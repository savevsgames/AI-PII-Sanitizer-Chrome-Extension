/*! For license information please see background.js.LICENSE.txt */
(()=>{"use strict";var e={51:(e,t,n)=>{n.d(t,{BG:()=>f,auth:()=>g});var r=n(223),s=n(2405),i=n(6639),o=n(5908);const a={apiKey:"AIzaSyA3bziFSSl5bmMOg57LXdgA6UYY50YKGIg",authDomain:"promptblocker-prod.firebaseapp.com",projectId:"promptblocker-prod",storageBucket:"promptblocker-prod.firebasestorage.app",messagingSenderId:"861822607891",appId:"1:861822607891:web:69b2213902528793f715e6"},c=["apiKey","authDomain","projectId","appId"].filter(e=>!a[e]);if(c.length>0)throw new Error(`[Firebase] Missing required environment variables: ${c.map(e=>`FIREBASE_${e.toUpperCase()}`).join(", ")}`);const l=!0===globalThis.__IS_SERVICE_WORKER__||"undefined"==typeof document,u=l?"SERVICE WORKER":"POPUP/CONTENT";let h,d;try{h=(0,r.Wp)(a),d=(0,s.aU)(h),"true"==="MISSING_ENV_VAR".USE_FIREBASE_EMULATORS&&((0,s.vN)(d,"localhost",8080),console.log("[Firebase] Connected Firestore to local emulator")),console.log("[Firebase] App initialized successfully"),console.log("[Firebase] Context:",u),console.log("[Firebase] Project ID:",a.projectId)}catch(e){throw console.error("[Firebase] App initialization failed in",u,":",e),e}let p,g=null;async function f(){return p}p=(async()=>{try{return console.log("[Firebase] Starting auth initialization for",u),l?(console.log("[Firebase] Calling getAuth with web-extension module..."),g=(0,i.xI)(h),console.log("[Firebase] Auth instance created, setting persistence..."),await g.setPersistence(i.Gt),console.log("[Firebase] Persistence set to IndexedDB"),console.log("[Firebase] ✅ Initialized with WEB-EXTENSION auth for service worker")):(console.log("[Firebase] Calling getAuth with standard module..."),g=(0,o.xI)(h),console.log("[Firebase] Auth instance created"),console.log("[Firebase] ✅ Initialized with STANDARD auth for popup/content"),"true"==="MISSING_ENV_VAR".USE_FIREBASE_EMULATORS&&((0,o.Wq)(g,"http://localhost:9099"),console.log("[Firebase] Connected auth to local emulator"))),console.log("[Firebase] Auth initialization complete, returning auth"),g}catch(e){throw console.error("[Firebase] Auth initialization failed in",u,":",e),e}})()},223:(e,t,n)=>{n.d(t,{Wp:()=>r.Wp});var r=n(9943);(0,r.KO)("firebase","12.5.0","app")},602:(e,t,n)=>{n.d(t,{P2:()=>s});var r=n(7500);function s(e,t,{blocked:n,upgrade:s,blocking:i,terminated:o}={}){const a=indexedDB.open(e,t),c=(0,r.w)(a);return s&&a.addEventListener("upgradeneeded",e=>{s((0,r.w)(a.result),e.oldVersion,e.newVersion,(0,r.w)(a.transaction),e)}),n&&a.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),c.then(e=>{o&&e.addEventListener("close",()=>o()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),c}const i=["get","getKey","getAll","getAllKeys","count"],o=["put","add","delete","clear"],a=new Map;function c(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(a.get(t))return a.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=o.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!i.includes(n))return;const c=async function(e,...t){const i=this.transaction(e,s?"readwrite":"readonly");let o=i.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),s&&i.done]))[0]};return a.set(t,c),c}(0,r.r)(e=>({...e,get:(t,n,r)=>c(t,n)||e.get(t,n,r),has:(t,n)=>!!c(t,n)||e.has(t,n)}))},722:(e,t,n)=>{n.d(t,{$b:()=>s,Vy:()=>l});const r=[];var s;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(s||(s={}));const i={debug:s.DEBUG,verbose:s.VERBOSE,info:s.INFO,warn:s.WARN,error:s.ERROR,silent:s.SILENT},o=s.INFO,a={[s.DEBUG]:"log",[s.VERBOSE]:"log",[s.INFO]:"info",[s.WARN]:"warn",[s.ERROR]:"error"},c=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),s=a[t];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[s](`[${r}]  ${e.name}:`,...n)};class l{constructor(e){this.name=e,this._logLevel=o,this._logHandler=c,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in s))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?i[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,s.DEBUG,...e),this._logHandler(this,s.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,s.VERBOSE,...e),this._logHandler(this,s.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,s.INFO,...e),this._logHandler(this,s.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,s.WARN,...e),this._logHandler(this,s.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,s.ERROR,...e),this._logHandler(this,s.ERROR,...e)}}},1026:(e,t,n)=>{n.d(t,{a:()=>qe,c:()=>ge,i:()=>pe,r:()=>Ye});var r=n(1625),s=n(9943),i=n(1711),o=n(722);const a=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},c=new r.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),l=new o.Vy("@firebase/auth");function u(e,...t){l.logLevel<=o.$b.ERROR&&l.error(`Auth (${s.MF}): ${e}`,...t)}function h(e,...t){throw f(e,...t)}function d(e,...t){return f(e,...t)}function p(e,t,n){const s={...a(),[t]:n};return new r.FA("auth","Firebase",s).create(t,{appName:e.name})}function g(e){return p(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function f(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return c.create(e,...t)}function m(e,t,...n){if(!e)throw f(t,...n)}function y(e){const t="INTERNAL ASSERTION FAILED: "+e;throw u(t),new Error(t)}function w(e,t){e||y(t)}function v(){return"undefined"!=typeof self&&self.location?.protocol||null}class I{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void y("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void y("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void y("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const E={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},_=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],T=new class{constructor(e,t){this.shortDelay=e,this.longDelay=t,w(t>e,"Short delay should be less than long delay!"),this.isMobile=(0,r.jZ)()||(0,r.lV)()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===v()||"https:"===v()||(0,r.sr)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}(3e4,6e4);function A(e,t){return e.tenantId&&!t.tenantId?{...t,tenantId:e.tenantId}:t}async function S(e,t,n,s,i={}){return b(e,i,async()=>{let i={},o={};s&&("GET"===t?o=s:i={body:JSON.stringify(s)});const a=(0,r.Am)({key:e.config.apiKey,...o}).slice(1),c=await e._getAdditionalHeaders();c["Content-Type"]="application/json",e.languageCode&&(c["X-Firebase-Locale"]=e.languageCode);const l={method:t,headers:c,...i};return(0,r.c1)()||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&(0,r.zJ)(e.emulatorConfig.host)&&(l.credentials="include"),I.fetch()(await R(e,e.config.apiHost,n,a),l)})}async function b(e,t,n){e._canInitEmulator=!1;const s={...E,...t};try{const t=new k(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const i=await r.json();if("needConfirmation"in i)throw N(e,"account-exists-with-different-credential",i);if(r.ok&&!("errorMessage"in i))return i;{const t=r.ok?i.errorMessage:i.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw N(e,"credential-already-in-use",i);if("EMAIL_EXISTS"===n)throw N(e,"email-already-in-use",i);if("USER_DISABLED"===n)throw N(e,"user-disabled",i);const a=s[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw p(e,a,o);h(e,a)}}catch(t){if(t instanceof r.g)throw t;h(e,"network-request-failed",{message:String(t)})}}async function C(e,t,n,r,s={}){const i=await S(e,t,n,r,s);return"mfaPendingCredential"in i&&h(e,"multi-factor-auth-required",{_serverResponse:i}),i}async function R(e,t,n,r){const s=`${t}${n}?${r}`,i=e,o=i.config.emulator?function(e,t){w(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}(e.config,s):`${e.config.apiScheme}://${s}`;return _.includes(n)&&(await i._persistenceManagerAvailable,"COOKIE"===i._getPersistenceType())?i._getPersistence()._getFinalTarget(o).toString():o}function P(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class k{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(d(this.auth,"network-request-failed")),T.get())})}}function N(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=d(e,t,r);return s.customData._tokenResponse=n,s}function M(e){return void 0!==e&&void 0!==e.enterprise}class O{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return P(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function D(e,t){return S(e,"POST","/v1/accounts:lookup",t)}function L(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function U(e){return 1e3*Number(e)}function x(e){const[t,n,s]=e.split(".");if(void 0===t||void 0===n||void 0===s)return u("JWT malformed, contained fewer than 3 sections"),null;try{const e=(0,r.u)(n);return e?JSON.parse(e):(u("Failed to decode base64 JWT payload"),null)}catch(e){return u("Caught error parsing JWT payload as JSON",e?.toString()),null}}function V(e){const t=x(e);return m(t,"internal-error"),m(void 0!==t.exp,"internal-error"),m(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function F(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof r.g&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class K{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e?.code&&this.schedule(!0))}this.schedule()}}class j{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=L(this.lastLoginAt),this.creationTime=L(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function B(e){const t=e.auth,n=await e.getIdToken(),r=await F(e,D(t,{idToken:n}));m(r?.users.length,t,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const i=s.providerUserInfo?.length?$(s.providerUserInfo):[],o=(a=e.providerData,c=i,[...a.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var a,c;const l=e.isAnonymous,u=!(e.email&&s.passwordHash||o?.length),h=!!l&&u,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new j(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(e,d)}function $(e){return e.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}class H{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){m(e.idToken,"internal-error"),m(void 0!==e.idToken,"internal-error"),m(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):V(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){m(0!==e.length,"internal-error");const t=V(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(m(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:s,expiresIn:i}=await async function(e,t){const n=await b(e,{},async()=>{const n=(0,r.Am)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:i}=e.config,o=await R(e,s,"/v1/token",`key=${i}`),a=await e._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:n};return e.emulatorConfig&&(0,r.zJ)(e.emulatorConfig.host)&&(c.credentials="include"),I.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:s}=t,i=new H;return n&&(m("string"==typeof n,"internal-error",{appName:e}),i.refreshToken=n),r&&(m("string"==typeof r,"internal-error",{appName:e}),i.accessToken=r),s&&(m("number"==typeof s,"internal-error",{appName:e}),i.expirationTime=s),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new H,this.toJSON())}_performRefresh(){return y("not implemented")}}function q(e,t){m("string"==typeof e||void 0===e,"internal-error",{appName:t})}class z{constructor({uid:e,auth:t,stsTokenManager:n,...r}){this.providerId="firebase",this.proactiveRefresh=new K(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new j(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await F(this,this.stsTokenManager.getToken(this.auth,e));return m(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=(0,r.Ku)(e),s=await n.getIdToken(t),i=x(s);m(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const o="object"==typeof i.firebase?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:s,authTime:L(U(i.auth_time)),issuedAtTime:L(U(i.iat)),expirationTime:L(U(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}}(this,e)}reload(){return async function(e){const t=(0,r.Ku)(e);await B(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(m(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>({...e})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new z({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){m(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await B(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,s.xZ)(this.auth.app))return Promise.reject(g(this.auth));const e=await this.getIdToken();return await F(this,async function(e,t){return S(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,i=t.photoURL??void 0,o=t.tenantId??void 0,a=t._redirectEventId??void 0,c=t.createdAt??void 0,l=t.lastLoginAt??void 0,{uid:u,emailVerified:h,isAnonymous:d,providerData:p,stsTokenManager:g}=t;m(u&&g,e,"internal-error");const f=H.fromJSON(this.name,g);m("string"==typeof u,e,"internal-error"),q(n,e.name),q(r,e.name),m("boolean"==typeof h,e,"internal-error"),m("boolean"==typeof d,e,"internal-error"),q(s,e.name),q(i,e.name),q(o,e.name),q(a,e.name),q(c,e.name),q(l,e.name);const y=new z({uid:u,auth:e,email:r,emailVerified:h,displayName:n,isAnonymous:d,photoURL:i,phoneNumber:s,tenantId:o,stsTokenManager:f,createdAt:c,lastLoginAt:l});return p&&Array.isArray(p)&&(y.providerData=p.map(e=>({...e}))),a&&(y._redirectEventId=a),y}static async _fromIdTokenResponse(e,t,n=!1){const r=new H;r.updateFromServerResponse(t);const s=new z({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await B(s),s}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];m(void 0!==r.localId,"internal-error");const s=void 0!==r.providerUserInfo?$(r.providerUserInfo):[],i=!(r.email&&r.passwordHash||s?.length),o=new H;o.updateFromIdToken(n);const a=new z({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:i}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new j(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash||s?.length)};return Object.assign(a,c),a}}const G=new Map;function W(e){w(e instanceof Function,"Expected a class definition");let t=G.get(e);return t?(w(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,G.set(e,t),t)}class Y{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Y.type="NONE";const J=Y;function Q(e,t,n){return`firebase:${e}:${t}:${n}`}class X{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:s}=this.auth;this.fullUserKey=Q(this.userKey,r.apiKey,s),this.fullPersistenceKey=Q("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){const t=await D(this.auth,{idToken:e}).catch(()=>{});return t?z._fromGetAccountInfoResponse(this.auth,t,e):null}return z._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new X(W(J),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let s=r[0]||W(J);const i=Q(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(i);if(t){let r;if("string"==typeof t){const n=await D(e,{idToken:t}).catch(()=>{});if(!n)break;r=await z._fromGetAccountInfoResponse(e,n,t)}else r=z._fromJSON(e,t);n!==s&&(o=r),s=n;break}}catch{}const a=r.filter(e=>e._shouldAllowMigration);return s._shouldAllowMigration&&a.length?(s=a[0],o&&await s._set(i,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==s)try{await e._remove(i)}catch{}})),new X(s,e,n)):new X(s,e,n)}}function Z(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(function(e=(0,r.ZQ)()){return/iemobile/i.test(e)}(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(function(e=(0,r.ZQ)()){return/firefox\//i.test(e)}(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(function(e=(0,r.ZQ)()){return/blackberry/i.test(e)}(t))return"Blackberry";if(function(e=(0,r.ZQ)()){return/webos/i.test(e)}(t))return"Webos";if(function(e=(0,r.ZQ)()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}(t))return"Safari";if((t.includes("chrome/")||function(e=(0,r.ZQ)()){return/crios\//i.test(e)}(t))&&!t.includes("edge/"))return"Chrome";if(function(e=(0,r.ZQ)()){return/android/i.test(e)}(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===n?.length)return n[1]}return"Other"}function ee(e,t=[]){let n;switch(e){case"Browser":n=Z((0,r.ZQ)());break;case"Worker":n=`${Z((0,r.ZQ)())}-${e}`;break;default:n=e}const i=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${s.MF}/${i}`}class te{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(e){r(e)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:e?.message})}}}class ne{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??6,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),void 0!==t.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),void 0!==t.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),void 0!==t.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),void 0!==t.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class re{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ie(this),this.idTokenSubscription=new ie(this),this.beforeStateQueue=new te(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=c,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=W(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await X.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await D(this,{idToken:e}),n=await z._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if((0,s.xZ)(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const t=this.redirectUser?._redirectEventId,s=n?._redirectEventId,i=await this.tryRedirectSignIn(e);t&&t!==s||!i?.user||(n=i.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(e){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(e))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return m(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await B(e)}catch(e){if("auth/network-request-failed"!==e?.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if((0,s.xZ)(this.app))return Promise.reject(g(this));const t=e?(0,r.Ku)(e):null;return t&&m(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&m(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(0,s.xZ)(this.app)?Promise.reject(g(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return(0,s.xZ)(this.app)?Promise.reject(g(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(W(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return S(e,"GET","/v2/passwordPolicy",A(e,t))}(this),t=new ne(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new r.FA("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return S(e,"POST","/v2/accounts:revokeToken",A(e,t))}(this,t)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&W(e)||this._popupRedirectResolver;m(t,this,"argument-error"),this.redirectPersistenceManager=await X.create(this,[W(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const s="function"==typeof t?t:t.next.bind(t);let i=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(m(o,this,"internal-error"),o.then(()=>{i||s(this.currentUser)}),"function"==typeof t){const s=e.addObserver(t,n,r);return()=>{i=!0,s()}}{const n=e.addObserver(t);return()=>{i=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return m(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ee(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await(this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if((0,s.xZ)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await(this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken());return e?.error&&function(e,...t){l.logLevel<=o.$b.WARN&&l.warn(`Auth (${s.MF}): ${e}`,...t)}(`Error while retrieving App Check token: ${e.error}`),e?.token}}function se(e){return(0,r.Ku)(e)}class ie{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,r.tD)(e=>this.observer=e)}get next(){return m(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let oe={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};class ae{constructor(){this.enterprise=new ce}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class ce{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const le="NO_RECAPTCHA";class ue{constructor(e){this.type="recaptcha-enterprise",this.auth=se(e)}async verify(e="verify",t=!1){function n(t,n,r){const s=window.grecaptcha;M(s)?s.enterprise.ready(()=>{s.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(le)})}):r(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?(new ae).execute("siteKey",{action:"verify"}):new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{(async function(e,t){return S(e,"GET","/v2/recaptchaConfig",A(e,t))})(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new O(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(s=>{if(!t&&M(window.grecaptcha))n(s,e,r);else{if("undefined"==typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=oe.recaptchaEnterpriseScript;0!==t.length&&(t+=s),function(e){return oe.loadJS(e)}(t).then(()=>{n(s,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function he(e,t,n,r=!1,s=!1){const i=new ue(e);let o;if(s)o=le;else try{o=await i.verify(n)}catch(e){o=await i.verify(n,!0)}const a={...t};if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in a){const e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const e=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function de(e,t,n,r,s){if("EMAIL_PASSWORD_PROVIDER"===s){if(e._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await he(e,t,n,"getOobCode"===n);return r(e,s)}return r(e,t).catch(async s=>{if("auth/missing-recaptcha-token"===s.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const s=await he(e,t,n,"getOobCode"===n);return r(e,s)}return Promise.reject(s)})}if("PHONE_PROVIDER"===s){if(e._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const s=await he(e,t,n);return r(e,s).catch(async s=>{if("AUDIT"===e._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")&&("auth/missing-recaptcha-token"===s.code||"auth/invalid-app-credential"===s.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const s=await he(e,t,n,!1,!0);return r(e,s)}return Promise.reject(s)})}{const s=await he(e,t,n,!1,!0);return r(e,s)}}return Promise.reject(s+" provider is not supported.")}function pe(e,t){const n=(0,s.j6)(e,"auth");if(n.isInitialized()){const e=n.getImmediate(),s=n.getOptions();if((0,r.bD)(s,t??{}))return e;h(e,"already-initialized")}return n.initialize({options:t})}function ge(e,t,n){const s=se(e);m(/^https?:\/\//.test(t),s,"invalid-emulator-scheme");const i=!!n?.disableWarnings,o=fe(t),{host:a,port:c}=function(e){const t=fe(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const e=s[1];return{host:e,port:me(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:me(t)}}}(t),l=null===c?"":`:${c}`,u={url:`${o}//${a}${l}/`},h=Object.freeze({host:a,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!s._canInitEmulator)return m(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),void m((0,r.bD)(u,s.config.emulator)&&(0,r.bD)(h,s.emulatorConfig),s,"emulator-config-failed");s.config.emulator=u,s.emulatorConfig=h,s.settings.appVerificationDisabledForTesting=!0,(0,r.zJ)(a)?((0,r.gE)(`${o}//${a}${l}`),(0,r.P1)("Auth",!0)):i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function fe(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function me(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class ye{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return y("not implemented")}_getIdTokenResponse(e){return y("not implemented")}_linkToIdToken(e,t){return y("not implemented")}_getReauthenticationResolver(e){return y("not implemented")}}async function we(e,t){return S(e,"POST","/v1/accounts:signUp",t)}async function ve(e,t){return C(e,"POST","/v1/accounts:signInWithPassword",A(e,t))}class Ie extends ye{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Ie(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Ie(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return de(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",ve,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return C(e,"POST","/v1/accounts:signInWithEmailLink",A(e,t))}(e,{email:this._email,oobCode:this._password});default:h(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return de(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",we,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return C(e,"POST","/v1/accounts:signInWithEmailLink",A(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:h(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ee(e,t){return C(e,"POST","/v1/accounts:signInWithIdp",A(e,t))}class _e extends ye{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new _e(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):h("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,...s}=t;if(!n||!r)return null;const i=new _e(n,r);return i.idToken=s.idToken||void 0,i.accessToken=s.accessToken||void 0,i.secret=s.secret,i.nonce=s.nonce,i.pendingToken=s.pendingToken||null,i}_getIdTokenResponse(e){return Ee(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ee(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ee(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,r.Am)(t)}return e}}class Te{constructor(e){const t=(0,r.I9)((0,r.hp)(e)),n=t.apiKey??null,s=t.oobCode??null,i=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(t.mode??null);m(n&&s&&i,"argument-error"),this.apiKey=n,this.operation=i,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=function(e){const t=(0,r.I9)((0,r.hp)(e)).link,n=t?(0,r.I9)((0,r.hp)(t)).deep_link_id:null,s=(0,r.I9)((0,r.hp)(e)).deep_link_id;return(s?(0,r.I9)((0,r.hp)(s)).link:null)||s||n||t||e}(e);try{return new Te(t)}catch{return null}}}class Ae{constructor(){this.providerId=Ae.PROVIDER_ID}static credential(e,t){return Ie._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Te.parseLink(t);return m(n,"argument-error"),Ie._fromEmailAndCode(e,n.code,n.tenantId)}}Ae.PROVIDER_ID="password",Ae.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Ae.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Se{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class be extends Se{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ce extends be{constructor(){super("facebook.com")}static credential(e){return _e._fromParams({providerId:Ce.PROVIDER_ID,signInMethod:Ce.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ce.credentialFromTaggedObject(e)}static credentialFromError(e){return Ce.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Ce.credential(e.oauthAccessToken)}catch{return null}}}Ce.FACEBOOK_SIGN_IN_METHOD="facebook.com",Ce.PROVIDER_ID="facebook.com";class Re extends be{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return _e._fromParams({providerId:Re.PROVIDER_ID,signInMethod:Re.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Re.credentialFromTaggedObject(e)}static credentialFromError(e){return Re.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Re.credential(t,n)}catch{return null}}}Re.GOOGLE_SIGN_IN_METHOD="google.com",Re.PROVIDER_ID="google.com";class Pe extends be{constructor(){super("github.com")}static credential(e){return _e._fromParams({providerId:Pe.PROVIDER_ID,signInMethod:Pe.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Pe.credentialFromTaggedObject(e)}static credentialFromError(e){return Pe.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Pe.credential(e.oauthAccessToken)}catch{return null}}}Pe.GITHUB_SIGN_IN_METHOD="github.com",Pe.PROVIDER_ID="github.com";class ke extends be{constructor(){super("twitter.com")}static credential(e,t){return _e._fromParams({providerId:ke.PROVIDER_ID,signInMethod:ke.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ke.credentialFromTaggedObject(e)}static credentialFromError(e){return ke.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return ke.credential(t,n)}catch{return null}}}ke.TWITTER_SIGN_IN_METHOD="twitter.com",ke.PROVIDER_ID="twitter.com",r.g,new WeakMap;const Ne="__sak";class Me{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Me(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:s}=t.data,i=this.handlersMap[r];if(!i?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(i).map(async e=>e(t.origin,s)),a=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}}))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Me.receivers=[];class Oe{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,i;return new Promise((o,a)=>{const c=function(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}("",20);r.port1.start();const l=setTimeout(()=>{a(new Error("unsupported_event"))},n);i={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),s=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(t.data.response);break;default:clearTimeout(l),clearTimeout(s),a(new Error("invalid_response"))}}},this.handlers.add(i),r.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}function De(){return window}function Le(){return void 0!==De().WorkerGlobalScope&&"function"==typeof De().importScripts}const Ue="firebaseLocalStorageDb",xe="firebaseLocalStorage",Ve="fbase_key";class Fe{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Ke(e,t){return e.transaction([xe],t?"readwrite":"readonly").objectStore(xe)}function je(){const e=indexedDB.open(Ue,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(xe,{keyPath:Ve})}catch(e){n(e)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(xe)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Ue);return new Fe(e).toPromise()}(),t(await je()))})})}async function Be(e,t,n){const r=Ke(e,!0).put({[Ve]:t,value:n});return new Fe(r).toPromise()}function $e(e,t){const n=Ke(e,!0).delete(t);return new Fe(n).toPromise()}class He{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await je()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Le()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Me._getInstance(Le()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await async function(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}(),!this.activeServiceWorker)return;this.sender=new Oe(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&(navigator?.serviceWorker?.controller||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await je();return await Be(e,Ne,"1"),await $e(e,Ne),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Be(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Ke(e,!1).get(t),r=await new Fe(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>$e(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Ke(e,!1).getAll();return new Fe(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:s}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}He.type="LOCAL";const qe=He;var ze="@firebase/auth",Ge="1.11.1";class We{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e(t?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){m(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Ye(e){(0,s.om)(new i.uA("auth",(t,{options:n})=>{const r=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),i=t.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;m(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:a,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ee(e)},l=new re(r,s,i,c);return function(e,t){const n=t?.persistence||[],r=(Array.isArray(n)?n:[n]).map(W);t?.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,t?.popupRedirectResolver)}(l,n),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),(0,s.om)(new i.uA("auth-internal",e=>{return t=se(e.getProvider("auth").getImmediate()),new We(t);var t},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,s.KO)(ze,Ge,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(e)),(0,s.KO)(ze,Ge,"esm2020")}},1625:(e,t,n)=>{n.d(t,{Am:()=>F,FA:()=>D,Fy:()=>w,I9:()=>K,Im:()=>U,Ku:()=>q,Ov:()=>k,P1:()=>E,T9:()=>p,Tj:()=>h,Uj:()=>a,XA:()=>g,ZQ:()=>_,bD:()=>x,c1:()=>S,cY:()=>f,eX:()=>M,g:()=>O,gE:()=>y,hp:()=>j,jZ:()=>T,lT:()=>R,lV:()=>C,mS:()=>l,nr:()=>P,sr:()=>b,tD:()=>B,u:()=>c,yU:()=>d,zJ:()=>m,zW:()=>N});var r=n(7773);const s=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=63&s|128):55296==(64512&s)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++r)),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=63&s|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=63&s|128)}return t},i={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const s=e[t],i=t+1<e.length,o=i?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,l=s>>2,u=(3&s)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,i||(h=64)),r.push(n[l],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(s(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const s=e[n++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=e[n++];t[r++]=String.fromCharCode((31&s)<<6|63&i)}else if(s>239&&s<365){const i=((7&s)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))}else{const i=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&s)<<12|(63&i)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const s=n[e.charAt(t++)],i=t<e.length?n[e.charAt(t)]:0;++t;const a=t<e.length?n[e.charAt(t)]:64;++t;const c=t<e.length?n[e.charAt(t)]:64;if(++t,null==s||null==i||null==a||null==c)throw new o;const l=s<<2|i>>4;if(r.push(l),64!==a){const e=i<<4&240|a>>2;if(r.push(e),64!==c){const e=a<<6&192|c;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class o extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const a=function(e){return function(e){const t=s(e);return i.encodeByteArray(t,!0)}(e).replace(/\./g,"")},c=function(e){try{return i.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function l(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}const u=()=>{try{return(0,r.M)()||l().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process)return;const e="MISSING_ENV_VAR".__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&c(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},h=e=>u()?.emulatorHosts?.[e],d=e=>{const t=h(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},p=()=>u()?.config,g=e=>u()?.[`_${e}`];class f{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function m(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function y(e){return(await fetch(e,{credentials:"include"})).ok}function w(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i={iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...e};return[a(JSON.stringify({alg:"none",type:"JWT"})),a(JSON.stringify(i)),""].join(".")}const v={};let I=!1;function E(e,t){if("undefined"==typeof window||"undefined"==typeof document||!m(window.location.host)||v[e]===t||v[e]||I)return;function n(e){return`__firebase__banner__${e}`}v[e]=t;const r="__firebase__banner",s=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(v))v[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function i(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),i=document.getElementById(t)||document.createElement("span"),o=n("learnmore"),a=document.getElementById(o)||document.createElement("a"),c=n("preprendIcon"),l=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(a,o);const n=function(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{I=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(l,c),t.append(l,i,a,n),document.body.appendChild(t)}s?(i.innerText="Preview backend disconnected.",l.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(l.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',i.innerText="Preview backend running in this workspace."),i.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",i):i()}function _(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function T(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_())}function A(){const e=u()?.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(e){return!1}}function S(){return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function b(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function C(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function R(){const e=_();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function P(){return!A()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function k(){return!A()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function N(){try{return"object"==typeof indexedDB}catch(e){return!1}}function M(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{t(s.error?.message||"")}}catch(e){t(e)}})}class O extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,O.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,D.prototype.create)}}class D{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],i=s?function(e,t){return e.replace(L,(e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`})}(s,n):"Error",o=`${this.serviceName}: ${i} (${r}).`;return new O(r,o,n)}}const L=/\{\$([^}]+)}/g;function U(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function x(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const s of n){if(!r.includes(s))return!1;const n=e[s],i=t[s];if(V(n)&&V(i)){if(!x(n,i))return!1}else if(n!==i)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function V(e){return null!==e&&"object"==typeof e}function F(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function K(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function j(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function B(e,t){const n=new $(e,t);return n.subscribe.bind(n)}class ${constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=H),void 0===r.error&&(r.error=H),void 0===r.complete&&(r.complete=H);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),s}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function H(){}function q(e){return e&&e._delegate?e._delegate:e}},1711:(e,t,n)=>{n.d(t,{h1:()=>a,uA:()=>s});var r=n(1625);class s{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const i="[DEFAULT]";class o{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new r.cY;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(!this.isInitialized(t)&&!this.shouldAutoInitialize()){if(n)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:t})}catch(e){if(n)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:i})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=i){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=i){return this.instances.has(e)}getOptions(e=i){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(r);return r}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);const s=this.instances.get(n);return s&&e(s,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===i?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}var r;return n||null}normalizeInstanceIdentifier(e=i){return this.component?this.component.multipleInstances?e:i:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new o(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},1853:(e,t,n)=>{n.d(t,{Ao:()=>l,Bx:()=>i,Jh:()=>c,O4:()=>o,ZS:()=>r,fF:()=>u,iO:()=>s,ro:()=>a});var r,s,i,o,a,c,l,u,h="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},d={};(function(){var e,t=Object.defineProperty,n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof h&&h];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function p(e,r){if(r)e:{var s=n;e=e.split(".");for(var i=0;i<e.length-1;i++){var o=e[i];if(!(o in s))break e;s=s[o]}(r=r(i=s[e=e[e.length-1]]))!=i&&null!=r&&t(s,e,{configurable:!0,writable:!0,value:r})}}p("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")}),p("Array.prototype.values",function(e){return e||function(){return this[Symbol.iterator]()}}),p("Object.entries",function(e){return e||function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push([t,e[t]]);return n}});var g=g||{},f=this||self;function m(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function y(e,t,n){return e.call.apply(e.bind,arguments)}function w(e,t,n){return(w=y).apply(null,arguments)}function v(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function I(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Ob=function(e,n,r){for(var s=Array(arguments.length-2),i=2;i<arguments.length;i++)s[i-2]=arguments[i];return t.prototype[n].apply(e,s)}}var E="undefined"!=typeof AsyncContext&&"function"==typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function _(e){const t=e.length;if(t>0){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function T(e,t){for(let t=1;t<arguments.length;t++){const r=arguments[t];var n=typeof r;if("array"==(n="object"!=n?n:r?Array.isArray(r)?"array":n:"null")||"object"==n&&"number"==typeof r.length){n=e.length||0;const t=r.length||0;e.length=n+t;for(let s=0;s<t;s++)e[n+s]=r[s]}else e.push(r)}}function A(e){f.setTimeout(()=>{throw e},0)}function S(){var e=k;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var b=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new C,e=>e.reset());class C{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let R,P=!1,k=new class{constructor(){this.h=this.g=null}add(e,t){const n=b.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},N=()=>{const e=Promise.resolve(void 0);R=()=>{e.then(M)}};function M(){for(var e;e=S();){try{e.h.call(e.g)}catch(e){A(e)}var t=b;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}P=!1}function O(){this.u=this.u,this.C=this.C}function D(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}O.prototype.u=!1,O.prototype.dispose=function(){this.u||(this.u=!0,this.N())},O.prototype[Symbol.dispose]=function(){this.dispose()},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},D.prototype.h=function(){this.defaultPrevented=!0};var L=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};f.addEventListener("test",e,t),f.removeEventListener("test",e,t)}catch(e){}return e}();function U(e){return/^[\s\xa0]*$/.test(e)}function x(e,t){D.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,t)}I(x,D),x.prototype.init=function(e,t){const n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,(t=e.relatedTarget)||("mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement)),this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&x.Z.h.call(this)},x.prototype.h=function(){x.Z.h.call(this);const e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var V="closure_listenable_"+(1e6*Math.random()|0),F=0;function K(e,t,n,r,s){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=s,this.key=++F,this.da=this.fa=!1}function j(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function B(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function $(e){const t={};for(const n in e)t[n]=e[n];return t}const H="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function q(e,t){let n,r;for(let t=1;t<arguments.length;t++){for(n in r=arguments[t],r)e[n]=r[n];for(let t=0;t<H.length;t++)n=H[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function z(e){this.src=e,this.g={},this.h=0}function G(e,t){const n=t.type;if(n in e.g){var r,s=e.g[n],i=Array.prototype.indexOf.call(s,t,void 0);(r=i>=0)&&Array.prototype.splice.call(s,i,1),r&&(j(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function W(e,t,n,r){for(let s=0;s<e.length;++s){const i=e[s];if(!i.da&&i.listener==t&&i.capture==!!n&&i.ha==r)return s}return-1}z.prototype.add=function(e,t,n,r,s){const i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);const o=W(e,t,r,s);return o>-1?(t=e[o],n||(t.fa=!1)):((t=new K(t,this.src,i,!!r,s)).fa=n,e.push(t)),t};var Y="closure_lm_"+(1e6*Math.random()|0),J={};function Q(e,t,n,r,s){if(r&&r.once)return Z(e,t,n,r,s);if(Array.isArray(t)){for(let i=0;i<t.length;i++)Q(e,t[i],n,r,s);return null}return n=oe(n),e&&e[V]?e.J(t,n,m(r)?!!r.capture:!!r,s):X(e,t,n,!1,r,s)}function X(e,t,n,r,s,i){if(!t)throw Error("Invalid event type");const o=m(s)?!!s.capture:!!s;let a=se(e);if(a||(e[Y]=a=new z(e)),(n=a.add(t,n,r,o,i)).proxy)return n;if(r=function(){const e=re;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)L||(s=o),void 0===s&&(s=!1),e.addEventListener(t.toString(),r,s);else if(e.attachEvent)e.attachEvent(ne(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function Z(e,t,n,r,s){if(Array.isArray(t)){for(let i=0;i<t.length;i++)Z(e,t[i],n,r,s);return null}return n=oe(n),e&&e[V]?e.K(t,n,m(r)?!!r.capture:!!r,s):X(e,t,n,!0,r,s)}function ee(e,t,n,r,s){if(Array.isArray(t))for(var i=0;i<t.length;i++)ee(e,t[i],n,r,s);else r=m(r)?!!r.capture:!!r,n=oe(n),e&&e[V]?(e=e.i,(i=String(t).toString())in e.g&&(n=W(t=e.g[i],n,r,s))>-1&&(j(t[n]),Array.prototype.splice.call(t,n,1),0==t.length&&(delete e.g[i],e.h--))):e&&(e=se(e))&&(t=e.g[t.toString()],e=-1,t&&(e=W(t,n,r,s)),(n=e>-1?t[e]:null)&&te(n))}function te(e){if("number"!=typeof e&&e&&!e.da){var t=e.src;if(t&&t[V])G(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(ne(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=se(t))?(G(n,e),0==n.h&&(n.src=null,t[Y]=null)):j(e)}}}function ne(e){return e in J?J[e]:J[e]="on"+e}function re(e,t){if(e.da)e=!0;else{t=new x(t,this);const n=e.listener,r=e.ha||e.src;e.fa&&te(e),e=n.call(r,t)}return e}function se(e){return(e=e[Y])instanceof z?e:null}var ie="__closure_events_fn_"+(1e9*Math.random()>>>0);function oe(e){return"function"==typeof e?e:(e[ie]||(e[ie]=function(t){return e.handleEvent(t)}),e[ie])}function ae(){O.call(this),this.i=new z(this),this.M=this,this.G=null}function ce(e,t){var n,r=e.G;if(r)for(n=[];r;r=r.G)n.push(r);if(e=e.M,r=t.type||t,"string"==typeof t)t=new D(t,e);else if(t instanceof D)t.target=t.target||e;else{var s=t;q(t=new D(r,e),s)}let i,o;if(s=!0,n)for(o=n.length-1;o>=0;o--)i=t.g=n[o],s=le(i,r,!0,t)&&s;if(i=t.g=e,s=le(i,r,!0,t)&&s,s=le(i,r,!1,t)&&s,n)for(o=0;o<n.length;o++)i=t.g=n[o],s=le(i,r,!1,t)&&s}function le(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();let s=!0;for(let i=0;i<t.length;++i){const o=t[i];if(o&&!o.da&&o.capture==n){const t=o.listener,n=o.ha||o.src;o.fa&&G(e.i,o),s=!1!==t.call(n,r)&&s}}return s&&!r.defaultPrevented}function ue(e){e.g=function(e,t){if("function"!=typeof e){if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=w(e.handleEvent,e)}return Number(t)>2147483647?-1:f.setTimeout(e,t||0)}(()=>{e.g=null,e.i&&(e.i=!1,ue(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}I(ae,O),ae.prototype[V]=!0,ae.prototype.removeEventListener=function(e,t,n,r){ee(this,e,t,n,r)},ae.prototype.N=function(){if(ae.Z.N.call(this),this.i){var e=this.i;for(const t in e.g){const n=e.g[t];for(let e=0;e<n.length;e++)j(n[e]);delete e.g[t],e.h--}}this.G=null},ae.prototype.J=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ae.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class he extends O{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ue(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function de(e){O.call(this),this.h=e,this.g={}}I(de,O);var pe=[];function ge(e){B(e.g,function(e,t){this.g.hasOwnProperty(t)&&te(e)},e),e.g={}}de.prototype.N=function(){de.Z.N.call(this),ge(this)},de.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var fe=f.JSON.stringify,me=f.JSON.parse,ye=class{stringify(e){return f.JSON.stringify(e,void 0)}parse(e){return f.JSON.parse(e,void 0)}};function we(){}function ve(){}var Ie={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ee(){D.call(this,"d")}function _e(){D.call(this,"c")}I(Ee,D),I(_e,D);var Te={},Ae=null;function Se(){return Ae=Ae||new ae}function be(e){D.call(this,Te.Ia,e)}function Ce(e){const t=Se();ce(t,new be(t))}function Re(e,t){D.call(this,Te.STAT_EVENT,e),this.stat=t}function Pe(e){const t=Se();ce(t,new Re(t,e))}function ke(e,t){D.call(this,Te.Ja,e),this.size=t}function Ne(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){e()},t)}function Me(){this.g=!0}function Oe(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{const i=JSON.parse(t);if(i)for(e=0;e<i.length;e++)if(Array.isArray(i[e])){var n=i[e];if(!(n.length<2)){var r=n[1];if(Array.isArray(r)&&!(r.length<1)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(let e=1;e<r.length;e++)r[e]=""}}}return fe(i)}catch(e){return t}}(e,n)+(r?" "+r:"")})}Te.Ia="serverreachability",I(be,D),Te.STAT_EVENT="statevent",I(Re,D),Te.Ja="timingevent",I(ke,D),Me.prototype.ua=function(){this.g=!1},Me.prototype.info=function(){};var De,Le={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ue={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function xe(){}function Ve(e){return encodeURIComponent(String(e))}function Fe(e){var t=1;e=e.split(":");const n=[];for(;t>0&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Ke(e,t,n,r){this.j=e,this.i=t,this.l=n,this.S=r||1,this.V=new de(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new je}function je(){this.i=null,this.g="",this.h=!1}I(xe,we),xe.prototype.g=function(){return new XMLHttpRequest},De=new xe;var Be={},$e={};function He(e,t,n){e.M=1,e.A=ft(ut(t)),e.u=n,e.R=!0,qe(e,null)}function qe(e,t){e.F=Date.now(),We(e),e.B=ut(e.A);var n=e.B,r=e.S;Array.isArray(r)||(r=[String(r)]),Pt(n.i,"t",r),e.C=0,n=e.j.L,e.h=new je,e.g=mn(e.j,n?t:null,!e.u),e.P>0&&(e.O=new he(w(e.Y,e,e.g),e.P)),t=e.V,n=e.g,r=e.ba;var s="readystatechange";Array.isArray(s)||(s&&(pe[0]=s.toString()),s=pe);for(let e=0;e<s.length;e++){const i=Q(n,s[e],r||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}t=e.J?$(e.J):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,t)):(e.v="GET",e.g.ea(e.B,e.v,null,t)),Ce(),function(e,t,n,r,s,i){e.info(function(){if(e.g)if(i){var o="",a=i.split("&");for(let e=0;e<a.length;e++){var c=a[e].split("=");if(c.length>1){const e=c[0];c=c[1];const t=e.split("_");o=t.length>=2&&"type"==t[1]?o+(e+"=")+c+"&":o+(e+"=redacted&")}}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+t+"\n"+n+"\n"+o})}(e.i,e.v,e.B,e.l,e.S,e.u)}function ze(e){return!!e.g&&"GET"==e.v&&2!=e.M&&e.j.Aa}function Ge(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?$e:(n=Number(t.substring(n,r)),isNaN(n)?Be:(r+=1)+n>t.length?$e:(t=t.slice(r,r+n),e.C=r+n,t))}function We(e){e.T=Date.now()+e.H,Ye(e,e.H)}function Ye(e,t){if(null!=e.D)throw Error("WatchDog timer not null");e.D=Ne(w(e.aa,e),t)}function Je(e){e.D&&(f.clearTimeout(e.D),e.D=null)}function Qe(e){0==e.j.I||e.K||hn(e.j,e)}function Xe(e){Je(e);var t=e.O;t&&"function"==typeof t.dispose&&t.dispose(),e.O=null,ge(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function Ze(e,t){try{var n=e.j;if(0!=n.I&&(n.g==e||st(n.h,e)))if(!e.L&&st(n.h,e)&&3==n.I){try{var r=n.Ba.g.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!n.v){if(n.g){if(!(n.g.F+3e3<e.F))break e;un(n),Zt(n)}an(n),Pe(18)}}else n.xa=s[1],0<n.xa-n.K&&s[2]<37500&&n.F&&0==n.A&&!n.C&&(n.C=Ne(w(n.Va,n),6e3));rt(n.h)<=1&&n.ta&&(n.ta=void 0)}else pn(n,11)}else if((e.L||n.g==e)&&un(n),!U(t))for(s=n.Ba.g.parse(t),t=0;t<s.length;t++){let l=s[t];const u=l[0];if(!(u<=n.K))if(n.K=u,l=l[1],2==n.I)if("c"==l[0]){n.M=l[1],n.ba=l[2];const t=l[3];null!=t&&(n.ka=t,n.j.info("VER="+n.ka));const s=l[4];null!=s&&(n.za=s,n.j.info("SVER="+n.za));const u=l[5];null!=u&&"number"==typeof u&&u>0&&(r=1.5*u,n.O=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var i=r.h;i.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(it(i,i.h),i.h=null))}if(r.G){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.wa=e,gt(r.J,r.G,e))}}n.I=3,n.l&&n.l.ra(),n.aa&&(n.T=Date.now()-e.F,n.j.info("Handshake RTT: "+n.T+"ms"));var o=e;if((r=n).na=fn(r,r.L?r.ba:null,r.W),o.L){ot(r.h,o);var a=o,c=r.O;c&&(a.H=c),a.D&&(Je(a),We(a)),r.g=o}else on(r);n.i.length>0&&tn(n)}else"stop"!=l[0]&&"close"!=l[0]||pn(n,7);else 3==n.I&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?pn(n,7):Xt(n):"noop"!=l[0]&&n.l&&n.l.qa(l),n.A=0)}Ce()}catch(e){}}Ke.prototype.ba=function(e){e=e.target;const t=this.O;t&&3==Wt(e)?t.j():this.Y(e)},Ke.prototype.Y=function(e){try{if(e==this.g)e:{const a=Wt(this.g),c=this.g.ya();if(this.g.ca(),!(a<3)&&(3!=a||this.g&&(this.h.h||this.g.la()||Yt(this.g)))){this.K||4!=a||7==c||Ce(),Je(this);var t=this.g.ca();this.X=t;var n=function(e){if(!ze(e))return e.g.la();const t=Yt(e.g);if(""===t)return"";let n="";const r=t.length,s=4==Wt(e.g);if(!e.h.i){if("undefined"==typeof TextDecoder)return Xe(e),Qe(e),"";e.h.i=new f.TextDecoder}for(let i=0;i<r;i++)e.h.h=!0,n+=e.h.i.decode(t[i],{stream:!(s&&i==r-1)});return t.length=0,e.h.g+=n,e.C=0,e.h.g}(this);if(this.o=200==t,function(e,t,n,r,s,i,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+t+"\n"+n+"\n"+i+" "+o})}(this.i,this.v,this.B,this.l,this.S,a,t),this.o){if(this.U&&!this.L){t:{if(this.g){var r,s=this.g;if((r=s.g?s.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U(r)){var i=r;break t}}i=null}if(!(e=i)){this.o=!1,this.m=3,Pe(12),Xe(this),Qe(this);break e}Oe(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ze(this,e)}if(this.R){let t;for(e=!0;!this.K&&this.C<n.length;){if(t=Ge(this,n),t==$e){4==a&&(this.m=4,Pe(14),e=!1),Oe(this.i,this.l,null,"[Incomplete Response]");break}if(t==Be){this.m=4,Pe(15),Oe(this.i,this.l,n,"[Invalid Chunk]"),e=!1;break}Oe(this.i,this.l,t,null),Ze(this,t)}if(ze(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=a||0!=n.length||this.h.h||(this.m=1,Pe(16),e=!1),this.o=this.o&&e,e){if(n.length>0&&!this.W){this.W=!0;var o=this.j;o.g==this&&o.aa&&!o.P&&(o.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),cn(o),o.P=!0,Pe(11))}}else Oe(this.i,this.l,n,"[Invalid Chunked Response]"),Xe(this),Qe(this)}else Oe(this.i,this.l,n,null),Ze(this,n);4==a&&Xe(this),this.o&&!this.K&&(4==a?hn(this.j,this):(this.o=!1,We(this)))}else(function(e){const t={};e=(e.g&&Wt(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(U(e[r]))continue;var n=Fe(e[r]);const s=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const i=t[s]||[];t[s]=i,i.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==t&&n.indexOf("Unknown SID")>0?(this.m=3,Pe(12)):(this.m=0,Pe(13)),Xe(this),Qe(this)}}}catch(e){}},Ke.prototype.cancel=function(){this.K=!0,Xe(this)},Ke.prototype.aa=function(){this.D=null;const e=Date.now();e-this.T>=0?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.B),2!=this.M&&(Ce(),Pe(17)),Xe(this),this.m=2,Qe(this)):Ye(this,this.T-e)};var et=class{constructor(e,t){this.g=e,this.map=t}};function tt(e){this.l=e||10,e=f.PerformanceNavigationTiming?(e=f.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function nt(e){return!!e.h||!!e.g&&e.g.size>=e.j}function rt(e){return e.h?1:e.g?e.g.size:0}function st(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function it(e,t){e.g?e.g.add(t):e.h=t}function ot(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function at(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.G);return t}return _(e.i)}tt.prototype.cancel=function(){if(this.i=at(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var ct=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function lt(e){let t;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof lt?(this.l=e.l,ht(this,e.j),this.o=e.o,this.g=e.g,dt(this,e.u),this.h=e.h,pt(this,kt(e.i)),this.m=e.m):e&&(t=String(e).match(ct))?(this.l=!1,ht(this,t[1]||"",!0),this.o=mt(t[2]||""),this.g=mt(t[3]||"",!0),dt(this,t[4]),this.h=mt(t[5]||"",!0),pt(this,t[6]||"",!0),this.m=mt(t[7]||"")):(this.l=!1,this.i=new At(null,this.l))}function ut(e){return new lt(e)}function ht(e,t,n){e.j=n?mt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function dt(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.u=t}else e.u=null}function pt(e,t,n){t instanceof At?(e.i=t,function(e,t){t&&!e.j&&(St(e),e.i=null,e.g.forEach(function(e,t){const n=t.toLowerCase();t!=n&&(bt(this,t),Pt(this,n,e))},e)),e.j=t}(e.i,e.l)):(n||(t=yt(t,_t)),e.i=new At(t,e.l))}function gt(e,t,n){e.i.set(t,n)}function ft(e){return gt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function mt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function yt(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,wt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function wt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}lt.prototype.toString=function(){const e=[];var t=this.j;t&&e.push(yt(t,vt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(yt(t,vt,!0),"@"),e.push(Ve(n).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.u)&&e.push(":",String(n))),(n=this.h)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(yt(n,"/"==n.charAt(0)?Et:It,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",yt(n,Tt)),e.join("")},lt.prototype.resolve=function(e){const t=ut(this);let n=!!e.j;n?ht(t,e.j):n=!!e.o,n?t.o=e.o:n=!!e.g,n?t.g=e.g:n=null!=e.u;var r=e.h;if(n)dt(t,e.u);else if(n=!!e.h){if("/"!=r.charAt(0))if(this.g&&!this.h)r="/"+r;else{var s=t.h.lastIndexOf("/");-1!=s&&(r=t.h.slice(0,s+1)+r)}if(".."==(s=r)||"."==s)r="";else if(-1!=s.indexOf("./")||-1!=s.indexOf("/.")){r=0==s.lastIndexOf("/",0),s=s.split("/");const e=[];for(let t=0;t<s.length;){const n=s[t++];"."==n?r&&t==s.length&&e.push(""):".."==n?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),r&&t==s.length&&e.push("")):(e.push(n),r=!0)}r=e.join("/")}else r=s}return n?t.h=r:n=""!==e.i.toString(),n?pt(t,kt(e.i)):n=!!e.m,n&&(t.m=e.m),t};var vt=/[#\/\?@]/g,It=/[#\?:]/g,Et=/[#\?]/g,_t=/[#\?@]/g,Tt=/#/g;function At(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function St(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(let n=0;n<e.length;n++){const r=e[n].indexOf("=");let s,i=null;r>=0?(s=e[n].substring(0,r),i=e[n].substring(r+1)):s=e[n],t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function bt(e,t){St(e),t=Nt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Ct(e,t){return St(e),t=Nt(e,t),e.g.has(t)}function Rt(e,t){St(e);let n=[];if("string"==typeof t)Ct(e,t)&&(n=n.concat(e.g.get(Nt(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)n=n.concat(e[t]);return n}function Pt(e,t,n){bt(e,t),n.length>0&&(e.i=null,e.g.set(Nt(e,t),_(n)),e.h+=n.length)}function kt(e){const t=new At;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function Nt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Mt(e,t,n,r,s){try{s&&(s.onload=null,s.onerror=null,s.onabort=null,s.ontimeout=null),r(n)}catch(e){}}function Ot(){this.g=new ye}function Dt(e){this.i=e.Sb||null,this.h=e.ab||!1}function Lt(e,t){ae.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function Ut(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function xt(e){e.readyState=4,e.l=null,e.j=null,e.B=null,Vt(e)}function Vt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Ft(e){let t="";return B(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Kt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Ft(n),"string"==typeof e?null!=n&&Ve(n):gt(e,t,n))}function jt(e){ae.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(e=At.prototype).add=function(e,t){St(this),this.i=null,e=Nt(this,e);let n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){St(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.set=function(e,t){return St(this),this.i=null,Ct(this,e=Nt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&(e=Rt(this,e)).length>0?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(let r=0;r<t.length;r++){var n=t[r];const s=Ve(n);n=Rt(this,n);for(let t=0;t<n.length;t++){let r=s;""!==n[t]&&(r+="="+Ve(n[t])),e.push(r)}}return this.i=e.join("&")},I(Dt,we),Dt.prototype.g=function(){return new Lt(this.i,this.h)},I(Lt,ae),(e=Lt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=t,this.readyState=1,Vt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||f).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,xt(this)),this.readyState=0},e.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Vt(this)),this.g&&(this.readyState=3,Vt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(void 0!==f.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ut(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))},e.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?xt(this):Vt(this),3==this.readyState&&Ut(this)}},e.Oa=function(e){this.g&&(this.response=this.responseText=e,xt(this))},e.Na=function(e){this.g&&(this.response=e,xt(this))},e.ga=function(){this.g&&xt(this)},e.setRequestHeader=function(e,t){this.A.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Lt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),I(jt,ae);var Bt=/^https?$/i,$t=["POST","PUT"];function Ht(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,qt(e),Gt(e)}function qt(e){e.A||(e.A=!0,ce(e,"complete"),ce(e,"error"))}function zt(e){if(e.h&&void 0!==g)if(e.v&&4==Wt(e))setTimeout(e.Ca.bind(e),0);else if(ce(e,"readystatechange"),4==Wt(e)){e.h=!1;try{const i=e.ca();e:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===i){let t=String(e.D).match(ct)[1]||null;!t&&f.self&&f.self.location&&(t=f.self.location.protocol.slice(0,-1)),r=!Bt.test(t?t.toLowerCase():"")}n=r}if(n)ce(e,"complete"),ce(e,"success");else{e.o=6;try{var s=Wt(e)>2?e.g.statusText:""}catch(e){s=""}e.l=s+" ["+e.ca()+"]",qt(e)}}finally{Gt(e)}}}function Gt(e,t){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);const n=e.g;e.g=null,t||ce(e,"ready");try{n.onreadystatechange=null}catch(e){}}}function Wt(e){return e.g?e.g.readyState:0}function Yt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Jt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Qt(e){this.za=0,this.i=[],this.j=new Me,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Jt("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Jt("baseRetryDelayMs",5e3,e),this.Za=Jt("retryDelaySeedMs",1e4,e),this.Ta=Jt("forwardChannelMaxRetries",2,e),this.va=Jt("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new tt(e&&e.concurrentRequestLimit),this.Ba=new Ot,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function Xt(e){if(en(e),3==e.I){var t=e.V++,n=ut(e.J);if(gt(n,"SID",e.M),gt(n,"RID",t),gt(n,"TYPE","terminate"),rn(e,n),(t=new Ke(e,e.j,t)).M=2,t.A=ft(ut(n)),n=!1,f.navigator&&f.navigator.sendBeacon)try{n=f.navigator.sendBeacon(t.A.toString(),"")}catch(e){}!n&&f.Image&&((new Image).src=t.A,n=!0),n||(t.g=mn(t.j,null),t.g.ea(t.A)),t.F=Date.now(),We(t)}gn(e)}function Zt(e){e.g&&(cn(e),e.g.cancel(),e.g=null)}function en(e){Zt(e),e.v&&(f.clearTimeout(e.v),e.v=null),un(e),e.h.cancel(),e.m&&("number"==typeof e.m&&f.clearTimeout(e.m),e.m=null)}function tn(e){if(!nt(e.h)&&!e.m){e.m=!0;var t=e.Ea;R||N(),P||(R(),P=!0),k.add(t,e),e.D=0}}function nn(e,t){var n;n=t?t.l:e.V++;const r=ut(e.J);gt(r,"SID",e.M),gt(r,"RID",n),gt(r,"AID",e.K),rn(e,r),e.u&&e.o&&Kt(r,e.u,e.o),n=new Ke(e,e.j,n,e.D+1),null===e.u&&(n.J=e.o),t&&(e.i=t.G.concat(e.i)),t=sn(e,n,1e3),n.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),it(e.h,n),He(n,r,t)}function rn(e,t){e.H&&B(e.H,function(e,n){gt(t,n,e)}),e.l&&B({},function(e,n){gt(t,n,e)})}function sn(e,t,n){n=Math.min(e.i.length,n);const r=e.l?w(e.l.Ka,e.l,e):null;e:{var s=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?n>0?(t=s[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let a=!0;for(let c=0;c<n;c++){var i=s[c].g;const n=s[c].map;if((i-=t)<0)t=Math.max(0,s[c].g-100),a=!1;else try{i="req"+i+"_"||0;try{var o=n instanceof Map?n:Object.entries(n);for(const[t,n]of o){let r=n;m(n)&&(r=fe(n)),e.push(i+t+"="+encodeURIComponent(r))}}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}catch(e){r&&r(n)}}if(a){o=e.join("&");break e}}o=void 0}return e=e.i.splice(0,n),t.G=e,o}function on(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;R||N(),P||(R(),P=!0),k.add(t,e),e.A=0}}function an(e){return!(e.g||e.v||e.A>=3||(e.Y++,e.v=Ne(w(e.Da,e),dn(e,e.A)),e.A++,0))}function cn(e){null!=e.B&&(f.clearTimeout(e.B),e.B=null)}function ln(e){e.g=new Ke(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var t=ut(e.na);gt(t,"RID","rpc"),gt(t,"SID",e.M),gt(t,"AID",e.K),gt(t,"CI",e.F?"0":"1"),!e.F&&e.ia&&gt(t,"TO",e.ia),gt(t,"TYPE","xmlhttp"),rn(e,t),e.u&&e.o&&Kt(t,e.u,e.o),e.O&&(e.g.H=e.O);var n=e.g;e=e.ba,n.M=1,n.A=ft(ut(t)),n.u=null,n.R=!0,qe(n,e)}function un(e){null!=e.C&&(f.clearTimeout(e.C),e.C=null)}function hn(e,t){var n=null;if(e.g==t){un(e),cn(e),e.g=null;var r=2}else{if(!st(e.h,t))return;n=t.G,ot(e.h,t),r=1}if(0!=e.I)if(t.o)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.F;var s=e.D;ce(r=Se(),new ke(r,n)),tn(e)}else on(e);else if(3==(s=t.m)||0==s&&t.X>0||!(1==r&&function(e,t){return!(rt(e.h)>=e.h.j-(e.m?1:0)||(e.m?(e.i=t.G.concat(e.i),0):1==e.I||2==e.I||e.D>=(e.Sa?0:e.Ta)||(e.m=Ne(w(e.Ea,e,t),dn(e,e.D)),e.D++,0)))}(e,t)||2==r&&an(e)))switch(n&&n.length>0&&(t=e.h,t.i=t.i.concat(n)),s){case 1:pn(e,5);break;case 4:pn(e,10);break;case 3:pn(e,6);break;default:pn(e,2)}}function dn(e,t){let n=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(n*=2),n*t}function pn(e,t){if(e.j.info("Error code "+t),2==t){var n=w(e.bb,e),r=e.Ua;const t=!r;r=new lt(r||"//www.google.com/images/cleardot.gif"),f.location&&"http"==f.location.protocol||ht(r,"https"),ft(r),t?function(e,t){const n=new Me;if(f.Image){const r=new Image;r.onload=v(Mt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=v(Mt,n,"TestLoadImage: error",!1,t,r),r.onabort=v(Mt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=v(Mt,n,"TestLoadImage: timeout",!1,t,r),f.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Me;const n=new AbortController,r=setTimeout(()=>{n.abort(),Mt(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?Mt(0,0,!0,t):Mt(0,0,!1,t)}).catch(()=>{clearTimeout(r),Mt(0,0,!1,t)})}(r.toString(),n)}else Pe(2);e.I=0,e.l&&e.l.pa(t),gn(e),en(e)}function gn(e){if(e.I=0,e.ja=[],e.l){const t=at(e.h);0==t.length&&0==e.i.length||(T(e.ja,t),T(e.ja,e.i),e.h.i.length=0,_(e.i),e.i.length=0),e.l.oa()}}function fn(e,t,n){var r=n instanceof lt?ut(n):new lt(n);if(""!=r.g)t&&(r.g=t+"."+r.g),dt(r,r.u);else{var s=f.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;const e=new lt(null);r&&ht(e,r),t&&(e.g=t),s&&dt(e,s),n&&(e.h=n),r=e}return n=e.G,t=e.wa,n&&t&&gt(r,n,t),gt(r,"VER",e.ka),rn(e,r),r}function mn(e,t,n){if(t&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Aa&&!e.ma?new jt(new Dt({ab:n})):new jt(e.ma)).Fa(e.L),t}function yn(){}function wn(){}function vn(e,t){ae.call(this),this.g=new Qt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e["X-WebChannel-Client-Profile"]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!U(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!U(t)&&(this.g.G=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new _n(this)}function In(e){Ee.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function En(){_e.call(this),this.status=1}function _n(e){this.g=e}(e=jt.prototype).Fa=function(e){this.H=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():De.g(),this.g.onreadystatechange=E(w(this.Ca,this));try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(e){return void Ht(this,e)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),s=f.FormData&&e instanceof f.FormData,!(Array.prototype.indexOf.call($t,t,void 0)>=0)||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[e,t]of n)this.g.setRequestHeader(e,t);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(e),this.v=!1}catch(e){Ht(this,e)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,ce(this,"complete"),ce(this,"abort"),Gt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gt(this,!0)),jt.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?zt(this):this.Xa())},e.Xa=function(){zt(this)},e.isActive=function(){return!!this.g},e.ca=function(){try{return Wt(this)>2?this.g.status:-1}catch(e){return-1}},e.la=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.La=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),me(t)}},e.ya=function(){return this.o},e.Ha=function(){return"string"==typeof this.l?this.l:String(this.l)},(e=Qt.prototype).ka=8,e.I=1,e.connect=function(e,t,n,r){Pe(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.J=fn(this,null,this.W),tn(this)},e.Ea=function(e){if(this.m)if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const s=new Ke(this,this.j,e);let i=this.o;if(this.U&&(i?(i=$(i),q(i,this.U)):i=this.U),null!==this.u||this.R||(s.J=i,i=null),this.S)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if((t+=r)>4096){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=sn(this,s,t),gt(n=ut(this.J),"RID",e),gt(n,"CVER",22),this.G&&gt(n,"X-HTTP-Session-Id",this.G),rn(this,n),i&&(this.R?t="headers="+Ve(Ft(i))+"&"+t:this.u&&Kt(n,this.u,i)),it(this.h,s),this.Ra&&gt(n,"TYPE","init"),this.S?(gt(n,"$req",t),gt(n,"SID","null"),s.U=!0,He(s,n,null)):He(s,n,t),this.I=2}}else 3==this.I&&(e?nn(this,e):0==this.i.length||nt(this.h)||nn(this))},e.Da=function(){if(this.v=null,ln(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=Ne(w(this.Wa,this),e)}},e.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Pe(10),Zt(this),ln(this))},e.Va=function(){null!=this.C&&(this.C=null,Zt(this),an(this),Pe(19))},e.bb=function(e){e?(this.j.info("Successfully pinged google.com"),Pe(2)):(this.j.info("Failed to ping google.com"),Pe(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=yn.prototype).ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){},wn.prototype.g=function(e,t){return new vn(e,t)},I(vn,ae),vn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},vn.prototype.close=function(){Xt(this.g)},vn.prototype.o=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=fe(e),e=n);t.i.push(new et(t.Ya++,e)),3==t.I&&tn(t)},vn.prototype.N=function(){this.g.l=null,delete this.j,Xt(this.g),delete this.g,vn.Z.N.call(this)},I(In,Ee),I(En,_e),I(_n,yn),_n.prototype.ra=function(){ce(this.g,"a")},_n.prototype.qa=function(e){ce(this.g,new In(e))},_n.prototype.pa=function(e){ce(this.g,new En)},_n.prototype.oa=function(){ce(this.g,"b")},wn.prototype.createWebChannel=wn.prototype.g,vn.prototype.send=vn.prototype.o,vn.prototype.open=vn.prototype.m,vn.prototype.close=vn.prototype.close,u=d.createWebChannelTransport=function(){return new wn},l=d.getStatEventTarget=function(){return Se()},c=d.Event=Te,a=d.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Le.NO_ERROR=0,Le.TIMEOUT=8,Le.HTTP_ERROR=6,o=d.ErrorCode=Le,Ue.COMPLETE="complete",i=d.EventType=Ue,ve.EventType=Ie,Ie.OPEN="a",Ie.CLOSE="b",Ie.ERROR="c",Ie.MESSAGE="d",ae.prototype.listen=ae.prototype.J,s=d.WebChannel=ve,d.FetchXmlHttpFactory=Dt,jt.prototype.listenOnce=jt.prototype.K,jt.prototype.getLastError=jt.prototype.Ha,jt.prototype.getLastErrorCode=jt.prototype.ya,jt.prototype.getStatus=jt.prototype.ca,jt.prototype.getResponseJson=jt.prototype.La,jt.prototype.getResponseText=jt.prototype.la,jt.prototype.send=jt.prototype.ea,jt.prototype.setWithCredentials=jt.prototype.Fa,r=d.XhrIo=jt}).apply(void 0!==h?h:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},2405:(e,t,n)=>{n.d(t,{aU:()=>r.aU,vN:()=>r.vN});var r=n(3552)},2429:(e,t,n)=>{n.d(t,{VV:()=>s,jz:()=>r});var r,s,i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},o={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}function n(e,t,n){n||(n=0);const r=Array(16);if("string"==typeof t)for(var s=0;s<16;++s)r[s]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(s=0;s<16;++s)r[s]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],s=e.g[2];let i,o=e.g[3];i=t+(o^n&(s^o))+r[0]+3614090360&4294967295,i=o+(s^(t=n+(i<<7&4294967295|i>>>25))&(n^s))+r[1]+3905402710&4294967295,o=t+(i<<12&4294967295|i>>>20),i=s+(n^o&(t^n))+r[2]+606105819&4294967295,i=n+(t^(s=o+(i<<17&4294967295|i>>>15))&(o^t))+r[3]+3250441966&4294967295,i=t+(o^(n=s+(i<<22&4294967295|i>>>10))&(s^o))+r[4]+4118548399&4294967295,i=o+(s^(t=n+(i<<7&4294967295|i>>>25))&(n^s))+r[5]+1200080426&4294967295,o=t+(i<<12&4294967295|i>>>20),i=s+(n^o&(t^n))+r[6]+2821735955&4294967295,i=n+(t^(s=o+(i<<17&4294967295|i>>>15))&(o^t))+r[7]+4249261313&4294967295,i=t+(o^(n=s+(i<<22&4294967295|i>>>10))&(s^o))+r[8]+1770035416&4294967295,i=o+(s^(t=n+(i<<7&4294967295|i>>>25))&(n^s))+r[9]+2336552879&4294967295,o=t+(i<<12&4294967295|i>>>20),i=s+(n^o&(t^n))+r[10]+4294925233&4294967295,i=n+(t^(s=o+(i<<17&4294967295|i>>>15))&(o^t))+r[11]+2304563134&4294967295,i=t+(o^(n=s+(i<<22&4294967295|i>>>10))&(s^o))+r[12]+1804603682&4294967295,i=o+(s^(t=n+(i<<7&4294967295|i>>>25))&(n^s))+r[13]+4254626195&4294967295,o=t+(i<<12&4294967295|i>>>20),i=s+(n^o&(t^n))+r[14]+2792965006&4294967295,i=n+(t^(s=o+(i<<17&4294967295|i>>>15))&(o^t))+r[15]+1236535329&4294967295,i=t+(s^o&((n=s+(i<<22&4294967295|i>>>10))^s))+r[1]+4129170786&4294967295,i=o+(n^s&((t=n+(i<<5&4294967295|i>>>27))^n))+r[6]+3225465664&4294967295,o=t+(i<<9&4294967295|i>>>23),i=s+(t^n&(o^t))+r[11]+643717713&4294967295,i=n+(o^t&((s=o+(i<<14&4294967295|i>>>18))^o))+r[0]+3921069994&4294967295,i=t+(s^o&((n=s+(i<<20&4294967295|i>>>12))^s))+r[5]+3593408605&4294967295,i=o+(n^s&((t=n+(i<<5&4294967295|i>>>27))^n))+r[10]+38016083&4294967295,o=t+(i<<9&4294967295|i>>>23),i=s+(t^n&(o^t))+r[15]+3634488961&4294967295,i=n+(o^t&((s=o+(i<<14&4294967295|i>>>18))^o))+r[4]+3889429448&4294967295,i=t+(s^o&((n=s+(i<<20&4294967295|i>>>12))^s))+r[9]+568446438&4294967295,i=o+(n^s&((t=n+(i<<5&4294967295|i>>>27))^n))+r[14]+3275163606&4294967295,o=t+(i<<9&4294967295|i>>>23),i=s+(t^n&(o^t))+r[3]+4107603335&4294967295,i=n+(o^t&((s=o+(i<<14&4294967295|i>>>18))^o))+r[8]+1163531501&4294967295,i=t+(s^o&((n=s+(i<<20&4294967295|i>>>12))^s))+r[13]+2850285829&4294967295,i=o+(n^s&((t=n+(i<<5&4294967295|i>>>27))^n))+r[2]+4243563512&4294967295,o=t+(i<<9&4294967295|i>>>23),i=s+(t^n&(o^t))+r[7]+1735328473&4294967295,i=n+(o^t&((s=o+(i<<14&4294967295|i>>>18))^o))+r[12]+2368359562&4294967295,i=t+((n=s+(i<<20&4294967295|i>>>12))^s^o)+r[5]+4294588738&4294967295,i=o+((t=n+(i<<4&4294967295|i>>>28))^n^s)+r[8]+2272392833&4294967295,o=t+(i<<11&4294967295|i>>>21),i=s+(o^t^n)+r[11]+1839030562&4294967295,i=n+((s=o+(i<<16&4294967295|i>>>16))^o^t)+r[14]+4259657740&4294967295,i=t+((n=s+(i<<23&4294967295|i>>>9))^s^o)+r[1]+2763975236&4294967295,i=o+((t=n+(i<<4&4294967295|i>>>28))^n^s)+r[4]+1272893353&4294967295,o=t+(i<<11&4294967295|i>>>21),i=s+(o^t^n)+r[7]+4139469664&4294967295,i=n+((s=o+(i<<16&4294967295|i>>>16))^o^t)+r[10]+3200236656&4294967295,i=t+((n=s+(i<<23&4294967295|i>>>9))^s^o)+r[13]+681279174&4294967295,i=o+((t=n+(i<<4&4294967295|i>>>28))^n^s)+r[0]+3936430074&4294967295,o=t+(i<<11&4294967295|i>>>21),i=s+(o^t^n)+r[3]+3572445317&4294967295,i=n+((s=o+(i<<16&4294967295|i>>>16))^o^t)+r[6]+76029189&4294967295,i=t+((n=s+(i<<23&4294967295|i>>>9))^s^o)+r[9]+3654602809&4294967295,i=o+((t=n+(i<<4&4294967295|i>>>28))^n^s)+r[12]+3873151461&4294967295,o=t+(i<<11&4294967295|i>>>21),i=s+(o^t^n)+r[15]+530742520&4294967295,i=n+((s=o+(i<<16&4294967295|i>>>16))^o^t)+r[2]+3299628645&4294967295,i=t+(s^((n=s+(i<<23&4294967295|i>>>9))|~o))+r[0]+4096336452&4294967295,i=o+(n^((t=n+(i<<6&4294967295|i>>>26))|~s))+r[7]+1126891415&4294967295,o=t+(i<<10&4294967295|i>>>22),i=s+(t^(o|~n))+r[14]+2878612391&4294967295,i=n+(o^((s=o+(i<<15&4294967295|i>>>17))|~t))+r[5]+4237533241&4294967295,i=t+(s^((n=s+(i<<21&4294967295|i>>>11))|~o))+r[12]+1700485571&4294967295,i=o+(n^((t=n+(i<<6&4294967295|i>>>26))|~s))+r[3]+2399980690&4294967295,o=t+(i<<10&4294967295|i>>>22),i=s+(t^(o|~n))+r[10]+4293915773&4294967295,i=n+(o^((s=o+(i<<15&4294967295|i>>>17))|~t))+r[1]+2240044497&4294967295,i=t+(s^((n=s+(i<<21&4294967295|i>>>11))|~o))+r[8]+1873313359&4294967295,i=o+(n^((t=n+(i<<6&4294967295|i>>>26))|~s))+r[15]+4264355552&4294967295,o=t+(i<<10&4294967295|i>>>22),i=s+(t^(o|~n))+r[6]+2734768916&4294967295,i=n+(o^((s=o+(i<<15&4294967295|i>>>17))|~t))+r[13]+1309151649&4294967295,i=t+(s^((n=s+(i<<21&4294967295|i>>>11))|~o))+r[4]+4149444226&4294967295,i=o+(n^((t=n+(i<<6&4294967295|i>>>26))|~s))+r[11]+3174756917&4294967295,o=t+(i<<10&4294967295|i>>>22),i=s+(t^(o|~n))+r[2]+718787259&4294967295,i=n+(o^((s=o+(i<<15&4294967295|i>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(s+(i<<21&4294967295|i>>>11))&4294967295,e.g[2]=e.g[2]+s&4294967295,e.g[3]=e.g[3]+o&4294967295}function i(e,t){this.h=t;const n=[];let r=!0;for(let s=e.length-1;s>=0;s--){const i=0|e[s];r&&i==t||(n[s]=i,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.F=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.D=function(e,n,r){for(var s=Array(arguments.length-2),i=2;i<arguments.length;i++)s[i-2]=arguments[i];return t.prototype[n].apply(e,s)}}(t,function(){this.blockSize=-1}),t.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.v=function(e,t){void 0===t&&(t=e.length);const r=t-this.blockSize,s=this.C;let i=this.h,o=0;for(;o<t;){if(0==i)for(;o<=r;)n(this,e,o),o+=this.blockSize;if("string"==typeof e){for(;o<t;)if(s[i++]=e.charCodeAt(o++),i==this.blockSize){n(this,s),i=0;break}}else for(;o<t;)if(s[i++]=e[o++],i==this.blockSize){n(this,s),i=0;break}}this.h=i,this.o+=t},t.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var n=e.length-8;n<e.length;++n)e[n]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,n=0;n<4;++n)for(let r=0;r<32;r+=8)e[t++]=this.g[n]>>>r&255;return e};var a={};function c(e){return-128<=e&&e<128?function(e){var t=a;return Object.prototype.hasOwnProperty.call(t,e)?t[e]:t[e]=function(e){return new i([0|e],e<0?-1:0)}(e)}(e):new i([0|e],e<0?-1:0)}function l(e){if(isNaN(e)||!isFinite(e))return u;if(e<0)return f(l(-e));const t=[];let n=1;for(let r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new i(t,0)}var u=c(0),h=c(1),d=c(16777216);function p(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function g(e){return-1==e.h}function f(e){const t=e.g.length,n=[];for(let r=0;r<t;r++)n[r]=~e.g[r];return new i(n,~e.h).add(h)}function m(e,t){return e.add(f(t))}function y(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function w(e,t){this.g=e,this.h=t}function v(e,t){if(p(t))throw Error("division by zero");if(p(e))return new w(u,u);if(g(e))return t=v(f(e),t),new w(f(t.g),f(t.h));if(g(t))return t=v(e,f(t)),new w(f(t.g),t.h);if(e.g.length>30){if(g(e)||g(t))throw Error("slowDivide_ only works with positive integers.");for(var n=h,r=t;r.l(e)<=0;)n=I(n),r=I(r);var s=E(n,1),i=E(r,1);for(r=E(r,2),n=E(n,2);!p(r);){var o=i.add(r);o.l(e)<=0&&(s=s.add(n),i=o),r=E(r,1),n=E(n,1)}return t=m(e,s.j(t)),new w(s,t)}for(s=u;e.l(t)>=0;){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=(r=Math.ceil(Math.log(n)/Math.LN2))<=48?1:Math.pow(2,r-48),o=(i=l(n)).j(t);g(o)||o.l(e)>0;)o=(i=l(n-=r)).j(t);p(i)&&(i=h),s=s.add(i),e=m(e,o)}return new w(s,e)}function I(e){const t=e.g.length+1,n=[];for(let r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new i(n,e.h)}function E(e,t){const n=t>>5;t%=32;const r=e.g.length-n,s=[];for(let i=0;i<r;i++)s[i]=t>0?e.i(i+n)>>>t|e.i(i+n+1)<<32-t:e.i(i+n);return new i(s,e.h)}(e=i.prototype).m=function(){if(g(this))return-f(this).m();let e=0,t=1;for(let n=0;n<this.g.length;n++){const r=this.i(n);e+=(r>=0?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(p(this))return"0";if(g(this))return"-"+f(this).toString(e);const t=l(Math.pow(e,6));var n=this;let r="";for(;;){const s=v(n,t).g;let i=(((n=m(n,s.j(t))).g.length>0?n.g[0]:n.h)>>>0).toString(e);if(p(n=s))return i+r;for(;i.length<6;)i="0"+i;r=i+r}},e.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return g(e=m(this,e))?-1:p(e)?0:1},e.abs=function(){return g(this)?f(this):this},e.add=function(e){const t=Math.max(this.g.length,e.g.length),n=[];let r=0;for(let s=0;s<=t;s++){let t=r+(65535&this.i(s))+(65535&e.i(s)),i=(t>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);r=i>>>16,t&=65535,i&=65535,n[s]=i<<16|t}return new i(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(p(this)||p(e))return u;if(g(this))return g(e)?f(this).j(f(e)):f(f(this).j(e));if(g(e))return f(this.j(f(e)));if(this.l(d)<0&&e.l(d)<0)return l(this.m()*e.m());const t=this.g.length+e.g.length,n=[];for(var r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(let t=0;t<e.g.length;t++){const s=this.i(r)>>>16,i=65535&this.i(r),o=e.i(t)>>>16,a=65535&e.i(t);n[2*r+2*t]+=i*a,y(n,2*r+2*t),n[2*r+2*t+1]+=s*a,y(n,2*r+2*t+1),n[2*r+2*t+1]+=i*o,y(n,2*r+2*t+1),n[2*r+2*t+2]+=s*o,y(n,2*r+2*t+2)}for(e=0;e<t;e++)n[e]=n[2*e+1]<<16|n[2*e];for(e=t;e<2*t;e++)n[e]=0;return new i(n,0)},e.B=function(e){return v(this,e).h},e.and=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new i(n,this.h&e.h)},e.or=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new i(n,this.h|e.h)},e.xor=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new i(n,this.h^e.h)},t.prototype.digest=t.prototype.A,t.prototype.reset=t.prototype.u,t.prototype.update=t.prototype.v,s=o.Md5=t,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.B,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=l,i.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if((n=n||10)<2||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return f(e(t.substring(1),n));if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character');const r=l(Math.pow(n,8));let s=u;for(let e=0;e<t.length;e+=8){var i=Math.min(8,t.length-e);const o=parseInt(t.substring(e,e+i),n);i<8?(i=l(Math.pow(n,i)),s=s.j(i).add(l(o))):(s=s.j(r),s=s.add(l(o)))}return s},r=o.Integer=i}).apply(void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},3070:(e,t,n)=>{n.d(t,{Gt:()=>r.a,xI:()=>o});var r=n(1026),s=n(9943),i=n(1625);function o(e=(0,s.Sx)()){const t=(0,s.j6)(e,"auth");if(t.isInitialized())return t.getImmediate();const n=(0,r.i)(e,{persistence:[r.a]}),o=(0,i.Tj)("auth");return o&&(0,r.c)(n,`http://${o}`),n}n(1711),n(722),(0,r.r)("WebExtension")},3552:(e,t,n)=>{n.d(t,{aU:()=>is,vN:()=>Qr});var r=n(9943),s=n(1711),i=n(722),o=n(1625),a=n(2429),c=n(1853);const l="@firebase/firestore",u="4.9.2";class h{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}h.UNAUTHENTICATED=new h(null),h.GOOGLE_CREDENTIALS=new h("google-credentials-uid"),h.FIRST_PARTY=new h("first-party-uid"),h.MOCK_USER=new h("mock-user");let d="12.3.0";const p=new i.Vy("@firebase/firestore");function g(){return p.logLevel}function f(e,...t){if(p.logLevel<=i.$b.DEBUG){const n=t.map(w);p.debug(`Firestore (${d}): ${e}`,...n)}}function m(e,...t){if(p.logLevel<=i.$b.ERROR){const n=t.map(w);p.error(`Firestore (${d}): ${e}`,...n)}}function y(e,...t){if(p.logLevel<=i.$b.WARN){const n=t.map(w);p.warn(`Firestore (${d}): ${e}`,...n)}}function w(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function v(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,I(e,r,n)}function I(e,t,n){let r=`FIRESTORE (${d}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw m(r),new Error(r)}function E(e,t,n,r){let s="Unexpected state";"string"==typeof n?s=n:r=n,e||I(t,s,r)}function _(e,t){return e}const T={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class A extends o.g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class S{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class b{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class C{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(h.UNAUTHENTICATED))}shutdown(){}}class R{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class P{constructor(e){this.t=e,this.currentUser=h.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){E(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let s=new S;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new S,e.enqueueRetryable(()=>r(this.currentUser))};const i=()=>{const t=s;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},o=e=>{f("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(f("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new S)}},0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(f("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(E("string"==typeof t.accessToken,31837,{l:t}),new b(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return E(null===e||"string"==typeof e,2055,{h:e}),new h(e)}}class k{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=h.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class N{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new k(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(h.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class M{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class O{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,(0,r.xZ)(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){E(void 0===this.o,3512);const n=e=>{null!=e.error&&f("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.m;return this.m=e.token,f("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{f("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):f("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new M(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(E("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new M(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function D(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}class L{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=D(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function U(e,t){return e<t?-1:e>t?1:0}function x(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.charAt(r),s=t.charAt(r);if(n!==s)return K(n)===K(s)?U(n,s):K(n)?1:-1}return U(e.length,t.length)}const V=55296,F=57343;function K(e){const t=e.charCodeAt(0);return t>=V&&t<=F}function j(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}const B="__name__";class ${constructor(e,t,n){void 0===t?t=0:t>e.length&&v(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&v(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===$.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof $?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=$.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return U(e.length,t.length)}static compareSegments(e,t){const n=$.isNumericId(e),r=$.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?$.extractNumericId(e).compare($.extractNumericId(t)):x(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return a.jz.fromString(e.substring(4,e.length-2))}}class H extends ${construct(e,t,n){return new H(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new A(T.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(e=>e.length>0))}return new H(t)}static emptyPath(){return new H([])}}const q=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class z extends ${construct(e,t,n){return new z(e,t,n)}static isValidIdentifier(e){return q.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),z.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===B}static keyField(){return new z([B])}static fromServerFormat(e){const t=[];let n="",r=0;const s=()=>{if(0===n.length)throw new A(T.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let i=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new A(T.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new A(T.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(i=!i,r++):"."!==t||i?(n+=t,r++):(s(),r++)}if(s(),i)throw new A(T.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new z(t)}static emptyPath(){return new z([])}}class G{constructor(e){this.path=e}static fromPath(e){return new G(H.fromString(e))}static fromName(e){return new G(H.fromString(e).popFirst(5))}static empty(){return new G(H.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===H.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return H.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new G(new H(e.slice()))}}function W(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new A(T.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=function(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":v(12329,{type:typeof e})}(e);throw new A(T.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Y(e,t){const n={typeString:e};return t&&(n.value=t),n}function J(e,t){if(!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(e))throw new A(T.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const s=t[r].typeString,i="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}const o=e[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(void 0!==i&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new A(T.INVALID_ARGUMENT,n);return!0}const Q=-62135596800,X=1e6;class Z{static now(){return Z.fromMillis(Date.now())}static fromDate(e){return Z.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*X);return new Z(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new A(T.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new A(T.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Q)throw new A(T.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new A(T.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/X}_compareTo(e){return this.seconds===e.seconds?U(this.nanoseconds,e.nanoseconds):U(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Z._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(J(e,Z._jsonSchema))return new Z(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Q;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Z._jsonSchemaVersion="firestore/timestamp/1.0",Z._jsonSchema={type:Y("string",Z._jsonSchemaVersion),seconds:Y("number"),nanoseconds:Y("number")};class ee{static fromTimestamp(e){return new ee(e)}static min(){return new ee(new Z(0,0))}static max(){return new ee(new Z(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function te(e){return new ne(e.readTime,e.key,-1)}class ne{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new ne(ee.min(),G.empty(),-1)}static max(){return new ne(ee.max(),G.empty(),-1)}}function re(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=G.comparator(e.documentKey,t.documentKey),0!==n?n:U(e.largestBatchId,t.largestBatchId))}class se{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}class ie{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&v(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ie((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ie?t:ie.resolve(t)}catch(e){return ie.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ie.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ie.reject(t)}static resolve(e){return new ie((t,n)=>{t(e)})}static reject(e){return new ie((t,n)=>{n(e)})}static waitFor(e){return new ie((t,n)=>{let r=0,s=0,i=!1;e.forEach(e=>{++r,e.next(()=>{++s,i&&s===r&&t()},e=>n(e))}),i=!0,s===r&&t()})}static or(e){let t=ie.resolve(!1);for(const n of e)t=t.next(e=>e?ie.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new ie((n,r)=>{const s=e.length,i=new Array(s);let o=0;for(let a=0;a<s;a++){const c=a;t(e[c]).next(e=>{i[c]=e,++o,o===s&&n(i)},e=>r(e))}})}static doWhile(e,t){return new ie((n,r)=>{const s=()=>{!0===e()?t().next(()=>{s()},r):n()};s()})}}function oe(e){return"IndexedDbTransactionError"===e.name}class ae{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ae.ce=-1;function ce(e){return null==e}function le(e){return 0===e&&1/e==-1/0}const ue="owner",he="mutationQueues",de="mutations",pe="documentMutations",ge="remoteDocumentGlobal",fe="targets",me="targetDocuments",ye="targetGlobal",we="collectionParents",ve="clientMetadata",Ie="bundles",Ee="namedQueries";function _e(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Te(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}class Ae{constructor(e,t){this.comparator=e,this.root=t||be.EMPTY}insert(e,t){return new Ae(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,be.BLACK,null,null))}remove(e){return new Ae(this.comparator,this.root.remove(e,this.comparator).copy(null,null,be.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Se(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Se(this.root,e,this.comparator,!1)}getReverseIterator(){return new Se(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Se(this.root,e,this.comparator,!0)}}class Se{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class be{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=null!=n?n:be.RED,this.left=null!=r?r:be.EMPTY,this.right=null!=s?s:be.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new be(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return be.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return be.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,be.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,be.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw v(43730,{key:this.key,value:this.value});if(this.right.isRed())throw v(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw v(27949);return e+(this.isRed()?0:1)}}be.EMPTY=null,be.RED=!0,be.BLACK=!1,be.EMPTY=new class{constructor(){this.size=0}get key(){throw v(57766)}get value(){throw v(16141)}get color(){throw v(16727)}get left(){throw v(29726)}get right(){throw v(36894)}copy(e,t,n,r,s){return this}insert(e,t,n){return new be(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ce{constructor(e){this.comparator=e,this.data=new Ae(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Re(this.data.getIterator())}getIteratorFrom(e){return new Re(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Ce))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ce(this.comparator);return t.data=e,t}}class Re{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Pe{constructor(e){this.fields=e,e.sort(z.comparator)}static empty(){return new Pe([])}unionWith(e){let t=new Ce(z.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new Pe(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return j(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class ke extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ne{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new ke("Invalid base64 string: "+e):e}}(e);return new Ne(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Ne(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return U(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ne.EMPTY_BYTE_STRING=new Ne("");const Me=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Oe(e){if(E(!!e,39018),"string"==typeof e){let t=0;const n=Me.exec(e);if(E(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:De(e.seconds),nanos:De(e.nanos)}}function De(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Le(e){return"string"==typeof e?Ne.fromBase64String(e):Ne.fromUint8Array(e)}const Ue="server_timestamp",xe="__type__",Ve="__previous_value__",Fe="__local_write_time__";function Ke(e){const t=(e?.mapValue?.fields||{})[xe]?.stringValue;return t===Ue}function je(e){const t=e.mapValue.fields[Ve];return Ke(t)?je(t):t}function Be(e){const t=Oe(e.mapValue.fields[Fe].timestampValue);return new Z(t.seconds,t.nanos)}const $e="(default)";class He{constructor(e,t){this.projectId=e,this.database=t||$e}static empty(){return new He("","")}get isDefaultDatabase(){return this.database===$e}isEqual(e){return e instanceof He&&e.projectId===this.projectId&&e.database===this.database}}const qe="__max__",ze={fields:{__type__:{stringValue:qe}}},Ge="value";function We(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ke(e)?4:at(e)?9007199254740991:it(e)?10:11:v(28295,{value:e})}function Ye(e,t){if(e===t)return!0;const n=We(e);if(n!==We(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Be(e).isEqual(Be(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Oe(e.timestampValue),r=Oe(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Le(e.bytesValue).isEqual(Le(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return De(e.geoPointValue.latitude)===De(t.geoPointValue.latitude)&&De(e.geoPointValue.longitude)===De(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return De(e.integerValue)===De(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=De(e.doubleValue),r=De(t.doubleValue);return n===r?le(n)===le(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return j(e.arrayValue.values||[],t.arrayValue.values||[],Ye);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(_e(n)!==_e(r))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!Ye(n[e],r[e])))return!1;return!0}(e,t);default:return v(52216,{left:e})}}function Je(e,t){return void 0!==(e.values||[]).find(e=>Ye(e,t))}function Qe(e,t){if(e===t)return 0;const n=We(e),r=We(t);if(n!==r)return U(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return U(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=De(e.integerValue||e.doubleValue),r=De(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Xe(e.timestampValue,t.timestampValue);case 4:return Xe(Be(e),Be(t));case 5:return x(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Le(e),r=Le(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){const t=U(n[e],r[e]);if(0!==t)return t}return U(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=U(De(e.latitude),De(t.latitude));return 0!==n?n:U(De(e.longitude),De(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Ze(e.arrayValue,t.arrayValue);case 10:return function(e,t){const n=e.fields||{},r=t.fields||{},s=n[Ge]?.arrayValue,i=r[Ge]?.arrayValue,o=U(s?.values?.length||0,i?.values?.length||0);return 0!==o?o:Ze(s,i)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===ze&&t===ze)return 0;if(e===ze)return 1;if(t===ze)return-1;const n=e.fields||{},r=Object.keys(n),s=t.fields||{},i=Object.keys(s);r.sort(),i.sort();for(let e=0;e<r.length&&e<i.length;++e){const t=x(r[e],i[e]);if(0!==t)return t;const o=Qe(n[r[e]],s[i[e]]);if(0!==o)return o}return U(r.length,i.length)}(e.mapValue,t.mapValue);default:throw v(23264,{he:n})}}function Xe(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return U(e,t);const n=Oe(e),r=Oe(t),s=U(n.seconds,r.seconds);return 0!==s?s:U(n.nanos,r.nanos)}function Ze(e,t){const n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){const t=Qe(n[e],r[e]);if(t)return t}return U(n.length,r.length)}function et(e){return tt(e)}function tt(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Oe(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Le(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return G.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=tt(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const s of t)r?r=!1:n+=",",n+=`${s}:${tt(e.fields[s])}`;return n+"}"}(e.mapValue):v(61005,{value:e})}function nt(e){return!!e&&"integerValue"in e}function rt(e){return!!e&&"arrayValue"in e}function st(e){return!!e&&"mapValue"in e}function it(e){const t=(e?.mapValue?.fields||{}).__type__?.stringValue;return"__vector__"===t}function ot(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:{...e.timestampValue}};if(e.mapValue){const t={mapValue:{fields:{}}};return Te(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=ot(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=ot(e.arrayValue.values[n]);return t}return{...e}}function at(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===qe}class ct{constructor(e){this.value=e}static empty(){return new ct({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!st(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ot(t)}setAll(e){let t=z.emptyPath(),n={},r=[];e.forEach((e,s)=>{if(!t.isImmediateParentOf(s)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=s.popLast()}e?n[s.lastSegment()]=ot(e):r.push(s.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){const t=this.field(e.popLast());st(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ye(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];st(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Te(t,(t,n)=>e[t]=n);for(const t of n)delete e[t]}clone(){return new ct(ot(this.value))}}class lt{constructor(e,t,n,r,s,i,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=s,this.data=i,this.documentState=o}static newInvalidDocument(e){return new lt(e,0,ee.min(),ee.min(),ee.min(),ct.empty(),0)}static newFoundDocument(e,t,n,r){return new lt(e,1,t,ee.min(),n,r,0)}static newNoDocument(e,t){return new lt(e,2,t,ee.min(),ee.min(),ct.empty(),0)}static newUnknownDocument(e,t){return new lt(e,3,t,ee.min(),ee.min(),ct.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ee.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ct.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ct.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ee.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof lt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new lt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class ut{constructor(e,t){this.position=e,this.inclusive=t}}function ht(e,t,n){let r=0;for(let s=0;s<e.position.length;s++){const i=t[s],o=e.position[s];if(r=i.field.isKeyField()?G.comparator(G.fromName(o.referenceValue),n.key):Qe(o,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function dt(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Ye(e.position[n],t.position[n]))return!1;return!0}class pt{constructor(e,t="asc"){this.field=e,this.dir=t}}function gt(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class ft{}class mt extends ft{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Tt(e,t,n):"array-contains"===t?new Ct(e,n):"in"===t?new Rt(e,n):"not-in"===t?new Pt(e,n):"array-contains-any"===t?new kt(e,n):new mt(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new At(e,n):new St(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(Qe(t,this.value)):null!==t&&We(this.value)===We(t)&&this.matchesComparison(Qe(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return v(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class yt extends ft{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new yt(e,t)}matches(e){return wt(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function wt(e){return"and"===e.op}function vt(e){return function(e){for(const t of e.filters)if(t instanceof yt)return!1;return!0}(e)&&wt(e)}function It(e){if(e instanceof mt)return e.field.canonicalString()+e.op.toString()+et(e.value);if(vt(e))return e.filters.map(e=>It(e)).join(",");{const t=e.filters.map(e=>It(e)).join(",");return`${e.op}(${t})`}}function Et(e,t){return e instanceof mt?function(e,t){return t instanceof mt&&e.op===t.op&&e.field.isEqual(t.field)&&Ye(e.value,t.value)}(e,t):e instanceof yt?function(e,t){return t instanceof yt&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&Et(n,t.filters[r]),!0)}(e,t):void v(19439)}function _t(e){return e instanceof mt?function(e){return`${e.field.canonicalString()} ${e.op} ${et(e.value)}`}(e):e instanceof yt?function(e){return e.op.toString()+" {"+e.getFilters().map(_t).join(" ,")+"}"}(e):"Filter"}class Tt extends mt{constructor(e,t,n){super(e,t,n),this.key=G.fromName(n.referenceValue)}matches(e){const t=G.comparator(e.key,this.key);return this.matchesComparison(t)}}class At extends mt{constructor(e,t){super(e,"in",t),this.keys=bt(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class St extends mt{constructor(e,t){super(e,"not-in",t),this.keys=bt(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function bt(e,t){return(t.arrayValue?.values||[]).map(e=>G.fromName(e.referenceValue))}class Ct extends mt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return rt(t)&&Je(t.arrayValue,this.value)}}class Rt extends mt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Je(this.value.arrayValue,t)}}class Pt extends mt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Je(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!Je(this.value.arrayValue,t)}}class kt extends mt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!rt(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Je(this.value.arrayValue,e))}}class Nt{constructor(e,t=null,n=[],r=[],s=null,i=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=i,this.endAt=o,this.Te=null}}function Mt(e,t=null,n=[],r=[],s=null,i=null,o=null){return new Nt(e,t,n,r,s,i,o)}function Ot(e){const t=_(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>It(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),ce(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>et(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>et(e)).join(",")),t.Te=e}return t.Te}function Dt(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!gt(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Et(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!dt(e.startAt,t.startAt)&&dt(e.endAt,t.endAt)}class Lt{constructor(e,t=null,n=[],r=[],s=null,i="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=i,this.startAt=o,this.endAt=a,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Ut(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function xt(e){const t=_(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const n of t.explicitOrderBy)t.Ie.push(n),e.add(n.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Ce(z.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new pt(r,n))}),e.has(z.keyField().canonicalString())||t.Ie.push(new pt(z.keyField(),n))}return t.Ie}function Vt(e){const t=_(e);return t.Ee||(t.Ee=function(e,t){if("F"===e.limitType)return Mt(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new pt(e.field,t)});const n=e.endAt?new ut(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new ut(e.startAt.position,e.startAt.inclusive):null;return Mt(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}(t,xt(e))),t.Ee}function Ft(e,t,n){return new Lt(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Kt(e,t){return Dt(Vt(e),Vt(t))&&e.limitType===t.limitType}function jt(e){return`${Ot(Vt(e))}|lt:${e.limitType}`}function Bt(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>_t(e)).join(", ")}]`),ce(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>et(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>et(e)).join(",")),`Target(${t})`}(Vt(e))}; limitType=${e.limitType})`}function $t(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):G.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of xt(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=ht(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,xt(e),t)||e.endAt&&!function(e,t,n){const r=ht(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,xt(e),t))}(e,t)}function Ht(e,t,n){const r=e.field.isKeyField()?G.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),s=n.data.field(e);return null!==r&&null!==s?Qe(r,s):v(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return v(19790,{direction:e.dir})}}class qt{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Te(this.inner,(t,n)=>{for(const[t,r]of n)e(t,r)})}isEmpty(){return function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(this.inner)}size(){return this.innerSize}}const zt=new Ae(G.comparator);function Gt(){return zt}const Wt=new Ae(G.comparator);function Yt(...e){let t=Wt;for(const n of e)t=t.insert(n.key,n);return t}function Jt(e){let t=Wt;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function Qt(){return Zt()}function Xt(){return Zt()}function Zt(){return new qt(e=>e.toString(),(e,t)=>e.isEqual(t))}new Ae(G.comparator);const en=new Ce(G.comparator);function tn(...e){let t=en;for(const n of e)t=t.add(n);return t}const nn=new Ce(U);class rn{constructor(){this._=void 0}}function sn(e,t,n){return e instanceof an?function(e,t){const n={fields:{[xe]:{stringValue:Ue},[Fe]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Ke(t)&&(t=je(t)),t&&(n.fields[Ve]=t),{mapValue:n}}(n,t):e instanceof cn?ln(e,t):e instanceof un?hn(e,t):function(e,t){const n=function(e,t){return e instanceof dn?function(e){return nt(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}(e,t),r=pn(n)+pn(e.Ae);return nt(n)&&nt(e.Ae)?function(e){return{integerValue:""+e}}(r):function(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:le(t)?"-0":t}}(e.serializer,r)}(e,t)}function on(e,t,n){return e instanceof cn?ln(e,t):e instanceof un?hn(e,t):n}class an extends rn{}class cn extends rn{constructor(e){super(),this.elements=e}}function ln(e,t){const n=gn(t);for(const t of e.elements)n.some(e=>Ye(e,t))||n.push(t);return{arrayValue:{values:n}}}class un extends rn{constructor(e){super(),this.elements=e}}function hn(e,t){let n=gn(t);for(const t of e.elements)n=n.filter(e=>!Ye(e,t));return{arrayValue:{values:n}}}class dn extends rn{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function pn(e){return De(e.integerValue||e.doubleValue)}function gn(e){return rt(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class fn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new fn}static exists(e){return new fn(void 0,e)}static updateTime(e){return new fn(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function mn(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class yn{}function wn(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Cn(e.key,fn.none()):new _n(e.key,e.data,fn.none());{const n=e.data,r=ct.empty();let s=new Ce(z.comparator);for(let e of t.fields)if(!s.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),s=s.add(e)}return new Tn(e.key,r,new Pe(s.toArray()),fn.none())}}function vn(e,t,n){e instanceof _n?function(e,t,n){const r=e.value.clone(),s=Sn(e.fieldTransforms,t,n.transformResults);r.setAll(s),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Tn?function(e,t,n){if(!mn(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Sn(e.fieldTransforms,t,n.transformResults),s=t.data;s.setAll(An(e)),s.setAll(r),t.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function In(e,t,n,r){return e instanceof _n?function(e,t,n,r){if(!mn(e.precondition,t))return n;const s=e.value.clone(),i=bn(e.fieldTransforms,r,t);return s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null}(e,t,n,r):e instanceof Tn?function(e,t,n,r){if(!mn(e.precondition,t))return n;const s=bn(e.fieldTransforms,r,t),i=t.data;return i.setAll(An(e)),i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return mn(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function En(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&j(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof cn&&t instanceof cn||e instanceof un&&t instanceof un?j(e.elements,t.elements,Ye):e instanceof dn&&t instanceof dn?Ye(e.Ae,t.Ae):e instanceof an&&t instanceof an}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class _n extends yn{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Tn extends yn{constructor(e,t,n,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function An(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function Sn(e,t,n){const r=new Map;E(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let s=0;s<n.length;s++){const i=e[s],o=i.transform,a=t.data.field(i.field);r.set(i.field,on(o,a,n[s]))}return r}function bn(e,t,n){const r=new Map;for(const s of e){const e=s.transform,i=n.data.field(s.field);r.set(s.field,sn(e,i,t))}return r}class Cn extends yn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Rn{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const r=this.mutations[t];r.key.isEqual(e.key)&&vn(r,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=In(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=In(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Xt();return this.mutations.forEach(r=>{const s=e.get(r.key),i=s.overlayedDocument;let o=this.applyToLocalView(i,s.mutatedFields);o=t.has(r.key)?null:o;const a=wn(i,o);null!==a&&n.set(r.key,a),i.isValidDocument()||i.convertToNoDocument(ee.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),tn())}isEqual(e){return this.batchId===e.batchId&&j(this.mutations,e.mutations,(e,t)=>En(e,t))&&j(this.baseMutations,e.baseMutations,(e,t)=>En(e,t))}}class Pn{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}var kn,Nn;(Nn=kn||(kn={}))[Nn.OK=0]="OK",Nn[Nn.CANCELLED=1]="CANCELLED",Nn[Nn.UNKNOWN=2]="UNKNOWN",Nn[Nn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Nn[Nn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Nn[Nn.NOT_FOUND=5]="NOT_FOUND",Nn[Nn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Nn[Nn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Nn[Nn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Nn[Nn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Nn[Nn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Nn[Nn.ABORTED=10]="ABORTED",Nn[Nn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Nn[Nn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Nn[Nn.INTERNAL=13]="INTERNAL",Nn[Nn.UNAVAILABLE=14]="UNAVAILABLE",Nn[Nn.DATA_LOSS=15]="DATA_LOSS",new a.jz([4294967295,4294967295],0),Error;class Mn{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function On(e){return E(!!e,49232),ee.fromTimestamp(function(e){const t=Oe(e);return new Z(t.seconds,t.nanos)}(e))}function Dn(e,t){const n=function(e){return new H(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Ln(e){const t=function(e){const t=H.fromString(e);return E(function(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}(t),10190,{key:t.toString()}),t}(e);return 4===t.length?H.emptyPath():function(e){return E(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}(t)}function Un(e){let t=Ln(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){E(1===r,65062);const e=n.from[0];e.allDescendants?s=e.collectionId:t=t.child(e.collectionId)}let i=[];n.where&&(i=function(e){const t=xn(e);return t instanceof yt&&vt(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map(e=>function(e){return new pt(Vn(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,ce(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new ut(n,t)}(n.startAt));let l=null;return n.endAt&&(l=function(e){const t=!e.before,n=e.values||[];return new ut(n,t)}(n.endAt)),function(e,t,n,r,s,i,o,a){return new Lt(e,t,n,r,s,i,o,a)}(t,s,o,i,a,"F",c,l)}function xn(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Vn(e.unaryFilter.field);return mt.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Vn(e.unaryFilter.field);return mt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Vn(e.unaryFilter.field);return mt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Vn(e.unaryFilter.field);return mt.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return v(61313);default:return v(60726)}}(e):void 0!==e.fieldFilter?function(e){return mt.create(Vn(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return v(58110);default:return v(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return yt.create(e.compositeFilter.filters.map(e=>xn(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return v(1026)}}(e.compositeFilter.op))}(e):v(30097,{filter:e})}function Vn(e){return z.fromServerFormat(e.fieldPath)}class Fn{constructor(e){this.yt=e}}function Kn(e){const t=Un({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Ft(t,t.limit,"L"):t}class jn{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(De(e.integerValue));else if("doubleValue"in e){const n=De(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),le(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),"string"==typeof n&&(n=Oe(n)),t.xt(`${n.seconds||""}`),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Le(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?at(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):it(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):v(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const e of Object.keys(n))this.Ot(e,t),this.Ct(n[e],t)}kt(e,t){const n=e.fields||{};this.Ft(t,53);const r=Ge,s=n[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(De(s)),this.Ot(r,t),this.Ct(n[r],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const e of n)this.Ct(e,t)}Lt(e,t){this.Ft(t,37),G.fromName(e).path.forEach(e=>{this.Ft(t,60),this.Ut(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}jn.Kt=new jn;class Bn{constructor(){this.Cn=new $n}addToCollectionParentIndex(e,t){return this.Cn.add(t),ie.resolve()}getCollectionParents(e,t){return ie.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ie.resolve()}deleteFieldIndex(e,t){return ie.resolve()}deleteAllFieldIndexes(e){return ie.resolve()}createTargetIndexes(e,t){return ie.resolve()}getDocumentsMatchingTarget(e,t){return ie.resolve(null)}getIndexType(e,t){return ie.resolve(0)}getFieldIndexes(e,t){return ie.resolve([])}getNextCollectionGroupToUpdate(e){return ie.resolve(null)}getMinOffset(e,t){return ie.resolve(ne.min())}getMinOffsetFromCollectionGroup(e,t){return ie.resolve(ne.min())}updateCollectionGroup(e,t,n){return ie.resolve()}updateIndexEntries(e,t){return ie.resolve()}}class $n{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Ce(H.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Ce(H.comparator)).toArray()}}new Uint8Array(0);const Hn=41943040;class qn{static withCacheSize(e){return new qn(e,qn.DEFAULT_COLLECTION_PERCENTILE,qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}qn.DEFAULT_COLLECTION_PERCENTILE=10,qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qn.DEFAULT=new qn(Hn,qn.DEFAULT_COLLECTION_PERCENTILE,qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qn.DISABLED=new qn(-1,0,0);class zn{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new zn(0)}static cr(){return new zn(-1)}}class Gn{constructor(){this.changes=new qt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,lt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?ie.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Wn{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Yn{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&In(n.mutation,e,Pe.empty(),Z.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,tn()).next(()=>t))}getLocalViewOfDocuments(e,t,n=tn()){const r=Qt();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=Yt();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=Qt();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,tn()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let s=Gt();const i=Zt(),o=Zt();return t.forEach((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Tn)?s=s.insert(t.key,t):void 0!==o?(i.set(t.key,o.mutation.getFieldMask()),In(o.mutation,t,o.mutation.getFieldMask(),Z.now())):i.set(t.key,Pe.empty())}),this.recalculateAndSaveOverlays(e,s).next(e=>(e.forEach((e,t)=>i.set(e,t)),t.forEach((e,t)=>o.set(e,new Wn(t,i.get(e)??null))),o))}recalculateAndSaveOverlays(e,t){const n=Zt();let r=new Ae((e,t)=>e-t),s=tn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const s of e)s.keys().forEach(e=>{const i=t.get(e);if(null===i)return;let o=n.get(e)||Pe.empty();o=s.applyToLocalView(i,o),n.set(e,o);const a=(r.get(s.batchId)||tn()).add(e);r=r.insert(s.batchId,a)})}).next(()=>{const i=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,l=Xt();c.forEach(e=>{if(!s.has(e)){const r=wn(t.get(e),n.get(e));null!==r&&l.set(e,r),s=s.add(e)}}),i.push(this.documentOverlayCache.saveOverlays(e,a,l))}return ie.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return G.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):function(e){return null!==e.collectionGroup}(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(s=>{const i=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):ie.resolve(Qt());let o=-1,a=s;return i.next(t=>ie.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),s.get(t)?ie.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,s)).next(()=>this.computeViews(e,a,t,tn())).next(e=>({batchId:o,changes:Jt(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new G(t)).next(e=>{let t=Yt();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const s=t.collectionGroup;let i=Yt();return this.indexManager.getCollectionParents(e,s).next(o=>ie.forEach(o,o=>{const a=function(e,t){return new Lt(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(s));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next(e=>{e.forEach((e,t)=>{i=i.insert(e,t)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,r))).next(e=>{s.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,lt.newInvalidDocument(r)))});let n=Yt();return e.forEach((e,r)=>{const i=s.get(e);void 0!==i&&In(i.mutation,r,Pe.empty(),Z.now()),$t(t,r)&&(n=n.insert(e,r))}),n})}}class Jn{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ie.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:On(e.createTime)}}(t)),ie.resolve()}getNamedQuery(e,t){return ie.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:Kn(e.bundledQuery),readTime:On(e.readTime)}}(t)),ie.resolve()}}class Qn{constructor(){this.overlays=new Ae(G.comparator),this.qr=new Map}getOverlay(e,t){return ie.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Qt();return ie.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.St(e,t,r)}),ie.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(n)),ie.resolve()}getOverlaysForCollection(e,t,n){const r=Qt(),s=t.length+1,i=new G(t.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const e=o.getNext().value,i=e.getKey();if(!t.isPrefixOf(i.path))break;i.path.length===s&&e.largestBatchId>n&&r.set(e.getKey(),e)}return ie.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new Ae((e,t)=>e-t);const i=this.overlays.getIterator();for(;i.hasNext();){const e=i.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=s.get(e.largestBatchId);null===t&&(t=Qt(),s=s.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Qt(),a=s.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=r)););return ie.resolve(o)}St(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Pn(t,n));let s=this.qr.get(t);void 0===s&&(s=tn(),this.qr.set(t,s)),this.qr.set(t,s.add(n.key))}}class Xn{constructor(){this.sessionToken=Ne.EMPTY_BYTE_STRING}getSessionToken(e){return ie.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ie.resolve()}}class Zn{constructor(){this.Qr=new Ce(er.$r),this.Ur=new Ce(er.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new er(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new er(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new G(new H([])),n=new er(t,e),r=new er(t,e+1),s=[];return this.Ur.forEachInRange([n,r],e=>{this.Gr(e),s.push(e.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new G(new H([])),n=new er(t,e),r=new er(t,e+1);let s=tn();return this.Ur.forEachInRange([n,r],e=>{s=s.add(e.key)}),s}containsKey(e){const t=new er(e,0),n=this.Qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class er{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return G.comparator(e.key,t.key)||U(e.Yr,t.Yr)}static Kr(e,t){return U(e.Yr,t.Yr)||G.comparator(e.key,t.key)}}class tr{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ce(er.$r)}checkEmpty(e){return ie.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new Rn(s,t,n,r);this.mutationQueue.push(i);for(const t of r)this.Zr=this.Zr.add(new er(t.key,s)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return ie.resolve(i)}lookupMutationBatch(e,t){return ie.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),s=r<0?0:r;return ie.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ie.resolve(0===this.mutationQueue.length?-1:this.tr-1)}getAllMutationBatches(e){return ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new er(t,0),r=new er(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([n,r],e=>{const t=this.Xr(e.Yr);s.push(t)}),ie.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ce(U);return t.forEach(e=>{const t=new er(e,0),r=new er(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,r],e=>{n=n.add(e.Yr)})}),ie.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let s=n;G.isDocumentKey(s)||(s=s.child(""));const i=new er(new G(s),0);let o=new Ce(U);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.Yr)),!0)},i),ie.resolve(this.ti(o))}ti(e){const t=[];return e.forEach(e=>{const n=this.Xr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){E(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return ie.forEach(t.mutations,r=>{const s=new er(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new er(t,0),r=this.Zr.firstAfterOrEqual(n);return ie.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ie.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class nr{constructor(e){this.ri=e,this.docs=new Ae(G.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),s=r?r.size:0,i=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ie.resolve(n?n.document.mutableCopy():lt.newInvalidDocument(t))}getEntries(e,t){let n=Gt();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():lt.newInvalidDocument(e))}),ie.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let s=Gt();const i=t.path,o=new G(i.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!i.isPrefixOf(e.path))break;e.path.length>i.length+1||re(te(o),n)<=0||(r.has(o.key)||$t(t,o))&&(s=s.insert(o.key,o.mutableCopy()))}return ie.resolve(s)}getAllFromCollectionGroup(e,t,n,r){v(9500)}ii(e,t){return ie.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new rr(this)}getSize(e){return ie.resolve(this.size)}}class rr extends Gn{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),ie.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class sr{constructor(e){this.persistence=e,this.si=new qt(e=>Ot(e),Dt),this.lastRemoteSnapshotVersion=ee.min(),this.highestTargetId=0,this.oi=0,this._i=new Zn,this.targetCount=0,this.ai=zn.ur()}forEachTarget(e,t){return this.si.forEach((e,n)=>t(n)),ie.resolve()}getLastRemoteSnapshotVersion(e){return ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ie.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ie.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),ie.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new zn(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ie.resolve()}updateTargetData(e,t){return this.Pr(t),ie.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ie.resolve()}removeTargets(e,t,n){let r=0;const s=[];return this.si.forEach((i,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.si.delete(i),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),ie.waitFor(s).next(()=>r)}getTargetCount(e){return ie.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return ie.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),ie.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(t=>{s.push(r.markPotentiallyOrphaned(e,t))}),ie.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ie.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return ie.resolve(n)}containsKey(e,t){return ie.resolve(this._i.containsKey(t))}}class ir{constructor(e,t){this.ui={},this.overlays={},this.ci=new ae(0),this.li=!1,this.li=!0,this.hi=new Xn,this.referenceDelegate=e(this),this.Pi=new sr(this),this.indexManager=new Bn,this.remoteDocumentCache=function(e){return new nr(e)}(e=>this.referenceDelegate.Ti(e)),this.serializer=new Fn(t),this.Ii=new Jn(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Qn,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new tr(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){f("MemoryPersistence","Starting transaction:",e);const r=new or(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ai(e,t){return ie.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class or extends se{constructor(e){super(),this.currentSequenceNumber=e}}class ar{constructor(e){this.persistence=e,this.Ri=new Zn,this.Vi=null}static mi(e){return new ar(e)}get fi(){if(this.Vi)return this.Vi;throw v(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),ie.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),ie.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ie.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ie.forEach(this.fi,n=>{const r=G.fromPath(n);return this.gi(e,r).next(e=>{e||t.removeEntry(r,ee.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return ie.or([()=>ie.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class cr{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=tn(),r=tn();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new cr(e,t.fromCache,n,r)}}class lr{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class ur{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(0,o.nr)()?8:function(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}((0,o.ZQ)())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const s={result:null};return this.ys(e,t).next(e=>{s.result=e}).next(()=>{if(!s.result)return this.ws(e,t,r,n).next(e=>{s.result=e})}).next(()=>{if(s.result)return;const n=new lr;return this.Ss(e,t,n).next(r=>{if(s.result=r,this.Vs)return this.bs(e,t,n,r.size)})}).next(()=>s.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(g()<=i.$b.DEBUG&&f("QueryEngine","SDK will not create cache indexes for query:",Bt(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ie.resolve()):(g()<=i.$b.DEBUG&&f("QueryEngine","Query:",Bt(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(g()<=i.$b.DEBUG&&f("QueryEngine","The SDK decides to create cache indexes for query:",Bt(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Vt(t))):ie.resolve())}ys(e,t){if(Ut(t))return ie.resolve(null);let n=Vt(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=Ft(t,null,"F"),n=Vt(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const s=tn(...r);return this.ps.getDocuments(e,s).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const i=this.Ds(t,r);return this.Cs(t,i,s,n.readTime)?this.ys(e,Ft(t,null,"F")):this.vs(e,i,t,n)}))})))}ws(e,t,n,r){return Ut(t)||r.isEqual(ee.min())?ie.resolve(null):this.ps.getDocuments(e,n).next(s=>{const o=this.Ds(t,s);return this.Cs(t,o,n,r)?ie.resolve(null):(g()<=i.$b.DEBUG&&f("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Bt(t)),this.vs(e,o,t,function(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,s=ee.fromTimestamp(1e9===r?new Z(n+1,0):new Z(n,r));return new ne(s,G.empty(),t)}(r,-1)).next(e=>e))})}Ds(e,t){let n=new Ce(function(e){return(t,n)=>{let r=!1;for(const s of xt(e)){const e=Ht(s,t,n);if(0!==e)return e;r=r||s.field.isKeyField()}return 0}}(e));return t.forEach((t,r)=>{$t(e,r)&&(n=n.add(r))}),n}Cs(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,n){return g()<=i.$b.DEBUG&&f("QueryEngine","Using full collection scan to execute query:",Bt(t)),this.ps.getDocumentsMatchingQuery(e,t,ne.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}class hr{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new Ae(U),this.xs=new qt(e=>Ot(e),Dt),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Yn(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}class dr{constructor(){this.activeTargetIds=nn}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pr{constructor(){this.Mo=new dr,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new dr,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class gr{Oo(e){}shutdown(){}}const fr="ConnectivityMonitor";class mr{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){f(fr,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){f(fr,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let yr=null;function wr(){return null===yr?yr=268435456+Math.round(2147483648*Math.random()):yr++,"0x"+yr.toString(16)}const vr="RestConnection",Ir={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Er{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${r}`,this.Wo=this.databaseId.database===$e?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Go(e,t,n,r,s){const i=wr(),a=this.zo(e,t.toUriEncodedString());f(vr,`Sending RPC '${e}' ${i}:`,a,n);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,r,s);const{host:l}=new URL(a),u=(0,o.zJ)(l);return this.Jo(e,a,c,n,u).then(t=>(f(vr,`Received RPC '${e}' ${i}: `,t),t),t=>{throw y(vr,`RPC '${e}' ${i} failed with error: `,t,"url: ",a,"request:",n),t})}Ho(e,t,n,r,s,i){return this.Go(e,t,n,r,s)}jo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+d,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}zo(e,t){const n=Ir[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}class _r{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Tr="WebChannelConnection";class Ar extends Er{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,s){const i=wr();return new Promise((s,o)=>{const a=new c.ZS;a.setWithCredentials(!0),a.listenOnce(c.Bx.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case c.O4.NO_ERROR:const t=a.getResponseJson();f(Tr,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),s(t);break;case c.O4.TIMEOUT:f(Tr,`RPC '${e}' ${i} timed out`),o(new A(T.DEADLINE_EXCEEDED,"Request time out"));break;case c.O4.HTTP_ERROR:const n=a.getStatus();if(f(Tr,`RPC '${e}' ${i} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=e?.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(T).indexOf(t)>=0?t:T.UNKNOWN}(t.status);o(new A(e,t.message))}else o(new A(T.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new A(T.UNAVAILABLE,"Connection failed."));break;default:v(9055,{l_:e,streamId:i,h_:a.getLastErrorCode(),P_:a.getLastError()})}}finally{f(Tr,`RPC '${e}' ${i} completed.`)}});const l=JSON.stringify(r);f(Tr,`RPC '${e}' ${i} sending request:`,r),a.send(t,"POST",l,n,15)})}T_(e,t,n){const r=wr(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=(0,c.fF)(),o=(0,c.Ao)(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.jo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const u=s.join("");f(Tr,`Creating RPC '${e}' stream ${r}: ${u}`,a);const h=i.createWebChannel(u,a);this.I_(h);let d=!1,p=!1;const g=new _r({Yo:t=>{p?f(Tr,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||(f(Tr,`Opening RPC '${e}' stream ${r} transport.`),h.open(),d=!0),f(Tr,`RPC '${e}' stream ${r} sending:`,t),h.send(t))},Zo:()=>h.close()}),w=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return w(h,c.iO.EventType.OPEN,()=>{p||(f(Tr,`RPC '${e}' stream ${r} transport opened.`),g.o_())}),w(h,c.iO.EventType.CLOSE,()=>{p||(p=!0,f(Tr,`RPC '${e}' stream ${r} transport closed`),g.a_(),this.E_(h))}),w(h,c.iO.EventType.ERROR,t=>{p||(p=!0,y(Tr,`RPC '${e}' stream ${r} transport errored. Name:`,t.name,"Message:",t.message),g.a_(new A(T.UNAVAILABLE,"The operation could not be completed")))}),w(h,c.iO.EventType.MESSAGE,t=>{if(!p){const n=t.data[0];E(!!n,16349);const s=n,i=s?.error||s[0]?.error;if(i){f(Tr,`RPC '${e}' stream ${r} received error:`,i);const t=i.status;let n=function(e){const t=kn[e];if(void 0!==t)return function(e){if(void 0===e)return m("GRPC error has no .code"),T.UNKNOWN;switch(e){case kn.OK:return T.OK;case kn.CANCELLED:return T.CANCELLED;case kn.UNKNOWN:return T.UNKNOWN;case kn.DEADLINE_EXCEEDED:return T.DEADLINE_EXCEEDED;case kn.RESOURCE_EXHAUSTED:return T.RESOURCE_EXHAUSTED;case kn.INTERNAL:return T.INTERNAL;case kn.UNAVAILABLE:return T.UNAVAILABLE;case kn.UNAUTHENTICATED:return T.UNAUTHENTICATED;case kn.INVALID_ARGUMENT:return T.INVALID_ARGUMENT;case kn.NOT_FOUND:return T.NOT_FOUND;case kn.ALREADY_EXISTS:return T.ALREADY_EXISTS;case kn.PERMISSION_DENIED:return T.PERMISSION_DENIED;case kn.FAILED_PRECONDITION:return T.FAILED_PRECONDITION;case kn.ABORTED:return T.ABORTED;case kn.OUT_OF_RANGE:return T.OUT_OF_RANGE;case kn.UNIMPLEMENTED:return T.UNIMPLEMENTED;case kn.DATA_LOSS:return T.DATA_LOSS;default:return v(39323,{code:e})}}(t)}(t),s=i.message;void 0===n&&(n=T.INTERNAL,s="Unknown error status: "+t+" with message "+i.message),p=!0,g.a_(new A(n,s)),h.close()}else f(Tr,`RPC '${e}' stream ${r} received:`,n),g.u_(n)}}),w(o,c.Jh.STAT_EVENT,t=>{t.stat===c.ro.PROXY?f(Tr,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===c.ro.NOPROXY&&f(Tr,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{g.__()},0),g}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Sr(){return"undefined"!=typeof document?document:null}function br(e){return new Mn(e,!0)}class Cr{constructor(e,t,n=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&f("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}class Rr{}class Pr extends Rr{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new A(T.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.Go(e,Dn(t,n),r,s,i)).catch(e=>{throw"FirebaseError"===e.name?(e.code===T.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new A(T.UNKNOWN,e.toString())})}Ho(e,t,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Ho(e,Dn(t,n),r,i,o,s)).catch(e=>{throw"FirebaseError"===e.name?(e.code===T.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new A(T.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class kr{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(m(t),this.aa=!1):f("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const Nr="RemoteStore";class Mr{constructor(e,t,n,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(e=>{n.enqueueAndForget(async()=>{Lr(this)&&(f(Nr,"Restarting streams for network reachability change."),await async function(e){const t=_(e);t.Ea.add(4),await Dr(t),t.Ra.set("Unknown"),t.Ea.delete(4),await Or(t)}(this))})}),this.Ra=new kr(n,r)}}async function Or(e){if(Lr(e))for(const t of e.da)await t(!0)}async function Dr(e){for(const t of e.da)await t(!1)}function Lr(e){return 0===_(e).Ea.size}class Ur{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new S,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,s){const i=Date.now()+n,o=new Ur(e,t,i,r,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new A(T.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}class xr{constructor(){this.queries=Vr(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const n=_(e),r=n.queries;n.queries=Vr(),r.forEach((e,n)=>{for(const e of n.Sa)e.onError(t)})}(this,new A(T.ABORTED,"Firestore shutting down"))}}function Vr(){return new qt(e=>jt(e),Kt)}var Fr,Kr;(Kr=Fr||(Fr={})).Ma="default",Kr.Cache="cache";class jr{constructor(e,t,n,r,s,i){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=i,this.Pu={},this.Tu=new qt(e=>jt(e),Kt),this.Iu=new Map,this.Eu=new Set,this.du=new Ae(G.comparator),this.Au=new Map,this.Ru=new Zn,this.Vu={},this.mu=new Map,this.fu=zn.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}function Br(e,t,n){const r=_(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Tu.forEach((n,r)=>{const s=r.view.va(t);s.snapshot&&e.push(s.snapshot)}),function(e,t){const n=_(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const e of n.Sa)e.va(t)&&(r=!0)}),r&&function(e){e.Ca.forEach(e=>{e.next()})}(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function $r(e,t){const n=_(e);if(!n.currentUser.isEqual(t)){f("SyncEngine","User change. New user:",t.toKey());const e=await async function(e,t){const n=_(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(s=>(r=s,n.Bs(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const s=[],i=[];let o=tn();for(const e of r){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({Ls:e,removedBatchIds:s,addedBatchIds:i}))})})}(n.localStore,t);n.currentUser=t,function(e){e.mu.forEach(e=>{e.forEach(e=>{e.reject(new A(T.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.mu.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await async function(e,t,n){const r=_(e),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((e,a)=>{o.push(r.pu(a,t,n).then(e=>{if((e||n)&&r.isPrimaryClient){const t=e?!e.fromCache:n?.targetChanges.get(a.targetId)?.current;r.sharedClientState.updateQueryState(a.targetId,t?"current":"not-current")}if(e){s.push(e);const t=cr.As(a.targetId,e);i.push(t)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(e,t){const n=_(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>ie.forEach(t,t=>ie.forEach(t.Es,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>ie.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!oe(e))throw e;f("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.Ms.get(t),r=e.snapshotVersion,s=e.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(t,s)}}}(r.localStore,i))}(n,e.Ls)}}class Hr{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=br(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return function(e,t,n,r){return new hr(e,t,n,r)}(this.persistence,new ur,e.initialUser,this.serializer)}Cu(e){return new ir(ar.mi,this.serializer)}Du(e){return new pr}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Hr.provider={build:()=>new Hr};class qr{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Br(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=$r.bind(null,this.syncEngine),await async function(e,t){const n=_(e);t?(n.Ea.delete(2),await Or(n)):t||(n.Ea.add(2),await Dr(n),n.Ra.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new xr}createDatastore(e){const t=br(e.databaseInfo.databaseId),n=function(e){return new Ar(e)}(e.databaseInfo);return function(e,t,n,r){return new Pr(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,s){return new Mr(e,t,n,r,s)}(this.localStore,this.datastore,e.asyncQueue,e=>Br(this.syncEngine,e,0),mr.v()?new mr:new gr)}createSyncEngine(e,t){return function(e,t,n,r,s,i,o){const a=new jr(e,t,n,r,s,i);return o&&(a.gu=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await async function(e){const t=_(e);f(Nr,"RemoteStore shutting down."),t.Ea.add(5),await Dr(t),t.Aa.shutdown(),t.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}qr.provider={build:()=>new qr};const zr=new Map,Gr="firestore.googleapis.com",Wr=!0;class Yr{constructor(e){if(void 0===e.host){if(void 0!==e.ssl)throw new A(T.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Gr,this.ssl=Wr}else this.host=e.host,this.ssl=e.ssl??Wr;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=Hn;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new A(T.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new A(T.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=function(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}(e.experimentalLongPollingOptions??{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new A(T.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new A(T.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new A(T.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Jr{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Yr({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new A(T.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new A(T.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Yr(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new C;switch(e.type){case"firstParty":return new N(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new A(T.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=zr.get(e);t&&(f("ComponentProvider","Removing Datastore"),zr.delete(e),t.terminate())}(this),Promise.resolve()}}function Qr(e,t,n,r={}){e=W(e,Jr);const s=(0,o.zJ)(t),i=e._getSettings(),a={...i,emulatorOptions:e._getEmulatorOptions()},c=`${t}:${n}`;s&&((0,o.gE)(`https://${c}`),(0,o.P1)("Firestore",!0)),i.host!==Gr&&i.host!==c&&y("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:c,ssl:s,emulatorOptions:r};if(!(0,o.bD)(l,a)&&(e._setSettings(l),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=h.MOCK_USER;else{t=(0,o.Fy)(r.mockUserToken,e._app?.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new A(T.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new h(s)}e._authCredentials=new R(new b(t,n))}}class Xr{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Xr(this.firestore,e,this._query)}}class Zr{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new es(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Zr(this.firestore,e,this._key)}toJSON(){return{type:Zr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(J(t,Zr._jsonSchema))return new Zr(e,n||null,new G(H.fromString(t.referencePath)))}}Zr._jsonSchemaVersion="firestore/documentReference/1.0",Zr._jsonSchema={type:Y("string",Zr._jsonSchemaVersion),referencePath:Y("string")};class es extends Xr{constructor(e,t,n){super(e,t,function(e){return new Lt(e)}(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Zr(this.firestore,null,new G(e))}withConverter(e){return new es(this.firestore,e,this._path)}}const ts="AsyncQueue";class ns{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Cr(this,"async_queue_retry"),this._c=()=>{const e=Sr();e&&f(ts,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=Sr();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Sr();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new S;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!oe(e))throw e;f(ts,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,m("INTERNAL UNHANDLED ERROR: ",rs(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Ur.createAndSchedule(this,e,t,n,e=>this.hc(e));return this.tc.push(r),r}uc(){this.nc&&v(47125,{Pc:rs(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do{e=this.ac,await e}while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function rs(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}class ss extends Jr{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new ns,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ns(e),this._firestoreClient=void 0,await e}}}function is(e,t){const n="object"==typeof e?e:(0,r.Sx)(),s="string"==typeof e?e:t||$e,i=(0,r.j6)(n,"firestore").getImmediate({identifier:s});if(!i._initialized){const e=(0,o.yU)("firestore");e&&Qr(i,...e)}return i}class os{constructor(e){this._byteString=e}static fromBase64String(e){try{return new os(Ne.fromBase64String(e))}catch(e){throw new A(T.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new os(Ne.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:os._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(J(e,os._jsonSchema))return os.fromBase64String(e.bytes)}}os._jsonSchemaVersion="firestore/bytes/1.0",os._jsonSchema={type:Y("string",os._jsonSchemaVersion),bytes:Y("string")};class as{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new A(T.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new z(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class cs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new A(T.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new A(T.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return U(this._lat,e._lat)||U(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:cs._jsonSchemaVersion}}static fromJSON(e){if(J(e,cs._jsonSchema))return new cs(e.latitude,e.longitude)}}cs._jsonSchemaVersion="firestore/geoPoint/1.0",cs._jsonSchema={type:Y("string",cs._jsonSchemaVersion),latitude:Y("number"),longitude:Y("number")};class ls{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ls._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(J(e,ls._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new ls(e.vectorValues);throw new A(T.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ls._jsonSchemaVersion="firestore/vectorValue/1.0",ls._jsonSchema={type:Y("string",ls._jsonSchemaVersion),vectorValues:Y("object")};const us=new RegExp("[~\\*/\\[\\]]");function hs(e,t,n,r,s){const i=r&&!r.isEmpty(),o=void 0!==s;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new A(T.INVALID_ARGUMENT,a+e+c)}class ds{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Zr(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new ps(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(gs("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class ps extends ds{data(){return super.data()}}function gs(e,t){return"string"==typeof t?function(e,t,n){if(t.search(us)>=0)throw hs(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new as(...t.split("."))._internalPath}catch(r){throw hs(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}(e,t):t instanceof as?t._internalPath:t._delegate._internalPath}class fs{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ms extends ds{constructor(e,t,n,r,s,i){super(e,t,n,r,i),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new ys(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(gs("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new A(T.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ms._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}ms._jsonSchemaVersion="firestore/documentSnapshot/1.0",ms._jsonSchema={type:Y("string",ms._jsonSchemaVersion),bundleSource:Y("string","DocumentSnapshot"),bundleName:Y("string"),bundle:Y("string")};class ys extends ms{data(e={}){return super.data(e)}}class ws{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new fs(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new ys(this._firestore,this._userDataWriter,n.key,n,new fs(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new A(T.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new ys(e._firestore,e._userDataWriter,n.doc.key,n.doc,new fs(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new ys(e._firestore,e._userDataWriter,t.doc.key,t.doc,new fs(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let s=-1,i=-1;return 0!==t.type&&(s=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),i=n.indexOf(t.doc.key)),{type:vs(t.type),doc:r,oldIndex:s,newIndex:i}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new A(T.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ws._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=L.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function vs(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return v(61501,{type:e})}}ws._jsonSchemaVersion="firestore/querySnapshot/1.0",ws._jsonSchema={type:Y("string",ws._jsonSchemaVersion),bundleSource:Y("string","QuerySnapshot"),bundleName:Y("string"),bundle:Y("string")},new WeakMap,function(e,t=!0){!function(e){d=e}(r.MF),(0,r.om)(new s.uA("firestore",(e,{instanceIdentifier:n,options:r})=>{const s=e.getProvider("app").getImmediate(),i=new ss(new P(e.getProvider("auth-internal")),new O(s,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new A(T.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new He(e.options.projectId,t)}(s,n),s);return r={useFetchStreams:t,...r},i._setSettings(r),i},"PUBLIC").setMultipleInstances(!0)),(0,r.KO)(l,u,e),(0,r.KO)(l,u,"esm2020")}()},5908:(e,t,n)=>{n.d(t,{Wq:()=>r.Wq,xI:()=>r.xI});var r=n(9082)},6639:(e,t,n)=>{n.d(t,{Gt:()=>r.Gt,xI:()=>r.xI});var r=n(3070)},7500:(e,t,n)=>{n.d(t,{r:()=>d,w:()=>g});const r=(e,t)=>t.some(t=>e instanceof t);let s,i;const o=new WeakMap,a=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap;let h={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return a.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return g(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function d(e){h=e(h)}function p(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(f(this),e),g(o.get(this))}:function(...e){return g(t.apply(f(this),e))}:function(e,...n){const r=t.call(f(this),e,...n);return c.set(r,e.sort?e.sort():[e]),g(r)}:(e instanceof IDBTransaction&&function(e){if(a.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",i),e.removeEventListener("abort",i)},s=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",s),e.addEventListener("error",i),e.addEventListener("abort",i)});a.set(e,t)}(e),r(e,s||(s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,h):e);var t}function g(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",s),e.removeEventListener("error",i)},s=()=>{t(g(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",s),e.addEventListener("error",i)});return t.then(t=>{t instanceof IDBCursor&&o.set(t,e)}).catch(()=>{}),u.set(t,e),t}(e);if(l.has(e))return l.get(e);const t=p(e);return t!==e&&(l.set(e,t),u.set(t,e)),t}const f=e=>u.get(e)},7573:(e,t,n)=>{n.d(t,{L:()=>Re,p:()=>ln});var r=n(9943),s=n(1625),i=n(722),o=n(1711);const a=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},c=new s.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),l=new i.Vy("@firebase/auth");function u(e,...t){l.logLevel<=i.$b.ERROR&&l.error(`Auth (${r.MF}): ${e}`,...t)}function h(e,...t){throw f(e,...t)}function d(e,...t){return f(e,...t)}function p(e,t,n){const r={...a(),[t]:n};return new s.FA("auth","Firebase",r).create(t,{appName:e.name})}function g(e){return p(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function f(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return c.create(e,...t)}function m(e,t,...n){if(!e)throw f(t,...n)}function y(e){const t="INTERNAL ASSERTION FAILED: "+e;throw u(t),new Error(t)}function w(e,t){e||y(t)}function v(){return"undefined"!=typeof self&&self.location?.href||""}function I(){return"undefined"!=typeof self&&self.location?.protocol||null}class E{constructor(e,t){this.shortDelay=e,this.longDelay=t,w(t>e,"Short delay should be less than long delay!"),this.isMobile=(0,s.jZ)()||(0,s.lV)()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===I()||"https:"===I()||(0,s.sr)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function _(e,t){w(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class T{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void y("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void y("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void y("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const A={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},S=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],b=new E(3e4,6e4);function C(e,t){return e.tenantId&&!t.tenantId?{...t,tenantId:e.tenantId}:t}async function R(e,t,n,r,i={}){return P(e,i,async()=>{let i={},o={};r&&("GET"===t?o=r:i={body:JSON.stringify(r)});const a=(0,s.Am)({key:e.config.apiKey,...o}).slice(1),c=await e._getAdditionalHeaders();c["Content-Type"]="application/json",e.languageCode&&(c["X-Firebase-Locale"]=e.languageCode);const l={method:t,headers:c,...i};return(0,s.c1)()||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&(0,s.zJ)(e.emulatorConfig.host)&&(l.credentials="include"),T.fetch()(await N(e,e.config.apiHost,n,a),l)})}async function P(e,t,n){e._canInitEmulator=!1;const r={...A,...t};try{const t=new O(e),s=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const i=await s.json();if("needConfirmation"in i)throw D(e,"account-exists-with-different-credential",i);if(s.ok&&!("errorMessage"in i))return i;{const t=s.ok?i.errorMessage:i.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw D(e,"credential-already-in-use",i);if("EMAIL_EXISTS"===n)throw D(e,"email-already-in-use",i);if("USER_DISABLED"===n)throw D(e,"user-disabled",i);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw p(e,a,o);h(e,a)}}catch(t){if(t instanceof s.g)throw t;h(e,"network-request-failed",{message:String(t)})}}async function k(e,t,n,r,s={}){const i=await R(e,t,n,r,s);return"mfaPendingCredential"in i&&h(e,"multi-factor-auth-required",{_serverResponse:i}),i}async function N(e,t,n,r){const s=`${t}${n}?${r}`,i=e,o=i.config.emulator?_(e.config,s):`${e.config.apiScheme}://${s}`;return S.includes(n)&&(await i._persistenceManagerAvailable,"COOKIE"===i._getPersistenceType())?i._getPersistence()._getFinalTarget(o).toString():o}function M(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class O{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(d(this.auth,"network-request-failed")),b.get())})}}function D(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=d(e,t,r);return s.customData._tokenResponse=n,s}function L(e){return void 0!==e&&void 0!==e.enterprise}class U{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return M(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function x(e,t){return R(e,"GET","/v2/recaptchaConfig",C(e,t))}async function V(e,t){return R(e,"POST","/v1/accounts:lookup",t)}function F(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function K(e){return 1e3*Number(e)}function j(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return u("JWT malformed, contained fewer than 3 sections"),null;try{const e=(0,s.u)(n);return e?JSON.parse(e):(u("Failed to decode base64 JWT payload"),null)}catch(e){return u("Caught error parsing JWT payload as JSON",e?.toString()),null}}function B(e){const t=j(e);return m(t,"internal-error"),m(void 0!==t.exp,"internal-error"),m(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function $(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof s.g&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class H{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e?.code&&this.schedule(!0))}this.schedule()}}class q{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=F(this.lastLoginAt),this.creationTime=F(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function z(e){const t=e.auth,n=await e.getIdToken(),r=await $(e,V(t,{idToken:n}));m(r?.users.length,t,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const i=s.providerUserInfo?.length?G(s.providerUserInfo):[],o=(a=e.providerData,c=i,[...a.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var a,c;const l=e.isAnonymous,u=!(e.email&&s.passwordHash||o?.length),h=!!l&&u,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new q(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(e,d)}function G(e){return e.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}class W{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){m(e.idToken,"internal-error"),m(void 0!==e.idToken,"internal-error"),m(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):B(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){m(0!==e.length,"internal-error");const t=B(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(m(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await P(e,{},async()=>{const n=(0,s.Am)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,o=await N(e,r,"/v1/token",`key=${i}`),a=await e._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:n};return e.emulatorConfig&&(0,s.zJ)(e.emulatorConfig.host)&&(c.credentials="include"),T.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:s}=t,i=new W;return n&&(m("string"==typeof n,"internal-error",{appName:e}),i.refreshToken=n),r&&(m("string"==typeof r,"internal-error",{appName:e}),i.accessToken=r),s&&(m("number"==typeof s,"internal-error",{appName:e}),i.expirationTime=s),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new W,this.toJSON())}_performRefresh(){return y("not implemented")}}function Y(e,t){m("string"==typeof e||void 0===e,"internal-error",{appName:t})}class J{constructor({uid:e,auth:t,stsTokenManager:n,...r}){this.providerId="firebase",this.proactiveRefresh=new H(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new q(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await $(this,this.stsTokenManager.getToken(this.auth,e));return m(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=(0,s.Ku)(e),r=await n.getIdToken(t),i=j(r);m(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const o="object"==typeof i.firebase?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:r,authTime:F(K(i.auth_time)),issuedAtTime:F(K(i.iat)),expirationTime:F(K(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}}(this,e)}reload(){return async function(e){const t=(0,s.Ku)(e);await z(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(m(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>({...e})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new J({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){m(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await z(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,r.xZ)(this.auth.app))return Promise.reject(g(this.auth));const e=await this.getIdToken();return await $(this,async function(e,t){return R(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,i=t.photoURL??void 0,o=t.tenantId??void 0,a=t._redirectEventId??void 0,c=t.createdAt??void 0,l=t.lastLoginAt??void 0,{uid:u,emailVerified:h,isAnonymous:d,providerData:p,stsTokenManager:g}=t;m(u&&g,e,"internal-error");const f=W.fromJSON(this.name,g);m("string"==typeof u,e,"internal-error"),Y(n,e.name),Y(r,e.name),m("boolean"==typeof h,e,"internal-error"),m("boolean"==typeof d,e,"internal-error"),Y(s,e.name),Y(i,e.name),Y(o,e.name),Y(a,e.name),Y(c,e.name),Y(l,e.name);const y=new J({uid:u,auth:e,email:r,emailVerified:h,displayName:n,isAnonymous:d,photoURL:i,phoneNumber:s,tenantId:o,stsTokenManager:f,createdAt:c,lastLoginAt:l});return p&&Array.isArray(p)&&(y.providerData=p.map(e=>({...e}))),a&&(y._redirectEventId=a),y}static async _fromIdTokenResponse(e,t,n=!1){const r=new W;r.updateFromServerResponse(t);const s=new J({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await z(s),s}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];m(void 0!==r.localId,"internal-error");const s=void 0!==r.providerUserInfo?G(r.providerUserInfo):[],i=!(r.email&&r.passwordHash||s?.length),o=new W;o.updateFromIdToken(n);const a=new J({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:i}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new q(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash||s?.length)};return Object.assign(a,c),a}}const Q=new Map;function X(e){w(e instanceof Function,"Expected a class definition");let t=Q.get(e);return t?(w(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Q.set(e,t),t)}class Z{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Z.type="NONE";const ee=Z;function te(e,t,n){return`firebase:${e}:${t}:${n}`}class ne{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:s}=this.auth;this.fullUserKey=te(this.userKey,r.apiKey,s),this.fullPersistenceKey=te("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){const t=await V(this.auth,{idToken:e}).catch(()=>{});return t?J._fromGetAccountInfoResponse(this.auth,t,e):null}return J._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new ne(X(ee),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let s=r[0]||X(ee);const i=te(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(i);if(t){let r;if("string"==typeof t){const n=await V(e,{idToken:t}).catch(()=>{});if(!n)break;r=await J._fromGetAccountInfoResponse(e,n,t)}else r=J._fromJSON(e,t);n!==s&&(o=r),s=n;break}}catch{}const a=r.filter(e=>e._shouldAllowMigration);return s._shouldAllowMigration&&a.length?(s=a[0],o&&await s._set(i,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==s)try{await e._remove(i)}catch{}})),new ne(s,e,n)):new ne(s,e,n)}}function re(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(ae(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(se(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(le(t))return"Blackberry";if(ue(t))return"Webos";if(ie(t))return"Safari";if((t.includes("chrome/")||oe(t))&&!t.includes("edge/"))return"Chrome";if(ce(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===n?.length)return n[1]}return"Other"}function se(e=(0,s.ZQ)()){return/firefox\//i.test(e)}function ie(e=(0,s.ZQ)()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function oe(e=(0,s.ZQ)()){return/crios\//i.test(e)}function ae(e=(0,s.ZQ)()){return/iemobile/i.test(e)}function ce(e=(0,s.ZQ)()){return/android/i.test(e)}function le(e=(0,s.ZQ)()){return/blackberry/i.test(e)}function ue(e=(0,s.ZQ)()){return/webos/i.test(e)}function he(e=(0,s.ZQ)()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function de(e=(0,s.ZQ)()){return he(e)||ce(e)||ue(e)||le(e)||/windows phone/i.test(e)||ae(e)}function pe(e,t=[]){let n;switch(e){case"Browser":n=re((0,s.ZQ)());break;case"Worker":n=`${re((0,s.ZQ)())}-${e}`;break;default:n=e}const i=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${r.MF}/${i}`}class ge{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(e){r(e)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:e?.message})}}}class fe{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??6,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),void 0!==t.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),void 0!==t.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),void 0!==t.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),void 0!==t.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class me{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new we(this),this.idTokenSubscription=new we(this),this.beforeStateQueue=new ge(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=c,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=X(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await ne.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await V(this,{idToken:e}),n=await J._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if((0,r.xZ)(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const t=this.redirectUser?._redirectEventId,r=n?._redirectEventId,i=await this.tryRedirectSignIn(e);t&&t!==r||!i?.user||(n=i.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(e){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(e))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return m(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await z(e)}catch(e){if("auth/network-request-failed"!==e?.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if((0,r.xZ)(this.app))return Promise.reject(g(this));const t=e?(0,s.Ku)(e):null;return t&&m(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&m(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(0,r.xZ)(this.app)?Promise.reject(g(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return(0,r.xZ)(this.app)?Promise.reject(g(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(X(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return R(e,"GET","/v2/passwordPolicy",C(e,t))}(this),t=new fe(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new s.FA("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return R(e,"POST","/v2/accounts:revokeToken",C(e,t))}(this,t)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&X(e)||this._popupRedirectResolver;m(t,this,"argument-error"),this.redirectPersistenceManager=await ne.create(this,[X(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const s="function"==typeof t?t:t.next.bind(t);let i=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(m(o,this,"internal-error"),o.then(()=>{i||s(this.currentUser)}),"function"==typeof t){const s=e.addObserver(t,n,r);return()=>{i=!0,s()}}{const n=e.addObserver(t);return()=>{i=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return m(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=pe(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await(this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if((0,r.xZ)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await(this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken());return e?.error&&function(e,...t){l.logLevel<=i.$b.WARN&&l.warn(`Auth (${r.MF}): ${e}`,...t)}(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ye(e){return(0,s.Ku)(e)}class we{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,s.tD)(e=>this.observer=e)}get next(){return m(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ve={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ie(e){return ve.loadJS(e)}function Ee(e){return`__${e}${Math.floor(1e6*Math.random())}`}class _e{constructor(){this.enterprise=new Te}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Te{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Ae="NO_RECAPTCHA";class Se{constructor(e){this.type="recaptcha-enterprise",this.auth=ye(e)}async verify(e="verify",t=!1){function n(t,n,r){const s=window.grecaptcha;L(s)?s.enterprise.ready(()=>{s.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(Ae)})}):r(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?(new _e).execute("siteKey",{action:"verify"}):new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{x(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new U(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(s=>{if(!t&&L(window.grecaptcha))n(s,e,r);else{if("undefined"==typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=ve.recaptchaEnterpriseScript;0!==t.length&&(t+=s),Ie(t).then(()=>{n(s,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function be(e,t,n,r=!1,s=!1){const i=new Se(e);let o;if(s)o=Ae;else try{o=await i.verify(n)}catch(e){o=await i.verify(n,!0)}const a={...t};if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in a){const e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const e=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Ce(e,t,n,r,s){if("EMAIL_PASSWORD_PROVIDER"===s){if(e._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await be(e,t,n,"getOobCode"===n);return r(e,s)}return r(e,t).catch(async s=>{if("auth/missing-recaptcha-token"===s.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const s=await be(e,t,n,"getOobCode"===n);return r(e,s)}return Promise.reject(s)})}if("PHONE_PROVIDER"===s){if(e._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const s=await be(e,t,n);return r(e,s).catch(async s=>{if("AUDIT"===e._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")&&("auth/missing-recaptcha-token"===s.code||"auth/invalid-app-credential"===s.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const s=await be(e,t,n,!1,!0);return r(e,s)}return Promise.reject(s)})}{const s=await be(e,t,n,!1,!0);return r(e,s)}}return Promise.reject(s+" provider is not supported.")}function Re(e,t,n){const r=ye(e);m(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!n?.disableWarnings,o=Pe(t),{host:a,port:c}=function(e){const t=Pe(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const e=s[1];return{host:e,port:ke(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:ke(t)}}}(t),l=null===c?"":`:${c}`,u={url:`${o}//${a}${l}/`},h=Object.freeze({host:a,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator)return m(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void m((0,s.bD)(u,r.config.emulator)&&(0,s.bD)(h,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=u,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,(0,s.zJ)(a)?((0,s.gE)(`${o}//${a}${l}`),(0,s.P1)("Auth",!0)):i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Pe(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function ke(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Ne{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return y("not implemented")}_getIdTokenResponse(e){return y("not implemented")}_linkToIdToken(e,t){return y("not implemented")}_getReauthenticationResolver(e){return y("not implemented")}}async function Me(e,t){return R(e,"POST","/v1/accounts:signUp",t)}async function Oe(e,t){return k(e,"POST","/v1/accounts:signInWithPassword",C(e,t))}class De extends Ne{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new De(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new De(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Ce(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Oe,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return k(e,"POST","/v1/accounts:signInWithEmailLink",C(e,t))}(e,{email:this._email,oobCode:this._password});default:h(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Ce(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Me,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return k(e,"POST","/v1/accounts:signInWithEmailLink",C(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:h(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Le(e,t){return k(e,"POST","/v1/accounts:signInWithIdp",C(e,t))}class Ue extends Ne{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ue(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):h("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,...s}=t;if(!n||!r)return null;const i=new Ue(n,r);return i.idToken=s.idToken||void 0,i.accessToken=s.accessToken||void 0,i.secret=s.secret,i.nonce=s.nonce,i.pendingToken=s.pendingToken||null,i}_getIdTokenResponse(e){return Le(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Le(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Le(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,s.Am)(t)}return e}}async function xe(e,t){return R(e,"POST","/v1/accounts:sendVerificationCode",C(e,t))}const Ve={USER_NOT_FOUND:"user-not-found"};class Fe extends Ne{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Fe({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Fe({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return k(e,"POST","/v1/accounts:signInWithPhoneNumber",C(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await k(e,"POST","/v1/accounts:signInWithPhoneNumber",C(e,t));if(n.temporaryProof)throw D(e,"account-exists-with-different-credential",n);return n}(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return async function(e,t){return k(e,"POST","/v1/accounts:signInWithPhoneNumber",C(e,{...t,operation:"REAUTH"}),Ve)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:s}=e;return n||t||r||s?new Fe({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:s}):null}}class Ke{constructor(e){const t=(0,s.I9)((0,s.hp)(e)),n=t.apiKey??null,r=t.oobCode??null,i=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(t.mode??null);m(n&&r&&i,"argument-error"),this.apiKey=n,this.operation=i,this.code=r,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=function(e){const t=(0,s.I9)((0,s.hp)(e)).link,n=t?(0,s.I9)((0,s.hp)(t)).deep_link_id:null,r=(0,s.I9)((0,s.hp)(e)).deep_link_id;return(r?(0,s.I9)((0,s.hp)(r)).link:null)||r||n||t||e}(e);try{return new Ke(t)}catch{return null}}}class je{constructor(){this.providerId=je.PROVIDER_ID}static credential(e,t){return De._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Ke.parseLink(t);return m(n,"argument-error"),De._fromEmailAndCode(e,n.code,n.tenantId)}}je.PROVIDER_ID="password",je.EMAIL_PASSWORD_SIGN_IN_METHOD="password",je.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Be{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class $e extends Be{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class He extends $e{constructor(){super("facebook.com")}static credential(e){return Ue._fromParams({providerId:He.PROVIDER_ID,signInMethod:He.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return He.credentialFromTaggedObject(e)}static credentialFromError(e){return He.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return He.credential(e.oauthAccessToken)}catch{return null}}}He.FACEBOOK_SIGN_IN_METHOD="facebook.com",He.PROVIDER_ID="facebook.com";class qe extends $e{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ue._fromParams({providerId:qe.PROVIDER_ID,signInMethod:qe.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return qe.credentialFromTaggedObject(e)}static credentialFromError(e){return qe.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return qe.credential(t,n)}catch{return null}}}qe.GOOGLE_SIGN_IN_METHOD="google.com",qe.PROVIDER_ID="google.com";class ze extends $e{constructor(){super("github.com")}static credential(e){return Ue._fromParams({providerId:ze.PROVIDER_ID,signInMethod:ze.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ze.credentialFromTaggedObject(e)}static credentialFromError(e){return ze.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return ze.credential(e.oauthAccessToken)}catch{return null}}}ze.GITHUB_SIGN_IN_METHOD="github.com",ze.PROVIDER_ID="github.com";class Ge extends $e{constructor(){super("twitter.com")}static credential(e,t){return Ue._fromParams({providerId:Ge.PROVIDER_ID,signInMethod:Ge.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ge.credentialFromTaggedObject(e)}static credentialFromError(e){return Ge.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Ge.credential(t,n)}catch{return null}}}Ge.TWITTER_SIGN_IN_METHOD="twitter.com",Ge.PROVIDER_ID="twitter.com";class We{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const s=await J._fromIdTokenResponse(e,n,r),i=Ye(n);return new We({user:s,providerId:i,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Ye(n);return new We({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Ye(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Je extends s.g{constructor(e,t,n,r){super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Je.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Je(e,t,n,r)}}function Qe(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw Je._fromErrorAndOperation(e,n,t,r);throw n})}function Xe(e,t){return R(e,"POST","/v2/accounts/mfaEnrollment:start",C(e,t))}new WeakMap;const Ze="__sak";class et{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ze,"1"),this.storage.removeItem(Ze),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class tt extends et{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=de(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);(0,s.lT)()&&10===document.documentMode&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}tt.type="LOCAL";const nt=tt;class rt extends et{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}rt.type="SESSION";const st=rt;class it{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new it(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:s}=t.data,i=this.handlersMap[r];if(!i?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(i).map(async e=>e(t.origin,s)),a=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}}))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function ot(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}it.receivers=[];class at{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,i;return new Promise((o,a)=>{const c=ot("",20);r.port1.start();const l=setTimeout(()=>{a(new Error("unsupported_event"))},n);i={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),s=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(t.data.response);break;default:clearTimeout(l),clearTimeout(s),a(new Error("invalid_response"))}}},this.handlers.add(i),r.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}function ct(){return window}function lt(){return void 0!==ct().WorkerGlobalScope&&"function"==typeof ct().importScripts}const ut="firebaseLocalStorageDb",ht="firebaseLocalStorage",dt="fbase_key";class pt{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function gt(e,t){return e.transaction([ht],t?"readwrite":"readonly").objectStore(ht)}function ft(){const e=indexedDB.open(ut,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(ht,{keyPath:dt})}catch(e){n(e)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(ht)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(ut);return new pt(e).toPromise()}(),t(await ft()))})})}async function mt(e,t,n){const r=gt(e,!0).put({[dt]:t,value:n});return new pt(r).toPromise()}function yt(e,t){const n=gt(e,!0).delete(t);return new pt(n).toPromise()}class wt{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await ft()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return lt()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=it._getInstance(lt()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await async function(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}(),!this.activeServiceWorker)return;this.sender=new at(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&(navigator?.serviceWorker?.controller||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ft();return await mt(e,Ze,"1"),await yt(e,Ze),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>mt(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=gt(e,!1).get(t),r=await new pt(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>yt(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=gt(e,!1).getAll();return new pt(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:s}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}wt.type="LOCAL";const vt=wt;function It(e,t){return R(e,"POST","/v2/accounts/mfaSignIn:start",C(e,t))}Ee("rcb"),new E(3e4,6e4);const Et="recaptcha";async function _t(e,t,n){if(!e._getRecaptchaConfig())try{await async function(e){const t=ye(e),n=await x(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new U(n);null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()&&new Se(t).verify()}(e)}catch(e){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let r;if(r="string"==typeof t?{phoneNumber:t}:t,"session"in r){const t=r.session;if("phoneNumber"in r){m("enroll"===t.type,e,"internal-error");const s=Ce(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},"mfaSmsEnrollment",async(e,t)=>t.phoneEnrollmentInfo.captchaResponse===Ae?(m(n?.type===Et,e,"argument-error"),Xe(e,await Tt(e,t,n))):Xe(e,t),"PHONE_PROVIDER");return(await s.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{m("signin"===t.type,e,"internal-error");const s=r.multiFactorHint?.uid||r.multiFactorUid;m(s,e,"missing-multi-factor-info");const i=Ce(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:s,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},"mfaSmsSignIn",async(e,t)=>t.phoneSignInInfo.captchaResponse===Ae?(m(n?.type===Et,e,"argument-error"),It(e,await Tt(e,t,n))):It(e,t),"PHONE_PROVIDER");return(await i.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{const t=Ce(e,{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"},"sendVerificationCode",async(e,t)=>t.captchaResponse===Ae?(m(n?.type===Et,e,"argument-error"),xe(e,await Tt(e,t,n))):xe(e,t),"PHONE_PROVIDER");return(await t.catch(e=>Promise.reject(e))).sessionInfo}}finally{n?._reset()}}async function Tt(e,t,n){m(n.type===Et,e,"argument-error");const r=await n.verify();m("string"==typeof r,e,"argument-error");const s={...t};if("phoneEnrollmentInfo"in s){const e=s.phoneEnrollmentInfo.phoneNumber,t=s.phoneEnrollmentInfo.captchaResponse,n=s.phoneEnrollmentInfo.clientType,i=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:i}}),s}if("phoneSignInInfo"in s){const e=s.phoneSignInInfo.captchaResponse,t=s.phoneSignInInfo.clientType,n=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),s}return Object.assign(s,{recaptchaToken:r}),s}class At{constructor(e){this.providerId=At.PROVIDER_ID,this.auth=ye(e)}verifyPhoneNumber(e,t){return _t(this.auth,e,(0,s.Ku)(t))}static credential(e,t){return Fe._fromVerification(e,t)}static credentialFromResult(e){const t=e;return At.credentialFromTaggedObject(t)}static credentialFromError(e){return At.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?Fe._fromTokenResponse(t,n):null}}At.PROVIDER_ID="phone",At.PHONE_SIGN_IN_METHOD="phone";class St extends Ne{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Le(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Le(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Le(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function bt(e){return async function(e,t,n=!1){if((0,r.xZ)(e.app))return Promise.reject(g(e));const s="signIn",i=await Qe(e,s,t),o=await We._fromIdTokenResponse(e,s,i);return n||await e._updateCurrentUser(o.user),o}(e.auth,new St(e),e.bypassAuthState)}function Ct(e){const{auth:t,user:n}=e;return m(n,t,"internal-error"),async function(e,t,n=!1){const{auth:s}=e;if((0,r.xZ)(s.app))return Promise.reject(g(s));const i="reauthenticate";try{const r=await $(e,Qe(s,i,t,e),n);m(r.idToken,s,"internal-error");const o=j(r.idToken);m(o,s,"internal-error");const{sub:a}=o;return m(e.uid===a,s,"user-mismatch"),We._forOperation(e,i,r)}catch(e){throw"auth/user-not-found"===e?.code&&h(s,"user-mismatch"),e}}(n,new St(e),e.bypassAuthState)}async function Rt(e){const{auth:t,user:n}=e;return m(n,t,"internal-error"),async function(e,t,n=!1){const r=await $(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return We._forOperation(e,"link",r)}(n,new St(e),e.bypassAuthState)}class Pt{constructor(e,t,n,r,s=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:s,error:i,type:o}=e;if(i)return void this.reject(i);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return bt;case"linkViaPopup":case"linkViaRedirect":return Rt;case"reauthViaPopup":case"reauthViaRedirect":return Ct;default:h(this.auth,"internal-error")}}resolve(e){w(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){w(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const kt=new E(2e3,1e4);class Nt extends Pt{constructor(e,t,n,r,s){super(e,t,r,s),this.provider=n,this.authWindow=null,this.pollId=null,Nt.currentPopupAction&&Nt.currentPopupAction.cancel(),Nt.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return m(e,this.auth,"internal-error"),e}async onExecution(){w(1===this.filter.length,"Popup operations only handle one event");const e=ot();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(d(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(d(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Nt.currentPopupAction=null}pollUserCancellation(){const e=()=>{this.authWindow?.window?.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(d(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,kt.get())};e()}}Nt.currentPopupAction=null;const Mt=new Map;class Ot extends Pt{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Mt.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return te("pendingRedirect",e.config.apiKey,e.name)}(t),r=function(e){return X(e._redirectPersistence)}(e);if(!await r._isAvailable())return!1;const s="true"===await r._get(n);return await r._remove(n),s}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}Mt.set(this.auth._key(),e)}return this.bypassAuthState||Mt.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Dt(e,t){Mt.set(e._key(),t)}async function Lt(e,t,n=!1){if((0,r.xZ)(e.app))return Promise.reject(g(e));const s=ye(e),i=function(e,t){return t?X(t):(m(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(s,t),o=new Ot(s,i,n),a=await o.execute();return a&&!n&&(delete a.user._redirectEventId,await s._persistUserIfCurrent(a.user),await s._setRedirectUser(null,t)),a}class Ut{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Vt(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Vt(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";t.onError(d(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(xt(e))}saveEventToCache(e){this.cachedEventUids.add(xt(e)),this.lastProcessedEventTime=Date.now()}}function xt(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function Vt({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===t?.code}const Ft=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Kt=/^https?/;function jt(e){const t=v(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const s=new URL(e);return""===s.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&s.hostname===r}if(!Kt.test(n))return!1;if(Ft.test(e))return r===e;const s=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const Bt=new E(3e4,6e4);function $t(){const e=ct().___jsl;if(e?.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}function Ht(e){return new Promise((t,n)=>{function r(){$t(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{$t(),n(d(e,"network-request-failed"))},timeout:Bt.get()})}if(ct().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else{if(!ct().gapi?.load){const t=Ee("iframefcb");return ct()[t]=()=>{gapi.load?r():n(d(e,"network-request-failed"))},Ie(`${ve.gapiScript}?onload=${t}`).catch(e=>n(e))}r()}}).catch(e=>{throw qt=null,e})}let qt=null;const zt=new E(5e3,15e3),Gt={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Wt=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Yt(e){const t=e.config;m(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?_(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,i={apiKey:t.apiKey,appName:e.name,v:r.MF},o=Wt.get(e.config.apiHost);o&&(i.eid=o);const a=e._getFrameworks();return a.length&&(i.fw=a.join(",")),`${n}?${(0,s.Am)(i).slice(1)}`}const Jt={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Qt{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}const Xt=encodeURIComponent("fac");async function Zt(e,t,n,i,o,a){m(e.config.authDomain,e,"auth-domain-config-required"),m(e.config.apiKey,e,"invalid-api-key");const c={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:r.MF,eventId:o};if(t instanceof Be){t.setDefaultLanguage(e.languageCode),c.providerId=t.providerId||"",(0,s.Im)(t.getCustomParameters())||(c.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))c[e]=t}if(t instanceof $e){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(c.scopes=e.join(","))}e.tenantId&&(c.tid=e.tenantId);const l=c;for(const e of Object.keys(l))void 0===l[e]&&delete l[e];const u=await e._getAppCheckToken(),h=u?`#${Xt}=${encodeURIComponent(u)}`:"";return`${function({config:e}){return e.emulator?_(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${(0,s.Am)(l).slice(1)}${h}`}const en="webStorageSupport",tn=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=st,this._completeRedirectFn=Lt,this._overrideRedirectResult=Dt}async _openPopup(e,t,n,r){return w(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()"),function(e,t,n,r=500,i=600){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const l={...Jt,width:r.toString(),height:i.toString(),top:o,left:a},u=(0,s.ZQ)().toLowerCase();n&&(c=oe(u)?"_blank":n),se(u)&&(t=t||"http://localhost",l.scrollbars="yes");const h=Object.entries(l).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(function(e=(0,s.ZQ)()){return he(e)&&!!window.navigator?.standalone}(u)&&"_self"!==c)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",c),new Qt(null);const d=window.open(t||"",c,h);m(d,e,"popup-blocked");try{d.focus()}catch(e){}return new Qt(d)}(e,await Zt(e,t,n,v(),r),ot())}async _openRedirect(e,t,n,r){return await this._originValidation(e),s=await Zt(e,t,n,v(),r),ct().location.href=s,new Promise(()=>{});var s}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(w(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await async function(e){const t=await function(e){return qt=qt||Ht(e),qt}(e),n=ct().gapi;return m(n,e,"internal-error"),t.open({where:document.body,url:Yt(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Gt,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const s=d(e,"network-request-failed"),i=ct().setTimeout(()=>{r(s)},zt.get());function o(){ct().clearTimeout(i),n(t)}t.ping(o).then(o,()=>{r(s)})}))}(e),n=new Ut(e);return t.register("authEvent",t=>(m(t?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(en,{type:en},n=>{const r=n?.[0]?.[en];void 0!==r&&t(!!r),h(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return R(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(jt(e))return}catch{}h(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return de()||ie()||he()}};var nn="@firebase/auth",rn="1.11.1";class sn{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e(t?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){m(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const on=(0,s.XA)("authIdTokenMaxAge")||300;let an=null;const cn=e=>async t=>{const n=t&&await t.getIdTokenResult(),r=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>on)return;const s=n?.token;an!==s&&(an=s,await fetch(e,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function ln(e=(0,r.Sx)()){const t=(0,r.j6)(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=(0,r.j6)(e,"auth");if(n.isInitialized()){const e=n.getImmediate(),r=n.getOptions();if((0,s.bD)(r,t??{}))return e;h(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:tn,persistence:[vt,nt,st]}),i=(0,s.XA)("authTokenSyncURL");if(i&&"boolean"==typeof isSecureContext&&isSecureContext){const e=new URL(i,location.origin);if(location.origin===e.origin){const t=cn(e.toString());!function(e,t,n){(0,s.Ku)(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e){(0,s.Ku)(e).onIdTokenChanged(e=>t(e),void 0,void 0)}(n)}}const o=(0,s.Tj)("auth");return o&&Re(n,`http://${o}`),n}var un;ve={loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=d("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(document.getElementsByTagName("head")?.[0]??document).appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},un="Browser",(0,r.om)(new o.uA("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:i,authDomain:o}=n.options;m(i&&!i.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:i,authDomain:o,clientPlatform:un,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:pe(un)},c=new me(n,r,s,a);return function(e,t){const n=t?.persistence||[],r=(Array.isArray(n)?n:[n]).map(X);t?.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,t?.popupRedirectResolver)}(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),(0,r.om)(new o.uA("auth-internal",e=>{return t=ye(e.getProvider("auth").getImmediate()),new sn(t);var t},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,r.KO)(nn,rn,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(un)),(0,r.KO)(nn,rn,"esm2020")},7773:(e,t,n)=>{n.d(t,{M:()=>r});const r=()=>{}},9082:(e,t,n)=>{n.d(t,{Wq:()=>r.L,xI:()=>r.p});var r=n(7573);n(9943),n(1625),n(722),n(1711)},9943:(e,t,n)=>{n.d(t,{KO:()=>Q,MF:()=>W,Sx:()=>J,Wp:()=>Y,j6:()=>H,om:()=>$,xZ:()=>q});var r=n(1711),s=n(722),i=n(1625),o=n(602);class a{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===t?.type}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const c="@firebase/app",l="0.14.5",u=new s.Vy("@firebase/app"),h="@firebase/app-compat",d="@firebase/analytics-compat",p="@firebase/analytics",g="@firebase/app-check-compat",f="@firebase/app-check",m="@firebase/auth",y="@firebase/auth-compat",w="@firebase/database",v="@firebase/data-connect",I="@firebase/database-compat",E="@firebase/functions",_="@firebase/functions-compat",T="@firebase/installations",A="@firebase/installations-compat",S="@firebase/messaging",b="@firebase/messaging-compat",C="@firebase/performance",R="@firebase/performance-compat",P="@firebase/remote-config",k="@firebase/remote-config-compat",N="@firebase/storage",M="@firebase/storage-compat",O="@firebase/firestore",D="@firebase/ai",L="@firebase/firestore-compat",U="firebase",x="[DEFAULT]",V={[c]:"fire-core",[h]:"fire-core-compat",[p]:"fire-analytics",[d]:"fire-analytics-compat",[f]:"fire-app-check",[g]:"fire-app-check-compat",[m]:"fire-auth",[y]:"fire-auth-compat",[w]:"fire-rtdb",[v]:"fire-data-connect",[I]:"fire-rtdb-compat",[E]:"fire-fn",[_]:"fire-fn-compat",[T]:"fire-iid",[A]:"fire-iid-compat",[S]:"fire-fcm",[b]:"fire-fcm-compat",[C]:"fire-perf",[R]:"fire-perf-compat",[P]:"fire-rc",[k]:"fire-rc-compat",[N]:"fire-gcs",[M]:"fire-gcs-compat",[O]:"fire-fst",[L]:"fire-fst-compat",[D]:"fire-vertex","fire-js":"fire-js",[U]:"fire-js-all"},F=new Map,K=new Map,j=new Map;function B(e,t){try{e.container.addComponent(t)}catch(n){u.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function $(e){const t=e.name;if(j.has(t))return u.debug(`There were multiple attempts to register component ${t}.`),!1;j.set(t,e);for(const t of F.values())B(t,e);for(const t of K.values())B(t,e);return!0}function H(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function q(e){return null!=e&&void 0!==e.settings}const z=new i.FA("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class G{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new r.uA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw z.create("app-deleted",{appName:this._name})}}const W="12.5.0";function Y(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const s={name:x,automaticDataCollectionEnabled:!0,...t},o=s.name;if("string"!=typeof o||!o)throw z.create("bad-app-name",{appName:String(o)});if(n||(n=(0,i.T9)()),!n)throw z.create("no-options");const a=F.get(o);if(a){if((0,i.bD)(n,a.options)&&(0,i.bD)(s,a.config))return a;throw z.create("duplicate-app",{appName:o})}const c=new r.h1(o);for(const e of j.values())c.addComponent(e);const l=new G(n,s,c);return F.set(o,l),l}function J(e=x){const t=F.get(e);if(!t&&e===x&&(0,i.T9)())return Y();if(!t)throw z.create("no-app",{appName:e});return t}function Q(e,t,n){let s=V[e]??e;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const e=[`Unable to register library "${s}" with version "${t}":`];return i&&e.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void u.warn(e.join(" "))}$(new r.uA(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}const X="firebase-heartbeat-store";let Z=null;function ee(){return Z||(Z=(0,o.P2)("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(X)}catch(e){console.warn(e)}}}).catch(e=>{throw z.create("idb-open",{originalErrorMessage:e.message})})),Z}async function te(e,t){try{const n=(await ee()).transaction(X,"readwrite"),r=n.objectStore(X);await r.put(t,ne(e)),await n.done}catch(e){if(e instanceof i.g)u.warn(e.message);else{const t=z.create("idb-set",{originalErrorMessage:e?.message});u.warn(t.message)}}}function ne(e){return`${e.name}!${e.options.appId}`}class re{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new ie(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=se();if(null==this._heartbeatsCache?.heartbeats&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==this._heartbeatsCache?.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===t||this._heartbeatsCache.heartbeats.some(e=>e.date===t))return;if(this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){u.warn(e)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==this._heartbeatsCache?.heartbeats||0===this._heartbeatsCache.heartbeats.length)return"";const e=se(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let r=e.slice();for(const s of e){const e=n.find(e=>e.agent===s.agent);if(e){if(e.dates.push(s.date),oe(n)>t){e.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),oe(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=(0,i.Uj)(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return u.warn(e),""}}}function se(){return(new Date).toISOString().substring(0,10)}class ie{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,i.zW)()&&(0,i.eX)().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await ee()).transaction(X),n=await t.objectStore(X).get(ne(e));return await t.done,n}catch(e){if(e instanceof i.g)u.warn(e.message);else{const t=z.create("idb-get",{originalErrorMessage:e?.message});u.warn(t.message)}}}(this.app);return e?.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const t=await this.read();return te(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){const t=await this.read();return te(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:[...t.heartbeats,...e.heartbeats]})}}}function oe(e){return(0,i.Uj)(JSON.stringify({version:2,heartbeats:e})).length}$(new r.uA("platform-logger",e=>new a(e),"PRIVATE")),$(new r.uA("heartbeat",e=>new re(e),"PRIVATE")),Q(c,l,""),Q(c,l,"esm2020"),Q("fire-js","")}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),globalThis.__IS_SERVICE_WORKER__=!0,"undefined"==typeof document&&(globalThis.document={readyState:"complete",addEventListener:()=>{},removeEventListener:()=>{},dispatchEvent:()=>!0,createElement:()=>({setAttribute:()=>{},getAttribute:()=>null,style:{}}),createEvent:()=>({initEvent:()=>{}}),getElementById:()=>null,getElementsByTagName:()=>[],querySelector:()=>null,querySelectorAll:()=>[],head:{appendChild:()=>{},removeChild:()=>{}},body:{appendChild:()=>{},removeChild:()=>{}}},console.log("[Polyfills] Document stub installed for Firebase SDK")),"undefined"==typeof window&&(globalThis.window={location:{href:"chrome-extension://",hostname:"localhost",protocol:"chrome-extension:"},addEventListener:()=>{},removeEventListener:()=>{}},console.log("[Polyfills] Window stub installed for Firebase SDK"));var r=n(51);class s{constructor(){this.customAuthInstance=null}async encrypt(e){const t=(new TextEncoder).encode(e),n=await this.getEncryptionKey(),r=crypto.getRandomValues(new Uint8Array(12)),s=await crypto.subtle.encrypt({name:"AES-GCM",iv:r},n,t),i=new Uint8Array(r.length+s.byteLength);return i.set(r),i.set(new Uint8Array(s),r.length),this.arrayBufferToBase64(i)}async decrypt(e){const t=this.base64ToArrayBuffer(e),n=t.slice(0,12),r=t.slice(12),s=await this.getEncryptionKey(),i=await crypto.subtle.decrypt({name:"AES-GCM",iv:n},s,r);return(new TextDecoder).decode(i)}async getEncryptionKey(){const e=new TextEncoder,t=await this.getFirebaseKeyMaterial(),n=await crypto.subtle.importKey("raw",e.encode(t),"PBKDF2",!1,["deriveKey"]),r=await this.getOrGenerateSalt();return crypto.subtle.deriveKey({name:"PBKDF2",salt:e.encode(r),iterations:6e5,hash:"SHA-256"},n,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async getFirebaseKeyMaterial(){try{let e;if(this.customAuthInstance)e=this.customAuthInstance,console.log("[StorageEncryptionManager] Using custom auth instance (test mode)");else{const t=await Promise.resolve().then(n.bind(n,51));e=t.auth}if(!e.currentUser){const t=300,n=Date.now();await new Promise(n=>{const r=e.onAuthStateChanged(()=>{r(),n()});setTimeout(()=>{n()},t)});const r=Date.now()-n;e.currentUser&&console.log(`[StorageEncryptionManager] Firebase auth initialized after ${r}ms wait`)}if(!e.currentUser)throw new Error("ENCRYPTION_KEY_UNAVAILABLE: Please sign in to access encrypted data. Your data is locked and requires authentication.");const t=e.currentUser.uid;if(!t||""===t.trim())throw new Error("ENCRYPTION_KEY_INVALID: Firebase UID is missing or empty.");return console.log("[StorageEncryptionManager] Using Firebase UID for encryption key derivation"),t}catch(e){if(e instanceof Error&&e.message.includes("ENCRYPTION_KEY"))throw e;if(e instanceof Error&&e.message.includes("document is not defined"))throw new Error("ENCRYPTION_KEY_UNAVAILABLE: Cannot access encrypted data in service worker context.");throw console.error("[StorageEncryptionManager] Unexpected error accessing Firebase auth:",e),new Error("ENCRYPTION_KEY_UNAVAILABLE: Authentication required to access encrypted data.")}}async getLegacyEncryptionKey(){const e=new TextEncoder,t=await this.getOrGenerateKeyMaterial(),n=await crypto.subtle.importKey("raw",e.encode(t),"PBKDF2",!1,["deriveKey"]),r=await this.getOrGenerateSalt();return crypto.subtle.deriveKey({name:"PBKDF2",salt:e.encode(r),iterations:21e4,hash:"SHA-256"},n,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async decryptWithKey(e,t){const n=this.base64ToArrayBuffer(e),r=n.slice(0,12),s=n.slice(12),i=await crypto.subtle.decrypt({name:"AES-GCM",iv:r},t,s);return(new TextDecoder).decode(i)}async encryptAPIKeyVault(e){try{const t=JSON.stringify(e);return await this.encrypt(t)}catch(e){throw console.error("[StorageEncryptionManager] Failed to encrypt API key vault:",e),e}}async decryptAPIKeyVault(e){try{const t=await this.decrypt(e);return JSON.parse(t)}catch(e){throw e instanceof Error&&e.message.includes("ENCRYPTION_KEY_UNAVAILABLE")||console.error("[StorageEncryptionManager] Failed to decrypt API key vault:",e),e}}async encryptCustomRules(e){try{const t=JSON.stringify(e);return await this.encrypt(t)}catch(e){throw console.error("[StorageEncryptionManager] Failed to encrypt custom rules:",e),e}}async decryptCustomRules(e){try{const t=await this.decrypt(e);return JSON.parse(t)}catch(e){throw e instanceof Error&&e.message.includes("ENCRYPTION_KEY_UNAVAILABLE")||console.error("[StorageEncryptionManager] Failed to decrypt custom rules:",e),e}}async encryptActivityLogs(e){try{const t=JSON.stringify(e);return await this.encrypt(t)}catch(e){throw console.error("[StorageEncryptionManager] Failed to encrypt activity logs:",e),e}}async decryptActivityLogs(e){try{const t=await this.decrypt(e);return JSON.parse(t)}catch(e){throw e instanceof Error&&e.message.includes("ENCRYPTION_KEY_UNAVAILABLE")||console.error("[StorageEncryptionManager] Failed to decrypt activity logs:",e),e}}async encryptAccountData(e){try{const t=JSON.stringify(e);return await this.encrypt(t)}catch(e){throw console.error("[StorageEncryptionManager] Failed to encrypt account data:",e),e}}async decryptAccountData(e){try{const t=await this.decrypt(e);return JSON.parse(t)}catch(e){throw e instanceof Error&&e.message.includes("ENCRYPTION_KEY_UNAVAILABLE")||console.error("[StorageEncryptionManager] Failed to decrypt account data:",e),e}}async getOrGenerateKeyMaterial(){const e="_encryptionKeyMaterial",t=await chrome.storage.local.get(e);if(t[e])return t[e];const n=crypto.getRandomValues(new Uint8Array(32)),r=this.arrayBufferToBase64(n);return await chrome.storage.local.set({[e]:r}),console.log("[StorageEncryptionManager] Generated new encryption key material"),r}async getOrGenerateSalt(){const e="_encryptionSalt",t=await chrome.storage.local.get(e);if(t[e])return t[e];const n=crypto.getRandomValues(new Uint8Array(16)),r=this.arrayBufferToBase64(n);return await chrome.storage.local.set({[e]:r}),console.log("[StorageEncryptionManager] Generated new encryption salt"),r}arrayBufferToBase64(e){let t="";for(let n=0;n<e.byteLength;n++)t+=String.fromCharCode(e[n]);return btoa(t)}base64ToArrayBuffer(e){const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n}setCustomAuth(e){this.customAuthInstance=e}clearCustomAuth(){this.customAuthInstance=null}}class i{constructor(e){this.configCache=null,this.configCacheTimestamp=0,this.CACHE_TTL_MS=5e3,this.encryptionManager=e,chrome.storage.onChanged.addListener((e,t)=>{"local"===t&&e[i.CONFIG_KEY]&&(console.log("[StorageConfigManager] 🔄 Config changed in another context, invalidating cache"),this.configCache=null,this.configCacheTimestamp=0)})}async saveConfig(e){console.log("[StorageConfigManager] 💾 Saving config with encryption...");const t={...e},n=t;if(t.apiKeyVault&&t.apiKeyVault.keys.length>0&&(console.log("[StorageConfigManager] 🔐 Encrypting API key vault..."),n._encryptedApiKeyVault=await this.encryptionManager.encryptAPIKeyVault(t.apiKeyVault),t.apiKeyVault={...t.apiKeyVault,keys:[]},console.log("[StorageConfigManager] ✅ API key vault encrypted")),t.customRules&&t.customRules.rules.length>0&&(console.log("[StorageConfigManager] 🔐 Encrypting custom rules..."),n._encryptedCustomRules=await this.encryptionManager.encryptCustomRules(t.customRules),t.customRules={...t.customRules,rules:[]},console.log("[StorageConfigManager] ✅ Custom rules encrypted")),t.stats&&t.stats.activityLog&&t.stats.activityLog.length>0&&(console.log("[StorageConfigManager] 🔐 Encrypting activity logs..."),n._encryptedActivityLogs=await this.encryptionManager.encryptActivityLogs(t.stats.activityLog),t.stats={...t.stats,activityLog:[]},console.log("[StorageConfigManager] ✅ Activity logs encrypted")),t.account&&(t.account.email||t.account.displayName)){console.log("[StorageConfigManager] 🔐 Encrypting account data...");const e={email:t.account.email,displayName:t.account.displayName,photoURL:t.account.photoURL};n._encryptedAccountData=await this.encryptionManager.encryptAccountData(e),t.account={...t.account,email:void 0,displayName:void 0,photoURL:void 0,firebaseUid:void 0},console.log("[StorageConfigManager] ✅ Account data encrypted")}await chrome.storage.local.set({[i.CONFIG_KEY]:t}),console.log("[StorageConfigManager] ✅ Config saved with all sensitive data encrypted"),this.configCache=e,this.configCacheTimestamp=Date.now()}async loadConfig(){const e=Date.now();if(this.configCache&&e-this.configCacheTimestamp<this.CACHE_TTL_MS)return this.configCache;console.log("[StorageConfigManager] 📂 Loading config from storage (cache miss)");const t=(await chrome.storage.local.get(i.CONFIG_KEY))[i.CONFIG_KEY]||null;if(!t)return console.log("[Theme Debug] 📂 No config found in storage"),null;const n=t;if(n._encryptedApiKeyVault)try{const e=await this.encryptionManager.decryptAPIKeyVault(n._encryptedApiKeyVault);t.apiKeyVault=e,console.log("[StorageConfigManager] ✅ API key vault decrypted")}catch(e){e instanceof Error&&e.message.includes("ENCRYPTION_KEY_UNAVAILABLE")||console.error("[StorageConfigManager] ❌ Failed to decrypt API key vault:",e)}else t.apiKeyVault&&t.apiKeyVault.keys.length>0&&console.warn("[StorageConfigManager] ⚠️ Found plaintext API keys - will encrypt on next save");if(n._encryptedCustomRules)try{const e=await this.encryptionManager.decryptCustomRules(n._encryptedCustomRules);t.customRules=e,console.log("[StorageConfigManager] ✅ Custom rules decrypted")}catch(e){e instanceof Error&&e.message.includes("ENCRYPTION_KEY_UNAVAILABLE")||console.error("[StorageConfigManager] ❌ Failed to decrypt custom rules:",e)}else t.customRules&&t.customRules.rules.length>0&&console.warn("[StorageConfigManager] ⚠️ Found plaintext custom rules - will encrypt on next save");if(n._encryptedActivityLogs)try{const e=await this.encryptionManager.decryptActivityLogs(n._encryptedActivityLogs);t.stats.activityLog=e,console.log("[StorageConfigManager] ✅ Activity logs decrypted")}catch(e){e instanceof Error&&e.message.includes("ENCRYPTION_KEY_UNAVAILABLE")||console.error("[StorageConfigManager] ❌ Failed to decrypt activity logs:",e)}else t.stats&&t.stats.activityLog&&t.stats.activityLog.length>0&&console.warn("[StorageConfigManager] ⚠️ Found plaintext activity logs - will encrypt on next save");if(n._encryptedAccountData)try{const e=await this.encryptionManager.decryptAccountData(n._encryptedAccountData);t.account={...t.account,email:e.email,displayName:e.displayName,photoURL:e.photoURL,firebaseUid:e.firebaseUid},console.log("[StorageConfigManager] ✅ Account data decrypted")}catch(e){e instanceof Error&&e.message.includes("ENCRYPTION_KEY_UNAVAILABLE")||console.error("[StorageConfigManager] ❌ Failed to decrypt account data:",e)}else t.account&&(t.account.email||t.account.displayName)&&console.warn("[StorageConfigManager] ⚠️ Found plaintext account data - will encrypt on next save");return console.log("[Theme Debug] 📂 Config retrieved from chrome.storage.local:",{hasConfig:!!t,theme:t?.settings?.theme||"none",isNull:null===t,hasEncryptedKeys:!!n._encryptedApiKeyVault,hasEncryptedRules:!!n._encryptedCustomRules,hasEncryptedLogs:!!n._encryptedActivityLogs,hasEncryptedAccount:!!n._encryptedAccountData,keyCount:t.apiKeyVault?.keys?.length||0,rulesCount:t.customRules?.rules?.length||0,logsCount:t.stats?.activityLog?.length||0,hasAccountEmail:!!t.account?.email}),t.promptTemplates||(console.log("[StorageConfigManager] 🆕 Adding starter prompt templates to existing config"),t.promptTemplates={templates:this.getStarterTemplates(),maxTemplates:10,enableKeyboardShortcuts:!0},await this.saveConfig(t)),this.configCache=t,this.configCacheTimestamp=Date.now(),t}getDefaultConfig(){return{version:2,account:{emailOptIn:!1,tier:"pro",syncEnabled:!1},settings:{enabled:!0,defaultMode:"auto-replace",showNotifications:!0,decodeResponses:!1,theme:"classic-dark",protectedDomains:["chat.openai.com","chatgpt.com","claude.ai","gemini.google.com","perplexity.ai","copilot.microsoft.com"],excludedDomains:[],strictMode:!1,debugMode:!1,cloudSync:!1},profiles:[],stats:{totalSubstitutions:0,totalInterceptions:0,totalWarnings:0,successRate:1,lastSyncTimestamp:Date.now(),byService:{chatgpt:{requests:0,substitutions:0},claude:{requests:0,substitutions:0},gemini:{requests:0,substitutions:0},perplexity:{requests:0,substitutions:0},copilot:{requests:0,substitutions:0}},activityLog:[]},promptTemplates:{templates:this.getStarterTemplates(),maxTemplates:10,enableKeyboardShortcuts:!0}}}getStarterTemplates(){const e=Date.now();return[{id:"starter-professional-email",isStarter:!0,readonly:!1,name:"Professional Email",description:"Generate a professional email using your protected identity",content:"Write a professional email with the following details:\n\nFrom: {{name}} ({{email}})\nCompany: {{company}}\nSubject: [Your subject here]\n\nPlease draft a polite, professional email that:\n- Introduces myself and my company\n- Clearly states the purpose\n- Includes a call to action\n- Ends with appropriate closing\n\nTone: Professional and friendly",category:"Email",usageCount:0,createdAt:e,updatedAt:e,lastUsed:void 0},{id:"starter-code-review",isStarter:!0,readonly:!1,name:"Code Review Request",description:"Request AI to review code as your developer persona",content:"I'm {{name}}, a developer at {{company}}. Please review the following code:\n\n[Paste your code here]\n\nSpecifically, please check for:\n- Security vulnerabilities\n- Performance issues\n- Code style and best practices\n- Potential bugs or edge cases\n\nProvide feedback as if you're conducting a professional code review.",category:"Code Review",usageCount:0,createdAt:e,updatedAt:e,lastUsed:void 0},{id:"starter-meeting-summary",isStarter:!0,readonly:!1,name:"Meeting Summary",description:"Create meeting notes using your work identity",content:"Create professional meeting notes for:\n\nAttendee: {{name}} ({{email}})\nCompany: {{company}}\nDate: [Today's date]\nTopic: [Meeting topic]\n\nPlease help me structure meeting notes that include:\n- Key discussion points\n- Action items and owners\n- Decisions made\n- Next steps and timeline\n\nKeep it concise and professional, suitable for sharing with stakeholders.",category:"Writing",usageCount:0,createdAt:e,updatedAt:e,lastUsed:void 0}]}clearCache(){this.configCache=null,this.configCacheTimestamp=0}}function o(e){if(!e||""===e.trim())return[];const t=new Set;t.add(e.trim());const n=e.replace(/\D/g,"");if(0===n.length)return[e];if(t.add(n),10===n.length){const e=n.slice(0,3),r=n.slice(3,6),s=n.slice(6,10);t.add(`(${e}) ${r}-${s}`),t.add(`${e}-${r}-${s}`),t.add(`${e}.${r}.${s}`),t.add(`${e} ${r} ${s}`),t.add(`+1 ${e} ${r} ${s}`),t.add(`+1-${e}-${r}-${s}`),t.add(`1-${e}-${r}-${s}`)}else if(11===n.length&&n.startsWith("1")){const e=n.slice(1,4),r=n.slice(4,7),s=n.slice(7,11);t.add(`+${n}`),t.add(`+1 ${e} ${r} ${s}`),t.add(`+1-${e}-${r}-${s}`),t.add(`1-${e}-${r}-${s}`),t.add(`(${e}) ${r}-${s}`)}return Array.from(t)}function a(e){if(!e||""===e.trim())return[];const t=new Set,n=e.trim();t.add(n),t.add(n.toLowerCase()),t.add(n.toUpperCase());const r=n.split(/\s+/).map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ");return t.add(r),Array.from(t)}function c(e){const t={};return e.name&&(t.name=function(e){if(!e||""===e.trim())return[];const t=new Set,n=e.trim();t.add(n);const r=n.split(/\s+/);if(0===r.length)return[n];if(1===r.length){const e=r[0];return t.add(e),t.add(e.toLowerCase()),t.add(e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()),t.add(e.toUpperCase()),Array.from(t)}const s=r[0],i=r[r.length-1],o=r.slice(1,-1);t.add(r.join(" ")),t.add(r.join("")),t.add(r.join("").toLowerCase()),t.add(r.join(" ").toLowerCase());const a=r.map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ");return t.add(a),t.add(a.replace(/\s+/g,"")),t.add(`${s.charAt(0).toLowerCase()}${i.toLowerCase()}`),t.add(`${s.charAt(0).toUpperCase()}${i.toLowerCase()}`),t.add(`${s.charAt(0).toLowerCase()}${i}`),t.add(`${s.charAt(0).toUpperCase()}${i}`),t.add(`${s.charAt(0).toUpperCase()}. ${i}`),t.add(`${s.charAt(0).toUpperCase()}.${i}`),o.length>0&&(t.add(`${s} ${i}`),t.add(`${s}${i}`),t.add(`${s.toLowerCase()}${i.toLowerCase()}`)),t.add(r.join(" ").toUpperCase()),t.add(r.join("").toUpperCase()),t.add(r.join("_").toLowerCase()),t.add(r.join("_").toUpperCase()),t.add(r.join("-").toLowerCase()),t.add(r.join("-")),t.add(r.join(".").toLowerCase()),t.add(r.join(".")),Array.from(t).filter(e=>e.length>0)}(e.name)),e.email&&(t.email=function(e){if(!e||!e.includes("@"))return[];const t=new Set,n=e.trim().toLowerCase();t.add(n);const[r,s]=n.split("@"),i=r.replace(/\./g,"");if(t.add(`${i}@${s}`),r.includes(".")){const e=r.split("."),n=e[0]+e.slice(1).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join("");t.add(`${n}@${s}`)}r.includes("_")&&t.add(`${r.replace(/_/g,".")}@${s}`),r.includes(".")&&t.add(`${r.replace(/\./g,"_")}@${s}`);const o=r.charAt(0).toUpperCase()+r.slice(1);return t.add(`${o}@${s}`),Array.from(t)}(e.email)),e.phone&&(t.phone=o(e.phone)),e.cellPhone&&(t.cellPhone=o(e.cellPhone)),e.company&&(t.company=a(e.company)),e.address&&(t.address=a(e.address)),t}i.CONFIG_KEY="config";class l{constructor(e,t){this.encryptionManager=e,this.configManager=t}async saveProfiles(e){const t=await this.encryptionManager.encrypt(JSON.stringify(e));await chrome.storage.local.set({[l.PROFILES_KEY]:t})}async loadProfiles(){const e=await chrome.storage.local.get(l.PROFILES_KEY);if(!e[l.PROFILES_KEY])return[];const t=e[l.PROFILES_KEY];try{console.log("[StorageProfileManager] Attempting decryption with Firebase UID key...");const e=await this.encryptionManager.decrypt(t),n=JSON.parse(e);return console.log("[StorageProfileManager] ✅ Firebase UID decryption successful"),n}catch(e){console.error("[StorageProfileManager] ❌ Profiles decryption failed:",e),console.error("[StorageProfileManager] Error type:",e instanceof Error?e.constructor.name:typeof e),console.error("[StorageProfileManager] Error message:",e instanceof Error?e.message:String(e));const n=!!(await chrome.storage.local.get("_encryptionKeyMaterial"))._encryptionKeyMaterial;if(console.log("[StorageProfileManager] Legacy key check:",{hasLegacyKey:n}),!n){if(console.log("[StorageProfileManager] Data already migrated to Firebase UID (no legacy key found)"),e instanceof Error&&e.message.includes("ENCRYPTION_KEY_UNAVAILABLE"))throw e;const t=e instanceof Error?e.message:String(e);throw new Error(`DECRYPTION_FAILED: Profiles encrypted with Firebase UID. Authentication required. Original error: ${t}`)}console.warn("[StorageProfileManager] Legacy key found - attempting legacy key migration...");try{const e=await this.encryptionManager.getLegacyEncryptionKey(),n=await this.encryptionManager.decryptWithKey(t,e),r=JSON.parse(n);return console.log("[StorageProfileManager] ✅ Legacy decryption successful"),"undefined"==typeof document?(console.log("[StorageProfileManager] ⏭️ Running in service worker - skipping migration (will happen in popup)"),r):(console.log("[StorageProfileManager] 🔄 Migrating to Firebase UID encryption..."),await this.saveProfiles(r),await chrome.storage.local.remove("_encryptionKeyMaterial"),console.log("[StorageProfileManager] ✅ Migration complete - old key material removed"),console.log("[StorageProfileManager] 🔐 Data now encrypted with Firebase UID"),r)}catch(t){if(console.error("[StorageProfileManager] Both decryption methods failed:",t),console.error("[StorageProfileManager] Original error:",e),e instanceof Error&&e.message.includes("ENCRYPTION_KEY_UNAVAILABLE"))throw e;throw new Error("DECRYPTION_FAILED: Cannot decrypt profiles. Data may be corrupted or authentication required.")}}}async createProfile(e){const t=await this.loadProfiles(),n=await this.configManager.loadConfig(),r="free"===n?.account?.tier;if(r&&t.length>=1)throw new Error("FREE_TIER_LIMIT: You can only create 1 profile on the FREE tier. Upgrade to PRO for unlimited profiles.");let s;r||(s={real:c(e.real),alias:c(e.alias)});const i={id:this.generateId(),profileName:e.profileName,description:e.description,enabled:e.enabled??!0,real:e.real,alias:e.alias,variations:s,metadata:{createdAt:Date.now(),updatedAt:Date.now(),usageStats:{totalSubstitutions:0,lastUsed:0,byService:{chatgpt:0,claude:0,gemini:0,perplexity:0,copilot:0},byPIIType:{name:0,email:0,phone:0,cellPhone:0,address:0,company:0,custom:0}},confidence:1},settings:{autoReplace:!0,highlightInUI:!0,activeServices:["chatgpt","claude","gemini"],enableVariations:!r}};return t.push(i),await this.saveProfiles(t),console.log("[StorageProfileManager] Created profile:",i.profileName,"with variations"),i}async updateProfile(e,t){const n=await this.loadProfiles(),r=n.findIndex(t=>t.id===e);if(-1!==r){const e={...n[r],...t,metadata:{...n[r].metadata,updatedAt:Date.now()},settings:{...n[r].settings,...t.settings||{}}};if(t.real||t.alias){const t=await this.configManager.loadConfig();if("free"===t?.account?.tier)e.variations=void 0,console.log("[StorageProfileManager] Variations disabled for FREE tier profile:",e.profileName);else{const t=c(e.real),n=c(e.alias);e.variations={real:t,alias:n},console.log("[StorageProfileManager] Regenerated variations for profile:",e.profileName)}}n[r]=e,await this.saveProfiles(n),console.log("[StorageProfileManager] Updated profile:",n[r].profileName)}}async deleteProfile(e){const t=(await this.loadProfiles()).filter(t=>t.id!==e);await this.saveProfiles(t),console.log("[StorageProfileManager] Deleted profile:",e)}async toggleProfile(e){const t=await this.loadProfiles(),n=t.findIndex(t=>t.id===e);-1!==n&&(t[n].enabled=!t[n].enabled,t[n].metadata.updatedAt=Date.now(),await this.saveProfiles(t),console.log("[StorageProfileManager] Toggled profile:",t[n].profileName,"to",t[n].enabled))}async getProfile(e){return(await this.loadProfiles()).find(t=>t.id===e)||null}async incrementProfileUsage(e,t,n){const r=await this.loadProfiles(),s=r.findIndex(t=>t.id===e);if(-1!==s){const e=r[s];e.metadata.usageStats.totalSubstitutions++,e.metadata.usageStats.lastUsed=Date.now(),e.metadata.usageStats.byService[t]++,e.metadata.usageStats.byPIIType[n]++,e.metadata.updatedAt=Date.now(),await this.saveProfiles(r)}}generateId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}}l.PROFILES_KEY="profiles";class u{constructor(e){this.configManager=e}async ensureAPIKeyVaultConfig(e){e.apiKeyVault||(e.apiKeyVault={enabled:!0,mode:"warn-first",autoDetectPatterns:!0,keys:[],customPatterns:[]})}async addAPIKey(e){const t=await this.configManager.loadConfig();if(!t)throw new Error("Config not initialized");if(await this.ensureAPIKeyVaultConfig(t),"free"===t.account?.tier){if(t.apiKeyVault.keys.length>=10)throw new Error("FREE_TIER_LIMIT: Upgrade to PRO for unlimited keys");if("openai"!==(e.format||this.detectKeyFormat(e.keyValue)))throw new Error("FREE_TIER_PATTERN: Upgrade to PRO for non-OpenAI key detection")}const n={id:this.generateId(),name:e.name,keyValue:e.keyValue,format:e.format||this.detectKeyFormat(e.keyValue),createdAt:Date.now(),lastUsed:0,protectionCount:0,enabled:!0};return t.apiKeyVault.keys.push(n),await this.configManager.saveConfig(t),console.log("[StorageAPIKeyVaultManager] Added API key:",n.format,n.name),n}async removeAPIKey(e){const t=await this.configManager.loadConfig();t&&t.apiKeyVault&&(t.apiKeyVault.keys=t.apiKeyVault.keys.filter(t=>t.id!==e),await this.configManager.saveConfig(t),console.log("[StorageAPIKeyVaultManager] Removed API key:",e))}async updateAPIKey(e,t){const n=await this.configManager.loadConfig();if(!n||!n.apiKeyVault)return;const r=n.apiKeyVault.keys.findIndex(t=>t.id===e);-1!==r&&(n.apiKeyVault.keys[r]={...n.apiKeyVault.keys[r],...t},await this.configManager.saveConfig(n),console.log("[StorageAPIKeyVaultManager] Updated API key:",e))}async getAPIKey(e){const t=await this.configManager.loadConfig();return t&&t.apiKeyVault&&t.apiKeyVault.keys.find(t=>t.id===e)||null}async getAllAPIKeys(){const e=await this.configManager.loadConfig();return e&&e.apiKeyVault?e.apiKeyVault.keys:[]}async incrementAPIKeyProtection(e){const t=await this.configManager.loadConfig();if(!t||!t.apiKeyVault)return;const n=t.apiKeyVault.keys.find(t=>t.id===e);n&&(n.protectionCount++,n.lastUsed=Date.now(),await this.configManager.saveConfig(t))}async updateAPIKeyVaultSettings(e){const t=await this.configManager.loadConfig();t&&(await this.ensureAPIKeyVaultConfig(t),t.apiKeyVault={...t.apiKeyVault,...e},await this.configManager.saveConfig(t),console.log("[StorageAPIKeyVaultManager] Updated API Key Vault settings"))}detectKeyFormat(e){return/^sk-(proj-)?[A-Za-z0-9]{48,}/.test(e)?"openai":/^sk-ant-[A-Za-z0-9-]{95}/.test(e)?"anthropic":/^AIza[A-Za-z0-9_-]{35}/.test(e)?"google":/^(AKIA|ASIA)[A-Z0-9]{16}/.test(e)?"aws":/^gh[ps]_[A-Za-z0-9]{36}/.test(e)?"github":/^(sk|pk)_(live|test)_[A-Za-z0-9]{24,}/.test(e)?"stripe":"generic"}generateId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}}class h{constructor(e){this.configManager=e}async ensureCustomRulesConfig(e){e.customRules||(e.customRules={enabled:!0,rules:[]})}async addCustomRule(e){const t=await this.configManager.loadConfig();if(!t)throw new Error("Failed to load config");if(await this.ensureCustomRulesConfig(t),"free"===t.account?.tier)throw new Error("PRO_FEATURE: Custom redaction rules are a PRO feature. Upgrade to PRO to create custom rules.");const n=crypto.randomUUID(),r={id:n,name:e.name,pattern:e.pattern,replacement:e.replacement,enabled:!0,priority:e.priority??50,category:e.category,description:e.description,createdAt:Date.now(),matchCount:0,testCases:e.testCases};return t.customRules.rules.push(r),await this.configManager.saveConfig(t),console.log("[StorageCustomRulesManager] Added custom rule:",n),n}async removeCustomRule(e){const t=await this.configManager.loadConfig();t?.customRules&&(t.customRules.rules=t.customRules.rules.filter(t=>t.id!==e),await this.configManager.saveConfig(t),console.log("[StorageCustomRulesManager] Removed custom rule:",e))}async updateCustomRule(e,t){const n=await this.configManager.loadConfig();if(!n?.customRules)return;const r=n.customRules.rules.findIndex(t=>t.id===e);if(-1===r)throw new Error(`Rule not found: ${e}`);n.customRules.rules[r]={...n.customRules.rules[r],...t},await this.configManager.saveConfig(n),console.log("[StorageCustomRulesManager] Updated custom rule:",e)}async toggleCustomRule(e){const t=await this.configManager.loadConfig();if(!t?.customRules)return;const n=t.customRules.rules.find(t=>t.id===e);n&&(n.enabled=!n.enabled,await this.configManager.saveConfig(t),console.log("[StorageCustomRulesManager] Toggled custom rule:",e,"enabled:",n.enabled))}async incrementRuleMatchCount(e){const t=await this.configManager.loadConfig();if(!t?.customRules)return;const n=t.customRules.rules.find(t=>t.id===e);n&&(n.matchCount++,n.lastUsed=Date.now(),await this.configManager.saveConfig(t))}async updateCustomRulesSettings(e){const t=await this.configManager.loadConfig();t&&(await this.ensureCustomRulesConfig(t),t.customRules={...t.customRules,...e},await this.configManager.saveConfig(t),console.log("[StorageCustomRulesManager] Updated custom rules settings"))}}class d{constructor(e){this.configManager=e}async ensurePromptTemplatesConfig(e){if(!e.promptTemplates){const t=e.account?.tier||"free";e.promptTemplates={templates:[],maxTemplates:"pro"===t||"enterprise"===t?-1:3,enableKeyboardShortcuts:!0}}}async addPromptTemplate(e){const t=await this.configManager.loadConfig();if(!t)throw new Error("Config not initialized");if(await this.ensurePromptTemplatesConfig(t),"free"===t.account?.tier)throw new Error("PRO_FEATURE: Creating custom templates requires PRO tier. Upgrade to unlock unlimited templates.");const n={id:this.generateId(),name:e.name,content:e.content,description:e.description,category:e.category,tags:e.tags,profileId:e.profileId,createdAt:Date.now(),updatedAt:Date.now(),usageCount:0,lastUsed:void 0};return t.promptTemplates.templates.push(n),await this.configManager.saveConfig(t),console.log("[StoragePromptTemplatesManager] Added prompt template:",n.name),n}async removePromptTemplate(e){const t=await this.configManager.loadConfig();t&&t.promptTemplates&&(t.promptTemplates.templates=t.promptTemplates.templates.filter(t=>t.id!==e),await this.configManager.saveConfig(t),console.log("[StoragePromptTemplatesManager] Removed prompt template:",e))}async updatePromptTemplate(e,t){const n=await this.configManager.loadConfig();if(!n||!n.promptTemplates)return;const r=n.promptTemplates.templates.find(t=>t.id===e);if(r){if("free"===n.account?.tier&&r.isStarter)throw new Error("PRO_FEATURE: Editing templates requires PRO tier. Upgrade to unlock.");Object.assign(r,t,{updatedAt:Date.now()}),await this.configManager.saveConfig(n),console.log("[StoragePromptTemplatesManager] Updated prompt template:",e)}else console.error("[StoragePromptTemplatesManager] Template not found:",e)}async getPromptTemplate(e){const t=await this.configManager.loadConfig();return t&&t.promptTemplates&&t.promptTemplates.templates.find(t=>t.id===e)||null}async getAllPromptTemplates(){const e=await this.configManager.loadConfig();return e&&e.promptTemplates?e.promptTemplates.templates:[]}async incrementTemplateUsage(e){const t=await this.configManager.loadConfig();if(!t||!t.promptTemplates)return;const n=t.promptTemplates.templates.find(t=>t.id===e);n&&(n.usageCount++,n.lastUsed=Date.now(),await this.configManager.saveConfig(t),console.log("[StoragePromptTemplatesManager] Incremented template usage:",e))}async updatePromptTemplatesSettings(e){const t=await this.configManager.loadConfig();t&&(await this.ensurePromptTemplatesConfig(t),t.promptTemplates={...t.promptTemplates,...e},await this.configManager.saveConfig(t),console.log("[StoragePromptTemplatesManager] Updated prompt templates settings"))}generateId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}}class p{constructor(e){this.encryptionManager=e}async loadDocumentAliases(){const e=await chrome.storage.local.get(p.DOCUMENT_ALIASES_KEY);if(!e[p.DOCUMENT_ALIASES_KEY])return[];const t=[];for(const n of e[p.DOCUMENT_ALIASES_KEY])try{const e=await this.encryptionManager.decrypt(n.encryptedData);t.push(JSON.parse(e))}catch(e){console.error("[StorageDocumentAliasManager] Failed to decrypt document:",n.id,e)}return t.sort((e,t)=>t.createdAt-e.createdAt)}async saveDocumentAlias(e){const t=await this.encryptionManager.encrypt(JSON.stringify(e)),n=(await chrome.storage.local.get(p.DOCUMENT_ALIASES_KEY))[p.DOCUMENT_ALIASES_KEY]||[];n.push({id:e.id,documentName:e.documentName,createdAt:e.createdAt,encryptedData:t}),n.length>p.MAX_DOCUMENTS&&(n.sort((e,t)=>t.createdAt-e.createdAt),n.splice(p.MAX_DOCUMENTS),console.log(`[StorageDocumentAliasManager] Trimmed to ${p.MAX_DOCUMENTS} documents`)),await chrome.storage.local.set({[p.DOCUMENT_ALIASES_KEY]:n}),console.log("[StorageDocumentAliasManager] Saved document alias:",e.id)}async deleteDocumentAlias(e){const t=((await chrome.storage.local.get(p.DOCUMENT_ALIASES_KEY))[p.DOCUMENT_ALIASES_KEY]||[]).filter(t=>t.id!==e);await chrome.storage.local.set({[p.DOCUMENT_ALIASES_KEY]:t}),console.log("[StorageDocumentAliasManager] Deleted document alias:",e)}async updateDocumentAlias(e){const t=(await chrome.storage.local.get(p.DOCUMENT_ALIASES_KEY))[p.DOCUMENT_ALIASES_KEY]||[],n=t.findIndex(t=>t.id===e.id);if(-1!==n){const r=await this.encryptionManager.encrypt(JSON.stringify(e));t[n]={id:e.id,documentName:e.documentName,createdAt:e.createdAt,encryptedData:r},await chrome.storage.local.set({[p.DOCUMENT_ALIASES_KEY]:t}),console.log("[StorageDocumentAliasManager] Updated document alias:",e.id)}}}function g(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}p.DOCUMENT_ALIASES_KEY="documentAliases",p.MAX_DOCUMENTS=50;class f{constructor(e,t,n){this.encryptionManager=e,this.configManager=t,this.profileManager=n}async initialize(){const e="undefined"==typeof document;try{await this.migrateV1ToV2IfNeeded(),await this.migrateAPIKeysToEncryptedIfNeeded(),await this.configManager.loadConfig()||await this.configManager.saveConfig(this.configManager.getDefaultConfig());const t=await this.profileManager.loadProfiles();t&&0!==t.length||await this.profileManager.saveProfiles([]),console.log(`[StorageMigrationManager] ✅ Initialized with ${t.length} profiles in ${e?"SERVICE WORKER":"POPUP"} context`)}catch(e){if(e instanceof Error&&e.message.includes("ENCRYPTION_KEY_UNAVAILABLE"))return void console.log("[StorageMigrationManager] User not authenticated - skipping data initialization");if(e instanceof Error&&e.message.includes("DECRYPTION_FAILED"))return console.warn("[StorageMigrationManager] ⚠️ Decryption failed - possible UID mismatch"),console.warn("[StorageMigrationManager] App will run with empty profiles. Sign in with original provider to access encrypted data."),void("undefined"!=typeof document&&setTimeout(()=>{const e=new CustomEvent("auth-decryption-failed");window.dispatchEvent(e)},100));throw e}}async migrateV1ToV2IfNeeded(){if((await chrome.storage.local.get(f.KEYS.VERSION))[f.KEYS.VERSION]>=2)return void console.log("[StorageMigrationManager] Already on v2");const e=await this.loadAliasesForMigration();if(!e||0===e.length)return console.log("[StorageMigrationManager] No v1 data to migrate"),void await chrome.storage.local.set({[f.KEYS.VERSION]:2});console.log("[StorageMigrationManager] Migrating v1 aliases to v2 profiles...");const t=new Map;e.forEach(e=>{const n=e.category||`profile-${e.id}`;t.has(n)||t.set(n,[]),t.get(n).push(e)});const n=[];t.forEach((e,t)=>{const r={},s={};e.forEach(e=>{switch(e.type){case"name":r.name=e.realValue,s.name=e.aliasValue;break;case"email":r.email=e.realValue,s.email=e.aliasValue;break;case"phone":r.phone=e.realValue,s.phone=e.aliasValue;break;case"address":r.address=e.realValue,s.address=e.aliasValue}});const i=e.reduce((e,t)=>e+t.metadata.usageCount,0),o=Math.max(...e.map(e=>e.metadata.lastUsed)),a=Math.min(...e.map(e=>e.metadata.createdAt)),c={id:g(),profileName:t===`profile-${e[0].id}`?`Profile - ${r.name||r.email||"Unknown"}`:t,description:"Migrated from v1",enabled:e[0].enabled,real:r,alias:s,metadata:{createdAt:a,updatedAt:Date.now(),usageStats:{totalSubstitutions:i,lastUsed:o,byService:{chatgpt:0,claude:0,gemini:0,perplexity:0,copilot:0},byPIIType:{name:0,email:0,phone:0,cellPhone:0,address:0,company:0,custom:0}},confidence:e[0].metadata.confidence},settings:{autoReplace:!0,highlightInUI:!0,activeServices:["chatgpt","claude","gemini"],enableVariations:!0}};n.push(c)}),await this.profileManager.saveProfiles(n);const r=await this.configManager.loadConfig();if(r){const e={version:2,account:{emailOptIn:!1,tier:"free",syncEnabled:!1},settings:{enabled:r.settings.enabled,defaultMode:"auto-replace",showNotifications:r.settings.showNotifications,decodeResponses:!1,theme:"classic-dark",protectedDomains:r.settings.protectedDomains,excludedDomains:r.settings.excludedDomains,strictMode:r.settings.strictMode,debugMode:!1,cloudSync:!1},profiles:n,stats:{totalSubstitutions:r.stats.totalSubstitutions,totalInterceptions:0,totalWarnings:0,successRate:r.stats.successRate,lastSyncTimestamp:r.stats.lastSyncTimestamp,byService:{chatgpt:{requests:0,substitutions:0},claude:{requests:0,substitutions:0},gemini:{requests:0,substitutions:0},perplexity:{requests:0,substitutions:0},copilot:{requests:0,substitutions:0}},activityLog:[]}};await this.configManager.saveConfig(e)}await chrome.storage.local.set({[f.KEYS.VERSION]:2}),console.log(`[StorageMigrationManager] Migration complete! Created ${n.length} profiles from ${e.length} aliases`)}async migrateAPIKeysToEncryptedIfNeeded(){const e=(await chrome.storage.local.get(f.KEYS.CONFIG))[f.KEYS.CONFIG];if(!e)return;const t=e;let n=!1;const r=e.apiKeyVault&&e.apiKeyVault.keys.length>0,s=!!t._encryptedApiKeyVault;if(r&&!s){console.log("[StorageMigrationManager] 🔐 Migrating plaintext API keys to encrypted storage..."),console.log(`[StorageMigrationManager] Found ${e.apiKeyVault.keys.length} plaintext API keys`);try{const r=await this.encryptionManager.encryptAPIKeyVault(e.apiKeyVault);t._encryptedApiKeyVault=r,e.apiKeyVault={...e.apiKeyVault,keys:[]},n=!0,console.log("[StorageMigrationManager] ✅ API key migration complete - keys are now encrypted")}catch(e){console.error("[StorageMigrationManager] ❌ Failed to migrate API keys:",e)}}const i=e.customRules&&e.customRules.rules.length>0,o=!!t._encryptedCustomRules;if(i&&!o){console.log("[StorageMigrationManager] 🔐 Migrating plaintext custom rules to encrypted storage..."),console.log(`[StorageMigrationManager] Found ${e.customRules.rules.length} plaintext custom rules`);try{const r=await this.encryptionManager.encryptCustomRules(e.customRules);t._encryptedCustomRules=r,e.customRules={...e.customRules,rules:[]},n=!0,console.log("[StorageMigrationManager] ✅ Custom rules migration complete - rules are now encrypted")}catch(e){console.error("[StorageMigrationManager] ❌ Failed to migrate custom rules:",e)}}const a=e.stats&&e.stats.activityLog&&e.stats.activityLog.length>0,c=!!t._encryptedActivityLogs;if(a&&!c){console.log("[StorageMigrationManager] 🔐 Migrating plaintext activity logs to encrypted storage..."),console.log(`[StorageMigrationManager] Found ${e.stats.activityLog.length} plaintext activity log entries`);try{const r=await this.encryptionManager.encryptActivityLogs(e.stats.activityLog);t._encryptedActivityLogs=r,e.stats={...e.stats,activityLog:[]},n=!0,console.log("[StorageMigrationManager] ✅ Activity logs migration complete - logs are now encrypted")}catch(e){console.error("[StorageMigrationManager] ❌ Failed to migrate activity logs:",e)}}const l=e.account&&(e.account.email||e.account.displayName),u=!!t._encryptedAccountData;if(l&&!u){console.log("[StorageMigrationManager] 🔐 Migrating plaintext account data to encrypted storage..."),console.log("[StorageMigrationManager] Found plaintext account data (email, displayName, etc.)");try{const r={email:e.account.email,displayName:e.account.displayName,photoURL:e.account.photoURL,firebaseUid:e.account.firebaseUid},s=await this.encryptionManager.encryptAccountData(r);t._encryptedAccountData=s,e.account={...e.account,email:void 0,displayName:void 0,photoURL:void 0,firebaseUid:void 0},n=!0,console.log("[StorageMigrationManager] ✅ Account data migration complete - account data is now encrypted")}catch(e){console.error("[StorageMigrationManager] ❌ Failed to migrate account data:",e)}}n&&(await chrome.storage.local.set({[f.KEYS.CONFIG]:e}),console.log("[StorageMigrationManager] 🎉 All sensitive data migration complete - all data is now encrypted"))}async loadAliasesForMigration(){const e=await chrome.storage.local.get(f.KEYS.ALIASES);if(!e[f.KEYS.ALIASES])return[];const t=e[f.KEYS.ALIASES];try{const e=await this.encryptionManager.decrypt(t);return JSON.parse(e)}catch(e){if(!(await chrome.storage.local.get("_encryptionKeyMaterial"))._encryptionKeyMaterial){if(console.log("[StorageMigrationManager] Aliases already migrated to Firebase UID"),e instanceof Error&&e.message.includes("ENCRYPTION_KEY_UNAVAILABLE"))throw e;return[]}console.warn("[StorageMigrationManager] Aliases: Firebase UID decryption failed, attempting legacy migration...");try{const e=await this.encryptionManager.getLegacyEncryptionKey(),n=await this.encryptionManager.decryptWithKey(t,e),r=JSON.parse(n);if(console.log("[StorageMigrationManager] ✅ Legacy aliases decrypted"),"undefined"==typeof document)return console.log("[StorageMigrationManager] ⏭️ Running in service worker - skipping aliases migration"),r;console.log("[StorageMigrationManager] 🔄 Migrating aliases to Firebase UID...");const s=await this.encryptionManager.encrypt(JSON.stringify(r));return await chrome.storage.local.set({[f.KEYS.ALIASES]:s}),r}catch(t){if(console.error("[StorageMigrationManager] Failed to decrypt aliases:",t),e instanceof Error&&e.message.includes("ENCRYPTION_KEY_UNAVAILABLE"))throw e;return[]}}}}f.KEYS={ALIASES:"aliases",PROFILES:"profiles",CONFIG:"config",VERSION:"dataVersion"};class m{constructor(){this.encryptionManager=new s,this.configManager=new i(this.encryptionManager),this.profileManager=new l(this.encryptionManager,this.configManager),this.apiKeyVaultManager=new u(this.configManager),this.customRulesManager=new h(this.configManager),this.promptTemplatesManager=new d(this.configManager),this.documentAliasManager=new p(this.encryptionManager),this.migrationManager=new f(this.encryptionManager,this.configManager,this.profileManager),this.setupStorageChangeListener(),this.setupAuthListener()}setupAuthListener(){"undefined"!=typeof document?Promise.resolve().then(n.bind(n,51)).then(({auth:e})=>{e.onAuthStateChanged(e=>{console.log("[StorageManager] 🔐 Auth state changed:",e?"Signed in":"Signed out"),console.log("[StorageManager] 🔄 Invalidating cache due to auth state change"),this.configManager.clearCache()})}).catch(e=>{console.error("[StorageManager] Failed to setup auth listener:",e)}):console.log("[StorageManager] Running in service worker context - skipping auth listener setup")}setupStorageChangeListener(){chrome.storage.onChanged.addListener((e,t)=>{"local"===t&&e[m.KEYS.CONFIG]&&console.log("[StorageManager] 🔄 Config changed in another context")})}static getInstance(){return m.instance||(m.instance=new m),m.instance}setCustomAuth(e){this.encryptionManager.setCustomAuth(e),console.log("[StorageManager] Custom auth instance configured for testing")}clearCustomAuth(){this.encryptionManager.clearCustomAuth(),console.log("[StorageManager] Cleared custom auth instance")}async initialize(){return this.migrationManager.initialize()}async saveConfig(e){return this.configManager.saveConfig(e)}async loadConfig(){return this.configManager.loadConfig()}clearCache(){this.configManager.clearCache()}async saveProfiles(e){return this.profileManager.saveProfiles(e)}async loadProfiles(){return this.profileManager.loadProfiles()}async createProfile(e){return this.profileManager.createProfile(e)}async updateProfile(e,t){return this.profileManager.updateProfile(e,t)}async deleteProfile(e){return this.profileManager.deleteProfile(e)}async toggleProfile(e){return this.profileManager.toggleProfile(e)}async getProfile(e){return this.profileManager.getProfile(e)}async incrementProfileUsage(e,t,n){return this.profileManager.incrementProfileUsage(e,t,n)}async saveAliases(e){const t=await this.encryptionManager.encrypt(JSON.stringify(e));await chrome.storage.local.set({[m.KEYS.ALIASES]:t})}async loadAliases(){const e=await chrome.storage.local.get(m.KEYS.ALIASES);if(!e[m.KEYS.ALIASES])return[];const t=e[m.KEYS.ALIASES];try{const e=await this.encryptionManager.decrypt(t);return JSON.parse(e)}catch(e){if(!(await chrome.storage.local.get("_encryptionKeyMaterial"))._encryptionKeyMaterial){if(console.log("[StorageManager] Aliases already migrated to Firebase UID"),e instanceof Error&&e.message.includes("ENCRYPTION_KEY_UNAVAILABLE"))throw e;return[]}console.warn("[StorageManager] Aliases: Firebase UID decryption failed, attempting legacy migration...");try{const e=await this.encryptionManager.getLegacyEncryptionKey(),n=await this.encryptionManager.decryptWithKey(t,e),r=JSON.parse(n);return console.log("[StorageManager] ✅ Legacy aliases decrypted"),"undefined"==typeof document?(console.log("[StorageManager] ⏭️ Running in service worker - skipping aliases migration"),r):(console.log("[StorageManager] 🔄 Migrating aliases to Firebase UID..."),await this.saveAliases(r),r)}catch(t){if(console.error("[StorageManager] Failed to decrypt aliases:",t),e instanceof Error&&e.message.includes("ENCRYPTION_KEY_UNAVAILABLE"))throw e;return[]}}}async addAlias(e){const t=await this.loadAliases(),n={...e,id:g(),metadata:{createdAt:Date.now(),usageCount:0,lastUsed:0,confidence:1}};return t.push(n),await this.saveAliases(t),n}async removeAlias(e){const t=(await this.loadAliases()).filter(t=>t.id!==e);await this.saveAliases(t)}async updateAlias(e,t){const n=await this.loadAliases(),r=n.findIndex(t=>t.id===e);-1!==r&&(n[r]={...n[r],...t},await this.saveAliases(n))}async addAPIKey(e){return this.apiKeyVaultManager.addAPIKey(e)}async removeAPIKey(e){return this.apiKeyVaultManager.removeAPIKey(e)}async updateAPIKey(e,t){return this.apiKeyVaultManager.updateAPIKey(e,t)}async getAPIKey(e){return this.apiKeyVaultManager.getAPIKey(e)}async getAllAPIKeys(){return this.apiKeyVaultManager.getAllAPIKeys()}async incrementAPIKeyProtection(e){return this.apiKeyVaultManager.incrementAPIKeyProtection(e)}async updateAPIKeyVaultSettings(e){return this.apiKeyVaultManager.updateAPIKeyVaultSettings(e)}async addCustomRule(e){return this.customRulesManager.addCustomRule(e)}async removeCustomRule(e){return this.customRulesManager.removeCustomRule(e)}async updateCustomRule(e,t){return this.customRulesManager.updateCustomRule(e,t)}async toggleCustomRule(e){return this.customRulesManager.toggleCustomRule(e)}async incrementRuleMatchCount(e){return this.customRulesManager.incrementRuleMatchCount(e)}async updateCustomRulesSettings(e){return this.customRulesManager.updateCustomRulesSettings(e)}async addPromptTemplate(e){return this.promptTemplatesManager.addPromptTemplate(e)}async removePromptTemplate(e){return this.promptTemplatesManager.removePromptTemplate(e)}async updatePromptTemplate(e,t){return this.promptTemplatesManager.updatePromptTemplate(e,t)}async getPromptTemplate(e){return this.promptTemplatesManager.getPromptTemplate(e)}async getAllPromptTemplates(){return this.promptTemplatesManager.getAllPromptTemplates()}async incrementTemplateUsage(e){return this.promptTemplatesManager.incrementTemplateUsage(e)}async updatePromptTemplatesSettings(e){return this.promptTemplatesManager.updatePromptTemplatesSettings(e)}async loadDocumentAliases(){return this.documentAliasManager.loadDocumentAliases()}async saveDocumentAlias(e){return this.documentAliasManager.saveDocumentAlias(e)}async deleteDocumentAlias(e){return this.documentAliasManager.deleteDocumentAlias(e)}async updateDocumentAlias(e){return this.documentAliasManager.updateDocumentAlias(e)}async getStorageQuota(){return async function(){const e=await navigator.storage.estimate(),t=e.usage||0,n=e.quota||10485760;return{used:t,quota:n,percentage:t/n*100,hasUnlimitedStorage:n>1e8}}()}async encrypt(e){return this.encryptionManager.encrypt(e)}async decrypt(e){return this.encryptionManager.decrypt(e)}getStarterTemplates(){return this.configManager.getStarterTemplates()}}m.KEYS={ALIASES:"aliases",PROFILES:"profiles",CONFIG:"config",STATS:"stats",VERSION:"dataVersion"};class y{constructor(){this.profiles=[],this.realToAliasMap=new Map,this.aliasToRealMap=new Map}static async getInstance(){return y.instance||(y.instance=new y,"undefined"==typeof document?console.log("[AliasEngine] Service worker context - waiting for profiles via SET_PROFILES"):await y.instance.loadProfiles()),y.instance}async loadProfiles(){try{const e=m.getInstance();this.profiles=await e.loadProfiles(),this.buildLookupMaps(),console.log("[AliasEngine] Loaded",this.profiles.length,"profiles")}catch(e){e instanceof Error&&e.message.includes("ENCRYPTION_KEY_UNAVAILABLE")?(console.log("[AliasEngine] Running in service worker context - profiles unavailable (encrypted)"),console.log("[AliasEngine] Profiles will load once user opens popup and authenticates"),this.profiles=[],this.buildLookupMaps()):(console.error("[AliasEngine] Failed to load profiles:",e),this.profiles=[],this.buildLookupMaps())}}setProfiles(e){this.profiles=e,this.buildLookupMaps(),console.log("[AliasEngine] Profiles set directly:",this.profiles.length,"profiles")}buildLookupMaps(){this.realToAliasMap.clear(),this.aliasToRealMap.clear();const e=["name","email","phone","cellPhone","address","company"];for(const t of this.profiles){if(!t.enabled)continue;const n=t.settings?.enableVariations??!0;for(const r of e){const e=t.real[r],s=t.alias[r];if(e&&s&&"string"==typeof e&&"string"==typeof s){const i={real:e,alias:s,profileId:t.id,profileName:t.profileName,piiType:r};if(this.realToAliasMap.set(e.toLowerCase(),i),this.aliasToRealMap.set(s.toLowerCase(),i),n&&t.variations){const n=t.disabledVariations?.real[r]||[],o=t.disabledVariations?.alias[r]||[],a=t.variations.real[r]||[];for(const t of a)t&&t.toLowerCase()!==e.toLowerCase()&&!n.includes(t)&&this.realToAliasMap.set(t.toLowerCase(),i);const c=t.variations.alias[r]||[];for(const e of c)e&&e.toLowerCase()!==s.toLowerCase()&&!o.includes(e)&&this.aliasToRealMap.set(e.toLowerCase(),i)}if(n&&t.customVariations){const n=t.customVariations.real[r]||[];for(const t of n)t&&t.enabled&&t.value&&t.value.toLowerCase()!==e.toLowerCase()&&this.realToAliasMap.set(t.value.toLowerCase(),i);const o=t.customVariations.alias[r]||[];for(const e of o)e&&e.enabled&&e.value&&e.value.toLowerCase()!==s.toLowerCase()&&this.aliasToRealMap.set(e.value.toLowerCase(),i)}}}if(t.real.custom&&t.alias.custom)for(const[e,n]of Object.entries(t.real.custom)){const r=t.alias.custom[e];if(n&&r){const e={real:n,alias:r,profileId:t.id,profileName:t.profileName,piiType:"custom"};this.realToAliasMap.set(n.toLowerCase(),e),this.aliasToRealMap.set(r.toLowerCase(),e)}}}console.log("[AliasEngine] Built maps:",this.realToAliasMap.size,"real→alias mappings (with variations)")}substitute(e,t,n){const r="encode"===t?this.realToAliasMap:this.aliasToRealMap,s=[],i=new Map;let o=e;const a=Array.from(r.keys()).sort((e,t)=>t.length-e.length);for(const e of a){const a=r.get(e);if(!a)continue;if(n?.profileIds&&!n.profileIds.includes(a.profileId))continue;const c="encode"===t?a.alias:a.real,l=new RegExp(`\\b${this.escapeRegex(e)}\\b`,"gi");let u;const h=[];for(;null!==(u=l.exec(o));)h.push({match:u[0],index:u.index});for(let e=h.length-1;e>=0;e--){const t=h[e],r=this.preserveCase(t.match,c);"detect-only"!==n?.mode&&(o=o.substring(0,t.index)+r+o.substring(t.index+t.match.length)),s.push({from:t.match,to:r,position:t.index,profileId:a.profileId,piiType:a.piiType}),i.has(a.profileId)||i.set(a.profileId,{profileId:a.profileId,profileName:a.profileName,piiTypes:new Set,matches:[]});const l=i.get(a.profileId);l.piiTypes.add(a.piiType),l.matches.push({type:a.piiType,value:t.match,position:t.index})}}return"detect-only"!==n?.mode&&(o=this.handlePossessives(o,r,t)),{text:o,substitutions:s,confidence:this.calculateConfidence(s.length),profilesMatched:Array.from(i.values()).map(e=>({profileId:e.profileId,profileName:e.profileName,piiTypes:Array.from(e.piiTypes),matches:e.matches}))}}findPII(e){const t=[];for(const[n,r]of this.realToAliasMap){const s=new RegExp(`\\b${this.escapeRegex(n)}\\b`,"gi");let i;for(;null!==(i=s.exec(e));)t.push({text:i[0],start:i.index,end:i.index+i[0].length,alias:r.alias,profileId:r.profileId,profileName:r.profileName,piiType:r.piiType})}return t}escapeRegex(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}preserveCase(e,t){if(e===e.toUpperCase())return t.toUpperCase();if(e===e.toLowerCase())return t.toLowerCase();const n=e.split(" ");return t.split(" ").map((e,t)=>{if(t>=n.length)return e;const r=n[t][0];return r===r.toUpperCase()?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():e.toLowerCase()}).join(" ")}handlePossessives(e,t,n){let r=e;for(const[e,s]of t){const t="encode"===n?s.alias:s.real,i=new RegExp(`\\b${this.escapeRegex(e)}'s\\b`,"gi");r=r.replace(i,e=>`${this.preserveCase(e.replace(/'s$/i,""),t)}'s`)}return r}calculateConfidence(e){return e>0?.9:1}async updateProfileUsage(e,t,n){const r=m.getInstance();await r.incrementProfileUsage(e,t,n)}getProfiles(){return this.profiles.filter(e=>e.enabled)}getProfile(e){return this.profiles.find(t=>t.id===e)}async reload(){await this.loadProfiles()}hasProfiles(){return this.profiles.filter(e=>e.enabled).length>0}}class w{static detect(e,t={}){const n=[];for(const[r,s]of Object.entries(this.patterns)){if("generic"===r&&!t.includeGeneric)continue;if("custom"===r)continue;const i=new RegExp(s.source,s.flags);let o;for(;null!==(o=i.exec(e));)n.push({value:o[0],format:r,startIndex:o.index,endIndex:o.index+o[0].length,context:this.getContext(e,o.index,o[0].length)})}if(t.customPatterns)for(const r of t.customPatterns){const t=new RegExp(r,"g");let s;for(;null!==(s=t.exec(e));)n.push({value:s[0],format:"custom",startIndex:s.index,endIndex:s.index+s[0].length,context:this.getContext(e,s.index,s[0].length)})}if(t.storedKeys)for(const r of t.storedKeys){const t=e.indexOf(r);-1!==t&&n.push({value:r,format:this.detectFormat(r),startIndex:t,endIndex:t+r.length,context:this.getContext(e,t,r.length)})}return this.deduplicateKeys(n)}static redact(e,t,n="full"){const r=[...t].sort((e,t)=>t.startIndex-e.startIndex);let s=e;for(const e of r){let t;switch(n){case"full":t="[REDACTED_API_KEY]";break;case"partial":{const n=4,r=e.value.substring(0,n),s=e.value.substring(e.value.length-n);t=`${r}${"•".repeat(Math.max(0,e.value.length-2*n))}${s}`;break}case"placeholder":t=`[${e.format.toUpperCase()}_KEY]`}s=s.substring(0,e.startIndex)+t+s.substring(e.endIndex)}return s}static detectFormat(e){for(const[t,n]of Object.entries(this.patterns))if("custom"!==t&&new RegExp(n.source).test(e))return t;return"generic"}static getContext(e,t,n){const r=Math.max(0,t-30),s=Math.min(e.length,t+n+30);return e.substring(r,s)}static deduplicateKeys(e){const t=new Set;return e.filter(e=>{const n=`${e.startIndex}-${e.endIndex}`;return!t.has(n)&&(t.add(n),!0)})}}w.patterns={openai:/sk-(proj-)?[A-Za-z0-9]{48,}/g,anthropic:/sk-ant-[A-Za-z0-9-]{95}/g,google:/AIza[A-Za-z0-9_-]{35}/g,aws:/(AKIA|ASIA)[A-Z0-9]{16}/g,github:/gh[ps]_[A-Za-z0-9]{36}/g,stripe:/(sk|pk)_(live|test)_[A-Za-z0-9]{24,}/g,generic:/\b[A-Fa-f0-9]{32,}\b|\b[A-Za-z0-9+/]{40,}={0,2}\b/g,custom:/.*/};const v=new class{constructor(){this.compiledRules=new Map}compileRules(e){this.compiledRules.clear();const t=e.filter(e=>e.enabled).sort((e,t)=>t.priority-e.priority);for(const e of t)try{const t=new RegExp(e.pattern,"g");this.compiledRules.set(e.id,t)}catch(t){console.error(`[Redaction Engine] Failed to compile rule "${e.name}":`,t)}console.log(`[Redaction Engine] Compiled ${this.compiledRules.size} rules`)}applyRules(e,t){if(!e||0===t.length)return{modifiedText:e,matches:[],rulesApplied:[]};0===this.compiledRules.size&&this.compileRules(t);const n=[],r=new Set;let s=e;const i=t.filter(e=>e.enabled).sort((e,t)=>t.priority-e.priority);for(const e of i){const t=this.compiledRules.get(e.id);if(!t)continue;let i;t.lastIndex=0;const o=[];for(;null!==(i=t.exec(s));){const t=i[0],n=this.processReplacement(e.replacement,i);o.push({ruleId:e.id,ruleName:e.name,match:t,replacement:n,startIndex:i.index,endIndex:i.index+t.length}),r.add(e.id)}for(let e=o.length-1;e>=0;e--){const t=o[e];s=s.slice(0,t.startIndex)+t.replacement+s.slice(t.endIndex)}n.push(...o)}return{modifiedText:s,matches:n,rulesApplied:Array.from(r)}}processReplacement(e,t){let n=e;for(let e=1;e<t.length;e++){const r=t[e]||"";n=n.replace(new RegExp(`\\$${e}`,"g"),r)}return n=n.replace(/\$&/g,t[0]),n}static validatePattern(e){try{return new RegExp(e),{valid:!0}}catch(e){return{valid:!1,error:e instanceof Error?e.message:"Invalid regex pattern"}}}static testRule(e,t){try{const n=new RegExp(e.pattern,"g"),r=[],s=[];let i;for(;null!==(i=n.exec(t));){r.push(i[0]);let t=e.replacement;for(let e=1;e<i.length;e++)t=t.replace(new RegExp(`\\$${e}`,"g"),i[e]||"");t=t.replace(/\$&/g,i[0]),s.push(t)}return{matches:r,replacements:s}}catch(e){return{matches:[],replacements:[],error:e instanceof Error?e.message:"Test failed"}}}static detectConflicts(e){const t=[];for(let n=0;n<e.length;n++)for(let r=n+1;r<e.length;r++){const s=e[n],i=e[r];this.patternsOverlap(s.pattern,i.pattern)&&t.push({rule1:s.name,rule2:i.name,reason:"Patterns may overlap - consider adjusting priorities"})}return t}static patternsOverlap(e,t){return e===t}};class I{constructor(e,t){this.storage=e,this.contentScriptManager=t,this.badgeStateCache=new Map}isAIServiceURL(e){return!!e&&I.AI_SERVICE_URLS.some(t=>e.includes(t))}async updateBadge(e,t){try{const n=this.badgeStateCache.get(e)!==t;switch(n&&this.badgeStateCache.set(e,t),t){case"protected":await chrome.action.setBadgeText({tabId:e,text:"✓"}),await chrome.action.setBadgeBackgroundColor({tabId:e,color:"#10B981"}),await chrome.action.setTitle({tabId:e,title:"AI PII Sanitizer - Protected ✓"}),n&&console.log(`[BadgeManager] Tab ${e}: PROTECTED (Green)`);break;case"unprotected":await chrome.action.setBadgeText({tabId:e,text:"!"}),await chrome.action.setBadgeBackgroundColor({tabId:e,color:"#EF4444"}),await chrome.action.setTitle({tabId:e,title:"AI PII Sanitizer - NOT PROTECTED! Click to reload page"}),n&&console.log(`[BadgeManager] Tab ${e}: UNPROTECTED (Red)`);break;case"disabled":await chrome.action.setBadgeText({tabId:e,text:""}),await chrome.action.setBadgeBackgroundColor({tabId:e,color:"#6B7280"}),await chrome.action.setTitle({tabId:e,title:"AI PII Sanitizer - Disabled"}),n&&console.log(`[BadgeManager] Tab ${e}: DISABLED (No badge)`)}}catch(t){console.error(`[BadgeManager] Failed to update badge for tab ${e}:`,t)}}async checkAndUpdateBadge(e,t){try{if(!this.isAIServiceURL(t))return void await chrome.action.setBadgeText({tabId:e,text:""});let n=null;try{n=await this.storage.loadConfig()}catch(t){if(t instanceof Error&&t.message.includes("ENCRYPTION_KEY_UNAVAILABLE"))return console.log(`[BadgeManager] Tab ${e}: Data locked (user not authenticated)`),void await this.updateBadge(e,"disabled");throw t}if(!n?.settings?.enabled)return void await this.updateBadge(e,"disabled");const r=n?.settings?.protectedDomains||[],s=t?new URL(t).hostname:"";if(!r.some(e=>s.includes(e)||e.includes(s)))return void await this.updateBadge(e,"disabled");const i=await this.contentScriptManager.isContentScriptInjected(e);let o=!1;try{o=(await this.storage.loadProfiles()).some(e=>e.enabled)}catch(t){t instanceof Error&&t.message.includes("ENCRYPTION_KEY_UNAVAILABLE")&&console.log(`[BadgeManager] Tab ${e}: Profiles locked (user not authenticated)`)}const a=i&&o;a||!i||o||console.log(`[BadgeManager] Tab ${e}: NO ACTIVE PROFILES (Warning)`),a?await this.updateBadge(e,"protected"):await this.updateBadge(e,"unprotected")}catch(t){console.error(`[BadgeManager] Error checking protection for tab ${e}:`,t)}}}I.AI_SERVICE_URLS=["chatgpt.com","openai.com","claude.ai","gemini.google.com","perplexity.ai","copilot.microsoft.com"];class E{constructor(e){this.badgeManager=e}async isContentScriptInjected(e){try{return"PONG"===await chrome.tabs.sendMessage(e,{type:"PING"})}catch(e){return!1}}async injectIntoExistingTabs(){console.log("[ContentScriptManager] Injecting content scripts into existing tabs...");try{for(const e of E.AI_SERVICE_PATTERNS){const t=await chrome.tabs.query({url:e});for(const e of t)if(e.id)if(await this.isContentScriptInjected(e.id))console.log(`[ContentScriptManager] Already injected in tab ${e.id}`);else{console.log(`[ContentScriptManager] Injecting into tab ${e.id}: ${e.url}`);try{await chrome.scripting.executeScript({target:{tabId:e.id},files:["content.js"]}),console.log(`[ContentScriptManager] ✅ Injected into tab ${e.id}`),await this.badgeManager.checkAndUpdateBadge(e.id,e.url)}catch(t){console.warn(`[ContentScriptManager] Failed to inject into tab ${e.id}:`,t)}await this.badgeManager.checkAndUpdateBadge(e.id,e.url)}}console.log("[ContentScriptManager] ✅ Content script injection complete")}catch(e){console.error("[ContentScriptManager] Error injecting into existing tabs:",e)}}async handleReinject(){return await this.injectIntoExistingTabs(),{success:!0,message:"Content scripts reinjected"}}async reloadAIServiceTabs(){console.log("[ContentScriptManager] Reloading all AI service tabs...");let e=0;try{for(const t of E.AI_SERVICE_PATTERNS){const n=await chrome.tabs.query({url:t});for(const t of n)if(t.id)try{console.log(`[ContentScriptManager] Reloading tab ${t.id}: ${t.url}`),await chrome.tabs.reload(t.id),e++}catch(e){console.warn(`[ContentScriptManager] Failed to reload tab ${t.id}:`,e)}}console.log(`[ContentScriptManager] ✅ Reloaded ${e} AI service tabs`)}catch(e){console.error("[ContentScriptManager] Error reloading AI service tabs:",e)}return e}}E.AI_SERVICE_PATTERNS=["*://chatgpt.com/*","*://*.openai.com/*","*://claude.ai/*","*://gemini.google.com/*","*://perplexity.ai/*","*://copilot.microsoft.com/*"];class _{constructor(e){this.storage=e}async logActivity(e){console.log("[ActivityLogger] Activity:",e.message);try{const t=await this.storage.loadConfig();if(!t)return void console.warn("[ActivityLogger] No config found - skipping activity log");const n=t.stats?.activityLog||[],r=[{...e,id:`log_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,timestamp:Date.now()},...n].slice(0,100);await this.storage.saveConfig({...t,stats:{...t.stats,activityLog:r}}),console.log("[ActivityLogger] ✅ Activity logged to encrypted storage")}catch(e){console.error("[ActivityLogger] Failed to log activity:",e)}}}class T{constructor(e,t,n,r,s){this.storage=e,this.aliasEngine=t,this.redactionEngineInstance=r,this.activityLogger=s}async processRequest(e,t,n){try{const t=n?function(e){return e.includes("openai.com")||e.includes("chatgpt.com")?"chatgpt":e.includes("claude.ai")?"claude":e.includes("gemini.google.com")?"gemini":e.includes("perplexity.ai")?"perplexity":e.includes("copilot.microsoft.com")||e.includes("bing.com/sydney")?"copilot":"unknown"}(n):"unknown";if(console.log("[RequestProcessor] 🔄 Substituting request body"),!e||""===e.trim())return console.log("[RequestProcessor] ⚠️ Empty request body, skipping substitution"),{success:!0,modifiedBody:e,substitutions:0};let r;try{r=JSON.parse(e)}catch(t){console.log("[RequestProcessor] ⚠️ Non-JSON request body, attempting plain text substitution");let n=e,r=!1;if("string"==typeof e&&e.includes("f.req=")){console.log("[RequestProcessor] [Gemini] Detected URL-encoded batchexecute format");try{const t=new URLSearchParams(e).get("f.req");t&&(n=t,r=!0,console.log("[RequestProcessor] [Gemini] Decoded f.req value length:",n.length))}catch(t){console.warn("[RequestProcessor] [Gemini] Failed to parse URL parameters, using original"),n=e}}const s=this.aliasEngine.substitute(n,"encode");s.substitutions.length>0&&console.log("[RequestProcessor] ✅ Plain text substituted:",s.substitutions.length,"replacements");let i=s.text;if(r)try{const t=new URLSearchParams(e);t.set("f.req",s.text),i=t.toString(),console.log("[RequestProcessor] [Gemini] Reconstructed body length:",i.length)}catch(e){console.error("[RequestProcessor] [Gemini] Failed to reconstruct body:",e),i=s.text}return{success:!0,modifiedBody:i,substitutions:s.substitutions.length}}const s=function(e){if(!e||"object"!=typeof e)return"";if("send"===e.event&&Array.isArray(e.content)){const t=[];if(e.content.forEach(e=>{"text"===e.type&&"string"==typeof e.text&&t.push(e.text)}),t.length>0)return t.join("\n\n\n")}if(e.query_str&&"string"==typeof e.query_str){const t=[e.query_str];return e.params?.dsl_query&&"string"==typeof e.params.dsl_query&&t.push(e.params.dsl_query),t.join("\n\n\n")}return e.query&&"string"==typeof e.query?e.query:e.messages&&Array.isArray(e.messages)?e.messages.filter(e=>e&&"object"==typeof e).map(e=>"string"==typeof e.content?e.content:e.content?.parts&&Array.isArray(e.content.parts)?e.content.parts.join("\n"):Array.isArray(e.content)?e.content.map(e=>"string"==typeof e?e:e.text||"").join("\n"):"").filter(Boolean).join("\n\n\n"):e.prompt&&"string"==typeof e.prompt?e.prompt:e.contents&&Array.isArray(e.contents)?e.contents.filter(e=>e&&"object"==typeof e).flatMap(e=>e.parts&&Array.isArray(e.parts)?e.parts.filter(e=>e&&"object"==typeof e).map(e=>e.text):[]).filter(Boolean).join("\n\n\n"):""}(r);if(console.log("[RequestProcessor] 📝 Extracted text:",s.substring(0,300)),!s)return console.log("[RequestProcessor] ⚠️ No text extracted from request"),{success:!0,modifiedBody:e,substitutions:0};const i=this.aliasEngine.getProfiles();console.log("[RequestProcessor] 📋 Active profiles:",i.length,"-",i.map(e=>e.profileName).join(", "));const o=this.aliasEngine.substitute(s,"encode");if(console.log("[RequestProcessor] ✅ Request substituted:",o.substitutions.length,"replacements"),o.substitutions.length>0){console.log("[RequestProcessor] 🔀 Changes:",o.substitutions);const e=this.getServiceName(t);this.activityLogger.logActivity({type:"substitution",service:t,details:{url:e,profilesUsed:o.profilesMatched?.map(e=>e.profileName)||[],piiTypesFound:o.profilesMatched?.flatMap(e=>e.piiTypes)||[],substitutionCount:o.substitutions.length},message:`${e}: ${o.substitutions.length} items replaced`})}let a=o.text;const c=await this.storage.loadConfig();if(c?.customRules?.enabled&&c.customRules.rules.length>0){console.log("[RequestProcessor] 🎯 Custom rules enabled, applying redaction rules..."),console.log("[RequestProcessor] 📝 Text before custom rules:",a.substring(0,200));const e=this.redactionEngineInstance.applyRules(a,c.customRules.rules);if(console.log(`[RequestProcessor] 🎯 Rules result: ${e.matches.length} matches, ${e.rulesApplied.length} rules applied`),e.matches.length>0){console.log("[RequestProcessor] 🔍 Matches:",e.matches),console.log("[RequestProcessor] 📝 Text after custom rules:",e.modifiedText.substring(0,200)),a=e.modifiedText;for(const t of e.rulesApplied)await this.storage.incrementRuleMatchCount(t)}else console.log("[RequestProcessor] ⚠️ No matches found for custom rules")}const l=this.getServiceName(t);if(c?.apiKeyVault?.enabled){console.log("[RequestProcessor] 🔐 API Key Vault enabled, scanning for keys...");const n=c.apiKeyVault.keys.filter(e=>e.enabled).map(e=>e.keyValue),r="free"===c.account?.tier,s=!r,i=(c.apiKeyVault.customPatterns||[]).map(e=>new RegExp(e,"g")),u=w.detect(a,{includeGeneric:s,customPatterns:i,storedKeys:n}),h=r?u.filter(e=>"openai"===e.format):u;if(h.length>0)if(console.log(`[RequestProcessor] 🔐 Detected ${h.length} API keys (mode: ${c.apiKeyVault.mode})`),"auto-redact"===c.apiKeyVault.mode){a=w.redact(a,h,"placeholder");for(const e of h){const t=c.apiKeyVault.keys.find(t=>t.keyValue===e.value);t&&await this.storage.incrementAPIKeyProtection(t.id)}this.activityLogger.logActivity({type:"substitution",service:t,details:{url:l,apiKeysProtected:h.length,keyTypes:h.map(e=>e.format),substitutionCount:h.length},message:`API Keys: ${h.length} keys redacted`}),console.log("[RequestProcessor] ✅ API keys auto-redacted:",h.map(e=>e.format))}else{if("warn-first"===c.apiKeyVault.mode)return console.log("[RequestProcessor] ⚠️  Warn-first mode: Returning warning to user"),{success:!0,needsWarning:!0,keysDetected:h.length,keyTypes:h.map(e=>e.format),originalBody:e,modifiedBody:e,substitutions:o.substitutions.length};"log-only"===c.apiKeyVault.mode&&(console.log("[RequestProcessor] 📋 Log-only mode: Keys detected but not redacted"),this.activityLogger.logActivity({type:"warning",service:t,details:{url:l,apiKeysFound:h.length,keyTypes:h.map(e=>e.format),substitutionCount:0},message:`Warning: ${h.length} API keys found but not redacted (log-only mode)`}))}}const u=function(e,t){const n=JSON.parse(JSON.stringify(e));if("send"===n.event&&Array.isArray(n.content)){const e=t.split("\n\n\n").filter(Boolean);let r=0;return n.content.forEach(n=>{"text"===n.type&&"string"==typeof n.text&&(n.text=e[r]||t,r++)}),n}if(n.query_str&&"string"==typeof n.query_str){const e=t.split("\n\n\n");return n.query_str=e[0]||t,n.params?.dsl_query&&"string"==typeof n.params.dsl_query&&(n.params.dsl_query=e[1]||e[0]||t),n}if(n.query&&"string"==typeof n.query)return n.query=t,n;const r=t.split("\n\n\n").filter(Boolean);let s=0;return n.messages&&Array.isArray(n.messages)&&(n.messages=n.messages.map(e=>{if(!e.content)return e;if("string"==typeof e.content&&e.content)return{...e,content:r[s++]||e.content};if(e.content.parts&&Array.isArray(e.content.parts)){const t=r[s++];if(t)return{...e,content:{...e.content,parts:[t]}}}return Array.isArray(e.content)?{...e,content:e.content.map(e=>"string"==typeof e?r[s++]||e:e.text?{...e,text:r[s++]||e.text}:e)}:e})),n.prompt&&"string"==typeof n.prompt&&(n.prompt=t),n.contents&&Array.isArray(n.contents)&&(n.contents=n.contents.map(e=>e.parts&&Array.isArray(e.parts)?{...e,parts:e.parts.map(e=>e.text?{...e,text:r[s++]||e.text}:e)}:e)),n}(r,a);return{success:!0,modifiedBody:JSON.stringify(u),substitutions:o.substitutions.length}}catch(t){return console.error("[RequestProcessor] ❌ Request substitution error:",t),{success:!1,modifiedBody:e,substitutions:0,error:t.message}}}getServiceName(e){switch(e){case"chatgpt":return"ChatGPT";case"claude":return"Claude";case"gemini":return"Gemini";case"perplexity":return"Perplexity";case"copilot":return"Copilot";default:return"Unknown"}}}class A{constructor(e,t){this.storage=e,this.aliasEngine=t}async processResponse(e,t){try{if(!e)return{success:!0,modifiedText:e,substitutions:0};const t=await this.storage.loadConfig();if(!t?.settings?.decodeResponses)return console.log("[ResponseProcessor] ℹ️ Response decoding disabled - keeping aliases in response"),{success:!0,modifiedText:e,substitutions:0};const n=this.aliasEngine.substitute(e,"decode");return n.substitutions.length>0&&(console.log("[ResponseProcessor] ✅ Decoded:",n.substitutions.length,"replacements"),console.log("[ResponseProcessor] Replacements made:",n.substitutions)),{success:!0,modifiedText:n.text,substitutions:n.substitutions.length}}catch(t){return console.error("[ResponseProcessor] ❌ Response substitution error:",t),{success:!1,modifiedText:e,substitutions:0,error:t.message}}}}class S{constructor(e,t,n,r,s,i,o,a,c){this.storage=e,this.aliasHandlers=t,this.configHandlers=n,this.apiKeyHandlers=r,this.customRulesHandlers=s,this.requestProcessor=i,this.responseProcessor=o,this.badgeManager=a,this.contentScriptManager=c}async handleMessage(e,t){switch(e.type){case"HEALTH_CHECK":{const n=e.tabId||t?.tab?.id;if(n){const e=await this.storage.loadConfig();e?.settings?.enabled&&await this.badgeManager.updateBadge(n,"protected")}return{success:!0,status:"ok"}}case"PROTECTION_LOST":{const n=e.tabId||t?.tab?.id;return n?(console.log(`[MessageRouter] Protection lost for tab ${n}`),await this.badgeManager.updateBadge(n,"unprotected")):console.warn("[MessageRouter] PROTECTION_LOST received but no tabId available"),{success:!0}}case"DISABLE_EXTENSION":{console.log("[MessageRouter] User requested extension disable");const e=await this.storage.loadConfig();if(e){await this.storage.saveConfig({...e,settings:{...e.settings,enabled:!1}}),console.log("[MessageRouter] ✅ Extension disabled");const t=await chrome.tabs.query({});for(const e of t)e.id&&await this.badgeManager.checkAndUpdateBadge(e.id,e.url)}return{success:!0}}case"SUBSTITUTE_REQUEST":return this.requestProcessor.processRequest(e.payload.body,e.tabId,e.payload.url);case"SUBSTITUTE_RESPONSE":return this.responseProcessor.processResponse(e.payload.text,e.payload.url);case"RELOAD_PROFILES":return this.aliasHandlers.handleReloadProfiles();case"GET_ALIASES":return this.aliasHandlers.handleGetAliases();case"GET_PROFILES":return this.aliasHandlers.handleGetProfiles();case"ADD_ALIAS":return this.aliasHandlers.handleAddAlias(e.payload);case"REMOVE_ALIAS":return this.aliasHandlers.handleRemoveAlias(e.payload);case"UPDATE_CONFIG":return this.configHandlers.handleUpdateConfig(e.payload);case"GET_CONFIG":return this.configHandlers.handleGetConfig();case"REINJECT_CONTENT_SCRIPTS":return this.contentScriptManager.handleReinject();case"ADD_API_KEY":return this.apiKeyHandlers.handleAddAPIKey(e.payload);case"REMOVE_API_KEY":return this.apiKeyHandlers.handleRemoveAPIKey(e.payload);case"UPDATE_API_KEY":return this.apiKeyHandlers.handleUpdateAPIKey(e.payload);case"GET_API_KEYS":return this.apiKeyHandlers.handleGetAPIKeys();case"UPDATE_API_KEY_VAULT_SETTINGS":return this.apiKeyHandlers.handleUpdateAPIKeyVaultSettings(e.payload);case"ADD_CUSTOM_RULE":return this.customRulesHandlers.handleAddCustomRule(e.payload);case"REMOVE_CUSTOM_RULE":return this.customRulesHandlers.handleRemoveCustomRule(e.payload);case"UPDATE_CUSTOM_RULE":return this.customRulesHandlers.handleUpdateCustomRule(e.payload);case"TOGGLE_CUSTOM_RULE":return this.customRulesHandlers.handleToggleCustomRule(e.payload);case"UPDATE_CUSTOM_RULES_SETTINGS":return this.customRulesHandlers.handleUpdateCustomRulesSettings(e.payload);default:throw new Error(`Unknown message type: ${e.type}`)}}}class b{constructor(e,t){this.storage=e,this.aliasEngine=t}async handleGetAliases(){try{return{success:!0,data:await this.storage.loadAliases()}}catch(e){return{success:!1,error:e.message}}}async handleGetProfiles(){try{return{success:!0,data:await this.storage.loadProfiles()}}catch(e){return{success:!1,error:e.message}}}async handleAddAlias(e){try{const t=await this.storage.addAlias(e);return await this.aliasEngine.reload(),{success:!0,data:t}}catch(e){return{success:!1,error:e.message}}}async handleRemoveAlias(e){try{return await this.storage.removeAlias(e.id),await this.aliasEngine.reload(),{success:!0}}catch(e){return{success:!1,error:e.message}}}async handleReloadProfiles(){console.log("[AliasHandlers] Reloading profiles..."),await this.aliasEngine.reload();const e=this.aliasEngine.getProfiles();return console.log("[AliasHandlers] ✅ Profiles reloaded:",e.length,"active profiles"),{success:!0,profileCount:e.length}}}class C{constructor(e){this.storage=e}async handleUpdateConfig(e){try{return await this.storage.saveConfig(e),{success:!0}}catch(e){return{success:!1,error:e.message}}}async handleGetConfig(){try{return{success:!0,data:await this.storage.loadConfig()}}catch(e){return e instanceof Error&&e.message.includes("ENCRYPTION_KEY_UNAVAILABLE")?(console.log("[ConfigHandlers] Config requested but user not authenticated - returning default config"),{success:!0,data:{settings:{enabled:!1},features:{},stats:{totalSubstitutions:0,totalInterceptions:0,byService:{}},account:{tier:"free"}}}):(console.error("[ConfigHandlers] Error loading config:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"})}}}class R{constructor(e){this.storage=e}async handleAddAPIKey(e){try{return{success:!0,data:await this.storage.addAPIKey(e)}}catch(e){return console.error("[APIKeyHandlers] Failed to add API key:",e),e.message.startsWith("FREE_TIER_LIMIT")?{success:!1,error:"FREE_TIER_LIMIT",message:"You have reached the FREE tier limit of 10 API keys. Upgrade to PRO for unlimited keys."}:e.message.startsWith("FREE_TIER_PATTERN")?{success:!1,error:"FREE_TIER_PATTERN",message:"FREE tier only supports OpenAI key detection. Upgrade to PRO for GitHub, AWS, Stripe, and other patterns."}:{success:!1,error:e.message}}}async handleRemoveAPIKey(e){try{return await this.storage.removeAPIKey(e.id),{success:!0}}catch(e){return console.error("[APIKeyHandlers] Failed to remove API key:",e),{success:!1,error:e.message}}}async handleUpdateAPIKey(e){try{return await this.storage.updateAPIKey(e.id,e.updates),{success:!0}}catch(e){return console.error("[APIKeyHandlers] Failed to update API key:",e),{success:!1,error:e.message}}}async handleGetAPIKeys(){try{return{success:!0,data:await this.storage.getAllAPIKeys()}}catch(e){return console.error("[APIKeyHandlers] Failed to get API keys:",e),{success:!1,error:e.message}}}async handleUpdateAPIKeyVaultSettings(e){try{return await this.storage.updateAPIKeyVaultSettings(e),{success:!0}}catch(e){return console.error("[APIKeyHandlers] Failed to update API Key Vault settings:",e),{success:!1,error:e.message}}}}class P{constructor(e){this.storage=e}async handleAddCustomRule(e){try{return{success:!0,data:{ruleId:await this.storage.addCustomRule(e)}}}catch(e){return console.error("[CustomRulesHandlers] Failed to add custom rule:",e),{success:!1,error:e.message}}}async handleRemoveCustomRule(e){try{return await this.storage.removeCustomRule(e.ruleId),{success:!0}}catch(e){return console.error("[CustomRulesHandlers] Failed to remove custom rule:",e),{success:!1,error:e.message}}}async handleUpdateCustomRule(e){try{return await this.storage.updateCustomRule(e.ruleId,e.updates),{success:!0}}catch(e){return console.error("[CustomRulesHandlers] Failed to update custom rule:",e),{success:!1,error:e.message}}}async handleToggleCustomRule(e){try{return await this.storage.toggleCustomRule(e.ruleId),{success:!0}}catch(e){return console.error("[CustomRulesHandlers] Failed to toggle custom rule:",e),{success:!1,error:e.message}}}async handleUpdateCustomRulesSettings(e){try{return await this.storage.updateCustomRulesSettings(e),{success:!0}}catch(e){return console.error("[CustomRulesHandlers] Failed to update custom rules settings:",e),{success:!1,error:e.message}}}}console.log("[Background] Initializing Firebase auth for service worker..."),(0,r.BG)().then(()=>{console.log("[Background] ✅ Firebase auth initialized in service worker")}).catch(e=>{console.error("[Background] ❌ Firebase auth initialization failed:",e)}),(async()=>{const e=m.getInstance(),t=await y.getInstance(),r=new w,s=new _(e),i=new I(e,null),o=new E(i);i.contentScriptManager=o;const a=new T(e,t,r,v,s),c=new A(e,t),l=new b(e,t),u=new C(e),h=new R(e),d=new P(e),p=new S(e,l,u,h,d,a,c,i,o),{auth:g}=await Promise.resolve().then(n.bind(n,51));g.onAuthStateChanged(async n=>{if(n){console.log("[Background] 🔐 User signed in:",n.email),console.log("[Background] Reloading profiles with Firebase UID encryption...");try{await e.initialize();const n=await e.loadProfiles();t.setProfiles(n),console.log("[Background] ✅ Profiles reloaded:",n.length,"profiles"),console.log("[Background] ✅ Active profiles:",n.filter(e=>e.enabled).length);const r=await chrome.tabs.query({});for(const e of r)e.id&&await i.checkAndUpdateBadge(e.id,e.url);console.log("[Background] ✅ Badges updated for all tabs")}catch(e){console.error("[Background] ❌ Failed to reload profiles after sign-in:",e)}}else console.log("[Background] 🔓 User signed out - profiles locked"),t.setProfiles([])}),console.log("[Background] ✅ Firebase auth state listener registered"),chrome.runtime.onStartup.addListener(async()=>{console.log("AI PII Sanitizer startup"),await o.injectIntoExistingTabs();const e=await chrome.tabs.query({});for(const t of e)t.id&&await i.checkAndUpdateBadge(t.id,t.url)}),chrome.runtime.onInstalled.addListener(async t=>{console.log("AI PII Sanitizer installed:",t.reason);try{await e.initialize();const t=await e.loadConfig();t&&!t.settings.enabled&&(console.log("[Background] Extension was disabled - enabling it now"),t.settings.enabled=!0,await e.saveConfig(t))}catch(e){e instanceof Error&&e.message.includes("ENCRYPTION_KEY_UNAVAILABLE")?(console.log("[Background] User not authenticated - skipping data initialization"),console.log("[Background] Extension will initialize when user signs in")):console.error("[Background] Failed to initialize on install:",e)}if("update"===t.reason||"install"===t.reason){console.log("[Background] Extension updated/installed - auto-reloading AI service tabs");const e=await o.reloadAIServiceTabs();console.log(`[Background] ✅ Auto-reloaded ${e} AI service tabs`)}await o.injectIntoExistingTabs();const n=await chrome.tabs.query({});for(const e of n)e.id&&await i.checkAndUpdateBadge(e.id,e.url)}),chrome.runtime.onMessage.addListener((e,t,n)=>e&&e.type?(p.handleMessage(e,t).then(n).catch(e=>{console.error("Error handling message:",e),n({success:!1,error:e.message})}),!0):(console.warn("[Background] Received message without type field:",e),n({success:!1,error:"Invalid message format"}),!1)),chrome.tabs.onActivated.addListener(async e=>{try{const t=await chrome.tabs.get(e.tabId);await i.checkAndUpdateBadge(e.tabId,t.url)}catch(e){console.error("[Badge] Error on tab activation:",e)}}),chrome.tabs.onUpdated.addListener(async(e,t,n)=>{(t.url||"complete"===t.status)&&await i.checkAndUpdateBadge(e,n.url)}),chrome.storage.onChanged.addListener(async(e,t)=>{if("local"===t&&e.config){const t=e.config.oldValue,n=e.config.newValue,r=t?.settings?.enabled!==n?.settings?.enabled,s=JSON.stringify(t?.settings?.protectedDomains)!==JSON.stringify(n?.settings?.protectedDomains);if(r||s){console.log("[Badge] Protection settings changed, updating all badges",{enabledChanged:r,domainsChanged:s,oldDomains:t?.settings?.protectedDomains,newDomains:n?.settings?.protectedDomains});const e=await chrome.tabs.query({});for(const t of e)t.id&&await i.checkAndUpdateBadge(t.id,t.url)}}})})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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L2ZpcmViYXNlLnRzIiwid2VicGFjazovL2FpLXBpaS1zYW5pdGl6ZXIvLi9ub2RlX21vZHVsZXMvZmlyZWJhc2UvYXBwL2Rpc3QvZXNtL2luZGV4LmVzbS5qcyIsIndlYnBhY2s6Ly9haS1waWktc2FuaXRpemVyLy4vbm9kZV9tb2R1bGVzL2lkYi9idWlsZC9pbmRleC5qcyIsIndlYnBhY2s6Ly9haS1waWktc2FuaXRpemVyLy4vbm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9sb2dnZXIvZGlzdC9lc20vaW5kZXguZXNtLmpzIiwid2VicGFjazovL2FpLXBpaS1zYW5pdGl6ZXIvLi9ub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvZGlzdC93ZWItZXh0ZW5zaW9uLWVzbS9yZWdpc3Rlci03OTkzYjdhZi5qcyIsIndlYnBhY2s6Ly9haS1waWktc2FuaXRpemVyLy4vbm9kZV9tb2R1bGVzL0BmaXJlYmFzZS91dGlsL2Rpc3QvaW5kZXguZXNtLmpzIiwid2VicGFjazovL2FpLXBpaS1zYW5pdGl6ZXIvLi9ub2RlX21vZHVsZXMvQGZpcmViYXNlL2NvbXBvbmVudC9kaXN0L2VzbS9pbmRleC5lc20uanMiLCJ3ZWJwYWNrOi8vYWktcGlpLXNhbml0aXplci8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvd2ViY2hhbm5lbC13cmFwcGVyL2Rpc3Qvd2ViY2hhbm5lbC1ibG9iL2VzbS93ZWJjaGFubmVsX2Jsb2JfZXMyMDE4LmpzIiwid2VicGFjazovL2FpLXBpaS1zYW5pdGl6ZXIvLi9ub2RlX21vZHVsZXMvQGZpcmViYXNlL3dlYmNoYW5uZWwtd3JhcHBlci9kaXN0L2Jsb29tLWJsb2IvZXNtL2Jsb29tX2Jsb2JfZXMyMDE4LmpzIiwid2VicGFjazovL2FpLXBpaS1zYW5pdGl6ZXIvLi9ub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvZGlzdC93ZWItZXh0ZW5zaW9uLWVzbS9pbmRleC5qcyIsIndlYnBhY2s6Ly9haS1waWktc2FuaXRpemVyLy4vbm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9maXJlc3RvcmUvZGlzdC9pbmRleC5lc20uanMiLCJ3ZWJwYWNrOi8vYWktcGlpLXNhbml0aXplci8uL25vZGVfbW9kdWxlcy9pZGIvYnVpbGQvd3JhcC1pZGItdmFsdWUuanMiLCJ3ZWJwYWNrOi8vYWktcGlpLXNhbml0aXplci8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9kaXN0L2VzbS9pbmRleC0xOTcwMDI3Zi5qcyIsIndlYnBhY2s6Ly9haS1waWktc2FuaXRpemVyLy4vbm9kZV9tb2R1bGVzL0BmaXJlYmFzZS91dGlsL2Rpc3QvcG9zdGluc3RhbGwubWpzIiwid2VicGFjazovL2FpLXBpaS1zYW5pdGl6ZXIvLi9ub2RlX21vZHVsZXMvQGZpcmViYXNlL2FwcC9kaXN0L2VzbS9pbmRleC5lc20uanMiLCJ3ZWJwYWNrOi8vYWktcGlpLXNhbml0aXplci93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9haS1waWktc2FuaXRpemVyL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9haS1waWktc2FuaXRpemVyL3dlYnBhY2svcnVudGltZS9nbG9iYWwiLCJ3ZWJwYWNrOi8vYWktcGlpLXNhbml0aXplci93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL2FpLXBpaS1zYW5pdGl6ZXIvLi9zcmMvYmFja2dyb3VuZC9wb2x5ZmlsbHMudHMiLCJ3ZWJwYWNrOi8vYWktcGlpLXNhbml0aXplci8uL3NyYy9saWIvc3RvcmFnZS9TdG9yYWdlRW5jcnlwdGlvbk1hbmFnZXIudHMiLCJ3ZWJwYWNrOi8vYWktcGlpLXNhbml0aXplci8uL3NyYy9saWIvc3RvcmFnZS9TdG9yYWdlQ29uZmlnTWFuYWdlci50cyIsIndlYnBhY2s6Ly9haS1waWktc2FuaXRpemVyLy4vc3JjL2xpYi9hbGlhc1ZhcmlhdGlvbnMudHMiLCJ3ZWJwYWNrOi8vYWktcGlpLXNhbml0aXplci8uL3NyYy9saWIvc3RvcmFnZS9TdG9yYWdlUHJvZmlsZU1hbmFnZXIudHMiLCJ3ZWJwYWNrOi8vYWktcGlpLXNhbml0aXplci8uL3NyYy9saWIvc3RvcmFnZS9TdG9yYWdlQVBJS2V5VmF1bHRNYW5hZ2VyLnRzIiwid2VicGFjazovL2FpLXBpaS1zYW5pdGl6ZXIvLi9zcmMvbGliL3N0b3JhZ2UvU3RvcmFnZUN1c3RvbVJ1bGVzTWFuYWdlci50cyIsIndlYnBhY2s6Ly9haS1waWktc2FuaXRpemVyLy4vc3JjL2xpYi9zdG9yYWdlL1N0b3JhZ2VQcm9tcHRUZW1wbGF0ZXNNYW5hZ2VyLnRzIiwid2VicGFjazovL2FpLXBpaS1zYW5pdGl6ZXIvLi9zcmMvbGliL3N0b3JhZ2UvU3RvcmFnZURvY3VtZW50QWxpYXNNYW5hZ2VyLnRzIiwid2VicGFjazovL2FpLXBpaS1zYW5pdGl6ZXIvLi9zcmMvbGliL3N0b3JhZ2Uvc3RvcmFnZS11dGlscy50cyIsIndlYnBhY2s6Ly9haS1waWktc2FuaXRpemVyLy4vc3JjL2xpYi9zdG9yYWdlL1N0b3JhZ2VNaWdyYXRpb25NYW5hZ2VyLnRzIiwid2VicGFjazovL2FpLXBpaS1zYW5pdGl6ZXIvLi9zcmMvbGliL3N0b3JhZ2UudHMiLCJ3ZWJwYWNrOi8vYWktcGlpLXNhbml0aXplci8uL3NyYy9saWIvYWxpYXNFbmdpbmUudHMiLCJ3ZWJwYWNrOi8vYWktcGlpLXNhbml0aXplci8uL3NyYy9saWIvYXBpS2V5RGV0ZWN0b3IudHMiLCJ3ZWJwYWNrOi8vYWktcGlpLXNhbml0aXplci8uL3NyYy9saWIvcmVkYWN0aW9uRW5naW5lLnRzIiwid2VicGFjazovL2FpLXBpaS1zYW5pdGl6ZXIvLi9zcmMvYmFja2dyb3VuZC9tYW5hZ2Vycy9CYWRnZU1hbmFnZXIudHMiLCJ3ZWJwYWNrOi8vYWktcGlpLXNhbml0aXplci8uL3NyYy9iYWNrZ3JvdW5kL21hbmFnZXJzL0NvbnRlbnRTY3JpcHRNYW5hZ2VyLnRzIiwid2VicGFjazovL2FpLXBpaS1zYW5pdGl6ZXIvLi9zcmMvYmFja2dyb3VuZC9tYW5hZ2Vycy9BY3Rpdml0eUxvZ2dlci50cyIsIndlYnBhY2s6Ly9haS1waWktc2FuaXRpemVyLy4vc3JjL2JhY2tncm91bmQvcHJvY2Vzc29ycy9SZXF1ZXN0UHJvY2Vzc29yLnRzIiwid2VicGFjazovL2FpLXBpaS1zYW5pdGl6ZXIvLi9zcmMvYmFja2dyb3VuZC91dGlscy9TZXJ2aWNlRGV0ZWN0b3IudHMiLCJ3ZWJwYWNrOi8vYWktcGlpLXNhbml0aXplci8uL3NyYy9saWIvdGV4dFByb2Nlc3Nvci50cyIsIndlYnBhY2s6Ly9haS1waWktc2FuaXRpemVyLy4vc3JjL2JhY2tncm91bmQvcHJvY2Vzc29ycy9SZXNwb25zZVByb2Nlc3Nvci50cyIsIndlYnBhY2s6Ly9haS1waWktc2FuaXRpemVyLy4vc3JjL2JhY2tncm91bmQvaGFuZGxlcnMvTWVzc2FnZVJvdXRlci50cyIsIndlYnBhY2s6Ly9haS1waWktc2FuaXRpemVyLy4vc3JjL2JhY2tncm91bmQvaGFuZGxlcnMvQWxpYXNIYW5kbGVycy50cyIsIndlYnBhY2s6Ly9haS1waWktc2FuaXRpemVyLy4vc3JjL2JhY2tncm91bmQvaGFuZGxlcnMvQ29uZmlnSGFuZGxlcnMudHMiLCJ3ZWJwYWNrOi8vYWktcGlpLXNhbml0aXplci8uL3NyYy9iYWNrZ3JvdW5kL2hhbmRsZXJzL0FQSUtleUhhbmRsZXJzLnRzIiwid2VicGFjazovL2FpLXBpaS1zYW5pdGl6ZXIvLi9zcmMvYmFja2dyb3VuZC9oYW5kbGVycy9DdXN0b21SdWxlc0hhbmRsZXJzLnRzIiwid2VicGFjazovL2FpLXBpaS1zYW5pdGl6ZXIvLi9zcmMvYmFja2dyb3VuZC9zZXJ2aWNlV29ya2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRmlyZWJhc2UgSW5pdGlhbGl6YXRpb25cbiAqIENvbm5lY3RzIENocm9tZSBleHRlbnNpb24gdG8gRmlyZWJhc2UgQXV0aGVudGljYXRpb24gYW5kIEZpcmVzdG9yZVxuICpcbiAqIENvbnRleHQtQXdhcmUgQXV0aDpcbiAqIC0gU2VydmljZSBXb3JrZXI6IFVzZXMgZmlyZWJhc2UvYXV0aC93ZWItZXh0ZW5zaW9uIChubyBET00gcmVxdWlyZWQpXG4gKiAtIFBvcHVwL0NvbnRlbnQ6IFVzZXMgZmlyZWJhc2UvYXV0aCAoc3RhbmRhcmQgd2ViIGF1dGgpXG4gKi9cblxuaW1wb3J0IHsgaW5pdGlhbGl6ZUFwcCwgRmlyZWJhc2VBcHAgfSBmcm9tICdmaXJlYmFzZS9hcHAnO1xuaW1wb3J0IHsgQXV0aCB9IGZyb20gJ2ZpcmViYXNlL2F1dGgnO1xuaW1wb3J0IHsgZ2V0RmlyZXN0b3JlLCBGaXJlc3RvcmUsIGNvbm5lY3RGaXJlc3RvcmVFbXVsYXRvciB9IGZyb20gJ2ZpcmViYXNlL2ZpcmVzdG9yZSc7XG5cbi8vIFN0YXRpYyBpbXBvcnRzIGZvciBib3RoIGF1dGggbW9kdWxlcyAod2VicGFjayB3aWxsIHRyZWUtc2hha2UgdW51c2VkIGNvZGUpXG5pbXBvcnQgeyBnZXRBdXRoIGFzIGdldFdlYkV4dEF1dGgsIGluZGV4ZWREQkxvY2FsUGVyc2lzdGVuY2UgfSBmcm9tICdmaXJlYmFzZS9hdXRoL3dlYi1leHRlbnNpb24nO1xuaW1wb3J0IHsgZ2V0QXV0aCBhcyBnZXRTdGFuZGFyZEF1dGgsIGNvbm5lY3RBdXRoRW11bGF0b3IgfSBmcm9tICdmaXJlYmFzZS9hdXRoJztcblxuLy8gRmlyZWJhc2UgY29uZmlndXJhdGlvbiBmcm9tIGVudmlyb25tZW50IHZhcmlhYmxlc1xuY29uc3QgZmlyZWJhc2VDb25maWcgPSB7XG4gIGFwaUtleTogcHJvY2Vzcy5lbnYuRklSRUJBU0VfQVBJX0tFWSxcbiAgYXV0aERvbWFpbjogcHJvY2Vzcy5lbnYuRklSRUJBU0VfQVVUSF9ET01BSU4sXG4gIHByb2plY3RJZDogcHJvY2Vzcy5lbnYuRklSRUJBU0VfUFJPSkVDVF9JRCxcbiAgc3RvcmFnZUJ1Y2tldDogcHJvY2Vzcy5lbnYuRklSRUJBU0VfU1RPUkFHRV9CVUNLRVQsXG4gIG1lc3NhZ2luZ1NlbmRlcklkOiBwcm9jZXNzLmVudi5GSVJFQkFTRV9NRVNTQUdJTkdfU0VOREVSX0lELFxuICBhcHBJZDogcHJvY2Vzcy5lbnYuRklSRUJBU0VfQVBQX0lELFxufTtcblxuLy8gVmFsaWRhdGUgY29uZmlndXJhdGlvblxuY29uc3QgcmVxdWlyZWRLZXlzID0gWydhcGlLZXknLCAnYXV0aERvbWFpbicsICdwcm9qZWN0SWQnLCAnYXBwSWQnXTtcbmNvbnN0IG1pc3NpbmdLZXlzID0gcmVxdWlyZWRLZXlzLmZpbHRlcihrZXkgPT4gIWZpcmViYXNlQ29uZmlnW2tleSBhcyBrZXlvZiB0eXBlb2YgZmlyZWJhc2VDb25maWddKTtcblxuaWYgKG1pc3NpbmdLZXlzLmxlbmd0aCA+IDApIHtcbiAgdGhyb3cgbmV3IEVycm9yKFxuICAgIGBbRmlyZWJhc2VdIE1pc3NpbmcgcmVxdWlyZWQgZW52aXJvbm1lbnQgdmFyaWFibGVzOiAke21pc3NpbmdLZXlzLm1hcChrID0+IGBGSVJFQkFTRV8ke2sudG9VcHBlckNhc2UoKX1gKS5qb2luKCcsICcpfWBcbiAgKTtcbn1cblxuLy8gRGV0ZWN0IGV4ZWN1dGlvbiBjb250ZXh0XG4vLyBDaGVjayBleHBsaWNpdCBmbGFnIGZpcnN0IChzZXQgYnkgcG9seWZpbGxzLnRzKSwgdGhlbiBmYWxsYmFjayB0byBkb2N1bWVudCBjaGVja1xuY29uc3QgaXNTZXJ2aWNlV29ya2VyID0gKGdsb2JhbFRoaXMgYXMgYW55KS5fX0lTX1NFUlZJQ0VfV09SS0VSX18gPT09IHRydWUgfHwgdHlwZW9mIGRvY3VtZW50ID09PSAndW5kZWZpbmVkJztcbmNvbnN0IGNvbnRleHROYW1lID0gaXNTZXJ2aWNlV29ya2VyID8gJ1NFUlZJQ0UgV09SS0VSJyA6ICdQT1BVUC9DT05URU5UJztcblxuLy8gSW5pdGlhbGl6ZSBGaXJlYmFzZSBBcHAgYW5kIEZpcmVzdG9yZSAoc3luY2hyb25vdXMpXG5sZXQgYXBwOiBGaXJlYmFzZUFwcDtcbmxldCBkYjogRmlyZXN0b3JlO1xuXG50cnkge1xuICBhcHAgPSBpbml0aWFsaXplQXBwKGZpcmViYXNlQ29uZmlnKTtcbiAgZGIgPSBnZXRGaXJlc3RvcmUoYXBwKTtcblxuICAvLyBGaXJlc3RvcmUgZW11bGF0b3Igd29ya3MgaW4gYm90aCBjb250ZXh0c1xuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgJiYgcHJvY2Vzcy5lbnYuVVNFX0ZJUkVCQVNFX0VNVUxBVE9SUyA9PT0gJ3RydWUnKSB7XG4gICAgY29ubmVjdEZpcmVzdG9yZUVtdWxhdG9yKGRiLCAnbG9jYWxob3N0JywgODA4MCk7XG4gICAgY29uc29sZS5sb2coJ1tGaXJlYmFzZV0gQ29ubmVjdGVkIEZpcmVzdG9yZSB0byBsb2NhbCBlbXVsYXRvcicpO1xuICB9XG5cbiAgY29uc29sZS5sb2coJ1tGaXJlYmFzZV0gQXBwIGluaXRpYWxpemVkIHN1Y2Nlc3NmdWxseScpO1xuICBjb25zb2xlLmxvZygnW0ZpcmViYXNlXSBDb250ZXh0OicsIGNvbnRleHROYW1lKTtcbiAgY29uc29sZS5sb2coJ1tGaXJlYmFzZV0gUHJvamVjdCBJRDonLCBmaXJlYmFzZUNvbmZpZy5wcm9qZWN0SWQpO1xufSBjYXRjaCAoZXJyb3IpIHtcbiAgY29uc29sZS5lcnJvcignW0ZpcmViYXNlXSBBcHAgaW5pdGlhbGl6YXRpb24gZmFpbGVkIGluJywgY29udGV4dE5hbWUsICc6JywgZXJyb3IpO1xuICB0aHJvdyBlcnJvcjtcbn1cblxuLy8gQXV0aCBpbml0aWFsaXphdGlvbiAoYXN5bmMgLSBjb250ZXh0LWRlcGVuZGVudClcbi8vIFRoaXMgd2lsbCBiZSBzZXQgYWZ0ZXIgYXN5bmMgaW5pdGlhbGl6YXRpb24gY29tcGxldGVzXG5sZXQgYXV0aDogQXV0aCA9IG51bGwgYXMgYW55OyAgLy8gVGVtcG9yYXJ5IG51bGwsIHdpbGwgYmUgc2V0IGltbWVkaWF0ZWx5XG5sZXQgYXV0aFJlYWR5OiBQcm9taXNlPEF1dGg+O1xuXG4vLyBJbml0aWFsaXplIGF1dGggYmFzZWQgb24gY29udGV4dCAocnVucyBpbW1lZGlhdGVseSlcbmF1dGhSZWFkeSA9IChhc3luYyAoKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJ1tGaXJlYmFzZV0gU3RhcnRpbmcgYXV0aCBpbml0aWFsaXphdGlvbiBmb3InLCBjb250ZXh0TmFtZSk7XG5cbiAgICBpZiAoaXNTZXJ2aWNlV29ya2VyKSB7XG4gICAgICAvLyBTZXJ2aWNlIFdvcmtlcjogVXNlIHdlYi1leHRlbnNpb24gYXV0aCBtb2R1bGUgKG5vIERPTSByZXF1aXJlZClcbiAgICAgIGNvbnNvbGUubG9nKCdbRmlyZWJhc2VdIENhbGxpbmcgZ2V0QXV0aCB3aXRoIHdlYi1leHRlbnNpb24gbW9kdWxlLi4uJyk7XG4gICAgICBhdXRoID0gZ2V0V2ViRXh0QXV0aChhcHApO1xuICAgICAgY29uc29sZS5sb2coJ1tGaXJlYmFzZV0gQXV0aCBpbnN0YW5jZSBjcmVhdGVkLCBzZXR0aW5nIHBlcnNpc3RlbmNlLi4uJyk7XG5cbiAgICAgIC8vIEVuYWJsZSBJbmRleGVkREIgcGVyc2lzdGVuY2UgZm9yIHNlcnZpY2Ugd29ya2VyXG4gICAgICBhd2FpdCBhdXRoLnNldFBlcnNpc3RlbmNlKGluZGV4ZWREQkxvY2FsUGVyc2lzdGVuY2UpO1xuICAgICAgY29uc29sZS5sb2coJ1tGaXJlYmFzZV0gUGVyc2lzdGVuY2Ugc2V0IHRvIEluZGV4ZWREQicpO1xuXG4gICAgICBjb25zb2xlLmxvZygnW0ZpcmViYXNlXSDinIUgSW5pdGlhbGl6ZWQgd2l0aCBXRUItRVhURU5TSU9OIGF1dGggZm9yIHNlcnZpY2Ugd29ya2VyJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFBvcHVwL0NvbnRlbnQ6IFVzZSBzdGFuZGFyZCBhdXRoIG1vZHVsZSAocmVxdWlyZXMgRE9NKVxuICAgICAgY29uc29sZS5sb2coJ1tGaXJlYmFzZV0gQ2FsbGluZyBnZXRBdXRoIHdpdGggc3RhbmRhcmQgbW9kdWxlLi4uJyk7XG4gICAgICBhdXRoID0gZ2V0U3RhbmRhcmRBdXRoKGFwcCk7XG4gICAgICBjb25zb2xlLmxvZygnW0ZpcmViYXNlXSBBdXRoIGluc3RhbmNlIGNyZWF0ZWQnKTtcblxuICAgICAgY29uc29sZS5sb2coJ1tGaXJlYmFzZV0g4pyFIEluaXRpYWxpemVkIHdpdGggU1RBTkRBUkQgYXV0aCBmb3IgcG9wdXAvY29udGVudCcpO1xuXG4gICAgICAvLyBBdXRoIGVtdWxhdG9yIG9ubHkgaW4gcG9wdXAvY29udGVudCAoc2VydmljZSB3b3JrZXIgZG9lc24ndCBzdXBwb3J0IGl0KVxuICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnICYmIHByb2Nlc3MuZW52LlVTRV9GSVJFQkFTRV9FTVVMQVRPUlMgPT09ICd0cnVlJykge1xuICAgICAgICBjb25uZWN0QXV0aEVtdWxhdG9yKGF1dGgsICdodHRwOi8vbG9jYWxob3N0OjkwOTknKTtcbiAgICAgICAgY29uc29sZS5sb2coJ1tGaXJlYmFzZV0gQ29ubmVjdGVkIGF1dGggdG8gbG9jYWwgZW11bGF0b3InKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygnW0ZpcmViYXNlXSBBdXRoIGluaXRpYWxpemF0aW9uIGNvbXBsZXRlLCByZXR1cm5pbmcgYXV0aCcpO1xuICAgIHJldHVybiBhdXRoO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tGaXJlYmFzZV0gQXV0aCBpbml0aWFsaXphdGlvbiBmYWlsZWQgaW4nLCBjb250ZXh0TmFtZSwgJzonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn0pKCk7XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBlbnN1cmUgYXV0aCBpcyByZWFkeSBiZWZvcmUgdXNpbmdcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB3YWl0Rm9yQXV0aCgpOiBQcm9taXNlPEF1dGg+IHtcbiAgcmV0dXJuIGF1dGhSZWFkeTtcbn1cblxuZXhwb3J0IHsgYXBwLCBhdXRoLCBkYiwgYXV0aFJlYWR5IH07XG4iLCJpbXBvcnQgeyByZWdpc3RlclZlcnNpb24gfSBmcm9tICdAZmlyZWJhc2UvYXBwJztcbmV4cG9ydCAqIGZyb20gJ0BmaXJlYmFzZS9hcHAnO1xuXG52YXIgbmFtZSA9IFwiZmlyZWJhc2VcIjtcbnZhciB2ZXJzaW9uID0gXCIxMi41LjBcIjtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbnJlZ2lzdGVyVmVyc2lvbihuYW1lLCB2ZXJzaW9uLCAnYXBwJyk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5lc20uanMubWFwXG4iLCJpbXBvcnQgeyB3IGFzIHdyYXAsIHIgYXMgcmVwbGFjZVRyYXBzIH0gZnJvbSAnLi93cmFwLWlkYi12YWx1ZS5qcyc7XG5leHBvcnQgeyB1IGFzIHVud3JhcCwgdyBhcyB3cmFwIH0gZnJvbSAnLi93cmFwLWlkYi12YWx1ZS5qcyc7XG5cbi8qKlxuICogT3BlbiBhIGRhdGFiYXNlLlxuICpcbiAqIEBwYXJhbSBuYW1lIE5hbWUgb2YgdGhlIGRhdGFiYXNlLlxuICogQHBhcmFtIHZlcnNpb24gU2NoZW1hIHZlcnNpb24uXG4gKiBAcGFyYW0gY2FsbGJhY2tzIEFkZGl0aW9uYWwgY2FsbGJhY2tzLlxuICovXG5mdW5jdGlvbiBvcGVuREIobmFtZSwgdmVyc2lvbiwgeyBibG9ja2VkLCB1cGdyYWRlLCBibG9ja2luZywgdGVybWluYXRlZCB9ID0ge30pIHtcbiAgICBjb25zdCByZXF1ZXN0ID0gaW5kZXhlZERCLm9wZW4obmFtZSwgdmVyc2lvbik7XG4gICAgY29uc3Qgb3BlblByb21pc2UgPSB3cmFwKHJlcXVlc3QpO1xuICAgIGlmICh1cGdyYWRlKSB7XG4gICAgICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcigndXBncmFkZW5lZWRlZCcsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgdXBncmFkZSh3cmFwKHJlcXVlc3QucmVzdWx0KSwgZXZlbnQub2xkVmVyc2lvbiwgZXZlbnQubmV3VmVyc2lvbiwgd3JhcChyZXF1ZXN0LnRyYW5zYWN0aW9uKSwgZXZlbnQpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGJsb2NrZWQpIHtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdibG9ja2VkJywgKGV2ZW50KSA9PiBibG9ja2VkKFxuICAgICAgICAvLyBDYXN0aW5nIGR1ZSB0byBodHRwczovL2dpdGh1Yi5jb20vbWljcm9zb2Z0L1R5cGVTY3JpcHQtRE9NLWxpYi1nZW5lcmF0b3IvcHVsbC8xNDA1XG4gICAgICAgIGV2ZW50Lm9sZFZlcnNpb24sIGV2ZW50Lm5ld1ZlcnNpb24sIGV2ZW50KSk7XG4gICAgfVxuICAgIG9wZW5Qcm9taXNlXG4gICAgICAgIC50aGVuKChkYikgPT4ge1xuICAgICAgICBpZiAodGVybWluYXRlZClcbiAgICAgICAgICAgIGRiLmFkZEV2ZW50TGlzdGVuZXIoJ2Nsb3NlJywgKCkgPT4gdGVybWluYXRlZCgpKTtcbiAgICAgICAgaWYgKGJsb2NraW5nKSB7XG4gICAgICAgICAgICBkYi5hZGRFdmVudExpc3RlbmVyKCd2ZXJzaW9uY2hhbmdlJywgKGV2ZW50KSA9PiBibG9ja2luZyhldmVudC5vbGRWZXJzaW9uLCBldmVudC5uZXdWZXJzaW9uLCBldmVudCkpO1xuICAgICAgICB9XG4gICAgfSlcbiAgICAgICAgLmNhdGNoKCgpID0+IHsgfSk7XG4gICAgcmV0dXJuIG9wZW5Qcm9taXNlO1xufVxuLyoqXG4gKiBEZWxldGUgYSBkYXRhYmFzZS5cbiAqXG4gKiBAcGFyYW0gbmFtZSBOYW1lIG9mIHRoZSBkYXRhYmFzZS5cbiAqL1xuZnVuY3Rpb24gZGVsZXRlREIobmFtZSwgeyBibG9ja2VkIH0gPSB7fSkge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBpbmRleGVkREIuZGVsZXRlRGF0YWJhc2UobmFtZSk7XG4gICAgaWYgKGJsb2NrZWQpIHtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdibG9ja2VkJywgKGV2ZW50KSA9PiBibG9ja2VkKFxuICAgICAgICAvLyBDYXN0aW5nIGR1ZSB0byBodHRwczovL2dpdGh1Yi5jb20vbWljcm9zb2Z0L1R5cGVTY3JpcHQtRE9NLWxpYi1nZW5lcmF0b3IvcHVsbC8xNDA1XG4gICAgICAgIGV2ZW50Lm9sZFZlcnNpb24sIGV2ZW50KSk7XG4gICAgfVxuICAgIHJldHVybiB3cmFwKHJlcXVlc3QpLnRoZW4oKCkgPT4gdW5kZWZpbmVkKTtcbn1cblxuY29uc3QgcmVhZE1ldGhvZHMgPSBbJ2dldCcsICdnZXRLZXknLCAnZ2V0QWxsJywgJ2dldEFsbEtleXMnLCAnY291bnQnXTtcbmNvbnN0IHdyaXRlTWV0aG9kcyA9IFsncHV0JywgJ2FkZCcsICdkZWxldGUnLCAnY2xlYXInXTtcbmNvbnN0IGNhY2hlZE1ldGhvZHMgPSBuZXcgTWFwKCk7XG5mdW5jdGlvbiBnZXRNZXRob2QodGFyZ2V0LCBwcm9wKSB7XG4gICAgaWYgKCEodGFyZ2V0IGluc3RhbmNlb2YgSURCRGF0YWJhc2UgJiZcbiAgICAgICAgIShwcm9wIGluIHRhcmdldCkgJiZcbiAgICAgICAgdHlwZW9mIHByb3AgPT09ICdzdHJpbmcnKSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChjYWNoZWRNZXRob2RzLmdldChwcm9wKSlcbiAgICAgICAgcmV0dXJuIGNhY2hlZE1ldGhvZHMuZ2V0KHByb3ApO1xuICAgIGNvbnN0IHRhcmdldEZ1bmNOYW1lID0gcHJvcC5yZXBsYWNlKC9Gcm9tSW5kZXgkLywgJycpO1xuICAgIGNvbnN0IHVzZUluZGV4ID0gcHJvcCAhPT0gdGFyZ2V0RnVuY05hbWU7XG4gICAgY29uc3QgaXNXcml0ZSA9IHdyaXRlTWV0aG9kcy5pbmNsdWRlcyh0YXJnZXRGdW5jTmFtZSk7XG4gICAgaWYgKFxuICAgIC8vIEJhaWwgaWYgdGhlIHRhcmdldCBkb2Vzbid0IGV4aXN0IG9uIHRoZSB0YXJnZXQuIEVnLCBnZXRBbGwgaXNuJ3QgaW4gRWRnZS5cbiAgICAhKHRhcmdldEZ1bmNOYW1lIGluICh1c2VJbmRleCA/IElEQkluZGV4IDogSURCT2JqZWN0U3RvcmUpLnByb3RvdHlwZSkgfHxcbiAgICAgICAgIShpc1dyaXRlIHx8IHJlYWRNZXRob2RzLmluY2x1ZGVzKHRhcmdldEZ1bmNOYW1lKSkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBtZXRob2QgPSBhc3luYyBmdW5jdGlvbiAoc3RvcmVOYW1lLCAuLi5hcmdzKSB7XG4gICAgICAgIC8vIGlzV3JpdGUgPyAncmVhZHdyaXRlJyA6IHVuZGVmaW5lZCBnemlwcHMgYmV0dGVyLCBidXQgZmFpbHMgaW4gRWRnZSA6KFxuICAgICAgICBjb25zdCB0eCA9IHRoaXMudHJhbnNhY3Rpb24oc3RvcmVOYW1lLCBpc1dyaXRlID8gJ3JlYWR3cml0ZScgOiAncmVhZG9ubHknKTtcbiAgICAgICAgbGV0IHRhcmdldCA9IHR4LnN0b3JlO1xuICAgICAgICBpZiAodXNlSW5kZXgpXG4gICAgICAgICAgICB0YXJnZXQgPSB0YXJnZXQuaW5kZXgoYXJncy5zaGlmdCgpKTtcbiAgICAgICAgLy8gTXVzdCByZWplY3QgaWYgb3AgcmVqZWN0cy5cbiAgICAgICAgLy8gSWYgaXQncyBhIHdyaXRlIG9wZXJhdGlvbiwgbXVzdCByZWplY3QgaWYgdHguZG9uZSByZWplY3RzLlxuICAgICAgICAvLyBNdXN0IHJlamVjdCB3aXRoIG9wIHJlamVjdGlvbiBmaXJzdC5cbiAgICAgICAgLy8gTXVzdCByZXNvbHZlIHdpdGggb3AgdmFsdWUuXG4gICAgICAgIC8vIE11c3QgaGFuZGxlIGJvdGggcHJvbWlzZXMgKG5vIHVuaGFuZGxlZCByZWplY3Rpb25zKVxuICAgICAgICByZXR1cm4gKGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgICAgIHRhcmdldFt0YXJnZXRGdW5jTmFtZV0oLi4uYXJncyksXG4gICAgICAgICAgICBpc1dyaXRlICYmIHR4LmRvbmUsXG4gICAgICAgIF0pKVswXTtcbiAgICB9O1xuICAgIGNhY2hlZE1ldGhvZHMuc2V0KHByb3AsIG1ldGhvZCk7XG4gICAgcmV0dXJuIG1ldGhvZDtcbn1cbnJlcGxhY2VUcmFwcygob2xkVHJhcHMpID0+ICh7XG4gICAgLi4ub2xkVHJhcHMsXG4gICAgZ2V0OiAodGFyZ2V0LCBwcm9wLCByZWNlaXZlcikgPT4gZ2V0TWV0aG9kKHRhcmdldCwgcHJvcCkgfHwgb2xkVHJhcHMuZ2V0KHRhcmdldCwgcHJvcCwgcmVjZWl2ZXIpLFxuICAgIGhhczogKHRhcmdldCwgcHJvcCkgPT4gISFnZXRNZXRob2QodGFyZ2V0LCBwcm9wKSB8fCBvbGRUcmFwcy5oYXModGFyZ2V0LCBwcm9wKSxcbn0pKTtcblxuZXhwb3J0IHsgZGVsZXRlREIsIG9wZW5EQiB9O1xuIiwiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBjb250YWluZXIgZm9yIGFsbCBvZiB0aGUgTG9nZ2VyIGluc3RhbmNlc1xuICovXG5jb25zdCBpbnN0YW5jZXMgPSBbXTtcbi8qKlxuICogVGhlIEpTIFNESyBzdXBwb3J0cyA1IGxvZyBsZXZlbHMgYW5kIGFsc28gYWxsb3dzIGEgdXNlciB0aGUgYWJpbGl0eSB0b1xuICogc2lsZW5jZSB0aGUgbG9ncyBhbHRvZ2V0aGVyLlxuICpcbiAqIFRoZSBvcmRlciBpcyBhIGZvbGxvd3M6XG4gKiBERUJVRyA8IFZFUkJPU0UgPCBJTkZPIDwgV0FSTiA8IEVSUk9SXG4gKlxuICogQWxsIG9mIHRoZSBsb2cgdHlwZXMgYWJvdmUgdGhlIGN1cnJlbnQgbG9nIGxldmVsIHdpbGwgYmUgY2FwdHVyZWQgKGkuZS4gaWZcbiAqIHlvdSBzZXQgdGhlIGxvZyBsZXZlbCB0byBgSU5GT2AsIGVycm9ycyB3aWxsIHN0aWxsIGJlIGxvZ2dlZCwgYnV0IGBERUJVR2AgYW5kXG4gKiBgVkVSQk9TRWAgbG9ncyB3aWxsIG5vdClcbiAqL1xudmFyIExvZ0xldmVsO1xuKGZ1bmN0aW9uIChMb2dMZXZlbCkge1xuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiREVCVUdcIl0gPSAwXSA9IFwiREVCVUdcIjtcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIlZFUkJPU0VcIl0gPSAxXSA9IFwiVkVSQk9TRVwiO1xuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiSU5GT1wiXSA9IDJdID0gXCJJTkZPXCI7XG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJXQVJOXCJdID0gM10gPSBcIldBUk5cIjtcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIkVSUk9SXCJdID0gNF0gPSBcIkVSUk9SXCI7XG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJTSUxFTlRcIl0gPSA1XSA9IFwiU0lMRU5UXCI7XG59KShMb2dMZXZlbCB8fCAoTG9nTGV2ZWwgPSB7fSkpO1xuY29uc3QgbGV2ZWxTdHJpbmdUb0VudW0gPSB7XG4gICAgJ2RlYnVnJzogTG9nTGV2ZWwuREVCVUcsXG4gICAgJ3ZlcmJvc2UnOiBMb2dMZXZlbC5WRVJCT1NFLFxuICAgICdpbmZvJzogTG9nTGV2ZWwuSU5GTyxcbiAgICAnd2Fybic6IExvZ0xldmVsLldBUk4sXG4gICAgJ2Vycm9yJzogTG9nTGV2ZWwuRVJST1IsXG4gICAgJ3NpbGVudCc6IExvZ0xldmVsLlNJTEVOVFxufTtcbi8qKlxuICogVGhlIGRlZmF1bHQgbG9nIGxldmVsXG4gKi9cbmNvbnN0IGRlZmF1bHRMb2dMZXZlbCA9IExvZ0xldmVsLklORk87XG4vKipcbiAqIEJ5IGRlZmF1bHQsIGBjb25zb2xlLmRlYnVnYCBpcyBub3QgZGlzcGxheWVkIGluIHRoZSBkZXZlbG9wZXIgY29uc29sZSAoaW5cbiAqIGNocm9tZSkuIFRvIGF2b2lkIGZvcmNpbmcgdXNlcnMgdG8gaGF2ZSB0byBvcHQtaW4gdG8gdGhlc2UgbG9ncyB0d2ljZVxuICogKGkuZS4gb25jZSBmb3IgZmlyZWJhc2UsIGFuZCBvbmNlIGluIHRoZSBjb25zb2xlKSwgd2UgYXJlIHNlbmRpbmcgYERFQlVHYFxuICogbG9ncyB0byB0aGUgYGNvbnNvbGUubG9nYCBmdW5jdGlvbi5cbiAqL1xuY29uc3QgQ29uc29sZU1ldGhvZCA9IHtcbiAgICBbTG9nTGV2ZWwuREVCVUddOiAnbG9nJyxcbiAgICBbTG9nTGV2ZWwuVkVSQk9TRV06ICdsb2cnLFxuICAgIFtMb2dMZXZlbC5JTkZPXTogJ2luZm8nLFxuICAgIFtMb2dMZXZlbC5XQVJOXTogJ3dhcm4nLFxuICAgIFtMb2dMZXZlbC5FUlJPUl06ICdlcnJvcidcbn07XG4vKipcbiAqIFRoZSBkZWZhdWx0IGxvZyBoYW5kbGVyIHdpbGwgZm9yd2FyZCBERUJVRywgVkVSQk9TRSwgSU5GTywgV0FSTiwgYW5kIEVSUk9SXG4gKiBtZXNzYWdlcyBvbiB0byB0aGVpciBjb3JyZXNwb25kaW5nIGNvbnNvbGUgY291bnRlcnBhcnRzIChpZiB0aGUgbG9nIG1ldGhvZFxuICogaXMgc3VwcG9ydGVkIGJ5IHRoZSBjdXJyZW50IGxvZyBsZXZlbClcbiAqL1xuY29uc3QgZGVmYXVsdExvZ0hhbmRsZXIgPSAoaW5zdGFuY2UsIGxvZ1R5cGUsIC4uLmFyZ3MpID0+IHtcbiAgICBpZiAobG9nVHlwZSA8IGluc3RhbmNlLmxvZ0xldmVsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgIGNvbnN0IG1ldGhvZCA9IENvbnNvbGVNZXRob2RbbG9nVHlwZV07XG4gICAgaWYgKG1ldGhvZCkge1xuICAgICAgICBjb25zb2xlW21ldGhvZF0oYFske25vd31dICAke2luc3RhbmNlLm5hbWV9OmAsIC4uLmFyZ3MpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBdHRlbXB0ZWQgdG8gbG9nIGEgbWVzc2FnZSB3aXRoIGFuIGludmFsaWQgbG9nVHlwZSAodmFsdWU6ICR7bG9nVHlwZX0pYCk7XG4gICAgfVxufTtcbmNsYXNzIExvZ2dlciB7XG4gICAgLyoqXG4gICAgICogR2l2ZXMgeW91IGFuIGluc3RhbmNlIG9mIGEgTG9nZ2VyIHRvIGNhcHR1cmUgbWVzc2FnZXMgYWNjb3JkaW5nIHRvXG4gICAgICogRmlyZWJhc2UncyBsb2dnaW5nIHNjaGVtZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBuYW1lIFRoZSBuYW1lIHRoYXQgdGhlIGxvZ3Mgd2lsbCBiZSBhc3NvY2lhdGVkIHdpdGhcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihuYW1lKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbG9nIGxldmVsIG9mIHRoZSBnaXZlbiBMb2dnZXIgaW5zdGFuY2UuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9sb2dMZXZlbCA9IGRlZmF1bHRMb2dMZXZlbDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBtYWluIChpbnRlcm5hbCkgbG9nIGhhbmRsZXIgZm9yIHRoZSBMb2dnZXIgaW5zdGFuY2UuXG4gICAgICAgICAqIENhbiBiZSBzZXQgdG8gYSBuZXcgZnVuY3Rpb24gaW4gaW50ZXJuYWwgcGFja2FnZSBjb2RlIGJ1dCBub3QgYnkgdXNlci5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIgPSBkZWZhdWx0TG9nSGFuZGxlcjtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBvcHRpb25hbCwgYWRkaXRpb25hbCwgdXNlci1kZWZpbmVkIGxvZyBoYW5kbGVyIGZvciB0aGUgTG9nZ2VyIGluc3RhbmNlLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIgPSBudWxsO1xuICAgICAgICAvKipcbiAgICAgICAgICogQ2FwdHVyZSB0aGUgY3VycmVudCBpbnN0YW5jZSBmb3IgbGF0ZXIgdXNlXG4gICAgICAgICAqL1xuICAgICAgICBpbnN0YW5jZXMucHVzaCh0aGlzKTtcbiAgICB9XG4gICAgZ2V0IGxvZ0xldmVsKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbG9nTGV2ZWw7XG4gICAgfVxuICAgIHNldCBsb2dMZXZlbCh2YWwpIHtcbiAgICAgICAgaWYgKCEodmFsIGluIExvZ0xldmVsKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgSW52YWxpZCB2YWx1ZSBcIiR7dmFsfVwiIGFzc2lnbmVkIHRvIFxcYGxvZ0xldmVsXFxgYCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbG9nTGV2ZWwgPSB2YWw7XG4gICAgfVxuICAgIC8vIFdvcmthcm91bmQgZm9yIHNldHRlci9nZXR0ZXIgaGF2aW5nIHRvIGJlIHRoZSBzYW1lIHR5cGUuXG4gICAgc2V0TG9nTGV2ZWwodmFsKSB7XG4gICAgICAgIHRoaXMuX2xvZ0xldmVsID0gdHlwZW9mIHZhbCA9PT0gJ3N0cmluZycgPyBsZXZlbFN0cmluZ1RvRW51bVt2YWxdIDogdmFsO1xuICAgIH1cbiAgICBnZXQgbG9nSGFuZGxlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xvZ0hhbmRsZXI7XG4gICAgfVxuICAgIHNldCBsb2dIYW5kbGVyKHZhbCkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbCAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVmFsdWUgYXNzaWduZWQgdG8gYGxvZ0hhbmRsZXJgIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIgPSB2YWw7XG4gICAgfVxuICAgIGdldCB1c2VyTG9nSGFuZGxlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VzZXJMb2dIYW5kbGVyO1xuICAgIH1cbiAgICBzZXQgdXNlckxvZ0hhbmRsZXIodmFsKSB7XG4gICAgICAgIHRoaXMuX3VzZXJMb2dIYW5kbGVyID0gdmFsO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgZnVuY3Rpb25zIGJlbG93IGFyZSBhbGwgYmFzZWQgb24gdGhlIGBjb25zb2xlYCBpbnRlcmZhY2VcbiAgICAgKi9cbiAgICBkZWJ1ZyguLi5hcmdzKSB7XG4gICAgICAgIHRoaXMuX3VzZXJMb2dIYW5kbGVyICYmIHRoaXMuX3VzZXJMb2dIYW5kbGVyKHRoaXMsIExvZ0xldmVsLkRFQlVHLCAuLi5hcmdzKTtcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlcih0aGlzLCBMb2dMZXZlbC5ERUJVRywgLi4uYXJncyk7XG4gICAgfVxuICAgIGxvZyguLi5hcmdzKSB7XG4gICAgICAgIHRoaXMuX3VzZXJMb2dIYW5kbGVyICYmXG4gICAgICAgICAgICB0aGlzLl91c2VyTG9nSGFuZGxlcih0aGlzLCBMb2dMZXZlbC5WRVJCT1NFLCAuLi5hcmdzKTtcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlcih0aGlzLCBMb2dMZXZlbC5WRVJCT1NFLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgaW5mbyguLi5hcmdzKSB7XG4gICAgICAgIHRoaXMuX3VzZXJMb2dIYW5kbGVyICYmIHRoaXMuX3VzZXJMb2dIYW5kbGVyKHRoaXMsIExvZ0xldmVsLklORk8sIC4uLmFyZ3MpO1xuICAgICAgICB0aGlzLl9sb2dIYW5kbGVyKHRoaXMsIExvZ0xldmVsLklORk8sIC4uLmFyZ3MpO1xuICAgIH1cbiAgICB3YXJuKC4uLmFyZ3MpIHtcbiAgICAgICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIgJiYgdGhpcy5fdXNlckxvZ0hhbmRsZXIodGhpcywgTG9nTGV2ZWwuV0FSTiwgLi4uYXJncyk7XG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIodGhpcywgTG9nTGV2ZWwuV0FSTiwgLi4uYXJncyk7XG4gICAgfVxuICAgIGVycm9yKC4uLmFyZ3MpIHtcbiAgICAgICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIgJiYgdGhpcy5fdXNlckxvZ0hhbmRsZXIodGhpcywgTG9nTGV2ZWwuRVJST1IsIC4uLmFyZ3MpO1xuICAgICAgICB0aGlzLl9sb2dIYW5kbGVyKHRoaXMsIExvZ0xldmVsLkVSUk9SLCAuLi5hcmdzKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzZXRMb2dMZXZlbChsZXZlbCkge1xuICAgIGluc3RhbmNlcy5mb3JFYWNoKGluc3QgPT4ge1xuICAgICAgICBpbnN0LnNldExvZ0xldmVsKGxldmVsKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIHNldFVzZXJMb2dIYW5kbGVyKGxvZ0NhbGxiYWNrLCBvcHRpb25zKSB7XG4gICAgZm9yIChjb25zdCBpbnN0YW5jZSBvZiBpbnN0YW5jZXMpIHtcbiAgICAgICAgbGV0IGN1c3RvbUxvZ0xldmVsID0gbnVsbDtcbiAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5sZXZlbCkge1xuICAgICAgICAgICAgY3VzdG9tTG9nTGV2ZWwgPSBsZXZlbFN0cmluZ1RvRW51bVtvcHRpb25zLmxldmVsXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobG9nQ2FsbGJhY2sgPT09IG51bGwpIHtcbiAgICAgICAgICAgIGluc3RhbmNlLnVzZXJMb2dIYW5kbGVyID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGluc3RhbmNlLnVzZXJMb2dIYW5kbGVyID0gKGluc3RhbmNlLCBsZXZlbCwgLi4uYXJncykgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBhcmdzXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoYXJnID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFyZyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgYXJnID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFyZztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgYXJnID09PSAnbnVtYmVyJyB8fCB0eXBlb2YgYXJnID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhcmcudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChhcmcgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFyZy5tZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoYXJnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChpZ25vcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGFyZyA9PiBhcmcpXG4gICAgICAgICAgICAgICAgICAgIC5qb2luKCcgJyk7XG4gICAgICAgICAgICAgICAgaWYgKGxldmVsID49IChjdXN0b21Mb2dMZXZlbCA/PyBpbnN0YW5jZS5sb2dMZXZlbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9nQ2FsbGJhY2soe1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWw6IExvZ0xldmVsW2xldmVsXS50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBpbnN0YW5jZS5uYW1lXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCB7IExvZ0xldmVsLCBMb2dnZXIsIHNldExvZ0xldmVsLCBzZXRVc2VyTG9nSGFuZGxlciB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguZXNtLmpzLm1hcFxuIiwiaW1wb3J0IHsgRXJyb3JGYWN0b3J5LCBpc0Jyb3dzZXJFeHRlbnNpb24sIGlzTW9iaWxlQ29yZG92YSwgaXNSZWFjdE5hdGl2ZSwgRmlyZWJhc2VFcnJvciwgcXVlcnlzdHJpbmcsIGlzQ2xvdWRmbGFyZVdvcmtlciwgaXNDbG91ZFdvcmtzdGF0aW9uLCBnZXRNb2R1bGFySW5zdGFuY2UsIGJhc2U2NERlY29kZSwgZ2V0VUEsIGlzSUUsIGNyZWF0ZVN1YnNjcmliZSwgZGVlcEVxdWFsLCBwaW5nU2VydmVyLCB1cGRhdGVFbXVsYXRvckJhbm5lciwgcXVlcnlzdHJpbmdEZWNvZGUsIGV4dHJhY3RRdWVyeXN0cmluZyB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmltcG9ydCB7IFNES19WRVJTSU9OLCBfaXNGaXJlYmFzZVNlcnZlckFwcCwgX2dldFByb3ZpZGVyLCBfcmVnaXN0ZXJDb21wb25lbnQsIHJlZ2lzdGVyVmVyc2lvbiB9IGZyb20gJ0BmaXJlYmFzZS9hcHAnO1xuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnQGZpcmViYXNlL2NvbXBvbmVudCc7XG5pbXBvcnQgeyBMb2dnZXIsIExvZ0xldmVsIH0gZnJvbSAnQGZpcmViYXNlL2xvZ2dlcic7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5mdW5jdGlvbiBfZGVidWdFcnJvck1hcCgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBbXCJhZG1pbi1yZXN0cmljdGVkLW9wZXJhdGlvblwiIC8qIEF1dGhFcnJvckNvZGUuQURNSU5fT05MWV9PUEVSQVRJT04gKi9dOiAnVGhpcyBvcGVyYXRpb24gaXMgcmVzdHJpY3RlZCB0byBhZG1pbmlzdHJhdG9ycyBvbmx5LicsXG4gICAgICAgIFtcImFyZ3VtZW50LWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUiAqL106ICcnLFxuICAgICAgICBbXCJhcHAtbm90LWF1dGhvcml6ZWRcIiAvKiBBdXRoRXJyb3JDb2RlLkFQUF9OT1RfQVVUSE9SSVpFRCAqL106IFwiVGhpcyBhcHAsIGlkZW50aWZpZWQgYnkgdGhlIGRvbWFpbiB3aGVyZSBpdCdzIGhvc3RlZCwgaXMgbm90IFwiICtcbiAgICAgICAgICAgICdhdXRob3JpemVkIHRvIHVzZSBGaXJlYmFzZSBBdXRoZW50aWNhdGlvbiB3aXRoIHRoZSBwcm92aWRlZCBBUEkga2V5LiAnICtcbiAgICAgICAgICAgICdSZXZpZXcgeW91ciBrZXkgY29uZmlndXJhdGlvbiBpbiB0aGUgR29vZ2xlIEFQSSBjb25zb2xlLicsXG4gICAgICAgIFtcImFwcC1ub3QtaW5zdGFsbGVkXCIgLyogQXV0aEVycm9yQ29kZS5BUFBfTk9UX0lOU1RBTExFRCAqL106ICdUaGUgcmVxdWVzdGVkIG1vYmlsZSBhcHBsaWNhdGlvbiBjb3JyZXNwb25kaW5nIHRvIHRoZSBpZGVudGlmaWVyICgnICtcbiAgICAgICAgICAgICdBbmRyb2lkIHBhY2thZ2UgbmFtZSBvciBpT1MgYnVuZGxlIElEKSBwcm92aWRlZCBpcyBub3QgaW5zdGFsbGVkIG9uICcgK1xuICAgICAgICAgICAgJ3RoaXMgZGV2aWNlLicsXG4gICAgICAgIFtcImNhcHRjaGEtY2hlY2stZmFpbGVkXCIgLyogQXV0aEVycm9yQ29kZS5DQVBUQ0hBX0NIRUNLX0ZBSUxFRCAqL106ICdUaGUgcmVDQVBUQ0hBIHJlc3BvbnNlIHRva2VuIHByb3ZpZGVkIGlzIGVpdGhlciBpbnZhbGlkLCBleHBpcmVkLCAnICtcbiAgICAgICAgICAgICdhbHJlYWR5IHVzZWQgb3IgdGhlIGRvbWFpbiBhc3NvY2lhdGVkIHdpdGggaXQgZG9lcyBub3QgbWF0Y2ggdGhlIGxpc3QgJyArXG4gICAgICAgICAgICAnb2Ygd2hpdGVsaXN0ZWQgZG9tYWlucy4nLFxuICAgICAgICBbXCJjb2RlLWV4cGlyZWRcIiAvKiBBdXRoRXJyb3JDb2RlLkNPREVfRVhQSVJFRCAqL106ICdUaGUgU01TIGNvZGUgaGFzIGV4cGlyZWQuIFBsZWFzZSByZS1zZW5kIHRoZSB2ZXJpZmljYXRpb24gY29kZSB0byB0cnkgJyArXG4gICAgICAgICAgICAnYWdhaW4uJyxcbiAgICAgICAgW1wiY29yZG92YS1ub3QtcmVhZHlcIiAvKiBBdXRoRXJyb3JDb2RlLkNPUkRPVkFfTk9UX1JFQURZICovXTogJ0NvcmRvdmEgZnJhbWV3b3JrIGlzIG5vdCByZWFkeS4nLFxuICAgICAgICBbXCJjb3JzLXVuc3VwcG9ydGVkXCIgLyogQXV0aEVycm9yQ29kZS5DT1JTX1VOU1VQUE9SVEVEICovXTogJ1RoaXMgYnJvd3NlciBpcyBub3Qgc3VwcG9ydGVkLicsXG4gICAgICAgIFtcImNyZWRlbnRpYWwtYWxyZWFkeS1pbi11c2VcIiAvKiBBdXRoRXJyb3JDb2RlLkNSRURFTlRJQUxfQUxSRUFEWV9JTl9VU0UgKi9dOiAnVGhpcyBjcmVkZW50aWFsIGlzIGFscmVhZHkgYXNzb2NpYXRlZCB3aXRoIGEgZGlmZmVyZW50IHVzZXIgYWNjb3VudC4nLFxuICAgICAgICBbXCJjdXN0b20tdG9rZW4tbWlzbWF0Y2hcIiAvKiBBdXRoRXJyb3JDb2RlLkNSRURFTlRJQUxfTUlTTUFUQ0ggKi9dOiAnVGhlIGN1c3RvbSB0b2tlbiBjb3JyZXNwb25kcyB0byBhIGRpZmZlcmVudCBhdWRpZW5jZS4nLFxuICAgICAgICBbXCJyZXF1aXJlcy1yZWNlbnQtbG9naW5cIiAvKiBBdXRoRXJyb3JDb2RlLkNSRURFTlRJQUxfVE9PX09MRF9MT0dJTl9BR0FJTiAqL106ICdUaGlzIG9wZXJhdGlvbiBpcyBzZW5zaXRpdmUgYW5kIHJlcXVpcmVzIHJlY2VudCBhdXRoZW50aWNhdGlvbi4gTG9nIGluICcgK1xuICAgICAgICAgICAgJ2FnYWluIGJlZm9yZSByZXRyeWluZyB0aGlzIHJlcXVlc3QuJyxcbiAgICAgICAgW1wiZGVwZW5kZW50LXNkay1pbml0aWFsaXplZC1iZWZvcmUtYXV0aFwiIC8qIEF1dGhFcnJvckNvZGUuREVQRU5ERU5UX1NES19JTklUX0JFRk9SRV9BVVRIICovXTogJ0Fub3RoZXIgRmlyZWJhc2UgU0RLIHdhcyBpbml0aWFsaXplZCBhbmQgaXMgdHJ5aW5nIHRvIHVzZSBBdXRoIGJlZm9yZSBBdXRoIGlzICcgK1xuICAgICAgICAgICAgJ2luaXRpYWxpemVkLiBQbGVhc2UgYmUgc3VyZSB0byBjYWxsIGBpbml0aWFsaXplQXV0aGAgb3IgYGdldEF1dGhgIGJlZm9yZSAnICtcbiAgICAgICAgICAgICdzdGFydGluZyBhbnkgb3RoZXIgRmlyZWJhc2UgU0RLLicsXG4gICAgICAgIFtcImR5bmFtaWMtbGluay1ub3QtYWN0aXZhdGVkXCIgLyogQXV0aEVycm9yQ29kZS5EWU5BTUlDX0xJTktfTk9UX0FDVElWQVRFRCAqL106ICdQbGVhc2UgYWN0aXZhdGUgRHluYW1pYyBMaW5rcyBpbiB0aGUgRmlyZWJhc2UgQ29uc29sZSBhbmQgYWdyZWUgdG8gdGhlIHRlcm1zIGFuZCAnICtcbiAgICAgICAgICAgICdjb25kaXRpb25zLicsXG4gICAgICAgIFtcImVtYWlsLWNoYW5nZS1uZWVkcy12ZXJpZmljYXRpb25cIiAvKiBBdXRoRXJyb3JDb2RlLkVNQUlMX0NIQU5HRV9ORUVEU19WRVJJRklDQVRJT04gKi9dOiAnTXVsdGktZmFjdG9yIHVzZXJzIG11c3QgYWx3YXlzIGhhdmUgYSB2ZXJpZmllZCBlbWFpbC4nLFxuICAgICAgICBbXCJlbWFpbC1hbHJlYWR5LWluLXVzZVwiIC8qIEF1dGhFcnJvckNvZGUuRU1BSUxfRVhJU1RTICovXTogJ1RoZSBlbWFpbCBhZGRyZXNzIGlzIGFscmVhZHkgaW4gdXNlIGJ5IGFub3RoZXIgYWNjb3VudC4nLFxuICAgICAgICBbXCJlbXVsYXRvci1jb25maWctZmFpbGVkXCIgLyogQXV0aEVycm9yQ29kZS5FTVVMQVRPUl9DT05GSUdfRkFJTEVEICovXTogJ0F1dGggaW5zdGFuY2UgaGFzIGFscmVhZHkgYmVlbiB1c2VkIHRvIG1ha2UgYSBuZXR3b3JrIGNhbGwuIEF1dGggY2FuICcgK1xuICAgICAgICAgICAgJ25vIGxvbmdlciBiZSBjb25maWd1cmVkIHRvIHVzZSB0aGUgZW11bGF0b3IuIFRyeSBjYWxsaW5nICcgK1xuICAgICAgICAgICAgJ1wiY29ubmVjdEF1dGhFbXVsYXRvcigpXCIgc29vbmVyLicsXG4gICAgICAgIFtcImV4cGlyZWQtYWN0aW9uLWNvZGVcIiAvKiBBdXRoRXJyb3JDb2RlLkVYUElSRURfT09CX0NPREUgKi9dOiAnVGhlIGFjdGlvbiBjb2RlIGhhcyBleHBpcmVkLicsXG4gICAgICAgIFtcImNhbmNlbGxlZC1wb3B1cC1yZXF1ZXN0XCIgLyogQXV0aEVycm9yQ29kZS5FWFBJUkVEX1BPUFVQX1JFUVVFU1QgKi9dOiAnVGhpcyBvcGVyYXRpb24gaGFzIGJlZW4gY2FuY2VsbGVkIGR1ZSB0byBhbm90aGVyIGNvbmZsaWN0aW5nIHBvcHVwIGJlaW5nIG9wZW5lZC4nLFxuICAgICAgICBbXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi9dOiAnQW4gaW50ZXJuYWwgQXV0aEVycm9yIGhhcyBvY2N1cnJlZC4nLFxuICAgICAgICBbXCJpbnZhbGlkLWFwcC1jcmVkZW50aWFsXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0FQUF9DUkVERU5USUFMICovXTogJ1RoZSBwaG9uZSB2ZXJpZmljYXRpb24gcmVxdWVzdCBjb250YWlucyBhbiBpbnZhbGlkIGFwcGxpY2F0aW9uIHZlcmlmaWVyLicgK1xuICAgICAgICAgICAgJyBUaGUgcmVDQVBUQ0hBIHRva2VuIHJlc3BvbnNlIGlzIGVpdGhlciBpbnZhbGlkIG9yIGV4cGlyZWQuJyxcbiAgICAgICAgW1wiaW52YWxpZC1hcHAtaWRcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfQVBQX0lEICovXTogJ1RoZSBtb2JpbGUgYXBwIGlkZW50aWZpZXIgaXMgbm90IHJlZ2lzdGVyZWQgZm9yIHRoZSBjdXJyZW50IHByb2plY3QuJyxcbiAgICAgICAgW1wiaW52YWxpZC11c2VyLXRva2VuXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0FVVEggKi9dOiBcIlRoaXMgdXNlcidzIGNyZWRlbnRpYWwgaXNuJ3QgdmFsaWQgZm9yIHRoaXMgcHJvamVjdC4gVGhpcyBjYW4gaGFwcGVuIFwiICtcbiAgICAgICAgICAgIFwiaWYgdGhlIHVzZXIncyB0b2tlbiBoYXMgYmVlbiB0YW1wZXJlZCB3aXRoLCBvciBpZiB0aGUgdXNlciBpc24ndCBmb3IgXCIgK1xuICAgICAgICAgICAgJ3RoZSBwcm9qZWN0IGFzc29jaWF0ZWQgd2l0aCB0aGlzIEFQSSBrZXkuJyxcbiAgICAgICAgW1wiaW52YWxpZC1hdXRoLWV2ZW50XCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0FVVEhfRVZFTlQgKi9dOiAnQW4gaW50ZXJuYWwgQXV0aEVycm9yIGhhcyBvY2N1cnJlZC4nLFxuICAgICAgICBbXCJpbnZhbGlkLXZlcmlmaWNhdGlvbi1jb2RlXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0NPREUgKi9dOiAnVGhlIFNNUyB2ZXJpZmljYXRpb24gY29kZSB1c2VkIHRvIGNyZWF0ZSB0aGUgcGhvbmUgYXV0aCBjcmVkZW50aWFsIGlzICcgK1xuICAgICAgICAgICAgJ2ludmFsaWQuIFBsZWFzZSByZXNlbmQgdGhlIHZlcmlmaWNhdGlvbiBjb2RlIHNtcyBhbmQgYmUgc3VyZSB0byB1c2UgdGhlICcgK1xuICAgICAgICAgICAgJ3ZlcmlmaWNhdGlvbiBjb2RlIHByb3ZpZGVkIGJ5IHRoZSB1c2VyLicsXG4gICAgICAgIFtcImludmFsaWQtY29udGludWUtdXJpXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0NPTlRJTlVFX1VSSSAqL106ICdUaGUgY29udGludWUgVVJMIHByb3ZpZGVkIGluIHRoZSByZXF1ZXN0IGlzIGludmFsaWQuJyxcbiAgICAgICAgW1wiaW52YWxpZC1jb3Jkb3ZhLWNvbmZpZ3VyYXRpb25cIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfQ09SRE9WQV9DT05GSUdVUkFUSU9OICovXTogJ1RoZSBmb2xsb3dpbmcgQ29yZG92YSBwbHVnaW5zIG11c3QgYmUgaW5zdGFsbGVkIHRvIGVuYWJsZSBPQXV0aCBzaWduLWluOiAnICtcbiAgICAgICAgICAgICdjb3Jkb3ZhLXBsdWdpbi1idWlsZGluZm8sIGNvcmRvdmEtdW5pdmVyc2FsLWxpbmtzLXBsdWdpbiwgJyArXG4gICAgICAgICAgICAnY29yZG92YS1wbHVnaW4tYnJvd3NlcnRhYiwgY29yZG92YS1wbHVnaW4taW5hcHBicm93c2VyIGFuZCAnICtcbiAgICAgICAgICAgICdjb3Jkb3ZhLXBsdWdpbi1jdXN0b211cmxzY2hlbWUuJyxcbiAgICAgICAgW1wiaW52YWxpZC1jdXN0b20tdG9rZW5cIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfQ1VTVE9NX1RPS0VOICovXTogJ1RoZSBjdXN0b20gdG9rZW4gZm9ybWF0IGlzIGluY29ycmVjdC4gUGxlYXNlIGNoZWNrIHRoZSBkb2N1bWVudGF0aW9uLicsXG4gICAgICAgIFtcImludmFsaWQtZHluYW1pYy1saW5rLWRvbWFpblwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9EWU5BTUlDX0xJTktfRE9NQUlOICovXTogJ1RoZSBwcm92aWRlZCBkeW5hbWljIGxpbmsgZG9tYWluIGlzIG5vdCBjb25maWd1cmVkIG9yIGF1dGhvcml6ZWQgZm9yIHRoZSBjdXJyZW50IHByb2plY3QuJyxcbiAgICAgICAgW1wiaW52YWxpZC1lbWFpbFwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9FTUFJTCAqL106ICdUaGUgZW1haWwgYWRkcmVzcyBpcyBiYWRseSBmb3JtYXR0ZWQuJyxcbiAgICAgICAgW1wiaW52YWxpZC1lbXVsYXRvci1zY2hlbWVcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfRU1VTEFUT1JfU0NIRU1FICovXTogJ0VtdWxhdG9yIFVSTCBtdXN0IHN0YXJ0IHdpdGggYSB2YWxpZCBzY2hlbWUgKGh0dHA6Ly8gb3IgaHR0cHM6Ly8pLicsXG4gICAgICAgIFtcImludmFsaWQtYXBpLWtleVwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9BUElfS0VZICovXTogJ1lvdXIgQVBJIGtleSBpcyBpbnZhbGlkLCBwbGVhc2UgY2hlY2sgeW91IGhhdmUgY29waWVkIGl0IGNvcnJlY3RseS4nLFxuICAgICAgICBbXCJpbnZhbGlkLWNlcnQtaGFzaFwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9DRVJUX0hBU0ggKi9dOiAnVGhlIFNIQS0xIGNlcnRpZmljYXRlIGhhc2ggcHJvdmlkZWQgaXMgaW52YWxpZC4nLFxuICAgICAgICBbXCJpbnZhbGlkLWNyZWRlbnRpYWxcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfQ1JFREVOVElBTCAqL106ICdUaGUgc3VwcGxpZWQgYXV0aCBjcmVkZW50aWFsIGlzIGluY29ycmVjdCwgbWFsZm9ybWVkIG9yIGhhcyBleHBpcmVkLicsXG4gICAgICAgIFtcImludmFsaWQtbWVzc2FnZS1wYXlsb2FkXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX01FU1NBR0VfUEFZTE9BRCAqL106ICdUaGUgZW1haWwgdGVtcGxhdGUgY29ycmVzcG9uZGluZyB0byB0aGlzIGFjdGlvbiBjb250YWlucyBpbnZhbGlkIGNoYXJhY3RlcnMgaW4gaXRzIG1lc3NhZ2UuICcgK1xuICAgICAgICAgICAgJ1BsZWFzZSBmaXggYnkgZ29pbmcgdG8gdGhlIEF1dGggZW1haWwgdGVtcGxhdGVzIHNlY3Rpb24gaW4gdGhlIEZpcmViYXNlIENvbnNvbGUuJyxcbiAgICAgICAgW1wiaW52YWxpZC1tdWx0aS1mYWN0b3Itc2Vzc2lvblwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9NRkFfU0VTU0lPTiAqL106ICdUaGUgcmVxdWVzdCBkb2VzIG5vdCBjb250YWluIGEgdmFsaWQgcHJvb2Ygb2YgZmlyc3QgZmFjdG9yIHN1Y2Nlc3NmdWwgc2lnbi1pbi4nLFxuICAgICAgICBbXCJpbnZhbGlkLW9hdXRoLXByb3ZpZGVyXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX09BVVRIX1BST1ZJREVSICovXTogJ0VtYWlsQXV0aFByb3ZpZGVyIGlzIG5vdCBzdXBwb3J0ZWQgZm9yIHRoaXMgb3BlcmF0aW9uLiBUaGlzIG9wZXJhdGlvbiAnICtcbiAgICAgICAgICAgICdvbmx5IHN1cHBvcnRzIE9BdXRoIHByb3ZpZGVycy4nLFxuICAgICAgICBbXCJpbnZhbGlkLW9hdXRoLWNsaWVudC1pZFwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9PQVVUSF9DTElFTlRfSUQgKi9dOiAnVGhlIE9BdXRoIGNsaWVudCBJRCBwcm92aWRlZCBpcyBlaXRoZXIgaW52YWxpZCBvciBkb2VzIG5vdCBtYXRjaCB0aGUgJyArXG4gICAgICAgICAgICAnc3BlY2lmaWVkIEFQSSBrZXkuJyxcbiAgICAgICAgW1widW5hdXRob3JpemVkLWRvbWFpblwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9PUklHSU4gKi9dOiAnVGhpcyBkb21haW4gaXMgbm90IGF1dGhvcml6ZWQgZm9yIE9BdXRoIG9wZXJhdGlvbnMgZm9yIHlvdXIgRmlyZWJhc2UgJyArXG4gICAgICAgICAgICAncHJvamVjdC4gRWRpdCB0aGUgbGlzdCBvZiBhdXRob3JpemVkIGRvbWFpbnMgZnJvbSB0aGUgRmlyZWJhc2UgY29uc29sZS4nLFxuICAgICAgICBbXCJpbnZhbGlkLWFjdGlvbi1jb2RlXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX09PQl9DT0RFICovXTogJ1RoZSBhY3Rpb24gY29kZSBpcyBpbnZhbGlkLiBUaGlzIGNhbiBoYXBwZW4gaWYgdGhlIGNvZGUgaXMgbWFsZm9ybWVkLCAnICtcbiAgICAgICAgICAgICdleHBpcmVkLCBvciBoYXMgYWxyZWFkeSBiZWVuIHVzZWQuJyxcbiAgICAgICAgW1wid3JvbmctcGFzc3dvcmRcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfUEFTU1dPUkQgKi9dOiAnVGhlIHBhc3N3b3JkIGlzIGludmFsaWQgb3IgdGhlIHVzZXIgZG9lcyBub3QgaGF2ZSBhIHBhc3N3b3JkLicsXG4gICAgICAgIFtcImludmFsaWQtcGVyc2lzdGVuY2UtdHlwZVwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9QRVJTSVNURU5DRSAqL106ICdUaGUgc3BlY2lmaWVkIHBlcnNpc3RlbmNlIHR5cGUgaXMgaW52YWxpZC4gSXQgY2FuIG9ubHkgYmUgbG9jYWwsIHNlc3Npb24gb3Igbm9uZS4nLFxuICAgICAgICBbXCJpbnZhbGlkLXBob25lLW51bWJlclwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9QSE9ORV9OVU1CRVIgKi9dOiAnVGhlIGZvcm1hdCBvZiB0aGUgcGhvbmUgbnVtYmVyIHByb3ZpZGVkIGlzIGluY29ycmVjdC4gUGxlYXNlIGVudGVyIHRoZSAnICtcbiAgICAgICAgICAgICdwaG9uZSBudW1iZXIgaW4gYSBmb3JtYXQgdGhhdCBjYW4gYmUgcGFyc2VkIGludG8gRS4xNjQgZm9ybWF0LiBFLjE2NCAnICtcbiAgICAgICAgICAgICdwaG9uZSBudW1iZXJzIGFyZSB3cml0dGVuIGluIHRoZSBmb3JtYXQgWytdW2NvdW50cnkgY29kZV1bc3Vic2NyaWJlciAnICtcbiAgICAgICAgICAgICdudW1iZXIgaW5jbHVkaW5nIGFyZWEgY29kZV0uJyxcbiAgICAgICAgW1wiaW52YWxpZC1wcm92aWRlci1pZFwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9QUk9WSURFUl9JRCAqL106ICdUaGUgc3BlY2lmaWVkIHByb3ZpZGVyIElEIGlzIGludmFsaWQuJyxcbiAgICAgICAgW1wiaW52YWxpZC1yZWNpcGllbnQtZW1haWxcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfUkVDSVBJRU5UX0VNQUlMICovXTogJ1RoZSBlbWFpbCBjb3JyZXNwb25kaW5nIHRvIHRoaXMgYWN0aW9uIGZhaWxlZCB0byBzZW5kIGFzIHRoZSBwcm92aWRlZCAnICtcbiAgICAgICAgICAgICdyZWNpcGllbnQgZW1haWwgYWRkcmVzcyBpcyBpbnZhbGlkLicsXG4gICAgICAgIFtcImludmFsaWQtc2VuZGVyXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX1NFTkRFUiAqL106ICdUaGUgZW1haWwgdGVtcGxhdGUgY29ycmVzcG9uZGluZyB0byB0aGlzIGFjdGlvbiBjb250YWlucyBhbiBpbnZhbGlkIHNlbmRlciBlbWFpbCBvciBuYW1lLiAnICtcbiAgICAgICAgICAgICdQbGVhc2UgZml4IGJ5IGdvaW5nIHRvIHRoZSBBdXRoIGVtYWlsIHRlbXBsYXRlcyBzZWN0aW9uIGluIHRoZSBGaXJlYmFzZSBDb25zb2xlLicsXG4gICAgICAgIFtcImludmFsaWQtdmVyaWZpY2F0aW9uLWlkXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX1NFU1NJT05fSU5GTyAqL106ICdUaGUgdmVyaWZpY2F0aW9uIElEIHVzZWQgdG8gY3JlYXRlIHRoZSBwaG9uZSBhdXRoIGNyZWRlbnRpYWwgaXMgaW52YWxpZC4nLFxuICAgICAgICBbXCJpbnZhbGlkLXRlbmFudC1pZFwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9URU5BTlRfSUQgKi9dOiBcIlRoZSBBdXRoIGluc3RhbmNlJ3MgdGVuYW50IElEIGlzIGludmFsaWQuXCIsXG4gICAgICAgIFtcImxvZ2luLWJsb2NrZWRcIiAvKiBBdXRoRXJyb3JDb2RlLkxPR0lOX0JMT0NLRUQgKi9dOiAnTG9naW4gYmxvY2tlZCBieSB1c2VyLXByb3ZpZGVkIG1ldGhvZDogeyRvcmlnaW5hbE1lc3NhZ2V9JyxcbiAgICAgICAgW1wibWlzc2luZy1hbmRyb2lkLXBrZy1uYW1lXCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX0FORFJPSURfUEFDS0FHRV9OQU1FICovXTogJ0FuIEFuZHJvaWQgUGFja2FnZSBOYW1lIG11c3QgYmUgcHJvdmlkZWQgaWYgdGhlIEFuZHJvaWQgQXBwIGlzIHJlcXVpcmVkIHRvIGJlIGluc3RhbGxlZC4nLFxuICAgICAgICBbXCJhdXRoLWRvbWFpbi1jb25maWctcmVxdWlyZWRcIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfQVVUSF9ET01BSU4gKi9dOiAnQmUgc3VyZSB0byBpbmNsdWRlIGF1dGhEb21haW4gd2hlbiBjYWxsaW5nIGZpcmViYXNlLmluaXRpYWxpemVBcHAoKSwgJyArXG4gICAgICAgICAgICAnYnkgZm9sbG93aW5nIHRoZSBpbnN0cnVjdGlvbnMgaW4gdGhlIEZpcmViYXNlIGNvbnNvbGUuJyxcbiAgICAgICAgW1wibWlzc2luZy1hcHAtY3JlZGVudGlhbFwiIC8qIEF1dGhFcnJvckNvZGUuTUlTU0lOR19BUFBfQ1JFREVOVElBTCAqL106ICdUaGUgcGhvbmUgdmVyaWZpY2F0aW9uIHJlcXVlc3QgaXMgbWlzc2luZyBhbiBhcHBsaWNhdGlvbiB2ZXJpZmllciAnICtcbiAgICAgICAgICAgICdhc3NlcnRpb24uIEEgcmVDQVBUQ0hBIHJlc3BvbnNlIHRva2VuIG5lZWRzIHRvIGJlIHByb3ZpZGVkLicsXG4gICAgICAgIFtcIm1pc3NpbmctdmVyaWZpY2F0aW9uLWNvZGVcIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfQ09ERSAqL106ICdUaGUgcGhvbmUgYXV0aCBjcmVkZW50aWFsIHdhcyBjcmVhdGVkIHdpdGggYW4gZW1wdHkgU01TIHZlcmlmaWNhdGlvbiBjb2RlLicsXG4gICAgICAgIFtcIm1pc3NpbmctY29udGludWUtdXJpXCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX0NPTlRJTlVFX1VSSSAqL106ICdBIGNvbnRpbnVlIFVSTCBtdXN0IGJlIHByb3ZpZGVkIGluIHRoZSByZXF1ZXN0LicsXG4gICAgICAgIFtcIm1pc3NpbmctaWZyYW1lLXN0YXJ0XCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX0lGUkFNRV9TVEFSVCAqL106ICdBbiBpbnRlcm5hbCBBdXRoRXJyb3IgaGFzIG9jY3VycmVkLicsXG4gICAgICAgIFtcIm1pc3NpbmctaW9zLWJ1bmRsZS1pZFwiIC8qIEF1dGhFcnJvckNvZGUuTUlTU0lOR19JT1NfQlVORExFX0lEICovXTogJ0FuIGlPUyBCdW5kbGUgSUQgbXVzdCBiZSBwcm92aWRlZCBpZiBhbiBBcHAgU3RvcmUgSUQgaXMgcHJvdmlkZWQuJyxcbiAgICAgICAgW1wibWlzc2luZy1vci1pbnZhbGlkLW5vbmNlXCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX09SX0lOVkFMSURfTk9OQ0UgKi9dOiAnVGhlIHJlcXVlc3QgZG9lcyBub3QgY29udGFpbiBhIHZhbGlkIG5vbmNlLiBUaGlzIGNhbiBvY2N1ciBpZiB0aGUgJyArXG4gICAgICAgICAgICAnU0hBLTI1NiBoYXNoIG9mIHRoZSBwcm92aWRlZCByYXcgbm9uY2UgZG9lcyBub3QgbWF0Y2ggdGhlIGhhc2hlZCBub25jZSAnICtcbiAgICAgICAgICAgICdpbiB0aGUgSUQgdG9rZW4gcGF5bG9hZC4nLFxuICAgICAgICBbXCJtaXNzaW5nLXBhc3N3b3JkXCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX1BBU1NXT1JEICovXTogJ0Egbm9uLWVtcHR5IHBhc3N3b3JkIG11c3QgYmUgcHJvdmlkZWQnLFxuICAgICAgICBbXCJtaXNzaW5nLW11bHRpLWZhY3Rvci1pbmZvXCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX01GQV9JTkZPICovXTogJ05vIHNlY29uZCBmYWN0b3IgaWRlbnRpZmllciBpcyBwcm92aWRlZC4nLFxuICAgICAgICBbXCJtaXNzaW5nLW11bHRpLWZhY3Rvci1zZXNzaW9uXCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX01GQV9TRVNTSU9OICovXTogJ1RoZSByZXF1ZXN0IGlzIG1pc3NpbmcgcHJvb2Ygb2YgZmlyc3QgZmFjdG9yIHN1Y2Nlc3NmdWwgc2lnbi1pbi4nLFxuICAgICAgICBbXCJtaXNzaW5nLXBob25lLW51bWJlclwiIC8qIEF1dGhFcnJvckNvZGUuTUlTU0lOR19QSE9ORV9OVU1CRVIgKi9dOiAnVG8gc2VuZCB2ZXJpZmljYXRpb24gY29kZXMsIHByb3ZpZGUgYSBwaG9uZSBudW1iZXIgZm9yIHRoZSByZWNpcGllbnQuJyxcbiAgICAgICAgW1wibWlzc2luZy12ZXJpZmljYXRpb24taWRcIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfU0VTU0lPTl9JTkZPICovXTogJ1RoZSBwaG9uZSBhdXRoIGNyZWRlbnRpYWwgd2FzIGNyZWF0ZWQgd2l0aCBhbiBlbXB0eSB2ZXJpZmljYXRpb24gSUQuJyxcbiAgICAgICAgW1wiYXBwLWRlbGV0ZWRcIiAvKiBBdXRoRXJyb3JDb2RlLk1PRFVMRV9ERVNUUk9ZRUQgKi9dOiAnVGhpcyBpbnN0YW5jZSBvZiBGaXJlYmFzZUFwcCBoYXMgYmVlbiBkZWxldGVkLicsXG4gICAgICAgIFtcIm11bHRpLWZhY3Rvci1pbmZvLW5vdC1mb3VuZFwiIC8qIEF1dGhFcnJvckNvZGUuTUZBX0lORk9fTk9UX0ZPVU5EICovXTogJ1RoZSB1c2VyIGRvZXMgbm90IGhhdmUgYSBzZWNvbmQgZmFjdG9yIG1hdGNoaW5nIHRoZSBpZGVudGlmaWVyIHByb3ZpZGVkLicsXG4gICAgICAgIFtcIm11bHRpLWZhY3Rvci1hdXRoLXJlcXVpcmVkXCIgLyogQXV0aEVycm9yQ29kZS5NRkFfUkVRVUlSRUQgKi9dOiAnUHJvb2Ygb2Ygb3duZXJzaGlwIG9mIGEgc2Vjb25kIGZhY3RvciBpcyByZXF1aXJlZCB0byBjb21wbGV0ZSBzaWduLWluLicsXG4gICAgICAgIFtcImFjY291bnQtZXhpc3RzLXdpdGgtZGlmZmVyZW50LWNyZWRlbnRpYWxcIiAvKiBBdXRoRXJyb3JDb2RlLk5FRURfQ09ORklSTUFUSU9OICovXTogJ0FuIGFjY291bnQgYWxyZWFkeSBleGlzdHMgd2l0aCB0aGUgc2FtZSBlbWFpbCBhZGRyZXNzIGJ1dCBkaWZmZXJlbnQgJyArXG4gICAgICAgICAgICAnc2lnbi1pbiBjcmVkZW50aWFscy4gU2lnbiBpbiB1c2luZyBhIHByb3ZpZGVyIGFzc29jaWF0ZWQgd2l0aCB0aGlzICcgK1xuICAgICAgICAgICAgJ2VtYWlsIGFkZHJlc3MuJyxcbiAgICAgICAgW1wibmV0d29yay1yZXF1ZXN0LWZhaWxlZFwiIC8qIEF1dGhFcnJvckNvZGUuTkVUV09SS19SRVFVRVNUX0ZBSUxFRCAqL106ICdBIG5ldHdvcmsgQXV0aEVycm9yIChzdWNoIGFzIHRpbWVvdXQsIGludGVycnVwdGVkIGNvbm5lY3Rpb24gb3IgdW5yZWFjaGFibGUgaG9zdCkgaGFzIG9jY3VycmVkLicsXG4gICAgICAgIFtcIm5vLWF1dGgtZXZlbnRcIiAvKiBBdXRoRXJyb3JDb2RlLk5PX0FVVEhfRVZFTlQgKi9dOiAnQW4gaW50ZXJuYWwgQXV0aEVycm9yIGhhcyBvY2N1cnJlZC4nLFxuICAgICAgICBbXCJuby1zdWNoLXByb3ZpZGVyXCIgLyogQXV0aEVycm9yQ29kZS5OT19TVUNIX1BST1ZJREVSICovXTogJ1VzZXIgd2FzIG5vdCBsaW5rZWQgdG8gYW4gYWNjb3VudCB3aXRoIHRoZSBnaXZlbiBwcm92aWRlci4nLFxuICAgICAgICBbXCJudWxsLXVzZXJcIiAvKiBBdXRoRXJyb3JDb2RlLk5VTExfVVNFUiAqL106ICdBIG51bGwgdXNlciBvYmplY3Qgd2FzIHByb3ZpZGVkIGFzIHRoZSBhcmd1bWVudCBmb3IgYW4gb3BlcmF0aW9uIHdoaWNoICcgK1xuICAgICAgICAgICAgJ3JlcXVpcmVzIGEgbm9uLW51bGwgdXNlciBvYmplY3QuJyxcbiAgICAgICAgW1wib3BlcmF0aW9uLW5vdC1hbGxvd2VkXCIgLyogQXV0aEVycm9yQ29kZS5PUEVSQVRJT05fTk9UX0FMTE9XRUQgKi9dOiAnVGhlIGdpdmVuIHNpZ24taW4gcHJvdmlkZXIgaXMgZGlzYWJsZWQgZm9yIHRoaXMgRmlyZWJhc2UgcHJvamVjdC4gJyArXG4gICAgICAgICAgICAnRW5hYmxlIGl0IGluIHRoZSBGaXJlYmFzZSBjb25zb2xlLCB1bmRlciB0aGUgc2lnbi1pbiBtZXRob2QgdGFiIG9mIHRoZSAnICtcbiAgICAgICAgICAgICdBdXRoIHNlY3Rpb24uJyxcbiAgICAgICAgW1wib3BlcmF0aW9uLW5vdC1zdXBwb3J0ZWQtaW4tdGhpcy1lbnZpcm9ubWVudFwiIC8qIEF1dGhFcnJvckNvZGUuT1BFUkFUSU9OX05PVF9TVVBQT1JURUQgKi9dOiAnVGhpcyBvcGVyYXRpb24gaXMgbm90IHN1cHBvcnRlZCBpbiB0aGUgZW52aXJvbm1lbnQgdGhpcyBhcHBsaWNhdGlvbiBpcyAnICtcbiAgICAgICAgICAgICdydW5uaW5nIG9uLiBcImxvY2F0aW9uLnByb3RvY29sXCIgbXVzdCBiZSBodHRwLCBodHRwcyBvciBjaHJvbWUtZXh0ZW5zaW9uJyArXG4gICAgICAgICAgICAnIGFuZCB3ZWIgc3RvcmFnZSBtdXN0IGJlIGVuYWJsZWQuJyxcbiAgICAgICAgW1wicG9wdXAtYmxvY2tlZFwiIC8qIEF1dGhFcnJvckNvZGUuUE9QVVBfQkxPQ0tFRCAqL106ICdVbmFibGUgdG8gZXN0YWJsaXNoIGEgY29ubmVjdGlvbiB3aXRoIHRoZSBwb3B1cC4gSXQgbWF5IGhhdmUgYmVlbiBibG9ja2VkIGJ5IHRoZSBicm93c2VyLicsXG4gICAgICAgIFtcInBvcHVwLWNsb3NlZC1ieS11c2VyXCIgLyogQXV0aEVycm9yQ29kZS5QT1BVUF9DTE9TRURfQllfVVNFUiAqL106ICdUaGUgcG9wdXAgaGFzIGJlZW4gY2xvc2VkIGJ5IHRoZSB1c2VyIGJlZm9yZSBmaW5hbGl6aW5nIHRoZSBvcGVyYXRpb24uJyxcbiAgICAgICAgW1wicHJvdmlkZXItYWxyZWFkeS1saW5rZWRcIiAvKiBBdXRoRXJyb3JDb2RlLlBST1ZJREVSX0FMUkVBRFlfTElOS0VEICovXTogJ1VzZXIgY2FuIG9ubHkgYmUgbGlua2VkIHRvIG9uZSBpZGVudGl0eSBmb3IgdGhlIGdpdmVuIHByb3ZpZGVyLicsXG4gICAgICAgIFtcInF1b3RhLWV4Y2VlZGVkXCIgLyogQXV0aEVycm9yQ29kZS5RVU9UQV9FWENFRURFRCAqL106IFwiVGhlIHByb2plY3QncyBxdW90YSBmb3IgdGhpcyBvcGVyYXRpb24gaGFzIGJlZW4gZXhjZWVkZWQuXCIsXG4gICAgICAgIFtcInJlZGlyZWN0LWNhbmNlbGxlZC1ieS11c2VyXCIgLyogQXV0aEVycm9yQ29kZS5SRURJUkVDVF9DQU5DRUxMRURfQllfVVNFUiAqL106ICdUaGUgcmVkaXJlY3Qgb3BlcmF0aW9uIGhhcyBiZWVuIGNhbmNlbGxlZCBieSB0aGUgdXNlciBiZWZvcmUgZmluYWxpemluZy4nLFxuICAgICAgICBbXCJyZWRpcmVjdC1vcGVyYXRpb24tcGVuZGluZ1wiIC8qIEF1dGhFcnJvckNvZGUuUkVESVJFQ1RfT1BFUkFUSU9OX1BFTkRJTkcgKi9dOiAnQSByZWRpcmVjdCBzaWduLWluIG9wZXJhdGlvbiBpcyBhbHJlYWR5IHBlbmRpbmcuJyxcbiAgICAgICAgW1wicmVqZWN0ZWQtY3JlZGVudGlhbFwiIC8qIEF1dGhFcnJvckNvZGUuUkVKRUNURURfQ1JFREVOVElBTCAqL106ICdUaGUgcmVxdWVzdCBjb250YWlucyBtYWxmb3JtZWQgb3IgbWlzbWF0Y2hpbmcgY3JlZGVudGlhbHMuJyxcbiAgICAgICAgW1wic2Vjb25kLWZhY3Rvci1hbHJlYWR5LWluLXVzZVwiIC8qIEF1dGhFcnJvckNvZGUuU0VDT05EX0ZBQ1RPUl9BTFJFQURZX0VOUk9MTEVEICovXTogJ1RoZSBzZWNvbmQgZmFjdG9yIGlzIGFscmVhZHkgZW5yb2xsZWQgb24gdGhpcyBhY2NvdW50LicsXG4gICAgICAgIFtcIm1heGltdW0tc2Vjb25kLWZhY3Rvci1jb3VudC1leGNlZWRlZFwiIC8qIEF1dGhFcnJvckNvZGUuU0VDT05EX0ZBQ1RPUl9MSU1JVF9FWENFRURFRCAqL106ICdUaGUgbWF4aW11bSBhbGxvd2VkIG51bWJlciBvZiBzZWNvbmQgZmFjdG9ycyBvbiBhIHVzZXIgaGFzIGJlZW4gZXhjZWVkZWQuJyxcbiAgICAgICAgW1widGVuYW50LWlkLW1pc21hdGNoXCIgLyogQXV0aEVycm9yQ29kZS5URU5BTlRfSURfTUlTTUFUQ0ggKi9dOiBcIlRoZSBwcm92aWRlZCB0ZW5hbnQgSUQgZG9lcyBub3QgbWF0Y2ggdGhlIEF1dGggaW5zdGFuY2UncyB0ZW5hbnQgSURcIixcbiAgICAgICAgW1widGltZW91dFwiIC8qIEF1dGhFcnJvckNvZGUuVElNRU9VVCAqL106ICdUaGUgb3BlcmF0aW9uIGhhcyB0aW1lZCBvdXQuJyxcbiAgICAgICAgW1widXNlci10b2tlbi1leHBpcmVkXCIgLyogQXV0aEVycm9yQ29kZS5UT0tFTl9FWFBJUkVEICovXTogXCJUaGUgdXNlcidzIGNyZWRlbnRpYWwgaXMgbm8gbG9uZ2VyIHZhbGlkLiBUaGUgdXNlciBtdXN0IHNpZ24gaW4gYWdhaW4uXCIsXG4gICAgICAgIFtcInRvby1tYW55LXJlcXVlc3RzXCIgLyogQXV0aEVycm9yQ29kZS5UT09fTUFOWV9BVFRFTVBUU19UUllfTEFURVIgKi9dOiAnV2UgaGF2ZSBibG9ja2VkIGFsbCByZXF1ZXN0cyBmcm9tIHRoaXMgZGV2aWNlIGR1ZSB0byB1bnVzdWFsIGFjdGl2aXR5LiAnICtcbiAgICAgICAgICAgICdUcnkgYWdhaW4gbGF0ZXIuJyxcbiAgICAgICAgW1widW5hdXRob3JpemVkLWNvbnRpbnVlLXVyaVwiIC8qIEF1dGhFcnJvckNvZGUuVU5BVVRIT1JJWkVEX0RPTUFJTiAqL106ICdUaGUgZG9tYWluIG9mIHRoZSBjb250aW51ZSBVUkwgaXMgbm90IHdoaXRlbGlzdGVkLiAgUGxlYXNlIHdoaXRlbGlzdCAnICtcbiAgICAgICAgICAgICd0aGUgZG9tYWluIGluIHRoZSBGaXJlYmFzZSBjb25zb2xlLicsXG4gICAgICAgIFtcInVuc3VwcG9ydGVkLWZpcnN0LWZhY3RvclwiIC8qIEF1dGhFcnJvckNvZGUuVU5TVVBQT1JURURfRklSU1RfRkFDVE9SICovXTogJ0Vucm9sbGluZyBhIHNlY29uZCBmYWN0b3Igb3Igc2lnbmluZyBpbiB3aXRoIGEgbXVsdGktZmFjdG9yIGFjY291bnQgcmVxdWlyZXMgc2lnbi1pbiB3aXRoIGEgc3VwcG9ydGVkIGZpcnN0IGZhY3Rvci4nLFxuICAgICAgICBbXCJ1bnN1cHBvcnRlZC1wZXJzaXN0ZW5jZS10eXBlXCIgLyogQXV0aEVycm9yQ29kZS5VTlNVUFBPUlRFRF9QRVJTSVNURU5DRSAqL106ICdUaGUgY3VycmVudCBlbnZpcm9ubWVudCBkb2VzIG5vdCBzdXBwb3J0IHRoZSBzcGVjaWZpZWQgcGVyc2lzdGVuY2UgdHlwZS4nLFxuICAgICAgICBbXCJ1bnN1cHBvcnRlZC10ZW5hbnQtb3BlcmF0aW9uXCIgLyogQXV0aEVycm9yQ29kZS5VTlNVUFBPUlRFRF9URU5BTlRfT1BFUkFUSU9OICovXTogJ1RoaXMgb3BlcmF0aW9uIGlzIG5vdCBzdXBwb3J0ZWQgaW4gYSBtdWx0aS10ZW5hbnQgY29udGV4dC4nLFxuICAgICAgICBbXCJ1bnZlcmlmaWVkLWVtYWlsXCIgLyogQXV0aEVycm9yQ29kZS5VTlZFUklGSUVEX0VNQUlMICovXTogJ1RoZSBvcGVyYXRpb24gcmVxdWlyZXMgYSB2ZXJpZmllZCBlbWFpbC4nLFxuICAgICAgICBbXCJ1c2VyLWNhbmNlbGxlZFwiIC8qIEF1dGhFcnJvckNvZGUuVVNFUl9DQU5DRUxMRUQgKi9dOiAnVGhlIHVzZXIgZGlkIG5vdCBncmFudCB5b3VyIGFwcGxpY2F0aW9uIHRoZSBwZXJtaXNzaW9ucyBpdCByZXF1ZXN0ZWQuJyxcbiAgICAgICAgW1widXNlci1ub3QtZm91bmRcIiAvKiBBdXRoRXJyb3JDb2RlLlVTRVJfREVMRVRFRCAqL106ICdUaGVyZSBpcyBubyB1c2VyIHJlY29yZCBjb3JyZXNwb25kaW5nIHRvIHRoaXMgaWRlbnRpZmllci4gVGhlIHVzZXIgbWF5ICcgK1xuICAgICAgICAgICAgJ2hhdmUgYmVlbiBkZWxldGVkLicsXG4gICAgICAgIFtcInVzZXItZGlzYWJsZWRcIiAvKiBBdXRoRXJyb3JDb2RlLlVTRVJfRElTQUJMRUQgKi9dOiAnVGhlIHVzZXIgYWNjb3VudCBoYXMgYmVlbiBkaXNhYmxlZCBieSBhbiBhZG1pbmlzdHJhdG9yLicsXG4gICAgICAgIFtcInVzZXItbWlzbWF0Y2hcIiAvKiBBdXRoRXJyb3JDb2RlLlVTRVJfTUlTTUFUQ0ggKi9dOiAnVGhlIHN1cHBsaWVkIGNyZWRlbnRpYWxzIGRvIG5vdCBjb3JyZXNwb25kIHRvIHRoZSBwcmV2aW91c2x5IHNpZ25lZCBpbiB1c2VyLicsXG4gICAgICAgIFtcInVzZXItc2lnbmVkLW91dFwiIC8qIEF1dGhFcnJvckNvZGUuVVNFUl9TSUdORURfT1VUICovXTogJycsXG4gICAgICAgIFtcIndlYWstcGFzc3dvcmRcIiAvKiBBdXRoRXJyb3JDb2RlLldFQUtfUEFTU1dPUkQgKi9dOiAnVGhlIHBhc3N3b3JkIG11c3QgYmUgNiBjaGFyYWN0ZXJzIGxvbmcgb3IgbW9yZS4nLFxuICAgICAgICBbXCJ3ZWItc3RvcmFnZS11bnN1cHBvcnRlZFwiIC8qIEF1dGhFcnJvckNvZGUuV0VCX1NUT1JBR0VfVU5TVVBQT1JURUQgKi9dOiAnVGhpcyBicm93c2VyIGlzIG5vdCBzdXBwb3J0ZWQgb3IgM3JkIHBhcnR5IGNvb2tpZXMgYW5kIGRhdGEgbWF5IGJlIGRpc2FibGVkLicsXG4gICAgICAgIFtcImFscmVhZHktaW5pdGlhbGl6ZWRcIiAvKiBBdXRoRXJyb3JDb2RlLkFMUkVBRFlfSU5JVElBTElaRUQgKi9dOiAnaW5pdGlhbGl6ZUF1dGgoKSBoYXMgYWxyZWFkeSBiZWVuIGNhbGxlZCB3aXRoICcgK1xuICAgICAgICAgICAgJ2RpZmZlcmVudCBvcHRpb25zLiBUbyBhdm9pZCB0aGlzIGVycm9yLCBjYWxsIGluaXRpYWxpemVBdXRoKCkgd2l0aCB0aGUgJyArXG4gICAgICAgICAgICAnc2FtZSBvcHRpb25zIGFzIHdoZW4gaXQgd2FzIG9yaWdpbmFsbHkgY2FsbGVkLCBvciBjYWxsIGdldEF1dGgoKSB0byByZXR1cm4gdGhlJyArXG4gICAgICAgICAgICAnIGFscmVhZHkgaW5pdGlhbGl6ZWQgaW5zdGFuY2UuJyxcbiAgICAgICAgW1wibWlzc2luZy1yZWNhcHRjaGEtdG9rZW5cIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfUkVDQVBUQ0hBX1RPS0VOICovXTogJ1RoZSByZUNBUFRDSEEgdG9rZW4gaXMgbWlzc2luZyB3aGVuIHNlbmRpbmcgcmVxdWVzdCB0byB0aGUgYmFja2VuZC4nLFxuICAgICAgICBbXCJpbnZhbGlkLXJlY2FwdGNoYS10b2tlblwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9SRUNBUFRDSEFfVE9LRU4gKi9dOiAnVGhlIHJlQ0FQVENIQSB0b2tlbiBpcyBpbnZhbGlkIHdoZW4gc2VuZGluZyByZXF1ZXN0IHRvIHRoZSBiYWNrZW5kLicsXG4gICAgICAgIFtcImludmFsaWQtcmVjYXB0Y2hhLWFjdGlvblwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9SRUNBUFRDSEFfQUNUSU9OICovXTogJ1RoZSByZUNBUFRDSEEgYWN0aW9uIGlzIGludmFsaWQgd2hlbiBzZW5kaW5nIHJlcXVlc3QgdG8gdGhlIGJhY2tlbmQuJyxcbiAgICAgICAgW1wicmVjYXB0Y2hhLW5vdC1lbmFibGVkXCIgLyogQXV0aEVycm9yQ29kZS5SRUNBUFRDSEFfTk9UX0VOQUJMRUQgKi9dOiAncmVDQVBUQ0hBIEVudGVycHJpc2UgaW50ZWdyYXRpb24gaXMgbm90IGVuYWJsZWQgZm9yIHRoaXMgcHJvamVjdC4nLFxuICAgICAgICBbXCJtaXNzaW5nLWNsaWVudC10eXBlXCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX0NMSUVOVF9UWVBFICovXTogJ1RoZSByZUNBUFRDSEEgY2xpZW50IHR5cGUgaXMgbWlzc2luZyB3aGVuIHNlbmRpbmcgcmVxdWVzdCB0byB0aGUgYmFja2VuZC4nLFxuICAgICAgICBbXCJtaXNzaW5nLXJlY2FwdGNoYS12ZXJzaW9uXCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX1JFQ0FQVENIQV9WRVJTSU9OICovXTogJ1RoZSByZUNBUFRDSEEgdmVyc2lvbiBpcyBtaXNzaW5nIHdoZW4gc2VuZGluZyByZXF1ZXN0IHRvIHRoZSBiYWNrZW5kLicsXG4gICAgICAgIFtcImludmFsaWQtcmVxLXR5cGVcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfUkVRX1RZUEUgKi9dOiAnSW52YWxpZCByZXF1ZXN0IHBhcmFtZXRlcnMuJyxcbiAgICAgICAgW1wiaW52YWxpZC1yZWNhcHRjaGEtdmVyc2lvblwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9SRUNBUFRDSEFfVkVSU0lPTiAqL106ICdUaGUgcmVDQVBUQ0hBIHZlcnNpb24gaXMgaW52YWxpZCB3aGVuIHNlbmRpbmcgcmVxdWVzdCB0byB0aGUgYmFja2VuZC4nLFxuICAgICAgICBbXCJ1bnN1cHBvcnRlZC1wYXNzd29yZC1wb2xpY3ktc2NoZW1hLXZlcnNpb25cIiAvKiBBdXRoRXJyb3JDb2RlLlVOU1VQUE9SVEVEX1BBU1NXT1JEX1BPTElDWV9TQ0hFTUFfVkVSU0lPTiAqL106ICdUaGUgcGFzc3dvcmQgcG9saWN5IHJlY2VpdmVkIGZyb20gdGhlIGJhY2tlbmQgdXNlcyBhIHNjaGVtYSB2ZXJzaW9uIHRoYXQgaXMgbm90IHN1cHBvcnRlZCBieSB0aGlzIHZlcnNpb24gb2YgdGhlIEZpcmViYXNlIFNESy4nLFxuICAgICAgICBbXCJwYXNzd29yZC1kb2VzLW5vdC1tZWV0LXJlcXVpcmVtZW50c1wiIC8qIEF1dGhFcnJvckNvZGUuUEFTU1dPUkRfRE9FU19OT1RfTUVFVF9SRVFVSVJFTUVOVFMgKi9dOiAnVGhlIHBhc3N3b3JkIGRvZXMgbm90IG1lZXQgdGhlIHJlcXVpcmVtZW50cy4nLFxuICAgICAgICBbXCJpbnZhbGlkLWhvc3RpbmctbGluay1kb21haW5cIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfSE9TVElOR19MSU5LX0RPTUFJTiAqL106ICdUaGUgcHJvdmlkZWQgSG9zdGluZyBsaW5rIGRvbWFpbiBpcyBub3QgY29uZmlndXJlZCBpbiBGaXJlYmFzZSBIb3N0aW5nIG9yIGlzIG5vdCBvd25lZCBieSAnICtcbiAgICAgICAgICAgICd0aGUgY3VycmVudCBwcm9qZWN0LiBUaGlzIGNhbm5vdCBiZSBhIGRlZmF1bHQgSG9zdGluZyBkb21haW4gKGB3ZWIuYXBwYCBvciBgZmlyZWJhc2VhcHAuY29tYCkuJ1xuICAgIH07XG59XG5mdW5jdGlvbiBfcHJvZEVycm9yTWFwKCkge1xuICAgIC8vIFdlIHdpbGwgaW5jbHVkZSB0aGlzIG9uZSBtZXNzYWdlIGluIHRoZSBwcm9kIGVycm9yIG1hcCBzaW5jZSBieSB0aGUgdmVyeVxuICAgIC8vIG5hdHVyZSBvZiB0aGlzIGVycm9yLCBkZXZlbG9wZXJzIHdpbGwgbmV2ZXIgYmUgYWJsZSB0byBzZWUgdGhlIG1lc3NhZ2VcbiAgICAvLyB1c2luZyB0aGUgZGVidWdFcnJvck1hcCAod2hpY2ggaXMgaW5zdGFsbGVkIGR1cmluZyBhdXRoIGluaXRpYWxpemF0aW9uKS5cbiAgICByZXR1cm4ge1xuICAgICAgICBbXCJkZXBlbmRlbnQtc2RrLWluaXRpYWxpemVkLWJlZm9yZS1hdXRoXCIgLyogQXV0aEVycm9yQ29kZS5ERVBFTkRFTlRfU0RLX0lOSVRfQkVGT1JFX0FVVEggKi9dOiAnQW5vdGhlciBGaXJlYmFzZSBTREsgd2FzIGluaXRpYWxpemVkIGFuZCBpcyB0cnlpbmcgdG8gdXNlIEF1dGggYmVmb3JlIEF1dGggaXMgJyArXG4gICAgICAgICAgICAnaW5pdGlhbGl6ZWQuIFBsZWFzZSBiZSBzdXJlIHRvIGNhbGwgYGluaXRpYWxpemVBdXRoYCBvciBgZ2V0QXV0aGAgYmVmb3JlICcgK1xuICAgICAgICAgICAgJ3N0YXJ0aW5nIGFueSBvdGhlciBGaXJlYmFzZSBTREsuJ1xuICAgIH07XG59XG4vKipcbiAqIEEgdmVyYm9zZSBlcnJvciBtYXAgd2l0aCBkZXRhaWxlZCBkZXNjcmlwdGlvbnMgZm9yIG1vc3QgZXJyb3IgY29kZXMuXG4gKlxuICogU2VlIGRpc2N1c3Npb24gYXQge0BsaW5rIEF1dGhFcnJvck1hcH1cbiAqXG4gKiBAcHVibGljXG4gKi9cbmNvbnN0IGRlYnVnRXJyb3JNYXAgPSBfZGVidWdFcnJvck1hcDtcbi8qKlxuICogQSBtaW5pbWFsIGVycm9yIG1hcCB3aXRoIGFsbCB2ZXJib3NlIGVycm9yIG1lc3NhZ2VzIHN0cmlwcGVkLlxuICpcbiAqIFNlZSBkaXNjdXNzaW9uIGF0IHtAbGluayBBdXRoRXJyb3JNYXB9XG4gKlxuICogQHB1YmxpY1xuICovXG5jb25zdCBwcm9kRXJyb3JNYXAgPSBfcHJvZEVycm9yTWFwO1xuY29uc3QgX0RFRkFVTFRfQVVUSF9FUlJPUl9GQUNUT1JZID0gbmV3IEVycm9yRmFjdG9yeSgnYXV0aCcsICdGaXJlYmFzZScsIF9wcm9kRXJyb3JNYXAoKSk7XG4vKipcbiAqIEEgbWFwIG9mIHBvdGVudGlhbCBgQXV0aGAgZXJyb3IgY29kZXMsIGZvciBlYXNpZXIgY29tcGFyaXNvbiB3aXRoIGVycm9yc1xuICogdGhyb3duIGJ5IHRoZSBTREsuXG4gKlxuICogQHJlbWFya3NcbiAqIE5vdGUgdGhhdCB5b3UgY2FuJ3QgdHJlZS1zaGFrZSBpbmRpdmlkdWFsIGtleXNcbiAqIGluIHRoZSBtYXAsIHNvIGJ5IHVzaW5nIHRoZSBtYXAgeW91IG1pZ2h0IHN1YnN0YW50aWFsbHkgaW5jcmVhc2UgeW91clxuICogYnVuZGxlIHNpemUuXG4gKlxuICogQHB1YmxpY1xuICovXG5jb25zdCBBVVRIX0VSUk9SX0NPREVTX01BUF9ET19OT1RfVVNFX0lOVEVSTkFMTFkgPSB7XG4gICAgQURNSU5fT05MWV9PUEVSQVRJT046ICdhdXRoL2FkbWluLXJlc3RyaWN0ZWQtb3BlcmF0aW9uJyxcbiAgICBBUkdVTUVOVF9FUlJPUjogJ2F1dGgvYXJndW1lbnQtZXJyb3InLFxuICAgIEFQUF9OT1RfQVVUSE9SSVpFRDogJ2F1dGgvYXBwLW5vdC1hdXRob3JpemVkJyxcbiAgICBBUFBfTk9UX0lOU1RBTExFRDogJ2F1dGgvYXBwLW5vdC1pbnN0YWxsZWQnLFxuICAgIENBUFRDSEFfQ0hFQ0tfRkFJTEVEOiAnYXV0aC9jYXB0Y2hhLWNoZWNrLWZhaWxlZCcsXG4gICAgQ09ERV9FWFBJUkVEOiAnYXV0aC9jb2RlLWV4cGlyZWQnLFxuICAgIENPUkRPVkFfTk9UX1JFQURZOiAnYXV0aC9jb3Jkb3ZhLW5vdC1yZWFkeScsXG4gICAgQ09SU19VTlNVUFBPUlRFRDogJ2F1dGgvY29ycy11bnN1cHBvcnRlZCcsXG4gICAgQ1JFREVOVElBTF9BTFJFQURZX0lOX1VTRTogJ2F1dGgvY3JlZGVudGlhbC1hbHJlYWR5LWluLXVzZScsXG4gICAgQ1JFREVOVElBTF9NSVNNQVRDSDogJ2F1dGgvY3VzdG9tLXRva2VuLW1pc21hdGNoJyxcbiAgICBDUkVERU5USUFMX1RPT19PTERfTE9HSU5fQUdBSU46ICdhdXRoL3JlcXVpcmVzLXJlY2VudC1sb2dpbicsXG4gICAgREVQRU5ERU5UX1NES19JTklUX0JFRk9SRV9BVVRIOiAnYXV0aC9kZXBlbmRlbnQtc2RrLWluaXRpYWxpemVkLWJlZm9yZS1hdXRoJyxcbiAgICBEWU5BTUlDX0xJTktfTk9UX0FDVElWQVRFRDogJ2F1dGgvZHluYW1pYy1saW5rLW5vdC1hY3RpdmF0ZWQnLFxuICAgIEVNQUlMX0NIQU5HRV9ORUVEU19WRVJJRklDQVRJT046ICdhdXRoL2VtYWlsLWNoYW5nZS1uZWVkcy12ZXJpZmljYXRpb24nLFxuICAgIEVNQUlMX0VYSVNUUzogJ2F1dGgvZW1haWwtYWxyZWFkeS1pbi11c2UnLFxuICAgIEVNVUxBVE9SX0NPTkZJR19GQUlMRUQ6ICdhdXRoL2VtdWxhdG9yLWNvbmZpZy1mYWlsZWQnLFxuICAgIEVYUElSRURfT09CX0NPREU6ICdhdXRoL2V4cGlyZWQtYWN0aW9uLWNvZGUnLFxuICAgIEVYUElSRURfUE9QVVBfUkVRVUVTVDogJ2F1dGgvY2FuY2VsbGVkLXBvcHVwLXJlcXVlc3QnLFxuICAgIElOVEVSTkFMX0VSUk9SOiAnYXV0aC9pbnRlcm5hbC1lcnJvcicsXG4gICAgSU5WQUxJRF9BUElfS0VZOiAnYXV0aC9pbnZhbGlkLWFwaS1rZXknLFxuICAgIElOVkFMSURfQVBQX0NSRURFTlRJQUw6ICdhdXRoL2ludmFsaWQtYXBwLWNyZWRlbnRpYWwnLFxuICAgIElOVkFMSURfQVBQX0lEOiAnYXV0aC9pbnZhbGlkLWFwcC1pZCcsXG4gICAgSU5WQUxJRF9BVVRIOiAnYXV0aC9pbnZhbGlkLXVzZXItdG9rZW4nLFxuICAgIElOVkFMSURfQVVUSF9FVkVOVDogJ2F1dGgvaW52YWxpZC1hdXRoLWV2ZW50JyxcbiAgICBJTlZBTElEX0NFUlRfSEFTSDogJ2F1dGgvaW52YWxpZC1jZXJ0LWhhc2gnLFxuICAgIElOVkFMSURfQ09ERTogJ2F1dGgvaW52YWxpZC12ZXJpZmljYXRpb24tY29kZScsXG4gICAgSU5WQUxJRF9DT05USU5VRV9VUkk6ICdhdXRoL2ludmFsaWQtY29udGludWUtdXJpJyxcbiAgICBJTlZBTElEX0NPUkRPVkFfQ09ORklHVVJBVElPTjogJ2F1dGgvaW52YWxpZC1jb3Jkb3ZhLWNvbmZpZ3VyYXRpb24nLFxuICAgIElOVkFMSURfQ1VTVE9NX1RPS0VOOiAnYXV0aC9pbnZhbGlkLWN1c3RvbS10b2tlbicsXG4gICAgSU5WQUxJRF9EWU5BTUlDX0xJTktfRE9NQUlOOiAnYXV0aC9pbnZhbGlkLWR5bmFtaWMtbGluay1kb21haW4nLFxuICAgIElOVkFMSURfRU1BSUw6ICdhdXRoL2ludmFsaWQtZW1haWwnLFxuICAgIElOVkFMSURfRU1VTEFUT1JfU0NIRU1FOiAnYXV0aC9pbnZhbGlkLWVtdWxhdG9yLXNjaGVtZScsXG4gICAgSU5WQUxJRF9JRFBfUkVTUE9OU0U6ICdhdXRoL2ludmFsaWQtY3JlZGVudGlhbCcsXG4gICAgSU5WQUxJRF9MT0dJTl9DUkVERU5USUFMUzogJ2F1dGgvaW52YWxpZC1jcmVkZW50aWFsJyxcbiAgICBJTlZBTElEX01FU1NBR0VfUEFZTE9BRDogJ2F1dGgvaW52YWxpZC1tZXNzYWdlLXBheWxvYWQnLFxuICAgIElOVkFMSURfTUZBX1NFU1NJT046ICdhdXRoL2ludmFsaWQtbXVsdGktZmFjdG9yLXNlc3Npb24nLFxuICAgIElOVkFMSURfT0FVVEhfQ0xJRU5UX0lEOiAnYXV0aC9pbnZhbGlkLW9hdXRoLWNsaWVudC1pZCcsXG4gICAgSU5WQUxJRF9PQVVUSF9QUk9WSURFUjogJ2F1dGgvaW52YWxpZC1vYXV0aC1wcm92aWRlcicsXG4gICAgSU5WQUxJRF9PT0JfQ09ERTogJ2F1dGgvaW52YWxpZC1hY3Rpb24tY29kZScsXG4gICAgSU5WQUxJRF9PUklHSU46ICdhdXRoL3VuYXV0aG9yaXplZC1kb21haW4nLFxuICAgIElOVkFMSURfUEFTU1dPUkQ6ICdhdXRoL3dyb25nLXBhc3N3b3JkJyxcbiAgICBJTlZBTElEX1BFUlNJU1RFTkNFOiAnYXV0aC9pbnZhbGlkLXBlcnNpc3RlbmNlLXR5cGUnLFxuICAgIElOVkFMSURfUEhPTkVfTlVNQkVSOiAnYXV0aC9pbnZhbGlkLXBob25lLW51bWJlcicsXG4gICAgSU5WQUxJRF9QUk9WSURFUl9JRDogJ2F1dGgvaW52YWxpZC1wcm92aWRlci1pZCcsXG4gICAgSU5WQUxJRF9SRUNJUElFTlRfRU1BSUw6ICdhdXRoL2ludmFsaWQtcmVjaXBpZW50LWVtYWlsJyxcbiAgICBJTlZBTElEX1NFTkRFUjogJ2F1dGgvaW52YWxpZC1zZW5kZXInLFxuICAgIElOVkFMSURfU0VTU0lPTl9JTkZPOiAnYXV0aC9pbnZhbGlkLXZlcmlmaWNhdGlvbi1pZCcsXG4gICAgSU5WQUxJRF9URU5BTlRfSUQ6ICdhdXRoL2ludmFsaWQtdGVuYW50LWlkJyxcbiAgICBNRkFfSU5GT19OT1RfRk9VTkQ6ICdhdXRoL211bHRpLWZhY3Rvci1pbmZvLW5vdC1mb3VuZCcsXG4gICAgTUZBX1JFUVVJUkVEOiAnYXV0aC9tdWx0aS1mYWN0b3ItYXV0aC1yZXF1aXJlZCcsXG4gICAgTUlTU0lOR19BTkRST0lEX1BBQ0tBR0VfTkFNRTogJ2F1dGgvbWlzc2luZy1hbmRyb2lkLXBrZy1uYW1lJyxcbiAgICBNSVNTSU5HX0FQUF9DUkVERU5USUFMOiAnYXV0aC9taXNzaW5nLWFwcC1jcmVkZW50aWFsJyxcbiAgICBNSVNTSU5HX0FVVEhfRE9NQUlOOiAnYXV0aC9hdXRoLWRvbWFpbi1jb25maWctcmVxdWlyZWQnLFxuICAgIE1JU1NJTkdfQ09ERTogJ2F1dGgvbWlzc2luZy12ZXJpZmljYXRpb24tY29kZScsXG4gICAgTUlTU0lOR19DT05USU5VRV9VUkk6ICdhdXRoL21pc3NpbmctY29udGludWUtdXJpJyxcbiAgICBNSVNTSU5HX0lGUkFNRV9TVEFSVDogJ2F1dGgvbWlzc2luZy1pZnJhbWUtc3RhcnQnLFxuICAgIE1JU1NJTkdfSU9TX0JVTkRMRV9JRDogJ2F1dGgvbWlzc2luZy1pb3MtYnVuZGxlLWlkJyxcbiAgICBNSVNTSU5HX09SX0lOVkFMSURfTk9OQ0U6ICdhdXRoL21pc3Npbmctb3ItaW52YWxpZC1ub25jZScsXG4gICAgTUlTU0lOR19NRkFfSU5GTzogJ2F1dGgvbWlzc2luZy1tdWx0aS1mYWN0b3ItaW5mbycsXG4gICAgTUlTU0lOR19NRkFfU0VTU0lPTjogJ2F1dGgvbWlzc2luZy1tdWx0aS1mYWN0b3Itc2Vzc2lvbicsXG4gICAgTUlTU0lOR19QSE9ORV9OVU1CRVI6ICdhdXRoL21pc3NpbmctcGhvbmUtbnVtYmVyJyxcbiAgICBNSVNTSU5HX1BBU1NXT1JEOiAnYXV0aC9taXNzaW5nLXBhc3N3b3JkJyxcbiAgICBNSVNTSU5HX1NFU1NJT05fSU5GTzogJ2F1dGgvbWlzc2luZy12ZXJpZmljYXRpb24taWQnLFxuICAgIE1PRFVMRV9ERVNUUk9ZRUQ6ICdhdXRoL2FwcC1kZWxldGVkJyxcbiAgICBORUVEX0NPTkZJUk1BVElPTjogJ2F1dGgvYWNjb3VudC1leGlzdHMtd2l0aC1kaWZmZXJlbnQtY3JlZGVudGlhbCcsXG4gICAgTkVUV09SS19SRVFVRVNUX0ZBSUxFRDogJ2F1dGgvbmV0d29yay1yZXF1ZXN0LWZhaWxlZCcsXG4gICAgTlVMTF9VU0VSOiAnYXV0aC9udWxsLXVzZXInLFxuICAgIE5PX0FVVEhfRVZFTlQ6ICdhdXRoL25vLWF1dGgtZXZlbnQnLFxuICAgIE5PX1NVQ0hfUFJPVklERVI6ICdhdXRoL25vLXN1Y2gtcHJvdmlkZXInLFxuICAgIE9QRVJBVElPTl9OT1RfQUxMT1dFRDogJ2F1dGgvb3BlcmF0aW9uLW5vdC1hbGxvd2VkJyxcbiAgICBPUEVSQVRJT05fTk9UX1NVUFBPUlRFRDogJ2F1dGgvb3BlcmF0aW9uLW5vdC1zdXBwb3J0ZWQtaW4tdGhpcy1lbnZpcm9ubWVudCcsXG4gICAgUE9QVVBfQkxPQ0tFRDogJ2F1dGgvcG9wdXAtYmxvY2tlZCcsXG4gICAgUE9QVVBfQ0xPU0VEX0JZX1VTRVI6ICdhdXRoL3BvcHVwLWNsb3NlZC1ieS11c2VyJyxcbiAgICBQUk9WSURFUl9BTFJFQURZX0xJTktFRDogJ2F1dGgvcHJvdmlkZXItYWxyZWFkeS1saW5rZWQnLFxuICAgIFFVT1RBX0VYQ0VFREVEOiAnYXV0aC9xdW90YS1leGNlZWRlZCcsXG4gICAgUkVESVJFQ1RfQ0FOQ0VMTEVEX0JZX1VTRVI6ICdhdXRoL3JlZGlyZWN0LWNhbmNlbGxlZC1ieS11c2VyJyxcbiAgICBSRURJUkVDVF9PUEVSQVRJT05fUEVORElORzogJ2F1dGgvcmVkaXJlY3Qtb3BlcmF0aW9uLXBlbmRpbmcnLFxuICAgIFJFSkVDVEVEX0NSRURFTlRJQUw6ICdhdXRoL3JlamVjdGVkLWNyZWRlbnRpYWwnLFxuICAgIFNFQ09ORF9GQUNUT1JfQUxSRUFEWV9FTlJPTExFRDogJ2F1dGgvc2Vjb25kLWZhY3Rvci1hbHJlYWR5LWluLXVzZScsXG4gICAgU0VDT05EX0ZBQ1RPUl9MSU1JVF9FWENFRURFRDogJ2F1dGgvbWF4aW11bS1zZWNvbmQtZmFjdG9yLWNvdW50LWV4Y2VlZGVkJyxcbiAgICBURU5BTlRfSURfTUlTTUFUQ0g6ICdhdXRoL3RlbmFudC1pZC1taXNtYXRjaCcsXG4gICAgVElNRU9VVDogJ2F1dGgvdGltZW91dCcsXG4gICAgVE9LRU5fRVhQSVJFRDogJ2F1dGgvdXNlci10b2tlbi1leHBpcmVkJyxcbiAgICBUT09fTUFOWV9BVFRFTVBUU19UUllfTEFURVI6ICdhdXRoL3Rvby1tYW55LXJlcXVlc3RzJyxcbiAgICBVTkFVVEhPUklaRURfRE9NQUlOOiAnYXV0aC91bmF1dGhvcml6ZWQtY29udGludWUtdXJpJyxcbiAgICBVTlNVUFBPUlRFRF9GSVJTVF9GQUNUT1I6ICdhdXRoL3Vuc3VwcG9ydGVkLWZpcnN0LWZhY3RvcicsXG4gICAgVU5TVVBQT1JURURfUEVSU0lTVEVOQ0U6ICdhdXRoL3Vuc3VwcG9ydGVkLXBlcnNpc3RlbmNlLXR5cGUnLFxuICAgIFVOU1VQUE9SVEVEX1RFTkFOVF9PUEVSQVRJT046ICdhdXRoL3Vuc3VwcG9ydGVkLXRlbmFudC1vcGVyYXRpb24nLFxuICAgIFVOVkVSSUZJRURfRU1BSUw6ICdhdXRoL3VudmVyaWZpZWQtZW1haWwnLFxuICAgIFVTRVJfQ0FOQ0VMTEVEOiAnYXV0aC91c2VyLWNhbmNlbGxlZCcsXG4gICAgVVNFUl9ERUxFVEVEOiAnYXV0aC91c2VyLW5vdC1mb3VuZCcsXG4gICAgVVNFUl9ESVNBQkxFRDogJ2F1dGgvdXNlci1kaXNhYmxlZCcsXG4gICAgVVNFUl9NSVNNQVRDSDogJ2F1dGgvdXNlci1taXNtYXRjaCcsXG4gICAgVVNFUl9TSUdORURfT1VUOiAnYXV0aC91c2VyLXNpZ25lZC1vdXQnLFxuICAgIFdFQUtfUEFTU1dPUkQ6ICdhdXRoL3dlYWstcGFzc3dvcmQnLFxuICAgIFdFQl9TVE9SQUdFX1VOU1VQUE9SVEVEOiAnYXV0aC93ZWItc3RvcmFnZS11bnN1cHBvcnRlZCcsXG4gICAgQUxSRUFEWV9JTklUSUFMSVpFRDogJ2F1dGgvYWxyZWFkeS1pbml0aWFsaXplZCcsXG4gICAgUkVDQVBUQ0hBX05PVF9FTkFCTEVEOiAnYXV0aC9yZWNhcHRjaGEtbm90LWVuYWJsZWQnLFxuICAgIE1JU1NJTkdfUkVDQVBUQ0hBX1RPS0VOOiAnYXV0aC9taXNzaW5nLXJlY2FwdGNoYS10b2tlbicsXG4gICAgSU5WQUxJRF9SRUNBUFRDSEFfVE9LRU46ICdhdXRoL2ludmFsaWQtcmVjYXB0Y2hhLXRva2VuJyxcbiAgICBJTlZBTElEX1JFQ0FQVENIQV9BQ1RJT046ICdhdXRoL2ludmFsaWQtcmVjYXB0Y2hhLWFjdGlvbicsXG4gICAgTUlTU0lOR19DTElFTlRfVFlQRTogJ2F1dGgvbWlzc2luZy1jbGllbnQtdHlwZScsXG4gICAgTUlTU0lOR19SRUNBUFRDSEFfVkVSU0lPTjogJ2F1dGgvbWlzc2luZy1yZWNhcHRjaGEtdmVyc2lvbicsXG4gICAgSU5WQUxJRF9SRUNBUFRDSEFfVkVSU0lPTjogJ2F1dGgvaW52YWxpZC1yZWNhcHRjaGEtdmVyc2lvbicsXG4gICAgSU5WQUxJRF9SRVFfVFlQRTogJ2F1dGgvaW52YWxpZC1yZXEtdHlwZScsXG4gICAgSU5WQUxJRF9IT1NUSU5HX0xJTktfRE9NQUlOOiAnYXV0aC9pbnZhbGlkLWhvc3RpbmctbGluay1kb21haW4nXG59O1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY29uc3QgbG9nQ2xpZW50ID0gbmV3IExvZ2dlcignQGZpcmViYXNlL2F1dGgnKTtcbmZ1bmN0aW9uIF9sb2dXYXJuKG1zZywgLi4uYXJncykge1xuICAgIGlmIChsb2dDbGllbnQubG9nTGV2ZWwgPD0gTG9nTGV2ZWwuV0FSTikge1xuICAgICAgICBsb2dDbGllbnQud2FybihgQXV0aCAoJHtTREtfVkVSU0lPTn0pOiAke21zZ31gLCAuLi5hcmdzKTtcbiAgICB9XG59XG5mdW5jdGlvbiBfbG9nRXJyb3IobXNnLCAuLi5hcmdzKSB7XG4gICAgaWYgKGxvZ0NsaWVudC5sb2dMZXZlbCA8PSBMb2dMZXZlbC5FUlJPUikge1xuICAgICAgICBsb2dDbGllbnQuZXJyb3IoYEF1dGggKCR7U0RLX1ZFUlNJT059KTogJHttc2d9YCwgLi4uYXJncyk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuZnVuY3Rpb24gX2ZhaWwoYXV0aE9yQ29kZSwgLi4ucmVzdCkge1xuICAgIHRocm93IGNyZWF0ZUVycm9ySW50ZXJuYWwoYXV0aE9yQ29kZSwgLi4ucmVzdCk7XG59XG5mdW5jdGlvbiBfY3JlYXRlRXJyb3IoYXV0aE9yQ29kZSwgLi4ucmVzdCkge1xuICAgIHJldHVybiBjcmVhdGVFcnJvckludGVybmFsKGF1dGhPckNvZGUsIC4uLnJlc3QpO1xufVxuZnVuY3Rpb24gX2Vycm9yV2l0aEN1c3RvbU1lc3NhZ2UoYXV0aCwgY29kZSwgbWVzc2FnZSkge1xuICAgIGNvbnN0IGVycm9yTWFwID0ge1xuICAgICAgICAuLi5wcm9kRXJyb3JNYXAoKSxcbiAgICAgICAgW2NvZGVdOiBtZXNzYWdlXG4gICAgfTtcbiAgICBjb25zdCBmYWN0b3J5ID0gbmV3IEVycm9yRmFjdG9yeSgnYXV0aCcsICdGaXJlYmFzZScsIGVycm9yTWFwKTtcbiAgICByZXR1cm4gZmFjdG9yeS5jcmVhdGUoY29kZSwge1xuICAgICAgICBhcHBOYW1lOiBhdXRoLm5hbWVcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIF9zZXJ2ZXJBcHBDdXJyZW50VXNlck9wZXJhdGlvbk5vdFN1cHBvcnRlZEVycm9yKGF1dGgpIHtcbiAgICByZXR1cm4gX2Vycm9yV2l0aEN1c3RvbU1lc3NhZ2UoYXV0aCwgXCJvcGVyYXRpb24tbm90LXN1cHBvcnRlZC1pbi10aGlzLWVudmlyb25tZW50XCIgLyogQXV0aEVycm9yQ29kZS5PUEVSQVRJT05fTk9UX1NVUFBPUlRFRCAqLywgJ09wZXJhdGlvbnMgdGhhdCBhbHRlciB0aGUgY3VycmVudCB1c2VyIGFyZSBub3Qgc3VwcG9ydGVkIGluIGNvbmp1bmN0aW9uIHdpdGggRmlyZWJhc2VTZXJ2ZXJBcHAnKTtcbn1cbmZ1bmN0aW9uIF9hc3NlcnRJbnN0YW5jZU9mKGF1dGgsIG9iamVjdCwgaW5zdGFuY2UpIHtcbiAgICBjb25zdCBjb25zdHJ1Y3Rvckluc3RhbmNlID0gaW5zdGFuY2U7XG4gICAgaWYgKCEob2JqZWN0IGluc3RhbmNlb2YgY29uc3RydWN0b3JJbnN0YW5jZSkpIHtcbiAgICAgICAgaWYgKGNvbnN0cnVjdG9ySW5zdGFuY2UubmFtZSAhPT0gb2JqZWN0LmNvbnN0cnVjdG9yLm5hbWUpIHtcbiAgICAgICAgICAgIF9mYWlsKGF1dGgsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SICovKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBfZXJyb3JXaXRoQ3VzdG9tTWVzc2FnZShhdXRoLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUiAqLywgYFR5cGUgb2YgJHtvYmplY3QuY29uc3RydWN0b3IubmFtZX0gZG9lcyBub3QgbWF0Y2ggZXhwZWN0ZWQgaW5zdGFuY2UuYCArXG4gICAgICAgICAgICBgRGlkIHlvdSBwYXNzIGEgcmVmZXJlbmNlIGZyb20gYSBkaWZmZXJlbnQgQXV0aCBTREs/YCk7XG4gICAgfVxufVxuZnVuY3Rpb24gY3JlYXRlRXJyb3JJbnRlcm5hbChhdXRoT3JDb2RlLCAuLi5yZXN0KSB7XG4gICAgaWYgKHR5cGVvZiBhdXRoT3JDb2RlICE9PSAnc3RyaW5nJykge1xuICAgICAgICBjb25zdCBjb2RlID0gcmVzdFswXTtcbiAgICAgICAgY29uc3QgZnVsbFBhcmFtcyA9IFsuLi5yZXN0LnNsaWNlKDEpXTtcbiAgICAgICAgaWYgKGZ1bGxQYXJhbXNbMF0pIHtcbiAgICAgICAgICAgIGZ1bGxQYXJhbXNbMF0uYXBwTmFtZSA9IGF1dGhPckNvZGUubmFtZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXV0aE9yQ29kZS5fZXJyb3JGYWN0b3J5LmNyZWF0ZShjb2RlLCAuLi5mdWxsUGFyYW1zKTtcbiAgICB9XG4gICAgcmV0dXJuIF9ERUZBVUxUX0FVVEhfRVJST1JfRkFDVE9SWS5jcmVhdGUoYXV0aE9yQ29kZSwgLi4ucmVzdCk7XG59XG5mdW5jdGlvbiBfYXNzZXJ0KGFzc2VydGlvbiwgYXV0aE9yQ29kZSwgLi4ucmVzdCkge1xuICAgIGlmICghYXNzZXJ0aW9uKSB7XG4gICAgICAgIHRocm93IGNyZWF0ZUVycm9ySW50ZXJuYWwoYXV0aE9yQ29kZSwgLi4ucmVzdCk7XG4gICAgfVxufVxuLyoqXG4gKiBVbmNvbmRpdGlvbmFsbHkgZmFpbHMsIHRocm93aW5nIGFuIGludGVybmFsIGVycm9yIHdpdGggdGhlIGdpdmVuIG1lc3NhZ2UuXG4gKlxuICogQHBhcmFtIGZhaWx1cmUgdHlwZSBvZiBmYWlsdXJlIGVuY291bnRlcmVkXG4gKiBAdGhyb3dzIEVycm9yXG4gKi9cbmZ1bmN0aW9uIGRlYnVnRmFpbChmYWlsdXJlKSB7XG4gICAgLy8gTG9nIHRoZSBmYWlsdXJlIGluIGFkZGl0aW9uIHRvIHRocm93IGFuIGV4Y2VwdGlvbiwganVzdCBpbiBjYXNlIHRoZVxuICAgIC8vIGV4Y2VwdGlvbiBpcyBzd2FsbG93ZWQuXG4gICAgY29uc3QgbWVzc2FnZSA9IGBJTlRFUk5BTCBBU1NFUlRJT04gRkFJTEVEOiBgICsgZmFpbHVyZTtcbiAgICBfbG9nRXJyb3IobWVzc2FnZSk7XG4gICAgLy8gTk9URTogV2UgZG9uJ3QgdXNlIEZpcmViYXNlRXJyb3IgaGVyZSBiZWNhdXNlIHRoZXNlIGFyZSBpbnRlcm5hbCBmYWlsdXJlc1xuICAgIC8vIHRoYXQgY2Fubm90IGJlIGhhbmRsZWQgYnkgdGhlIHVzZXIuIChBbHNvIGl0IHdvdWxkIGNyZWF0ZSBhIGNpcmN1bGFyXG4gICAgLy8gZGVwZW5kZW5jeSBiZXR3ZWVuIHRoZSBlcnJvciBhbmQgYXNzZXJ0IG1vZHVsZXMgd2hpY2ggZG9lc24ndCB3b3JrLilcbiAgICB0aHJvdyBuZXcgRXJyb3IobWVzc2FnZSk7XG59XG4vKipcbiAqIEZhaWxzIGlmIHRoZSBnaXZlbiBhc3NlcnRpb24gY29uZGl0aW9uIGlzIGZhbHNlLCB0aHJvd2luZyBhbiBFcnJvciB3aXRoIHRoZVxuICogZ2l2ZW4gbWVzc2FnZSBpZiBpdCBkaWQuXG4gKlxuICogQHBhcmFtIGFzc2VydGlvblxuICogQHBhcmFtIG1lc3NhZ2VcbiAqL1xuZnVuY3Rpb24gZGVidWdBc3NlcnQoYXNzZXJ0aW9uLCBtZXNzYWdlKSB7XG4gICAgaWYgKCFhc3NlcnRpb24pIHtcbiAgICAgICAgZGVidWdGYWlsKG1lc3NhZ2UpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmZ1bmN0aW9uIF9nZXRDdXJyZW50VXJsKCkge1xuICAgIHJldHVybiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnICYmIHNlbGYubG9jYXRpb24/LmhyZWYpIHx8ICcnO1xufVxuZnVuY3Rpb24gX2lzSHR0cE9ySHR0cHMoKSB7XG4gICAgcmV0dXJuIF9nZXRDdXJyZW50U2NoZW1lKCkgPT09ICdodHRwOicgfHwgX2dldEN1cnJlbnRTY2hlbWUoKSA9PT0gJ2h0dHBzOic7XG59XG5mdW5jdGlvbiBfZ2V0Q3VycmVudFNjaGVtZSgpIHtcbiAgICByZXR1cm4gKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyAmJiBzZWxmLmxvY2F0aW9uPy5wcm90b2NvbCkgfHwgbnVsbDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogRGV0ZXJtaW5lIHdoZXRoZXIgdGhlIGJyb3dzZXIgaXMgd29ya2luZyBvbmxpbmVcbiAqL1xuZnVuY3Rpb24gX2lzT25saW5lKCkge1xuICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICBuYXZpZ2F0b3IgJiZcbiAgICAgICAgJ29uTGluZScgaW4gbmF2aWdhdG9yICYmXG4gICAgICAgIHR5cGVvZiBuYXZpZ2F0b3Iub25MaW5lID09PSAnYm9vbGVhbicgJiZcbiAgICAgICAgLy8gQXBwbHkgb25seSBmb3IgdHJhZGl0aW9uYWwgd2ViIGFwcHMgYW5kIENocm9tZSBleHRlbnNpb25zLlxuICAgICAgICAvLyBUaGlzIGlzIGVzcGVjaWFsbHkgdHJ1ZSBmb3IgQ29yZG92YSBhcHBzIHdoaWNoIGhhdmUgdW5yZWxpYWJsZVxuICAgICAgICAvLyBuYXZpZ2F0b3Iub25MaW5lIGJlaGF2aW9yIHVubGVzcyBjb3Jkb3ZhLXBsdWdpbi1uZXR3b3JrLWluZm9ybWF0aW9uIGlzXG4gICAgICAgIC8vIGluc3RhbGxlZCB3aGljaCBvdmVyd3JpdGVzIHRoZSBuYXRpdmUgbmF2aWdhdG9yLm9uTGluZSB2YWx1ZSBhbmRcbiAgICAgICAgLy8gZGVmaW5lcyBuYXZpZ2F0b3IuY29ubmVjdGlvbi5cbiAgICAgICAgKF9pc0h0dHBPckh0dHBzKCkgfHwgaXNCcm93c2VyRXh0ZW5zaW9uKCkgfHwgJ2Nvbm5lY3Rpb24nIGluIG5hdmlnYXRvcikpIHtcbiAgICAgICAgcmV0dXJuIG5hdmlnYXRvci5vbkxpbmU7XG4gICAgfVxuICAgIC8vIElmIHdlIGNhbid0IGRldGVybWluZSB0aGUgc3RhdGUsIGFzc3VtZSBpdCBpcyBvbmxpbmUuXG4gICAgcmV0dXJuIHRydWU7XG59XG5mdW5jdGlvbiBfZ2V0VXNlckxhbmd1YWdlKCkge1xuICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgbmF2aWdhdG9yTGFuZ3VhZ2UgPSBuYXZpZ2F0b3I7XG4gICAgcmV0dXJuIChcbiAgICAvLyBNb3N0IHJlbGlhYmxlLCBidXQgb25seSBzdXBwb3J0ZWQgaW4gQ2hyb21lL0ZpcmVmb3guXG4gICAgKG5hdmlnYXRvckxhbmd1YWdlLmxhbmd1YWdlcyAmJiBuYXZpZ2F0b3JMYW5ndWFnZS5sYW5ndWFnZXNbMF0pIHx8XG4gICAgICAgIC8vIFN1cHBvcnRlZCBpbiBtb3N0IGJyb3dzZXJzLCBidXQgcmV0dXJucyB0aGUgbGFuZ3VhZ2Ugb2YgdGhlIGJyb3dzZXJcbiAgICAgICAgLy8gVUksIG5vdCB0aGUgbGFuZ3VhZ2Ugc2V0IGluIGJyb3dzZXIgc2V0dGluZ3MuXG4gICAgICAgIG5hdmlnYXRvckxhbmd1YWdlLmxhbmd1YWdlIHx8XG4gICAgICAgIC8vIENvdWxkbid0IGRldGVybWluZSBsYW5ndWFnZS5cbiAgICAgICAgbnVsbCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgc3RydWN0dXJlIHRvIGhlbHAgcGljayBiZXR3ZWVuIGEgcmFuZ2Ugb2YgbG9uZyBhbmQgc2hvcnQgZGVsYXkgZHVyYXRpb25zXG4gKiBkZXBlbmRpbmcgb24gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuIEluIGdlbmVyYWwsIHRoZSBsb25nIGRlbGF5IGlzIHVzZWQgZm9yXG4gKiBtb2JpbGUgZW52aXJvbm1lbnRzIHdoZXJlYXMgc2hvcnQgZGVsYXlzIGFyZSB1c2VkIGZvciBkZXNrdG9wIGVudmlyb25tZW50cy5cbiAqL1xuY2xhc3MgRGVsYXkge1xuICAgIGNvbnN0cnVjdG9yKHNob3J0RGVsYXksIGxvbmdEZWxheSkge1xuICAgICAgICB0aGlzLnNob3J0RGVsYXkgPSBzaG9ydERlbGF5O1xuICAgICAgICB0aGlzLmxvbmdEZWxheSA9IGxvbmdEZWxheTtcbiAgICAgICAgLy8gSW50ZXJuYWwgZXJyb3Igd2hlbiBpbXByb3Blcmx5IGluaXRpYWxpemVkLlxuICAgICAgICBkZWJ1Z0Fzc2VydChsb25nRGVsYXkgPiBzaG9ydERlbGF5LCAnU2hvcnQgZGVsYXkgc2hvdWxkIGJlIGxlc3MgdGhhbiBsb25nIGRlbGF5IScpO1xuICAgICAgICB0aGlzLmlzTW9iaWxlID0gaXNNb2JpbGVDb3Jkb3ZhKCkgfHwgaXNSZWFjdE5hdGl2ZSgpO1xuICAgIH1cbiAgICBnZXQoKSB7XG4gICAgICAgIGlmICghX2lzT25saW5lKCkpIHtcbiAgICAgICAgICAgIC8vIFBpY2sgdGhlIHNob3J0ZXIgdGltZW91dC5cbiAgICAgICAgICAgIHJldHVybiBNYXRoLm1pbig1MDAwIC8qIERlbGF5TWluLk9GRkxJTkUgKi8sIHRoaXMuc2hvcnREZWxheSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgcnVubmluZyBpbiBhIG1vYmlsZSBlbnZpcm9ubWVudCwgcmV0dXJuIHRoZSBsb25nIGRlbGF5LCBvdGhlcndpc2VcbiAgICAgICAgLy8gcmV0dXJuIHRoZSBzaG9ydCBkZWxheS5cbiAgICAgICAgLy8gVGhpcyBjb3VsZCBiZSBpbXByb3ZlZCBpbiB0aGUgZnV0dXJlIHRvIGR5bmFtaWNhbGx5IGNoYW5nZSBiYXNlZCBvbiBvdGhlclxuICAgICAgICAvLyB2YXJpYWJsZXMgaW5zdGVhZCBvZiBqdXN0IHJlYWRpbmcgdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuXG4gICAgICAgIHJldHVybiB0aGlzLmlzTW9iaWxlID8gdGhpcy5sb25nRGVsYXkgOiB0aGlzLnNob3J0RGVsYXk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuZnVuY3Rpb24gX2VtdWxhdG9yVXJsKGNvbmZpZywgcGF0aCkge1xuICAgIGRlYnVnQXNzZXJ0KGNvbmZpZy5lbXVsYXRvciwgJ0VtdWxhdG9yIHNob3VsZCBhbHdheXMgYmUgc2V0IGhlcmUnKTtcbiAgICBjb25zdCB7IHVybCB9ID0gY29uZmlnLmVtdWxhdG9yO1xuICAgIGlmICghcGF0aCkge1xuICAgICAgICByZXR1cm4gdXJsO1xuICAgIH1cbiAgICByZXR1cm4gYCR7dXJsfSR7cGF0aC5zdGFydHNXaXRoKCcvJykgPyBwYXRoLnNsaWNlKDEpIDogcGF0aH1gO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3MgRmV0Y2hQcm92aWRlciB7XG4gICAgc3RhdGljIGluaXRpYWxpemUoZmV0Y2hJbXBsLCBoZWFkZXJzSW1wbCwgcmVzcG9uc2VJbXBsKSB7XG4gICAgICAgIHRoaXMuZmV0Y2hJbXBsID0gZmV0Y2hJbXBsO1xuICAgICAgICBpZiAoaGVhZGVyc0ltcGwpIHtcbiAgICAgICAgICAgIHRoaXMuaGVhZGVyc0ltcGwgPSBoZWFkZXJzSW1wbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzcG9uc2VJbXBsKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3BvbnNlSW1wbCA9IHJlc3BvbnNlSW1wbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGF0aWMgZmV0Y2goKSB7XG4gICAgICAgIGlmICh0aGlzLmZldGNoSW1wbCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2hJbXBsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgJiYgJ2ZldGNoJyBpbiBzZWxmKSB7XG4gICAgICAgICAgICByZXR1cm4gc2VsZi5mZXRjaDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGdsb2JhbFRoaXMgIT09ICd1bmRlZmluZWQnICYmIGdsb2JhbFRoaXMuZmV0Y2gpIHtcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWxUaGlzLmZldGNoO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZmV0Y2ggIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICByZXR1cm4gZmV0Y2g7XG4gICAgICAgIH1cbiAgICAgICAgZGVidWdGYWlsKCdDb3VsZCBub3QgZmluZCBmZXRjaCBpbXBsZW1lbnRhdGlvbiwgbWFrZSBzdXJlIHlvdSBjYWxsIEZldGNoUHJvdmlkZXIuaW5pdGlhbGl6ZSgpIHdpdGggYW4gYXBwcm9wcmlhdGUgcG9seWZpbGwnKTtcbiAgICB9XG4gICAgc3RhdGljIGhlYWRlcnMoKSB7XG4gICAgICAgIGlmICh0aGlzLmhlYWRlcnNJbXBsKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5oZWFkZXJzSW1wbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnICYmICdIZWFkZXJzJyBpbiBzZWxmKSB7XG4gICAgICAgICAgICByZXR1cm4gc2VsZi5IZWFkZXJzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZ2xvYmFsVGhpcyAhPT0gJ3VuZGVmaW5lZCcgJiYgZ2xvYmFsVGhpcy5IZWFkZXJzKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsVGhpcy5IZWFkZXJzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgSGVhZGVycyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHJldHVybiBIZWFkZXJzO1xuICAgICAgICB9XG4gICAgICAgIGRlYnVnRmFpbCgnQ291bGQgbm90IGZpbmQgSGVhZGVycyBpbXBsZW1lbnRhdGlvbiwgbWFrZSBzdXJlIHlvdSBjYWxsIEZldGNoUHJvdmlkZXIuaW5pdGlhbGl6ZSgpIHdpdGggYW4gYXBwcm9wcmlhdGUgcG9seWZpbGwnKTtcbiAgICB9XG4gICAgc3RhdGljIHJlc3BvbnNlKCkge1xuICAgICAgICBpZiAodGhpcy5yZXNwb25zZUltcGwpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlc3BvbnNlSW1wbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnICYmICdSZXNwb25zZScgaW4gc2VsZikge1xuICAgICAgICAgICAgcmV0dXJuIHNlbGYuUmVzcG9uc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyAmJiBnbG9iYWxUaGlzLlJlc3BvbnNlKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsVGhpcy5SZXNwb25zZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIFJlc3BvbnNlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgcmV0dXJuIFJlc3BvbnNlO1xuICAgICAgICB9XG4gICAgICAgIGRlYnVnRmFpbCgnQ291bGQgbm90IGZpbmQgUmVzcG9uc2UgaW1wbGVtZW50YXRpb24sIG1ha2Ugc3VyZSB5b3UgY2FsbCBGZXRjaFByb3ZpZGVyLmluaXRpYWxpemUoKSB3aXRoIGFuIGFwcHJvcHJpYXRlIHBvbHlmaWxsJyk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBNYXAgZnJvbSBlcnJvcnMgcmV0dXJuZWQgYnkgdGhlIHNlcnZlciB0byBlcnJvcnMgdG8gZGV2ZWxvcGVyIHZpc2libGUgZXJyb3JzXG4gKi9cbmNvbnN0IFNFUlZFUl9FUlJPUl9NQVAgPSB7XG4gICAgLy8gQ3VzdG9tIHRva2VuIGVycm9ycy5cbiAgICBbXCJDUkVERU5USUFMX01JU01BVENIXCIgLyogU2VydmVyRXJyb3IuQ1JFREVOVElBTF9NSVNNQVRDSCAqL106IFwiY3VzdG9tLXRva2VuLW1pc21hdGNoXCIgLyogQXV0aEVycm9yQ29kZS5DUkVERU5USUFMX01JU01BVENIICovLFxuICAgIC8vIFRoaXMgY2FuIG9ubHkgaGFwcGVuIGlmIHRoZSBTREsgc2VuZHMgYSBiYWQgcmVxdWVzdC5cbiAgICBbXCJNSVNTSU5HX0NVU1RPTV9UT0tFTlwiIC8qIFNlcnZlckVycm9yLk1JU1NJTkdfQ1VTVE9NX1RPS0VOICovXTogXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8sXG4gICAgLy8gQ3JlYXRlIEF1dGggVVJJIGVycm9ycy5cbiAgICBbXCJJTlZBTElEX0lERU5USUZJRVJcIiAvKiBTZXJ2ZXJFcnJvci5JTlZBTElEX0lERU5USUZJRVIgKi9dOiBcImludmFsaWQtZW1haWxcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfRU1BSUwgKi8sXG4gICAgLy8gVGhpcyBjYW4gb25seSBoYXBwZW4gaWYgdGhlIFNESyBzZW5kcyBhIGJhZCByZXF1ZXN0LlxuICAgIFtcIk1JU1NJTkdfQ09OVElOVUVfVVJJXCIgLyogU2VydmVyRXJyb3IuTUlTU0lOR19DT05USU5VRV9VUkkgKi9dOiBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyxcbiAgICAvLyBTaWduIGluIHdpdGggZW1haWwgYW5kIHBhc3N3b3JkIGVycm9ycyAoc29tZSBhcHBseSB0byBzaWduIHVwIHRvbykuXG4gICAgW1wiSU5WQUxJRF9QQVNTV09SRFwiIC8qIFNlcnZlckVycm9yLklOVkFMSURfUEFTU1dPUkQgKi9dOiBcIndyb25nLXBhc3N3b3JkXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX1BBU1NXT1JEICovLFxuICAgIC8vIFRoaXMgY2FuIG9ubHkgaGFwcGVuIGlmIHRoZSBTREsgc2VuZHMgYSBiYWQgcmVxdWVzdC5cbiAgICBbXCJNSVNTSU5HX1BBU1NXT1JEXCIgLyogU2VydmVyRXJyb3IuTUlTU0lOR19QQVNTV09SRCAqL106IFwibWlzc2luZy1wYXNzd29yZFwiIC8qIEF1dGhFcnJvckNvZGUuTUlTU0lOR19QQVNTV09SRCAqLyxcbiAgICAvLyBUaHJvd24gaWYgRW1haWwgRW51bWVyYXRpb24gUHJvdGVjdGlvbiBpcyBlbmFibGVkIGluIHRoZSBwcm9qZWN0IGFuZCB0aGUgZW1haWwgb3IgcGFzc3dvcmQgaXNcbiAgICAvLyBpbnZhbGlkLlxuICAgIFtcIklOVkFMSURfTE9HSU5fQ1JFREVOVElBTFNcIiAvKiBTZXJ2ZXJFcnJvci5JTlZBTElEX0xPR0lOX0NSRURFTlRJQUxTICovXTogXCJpbnZhbGlkLWNyZWRlbnRpYWxcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfQ1JFREVOVElBTCAqLyxcbiAgICAvLyBTaWduIHVwIHdpdGggZW1haWwgYW5kIHBhc3N3b3JkIGVycm9ycy5cbiAgICBbXCJFTUFJTF9FWElTVFNcIiAvKiBTZXJ2ZXJFcnJvci5FTUFJTF9FWElTVFMgKi9dOiBcImVtYWlsLWFscmVhZHktaW4tdXNlXCIgLyogQXV0aEVycm9yQ29kZS5FTUFJTF9FWElTVFMgKi8sXG4gICAgW1wiUEFTU1dPUkRfTE9HSU5fRElTQUJMRURcIiAvKiBTZXJ2ZXJFcnJvci5QQVNTV09SRF9MT0dJTl9ESVNBQkxFRCAqL106IFwib3BlcmF0aW9uLW5vdC1hbGxvd2VkXCIgLyogQXV0aEVycm9yQ29kZS5PUEVSQVRJT05fTk9UX0FMTE9XRUQgKi8sXG4gICAgLy8gVmVyaWZ5IGFzc2VydGlvbiBmb3Igc2lnbiBpbiB3aXRoIGNyZWRlbnRpYWwgZXJyb3JzOlxuICAgIFtcIklOVkFMSURfSURQX1JFU1BPTlNFXCIgLyogU2VydmVyRXJyb3IuSU5WQUxJRF9JRFBfUkVTUE9OU0UgKi9dOiBcImludmFsaWQtY3JlZGVudGlhbFwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9DUkVERU5USUFMICovLFxuICAgIFtcIklOVkFMSURfUEVORElOR19UT0tFTlwiIC8qIFNlcnZlckVycm9yLklOVkFMSURfUEVORElOR19UT0tFTiAqL106IFwiaW52YWxpZC1jcmVkZW50aWFsXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0NSRURFTlRJQUwgKi8sXG4gICAgW1wiRkVERVJBVEVEX1VTRVJfSURfQUxSRUFEWV9MSU5LRURcIiAvKiBTZXJ2ZXJFcnJvci5GRURFUkFURURfVVNFUl9JRF9BTFJFQURZX0xJTktFRCAqL106IFwiY3JlZGVudGlhbC1hbHJlYWR5LWluLXVzZVwiIC8qIEF1dGhFcnJvckNvZGUuQ1JFREVOVElBTF9BTFJFQURZX0lOX1VTRSAqLyxcbiAgICAvLyBUaGlzIGNhbiBvbmx5IGhhcHBlbiBpZiB0aGUgU0RLIHNlbmRzIGEgYmFkIHJlcXVlc3QuXG4gICAgW1wiTUlTU0lOR19SRVFfVFlQRVwiIC8qIFNlcnZlckVycm9yLk1JU1NJTkdfUkVRX1RZUEUgKi9dOiBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyxcbiAgICAvLyBTZW5kIFBhc3N3b3JkIHJlc2V0IGVtYWlsIGVycm9yczpcbiAgICBbXCJFTUFJTF9OT1RfRk9VTkRcIiAvKiBTZXJ2ZXJFcnJvci5FTUFJTF9OT1RfRk9VTkQgKi9dOiBcInVzZXItbm90LWZvdW5kXCIgLyogQXV0aEVycm9yQ29kZS5VU0VSX0RFTEVURUQgKi8sXG4gICAgW1wiUkVTRVRfUEFTU1dPUkRfRVhDRUVEX0xJTUlUXCIgLyogU2VydmVyRXJyb3IuUkVTRVRfUEFTU1dPUkRfRVhDRUVEX0xJTUlUICovXTogXCJ0b28tbWFueS1yZXF1ZXN0c1wiIC8qIEF1dGhFcnJvckNvZGUuVE9PX01BTllfQVRURU1QVFNfVFJZX0xBVEVSICovLFxuICAgIFtcIkVYUElSRURfT09CX0NPREVcIiAvKiBTZXJ2ZXJFcnJvci5FWFBJUkVEX09PQl9DT0RFICovXTogXCJleHBpcmVkLWFjdGlvbi1jb2RlXCIgLyogQXV0aEVycm9yQ29kZS5FWFBJUkVEX09PQl9DT0RFICovLFxuICAgIFtcIklOVkFMSURfT09CX0NPREVcIiAvKiBTZXJ2ZXJFcnJvci5JTlZBTElEX09PQl9DT0RFICovXTogXCJpbnZhbGlkLWFjdGlvbi1jb2RlXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX09PQl9DT0RFICovLFxuICAgIC8vIFRoaXMgY2FuIG9ubHkgaGFwcGVuIGlmIHRoZSBTREsgc2VuZHMgYSBiYWQgcmVxdWVzdC5cbiAgICBbXCJNSVNTSU5HX09PQl9DT0RFXCIgLyogU2VydmVyRXJyb3IuTUlTU0lOR19PT0JfQ09ERSAqL106IFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovLFxuICAgIC8vIE9wZXJhdGlvbnMgdGhhdCByZXF1aXJlIElEIHRva2VuIGluIHJlcXVlc3Q6XG4gICAgW1wiQ1JFREVOVElBTF9UT09fT0xEX0xPR0lOX0FHQUlOXCIgLyogU2VydmVyRXJyb3IuQ1JFREVOVElBTF9UT09fT0xEX0xPR0lOX0FHQUlOICovXTogXCJyZXF1aXJlcy1yZWNlbnQtbG9naW5cIiAvKiBBdXRoRXJyb3JDb2RlLkNSRURFTlRJQUxfVE9PX09MRF9MT0dJTl9BR0FJTiAqLyxcbiAgICBbXCJJTlZBTElEX0lEX1RPS0VOXCIgLyogU2VydmVyRXJyb3IuSU5WQUxJRF9JRF9UT0tFTiAqL106IFwiaW52YWxpZC11c2VyLXRva2VuXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0FVVEggKi8sXG4gICAgW1wiVE9LRU5fRVhQSVJFRFwiIC8qIFNlcnZlckVycm9yLlRPS0VOX0VYUElSRUQgKi9dOiBcInVzZXItdG9rZW4tZXhwaXJlZFwiIC8qIEF1dGhFcnJvckNvZGUuVE9LRU5fRVhQSVJFRCAqLyxcbiAgICBbXCJVU0VSX05PVF9GT1VORFwiIC8qIFNlcnZlckVycm9yLlVTRVJfTk9UX0ZPVU5EICovXTogXCJ1c2VyLXRva2VuLWV4cGlyZWRcIiAvKiBBdXRoRXJyb3JDb2RlLlRPS0VOX0VYUElSRUQgKi8sXG4gICAgLy8gT3RoZXIgZXJyb3JzLlxuICAgIFtcIlRPT19NQU5ZX0FUVEVNUFRTX1RSWV9MQVRFUlwiIC8qIFNlcnZlckVycm9yLlRPT19NQU5ZX0FUVEVNUFRTX1RSWV9MQVRFUiAqL106IFwidG9vLW1hbnktcmVxdWVzdHNcIiAvKiBBdXRoRXJyb3JDb2RlLlRPT19NQU5ZX0FUVEVNUFRTX1RSWV9MQVRFUiAqLyxcbiAgICBbXCJQQVNTV09SRF9ET0VTX05PVF9NRUVUX1JFUVVJUkVNRU5UU1wiIC8qIFNlcnZlckVycm9yLlBBU1NXT1JEX0RPRVNfTk9UX01FRVRfUkVRVUlSRU1FTlRTICovXTogXCJwYXNzd29yZC1kb2VzLW5vdC1tZWV0LXJlcXVpcmVtZW50c1wiIC8qIEF1dGhFcnJvckNvZGUuUEFTU1dPUkRfRE9FU19OT1RfTUVFVF9SRVFVSVJFTUVOVFMgKi8sXG4gICAgLy8gUGhvbmUgQXV0aCByZWxhdGVkIGVycm9ycy5cbiAgICBbXCJJTlZBTElEX0NPREVcIiAvKiBTZXJ2ZXJFcnJvci5JTlZBTElEX0NPREUgKi9dOiBcImludmFsaWQtdmVyaWZpY2F0aW9uLWNvZGVcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfQ09ERSAqLyxcbiAgICBbXCJJTlZBTElEX1NFU1NJT05fSU5GT1wiIC8qIFNlcnZlckVycm9yLklOVkFMSURfU0VTU0lPTl9JTkZPICovXTogXCJpbnZhbGlkLXZlcmlmaWNhdGlvbi1pZFwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9TRVNTSU9OX0lORk8gKi8sXG4gICAgW1wiSU5WQUxJRF9URU1QT1JBUllfUFJPT0ZcIiAvKiBTZXJ2ZXJFcnJvci5JTlZBTElEX1RFTVBPUkFSWV9QUk9PRiAqL106IFwiaW52YWxpZC1jcmVkZW50aWFsXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0NSRURFTlRJQUwgKi8sXG4gICAgW1wiTUlTU0lOR19TRVNTSU9OX0lORk9cIiAvKiBTZXJ2ZXJFcnJvci5NSVNTSU5HX1NFU1NJT05fSU5GTyAqL106IFwibWlzc2luZy12ZXJpZmljYXRpb24taWRcIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfU0VTU0lPTl9JTkZPICovLFxuICAgIFtcIlNFU1NJT05fRVhQSVJFRFwiIC8qIFNlcnZlckVycm9yLlNFU1NJT05fRVhQSVJFRCAqL106IFwiY29kZS1leHBpcmVkXCIgLyogQXV0aEVycm9yQ29kZS5DT0RFX0VYUElSRUQgKi8sXG4gICAgLy8gT3RoZXIgYWN0aW9uIGNvZGUgZXJyb3JzIHdoZW4gYWRkaXRpb25hbCBzZXR0aW5ncyBwYXNzZWQuXG4gICAgLy8gTUlTU0lOR19DT05USU5VRV9VUkkgaXMgZ2V0dGluZyBtYXBwZWQgdG8gSU5URVJOQUxfRVJST1IgYWJvdmUuXG4gICAgLy8gVGhpcyBpcyBPSyBhcyB0aGlzIGVycm9yIHdpbGwgYmUgY2F1Z2h0IGJ5IGNsaWVudCBzaWRlIHZhbGlkYXRpb24uXG4gICAgW1wiTUlTU0lOR19BTkRST0lEX1BBQ0tBR0VfTkFNRVwiIC8qIFNlcnZlckVycm9yLk1JU1NJTkdfQU5EUk9JRF9QQUNLQUdFX05BTUUgKi9dOiBcIm1pc3NpbmctYW5kcm9pZC1wa2ctbmFtZVwiIC8qIEF1dGhFcnJvckNvZGUuTUlTU0lOR19BTkRST0lEX1BBQ0tBR0VfTkFNRSAqLyxcbiAgICBbXCJVTkFVVEhPUklaRURfRE9NQUlOXCIgLyogU2VydmVyRXJyb3IuVU5BVVRIT1JJWkVEX0RPTUFJTiAqL106IFwidW5hdXRob3JpemVkLWNvbnRpbnVlLXVyaVwiIC8qIEF1dGhFcnJvckNvZGUuVU5BVVRIT1JJWkVEX0RPTUFJTiAqLyxcbiAgICAvLyBnZXRQcm9qZWN0Q29uZmlnIGVycm9ycyB3aGVuIGNsaWVudElkIGlzIHBhc3NlZC5cbiAgICBbXCJJTlZBTElEX09BVVRIX0NMSUVOVF9JRFwiIC8qIFNlcnZlckVycm9yLklOVkFMSURfT0FVVEhfQ0xJRU5UX0lEICovXTogXCJpbnZhbGlkLW9hdXRoLWNsaWVudC1pZFwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9PQVVUSF9DTElFTlRfSUQgKi8sXG4gICAgLy8gVXNlciBhY3Rpb25zIChzaWduLXVwIG9yIGRlbGV0aW9uKSBkaXNhYmxlZCBlcnJvcnMuXG4gICAgW1wiQURNSU5fT05MWV9PUEVSQVRJT05cIiAvKiBTZXJ2ZXJFcnJvci5BRE1JTl9PTkxZX09QRVJBVElPTiAqL106IFwiYWRtaW4tcmVzdHJpY3RlZC1vcGVyYXRpb25cIiAvKiBBdXRoRXJyb3JDb2RlLkFETUlOX09OTFlfT1BFUkFUSU9OICovLFxuICAgIC8vIE11bHRpIGZhY3RvciByZWxhdGVkIGVycm9ycy5cbiAgICBbXCJJTlZBTElEX01GQV9QRU5ESU5HX0NSRURFTlRJQUxcIiAvKiBTZXJ2ZXJFcnJvci5JTlZBTElEX01GQV9QRU5ESU5HX0NSRURFTlRJQUwgKi9dOiBcImludmFsaWQtbXVsdGktZmFjdG9yLXNlc3Npb25cIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfTUZBX1NFU1NJT04gKi8sXG4gICAgW1wiTUZBX0VOUk9MTE1FTlRfTk9UX0ZPVU5EXCIgLyogU2VydmVyRXJyb3IuTUZBX0VOUk9MTE1FTlRfTk9UX0ZPVU5EICovXTogXCJtdWx0aS1mYWN0b3ItaW5mby1ub3QtZm91bmRcIiAvKiBBdXRoRXJyb3JDb2RlLk1GQV9JTkZPX05PVF9GT1VORCAqLyxcbiAgICBbXCJNSVNTSU5HX01GQV9FTlJPTExNRU5UX0lEXCIgLyogU2VydmVyRXJyb3IuTUlTU0lOR19NRkFfRU5ST0xMTUVOVF9JRCAqL106IFwibWlzc2luZy1tdWx0aS1mYWN0b3ItaW5mb1wiIC8qIEF1dGhFcnJvckNvZGUuTUlTU0lOR19NRkFfSU5GTyAqLyxcbiAgICBbXCJNSVNTSU5HX01GQV9QRU5ESU5HX0NSRURFTlRJQUxcIiAvKiBTZXJ2ZXJFcnJvci5NSVNTSU5HX01GQV9QRU5ESU5HX0NSRURFTlRJQUwgKi9dOiBcIm1pc3NpbmctbXVsdGktZmFjdG9yLXNlc3Npb25cIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfTUZBX1NFU1NJT04gKi8sXG4gICAgW1wiU0VDT05EX0ZBQ1RPUl9FWElTVFNcIiAvKiBTZXJ2ZXJFcnJvci5TRUNPTkRfRkFDVE9SX0VYSVNUUyAqL106IFwic2Vjb25kLWZhY3Rvci1hbHJlYWR5LWluLXVzZVwiIC8qIEF1dGhFcnJvckNvZGUuU0VDT05EX0ZBQ1RPUl9BTFJFQURZX0VOUk9MTEVEICovLFxuICAgIFtcIlNFQ09ORF9GQUNUT1JfTElNSVRfRVhDRUVERURcIiAvKiBTZXJ2ZXJFcnJvci5TRUNPTkRfRkFDVE9SX0xJTUlUX0VYQ0VFREVEICovXTogXCJtYXhpbXVtLXNlY29uZC1mYWN0b3ItY291bnQtZXhjZWVkZWRcIiAvKiBBdXRoRXJyb3JDb2RlLlNFQ09ORF9GQUNUT1JfTElNSVRfRVhDRUVERUQgKi8sXG4gICAgLy8gQmxvY2tpbmcgZnVuY3Rpb25zIHJlbGF0ZWQgZXJyb3JzLlxuICAgIFtcIkJMT0NLSU5HX0ZVTkNUSU9OX0VSUk9SX1JFU1BPTlNFXCIgLyogU2VydmVyRXJyb3IuQkxPQ0tJTkdfRlVOQ1RJT05fRVJST1JfUkVTUE9OU0UgKi9dOiBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyxcbiAgICAvLyBSZWNhcHRjaGEgcmVsYXRlZCBlcnJvcnMuXG4gICAgW1wiUkVDQVBUQ0hBX05PVF9FTkFCTEVEXCIgLyogU2VydmVyRXJyb3IuUkVDQVBUQ0hBX05PVF9FTkFCTEVEICovXTogXCJyZWNhcHRjaGEtbm90LWVuYWJsZWRcIiAvKiBBdXRoRXJyb3JDb2RlLlJFQ0FQVENIQV9OT1RfRU5BQkxFRCAqLyxcbiAgICBbXCJNSVNTSU5HX1JFQ0FQVENIQV9UT0tFTlwiIC8qIFNlcnZlckVycm9yLk1JU1NJTkdfUkVDQVBUQ0hBX1RPS0VOICovXTogXCJtaXNzaW5nLXJlY2FwdGNoYS10b2tlblwiIC8qIEF1dGhFcnJvckNvZGUuTUlTU0lOR19SRUNBUFRDSEFfVE9LRU4gKi8sXG4gICAgW1wiSU5WQUxJRF9SRUNBUFRDSEFfVE9LRU5cIiAvKiBTZXJ2ZXJFcnJvci5JTlZBTElEX1JFQ0FQVENIQV9UT0tFTiAqL106IFwiaW52YWxpZC1yZWNhcHRjaGEtdG9rZW5cIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfUkVDQVBUQ0hBX1RPS0VOICovLFxuICAgIFtcIklOVkFMSURfUkVDQVBUQ0hBX0FDVElPTlwiIC8qIFNlcnZlckVycm9yLklOVkFMSURfUkVDQVBUQ0hBX0FDVElPTiAqL106IFwiaW52YWxpZC1yZWNhcHRjaGEtYWN0aW9uXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX1JFQ0FQVENIQV9BQ1RJT04gKi8sXG4gICAgW1wiTUlTU0lOR19DTElFTlRfVFlQRVwiIC8qIFNlcnZlckVycm9yLk1JU1NJTkdfQ0xJRU5UX1RZUEUgKi9dOiBcIm1pc3NpbmctY2xpZW50LXR5cGVcIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfQ0xJRU5UX1RZUEUgKi8sXG4gICAgW1wiTUlTU0lOR19SRUNBUFRDSEFfVkVSU0lPTlwiIC8qIFNlcnZlckVycm9yLk1JU1NJTkdfUkVDQVBUQ0hBX1ZFUlNJT04gKi9dOiBcIm1pc3NpbmctcmVjYXB0Y2hhLXZlcnNpb25cIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfUkVDQVBUQ0hBX1ZFUlNJT04gKi8sXG4gICAgW1wiSU5WQUxJRF9SRUNBUFRDSEFfVkVSU0lPTlwiIC8qIFNlcnZlckVycm9yLklOVkFMSURfUkVDQVBUQ0hBX1ZFUlNJT04gKi9dOiBcImludmFsaWQtcmVjYXB0Y2hhLXZlcnNpb25cIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfUkVDQVBUQ0hBX1ZFUlNJT04gKi8sXG4gICAgW1wiSU5WQUxJRF9SRVFfVFlQRVwiIC8qIFNlcnZlckVycm9yLklOVkFMSURfUkVRX1RZUEUgKi9dOiBcImludmFsaWQtcmVxLXR5cGVcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfUkVRX1RZUEUgKi9cbn07XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jb25zdCBDb29raWVBdXRoUHJveGllZEVuZHBvaW50cyA9IFtcbiAgICBcIi92MS9hY2NvdW50czpzaWduSW5XaXRoQ3VzdG9tVG9rZW5cIiAvKiBFbmRwb2ludC5TSUdOX0lOX1dJVEhfQ1VTVE9NX1RPS0VOICovLFxuICAgIFwiL3YxL2FjY291bnRzOnNpZ25JbldpdGhFbWFpbExpbmtcIiAvKiBFbmRwb2ludC5TSUdOX0lOX1dJVEhfRU1BSUxfTElOSyAqLyxcbiAgICBcIi92MS9hY2NvdW50czpzaWduSW5XaXRoSWRwXCIgLyogRW5kcG9pbnQuU0lHTl9JTl9XSVRIX0lEUCAqLyxcbiAgICBcIi92MS9hY2NvdW50czpzaWduSW5XaXRoUGFzc3dvcmRcIiAvKiBFbmRwb2ludC5TSUdOX0lOX1dJVEhfUEFTU1dPUkQgKi8sXG4gICAgXCIvdjEvYWNjb3VudHM6c2lnbkluV2l0aFBob25lTnVtYmVyXCIgLyogRW5kcG9pbnQuU0lHTl9JTl9XSVRIX1BIT05FX05VTUJFUiAqLyxcbiAgICBcIi92MS90b2tlblwiIC8qIEVuZHBvaW50LlRPS0VOICovXG5dO1xuY29uc3QgREVGQVVMVF9BUElfVElNRU9VVF9NUyA9IG5ldyBEZWxheSgzMDAwMCwgNjAwMDApO1xuZnVuY3Rpb24gX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpIHtcbiAgICBpZiAoYXV0aC50ZW5hbnRJZCAmJiAhcmVxdWVzdC50ZW5hbnRJZCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLi4ucmVxdWVzdCxcbiAgICAgICAgICAgIHRlbmFudElkOiBhdXRoLnRlbmFudElkXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiByZXF1ZXN0O1xufVxuYXN5bmMgZnVuY3Rpb24gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIG1ldGhvZCwgcGF0aCwgcmVxdWVzdCwgY3VzdG9tRXJyb3JNYXAgPSB7fSkge1xuICAgIHJldHVybiBfcGVyZm9ybUZldGNoV2l0aEVycm9ySGFuZGxpbmcoYXV0aCwgY3VzdG9tRXJyb3JNYXAsIGFzeW5jICgpID0+IHtcbiAgICAgICAgbGV0IGJvZHkgPSB7fTtcbiAgICAgICAgbGV0IHBhcmFtcyA9IHt9O1xuICAgICAgICBpZiAocmVxdWVzdCkge1xuICAgICAgICAgICAgaWYgKG1ldGhvZCA9PT0gXCJHRVRcIiAvKiBIdHRwTWV0aG9kLkdFVCAqLykge1xuICAgICAgICAgICAgICAgIHBhcmFtcyA9IHJlcXVlc3Q7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBib2R5ID0ge1xuICAgICAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShyZXF1ZXN0KVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcXVlcnkgPSBxdWVyeXN0cmluZyh7XG4gICAgICAgICAgICBrZXk6IGF1dGguY29uZmlnLmFwaUtleSxcbiAgICAgICAgICAgIC4uLnBhcmFtc1xuICAgICAgICB9KS5zbGljZSgxKTtcbiAgICAgICAgY29uc3QgaGVhZGVycyA9IGF3YWl0IGF1dGguX2dldEFkZGl0aW9uYWxIZWFkZXJzKCk7XG4gICAgICAgIGhlYWRlcnNbXCJDb250ZW50LVR5cGVcIiAvKiBIdHRwSGVhZGVyLkNPTlRFTlRfVFlQRSAqL10gPSAnYXBwbGljYXRpb24vanNvbic7XG4gICAgICAgIGlmIChhdXRoLmxhbmd1YWdlQ29kZSkge1xuICAgICAgICAgICAgaGVhZGVyc1tcIlgtRmlyZWJhc2UtTG9jYWxlXCIgLyogSHR0cEhlYWRlci5YX0ZJUkVCQVNFX0xPQ0FMRSAqL10gPSBhdXRoLmxhbmd1YWdlQ29kZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmZXRjaEFyZ3MgPSB7XG4gICAgICAgICAgICBtZXRob2QsXG4gICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgLi4uYm9keVxuICAgICAgICB9O1xuICAgICAgICAvKiBTZWN1cml0eS1jb25zY2lvdXMgc2VydmVyLXNpZGUgZnJhbWV3b3JrcyB0ZW5kIHRvIGhhdmUgYnVpbHQgaW4gbWl0aWdhdGlvbnMgZm9yIHJlZmVycmVyXG4gICAgICAgICAgIHByb2JsZW1zXCIuIFNlZSB0aGUgQ2xvdWRmbGFyZSBHaXRIdWIgaXNzdWUgIzQ4NzogRXJyb3I6IFRoZSAncmVmZXJyZXJQb2xpY3knIGZpZWxkIG9uXG4gICAgICAgICAgICdSZXF1ZXN0SW5pdGlhbGl6ZXJEaWN0JyBpcyBub3QgaW1wbGVtZW50ZWQuXCJcbiAgICAgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL2Nsb3VkZmxhcmUvbmV4dC1vbi1wYWdlcy9pc3N1ZXMvNDg3ICovXG4gICAgICAgIGlmICghaXNDbG91ZGZsYXJlV29ya2VyKCkpIHtcbiAgICAgICAgICAgIGZldGNoQXJncy5yZWZlcnJlclBvbGljeSA9ICduby1yZWZlcnJlcic7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGF1dGguZW11bGF0b3JDb25maWcgJiYgaXNDbG91ZFdvcmtzdGF0aW9uKGF1dGguZW11bGF0b3JDb25maWcuaG9zdCkpIHtcbiAgICAgICAgICAgIGZldGNoQXJncy5jcmVkZW50aWFscyA9ICdpbmNsdWRlJztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gRmV0Y2hQcm92aWRlci5mZXRjaCgpKGF3YWl0IF9nZXRGaW5hbFRhcmdldChhdXRoLCBhdXRoLmNvbmZpZy5hcGlIb3N0LCBwYXRoLCBxdWVyeSksIGZldGNoQXJncyk7XG4gICAgfSk7XG59XG5hc3luYyBmdW5jdGlvbiBfcGVyZm9ybUZldGNoV2l0aEVycm9ySGFuZGxpbmcoYXV0aCwgY3VzdG9tRXJyb3JNYXAsIGZldGNoRm4pIHtcbiAgICBhdXRoLl9jYW5Jbml0RW11bGF0b3IgPSBmYWxzZTtcbiAgICBjb25zdCBlcnJvck1hcCA9IHsgLi4uU0VSVkVSX0VSUk9SX01BUCwgLi4uY3VzdG9tRXJyb3JNYXAgfTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBuZXR3b3JrVGltZW91dCA9IG5ldyBOZXR3b3JrVGltZW91dChhdXRoKTtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBQcm9taXNlLnJhY2UoW1xuICAgICAgICAgICAgZmV0Y2hGbigpLFxuICAgICAgICAgICAgbmV0d29ya1RpbWVvdXQucHJvbWlzZVxuICAgICAgICBdKTtcbiAgICAgICAgLy8gSWYgd2UndmUgcmVhY2hlZCB0aGlzIHBvaW50LCB0aGUgZmV0Y2ggc3VjY2VlZGVkIGFuZCB0aGUgbmV0d29ya1RpbWVvdXRcbiAgICAgICAgLy8gZGlkbid0IHRocm93OyBjbGVhciB0aGUgbmV0d29yayB0aW1lb3V0IGRlbGF5IHNvIHRoYXQgTm9kZSB3b24ndCBoYW5nXG4gICAgICAgIG5ldHdvcmtUaW1lb3V0LmNsZWFyTmV0d29ya1RpbWVvdXQoKTtcbiAgICAgICAgY29uc3QganNvbiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgaWYgKCduZWVkQ29uZmlybWF0aW9uJyBpbiBqc29uKSB7XG4gICAgICAgICAgICB0aHJvdyBfbWFrZVRhZ2dlZEVycm9yKGF1dGgsIFwiYWNjb3VudC1leGlzdHMtd2l0aC1kaWZmZXJlbnQtY3JlZGVudGlhbFwiIC8qIEF1dGhFcnJvckNvZGUuTkVFRF9DT05GSVJNQVRJT04gKi8sIGpzb24pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZXNwb25zZS5vayAmJiAhKCdlcnJvck1lc3NhZ2UnIGluIGpzb24pKSB7XG4gICAgICAgICAgICByZXR1cm4ganNvbjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IHJlc3BvbnNlLm9rID8ganNvbi5lcnJvck1lc3NhZ2UgOiBqc29uLmVycm9yLm1lc3NhZ2U7XG4gICAgICAgICAgICBjb25zdCBbc2VydmVyRXJyb3JDb2RlLCBzZXJ2ZXJFcnJvck1lc3NhZ2VdID0gZXJyb3JNZXNzYWdlLnNwbGl0KCcgOiAnKTtcbiAgICAgICAgICAgIGlmIChzZXJ2ZXJFcnJvckNvZGUgPT09IFwiRkVERVJBVEVEX1VTRVJfSURfQUxSRUFEWV9MSU5LRURcIiAvKiBTZXJ2ZXJFcnJvci5GRURFUkFURURfVVNFUl9JRF9BTFJFQURZX0xJTktFRCAqLykge1xuICAgICAgICAgICAgICAgIHRocm93IF9tYWtlVGFnZ2VkRXJyb3IoYXV0aCwgXCJjcmVkZW50aWFsLWFscmVhZHktaW4tdXNlXCIgLyogQXV0aEVycm9yQ29kZS5DUkVERU5USUFMX0FMUkVBRFlfSU5fVVNFICovLCBqc29uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNlcnZlckVycm9yQ29kZSA9PT0gXCJFTUFJTF9FWElTVFNcIiAvKiBTZXJ2ZXJFcnJvci5FTUFJTF9FWElTVFMgKi8pIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBfbWFrZVRhZ2dlZEVycm9yKGF1dGgsIFwiZW1haWwtYWxyZWFkeS1pbi11c2VcIiAvKiBBdXRoRXJyb3JDb2RlLkVNQUlMX0VYSVNUUyAqLywganNvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzZXJ2ZXJFcnJvckNvZGUgPT09IFwiVVNFUl9ESVNBQkxFRFwiIC8qIFNlcnZlckVycm9yLlVTRVJfRElTQUJMRUQgKi8pIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBfbWFrZVRhZ2dlZEVycm9yKGF1dGgsIFwidXNlci1kaXNhYmxlZFwiIC8qIEF1dGhFcnJvckNvZGUuVVNFUl9ESVNBQkxFRCAqLywganNvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBhdXRoRXJyb3IgPSBlcnJvck1hcFtzZXJ2ZXJFcnJvckNvZGVdIHx8XG4gICAgICAgICAgICAgICAgc2VydmVyRXJyb3JDb2RlXG4gICAgICAgICAgICAgICAgICAgIC50b0xvd2VyQ2FzZSgpXG4gICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9bX1xcc10rL2csICctJyk7XG4gICAgICAgICAgICBpZiAoc2VydmVyRXJyb3JNZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgX2Vycm9yV2l0aEN1c3RvbU1lc3NhZ2UoYXV0aCwgYXV0aEVycm9yLCBzZXJ2ZXJFcnJvck1lc3NhZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgX2ZhaWwoYXV0aCwgYXV0aEVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEZpcmViYXNlRXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQ2hhbmdpbmcgdGhpcyB0byBhIGRpZmZlcmVudCBlcnJvciBjb2RlIHdpbGwgbG9nIHVzZXIgb3V0IHdoZW4gdGhlcmUgaXMgYSBuZXR3b3JrIGVycm9yXG4gICAgICAgIC8vIGJlY2F1c2Ugd2UgdHJlYXQgYW55IGVycm9yIG90aGVyIHRoYW4gTkVUV09SS19SRVFVRVNUX0ZBSUxFRCBhcyB0b2tlbiBpcyBpbnZhbGlkLlxuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZmlyZWJhc2UvZmlyZWJhc2UtanMtc2RrL2Jsb2IvNGZiYzczNjEwZDcwYmU0ZTA4NTJlN2RlNjNhMzljYjc4OTdlODU0Ni9wYWNrYWdlcy9hdXRoL3NyYy9jb3JlL2F1dGgvYXV0aF9pbXBsLnRzI0wzMDktTDMxNlxuICAgICAgICBfZmFpbChhdXRoLCBcIm5ldHdvcmstcmVxdWVzdC1mYWlsZWRcIiAvKiBBdXRoRXJyb3JDb2RlLk5FVFdPUktfUkVRVUVTVF9GQUlMRUQgKi8sIHsgJ21lc3NhZ2UnOiBTdHJpbmcoZSkgfSk7XG4gICAgfVxufVxuYXN5bmMgZnVuY3Rpb24gX3BlcmZvcm1TaWduSW5SZXF1ZXN0KGF1dGgsIG1ldGhvZCwgcGF0aCwgcmVxdWVzdCwgY3VzdG9tRXJyb3JNYXAgPSB7fSkge1xuICAgIGNvbnN0IHNlcnZlclJlc3BvbnNlID0gYXdhaXQgX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIG1ldGhvZCwgcGF0aCwgcmVxdWVzdCwgY3VzdG9tRXJyb3JNYXApO1xuICAgIGlmICgnbWZhUGVuZGluZ0NyZWRlbnRpYWwnIGluIHNlcnZlclJlc3BvbnNlKSB7XG4gICAgICAgIF9mYWlsKGF1dGgsIFwibXVsdGktZmFjdG9yLWF1dGgtcmVxdWlyZWRcIiAvKiBBdXRoRXJyb3JDb2RlLk1GQV9SRVFVSVJFRCAqLywge1xuICAgICAgICAgICAgX3NlcnZlclJlc3BvbnNlOiBzZXJ2ZXJSZXNwb25zZVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHNlcnZlclJlc3BvbnNlO1xufVxuYXN5bmMgZnVuY3Rpb24gX2dldEZpbmFsVGFyZ2V0KGF1dGgsIGhvc3QsIHBhdGgsIHF1ZXJ5KSB7XG4gICAgY29uc3QgYmFzZSA9IGAke2hvc3R9JHtwYXRofT8ke3F1ZXJ5fWA7XG4gICAgY29uc3QgYXV0aEludGVybmFsID0gYXV0aDtcbiAgICBjb25zdCBmaW5hbFRhcmdldCA9IGF1dGhJbnRlcm5hbC5jb25maWcuZW11bGF0b3JcbiAgICAgICAgPyBfZW11bGF0b3JVcmwoYXV0aC5jb25maWcsIGJhc2UpXG4gICAgICAgIDogYCR7YXV0aC5jb25maWcuYXBpU2NoZW1lfTovLyR7YmFzZX1gO1xuICAgIC8vIENvb2tpZSBhdXRoIHdvcmtzIGJ5IE1pVE1pbmcgdGhlIHNpZ25JbiBhbmQgdG9rZW4gZW5kcG9pbnRzIGZyb20gdGhlIGRldmVsb3BlcidzIGJhY2tlbmQsXG4gICAgLy8gc2F2aW5nIHRoZSBpZFRva2VuIGFuZCByZWZyZXNoVG9rZW4gaW50byBjb29raWVzLCBhbmQgdGhlbiByZWRhY3RpbmcgdGhlIHJlZnJlc2hUb2tlblxuICAgIC8vIGZyb20gdGhlIHJlc3BvbnNlXG4gICAgaWYgKENvb2tpZUF1dGhQcm94aWVkRW5kcG9pbnRzLmluY2x1ZGVzKHBhdGgpKSB7XG4gICAgICAgIC8vIFBlcnNpc3RlbmNlIG1hbmFnZXIgaXMgYXN5bmMsIHdlIG5lZWQgdG8gYXdhaXQgaXQuIFdlIGNhbid0IGp1c3Qgd2FpdCBmb3IgYXV0aCBpbml0aWFsaXplZFxuICAgICAgICAvLyBoZXJlIHNpbmNlIGF1dGggaW5pdGlhbGl6YXRpb24gY2FsbHMgdGhpcyBmdW5jdGlvbi5cbiAgICAgICAgYXdhaXQgYXV0aEludGVybmFsLl9wZXJzaXN0ZW5jZU1hbmFnZXJBdmFpbGFibGU7XG4gICAgICAgIGlmIChhdXRoSW50ZXJuYWwuX2dldFBlcnNpc3RlbmNlVHlwZSgpID09PSBcIkNPT0tJRVwiIC8qIFBlcnNpc3RlbmNlVHlwZS5DT09LSUUgKi8pIHtcbiAgICAgICAgICAgIGNvbnN0IGNvb2tpZVBlcnNpc3RlbmNlID0gYXV0aEludGVybmFsLl9nZXRQZXJzaXN0ZW5jZSgpO1xuICAgICAgICAgICAgcmV0dXJuIGNvb2tpZVBlcnNpc3RlbmNlLl9nZXRGaW5hbFRhcmdldChmaW5hbFRhcmdldCkudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmluYWxUYXJnZXQ7XG59XG5mdW5jdGlvbiBfcGFyc2VFbmZvcmNlbWVudFN0YXRlKGVuZm9yY2VtZW50U3RhdGVTdHIpIHtcbiAgICBzd2l0Y2ggKGVuZm9yY2VtZW50U3RhdGVTdHIpIHtcbiAgICAgICAgY2FzZSAnRU5GT1JDRSc6XG4gICAgICAgICAgICByZXR1cm4gXCJFTkZPUkNFXCIgLyogRW5mb3JjZW1lbnRTdGF0ZS5FTkZPUkNFICovO1xuICAgICAgICBjYXNlICdBVURJVCc6XG4gICAgICAgICAgICByZXR1cm4gXCJBVURJVFwiIC8qIEVuZm9yY2VtZW50U3RhdGUuQVVESVQgKi87XG4gICAgICAgIGNhc2UgJ09GRic6XG4gICAgICAgICAgICByZXR1cm4gXCJPRkZcIiAvKiBFbmZvcmNlbWVudFN0YXRlLk9GRiAqLztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBcIkVORk9SQ0VNRU5UX1NUQVRFX1VOU1BFQ0lGSUVEXCIgLyogRW5mb3JjZW1lbnRTdGF0ZS5FTkZPUkNFTUVOVF9TVEFURV9VTlNQRUNJRklFRCAqLztcbiAgICB9XG59XG5jbGFzcyBOZXR3b3JrVGltZW91dCB7XG4gICAgY2xlYXJOZXR3b3JrVGltZW91dCgpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpO1xuICAgIH1cbiAgICBjb25zdHJ1Y3RvcihhdXRoKSB7XG4gICAgICAgIHRoaXMuYXV0aCA9IGF1dGg7XG4gICAgICAgIC8vIE5vZGUgdGltZXJzIGFuZCBicm93c2VyIHRpbWVycyBhcmUgZnVuZGFtZW50YWxseSBpbmNvbXBhdGlibGUsIGJ1dCB3ZVxuICAgICAgICAvLyBkb24ndCBjYXJlIGFib3V0IHRoZSB2YWx1ZSBoZXJlXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIHRoaXMudGltZXIgPSBudWxsO1xuICAgICAgICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZSgoXywgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLnRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChfY3JlYXRlRXJyb3IodGhpcy5hdXRoLCBcIm5ldHdvcmstcmVxdWVzdC1mYWlsZWRcIiAvKiBBdXRoRXJyb3JDb2RlLk5FVFdPUktfUkVRVUVTVF9GQUlMRUQgKi8pKTtcbiAgICAgICAgICAgIH0sIERFRkFVTFRfQVBJX1RJTUVPVVRfTVMuZ2V0KCkpO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5mdW5jdGlvbiBfbWFrZVRhZ2dlZEVycm9yKGF1dGgsIGNvZGUsIHJlc3BvbnNlKSB7XG4gICAgY29uc3QgZXJyb3JQYXJhbXMgPSB7XG4gICAgICAgIGFwcE5hbWU6IGF1dGgubmFtZVxuICAgIH07XG4gICAgaWYgKHJlc3BvbnNlLmVtYWlsKSB7XG4gICAgICAgIGVycm9yUGFyYW1zLmVtYWlsID0gcmVzcG9uc2UuZW1haWw7XG4gICAgfVxuICAgIGlmIChyZXNwb25zZS5waG9uZU51bWJlcikge1xuICAgICAgICBlcnJvclBhcmFtcy5waG9uZU51bWJlciA9IHJlc3BvbnNlLnBob25lTnVtYmVyO1xuICAgIH1cbiAgICBjb25zdCBlcnJvciA9IF9jcmVhdGVFcnJvcihhdXRoLCBjb2RlLCBlcnJvclBhcmFtcyk7XG4gICAgLy8gV2Uga25vdyBjdXN0b21EYXRhIGlzIGRlZmluZWQgb24gZXJyb3IgYmVjYXVzZSBlcnJvclBhcmFtcyBpcyBkZWZpbmVkXG4gICAgZXJyb3IuY3VzdG9tRGF0YS5fdG9rZW5SZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgIHJldHVybiBlcnJvcjtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmZ1bmN0aW9uIGlzVjIoZ3JlY2FwdGNoYSkge1xuICAgIHJldHVybiAoZ3JlY2FwdGNoYSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgIGdyZWNhcHRjaGEuZ2V0UmVzcG9uc2UgIT09IHVuZGVmaW5lZCk7XG59XG5mdW5jdGlvbiBpc0VudGVycHJpc2UoZ3JlY2FwdGNoYSkge1xuICAgIHJldHVybiAoZ3JlY2FwdGNoYSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgIGdyZWNhcHRjaGEuZW50ZXJwcmlzZSAhPT0gdW5kZWZpbmVkKTtcbn1cbmNsYXNzIFJlY2FwdGNoYUNvbmZpZyB7XG4gICAgY29uc3RydWN0b3IocmVzcG9uc2UpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSByZUNBUFRDSEEgc2l0ZSBrZXkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNpdGVLZXkgPSAnJztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBsaXN0IG9mIHByb3ZpZGVycyBhbmQgdGhlaXIgZW5hYmxlbWVudCBzdGF0dXMgZm9yIHJlQ0FQVENIQSBFbnRlcnByaXNlLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5yZWNhcHRjaGFFbmZvcmNlbWVudFN0YXRlID0gW107XG4gICAgICAgIGlmIChyZXNwb25zZS5yZWNhcHRjaGFLZXkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdyZWNhcHRjaGFLZXkgdW5kZWZpbmVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gRXhhbXBsZSByZXNwb25zZS5yZWNhcHRjaGFLZXk6IFwicHJvamVjdHMvcHJvajEyMy9rZXlzL3NpdGVrZXkxMjNcIlxuICAgICAgICB0aGlzLnNpdGVLZXkgPSByZXNwb25zZS5yZWNhcHRjaGFLZXkuc3BsaXQoJy8nKVszXTtcbiAgICAgICAgdGhpcy5yZWNhcHRjaGFFbmZvcmNlbWVudFN0YXRlID0gcmVzcG9uc2UucmVjYXB0Y2hhRW5mb3JjZW1lbnRTdGF0ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgcmVDQVBUQ0hBIEVudGVycHJpc2UgZW5mb3JjZW1lbnQgc3RhdGUgZm9yIHRoZSBnaXZlbiBwcm92aWRlci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwcm92aWRlclN0ciAtIFRoZSBwcm92aWRlciB3aG9zZSBlbmZvcmNlbWVudCBzdGF0ZSBpcyB0byBiZSByZXR1cm5lZC5cbiAgICAgKiBAcmV0dXJucyBUaGUgcmVDQVBUQ0hBIEVudGVycHJpc2UgZW5mb3JjZW1lbnQgc3RhdGUgZm9yIHRoZSBnaXZlbiBwcm92aWRlci5cbiAgICAgKi9cbiAgICBnZXRQcm92aWRlckVuZm9yY2VtZW50U3RhdGUocHJvdmlkZXJTdHIpIHtcbiAgICAgICAgaWYgKCF0aGlzLnJlY2FwdGNoYUVuZm9yY2VtZW50U3RhdGUgfHxcbiAgICAgICAgICAgIHRoaXMucmVjYXB0Y2hhRW5mb3JjZW1lbnRTdGF0ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgcmVjYXB0Y2hhRW5mb3JjZW1lbnRTdGF0ZSBvZiB0aGlzLnJlY2FwdGNoYUVuZm9yY2VtZW50U3RhdGUpIHtcbiAgICAgICAgICAgIGlmIChyZWNhcHRjaGFFbmZvcmNlbWVudFN0YXRlLnByb3ZpZGVyICYmXG4gICAgICAgICAgICAgICAgcmVjYXB0Y2hhRW5mb3JjZW1lbnRTdGF0ZS5wcm92aWRlciA9PT0gcHJvdmlkZXJTdHIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX3BhcnNlRW5mb3JjZW1lbnRTdGF0ZShyZWNhcHRjaGFFbmZvcmNlbWVudFN0YXRlLmVuZm9yY2VtZW50U3RhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIHJlQ0FQVENIQSBFbnRlcnByaXNlIGVuZm9yY2VtZW50IHN0YXRlIGZvciB0aGUgcHJvdmlkZXIgaXMgc2V0IHRvIEVORk9SQ0Ugb3IgQVVESVQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcHJvdmlkZXJTdHIgLSBUaGUgcHJvdmlkZXIgd2hvc2UgZW5hYmxlbWVudCBzdGF0ZSBpcyB0byBiZSByZXR1cm5lZC5cbiAgICAgKiBAcmV0dXJucyBXaGV0aGVyIG9yIG5vdCByZUNBUFRDSEEgRW50ZXJwcmlzZSBwcm90ZWN0aW9uIGlzIGVuYWJsZWQgZm9yIHRoZSBnaXZlbiBwcm92aWRlci5cbiAgICAgKi9cbiAgICBpc1Byb3ZpZGVyRW5hYmxlZChwcm92aWRlclN0cikge1xuICAgICAgICByZXR1cm4gKHRoaXMuZ2V0UHJvdmlkZXJFbmZvcmNlbWVudFN0YXRlKHByb3ZpZGVyU3RyKSA9PT1cbiAgICAgICAgICAgIFwiRU5GT1JDRVwiIC8qIEVuZm9yY2VtZW50U3RhdGUuRU5GT1JDRSAqLyB8fFxuICAgICAgICAgICAgdGhpcy5nZXRQcm92aWRlckVuZm9yY2VtZW50U3RhdGUocHJvdmlkZXJTdHIpID09PSBcIkFVRElUXCIgLyogRW5mb3JjZW1lbnRTdGF0ZS5BVURJVCAqLyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiByZUNBUFRDSEEgRW50ZXJwcmlzZSBwcm90ZWN0aW9uIGlzIGVuYWJsZWQgaW4gYXQgbGVhc3Qgb25lIHByb3ZpZGVyLCBvdGhlcndpc2VcbiAgICAgKiByZXR1cm5zIGZhbHNlLlxuICAgICAqXG4gICAgICogQHJldHVybnMgV2hldGhlciBvciBub3QgcmVDQVBUQ0hBIEVudGVycHJpc2UgcHJvdGVjdGlvbiBpcyBlbmFibGVkIGZvciBhdCBsZWFzdCBvbmUgcHJvdmlkZXIuXG4gICAgICovXG4gICAgaXNBbnlQcm92aWRlckVuYWJsZWQoKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5pc1Byb3ZpZGVyRW5hYmxlZChcIkVNQUlMX1BBU1NXT1JEX1BST1ZJREVSXCIgLyogUmVjYXB0Y2hhQXV0aFByb3ZpZGVyLkVNQUlMX1BBU1NXT1JEX1BST1ZJREVSICovKSB8fFxuICAgICAgICAgICAgdGhpcy5pc1Byb3ZpZGVyRW5hYmxlZChcIlBIT05FX1BST1ZJREVSXCIgLyogUmVjYXB0Y2hhQXV0aFByb3ZpZGVyLlBIT05FX1BST1ZJREVSICovKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0UmVjYXB0Y2hhUGFyYW1zKGF1dGgpIHtcbiAgICByZXR1cm4gKChhd2FpdCBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJHRVRcIiAvKiBIdHRwTWV0aG9kLkdFVCAqLywgXCIvdjEvcmVjYXB0Y2hhUGFyYW1zXCIgLyogRW5kcG9pbnQuR0VUX1JFQ0FQVENIQV9QQVJBTSAqLykpLnJlY2FwdGNoYVNpdGVLZXkgfHwgJycpO1xufVxuYXN5bmMgZnVuY3Rpb24gZ2V0UmVjYXB0Y2hhQ29uZmlnKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiR0VUXCIgLyogSHR0cE1ldGhvZC5HRVQgKi8sIFwiL3YyL3JlY2FwdGNoYUNvbmZpZ1wiIC8qIEVuZHBvaW50LkdFVF9SRUNBUFRDSEFfQ09ORklHICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZGVsZXRlQWNjb3VudChhdXRoLCByZXF1ZXN0KSB7XG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBIdHRwTWV0aG9kLlBPU1QgKi8sIFwiL3YxL2FjY291bnRzOmRlbGV0ZVwiIC8qIEVuZHBvaW50LkRFTEVURV9BQ0NPVU5UICovLCByZXF1ZXN0KTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUxpbmtlZEFjY291bnRzKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6dXBkYXRlXCIgLyogRW5kcG9pbnQuU0VUX0FDQ09VTlRfSU5GTyAqLywgcmVxdWVzdCk7XG59XG5hc3luYyBmdW5jdGlvbiBnZXRBY2NvdW50SW5mbyhhdXRoLCByZXF1ZXN0KSB7XG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBIdHRwTWV0aG9kLlBPU1QgKi8sIFwiL3YxL2FjY291bnRzOmxvb2t1cFwiIC8qIEVuZHBvaW50LkdFVF9BQ0NPVU5UX0lORk8gKi8sIHJlcXVlc3QpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuZnVuY3Rpb24gdXRjVGltZXN0YW1wVG9EYXRlU3RyaW5nKHV0Y1RpbWVzdGFtcCkge1xuICAgIGlmICghdXRjVGltZXN0YW1wKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIC8vIENvbnZlcnQgdG8gZGF0ZSBvYmplY3QuXG4gICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShOdW1iZXIodXRjVGltZXN0YW1wKSk7XG4gICAgICAgIC8vIFRlc3QgZGF0ZSBpcyB2YWxpZC5cbiAgICAgICAgaWYgKCFpc05hTihkYXRlLmdldFRpbWUoKSkpIHtcbiAgICAgICAgICAgIC8vIENvbnZlcnQgdG8gVVRDIGRhdGUgc3RyaW5nLlxuICAgICAgICAgICAgcmV0dXJuIGRhdGUudG9VVENTdHJpbmcoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICAvLyBEbyBub3RoaW5nLiB1bmRlZmluZWQgd2lsbCBiZSByZXR1cm5lZC5cbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmV0dXJucyBhIEpTT04gV2ViIFRva2VuIChKV1QpIHVzZWQgdG8gaWRlbnRpZnkgdGhlIHVzZXIgdG8gYSBGaXJlYmFzZSBzZXJ2aWNlLlxuICpcbiAqIEByZW1hcmtzXG4gKiBSZXR1cm5zIHRoZSBjdXJyZW50IHRva2VuIGlmIGl0IGhhcyBub3QgZXhwaXJlZCBvciBpZiBpdCB3aWxsIG5vdCBleHBpcmUgaW4gdGhlIG5leHQgZml2ZVxuICogbWludXRlcy4gT3RoZXJ3aXNlLCB0aGlzIHdpbGwgcmVmcmVzaCB0aGUgdG9rZW4gYW5kIHJldHVybiBhIG5ldyBvbmUuXG4gKlxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cbiAqIEBwYXJhbSBmb3JjZVJlZnJlc2ggLSBGb3JjZSByZWZyZXNoIHJlZ2FyZGxlc3Mgb2YgdG9rZW4gZXhwaXJhdGlvbi5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIGdldElkVG9rZW4odXNlciwgZm9yY2VSZWZyZXNoID0gZmFsc2UpIHtcbiAgICByZXR1cm4gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpLmdldElkVG9rZW4oZm9yY2VSZWZyZXNoKTtcbn1cbi8qKlxuICogUmV0dXJucyBhIGRlc2VyaWFsaXplZCBKU09OIFdlYiBUb2tlbiAoSldUKSB1c2VkIHRvIGlkZW50aWZ5IHRoZSB1c2VyIHRvIGEgRmlyZWJhc2Ugc2VydmljZS5cbiAqXG4gKiBAcmVtYXJrc1xuICogUmV0dXJucyB0aGUgY3VycmVudCB0b2tlbiBpZiBpdCBoYXMgbm90IGV4cGlyZWQgb3IgaWYgaXQgd2lsbCBub3QgZXhwaXJlIGluIHRoZSBuZXh0IGZpdmVcbiAqIG1pbnV0ZXMuIE90aGVyd2lzZSwgdGhpcyB3aWxsIHJlZnJlc2ggdGhlIHRva2VuIGFuZCByZXR1cm4gYSBuZXcgb25lLlxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gZm9yY2VSZWZyZXNoIC0gRm9yY2UgcmVmcmVzaCByZWdhcmRsZXNzIG9mIHRva2VuIGV4cGlyYXRpb24uXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiBnZXRJZFRva2VuUmVzdWx0KHVzZXIsIGZvcmNlUmVmcmVzaCA9IGZhbHNlKSB7XG4gICAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpO1xuICAgIGNvbnN0IHRva2VuID0gYXdhaXQgdXNlckludGVybmFsLmdldElkVG9rZW4oZm9yY2VSZWZyZXNoKTtcbiAgICBjb25zdCBjbGFpbXMgPSBfcGFyc2VUb2tlbih0b2tlbik7XG4gICAgX2Fzc2VydChjbGFpbXMgJiYgY2xhaW1zLmV4cCAmJiBjbGFpbXMuYXV0aF90aW1lICYmIGNsYWltcy5pYXQsIHVzZXJJbnRlcm5hbC5hdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgY29uc3QgZmlyZWJhc2UgPSB0eXBlb2YgY2xhaW1zLmZpcmViYXNlID09PSAnb2JqZWN0JyA/IGNsYWltcy5maXJlYmFzZSA6IHVuZGVmaW5lZDtcbiAgICBjb25zdCBzaWduSW5Qcm92aWRlciA9IGZpcmViYXNlPy5bJ3NpZ25faW5fcHJvdmlkZXInXTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjbGFpbXMsXG4gICAgICAgIHRva2VuLFxuICAgICAgICBhdXRoVGltZTogdXRjVGltZXN0YW1wVG9EYXRlU3RyaW5nKHNlY29uZHNTdHJpbmdUb01pbGxpc2Vjb25kcyhjbGFpbXMuYXV0aF90aW1lKSksXG4gICAgICAgIGlzc3VlZEF0VGltZTogdXRjVGltZXN0YW1wVG9EYXRlU3RyaW5nKHNlY29uZHNTdHJpbmdUb01pbGxpc2Vjb25kcyhjbGFpbXMuaWF0KSksXG4gICAgICAgIGV4cGlyYXRpb25UaW1lOiB1dGNUaW1lc3RhbXBUb0RhdGVTdHJpbmcoc2Vjb25kc1N0cmluZ1RvTWlsbGlzZWNvbmRzKGNsYWltcy5leHApKSxcbiAgICAgICAgc2lnbkluUHJvdmlkZXI6IHNpZ25JblByb3ZpZGVyIHx8IG51bGwsXG4gICAgICAgIHNpZ25JblNlY29uZEZhY3RvcjogZmlyZWJhc2U/Llsnc2lnbl9pbl9zZWNvbmRfZmFjdG9yJ10gfHwgbnVsbFxuICAgIH07XG59XG5mdW5jdGlvbiBzZWNvbmRzU3RyaW5nVG9NaWxsaXNlY29uZHMoc2Vjb25kcykge1xuICAgIHJldHVybiBOdW1iZXIoc2Vjb25kcykgKiAxMDAwO1xufVxuZnVuY3Rpb24gX3BhcnNlVG9rZW4odG9rZW4pIHtcbiAgICBjb25zdCBbYWxnb3JpdGhtLCBwYXlsb2FkLCBzaWduYXR1cmVdID0gdG9rZW4uc3BsaXQoJy4nKTtcbiAgICBpZiAoYWxnb3JpdGhtID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgcGF5bG9hZCA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgIHNpZ25hdHVyZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIF9sb2dFcnJvcignSldUIG1hbGZvcm1lZCwgY29udGFpbmVkIGZld2VyIHRoYW4gMyBzZWN0aW9ucycpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZGVjb2RlZCA9IGJhc2U2NERlY29kZShwYXlsb2FkKTtcbiAgICAgICAgaWYgKCFkZWNvZGVkKSB7XG4gICAgICAgICAgICBfbG9nRXJyb3IoJ0ZhaWxlZCB0byBkZWNvZGUgYmFzZTY0IEpXVCBwYXlsb2FkJyk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShkZWNvZGVkKTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgX2xvZ0Vycm9yKCdDYXVnaHQgZXJyb3IgcGFyc2luZyBKV1QgcGF5bG9hZCBhcyBKU09OJywgZT8udG9TdHJpbmcoKSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cbi8qKlxuICogRXh0cmFjdCBleHBpcmVzSW4gVFRMIGZyb20gYSB0b2tlbiBieSBzdWJ0cmFjdGluZyB0aGUgZXhwaXJhdGlvbiBmcm9tIHRoZSBpc3N1YW5jZS5cbiAqL1xuZnVuY3Rpb24gX3Rva2VuRXhwaXJlc0luKHRva2VuKSB7XG4gICAgY29uc3QgcGFyc2VkVG9rZW4gPSBfcGFyc2VUb2tlbih0b2tlbik7XG4gICAgX2Fzc2VydChwYXJzZWRUb2tlbiwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgIF9hc3NlcnQodHlwZW9mIHBhcnNlZFRva2VuLmV4cCAhPT0gJ3VuZGVmaW5lZCcsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICBfYXNzZXJ0KHR5cGVvZiBwYXJzZWRUb2tlbi5pYXQgIT09ICd1bmRlZmluZWQnLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgcmV0dXJuIE51bWJlcihwYXJzZWRUb2tlbi5leHApIC0gTnVtYmVyKHBhcnNlZFRva2VuLmlhdCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5hc3luYyBmdW5jdGlvbiBfbG9nb3V0SWZJbnZhbGlkYXRlZCh1c2VyLCBwcm9taXNlLCBieXBhc3NBdXRoU3RhdGUgPSBmYWxzZSkge1xuICAgIGlmIChieXBhc3NBdXRoU3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBhd2FpdCBwcm9taXNlO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEZpcmViYXNlRXJyb3IgJiYgaXNVc2VySW52YWxpZGF0ZWQoZSkpIHtcbiAgICAgICAgICAgIGlmICh1c2VyLmF1dGguY3VycmVudFVzZXIgPT09IHVzZXIpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB1c2VyLmF1dGguc2lnbk91dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRocm93IGU7XG4gICAgfVxufVxuZnVuY3Rpb24gaXNVc2VySW52YWxpZGF0ZWQoeyBjb2RlIH0pIHtcbiAgICByZXR1cm4gKGNvZGUgPT09IGBhdXRoLyR7XCJ1c2VyLWRpc2FibGVkXCIgLyogQXV0aEVycm9yQ29kZS5VU0VSX0RJU0FCTEVEICovfWAgfHxcbiAgICAgICAgY29kZSA9PT0gYGF1dGgvJHtcInVzZXItdG9rZW4tZXhwaXJlZFwiIC8qIEF1dGhFcnJvckNvZGUuVE9LRU5fRVhQSVJFRCAqL31gKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNsYXNzIFByb2FjdGl2ZVJlZnJlc2gge1xuICAgIGNvbnN0cnVjdG9yKHVzZXIpIHtcbiAgICAgICAgdGhpcy51c2VyID0gdXNlcjtcbiAgICAgICAgdGhpcy5pc1J1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgLy8gTm9kZSB0aW1lcnMgYW5kIGJyb3dzZXIgdGltZXJzIHJldHVybiBmdW5kYW1lbnRhbGx5IGRpZmZlcmVudCB0eXBlcy5cbiAgICAgICAgLy8gV2UgZG9uJ3QgYWN0dWFsbHkgY2FyZSB3aGF0IHRoZSB2YWx1ZSBpcyBidXQgVFMgd29uJ3QgYWNjZXB0IHVua25vd24gYW5kXG4gICAgICAgIC8vIHdlIGNhbid0IGNhc3QgcHJvcGVybHkgaW4gYm90aCBlbnZpcm9ubWVudHMuXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIHRoaXMudGltZXJJZCA9IG51bGw7XG4gICAgICAgIHRoaXMuZXJyb3JCYWNrb2ZmID0gMzAwMDAgLyogRHVyYXRpb24uUkVUUllfQkFDS09GRl9NSU4gKi87XG4gICAgfVxuICAgIF9zdGFydCgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNSdW5uaW5nKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pc1J1bm5pbmcgPSB0cnVlO1xuICAgICAgICB0aGlzLnNjaGVkdWxlKCk7XG4gICAgfVxuICAgIF9zdG9wKCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNSdW5uaW5nKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pc1J1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgaWYgKHRoaXMudGltZXJJZCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJJZCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0SW50ZXJ2YWwod2FzRXJyb3IpIHtcbiAgICAgICAgaWYgKHdhc0Vycm9yKSB7XG4gICAgICAgICAgICBjb25zdCBpbnRlcnZhbCA9IHRoaXMuZXJyb3JCYWNrb2ZmO1xuICAgICAgICAgICAgdGhpcy5lcnJvckJhY2tvZmYgPSBNYXRoLm1pbih0aGlzLmVycm9yQmFja29mZiAqIDIsIDk2MDAwMCAvKiBEdXJhdGlvbi5SRVRSWV9CQUNLT0ZGX01BWCAqLyk7XG4gICAgICAgICAgICByZXR1cm4gaW50ZXJ2YWw7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBSZXNldCB0aGUgZXJyb3IgYmFja29mZlxuICAgICAgICAgICAgdGhpcy5lcnJvckJhY2tvZmYgPSAzMDAwMCAvKiBEdXJhdGlvbi5SRVRSWV9CQUNLT0ZGX01JTiAqLztcbiAgICAgICAgICAgIGNvbnN0IGV4cFRpbWUgPSB0aGlzLnVzZXIuc3RzVG9rZW5NYW5hZ2VyLmV4cGlyYXRpb25UaW1lID8/IDA7XG4gICAgICAgICAgICBjb25zdCBpbnRlcnZhbCA9IGV4cFRpbWUgLSBEYXRlLm5vdygpIC0gMzAwMDAwIC8qIER1cmF0aW9uLk9GRlNFVCAqLztcbiAgICAgICAgICAgIHJldHVybiBNYXRoLm1heCgwLCBpbnRlcnZhbCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2NoZWR1bGUod2FzRXJyb3IgPSBmYWxzZSkge1xuICAgICAgICBpZiAoIXRoaXMuaXNSdW5uaW5nKSB7XG4gICAgICAgICAgICAvLyBKdXN0IGluIGNhc2UuLi5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpbnRlcnZhbCA9IHRoaXMuZ2V0SW50ZXJ2YWwod2FzRXJyb3IpO1xuICAgICAgICB0aGlzLnRpbWVySWQgPSBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuaXRlcmF0aW9uKCk7XG4gICAgICAgIH0sIGludGVydmFsKTtcbiAgICB9XG4gICAgYXN5bmMgaXRlcmF0aW9uKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy51c2VyLmdldElkVG9rZW4odHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIC8vIE9ubHkgcmV0cnkgb24gbmV0d29yayBlcnJvcnNcbiAgICAgICAgICAgIGlmIChlPy5jb2RlID09PVxuICAgICAgICAgICAgICAgIGBhdXRoLyR7XCJuZXR3b3JrLXJlcXVlc3QtZmFpbGVkXCIgLyogQXV0aEVycm9yQ29kZS5ORVRXT1JLX1JFUVVFU1RfRkFJTEVEICovfWApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlKC8qIHdhc0Vycm9yICovIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2NoZWR1bGUoKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jbGFzcyBVc2VyTWV0YWRhdGEge1xuICAgIGNvbnN0cnVjdG9yKGNyZWF0ZWRBdCwgbGFzdExvZ2luQXQpIHtcbiAgICAgICAgdGhpcy5jcmVhdGVkQXQgPSBjcmVhdGVkQXQ7XG4gICAgICAgIHRoaXMubGFzdExvZ2luQXQgPSBsYXN0TG9naW5BdDtcbiAgICAgICAgdGhpcy5faW5pdGlhbGl6ZVRpbWUoKTtcbiAgICB9XG4gICAgX2luaXRpYWxpemVUaW1lKCkge1xuICAgICAgICB0aGlzLmxhc3RTaWduSW5UaW1lID0gdXRjVGltZXN0YW1wVG9EYXRlU3RyaW5nKHRoaXMubGFzdExvZ2luQXQpO1xuICAgICAgICB0aGlzLmNyZWF0aW9uVGltZSA9IHV0Y1RpbWVzdGFtcFRvRGF0ZVN0cmluZyh0aGlzLmNyZWF0ZWRBdCk7XG4gICAgfVxuICAgIF9jb3B5KG1ldGFkYXRhKSB7XG4gICAgICAgIHRoaXMuY3JlYXRlZEF0ID0gbWV0YWRhdGEuY3JlYXRlZEF0O1xuICAgICAgICB0aGlzLmxhc3RMb2dpbkF0ID0gbWV0YWRhdGEubGFzdExvZ2luQXQ7XG4gICAgICAgIHRoaXMuX2luaXRpYWxpemVUaW1lKCk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogdGhpcy5jcmVhdGVkQXQsXG4gICAgICAgICAgICBsYXN0TG9naW5BdDogdGhpcy5sYXN0TG9naW5BdFxuICAgICAgICB9O1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIF9yZWxvYWRXaXRob3V0U2F2aW5nKHVzZXIpIHtcbiAgICBjb25zdCBhdXRoID0gdXNlci5hdXRoO1xuICAgIGNvbnN0IGlkVG9rZW4gPSBhd2FpdCB1c2VyLmdldElkVG9rZW4oKTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IF9sb2dvdXRJZkludmFsaWRhdGVkKHVzZXIsIGdldEFjY291bnRJbmZvKGF1dGgsIHsgaWRUb2tlbiB9KSk7XG4gICAgX2Fzc2VydChyZXNwb25zZT8udXNlcnMubGVuZ3RoLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgY29uc3QgY29yZUFjY291bnQgPSByZXNwb25zZS51c2Vyc1swXTtcbiAgICB1c2VyLl9ub3RpZnlSZWxvYWRMaXN0ZW5lcihjb3JlQWNjb3VudCk7XG4gICAgY29uc3QgbmV3UHJvdmlkZXJEYXRhID0gY29yZUFjY291bnQucHJvdmlkZXJVc2VySW5mbz8ubGVuZ3RoXG4gICAgICAgID8gZXh0cmFjdFByb3ZpZGVyRGF0YShjb3JlQWNjb3VudC5wcm92aWRlclVzZXJJbmZvKVxuICAgICAgICA6IFtdO1xuICAgIGNvbnN0IHByb3ZpZGVyRGF0YSA9IG1lcmdlUHJvdmlkZXJEYXRhKHVzZXIucHJvdmlkZXJEYXRhLCBuZXdQcm92aWRlckRhdGEpO1xuICAgIC8vIFByZXNlcnZlcyB0aGUgbm9uLW5vbnltb3VzIHN0YXR1cyBvZiB0aGUgc3RvcmVkIHVzZXIsIGV2ZW4gaWYgbm8gbW9yZVxuICAgIC8vIGNyZWRlbnRpYWxzIChmZWRlcmF0ZWQgb3IgZW1haWwvcGFzc3dvcmQpIGFyZSBsaW5rZWQgdG8gdGhlIHVzZXIuIElmXG4gICAgLy8gdGhlIHVzZXIgd2FzIHByZXZpb3VzbHkgYW5vbnltb3VzLCB0aGVuIHVzZSBwcm92aWRlciBkYXRhIHRvIHVwZGF0ZS5cbiAgICAvLyBPbiB0aGUgb3RoZXIgaGFuZCwgaWYgaXQgd2FzIG5vdCBhbm9ueW1vdXMgYmVmb3JlLCBpdCBzaG91bGQgbmV2ZXIgYmVcbiAgICAvLyBjb25zaWRlcmVkIGFub255bW91cyBub3cuXG4gICAgY29uc3Qgb2xkSXNBbm9ueW1vdXMgPSB1c2VyLmlzQW5vbnltb3VzO1xuICAgIGNvbnN0IG5ld0lzQW5vbnltb3VzID0gISh1c2VyLmVtYWlsICYmIGNvcmVBY2NvdW50LnBhc3N3b3JkSGFzaCkgJiYgIXByb3ZpZGVyRGF0YT8ubGVuZ3RoO1xuICAgIGNvbnN0IGlzQW5vbnltb3VzID0gIW9sZElzQW5vbnltb3VzID8gZmFsc2UgOiBuZXdJc0Fub255bW91cztcbiAgICBjb25zdCB1cGRhdGVzID0ge1xuICAgICAgICB1aWQ6IGNvcmVBY2NvdW50LmxvY2FsSWQsXG4gICAgICAgIGRpc3BsYXlOYW1lOiBjb3JlQWNjb3VudC5kaXNwbGF5TmFtZSB8fCBudWxsLFxuICAgICAgICBwaG90b1VSTDogY29yZUFjY291bnQucGhvdG9VcmwgfHwgbnVsbCxcbiAgICAgICAgZW1haWw6IGNvcmVBY2NvdW50LmVtYWlsIHx8IG51bGwsXG4gICAgICAgIGVtYWlsVmVyaWZpZWQ6IGNvcmVBY2NvdW50LmVtYWlsVmVyaWZpZWQgfHwgZmFsc2UsXG4gICAgICAgIHBob25lTnVtYmVyOiBjb3JlQWNjb3VudC5waG9uZU51bWJlciB8fCBudWxsLFxuICAgICAgICB0ZW5hbnRJZDogY29yZUFjY291bnQudGVuYW50SWQgfHwgbnVsbCxcbiAgICAgICAgcHJvdmlkZXJEYXRhLFxuICAgICAgICBtZXRhZGF0YTogbmV3IFVzZXJNZXRhZGF0YShjb3JlQWNjb3VudC5jcmVhdGVkQXQsIGNvcmVBY2NvdW50Lmxhc3RMb2dpbkF0KSxcbiAgICAgICAgaXNBbm9ueW1vdXNcbiAgICB9O1xuICAgIE9iamVjdC5hc3NpZ24odXNlciwgdXBkYXRlcyk7XG59XG4vKipcbiAqIFJlbG9hZHMgdXNlciBhY2NvdW50IGRhdGEsIGlmIHNpZ25lZCBpbi5cbiAqXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gcmVsb2FkKHVzZXIpIHtcbiAgICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcik7XG4gICAgYXdhaXQgX3JlbG9hZFdpdGhvdXRTYXZpbmcodXNlckludGVybmFsKTtcbiAgICAvLyBFdmVuIHRob3VnaCB0aGUgY3VycmVudCB1c2VyIGhhc24ndCBjaGFuZ2VkLCB1cGRhdGVcbiAgICAvLyBjdXJyZW50IHVzZXIgd2lsbCB0cmlnZ2VyIGEgcGVyc2lzdGVuY2UgdXBkYXRlIHcvIHRoZVxuICAgIC8vIG5ldyBpbmZvLlxuICAgIGF3YWl0IHVzZXJJbnRlcm5hbC5hdXRoLl9wZXJzaXN0VXNlcklmQ3VycmVudCh1c2VySW50ZXJuYWwpO1xuICAgIHVzZXJJbnRlcm5hbC5hdXRoLl9ub3RpZnlMaXN0ZW5lcnNJZkN1cnJlbnQodXNlckludGVybmFsKTtcbn1cbmZ1bmN0aW9uIG1lcmdlUHJvdmlkZXJEYXRhKG9yaWdpbmFsLCBuZXdEYXRhKSB7XG4gICAgY29uc3QgZGVkdXBlZCA9IG9yaWdpbmFsLmZpbHRlcihvID0+ICFuZXdEYXRhLnNvbWUobiA9PiBuLnByb3ZpZGVySWQgPT09IG8ucHJvdmlkZXJJZCkpO1xuICAgIHJldHVybiBbLi4uZGVkdXBlZCwgLi4ubmV3RGF0YV07XG59XG5mdW5jdGlvbiBleHRyYWN0UHJvdmlkZXJEYXRhKHByb3ZpZGVycykge1xuICAgIHJldHVybiBwcm92aWRlcnMubWFwKCh7IHByb3ZpZGVySWQsIC4uLnByb3ZpZGVyIH0pID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHByb3ZpZGVySWQsXG4gICAgICAgICAgICB1aWQ6IHByb3ZpZGVyLnJhd0lkIHx8ICcnLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6IHByb3ZpZGVyLmRpc3BsYXlOYW1lIHx8IG51bGwsXG4gICAgICAgICAgICBlbWFpbDogcHJvdmlkZXIuZW1haWwgfHwgbnVsbCxcbiAgICAgICAgICAgIHBob25lTnVtYmVyOiBwcm92aWRlci5waG9uZU51bWJlciB8fCBudWxsLFxuICAgICAgICAgICAgcGhvdG9VUkw6IHByb3ZpZGVyLnBob3RvVXJsIHx8IG51bGxcbiAgICAgICAgfTtcbiAgICB9KTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHJlcXVlc3RTdHNUb2tlbihhdXRoLCByZWZyZXNoVG9rZW4pIHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IF9wZXJmb3JtRmV0Y2hXaXRoRXJyb3JIYW5kbGluZyhhdXRoLCB7fSwgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBib2R5ID0gcXVlcnlzdHJpbmcoe1xuICAgICAgICAgICAgJ2dyYW50X3R5cGUnOiAncmVmcmVzaF90b2tlbicsXG4gICAgICAgICAgICAncmVmcmVzaF90b2tlbic6IHJlZnJlc2hUb2tlblxuICAgICAgICB9KS5zbGljZSgxKTtcbiAgICAgICAgY29uc3QgeyB0b2tlbkFwaUhvc3QsIGFwaUtleSB9ID0gYXV0aC5jb25maWc7XG4gICAgICAgIGNvbnN0IHVybCA9IGF3YWl0IF9nZXRGaW5hbFRhcmdldChhdXRoLCB0b2tlbkFwaUhvc3QsIFwiL3YxL3Rva2VuXCIgLyogRW5kcG9pbnQuVE9LRU4gKi8sIGBrZXk9JHthcGlLZXl9YCk7XG4gICAgICAgIGNvbnN0IGhlYWRlcnMgPSBhd2FpdCBhdXRoLl9nZXRBZGRpdGlvbmFsSGVhZGVycygpO1xuICAgICAgICBoZWFkZXJzW1wiQ29udGVudC1UeXBlXCIgLyogSHR0cEhlYWRlci5DT05URU5UX1RZUEUgKi9dID0gJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCc7XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLyxcbiAgICAgICAgICAgIGhlYWRlcnMsXG4gICAgICAgICAgICBib2R5XG4gICAgICAgIH07XG4gICAgICAgIGlmIChhdXRoLmVtdWxhdG9yQ29uZmlnICYmXG4gICAgICAgICAgICBpc0Nsb3VkV29ya3N0YXRpb24oYXV0aC5lbXVsYXRvckNvbmZpZy5ob3N0KSkge1xuICAgICAgICAgICAgb3B0aW9ucy5jcmVkZW50aWFscyA9ICdpbmNsdWRlJztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gRmV0Y2hQcm92aWRlci5mZXRjaCgpKHVybCwgb3B0aW9ucyk7XG4gICAgfSk7XG4gICAgLy8gVGhlIHJlc3BvbnNlIGNvbWVzIGJhY2sgaW4gc25ha2VfY2FzZS4gQ29udmVydCB0byBjYW1lbDpcbiAgICByZXR1cm4ge1xuICAgICAgICBhY2Nlc3NUb2tlbjogcmVzcG9uc2UuYWNjZXNzX3Rva2VuLFxuICAgICAgICBleHBpcmVzSW46IHJlc3BvbnNlLmV4cGlyZXNfaW4sXG4gICAgICAgIHJlZnJlc2hUb2tlbjogcmVzcG9uc2UucmVmcmVzaF90b2tlblxuICAgIH07XG59XG5hc3luYyBmdW5jdGlvbiByZXZva2VUb2tlbihhdXRoLCByZXF1ZXN0KSB7XG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBIdHRwTWV0aG9kLlBPU1QgKi8sIFwiL3YyL2FjY291bnRzOnJldm9rZVRva2VuXCIgLyogRW5kcG9pbnQuUkVWT0tFX1RPS0VOICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBXZSBuZWVkIHRvIG1hcmsgdGhpcyBjbGFzcyBhcyBpbnRlcm5hbCBleHBsaWNpdGx5IHRvIGV4Y2x1ZGUgaXQgaW4gdGhlIHB1YmxpYyB0eXBpbmdzLCBiZWNhdXNlXG4gKiBpdCByZWZlcmVuY2VzIEF1dGhJbnRlcm5hbCB3aGljaCBoYXMgYSBjaXJjdWxhciBkZXBlbmRlbmN5IHdpdGggVXNlckludGVybmFsLlxuICpcbiAqIEBpbnRlcm5hbFxuICovXG5jbGFzcyBTdHNUb2tlbk1hbmFnZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnJlZnJlc2hUb2tlbiA9IG51bGw7XG4gICAgICAgIHRoaXMuYWNjZXNzVG9rZW4gPSBudWxsO1xuICAgICAgICB0aGlzLmV4cGlyYXRpb25UaW1lID0gbnVsbDtcbiAgICB9XG4gICAgZ2V0IGlzRXhwaXJlZCgpIHtcbiAgICAgICAgcmV0dXJuICghdGhpcy5leHBpcmF0aW9uVGltZSB8fFxuICAgICAgICAgICAgRGF0ZS5ub3coKSA+IHRoaXMuZXhwaXJhdGlvblRpbWUgLSAzMDAwMCAvKiBCdWZmZXIuVE9LRU5fUkVGUkVTSCAqLyk7XG4gICAgfVxuICAgIHVwZGF0ZUZyb21TZXJ2ZXJSZXNwb25zZShyZXNwb25zZSkge1xuICAgICAgICBfYXNzZXJ0KHJlc3BvbnNlLmlkVG9rZW4sIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgX2Fzc2VydCh0eXBlb2YgcmVzcG9uc2UuaWRUb2tlbiAhPT0gJ3VuZGVmaW5lZCcsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgX2Fzc2VydCh0eXBlb2YgcmVzcG9uc2UucmVmcmVzaFRva2VuICE9PSAndW5kZWZpbmVkJywgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgICAgICBjb25zdCBleHBpcmVzSW4gPSAnZXhwaXJlc0luJyBpbiByZXNwb25zZSAmJiB0eXBlb2YgcmVzcG9uc2UuZXhwaXJlc0luICE9PSAndW5kZWZpbmVkJ1xuICAgICAgICAgICAgPyBOdW1iZXIocmVzcG9uc2UuZXhwaXJlc0luKVxuICAgICAgICAgICAgOiBfdG9rZW5FeHBpcmVzSW4ocmVzcG9uc2UuaWRUb2tlbik7XG4gICAgICAgIHRoaXMudXBkYXRlVG9rZW5zQW5kRXhwaXJhdGlvbihyZXNwb25zZS5pZFRva2VuLCByZXNwb25zZS5yZWZyZXNoVG9rZW4sIGV4cGlyZXNJbik7XG4gICAgfVxuICAgIHVwZGF0ZUZyb21JZFRva2VuKGlkVG9rZW4pIHtcbiAgICAgICAgX2Fzc2VydChpZFRva2VuLmxlbmd0aCAhPT0gMCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgICAgICBjb25zdCBleHBpcmVzSW4gPSBfdG9rZW5FeHBpcmVzSW4oaWRUb2tlbik7XG4gICAgICAgIHRoaXMudXBkYXRlVG9rZW5zQW5kRXhwaXJhdGlvbihpZFRva2VuLCBudWxsLCBleHBpcmVzSW4pO1xuICAgIH1cbiAgICBhc3luYyBnZXRUb2tlbihhdXRoLCBmb3JjZVJlZnJlc2ggPSBmYWxzZSkge1xuICAgICAgICBpZiAoIWZvcmNlUmVmcmVzaCAmJiB0aGlzLmFjY2Vzc1Rva2VuICYmICF0aGlzLmlzRXhwaXJlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWNjZXNzVG9rZW47XG4gICAgICAgIH1cbiAgICAgICAgX2Fzc2VydCh0aGlzLnJlZnJlc2hUb2tlbiwgYXV0aCwgXCJ1c2VyLXRva2VuLWV4cGlyZWRcIiAvKiBBdXRoRXJyb3JDb2RlLlRPS0VOX0VYUElSRUQgKi8pO1xuICAgICAgICBpZiAodGhpcy5yZWZyZXNoVG9rZW4pIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucmVmcmVzaChhdXRoLCB0aGlzLnJlZnJlc2hUb2tlbik7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hY2Nlc3NUb2tlbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY2xlYXJSZWZyZXNoVG9rZW4oKSB7XG4gICAgICAgIHRoaXMucmVmcmVzaFRva2VuID0gbnVsbDtcbiAgICB9XG4gICAgYXN5bmMgcmVmcmVzaChhdXRoLCBvbGRUb2tlbikge1xuICAgICAgICBjb25zdCB7IGFjY2Vzc1Rva2VuLCByZWZyZXNoVG9rZW4sIGV4cGlyZXNJbiB9ID0gYXdhaXQgcmVxdWVzdFN0c1Rva2VuKGF1dGgsIG9sZFRva2VuKTtcbiAgICAgICAgdGhpcy51cGRhdGVUb2tlbnNBbmRFeHBpcmF0aW9uKGFjY2Vzc1Rva2VuLCByZWZyZXNoVG9rZW4sIE51bWJlcihleHBpcmVzSW4pKTtcbiAgICB9XG4gICAgdXBkYXRlVG9rZW5zQW5kRXhwaXJhdGlvbihhY2Nlc3NUb2tlbiwgcmVmcmVzaFRva2VuLCBleHBpcmVzSW5TZWMpIHtcbiAgICAgICAgdGhpcy5yZWZyZXNoVG9rZW4gPSByZWZyZXNoVG9rZW4gfHwgbnVsbDtcbiAgICAgICAgdGhpcy5hY2Nlc3NUb2tlbiA9IGFjY2Vzc1Rva2VuIHx8IG51bGw7XG4gICAgICAgIHRoaXMuZXhwaXJhdGlvblRpbWUgPSBEYXRlLm5vdygpICsgZXhwaXJlc0luU2VjICogMTAwMDtcbiAgICB9XG4gICAgc3RhdGljIGZyb21KU09OKGFwcE5hbWUsIG9iamVjdCkge1xuICAgICAgICBjb25zdCB7IHJlZnJlc2hUb2tlbiwgYWNjZXNzVG9rZW4sIGV4cGlyYXRpb25UaW1lIH0gPSBvYmplY3Q7XG4gICAgICAgIGNvbnN0IG1hbmFnZXIgPSBuZXcgU3RzVG9rZW5NYW5hZ2VyKCk7XG4gICAgICAgIGlmIChyZWZyZXNoVG9rZW4pIHtcbiAgICAgICAgICAgIF9hc3NlcnQodHlwZW9mIHJlZnJlc2hUb2tlbiA9PT0gJ3N0cmluZycsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovLCB7XG4gICAgICAgICAgICAgICAgYXBwTmFtZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBtYW5hZ2VyLnJlZnJlc2hUb2tlbiA9IHJlZnJlc2hUb2tlbjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgICAgIF9hc3NlcnQodHlwZW9mIGFjY2Vzc1Rva2VuID09PSAnc3RyaW5nJywgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8sIHtcbiAgICAgICAgICAgICAgICBhcHBOYW1lXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG1hbmFnZXIuYWNjZXNzVG9rZW4gPSBhY2Nlc3NUb2tlbjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZXhwaXJhdGlvblRpbWUpIHtcbiAgICAgICAgICAgIF9hc3NlcnQodHlwZW9mIGV4cGlyYXRpb25UaW1lID09PSAnbnVtYmVyJywgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8sIHtcbiAgICAgICAgICAgICAgICBhcHBOYW1lXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG1hbmFnZXIuZXhwaXJhdGlvblRpbWUgPSBleHBpcmF0aW9uVGltZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWFuYWdlcjtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVmcmVzaFRva2VuOiB0aGlzLnJlZnJlc2hUb2tlbixcbiAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiB0aGlzLmFjY2Vzc1Rva2VuLFxuICAgICAgICAgICAgZXhwaXJhdGlvblRpbWU6IHRoaXMuZXhwaXJhdGlvblRpbWVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgX2Fzc2lnbihzdHNUb2tlbk1hbmFnZXIpIHtcbiAgICAgICAgdGhpcy5hY2Nlc3NUb2tlbiA9IHN0c1Rva2VuTWFuYWdlci5hY2Nlc3NUb2tlbjtcbiAgICAgICAgdGhpcy5yZWZyZXNoVG9rZW4gPSBzdHNUb2tlbk1hbmFnZXIucmVmcmVzaFRva2VuO1xuICAgICAgICB0aGlzLmV4cGlyYXRpb25UaW1lID0gc3RzVG9rZW5NYW5hZ2VyLmV4cGlyYXRpb25UaW1lO1xuICAgIH1cbiAgICBfY2xvbmUoKSB7XG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKG5ldyBTdHNUb2tlbk1hbmFnZXIoKSwgdGhpcy50b0pTT04oKSk7XG4gICAgfVxuICAgIF9wZXJmb3JtUmVmcmVzaCgpIHtcbiAgICAgICAgcmV0dXJuIGRlYnVnRmFpbCgnbm90IGltcGxlbWVudGVkJyk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuZnVuY3Rpb24gYXNzZXJ0U3RyaW5nT3JVbmRlZmluZWQoYXNzZXJ0aW9uLCBhcHBOYW1lKSB7XG4gICAgX2Fzc2VydCh0eXBlb2YgYXNzZXJ0aW9uID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgYXNzZXJ0aW9uID09PSAndW5kZWZpbmVkJywgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8sIHsgYXBwTmFtZSB9KTtcbn1cbmNsYXNzIFVzZXJJbXBsIHtcbiAgICBjb25zdHJ1Y3Rvcih7IHVpZCwgYXV0aCwgc3RzVG9rZW5NYW5hZ2VyLCAuLi5vcHQgfSkge1xuICAgICAgICAvLyBGb3IgdGhlIHVzZXIgb2JqZWN0LCBwcm92aWRlciBpcyBhbHdheXMgRmlyZWJhc2UuXG4gICAgICAgIHRoaXMucHJvdmlkZXJJZCA9IFwiZmlyZWJhc2VcIiAvKiBQcm92aWRlcklkLkZJUkVCQVNFICovO1xuICAgICAgICB0aGlzLnByb2FjdGl2ZVJlZnJlc2ggPSBuZXcgUHJvYWN0aXZlUmVmcmVzaCh0aGlzKTtcbiAgICAgICAgdGhpcy5yZWxvYWRVc2VySW5mbyA9IG51bGw7XG4gICAgICAgIHRoaXMucmVsb2FkTGlzdGVuZXIgPSBudWxsO1xuICAgICAgICB0aGlzLnVpZCA9IHVpZDtcbiAgICAgICAgdGhpcy5hdXRoID0gYXV0aDtcbiAgICAgICAgdGhpcy5zdHNUb2tlbk1hbmFnZXIgPSBzdHNUb2tlbk1hbmFnZXI7XG4gICAgICAgIHRoaXMuYWNjZXNzVG9rZW4gPSBzdHNUb2tlbk1hbmFnZXIuYWNjZXNzVG9rZW47XG4gICAgICAgIHRoaXMuZGlzcGxheU5hbWUgPSBvcHQuZGlzcGxheU5hbWUgfHwgbnVsbDtcbiAgICAgICAgdGhpcy5lbWFpbCA9IG9wdC5lbWFpbCB8fCBudWxsO1xuICAgICAgICB0aGlzLmVtYWlsVmVyaWZpZWQgPSBvcHQuZW1haWxWZXJpZmllZCB8fCBmYWxzZTtcbiAgICAgICAgdGhpcy5waG9uZU51bWJlciA9IG9wdC5waG9uZU51bWJlciB8fCBudWxsO1xuICAgICAgICB0aGlzLnBob3RvVVJMID0gb3B0LnBob3RvVVJMIHx8IG51bGw7XG4gICAgICAgIHRoaXMuaXNBbm9ueW1vdXMgPSBvcHQuaXNBbm9ueW1vdXMgfHwgZmFsc2U7XG4gICAgICAgIHRoaXMudGVuYW50SWQgPSBvcHQudGVuYW50SWQgfHwgbnVsbDtcbiAgICAgICAgdGhpcy5wcm92aWRlckRhdGEgPSBvcHQucHJvdmlkZXJEYXRhID8gWy4uLm9wdC5wcm92aWRlckRhdGFdIDogW107XG4gICAgICAgIHRoaXMubWV0YWRhdGEgPSBuZXcgVXNlck1ldGFkYXRhKG9wdC5jcmVhdGVkQXQgfHwgdW5kZWZpbmVkLCBvcHQubGFzdExvZ2luQXQgfHwgdW5kZWZpbmVkKTtcbiAgICB9XG4gICAgYXN5bmMgZ2V0SWRUb2tlbihmb3JjZVJlZnJlc2gpIHtcbiAgICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCBfbG9nb3V0SWZJbnZhbGlkYXRlZCh0aGlzLCB0aGlzLnN0c1Rva2VuTWFuYWdlci5nZXRUb2tlbih0aGlzLmF1dGgsIGZvcmNlUmVmcmVzaCkpO1xuICAgICAgICBfYXNzZXJ0KGFjY2Vzc1Rva2VuLCB0aGlzLmF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgaWYgKHRoaXMuYWNjZXNzVG9rZW4gIT09IGFjY2Vzc1Rva2VuKSB7XG4gICAgICAgICAgICB0aGlzLmFjY2Vzc1Rva2VuID0gYWNjZXNzVG9rZW47XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmF1dGguX3BlcnNpc3RVc2VySWZDdXJyZW50KHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5hdXRoLl9ub3RpZnlMaXN0ZW5lcnNJZkN1cnJlbnQodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFjY2Vzc1Rva2VuO1xuICAgIH1cbiAgICBnZXRJZFRva2VuUmVzdWx0KGZvcmNlUmVmcmVzaCkge1xuICAgICAgICByZXR1cm4gZ2V0SWRUb2tlblJlc3VsdCh0aGlzLCBmb3JjZVJlZnJlc2gpO1xuICAgIH1cbiAgICByZWxvYWQoKSB7XG4gICAgICAgIHJldHVybiByZWxvYWQodGhpcyk7XG4gICAgfVxuICAgIF9hc3NpZ24odXNlcikge1xuICAgICAgICBpZiAodGhpcyA9PT0gdXNlcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIF9hc3NlcnQodGhpcy51aWQgPT09IHVzZXIudWlkLCB0aGlzLmF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgdGhpcy5kaXNwbGF5TmFtZSA9IHVzZXIuZGlzcGxheU5hbWU7XG4gICAgICAgIHRoaXMucGhvdG9VUkwgPSB1c2VyLnBob3RvVVJMO1xuICAgICAgICB0aGlzLmVtYWlsID0gdXNlci5lbWFpbDtcbiAgICAgICAgdGhpcy5lbWFpbFZlcmlmaWVkID0gdXNlci5lbWFpbFZlcmlmaWVkO1xuICAgICAgICB0aGlzLnBob25lTnVtYmVyID0gdXNlci5waG9uZU51bWJlcjtcbiAgICAgICAgdGhpcy5pc0Fub255bW91cyA9IHVzZXIuaXNBbm9ueW1vdXM7XG4gICAgICAgIHRoaXMudGVuYW50SWQgPSB1c2VyLnRlbmFudElkO1xuICAgICAgICB0aGlzLnByb3ZpZGVyRGF0YSA9IHVzZXIucHJvdmlkZXJEYXRhLm1hcCh1c2VySW5mbyA9PiAoeyAuLi51c2VySW5mbyB9KSk7XG4gICAgICAgIHRoaXMubWV0YWRhdGEuX2NvcHkodXNlci5tZXRhZGF0YSk7XG4gICAgICAgIHRoaXMuc3RzVG9rZW5NYW5hZ2VyLl9hc3NpZ24odXNlci5zdHNUb2tlbk1hbmFnZXIpO1xuICAgIH1cbiAgICBfY2xvbmUoYXV0aCkge1xuICAgICAgICBjb25zdCBuZXdVc2VyID0gbmV3IFVzZXJJbXBsKHtcbiAgICAgICAgICAgIC4uLnRoaXMsXG4gICAgICAgICAgICBhdXRoLFxuICAgICAgICAgICAgc3RzVG9rZW5NYW5hZ2VyOiB0aGlzLnN0c1Rva2VuTWFuYWdlci5fY2xvbmUoKVxuICAgICAgICB9KTtcbiAgICAgICAgbmV3VXNlci5tZXRhZGF0YS5fY29weSh0aGlzLm1ldGFkYXRhKTtcbiAgICAgICAgcmV0dXJuIG5ld1VzZXI7XG4gICAgfVxuICAgIF9vblJlbG9hZChjYWxsYmFjaykge1xuICAgICAgICAvLyBUaGVyZSBzaG91bGQgb25seSBldmVyIGJlIG9uZSBsaXN0ZW5lciwgYW5kIHRoYXQgaXMgYSBzaW5nbGUgaW5zdGFuY2Ugb2YgTXVsdGlGYWN0b3JVc2VyXG4gICAgICAgIF9hc3NlcnQoIXRoaXMucmVsb2FkTGlzdGVuZXIsIHRoaXMuYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgICAgICB0aGlzLnJlbG9hZExpc3RlbmVyID0gY2FsbGJhY2s7XG4gICAgICAgIGlmICh0aGlzLnJlbG9hZFVzZXJJbmZvKSB7XG4gICAgICAgICAgICB0aGlzLl9ub3RpZnlSZWxvYWRMaXN0ZW5lcih0aGlzLnJlbG9hZFVzZXJJbmZvKTtcbiAgICAgICAgICAgIHRoaXMucmVsb2FkVXNlckluZm8gPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9ub3RpZnlSZWxvYWRMaXN0ZW5lcih1c2VySW5mbykge1xuICAgICAgICBpZiAodGhpcy5yZWxvYWRMaXN0ZW5lcikge1xuICAgICAgICAgICAgdGhpcy5yZWxvYWRMaXN0ZW5lcih1c2VySW5mbyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBJZiBubyBsaXN0ZW5lciBpcyBzdWJzY3JpYmVkIHlldCwgc2F2ZSB0aGUgcmVzdWx0IHNvIGl0J3MgYXZhaWxhYmxlIHdoZW4gdGhleSBkbyBzdWJzY3JpYmVcbiAgICAgICAgICAgIHRoaXMucmVsb2FkVXNlckluZm8gPSB1c2VySW5mbztcbiAgICAgICAgfVxuICAgIH1cbiAgICBfc3RhcnRQcm9hY3RpdmVSZWZyZXNoKCkge1xuICAgICAgICB0aGlzLnByb2FjdGl2ZVJlZnJlc2guX3N0YXJ0KCk7XG4gICAgfVxuICAgIF9zdG9wUHJvYWN0aXZlUmVmcmVzaCgpIHtcbiAgICAgICAgdGhpcy5wcm9hY3RpdmVSZWZyZXNoLl9zdG9wKCk7XG4gICAgfVxuICAgIGFzeW5jIF91cGRhdGVUb2tlbnNJZk5lY2Vzc2FyeShyZXNwb25zZSwgcmVsb2FkID0gZmFsc2UpIHtcbiAgICAgICAgbGV0IHRva2Vuc1JlZnJlc2hlZCA9IGZhbHNlO1xuICAgICAgICBpZiAocmVzcG9uc2UuaWRUb2tlbiAmJlxuICAgICAgICAgICAgcmVzcG9uc2UuaWRUb2tlbiAhPT0gdGhpcy5zdHNUb2tlbk1hbmFnZXIuYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgICAgIHRoaXMuc3RzVG9rZW5NYW5hZ2VyLnVwZGF0ZUZyb21TZXJ2ZXJSZXNwb25zZShyZXNwb25zZSk7XG4gICAgICAgICAgICB0b2tlbnNSZWZyZXNoZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZWxvYWQpIHtcbiAgICAgICAgICAgIGF3YWl0IF9yZWxvYWRXaXRob3V0U2F2aW5nKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIGF3YWl0IHRoaXMuYXV0aC5fcGVyc2lzdFVzZXJJZkN1cnJlbnQodGhpcyk7XG4gICAgICAgIGlmICh0b2tlbnNSZWZyZXNoZWQpIHtcbiAgICAgICAgICAgIHRoaXMuYXV0aC5fbm90aWZ5TGlzdGVuZXJzSWZDdXJyZW50KHRoaXMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFzeW5jIGRlbGV0ZSgpIHtcbiAgICAgICAgaWYgKF9pc0ZpcmViYXNlU2VydmVyQXBwKHRoaXMuYXV0aC5hcHApKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoX3NlcnZlckFwcEN1cnJlbnRVc2VyT3BlcmF0aW9uTm90U3VwcG9ydGVkRXJyb3IodGhpcy5hdXRoKSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaWRUb2tlbiA9IGF3YWl0IHRoaXMuZ2V0SWRUb2tlbigpO1xuICAgICAgICBhd2FpdCBfbG9nb3V0SWZJbnZhbGlkYXRlZCh0aGlzLCBkZWxldGVBY2NvdW50KHRoaXMuYXV0aCwgeyBpZFRva2VuIH0pKTtcbiAgICAgICAgdGhpcy5zdHNUb2tlbk1hbmFnZXIuY2xlYXJSZWZyZXNoVG9rZW4oKTtcbiAgICAgICAgLy8gVE9ETzogRGV0ZXJtaW5lIGlmIGNhbmNlbGxhYmxlLXByb21pc2VzIGFyZSBuZWNlc3NhcnkgdG8gdXNlIGluIHRoaXMgY2xhc3Mgc28gdGhhdCBkZWxldGUoKVxuICAgICAgICAvLyAgICAgICBjYW5jZWxzIHBlbmRpbmcgYWN0aW9ucy4uLlxuICAgICAgICByZXR1cm4gdGhpcy5hdXRoLnNpZ25PdXQoKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdWlkOiB0aGlzLnVpZCxcbiAgICAgICAgICAgIGVtYWlsOiB0aGlzLmVtYWlsIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRoaXMuZW1haWxWZXJpZmllZCxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiB0aGlzLmRpc3BsYXlOYW1lIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGlzQW5vbnltb3VzOiB0aGlzLmlzQW5vbnltb3VzLFxuICAgICAgICAgICAgcGhvdG9VUkw6IHRoaXMucGhvdG9VUkwgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgcGhvbmVOdW1iZXI6IHRoaXMucGhvbmVOdW1iZXIgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgdGVuYW50SWQ6IHRoaXMudGVuYW50SWQgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgcHJvdmlkZXJEYXRhOiB0aGlzLnByb3ZpZGVyRGF0YS5tYXAodXNlckluZm8gPT4gKHsgLi4udXNlckluZm8gfSkpLFxuICAgICAgICAgICAgc3RzVG9rZW5NYW5hZ2VyOiB0aGlzLnN0c1Rva2VuTWFuYWdlci50b0pTT04oKSxcbiAgICAgICAgICAgIC8vIFJlZGlyZWN0IGV2ZW50IElEIG11c3QgYmUgbWFpbnRhaW5lZCBpbiBjYXNlIHRoZXJlIGlzIGEgcGVuZGluZ1xuICAgICAgICAgICAgLy8gcmVkaXJlY3QgZXZlbnQuXG4gICAgICAgICAgICBfcmVkaXJlY3RFdmVudElkOiB0aGlzLl9yZWRpcmVjdEV2ZW50SWQsXG4gICAgICAgICAgICAuLi50aGlzLm1ldGFkYXRhLnRvSlNPTigpLFxuICAgICAgICAgICAgLy8gUmVxdWlyZWQgZm9yIGNvbXBhdGliaWxpdHkgd2l0aCB0aGUgbGVnYWN5IFNESyAoZ28vZmlyZWJhc2UtYXV0aC1zZGstcGVyc2lzdGVuY2UtcGFyc2luZyk6XG4gICAgICAgICAgICBhcGlLZXk6IHRoaXMuYXV0aC5jb25maWcuYXBpS2V5LFxuICAgICAgICAgICAgYXBwTmFtZTogdGhpcy5hdXRoLm5hbWVcbiAgICAgICAgICAgIC8vIE1pc3NpbmcgYXV0aERvbWFpbiB3aWxsIGJlIHRvbGVyYXRlZCBieSB0aGUgbGVnYWN5IFNESy5cbiAgICAgICAgICAgIC8vIHN0c1Rva2VuTWFuYWdlci5hcGlLZXkgaXNuJ3QgYWN0dWFsbHkgcmVxdWlyZWQgKGRlc3BpdGUgdGhlIGxlZ2FjeSBTREsgcGVyc2lzdGluZyBpdCkuXG4gICAgICAgIH07XG4gICAgfVxuICAgIGdldCByZWZyZXNoVG9rZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0c1Rva2VuTWFuYWdlci5yZWZyZXNoVG9rZW4gfHwgJyc7XG4gICAgfVxuICAgIHN0YXRpYyBfZnJvbUpTT04oYXV0aCwgb2JqZWN0KSB7XG4gICAgICAgIGNvbnN0IGRpc3BsYXlOYW1lID0gb2JqZWN0LmRpc3BsYXlOYW1lID8/IHVuZGVmaW5lZDtcbiAgICAgICAgY29uc3QgZW1haWwgPSBvYmplY3QuZW1haWwgPz8gdW5kZWZpbmVkO1xuICAgICAgICBjb25zdCBwaG9uZU51bWJlciA9IG9iamVjdC5waG9uZU51bWJlciA/PyB1bmRlZmluZWQ7XG4gICAgICAgIGNvbnN0IHBob3RvVVJMID0gb2JqZWN0LnBob3RvVVJMID8/IHVuZGVmaW5lZDtcbiAgICAgICAgY29uc3QgdGVuYW50SWQgPSBvYmplY3QudGVuYW50SWQgPz8gdW5kZWZpbmVkO1xuICAgICAgICBjb25zdCBfcmVkaXJlY3RFdmVudElkID0gb2JqZWN0Ll9yZWRpcmVjdEV2ZW50SWQgPz8gdW5kZWZpbmVkO1xuICAgICAgICBjb25zdCBjcmVhdGVkQXQgPSBvYmplY3QuY3JlYXRlZEF0ID8/IHVuZGVmaW5lZDtcbiAgICAgICAgY29uc3QgbGFzdExvZ2luQXQgPSBvYmplY3QubGFzdExvZ2luQXQgPz8gdW5kZWZpbmVkO1xuICAgICAgICBjb25zdCB7IHVpZCwgZW1haWxWZXJpZmllZCwgaXNBbm9ueW1vdXMsIHByb3ZpZGVyRGF0YSwgc3RzVG9rZW5NYW5hZ2VyOiBwbGFpbk9iamVjdFRva2VuTWFuYWdlciB9ID0gb2JqZWN0O1xuICAgICAgICBfYXNzZXJ0KHVpZCAmJiBwbGFpbk9iamVjdFRva2VuTWFuYWdlciwgYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgICAgICBjb25zdCBzdHNUb2tlbk1hbmFnZXIgPSBTdHNUb2tlbk1hbmFnZXIuZnJvbUpTT04odGhpcy5uYW1lLCBwbGFpbk9iamVjdFRva2VuTWFuYWdlcik7XG4gICAgICAgIF9hc3NlcnQodHlwZW9mIHVpZCA9PT0gJ3N0cmluZycsIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgYXNzZXJ0U3RyaW5nT3JVbmRlZmluZWQoZGlzcGxheU5hbWUsIGF1dGgubmFtZSk7XG4gICAgICAgIGFzc2VydFN0cmluZ09yVW5kZWZpbmVkKGVtYWlsLCBhdXRoLm5hbWUpO1xuICAgICAgICBfYXNzZXJ0KHR5cGVvZiBlbWFpbFZlcmlmaWVkID09PSAnYm9vbGVhbicsIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgX2Fzc2VydCh0eXBlb2YgaXNBbm9ueW1vdXMgPT09ICdib29sZWFuJywgYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgICAgICBhc3NlcnRTdHJpbmdPclVuZGVmaW5lZChwaG9uZU51bWJlciwgYXV0aC5uYW1lKTtcbiAgICAgICAgYXNzZXJ0U3RyaW5nT3JVbmRlZmluZWQocGhvdG9VUkwsIGF1dGgubmFtZSk7XG4gICAgICAgIGFzc2VydFN0cmluZ09yVW5kZWZpbmVkKHRlbmFudElkLCBhdXRoLm5hbWUpO1xuICAgICAgICBhc3NlcnRTdHJpbmdPclVuZGVmaW5lZChfcmVkaXJlY3RFdmVudElkLCBhdXRoLm5hbWUpO1xuICAgICAgICBhc3NlcnRTdHJpbmdPclVuZGVmaW5lZChjcmVhdGVkQXQsIGF1dGgubmFtZSk7XG4gICAgICAgIGFzc2VydFN0cmluZ09yVW5kZWZpbmVkKGxhc3RMb2dpbkF0LCBhdXRoLm5hbWUpO1xuICAgICAgICBjb25zdCB1c2VyID0gbmV3IFVzZXJJbXBsKHtcbiAgICAgICAgICAgIHVpZCxcbiAgICAgICAgICAgIGF1dGgsXG4gICAgICAgICAgICBlbWFpbCxcbiAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZSxcbiAgICAgICAgICAgIGlzQW5vbnltb3VzLFxuICAgICAgICAgICAgcGhvdG9VUkwsXG4gICAgICAgICAgICBwaG9uZU51bWJlcixcbiAgICAgICAgICAgIHRlbmFudElkLFxuICAgICAgICAgICAgc3RzVG9rZW5NYW5hZ2VyLFxuICAgICAgICAgICAgY3JlYXRlZEF0LFxuICAgICAgICAgICAgbGFzdExvZ2luQXRcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChwcm92aWRlckRhdGEgJiYgQXJyYXkuaXNBcnJheShwcm92aWRlckRhdGEpKSB7XG4gICAgICAgICAgICB1c2VyLnByb3ZpZGVyRGF0YSA9IHByb3ZpZGVyRGF0YS5tYXAodXNlckluZm8gPT4gKHsgLi4udXNlckluZm8gfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChfcmVkaXJlY3RFdmVudElkKSB7XG4gICAgICAgICAgICB1c2VyLl9yZWRpcmVjdEV2ZW50SWQgPSBfcmVkaXJlY3RFdmVudElkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1c2VyO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplIGEgVXNlciBmcm9tIGFuIGlkVG9rZW4gc2VydmVyIHJlc3BvbnNlXG4gICAgICogQHBhcmFtIGF1dGhcbiAgICAgKiBAcGFyYW0gaWRUb2tlblJlc3BvbnNlXG4gICAgICovXG4gICAgc3RhdGljIGFzeW5jIF9mcm9tSWRUb2tlblJlc3BvbnNlKGF1dGgsIGlkVG9rZW5SZXNwb25zZSwgaXNBbm9ueW1vdXMgPSBmYWxzZSkge1xuICAgICAgICBjb25zdCBzdHNUb2tlbk1hbmFnZXIgPSBuZXcgU3RzVG9rZW5NYW5hZ2VyKCk7XG4gICAgICAgIHN0c1Rva2VuTWFuYWdlci51cGRhdGVGcm9tU2VydmVyUmVzcG9uc2UoaWRUb2tlblJlc3BvbnNlKTtcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgRmlyZWJhc2UgQXV0aCB1c2VyLlxuICAgICAgICBjb25zdCB1c2VyID0gbmV3IFVzZXJJbXBsKHtcbiAgICAgICAgICAgIHVpZDogaWRUb2tlblJlc3BvbnNlLmxvY2FsSWQsXG4gICAgICAgICAgICBhdXRoLFxuICAgICAgICAgICAgc3RzVG9rZW5NYW5hZ2VyLFxuICAgICAgICAgICAgaXNBbm9ueW1vdXNcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIFVwZGF0ZXMgdGhlIHVzZXIgaW5mbyBhbmQgZGF0YSBhbmQgcmVzb2x2ZXMgd2l0aCBhIHVzZXIgaW5zdGFuY2UuXG4gICAgICAgIGF3YWl0IF9yZWxvYWRXaXRob3V0U2F2aW5nKHVzZXIpO1xuICAgICAgICByZXR1cm4gdXNlcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZSBhIFVzZXIgZnJvbSBhbiBpZFRva2VuIHNlcnZlciByZXNwb25zZVxuICAgICAqIEBwYXJhbSBhdXRoXG4gICAgICogQHBhcmFtIGlkVG9rZW5SZXNwb25zZVxuICAgICAqL1xuICAgIHN0YXRpYyBhc3luYyBfZnJvbUdldEFjY291bnRJbmZvUmVzcG9uc2UoYXV0aCwgcmVzcG9uc2UsIGlkVG9rZW4pIHtcbiAgICAgICAgY29uc3QgY29yZUFjY291bnQgPSByZXNwb25zZS51c2Vyc1swXTtcbiAgICAgICAgX2Fzc2VydChjb3JlQWNjb3VudC5sb2NhbElkICE9PSB1bmRlZmluZWQsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgY29uc3QgcHJvdmlkZXJEYXRhID0gY29yZUFjY291bnQucHJvdmlkZXJVc2VySW5mbyAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICA/IGV4dHJhY3RQcm92aWRlckRhdGEoY29yZUFjY291bnQucHJvdmlkZXJVc2VySW5mbylcbiAgICAgICAgICAgIDogW107XG4gICAgICAgIGNvbnN0IGlzQW5vbnltb3VzID0gIShjb3JlQWNjb3VudC5lbWFpbCAmJiBjb3JlQWNjb3VudC5wYXNzd29yZEhhc2gpICYmICFwcm92aWRlckRhdGE/Lmxlbmd0aDtcbiAgICAgICAgY29uc3Qgc3RzVG9rZW5NYW5hZ2VyID0gbmV3IFN0c1Rva2VuTWFuYWdlcigpO1xuICAgICAgICBzdHNUb2tlbk1hbmFnZXIudXBkYXRlRnJvbUlkVG9rZW4oaWRUb2tlbik7XG4gICAgICAgIC8vIEluaXRpYWxpemUgdGhlIEZpcmViYXNlIEF1dGggdXNlci5cbiAgICAgICAgY29uc3QgdXNlciA9IG5ldyBVc2VySW1wbCh7XG4gICAgICAgICAgICB1aWQ6IGNvcmVBY2NvdW50LmxvY2FsSWQsXG4gICAgICAgICAgICBhdXRoLFxuICAgICAgICAgICAgc3RzVG9rZW5NYW5hZ2VyLFxuICAgICAgICAgICAgaXNBbm9ueW1vdXNcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIHVwZGF0ZSB0aGUgdXNlciB3aXRoIGRhdGEgZnJvbSB0aGUgR2V0QWNjb3VudEluZm8gcmVzcG9uc2UuXG4gICAgICAgIGNvbnN0IHVwZGF0ZXMgPSB7XG4gICAgICAgICAgICB1aWQ6IGNvcmVBY2NvdW50LmxvY2FsSWQsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogY29yZUFjY291bnQuZGlzcGxheU5hbWUgfHwgbnVsbCxcbiAgICAgICAgICAgIHBob3RvVVJMOiBjb3JlQWNjb3VudC5waG90b1VybCB8fCBudWxsLFxuICAgICAgICAgICAgZW1haWw6IGNvcmVBY2NvdW50LmVtYWlsIHx8IG51bGwsXG4gICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBjb3JlQWNjb3VudC5lbWFpbFZlcmlmaWVkIHx8IGZhbHNlLFxuICAgICAgICAgICAgcGhvbmVOdW1iZXI6IGNvcmVBY2NvdW50LnBob25lTnVtYmVyIHx8IG51bGwsXG4gICAgICAgICAgICB0ZW5hbnRJZDogY29yZUFjY291bnQudGVuYW50SWQgfHwgbnVsbCxcbiAgICAgICAgICAgIHByb3ZpZGVyRGF0YSxcbiAgICAgICAgICAgIG1ldGFkYXRhOiBuZXcgVXNlck1ldGFkYXRhKGNvcmVBY2NvdW50LmNyZWF0ZWRBdCwgY29yZUFjY291bnQubGFzdExvZ2luQXQpLFxuICAgICAgICAgICAgaXNBbm9ueW1vdXM6ICEoY29yZUFjY291bnQuZW1haWwgJiYgY29yZUFjY291bnQucGFzc3dvcmRIYXNoKSAmJlxuICAgICAgICAgICAgICAgICFwcm92aWRlckRhdGE/Lmxlbmd0aFxuICAgICAgICB9O1xuICAgICAgICBPYmplY3QuYXNzaWduKHVzZXIsIHVwZGF0ZXMpO1xuICAgICAgICByZXR1cm4gdXNlcjtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jb25zdCBpbnN0YW5jZUNhY2hlID0gbmV3IE1hcCgpO1xuZnVuY3Rpb24gX2dldEluc3RhbmNlKGNscykge1xuICAgIGRlYnVnQXNzZXJ0KGNscyBpbnN0YW5jZW9mIEZ1bmN0aW9uLCAnRXhwZWN0ZWQgYSBjbGFzcyBkZWZpbml0aW9uJyk7XG4gICAgbGV0IGluc3RhbmNlID0gaW5zdGFuY2VDYWNoZS5nZXQoY2xzKTtcbiAgICBpZiAoaW5zdGFuY2UpIHtcbiAgICAgICAgZGVidWdBc3NlcnQoaW5zdGFuY2UgaW5zdGFuY2VvZiBjbHMsICdJbnN0YW5jZSBzdG9yZWQgaW4gY2FjaGUgbWlzbWF0Y2hlZCB3aXRoIGNsYXNzJyk7XG4gICAgICAgIHJldHVybiBpbnN0YW5jZTtcbiAgICB9XG4gICAgaW5zdGFuY2UgPSBuZXcgY2xzKCk7XG4gICAgaW5zdGFuY2VDYWNoZS5zZXQoY2xzLCBpbnN0YW5jZSk7XG4gICAgcmV0dXJuIGluc3RhbmNlO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3MgSW5NZW1vcnlQZXJzaXN0ZW5jZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMudHlwZSA9IFwiTk9ORVwiIC8qIFBlcnNpc3RlbmNlVHlwZS5OT05FICovO1xuICAgICAgICB0aGlzLnN0b3JhZ2UgPSB7fTtcbiAgICB9XG4gICAgYXN5bmMgX2lzQXZhaWxhYmxlKCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgYXN5bmMgX3NldChrZXksIHZhbHVlKSB7XG4gICAgICAgIHRoaXMuc3RvcmFnZVtrZXldID0gdmFsdWU7XG4gICAgfVxuICAgIGFzeW5jIF9nZXQoa2V5KSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5zdG9yYWdlW2tleV07XG4gICAgICAgIHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IHZhbHVlO1xuICAgIH1cbiAgICBhc3luYyBfcmVtb3ZlKGtleSkge1xuICAgICAgICBkZWxldGUgdGhpcy5zdG9yYWdlW2tleV07XG4gICAgfVxuICAgIF9hZGRMaXN0ZW5lcihfa2V5LCBfbGlzdGVuZXIpIHtcbiAgICAgICAgLy8gTGlzdGVuZXJzIGFyZSBub3Qgc3VwcG9ydGVkIGZvciBpbi1tZW1vcnkgc3RvcmFnZSBzaW5jZSBpdCBjYW5ub3QgYmUgc2hhcmVkIGFjcm9zcyB3aW5kb3dzL3dvcmtlcnNcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBfcmVtb3ZlTGlzdGVuZXIoX2tleSwgX2xpc3RlbmVyKSB7XG4gICAgICAgIC8vIExpc3RlbmVycyBhcmUgbm90IHN1cHBvcnRlZCBmb3IgaW4tbWVtb3J5IHN0b3JhZ2Ugc2luY2UgaXQgY2Fubm90IGJlIHNoYXJlZCBhY3Jvc3Mgd2luZG93cy93b3JrZXJzXG4gICAgICAgIHJldHVybjtcbiAgICB9XG59XG5Jbk1lbW9yeVBlcnNpc3RlbmNlLnR5cGUgPSAnTk9ORSc7XG4vKipcbiAqIEFuIGltcGxlbWVudGF0aW9uIG9mIHtAbGluayBQZXJzaXN0ZW5jZX0gb2YgdHlwZSAnTk9ORScuXG4gKlxuICogQHB1YmxpY1xuICovXG5jb25zdCBpbk1lbW9yeVBlcnNpc3RlbmNlID0gSW5NZW1vcnlQZXJzaXN0ZW5jZTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmZ1bmN0aW9uIF9wZXJzaXN0ZW5jZUtleU5hbWUoa2V5LCBhcGlLZXksIGFwcE5hbWUpIHtcbiAgICByZXR1cm4gYCR7XCJmaXJlYmFzZVwiIC8qIE5hbWVzcGFjZS5QRVJTSVNURU5DRSAqL306JHtrZXl9OiR7YXBpS2V5fToke2FwcE5hbWV9YDtcbn1cbmNsYXNzIFBlcnNpc3RlbmNlVXNlck1hbmFnZXIge1xuICAgIGNvbnN0cnVjdG9yKHBlcnNpc3RlbmNlLCBhdXRoLCB1c2VyS2V5KSB7XG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UgPSBwZXJzaXN0ZW5jZTtcbiAgICAgICAgdGhpcy5hdXRoID0gYXV0aDtcbiAgICAgICAgdGhpcy51c2VyS2V5ID0gdXNlcktleTtcbiAgICAgICAgY29uc3QgeyBjb25maWcsIG5hbWUgfSA9IHRoaXMuYXV0aDtcbiAgICAgICAgdGhpcy5mdWxsVXNlcktleSA9IF9wZXJzaXN0ZW5jZUtleU5hbWUodGhpcy51c2VyS2V5LCBjb25maWcuYXBpS2V5LCBuYW1lKTtcbiAgICAgICAgdGhpcy5mdWxsUGVyc2lzdGVuY2VLZXkgPSBfcGVyc2lzdGVuY2VLZXlOYW1lKFwicGVyc2lzdGVuY2VcIiAvKiBLZXlOYW1lLlBFUlNJU1RFTkNFX1VTRVIgKi8sIGNvbmZpZy5hcGlLZXksIG5hbWUpO1xuICAgICAgICB0aGlzLmJvdW5kRXZlbnRIYW5kbGVyID0gYXV0aC5fb25TdG9yYWdlRXZlbnQuYmluZChhdXRoKTtcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZS5fYWRkTGlzdGVuZXIodGhpcy5mdWxsVXNlcktleSwgdGhpcy5ib3VuZEV2ZW50SGFuZGxlcik7XG4gICAgfVxuICAgIHNldEN1cnJlbnRVc2VyKHVzZXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UuX3NldCh0aGlzLmZ1bGxVc2VyS2V5LCB1c2VyLnRvSlNPTigpKTtcbiAgICB9XG4gICAgYXN5bmMgZ2V0Q3VycmVudFVzZXIoKSB7XG4gICAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCB0aGlzLnBlcnNpc3RlbmNlLl9nZXQodGhpcy5mdWxsVXNlcktleSk7XG4gICAgICAgIGlmICghYmxvYikge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBibG9iID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXRBY2NvdW50SW5mbyh0aGlzLmF1dGgsIHsgaWRUb2tlbjogYmxvYiB9KS5jYXRjaCgoKSA9PiB1bmRlZmluZWQpO1xuICAgICAgICAgICAgaWYgKCFyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFVzZXJJbXBsLl9mcm9tR2V0QWNjb3VudEluZm9SZXNwb25zZSh0aGlzLmF1dGgsIHJlc3BvbnNlLCBibG9iKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gVXNlckltcGwuX2Zyb21KU09OKHRoaXMuYXV0aCwgYmxvYik7XG4gICAgfVxuICAgIHJlbW92ZUN1cnJlbnRVc2VyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5fcmVtb3ZlKHRoaXMuZnVsbFVzZXJLZXkpO1xuICAgIH1cbiAgICBzYXZlUGVyc2lzdGVuY2VGb3JSZWRpcmVjdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UuX3NldCh0aGlzLmZ1bGxQZXJzaXN0ZW5jZUtleSwgdGhpcy5wZXJzaXN0ZW5jZS50eXBlKTtcbiAgICB9XG4gICAgYXN5bmMgc2V0UGVyc2lzdGVuY2UobmV3UGVyc2lzdGVuY2UpIHtcbiAgICAgICAgaWYgKHRoaXMucGVyc2lzdGVuY2UgPT09IG5ld1BlcnNpc3RlbmNlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY3VycmVudFVzZXIgPSBhd2FpdCB0aGlzLmdldEN1cnJlbnRVc2VyKCk7XG4gICAgICAgIGF3YWl0IHRoaXMucmVtb3ZlQ3VycmVudFVzZXIoKTtcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZSA9IG5ld1BlcnNpc3RlbmNlO1xuICAgICAgICBpZiAoY3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldEN1cnJlbnRVc2VyKGN1cnJlbnRVc2VyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkZWxldGUoKSB7XG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UuX3JlbW92ZUxpc3RlbmVyKHRoaXMuZnVsbFVzZXJLZXksIHRoaXMuYm91bmRFdmVudEhhbmRsZXIpO1xuICAgIH1cbiAgICBzdGF0aWMgYXN5bmMgY3JlYXRlKGF1dGgsIHBlcnNpc3RlbmNlSGllcmFyY2h5LCB1c2VyS2V5ID0gXCJhdXRoVXNlclwiIC8qIEtleU5hbWUuQVVUSF9VU0VSICovKSB7XG4gICAgICAgIGlmICghcGVyc2lzdGVuY2VIaWVyYXJjaHkubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFBlcnNpc3RlbmNlVXNlck1hbmFnZXIoX2dldEluc3RhbmNlKGluTWVtb3J5UGVyc2lzdGVuY2UpLCBhdXRoLCB1c2VyS2V5KTtcbiAgICAgICAgfVxuICAgICAgICAvLyBFbGltaW5hdGUgYW55IHBlcnNpc3RlbmNlcyB0aGF0IGFyZSBub3QgYXZhaWxhYmxlXG4gICAgICAgIGNvbnN0IGF2YWlsYWJsZVBlcnNpc3RlbmNlcyA9IChhd2FpdCBQcm9taXNlLmFsbChwZXJzaXN0ZW5jZUhpZXJhcmNoeS5tYXAoYXN5bmMgKHBlcnNpc3RlbmNlKSA9PiB7XG4gICAgICAgICAgICBpZiAoYXdhaXQgcGVyc2lzdGVuY2UuX2lzQXZhaWxhYmxlKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGVyc2lzdGVuY2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9KSkpLmZpbHRlcihwZXJzaXN0ZW5jZSA9PiBwZXJzaXN0ZW5jZSk7XG4gICAgICAgIC8vIEZhbGwgYmFjayB0byB0aGUgZmlyc3QgcGVyc2lzdGVuY2UgbGlzdGVkLCBvciBpbiBtZW1vcnkgaWYgbm9uZSBhdmFpbGFibGVcbiAgICAgICAgbGV0IHNlbGVjdGVkUGVyc2lzdGVuY2UgPSBhdmFpbGFibGVQZXJzaXN0ZW5jZXNbMF0gfHxcbiAgICAgICAgICAgIF9nZXRJbnN0YW5jZShpbk1lbW9yeVBlcnNpc3RlbmNlKTtcbiAgICAgICAgY29uc3Qga2V5ID0gX3BlcnNpc3RlbmNlS2V5TmFtZSh1c2VyS2V5LCBhdXRoLmNvbmZpZy5hcGlLZXksIGF1dGgubmFtZSk7XG4gICAgICAgIC8vIFB1bGwgb3V0IHRoZSBleGlzdGluZyB1c2VyLCBzZXR0aW5nIHRoZSBjaG9zZW4gcGVyc2lzdGVuY2UgdG8gdGhhdFxuICAgICAgICAvLyBwZXJzaXN0ZW5jZSBpZiB0aGUgdXNlciBleGlzdHMuXG4gICAgICAgIGxldCB1c2VyVG9NaWdyYXRlID0gbnVsbDtcbiAgICAgICAgLy8gTm90ZSwgaGVyZSB3ZSBjaGVjayBmb3IgYSB1c2VyIGluIF9hbGxfIHBlcnNpc3RlbmNlcywgbm90IGp1c3QgdGhlXG4gICAgICAgIC8vIG9uZXMgZGVlbWVkIGF2YWlsYWJsZS4gSWYgd2UgY2FuIG1pZ3JhdGUgYSB1c2VyIG91dCBvZiBhIGJyb2tlblxuICAgICAgICAvLyBwZXJzaXN0ZW5jZSwgd2Ugd2lsbCAoYnV0IG9ubHkgaWYgdGhhdCBwZXJzaXN0ZW5jZSBzdXBwb3J0cyBtaWdyYXRpb24pLlxuICAgICAgICBmb3IgKGNvbnN0IHBlcnNpc3RlbmNlIG9mIHBlcnNpc3RlbmNlSGllcmFyY2h5KSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCBwZXJzaXN0ZW5jZS5fZ2V0KGtleSk7XG4gICAgICAgICAgICAgICAgaWYgKGJsb2IpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHVzZXI7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgYmxvYiA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2V0QWNjb3VudEluZm8oYXV0aCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkVG9rZW46IGJsb2JcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyID0gYXdhaXQgVXNlckltcGwuX2Zyb21HZXRBY2NvdW50SW5mb1Jlc3BvbnNlKGF1dGgsIHJlc3BvbnNlLCBibG9iKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIgPSBVc2VySW1wbC5fZnJvbUpTT04oYXV0aCwgYmxvYik7IC8vIHRocm93cyBmb3IgdW5wYXJzYWJsZSBibG9iICh3cm9uZyBmb3JtYXQpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHBlcnNpc3RlbmNlICE9PSBzZWxlY3RlZFBlcnNpc3RlbmNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyVG9NaWdyYXRlID0gdXNlcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZFBlcnNpc3RlbmNlID0gcGVyc2lzdGVuY2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIHsgfVxuICAgICAgICB9XG4gICAgICAgIC8vIElmIHdlIGZpbmQgdGhlIHVzZXIgaW4gYSBwZXJzaXN0ZW5jZSB0aGF0IGRvZXMgc3VwcG9ydCBtaWdyYXRpb24sIHVzZVxuICAgICAgICAvLyB0aGF0IG1pZ3JhdGlvbiBwYXRoIChvZiBvbmx5IHBlcnNpc3RlbmNlcyB0aGF0IHN1cHBvcnQgbWlncmF0aW9uKVxuICAgICAgICBjb25zdCBtaWdyYXRpb25IaWVyYXJjaHkgPSBhdmFpbGFibGVQZXJzaXN0ZW5jZXMuZmlsdGVyKHAgPT4gcC5fc2hvdWxkQWxsb3dNaWdyYXRpb24pO1xuICAgICAgICAvLyBJZiB0aGUgcGVyc2lzdGVuY2UgZG9lcyBfbm90XyBhbGxvdyBtaWdyYXRpb24sIGp1c3QgZmluaXNoIG9mZiBoZXJlXG4gICAgICAgIGlmICghc2VsZWN0ZWRQZXJzaXN0ZW5jZS5fc2hvdWxkQWxsb3dNaWdyYXRpb24gfHxcbiAgICAgICAgICAgICFtaWdyYXRpb25IaWVyYXJjaHkubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFBlcnNpc3RlbmNlVXNlck1hbmFnZXIoc2VsZWN0ZWRQZXJzaXN0ZW5jZSwgYXV0aCwgdXNlcktleSk7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZWN0ZWRQZXJzaXN0ZW5jZSA9IG1pZ3JhdGlvbkhpZXJhcmNoeVswXTtcbiAgICAgICAgaWYgKHVzZXJUb01pZ3JhdGUpIHtcbiAgICAgICAgICAgIC8vIFRoaXMgbm9ybWFsbHkgc2hvdWxkbid0IHRocm93IHNpbmNlIGNob3NlblBlcnNpc3RlbmNlLmlzQXZhaWxhYmxlKCkgaXMgdHJ1ZSwgYnV0IGlmIGl0IGRvZXNcbiAgICAgICAgICAgIC8vIHdlJ2xsIGp1c3QgbGV0IGl0IGJ1YmJsZSB0byBzdXJmYWNlIHRoZSBlcnJvci5cbiAgICAgICAgICAgIGF3YWl0IHNlbGVjdGVkUGVyc2lzdGVuY2UuX3NldChrZXksIHVzZXJUb01pZ3JhdGUudG9KU09OKCkpO1xuICAgICAgICB9XG4gICAgICAgIC8vIEF0dGVtcHQgdG8gY2xlYXIgdGhlIGtleSBpbiBvdGhlciBwZXJzaXN0ZW5jZXMgYnV0IGlnbm9yZSBlcnJvcnMuIFRoaXMgaGVscHMgcHJldmVudCBpc3N1ZXNcbiAgICAgICAgLy8gc3VjaCBhcyB1c2VycyBnZXR0aW5nIHN0dWNrIHdpdGggYSBwcmV2aW91cyBhY2NvdW50IGFmdGVyIHNpZ25pbmcgb3V0IGFuZCByZWZyZXNoaW5nIHRoZSB0YWIuXG4gICAgICAgIGF3YWl0IFByb21pc2UuYWxsKHBlcnNpc3RlbmNlSGllcmFyY2h5Lm1hcChhc3luYyAocGVyc2lzdGVuY2UpID0+IHtcbiAgICAgICAgICAgIGlmIChwZXJzaXN0ZW5jZSAhPT0gc2VsZWN0ZWRQZXJzaXN0ZW5jZSkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHBlcnNpc3RlbmNlLl9yZW1vdmUoa2V5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggeyB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW5jZVVzZXJNYW5hZ2VyKHNlbGVjdGVkUGVyc2lzdGVuY2UsIGF1dGgsIHVzZXJLZXkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogRGV0ZXJtaW5lIHRoZSBicm93c2VyIGZvciB0aGUgcHVycG9zZXMgb2YgcmVwb3J0aW5nIHVzYWdlIHRvIHRoZSBBUElcbiAqL1xuZnVuY3Rpb24gX2dldEJyb3dzZXJOYW1lKHVzZXJBZ2VudCkge1xuICAgIGNvbnN0IHVhID0gdXNlckFnZW50LnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKHVhLmluY2x1ZGVzKCdvcGVyYS8nKSB8fCB1YS5pbmNsdWRlcygnb3ByLycpIHx8IHVhLmluY2x1ZGVzKCdvcGlvcy8nKSkge1xuICAgICAgICByZXR1cm4gXCJPcGVyYVwiIC8qIEJyb3dzZXJOYW1lLk9QRVJBICovO1xuICAgIH1cbiAgICBlbHNlIGlmIChfaXNJRU1vYmlsZSh1YSkpIHtcbiAgICAgICAgLy8gV2luZG93cyBwaG9uZSBJRU1vYmlsZSBicm93c2VyLlxuICAgICAgICByZXR1cm4gXCJJRU1vYmlsZVwiIC8qIEJyb3dzZXJOYW1lLklFTU9CSUxFICovO1xuICAgIH1cbiAgICBlbHNlIGlmICh1YS5pbmNsdWRlcygnbXNpZScpIHx8IHVhLmluY2x1ZGVzKCd0cmlkZW50LycpKSB7XG4gICAgICAgIHJldHVybiBcIklFXCIgLyogQnJvd3Nlck5hbWUuSUUgKi87XG4gICAgfVxuICAgIGVsc2UgaWYgKHVhLmluY2x1ZGVzKCdlZGdlLycpKSB7XG4gICAgICAgIHJldHVybiBcIkVkZ2VcIiAvKiBCcm93c2VyTmFtZS5FREdFICovO1xuICAgIH1cbiAgICBlbHNlIGlmIChfaXNGaXJlZm94KHVhKSkge1xuICAgICAgICByZXR1cm4gXCJGaXJlZm94XCIgLyogQnJvd3Nlck5hbWUuRklSRUZPWCAqLztcbiAgICB9XG4gICAgZWxzZSBpZiAodWEuaW5jbHVkZXMoJ3NpbGsvJykpIHtcbiAgICAgICAgcmV0dXJuIFwiU2lsa1wiIC8qIEJyb3dzZXJOYW1lLlNJTEsgKi87XG4gICAgfVxuICAgIGVsc2UgaWYgKF9pc0JsYWNrQmVycnkodWEpKSB7XG4gICAgICAgIC8vIEJsYWNrYmVycnkgYnJvd3Nlci5cbiAgICAgICAgcmV0dXJuIFwiQmxhY2tiZXJyeVwiIC8qIEJyb3dzZXJOYW1lLkJMQUNLQkVSUlkgKi87XG4gICAgfVxuICAgIGVsc2UgaWYgKF9pc1dlYk9TKHVhKSkge1xuICAgICAgICAvLyBXZWJPUyBkZWZhdWx0IGJyb3dzZXIuXG4gICAgICAgIHJldHVybiBcIldlYm9zXCIgLyogQnJvd3Nlck5hbWUuV0VCT1MgKi87XG4gICAgfVxuICAgIGVsc2UgaWYgKF9pc1NhZmFyaSh1YSkpIHtcbiAgICAgICAgcmV0dXJuIFwiU2FmYXJpXCIgLyogQnJvd3Nlck5hbWUuU0FGQVJJICovO1xuICAgIH1cbiAgICBlbHNlIGlmICgodWEuaW5jbHVkZXMoJ2Nocm9tZS8nKSB8fCBfaXNDaHJvbWVJT1ModWEpKSAmJlxuICAgICAgICAhdWEuaW5jbHVkZXMoJ2VkZ2UvJykpIHtcbiAgICAgICAgcmV0dXJuIFwiQ2hyb21lXCIgLyogQnJvd3Nlck5hbWUuQ0hST01FICovO1xuICAgIH1cbiAgICBlbHNlIGlmIChfaXNBbmRyb2lkKHVhKSkge1xuICAgICAgICAvLyBBbmRyb2lkIHN0b2NrIGJyb3dzZXIuXG4gICAgICAgIHJldHVybiBcIkFuZHJvaWRcIiAvKiBCcm93c2VyTmFtZS5BTkRST0lEICovO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgLy8gTW9zdCBtb2Rlcm4gYnJvd3NlcnMgaGF2ZSBuYW1lL3ZlcnNpb24gYXQgZW5kIG9mIHVzZXIgYWdlbnQgc3RyaW5nLlxuICAgICAgICBjb25zdCByZSA9IC8oW2EtekEtWlxcZFxcLl0rKVxcL1thLXpBLVpcXGRcXC5dKiQvO1xuICAgICAgICBjb25zdCBtYXRjaGVzID0gdXNlckFnZW50Lm1hdGNoKHJlKTtcbiAgICAgICAgaWYgKG1hdGNoZXM/Lmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXNbMV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIFwiT3RoZXJcIiAvKiBCcm93c2VyTmFtZS5PVEhFUiAqLztcbn1cbmZ1bmN0aW9uIF9pc0ZpcmVmb3godWEgPSBnZXRVQSgpKSB7XG4gICAgcmV0dXJuIC9maXJlZm94XFwvL2kudGVzdCh1YSk7XG59XG5mdW5jdGlvbiBfaXNTYWZhcmkodXNlckFnZW50ID0gZ2V0VUEoKSkge1xuICAgIGNvbnN0IHVhID0gdXNlckFnZW50LnRvTG93ZXJDYXNlKCk7XG4gICAgcmV0dXJuICh1YS5pbmNsdWRlcygnc2FmYXJpLycpICYmXG4gICAgICAgICF1YS5pbmNsdWRlcygnY2hyb21lLycpICYmXG4gICAgICAgICF1YS5pbmNsdWRlcygnY3Jpb3MvJykgJiZcbiAgICAgICAgIXVhLmluY2x1ZGVzKCdhbmRyb2lkJykpO1xufVxuZnVuY3Rpb24gX2lzQ2hyb21lSU9TKHVhID0gZ2V0VUEoKSkge1xuICAgIHJldHVybiAvY3Jpb3NcXC8vaS50ZXN0KHVhKTtcbn1cbmZ1bmN0aW9uIF9pc0lFTW9iaWxlKHVhID0gZ2V0VUEoKSkge1xuICAgIHJldHVybiAvaWVtb2JpbGUvaS50ZXN0KHVhKTtcbn1cbmZ1bmN0aW9uIF9pc0FuZHJvaWQodWEgPSBnZXRVQSgpKSB7XG4gICAgcmV0dXJuIC9hbmRyb2lkL2kudGVzdCh1YSk7XG59XG5mdW5jdGlvbiBfaXNCbGFja0JlcnJ5KHVhID0gZ2V0VUEoKSkge1xuICAgIHJldHVybiAvYmxhY2tiZXJyeS9pLnRlc3QodWEpO1xufVxuZnVuY3Rpb24gX2lzV2ViT1ModWEgPSBnZXRVQSgpKSB7XG4gICAgcmV0dXJuIC93ZWJvcy9pLnRlc3QodWEpO1xufVxuZnVuY3Rpb24gX2lzSU9TKHVhID0gZ2V0VUEoKSkge1xuICAgIHJldHVybiAoL2lwaG9uZXxpcGFkfGlwb2QvaS50ZXN0KHVhKSB8fFxuICAgICAgICAoL21hY2ludG9zaC9pLnRlc3QodWEpICYmIC9tb2JpbGUvaS50ZXN0KHVhKSkpO1xufVxuZnVuY3Rpb24gX2lzSU9TN09yOCh1YSA9IGdldFVBKCkpIHtcbiAgICByZXR1cm4gKC8oaVBhZHxpUGhvbmV8aVBvZCkuKk9TIDdfXFxkL2kudGVzdCh1YSkgfHxcbiAgICAgICAgLyhpUGFkfGlQaG9uZXxpUG9kKS4qT1MgOF9cXGQvaS50ZXN0KHVhKSk7XG59XG5mdW5jdGlvbiBfaXNJT1NTdGFuZGFsb25lKHVhID0gZ2V0VUEoKSkge1xuICAgIHJldHVybiBfaXNJT1ModWEpICYmICEhd2luZG93Lm5hdmlnYXRvcj8uc3RhbmRhbG9uZTtcbn1cbmZ1bmN0aW9uIF9pc0lFMTAoKSB7XG4gICAgcmV0dXJuIGlzSUUoKSAmJiBkb2N1bWVudC5kb2N1bWVudE1vZGUgPT09IDEwO1xufVxuZnVuY3Rpb24gX2lzTW9iaWxlQnJvd3Nlcih1YSA9IGdldFVBKCkpIHtcbiAgICAvLyBUT0RPOiBpbXBsZW1lbnQgZ2V0QnJvd3Nlck5hbWUgZXF1aXZhbGVudCBmb3IgT1MuXG4gICAgcmV0dXJuIChfaXNJT1ModWEpIHx8XG4gICAgICAgIF9pc0FuZHJvaWQodWEpIHx8XG4gICAgICAgIF9pc1dlYk9TKHVhKSB8fFxuICAgICAgICBfaXNCbGFja0JlcnJ5KHVhKSB8fFxuICAgICAgICAvd2luZG93cyBwaG9uZS9pLnRlc3QodWEpIHx8XG4gICAgICAgIF9pc0lFTW9iaWxlKHVhKSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKlxuICogRGV0ZXJtaW5lIHRoZSBTREsgdmVyc2lvbiBzdHJpbmdcbiAqL1xuZnVuY3Rpb24gX2dldENsaWVudFZlcnNpb24oY2xpZW50UGxhdGZvcm0sIGZyYW1ld29ya3MgPSBbXSkge1xuICAgIGxldCByZXBvcnRlZFBsYXRmb3JtO1xuICAgIHN3aXRjaCAoY2xpZW50UGxhdGZvcm0pIHtcbiAgICAgICAgY2FzZSBcIkJyb3dzZXJcIiAvKiBDbGllbnRQbGF0Zm9ybS5CUk9XU0VSICovOlxuICAgICAgICAgICAgLy8gSW4gYSBicm93c2VyIGVudmlyb25tZW50LCByZXBvcnQgdGhlIGJyb3dzZXIgbmFtZS5cbiAgICAgICAgICAgIHJlcG9ydGVkUGxhdGZvcm0gPSBfZ2V0QnJvd3Nlck5hbWUoZ2V0VUEoKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIldvcmtlclwiIC8qIENsaWVudFBsYXRmb3JtLldPUktFUiAqLzpcbiAgICAgICAgICAgIC8vIFRlY2huaWNhbGx5IGEgd29ya2VyIHJ1bnMgZnJvbSBhIGJyb3dzZXIgYnV0IHdlIG5lZWQgdG8gZGlmZmVyZW50aWF0ZSBhXG4gICAgICAgICAgICAvLyB3b3JrZXIgZnJvbSBhIGJyb3dzZXIuXG4gICAgICAgICAgICAvLyBGb3IgZXhhbXBsZTogQ2hyb21lLVdvcmtlci9Kc0NvcmUvNC45LjEvRmlyZWJhc2VDb3JlLXdlYi5cbiAgICAgICAgICAgIHJlcG9ydGVkUGxhdGZvcm0gPSBgJHtfZ2V0QnJvd3Nlck5hbWUoZ2V0VUEoKSl9LSR7Y2xpZW50UGxhdGZvcm19YDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmVwb3J0ZWRQbGF0Zm9ybSA9IGNsaWVudFBsYXRmb3JtO1xuICAgIH1cbiAgICBjb25zdCByZXBvcnRlZEZyYW1ld29ya3MgPSBmcmFtZXdvcmtzLmxlbmd0aFxuICAgICAgICA/IGZyYW1ld29ya3Muam9pbignLCcpXG4gICAgICAgIDogJ0ZpcmViYXNlQ29yZS13ZWInOyAvKiBkZWZhdWx0IHZhbHVlIGlmIG5vIG90aGVyIGZyYW1ld29yayBpcyB1c2VkICovXG4gICAgcmV0dXJuIGAke3JlcG9ydGVkUGxhdGZvcm19LyR7XCJKc0NvcmVcIiAvKiBDbGllbnRJbXBsZW1lbnRhdGlvbi5DT1JFICovfS8ke1NES19WRVJTSU9OfS8ke3JlcG9ydGVkRnJhbWV3b3Jrc31gO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3MgQXV0aE1pZGRsZXdhcmVRdWV1ZSB7XG4gICAgY29uc3RydWN0b3IoYXV0aCkge1xuICAgICAgICB0aGlzLmF1dGggPSBhdXRoO1xuICAgICAgICB0aGlzLnF1ZXVlID0gW107XG4gICAgfVxuICAgIHB1c2hDYWxsYmFjayhjYWxsYmFjaywgb25BYm9ydCkge1xuICAgICAgICAvLyBUaGUgY2FsbGJhY2sgY291bGQgYmUgc3luYyBvciBhc3luYy4gV3JhcCBpdCBpbnRvIGFcbiAgICAgICAgLy8gZnVuY3Rpb24gdGhhdCBpcyBhbHdheXMgYXN5bmMuXG4gICAgICAgIGNvbnN0IHdyYXBwZWRDYWxsYmFjayA9ICh1c2VyKSA9PiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGNhbGxiYWNrKHVzZXIpO1xuICAgICAgICAgICAgICAgIC8vIEVpdGhlciByZXNvbHZlIHdpdGggZXhpc3RpbmcgcHJvbWlzZSBvciB3cmFwIGEgbm9uLXByb21pc2VcbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gdmFsdWUgaW50byBhIHByb21pc2UuXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvLyBTeW5jIGNhbGxiYWNrIHRocm93cy5cbiAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBBdHRhY2ggdGhlIG9uQWJvcnQgaWYgcHJlc2VudFxuICAgICAgICB3cmFwcGVkQ2FsbGJhY2sub25BYm9ydCA9IG9uQWJvcnQ7XG4gICAgICAgIHRoaXMucXVldWUucHVzaCh3cmFwcGVkQ2FsbGJhY2spO1xuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMucXVldWUubGVuZ3RoIC0gMTtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIC8vIFVuc3Vic2NyaWJlLiBSZXBsYWNlIHdpdGggbm8tb3AuIERvIG5vdCByZW1vdmUgZnJvbSBhcnJheSwgb3IgaXQgd2lsbCBkaXN0dXJiXG4gICAgICAgICAgICAvLyBpbmRleGluZyBvZiBvdGhlciBlbGVtZW50cy5cbiAgICAgICAgICAgIHRoaXMucXVldWVbaW5kZXhdID0gKCkgPT4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIH07XG4gICAgfVxuICAgIGFzeW5jIHJ1bk1pZGRsZXdhcmUobmV4dFVzZXIpIHtcbiAgICAgICAgaWYgKHRoaXMuYXV0aC5jdXJyZW50VXNlciA9PT0gbmV4dFVzZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBXaGlsZSBydW5uaW5nIHRoZSBtaWRkbGV3YXJlLCBidWlsZCBhIHRlbXBvcmFyeSBzdGFjayBvZiBvbkFib3J0XG4gICAgICAgIC8vIGNhbGxiYWNrcyB0byBjYWxsIGlmIG9uZSBtaWRkbGV3YXJlIGNhbGxiYWNrIHJlamVjdHMuXG4gICAgICAgIGNvbnN0IG9uQWJvcnRTdGFjayA9IFtdO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBiZWZvcmVTdGF0ZUNhbGxiYWNrIG9mIHRoaXMucXVldWUpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCBiZWZvcmVTdGF0ZUNhbGxiYWNrKG5leHRVc2VyKTtcbiAgICAgICAgICAgICAgICAvLyBPbmx5IHB1c2ggdGhlIG9uQWJvcnQgaWYgdGhlIGNhbGxiYWNrIHN1Y2NlZWRzXG4gICAgICAgICAgICAgICAgaWYgKGJlZm9yZVN0YXRlQ2FsbGJhY2sub25BYm9ydCkge1xuICAgICAgICAgICAgICAgICAgICBvbkFib3J0U3RhY2sucHVzaChiZWZvcmVTdGF0ZUNhbGxiYWNrLm9uQWJvcnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgLy8gUnVuIGFsbCBvbkFib3J0LCB3aXRoIHNlcGFyYXRlIHRyeS9jYXRjaCB0byBpZ25vcmUgYW55IGVycm9ycyBhbmRcbiAgICAgICAgICAgIC8vIGNvbnRpbnVlXG4gICAgICAgICAgICBvbkFib3J0U3RhY2sucmV2ZXJzZSgpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBvbkFib3J0IG9mIG9uQWJvcnRTdGFjaykge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIG9uQWJvcnQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKF8pIHtcbiAgICAgICAgICAgICAgICAgICAgLyogc3dhbGxvdyBlcnJvciAqL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRocm93IHRoaXMuYXV0aC5fZXJyb3JGYWN0b3J5LmNyZWF0ZShcImxvZ2luLWJsb2NrZWRcIiAvKiBBdXRoRXJyb3JDb2RlLkxPR0lOX0JMT0NLRUQgKi8sIHtcbiAgICAgICAgICAgICAgICBvcmlnaW5hbE1lc3NhZ2U6IGU/Lm1lc3NhZ2VcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBGZXRjaGVzIHRoZSBwYXNzd29yZCBwb2xpY3kgZm9yIHRoZSBjdXJyZW50bHkgc2V0IHRlbmFudCBvciB0aGUgcHJvamVjdCBpZiBubyB0ZW5hbnQgaXMgc2V0LlxuICpcbiAqIEBwYXJhbSBhdXRoIEF1dGggb2JqZWN0LlxuICogQHBhcmFtIHJlcXVlc3QgUGFzc3dvcmQgcG9saWN5IHJlcXVlc3QuXG4gKiBAcmV0dXJucyBQYXNzd29yZCBwb2xpY3kgcmVzcG9uc2UuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIF9nZXRQYXNzd29yZFBvbGljeShhdXRoLCByZXF1ZXN0ID0ge30pIHtcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiR0VUXCIgLyogSHR0cE1ldGhvZC5HRVQgKi8sIFwiL3YyL3Bhc3N3b3JkUG9saWN5XCIgLyogRW5kcG9pbnQuR0VUX1BBU1NXT1JEX1BPTElDWSAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8vIE1pbmltdW0gbWluIHBhc3N3b3JkIGxlbmd0aCBlbmZvcmNlZCBieSB0aGUgYmFja2VuZCwgZXZlbiBpZiBubyBtaW5pbXVtIGxlbmd0aCBpcyBzZXQuXG5jb25zdCBNSU5JTVVNX01JTl9QQVNTV09SRF9MRU5HVEggPSA2O1xuLyoqXG4gKiBTdG9yZXMgcGFzc3dvcmQgcG9saWN5IHJlcXVpcmVtZW50cyBhbmQgcHJvdmlkZXMgcGFzc3dvcmQgdmFsaWRhdGlvbiBhZ2FpbnN0IHRoZSBwb2xpY3kuXG4gKlxuICogQGludGVybmFsXG4gKi9cbmNsYXNzIFBhc3N3b3JkUG9saWN5SW1wbCB7XG4gICAgY29uc3RydWN0b3IocmVzcG9uc2UpIHtcbiAgICAgICAgLy8gT25seSBpbmNsdWRlIGN1c3RvbSBzdHJlbmd0aCBvcHRpb25zIGRlZmluZWQgaW4gdGhlIHJlc3BvbnNlLlxuICAgICAgICBjb25zdCByZXNwb25zZU9wdGlvbnMgPSByZXNwb25zZS5jdXN0b21TdHJlbmd0aE9wdGlvbnM7XG4gICAgICAgIHRoaXMuY3VzdG9tU3RyZW5ndGhPcHRpb25zID0ge307XG4gICAgICAgIC8vIFRPRE86IFJlbW92ZSBvbmNlIHRoZSBiYWNrZW5kIGlzIHVwZGF0ZWQgdG8gaW5jbHVkZSB0aGUgbWluaW11bSBtaW4gcGFzc3dvcmQgbGVuZ3RoIGluc3RlYWQgb2YgdW5kZWZpbmVkIHdoZW4gdGhlcmUgaXMgbm8gbWluaW11bSBsZW5ndGggc2V0LlxuICAgICAgICB0aGlzLmN1c3RvbVN0cmVuZ3RoT3B0aW9ucy5taW5QYXNzd29yZExlbmd0aCA9XG4gICAgICAgICAgICByZXNwb25zZU9wdGlvbnMubWluUGFzc3dvcmRMZW5ndGggPz8gTUlOSU1VTV9NSU5fUEFTU1dPUkRfTEVOR1RIO1xuICAgICAgICBpZiAocmVzcG9uc2VPcHRpb25zLm1heFBhc3N3b3JkTGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLmN1c3RvbVN0cmVuZ3RoT3B0aW9ucy5tYXhQYXNzd29yZExlbmd0aCA9XG4gICAgICAgICAgICAgICAgcmVzcG9uc2VPcHRpb25zLm1heFBhc3N3b3JkTGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZXNwb25zZU9wdGlvbnMuY29udGFpbnNMb3dlcmNhc2VDaGFyYWN0ZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5jdXN0b21TdHJlbmd0aE9wdGlvbnMuY29udGFpbnNMb3dlcmNhc2VMZXR0ZXIgPVxuICAgICAgICAgICAgICAgIHJlc3BvbnNlT3B0aW9ucy5jb250YWluc0xvd2VyY2FzZUNoYXJhY3RlcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzcG9uc2VPcHRpb25zLmNvbnRhaW5zVXBwZXJjYXNlQ2hhcmFjdGVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuY3VzdG9tU3RyZW5ndGhPcHRpb25zLmNvbnRhaW5zVXBwZXJjYXNlTGV0dGVyID1cbiAgICAgICAgICAgICAgICByZXNwb25zZU9wdGlvbnMuY29udGFpbnNVcHBlcmNhc2VDaGFyYWN0ZXI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlc3BvbnNlT3B0aW9ucy5jb250YWluc051bWVyaWNDaGFyYWN0ZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5jdXN0b21TdHJlbmd0aE9wdGlvbnMuY29udGFpbnNOdW1lcmljQ2hhcmFjdGVyID1cbiAgICAgICAgICAgICAgICByZXNwb25zZU9wdGlvbnMuY29udGFpbnNOdW1lcmljQ2hhcmFjdGVyO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZXNwb25zZU9wdGlvbnMuY29udGFpbnNOb25BbHBoYW51bWVyaWNDaGFyYWN0ZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5jdXN0b21TdHJlbmd0aE9wdGlvbnMuY29udGFpbnNOb25BbHBoYW51bWVyaWNDaGFyYWN0ZXIgPVxuICAgICAgICAgICAgICAgIHJlc3BvbnNlT3B0aW9ucy5jb250YWluc05vbkFscGhhbnVtZXJpY0NoYXJhY3RlcjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmVuZm9yY2VtZW50U3RhdGUgPSByZXNwb25zZS5lbmZvcmNlbWVudFN0YXRlO1xuICAgICAgICBpZiAodGhpcy5lbmZvcmNlbWVudFN0YXRlID09PSAnRU5GT1JDRU1FTlRfU1RBVEVfVU5TUEVDSUZJRUQnKSB7XG4gICAgICAgICAgICB0aGlzLmVuZm9yY2VtZW50U3RhdGUgPSAnT0ZGJztcbiAgICAgICAgfVxuICAgICAgICAvLyBVc2UgYW4gZW1wdHkgc3RyaW5nIGlmIG5vIG5vbi1hbHBoYW51bWVyaWMgY2hhcmFjdGVycyBhcmUgc3BlY2lmaWVkIGluIHRoZSByZXNwb25zZS5cbiAgICAgICAgdGhpcy5hbGxvd2VkTm9uQWxwaGFudW1lcmljQ2hhcmFjdGVycyA9XG4gICAgICAgICAgICByZXNwb25zZS5hbGxvd2VkTm9uQWxwaGFudW1lcmljQ2hhcmFjdGVycz8uam9pbignJykgPz8gJyc7XG4gICAgICAgIHRoaXMuZm9yY2VVcGdyYWRlT25TaWduaW4gPSByZXNwb25zZS5mb3JjZVVwZ3JhZGVPblNpZ25pbiA/PyBmYWxzZTtcbiAgICAgICAgdGhpcy5zY2hlbWFWZXJzaW9uID0gcmVzcG9uc2Uuc2NoZW1hVmVyc2lvbjtcbiAgICB9XG4gICAgdmFsaWRhdGVQYXNzd29yZChwYXNzd29yZCkge1xuICAgICAgICBjb25zdCBzdGF0dXMgPSB7XG4gICAgICAgICAgICBpc1ZhbGlkOiB0cnVlLFxuICAgICAgICAgICAgcGFzc3dvcmRQb2xpY3k6IHRoaXNcbiAgICAgICAgfTtcbiAgICAgICAgLy8gQ2hlY2sgdGhlIHBhc3N3b3JkIGxlbmd0aCBhbmQgY2hhcmFjdGVyIG9wdGlvbnMuXG4gICAgICAgIHRoaXMudmFsaWRhdGVQYXNzd29yZExlbmd0aE9wdGlvbnMocGFzc3dvcmQsIHN0YXR1cyk7XG4gICAgICAgIHRoaXMudmFsaWRhdGVQYXNzd29yZENoYXJhY3Rlck9wdGlvbnMocGFzc3dvcmQsIHN0YXR1cyk7XG4gICAgICAgIC8vIENvbWJpbmUgdGhlIHN0YXR1cyBpbnRvIHNpbmdsZSBpc1ZhbGlkIHByb3BlcnR5LlxuICAgICAgICBzdGF0dXMuaXNWYWxpZCAmJiAoc3RhdHVzLmlzVmFsaWQgPSBzdGF0dXMubWVldHNNaW5QYXNzd29yZExlbmd0aCA/PyB0cnVlKTtcbiAgICAgICAgc3RhdHVzLmlzVmFsaWQgJiYgKHN0YXR1cy5pc1ZhbGlkID0gc3RhdHVzLm1lZXRzTWF4UGFzc3dvcmRMZW5ndGggPz8gdHJ1ZSk7XG4gICAgICAgIHN0YXR1cy5pc1ZhbGlkICYmIChzdGF0dXMuaXNWYWxpZCA9IHN0YXR1cy5jb250YWluc0xvd2VyY2FzZUxldHRlciA/PyB0cnVlKTtcbiAgICAgICAgc3RhdHVzLmlzVmFsaWQgJiYgKHN0YXR1cy5pc1ZhbGlkID0gc3RhdHVzLmNvbnRhaW5zVXBwZXJjYXNlTGV0dGVyID8/IHRydWUpO1xuICAgICAgICBzdGF0dXMuaXNWYWxpZCAmJiAoc3RhdHVzLmlzVmFsaWQgPSBzdGF0dXMuY29udGFpbnNOdW1lcmljQ2hhcmFjdGVyID8/IHRydWUpO1xuICAgICAgICBzdGF0dXMuaXNWYWxpZCAmJiAoc3RhdHVzLmlzVmFsaWQgPSBzdGF0dXMuY29udGFpbnNOb25BbHBoYW51bWVyaWNDaGFyYWN0ZXIgPz8gdHJ1ZSk7XG4gICAgICAgIHJldHVybiBzdGF0dXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlcyB0aGF0IHRoZSBwYXNzd29yZCBtZWV0cyB0aGUgbGVuZ3RoIG9wdGlvbnMgZm9yIHRoZSBwb2xpY3kuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFzc3dvcmQgUGFzc3dvcmQgdG8gdmFsaWRhdGUuXG4gICAgICogQHBhcmFtIHN0YXR1cyBWYWxpZGF0aW9uIHN0YXR1cy5cbiAgICAgKi9cbiAgICB2YWxpZGF0ZVBhc3N3b3JkTGVuZ3RoT3B0aW9ucyhwYXNzd29yZCwgc3RhdHVzKSB7XG4gICAgICAgIGNvbnN0IG1pblBhc3N3b3JkTGVuZ3RoID0gdGhpcy5jdXN0b21TdHJlbmd0aE9wdGlvbnMubWluUGFzc3dvcmRMZW5ndGg7XG4gICAgICAgIGNvbnN0IG1heFBhc3N3b3JkTGVuZ3RoID0gdGhpcy5jdXN0b21TdHJlbmd0aE9wdGlvbnMubWF4UGFzc3dvcmRMZW5ndGg7XG4gICAgICAgIGlmIChtaW5QYXNzd29yZExlbmd0aCkge1xuICAgICAgICAgICAgc3RhdHVzLm1lZXRzTWluUGFzc3dvcmRMZW5ndGggPSBwYXNzd29yZC5sZW5ndGggPj0gbWluUGFzc3dvcmRMZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1heFBhc3N3b3JkTGVuZ3RoKSB7XG4gICAgICAgICAgICBzdGF0dXMubWVldHNNYXhQYXNzd29yZExlbmd0aCA9IHBhc3N3b3JkLmxlbmd0aCA8PSBtYXhQYXNzd29yZExlbmd0aDtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZXMgdGhhdCB0aGUgcGFzc3dvcmQgbWVldHMgdGhlIGNoYXJhY3RlciBvcHRpb25zIGZvciB0aGUgcG9saWN5LlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhc3N3b3JkIFBhc3N3b3JkIHRvIHZhbGlkYXRlLlxuICAgICAqIEBwYXJhbSBzdGF0dXMgVmFsaWRhdGlvbiBzdGF0dXMuXG4gICAgICovXG4gICAgdmFsaWRhdGVQYXNzd29yZENoYXJhY3Rlck9wdGlvbnMocGFzc3dvcmQsIHN0YXR1cykge1xuICAgICAgICAvLyBBc3NpZ24gc3RhdHVzZXMgZm9yIHJlcXVpcmVtZW50cyBldmVuIGlmIHRoZSBwYXNzd29yZCBpcyBhbiBlbXB0eSBzdHJpbmcuXG4gICAgICAgIHRoaXMudXBkYXRlUGFzc3dvcmRDaGFyYWN0ZXJPcHRpb25zU3RhdHVzZXMoc3RhdHVzLCBcbiAgICAgICAgLyogY29udGFpbnNMb3dlcmNhc2VDaGFyYWN0ZXI9ICovIGZhbHNlLCBcbiAgICAgICAgLyogY29udGFpbnNVcHBlcmNhc2VDaGFyYWN0ZXI9ICovIGZhbHNlLCBcbiAgICAgICAgLyogY29udGFpbnNOdW1lcmljQ2hhcmFjdGVyPSAqLyBmYWxzZSwgXG4gICAgICAgIC8qIGNvbnRhaW5zTm9uQWxwaGFudW1lcmljQ2hhcmFjdGVyPSAqLyBmYWxzZSk7XG4gICAgICAgIGxldCBwYXNzd29yZENoYXI7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFzc3dvcmQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHBhc3N3b3JkQ2hhciA9IHBhc3N3b3JkLmNoYXJBdChpKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUGFzc3dvcmRDaGFyYWN0ZXJPcHRpb25zU3RhdHVzZXMoc3RhdHVzLCBcbiAgICAgICAgICAgIC8qIGNvbnRhaW5zTG93ZXJjYXNlQ2hhcmFjdGVyPSAqLyBwYXNzd29yZENoYXIgPj0gJ2EnICYmXG4gICAgICAgICAgICAgICAgcGFzc3dvcmRDaGFyIDw9ICd6JywgXG4gICAgICAgICAgICAvKiBjb250YWluc1VwcGVyY2FzZUNoYXJhY3Rlcj0gKi8gcGFzc3dvcmRDaGFyID49ICdBJyAmJlxuICAgICAgICAgICAgICAgIHBhc3N3b3JkQ2hhciA8PSAnWicsIFxuICAgICAgICAgICAgLyogY29udGFpbnNOdW1lcmljQ2hhcmFjdGVyPSAqLyBwYXNzd29yZENoYXIgPj0gJzAnICYmXG4gICAgICAgICAgICAgICAgcGFzc3dvcmRDaGFyIDw9ICc5JywgXG4gICAgICAgICAgICAvKiBjb250YWluc05vbkFscGhhbnVtZXJpY0NoYXJhY3Rlcj0gKi8gdGhpcy5hbGxvd2VkTm9uQWxwaGFudW1lcmljQ2hhcmFjdGVycy5pbmNsdWRlcyhwYXNzd29yZENoYXIpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSBydW5uaW5nIHZhbGlkYXRpb24gc3RhdHVzIHdpdGggdGhlIHN0YXR1c2VzIGZvciB0aGUgY2hhcmFjdGVyIG9wdGlvbnMuXG4gICAgICogRXhwZWN0ZWQgdG8gYmUgY2FsbGVkIGVhY2ggdGltZSBhIGNoYXJhY3RlciBpcyBwcm9jZXNzZWQgdG8gdXBkYXRlIGVhY2ggb3B0aW9uIHN0YXR1c1xuICAgICAqIGJhc2VkIG9uIHRoZSBjdXJyZW50IGNoYXJhY3Rlci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzdGF0dXMgVmFsaWRhdGlvbiBzdGF0dXMuXG4gICAgICogQHBhcmFtIGNvbnRhaW5zTG93ZXJjYXNlQ2hhcmFjdGVyIFdoZXRoZXIgdGhlIGNoYXJhY3RlciBpcyBhIGxvd2VyY2FzZSBsZXR0ZXIuXG4gICAgICogQHBhcmFtIGNvbnRhaW5zVXBwZXJjYXNlQ2hhcmFjdGVyIFdoZXRoZXIgdGhlIGNoYXJhY3RlciBpcyBhbiB1cHBlcmNhc2UgbGV0dGVyLlxuICAgICAqIEBwYXJhbSBjb250YWluc051bWVyaWNDaGFyYWN0ZXIgV2hldGhlciB0aGUgY2hhcmFjdGVyIGlzIGEgbnVtZXJpYyBjaGFyYWN0ZXIuXG4gICAgICogQHBhcmFtIGNvbnRhaW5zTm9uQWxwaGFudW1lcmljQ2hhcmFjdGVyIFdoZXRoZXIgdGhlIGNoYXJhY3RlciBpcyBhIG5vbi1hbHBoYW51bWVyaWMgY2hhcmFjdGVyLlxuICAgICAqL1xuICAgIHVwZGF0ZVBhc3N3b3JkQ2hhcmFjdGVyT3B0aW9uc1N0YXR1c2VzKHN0YXR1cywgY29udGFpbnNMb3dlcmNhc2VDaGFyYWN0ZXIsIGNvbnRhaW5zVXBwZXJjYXNlQ2hhcmFjdGVyLCBjb250YWluc051bWVyaWNDaGFyYWN0ZXIsIGNvbnRhaW5zTm9uQWxwaGFudW1lcmljQ2hhcmFjdGVyKSB7XG4gICAgICAgIGlmICh0aGlzLmN1c3RvbVN0cmVuZ3RoT3B0aW9ucy5jb250YWluc0xvd2VyY2FzZUxldHRlcikge1xuICAgICAgICAgICAgc3RhdHVzLmNvbnRhaW5zTG93ZXJjYXNlTGV0dGVyIHx8IChzdGF0dXMuY29udGFpbnNMb3dlcmNhc2VMZXR0ZXIgPSBjb250YWluc0xvd2VyY2FzZUNoYXJhY3Rlcik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY3VzdG9tU3RyZW5ndGhPcHRpb25zLmNvbnRhaW5zVXBwZXJjYXNlTGV0dGVyKSB7XG4gICAgICAgICAgICBzdGF0dXMuY29udGFpbnNVcHBlcmNhc2VMZXR0ZXIgfHwgKHN0YXR1cy5jb250YWluc1VwcGVyY2FzZUxldHRlciA9IGNvbnRhaW5zVXBwZXJjYXNlQ2hhcmFjdGVyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jdXN0b21TdHJlbmd0aE9wdGlvbnMuY29udGFpbnNOdW1lcmljQ2hhcmFjdGVyKSB7XG4gICAgICAgICAgICBzdGF0dXMuY29udGFpbnNOdW1lcmljQ2hhcmFjdGVyIHx8IChzdGF0dXMuY29udGFpbnNOdW1lcmljQ2hhcmFjdGVyID0gY29udGFpbnNOdW1lcmljQ2hhcmFjdGVyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jdXN0b21TdHJlbmd0aE9wdGlvbnMuY29udGFpbnNOb25BbHBoYW51bWVyaWNDaGFyYWN0ZXIpIHtcbiAgICAgICAgICAgIHN0YXR1cy5jb250YWluc05vbkFscGhhbnVtZXJpY0NoYXJhY3RlciB8fCAoc3RhdHVzLmNvbnRhaW5zTm9uQWxwaGFudW1lcmljQ2hhcmFjdGVyID0gY29udGFpbnNOb25BbHBoYW51bWVyaWNDaGFyYWN0ZXIpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3MgQXV0aEltcGwge1xuICAgIGNvbnN0cnVjdG9yKGFwcCwgaGVhcnRiZWF0U2VydmljZVByb3ZpZGVyLCBhcHBDaGVja1NlcnZpY2VQcm92aWRlciwgY29uZmlnKSB7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLmhlYXJ0YmVhdFNlcnZpY2VQcm92aWRlciA9IGhlYXJ0YmVhdFNlcnZpY2VQcm92aWRlcjtcbiAgICAgICAgdGhpcy5hcHBDaGVja1NlcnZpY2VQcm92aWRlciA9IGFwcENoZWNrU2VydmljZVByb3ZpZGVyO1xuICAgICAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IG51bGw7XG4gICAgICAgIHRoaXMuZW11bGF0b3JDb25maWcgPSBudWxsO1xuICAgICAgICB0aGlzLm9wZXJhdGlvbnMgPSBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgdGhpcy5hdXRoU3RhdGVTdWJzY3JpcHRpb24gPSBuZXcgU3Vic2NyaXB0aW9uKHRoaXMpO1xuICAgICAgICB0aGlzLmlkVG9rZW5TdWJzY3JpcHRpb24gPSBuZXcgU3Vic2NyaXB0aW9uKHRoaXMpO1xuICAgICAgICB0aGlzLmJlZm9yZVN0YXRlUXVldWUgPSBuZXcgQXV0aE1pZGRsZXdhcmVRdWV1ZSh0aGlzKTtcbiAgICAgICAgdGhpcy5yZWRpcmVjdFVzZXIgPSBudWxsO1xuICAgICAgICB0aGlzLmlzUHJvYWN0aXZlUmVmcmVzaEVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5FWFBFQ1RFRF9QQVNTV09SRF9QT0xJQ1lfU0NIRU1BX1ZFUlNJT04gPSAxO1xuICAgICAgICAvLyBBbnkgbmV0d29yayBjYWxscyB3aWxsIHNldCB0aGlzIHRvIHRydWUgYW5kIHByZXZlbnQgc3Vic2VxdWVudCBlbXVsYXRvclxuICAgICAgICAvLyBpbml0aWFsaXphdGlvblxuICAgICAgICB0aGlzLl9jYW5Jbml0RW11bGF0b3IgPSB0cnVlO1xuICAgICAgICB0aGlzLl9pc0luaXRpYWxpemVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2RlbGV0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5faW5pdGlhbGl6YXRpb25Qcm9taXNlID0gbnVsbDtcbiAgICAgICAgdGhpcy5fcG9wdXBSZWRpcmVjdFJlc29sdmVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5fZXJyb3JGYWN0b3J5ID0gX0RFRkFVTFRfQVVUSF9FUlJPUl9GQUNUT1JZO1xuICAgICAgICB0aGlzLl9hZ2VudFJlY2FwdGNoYUNvbmZpZyA9IG51bGw7XG4gICAgICAgIHRoaXMuX3RlbmFudFJlY2FwdGNoYUNvbmZpZ3MgPSB7fTtcbiAgICAgICAgdGhpcy5fcHJvamVjdFBhc3N3b3JkUG9saWN5ID0gbnVsbDtcbiAgICAgICAgdGhpcy5fdGVuYW50UGFzc3dvcmRQb2xpY2llcyA9IHt9O1xuICAgICAgICB0aGlzLl9yZXNvbHZlUGVyc2lzdGVuY2VNYW5hZ2VyQXZhaWxhYmxlID0gdW5kZWZpbmVkO1xuICAgICAgICAvLyBUcmFja3MgdGhlIGxhc3Qgbm90aWZpZWQgVUlEIGZvciBzdGF0ZSBjaGFuZ2UgbGlzdGVuZXJzIHRvIHByZXZlbnRcbiAgICAgICAgLy8gcmVwZWF0ZWQgY2FsbHMgdG8gdGhlIGNhbGxiYWNrcy4gVW5kZWZpbmVkIG1lYW5zIGl0J3MgbmV2ZXIgYmVlblxuICAgICAgICAvLyBjYWxsZWQsIHdoZXJlYXMgbnVsbCBtZWFucyBpdCdzIGJlZW4gY2FsbGVkIHdpdGggYSBzaWduZWQgb3V0IHVzZXJcbiAgICAgICAgdGhpcy5sYXN0Tm90aWZpZWRVaWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMubGFuZ3VhZ2VDb2RlID0gbnVsbDtcbiAgICAgICAgdGhpcy50ZW5hbnRJZCA9IG51bGw7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSB7IGFwcFZlcmlmaWNhdGlvbkRpc2FibGVkRm9yVGVzdGluZzogZmFsc2UgfTtcbiAgICAgICAgdGhpcy5mcmFtZXdvcmtzID0gW107XG4gICAgICAgIHRoaXMubmFtZSA9IGFwcC5uYW1lO1xuICAgICAgICB0aGlzLmNsaWVudFZlcnNpb24gPSBjb25maWcuc2RrQ2xpZW50VmVyc2lvbjtcbiAgICAgICAgLy8gVE9ETyhqYW1lc2RhbmllbHMpIGV4cGxvcmUgbGVzcyBoYWNreSB3YXkgdG8gZG8gdGhpcywgY29va2llIGF1dGhlbnRpY2F0aW9uIG5lZWRzXG4gICAgICAgIC8vIHBlcnNpc3RlbmNlTWFuYW5nZXIgdG8gYmUgYXZhaWxhYmxlLiBzZWUgX2dldEZpbmFsVGFyZ2V0IGZvciBtb3JlIGNvbnRleHRcbiAgICAgICAgdGhpcy5fcGVyc2lzdGVuY2VNYW5hZ2VyQXZhaWxhYmxlID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiAodGhpcy5fcmVzb2x2ZVBlcnNpc3RlbmNlTWFuYWdlckF2YWlsYWJsZSA9IHJlc29sdmUpKTtcbiAgICB9XG4gICAgX2luaXRpYWxpemVXaXRoUGVyc2lzdGVuY2UocGVyc2lzdGVuY2VIaWVyYXJjaHksIHBvcHVwUmVkaXJlY3RSZXNvbHZlcikge1xuICAgICAgICBpZiAocG9wdXBSZWRpcmVjdFJlc29sdmVyKSB7XG4gICAgICAgICAgICB0aGlzLl9wb3B1cFJlZGlyZWN0UmVzb2x2ZXIgPSBfZ2V0SW5zdGFuY2UocG9wdXBSZWRpcmVjdFJlc29sdmVyKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBIYXZlIHRvIGNoZWNrIGZvciBhcHAgZGVsZXRpb24gdGhyb3VnaG91dCBpbml0aWFsaXphdGlvbiAoYWZ0ZXIgZWFjaFxuICAgICAgICAvLyBwcm9taXNlIHJlc29sdXRpb24pXG4gICAgICAgIHRoaXMuX2luaXRpYWxpemF0aW9uUHJvbWlzZSA9IHRoaXMucXVldWUoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2RlbGV0ZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnBlcnNpc3RlbmNlTWFuYWdlciA9IGF3YWl0IFBlcnNpc3RlbmNlVXNlck1hbmFnZXIuY3JlYXRlKHRoaXMsIHBlcnNpc3RlbmNlSGllcmFyY2h5KTtcbiAgICAgICAgICAgIHRoaXMuX3Jlc29sdmVQZXJzaXN0ZW5jZU1hbmFnZXJBdmFpbGFibGU/LigpO1xuICAgICAgICAgICAgaWYgKHRoaXMuX2RlbGV0ZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBJbml0aWFsaXplIHRoZSByZXNvbHZlciBlYXJseSBpZiBuZWNlc3NhcnkgKG9ubHkgYXBwbGljYWJsZSB0byB3ZWI6XG4gICAgICAgICAgICAvLyB0aGlzIHdpbGwgY2F1c2UgdGhlIGlmcmFtZSB0byBsb2FkIGltbWVkaWF0ZWx5IGluIGNlcnRhaW4gY2FzZXMpXG4gICAgICAgICAgICBpZiAodGhpcy5fcG9wdXBSZWRpcmVjdFJlc29sdmVyPy5fc2hvdWxkSW5pdFByb2FjdGl2ZWx5KSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhpcyBmYWlscywgZG9uJ3QgaGFsdCBhdXRoIGxvYWRpbmdcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLl9wb3B1cFJlZGlyZWN0UmVzb2x2ZXIuX2luaXRpYWxpemUodGhpcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8qIElnbm9yZSB0aGUgZXJyb3IgKi9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVDdXJyZW50VXNlcihwb3B1cFJlZGlyZWN0UmVzb2x2ZXIpO1xuICAgICAgICAgICAgdGhpcy5sYXN0Tm90aWZpZWRVaWQgPSB0aGlzLmN1cnJlbnRVc2VyPy51aWQgfHwgbnVsbDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9kZWxldGVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5faXNJbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcy5faW5pdGlhbGl6YXRpb25Qcm9taXNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJZiB0aGUgcGVyc2lzdGVuY2UgaXMgY2hhbmdlZCBpbiBhbm90aGVyIHdpbmRvdywgdGhlIHVzZXIgbWFuYWdlciB3aWxsIGxldCB1cyBrbm93XG4gICAgICovXG4gICAgYXN5bmMgX29uU3RvcmFnZUV2ZW50KCkge1xuICAgICAgICBpZiAodGhpcy5fZGVsZXRlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCB0aGlzLmFzc2VydGVkUGVyc2lzdGVuY2UuZ2V0Q3VycmVudFVzZXIoKTtcbiAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRVc2VyICYmICF1c2VyKSB7XG4gICAgICAgICAgICAvLyBObyBjaGFuZ2UsIGRvIG5vdGhpbmcgKHdhcyBzaWduZWQgb3V0IGFuZCByZW1haW5lZCBzaWduZWQgb3V0KS5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBJZiB0aGUgc2FtZSB1c2VyIGlzIHRvIGJlIHN5bmNocm9uaXplZC5cbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFVzZXIgJiYgdXNlciAmJiB0aGlzLmN1cnJlbnRVc2VyLnVpZCA9PT0gdXNlci51aWQpIHtcbiAgICAgICAgICAgIC8vIERhdGEgdXBkYXRlLCBzaW1wbHkgY29weSBkYXRhIGNoYW5nZXMuXG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50VXNlci5fYXNzaWduKHVzZXIpO1xuICAgICAgICAgICAgLy8gSWYgdG9rZW5zIGNoYW5nZWQgZnJvbSBwcmV2aW91cyB1c2VyIHRva2VucywgdGhpcyB3aWxsIHRyaWdnZXJcbiAgICAgICAgICAgIC8vIG5vdGlmeUF1dGhMaXN0ZW5lcnNfLlxuICAgICAgICAgICAgYXdhaXQgdGhpcy5jdXJyZW50VXNlci5nZXRJZFRva2VuKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gVXBkYXRlIGN1cnJlbnQgQXV0aCBzdGF0ZS4gRWl0aGVyIGEgbmV3IGxvZ2luIG9yIGxvZ291dC5cbiAgICAgICAgLy8gU2tpcCBibG9ja2luZyBjYWxsYmFja3MsIHRoZXkgc2hvdWxkIG5vdCBhcHBseSB0byBhIGNoYW5nZSBpbiBhbm90aGVyIHRhYi5cbiAgICAgICAgYXdhaXQgdGhpcy5fdXBkYXRlQ3VycmVudFVzZXIodXNlciwgLyogc2tpcEJlZm9yZVN0YXRlQ2FsbGJhY2tzICovIHRydWUpO1xuICAgIH1cbiAgICBhc3luYyBpbml0aWFsaXplQ3VycmVudFVzZXJGcm9tSWRUb2tlbihpZFRva2VuKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldEFjY291bnRJbmZvKHRoaXMsIHsgaWRUb2tlbiB9KTtcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VySW1wbC5fZnJvbUdldEFjY291bnRJbmZvUmVzcG9uc2UodGhpcywgcmVzcG9uc2UsIGlkVG9rZW4pO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5kaXJlY3RseVNldEN1cnJlbnRVc2VyKHVzZXIpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignRmlyZWJhc2VTZXJ2ZXJBcHAgY291bGQgbm90IGxvZ2luIHVzZXIgd2l0aCBwcm92aWRlZCBhdXRoSWRUb2tlbjogJywgZXJyKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZGlyZWN0bHlTZXRDdXJyZW50VXNlcihudWxsKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBpbml0aWFsaXplQ3VycmVudFVzZXIocG9wdXBSZWRpcmVjdFJlc29sdmVyKSB7XG4gICAgICAgIGlmIChfaXNGaXJlYmFzZVNlcnZlckFwcCh0aGlzLmFwcCkpIHtcbiAgICAgICAgICAgIGNvbnN0IGlkVG9rZW4gPSB0aGlzLmFwcC5zZXR0aW5ncy5hdXRoSWRUb2tlbjtcbiAgICAgICAgICAgIGlmIChpZFRva2VuKSB7XG4gICAgICAgICAgICAgICAgLy8gU3RhcnQgdGhlIGF1dGggb3BlcmF0aW9uIGluIHRoZSBuZXh0IHRpY2sgdG8gYWxsb3cgYSBtb21lbnQgZm9yIHRoZSBjdXN0b21lcidzIGFwcCB0b1xuICAgICAgICAgICAgICAgIC8vIGF0dGFjaCBhbiBlbXVsYXRvciwgaWYgZGVzaXJlZC5cbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5pbml0aWFsaXplQ3VycmVudFVzZXJGcm9tSWRUb2tlbihpZFRva2VuKS50aGVuKHJlc29sdmUsIHJlc29sdmUpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRpcmVjdGx5U2V0Q3VycmVudFVzZXIobnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gRmlyc3QgY2hlY2sgdG8gc2VlIGlmIHdlIGhhdmUgYSBwZW5kaW5nIHJlZGlyZWN0IGV2ZW50LlxuICAgICAgICBjb25zdCBwcmV2aW91c2x5U3RvcmVkVXNlciA9IChhd2FpdCB0aGlzLmFzc2VydGVkUGVyc2lzdGVuY2UuZ2V0Q3VycmVudFVzZXIoKSk7XG4gICAgICAgIGxldCBmdXR1cmVDdXJyZW50VXNlciA9IHByZXZpb3VzbHlTdG9yZWRVc2VyO1xuICAgICAgICBsZXQgbmVlZHNUb2NoZWNrTWlkZGxld2FyZSA9IGZhbHNlO1xuICAgICAgICBpZiAocG9wdXBSZWRpcmVjdFJlc29sdmVyICYmIHRoaXMuY29uZmlnLmF1dGhEb21haW4pIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZ2V0T3JJbml0UmVkaXJlY3RQZXJzaXN0ZW5jZU1hbmFnZXIoKTtcbiAgICAgICAgICAgIGNvbnN0IHJlZGlyZWN0VXNlckV2ZW50SWQgPSB0aGlzLnJlZGlyZWN0VXNlcj8uX3JlZGlyZWN0RXZlbnRJZDtcbiAgICAgICAgICAgIGNvbnN0IHN0b3JlZFVzZXJFdmVudElkID0gZnV0dXJlQ3VycmVudFVzZXI/Ll9yZWRpcmVjdEV2ZW50SWQ7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnRyeVJlZGlyZWN0U2lnbkluKHBvcHVwUmVkaXJlY3RSZXNvbHZlcik7XG4gICAgICAgICAgICAvLyBJZiB0aGUgc3RvcmVkIHVzZXIgKGkuZS4gdGhlIG9sZCBcImN1cnJlbnRVc2VyXCIpIGhhcyBhIHJlZGlyZWN0SWQgdGhhdFxuICAgICAgICAgICAgLy8gbWF0Y2hlcyB0aGUgcmVkaXJlY3QgdXNlciwgdGhlbiB3ZSB3YW50IHRvIGluaXRpYWxseSBzaWduIGluIHdpdGggdGhlXG4gICAgICAgICAgICAvLyBuZXcgdXNlciBvYmplY3QgZnJvbSByZXN1bHQuXG4gICAgICAgICAgICAvLyBUT0RPKHNhbWdobyk6IE1vcmUgdGhvcm91Z2hseSB0ZXN0IGFsbCBvZiB0aGlzXG4gICAgICAgICAgICBpZiAoKCFyZWRpcmVjdFVzZXJFdmVudElkIHx8IHJlZGlyZWN0VXNlckV2ZW50SWQgPT09IHN0b3JlZFVzZXJFdmVudElkKSAmJlxuICAgICAgICAgICAgICAgIHJlc3VsdD8udXNlcikge1xuICAgICAgICAgICAgICAgIGZ1dHVyZUN1cnJlbnRVc2VyID0gcmVzdWx0LnVzZXI7XG4gICAgICAgICAgICAgICAgbmVlZHNUb2NoZWNrTWlkZGxld2FyZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgbm8gdXNlciBpbiBwZXJzaXN0ZW5jZSwgdGhlcmUgaXMgbm8gY3VycmVudCB1c2VyLiBTZXQgdG8gbnVsbC5cbiAgICAgICAgaWYgKCFmdXR1cmVDdXJyZW50VXNlcikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGlyZWN0bHlTZXRDdXJyZW50VXNlcihudWxsKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWZ1dHVyZUN1cnJlbnRVc2VyLl9yZWRpcmVjdEV2ZW50SWQpIHtcbiAgICAgICAgICAgIC8vIFRoaXMgaXNuJ3QgYSByZWRpcmVjdCBsaW5rIG9wZXJhdGlvbiwgd2UgY2FuIHJlbG9hZCBhbmQgYmFpbC5cbiAgICAgICAgICAgIC8vIEZpcnN0IHRob3VnaCwgZW5zdXJlIHRoYXQgd2UgY2hlY2sgdGhlIG1pZGRsZXdhcmUgaXMgaGFwcHkuXG4gICAgICAgICAgICBpZiAobmVlZHNUb2NoZWNrTWlkZGxld2FyZSkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYmVmb3JlU3RhdGVRdWV1ZS5ydW5NaWRkbGV3YXJlKGZ1dHVyZUN1cnJlbnRVc2VyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgZnV0dXJlQ3VycmVudFVzZXIgPSBwcmV2aW91c2x5U3RvcmVkVXNlcjtcbiAgICAgICAgICAgICAgICAgICAgLy8gV2Uga25vdyB0aGlzIGlzIGF2YWlsYWJsZSBzaW5jZSB0aGUgYml0IGlzIG9ubHkgc2V0IHdoZW4gdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlc29sdmVyIGlzIGF2YWlsYWJsZVxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wb3B1cFJlZGlyZWN0UmVzb2x2ZXIuX292ZXJyaWRlUmVkaXJlY3RSZXN1bHQodGhpcywgKCkgPT4gUHJvbWlzZS5yZWplY3QoZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmdXR1cmVDdXJyZW50VXNlcikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbG9hZEFuZFNldEN1cnJlbnRVc2VyT3JDbGVhcihmdXR1cmVDdXJyZW50VXNlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kaXJlY3RseVNldEN1cnJlbnRVc2VyKG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIF9hc3NlcnQodGhpcy5fcG9wdXBSZWRpcmVjdFJlc29sdmVyLCB0aGlzLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUiAqLyk7XG4gICAgICAgIGF3YWl0IHRoaXMuZ2V0T3JJbml0UmVkaXJlY3RQZXJzaXN0ZW5jZU1hbmFnZXIoKTtcbiAgICAgICAgLy8gSWYgdGhlIHJlZGlyZWN0IHVzZXIncyBldmVudCBJRCBtYXRjaGVzIHRoZSBjdXJyZW50IHVzZXIncyBldmVudCBJRCxcbiAgICAgICAgLy8gRE8gTk9UIHJlbG9hZCB0aGUgY3VycmVudCB1c2VyLCBvdGhlcndpc2UgdGhleSdsbCBiZSBjbGVhcmVkIGZyb20gc3RvcmFnZS5cbiAgICAgICAgLy8gVGhpcyBpcyBpbXBvcnRhbnQgZm9yIHRoZSByZWF1dGhlbnRpY2F0ZVdpdGhSZWRpcmVjdCgpIGZsb3cuXG4gICAgICAgIGlmICh0aGlzLnJlZGlyZWN0VXNlciAmJlxuICAgICAgICAgICAgdGhpcy5yZWRpcmVjdFVzZXIuX3JlZGlyZWN0RXZlbnRJZCA9PT0gZnV0dXJlQ3VycmVudFVzZXIuX3JlZGlyZWN0RXZlbnRJZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGlyZWN0bHlTZXRDdXJyZW50VXNlcihmdXR1cmVDdXJyZW50VXNlcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucmVsb2FkQW5kU2V0Q3VycmVudFVzZXJPckNsZWFyKGZ1dHVyZUN1cnJlbnRVc2VyKTtcbiAgICB9XG4gICAgYXN5bmMgdHJ5UmVkaXJlY3RTaWduSW4ocmVkaXJlY3RSZXNvbHZlcikge1xuICAgICAgICAvLyBUaGUgcmVkaXJlY3QgdXNlciBuZWVkcyB0byBiZSBjaGVja2VkIChhbmQgc2lnbmVkIGluIGlmIGF2YWlsYWJsZSlcbiAgICAgICAgLy8gZHVyaW5nIGF1dGggaW5pdGlhbGl6YXRpb24uIEFsbCBvZiB0aGUgbm9ybWFsIHNpZ24gaW4gYW5kIGxpbmsvcmVhdXRoXG4gICAgICAgIC8vIGZsb3dzIGNhbGwgYmFjayBpbnRvIGF1dGggYW5kIHB1c2ggdGhpbmdzIG9udG8gdGhlIHByb21pc2UgcXVldWUuIFdlXG4gICAgICAgIC8vIG5lZWQgdG8gYXdhaXQgdGhlIHJlc3VsdCBvZiB0aGUgcmVkaXJlY3Qgc2lnbiBpbiAqaW5zaWRlIHRoZSBwcm9taXNlXG4gICAgICAgIC8vIHF1ZXVlKi4gVGhpcyBwcmVzZW50cyBhIHByb2JsZW06IHdlIHJ1biBpbnRvIGRlYWRsb2NrLiBTZWU6XG4gICAgICAgIC8vICAgIOKUjD4gW0luaXRpYWxpemF0aW9uXSDilIDilIDilIDilIDilIDilJBcbiAgICAgICAgLy8gICAg4pSMPiBbPG90aGVyIHF1ZXVlIHRhc2tzPl0g4pSCXG4gICAgICAgIC8vICAgIOKUlOKUgCBbZ2V0UmVkaXJlY3RSZXN1bHRdIDzilIDilJhcbiAgICAgICAgLy8gICAgd2hlcmUgW10gYXJlIHRhc2tzIG9uIHRoZSBxdWV1ZSBhbmQgYXJyb3dzIGRlbm90ZSBhd2FpdHNcbiAgICAgICAgLy8gSW5pdGlhbGl6YXRpb24gd2lsbCBuZXZlciBjb21wbGV0ZSBiZWNhdXNlIGl0J3Mgd2FpdGluZyBvbiBzb21ldGhpbmdcbiAgICAgICAgLy8gdGhhdCdzIHdhaXRpbmcgZm9yIGluaXRpYWxpemF0aW9uIHRvIGNvbXBsZXRlIVxuICAgICAgICAvL1xuICAgICAgICAvLyBJbnN0ZWFkLCB0aGlzIG1ldGhvZCBjYWxscyBnZXRSZWRpcmVjdFJlc3VsdCgpIChzdG9yZWQgaW5cbiAgICAgICAgLy8gX2NvbXBsZXRlUmVkaXJlY3RGbikgd2l0aCBhbiBvcHRpb25hbCBwYXJhbWV0ZXIgdGhhdCBpbnN0cnVjdHMgYWxsIG9mXG4gICAgICAgIC8vIHRoZSB1bmRlcmx5aW5nIGF1dGggb3BlcmF0aW9ucyB0byBza2lwIGFueXRoaW5nIHRoYXQgbXV0YXRlcyBhdXRoIHN0YXRlLlxuICAgICAgICBsZXQgcmVzdWx0ID0gbnVsbDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdlIGtub3cgdGhpcy5fcG9wdXBSZWRpcmVjdFJlc29sdmVyIGlzIHNldCBzaW5jZSByZWRpcmVjdFJlc29sdmVyXG4gICAgICAgICAgICAvLyBpcyBwYXNzZWQgaW4uIFRoZSBfY29tcGxldGVSZWRpcmVjdEZuIGV4cGVjdHMgdGhlIHVud3JhcHBlZCBleHRlcm4uXG4gICAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLl9wb3B1cFJlZGlyZWN0UmVzb2x2ZXIuX2NvbXBsZXRlUmVkaXJlY3RGbih0aGlzLCByZWRpcmVjdFJlc29sdmVyLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgLy8gU3dhbGxvdyBhbnkgZXJyb3JzIGhlcmU7IHRoZSBjb2RlIGNhbiByZXRyaWV2ZSB0aGVtIGluXG4gICAgICAgICAgICAvLyBnZXRSZWRpcmVjdFJlc3VsdCgpLlxuICAgICAgICAgICAgYXdhaXQgdGhpcy5fc2V0UmVkaXJlY3RVc2VyKG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGFzeW5jIHJlbG9hZEFuZFNldEN1cnJlbnRVc2VyT3JDbGVhcih1c2VyKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBfcmVsb2FkV2l0aG91dFNhdmluZyh1c2VyKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgaWYgKGU/LmNvZGUgIT09XG4gICAgICAgICAgICAgICAgYGF1dGgvJHtcIm5ldHdvcmstcmVxdWVzdC1mYWlsZWRcIiAvKiBBdXRoRXJyb3JDb2RlLk5FVFdPUktfUkVRVUVTVF9GQUlMRUQgKi99YCkge1xuICAgICAgICAgICAgICAgIC8vIFNvbWV0aGluZydzIHdyb25nIHdpdGggdGhlIHVzZXIncyB0b2tlbi4gTG9nIHRoZW0gb3V0IGFuZCByZW1vdmVcbiAgICAgICAgICAgICAgICAvLyB0aGVtIGZyb20gc3RvcmFnZVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRpcmVjdGx5U2V0Q3VycmVudFVzZXIobnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuZGlyZWN0bHlTZXRDdXJyZW50VXNlcih1c2VyKTtcbiAgICB9XG4gICAgdXNlRGV2aWNlTGFuZ3VhZ2UoKSB7XG4gICAgICAgIHRoaXMubGFuZ3VhZ2VDb2RlID0gX2dldFVzZXJMYW5ndWFnZSgpO1xuICAgIH1cbiAgICBhc3luYyBfZGVsZXRlKCkge1xuICAgICAgICB0aGlzLl9kZWxldGVkID0gdHJ1ZTtcbiAgICB9XG4gICAgYXN5bmMgdXBkYXRlQ3VycmVudFVzZXIodXNlckV4dGVybikge1xuICAgICAgICBpZiAoX2lzRmlyZWJhc2VTZXJ2ZXJBcHAodGhpcy5hcHApKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoX3NlcnZlckFwcEN1cnJlbnRVc2VyT3BlcmF0aW9uTm90U3VwcG9ydGVkRXJyb3IodGhpcykpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRoZSBwdWJsaWMgdXBkYXRlQ3VycmVudFVzZXIgbWV0aG9kIG5lZWRzIHRvIG1ha2UgYSBjb3B5IG9mIHRoZSB1c2VyLFxuICAgICAgICAvLyBhbmQgYWxzbyBjaGVjayB0aGF0IHRoZSBwcm9qZWN0IG1hdGNoZXNcbiAgICAgICAgY29uc3QgdXNlciA9IHVzZXJFeHRlcm5cbiAgICAgICAgICAgID8gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXJFeHRlcm4pXG4gICAgICAgICAgICA6IG51bGw7XG4gICAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgICAgICBfYXNzZXJ0KHVzZXIuYXV0aC5jb25maWcuYXBpS2V5ID09PSB0aGlzLmNvbmZpZy5hcGlLZXksIHRoaXMsIFwiaW52YWxpZC11c2VyLXRva2VuXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0FVVEggKi8pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl91cGRhdGVDdXJyZW50VXNlcih1c2VyICYmIHVzZXIuX2Nsb25lKHRoaXMpKTtcbiAgICB9XG4gICAgYXN5bmMgX3VwZGF0ZUN1cnJlbnRVc2VyKHVzZXIsIHNraXBCZWZvcmVTdGF0ZUNhbGxiYWNrcyA9IGZhbHNlKSB7XG4gICAgICAgIGlmICh0aGlzLl9kZWxldGVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgICAgIF9hc3NlcnQodGhpcy50ZW5hbnRJZCA9PT0gdXNlci50ZW5hbnRJZCwgdGhpcywgXCJ0ZW5hbnQtaWQtbWlzbWF0Y2hcIiAvKiBBdXRoRXJyb3JDb2RlLlRFTkFOVF9JRF9NSVNNQVRDSCAqLyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFza2lwQmVmb3JlU3RhdGVDYWxsYmFja3MpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYmVmb3JlU3RhdGVRdWV1ZS5ydW5NaWRkbGV3YXJlKHVzZXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnF1ZXVlKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZGlyZWN0bHlTZXRDdXJyZW50VXNlcih1c2VyKTtcbiAgICAgICAgICAgIHRoaXMubm90aWZ5QXV0aExpc3RlbmVycygpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgYXN5bmMgc2lnbk91dCgpIHtcbiAgICAgICAgaWYgKF9pc0ZpcmViYXNlU2VydmVyQXBwKHRoaXMuYXBwKSkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KF9zZXJ2ZXJBcHBDdXJyZW50VXNlck9wZXJhdGlvbk5vdFN1cHBvcnRlZEVycm9yKHRoaXMpKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBSdW4gZmlyc3QsIHRvIGJsb2NrIF9zZXRSZWRpcmVjdFVzZXIoKSBpZiBhbnkgY2FsbGJhY2tzIGZhaWwuXG4gICAgICAgIGF3YWl0IHRoaXMuYmVmb3JlU3RhdGVRdWV1ZS5ydW5NaWRkbGV3YXJlKG51bGwpO1xuICAgICAgICAvLyBDbGVhciB0aGUgcmVkaXJlY3QgdXNlciB3aGVuIHNpZ25PdXQgaXMgY2FsbGVkXG4gICAgICAgIGlmICh0aGlzLnJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyIHx8IHRoaXMuX3BvcHVwUmVkaXJlY3RSZXNvbHZlcikge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5fc2V0UmVkaXJlY3RVc2VyKG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFByZXZlbnQgY2FsbGJhY2tzIGZyb20gYmVpbmcgY2FsbGVkIGFnYWluIGluIF91cGRhdGVDdXJyZW50VXNlciwgYXNcbiAgICAgICAgLy8gdGhleSB3ZXJlIGFscmVhZHkgY2FsbGVkIGluIHRoZSBmaXJzdCBsaW5lLlxuICAgICAgICByZXR1cm4gdGhpcy5fdXBkYXRlQ3VycmVudFVzZXIobnVsbCwgLyogc2tpcEJlZm9yZVN0YXRlQ2FsbGJhY2tzICovIHRydWUpO1xuICAgIH1cbiAgICBzZXRQZXJzaXN0ZW5jZShwZXJzaXN0ZW5jZSkge1xuICAgICAgICBpZiAoX2lzRmlyZWJhc2VTZXJ2ZXJBcHAodGhpcy5hcHApKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoX3NlcnZlckFwcEN1cnJlbnRVc2VyT3BlcmF0aW9uTm90U3VwcG9ydGVkRXJyb3IodGhpcykpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnF1ZXVlKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXNzZXJ0ZWRQZXJzaXN0ZW5jZS5zZXRQZXJzaXN0ZW5jZShfZ2V0SW5zdGFuY2UocGVyc2lzdGVuY2UpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIF9nZXRSZWNhcHRjaGFDb25maWcoKSB7XG4gICAgICAgIGlmICh0aGlzLnRlbmFudElkID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hZ2VudFJlY2FwdGNoYUNvbmZpZztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90ZW5hbnRSZWNhcHRjaGFDb25maWdzW3RoaXMudGVuYW50SWRdO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFzeW5jIHZhbGlkYXRlUGFzc3dvcmQocGFzc3dvcmQpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9nZXRQYXNzd29yZFBvbGljeUludGVybmFsKCkpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuX3VwZGF0ZVBhc3N3b3JkUG9saWN5KCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gUGFzc3dvcmQgcG9saWN5IHdpbGwgYmUgZGVmaW5lZCBhZnRlciBmZXRjaGluZy5cbiAgICAgICAgY29uc3QgcGFzc3dvcmRQb2xpY3kgPSB0aGlzLl9nZXRQYXNzd29yZFBvbGljeUludGVybmFsKCk7XG4gICAgICAgIC8vIENoZWNrIHRoYXQgdGhlIHBvbGljeSBzY2hlbWEgdmVyc2lvbiBpcyBzdXBwb3J0ZWQgYnkgdGhlIFNESy5cbiAgICAgICAgLy8gVE9ETzogVXBkYXRlIHRoaXMgbG9naWMgdG8gdXNlIGEgbWF4IHN1cHBvcnRlZCBwb2xpY3kgc2NoZW1hIHZlcnNpb24gb25jZSB3ZSBoYXZlIG11bHRpcGxlIHNjaGVtYSB2ZXJzaW9ucy5cbiAgICAgICAgaWYgKHBhc3N3b3JkUG9saWN5LnNjaGVtYVZlcnNpb24gIT09XG4gICAgICAgICAgICB0aGlzLkVYUEVDVEVEX1BBU1NXT1JEX1BPTElDWV9TQ0hFTUFfVkVSU0lPTikge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHRoaXMuX2Vycm9yRmFjdG9yeS5jcmVhdGUoXCJ1bnN1cHBvcnRlZC1wYXNzd29yZC1wb2xpY3ktc2NoZW1hLXZlcnNpb25cIiAvKiBBdXRoRXJyb3JDb2RlLlVOU1VQUE9SVEVEX1BBU1NXT1JEX1BPTElDWV9TQ0hFTUFfVkVSU0lPTiAqLywge30pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFzc3dvcmRQb2xpY3kudmFsaWRhdGVQYXNzd29yZChwYXNzd29yZCk7XG4gICAgfVxuICAgIF9nZXRQYXNzd29yZFBvbGljeUludGVybmFsKCkge1xuICAgICAgICBpZiAodGhpcy50ZW5hbnRJZCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Byb2plY3RQYXNzd29yZFBvbGljeTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90ZW5hbnRQYXNzd29yZFBvbGljaWVzW3RoaXMudGVuYW50SWRdO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFzeW5jIF91cGRhdGVQYXNzd29yZFBvbGljeSgpIHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBfZ2V0UGFzc3dvcmRQb2xpY3kodGhpcyk7XG4gICAgICAgIGNvbnN0IHBhc3N3b3JkUG9saWN5ID0gbmV3IFBhc3N3b3JkUG9saWN5SW1wbChyZXNwb25zZSk7XG4gICAgICAgIGlmICh0aGlzLnRlbmFudElkID09PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLl9wcm9qZWN0UGFzc3dvcmRQb2xpY3kgPSBwYXNzd29yZFBvbGljeTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3RlbmFudFBhc3N3b3JkUG9saWNpZXNbdGhpcy50ZW5hbnRJZF0gPSBwYXNzd29yZFBvbGljeTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfZ2V0UGVyc2lzdGVuY2VUeXBlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hc3NlcnRlZFBlcnNpc3RlbmNlLnBlcnNpc3RlbmNlLnR5cGU7XG4gICAgfVxuICAgIF9nZXRQZXJzaXN0ZW5jZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXNzZXJ0ZWRQZXJzaXN0ZW5jZS5wZXJzaXN0ZW5jZTtcbiAgICB9XG4gICAgX3VwZGF0ZUVycm9yTWFwKGVycm9yTWFwKSB7XG4gICAgICAgIHRoaXMuX2Vycm9yRmFjdG9yeSA9IG5ldyBFcnJvckZhY3RvcnkoJ2F1dGgnLCAnRmlyZWJhc2UnLCBlcnJvck1hcCgpKTtcbiAgICB9XG4gICAgb25BdXRoU3RhdGVDaGFuZ2VkKG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGVkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlZ2lzdGVyU3RhdGVMaXN0ZW5lcih0aGlzLmF1dGhTdGF0ZVN1YnNjcmlwdGlvbiwgbmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZWQpO1xuICAgIH1cbiAgICBiZWZvcmVBdXRoU3RhdGVDaGFuZ2VkKGNhbGxiYWNrLCBvbkFib3J0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJlZm9yZVN0YXRlUXVldWUucHVzaENhbGxiYWNrKGNhbGxiYWNrLCBvbkFib3J0KTtcbiAgICB9XG4gICAgb25JZFRva2VuQ2hhbmdlZChuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZWdpc3RlclN0YXRlTGlzdGVuZXIodGhpcy5pZFRva2VuU3Vic2NyaXB0aW9uLCBuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlZCk7XG4gICAgfVxuICAgIGF1dGhTdGF0ZVJlYWR5KCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCB1bnN1YnNjcmliZSA9IHRoaXMub25BdXRoU3RhdGVDaGFuZ2VkKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIH0sIHJlamVjdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXZva2VzIHRoZSBnaXZlbiBhY2Nlc3MgdG9rZW4uIEN1cnJlbnRseSBvbmx5IHN1cHBvcnRzIEFwcGxlIE9BdXRoIGFjY2VzcyB0b2tlbnMuXG4gICAgICovXG4gICAgYXN5bmMgcmV2b2tlQWNjZXNzVG9rZW4odG9rZW4pIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IGlkVG9rZW4gPSBhd2FpdCB0aGlzLmN1cnJlbnRVc2VyLmdldElkVG9rZW4oKTtcbiAgICAgICAgICAgIC8vIEdlbmVyYWxpemUgdGhpcyB0byBhY2NlcHQgb3RoZXIgcHJvdmlkZXJzIG9uY2Ugc3VwcG9ydGVkLlxuICAgICAgICAgICAgY29uc3QgcmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICBwcm92aWRlcklkOiAnYXBwbGUuY29tJyxcbiAgICAgICAgICAgICAgICB0b2tlblR5cGU6IFwiQUNDRVNTX1RPS0VOXCIgLyogVG9rZW5UeXBlLkFDQ0VTU19UT0tFTiAqLyxcbiAgICAgICAgICAgICAgICB0b2tlbixcbiAgICAgICAgICAgICAgICBpZFRva2VuXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKHRoaXMudGVuYW50SWQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJlcXVlc3QudGVuYW50SWQgPSB0aGlzLnRlbmFudElkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgcmV2b2tlVG9rZW4odGhpcywgcmVxdWVzdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYXBpS2V5OiB0aGlzLmNvbmZpZy5hcGlLZXksXG4gICAgICAgICAgICBhdXRoRG9tYWluOiB0aGlzLmNvbmZpZy5hdXRoRG9tYWluLFxuICAgICAgICAgICAgYXBwTmFtZTogdGhpcy5uYW1lLFxuICAgICAgICAgICAgY3VycmVudFVzZXI6IHRoaXMuX2N1cnJlbnRVc2VyPy50b0pTT04oKVxuICAgICAgICB9O1xuICAgIH1cbiAgICBhc3luYyBfc2V0UmVkaXJlY3RVc2VyKHVzZXIsIHBvcHVwUmVkaXJlY3RSZXNvbHZlcikge1xuICAgICAgICBjb25zdCByZWRpcmVjdE1hbmFnZXIgPSBhd2FpdCB0aGlzLmdldE9ySW5pdFJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyKHBvcHVwUmVkaXJlY3RSZXNvbHZlcik7XG4gICAgICAgIHJldHVybiB1c2VyID09PSBudWxsXG4gICAgICAgICAgICA/IHJlZGlyZWN0TWFuYWdlci5yZW1vdmVDdXJyZW50VXNlcigpXG4gICAgICAgICAgICA6IHJlZGlyZWN0TWFuYWdlci5zZXRDdXJyZW50VXNlcih1c2VyKTtcbiAgICB9XG4gICAgYXN5bmMgZ2V0T3JJbml0UmVkaXJlY3RQZXJzaXN0ZW5jZU1hbmFnZXIocG9wdXBSZWRpcmVjdFJlc29sdmVyKSB7XG4gICAgICAgIGlmICghdGhpcy5yZWRpcmVjdFBlcnNpc3RlbmNlTWFuYWdlcikge1xuICAgICAgICAgICAgY29uc3QgcmVzb2x2ZXIgPSAocG9wdXBSZWRpcmVjdFJlc29sdmVyICYmIF9nZXRJbnN0YW5jZShwb3B1cFJlZGlyZWN0UmVzb2x2ZXIpKSB8fFxuICAgICAgICAgICAgICAgIHRoaXMuX3BvcHVwUmVkaXJlY3RSZXNvbHZlcjtcbiAgICAgICAgICAgIF9hc3NlcnQocmVzb2x2ZXIsIHRoaXMsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SICovKTtcbiAgICAgICAgICAgIHRoaXMucmVkaXJlY3RQZXJzaXN0ZW5jZU1hbmFnZXIgPSBhd2FpdCBQZXJzaXN0ZW5jZVVzZXJNYW5hZ2VyLmNyZWF0ZSh0aGlzLCBbX2dldEluc3RhbmNlKHJlc29sdmVyLl9yZWRpcmVjdFBlcnNpc3RlbmNlKV0sIFwicmVkaXJlY3RVc2VyXCIgLyogS2V5TmFtZS5SRURJUkVDVF9VU0VSICovKTtcbiAgICAgICAgICAgIHRoaXMucmVkaXJlY3RVc2VyID1cbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyLmdldEN1cnJlbnRVc2VyKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucmVkaXJlY3RQZXJzaXN0ZW5jZU1hbmFnZXI7XG4gICAgfVxuICAgIGFzeW5jIF9yZWRpcmVjdFVzZXJGb3JJZChpZCkge1xuICAgICAgICAvLyBNYWtlIHN1cmUgd2UndmUgY2xlYXJlZCBhbnkgcGVuZGluZyBwZXJzaXN0ZW5jZSBhY3Rpb25zIGlmIHdlJ3JlIG5vdCBpblxuICAgICAgICAvLyB0aGUgaW5pdGlhbGl6ZXJcbiAgICAgICAgaWYgKHRoaXMuX2lzSW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucXVldWUoYXN5bmMgKCkgPT4geyB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fY3VycmVudFVzZXI/Ll9yZWRpcmVjdEV2ZW50SWQgPT09IGlkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY3VycmVudFVzZXI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucmVkaXJlY3RVc2VyPy5fcmVkaXJlY3RFdmVudElkID09PSBpZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVkaXJlY3RVc2VyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBhc3luYyBfcGVyc2lzdFVzZXJJZkN1cnJlbnQodXNlcikge1xuICAgICAgICBpZiAodXNlciA9PT0gdGhpcy5jdXJyZW50VXNlcikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucXVldWUoYXN5bmMgKCkgPT4gdGhpcy5kaXJlY3RseVNldEN1cnJlbnRVc2VyKHVzZXIpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKiogTm90aWZpZXMgbGlzdGVuZXJzIG9ubHkgaWYgdGhlIHVzZXIgaXMgY3VycmVudCAqL1xuICAgIF9ub3RpZnlMaXN0ZW5lcnNJZkN1cnJlbnQodXNlcikge1xuICAgICAgICBpZiAodXNlciA9PT0gdGhpcy5jdXJyZW50VXNlcikge1xuICAgICAgICAgICAgdGhpcy5ub3RpZnlBdXRoTGlzdGVuZXJzKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2tleSgpIHtcbiAgICAgICAgcmV0dXJuIGAke3RoaXMuY29uZmlnLmF1dGhEb21haW59OiR7dGhpcy5jb25maWcuYXBpS2V5fToke3RoaXMubmFtZX1gO1xuICAgIH1cbiAgICBfc3RhcnRQcm9hY3RpdmVSZWZyZXNoKCkge1xuICAgICAgICB0aGlzLmlzUHJvYWN0aXZlUmVmcmVzaEVuYWJsZWQgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5jdXJyZW50VXNlcikge1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudFVzZXIuX3N0YXJ0UHJvYWN0aXZlUmVmcmVzaCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9zdG9wUHJvYWN0aXZlUmVmcmVzaCgpIHtcbiAgICAgICAgdGhpcy5pc1Byb2FjdGl2ZVJlZnJlc2hFbmFibGVkID0gZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRVc2VyKSB7XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50VXNlci5fc3RvcFByb2FjdGl2ZVJlZnJlc2goKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKiogUmV0dXJucyB0aGUgY3VycmVudCB1c2VyIGNhc3QgYXMgdGhlIGludGVybmFsIHR5cGUgKi9cbiAgICBnZXQgX2N1cnJlbnRVc2VyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50VXNlcjtcbiAgICB9XG4gICAgbm90aWZ5QXV0aExpc3RlbmVycygpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9pc0luaXRpYWxpemVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pZFRva2VuU3Vic2NyaXB0aW9uLm5leHQodGhpcy5jdXJyZW50VXNlcik7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRVaWQgPSB0aGlzLmN1cnJlbnRVc2VyPy51aWQgPz8gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMubGFzdE5vdGlmaWVkVWlkICE9PSBjdXJyZW50VWlkKSB7XG4gICAgICAgICAgICB0aGlzLmxhc3ROb3RpZmllZFVpZCA9IGN1cnJlbnRVaWQ7XG4gICAgICAgICAgICB0aGlzLmF1dGhTdGF0ZVN1YnNjcmlwdGlvbi5uZXh0KHRoaXMuY3VycmVudFVzZXIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlZ2lzdGVyU3RhdGVMaXN0ZW5lcihzdWJzY3JpcHRpb24sIG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGVkKSB7XG4gICAgICAgIGlmICh0aGlzLl9kZWxldGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4geyB9O1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNiID0gdHlwZW9mIG5leHRPck9ic2VydmVyID09PSAnZnVuY3Rpb24nXG4gICAgICAgICAgICA/IG5leHRPck9ic2VydmVyXG4gICAgICAgICAgICA6IG5leHRPck9ic2VydmVyLm5leHQuYmluZChuZXh0T3JPYnNlcnZlcik7XG4gICAgICAgIGxldCBpc1Vuc3Vic2NyaWJlZCA9IGZhbHNlO1xuICAgICAgICBjb25zdCBwcm9taXNlID0gdGhpcy5faXNJbml0aWFsaXplZFxuICAgICAgICAgICAgPyBQcm9taXNlLnJlc29sdmUoKVxuICAgICAgICAgICAgOiB0aGlzLl9pbml0aWFsaXphdGlvblByb21pc2U7XG4gICAgICAgIF9hc3NlcnQocHJvbWlzZSwgdGhpcywgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgICAgICAvLyBUaGUgY2FsbGJhY2sgbmVlZHMgdG8gYmUgY2FsbGVkIGFzeW5jaHJvbm91c2x5IHBlciB0aGUgc3BlYy5cbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xuICAgICAgICBwcm9taXNlLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgaWYgKGlzVW5zdWJzY3JpYmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2IodGhpcy5jdXJyZW50VXNlcik7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodHlwZW9mIG5leHRPck9ic2VydmVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjb25zdCB1bnN1YnNjcmliZSA9IHN1YnNjcmlwdGlvbi5hZGRPYnNlcnZlcihuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlZCk7XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlzVW5zdWJzY3JpYmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB1bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHVuc3Vic2NyaWJlID0gc3Vic2NyaXB0aW9uLmFkZE9ic2VydmVyKG5leHRPck9ic2VydmVyKTtcbiAgICAgICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaXNVbnN1YnNjcmliZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVucHJvdGVjdGVkIChmcm9tIHJhY2UgY29uZGl0aW9ucykgbWV0aG9kIHRvIHNldCB0aGUgY3VycmVudCB1c2VyLiBUaGlzXG4gICAgICogc2hvdWxkIG9ubHkgYmUgY2FsbGVkIGZyb20gd2l0aGluIGEgcXVldWVkIGNhbGxiYWNrLiBUaGlzIGlzIG5lY2Vzc2FyeVxuICAgICAqIGJlY2F1c2UgdGhlIHF1ZXVlIHNob3VsZG4ndCByZWx5IG9uIGFub3RoZXIgcXVldWVkIGNhbGxiYWNrLlxuICAgICAqL1xuICAgIGFzeW5jIGRpcmVjdGx5U2V0Q3VycmVudFVzZXIodXNlcikge1xuICAgICAgICBpZiAodGhpcy5jdXJyZW50VXNlciAmJiB0aGlzLmN1cnJlbnRVc2VyICE9PSB1c2VyKSB7XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50VXNlci5fc3RvcFByb2FjdGl2ZVJlZnJlc2goKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXNlciAmJiB0aGlzLmlzUHJvYWN0aXZlUmVmcmVzaEVuYWJsZWQpIHtcbiAgICAgICAgICAgIHVzZXIuX3N0YXJ0UHJvYWN0aXZlUmVmcmVzaCgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY3VycmVudFVzZXIgPSB1c2VyO1xuICAgICAgICBpZiAodXNlcikge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5hc3NlcnRlZFBlcnNpc3RlbmNlLnNldEN1cnJlbnRVc2VyKHVzZXIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5hc3NlcnRlZFBlcnNpc3RlbmNlLnJlbW92ZUN1cnJlbnRVc2VyKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWUoYWN0aW9uKSB7XG4gICAgICAgIC8vIEluIGNhc2Ugc29tZXRoaW5nIGVycm9ycywgdGhlIGNhbGxiYWNrIHN0aWxsIHNob3VsZCBiZSBjYWxsZWQgaW4gb3JkZXJcbiAgICAgICAgLy8gdG8ga2VlcCB0aGUgcHJvbWlzZSBjaGFpbiBhbGl2ZVxuICAgICAgICB0aGlzLm9wZXJhdGlvbnMgPSB0aGlzLm9wZXJhdGlvbnMudGhlbihhY3Rpb24sIGFjdGlvbik7XG4gICAgICAgIHJldHVybiB0aGlzLm9wZXJhdGlvbnM7XG4gICAgfVxuICAgIGdldCBhc3NlcnRlZFBlcnNpc3RlbmNlKCkge1xuICAgICAgICBfYXNzZXJ0KHRoaXMucGVyc2lzdGVuY2VNYW5hZ2VyLCB0aGlzLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlTWFuYWdlcjtcbiAgICB9XG4gICAgX2xvZ0ZyYW1ld29yayhmcmFtZXdvcmspIHtcbiAgICAgICAgaWYgKCFmcmFtZXdvcmsgfHwgdGhpcy5mcmFtZXdvcmtzLmluY2x1ZGVzKGZyYW1ld29yaykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmZyYW1ld29ya3MucHVzaChmcmFtZXdvcmspO1xuICAgICAgICAvLyBTb3J0IGFscGhhYmV0aWNhbGx5IHNvIHRoYXQgXCJGaXJlYmFzZUNvcmUtd2ViLEZpcmViYXNlVUktd2ViXCIgYW5kXG4gICAgICAgIC8vIFwiRmlyZWJhc2VVSS13ZWIsRmlyZWJhc2VDb3JlLXdlYlwiIGFyZW4ndCB2aWV3ZWQgYXMgZGlmZmVyZW50LlxuICAgICAgICB0aGlzLmZyYW1ld29ya3Muc29ydCgpO1xuICAgICAgICB0aGlzLmNsaWVudFZlcnNpb24gPSBfZ2V0Q2xpZW50VmVyc2lvbih0aGlzLmNvbmZpZy5jbGllbnRQbGF0Zm9ybSwgdGhpcy5fZ2V0RnJhbWV3b3JrcygpKTtcbiAgICB9XG4gICAgX2dldEZyYW1ld29ya3MoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZyYW1ld29ya3M7XG4gICAgfVxuICAgIGFzeW5jIF9nZXRBZGRpdGlvbmFsSGVhZGVycygpIHtcbiAgICAgICAgLy8gQWRkaXRpb25hbCBoZWFkZXJzIG9uIGV2ZXJ5IHJlcXVlc3RcbiAgICAgICAgY29uc3QgaGVhZGVycyA9IHtcbiAgICAgICAgICAgIFtcIlgtQ2xpZW50LVZlcnNpb25cIiAvKiBIdHRwSGVhZGVyLlhfQ0xJRU5UX1ZFUlNJT04gKi9dOiB0aGlzLmNsaWVudFZlcnNpb25cbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuYXBwLm9wdGlvbnMuYXBwSWQpIHtcbiAgICAgICAgICAgIGhlYWRlcnNbXCJYLUZpcmViYXNlLWdtcGlkXCIgLyogSHR0cEhlYWRlci5YX0ZJUkVCQVNFX0dNUElEICovXSA9IHRoaXMuYXBwLm9wdGlvbnMuYXBwSWQ7XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgdGhlIGhlYXJ0YmVhdCBzZXJ2aWNlIGV4aXN0cywgYWRkIHRoZSBoZWFydGJlYXQgc3RyaW5nXG4gICAgICAgIGNvbnN0IGhlYXJ0YmVhdHNIZWFkZXIgPSBhd2FpdCB0aGlzLmhlYXJ0YmVhdFNlcnZpY2VQcm92aWRlclxuICAgICAgICAgICAgLmdldEltbWVkaWF0ZSh7XG4gICAgICAgICAgICBvcHRpb25hbDogdHJ1ZVxuICAgICAgICB9KVxuICAgICAgICAgICAgPy5nZXRIZWFydGJlYXRzSGVhZGVyKCk7XG4gICAgICAgIGlmIChoZWFydGJlYXRzSGVhZGVyKSB7XG4gICAgICAgICAgICBoZWFkZXJzW1wiWC1GaXJlYmFzZS1DbGllbnRcIiAvKiBIdHRwSGVhZGVyLlhfRklSRUJBU0VfQ0xJRU5UICovXSA9IGhlYXJ0YmVhdHNIZWFkZXI7XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgdGhlIEFwcCBDaGVjayBzZXJ2aWNlIGV4aXN0cywgYWRkIHRoZSBBcHAgQ2hlY2sgdG9rZW4gaW4gdGhlIGhlYWRlcnNcbiAgICAgICAgY29uc3QgYXBwQ2hlY2tUb2tlbiA9IGF3YWl0IHRoaXMuX2dldEFwcENoZWNrVG9rZW4oKTtcbiAgICAgICAgaWYgKGFwcENoZWNrVG9rZW4pIHtcbiAgICAgICAgICAgIGhlYWRlcnNbXCJYLUZpcmViYXNlLUFwcENoZWNrXCIgLyogSHR0cEhlYWRlci5YX0ZJUkVCQVNFX0FQUF9DSEVDSyAqL10gPSBhcHBDaGVja1Rva2VuO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBoZWFkZXJzO1xuICAgIH1cbiAgICBhc3luYyBfZ2V0QXBwQ2hlY2tUb2tlbigpIHtcbiAgICAgICAgaWYgKF9pc0ZpcmViYXNlU2VydmVyQXBwKHRoaXMuYXBwKSAmJiB0aGlzLmFwcC5zZXR0aW5ncy5hcHBDaGVja1Rva2VuKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hcHAuc2V0dGluZ3MuYXBwQ2hlY2tUb2tlbjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBhcHBDaGVja1Rva2VuUmVzdWx0ID0gYXdhaXQgdGhpcy5hcHBDaGVja1NlcnZpY2VQcm92aWRlclxuICAgICAgICAgICAgLmdldEltbWVkaWF0ZSh7IG9wdGlvbmFsOiB0cnVlIH0pXG4gICAgICAgICAgICA/LmdldFRva2VuKCk7XG4gICAgICAgIGlmIChhcHBDaGVja1Rva2VuUmVzdWx0Py5lcnJvcikge1xuICAgICAgICAgICAgLy8gQ29udGV4dDogYXBwQ2hlY2suZ2V0VG9rZW4oKSB3aWxsIG5ldmVyIHRocm93IGV2ZW4gaWYgYW4gZXJyb3IgaGFwcGVuZWQuXG4gICAgICAgICAgICAvLyBJbiB0aGUgZXJyb3IgY2FzZSwgYSBkdW1teSB0b2tlbiB3aWxsIGJlIHJldHVybmVkIGFsb25nIHdpdGggYW4gZXJyb3IgZmllbGQgZGVzY3JpYmluZ1xuICAgICAgICAgICAgLy8gdGhlIGVycm9yLiBJbiBnZW5lcmFsLCB3ZSBzaG91bGRuJ3QgY2FyZSBhYm91dCB0aGUgZXJyb3IgY29uZGl0aW9uIGFuZCBqdXN0IHVzZVxuICAgICAgICAgICAgLy8gdGhlIHRva2VuIChhY3R1YWwgb3IgZHVtbXkpIHRvIHNlbmQgcmVxdWVzdHMuXG4gICAgICAgICAgICBfbG9nV2FybihgRXJyb3Igd2hpbGUgcmV0cmlldmluZyBBcHAgQ2hlY2sgdG9rZW46ICR7YXBwQ2hlY2tUb2tlblJlc3VsdC5lcnJvcn1gKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXBwQ2hlY2tUb2tlblJlc3VsdD8udG9rZW47XG4gICAgfVxufVxuLyoqXG4gKiBNZXRob2QgdG8gYmUgdXNlZCB0byBjYXN0IGRvd24gdG8gb3VyIHByaXZhdGUgaW1wbGVtZW50YXRpb24gb2YgQXV0aC5cbiAqIEl0IHdpbGwgYWxzbyBoYW5kbGUgdW53cmFwcGluZyBmcm9tIHRoZSBjb21wYXQgdHlwZSBpZiBuZWNlc3NhcnlcbiAqXG4gKiBAcGFyYW0gYXV0aCBBdXRoIG9iamVjdCBwYXNzZWQgaW4gZnJvbSBkZXZlbG9wZXJcbiAqL1xuZnVuY3Rpb24gX2Nhc3RBdXRoKGF1dGgpIHtcbiAgICByZXR1cm4gZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpO1xufVxuLyoqIEhlbHBlciBjbGFzcyB0byB3cmFwIHN1YnNjcmliZXIgbG9naWMgKi9cbmNsYXNzIFN1YnNjcmlwdGlvbiB7XG4gICAgY29uc3RydWN0b3IoYXV0aCkge1xuICAgICAgICB0aGlzLmF1dGggPSBhdXRoO1xuICAgICAgICB0aGlzLm9ic2VydmVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5hZGRPYnNlcnZlciA9IGNyZWF0ZVN1YnNjcmliZShvYnNlcnZlciA9PiAodGhpcy5vYnNlcnZlciA9IG9ic2VydmVyKSk7XG4gICAgfVxuICAgIGdldCBuZXh0KCkge1xuICAgICAgICBfYXNzZXJ0KHRoaXMub2JzZXJ2ZXIsIHRoaXMuYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgICAgICByZXR1cm4gdGhpcy5vYnNlcnZlci5uZXh0LmJpbmQodGhpcy5vYnNlcnZlcik7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xubGV0IGV4dGVybmFsSlNQcm92aWRlciA9IHtcbiAgICBhc3luYyBsb2FkSlMoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVW5hYmxlIHRvIGxvYWQgZXh0ZXJuYWwgc2NyaXB0cycpO1xuICAgIH0sXG4gICAgcmVjYXB0Y2hhVjJTY3JpcHQ6ICcnLFxuICAgIHJlY2FwdGNoYUVudGVycHJpc2VTY3JpcHQ6ICcnLFxuICAgIGdhcGlTY3JpcHQ6ICcnXG59O1xuZnVuY3Rpb24gX3NldEV4dGVybmFsSlNQcm92aWRlcihwKSB7XG4gICAgZXh0ZXJuYWxKU1Byb3ZpZGVyID0gcDtcbn1cbmZ1bmN0aW9uIF9sb2FkSlModXJsKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsSlNQcm92aWRlci5sb2FkSlModXJsKTtcbn1cbmZ1bmN0aW9uIF9yZWNhcHRjaGFWMlNjcmlwdFVybCgpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxKU1Byb3ZpZGVyLnJlY2FwdGNoYVYyU2NyaXB0O1xufVxuZnVuY3Rpb24gX3JlY2FwdGNoYUVudGVycHJpc2VTY3JpcHRVcmwoKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsSlNQcm92aWRlci5yZWNhcHRjaGFFbnRlcnByaXNlU2NyaXB0O1xufVxuZnVuY3Rpb24gX2dhcGlTY3JpcHRVcmwoKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsSlNQcm92aWRlci5nYXBpU2NyaXB0O1xufVxuZnVuY3Rpb24gX2dlbmVyYXRlQ2FsbGJhY2tOYW1lKHByZWZpeCkge1xuICAgIHJldHVybiBgX18ke3ByZWZpeH0ke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwMDApfWA7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jb25zdCBfU09MVkVfVElNRV9NUyA9IDUwMDtcbmNvbnN0IF9FWFBJUkFUSU9OX1RJTUVfTVMgPSA2MDAwMDtcbmNvbnN0IF9XSURHRVRfSURfU1RBUlQgPSAxMDAwMDAwMDAwMDAwO1xuY2xhc3MgTW9ja1JlQ2FwdGNoYSB7XG4gICAgY29uc3RydWN0b3IoYXV0aCkge1xuICAgICAgICB0aGlzLmF1dGggPSBhdXRoO1xuICAgICAgICB0aGlzLmNvdW50ZXIgPSBfV0lER0VUX0lEX1NUQVJUO1xuICAgICAgICB0aGlzLl93aWRnZXRzID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgICByZW5kZXIoY29udGFpbmVyLCBwYXJhbWV0ZXJzKSB7XG4gICAgICAgIGNvbnN0IGlkID0gdGhpcy5jb3VudGVyO1xuICAgICAgICB0aGlzLl93aWRnZXRzLnNldChpZCwgbmV3IE1vY2tXaWRnZXQoY29udGFpbmVyLCB0aGlzLmF1dGgubmFtZSwgcGFyYW1ldGVycyB8fCB7fSkpO1xuICAgICAgICB0aGlzLmNvdW50ZXIrKztcbiAgICAgICAgcmV0dXJuIGlkO1xuICAgIH1cbiAgICByZXNldChvcHRXaWRnZXRJZCkge1xuICAgICAgICBjb25zdCBpZCA9IG9wdFdpZGdldElkIHx8IF9XSURHRVRfSURfU1RBUlQ7XG4gICAgICAgIHZvaWQgdGhpcy5fd2lkZ2V0cy5nZXQoaWQpPy5kZWxldGUoKTtcbiAgICAgICAgdGhpcy5fd2lkZ2V0cy5kZWxldGUoaWQpO1xuICAgIH1cbiAgICBnZXRSZXNwb25zZShvcHRXaWRnZXRJZCkge1xuICAgICAgICBjb25zdCBpZCA9IG9wdFdpZGdldElkIHx8IF9XSURHRVRfSURfU1RBUlQ7XG4gICAgICAgIHJldHVybiB0aGlzLl93aWRnZXRzLmdldChpZCk/LmdldFJlc3BvbnNlKCkgfHwgJyc7XG4gICAgfVxuICAgIGFzeW5jIGV4ZWN1dGUob3B0V2lkZ2V0SWQpIHtcbiAgICAgICAgY29uc3QgaWQgPSBvcHRXaWRnZXRJZCB8fCBfV0lER0VUX0lEX1NUQVJUO1xuICAgICAgICB2b2lkIHRoaXMuX3dpZGdldHMuZ2V0KGlkKT8uZXhlY3V0ZSgpO1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxufVxuY2xhc3MgTW9ja0dyZUNBUFRDSEFUb3BMZXZlbCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuZW50ZXJwcmlzZSA9IG5ldyBNb2NrR3JlQ0FQVENIQSgpO1xuICAgIH1cbiAgICByZWFkeShjYWxsYmFjaykge1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgIH1cbiAgICBleGVjdXRlKFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICBfc2l0ZUtleSwgX29wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgndG9rZW4nKTtcbiAgICB9XG4gICAgcmVuZGVyKFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICBfY29udGFpbmVyLCBfcGFyYW1ldGVycykge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxufVxuY2xhc3MgTW9ja0dyZUNBUFRDSEEge1xuICAgIHJlYWR5KGNhbGxiYWNrKSB7XG4gICAgICAgIGNhbGxiYWNrKCk7XG4gICAgfVxuICAgIGV4ZWN1dGUoXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgIF9zaXRlS2V5LCBfb3B0aW9ucykge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCd0b2tlbicpO1xuICAgIH1cbiAgICByZW5kZXIoXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgIF9jb250YWluZXIsIF9wYXJhbWV0ZXJzKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG59XG5jbGFzcyBNb2NrV2lkZ2V0IHtcbiAgICBjb25zdHJ1Y3Rvcihjb250YWluZXJPcklkLCBhcHBOYW1lLCBwYXJhbXMpIHtcbiAgICAgICAgdGhpcy5wYXJhbXMgPSBwYXJhbXM7XG4gICAgICAgIHRoaXMudGltZXJJZCA9IG51bGw7XG4gICAgICAgIHRoaXMuZGVsZXRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnJlc3BvbnNlVG9rZW4gPSBudWxsO1xuICAgICAgICB0aGlzLmNsaWNrSGFuZGxlciA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZXhlY3V0ZSgpO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBjb250YWluZXIgPSB0eXBlb2YgY29udGFpbmVyT3JJZCA9PT0gJ3N0cmluZydcbiAgICAgICAgICAgID8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29udGFpbmVyT3JJZClcbiAgICAgICAgICAgIDogY29udGFpbmVyT3JJZDtcbiAgICAgICAgX2Fzc2VydChjb250YWluZXIsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SICovLCB7IGFwcE5hbWUgfSk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuICAgICAgICB0aGlzLmlzVmlzaWJsZSA9IHRoaXMucGFyYW1zLnNpemUgIT09ICdpbnZpc2libGUnO1xuICAgICAgICBpZiAodGhpcy5pc1Zpc2libGUpIHtcbiAgICAgICAgICAgIHRoaXMuZXhlY3V0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNsaWNrSGFuZGxlcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0UmVzcG9uc2UoKSB7XG4gICAgICAgIHRoaXMuY2hlY2tJZkRlbGV0ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVzcG9uc2VUb2tlbjtcbiAgICB9XG4gICAgZGVsZXRlKCkge1xuICAgICAgICB0aGlzLmNoZWNrSWZEZWxldGVkKCk7XG4gICAgICAgIHRoaXMuZGVsZXRlZCA9IHRydWU7XG4gICAgICAgIGlmICh0aGlzLnRpbWVySWQpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVySWQpO1xuICAgICAgICAgICAgdGhpcy50aW1lcklkID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNvbnRhaW5lci5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xpY2tIYW5kbGVyKTtcbiAgICB9XG4gICAgZXhlY3V0ZSgpIHtcbiAgICAgICAgdGhpcy5jaGVja0lmRGVsZXRlZCgpO1xuICAgICAgICBpZiAodGhpcy50aW1lcklkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50aW1lcklkID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5yZXNwb25zZVRva2VuID0gZ2VuZXJhdGVSYW5kb21BbHBoYU51bWVyaWNTdHJpbmcoNTApO1xuICAgICAgICAgICAgY29uc3QgeyBjYWxsYmFjaywgJ2V4cGlyZWQtY2FsbGJhY2snOiBleHBpcmVkQ2FsbGJhY2sgfSA9IHRoaXMucGFyYW1zO1xuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sodGhpcy5yZXNwb25zZVRva2VuKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHsgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy50aW1lcklkID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMudGltZXJJZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNwb25zZVRva2VuID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAoZXhwaXJlZENhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBleHBpcmVkQ2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkgeyB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzVmlzaWJsZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmV4ZWN1dGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBfRVhQSVJBVElPTl9USU1FX01TKTtcbiAgICAgICAgfSwgX1NPTFZFX1RJTUVfTVMpO1xuICAgIH1cbiAgICBjaGVja0lmRGVsZXRlZCgpIHtcbiAgICAgICAgaWYgKHRoaXMuZGVsZXRlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdyZUNBUFRDSEEgbW9jayB3YXMgYWxyZWFkeSBkZWxldGVkIScpO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gZ2VuZXJhdGVSYW5kb21BbHBoYU51bWVyaWNTdHJpbmcobGVuKSB7XG4gICAgY29uc3QgY2hhcnMgPSBbXTtcbiAgICBjb25zdCBhbGxvd2VkQ2hhcnMgPSAnMTIzNDU2Nzg5MGFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVonO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgY2hhcnMucHVzaChhbGxvd2VkQ2hhcnMuY2hhckF0KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGFsbG93ZWRDaGFycy5sZW5ndGgpKSk7XG4gICAgfVxuICAgIHJldHVybiBjaGFycy5qb2luKCcnKTtcbn1cblxuLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXJlcXVpcmUtaW1wb3J0cyAqL1xuY29uc3QgUkVDQVBUQ0hBX0VOVEVSUFJJU0VfVkVSSUZJRVJfVFlQRSA9ICdyZWNhcHRjaGEtZW50ZXJwcmlzZSc7XG5jb25zdCBGQUtFX1RPS0VOID0gJ05PX1JFQ0FQVENIQSc7XG5jbGFzcyBSZWNhcHRjaGFFbnRlcnByaXNlVmVyaWZpZXIge1xuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIGF1dGhFeHRlcm4gLSBUaGUgY29ycmVzcG9uZGluZyBGaXJlYmFzZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gICAgICpcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihhdXRoRXh0ZXJuKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZGVudGlmaWVzIHRoZSB0eXBlIG9mIGFwcGxpY2F0aW9uIHZlcmlmaWVyIChlLmcuIFwicmVjYXB0Y2hhLWVudGVycHJpc2VcIikuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBSRUNBUFRDSEFfRU5URVJQUklTRV9WRVJJRklFUl9UWVBFO1xuICAgICAgICB0aGlzLmF1dGggPSBfY2FzdEF1dGgoYXV0aEV4dGVybik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGVzIHRoZSB2ZXJpZmljYXRpb24gcHJvY2Vzcy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIEEgUHJvbWlzZSBmb3IgYSB0b2tlbiB0aGF0IGNhbiBiZSB1c2VkIHRvIGFzc2VydCB0aGUgdmFsaWRpdHkgb2YgYSByZXF1ZXN0LlxuICAgICAqL1xuICAgIGFzeW5jIHZlcmlmeShhY3Rpb24gPSAndmVyaWZ5JywgZm9yY2VSZWZyZXNoID0gZmFsc2UpIHtcbiAgICAgICAgYXN5bmMgZnVuY3Rpb24gcmV0cmlldmVTaXRlS2V5KGF1dGgpIHtcbiAgICAgICAgICAgIGlmICghZm9yY2VSZWZyZXNoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGF1dGgudGVuYW50SWQgPT0gbnVsbCAmJiBhdXRoLl9hZ2VudFJlY2FwdGNoYUNvbmZpZyAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhdXRoLl9hZ2VudFJlY2FwdGNoYUNvbmZpZy5zaXRlS2V5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYXV0aC50ZW5hbnRJZCAhPSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgIGF1dGguX3RlbmFudFJlY2FwdGNoYUNvbmZpZ3NbYXV0aC50ZW5hbnRJZF0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXV0aC5fdGVuYW50UmVjYXB0Y2hhQ29uZmlnc1thdXRoLnRlbmFudElkXS5zaXRlS2V5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShhc3luYyAocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgZ2V0UmVjYXB0Y2hhQ29uZmlnKGF1dGgsIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50VHlwZTogXCJDTElFTlRfVFlQRV9XRUJcIiAvKiBSZWNhcHRjaGFDbGllbnRUeXBlLldFQiAqLyxcbiAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogXCJSRUNBUFRDSEFfRU5URVJQUklTRVwiIC8qIFJlY2FwdGNoYVZlcnNpb24uRU5URVJQUklTRSAqL1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnJlY2FwdGNoYUtleSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdyZWNhcHRjaGEgRW50ZXJwcmlzZSBzaXRlIGtleSB1bmRlZmluZWQnKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25maWcgPSBuZXcgUmVjYXB0Y2hhQ29uZmlnKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdXRoLnRlbmFudElkID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRoLl9hZ2VudFJlY2FwdGNoYUNvbmZpZyA9IGNvbmZpZztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dGguX3RlbmFudFJlY2FwdGNoYUNvbmZpZ3NbYXV0aC50ZW5hbnRJZF0gPSBjb25maWc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShjb25maWcuc2l0ZUtleSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0cmlldmVSZWNhcHRjaGFUb2tlbihzaXRlS2V5LCByZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIGNvbnN0IGdyZWNhcHRjaGEgPSB3aW5kb3cuZ3JlY2FwdGNoYTtcbiAgICAgICAgICAgIGlmIChpc0VudGVycHJpc2UoZ3JlY2FwdGNoYSkpIHtcbiAgICAgICAgICAgICAgICBncmVjYXB0Y2hhLmVudGVycHJpc2UucmVhZHkoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBncmVjYXB0Y2hhLmVudGVycHJpc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIC5leGVjdXRlKHNpdGVLZXksIHsgYWN0aW9uIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbih0b2tlbiA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRva2VuKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKEZBS0VfVE9LRU4pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlamVjdChFcnJvcignTm8gcmVDQVBUQ0hBIGVudGVycHJpc2Ugc2NyaXB0IGxvYWRlZC4nKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gUmV0dXJucyBQcm9taXNlIGZvciBhIG1vY2sgdG9rZW4gd2hlbiBhcHBWZXJpZmljYXRpb25EaXNhYmxlZEZvclRlc3RpbmcgaXMgdHJ1ZS5cbiAgICAgICAgaWYgKHRoaXMuYXV0aC5zZXR0aW5ncy5hcHBWZXJpZmljYXRpb25EaXNhYmxlZEZvclRlc3RpbmcpIHtcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZWNhcHRjaGEgPSBuZXcgTW9ja0dyZUNBUFRDSEFUb3BMZXZlbCgpO1xuICAgICAgICAgICAgcmV0dXJuIG1vY2tSZWNhcHRjaGEuZXhlY3V0ZSgnc2l0ZUtleScsIHsgYWN0aW9uOiAndmVyaWZ5JyB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgcmV0cmlldmVTaXRlS2V5KHRoaXMuYXV0aClcbiAgICAgICAgICAgICAgICAudGhlbihzaXRlS2V5ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWZvcmNlUmVmcmVzaCAmJiBpc0VudGVycHJpc2Uod2luZG93LmdyZWNhcHRjaGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHJpZXZlUmVjYXB0Y2hhVG9rZW4oc2l0ZUtleSwgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignUmVjYXB0Y2hhVmVyaWZpZXIgaXMgb25seSBzdXBwb3J0ZWQgaW4gYnJvd3NlcicpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsZXQgdXJsID0gX3JlY2FwdGNoYUVudGVycHJpc2VTY3JpcHRVcmwoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVybC5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybCArPSBzaXRlS2V5O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIF9sb2FkSlModXJsKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0cmlldmVSZWNhcHRjaGFUb2tlbihzaXRlS2V5LCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbmFzeW5jIGZ1bmN0aW9uIGluamVjdFJlY2FwdGNoYUZpZWxkcyhhdXRoLCByZXF1ZXN0LCBhY3Rpb24sIGlzQ2FwdGNoYVJlc3AgPSBmYWxzZSwgaXNGYWtlVG9rZW4gPSBmYWxzZSkge1xuICAgIGNvbnN0IHZlcmlmaWVyID0gbmV3IFJlY2FwdGNoYUVudGVycHJpc2VWZXJpZmllcihhdXRoKTtcbiAgICBsZXQgY2FwdGNoYVJlc3BvbnNlO1xuICAgIGlmIChpc0Zha2VUb2tlbikge1xuICAgICAgICBjYXB0Y2hhUmVzcG9uc2UgPSBGQUtFX1RPS0VOO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNhcHRjaGFSZXNwb25zZSA9IGF3YWl0IHZlcmlmaWVyLnZlcmlmeShhY3Rpb24pO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY2FwdGNoYVJlc3BvbnNlID0gYXdhaXQgdmVyaWZpZXIudmVyaWZ5KGFjdGlvbiwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgbmV3UmVxdWVzdCA9IHsgLi4ucmVxdWVzdCB9O1xuICAgIGlmIChhY3Rpb24gPT09IFwibWZhU21zRW5yb2xsbWVudFwiIC8qIFJlY2FwdGNoYUFjdGlvbk5hbWUuTUZBX1NNU19FTlJPTExNRU5UICovIHx8XG4gICAgICAgIGFjdGlvbiA9PT0gXCJtZmFTbXNTaWduSW5cIiAvKiBSZWNhcHRjaGFBY3Rpb25OYW1lLk1GQV9TTVNfU0lHTklOICovKSB7XG4gICAgICAgIGlmICgncGhvbmVFbnJvbGxtZW50SW5mbycgaW4gbmV3UmVxdWVzdCkge1xuICAgICAgICAgICAgY29uc3QgcGhvbmVOdW1iZXIgPSBuZXdSZXF1ZXN0LnBob25lRW5yb2xsbWVudEluZm8ucGhvbmVOdW1iZXI7XG4gICAgICAgICAgICBjb25zdCByZWNhcHRjaGFUb2tlbiA9IG5ld1JlcXVlc3QucGhvbmVFbnJvbGxtZW50SW5mby5yZWNhcHRjaGFUb2tlbjtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24obmV3UmVxdWVzdCwge1xuICAgICAgICAgICAgICAgICdwaG9uZUVucm9sbG1lbnRJbmZvJzoge1xuICAgICAgICAgICAgICAgICAgICBwaG9uZU51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgcmVjYXB0Y2hhVG9rZW4sXG4gICAgICAgICAgICAgICAgICAgIGNhcHRjaGFSZXNwb25zZSxcbiAgICAgICAgICAgICAgICAgICAgJ2NsaWVudFR5cGUnOiBcIkNMSUVOVF9UWVBFX1dFQlwiIC8qIFJlY2FwdGNoYUNsaWVudFR5cGUuV0VCICovLFxuICAgICAgICAgICAgICAgICAgICAncmVjYXB0Y2hhVmVyc2lvbic6IFwiUkVDQVBUQ0hBX0VOVEVSUFJJU0VcIiAvKiBSZWNhcHRjaGFWZXJzaW9uLkVOVEVSUFJJU0UgKi9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICgncGhvbmVTaWduSW5JbmZvJyBpbiBuZXdSZXF1ZXN0KSB7XG4gICAgICAgICAgICBjb25zdCByZWNhcHRjaGFUb2tlbiA9IG5ld1JlcXVlc3QucGhvbmVTaWduSW5JbmZvLnJlY2FwdGNoYVRva2VuO1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihuZXdSZXF1ZXN0LCB7XG4gICAgICAgICAgICAgICAgJ3Bob25lU2lnbkluSW5mbyc6IHtcbiAgICAgICAgICAgICAgICAgICAgcmVjYXB0Y2hhVG9rZW4sXG4gICAgICAgICAgICAgICAgICAgIGNhcHRjaGFSZXNwb25zZSxcbiAgICAgICAgICAgICAgICAgICAgJ2NsaWVudFR5cGUnOiBcIkNMSUVOVF9UWVBFX1dFQlwiIC8qIFJlY2FwdGNoYUNsaWVudFR5cGUuV0VCICovLFxuICAgICAgICAgICAgICAgICAgICAncmVjYXB0Y2hhVmVyc2lvbic6IFwiUkVDQVBUQ0hBX0VOVEVSUFJJU0VcIiAvKiBSZWNhcHRjaGFWZXJzaW9uLkVOVEVSUFJJU0UgKi9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3UmVxdWVzdDtcbiAgICB9XG4gICAgaWYgKCFpc0NhcHRjaGFSZXNwKSB7XG4gICAgICAgIE9iamVjdC5hc3NpZ24obmV3UmVxdWVzdCwgeyBjYXB0Y2hhUmVzcG9uc2UgfSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBPYmplY3QuYXNzaWduKG5ld1JlcXVlc3QsIHsgJ2NhcHRjaGFSZXNwJzogY2FwdGNoYVJlc3BvbnNlIH0pO1xuICAgIH1cbiAgICBPYmplY3QuYXNzaWduKG5ld1JlcXVlc3QsIHsgJ2NsaWVudFR5cGUnOiBcIkNMSUVOVF9UWVBFX1dFQlwiIC8qIFJlY2FwdGNoYUNsaWVudFR5cGUuV0VCICovIH0pO1xuICAgIE9iamVjdC5hc3NpZ24obmV3UmVxdWVzdCwge1xuICAgICAgICAncmVjYXB0Y2hhVmVyc2lvbic6IFwiUkVDQVBUQ0hBX0VOVEVSUFJJU0VcIiAvKiBSZWNhcHRjaGFWZXJzaW9uLkVOVEVSUFJJU0UgKi9cbiAgICB9KTtcbiAgICByZXR1cm4gbmV3UmVxdWVzdDtcbn1cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVJlY2FwdGNoYUZsb3coYXV0aEluc3RhbmNlLCByZXF1ZXN0LCBhY3Rpb25OYW1lLCBhY3Rpb25NZXRob2QsIHJlY2FwdGNoYUF1dGhQcm92aWRlcikge1xuICAgIGlmIChyZWNhcHRjaGFBdXRoUHJvdmlkZXIgPT09IFwiRU1BSUxfUEFTU1dPUkRfUFJPVklERVJcIiAvKiBSZWNhcHRjaGFBdXRoUHJvdmlkZXIuRU1BSUxfUEFTU1dPUkRfUFJPVklERVIgKi8pIHtcbiAgICAgICAgaWYgKGF1dGhJbnN0YW5jZVxuICAgICAgICAgICAgLl9nZXRSZWNhcHRjaGFDb25maWcoKVxuICAgICAgICAgICAgPy5pc1Byb3ZpZGVyRW5hYmxlZChcIkVNQUlMX1BBU1NXT1JEX1BST1ZJREVSXCIgLyogUmVjYXB0Y2hhQXV0aFByb3ZpZGVyLkVNQUlMX1BBU1NXT1JEX1BST1ZJREVSICovKSkge1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdFdpdGhSZWNhcHRjaGEgPSBhd2FpdCBpbmplY3RSZWNhcHRjaGFGaWVsZHMoYXV0aEluc3RhbmNlLCByZXF1ZXN0LCBhY3Rpb25OYW1lLCBhY3Rpb25OYW1lID09PSBcImdldE9vYkNvZGVcIiAvKiBSZWNhcHRjaGFBY3Rpb25OYW1lLkdFVF9PT0JfQ09ERSAqLyk7XG4gICAgICAgICAgICByZXR1cm4gYWN0aW9uTWV0aG9kKGF1dGhJbnN0YW5jZSwgcmVxdWVzdFdpdGhSZWNhcHRjaGEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGFjdGlvbk1ldGhvZChhdXRoSW5zdGFuY2UsIHJlcXVlc3QpLmNhdGNoKGFzeW5jIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvci5jb2RlID09PSBgYXV0aC8ke1wibWlzc2luZy1yZWNhcHRjaGEtdG9rZW5cIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfUkVDQVBUQ0hBX1RPS0VOICovfWApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYCR7YWN0aW9uTmFtZX0gaXMgcHJvdGVjdGVkIGJ5IHJlQ0FQVENIQSBFbnRlcnByaXNlIGZvciB0aGlzIHByb2plY3QuIEF1dG9tYXRpY2FsbHkgdHJpZ2dlcmluZyB0aGUgcmVDQVBUQ0hBIGZsb3cgYW5kIHJlc3RhcnRpbmcgdGhlIGZsb3cuYCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RXaXRoUmVjYXB0Y2hhID0gYXdhaXQgaW5qZWN0UmVjYXB0Y2hhRmllbGRzKGF1dGhJbnN0YW5jZSwgcmVxdWVzdCwgYWN0aW9uTmFtZSwgYWN0aW9uTmFtZSA9PT0gXCJnZXRPb2JDb2RlXCIgLyogUmVjYXB0Y2hhQWN0aW9uTmFtZS5HRVRfT09CX0NPREUgKi8pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uTWV0aG9kKGF1dGhJbnN0YW5jZSwgcmVxdWVzdFdpdGhSZWNhcHRjaGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChyZWNhcHRjaGFBdXRoUHJvdmlkZXIgPT09IFwiUEhPTkVfUFJPVklERVJcIiAvKiBSZWNhcHRjaGFBdXRoUHJvdmlkZXIuUEhPTkVfUFJPVklERVIgKi8pIHtcbiAgICAgICAgaWYgKGF1dGhJbnN0YW5jZVxuICAgICAgICAgICAgLl9nZXRSZWNhcHRjaGFDb25maWcoKVxuICAgICAgICAgICAgPy5pc1Byb3ZpZGVyRW5hYmxlZChcIlBIT05FX1BST1ZJREVSXCIgLyogUmVjYXB0Y2hhQXV0aFByb3ZpZGVyLlBIT05FX1BST1ZJREVSICovKSkge1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdFdpdGhSZWNhcHRjaGEgPSBhd2FpdCBpbmplY3RSZWNhcHRjaGFGaWVsZHMoYXV0aEluc3RhbmNlLCByZXF1ZXN0LCBhY3Rpb25OYW1lKTtcbiAgICAgICAgICAgIHJldHVybiBhY3Rpb25NZXRob2QoYXV0aEluc3RhbmNlLCByZXF1ZXN0V2l0aFJlY2FwdGNoYSkuY2F0Y2goYXN5bmMgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGF1dGhJbnN0YW5jZVxuICAgICAgICAgICAgICAgICAgICAuX2dldFJlY2FwdGNoYUNvbmZpZygpXG4gICAgICAgICAgICAgICAgICAgID8uZ2V0UHJvdmlkZXJFbmZvcmNlbWVudFN0YXRlKFwiUEhPTkVfUFJPVklERVJcIiAvKiBSZWNhcHRjaGFBdXRoUHJvdmlkZXIuUEhPTkVfUFJPVklERVIgKi8pID09PSBcIkFVRElUXCIgLyogRW5mb3JjZW1lbnRTdGF0ZS5BVURJVCAqLykge1xuICAgICAgICAgICAgICAgICAgICAvLyBBVURJVCBtb2RlXG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnJvci5jb2RlID09PSBgYXV0aC8ke1wibWlzc2luZy1yZWNhcHRjaGEtdG9rZW5cIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfUkVDQVBUQ0hBX1RPS0VOICovfWAgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yLmNvZGUgPT09IGBhdXRoLyR7XCJpbnZhbGlkLWFwcC1jcmVkZW50aWFsXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0FQUF9DUkVERU5USUFMICovfWApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBGYWlsZWQgdG8gdmVyaWZ5IHdpdGggcmVDQVBUQ0hBIEVudGVycHJpc2UuIEF1dG9tYXRpY2FsbHkgdHJpZ2dlcmluZyB0aGUgcmVDQVBUQ0hBIHYyIGZsb3cgdG8gY29tcGxldGUgdGhlICR7YWN0aW9uTmFtZX0gZmxvdy5gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlQ0FQVENIQSBFbnRlcnByaXNlIHRva2VuIGlzIG1pc3Npbmcgb3IgcmVDQVBUQ0hBIEVudGVycHJpc2UgdG9rZW5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGZhaWxzLlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmFsbGJhY2sgdG8gcmVDQVBUQ0hBIHYyIGZsb3cuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXF1ZXN0V2l0aFJlY2FwdGNoYUZpZWxkcyA9IGF3YWl0IGluamVjdFJlY2FwdGNoYUZpZWxkcyhhdXRoSW5zdGFuY2UsIHJlcXVlc3QsIGFjdGlvbk5hbWUsIGZhbHNlLCAvLyBpc0NhcHRjaGFSZXNwXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnVlIC8vIGlzRmFrZVRva2VuXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyB3aWxsIGNhbGwgdGhlIFBob25lQXBpQ2FsbGVyIHRvIGZldGNoIGFuZCBpbmplY3QgcmVDQVBUQ0hBIHYyIHRva2VuLlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbk1ldGhvZChhdXRoSW5zdGFuY2UsIHJlcXVlc3RXaXRoUmVjYXB0Y2hhRmllbGRzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBFTkZPUkNFIG1vZGUgb3IgQVVESVQgbW9kZSB3aXRoIGFueSBvdGhlciBlcnJvci5cbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBEbyByZUNBUFRDSEEgdjIgZmxvdy5cbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RXaXRoUmVjYXB0Y2hhRmllbGRzID0gYXdhaXQgaW5qZWN0UmVjYXB0Y2hhRmllbGRzKGF1dGhJbnN0YW5jZSwgcmVxdWVzdCwgYWN0aW9uTmFtZSwgZmFsc2UsIC8vIGlzQ2FwdGNoYVJlc3BcbiAgICAgICAgICAgIHRydWUgLy8gaXNGYWtlVG9rZW5cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICAvLyBUaGlzIHdpbGwgY2FsbCB0aGUgUGhvbmVBcGlDYWxsZXIgdG8gZmV0Y2ggYW5kIGluamVjdCB2MiB0b2tlbi5cbiAgICAgICAgICAgIHJldHVybiBhY3Rpb25NZXRob2QoYXV0aEluc3RhbmNlLCByZXF1ZXN0V2l0aFJlY2FwdGNoYUZpZWxkcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZWNhcHRjaGFBdXRoUHJvdmlkZXIgKyAnIHByb3ZpZGVyIGlzIG5vdCBzdXBwb3J0ZWQuJyk7XG4gICAgfVxufVxuYXN5bmMgZnVuY3Rpb24gX2luaXRpYWxpemVSZWNhcHRjaGFDb25maWcoYXV0aCkge1xuICAgIGNvbnN0IGF1dGhJbnRlcm5hbCA9IF9jYXN0QXV0aChhdXRoKTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldFJlY2FwdGNoYUNvbmZpZyhhdXRoSW50ZXJuYWwsIHtcbiAgICAgICAgY2xpZW50VHlwZTogXCJDTElFTlRfVFlQRV9XRUJcIiAvKiBSZWNhcHRjaGFDbGllbnRUeXBlLldFQiAqLyxcbiAgICAgICAgdmVyc2lvbjogXCJSRUNBUFRDSEFfRU5URVJQUklTRVwiIC8qIFJlY2FwdGNoYVZlcnNpb24uRU5URVJQUklTRSAqL1xuICAgIH0pO1xuICAgIGNvbnN0IGNvbmZpZyA9IG5ldyBSZWNhcHRjaGFDb25maWcocmVzcG9uc2UpO1xuICAgIGlmIChhdXRoSW50ZXJuYWwudGVuYW50SWQgPT0gbnVsbCkge1xuICAgICAgICBhdXRoSW50ZXJuYWwuX2FnZW50UmVjYXB0Y2hhQ29uZmlnID0gY29uZmlnO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgYXV0aEludGVybmFsLl90ZW5hbnRSZWNhcHRjaGFDb25maWdzW2F1dGhJbnRlcm5hbC50ZW5hbnRJZF0gPSBjb25maWc7XG4gICAgfVxuICAgIGlmIChjb25maWcuaXNBbnlQcm92aWRlckVuYWJsZWQoKSkge1xuICAgICAgICBjb25zdCB2ZXJpZmllciA9IG5ldyBSZWNhcHRjaGFFbnRlcnByaXNlVmVyaWZpZXIoYXV0aEludGVybmFsKTtcbiAgICAgICAgdm9pZCB2ZXJpZmllci52ZXJpZnkoKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEluaXRpYWxpemVzIGFuIHtAbGluayBBdXRofSBpbnN0YW5jZSB3aXRoIGZpbmUtZ3JhaW5lZCBjb250cm9sIG92ZXJcbiAqIHtAbGluayBEZXBlbmRlbmNpZXN9LlxuICpcbiAqIEByZW1hcmtzXG4gKlxuICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgbW9yZSBjb250cm9sIG92ZXIgdGhlIHtAbGluayBBdXRofSBpbnN0YW5jZSB0aGFuXG4gKiB7QGxpbmsgZ2V0QXV0aH0uIGBnZXRBdXRoYCB1c2VzIHBsYXRmb3JtLXNwZWNpZmljIGRlZmF1bHRzIHRvIHN1cHBseVxuICogdGhlIHtAbGluayBEZXBlbmRlbmNpZXN9LiBJbiBnZW5lcmFsLCBgZ2V0QXV0aGAgaXMgdGhlIGVhc2llc3Qgd2F5IHRvXG4gKiBpbml0aWFsaXplIEF1dGggYW5kIHdvcmtzIGZvciBtb3N0IHVzZSBjYXNlcy4gVXNlIGBpbml0aWFsaXplQXV0aGAgaWYgeW91XG4gKiBuZWVkIGNvbnRyb2wgb3ZlciB3aGljaCBwZXJzaXN0ZW5jZSBsYXllciBpcyB1c2VkLCBvciB0byBtaW5pbWl6ZSBidW5kbGVcbiAqIHNpemUgaWYgeW91J3JlIG5vdCB1c2luZyBlaXRoZXIgYHNpZ25JbldpdGhQb3B1cGAgb3IgYHNpZ25JbldpdGhSZWRpcmVjdGAuXG4gKlxuICogRm9yIGV4YW1wbGUsIGlmIHlvdXIgYXBwIG9ubHkgdXNlcyBhbm9ueW1vdXMgYWNjb3VudHMgYW5kIHlvdSBvbmx5IHdhbnRcbiAqIGFjY291bnRzIHNhdmVkIGZvciB0aGUgY3VycmVudCBzZXNzaW9uLCBpbml0aWFsaXplIGBBdXRoYCB3aXRoOlxuICpcbiAqIGBgYGpzXG4gKiBjb25zdCBhdXRoID0gaW5pdGlhbGl6ZUF1dGgoYXBwLCB7XG4gKiAgIHBlcnNpc3RlbmNlOiBicm93c2VyU2Vzc2lvblBlcnNpc3RlbmNlLFxuICogICBwb3B1cFJlZGlyZWN0UmVzb2x2ZXI6IHVuZGVmaW5lZCxcbiAqIH0pO1xuICogYGBgXG4gKlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiBpbml0aWFsaXplQXV0aChhcHAsIGRlcHMpIHtcbiAgICBjb25zdCBwcm92aWRlciA9IF9nZXRQcm92aWRlcihhcHAsICdhdXRoJyk7XG4gICAgaWYgKHByb3ZpZGVyLmlzSW5pdGlhbGl6ZWQoKSkge1xuICAgICAgICBjb25zdCBhdXRoID0gcHJvdmlkZXIuZ2V0SW1tZWRpYXRlKCk7XG4gICAgICAgIGNvbnN0IGluaXRpYWxPcHRpb25zID0gcHJvdmlkZXIuZ2V0T3B0aW9ucygpO1xuICAgICAgICBpZiAoZGVlcEVxdWFsKGluaXRpYWxPcHRpb25zLCBkZXBzID8/IHt9KSkge1xuICAgICAgICAgICAgcmV0dXJuIGF1dGg7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBfZmFpbChhdXRoLCBcImFscmVhZHktaW5pdGlhbGl6ZWRcIiAvKiBBdXRoRXJyb3JDb2RlLkFMUkVBRFlfSU5JVElBTElaRUQgKi8pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGF1dGggPSBwcm92aWRlci5pbml0aWFsaXplKHsgb3B0aW9uczogZGVwcyB9KTtcbiAgICByZXR1cm4gYXV0aDtcbn1cbmZ1bmN0aW9uIF9pbml0aWFsaXplQXV0aEluc3RhbmNlKGF1dGgsIGRlcHMpIHtcbiAgICBjb25zdCBwZXJzaXN0ZW5jZSA9IGRlcHM/LnBlcnNpc3RlbmNlIHx8IFtdO1xuICAgIGNvbnN0IGhpZXJhcmNoeSA9IChBcnJheS5pc0FycmF5KHBlcnNpc3RlbmNlKSA/IHBlcnNpc3RlbmNlIDogW3BlcnNpc3RlbmNlXSkubWFwKF9nZXRJbnN0YW5jZSk7XG4gICAgaWYgKGRlcHM/LmVycm9yTWFwKSB7XG4gICAgICAgIGF1dGguX3VwZGF0ZUVycm9yTWFwKGRlcHMuZXJyb3JNYXApO1xuICAgIH1cbiAgICAvLyBUaGlzIHByb21pc2UgaXMgaW50ZW5kZWQgdG8gZmxvYXQ7IGF1dGggaW5pdGlhbGl6YXRpb24gaGFwcGVucyBpbiB0aGVcbiAgICAvLyBiYWNrZ3JvdW5kLCBtZWFud2hpbGUgdGhlIGF1dGggb2JqZWN0IG1heSBiZSB1c2VkIGJ5IHRoZSBhcHAuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xuICAgIGF1dGguX2luaXRpYWxpemVXaXRoUGVyc2lzdGVuY2UoaGllcmFyY2h5LCBkZXBzPy5wb3B1cFJlZGlyZWN0UmVzb2x2ZXIpO1xufVxuXG4vKipcbiAqIENoYW5nZXMgdGhlIHtAbGluayBBdXRofSBpbnN0YW5jZSB0byBjb21tdW5pY2F0ZSB3aXRoIHRoZSBGaXJlYmFzZSBBdXRoIEVtdWxhdG9yLCBpbnN0ZWFkIG9mIHByb2R1Y3Rpb25cbiAqIEZpcmViYXNlIEF1dGggc2VydmljZXMuXG4gKlxuICogQHJlbWFya3NcbiAqIFRoaXMgbXVzdCBiZSBjYWxsZWQgc3luY2hyb25vdXNseSBpbW1lZGlhdGVseSBmb2xsb3dpbmcgdGhlIGZpcnN0IGNhbGwgdG9cbiAqIHtAbGluayBpbml0aWFsaXplQXV0aH0uICBEbyBub3QgdXNlIHdpdGggcHJvZHVjdGlvbiBjcmVkZW50aWFscyBhcyBlbXVsYXRvclxuICogdHJhZmZpYyBpcyBub3QgZW5jcnlwdGVkLlxuICpcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogY29ubmVjdEF1dGhFbXVsYXRvcihhdXRoLCAnaHR0cDovLzEyNy4wLjAuMTo5MDk5JywgeyBkaXNhYmxlV2FybmluZ3M6IHRydWUgfSk7XG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gdXJsIC0gVGhlIFVSTCBhdCB3aGljaCB0aGUgZW11bGF0b3IgaXMgcnVubmluZyAoZWcsICdodHRwOi8vbG9jYWxob3N0OjkwOTknKS5cbiAqIEBwYXJhbSBvcHRpb25zIC0gT3B0aW9uYWwuIGBvcHRpb25zLmRpc2FibGVXYXJuaW5nc2AgZGVmYXVsdHMgdG8gYGZhbHNlYC4gU2V0IGl0IHRvXG4gKiBgdHJ1ZWAgdG8gZGlzYWJsZSB0aGUgd2FybmluZyBiYW5uZXIgYXR0YWNoZWQgdG8gdGhlIERPTS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIGNvbm5lY3RBdXRoRW11bGF0b3IoYXV0aCwgdXJsLCBvcHRpb25zKSB7XG4gICAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xuICAgIF9hc3NlcnQoL15odHRwcz86XFwvXFwvLy50ZXN0KHVybCksIGF1dGhJbnRlcm5hbCwgXCJpbnZhbGlkLWVtdWxhdG9yLXNjaGVtZVwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9FTVVMQVRPUl9TQ0hFTUUgKi8pO1xuICAgIGNvbnN0IGRpc2FibGVXYXJuaW5ncyA9ICEhb3B0aW9ucz8uZGlzYWJsZVdhcm5pbmdzO1xuICAgIGNvbnN0IHByb3RvY29sID0gZXh0cmFjdFByb3RvY29sKHVybCk7XG4gICAgY29uc3QgeyBob3N0LCBwb3J0IH0gPSBleHRyYWN0SG9zdEFuZFBvcnQodXJsKTtcbiAgICBjb25zdCBwb3J0U3RyID0gcG9ydCA9PT0gbnVsbCA/ICcnIDogYDoke3BvcnR9YDtcbiAgICAvLyBBbHdheXMgcmVwbGFjZSBwYXRoIHdpdGggXCIvXCIgKGV2ZW4gaWYgaW5wdXQgdXJsIGhhZCBubyBwYXRoIGF0IGFsbCwgb3IgaGFkIGEgZGlmZmVyZW50IG9uZSkuXG4gICAgY29uc3QgZW11bGF0b3IgPSB7IHVybDogYCR7cHJvdG9jb2x9Ly8ke2hvc3R9JHtwb3J0U3RyfS9gIH07XG4gICAgY29uc3QgZW11bGF0b3JDb25maWcgPSBPYmplY3QuZnJlZXplKHtcbiAgICAgICAgaG9zdCxcbiAgICAgICAgcG9ydCxcbiAgICAgICAgcHJvdG9jb2w6IHByb3RvY29sLnJlcGxhY2UoJzonLCAnJyksXG4gICAgICAgIG9wdGlvbnM6IE9iamVjdC5mcmVlemUoeyBkaXNhYmxlV2FybmluZ3MgfSlcbiAgICB9KTtcbiAgICAvLyBUaGVyZSBhcmUgYSBmZXcgc2NlbmFyaW9zIHRvIGd1YXJkIGFnYWluc3QgaWYgdGhlIEF1dGggaW5zdGFuY2UgaGFzIGFscmVhZHkgc3RhcnRlZDpcbiAgICBpZiAoIWF1dGhJbnRlcm5hbC5fY2FuSW5pdEVtdWxhdG9yKSB7XG4gICAgICAgIC8vIEFwcGxpY2F0aW9ucyBtYXkgbm90IGluaXRpYWxpemUgdGhlIGVtdWxhdG9yIGZvciB0aGUgZmlyc3QgdGltZSBpZiBBdXRoIGhhcyBhbHJlYWR5IHN0YXJ0ZWRcbiAgICAgICAgLy8gdG8gbWFrZSBuZXR3b3JrIHJlcXVlc3RzLlxuICAgICAgICBfYXNzZXJ0KGF1dGhJbnRlcm5hbC5jb25maWcuZW11bGF0b3IgJiYgYXV0aEludGVybmFsLmVtdWxhdG9yQ29uZmlnLCBhdXRoSW50ZXJuYWwsIFwiZW11bGF0b3ItY29uZmlnLWZhaWxlZFwiIC8qIEF1dGhFcnJvckNvZGUuRU1VTEFUT1JfQ09ORklHX0ZBSUxFRCAqLyk7XG4gICAgICAgIC8vIEFwcGxpY2F0aW9ucyBtYXkgbm90IGFsdGVyIHRoZSBjb25maWd1cmF0aW9uIG9mIHRoZSBlbXVsYXRvciAoYWthIHBhc3MgYSBkaWZmZXJlbnQgY29uZmlnKVxuICAgICAgICAvLyBvbmNlIEF1dGggaGFzIHN0YXJ0ZWQgdG8gbWFrZSBuZXR3b3JrIHJlcXVlc3RzLlxuICAgICAgICBfYXNzZXJ0KGRlZXBFcXVhbChlbXVsYXRvciwgYXV0aEludGVybmFsLmNvbmZpZy5lbXVsYXRvcikgJiZcbiAgICAgICAgICAgIGRlZXBFcXVhbChlbXVsYXRvckNvbmZpZywgYXV0aEludGVybmFsLmVtdWxhdG9yQ29uZmlnKSwgYXV0aEludGVybmFsLCBcImVtdWxhdG9yLWNvbmZpZy1mYWlsZWRcIiAvKiBBdXRoRXJyb3JDb2RlLkVNVUxBVE9SX0NPTkZJR19GQUlMRUQgKi8pO1xuICAgICAgICAvLyBJdCdzIHZhbGlkLCBob3dldmVyLCB0byBpbnZva2UgY29ubmVjdEF1dGhFbXVsYXRvcigpIGFmdGVyIEF1dGggaGFzIHN0YXJ0ZWQgbWFraW5nXG4gICAgICAgIC8vIGNvbm5lY3Rpb25zLCBzbyBsb25nIGFzIHRoZSBjb25maWcgbWF0Y2hlcyB0aGUgZXhpc3RpbmcgY29uZmlnLiBUaGlzIHJlc3VsdHMgaW4gYSBuby1vcC5cbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBhdXRoSW50ZXJuYWwuY29uZmlnLmVtdWxhdG9yID0gZW11bGF0b3I7XG4gICAgYXV0aEludGVybmFsLmVtdWxhdG9yQ29uZmlnID0gZW11bGF0b3JDb25maWc7XG4gICAgYXV0aEludGVybmFsLnNldHRpbmdzLmFwcFZlcmlmaWNhdGlvbkRpc2FibGVkRm9yVGVzdGluZyA9IHRydWU7XG4gICAgLy8gV29ya2Fyb3VuZCB0byBnZXQgY29va2llcyBpbiBGaXJlYmFzZSBTdHVkaW9cbiAgICBpZiAoaXNDbG91ZFdvcmtzdGF0aW9uKGhvc3QpKSB7XG4gICAgICAgIHZvaWQgcGluZ1NlcnZlcihgJHtwcm90b2NvbH0vLyR7aG9zdH0ke3BvcnRTdHJ9YCk7XG4gICAgICAgIHVwZGF0ZUVtdWxhdG9yQmFubmVyKCdBdXRoJywgdHJ1ZSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKCFkaXNhYmxlV2FybmluZ3MpIHtcbiAgICAgICAgZW1pdEVtdWxhdG9yV2FybmluZygpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGV4dHJhY3RQcm90b2NvbCh1cmwpIHtcbiAgICBjb25zdCBwcm90b2NvbEVuZCA9IHVybC5pbmRleE9mKCc6Jyk7XG4gICAgcmV0dXJuIHByb3RvY29sRW5kIDwgMCA/ICcnIDogdXJsLnN1YnN0cigwLCBwcm90b2NvbEVuZCArIDEpO1xufVxuZnVuY3Rpb24gZXh0cmFjdEhvc3RBbmRQb3J0KHVybCkge1xuICAgIGNvbnN0IHByb3RvY29sID0gZXh0cmFjdFByb3RvY29sKHVybCk7XG4gICAgY29uc3QgYXV0aG9yaXR5ID0gLyhcXC9cXC8pPyhbXj8jL10rKS8uZXhlYyh1cmwuc3Vic3RyKHByb3RvY29sLmxlbmd0aCkpOyAvLyBCZXR3ZWVuIC8vIGFuZCAvLCA/IG9yICMuXG4gICAgaWYgKCFhdXRob3JpdHkpIHtcbiAgICAgICAgcmV0dXJuIHsgaG9zdDogJycsIHBvcnQ6IG51bGwgfTtcbiAgICB9XG4gICAgY29uc3QgaG9zdEFuZFBvcnQgPSBhdXRob3JpdHlbMl0uc3BsaXQoJ0AnKS5wb3AoKSB8fCAnJzsgLy8gU3RyaXAgb3V0IFwidXNlcm5hbWU6cGFzc3dvcmRAXCIuXG4gICAgY29uc3QgYnJhY2tldGVkSVB2NiA9IC9eKFxcW1teXFxdXStcXF0pKDp8JCkvLmV4ZWMoaG9zdEFuZFBvcnQpO1xuICAgIGlmIChicmFja2V0ZWRJUHY2KSB7XG4gICAgICAgIGNvbnN0IGhvc3QgPSBicmFja2V0ZWRJUHY2WzFdO1xuICAgICAgICByZXR1cm4geyBob3N0LCBwb3J0OiBwYXJzZVBvcnQoaG9zdEFuZFBvcnQuc3Vic3RyKGhvc3QubGVuZ3RoICsgMSkpIH07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjb25zdCBbaG9zdCwgcG9ydF0gPSBob3N0QW5kUG9ydC5zcGxpdCgnOicpO1xuICAgICAgICByZXR1cm4geyBob3N0LCBwb3J0OiBwYXJzZVBvcnQocG9ydCkgfTtcbiAgICB9XG59XG5mdW5jdGlvbiBwYXJzZVBvcnQocG9ydFN0cikge1xuICAgIGlmICghcG9ydFN0cikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgcG9ydCA9IE51bWJlcihwb3J0U3RyKTtcbiAgICBpZiAoaXNOYU4ocG9ydCkpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiBwb3J0O1xufVxuZnVuY3Rpb24gZW1pdEVtdWxhdG9yV2FybmluZygpIHtcbiAgICBmdW5jdGlvbiBhdHRhY2hCYW5uZXIoKSB7XG4gICAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICAgICAgICBjb25zdCBzdHkgPSBlbC5zdHlsZTtcbiAgICAgICAgZWwuaW5uZXJUZXh0ID1cbiAgICAgICAgICAgICdSdW5uaW5nIGluIGVtdWxhdG9yIG1vZGUuIERvIG5vdCB1c2Ugd2l0aCBwcm9kdWN0aW9uIGNyZWRlbnRpYWxzLic7XG4gICAgICAgIHN0eS5wb3NpdGlvbiA9ICdmaXhlZCc7XG4gICAgICAgIHN0eS53aWR0aCA9ICcxMDAlJztcbiAgICAgICAgc3R5LmJhY2tncm91bmRDb2xvciA9ICcjZmZmZmZmJztcbiAgICAgICAgc3R5LmJvcmRlciA9ICcuMWVtIHNvbGlkICMwMDAwMDAnO1xuICAgICAgICBzdHkuY29sb3IgPSAnI2I1MDAwMCc7XG4gICAgICAgIHN0eS5ib3R0b20gPSAnMHB4JztcbiAgICAgICAgc3R5LmxlZnQgPSAnMHB4JztcbiAgICAgICAgc3R5Lm1hcmdpbiA9ICcwcHgnO1xuICAgICAgICBzdHkuekluZGV4ID0gJzEwMDAwJztcbiAgICAgICAgc3R5LnRleHRBbGlnbiA9ICdjZW50ZXInO1xuICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKCdmaXJlYmFzZS1lbXVsYXRvci13YXJuaW5nJyk7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWwpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGNvbnNvbGUgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBjb25zb2xlLmluZm8gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgY29uc29sZS5pbmZvKCdXQVJOSU5HOiBZb3UgYXJlIHVzaW5nIHRoZSBBdXRoIEVtdWxhdG9yLCcgK1xuICAgICAgICAgICAgJyB3aGljaCBpcyBpbnRlbmRlZCBmb3IgbG9jYWwgdGVzdGluZyBvbmx5LiAgRG8gbm90IHVzZSB3aXRoJyArXG4gICAgICAgICAgICAnIHByb2R1Y3Rpb24gY3JlZGVudGlhbHMuJyk7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSAnbG9hZGluZycpIHtcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgYXR0YWNoQmFubmVyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGF0dGFjaEJhbm5lcigpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBJbnRlcmZhY2UgdGhhdCByZXByZXNlbnRzIHRoZSBjcmVkZW50aWFscyByZXR1cm5lZCBieSBhbiB7QGxpbmsgQXV0aFByb3ZpZGVyfS5cbiAqXG4gKiBAcmVtYXJrc1xuICogSW1wbGVtZW50YXRpb25zIHNwZWNpZnkgdGhlIGRldGFpbHMgYWJvdXQgZWFjaCBhdXRoIHByb3ZpZGVyJ3MgY3JlZGVudGlhbCByZXF1aXJlbWVudHMuXG4gKlxuICogQHB1YmxpY1xuICovXG5jbGFzcyBBdXRoQ3JlZGVudGlhbCB7XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBhdXRoZW50aWNhdGlvbiBwcm92aWRlciBJRCBmb3IgdGhlIGNyZWRlbnRpYWwuXG4gICAgICpcbiAgICAgKiBAcmVtYXJrc1xuICAgICAqIEZvciBleGFtcGxlLCAnZmFjZWJvb2suY29tJywgb3IgJ2dvb2dsZS5jb20nLlxuICAgICAqL1xuICAgIHByb3ZpZGVySWQsIFxuICAgIC8qKlxuICAgICAqIFRoZSBhdXRoZW50aWNhdGlvbiBzaWduIGluIG1ldGhvZCBmb3IgdGhlIGNyZWRlbnRpYWwuXG4gICAgICpcbiAgICAgKiBAcmVtYXJrc1xuICAgICAqIEZvciBleGFtcGxlLCB7QGxpbmsgU2lnbkluTWV0aG9kfS5FTUFJTF9QQVNTV09SRCwgb3JcbiAgICAgKiB7QGxpbmsgU2lnbkluTWV0aG9kfS5FTUFJTF9MSU5LLiBUaGlzIGNvcnJlc3BvbmRzIHRvIHRoZSBzaWduLWluIG1ldGhvZFxuICAgICAqIGlkZW50aWZpZXIgYXMgcmV0dXJuZWQgaW4ge0BsaW5rIGZldGNoU2lnbkluTWV0aG9kc0ZvckVtYWlsfS5cbiAgICAgKi9cbiAgICBzaWduSW5NZXRob2QpIHtcbiAgICAgICAgdGhpcy5wcm92aWRlcklkID0gcHJvdmlkZXJJZDtcbiAgICAgICAgdGhpcy5zaWduSW5NZXRob2QgPSBzaWduSW5NZXRob2Q7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBKU09OLXNlcmlhbGl6YWJsZSByZXByZXNlbnRhdGlvbiBvZiB0aGlzIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIGEgSlNPTi1zZXJpYWxpemFibGUgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBvYmplY3QuXG4gICAgICovXG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4gZGVidWdGYWlsKCdub3QgaW1wbGVtZW50ZWQnKTtcbiAgICB9XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIF9nZXRJZFRva2VuUmVzcG9uc2UoX2F1dGgpIHtcbiAgICAgICAgcmV0dXJuIGRlYnVnRmFpbCgnbm90IGltcGxlbWVudGVkJyk7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBfbGlua1RvSWRUb2tlbihfYXV0aCwgX2lkVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIGRlYnVnRmFpbCgnbm90IGltcGxlbWVudGVkJyk7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBfZ2V0UmVhdXRoZW50aWNhdGlvblJlc29sdmVyKF9hdXRoKSB7XG4gICAgICAgIHJldHVybiBkZWJ1Z0ZhaWwoJ25vdCBpbXBsZW1lbnRlZCcpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHJlc2V0UGFzc3dvcmQoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92MS9hY2NvdW50czpyZXNldFBhc3N3b3JkXCIgLyogRW5kcG9pbnQuUkVTRVRfUEFTU1dPUkQgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XG59XG5hc3luYyBmdW5jdGlvbiB1cGRhdGVFbWFpbFBhc3N3b3JkKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6dXBkYXRlXCIgLyogRW5kcG9pbnQuU0VUX0FDQ09VTlRfSU5GTyAqLywgcmVxdWVzdCk7XG59XG4vLyBVc2VkIGZvciBsaW5raW5nIGFuIGVtYWlsL3Bhc3N3b3JkIGFjY291bnQgdG8gYW4gZXhpc3RpbmcgaWRUb2tlbi4gVXNlcyB0aGUgc2FtZSByZXF1ZXN0L3Jlc3BvbnNlXG4vLyBmb3JtYXQgYXMgdXBkYXRlRW1haWxQYXNzd29yZC5cbmFzeW5jIGZ1bmN0aW9uIGxpbmtFbWFpbFBhc3N3b3JkKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6c2lnblVwXCIgLyogRW5kcG9pbnQuU0lHTl9VUCAqLywgcmVxdWVzdCk7XG59XG5hc3luYyBmdW5jdGlvbiBhcHBseUFjdGlvbkNvZGUkMShhdXRoLCByZXF1ZXN0KSB7XG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBIdHRwTWV0aG9kLlBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnVwZGF0ZVwiIC8qIEVuZHBvaW50LlNFVF9BQ0NPVU5UX0lORk8gKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5hc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoUGFzc3dvcmQoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybVNpZ25JblJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92MS9hY2NvdW50czpzaWduSW5XaXRoUGFzc3dvcmRcIiAvKiBFbmRwb2ludC5TSUdOX0lOX1dJVEhfUEFTU1dPUkQgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XG59XG5hc3luYyBmdW5jdGlvbiBzZW5kT29iQ29kZShhdXRoLCByZXF1ZXN0KSB7XG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBIdHRwTWV0aG9kLlBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnNlbmRPb2JDb2RlXCIgLyogRW5kcG9pbnQuU0VORF9PT0JfQ09ERSAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHNlbmRFbWFpbFZlcmlmaWNhdGlvbiQxKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gc2VuZE9vYkNvZGUoYXV0aCwgcmVxdWVzdCk7XG59XG5hc3luYyBmdW5jdGlvbiBzZW5kUGFzc3dvcmRSZXNldEVtYWlsJDEoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBzZW5kT29iQ29kZShhdXRoLCByZXF1ZXN0KTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHNlbmRTaWduSW5MaW5rVG9FbWFpbCQxKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gc2VuZE9vYkNvZGUoYXV0aCwgcmVxdWVzdCk7XG59XG5hc3luYyBmdW5jdGlvbiB2ZXJpZnlBbmRDaGFuZ2VFbWFpbChhdXRoLCByZXF1ZXN0KSB7XG4gICAgcmV0dXJuIHNlbmRPb2JDb2RlKGF1dGgsIHJlcXVlc3QpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aEVtYWlsTGluayQxKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1TaWduSW5SZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6c2lnbkluV2l0aEVtYWlsTGlua1wiIC8qIEVuZHBvaW50LlNJR05fSU5fV0lUSF9FTUFJTF9MSU5LICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xufVxuYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aEVtYWlsTGlua0ZvckxpbmtpbmcoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybVNpZ25JblJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92MS9hY2NvdW50czpzaWduSW5XaXRoRW1haWxMaW5rXCIgLyogRW5kcG9pbnQuU0lHTl9JTl9XSVRIX0VNQUlMX0xJTksgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEludGVyZmFjZSB0aGF0IHJlcHJlc2VudHMgdGhlIGNyZWRlbnRpYWxzIHJldHVybmVkIGJ5IHtAbGluayBFbWFpbEF1dGhQcm92aWRlcn0gZm9yXG4gKiB7QGxpbmsgUHJvdmlkZXJJZH0uUEFTU1dPUkRcbiAqXG4gKiBAcmVtYXJrc1xuICogQ292ZXJzIGJvdGgge0BsaW5rIFNpZ25Jbk1ldGhvZH0uRU1BSUxfUEFTU1dPUkQgYW5kXG4gKiB7QGxpbmsgU2lnbkluTWV0aG9kfS5FTUFJTF9MSU5LLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuY2xhc3MgRW1haWxBdXRoQ3JlZGVudGlhbCBleHRlbmRzIEF1dGhDcmVkZW50aWFsIHtcbiAgICAvKiogQGludGVybmFsICovXG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIF9lbWFpbCwgXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIF9wYXNzd29yZCwgc2lnbkluTWV0aG9kLCBcbiAgICAvKiogQGludGVybmFsICovXG4gICAgX3RlbmFudElkID0gbnVsbCkge1xuICAgICAgICBzdXBlcihcInBhc3N3b3JkXCIgLyogUHJvdmlkZXJJZC5QQVNTV09SRCAqLywgc2lnbkluTWV0aG9kKTtcbiAgICAgICAgdGhpcy5fZW1haWwgPSBfZW1haWw7XG4gICAgICAgIHRoaXMuX3Bhc3N3b3JkID0gX3Bhc3N3b3JkO1xuICAgICAgICB0aGlzLl90ZW5hbnRJZCA9IF90ZW5hbnRJZDtcbiAgICB9XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIHN0YXRpYyBfZnJvbUVtYWlsQW5kUGFzc3dvcmQoZW1haWwsIHBhc3N3b3JkKSB7XG4gICAgICAgIHJldHVybiBuZXcgRW1haWxBdXRoQ3JlZGVudGlhbChlbWFpbCwgcGFzc3dvcmQsIFwicGFzc3dvcmRcIiAvKiBTaWduSW5NZXRob2QuRU1BSUxfUEFTU1dPUkQgKi8pO1xuICAgIH1cbiAgICAvKiogQGludGVybmFsICovXG4gICAgc3RhdGljIF9mcm9tRW1haWxBbmRDb2RlKGVtYWlsLCBvb2JDb2RlLCB0ZW5hbnRJZCA9IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBFbWFpbEF1dGhDcmVkZW50aWFsKGVtYWlsLCBvb2JDb2RlLCBcImVtYWlsTGlua1wiIC8qIFNpZ25Jbk1ldGhvZC5FTUFJTF9MSU5LICovLCB0ZW5hbnRJZCk7XG4gICAgfVxuICAgIC8qKiB7QGluaGVyaXRkb2MgQXV0aENyZWRlbnRpYWwudG9KU09OfSAqL1xuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGVtYWlsOiB0aGlzLl9lbWFpbCxcbiAgICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLl9wYXNzd29yZCxcbiAgICAgICAgICAgIHNpZ25Jbk1ldGhvZDogdGhpcy5zaWduSW5NZXRob2QsXG4gICAgICAgICAgICB0ZW5hbnRJZDogdGhpcy5fdGVuYW50SWRcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RhdGljIG1ldGhvZCB0byBkZXNlcmlhbGl6ZSBhIEpTT04gcmVwcmVzZW50YXRpb24gb2YgYW4gb2JqZWN0IGludG8gYW4ge0BsaW5rICBBdXRoQ3JlZGVudGlhbH0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ganNvbiAtIEVpdGhlciBgb2JqZWN0YCBvciB0aGUgc3RyaW5naWZpZWQgcmVwcmVzZW50YXRpb24gb2YgdGhlIG9iamVjdC4gV2hlbiBzdHJpbmcgaXNcbiAgICAgKiBwcm92aWRlZCwgYEpTT04ucGFyc2VgIHdvdWxkIGJlIGNhbGxlZCBmaXJzdC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIElmIHRoZSBKU09OIGlucHV0IGRvZXMgbm90IHJlcHJlc2VudCBhbiB7QGxpbmsgQXV0aENyZWRlbnRpYWx9LCBudWxsIGlzIHJldHVybmVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIGNvbnN0IG9iaiA9IHR5cGVvZiBqc29uID09PSAnc3RyaW5nJyA/IEpTT04ucGFyc2UoanNvbikgOiBqc29uO1xuICAgICAgICBpZiAob2JqPy5lbWFpbCAmJiBvYmo/LnBhc3N3b3JkKSB7XG4gICAgICAgICAgICBpZiAob2JqLnNpZ25Jbk1ldGhvZCA9PT0gXCJwYXNzd29yZFwiIC8qIFNpZ25Jbk1ldGhvZC5FTUFJTF9QQVNTV09SRCAqLykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9mcm9tRW1haWxBbmRQYXNzd29yZChvYmouZW1haWwsIG9iai5wYXNzd29yZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChvYmouc2lnbkluTWV0aG9kID09PSBcImVtYWlsTGlua1wiIC8qIFNpZ25Jbk1ldGhvZC5FTUFJTF9MSU5LICovKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Zyb21FbWFpbEFuZENvZGUob2JqLmVtYWlsLCBvYmoucGFzc3dvcmQsIG9iai50ZW5hbnRJZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBhc3luYyBfZ2V0SWRUb2tlblJlc3BvbnNlKGF1dGgpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLnNpZ25Jbk1ldGhvZCkge1xuICAgICAgICAgICAgY2FzZSBcInBhc3N3b3JkXCIgLyogU2lnbkluTWV0aG9kLkVNQUlMX1BBU1NXT1JEICovOlxuICAgICAgICAgICAgICAgIGNvbnN0IHJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblNlY3VyZVRva2VuOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy5fZW1haWwsXG4gICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLl9wYXNzd29yZCxcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50VHlwZTogXCJDTElFTlRfVFlQRV9XRUJcIiAvKiBSZWNhcHRjaGFDbGllbnRUeXBlLldFQiAqL1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZVJlY2FwdGNoYUZsb3coYXV0aCwgcmVxdWVzdCwgXCJzaWduSW5XaXRoUGFzc3dvcmRcIiAvKiBSZWNhcHRjaGFBY3Rpb25OYW1lLlNJR05fSU5fV0lUSF9QQVNTV09SRCAqLywgc2lnbkluV2l0aFBhc3N3b3JkLCBcIkVNQUlMX1BBU1NXT1JEX1BST1ZJREVSXCIgLyogUmVjYXB0Y2hhQXV0aFByb3ZpZGVyLkVNQUlMX1BBU1NXT1JEX1BST1ZJREVSICovKTtcbiAgICAgICAgICAgIGNhc2UgXCJlbWFpbExpbmtcIiAvKiBTaWduSW5NZXRob2QuRU1BSUxfTElOSyAqLzpcbiAgICAgICAgICAgICAgICByZXR1cm4gc2lnbkluV2l0aEVtYWlsTGluayQxKGF1dGgsIHtcbiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuX2VtYWlsLFxuICAgICAgICAgICAgICAgICAgICBvb2JDb2RlOiB0aGlzLl9wYXNzd29yZFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBfZmFpbChhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIGFzeW5jIF9saW5rVG9JZFRva2VuKGF1dGgsIGlkVG9rZW4pIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLnNpZ25Jbk1ldGhvZCkge1xuICAgICAgICAgICAgY2FzZSBcInBhc3N3b3JkXCIgLyogU2lnbkluTWV0aG9kLkVNQUlMX1BBU1NXT1JEICovOlxuICAgICAgICAgICAgICAgIGNvbnN0IHJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgICAgICAgIGlkVG9rZW4sXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblNlY3VyZVRva2VuOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy5fZW1haWwsXG4gICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLl9wYXNzd29yZCxcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50VHlwZTogXCJDTElFTlRfVFlQRV9XRUJcIiAvKiBSZWNhcHRjaGFDbGllbnRUeXBlLldFQiAqL1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZVJlY2FwdGNoYUZsb3coYXV0aCwgcmVxdWVzdCwgXCJzaWduVXBQYXNzd29yZFwiIC8qIFJlY2FwdGNoYUFjdGlvbk5hbWUuU0lHTl9VUF9QQVNTV09SRCAqLywgbGlua0VtYWlsUGFzc3dvcmQsIFwiRU1BSUxfUEFTU1dPUkRfUFJPVklERVJcIiAvKiBSZWNhcHRjaGFBdXRoUHJvdmlkZXIuRU1BSUxfUEFTU1dPUkRfUFJPVklERVIgKi8pO1xuICAgICAgICAgICAgY2FzZSBcImVtYWlsTGlua1wiIC8qIFNpZ25Jbk1ldGhvZC5FTUFJTF9MSU5LICovOlxuICAgICAgICAgICAgICAgIHJldHVybiBzaWduSW5XaXRoRW1haWxMaW5rRm9yTGlua2luZyhhdXRoLCB7XG4gICAgICAgICAgICAgICAgICAgIGlkVG9rZW4sXG4gICAgICAgICAgICAgICAgICAgIGVtYWlsOiB0aGlzLl9lbWFpbCxcbiAgICAgICAgICAgICAgICAgICAgb29iQ29kZTogdGhpcy5fcGFzc3dvcmRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgX2ZhaWwoYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBfZ2V0UmVhdXRoZW50aWNhdGlvblJlc29sdmVyKGF1dGgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldElkVG9rZW5SZXNwb25zZShhdXRoKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5hc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoSWRwKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1TaWduSW5SZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6c2lnbkluV2l0aElkcFwiIC8qIEVuZHBvaW50LlNJR05fSU5fV0lUSF9JRFAgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jb25zdCBJRFBfUkVRVUVTVF9VUkkkMSA9ICdodHRwOi8vbG9jYWxob3N0Jztcbi8qKlxuICogUmVwcmVzZW50cyB0aGUgT0F1dGggY3JlZGVudGlhbHMgcmV0dXJuZWQgYnkgYW4ge0BsaW5rIE9BdXRoUHJvdmlkZXJ9LlxuICpcbiAqIEByZW1hcmtzXG4gKiBJbXBsZW1lbnRhdGlvbnMgc3BlY2lmeSB0aGUgZGV0YWlscyBhYm91dCBlYWNoIGF1dGggcHJvdmlkZXIncyBjcmVkZW50aWFsIHJlcXVpcmVtZW50cy5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmNsYXNzIE9BdXRoQ3JlZGVudGlhbCBleHRlbmRzIEF1dGhDcmVkZW50aWFsIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICAgICAgdGhpcy5wZW5kaW5nVG9rZW4gPSBudWxsO1xuICAgIH1cbiAgICAvKiogQGludGVybmFsICovXG4gICAgc3RhdGljIF9mcm9tUGFyYW1zKHBhcmFtcykge1xuICAgICAgICBjb25zdCBjcmVkID0gbmV3IE9BdXRoQ3JlZGVudGlhbChwYXJhbXMucHJvdmlkZXJJZCwgcGFyYW1zLnNpZ25Jbk1ldGhvZCk7XG4gICAgICAgIGlmIChwYXJhbXMuaWRUb2tlbiB8fCBwYXJhbXMuYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgICAgIC8vIE9BdXRoIDIgYW5kIGVpdGhlciBJRCB0b2tlbiBvciBhY2Nlc3MgdG9rZW4uXG4gICAgICAgICAgICBpZiAocGFyYW1zLmlkVG9rZW4pIHtcbiAgICAgICAgICAgICAgICBjcmVkLmlkVG9rZW4gPSBwYXJhbXMuaWRUb2tlbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwYXJhbXMuYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgICAgICAgICBjcmVkLmFjY2Vzc1Rva2VuID0gcGFyYW1zLmFjY2Vzc1Rva2VuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gQWRkIG5vbmNlIGlmIGF2YWlsYWJsZSBhbmQgbm8gcGVuZGluZ1Rva2VuIGlzIHByZXNlbnQuXG4gICAgICAgICAgICBpZiAocGFyYW1zLm5vbmNlICYmICFwYXJhbXMucGVuZGluZ1Rva2VuKSB7XG4gICAgICAgICAgICAgICAgY3JlZC5ub25jZSA9IHBhcmFtcy5ub25jZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwYXJhbXMucGVuZGluZ1Rva2VuKSB7XG4gICAgICAgICAgICAgICAgY3JlZC5wZW5kaW5nVG9rZW4gPSBwYXJhbXMucGVuZGluZ1Rva2VuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHBhcmFtcy5vYXV0aFRva2VuICYmIHBhcmFtcy5vYXV0aFRva2VuU2VjcmV0KSB7XG4gICAgICAgICAgICAvLyBPQXV0aCAxIGFuZCBPQXV0aCB0b2tlbiB3aXRoIHRva2VuIHNlY3JldFxuICAgICAgICAgICAgY3JlZC5hY2Nlc3NUb2tlbiA9IHBhcmFtcy5vYXV0aFRva2VuO1xuICAgICAgICAgICAgY3JlZC5zZWNyZXQgPSBwYXJhbXMub2F1dGhUb2tlblNlY3JldDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIF9mYWlsKFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SICovKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3JlZDtcbiAgICB9XG4gICAgLyoqIHtAaW5oZXJpdGRvYyBBdXRoQ3JlZGVudGlhbC50b0pTT059ICAqL1xuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkVG9rZW46IHRoaXMuaWRUb2tlbixcbiAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiB0aGlzLmFjY2Vzc1Rva2VuLFxuICAgICAgICAgICAgc2VjcmV0OiB0aGlzLnNlY3JldCxcbiAgICAgICAgICAgIG5vbmNlOiB0aGlzLm5vbmNlLFxuICAgICAgICAgICAgcGVuZGluZ1Rva2VuOiB0aGlzLnBlbmRpbmdUb2tlbixcbiAgICAgICAgICAgIHByb3ZpZGVySWQ6IHRoaXMucHJvdmlkZXJJZCxcbiAgICAgICAgICAgIHNpZ25Jbk1ldGhvZDogdGhpcy5zaWduSW5NZXRob2RcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RhdGljIG1ldGhvZCB0byBkZXNlcmlhbGl6ZSBhIEpTT04gcmVwcmVzZW50YXRpb24gb2YgYW4gb2JqZWN0IGludG8gYW5cbiAgICAgKiB7QGxpbmsgIEF1dGhDcmVkZW50aWFsfS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBqc29uIC0gSW5wdXQgY2FuIGJlIGVpdGhlciBPYmplY3Qgb3IgdGhlIHN0cmluZ2lmaWVkIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBvYmplY3QuXG4gICAgICogV2hlbiBzdHJpbmcgaXMgcHJvdmlkZWQsIEpTT04ucGFyc2Ugd291bGQgYmUgY2FsbGVkIGZpcnN0LlxuICAgICAqXG4gICAgICogQHJldHVybnMgSWYgdGhlIEpTT04gaW5wdXQgZG9lcyBub3QgcmVwcmVzZW50IGFuIHtAbGluayAgQXV0aENyZWRlbnRpYWx9LCBudWxsIGlzIHJldHVybmVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIGNvbnN0IG9iaiA9IHR5cGVvZiBqc29uID09PSAnc3RyaW5nJyA/IEpTT04ucGFyc2UoanNvbikgOiBqc29uO1xuICAgICAgICBjb25zdCB7IHByb3ZpZGVySWQsIHNpZ25Jbk1ldGhvZCwgLi4ucmVzdCB9ID0gb2JqO1xuICAgICAgICBpZiAoIXByb3ZpZGVySWQgfHwgIXNpZ25Jbk1ldGhvZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY3JlZCA9IG5ldyBPQXV0aENyZWRlbnRpYWwocHJvdmlkZXJJZCwgc2lnbkluTWV0aG9kKTtcbiAgICAgICAgY3JlZC5pZFRva2VuID0gcmVzdC5pZFRva2VuIHx8IHVuZGVmaW5lZDtcbiAgICAgICAgY3JlZC5hY2Nlc3NUb2tlbiA9IHJlc3QuYWNjZXNzVG9rZW4gfHwgdW5kZWZpbmVkO1xuICAgICAgICBjcmVkLnNlY3JldCA9IHJlc3Quc2VjcmV0O1xuICAgICAgICBjcmVkLm5vbmNlID0gcmVzdC5ub25jZTtcbiAgICAgICAgY3JlZC5wZW5kaW5nVG9rZW4gPSByZXN0LnBlbmRpbmdUb2tlbiB8fCBudWxsO1xuICAgICAgICByZXR1cm4gY3JlZDtcbiAgICB9XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIF9nZXRJZFRva2VuUmVzcG9uc2UoYXV0aCkge1xuICAgICAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5idWlsZFJlcXVlc3QoKTtcbiAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhJZHAoYXV0aCwgcmVxdWVzdCk7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBfbGlua1RvSWRUb2tlbihhdXRoLCBpZFRva2VuKSB7XG4gICAgICAgIGNvbnN0IHJlcXVlc3QgPSB0aGlzLmJ1aWxkUmVxdWVzdCgpO1xuICAgICAgICByZXF1ZXN0LmlkVG9rZW4gPSBpZFRva2VuO1xuICAgICAgICByZXR1cm4gc2lnbkluV2l0aElkcChhdXRoLCByZXF1ZXN0KTtcbiAgICB9XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIF9nZXRSZWF1dGhlbnRpY2F0aW9uUmVzb2x2ZXIoYXV0aCkge1xuICAgICAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5idWlsZFJlcXVlc3QoKTtcbiAgICAgICAgcmVxdWVzdC5hdXRvQ3JlYXRlID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBzaWduSW5XaXRoSWRwKGF1dGgsIHJlcXVlc3QpO1xuICAgIH1cbiAgICBidWlsZFJlcXVlc3QoKSB7XG4gICAgICAgIGNvbnN0IHJlcXVlc3QgPSB7XG4gICAgICAgICAgICByZXF1ZXN0VXJpOiBJRFBfUkVRVUVTVF9VUkkkMSxcbiAgICAgICAgICAgIHJldHVyblNlY3VyZVRva2VuOiB0cnVlXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLnBlbmRpbmdUb2tlbikge1xuICAgICAgICAgICAgcmVxdWVzdC5wZW5kaW5nVG9rZW4gPSB0aGlzLnBlbmRpbmdUb2tlbjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHBvc3RCb2R5ID0ge307XG4gICAgICAgICAgICBpZiAodGhpcy5pZFRva2VuKSB7XG4gICAgICAgICAgICAgICAgcG9zdEJvZHlbJ2lkX3Rva2VuJ10gPSB0aGlzLmlkVG9rZW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5hY2Nlc3NUb2tlbikge1xuICAgICAgICAgICAgICAgIHBvc3RCb2R5WydhY2Nlc3NfdG9rZW4nXSA9IHRoaXMuYWNjZXNzVG9rZW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5zZWNyZXQpIHtcbiAgICAgICAgICAgICAgICBwb3N0Qm9keVsnb2F1dGhfdG9rZW5fc2VjcmV0J10gPSB0aGlzLnNlY3JldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBvc3RCb2R5Wydwcm92aWRlcklkJ10gPSB0aGlzLnByb3ZpZGVySWQ7XG4gICAgICAgICAgICBpZiAodGhpcy5ub25jZSAmJiAhdGhpcy5wZW5kaW5nVG9rZW4pIHtcbiAgICAgICAgICAgICAgICBwb3N0Qm9keVsnbm9uY2UnXSA9IHRoaXMubm9uY2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXF1ZXN0LnBvc3RCb2R5ID0gcXVlcnlzdHJpbmcocG9zdEJvZHkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXF1ZXN0O1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHNlbmRQaG9uZVZlcmlmaWNhdGlvbkNvZGUoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92MS9hY2NvdW50czpzZW5kVmVyaWZpY2F0aW9uQ29kZVwiIC8qIEVuZHBvaW50LlNFTkRfVkVSSUZJQ0FUSU9OX0NPREUgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XG59XG5hc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoUGhvbmVOdW1iZXIoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybVNpZ25JblJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92MS9hY2NvdW50czpzaWduSW5XaXRoUGhvbmVOdW1iZXJcIiAvKiBFbmRwb2ludC5TSUdOX0lOX1dJVEhfUEhPTkVfTlVNQkVSICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xufVxuYXN5bmMgZnVuY3Rpb24gbGlua1dpdGhQaG9uZU51bWJlcihhdXRoLCByZXF1ZXN0KSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBfcGVyZm9ybVNpZ25JblJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92MS9hY2NvdW50czpzaWduSW5XaXRoUGhvbmVOdW1iZXJcIiAvKiBFbmRwb2ludC5TSUdOX0lOX1dJVEhfUEhPTkVfTlVNQkVSICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xuICAgIGlmIChyZXNwb25zZS50ZW1wb3JhcnlQcm9vZikge1xuICAgICAgICB0aHJvdyBfbWFrZVRhZ2dlZEVycm9yKGF1dGgsIFwiYWNjb3VudC1leGlzdHMtd2l0aC1kaWZmZXJlbnQtY3JlZGVudGlhbFwiIC8qIEF1dGhFcnJvckNvZGUuTkVFRF9DT05GSVJNQVRJT04gKi8sIHJlc3BvbnNlKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3BvbnNlO1xufVxuY29uc3QgVkVSSUZZX1BIT05FX05VTUJFUl9GT1JfRVhJU1RJTkdfRVJST1JfTUFQXyA9IHtcbiAgICBbXCJVU0VSX05PVF9GT1VORFwiIC8qIFNlcnZlckVycm9yLlVTRVJfTk9UX0ZPVU5EICovXTogXCJ1c2VyLW5vdC1mb3VuZFwiIC8qIEF1dGhFcnJvckNvZGUuVVNFUl9ERUxFVEVEICovXG59O1xuYXN5bmMgZnVuY3Rpb24gdmVyaWZ5UGhvbmVOdW1iZXJGb3JFeGlzdGluZyhhdXRoLCByZXF1ZXN0KSB7XG4gICAgY29uc3QgYXBpUmVxdWVzdCA9IHtcbiAgICAgICAgLi4ucmVxdWVzdCxcbiAgICAgICAgb3BlcmF0aW9uOiAnUkVBVVRIJ1xuICAgIH07XG4gICAgcmV0dXJuIF9wZXJmb3JtU2lnbkluUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBIdHRwTWV0aG9kLlBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnNpZ25JbldpdGhQaG9uZU51bWJlclwiIC8qIEVuZHBvaW50LlNJR05fSU5fV0lUSF9QSE9ORV9OVU1CRVIgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCBhcGlSZXF1ZXN0KSwgVkVSSUZZX1BIT05FX05VTUJFUl9GT1JfRVhJU1RJTkdfRVJST1JfTUFQXyk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIGNyZWRlbnRpYWxzIHJldHVybmVkIGJ5IHtAbGluayBQaG9uZUF1dGhQcm92aWRlcn0uXG4gKlxuICogQHB1YmxpY1xuICovXG5jbGFzcyBQaG9uZUF1dGhDcmVkZW50aWFsIGV4dGVuZHMgQXV0aENyZWRlbnRpYWwge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtcykge1xuICAgICAgICBzdXBlcihcInBob25lXCIgLyogUHJvdmlkZXJJZC5QSE9ORSAqLywgXCJwaG9uZVwiIC8qIFNpZ25Jbk1ldGhvZC5QSE9ORSAqLyk7XG4gICAgICAgIHRoaXMucGFyYW1zID0gcGFyYW1zO1xuICAgIH1cbiAgICAvKiogQGludGVybmFsICovXG4gICAgc3RhdGljIF9mcm9tVmVyaWZpY2F0aW9uKHZlcmlmaWNhdGlvbklkLCB2ZXJpZmljYXRpb25Db2RlKSB7XG4gICAgICAgIHJldHVybiBuZXcgUGhvbmVBdXRoQ3JlZGVudGlhbCh7IHZlcmlmaWNhdGlvbklkLCB2ZXJpZmljYXRpb25Db2RlIH0pO1xuICAgIH1cbiAgICAvKiogQGludGVybmFsICovXG4gICAgc3RhdGljIF9mcm9tVG9rZW5SZXNwb25zZShwaG9uZU51bWJlciwgdGVtcG9yYXJ5UHJvb2YpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQaG9uZUF1dGhDcmVkZW50aWFsKHsgcGhvbmVOdW1iZXIsIHRlbXBvcmFyeVByb29mIH0pO1xuICAgIH1cbiAgICAvKiogQGludGVybmFsICovXG4gICAgX2dldElkVG9rZW5SZXNwb25zZShhdXRoKSB7XG4gICAgICAgIHJldHVybiBzaWduSW5XaXRoUGhvbmVOdW1iZXIoYXV0aCwgdGhpcy5fbWFrZVZlcmlmaWNhdGlvblJlcXVlc3QoKSk7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBfbGlua1RvSWRUb2tlbihhdXRoLCBpZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBsaW5rV2l0aFBob25lTnVtYmVyKGF1dGgsIHtcbiAgICAgICAgICAgIGlkVG9rZW4sXG4gICAgICAgICAgICAuLi50aGlzLl9tYWtlVmVyaWZpY2F0aW9uUmVxdWVzdCgpXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKiogQGludGVybmFsICovXG4gICAgX2dldFJlYXV0aGVudGljYXRpb25SZXNvbHZlcihhdXRoKSB7XG4gICAgICAgIHJldHVybiB2ZXJpZnlQaG9uZU51bWJlckZvckV4aXN0aW5nKGF1dGgsIHRoaXMuX21ha2VWZXJpZmljYXRpb25SZXF1ZXN0KCkpO1xuICAgIH1cbiAgICAvKiogQGludGVybmFsICovXG4gICAgX21ha2VWZXJpZmljYXRpb25SZXF1ZXN0KCkge1xuICAgICAgICBjb25zdCB7IHRlbXBvcmFyeVByb29mLCBwaG9uZU51bWJlciwgdmVyaWZpY2F0aW9uSWQsIHZlcmlmaWNhdGlvbkNvZGUgfSA9IHRoaXMucGFyYW1zO1xuICAgICAgICBpZiAodGVtcG9yYXJ5UHJvb2YgJiYgcGhvbmVOdW1iZXIpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHRlbXBvcmFyeVByb29mLCBwaG9uZU51bWJlciB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzZXNzaW9uSW5mbzogdmVyaWZpY2F0aW9uSWQsXG4gICAgICAgICAgICBjb2RlOiB2ZXJpZmljYXRpb25Db2RlXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKiB7QGluaGVyaXRkb2MgQXV0aENyZWRlbnRpYWwudG9KU09OfSAqL1xuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3Qgb2JqID0ge1xuICAgICAgICAgICAgcHJvdmlkZXJJZDogdGhpcy5wcm92aWRlcklkXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLnBhcmFtcy5waG9uZU51bWJlcikge1xuICAgICAgICAgICAgb2JqLnBob25lTnVtYmVyID0gdGhpcy5wYXJhbXMucGhvbmVOdW1iZXI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFyYW1zLnRlbXBvcmFyeVByb29mKSB7XG4gICAgICAgICAgICBvYmoudGVtcG9yYXJ5UHJvb2YgPSB0aGlzLnBhcmFtcy50ZW1wb3JhcnlQcm9vZjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJhbXMudmVyaWZpY2F0aW9uQ29kZSkge1xuICAgICAgICAgICAgb2JqLnZlcmlmaWNhdGlvbkNvZGUgPSB0aGlzLnBhcmFtcy52ZXJpZmljYXRpb25Db2RlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmFtcy52ZXJpZmljYXRpb25JZCkge1xuICAgICAgICAgICAgb2JqLnZlcmlmaWNhdGlvbklkID0gdGhpcy5wYXJhbXMudmVyaWZpY2F0aW9uSWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB9XG4gICAgLyoqIEdlbmVyYXRlcyBhIHBob25lIGNyZWRlbnRpYWwgYmFzZWQgb24gYSBwbGFpbiBvYmplY3Qgb3IgYSBKU09OIHN0cmluZy4gKi9cbiAgICBzdGF0aWMgZnJvbUpTT04oanNvbikge1xuICAgICAgICBpZiAodHlwZW9mIGpzb24gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBqc29uID0gSlNPTi5wYXJzZShqc29uKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IHZlcmlmaWNhdGlvbklkLCB2ZXJpZmljYXRpb25Db2RlLCBwaG9uZU51bWJlciwgdGVtcG9yYXJ5UHJvb2YgfSA9IGpzb247XG4gICAgICAgIGlmICghdmVyaWZpY2F0aW9uQ29kZSAmJlxuICAgICAgICAgICAgIXZlcmlmaWNhdGlvbklkICYmXG4gICAgICAgICAgICAhcGhvbmVOdW1iZXIgJiZcbiAgICAgICAgICAgICF0ZW1wb3JhcnlQcm9vZikge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBQaG9uZUF1dGhDcmVkZW50aWFsKHtcbiAgICAgICAgICAgIHZlcmlmaWNhdGlvbklkLFxuICAgICAgICAgICAgdmVyaWZpY2F0aW9uQ29kZSxcbiAgICAgICAgICAgIHBob25lTnVtYmVyLFxuICAgICAgICAgICAgdGVtcG9yYXJ5UHJvb2ZcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBNYXBzIHRoZSBtb2RlIHN0cmluZyBpbiBhY3Rpb24gY29kZSBVUkwgdG8gQWN0aW9uIENvZGUgSW5mbyBvcGVyYXRpb24uXG4gKlxuICogQHBhcmFtIG1vZGVcbiAqL1xuZnVuY3Rpb24gcGFyc2VNb2RlKG1vZGUpIHtcbiAgICBzd2l0Y2ggKG1vZGUpIHtcbiAgICAgICAgY2FzZSAncmVjb3ZlckVtYWlsJzpcbiAgICAgICAgICAgIHJldHVybiBcIlJFQ09WRVJfRU1BSUxcIiAvKiBBY3Rpb25Db2RlT3BlcmF0aW9uLlJFQ09WRVJfRU1BSUwgKi87XG4gICAgICAgIGNhc2UgJ3Jlc2V0UGFzc3dvcmQnOlxuICAgICAgICAgICAgcmV0dXJuIFwiUEFTU1dPUkRfUkVTRVRcIiAvKiBBY3Rpb25Db2RlT3BlcmF0aW9uLlBBU1NXT1JEX1JFU0VUICovO1xuICAgICAgICBjYXNlICdzaWduSW4nOlxuICAgICAgICAgICAgcmV0dXJuIFwiRU1BSUxfU0lHTklOXCIgLyogQWN0aW9uQ29kZU9wZXJhdGlvbi5FTUFJTF9TSUdOSU4gKi87XG4gICAgICAgIGNhc2UgJ3ZlcmlmeUVtYWlsJzpcbiAgICAgICAgICAgIHJldHVybiBcIlZFUklGWV9FTUFJTFwiIC8qIEFjdGlvbkNvZGVPcGVyYXRpb24uVkVSSUZZX0VNQUlMICovO1xuICAgICAgICBjYXNlICd2ZXJpZnlBbmRDaGFuZ2VFbWFpbCc6XG4gICAgICAgICAgICByZXR1cm4gXCJWRVJJRllfQU5EX0NIQU5HRV9FTUFJTFwiIC8qIEFjdGlvbkNvZGVPcGVyYXRpb24uVkVSSUZZX0FORF9DSEFOR0VfRU1BSUwgKi87XG4gICAgICAgIGNhc2UgJ3JldmVydFNlY29uZEZhY3RvckFkZGl0aW9uJzpcbiAgICAgICAgICAgIHJldHVybiBcIlJFVkVSVF9TRUNPTkRfRkFDVE9SX0FERElUSU9OXCIgLyogQWN0aW9uQ29kZU9wZXJhdGlvbi5SRVZFUlRfU0VDT05EX0ZBQ1RPUl9BRERJVElPTiAqLztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cbi8qKlxuICogSGVscGVyIHRvIHBhcnNlIEZETCBsaW5rc1xuICpcbiAqIEBwYXJhbSB1cmxcbiAqL1xuZnVuY3Rpb24gcGFyc2VEZWVwTGluayh1cmwpIHtcbiAgICBjb25zdCBsaW5rID0gcXVlcnlzdHJpbmdEZWNvZGUoZXh0cmFjdFF1ZXJ5c3RyaW5nKHVybCkpWydsaW5rJ107XG4gICAgLy8gRG91YmxlIGxpbmsgY2FzZSAoYXV0b21hdGljIHJlZGlyZWN0KS5cbiAgICBjb25zdCBkb3VibGVEZWVwTGluayA9IGxpbmtcbiAgICAgICAgPyBxdWVyeXN0cmluZ0RlY29kZShleHRyYWN0UXVlcnlzdHJpbmcobGluaykpWydkZWVwX2xpbmtfaWQnXVxuICAgICAgICA6IG51bGw7XG4gICAgLy8gaU9TIGN1c3RvbSBzY2hlbWUgbGlua3MuXG4gICAgY29uc3QgaU9TRGVlcExpbmsgPSBxdWVyeXN0cmluZ0RlY29kZShleHRyYWN0UXVlcnlzdHJpbmcodXJsKSlbJ2RlZXBfbGlua19pZCddO1xuICAgIGNvbnN0IGlPU0RvdWJsZURlZXBMaW5rID0gaU9TRGVlcExpbmtcbiAgICAgICAgPyBxdWVyeXN0cmluZ0RlY29kZShleHRyYWN0UXVlcnlzdHJpbmcoaU9TRGVlcExpbmspKVsnbGluayddXG4gICAgICAgIDogbnVsbDtcbiAgICByZXR1cm4gaU9TRG91YmxlRGVlcExpbmsgfHwgaU9TRGVlcExpbmsgfHwgZG91YmxlRGVlcExpbmsgfHwgbGluayB8fCB1cmw7XG59XG4vKipcbiAqIEEgdXRpbGl0eSBjbGFzcyB0byBwYXJzZSBlbWFpbCBhY3Rpb24gVVJMcyBzdWNoIGFzIHBhc3N3b3JkIHJlc2V0LCBlbWFpbCB2ZXJpZmljYXRpb24sXG4gKiBlbWFpbCBsaW5rIHNpZ24gaW4sIGV0Yy5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmNsYXNzIEFjdGlvbkNvZGVVUkwge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSBhY3Rpb25MaW5rIC0gVGhlIGxpbmsgZnJvbSB3aGljaCB0byBleHRyYWN0IHRoZSBVUkwuXG4gICAgICogQHJldHVybnMgVGhlIHtAbGluayBBY3Rpb25Db2RlVVJMfSBvYmplY3QsIG9yIG51bGwgaWYgdGhlIGxpbmsgaXMgaW52YWxpZC5cbiAgICAgKlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGFjdGlvbkxpbmspIHtcbiAgICAgICAgY29uc3Qgc2VhcmNoUGFyYW1zID0gcXVlcnlzdHJpbmdEZWNvZGUoZXh0cmFjdFF1ZXJ5c3RyaW5nKGFjdGlvbkxpbmspKTtcbiAgICAgICAgY29uc3QgYXBpS2V5ID0gc2VhcmNoUGFyYW1zW1wiYXBpS2V5XCIgLyogUXVlcnlGaWVsZC5BUElfS0VZICovXSA/PyBudWxsO1xuICAgICAgICBjb25zdCBjb2RlID0gc2VhcmNoUGFyYW1zW1wib29iQ29kZVwiIC8qIFF1ZXJ5RmllbGQuQ09ERSAqL10gPz8gbnVsbDtcbiAgICAgICAgY29uc3Qgb3BlcmF0aW9uID0gcGFyc2VNb2RlKHNlYXJjaFBhcmFtc1tcIm1vZGVcIiAvKiBRdWVyeUZpZWxkLk1PREUgKi9dID8/IG51bGwpO1xuICAgICAgICAvLyBWYWxpZGF0ZSBBUEkga2V5LCBjb2RlIGFuZCBtb2RlLlxuICAgICAgICBfYXNzZXJ0KGFwaUtleSAmJiBjb2RlICYmIG9wZXJhdGlvbiwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IgKi8pO1xuICAgICAgICB0aGlzLmFwaUtleSA9IGFwaUtleTtcbiAgICAgICAgdGhpcy5vcGVyYXRpb24gPSBvcGVyYXRpb247XG4gICAgICAgIHRoaXMuY29kZSA9IGNvZGU7XG4gICAgICAgIHRoaXMuY29udGludWVVcmwgPSBzZWFyY2hQYXJhbXNbXCJjb250aW51ZVVybFwiIC8qIFF1ZXJ5RmllbGQuQ09OVElOVUVfVVJMICovXSA/PyBudWxsO1xuICAgICAgICB0aGlzLmxhbmd1YWdlQ29kZSA9IHNlYXJjaFBhcmFtc1tcImxhbmdcIiAvKiBRdWVyeUZpZWxkLkxBTkdVQUdFX0NPREUgKi9dID8/IG51bGw7XG4gICAgICAgIHRoaXMudGVuYW50SWQgPSBzZWFyY2hQYXJhbXNbXCJ0ZW5hbnRJZFwiIC8qIFF1ZXJ5RmllbGQuVEVOQU5UX0lEICovXSA/PyBudWxsO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgdGhlIGVtYWlsIGFjdGlvbiBsaW5rIHN0cmluZyBhbmQgcmV0dXJucyBhbiB7QGxpbmsgQWN0aW9uQ29kZVVSTH0gaWYgdGhlIGxpbmsgaXMgdmFsaWQsXG4gICAgICogb3RoZXJ3aXNlIHJldHVybnMgbnVsbC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBsaW5rICAtIFRoZSBlbWFpbCBhY3Rpb24gbGluayBzdHJpbmcuXG4gICAgICogQHJldHVybnMgVGhlIHtAbGluayBBY3Rpb25Db2RlVVJMfSBvYmplY3QsIG9yIG51bGwgaWYgdGhlIGxpbmsgaXMgaW52YWxpZC5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBzdGF0aWMgcGFyc2VMaW5rKGxpbmspIHtcbiAgICAgICAgY29uc3QgYWN0aW9uTGluayA9IHBhcnNlRGVlcExpbmsobGluayk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEFjdGlvbkNvZGVVUkwoYWN0aW9uTGluayk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKipcbiAqIFBhcnNlcyB0aGUgZW1haWwgYWN0aW9uIGxpbmsgc3RyaW5nIGFuZCByZXR1cm5zIGFuIHtAbGluayBBY3Rpb25Db2RlVVJMfSBpZlxuICogdGhlIGxpbmsgaXMgdmFsaWQsIG90aGVyd2lzZSByZXR1cm5zIG51bGwuXG4gKlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiBwYXJzZUFjdGlvbkNvZGVVUkwobGluaykge1xuICAgIHJldHVybiBBY3Rpb25Db2RlVVJMLnBhcnNlTGluayhsaW5rKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcge0BsaW5rIEVtYWlsQXV0aENyZWRlbnRpYWx9LlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuY2xhc3MgRW1haWxBdXRoUHJvdmlkZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAvKipcbiAgICAgICAgICogQWx3YXlzIHNldCB0byB7QGxpbmsgUHJvdmlkZXJJZH0uUEFTU1dPUkQsIGV2ZW4gZm9yIGVtYWlsIGxpbmsuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnByb3ZpZGVySWQgPSBFbWFpbEF1dGhQcm92aWRlci5QUk9WSURFUl9JRDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZSBhbiB7QGxpbmsgQXV0aENyZWRlbnRpYWx9IHVzaW5nIGFuIGVtYWlsIGFuZCBwYXNzd29yZC5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogYGBgamF2YXNjcmlwdFxuICAgICAqIGNvbnN0IGF1dGhDcmVkZW50aWFsID0gRW1haWxBdXRoUHJvdmlkZXIuY3JlZGVudGlhbChlbWFpbCwgcGFzc3dvcmQpO1xuICAgICAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgc2lnbkluV2l0aENyZWRlbnRpYWwoYXV0aCwgYXV0aENyZWRlbnRpYWwpO1xuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBgYGBqYXZhc2NyaXB0XG4gICAgICogY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBzaWduSW5XaXRoRW1haWxBbmRQYXNzd29yZChhdXRoLCBlbWFpbCwgcGFzc3dvcmQpO1xuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogQHBhcmFtIGVtYWlsIC0gRW1haWwgYWRkcmVzcy5cbiAgICAgKiBAcGFyYW0gcGFzc3dvcmQgLSBVc2VyIGFjY291bnQgcGFzc3dvcmQuXG4gICAgICogQHJldHVybnMgVGhlIGF1dGggcHJvdmlkZXIgY3JlZGVudGlhbC5cbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlZGVudGlhbChlbWFpbCwgcGFzc3dvcmQpIHtcbiAgICAgICAgcmV0dXJuIEVtYWlsQXV0aENyZWRlbnRpYWwuX2Zyb21FbWFpbEFuZFBhc3N3b3JkKGVtYWlsLCBwYXNzd29yZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemUgYW4ge0BsaW5rIEF1dGhDcmVkZW50aWFsfSB1c2luZyBhbiBlbWFpbCBhbmQgYW4gZW1haWwgbGluayBhZnRlciBhIHNpZ24gaW4gd2l0aFxuICAgICAqIGVtYWlsIGxpbmsgb3BlcmF0aW9uLlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBgYGBqYXZhc2NyaXB0XG4gICAgICogY29uc3QgYXV0aENyZWRlbnRpYWwgPSBFbWFpbEF1dGhQcm92aWRlci5jcmVkZW50aWFsV2l0aExpbmsoYXV0aCwgZW1haWwsIGVtYWlsTGluayk7XG4gICAgICogY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBzaWduSW5XaXRoQ3JlZGVudGlhbChhdXRoLCBhdXRoQ3JlZGVudGlhbCk7XG4gICAgICogYGBgXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGBgYGphdmFzY3JpcHRcbiAgICAgKiBhd2FpdCBzZW5kU2lnbkluTGlua1RvRW1haWwoYXV0aCwgZW1haWwpO1xuICAgICAqIC8vIE9idGFpbiBlbWFpbExpbmsgZnJvbSB1c2VyLlxuICAgICAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgc2lnbkluV2l0aEVtYWlsTGluayhhdXRoLCBlbWFpbCwgZW1haWxMaW5rKTtcbiAgICAgKiBgYGBcbiAgICAgKlxuICAgICAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZSB1c2VkIHRvIHZlcmlmeSB0aGUgbGluay5cbiAgICAgKiBAcGFyYW0gZW1haWwgLSBFbWFpbCBhZGRyZXNzLlxuICAgICAqIEBwYXJhbSBlbWFpbExpbmsgLSBTaWduLWluIGVtYWlsIGxpbmsuXG4gICAgICogQHJldHVybnMgLSBUaGUgYXV0aCBwcm92aWRlciBjcmVkZW50aWFsLlxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVkZW50aWFsV2l0aExpbmsoZW1haWwsIGVtYWlsTGluaykge1xuICAgICAgICBjb25zdCBhY3Rpb25Db2RlVXJsID0gQWN0aW9uQ29kZVVSTC5wYXJzZUxpbmsoZW1haWxMaW5rKTtcbiAgICAgICAgX2Fzc2VydChhY3Rpb25Db2RlVXJsLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUiAqLyk7XG4gICAgICAgIHJldHVybiBFbWFpbEF1dGhDcmVkZW50aWFsLl9mcm9tRW1haWxBbmRDb2RlKGVtYWlsLCBhY3Rpb25Db2RlVXJsLmNvZGUsIGFjdGlvbkNvZGVVcmwudGVuYW50SWQpO1xuICAgIH1cbn1cbi8qKlxuICogQWx3YXlzIHNldCB0byB7QGxpbmsgUHJvdmlkZXJJZH0uUEFTU1dPUkQsIGV2ZW4gZm9yIGVtYWlsIGxpbmsuXG4gKi9cbkVtYWlsQXV0aFByb3ZpZGVyLlBST1ZJREVSX0lEID0gXCJwYXNzd29yZFwiIC8qIFByb3ZpZGVySWQuUEFTU1dPUkQgKi87XG4vKipcbiAqIEFsd2F5cyBzZXQgdG8ge0BsaW5rIFNpZ25Jbk1ldGhvZH0uRU1BSUxfUEFTU1dPUkQuXG4gKi9cbkVtYWlsQXV0aFByb3ZpZGVyLkVNQUlMX1BBU1NXT1JEX1NJR05fSU5fTUVUSE9EID0gXCJwYXNzd29yZFwiIC8qIFNpZ25Jbk1ldGhvZC5FTUFJTF9QQVNTV09SRCAqLztcbi8qKlxuICogQWx3YXlzIHNldCB0byB7QGxpbmsgU2lnbkluTWV0aG9kfS5FTUFJTF9MSU5LLlxuICovXG5FbWFpbEF1dGhQcm92aWRlci5FTUFJTF9MSU5LX1NJR05fSU5fTUVUSE9EID0gXCJlbWFpbExpbmtcIiAvKiBTaWduSW5NZXRob2QuRU1BSUxfTElOSyAqLztcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVGhlIGJhc2UgY2xhc3MgZm9yIGFsbCBGZWRlcmF0ZWQgcHJvdmlkZXJzIChPQXV0aCAoaW5jbHVkaW5nIE9JREMpLCBTQU1MKS5cbiAqXG4gKiBUaGlzIGNsYXNzIGlzIG5vdCBtZWFudCB0byBiZSBpbnN0YW50aWF0ZWQgZGlyZWN0bHkuXG4gKlxuICogQHB1YmxpY1xuICovXG5jbGFzcyBGZWRlcmF0ZWRBdXRoUHJvdmlkZXIge1xuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdG9yIGZvciBnZW5lcmljIE9BdXRoIHByb3ZpZGVycy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwcm92aWRlcklkIC0gUHJvdmlkZXIgZm9yIHdoaWNoIGNyZWRlbnRpYWxzIHNob3VsZCBiZSBnZW5lcmF0ZWQuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocHJvdmlkZXJJZCkge1xuICAgICAgICB0aGlzLnByb3ZpZGVySWQgPSBwcm92aWRlcklkO1xuICAgICAgICAvKiogQGludGVybmFsICovXG4gICAgICAgIHRoaXMuZGVmYXVsdExhbmd1YWdlQ29kZSA9IG51bGw7XG4gICAgICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICAgICAgdGhpcy5jdXN0b21QYXJhbWV0ZXJzID0ge307XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgbGFuZ3VhZ2UgZ29kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBsYW5ndWFnZUNvZGUgLSBsYW5ndWFnZSBjb2RlXG4gICAgICovXG4gICAgc2V0RGVmYXVsdExhbmd1YWdlKGxhbmd1YWdlQ29kZSkge1xuICAgICAgICB0aGlzLmRlZmF1bHRMYW5ndWFnZUNvZGUgPSBsYW5ndWFnZUNvZGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIE9BdXRoIGN1c3RvbSBwYXJhbWV0ZXJzIHRvIHBhc3MgaW4gYW4gT0F1dGggcmVxdWVzdCBmb3IgcG9wdXAgYW5kIHJlZGlyZWN0IHNpZ24taW5cbiAgICAgKiBvcGVyYXRpb25zLlxuICAgICAqXG4gICAgICogQHJlbWFya3NcbiAgICAgKiBGb3IgYSBkZXRhaWxlZCBsaXN0LCBjaGVjayB0aGUgcmVzZXJ2ZWQgcmVxdWlyZWQgT0F1dGggMi4wIHBhcmFtZXRlcnMgc3VjaCBhcyBgY2xpZW50X2lkYCxcbiAgICAgKiBgcmVkaXJlY3RfdXJpYCwgYHNjb3BlYCwgYHJlc3BvbnNlX3R5cGVgLCBhbmQgYHN0YXRlYCBhcmUgbm90IGFsbG93ZWQgYW5kIHdpbGwgYmUgaWdub3JlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjdXN0b21PQXV0aFBhcmFtZXRlcnMgLSBUaGUgY3VzdG9tIE9BdXRoIHBhcmFtZXRlcnMgdG8gcGFzcyBpbiB0aGUgT0F1dGggcmVxdWVzdC5cbiAgICAgKi9cbiAgICBzZXRDdXN0b21QYXJhbWV0ZXJzKGN1c3RvbU9BdXRoUGFyYW1ldGVycykge1xuICAgICAgICB0aGlzLmN1c3RvbVBhcmFtZXRlcnMgPSBjdXN0b21PQXV0aFBhcmFtZXRlcnM7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZSB0aGUgY3VycmVudCBsaXN0IG9mIHtAbGluayBDdXN0b21QYXJhbWV0ZXJzfS5cbiAgICAgKi9cbiAgICBnZXRDdXN0b21QYXJhbWV0ZXJzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jdXN0b21QYXJhbWV0ZXJzO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQ29tbW9uIGNvZGUgdG8gYWxsIE9BdXRoIHByb3ZpZGVycy4gVGhpcyBpcyBzZXBhcmF0ZSBmcm9tIHRoZVxuICoge0BsaW5rIE9BdXRoUHJvdmlkZXJ9IHNvIHRoYXQgY2hpbGQgcHJvdmlkZXJzIChsaWtlXG4gKiB7QGxpbmsgR29vZ2xlQXV0aFByb3ZpZGVyfSkgZG9uJ3QgaW5oZXJpdCB0aGUgYGNyZWRlbnRpYWxgIGluc3RhbmNlIG1ldGhvZC5cbiAqIEluc3RlYWQsIHRoZXkgcmVseSBvbiBhIHN0YXRpYyBgY3JlZGVudGlhbGAgbWV0aG9kLlxuICovXG5jbGFzcyBCYXNlT0F1dGhQcm92aWRlciBleHRlbmRzIEZlZGVyYXRlZEF1dGhQcm92aWRlciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKC4uLmFyZ3VtZW50cyk7XG4gICAgICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICAgICAgdGhpcy5zY29wZXMgPSBbXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkIGFuIE9BdXRoIHNjb3BlIHRvIHRoZSBjcmVkZW50aWFsLlxuICAgICAqXG4gICAgICogQHBhcmFtIHNjb3BlIC0gUHJvdmlkZXIgT0F1dGggc2NvcGUgdG8gYWRkLlxuICAgICAqL1xuICAgIGFkZFNjb3BlKHNjb3BlKSB7XG4gICAgICAgIC8vIElmIG5vdCBhbHJlYWR5IGFkZGVkLCBhZGQgc2NvcGUgdG8gbGlzdC5cbiAgICAgICAgaWYgKCF0aGlzLnNjb3Blcy5pbmNsdWRlcyhzY29wZSkpIHtcbiAgICAgICAgICAgIHRoaXMuc2NvcGVzLnB1c2goc2NvcGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZSB0aGUgY3VycmVudCBsaXN0IG9mIE9BdXRoIHNjb3Blcy5cbiAgICAgKi9cbiAgICBnZXRTY29wZXMoKSB7XG4gICAgICAgIHJldHVybiBbLi4udGhpcy5zY29wZXNdO1xuICAgIH1cbn1cbi8qKlxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcgZ2VuZXJpYyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfS5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gU2lnbiBpbiB1c2luZyBhIHJlZGlyZWN0LlxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgT0F1dGhQcm92aWRlcignZ29vZ2xlLmNvbScpO1xuICogLy8gU3RhcnQgYSBzaWduIGluIHByb2Nlc3MgZm9yIGFuIHVuYXV0aGVudGljYXRlZCB1c2VyLlxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3Byb2ZpbGUnKTtcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCdlbWFpbCcpO1xuICogYXdhaXQgc2lnbkluV2l0aFJlZGlyZWN0KGF1dGgsIHByb3ZpZGVyKTtcbiAqIC8vIFRoaXMgd2lsbCB0cmlnZ2VyIGEgZnVsbCBwYWdlIHJlZGlyZWN0IGF3YXkgZnJvbSB5b3VyIGFwcFxuICpcbiAqIC8vIEFmdGVyIHJldHVybmluZyBmcm9tIHRoZSByZWRpcmVjdCB3aGVuIHlvdXIgYXBwIGluaXRpYWxpemVzIHlvdSBjYW4gb2J0YWluIHRoZSByZXN1bHRcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFJlZGlyZWN0UmVzdWx0KGF1dGgpO1xuICogaWYgKHJlc3VsdCkge1xuICogICAvLyBUaGlzIGlzIHRoZSBzaWduZWQtaW4gdXNlclxuICogICBjb25zdCB1c2VyID0gcmVzdWx0LnVzZXI7XG4gKiAgIC8vIFRoaXMgZ2l2ZXMgeW91IGEgT0F1dGggQWNjZXNzIFRva2VuIGZvciB0aGUgcHJvdmlkZXIuXG4gKiAgIGNvbnN0IGNyZWRlbnRpYWwgPSBwcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChhdXRoLCByZXN1bHQpO1xuICogICBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gU2lnbiBpbiB1c2luZyBhIHBvcHVwLlxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgT0F1dGhQcm92aWRlcignZ29vZ2xlLmNvbScpO1xuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3Byb2ZpbGUnKTtcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCdlbWFpbCcpO1xuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgc2lnbkluV2l0aFBvcHVwKGF1dGgsIHByb3ZpZGVyKTtcbiAqXG4gKiAvLyBUaGUgc2lnbmVkLWluIHVzZXIgaW5mby5cbiAqIGNvbnN0IHVzZXIgPSByZXN1bHQudXNlcjtcbiAqIC8vIFRoaXMgZ2l2ZXMgeW91IGEgT0F1dGggQWNjZXNzIFRva2VuIGZvciB0aGUgcHJvdmlkZXIuXG4gKiBjb25zdCBjcmVkZW50aWFsID0gcHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQoYXV0aCwgcmVzdWx0KTtcbiAqIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcbiAqIGBgYFxuICogQHB1YmxpY1xuICovXG5jbGFzcyBPQXV0aFByb3ZpZGVyIGV4dGVuZHMgQmFzZU9BdXRoUHJvdmlkZXIge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4ge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIEpTT04gc3RyaW5nIG9yIGEgcGxhaW4gb2JqZWN0LlxuICAgICAqIEBwYXJhbSBqc29uIC0gQSBwbGFpbiBvYmplY3Qgb3IgYSBKU09OIHN0cmluZ1xuICAgICAqL1xuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbUpTT04oanNvbikge1xuICAgICAgICBjb25zdCBvYmogPSB0eXBlb2YganNvbiA9PT0gJ3N0cmluZycgPyBKU09OLnBhcnNlKGpzb24pIDoganNvbjtcbiAgICAgICAgX2Fzc2VydCgncHJvdmlkZXJJZCcgaW4gb2JqICYmICdzaWduSW5NZXRob2QnIGluIG9iaiwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IgKi8pO1xuICAgICAgICByZXR1cm4gT0F1dGhDcmVkZW50aWFsLl9mcm9tUGFyYW1zKG9iaik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEgZ2VuZXJpYyBPQXV0aCBwcm92aWRlcidzIGFjY2VzcyB0b2tlbiBvciBJRCB0b2tlbi5cbiAgICAgKlxuICAgICAqIEByZW1hcmtzXG4gICAgICogVGhlIHJhdyBub25jZSBpcyByZXF1aXJlZCB3aGVuIGFuIElEIHRva2VuIHdpdGggYSBub25jZSBmaWVsZCBpcyBwcm92aWRlZC4gVGhlIFNIQS0yNTYgaGFzaCBvZlxuICAgICAqIHRoZSByYXcgbm9uY2UgbXVzdCBtYXRjaCB0aGUgbm9uY2UgZmllbGQgaW4gdGhlIElEIHRva2VuLlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBgYGBqYXZhc2NyaXB0XG4gICAgICogLy8gYGdvb2dsZVVzZXJgIGZyb20gdGhlIG9uc3VjY2VzcyBHb29nbGUgU2lnbiBJbiBjYWxsYmFjay5cbiAgICAgKiAvLyBJbml0aWFsaXplIGEgZ2VuZXJhdGUgT0F1dGggcHJvdmlkZXIgd2l0aCBhIGBnb29nbGUuY29tYCBwcm92aWRlcklkLlxuICAgICAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IE9BdXRoUHJvdmlkZXIoJ2dvb2dsZS5jb20nKTtcbiAgICAgKiBjb25zdCBjcmVkZW50aWFsID0gcHJvdmlkZXIuY3JlZGVudGlhbCh7XG4gICAgICogICBpZFRva2VuOiBnb29nbGVVc2VyLmdldEF1dGhSZXNwb25zZSgpLmlkX3Rva2VuLFxuICAgICAqIH0pO1xuICAgICAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhDcmVkZW50aWFsKGNyZWRlbnRpYWwpO1xuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtcyAtIEVpdGhlciB0aGUgb3B0aW9ucyBvYmplY3QgY29udGFpbmluZyB0aGUgSUQgdG9rZW4sIGFjY2VzcyB0b2tlbiBhbmQgcmF3IG5vbmNlXG4gICAgICogb3IgdGhlIElEIHRva2VuIHN0cmluZy5cbiAgICAgKi9cbiAgICBjcmVkZW50aWFsKHBhcmFtcykge1xuICAgICAgICByZXR1cm4gdGhpcy5fY3JlZGVudGlhbCh7IC4uLnBhcmFtcywgbm9uY2U6IHBhcmFtcy5yYXdOb25jZSB9KTtcbiAgICB9XG4gICAgLyoqIEFuIGludGVybmFsIGNyZWRlbnRpYWwgbWV0aG9kIHRoYXQgYWNjZXB0cyBtb3JlIHBlcm1pc3NpdmUgb3B0aW9ucyAqL1xuICAgIF9jcmVkZW50aWFsKHBhcmFtcykge1xuICAgICAgICBfYXNzZXJ0KHBhcmFtcy5pZFRva2VuIHx8IHBhcmFtcy5hY2Nlc3NUb2tlbiwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IgKi8pO1xuICAgICAgICAvLyBGb3IgT0F1dGhDcmVkZW50aWFsLCBzaWduIGluIG1ldGhvZCBpcyBzYW1lIGFzIHByb3ZpZGVySWQuXG4gICAgICAgIHJldHVybiBPQXV0aENyZWRlbnRpYWwuX2Zyb21QYXJhbXMoe1xuICAgICAgICAgICAgLi4ucGFyYW1zLFxuICAgICAgICAgICAgcHJvdmlkZXJJZDogdGhpcy5wcm92aWRlcklkLFxuICAgICAgICAgICAgc2lnbkluTWV0aG9kOiB0aGlzLnByb3ZpZGVySWRcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIFVzZXJDcmVkZW50aWFsfS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXG4gICAgICovXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKSB7XG4gICAgICAgIHJldHVybiBPQXV0aFByb3ZpZGVyLm9hdXRoQ3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QodXNlckNyZWRlbnRpYWwpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBBdXRoRXJyb3J9IHdoaWNoIHdhc1xuICAgICAqIHRocm93biBkdXJpbmcgYSBzaWduLWluLCBsaW5rLCBvciByZWF1dGhlbnRpY2F0ZSBvcGVyYXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbUVycm9yKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBPQXV0aFByb3ZpZGVyLm9hdXRoQ3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoKGVycm9yLmN1c3RvbURhdGEgfHwge30pKTtcbiAgICB9XG4gICAgc3RhdGljIG9hdXRoQ3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoeyBfdG9rZW5SZXNwb25zZTogdG9rZW5SZXNwb25zZSB9KSB7XG4gICAgICAgIGlmICghdG9rZW5SZXNwb25zZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeyBvYXV0aElkVG9rZW4sIG9hdXRoQWNjZXNzVG9rZW4sIG9hdXRoVG9rZW5TZWNyZXQsIHBlbmRpbmdUb2tlbiwgbm9uY2UsIHByb3ZpZGVySWQgfSA9IHRva2VuUmVzcG9uc2U7XG4gICAgICAgIGlmICghb2F1dGhBY2Nlc3NUb2tlbiAmJlxuICAgICAgICAgICAgIW9hdXRoVG9rZW5TZWNyZXQgJiZcbiAgICAgICAgICAgICFvYXV0aElkVG9rZW4gJiZcbiAgICAgICAgICAgICFwZW5kaW5nVG9rZW4pIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcHJvdmlkZXJJZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgT0F1dGhQcm92aWRlcihwcm92aWRlcklkKS5fY3JlZGVudGlhbCh7XG4gICAgICAgICAgICAgICAgaWRUb2tlbjogb2F1dGhJZFRva2VuLFxuICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBvYXV0aEFjY2Vzc1Rva2VuLFxuICAgICAgICAgICAgICAgIG5vbmNlLFxuICAgICAgICAgICAgICAgIHBlbmRpbmdUb2tlblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBQcm92aWRlciBmb3IgZ2VuZXJhdGluZyBhbiB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmb3Ige0BsaW5rIFByb3ZpZGVySWR9LkZBQ0VCT09LLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcmVkaXJlY3QuXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBGYWNlYm9va0F1dGhQcm92aWRlcigpO1xuICogLy8gU3RhcnQgYSBzaWduIGluIHByb2Nlc3MgZm9yIGFuIHVuYXV0aGVudGljYXRlZCB1c2VyLlxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3VzZXJfYmlydGhkYXknKTtcbiAqIGF3YWl0IHNpZ25JbldpdGhSZWRpcmVjdChhdXRoLCBwcm92aWRlcik7XG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcbiAqXG4gKiAvLyBBZnRlciByZXR1cm5pbmcgZnJvbSB0aGUgcmVkaXJlY3Qgd2hlbiB5b3VyIGFwcCBpbml0aWFsaXplcyB5b3UgY2FuIG9idGFpbiB0aGUgcmVzdWx0XG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcbiAqIGlmIChyZXN1bHQpIHtcbiAqICAgLy8gVGhpcyBpcyB0aGUgc2lnbmVkLWluIHVzZXJcbiAqICAgY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xuICogICAvLyBUaGlzIGdpdmVzIHlvdSBhIEZhY2Vib29rIEFjY2VzcyBUb2tlbi5cbiAqICAgY29uc3QgY3JlZGVudGlhbCA9IEZhY2Vib29rQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KHJlc3VsdCk7XG4gKiAgIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcbiAqIH1cbiAqIGBgYFxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcG9wdXAuXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBGYWNlYm9va0F1dGhQcm92aWRlcigpO1xuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3VzZXJfYmlydGhkYXknKTtcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhQb3B1cChhdXRoLCBwcm92aWRlcik7XG4gKlxuICogLy8gVGhlIHNpZ25lZC1pbiB1c2VyIGluZm8uXG4gKiBjb25zdCB1c2VyID0gcmVzdWx0LnVzZXI7XG4gKiAvLyBUaGlzIGdpdmVzIHlvdSBhIEZhY2Vib29rIEFjY2VzcyBUb2tlbi5cbiAqIGNvbnN0IGNyZWRlbnRpYWwgPSBGYWNlYm9va0F1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChyZXN1bHQpO1xuICogY29uc3QgdG9rZW4gPSBjcmVkZW50aWFsLmFjY2Vzc1Rva2VuO1xuICogYGBgXG4gKlxuICogQHB1YmxpY1xuICovXG5jbGFzcyBGYWNlYm9va0F1dGhQcm92aWRlciBleHRlbmRzIEJhc2VPQXV0aFByb3ZpZGVyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoXCJmYWNlYm9vay5jb21cIiAvKiBQcm92aWRlcklkLkZBQ0VCT09LICovKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGNyZWRlbnRpYWwgZm9yIEZhY2Vib29rLlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBgYGBqYXZhc2NyaXB0XG4gICAgICogLy8gYGV2ZW50YCBmcm9tIHRoZSBGYWNlYm9vayBhdXRoLmF1dGhSZXNwb25zZUNoYW5nZSBjYWxsYmFjay5cbiAgICAgKiBjb25zdCBjcmVkZW50aWFsID0gRmFjZWJvb2tBdXRoUHJvdmlkZXIuY3JlZGVudGlhbChldmVudC5hdXRoUmVzcG9uc2UuYWNjZXNzVG9rZW4pO1xuICAgICAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhDcmVkZW50aWFsKGNyZWRlbnRpYWwpO1xuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogQHBhcmFtIGFjY2Vzc1Rva2VuIC0gRmFjZWJvb2sgYWNjZXNzIHRva2VuLlxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVkZW50aWFsKGFjY2Vzc1Rva2VuKSB7XG4gICAgICAgIHJldHVybiBPQXV0aENyZWRlbnRpYWwuX2Zyb21QYXJhbXMoe1xuICAgICAgICAgICAgcHJvdmlkZXJJZDogRmFjZWJvb2tBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQsXG4gICAgICAgICAgICBzaWduSW5NZXRob2Q6IEZhY2Vib29rQXV0aFByb3ZpZGVyLkZBQ0VCT09LX1NJR05fSU5fTUVUSE9ELFxuICAgICAgICAgICAgYWNjZXNzVG9rZW5cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIFVzZXJDcmVkZW50aWFsfS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXG4gICAgICovXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKSB7XG4gICAgICAgIHJldHVybiBGYWNlYm9va0F1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCh1c2VyQ3JlZGVudGlhbCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIEF1dGhFcnJvcn0gd2hpY2ggd2FzXG4gICAgICogdGhyb3duIGR1cmluZyBhIHNpZ24taW4sIGxpbmssIG9yIHJlYXV0aGVudGljYXRlIG9wZXJhdGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXG4gICAgICovXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tRXJyb3IoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIEZhY2Vib29rQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KChlcnJvci5jdXN0b21EYXRhIHx8IHt9KSk7XG4gICAgfVxuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCh7IF90b2tlblJlc3BvbnNlOiB0b2tlblJlc3BvbnNlIH0pIHtcbiAgICAgICAgaWYgKCF0b2tlblJlc3BvbnNlIHx8ICEoJ29hdXRoQWNjZXNzVG9rZW4nIGluIHRva2VuUmVzcG9uc2UpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRva2VuUmVzcG9uc2Uub2F1dGhBY2Nlc3NUb2tlbikge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBGYWNlYm9va0F1dGhQcm92aWRlci5jcmVkZW50aWFsKHRva2VuUmVzcG9uc2Uub2F1dGhBY2Nlc3NUb2tlbik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKiogQWx3YXlzIHNldCB0byB7QGxpbmsgU2lnbkluTWV0aG9kfS5GQUNFQk9PSy4gKi9cbkZhY2Vib29rQXV0aFByb3ZpZGVyLkZBQ0VCT09LX1NJR05fSU5fTUVUSE9EID0gXCJmYWNlYm9vay5jb21cIiAvKiBTaWduSW5NZXRob2QuRkFDRUJPT0sgKi87XG4vKiogQWx3YXlzIHNldCB0byB7QGxpbmsgUHJvdmlkZXJJZH0uRkFDRUJPT0suICovXG5GYWNlYm9va0F1dGhQcm92aWRlci5QUk9WSURFUl9JRCA9IFwiZmFjZWJvb2suY29tXCIgLyogUHJvdmlkZXJJZC5GQUNFQk9PSyAqLztcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcgYW4ge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZm9yIHtAbGluayBQcm92aWRlcklkfS5HT09HTEUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSByZWRpcmVjdC5cbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IEdvb2dsZUF1dGhQcm92aWRlcigpO1xuICogLy8gU3RhcnQgYSBzaWduIGluIHByb2Nlc3MgZm9yIGFuIHVuYXV0aGVudGljYXRlZCB1c2VyLlxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3Byb2ZpbGUnKTtcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCdlbWFpbCcpO1xuICogYXdhaXQgc2lnbkluV2l0aFJlZGlyZWN0KGF1dGgsIHByb3ZpZGVyKTtcbiAqIC8vIFRoaXMgd2lsbCB0cmlnZ2VyIGEgZnVsbCBwYWdlIHJlZGlyZWN0IGF3YXkgZnJvbSB5b3VyIGFwcFxuICpcbiAqIC8vIEFmdGVyIHJldHVybmluZyBmcm9tIHRoZSByZWRpcmVjdCB3aGVuIHlvdXIgYXBwIGluaXRpYWxpemVzIHlvdSBjYW4gb2J0YWluIHRoZSByZXN1bHRcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFJlZGlyZWN0UmVzdWx0KGF1dGgpO1xuICogaWYgKHJlc3VsdCkge1xuICogICAvLyBUaGlzIGlzIHRoZSBzaWduZWQtaW4gdXNlclxuICogICBjb25zdCB1c2VyID0gcmVzdWx0LnVzZXI7XG4gKiAgIC8vIFRoaXMgZ2l2ZXMgeW91IGEgR29vZ2xlIEFjY2VzcyBUb2tlbi5cbiAqICAgY29uc3QgY3JlZGVudGlhbCA9IEdvb2dsZUF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChyZXN1bHQpO1xuICogICBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gU2lnbiBpbiB1c2luZyBhIHBvcHVwLlxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgR29vZ2xlQXV0aFByb3ZpZGVyKCk7XG4gKiBwcm92aWRlci5hZGRTY29wZSgncHJvZmlsZScpO1xuICogcHJvdmlkZXIuYWRkU2NvcGUoJ2VtYWlsJyk7XG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoUG9wdXAoYXV0aCwgcHJvdmlkZXIpO1xuICpcbiAqIC8vIFRoZSBzaWduZWQtaW4gdXNlciBpbmZvLlxuICogY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xuICogLy8gVGhpcyBnaXZlcyB5b3UgYSBHb29nbGUgQWNjZXNzIFRva2VuLlxuICogY29uc3QgY3JlZGVudGlhbCA9IEdvb2dsZUF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChyZXN1bHQpO1xuICogY29uc3QgdG9rZW4gPSBjcmVkZW50aWFsLmFjY2Vzc1Rva2VuO1xuICogYGBgXG4gKlxuICogQHB1YmxpY1xuICovXG5jbGFzcyBHb29nbGVBdXRoUHJvdmlkZXIgZXh0ZW5kcyBCYXNlT0F1dGhQcm92aWRlciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKFwiZ29vZ2xlLmNvbVwiIC8qIFByb3ZpZGVySWQuR09PR0xFICovKTtcbiAgICAgICAgdGhpcy5hZGRTY29wZSgncHJvZmlsZScpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgY3JlZGVudGlhbCBmb3IgR29vZ2xlLiBBdCBsZWFzdCBvbmUgb2YgSUQgdG9rZW4gYW5kIGFjY2VzcyB0b2tlbiBpcyByZXF1aXJlZC5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogYGBgamF2YXNjcmlwdFxuICAgICAqIC8vIFxcYGdvb2dsZVVzZXJcXGAgZnJvbSB0aGUgb25zdWNjZXNzIEdvb2dsZSBTaWduIEluIGNhbGxiYWNrLlxuICAgICAqIGNvbnN0IGNyZWRlbnRpYWwgPSBHb29nbGVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbChnb29nbGVVc2VyLmdldEF1dGhSZXNwb25zZSgpLmlkX3Rva2VuKTtcbiAgICAgKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoQ3JlZGVudGlhbChjcmVkZW50aWFsKTtcbiAgICAgKiBgYGBcbiAgICAgKlxuICAgICAqIEBwYXJhbSBpZFRva2VuIC0gR29vZ2xlIElEIHRva2VuLlxuICAgICAqIEBwYXJhbSBhY2Nlc3NUb2tlbiAtIEdvb2dsZSBhY2Nlc3MgdG9rZW4uXG4gICAgICovXG4gICAgc3RhdGljIGNyZWRlbnRpYWwoaWRUb2tlbiwgYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIE9BdXRoQ3JlZGVudGlhbC5fZnJvbVBhcmFtcyh7XG4gICAgICAgICAgICBwcm92aWRlcklkOiBHb29nbGVBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQsXG4gICAgICAgICAgICBzaWduSW5NZXRob2Q6IEdvb2dsZUF1dGhQcm92aWRlci5HT09HTEVfU0lHTl9JTl9NRVRIT0QsXG4gICAgICAgICAgICBpZFRva2VuLFxuICAgICAgICAgICAgYWNjZXNzVG9rZW5cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIFVzZXJDcmVkZW50aWFsfS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXG4gICAgICovXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKSB7XG4gICAgICAgIHJldHVybiBHb29nbGVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QodXNlckNyZWRlbnRpYWwpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBBdXRoRXJyb3J9IHdoaWNoIHdhc1xuICAgICAqIHRocm93biBkdXJpbmcgYSBzaWduLWluLCBsaW5rLCBvciByZWF1dGhlbnRpY2F0ZSBvcGVyYXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbUVycm9yKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBHb29nbGVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoKGVycm9yLmN1c3RvbURhdGEgfHwge30pKTtcbiAgICB9XG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHsgX3Rva2VuUmVzcG9uc2U6IHRva2VuUmVzcG9uc2UgfSkge1xuICAgICAgICBpZiAoIXRva2VuUmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHsgb2F1dGhJZFRva2VuLCBvYXV0aEFjY2Vzc1Rva2VuIH0gPSB0b2tlblJlc3BvbnNlO1xuICAgICAgICBpZiAoIW9hdXRoSWRUb2tlbiAmJiAhb2F1dGhBY2Nlc3NUb2tlbikge1xuICAgICAgICAgICAgLy8gVGhpcyBjb3VsZCBiZSBhbiBvYXV0aCAxIGNyZWRlbnRpYWwgb3IgYSBwaG9uZSBjcmVkZW50aWFsXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIEdvb2dsZUF1dGhQcm92aWRlci5jcmVkZW50aWFsKG9hdXRoSWRUb2tlbiwgb2F1dGhBY2Nlc3NUb2tlbik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKiogQWx3YXlzIHNldCB0byB7QGxpbmsgU2lnbkluTWV0aG9kfS5HT09HTEUuICovXG5Hb29nbGVBdXRoUHJvdmlkZXIuR09PR0xFX1NJR05fSU5fTUVUSE9EID0gXCJnb29nbGUuY29tXCIgLyogU2lnbkluTWV0aG9kLkdPT0dMRSAqLztcbi8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBQcm92aWRlcklkfS5HT09HTEUuICovXG5Hb29nbGVBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQgPSBcImdvb2dsZS5jb21cIiAvKiBQcm92aWRlcklkLkdPT0dMRSAqLztcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcgYW4ge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZm9yIHtAbGluayBQcm92aWRlcklkfS5HSVRIVUIuXG4gKlxuICogQHJlbWFya3NcbiAqIEdpdEh1YiByZXF1aXJlcyBhbiBPQXV0aCAyLjAgcmVkaXJlY3QsIHNvIHlvdSBjYW4gZWl0aGVyIGhhbmRsZSB0aGUgcmVkaXJlY3QgZGlyZWN0bHksIG9yIHVzZVxuICogdGhlIHtAbGluayBzaWduSW5XaXRoUG9wdXB9IGhhbmRsZXI6XG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSByZWRpcmVjdC5cbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IEdpdGh1YkF1dGhQcm92aWRlcigpO1xuICogLy8gU3RhcnQgYSBzaWduIGluIHByb2Nlc3MgZm9yIGFuIHVuYXV0aGVudGljYXRlZCB1c2VyLlxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3JlcG8nKTtcbiAqIGF3YWl0IHNpZ25JbldpdGhSZWRpcmVjdChhdXRoLCBwcm92aWRlcik7XG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcbiAqXG4gKiAvLyBBZnRlciByZXR1cm5pbmcgZnJvbSB0aGUgcmVkaXJlY3Qgd2hlbiB5b3VyIGFwcCBpbml0aWFsaXplcyB5b3UgY2FuIG9idGFpbiB0aGUgcmVzdWx0XG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcbiAqIGlmIChyZXN1bHQpIHtcbiAqICAgLy8gVGhpcyBpcyB0aGUgc2lnbmVkLWluIHVzZXJcbiAqICAgY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xuICogICAvLyBUaGlzIGdpdmVzIHlvdSBhIEdpdEh1YiBBY2Nlc3MgVG9rZW4uXG4gKiAgIGNvbnN0IGNyZWRlbnRpYWwgPSBHaXRodWJBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQocmVzdWx0KTtcbiAqICAgY29uc3QgdG9rZW4gPSBjcmVkZW50aWFsLmFjY2Vzc1Rva2VuO1xuICogfVxuICogYGBgXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSBwb3B1cC5cbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IEdpdGh1YkF1dGhQcm92aWRlcigpO1xuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3JlcG8nKTtcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhQb3B1cChhdXRoLCBwcm92aWRlcik7XG4gKlxuICogLy8gVGhlIHNpZ25lZC1pbiB1c2VyIGluZm8uXG4gKiBjb25zdCB1c2VyID0gcmVzdWx0LnVzZXI7XG4gKiAvLyBUaGlzIGdpdmVzIHlvdSBhIEdpdEh1YiBBY2Nlc3MgVG9rZW4uXG4gKiBjb25zdCBjcmVkZW50aWFsID0gR2l0aHViQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KHJlc3VsdCk7XG4gKiBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XG4gKiBgYGBcbiAqIEBwdWJsaWNcbiAqL1xuY2xhc3MgR2l0aHViQXV0aFByb3ZpZGVyIGV4dGVuZHMgQmFzZU9BdXRoUHJvdmlkZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcihcImdpdGh1Yi5jb21cIiAvKiBQcm92aWRlcklkLkdJVEhVQiAqLyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBjcmVkZW50aWFsIGZvciBHaXRIdWIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYWNjZXNzVG9rZW4gLSBHaXRIdWIgYWNjZXNzIHRva2VuLlxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVkZW50aWFsKGFjY2Vzc1Rva2VuKSB7XG4gICAgICAgIHJldHVybiBPQXV0aENyZWRlbnRpYWwuX2Zyb21QYXJhbXMoe1xuICAgICAgICAgICAgcHJvdmlkZXJJZDogR2l0aHViQXV0aFByb3ZpZGVyLlBST1ZJREVSX0lELFxuICAgICAgICAgICAgc2lnbkluTWV0aG9kOiBHaXRodWJBdXRoUHJvdmlkZXIuR0lUSFVCX1NJR05fSU5fTUVUSE9ELFxuICAgICAgICAgICAgYWNjZXNzVG9rZW5cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIFVzZXJDcmVkZW50aWFsfS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXG4gICAgICovXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKSB7XG4gICAgICAgIHJldHVybiBHaXRodWJBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QodXNlckNyZWRlbnRpYWwpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBBdXRoRXJyb3J9IHdoaWNoIHdhc1xuICAgICAqIHRocm93biBkdXJpbmcgYSBzaWduLWluLCBsaW5rLCBvciByZWF1dGhlbnRpY2F0ZSBvcGVyYXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbUVycm9yKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBHaXRodWJBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoKGVycm9yLmN1c3RvbURhdGEgfHwge30pKTtcbiAgICB9XG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHsgX3Rva2VuUmVzcG9uc2U6IHRva2VuUmVzcG9uc2UgfSkge1xuICAgICAgICBpZiAoIXRva2VuUmVzcG9uc2UgfHwgISgnb2F1dGhBY2Nlc3NUb2tlbicgaW4gdG9rZW5SZXNwb25zZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdG9rZW5SZXNwb25zZS5vYXV0aEFjY2Vzc1Rva2VuKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIEdpdGh1YkF1dGhQcm92aWRlci5jcmVkZW50aWFsKHRva2VuUmVzcG9uc2Uub2F1dGhBY2Nlc3NUb2tlbik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKiogQWx3YXlzIHNldCB0byB7QGxpbmsgU2lnbkluTWV0aG9kfS5HSVRIVUIuICovXG5HaXRodWJBdXRoUHJvdmlkZXIuR0lUSFVCX1NJR05fSU5fTUVUSE9EID0gXCJnaXRodWIuY29tXCIgLyogU2lnbkluTWV0aG9kLkdJVEhVQiAqLztcbi8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBQcm92aWRlcklkfS5HSVRIVUIuICovXG5HaXRodWJBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQgPSBcImdpdGh1Yi5jb21cIiAvKiBQcm92aWRlcklkLkdJVEhVQiAqLztcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IElEUF9SRVFVRVNUX1VSSSA9ICdodHRwOi8vbG9jYWxob3N0Jztcbi8qKlxuICogQHB1YmxpY1xuICovXG5jbGFzcyBTQU1MQXV0aENyZWRlbnRpYWwgZXh0ZW5kcyBBdXRoQ3JlZGVudGlhbCB7XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIGNvbnN0cnVjdG9yKHByb3ZpZGVySWQsIHBlbmRpbmdUb2tlbikge1xuICAgICAgICBzdXBlcihwcm92aWRlcklkLCBwcm92aWRlcklkKTtcbiAgICAgICAgdGhpcy5wZW5kaW5nVG9rZW4gPSBwZW5kaW5nVG9rZW47XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBfZ2V0SWRUb2tlblJlc3BvbnNlKGF1dGgpIHtcbiAgICAgICAgY29uc3QgcmVxdWVzdCA9IHRoaXMuYnVpbGRSZXF1ZXN0KCk7XG4gICAgICAgIHJldHVybiBzaWduSW5XaXRoSWRwKGF1dGgsIHJlcXVlc3QpO1xuICAgIH1cbiAgICAvKiogQGludGVybmFsICovXG4gICAgX2xpbmtUb0lkVG9rZW4oYXV0aCwgaWRUb2tlbikge1xuICAgICAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5idWlsZFJlcXVlc3QoKTtcbiAgICAgICAgcmVxdWVzdC5pZFRva2VuID0gaWRUb2tlbjtcbiAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhJZHAoYXV0aCwgcmVxdWVzdCk7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBfZ2V0UmVhdXRoZW50aWNhdGlvblJlc29sdmVyKGF1dGgpIHtcbiAgICAgICAgY29uc3QgcmVxdWVzdCA9IHRoaXMuYnVpbGRSZXF1ZXN0KCk7XG4gICAgICAgIHJlcXVlc3QuYXV0b0NyZWF0ZSA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gc2lnbkluV2l0aElkcChhdXRoLCByZXF1ZXN0KTtcbiAgICB9XG4gICAgLyoqIHtAaW5oZXJpdGRvYyBBdXRoQ3JlZGVudGlhbC50b0pTT059ICAqL1xuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNpZ25Jbk1ldGhvZDogdGhpcy5zaWduSW5NZXRob2QsXG4gICAgICAgICAgICBwcm92aWRlcklkOiB0aGlzLnByb3ZpZGVySWQsXG4gICAgICAgICAgICBwZW5kaW5nVG9rZW46IHRoaXMucGVuZGluZ1Rva2VuXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXRpYyBtZXRob2QgdG8gZGVzZXJpYWxpemUgYSBKU09OIHJlcHJlc2VudGF0aW9uIG9mIGFuIG9iamVjdCBpbnRvIGFuXG4gICAgICoge0BsaW5rICBBdXRoQ3JlZGVudGlhbH0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ganNvbiAtIElucHV0IGNhbiBiZSBlaXRoZXIgT2JqZWN0IG9yIHRoZSBzdHJpbmdpZmllZCByZXByZXNlbnRhdGlvbiBvZiB0aGUgb2JqZWN0LlxuICAgICAqIFdoZW4gc3RyaW5nIGlzIHByb3ZpZGVkLCBKU09OLnBhcnNlIHdvdWxkIGJlIGNhbGxlZCBmaXJzdC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIElmIHRoZSBKU09OIGlucHV0IGRvZXMgbm90IHJlcHJlc2VudCBhbiB7QGxpbmsgIEF1dGhDcmVkZW50aWFsfSwgbnVsbCBpcyByZXR1cm5lZC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbUpTT04oanNvbikge1xuICAgICAgICBjb25zdCBvYmogPSB0eXBlb2YganNvbiA9PT0gJ3N0cmluZycgPyBKU09OLnBhcnNlKGpzb24pIDoganNvbjtcbiAgICAgICAgY29uc3QgeyBwcm92aWRlcklkLCBzaWduSW5NZXRob2QsIHBlbmRpbmdUb2tlbiB9ID0gb2JqO1xuICAgICAgICBpZiAoIXByb3ZpZGVySWQgfHxcbiAgICAgICAgICAgICFzaWduSW5NZXRob2QgfHxcbiAgICAgICAgICAgICFwZW5kaW5nVG9rZW4gfHxcbiAgICAgICAgICAgIHByb3ZpZGVySWQgIT09IHNpZ25Jbk1ldGhvZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBTQU1MQXV0aENyZWRlbnRpYWwocHJvdmlkZXJJZCwgcGVuZGluZ1Rva2VuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSGVscGVyIHN0YXRpYyBtZXRob2QgdG8gYXZvaWQgZXhwb3NpbmcgdGhlIGNvbnN0cnVjdG9yIHRvIGVuZCB1c2Vycy5cbiAgICAgKlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIHN0YXRpYyBfY3JlYXRlKHByb3ZpZGVySWQsIHBlbmRpbmdUb2tlbikge1xuICAgICAgICByZXR1cm4gbmV3IFNBTUxBdXRoQ3JlZGVudGlhbChwcm92aWRlcklkLCBwZW5kaW5nVG9rZW4pO1xuICAgIH1cbiAgICBidWlsZFJlcXVlc3QoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXF1ZXN0VXJpOiBJRFBfUkVRVUVTVF9VUkksXG4gICAgICAgICAgICByZXR1cm5TZWN1cmVUb2tlbjogdHJ1ZSxcbiAgICAgICAgICAgIHBlbmRpbmdUb2tlbjogdGhpcy5wZW5kaW5nVG9rZW5cbiAgICAgICAgfTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jb25zdCBTQU1MX1BST1ZJREVSX1BSRUZJWCA9ICdzYW1sLic7XG4vKipcbiAqIEFuIHtAbGluayBBdXRoUHJvdmlkZXJ9IGZvciBTQU1MLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuY2xhc3MgU0FNTEF1dGhQcm92aWRlciBleHRlbmRzIEZlZGVyYXRlZEF1dGhQcm92aWRlciB7XG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0b3IuIFRoZSBwcm92aWRlcklkIG11c3Qgc3RhcnQgd2l0aCBcInNhbWwuXCJcbiAgICAgKiBAcGFyYW0gcHJvdmlkZXJJZCAtIFNBTUwgcHJvdmlkZXIgSUQuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocHJvdmlkZXJJZCkge1xuICAgICAgICBfYXNzZXJ0KHByb3ZpZGVySWQuc3RhcnRzV2l0aChTQU1MX1BST1ZJREVSX1BSRUZJWCksIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SICovKTtcbiAgICAgICAgc3VwZXIocHJvdmlkZXJJZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdlbmVyYXRlcyBhbiB7QGxpbmsgQXV0aENyZWRlbnRpYWx9IGZyb20gYSB7QGxpbmsgVXNlckNyZWRlbnRpYWx9IGFmdGVyIGFcbiAgICAgKiBzdWNjZXNzZnVsIFNBTUwgZmxvdyBjb21wbGV0ZXMuXG4gICAgICpcbiAgICAgKiBAcmVtYXJrc1xuICAgICAqXG4gICAgICogRm9yIGV4YW1wbGUsIHRvIGdldCBhbiB7QGxpbmsgQXV0aENyZWRlbnRpYWx9LCB5b3UgY291bGQgd3JpdGUgdGhlXG4gICAgICogZm9sbG93aW5nIGNvZGU6XG4gICAgICpcbiAgICAgKiBgYGBqc1xuICAgICAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgc2lnbkluV2l0aFBvcHVwKGF1dGgsIHNhbWxQcm92aWRlcik7XG4gICAgICogY29uc3QgY3JlZGVudGlhbCA9IFNBTUxBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQodXNlckNyZWRlbnRpYWwpO1xuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21SZXN1bHQodXNlckNyZWRlbnRpYWwpIHtcbiAgICAgICAgcmV0dXJuIFNBTUxBdXRoUHJvdmlkZXIuc2FtbENyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHVzZXJDcmVkZW50aWFsKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXNlZCB0byBleHRyYWN0IHRoZSB1bmRlcmx5aW5nIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZyb20gYSB7QGxpbmsgQXV0aEVycm9yfSB3aGljaCB3YXNcbiAgICAgKiB0aHJvd24gZHVyaW5nIGEgc2lnbi1pbiwgbGluaywgb3IgcmVhdXRoZW50aWNhdGUgb3BlcmF0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21FcnJvcihlcnJvcikge1xuICAgICAgICByZXR1cm4gU0FNTEF1dGhQcm92aWRlci5zYW1sQ3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoKGVycm9yLmN1c3RvbURhdGEgfHwge30pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiB7QGxpbmsgQXV0aENyZWRlbnRpYWx9IGZyb20gYSBKU09OIHN0cmluZyBvciBhIHBsYWluIG9iamVjdC5cbiAgICAgKiBAcGFyYW0ganNvbiAtIEEgcGxhaW4gb2JqZWN0IG9yIGEgSlNPTiBzdHJpbmdcbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21KU09OKGpzb24pIHtcbiAgICAgICAgY29uc3QgY3JlZGVudGlhbCA9IFNBTUxBdXRoQ3JlZGVudGlhbC5mcm9tSlNPTihqc29uKTtcbiAgICAgICAgX2Fzc2VydChjcmVkZW50aWFsLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUiAqLyk7XG4gICAgICAgIHJldHVybiBjcmVkZW50aWFsO1xuICAgIH1cbiAgICBzdGF0aWMgc2FtbENyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHsgX3Rva2VuUmVzcG9uc2U6IHRva2VuUmVzcG9uc2UgfSkge1xuICAgICAgICBpZiAoIXRva2VuUmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHsgcGVuZGluZ1Rva2VuLCBwcm92aWRlcklkIH0gPSB0b2tlblJlc3BvbnNlO1xuICAgICAgICBpZiAoIXBlbmRpbmdUb2tlbiB8fCAhcHJvdmlkZXJJZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBTQU1MQXV0aENyZWRlbnRpYWwuX2NyZWF0ZShwcm92aWRlcklkLCBwZW5kaW5nVG9rZW4pO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcgYW4ge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZm9yIHtAbGluayBQcm92aWRlcklkfS5UV0lUVEVSLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcmVkaXJlY3QuXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBUd2l0dGVyQXV0aFByb3ZpZGVyKCk7XG4gKiAvLyBTdGFydCBhIHNpZ24gaW4gcHJvY2VzcyBmb3IgYW4gdW5hdXRoZW50aWNhdGVkIHVzZXIuXG4gKiBhd2FpdCBzaWduSW5XaXRoUmVkaXJlY3QoYXV0aCwgcHJvdmlkZXIpO1xuICogLy8gVGhpcyB3aWxsIHRyaWdnZXIgYSBmdWxsIHBhZ2UgcmVkaXJlY3QgYXdheSBmcm9tIHlvdXIgYXBwXG4gKlxuICogLy8gQWZ0ZXIgcmV0dXJuaW5nIGZyb20gdGhlIHJlZGlyZWN0IHdoZW4geW91ciBhcHAgaW5pdGlhbGl6ZXMgeW91IGNhbiBvYnRhaW4gdGhlIHJlc3VsdFxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0UmVkaXJlY3RSZXN1bHQoYXV0aCk7XG4gKiBpZiAocmVzdWx0KSB7XG4gKiAgIC8vIFRoaXMgaXMgdGhlIHNpZ25lZC1pbiB1c2VyXG4gKiAgIGNvbnN0IHVzZXIgPSByZXN1bHQudXNlcjtcbiAqICAgLy8gVGhpcyBnaXZlcyB5b3UgYSBUd2l0dGVyIEFjY2VzcyBUb2tlbiBhbmQgU2VjcmV0LlxuICogICBjb25zdCBjcmVkZW50aWFsID0gVHdpdHRlckF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChyZXN1bHQpO1xuICogICBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XG4gKiAgIGNvbnN0IHNlY3JldCA9IGNyZWRlbnRpYWwuc2VjcmV0O1xuICogfVxuICogYGBgXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSBwb3B1cC5cbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IFR3aXR0ZXJBdXRoUHJvdmlkZXIoKTtcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhQb3B1cChhdXRoLCBwcm92aWRlcik7XG4gKlxuICogLy8gVGhlIHNpZ25lZC1pbiB1c2VyIGluZm8uXG4gKiBjb25zdCB1c2VyID0gcmVzdWx0LnVzZXI7XG4gKiAvLyBUaGlzIGdpdmVzIHlvdSBhIFR3aXR0ZXIgQWNjZXNzIFRva2VuIGFuZCBTZWNyZXQuXG4gKiBjb25zdCBjcmVkZW50aWFsID0gVHdpdHRlckF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChyZXN1bHQpO1xuICogY29uc3QgdG9rZW4gPSBjcmVkZW50aWFsLmFjY2Vzc1Rva2VuO1xuICogY29uc3Qgc2VjcmV0ID0gY3JlZGVudGlhbC5zZWNyZXQ7XG4gKiBgYGBcbiAqXG4gKiBAcHVibGljXG4gKi9cbmNsYXNzIFR3aXR0ZXJBdXRoUHJvdmlkZXIgZXh0ZW5kcyBCYXNlT0F1dGhQcm92aWRlciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKFwidHdpdHRlci5jb21cIiAvKiBQcm92aWRlcklkLlRXSVRURVIgKi8pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgY3JlZGVudGlhbCBmb3IgVHdpdHRlci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0b2tlbiAtIFR3aXR0ZXIgYWNjZXNzIHRva2VuLlxuICAgICAqIEBwYXJhbSBzZWNyZXQgLSBUd2l0dGVyIHNlY3JldC5cbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlZGVudGlhbCh0b2tlbiwgc2VjcmV0KSB7XG4gICAgICAgIHJldHVybiBPQXV0aENyZWRlbnRpYWwuX2Zyb21QYXJhbXMoe1xuICAgICAgICAgICAgcHJvdmlkZXJJZDogVHdpdHRlckF1dGhQcm92aWRlci5QUk9WSURFUl9JRCxcbiAgICAgICAgICAgIHNpZ25Jbk1ldGhvZDogVHdpdHRlckF1dGhQcm92aWRlci5UV0lUVEVSX1NJR05fSU5fTUVUSE9ELFxuICAgICAgICAgICAgb2F1dGhUb2tlbjogdG9rZW4sXG4gICAgICAgICAgICBvYXV0aFRva2VuU2VjcmV0OiBzZWNyZXRcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIFVzZXJDcmVkZW50aWFsfS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXG4gICAgICovXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKSB7XG4gICAgICAgIHJldHVybiBUd2l0dGVyQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHVzZXJDcmVkZW50aWFsKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXNlZCB0byBleHRyYWN0IHRoZSB1bmRlcmx5aW5nIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZyb20gYSB7QGxpbmsgQXV0aEVycm9yfSB3aGljaCB3YXNcbiAgICAgKiB0aHJvd24gZHVyaW5nIGEgc2lnbi1pbiwgbGluaywgb3IgcmVhdXRoZW50aWNhdGUgb3BlcmF0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21FcnJvcihlcnJvcikge1xuICAgICAgICByZXR1cm4gVHdpdHRlckF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCgoZXJyb3IuY3VzdG9tRGF0YSB8fCB7fSkpO1xuICAgIH1cbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoeyBfdG9rZW5SZXNwb25zZTogdG9rZW5SZXNwb25zZSB9KSB7XG4gICAgICAgIGlmICghdG9rZW5SZXNwb25zZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeyBvYXV0aEFjY2Vzc1Rva2VuLCBvYXV0aFRva2VuU2VjcmV0IH0gPSB0b2tlblJlc3BvbnNlO1xuICAgICAgICBpZiAoIW9hdXRoQWNjZXNzVG9rZW4gfHwgIW9hdXRoVG9rZW5TZWNyZXQpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gVHdpdHRlckF1dGhQcm92aWRlci5jcmVkZW50aWFsKG9hdXRoQWNjZXNzVG9rZW4sIG9hdXRoVG9rZW5TZWNyZXQpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxufVxuLyoqIEFsd2F5cyBzZXQgdG8ge0BsaW5rIFNpZ25Jbk1ldGhvZH0uVFdJVFRFUi4gKi9cblR3aXR0ZXJBdXRoUHJvdmlkZXIuVFdJVFRFUl9TSUdOX0lOX01FVEhPRCA9IFwidHdpdHRlci5jb21cIiAvKiBTaWduSW5NZXRob2QuVFdJVFRFUiAqLztcbi8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBQcm92aWRlcklkfS5UV0lUVEVSLiAqL1xuVHdpdHRlckF1dGhQcm92aWRlci5QUk9WSURFUl9JRCA9IFwidHdpdHRlci5jb21cIiAvKiBQcm92aWRlcklkLlRXSVRURVIgKi87XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5hc3luYyBmdW5jdGlvbiBzaWduVXAoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybVNpZ25JblJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92MS9hY2NvdW50czpzaWduVXBcIiAvKiBFbmRwb2ludC5TSUdOX1VQICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3MgVXNlckNyZWRlbnRpYWxJbXBsIHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXMpIHtcbiAgICAgICAgdGhpcy51c2VyID0gcGFyYW1zLnVzZXI7XG4gICAgICAgIHRoaXMucHJvdmlkZXJJZCA9IHBhcmFtcy5wcm92aWRlcklkO1xuICAgICAgICB0aGlzLl90b2tlblJlc3BvbnNlID0gcGFyYW1zLl90b2tlblJlc3BvbnNlO1xuICAgICAgICB0aGlzLm9wZXJhdGlvblR5cGUgPSBwYXJhbXMub3BlcmF0aW9uVHlwZTtcbiAgICB9XG4gICAgc3RhdGljIGFzeW5jIF9mcm9tSWRUb2tlblJlc3BvbnNlKGF1dGgsIG9wZXJhdGlvblR5cGUsIGlkVG9rZW5SZXNwb25zZSwgaXNBbm9ueW1vdXMgPSBmYWxzZSkge1xuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlckltcGwuX2Zyb21JZFRva2VuUmVzcG9uc2UoYXV0aCwgaWRUb2tlblJlc3BvbnNlLCBpc0Fub255bW91cyk7XG4gICAgICAgIGNvbnN0IHByb3ZpZGVySWQgPSBwcm92aWRlcklkRm9yUmVzcG9uc2UoaWRUb2tlblJlc3BvbnNlKTtcbiAgICAgICAgY29uc3QgdXNlckNyZWQgPSBuZXcgVXNlckNyZWRlbnRpYWxJbXBsKHtcbiAgICAgICAgICAgIHVzZXIsXG4gICAgICAgICAgICBwcm92aWRlcklkLFxuICAgICAgICAgICAgX3Rva2VuUmVzcG9uc2U6IGlkVG9rZW5SZXNwb25zZSxcbiAgICAgICAgICAgIG9wZXJhdGlvblR5cGVcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB1c2VyQ3JlZDtcbiAgICB9XG4gICAgc3RhdGljIGFzeW5jIF9mb3JPcGVyYXRpb24odXNlciwgb3BlcmF0aW9uVHlwZSwgcmVzcG9uc2UpIHtcbiAgICAgICAgYXdhaXQgdXNlci5fdXBkYXRlVG9rZW5zSWZOZWNlc3NhcnkocmVzcG9uc2UsIC8qIHJlbG9hZCAqLyB0cnVlKTtcbiAgICAgICAgY29uc3QgcHJvdmlkZXJJZCA9IHByb3ZpZGVySWRGb3JSZXNwb25zZShyZXNwb25zZSk7XG4gICAgICAgIHJldHVybiBuZXcgVXNlckNyZWRlbnRpYWxJbXBsKHtcbiAgICAgICAgICAgIHVzZXIsXG4gICAgICAgICAgICBwcm92aWRlcklkLFxuICAgICAgICAgICAgX3Rva2VuUmVzcG9uc2U6IHJlc3BvbnNlLFxuICAgICAgICAgICAgb3BlcmF0aW9uVHlwZVxuICAgICAgICB9KTtcbiAgICB9XG59XG5mdW5jdGlvbiBwcm92aWRlcklkRm9yUmVzcG9uc2UocmVzcG9uc2UpIHtcbiAgICBpZiAocmVzcG9uc2UucHJvdmlkZXJJZCkge1xuICAgICAgICByZXR1cm4gcmVzcG9uc2UucHJvdmlkZXJJZDtcbiAgICB9XG4gICAgaWYgKCdwaG9uZU51bWJlcicgaW4gcmVzcG9uc2UpIHtcbiAgICAgICAgcmV0dXJuIFwicGhvbmVcIiAvKiBQcm92aWRlcklkLlBIT05FICovO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQXN5bmNocm9ub3VzbHkgc2lnbnMgaW4gYXMgYW4gYW5vbnltb3VzIHVzZXIuXG4gKlxuICogQHJlbWFya3NcbiAqIElmIHRoZXJlIGlzIGFscmVhZHkgYW4gYW5vbnltb3VzIHVzZXIgc2lnbmVkIGluLCB0aGF0IHVzZXIgd2lsbCBiZSByZXR1cm5lZDsgb3RoZXJ3aXNlLCBhXG4gKiBuZXcgYW5vbnltb3VzIHVzZXIgaWRlbnRpdHkgd2lsbCBiZSBjcmVhdGVkIGFuZCByZXR1cm5lZC5cbiAqXG4gKiBUaGlzIG1ldGhvZCBpcyBub3Qgc3VwcG9ydGVkIGJ5IHtAbGluayBBdXRofSBpbnN0YW5jZXMgY3JlYXRlZCB3aXRoIGFcbiAqIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlU2VydmVyQXBwfS5cbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiBzaWduSW5Bbm9ueW1vdXNseShhdXRoKSB7XG4gICAgaWYgKF9pc0ZpcmViYXNlU2VydmVyQXBwKGF1dGguYXBwKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoX3NlcnZlckFwcEN1cnJlbnRVc2VyT3BlcmF0aW9uTm90U3VwcG9ydGVkRXJyb3IoYXV0aCkpO1xuICAgIH1cbiAgICBjb25zdCBhdXRoSW50ZXJuYWwgPSBfY2FzdEF1dGgoYXV0aCk7XG4gICAgYXdhaXQgYXV0aEludGVybmFsLl9pbml0aWFsaXphdGlvblByb21pc2U7XG4gICAgaWYgKGF1dGhJbnRlcm5hbC5jdXJyZW50VXNlcj8uaXNBbm9ueW1vdXMpIHtcbiAgICAgICAgLy8gSWYgYW4gYW5vbnltb3VzIHVzZXIgaXMgYWxyZWFkeSBzaWduZWQgaW4sIG5vIG5lZWQgdG8gc2lnbiB0aGVtIGluIGFnYWluLlxuICAgICAgICByZXR1cm4gbmV3IFVzZXJDcmVkZW50aWFsSW1wbCh7XG4gICAgICAgICAgICB1c2VyOiBhdXRoSW50ZXJuYWwuY3VycmVudFVzZXIsXG4gICAgICAgICAgICBwcm92aWRlcklkOiBudWxsLFxuICAgICAgICAgICAgb3BlcmF0aW9uVHlwZTogXCJzaWduSW5cIiAvKiBPcGVyYXRpb25UeXBlLlNJR05fSU4gKi9cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgc2lnblVwKGF1dGhJbnRlcm5hbCwge1xuICAgICAgICByZXR1cm5TZWN1cmVUb2tlbjogdHJ1ZVxuICAgIH0pO1xuICAgIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgVXNlckNyZWRlbnRpYWxJbXBsLl9mcm9tSWRUb2tlblJlc3BvbnNlKGF1dGhJbnRlcm5hbCwgXCJzaWduSW5cIiAvKiBPcGVyYXRpb25UeXBlLlNJR05fSU4gKi8sIHJlc3BvbnNlLCB0cnVlKTtcbiAgICBhd2FpdCBhdXRoSW50ZXJuYWwuX3VwZGF0ZUN1cnJlbnRVc2VyKHVzZXJDcmVkZW50aWFsLnVzZXIpO1xuICAgIHJldHVybiB1c2VyQ3JlZGVudGlhbDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNsYXNzIE11bHRpRmFjdG9yRXJyb3IgZXh0ZW5kcyBGaXJlYmFzZUVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihhdXRoLCBlcnJvciwgb3BlcmF0aW9uVHlwZSwgdXNlcikge1xuICAgICAgICBzdXBlcihlcnJvci5jb2RlLCBlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgdGhpcy5vcGVyYXRpb25UeXBlID0gb3BlcmF0aW9uVHlwZTtcbiAgICAgICAgdGhpcy51c2VyID0gdXNlcjtcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL01pY3Jvc29mdC9UeXBlU2NyaXB0LXdpa2kvYmxvYi9tYXN0ZXIvQnJlYWtpbmctQ2hhbmdlcy5tZCNleHRlbmRpbmctYnVpbHQtaW5zLWxpa2UtZXJyb3ItYXJyYXktYW5kLW1hcC1tYXktbm8tbG9uZ2VyLXdvcmtcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsIE11bHRpRmFjdG9yRXJyb3IucHJvdG90eXBlKTtcbiAgICAgICAgdGhpcy5jdXN0b21EYXRhID0ge1xuICAgICAgICAgICAgYXBwTmFtZTogYXV0aC5uYW1lLFxuICAgICAgICAgICAgdGVuYW50SWQ6IGF1dGgudGVuYW50SWQgPz8gdW5kZWZpbmVkLFxuICAgICAgICAgICAgX3NlcnZlclJlc3BvbnNlOiBlcnJvci5jdXN0b21EYXRhLl9zZXJ2ZXJSZXNwb25zZSxcbiAgICAgICAgICAgIG9wZXJhdGlvblR5cGVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgc3RhdGljIF9mcm9tRXJyb3JBbmRPcGVyYXRpb24oYXV0aCwgZXJyb3IsIG9wZXJhdGlvblR5cGUsIHVzZXIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNdWx0aUZhY3RvckVycm9yKGF1dGgsIGVycm9yLCBvcGVyYXRpb25UeXBlLCB1c2VyKTtcbiAgICB9XG59XG5mdW5jdGlvbiBfcHJvY2Vzc0NyZWRlbnRpYWxTYXZpbmdNZmFDb250ZXh0SWZOZWNlc3NhcnkoYXV0aCwgb3BlcmF0aW9uVHlwZSwgY3JlZGVudGlhbCwgdXNlcikge1xuICAgIGNvbnN0IGlkVG9rZW5Qcm92aWRlciA9IG9wZXJhdGlvblR5cGUgPT09IFwicmVhdXRoZW50aWNhdGVcIiAvKiBPcGVyYXRpb25UeXBlLlJFQVVUSEVOVElDQVRFICovXG4gICAgICAgID8gY3JlZGVudGlhbC5fZ2V0UmVhdXRoZW50aWNhdGlvblJlc29sdmVyKGF1dGgpXG4gICAgICAgIDogY3JlZGVudGlhbC5fZ2V0SWRUb2tlblJlc3BvbnNlKGF1dGgpO1xuICAgIHJldHVybiBpZFRva2VuUHJvdmlkZXIuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICBpZiAoZXJyb3IuY29kZSA9PT0gYGF1dGgvJHtcIm11bHRpLWZhY3Rvci1hdXRoLXJlcXVpcmVkXCIgLyogQXV0aEVycm9yQ29kZS5NRkFfUkVRVUlSRUQgKi99YCkge1xuICAgICAgICAgICAgdGhyb3cgTXVsdGlGYWN0b3JFcnJvci5fZnJvbUVycm9yQW5kT3BlcmF0aW9uKGF1dGgsIGVycm9yLCBvcGVyYXRpb25UeXBlLCB1c2VyKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICB9KTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVGFrZXMgYSBzZXQgb2YgVXNlckluZm8gcHJvdmlkZXIgZGF0YSBhbmQgY29udmVydHMgaXQgdG8gYSBzZXQgb2YgbmFtZXNcbiAqL1xuZnVuY3Rpb24gcHJvdmlkZXJEYXRhQXNOYW1lcyhwcm92aWRlckRhdGEpIHtcbiAgICByZXR1cm4gbmV3IFNldChwcm92aWRlckRhdGFcbiAgICAgICAgLm1hcCgoeyBwcm92aWRlcklkIH0pID0+IHByb3ZpZGVySWQpXG4gICAgICAgIC5maWx0ZXIocGlkID0+ICEhcGlkKSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFVubGlua3MgYSBwcm92aWRlciBmcm9tIGEgdXNlciBhY2NvdW50LlxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gcHJvdmlkZXJJZCAtIFRoZSBwcm92aWRlciB0byB1bmxpbmsuXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiB1bmxpbmsodXNlciwgcHJvdmlkZXJJZCkge1xuICAgIGNvbnN0IHVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKTtcbiAgICBhd2FpdCBfYXNzZXJ0TGlua2VkU3RhdHVzKHRydWUsIHVzZXJJbnRlcm5hbCwgcHJvdmlkZXJJZCk7XG4gICAgY29uc3QgeyBwcm92aWRlclVzZXJJbmZvIH0gPSBhd2FpdCBkZWxldGVMaW5rZWRBY2NvdW50cyh1c2VySW50ZXJuYWwuYXV0aCwge1xuICAgICAgICBpZFRva2VuOiBhd2FpdCB1c2VySW50ZXJuYWwuZ2V0SWRUb2tlbigpLFxuICAgICAgICBkZWxldGVQcm92aWRlcjogW3Byb3ZpZGVySWRdXG4gICAgfSk7XG4gICAgY29uc3QgcHJvdmlkZXJzTGVmdCA9IHByb3ZpZGVyRGF0YUFzTmFtZXMocHJvdmlkZXJVc2VySW5mbyB8fCBbXSk7XG4gICAgdXNlckludGVybmFsLnByb3ZpZGVyRGF0YSA9IHVzZXJJbnRlcm5hbC5wcm92aWRlckRhdGEuZmlsdGVyKHBkID0+IHByb3ZpZGVyc0xlZnQuaGFzKHBkLnByb3ZpZGVySWQpKTtcbiAgICBpZiAoIXByb3ZpZGVyc0xlZnQuaGFzKFwicGhvbmVcIiAvKiBQcm92aWRlcklkLlBIT05FICovKSkge1xuICAgICAgICB1c2VySW50ZXJuYWwucGhvbmVOdW1iZXIgPSBudWxsO1xuICAgIH1cbiAgICBhd2FpdCB1c2VySW50ZXJuYWwuYXV0aC5fcGVyc2lzdFVzZXJJZkN1cnJlbnQodXNlckludGVybmFsKTtcbiAgICByZXR1cm4gdXNlckludGVybmFsO1xufVxuYXN5bmMgZnVuY3Rpb24gX2xpbmsodXNlciwgY3JlZGVudGlhbCwgYnlwYXNzQXV0aFN0YXRlID0gZmFsc2UpIHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IF9sb2dvdXRJZkludmFsaWRhdGVkKHVzZXIsIGNyZWRlbnRpYWwuX2xpbmtUb0lkVG9rZW4odXNlci5hdXRoLCBhd2FpdCB1c2VyLmdldElkVG9rZW4oKSksIGJ5cGFzc0F1dGhTdGF0ZSk7XG4gICAgcmV0dXJuIFVzZXJDcmVkZW50aWFsSW1wbC5fZm9yT3BlcmF0aW9uKHVzZXIsIFwibGlua1wiIC8qIE9wZXJhdGlvblR5cGUuTElOSyAqLywgcmVzcG9uc2UpO1xufVxuYXN5bmMgZnVuY3Rpb24gX2Fzc2VydExpbmtlZFN0YXR1cyhleHBlY3RlZCwgdXNlciwgcHJvdmlkZXIpIHtcbiAgICBhd2FpdCBfcmVsb2FkV2l0aG91dFNhdmluZyh1c2VyKTtcbiAgICBjb25zdCBwcm92aWRlcklkcyA9IHByb3ZpZGVyRGF0YUFzTmFtZXModXNlci5wcm92aWRlckRhdGEpO1xuICAgIGNvbnN0IGNvZGUgPSBleHBlY3RlZCA9PT0gZmFsc2VcbiAgICAgICAgPyBcInByb3ZpZGVyLWFscmVhZHktbGlua2VkXCIgLyogQXV0aEVycm9yQ29kZS5QUk9WSURFUl9BTFJFQURZX0xJTktFRCAqL1xuICAgICAgICA6IFwibm8tc3VjaC1wcm92aWRlclwiIC8qIEF1dGhFcnJvckNvZGUuTk9fU1VDSF9QUk9WSURFUiAqLztcbiAgICBfYXNzZXJ0KHByb3ZpZGVySWRzLmhhcyhwcm92aWRlcikgPT09IGV4cGVjdGVkLCB1c2VyLmF1dGgsIGNvZGUpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gX3JlYXV0aGVudGljYXRlKHVzZXIsIGNyZWRlbnRpYWwsIGJ5cGFzc0F1dGhTdGF0ZSA9IGZhbHNlKSB7XG4gICAgY29uc3QgeyBhdXRoIH0gPSB1c2VyO1xuICAgIGlmIChfaXNGaXJlYmFzZVNlcnZlckFwcChhdXRoLmFwcCkpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KF9zZXJ2ZXJBcHBDdXJyZW50VXNlck9wZXJhdGlvbk5vdFN1cHBvcnRlZEVycm9yKGF1dGgpKTtcbiAgICB9XG4gICAgY29uc3Qgb3BlcmF0aW9uVHlwZSA9IFwicmVhdXRoZW50aWNhdGVcIiAvKiBPcGVyYXRpb25UeXBlLlJFQVVUSEVOVElDQVRFICovO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgX2xvZ291dElmSW52YWxpZGF0ZWQodXNlciwgX3Byb2Nlc3NDcmVkZW50aWFsU2F2aW5nTWZhQ29udGV4dElmTmVjZXNzYXJ5KGF1dGgsIG9wZXJhdGlvblR5cGUsIGNyZWRlbnRpYWwsIHVzZXIpLCBieXBhc3NBdXRoU3RhdGUpO1xuICAgICAgICBfYXNzZXJ0KHJlc3BvbnNlLmlkVG9rZW4sIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgY29uc3QgcGFyc2VkID0gX3BhcnNlVG9rZW4ocmVzcG9uc2UuaWRUb2tlbik7XG4gICAgICAgIF9hc3NlcnQocGFyc2VkLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgIGNvbnN0IHsgc3ViOiBsb2NhbElkIH0gPSBwYXJzZWQ7XG4gICAgICAgIF9hc3NlcnQodXNlci51aWQgPT09IGxvY2FsSWQsIGF1dGgsIFwidXNlci1taXNtYXRjaFwiIC8qIEF1dGhFcnJvckNvZGUuVVNFUl9NSVNNQVRDSCAqLyk7XG4gICAgICAgIHJldHVybiBVc2VyQ3JlZGVudGlhbEltcGwuX2Zvck9wZXJhdGlvbih1c2VyLCBvcGVyYXRpb25UeXBlLCByZXNwb25zZSk7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIC8vIENvbnZlcnQgdXNlciBkZWxldGVkIGVycm9yIGludG8gdXNlciBtaXNtYXRjaFxuICAgICAgICBpZiAoZT8uY29kZSA9PT0gYGF1dGgvJHtcInVzZXItbm90LWZvdW5kXCIgLyogQXV0aEVycm9yQ29kZS5VU0VSX0RFTEVURUQgKi99YCkge1xuICAgICAgICAgICAgX2ZhaWwoYXV0aCwgXCJ1c2VyLW1pc21hdGNoXCIgLyogQXV0aEVycm9yQ29kZS5VU0VSX01JU01BVENIICovKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIF9zaWduSW5XaXRoQ3JlZGVudGlhbChhdXRoLCBjcmVkZW50aWFsLCBieXBhc3NBdXRoU3RhdGUgPSBmYWxzZSkge1xuICAgIGlmIChfaXNGaXJlYmFzZVNlcnZlckFwcChhdXRoLmFwcCkpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KF9zZXJ2ZXJBcHBDdXJyZW50VXNlck9wZXJhdGlvbk5vdFN1cHBvcnRlZEVycm9yKGF1dGgpKTtcbiAgICB9XG4gICAgY29uc3Qgb3BlcmF0aW9uVHlwZSA9IFwic2lnbkluXCIgLyogT3BlcmF0aW9uVHlwZS5TSUdOX0lOICovO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgX3Byb2Nlc3NDcmVkZW50aWFsU2F2aW5nTWZhQ29udGV4dElmTmVjZXNzYXJ5KGF1dGgsIG9wZXJhdGlvblR5cGUsIGNyZWRlbnRpYWwpO1xuICAgIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgVXNlckNyZWRlbnRpYWxJbXBsLl9mcm9tSWRUb2tlblJlc3BvbnNlKGF1dGgsIG9wZXJhdGlvblR5cGUsIHJlc3BvbnNlKTtcbiAgICBpZiAoIWJ5cGFzc0F1dGhTdGF0ZSkge1xuICAgICAgICBhd2FpdCBhdXRoLl91cGRhdGVDdXJyZW50VXNlcih1c2VyQ3JlZGVudGlhbC51c2VyKTtcbiAgICB9XG4gICAgcmV0dXJuIHVzZXJDcmVkZW50aWFsO1xufVxuLyoqXG4gKiBBc3luY2hyb25vdXNseSBzaWducyBpbiB3aXRoIHRoZSBnaXZlbiBjcmVkZW50aWFscy5cbiAqXG4gKiBAcmVtYXJrc1xuICogQW4ge0BsaW5rIEF1dGhQcm92aWRlcn0gY2FuIGJlIHVzZWQgdG8gZ2VuZXJhdGUgdGhlIGNyZWRlbnRpYWwuXG4gKlxuICogVGhpcyBtZXRob2QgaXMgbm90IHN1cHBvcnRlZCBieSB7QGxpbmsgQXV0aH0gaW5zdGFuY2VzIGNyZWF0ZWQgd2l0aCBhXG4gKiB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZVNlcnZlckFwcH0uXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIGNyZWRlbnRpYWwgLSBUaGUgYXV0aCBjcmVkZW50aWFsLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aENyZWRlbnRpYWwoYXV0aCwgY3JlZGVudGlhbCkge1xuICAgIHJldHVybiBfc2lnbkluV2l0aENyZWRlbnRpYWwoX2Nhc3RBdXRoKGF1dGgpLCBjcmVkZW50aWFsKTtcbn1cbi8qKlxuICogTGlua3MgdGhlIHVzZXIgYWNjb3VudCB3aXRoIHRoZSBnaXZlbiBjcmVkZW50aWFscy5cbiAqXG4gKiBAcmVtYXJrc1xuICogQW4ge0BsaW5rIEF1dGhQcm92aWRlcn0gY2FuIGJlIHVzZWQgdG8gZ2VuZXJhdGUgdGhlIGNyZWRlbnRpYWwuXG4gKlxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cbiAqIEBwYXJhbSBjcmVkZW50aWFsIC0gVGhlIGF1dGggY3JlZGVudGlhbC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGxpbmtXaXRoQ3JlZGVudGlhbCh1c2VyLCBjcmVkZW50aWFsKSB7XG4gICAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpO1xuICAgIGF3YWl0IF9hc3NlcnRMaW5rZWRTdGF0dXMoZmFsc2UsIHVzZXJJbnRlcm5hbCwgY3JlZGVudGlhbC5wcm92aWRlcklkKTtcbiAgICByZXR1cm4gX2xpbmsodXNlckludGVybmFsLCBjcmVkZW50aWFsKTtcbn1cbi8qKlxuICogUmUtYXV0aGVudGljYXRlcyBhIHVzZXIgdXNpbmcgYSBmcmVzaCBjcmVkZW50aWFsLlxuICpcbiAqIEByZW1hcmtzXG4gKiBVc2UgYmVmb3JlIG9wZXJhdGlvbnMgc3VjaCBhcyB7QGxpbmsgdXBkYXRlUGFzc3dvcmR9IHRoYXQgcmVxdWlyZSB0b2tlbnMgZnJvbSByZWNlbnQgc2lnbi1pblxuICogYXR0ZW1wdHMuIFRoaXMgbWV0aG9kIGNhbiBiZSB1c2VkIHRvIHJlY292ZXIgZnJvbSBhIGBDUkVERU5USUFMX1RPT19PTERfTE9HSU5fQUdBSU5gIGVycm9yXG4gKiBvciBhIGBUT0tFTl9FWFBJUkVEYCBlcnJvci5cbiAqXG4gKiBUaGlzIG1ldGhvZCBpcyBub3Qgc3VwcG9ydGVkIG9uIGFueSB7QGxpbmsgVXNlcn0gc2lnbmVkIGluIGJ5IHtAbGluayBBdXRofSBpbnN0YW5jZXNcbiAqIGNyZWF0ZWQgd2l0aCBhIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlU2VydmVyQXBwfS5cbiAqXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxuICogQHBhcmFtIGNyZWRlbnRpYWwgLSBUaGUgYXV0aCBjcmVkZW50aWFsLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gcmVhdXRoZW50aWNhdGVXaXRoQ3JlZGVudGlhbCh1c2VyLCBjcmVkZW50aWFsKSB7XG4gICAgcmV0dXJuIF9yZWF1dGhlbnRpY2F0ZShnZXRNb2R1bGFySW5zdGFuY2UodXNlciksIGNyZWRlbnRpYWwpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aEN1c3RvbVRva2VuJDEoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybVNpZ25JblJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92MS9hY2NvdW50czpzaWduSW5XaXRoQ3VzdG9tVG9rZW5cIiAvKiBFbmRwb2ludC5TSUdOX0lOX1dJVEhfQ1VTVE9NX1RPS0VOICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBc3luY2hyb25vdXNseSBzaWducyBpbiB1c2luZyBhIGN1c3RvbSB0b2tlbi5cbiAqXG4gKiBAcmVtYXJrc1xuICogQ3VzdG9tIHRva2VucyBhcmUgdXNlZCB0byBpbnRlZ3JhdGUgRmlyZWJhc2UgQXV0aCB3aXRoIGV4aXN0aW5nIGF1dGggc3lzdGVtcywgYW5kIG11c3RcbiAqIGJlIGdlbmVyYXRlZCBieSBhbiBhdXRoIGJhY2tlbmQgdXNpbmcgdGhlXG4gKiB7QGxpbmsgaHR0cHM6Ly9maXJlYmFzZS5nb29nbGUuY29tL2RvY3MvcmVmZXJlbmNlL2FkbWluL25vZGUvYWRtaW4uYXV0aC5BdXRoI2NyZWF0ZWN1c3RvbXRva2VuIHwgY3JlYXRlQ3VzdG9tVG9rZW59XG4gKiBtZXRob2QgaW4gdGhlIHtAbGluayBodHRwczovL2ZpcmViYXNlLmdvb2dsZS5jb20vZG9jcy9hdXRoL2FkbWluIHwgQWRtaW4gU0RLfSAuXG4gKlxuICogRmFpbHMgd2l0aCBhbiBlcnJvciBpZiB0aGUgdG9rZW4gaXMgaW52YWxpZCwgZXhwaXJlZCwgb3Igbm90IGFjY2VwdGVkIGJ5IHRoZSBGaXJlYmFzZSBBdXRoIHNlcnZpY2UuXG4gKlxuICogVGhpcyBtZXRob2QgaXMgbm90IHN1cHBvcnRlZCBieSB7QGxpbmsgQXV0aH0gaW5zdGFuY2VzIGNyZWF0ZWQgd2l0aCBhXG4gKiB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZVNlcnZlckFwcH0uXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIGN1c3RvbVRva2VuIC0gVGhlIGN1c3RvbSB0b2tlbiB0byBzaWduIGluIHdpdGguXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoQ3VzdG9tVG9rZW4oYXV0aCwgY3VzdG9tVG9rZW4pIHtcbiAgICBpZiAoX2lzRmlyZWJhc2VTZXJ2ZXJBcHAoYXV0aC5hcHApKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChfc2VydmVyQXBwQ3VycmVudFVzZXJPcGVyYXRpb25Ob3RTdXBwb3J0ZWRFcnJvcihhdXRoKSk7XG4gICAgfVxuICAgIGNvbnN0IGF1dGhJbnRlcm5hbCA9IF9jYXN0QXV0aChhdXRoKTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHNpZ25JbldpdGhDdXN0b21Ub2tlbiQxKGF1dGhJbnRlcm5hbCwge1xuICAgICAgICB0b2tlbjogY3VzdG9tVG9rZW4sXG4gICAgICAgIHJldHVyblNlY3VyZVRva2VuOiB0cnVlXG4gICAgfSk7XG4gICAgY29uc3QgY3JlZCA9IGF3YWl0IFVzZXJDcmVkZW50aWFsSW1wbC5fZnJvbUlkVG9rZW5SZXNwb25zZShhdXRoSW50ZXJuYWwsIFwic2lnbkluXCIgLyogT3BlcmF0aW9uVHlwZS5TSUdOX0lOICovLCByZXNwb25zZSk7XG4gICAgYXdhaXQgYXV0aEludGVybmFsLl91cGRhdGVDdXJyZW50VXNlcihjcmVkLnVzZXIpO1xuICAgIHJldHVybiBjcmVkO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3MgTXVsdGlGYWN0b3JJbmZvSW1wbCB7XG4gICAgY29uc3RydWN0b3IoZmFjdG9ySWQsIHJlc3BvbnNlKSB7XG4gICAgICAgIHRoaXMuZmFjdG9ySWQgPSBmYWN0b3JJZDtcbiAgICAgICAgdGhpcy51aWQgPSByZXNwb25zZS5tZmFFbnJvbGxtZW50SWQ7XG4gICAgICAgIHRoaXMuZW5yb2xsbWVudFRpbWUgPSBuZXcgRGF0ZShyZXNwb25zZS5lbnJvbGxlZEF0KS50b1VUQ1N0cmluZygpO1xuICAgICAgICB0aGlzLmRpc3BsYXlOYW1lID0gcmVzcG9uc2UuZGlzcGxheU5hbWU7XG4gICAgfVxuICAgIHN0YXRpYyBfZnJvbVNlcnZlclJlc3BvbnNlKGF1dGgsIGVucm9sbG1lbnQpIHtcbiAgICAgICAgaWYgKCdwaG9uZUluZm8nIGluIGVucm9sbG1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBQaG9uZU11bHRpRmFjdG9ySW5mb0ltcGwuX2Zyb21TZXJ2ZXJSZXNwb25zZShhdXRoLCBlbnJvbGxtZW50KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICgndG90cEluZm8nIGluIGVucm9sbG1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBUb3RwTXVsdGlGYWN0b3JJbmZvSW1wbC5fZnJvbVNlcnZlclJlc3BvbnNlKGF1dGgsIGVucm9sbG1lbnQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfZmFpbChhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgfVxufVxuY2xhc3MgUGhvbmVNdWx0aUZhY3RvckluZm9JbXBsIGV4dGVuZHMgTXVsdGlGYWN0b3JJbmZvSW1wbCB7XG4gICAgY29uc3RydWN0b3IocmVzcG9uc2UpIHtcbiAgICAgICAgc3VwZXIoXCJwaG9uZVwiIC8qIEZhY3RvcklkLlBIT05FICovLCByZXNwb25zZSk7XG4gICAgICAgIHRoaXMucGhvbmVOdW1iZXIgPSByZXNwb25zZS5waG9uZUluZm87XG4gICAgfVxuICAgIHN0YXRpYyBfZnJvbVNlcnZlclJlc3BvbnNlKF9hdXRoLCBlbnJvbGxtZW50KSB7XG4gICAgICAgIHJldHVybiBuZXcgUGhvbmVNdWx0aUZhY3RvckluZm9JbXBsKGVucm9sbG1lbnQpO1xuICAgIH1cbn1cbmNsYXNzIFRvdHBNdWx0aUZhY3RvckluZm9JbXBsIGV4dGVuZHMgTXVsdGlGYWN0b3JJbmZvSW1wbCB7XG4gICAgY29uc3RydWN0b3IocmVzcG9uc2UpIHtcbiAgICAgICAgc3VwZXIoXCJ0b3RwXCIgLyogRmFjdG9ySWQuVE9UUCAqLywgcmVzcG9uc2UpO1xuICAgIH1cbiAgICBzdGF0aWMgX2Zyb21TZXJ2ZXJSZXNwb25zZShfYXV0aCwgZW5yb2xsbWVudCkge1xuICAgICAgICByZXR1cm4gbmV3IFRvdHBNdWx0aUZhY3RvckluZm9JbXBsKGVucm9sbG1lbnQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmZ1bmN0aW9uIF9zZXRBY3Rpb25Db2RlU2V0dGluZ3NPblJlcXVlc3QoYXV0aCwgcmVxdWVzdCwgYWN0aW9uQ29kZVNldHRpbmdzKSB7XG4gICAgX2Fzc2VydChhY3Rpb25Db2RlU2V0dGluZ3MudXJsPy5sZW5ndGggPiAwLCBhdXRoLCBcImludmFsaWQtY29udGludWUtdXJpXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0NPTlRJTlVFX1VSSSAqLyk7XG4gICAgX2Fzc2VydCh0eXBlb2YgYWN0aW9uQ29kZVNldHRpbmdzLmR5bmFtaWNMaW5rRG9tYWluID09PSAndW5kZWZpbmVkJyB8fFxuICAgICAgICBhY3Rpb25Db2RlU2V0dGluZ3MuZHluYW1pY0xpbmtEb21haW4ubGVuZ3RoID4gMCwgYXV0aCwgXCJpbnZhbGlkLWR5bmFtaWMtbGluay1kb21haW5cIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfRFlOQU1JQ19MSU5LX0RPTUFJTiAqLyk7XG4gICAgX2Fzc2VydCh0eXBlb2YgYWN0aW9uQ29kZVNldHRpbmdzLmxpbmtEb21haW4gPT09ICd1bmRlZmluZWQnIHx8XG4gICAgICAgIGFjdGlvbkNvZGVTZXR0aW5ncy5saW5rRG9tYWluLmxlbmd0aCA+IDAsIGF1dGgsIFwiaW52YWxpZC1ob3N0aW5nLWxpbmstZG9tYWluXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0hPU1RJTkdfTElOS19ET01BSU4gKi8pO1xuICAgIHJlcXVlc3QuY29udGludWVVcmwgPSBhY3Rpb25Db2RlU2V0dGluZ3MudXJsO1xuICAgIHJlcXVlc3QuZHluYW1pY0xpbmtEb21haW4gPSBhY3Rpb25Db2RlU2V0dGluZ3MuZHluYW1pY0xpbmtEb21haW47XG4gICAgcmVxdWVzdC5saW5rRG9tYWluID0gYWN0aW9uQ29kZVNldHRpbmdzLmxpbmtEb21haW47XG4gICAgcmVxdWVzdC5jYW5IYW5kbGVDb2RlSW5BcHAgPSBhY3Rpb25Db2RlU2V0dGluZ3MuaGFuZGxlQ29kZUluQXBwO1xuICAgIGlmIChhY3Rpb25Db2RlU2V0dGluZ3MuaU9TKSB7XG4gICAgICAgIF9hc3NlcnQoYWN0aW9uQ29kZVNldHRpbmdzLmlPUy5idW5kbGVJZC5sZW5ndGggPiAwLCBhdXRoLCBcIm1pc3NpbmctaW9zLWJ1bmRsZS1pZFwiIC8qIEF1dGhFcnJvckNvZGUuTUlTU0lOR19JT1NfQlVORExFX0lEICovKTtcbiAgICAgICAgcmVxdWVzdC5pT1NCdW5kbGVJZCA9IGFjdGlvbkNvZGVTZXR0aW5ncy5pT1MuYnVuZGxlSWQ7XG4gICAgfVxuICAgIGlmIChhY3Rpb25Db2RlU2V0dGluZ3MuYW5kcm9pZCkge1xuICAgICAgICBfYXNzZXJ0KGFjdGlvbkNvZGVTZXR0aW5ncy5hbmRyb2lkLnBhY2thZ2VOYW1lLmxlbmd0aCA+IDAsIGF1dGgsIFwibWlzc2luZy1hbmRyb2lkLXBrZy1uYW1lXCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX0FORFJPSURfUEFDS0FHRV9OQU1FICovKTtcbiAgICAgICAgcmVxdWVzdC5hbmRyb2lkSW5zdGFsbEFwcCA9IGFjdGlvbkNvZGVTZXR0aW5ncy5hbmRyb2lkLmluc3RhbGxBcHA7XG4gICAgICAgIHJlcXVlc3QuYW5kcm9pZE1pbmltdW1WZXJzaW9uQ29kZSA9XG4gICAgICAgICAgICBhY3Rpb25Db2RlU2V0dGluZ3MuYW5kcm9pZC5taW5pbXVtVmVyc2lvbjtcbiAgICAgICAgcmVxdWVzdC5hbmRyb2lkUGFja2FnZU5hbWUgPSBhY3Rpb25Db2RlU2V0dGluZ3MuYW5kcm9pZC5wYWNrYWdlTmFtZTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFVwZGF0ZXMgdGhlIHBhc3N3b3JkIHBvbGljeSBjYWNoZWQgaW4gdGhlIHtAbGluayBBdXRofSBpbnN0YW5jZSBpZiBhIHBvbGljeSBpcyBhbHJlYWR5XG4gKiBjYWNoZWQgZm9yIHRoZSBwcm9qZWN0IG9yIHRlbmFudC5cbiAqXG4gKiBAcmVtYXJrc1xuICogV2Ugb25seSBmZXRjaCB0aGUgcGFzc3dvcmQgcG9saWN5IGlmIHRoZSBwYXNzd29yZCBkaWQgbm90IG1lZXQgcG9saWN5IHJlcXVpcmVtZW50cyBhbmRcbiAqIHRoZXJlIGlzIGFuIGV4aXN0aW5nIHBvbGljeSBjYWNoZWQuIEEgZGV2ZWxvcGVyIG11c3QgY2FsbCB2YWxpZGF0ZVBhc3N3b3JkIGF0IGxlYXN0XG4gKiBvbmNlIGZvciB0aGUgY2FjaGUgdG8gYmUgYXV0b21hdGljYWxseSB1cGRhdGVkLlxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqXG4gKiBAcHJpdmF0ZVxuICovXG5hc3luYyBmdW5jdGlvbiByZWNhY2hlUGFzc3dvcmRQb2xpY3koYXV0aCkge1xuICAgIGNvbnN0IGF1dGhJbnRlcm5hbCA9IF9jYXN0QXV0aChhdXRoKTtcbiAgICBpZiAoYXV0aEludGVybmFsLl9nZXRQYXNzd29yZFBvbGljeUludGVybmFsKCkpIHtcbiAgICAgICAgYXdhaXQgYXV0aEludGVybmFsLl91cGRhdGVQYXNzd29yZFBvbGljeSgpO1xuICAgIH1cbn1cbi8qKlxuICogU2VuZHMgYSBwYXNzd29yZCByZXNldCBlbWFpbCB0byB0aGUgZ2l2ZW4gZW1haWwgYWRkcmVzcy4gVGhpcyBtZXRob2QgZG9lcyBub3QgdGhyb3cgYW4gZXJyb3Igd2hlblxuICogdGhlcmUncyBubyB1c2VyIGFjY291bnQgd2l0aCB0aGUgZ2l2ZW4gZW1haWwgYWRkcmVzcyBhbmRcbiAqIHtAbGluayBodHRwczovL2Nsb3VkLmdvb2dsZS5jb20vaWRlbnRpdHktcGxhdGZvcm0vZG9jcy9hZG1pbi9lbWFpbC1lbnVtZXJhdGlvbi1wcm90ZWN0aW9uIHwgRW1haWwgRW51bWVyYXRpb24gUHJvdGVjdGlvbn1cbiAqIGlzIGVuYWJsZWQuXG4gKlxuICogQHJlbWFya3NcbiAqIFRvIGNvbXBsZXRlIHRoZSBwYXNzd29yZCByZXNldCwgY2FsbCB7QGxpbmsgY29uZmlybVBhc3N3b3JkUmVzZXR9IHdpdGggdGhlIGNvZGUgc3VwcGxpZWQgaW5cbiAqIHRoZSBlbWFpbCBzZW50IHRvIHRoZSB1c2VyLCBhbG9uZyB3aXRoIHRoZSBuZXcgcGFzc3dvcmQgc3BlY2lmaWVkIGJ5IHRoZSB1c2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiBjb25zdCBhY3Rpb25Db2RlU2V0dGluZ3MgPSB7XG4gKiAgIHVybDogJ2h0dHBzOi8vd3d3LmV4YW1wbGUuY29tLz9lbWFpbD11c2VyQGV4YW1wbGUuY29tJyxcbiAqICAgaU9TOiB7XG4gKiAgICAgIGJ1bmRsZUlkOiAnY29tLmV4YW1wbGUuaW9zJ1xuICogICB9LFxuICogICBhbmRyb2lkOiB7XG4gKiAgICAgcGFja2FnZU5hbWU6ICdjb20uZXhhbXBsZS5hbmRyb2lkJyxcbiAqICAgICBpbnN0YWxsQXBwOiB0cnVlLFxuICogICAgIG1pbmltdW1WZXJzaW9uOiAnMTInXG4gKiAgIH0sXG4gKiAgIGhhbmRsZUNvZGVJbkFwcDogdHJ1ZVxuICogfTtcbiAqIGF3YWl0IHNlbmRQYXNzd29yZFJlc2V0RW1haWwoYXV0aCwgJ3VzZXJAZXhhbXBsZS5jb20nLCBhY3Rpb25Db2RlU2V0dGluZ3MpO1xuICogLy8gT2J0YWluIGNvZGUgZnJvbSB1c2VyLlxuICogYXdhaXQgY29uZmlybVBhc3N3b3JkUmVzZXQoJ3VzZXJAZXhhbXBsZS5jb20nLCBjb2RlKTtcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSBlbWFpbCAtIFRoZSB1c2VyJ3MgZW1haWwgYWRkcmVzcy5cbiAqIEBwYXJhbSBhY3Rpb25Db2RlU2V0dGluZ3MgLSBUaGUge0BsaW5rIEFjdGlvbkNvZGVTZXR0aW5nc30uXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiBzZW5kUGFzc3dvcmRSZXNldEVtYWlsKGF1dGgsIGVtYWlsLCBhY3Rpb25Db2RlU2V0dGluZ3MpIHtcbiAgICBjb25zdCBhdXRoSW50ZXJuYWwgPSBfY2FzdEF1dGgoYXV0aCk7XG4gICAgY29uc3QgcmVxdWVzdCA9IHtcbiAgICAgICAgcmVxdWVzdFR5cGU6IFwiUEFTU1dPUkRfUkVTRVRcIiAvKiBBY3Rpb25Db2RlT3BlcmF0aW9uLlBBU1NXT1JEX1JFU0VUICovLFxuICAgICAgICBlbWFpbCxcbiAgICAgICAgY2xpZW50VHlwZTogXCJDTElFTlRfVFlQRV9XRUJcIiAvKiBSZWNhcHRjaGFDbGllbnRUeXBlLldFQiAqL1xuICAgIH07XG4gICAgaWYgKGFjdGlvbkNvZGVTZXR0aW5ncykge1xuICAgICAgICBfc2V0QWN0aW9uQ29kZVNldHRpbmdzT25SZXF1ZXN0KGF1dGhJbnRlcm5hbCwgcmVxdWVzdCwgYWN0aW9uQ29kZVNldHRpbmdzKTtcbiAgICB9XG4gICAgYXdhaXQgaGFuZGxlUmVjYXB0Y2hhRmxvdyhhdXRoSW50ZXJuYWwsIHJlcXVlc3QsIFwiZ2V0T29iQ29kZVwiIC8qIFJlY2FwdGNoYUFjdGlvbk5hbWUuR0VUX09PQl9DT0RFICovLCBzZW5kUGFzc3dvcmRSZXNldEVtYWlsJDEsIFwiRU1BSUxfUEFTU1dPUkRfUFJPVklERVJcIiAvKiBSZWNhcHRjaGFBdXRoUHJvdmlkZXIuRU1BSUxfUEFTU1dPUkRfUFJPVklERVIgKi8pO1xufVxuLyoqXG4gKiBDb21wbGV0ZXMgdGhlIHBhc3N3b3JkIHJlc2V0IHByb2Nlc3MsIGdpdmVuIGEgY29uZmlybWF0aW9uIGNvZGUgYW5kIG5ldyBwYXNzd29yZC5cbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gb29iQ29kZSAtIEEgY29uZmlybWF0aW9uIGNvZGUgc2VudCB0byB0aGUgdXNlci5cbiAqIEBwYXJhbSBuZXdQYXNzd29yZCAtIFRoZSBuZXcgcGFzc3dvcmQuXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiBjb25maXJtUGFzc3dvcmRSZXNldChhdXRoLCBvb2JDb2RlLCBuZXdQYXNzd29yZCkge1xuICAgIGF3YWl0IHJlc2V0UGFzc3dvcmQoZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLCB7XG4gICAgICAgIG9vYkNvZGUsXG4gICAgICAgIG5ld1Bhc3N3b3JkXG4gICAgfSlcbiAgICAgICAgLmNhdGNoKGFzeW5jIChlcnJvcikgPT4ge1xuICAgICAgICBpZiAoZXJyb3IuY29kZSA9PT1cbiAgICAgICAgICAgIGBhdXRoLyR7XCJwYXNzd29yZC1kb2VzLW5vdC1tZWV0LXJlcXVpcmVtZW50c1wiIC8qIEF1dGhFcnJvckNvZGUuUEFTU1dPUkRfRE9FU19OT1RfTUVFVF9SRVFVSVJFTUVOVFMgKi99YCkge1xuICAgICAgICAgICAgdm9pZCByZWNhY2hlUGFzc3dvcmRQb2xpY3koYXV0aCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfSk7XG4gICAgLy8gRG8gbm90IHJldHVybiB0aGUgZW1haWwuXG59XG4vKipcbiAqIEFwcGxpZXMgYSB2ZXJpZmljYXRpb24gY29kZSBzZW50IHRvIHRoZSB1c2VyIGJ5IGVtYWlsIG9yIG90aGVyIG91dC1vZi1iYW5kIG1lY2hhbmlzbS5cbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gb29iQ29kZSAtIEEgdmVyaWZpY2F0aW9uIGNvZGUgc2VudCB0byB0aGUgdXNlci5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGFwcGx5QWN0aW9uQ29kZShhdXRoLCBvb2JDb2RlKSB7XG4gICAgYXdhaXQgYXBwbHlBY3Rpb25Db2RlJDEoZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLCB7IG9vYkNvZGUgfSk7XG59XG4vKipcbiAqIENoZWNrcyBhIHZlcmlmaWNhdGlvbiBjb2RlIHNlbnQgdG8gdGhlIHVzZXIgYnkgZW1haWwgb3Igb3RoZXIgb3V0LW9mLWJhbmQgbWVjaGFuaXNtLlxuICpcbiAqIEByZXR1cm5zIG1ldGFkYXRhIGFib3V0IHRoZSBjb2RlLlxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSBvb2JDb2RlIC0gQSB2ZXJpZmljYXRpb24gY29kZSBzZW50IHRvIHRoZSB1c2VyLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gY2hlY2tBY3Rpb25Db2RlKGF1dGgsIG9vYkNvZGUpIHtcbiAgICBjb25zdCBhdXRoTW9kdWxhciA9IGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlc2V0UGFzc3dvcmQoYXV0aE1vZHVsYXIsIHsgb29iQ29kZSB9KTtcbiAgICAvLyBFbWFpbCBjb3VsZCBiZSBlbXB0eSBvbmx5IGlmIHRoZSByZXF1ZXN0IHR5cGUgaXMgRU1BSUxfU0lHTklOIG9yXG4gICAgLy8gVkVSSUZZX0FORF9DSEFOR0VfRU1BSUwuXG4gICAgLy8gTmV3IGVtYWlsIHNob3VsZCBub3QgYmUgZW1wdHkgaWYgdGhlIHJlcXVlc3QgdHlwZSBpc1xuICAgIC8vIFZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMLlxuICAgIC8vIE11bHRpLWZhY3RvciBpbmZvIGNvdWxkIG5vdCBiZSBlbXB0eSBpZiB0aGUgcmVxdWVzdCB0eXBlIGlzXG4gICAgLy8gUkVWRVJUX1NFQ09ORF9GQUNUT1JfQURESVRJT04uXG4gICAgY29uc3Qgb3BlcmF0aW9uID0gcmVzcG9uc2UucmVxdWVzdFR5cGU7XG4gICAgX2Fzc2VydChvcGVyYXRpb24sIGF1dGhNb2R1bGFyLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgc3dpdGNoIChvcGVyYXRpb24pIHtcbiAgICAgICAgY2FzZSBcIkVNQUlMX1NJR05JTlwiIC8qIEFjdGlvbkNvZGVPcGVyYXRpb24uRU1BSUxfU0lHTklOICovOlxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJWRVJJRllfQU5EX0NIQU5HRV9FTUFJTFwiIC8qIEFjdGlvbkNvZGVPcGVyYXRpb24uVkVSSUZZX0FORF9DSEFOR0VfRU1BSUwgKi86XG4gICAgICAgICAgICBfYXNzZXJ0KHJlc3BvbnNlLm5ld0VtYWlsLCBhdXRoTW9kdWxhciwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJSRVZFUlRfU0VDT05EX0ZBQ1RPUl9BRERJVElPTlwiIC8qIEFjdGlvbkNvZGVPcGVyYXRpb24uUkVWRVJUX1NFQ09ORF9GQUNUT1JfQURESVRJT04gKi86XG4gICAgICAgICAgICBfYXNzZXJ0KHJlc3BvbnNlLm1mYUluZm8sIGF1dGhNb2R1bGFyLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgIC8vIGZhbGwgdGhyb3VnaFxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgX2Fzc2VydChyZXNwb25zZS5lbWFpbCwgYXV0aE1vZHVsYXIsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICB9XG4gICAgLy8gVGhlIG11bHRpLWZhY3RvciBpbmZvIGZvciByZXZlcnQgc2Vjb25kIGZhY3RvciBhZGRpdGlvblxuICAgIGxldCBtdWx0aUZhY3RvckluZm8gPSBudWxsO1xuICAgIGlmIChyZXNwb25zZS5tZmFJbmZvKSB7XG4gICAgICAgIG11bHRpRmFjdG9ySW5mbyA9IE11bHRpRmFjdG9ySW5mb0ltcGwuX2Zyb21TZXJ2ZXJSZXNwb25zZShfY2FzdEF1dGgoYXV0aE1vZHVsYXIpLCByZXNwb25zZS5tZmFJbmZvKTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgZW1haWw6IChyZXNwb25zZS5yZXF1ZXN0VHlwZSA9PT0gXCJWRVJJRllfQU5EX0NIQU5HRV9FTUFJTFwiIC8qIEFjdGlvbkNvZGVPcGVyYXRpb24uVkVSSUZZX0FORF9DSEFOR0VfRU1BSUwgKi9cbiAgICAgICAgICAgICAgICA/IHJlc3BvbnNlLm5ld0VtYWlsXG4gICAgICAgICAgICAgICAgOiByZXNwb25zZS5lbWFpbCkgfHwgbnVsbCxcbiAgICAgICAgICAgIHByZXZpb3VzRW1haWw6IChyZXNwb25zZS5yZXF1ZXN0VHlwZSA9PT0gXCJWRVJJRllfQU5EX0NIQU5HRV9FTUFJTFwiIC8qIEFjdGlvbkNvZGVPcGVyYXRpb24uVkVSSUZZX0FORF9DSEFOR0VfRU1BSUwgKi9cbiAgICAgICAgICAgICAgICA/IHJlc3BvbnNlLmVtYWlsXG4gICAgICAgICAgICAgICAgOiByZXNwb25zZS5uZXdFbWFpbCkgfHwgbnVsbCxcbiAgICAgICAgICAgIG11bHRpRmFjdG9ySW5mb1xuICAgICAgICB9LFxuICAgICAgICBvcGVyYXRpb25cbiAgICB9O1xufVxuLyoqXG4gKiBDaGVja3MgYSBwYXNzd29yZCByZXNldCBjb2RlIHNlbnQgdG8gdGhlIHVzZXIgYnkgZW1haWwgb3Igb3RoZXIgb3V0LW9mLWJhbmQgbWVjaGFuaXNtLlxuICpcbiAqIEByZXR1cm5zIHRoZSB1c2VyJ3MgZW1haWwgYWRkcmVzcyBpZiB2YWxpZC5cbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gY29kZSAtIEEgdmVyaWZpY2F0aW9uIGNvZGUgc2VudCB0byB0aGUgdXNlci5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHZlcmlmeVBhc3N3b3JkUmVzZXRDb2RlKGF1dGgsIGNvZGUpIHtcbiAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IGNoZWNrQWN0aW9uQ29kZShnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCksIGNvZGUpO1xuICAgIC8vIEVtYWlsIHNob3VsZCBhbHdheXMgYmUgcHJlc2VudCBzaW5jZSBhIGNvZGUgd2FzIHNlbnQgdG8gaXRcbiAgICByZXR1cm4gZGF0YS5lbWFpbDtcbn1cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyB1c2VyIGFjY291bnQgYXNzb2NpYXRlZCB3aXRoIHRoZSBzcGVjaWZpZWQgZW1haWwgYWRkcmVzcyBhbmQgcGFzc3dvcmQuXG4gKlxuICogQHJlbWFya3NcbiAqIE9uIHN1Y2Nlc3NmdWwgY3JlYXRpb24gb2YgdGhlIHVzZXIgYWNjb3VudCwgdGhpcyB1c2VyIHdpbGwgYWxzbyBiZSBzaWduZWQgaW4gdG8geW91ciBhcHBsaWNhdGlvbi5cbiAqXG4gKiBVc2VyIGFjY291bnQgY3JlYXRpb24gY2FuIGZhaWwgaWYgdGhlIGFjY291bnQgYWxyZWFkeSBleGlzdHMgb3IgdGhlIHBhc3N3b3JkIGlzIGludmFsaWQuXG4gKlxuICogVGhpcyBtZXRob2QgaXMgbm90IHN1cHBvcnRlZCBvbiB7QGxpbmsgQXV0aH0gaW5zdGFuY2VzIGNyZWF0ZWQgd2l0aCBhXG4gKiB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZVNlcnZlckFwcH0uXG4gKlxuICogTm90ZTogVGhlIGVtYWlsIGFkZHJlc3MgYWN0cyBhcyBhIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgdXNlciBhbmQgZW5hYmxlcyBhbiBlbWFpbC1iYXNlZFxuICogcGFzc3dvcmQgcmVzZXQuIFRoaXMgZnVuY3Rpb24gd2lsbCBjcmVhdGUgYSBuZXcgdXNlciBhY2NvdW50IGFuZCBzZXQgdGhlIGluaXRpYWwgdXNlciBwYXNzd29yZC5cbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gZW1haWwgLSBUaGUgdXNlcidzIGVtYWlsIGFkZHJlc3MuXG4gKiBAcGFyYW0gcGFzc3dvcmQgLSBUaGUgdXNlcidzIGNob3NlbiBwYXNzd29yZC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVVzZXJXaXRoRW1haWxBbmRQYXNzd29yZChhdXRoLCBlbWFpbCwgcGFzc3dvcmQpIHtcbiAgICBpZiAoX2lzRmlyZWJhc2VTZXJ2ZXJBcHAoYXV0aC5hcHApKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChfc2VydmVyQXBwQ3VycmVudFVzZXJPcGVyYXRpb25Ob3RTdXBwb3J0ZWRFcnJvcihhdXRoKSk7XG4gICAgfVxuICAgIGNvbnN0IGF1dGhJbnRlcm5hbCA9IF9jYXN0QXV0aChhdXRoKTtcbiAgICBjb25zdCByZXF1ZXN0ID0ge1xuICAgICAgICByZXR1cm5TZWN1cmVUb2tlbjogdHJ1ZSxcbiAgICAgICAgZW1haWwsXG4gICAgICAgIHBhc3N3b3JkLFxuICAgICAgICBjbGllbnRUeXBlOiBcIkNMSUVOVF9UWVBFX1dFQlwiIC8qIFJlY2FwdGNoYUNsaWVudFR5cGUuV0VCICovXG4gICAgfTtcbiAgICBjb25zdCBzaWduVXBSZXNwb25zZSA9IGhhbmRsZVJlY2FwdGNoYUZsb3coYXV0aEludGVybmFsLCByZXF1ZXN0LCBcInNpZ25VcFBhc3N3b3JkXCIgLyogUmVjYXB0Y2hhQWN0aW9uTmFtZS5TSUdOX1VQX1BBU1NXT1JEICovLCBzaWduVXAsIFwiRU1BSUxfUEFTU1dPUkRfUFJPVklERVJcIiAvKiBSZWNhcHRjaGFBdXRoUHJvdmlkZXIuRU1BSUxfUEFTU1dPUkRfUFJPVklERVIgKi8pO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgc2lnblVwUmVzcG9uc2UuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICBpZiAoZXJyb3IuY29kZSA9PT0gYGF1dGgvJHtcInBhc3N3b3JkLWRvZXMtbm90LW1lZXQtcmVxdWlyZW1lbnRzXCIgLyogQXV0aEVycm9yQ29kZS5QQVNTV09SRF9ET0VTX05PVF9NRUVUX1JFUVVJUkVNRU5UUyAqL31gKSB7XG4gICAgICAgICAgICB2b2lkIHJlY2FjaGVQYXNzd29yZFBvbGljeShhdXRoKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICB9KTtcbiAgICBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IFVzZXJDcmVkZW50aWFsSW1wbC5fZnJvbUlkVG9rZW5SZXNwb25zZShhdXRoSW50ZXJuYWwsIFwic2lnbkluXCIgLyogT3BlcmF0aW9uVHlwZS5TSUdOX0lOICovLCByZXNwb25zZSk7XG4gICAgYXdhaXQgYXV0aEludGVybmFsLl91cGRhdGVDdXJyZW50VXNlcih1c2VyQ3JlZGVudGlhbC51c2VyKTtcbiAgICByZXR1cm4gdXNlckNyZWRlbnRpYWw7XG59XG4vKipcbiAqIEFzeW5jaHJvbm91c2x5IHNpZ25zIGluIHVzaW5nIGFuIGVtYWlsIGFuZCBwYXNzd29yZC5cbiAqXG4gKiBAcmVtYXJrc1xuICogRmFpbHMgd2l0aCBhbiBlcnJvciBpZiB0aGUgZW1haWwgYWRkcmVzcyBhbmQgcGFzc3dvcmQgZG8gbm90IG1hdGNoLiBXaGVuXG4gKiB7QGxpbmsgaHR0cHM6Ly9jbG91ZC5nb29nbGUuY29tL2lkZW50aXR5LXBsYXRmb3JtL2RvY3MvYWRtaW4vZW1haWwtZW51bWVyYXRpb24tcHJvdGVjdGlvbiB8IEVtYWlsIEVudW1lcmF0aW9uIFByb3RlY3Rpb259XG4gKiBpcyBlbmFibGVkLCB0aGlzIG1ldGhvZCBmYWlscyB3aXRoIFwiYXV0aC9pbnZhbGlkLWNyZWRlbnRpYWxcIiBpbiBjYXNlIG9mIGFuIGludmFsaWRcbiAqIGVtYWlsL3Bhc3N3b3JkLlxuICpcbiAqIFRoaXMgbWV0aG9kIGlzIG5vdCBzdXBwb3J0ZWQgb24ge0BsaW5rIEF1dGh9IGluc3RhbmNlcyBjcmVhdGVkIHdpdGggYVxuICoge0BsaW5rIEBmaXJlYmFzZS9hcHAjRmlyZWJhc2VTZXJ2ZXJBcHB9LlxuICpcbiAqIE5vdGU6IFRoZSB1c2VyJ3MgcGFzc3dvcmQgaXMgTk9UIHRoZSBwYXNzd29yZCB1c2VkIHRvIGFjY2VzcyB0aGUgdXNlcidzIGVtYWlsIGFjY291bnQuIFRoZVxuICogZW1haWwgYWRkcmVzcyBzZXJ2ZXMgYXMgYSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHVzZXIsIGFuZCB0aGUgcGFzc3dvcmQgaXMgdXNlZCB0byBhY2Nlc3NcbiAqIHRoZSB1c2VyJ3MgYWNjb3VudCBpbiB5b3VyIEZpcmViYXNlIHByb2plY3QuIFNlZSBhbHNvOiB7QGxpbmsgY3JlYXRlVXNlcldpdGhFbWFpbEFuZFBhc3N3b3JkfS5cbiAqXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIGVtYWlsIC0gVGhlIHVzZXJzIGVtYWlsIGFkZHJlc3MuXG4gKiBAcGFyYW0gcGFzc3dvcmQgLSBUaGUgdXNlcnMgcGFzc3dvcmQuXG4gKlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiBzaWduSW5XaXRoRW1haWxBbmRQYXNzd29yZChhdXRoLCBlbWFpbCwgcGFzc3dvcmQpIHtcbiAgICBpZiAoX2lzRmlyZWJhc2VTZXJ2ZXJBcHAoYXV0aC5hcHApKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChfc2VydmVyQXBwQ3VycmVudFVzZXJPcGVyYXRpb25Ob3RTdXBwb3J0ZWRFcnJvcihhdXRoKSk7XG4gICAgfVxuICAgIHJldHVybiBzaWduSW5XaXRoQ3JlZGVudGlhbChnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCksIEVtYWlsQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWwoZW1haWwsIHBhc3N3b3JkKSkuY2F0Y2goYXN5bmMgKGVycm9yKSA9PiB7XG4gICAgICAgIGlmIChlcnJvci5jb2RlID09PSBgYXV0aC8ke1wicGFzc3dvcmQtZG9lcy1ub3QtbWVldC1yZXF1aXJlbWVudHNcIiAvKiBBdXRoRXJyb3JDb2RlLlBBU1NXT1JEX0RPRVNfTk9UX01FRVRfUkVRVUlSRU1FTlRTICovfWApIHtcbiAgICAgICAgICAgIHZvaWQgcmVjYWNoZVBhc3N3b3JkUG9saWN5KGF1dGgpO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgIH0pO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBTZW5kcyBhIHNpZ24taW4gZW1haWwgbGluayB0byB0aGUgdXNlciB3aXRoIHRoZSBzcGVjaWZpZWQgZW1haWwuXG4gKlxuICogQHJlbWFya3NcbiAqIFRoZSBzaWduLWluIG9wZXJhdGlvbiBoYXMgdG8gYWx3YXlzIGJlIGNvbXBsZXRlZCBpbiB0aGUgYXBwIHVubGlrZSBvdGhlciBvdXQgb2YgYmFuZCBlbWFpbFxuICogYWN0aW9ucyAocGFzc3dvcmQgcmVzZXQgYW5kIGVtYWlsIHZlcmlmaWNhdGlvbnMpLiBUaGlzIGlzIGJlY2F1c2UsIGF0IHRoZSBlbmQgb2YgdGhlIGZsb3csXG4gKiB0aGUgdXNlciBpcyBleHBlY3RlZCB0byBiZSBzaWduZWQgaW4gYW5kIHRoZWlyIEF1dGggc3RhdGUgcGVyc2lzdGVkIHdpdGhpbiB0aGUgYXBwLlxuICpcbiAqIFRvIGNvbXBsZXRlIHNpZ24gaW4gd2l0aCB0aGUgZW1haWwgbGluaywgY2FsbCB7QGxpbmsgc2lnbkluV2l0aEVtYWlsTGlua30gd2l0aCB0aGUgZW1haWxcbiAqIGFkZHJlc3MgYW5kIHRoZSBlbWFpbCBsaW5rIHN1cHBsaWVkIGluIHRoZSBlbWFpbCBzZW50IHRvIHRoZSB1c2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiBjb25zdCBhY3Rpb25Db2RlU2V0dGluZ3MgPSB7XG4gKiAgIHVybDogJ2h0dHBzOi8vd3d3LmV4YW1wbGUuY29tLz9lbWFpbD11c2VyQGV4YW1wbGUuY29tJyxcbiAqICAgaU9TOiB7XG4gKiAgICAgIGJ1bmRsZUlkOiAnY29tLmV4YW1wbGUuaW9zJ1xuICogICB9LFxuICogICBhbmRyb2lkOiB7XG4gKiAgICAgcGFja2FnZU5hbWU6ICdjb20uZXhhbXBsZS5hbmRyb2lkJyxcbiAqICAgICBpbnN0YWxsQXBwOiB0cnVlLFxuICogICAgIG1pbmltdW1WZXJzaW9uOiAnMTInXG4gKiAgIH0sXG4gKiAgIGhhbmRsZUNvZGVJbkFwcDogdHJ1ZVxuICogfTtcbiAqIGF3YWl0IHNlbmRTaWduSW5MaW5rVG9FbWFpbChhdXRoLCAndXNlckBleGFtcGxlLmNvbScsIGFjdGlvbkNvZGVTZXR0aW5ncyk7XG4gKiAvLyBPYnRhaW4gZW1haWxMaW5rIGZyb20gdGhlIHVzZXIuXG4gKiBpZihpc1NpZ25JbldpdGhFbWFpbExpbmsoYXV0aCwgZW1haWxMaW5rKSkge1xuICogICBhd2FpdCBzaWduSW5XaXRoRW1haWxMaW5rKGF1dGgsICd1c2VyQGV4YW1wbGUuY29tJywgZW1haWxMaW5rKTtcbiAqIH1cbiAqIGBgYFxuICpcbiAqIEBwYXJhbSBhdXRoSW50ZXJuYWwgLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIGVtYWlsIC0gVGhlIHVzZXIncyBlbWFpbCBhZGRyZXNzLlxuICogQHBhcmFtIGFjdGlvbkNvZGVTZXR0aW5ncyAtIFRoZSB7QGxpbmsgQWN0aW9uQ29kZVNldHRpbmdzfS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHNlbmRTaWduSW5MaW5rVG9FbWFpbChhdXRoLCBlbWFpbCwgYWN0aW9uQ29kZVNldHRpbmdzKSB7XG4gICAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xuICAgIGNvbnN0IHJlcXVlc3QgPSB7XG4gICAgICAgIHJlcXVlc3RUeXBlOiBcIkVNQUlMX1NJR05JTlwiIC8qIEFjdGlvbkNvZGVPcGVyYXRpb24uRU1BSUxfU0lHTklOICovLFxuICAgICAgICBlbWFpbCxcbiAgICAgICAgY2xpZW50VHlwZTogXCJDTElFTlRfVFlQRV9XRUJcIiAvKiBSZWNhcHRjaGFDbGllbnRUeXBlLldFQiAqL1xuICAgIH07XG4gICAgZnVuY3Rpb24gc2V0QWN0aW9uQ29kZVNldHRpbmdzKHJlcXVlc3QsIGFjdGlvbkNvZGVTZXR0aW5ncykge1xuICAgICAgICBfYXNzZXJ0KGFjdGlvbkNvZGVTZXR0aW5ncy5oYW5kbGVDb2RlSW5BcHAsIGF1dGhJbnRlcm5hbCwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IgKi8pO1xuICAgICAgICBpZiAoYWN0aW9uQ29kZVNldHRpbmdzKSB7XG4gICAgICAgICAgICBfc2V0QWN0aW9uQ29kZVNldHRpbmdzT25SZXF1ZXN0KGF1dGhJbnRlcm5hbCwgcmVxdWVzdCwgYWN0aW9uQ29kZVNldHRpbmdzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRBY3Rpb25Db2RlU2V0dGluZ3MocmVxdWVzdCwgYWN0aW9uQ29kZVNldHRpbmdzKTtcbiAgICBhd2FpdCBoYW5kbGVSZWNhcHRjaGFGbG93KGF1dGhJbnRlcm5hbCwgcmVxdWVzdCwgXCJnZXRPb2JDb2RlXCIgLyogUmVjYXB0Y2hhQWN0aW9uTmFtZS5HRVRfT09CX0NPREUgKi8sIHNlbmRTaWduSW5MaW5rVG9FbWFpbCQxLCBcIkVNQUlMX1BBU1NXT1JEX1BST1ZJREVSXCIgLyogUmVjYXB0Y2hhQXV0aFByb3ZpZGVyLkVNQUlMX1BBU1NXT1JEX1BST1ZJREVSICovKTtcbn1cbi8qKlxuICogQ2hlY2tzIGlmIGFuIGluY29taW5nIGxpbmsgaXMgYSBzaWduLWluIHdpdGggZW1haWwgbGluayBzdWl0YWJsZSBmb3Ige0BsaW5rIHNpZ25JbldpdGhFbWFpbExpbmt9LlxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSBlbWFpbExpbmsgLSBUaGUgbGluayBzZW50IHRvIHRoZSB1c2VyJ3MgZW1haWwgYWRkcmVzcy5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIGlzU2lnbkluV2l0aEVtYWlsTGluayhhdXRoLCBlbWFpbExpbmspIHtcbiAgICBjb25zdCBhY3Rpb25Db2RlVXJsID0gQWN0aW9uQ29kZVVSTC5wYXJzZUxpbmsoZW1haWxMaW5rKTtcbiAgICByZXR1cm4gYWN0aW9uQ29kZVVybD8ub3BlcmF0aW9uID09PSBcIkVNQUlMX1NJR05JTlwiIC8qIEFjdGlvbkNvZGVPcGVyYXRpb24uRU1BSUxfU0lHTklOICovO1xufVxuLyoqXG4gKiBBc3luY2hyb25vdXNseSBzaWducyBpbiB1c2luZyBhbiBlbWFpbCBhbmQgc2lnbi1pbiBlbWFpbCBsaW5rLlxuICpcbiAqIEByZW1hcmtzXG4gKiBJZiBubyBsaW5rIGlzIHBhc3NlZCwgdGhlIGxpbmsgaXMgaW5mZXJyZWQgZnJvbSB0aGUgY3VycmVudCBVUkwuXG4gKlxuICogRmFpbHMgd2l0aCBhbiBlcnJvciBpZiB0aGUgZW1haWwgYWRkcmVzcyBpcyBpbnZhbGlkIG9yIE9UUCBpbiBlbWFpbCBsaW5rIGV4cGlyZXMuXG4gKlxuICogVGhpcyBtZXRob2QgaXMgbm90IHN1cHBvcnRlZCBieSB7QGxpbmsgQXV0aH0gaW5zdGFuY2VzIGNyZWF0ZWQgd2l0aCBhXG4gKiB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZVNlcnZlckFwcH0uXG4gKlxuICogTm90ZTogQ29uZmlybSB0aGUgbGluayBpcyBhIHNpZ24taW4gZW1haWwgbGluayBiZWZvcmUgY2FsbGluZyB0aGlzIG1ldGhvZCBmaXJlYmFzZS5hdXRoLkF1dGguaXNTaWduSW5XaXRoRW1haWxMaW5rLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiBjb25zdCBhY3Rpb25Db2RlU2V0dGluZ3MgPSB7XG4gKiAgIHVybDogJ2h0dHBzOi8vd3d3LmV4YW1wbGUuY29tLz9lbWFpbD11c2VyQGV4YW1wbGUuY29tJyxcbiAqICAgaU9TOiB7XG4gKiAgICAgIGJ1bmRsZUlkOiAnY29tLmV4YW1wbGUuaW9zJ1xuICogICB9LFxuICogICBhbmRyb2lkOiB7XG4gKiAgICAgcGFja2FnZU5hbWU6ICdjb20uZXhhbXBsZS5hbmRyb2lkJyxcbiAqICAgICBpbnN0YWxsQXBwOiB0cnVlLFxuICogICAgIG1pbmltdW1WZXJzaW9uOiAnMTInXG4gKiAgIH0sXG4gKiAgIGhhbmRsZUNvZGVJbkFwcDogdHJ1ZVxuICogfTtcbiAqIGF3YWl0IHNlbmRTaWduSW5MaW5rVG9FbWFpbChhdXRoLCAndXNlckBleGFtcGxlLmNvbScsIGFjdGlvbkNvZGVTZXR0aW5ncyk7XG4gKiAvLyBPYnRhaW4gZW1haWxMaW5rIGZyb20gdGhlIHVzZXIuXG4gKiBpZihpc1NpZ25JbldpdGhFbWFpbExpbmsoYXV0aCwgZW1haWxMaW5rKSkge1xuICogICBhd2FpdCBzaWduSW5XaXRoRW1haWxMaW5rKGF1dGgsICd1c2VyQGV4YW1wbGUuY29tJywgZW1haWxMaW5rKTtcbiAqIH1cbiAqIGBgYFxuICpcbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gZW1haWwgLSBUaGUgdXNlcidzIGVtYWlsIGFkZHJlc3MuXG4gKiBAcGFyYW0gZW1haWxMaW5rIC0gVGhlIGxpbmsgc2VudCB0byB0aGUgdXNlcidzIGVtYWlsIGFkZHJlc3MuXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoRW1haWxMaW5rKGF1dGgsIGVtYWlsLCBlbWFpbExpbmspIHtcbiAgICBpZiAoX2lzRmlyZWJhc2VTZXJ2ZXJBcHAoYXV0aC5hcHApKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChfc2VydmVyQXBwQ3VycmVudFVzZXJPcGVyYXRpb25Ob3RTdXBwb3J0ZWRFcnJvcihhdXRoKSk7XG4gICAgfVxuICAgIGNvbnN0IGF1dGhNb2R1bGFyID0gZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpO1xuICAgIGNvbnN0IGNyZWRlbnRpYWwgPSBFbWFpbEF1dGhQcm92aWRlci5jcmVkZW50aWFsV2l0aExpbmsoZW1haWwsIGVtYWlsTGluayB8fCBfZ2V0Q3VycmVudFVybCgpKTtcbiAgICAvLyBDaGVjayBpZiB0aGUgdGVuYW50IElEIGluIHRoZSBlbWFpbCBsaW5rIG1hdGNoZXMgdGhlIHRlbmFudCBJRCBvbiBBdXRoXG4gICAgLy8gaW5zdGFuY2UuXG4gICAgX2Fzc2VydChjcmVkZW50aWFsLl90ZW5hbnRJZCA9PT0gKGF1dGhNb2R1bGFyLnRlbmFudElkIHx8IG51bGwpLCBhdXRoTW9kdWxhciwgXCJ0ZW5hbnQtaWQtbWlzbWF0Y2hcIiAvKiBBdXRoRXJyb3JDb2RlLlRFTkFOVF9JRF9NSVNNQVRDSCAqLyk7XG4gICAgcmV0dXJuIHNpZ25JbldpdGhDcmVkZW50aWFsKGF1dGhNb2R1bGFyLCBjcmVkZW50aWFsKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUF1dGhVcmkoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92MS9hY2NvdW50czpjcmVhdGVBdXRoVXJpXCIgLyogRW5kcG9pbnQuQ1JFQVRFX0FVVEhfVVJJICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBHZXRzIHRoZSBsaXN0IG9mIHBvc3NpYmxlIHNpZ24gaW4gbWV0aG9kcyBmb3IgdGhlIGdpdmVuIGVtYWlsIGFkZHJlc3MuIFRoaXMgbWV0aG9kIHJldHVybnMgYW5cbiAqIGVtcHR5IGxpc3Qgd2hlblxuICoge0BsaW5rIGh0dHBzOi8vY2xvdWQuZ29vZ2xlLmNvbS9pZGVudGl0eS1wbGF0Zm9ybS9kb2NzL2FkbWluL2VtYWlsLWVudW1lcmF0aW9uLXByb3RlY3Rpb24gfCBFbWFpbCBFbnVtZXJhdGlvbiBQcm90ZWN0aW9ufVxuICogaXMgZW5hYmxlZCwgaXJyZXNwZWN0aXZlIG9mIHRoZSBudW1iZXIgb2YgYXV0aGVudGljYXRpb24gbWV0aG9kcyBhdmFpbGFibGUgZm9yIHRoZSBnaXZlbiBlbWFpbC5cbiAqXG4gKiBAcmVtYXJrc1xuICogVGhpcyBpcyB1c2VmdWwgdG8gZGlmZmVyZW50aWF0ZSBtZXRob2RzIG9mIHNpZ24taW4gZm9yIHRoZSBzYW1lIHByb3ZpZGVyLCBlZy5cbiAqIHtAbGluayBFbWFpbEF1dGhQcm92aWRlcn0gd2hpY2ggaGFzIDIgbWV0aG9kcyBvZiBzaWduLWluLFxuICoge0BsaW5rIFNpZ25Jbk1ldGhvZH0uRU1BSUxfUEFTU1dPUkQgYW5kXG4gKiB7QGxpbmsgU2lnbkluTWV0aG9kfS5FTUFJTF9MSU5LLlxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSBlbWFpbCAtIFRoZSB1c2VyJ3MgZW1haWwgYWRkcmVzcy5cbiAqXG4gKiBEZXByZWNhdGVkLiBNaWdyYXRpbmcgb2ZmIG9mIHRoaXMgbWV0aG9kIGlzIHJlY29tbWVuZGVkIGFzIGEgc2VjdXJpdHkgYmVzdC1wcmFjdGljZS5cbiAqIExlYXJuIG1vcmUgaW4gdGhlIElkZW50aXR5IFBsYXRmb3JtIGRvY3VtZW50YXRpb24gZm9yXG4gKiB7QGxpbmsgaHR0cHM6Ly9jbG91ZC5nb29nbGUuY29tL2lkZW50aXR5LXBsYXRmb3JtL2RvY3MvYWRtaW4vZW1haWwtZW51bWVyYXRpb24tcHJvdGVjdGlvbiB8IEVtYWlsIEVudW1lcmF0aW9uIFByb3RlY3Rpb259LlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiBmZXRjaFNpZ25Jbk1ldGhvZHNGb3JFbWFpbChhdXRoLCBlbWFpbCkge1xuICAgIC8vIGNyZWF0ZUF1dGhVcmkgcmV0dXJucyBhbiBlcnJvciBpZiBjb250aW51ZSBVUkkgaXMgbm90IGh0dHAgb3IgaHR0cHMuXG4gICAgLy8gRm9yIGVudmlyb25tZW50cyBsaWtlIENvcmRvdmEsIENocm9tZSBleHRlbnNpb25zLCBuYXRpdmUgZnJhbWV3b3JrcywgZmlsZVxuICAgIC8vIHN5c3RlbXMsIGV0YywgdXNlIGh0dHA6Ly9sb2NhbGhvc3QgYXMgY29udGludWUgVVJMLlxuICAgIGNvbnN0IGNvbnRpbnVlVXJpID0gX2lzSHR0cE9ySHR0cHMoKSA/IF9nZXRDdXJyZW50VXJsKCkgOiAnaHR0cDovL2xvY2FsaG9zdCc7XG4gICAgY29uc3QgcmVxdWVzdCA9IHtcbiAgICAgICAgaWRlbnRpZmllcjogZW1haWwsXG4gICAgICAgIGNvbnRpbnVlVXJpXG4gICAgfTtcbiAgICBjb25zdCB7IHNpZ25pbk1ldGhvZHMgfSA9IGF3YWl0IGNyZWF0ZUF1dGhVcmkoZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLCByZXF1ZXN0KTtcbiAgICByZXR1cm4gc2lnbmluTWV0aG9kcyB8fCBbXTtcbn1cbi8qKlxuICogU2VuZHMgYSB2ZXJpZmljYXRpb24gZW1haWwgdG8gYSB1c2VyLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUaGUgdmVyaWZpY2F0aW9uIHByb2Nlc3MgaXMgY29tcGxldGVkIGJ5IGNhbGxpbmcge0BsaW5rIGFwcGx5QWN0aW9uQ29kZX0uXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIGNvbnN0IGFjdGlvbkNvZGVTZXR0aW5ncyA9IHtcbiAqICAgdXJsOiAnaHR0cHM6Ly93d3cuZXhhbXBsZS5jb20vP2VtYWlsPXVzZXJAZXhhbXBsZS5jb20nLFxuICogICBpT1M6IHtcbiAqICAgICAgYnVuZGxlSWQ6ICdjb20uZXhhbXBsZS5pb3MnXG4gKiAgIH0sXG4gKiAgIGFuZHJvaWQ6IHtcbiAqICAgICBwYWNrYWdlTmFtZTogJ2NvbS5leGFtcGxlLmFuZHJvaWQnLFxuICogICAgIGluc3RhbGxBcHA6IHRydWUsXG4gKiAgICAgbWluaW11bVZlcnNpb246ICcxMidcbiAqICAgfSxcbiAqICAgaGFuZGxlQ29kZUluQXBwOiB0cnVlXG4gKiB9O1xuICogYXdhaXQgc2VuZEVtYWlsVmVyaWZpY2F0aW9uKHVzZXIsIGFjdGlvbkNvZGVTZXR0aW5ncyk7XG4gKiAvLyBPYnRhaW4gY29kZSBmcm9tIHRoZSB1c2VyLlxuICogYXdhaXQgYXBwbHlBY3Rpb25Db2RlKGF1dGgsIGNvZGUpO1xuICogYGBgXG4gKlxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cbiAqIEBwYXJhbSBhY3Rpb25Db2RlU2V0dGluZ3MgLSBUaGUge0BsaW5rIEFjdGlvbkNvZGVTZXR0aW5nc30uXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiBzZW5kRW1haWxWZXJpZmljYXRpb24odXNlciwgYWN0aW9uQ29kZVNldHRpbmdzKSB7XG4gICAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpO1xuICAgIGNvbnN0IGlkVG9rZW4gPSBhd2FpdCB1c2VyLmdldElkVG9rZW4oKTtcbiAgICBjb25zdCByZXF1ZXN0ID0ge1xuICAgICAgICByZXF1ZXN0VHlwZTogXCJWRVJJRllfRU1BSUxcIiAvKiBBY3Rpb25Db2RlT3BlcmF0aW9uLlZFUklGWV9FTUFJTCAqLyxcbiAgICAgICAgaWRUb2tlblxuICAgIH07XG4gICAgaWYgKGFjdGlvbkNvZGVTZXR0aW5ncykge1xuICAgICAgICBfc2V0QWN0aW9uQ29kZVNldHRpbmdzT25SZXF1ZXN0KHVzZXJJbnRlcm5hbC5hdXRoLCByZXF1ZXN0LCBhY3Rpb25Db2RlU2V0dGluZ3MpO1xuICAgIH1cbiAgICBjb25zdCB7IGVtYWlsIH0gPSBhd2FpdCBzZW5kRW1haWxWZXJpZmljYXRpb24kMSh1c2VySW50ZXJuYWwuYXV0aCwgcmVxdWVzdCk7XG4gICAgaWYgKGVtYWlsICE9PSB1c2VyLmVtYWlsKSB7XG4gICAgICAgIGF3YWl0IHVzZXIucmVsb2FkKCk7XG4gICAgfVxufVxuLyoqXG4gKiBTZW5kcyBhIHZlcmlmaWNhdGlvbiBlbWFpbCB0byBhIG5ldyBlbWFpbCBhZGRyZXNzLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUaGUgdXNlcidzIGVtYWlsIHdpbGwgYmUgdXBkYXRlZCB0byB0aGUgbmV3IG9uZSBhZnRlciBiZWluZyB2ZXJpZmllZC5cbiAqXG4gKiBJZiB5b3UgaGF2ZSBhIGN1c3RvbSBlbWFpbCBhY3Rpb24gaGFuZGxlciwgeW91IGNhbiBjb21wbGV0ZSB0aGUgdmVyaWZpY2F0aW9uIHByb2Nlc3MgYnkgY2FsbGluZ1xuICoge0BsaW5rIGFwcGx5QWN0aW9uQ29kZX0uXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIGNvbnN0IGFjdGlvbkNvZGVTZXR0aW5ncyA9IHtcbiAqICAgdXJsOiAnaHR0cHM6Ly93d3cuZXhhbXBsZS5jb20vP2VtYWlsPXVzZXJAZXhhbXBsZS5jb20nLFxuICogICBpT1M6IHtcbiAqICAgICAgYnVuZGxlSWQ6ICdjb20uZXhhbXBsZS5pb3MnXG4gKiAgIH0sXG4gKiAgIGFuZHJvaWQ6IHtcbiAqICAgICBwYWNrYWdlTmFtZTogJ2NvbS5leGFtcGxlLmFuZHJvaWQnLFxuICogICAgIGluc3RhbGxBcHA6IHRydWUsXG4gKiAgICAgbWluaW11bVZlcnNpb246ICcxMidcbiAqICAgfSxcbiAqICAgaGFuZGxlQ29kZUluQXBwOiB0cnVlXG4gKiB9O1xuICogYXdhaXQgdmVyaWZ5QmVmb3JlVXBkYXRlRW1haWwodXNlciwgJ25ld2VtYWlsQGV4YW1wbGUuY29tJywgYWN0aW9uQ29kZVNldHRpbmdzKTtcbiAqIC8vIE9idGFpbiBjb2RlIGZyb20gdGhlIHVzZXIuXG4gKiBhd2FpdCBhcHBseUFjdGlvbkNvZGUoYXV0aCwgY29kZSk7XG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxuICogQHBhcmFtIG5ld0VtYWlsIC0gVGhlIG5ldyBlbWFpbCBhZGRyZXNzIHRvIGJlIHZlcmlmaWVkIGJlZm9yZSB1cGRhdGUuXG4gKiBAcGFyYW0gYWN0aW9uQ29kZVNldHRpbmdzIC0gVGhlIHtAbGluayBBY3Rpb25Db2RlU2V0dGluZ3N9LlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gdmVyaWZ5QmVmb3JlVXBkYXRlRW1haWwodXNlciwgbmV3RW1haWwsIGFjdGlvbkNvZGVTZXR0aW5ncykge1xuICAgIGNvbnN0IHVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKTtcbiAgICBjb25zdCBpZFRva2VuID0gYXdhaXQgdXNlci5nZXRJZFRva2VuKCk7XG4gICAgY29uc3QgcmVxdWVzdCA9IHtcbiAgICAgICAgcmVxdWVzdFR5cGU6IFwiVkVSSUZZX0FORF9DSEFOR0VfRU1BSUxcIiAvKiBBY3Rpb25Db2RlT3BlcmF0aW9uLlZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMICovLFxuICAgICAgICBpZFRva2VuLFxuICAgICAgICBuZXdFbWFpbFxuICAgIH07XG4gICAgaWYgKGFjdGlvbkNvZGVTZXR0aW5ncykge1xuICAgICAgICBfc2V0QWN0aW9uQ29kZVNldHRpbmdzT25SZXF1ZXN0KHVzZXJJbnRlcm5hbC5hdXRoLCByZXF1ZXN0LCBhY3Rpb25Db2RlU2V0dGluZ3MpO1xuICAgIH1cbiAgICBjb25zdCB7IGVtYWlsIH0gPSBhd2FpdCB2ZXJpZnlBbmRDaGFuZ2VFbWFpbCh1c2VySW50ZXJuYWwuYXV0aCwgcmVxdWVzdCk7XG4gICAgaWYgKGVtYWlsICE9PSB1c2VyLmVtYWlsKSB7XG4gICAgICAgIC8vIElmIHRoZSBsb2NhbCBjb3B5IG9mIHRoZSBlbWFpbCBvbiB1c2VyIGlzIG91dGRhdGVkLCByZWxvYWQgdGhlXG4gICAgICAgIC8vIHVzZXIuXG4gICAgICAgIGF3YWl0IHVzZXIucmVsb2FkKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gdXBkYXRlUHJvZmlsZSQxKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6dXBkYXRlXCIgLyogRW5kcG9pbnQuU0VUX0FDQ09VTlRfSU5GTyAqLywgcmVxdWVzdCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFVwZGF0ZXMgYSB1c2VyJ3MgcHJvZmlsZSBkYXRhLlxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gcHJvZmlsZSAtIFRoZSBwcm9maWxlJ3MgYGRpc3BsYXlOYW1lYCBhbmQgYHBob3RvVVJMYCB0byB1cGRhdGUuXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9maWxlKHVzZXIsIHsgZGlzcGxheU5hbWUsIHBob3RvVVJMOiBwaG90b1VybCB9KSB7XG4gICAgaWYgKGRpc3BsYXlOYW1lID09PSB1bmRlZmluZWQgJiYgcGhvdG9VcmwgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKTtcbiAgICBjb25zdCBpZFRva2VuID0gYXdhaXQgdXNlckludGVybmFsLmdldElkVG9rZW4oKTtcbiAgICBjb25zdCBwcm9maWxlUmVxdWVzdCA9IHtcbiAgICAgICAgaWRUb2tlbixcbiAgICAgICAgZGlzcGxheU5hbWUsXG4gICAgICAgIHBob3RvVXJsLFxuICAgICAgICByZXR1cm5TZWN1cmVUb2tlbjogdHJ1ZVxuICAgIH07XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBfbG9nb3V0SWZJbnZhbGlkYXRlZCh1c2VySW50ZXJuYWwsIHVwZGF0ZVByb2ZpbGUkMSh1c2VySW50ZXJuYWwuYXV0aCwgcHJvZmlsZVJlcXVlc3QpKTtcbiAgICB1c2VySW50ZXJuYWwuZGlzcGxheU5hbWUgPSByZXNwb25zZS5kaXNwbGF5TmFtZSB8fCBudWxsO1xuICAgIHVzZXJJbnRlcm5hbC5waG90b1VSTCA9IHJlc3BvbnNlLnBob3RvVXJsIHx8IG51bGw7XG4gICAgLy8gVXBkYXRlIHRoZSBwYXNzd29yZCBwcm92aWRlciBhcyB3ZWxsXG4gICAgY29uc3QgcGFzc3dvcmRQcm92aWRlciA9IHVzZXJJbnRlcm5hbC5wcm92aWRlckRhdGEuZmluZCgoeyBwcm92aWRlcklkIH0pID0+IHByb3ZpZGVySWQgPT09IFwicGFzc3dvcmRcIiAvKiBQcm92aWRlcklkLlBBU1NXT1JEICovKTtcbiAgICBpZiAocGFzc3dvcmRQcm92aWRlcikge1xuICAgICAgICBwYXNzd29yZFByb3ZpZGVyLmRpc3BsYXlOYW1lID0gdXNlckludGVybmFsLmRpc3BsYXlOYW1lO1xuICAgICAgICBwYXNzd29yZFByb3ZpZGVyLnBob3RvVVJMID0gdXNlckludGVybmFsLnBob3RvVVJMO1xuICAgIH1cbiAgICBhd2FpdCB1c2VySW50ZXJuYWwuX3VwZGF0ZVRva2Vuc0lmTmVjZXNzYXJ5KHJlc3BvbnNlKTtcbn1cbi8qKlxuICogVXBkYXRlcyB0aGUgdXNlcidzIGVtYWlsIGFkZHJlc3MuXG4gKlxuICogQHJlbWFya3NcbiAqIEFuIGVtYWlsIHdpbGwgYmUgc2VudCB0byB0aGUgb3JpZ2luYWwgZW1haWwgYWRkcmVzcyAoaWYgaXQgd2FzIHNldCkgdGhhdCBhbGxvd3MgdG8gcmV2b2tlIHRoZVxuICogZW1haWwgYWRkcmVzcyBjaGFuZ2UsIGluIG9yZGVyIHRvIHByb3RlY3QgdGhlbSBmcm9tIGFjY291bnQgaGlqYWNraW5nLlxuICpcbiAqIFRoaXMgbWV0aG9kIGlzIG5vdCBzdXBwb3J0ZWQgb24gYW55IHtAbGluayBVc2VyfSBzaWduZWQgaW4gYnkge0BsaW5rIEF1dGh9IGluc3RhbmNlc1xuICogY3JlYXRlZCB3aXRoIGEge0BsaW5rIEBmaXJlYmFzZS9hcHAjRmlyZWJhc2VTZXJ2ZXJBcHB9LlxuICpcbiAqIEltcG9ydGFudDogdGhpcyBpcyBhIHNlY3VyaXR5IHNlbnNpdGl2ZSBvcGVyYXRpb24gdGhhdCByZXF1aXJlcyB0aGUgdXNlciB0byBoYXZlIHJlY2VudGx5IHNpZ25lZFxuICogaW4uIElmIHRoaXMgcmVxdWlyZW1lbnQgaXNuJ3QgbWV0LCBhc2sgdGhlIHVzZXIgdG8gYXV0aGVudGljYXRlIGFnYWluIGFuZCB0aGVuIGNhbGxcbiAqIHtAbGluayByZWF1dGhlbnRpY2F0ZVdpdGhDcmVkZW50aWFsfS5cbiAqXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxuICogQHBhcmFtIG5ld0VtYWlsIC0gVGhlIG5ldyBlbWFpbCBhZGRyZXNzLlxuICpcbiAqIFRocm93cyBcImF1dGgvb3BlcmF0aW9uLW5vdC1hbGxvd2VkXCIgZXJyb3Igd2hlblxuICoge0BsaW5rIGh0dHBzOi8vY2xvdWQuZ29vZ2xlLmNvbS9pZGVudGl0eS1wbGF0Zm9ybS9kb2NzL2FkbWluL2VtYWlsLWVudW1lcmF0aW9uLXByb3RlY3Rpb24gfCBFbWFpbCBFbnVtZXJhdGlvbiBQcm90ZWN0aW9ufVxuICogaXMgZW5hYmxlZC5cbiAqIERlcHJlY2F0ZWQgLSBVc2Uge0BsaW5rIHZlcmlmeUJlZm9yZVVwZGF0ZUVtYWlsfSBpbnN0ZWFkLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZnVuY3Rpb24gdXBkYXRlRW1haWwodXNlciwgbmV3RW1haWwpIHtcbiAgICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcik7XG4gICAgaWYgKF9pc0ZpcmViYXNlU2VydmVyQXBwKHVzZXJJbnRlcm5hbC5hdXRoLmFwcCkpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KF9zZXJ2ZXJBcHBDdXJyZW50VXNlck9wZXJhdGlvbk5vdFN1cHBvcnRlZEVycm9yKHVzZXJJbnRlcm5hbC5hdXRoKSk7XG4gICAgfVxuICAgIHJldHVybiB1cGRhdGVFbWFpbE9yUGFzc3dvcmQodXNlckludGVybmFsLCBuZXdFbWFpbCwgbnVsbCk7XG59XG4vKipcbiAqIFVwZGF0ZXMgdGhlIHVzZXIncyBwYXNzd29yZC5cbiAqXG4gKiBAcmVtYXJrc1xuICogSW1wb3J0YW50OiB0aGlzIGlzIGEgc2VjdXJpdHkgc2Vuc2l0aXZlIG9wZXJhdGlvbiB0aGF0IHJlcXVpcmVzIHRoZSB1c2VyIHRvIGhhdmUgcmVjZW50bHkgc2lnbmVkXG4gKiBpbi4gSWYgdGhpcyByZXF1aXJlbWVudCBpc24ndCBtZXQsIGFzayB0aGUgdXNlciB0byBhdXRoZW50aWNhdGUgYWdhaW4gYW5kIHRoZW4gY2FsbFxuICoge0BsaW5rIHJlYXV0aGVudGljYXRlV2l0aENyZWRlbnRpYWx9LlxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gbmV3UGFzc3dvcmQgLSBUaGUgbmV3IHBhc3N3b3JkLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZnVuY3Rpb24gdXBkYXRlUGFzc3dvcmQodXNlciwgbmV3UGFzc3dvcmQpIHtcbiAgICByZXR1cm4gdXBkYXRlRW1haWxPclBhc3N3b3JkKGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKSwgbnVsbCwgbmV3UGFzc3dvcmQpO1xufVxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlRW1haWxPclBhc3N3b3JkKHVzZXIsIGVtYWlsLCBwYXNzd29yZCkge1xuICAgIGNvbnN0IHsgYXV0aCB9ID0gdXNlcjtcbiAgICBjb25zdCBpZFRva2VuID0gYXdhaXQgdXNlci5nZXRJZFRva2VuKCk7XG4gICAgY29uc3QgcmVxdWVzdCA9IHtcbiAgICAgICAgaWRUb2tlbixcbiAgICAgICAgcmV0dXJuU2VjdXJlVG9rZW46IHRydWVcbiAgICB9O1xuICAgIGlmIChlbWFpbCkge1xuICAgICAgICByZXF1ZXN0LmVtYWlsID0gZW1haWw7XG4gICAgfVxuICAgIGlmIChwYXNzd29yZCkge1xuICAgICAgICByZXF1ZXN0LnBhc3N3b3JkID0gcGFzc3dvcmQ7XG4gICAgfVxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgX2xvZ291dElmSW52YWxpZGF0ZWQodXNlciwgdXBkYXRlRW1haWxQYXNzd29yZChhdXRoLCByZXF1ZXN0KSk7XG4gICAgYXdhaXQgdXNlci5fdXBkYXRlVG9rZW5zSWZOZWNlc3NhcnkocmVzcG9uc2UsIC8qIHJlbG9hZCAqLyB0cnVlKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUGFyc2UgdGhlIGBBZGRpdGlvbmFsVXNlckluZm9gIGZyb20gdGhlIElEIHRva2VuIHJlc3BvbnNlLlxuICpcbiAqL1xuZnVuY3Rpb24gX2Zyb21JZFRva2VuUmVzcG9uc2UoaWRUb2tlblJlc3BvbnNlKSB7XG4gICAgaWYgKCFpZFRva2VuUmVzcG9uc2UpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IHsgcHJvdmlkZXJJZCB9ID0gaWRUb2tlblJlc3BvbnNlO1xuICAgIGNvbnN0IHByb2ZpbGUgPSBpZFRva2VuUmVzcG9uc2UucmF3VXNlckluZm9cbiAgICAgICAgPyBKU09OLnBhcnNlKGlkVG9rZW5SZXNwb25zZS5yYXdVc2VySW5mbylcbiAgICAgICAgOiB7fTtcbiAgICBjb25zdCBpc05ld1VzZXIgPSBpZFRva2VuUmVzcG9uc2UuaXNOZXdVc2VyIHx8XG4gICAgICAgIGlkVG9rZW5SZXNwb25zZS5raW5kID09PSBcImlkZW50aXR5dG9vbGtpdCNTaWdudXBOZXdVc2VyUmVzcG9uc2VcIiAvKiBJZFRva2VuUmVzcG9uc2VLaW5kLlNpZ251cE5ld1VzZXIgKi87XG4gICAgaWYgKCFwcm92aWRlcklkICYmIGlkVG9rZW5SZXNwb25zZT8uaWRUb2tlbikge1xuICAgICAgICBjb25zdCBzaWduSW5Qcm92aWRlciA9IF9wYXJzZVRva2VuKGlkVG9rZW5SZXNwb25zZS5pZFRva2VuKT8uZmlyZWJhc2U/Llsnc2lnbl9pbl9wcm92aWRlciddO1xuICAgICAgICBpZiAoc2lnbkluUHJvdmlkZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IGZpbHRlcmVkUHJvdmlkZXJJZCA9IHNpZ25JblByb3ZpZGVyICE9PSBcImFub255bW91c1wiIC8qIFByb3ZpZGVySWQuQU5PTllNT1VTICovICYmXG4gICAgICAgICAgICAgICAgc2lnbkluUHJvdmlkZXIgIT09IFwiY3VzdG9tXCIgLyogUHJvdmlkZXJJZC5DVVNUT00gKi9cbiAgICAgICAgICAgICAgICA/IHNpZ25JblByb3ZpZGVyXG4gICAgICAgICAgICAgICAgOiBudWxsO1xuICAgICAgICAgICAgLy8gVXNlcyBnZW5lcmljIGNsYXNzIGluIGFjY29yZGFuY2Ugd2l0aCB0aGUgbGVnYWN5IFNESy5cbiAgICAgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0FkZGl0aW9uYWxVc2VySW5mbyhpc05ld1VzZXIsIGZpbHRlcmVkUHJvdmlkZXJJZCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFwcm92aWRlcklkKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBzd2l0Y2ggKHByb3ZpZGVySWQpIHtcbiAgICAgICAgY2FzZSBcImZhY2Vib29rLmNvbVwiIC8qIFByb3ZpZGVySWQuRkFDRUJPT0sgKi86XG4gICAgICAgICAgICByZXR1cm4gbmV3IEZhY2Vib29rQWRkaXRpb25hbFVzZXJJbmZvKGlzTmV3VXNlciwgcHJvZmlsZSk7XG4gICAgICAgIGNhc2UgXCJnaXRodWIuY29tXCIgLyogUHJvdmlkZXJJZC5HSVRIVUIgKi86XG4gICAgICAgICAgICByZXR1cm4gbmV3IEdpdGh1YkFkZGl0aW9uYWxVc2VySW5mbyhpc05ld1VzZXIsIHByb2ZpbGUpO1xuICAgICAgICBjYXNlIFwiZ29vZ2xlLmNvbVwiIC8qIFByb3ZpZGVySWQuR09PR0xFICovOlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBHb29nbGVBZGRpdGlvbmFsVXNlckluZm8oaXNOZXdVc2VyLCBwcm9maWxlKTtcbiAgICAgICAgY2FzZSBcInR3aXR0ZXIuY29tXCIgLyogUHJvdmlkZXJJZC5UV0lUVEVSICovOlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBUd2l0dGVyQWRkaXRpb25hbFVzZXJJbmZvKGlzTmV3VXNlciwgcHJvZmlsZSwgaWRUb2tlblJlc3BvbnNlLnNjcmVlbk5hbWUgfHwgbnVsbCk7XG4gICAgICAgIGNhc2UgXCJjdXN0b21cIiAvKiBQcm92aWRlcklkLkNVU1RPTSAqLzpcbiAgICAgICAgY2FzZSBcImFub255bW91c1wiIC8qIFByb3ZpZGVySWQuQU5PTllNT1VTICovOlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmljQWRkaXRpb25hbFVzZXJJbmZvKGlzTmV3VXNlciwgbnVsbCk7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gbmV3IEdlbmVyaWNBZGRpdGlvbmFsVXNlckluZm8oaXNOZXdVc2VyLCBwcm92aWRlcklkLCBwcm9maWxlKTtcbiAgICB9XG59XG5jbGFzcyBHZW5lcmljQWRkaXRpb25hbFVzZXJJbmZvIHtcbiAgICBjb25zdHJ1Y3Rvcihpc05ld1VzZXIsIHByb3ZpZGVySWQsIHByb2ZpbGUgPSB7fSkge1xuICAgICAgICB0aGlzLmlzTmV3VXNlciA9IGlzTmV3VXNlcjtcbiAgICAgICAgdGhpcy5wcm92aWRlcklkID0gcHJvdmlkZXJJZDtcbiAgICAgICAgdGhpcy5wcm9maWxlID0gcHJvZmlsZTtcbiAgICB9XG59XG5jbGFzcyBGZWRlcmF0ZWRBZGRpdGlvbmFsVXNlckluZm9XaXRoVXNlcm5hbWUgZXh0ZW5kcyBHZW5lcmljQWRkaXRpb25hbFVzZXJJbmZvIHtcbiAgICBjb25zdHJ1Y3Rvcihpc05ld1VzZXIsIHByb3ZpZGVySWQsIHByb2ZpbGUsIHVzZXJuYW1lKSB7XG4gICAgICAgIHN1cGVyKGlzTmV3VXNlciwgcHJvdmlkZXJJZCwgcHJvZmlsZSk7XG4gICAgICAgIHRoaXMudXNlcm5hbWUgPSB1c2VybmFtZTtcbiAgICB9XG59XG5jbGFzcyBGYWNlYm9va0FkZGl0aW9uYWxVc2VySW5mbyBleHRlbmRzIEdlbmVyaWNBZGRpdGlvbmFsVXNlckluZm8ge1xuICAgIGNvbnN0cnVjdG9yKGlzTmV3VXNlciwgcHJvZmlsZSkge1xuICAgICAgICBzdXBlcihpc05ld1VzZXIsIFwiZmFjZWJvb2suY29tXCIgLyogUHJvdmlkZXJJZC5GQUNFQk9PSyAqLywgcHJvZmlsZSk7XG4gICAgfVxufVxuY2xhc3MgR2l0aHViQWRkaXRpb25hbFVzZXJJbmZvIGV4dGVuZHMgRmVkZXJhdGVkQWRkaXRpb25hbFVzZXJJbmZvV2l0aFVzZXJuYW1lIHtcbiAgICBjb25zdHJ1Y3Rvcihpc05ld1VzZXIsIHByb2ZpbGUpIHtcbiAgICAgICAgc3VwZXIoaXNOZXdVc2VyLCBcImdpdGh1Yi5jb21cIiAvKiBQcm92aWRlcklkLkdJVEhVQiAqLywgcHJvZmlsZSwgdHlwZW9mIHByb2ZpbGU/LmxvZ2luID09PSAnc3RyaW5nJyA/IHByb2ZpbGU/LmxvZ2luIDogbnVsbCk7XG4gICAgfVxufVxuY2xhc3MgR29vZ2xlQWRkaXRpb25hbFVzZXJJbmZvIGV4dGVuZHMgR2VuZXJpY0FkZGl0aW9uYWxVc2VySW5mbyB7XG4gICAgY29uc3RydWN0b3IoaXNOZXdVc2VyLCBwcm9maWxlKSB7XG4gICAgICAgIHN1cGVyKGlzTmV3VXNlciwgXCJnb29nbGUuY29tXCIgLyogUHJvdmlkZXJJZC5HT09HTEUgKi8sIHByb2ZpbGUpO1xuICAgIH1cbn1cbmNsYXNzIFR3aXR0ZXJBZGRpdGlvbmFsVXNlckluZm8gZXh0ZW5kcyBGZWRlcmF0ZWRBZGRpdGlvbmFsVXNlckluZm9XaXRoVXNlcm5hbWUge1xuICAgIGNvbnN0cnVjdG9yKGlzTmV3VXNlciwgcHJvZmlsZSwgc2NyZWVuTmFtZSkge1xuICAgICAgICBzdXBlcihpc05ld1VzZXIsIFwidHdpdHRlci5jb21cIiAvKiBQcm92aWRlcklkLlRXSVRURVIgKi8sIHByb2ZpbGUsIHNjcmVlbk5hbWUpO1xuICAgIH1cbn1cbi8qKlxuICogRXh0cmFjdHMgcHJvdmlkZXIgc3BlY2lmaWMge0BsaW5rIEFkZGl0aW9uYWxVc2VySW5mb30gZm9yIHRoZSBnaXZlbiBjcmVkZW50aWFsLlxuICpcbiAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXG4gKlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiBnZXRBZGRpdGlvbmFsVXNlckluZm8odXNlckNyZWRlbnRpYWwpIHtcbiAgICBjb25zdCB7IHVzZXIsIF90b2tlblJlc3BvbnNlIH0gPSB1c2VyQ3JlZGVudGlhbDtcbiAgICBpZiAodXNlci5pc0Fub255bW91cyAmJiAhX3Rva2VuUmVzcG9uc2UpIHtcbiAgICAgICAgLy8gSGFuZGxlIHRoZSBzcGVjaWFsIGNhc2Ugd2hlcmUgc2lnbkluQW5vbnltb3VzbHkoKSBnZXRzIGNhbGxlZCB0d2ljZS5cbiAgICAgICAgLy8gTm8gbmV0d29yayBjYWxsIGlzIG1hZGUgc28gdGhlcmUncyBub3RoaW5nIHRvIGFjdHVhbGx5IGZpbGwgdGhpcyBpblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcHJvdmlkZXJJZDogbnVsbCxcbiAgICAgICAgICAgIGlzTmV3VXNlcjogZmFsc2UsXG4gICAgICAgICAgICBwcm9maWxlOiBudWxsXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBfZnJvbUlkVG9rZW5SZXNwb25zZShfdG9rZW5SZXNwb25zZSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBOb24tb3B0aW9uYWwgYXV0aCBtZXRob2RzLlxuLyoqXG4gKiBDaGFuZ2VzIHRoZSB0eXBlIG9mIHBlcnNpc3RlbmNlIG9uIHRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UgZm9yIHRoZSBjdXJyZW50bHkgc2F2ZWRcbiAqIGBBdXRoYCBzZXNzaW9uIGFuZCBhcHBsaWVzIHRoaXMgdHlwZSBvZiBwZXJzaXN0ZW5jZSBmb3IgZnV0dXJlIHNpZ24taW4gcmVxdWVzdHMsIGluY2x1ZGluZ1xuICogc2lnbi1pbiB3aXRoIHJlZGlyZWN0IHJlcXVlc3RzLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUaGlzIG1ha2VzIGl0IGVhc3kgZm9yIGEgdXNlciBzaWduaW5nIGluIHRvIHNwZWNpZnkgd2hldGhlciB0aGVpciBzZXNzaW9uIHNob3VsZCBiZVxuICogcmVtZW1iZXJlZCBvciBub3QuIEl0IGFsc28gbWFrZXMgaXQgZWFzaWVyIHRvIG5ldmVyIHBlcnNpc3QgdGhlIGBBdXRoYCBzdGF0ZSBmb3IgYXBwbGljYXRpb25zXG4gKiB0aGF0IGFyZSBzaGFyZWQgYnkgb3RoZXIgdXNlcnMgb3IgaGF2ZSBzZW5zaXRpdmUgZGF0YS5cbiAqXG4gKiBUaGlzIG1ldGhvZCBkb2VzIG5vdCB3b3JrIGluIGEgTm9kZS5qcyBlbnZpcm9ubWVudCBvciB3aXRoIHtAbGluayBBdXRofSBpbnN0YW5jZXMgY3JlYXRlZCB3aXRoIGFcbiAqIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlU2VydmVyQXBwfS5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogc2V0UGVyc2lzdGVuY2UoYXV0aCwgYnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZSk7XG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gcGVyc2lzdGVuY2UgLSBUaGUge0BsaW5rIFBlcnNpc3RlbmNlfSB0byB1c2UuXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IHJlc29sdmVzIG9uY2UgdGhlIHBlcnNpc3RlbmNlIGNoYW5nZSBoYXMgY29tcGxldGVkXG4gKlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiBzZXRQZXJzaXN0ZW5jZShhdXRoLCBwZXJzaXN0ZW5jZSkge1xuICAgIHJldHVybiBnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCkuc2V0UGVyc2lzdGVuY2UocGVyc2lzdGVuY2UpO1xufVxuLyoqXG4gKiBMb2FkcyB0aGUgcmVDQVBUQ0hBIGNvbmZpZ3VyYXRpb24gaW50byB0aGUgYEF1dGhgIGluc3RhbmNlLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUaGlzIHdpbGwgbG9hZCB0aGUgcmVDQVBUQ0hBIGNvbmZpZywgd2hpY2ggaW5kaWNhdGVzIHdoZXRoZXIgdGhlIHJlQ0FQVENIQVxuICogdmVyaWZpY2F0aW9uIGZsb3cgc2hvdWxkIGJlIHRyaWdnZXJlZCBmb3IgZWFjaCBhdXRoIHByb3ZpZGVyLCBpbnRvIHRoZVxuICogY3VycmVudCBBdXRoIHNlc3Npb24uXG4gKlxuICogSWYgaW5pdGlhbGl6ZVJlY2FwdGNoYUNvbmZpZygpIGlzIG5vdCBpbnZva2VkLCB0aGUgYXV0aCBmbG93IHdpbGwgYWx3YXlzIHN0YXJ0XG4gKiB3aXRob3V0IHJlQ0FQVENIQSB2ZXJpZmljYXRpb24uIElmIHRoZSBwcm92aWRlciBpcyBjb25maWd1cmVkIHRvIHJlcXVpcmUgcmVDQVBUQ0hBXG4gKiB2ZXJpZmljYXRpb24sIHRoZSBTREsgd2lsbCB0cmFuc3BhcmVudGx5IGxvYWQgdGhlIHJlQ0FQVENIQSBjb25maWcgYW5kIHJlc3RhcnQgdGhlXG4gKiBhdXRoIGZsb3dzLlxuICpcbiAqIFRodXMsIGJ5IGNhbGxpbmcgdGhpcyBvcHRpb25hbCBtZXRob2QsIHlvdSB3aWxsIHJlZHVjZSB0aGUgbGF0ZW5jeSBvZiBmdXR1cmUgYXV0aCBmbG93cy5cbiAqIExvYWRpbmcgdGhlIHJlQ0FQVENIQSBjb25maWcgZWFybHkgd2lsbCBhbHNvIGVuaGFuY2UgdGhlIHNpZ25hbCBjb2xsZWN0ZWQgYnkgcmVDQVBUQ0hBLlxuICpcbiAqIFRoaXMgbWV0aG9kIGRvZXMgbm90IHdvcmsgaW4gYSBOb2RlLmpzIGVudmlyb25tZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiBpbml0aWFsaXplUmVjYXB0Y2hhQ29uZmlnKGF1dGgpO1xuICogYGBgXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZnVuY3Rpb24gaW5pdGlhbGl6ZVJlY2FwdGNoYUNvbmZpZyhhdXRoKSB7XG4gICAgcmV0dXJuIF9pbml0aWFsaXplUmVjYXB0Y2hhQ29uZmlnKGF1dGgpO1xufVxuLyoqXG4gKiBWYWxpZGF0ZXMgdGhlIHBhc3N3b3JkIGFnYWluc3QgdGhlIHBhc3N3b3JkIHBvbGljeSBjb25maWd1cmVkIGZvciB0aGUgcHJvamVjdCBvciB0ZW5hbnQuXG4gKlxuICogQHJlbWFya3NcbiAqIElmIG5vIHRlbmFudCBJRCBpcyBzZXQgb24gdGhlIGBBdXRoYCBpbnN0YW5jZSwgdGhlbiB0aGlzIG1ldGhvZCB3aWxsIHVzZSB0aGUgcGFzc3dvcmRcbiAqIHBvbGljeSBjb25maWd1cmVkIGZvciB0aGUgcHJvamVjdC4gT3RoZXJ3aXNlLCB0aGlzIG1ldGhvZCB3aWxsIHVzZSB0aGUgcG9saWN5IGNvbmZpZ3VyZWRcbiAqIGZvciB0aGUgdGVuYW50LiBJZiBhIHBhc3N3b3JkIHBvbGljeSBoYXMgbm90IGJlZW4gY29uZmlndXJlZCwgdGhlbiB0aGUgZGVmYXVsdCBwb2xpY3lcbiAqIGNvbmZpZ3VyZWQgZm9yIGFsbCBwcm9qZWN0cyB3aWxsIGJlIHVzZWQuXG4gKlxuICogSWYgYW4gYXV0aCBmbG93IGZhaWxzIGJlY2F1c2UgYSBzdWJtaXR0ZWQgcGFzc3dvcmQgZG9lcyBub3QgbWVldCB0aGUgcGFzc3dvcmQgcG9saWN5XG4gKiByZXF1aXJlbWVudHMgYW5kIHRoaXMgbWV0aG9kIGhhcyBwcmV2aW91c2x5IGJlZW4gY2FsbGVkLCB0aGVuIHRoaXMgbWV0aG9kIHdpbGwgdXNlIHRoZVxuICogbW9zdCByZWNlbnQgcG9saWN5IGF2YWlsYWJsZSB3aGVuIGNhbGxlZCBhZ2Fpbi5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogdmFsaWRhdGVQYXNzd29yZChhdXRoLCAnc29tZS1wYXNzd29yZCcpO1xuICogYGBgXG4gKlxuICogQHBhcmFtIGF1dGggVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSBwYXNzd29yZCBUaGUgcGFzc3dvcmQgdG8gdmFsaWRhdGUuXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiB2YWxpZGF0ZVBhc3N3b3JkKGF1dGgsIHBhc3N3b3JkKSB7XG4gICAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xuICAgIHJldHVybiBhdXRoSW50ZXJuYWwudmFsaWRhdGVQYXNzd29yZChwYXNzd29yZCk7XG59XG4vKipcbiAqIEFkZHMgYW4gb2JzZXJ2ZXIgZm9yIGNoYW5nZXMgdG8gdGhlIHNpZ25lZC1pbiB1c2VyJ3MgSUQgdG9rZW4uXG4gKlxuICogQHJlbWFya3NcbiAqIFRoaXMgaW5jbHVkZXMgc2lnbi1pbiwgc2lnbi1vdXQsIGFuZCB0b2tlbiByZWZyZXNoIGV2ZW50cy5cbiAqIFRoaXMgd2lsbCBub3QgYmUgdHJpZ2dlcmVkIGF1dG9tYXRpY2FsbHkgdXBvbiBJRCB0b2tlbiBleHBpcmF0aW9uLiBVc2Uge0BsaW5rIFVzZXIuZ2V0SWRUb2tlbn0gdG8gcmVmcmVzaCB0aGUgSUQgdG9rZW4uXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIG5leHRPck9ic2VydmVyIC0gY2FsbGJhY2sgdHJpZ2dlcmVkIG9uIGNoYW5nZS5cbiAqIEBwYXJhbSBlcnJvciAtIERlcHJlY2F0ZWQuIFRoaXMgY2FsbGJhY2sgaXMgbmV2ZXIgdHJpZ2dlcmVkLiBFcnJvcnNcbiAqIG9uIHNpZ25pbmcgaW4vb3V0IGNhbiBiZSBjYXVnaHQgaW4gcHJvbWlzZXMgcmV0dXJuZWQgZnJvbVxuICogc2lnbi1pbi9zaWduLW91dCBmdW5jdGlvbnMuXG4gKiBAcGFyYW0gY29tcGxldGVkIC0gRGVwcmVjYXRlZC4gVGhpcyBjYWxsYmFjayBpcyBuZXZlciB0cmlnZ2VyZWQuXG4gKlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiBvbklkVG9rZW5DaGFuZ2VkKGF1dGgsIG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGVkKSB7XG4gICAgcmV0dXJuIGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKS5vbklkVG9rZW5DaGFuZ2VkKG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGVkKTtcbn1cbi8qKlxuICogQWRkcyBhIGJsb2NraW5nIGNhbGxiYWNrIHRoYXQgcnVucyBiZWZvcmUgYW4gYXV0aCBzdGF0ZSBjaGFuZ2VcbiAqIHNldHMgYSBuZXcgdXNlci5cbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gY2FsbGJhY2sgLSBjYWxsYmFjayB0cmlnZ2VyZWQgYmVmb3JlIG5ldyB1c2VyIHZhbHVlIGlzIHNldC5cbiAqICAgSWYgdGhpcyB0aHJvd3MsIGl0IGJsb2NrcyB0aGUgdXNlciBmcm9tIGJlaW5nIHNldC5cbiAqIEBwYXJhbSBvbkFib3J0IC0gY2FsbGJhY2sgdHJpZ2dlcmVkIGlmIGEgbGF0ZXIgYGJlZm9yZUF1dGhTdGF0ZUNoYW5nZWQoKWBcbiAqICAgY2FsbGJhY2sgdGhyb3dzLCBhbGxvd2luZyB5b3UgdG8gdW5kbyBhbnkgc2lkZSBlZmZlY3RzLlxuICovXG5mdW5jdGlvbiBiZWZvcmVBdXRoU3RhdGVDaGFuZ2VkKGF1dGgsIGNhbGxiYWNrLCBvbkFib3J0KSB7XG4gICAgcmV0dXJuIGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKS5iZWZvcmVBdXRoU3RhdGVDaGFuZ2VkKGNhbGxiYWNrLCBvbkFib3J0KTtcbn1cbi8qKlxuICogQWRkcyBhbiBvYnNlcnZlciBmb3IgY2hhbmdlcyB0byB0aGUgdXNlcidzIHNpZ24taW4gc3RhdGUuXG4gKlxuICogQHJlbWFya3NcbiAqIFRvIGtlZXAgdGhlIG9sZCBiZWhhdmlvciwgc2VlIHtAbGluayBvbklkVG9rZW5DaGFuZ2VkfS5cbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gbmV4dE9yT2JzZXJ2ZXIgLSBjYWxsYmFjayB0cmlnZ2VyZWQgb24gY2hhbmdlLlxuICogQHBhcmFtIGVycm9yIC0gRGVwcmVjYXRlZC4gVGhpcyBjYWxsYmFjayBpcyBuZXZlciB0cmlnZ2VyZWQuIEVycm9yc1xuICogb24gc2lnbmluZyBpbi9vdXQgY2FuIGJlIGNhdWdodCBpbiBwcm9taXNlcyByZXR1cm5lZCBmcm9tXG4gKiBzaWduLWluL3NpZ24tb3V0IGZ1bmN0aW9ucy5cbiAqIEBwYXJhbSBjb21wbGV0ZWQgLSBEZXByZWNhdGVkLiBUaGlzIGNhbGxiYWNrIGlzIG5ldmVyIHRyaWdnZXJlZC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIG9uQXV0aFN0YXRlQ2hhbmdlZChhdXRoLCBuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlZCkge1xuICAgIHJldHVybiBnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCkub25BdXRoU3RhdGVDaGFuZ2VkKG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGVkKTtcbn1cbi8qKlxuICogU2V0cyB0aGUgY3VycmVudCBsYW5ndWFnZSB0byB0aGUgZGVmYXVsdCBkZXZpY2UvYnJvd3NlciBwcmVmZXJlbmNlLlxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIHVzZURldmljZUxhbmd1YWdlKGF1dGgpIHtcbiAgICBnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCkudXNlRGV2aWNlTGFuZ3VhZ2UoKTtcbn1cbi8qKlxuICogQXN5bmNocm9ub3VzbHkgc2V0cyB0aGUgcHJvdmlkZWQgdXNlciBhcyB7QGxpbmsgQXV0aC5jdXJyZW50VXNlcn0gb24gdGhlXG4gKiB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKlxuICogQHJlbWFya3NcbiAqIEEgbmV3IGluc3RhbmNlIGNvcHkgb2YgdGhlIHVzZXIgcHJvdmlkZWQgd2lsbCBiZSBtYWRlIGFuZCBzZXQgYXMgY3VycmVudFVzZXIuXG4gKlxuICogVGhpcyB3aWxsIHRyaWdnZXIge0BsaW5rIG9uQXV0aFN0YXRlQ2hhbmdlZH0gYW5kIHtAbGluayBvbklkVG9rZW5DaGFuZ2VkfSBsaXN0ZW5lcnNcbiAqIGxpa2Ugb3RoZXIgc2lnbiBpbiBtZXRob2RzLlxuICpcbiAqIFRoZSBvcGVyYXRpb24gZmFpbHMgd2l0aCBhbiBlcnJvciBpZiB0aGUgdXNlciB0byBiZSB1cGRhdGVkIGJlbG9uZ3MgdG8gYSBkaWZmZXJlbnQgRmlyZWJhc2VcbiAqIHByb2plY3QuXG4gKlxuICogVGhpcyBtZXRob2QgaXMgbm90IHN1cHBvcnRlZCBieSB7QGxpbmsgQXV0aH0gaW5zdGFuY2VzIGNyZWF0ZWQgd2l0aCBhXG4gKiB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZVNlcnZlckFwcH0uXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIHVzZXIgLSBUaGUgbmV3IHtAbGluayBVc2VyfS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIHVwZGF0ZUN1cnJlbnRVc2VyKGF1dGgsIHVzZXIpIHtcbiAgICByZXR1cm4gZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLnVwZGF0ZUN1cnJlbnRVc2VyKHVzZXIpO1xufVxuLyoqXG4gKiBTaWducyBvdXQgdGhlIGN1cnJlbnQgdXNlci5cbiAqXG4gKiBAcmVtYXJrc1xuICogVGhpcyBtZXRob2QgaXMgbm90IHN1cHBvcnRlZCBieSB7QGxpbmsgQXV0aH0gaW5zdGFuY2VzIGNyZWF0ZWQgd2l0aCBhXG4gKiB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZVNlcnZlckFwcH0uXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZnVuY3Rpb24gc2lnbk91dChhdXRoKSB7XG4gICAgcmV0dXJuIGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKS5zaWduT3V0KCk7XG59XG4vKipcbiAqIFJldm9rZXMgdGhlIGdpdmVuIGFjY2VzcyB0b2tlbi4gQ3VycmVudGx5IG9ubHkgc3VwcG9ydHMgQXBwbGUgT0F1dGggYWNjZXNzIHRva2Vucy5cbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gdG9rZW4gLSBUaGUgQXBwbGUgT0F1dGggYWNjZXNzIHRva2VuLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZnVuY3Rpb24gcmV2b2tlQWNjZXNzVG9rZW4oYXV0aCwgdG9rZW4pIHtcbiAgICBjb25zdCBhdXRoSW50ZXJuYWwgPSBfY2FzdEF1dGgoYXV0aCk7XG4gICAgcmV0dXJuIGF1dGhJbnRlcm5hbC5yZXZva2VBY2Nlc3NUb2tlbih0b2tlbik7XG59XG4vKipcbiAqIERlbGV0ZXMgYW5kIHNpZ25zIG91dCB0aGUgdXNlci5cbiAqXG4gKiBAcmVtYXJrc1xuICogSW1wb3J0YW50OiB0aGlzIGlzIGEgc2VjdXJpdHktc2Vuc2l0aXZlIG9wZXJhdGlvbiB0aGF0IHJlcXVpcmVzIHRoZSB1c2VyIHRvIGhhdmUgcmVjZW50bHlcbiAqIHNpZ25lZCBpbi4gSWYgdGhpcyByZXF1aXJlbWVudCBpc24ndCBtZXQsIGFzayB0aGUgdXNlciB0byBhdXRoZW50aWNhdGUgYWdhaW4gYW5kIHRoZW4gY2FsbFxuICoge0BsaW5rIHJlYXV0aGVudGljYXRlV2l0aENyZWRlbnRpYWx9LlxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiBkZWxldGVVc2VyKHVzZXIpIHtcbiAgICByZXR1cm4gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpLmRlbGV0ZSgpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3MgTXVsdGlGYWN0b3JTZXNzaW9uSW1wbCB7XG4gICAgY29uc3RydWN0b3IodHlwZSwgY3JlZGVudGlhbCwgdXNlcikge1xuICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICB0aGlzLmNyZWRlbnRpYWwgPSBjcmVkZW50aWFsO1xuICAgICAgICB0aGlzLnVzZXIgPSB1c2VyO1xuICAgIH1cbiAgICBzdGF0aWMgX2Zyb21JZHRva2VuKGlkVG9rZW4sIHVzZXIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNdWx0aUZhY3RvclNlc3Npb25JbXBsKFwiZW5yb2xsXCIgLyogTXVsdGlGYWN0b3JTZXNzaW9uVHlwZS5FTlJPTEwgKi8sIGlkVG9rZW4sIHVzZXIpO1xuICAgIH1cbiAgICBzdGF0aWMgX2Zyb21NZmFQZW5kaW5nQ3JlZGVudGlhbChtZmFQZW5kaW5nQ3JlZGVudGlhbCkge1xuICAgICAgICByZXR1cm4gbmV3IE11bHRpRmFjdG9yU2Vzc2lvbkltcGwoXCJzaWduaW5cIiAvKiBNdWx0aUZhY3RvclNlc3Npb25UeXBlLlNJR05fSU4gKi8sIG1mYVBlbmRpbmdDcmVkZW50aWFsKTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCBrZXkgPSB0aGlzLnR5cGUgPT09IFwiZW5yb2xsXCIgLyogTXVsdGlGYWN0b3JTZXNzaW9uVHlwZS5FTlJPTEwgKi9cbiAgICAgICAgICAgID8gJ2lkVG9rZW4nXG4gICAgICAgICAgICA6ICdwZW5kaW5nQ3JlZGVudGlhbCc7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBtdWx0aUZhY3RvclNlc3Npb246IHtcbiAgICAgICAgICAgICAgICBba2V5XTogdGhpcy5jcmVkZW50aWFsXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tSlNPTihvYmopIHtcbiAgICAgICAgaWYgKG9iaj8ubXVsdGlGYWN0b3JTZXNzaW9uKSB7XG4gICAgICAgICAgICBpZiAob2JqLm11bHRpRmFjdG9yU2Vzc2lvbj8ucGVuZGluZ0NyZWRlbnRpYWwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gTXVsdGlGYWN0b3JTZXNzaW9uSW1wbC5fZnJvbU1mYVBlbmRpbmdDcmVkZW50aWFsKG9iai5tdWx0aUZhY3RvclNlc3Npb24ucGVuZGluZ0NyZWRlbnRpYWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAob2JqLm11bHRpRmFjdG9yU2Vzc2lvbj8uaWRUb2tlbikge1xuICAgICAgICAgICAgICAgIHJldHVybiBNdWx0aUZhY3RvclNlc3Npb25JbXBsLl9mcm9tSWR0b2tlbihvYmoubXVsdGlGYWN0b3JTZXNzaW9uLmlkVG9rZW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNsYXNzIE11bHRpRmFjdG9yUmVzb2x2ZXJJbXBsIHtcbiAgICBjb25zdHJ1Y3RvcihzZXNzaW9uLCBoaW50cywgc2lnbkluUmVzb2x2ZXIpIHtcbiAgICAgICAgdGhpcy5zZXNzaW9uID0gc2Vzc2lvbjtcbiAgICAgICAgdGhpcy5oaW50cyA9IGhpbnRzO1xuICAgICAgICB0aGlzLnNpZ25JblJlc29sdmVyID0gc2lnbkluUmVzb2x2ZXI7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBzdGF0aWMgX2Zyb21FcnJvcihhdXRoRXh0ZXJuLCBlcnJvcikge1xuICAgICAgICBjb25zdCBhdXRoID0gX2Nhc3RBdXRoKGF1dGhFeHRlcm4pO1xuICAgICAgICBjb25zdCBzZXJ2ZXJSZXNwb25zZSA9IGVycm9yLmN1c3RvbURhdGEuX3NlcnZlclJlc3BvbnNlO1xuICAgICAgICBjb25zdCBoaW50cyA9IChzZXJ2ZXJSZXNwb25zZS5tZmFJbmZvIHx8IFtdKS5tYXAoZW5yb2xsbWVudCA9PiBNdWx0aUZhY3RvckluZm9JbXBsLl9mcm9tU2VydmVyUmVzcG9uc2UoYXV0aCwgZW5yb2xsbWVudCkpO1xuICAgICAgICBfYXNzZXJ0KHNlcnZlclJlc3BvbnNlLm1mYVBlbmRpbmdDcmVkZW50aWFsLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgIGNvbnN0IHNlc3Npb24gPSBNdWx0aUZhY3RvclNlc3Npb25JbXBsLl9mcm9tTWZhUGVuZGluZ0NyZWRlbnRpYWwoc2VydmVyUmVzcG9uc2UubWZhUGVuZGluZ0NyZWRlbnRpYWwpO1xuICAgICAgICByZXR1cm4gbmV3IE11bHRpRmFjdG9yUmVzb2x2ZXJJbXBsKHNlc3Npb24sIGhpbnRzLCBhc3luYyAoYXNzZXJ0aW9uKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBtZmFSZXNwb25zZSA9IGF3YWl0IGFzc2VydGlvbi5fcHJvY2VzcyhhdXRoLCBzZXNzaW9uKTtcbiAgICAgICAgICAgIC8vIENsZWFyIG91dCB0aGUgdW5uZWVkZWQgZmllbGRzIGZyb20gdGhlIG9sZCBsb2dpbiByZXNwb25zZVxuICAgICAgICAgICAgZGVsZXRlIHNlcnZlclJlc3BvbnNlLm1mYUluZm87XG4gICAgICAgICAgICBkZWxldGUgc2VydmVyUmVzcG9uc2UubWZhUGVuZGluZ0NyZWRlbnRpYWw7XG4gICAgICAgICAgICAvLyBVc2UgaW4gdGhlIG5ldyB0b2tlbiAmIHJlZnJlc2ggdG9rZW4gaW4gdGhlIG9sZCByZXNwb25zZVxuICAgICAgICAgICAgY29uc3QgaWRUb2tlblJlc3BvbnNlID0ge1xuICAgICAgICAgICAgICAgIC4uLnNlcnZlclJlc3BvbnNlLFxuICAgICAgICAgICAgICAgIGlkVG9rZW46IG1mYVJlc3BvbnNlLmlkVG9rZW4sXG4gICAgICAgICAgICAgICAgcmVmcmVzaFRva2VuOiBtZmFSZXNwb25zZS5yZWZyZXNoVG9rZW5cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvLyBUT0RPOiB3ZSBzaG91bGQgY29sbGFwc2UgdGhpcyBzd2l0Y2ggc3RhdGVtZW50IGludG8gVXNlckNyZWRlbnRpYWxJbXBsLl9mb3JPcGVyYXRpb24gYW5kIGhhdmUgaXQgc3VwcG9ydCB0aGUgU0lHTl9JTiBjYXNlXG4gICAgICAgICAgICBzd2l0Y2ggKGVycm9yLm9wZXJhdGlvblR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwic2lnbkluXCIgLyogT3BlcmF0aW9uVHlwZS5TSUdOX0lOICovOlxuICAgICAgICAgICAgICAgICAgICBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IFVzZXJDcmVkZW50aWFsSW1wbC5fZnJvbUlkVG9rZW5SZXNwb25zZShhdXRoLCBlcnJvci5vcGVyYXRpb25UeXBlLCBpZFRva2VuUmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBhdXRoLl91cGRhdGVDdXJyZW50VXNlcih1c2VyQ3JlZGVudGlhbC51c2VyKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJDcmVkZW50aWFsO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJyZWF1dGhlbnRpY2F0ZVwiIC8qIE9wZXJhdGlvblR5cGUuUkVBVVRIRU5USUNBVEUgKi86XG4gICAgICAgICAgICAgICAgICAgIF9hc3NlcnQoZXJyb3IudXNlciwgYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gVXNlckNyZWRlbnRpYWxJbXBsLl9mb3JPcGVyYXRpb24oZXJyb3IudXNlciwgZXJyb3Iub3BlcmF0aW9uVHlwZSwgaWRUb2tlblJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBfZmFpbChhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhc3luYyByZXNvbHZlU2lnbkluKGFzc2VydGlvbkV4dGVybikge1xuICAgICAgICBjb25zdCBhc3NlcnRpb24gPSBhc3NlcnRpb25FeHRlcm47XG4gICAgICAgIHJldHVybiB0aGlzLnNpZ25JblJlc29sdmVyKGFzc2VydGlvbik7XG4gICAgfVxufVxuLyoqXG4gKiBQcm92aWRlcyBhIHtAbGluayBNdWx0aUZhY3RvclJlc29sdmVyfSBzdWl0YWJsZSBmb3IgY29tcGxldGlvbiBvZiBhXG4gKiBtdWx0aS1mYWN0b3IgZmxvdy5cbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gZXJyb3IgLSBUaGUge0BsaW5rIE11bHRpRmFjdG9yRXJyb3J9IHJhaXNlZCBkdXJpbmcgYSBzaWduLWluLCBvclxuICogcmVhdXRoZW50aWNhdGlvbiBvcGVyYXRpb24uXG4gKlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiBnZXRNdWx0aUZhY3RvclJlc29sdmVyKGF1dGgsIGVycm9yKSB7XG4gICAgY29uc3QgYXV0aE1vZHVsYXIgPSBnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCk7XG4gICAgY29uc3QgZXJyb3JJbnRlcm5hbCA9IGVycm9yO1xuICAgIF9hc3NlcnQoZXJyb3IuY3VzdG9tRGF0YS5vcGVyYXRpb25UeXBlLCBhdXRoTW9kdWxhciwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IgKi8pO1xuICAgIF9hc3NlcnQoZXJyb3JJbnRlcm5hbC5jdXN0b21EYXRhLl9zZXJ2ZXJSZXNwb25zZT8ubWZhUGVuZGluZ0NyZWRlbnRpYWwsIGF1dGhNb2R1bGFyLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUiAqLyk7XG4gICAgcmV0dXJuIE11bHRpRmFjdG9yUmVzb2x2ZXJJbXBsLl9mcm9tRXJyb3IoYXV0aE1vZHVsYXIsIGVycm9ySW50ZXJuYWwpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuZnVuY3Rpb24gc3RhcnRFbnJvbGxQaG9uZU1mYShhdXRoLCByZXF1ZXN0KSB7XG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBIdHRwTWV0aG9kLlBPU1QgKi8sIFwiL3YyL2FjY291bnRzL21mYUVucm9sbG1lbnQ6c3RhcnRcIiAvKiBFbmRwb2ludC5TVEFSVF9NRkFfRU5ST0xMTUVOVCAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcbn1cbmZ1bmN0aW9uIGZpbmFsaXplRW5yb2xsUGhvbmVNZmEoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92Mi9hY2NvdW50cy9tZmFFbnJvbGxtZW50OmZpbmFsaXplXCIgLyogRW5kcG9pbnQuRklOQUxJWkVfTUZBX0VOUk9MTE1FTlQgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XG59XG5mdW5jdGlvbiBzdGFydEVucm9sbFRvdHBNZmEoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92Mi9hY2NvdW50cy9tZmFFbnJvbGxtZW50OnN0YXJ0XCIgLyogRW5kcG9pbnQuU1RBUlRfTUZBX0VOUk9MTE1FTlQgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XG59XG5mdW5jdGlvbiBmaW5hbGl6ZUVucm9sbFRvdHBNZmEoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92Mi9hY2NvdW50cy9tZmFFbnJvbGxtZW50OmZpbmFsaXplXCIgLyogRW5kcG9pbnQuRklOQUxJWkVfTUZBX0VOUk9MTE1FTlQgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XG59XG5mdW5jdGlvbiB3aXRoZHJhd01mYShhdXRoLCByZXF1ZXN0KSB7XG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBIdHRwTWV0aG9kLlBPU1QgKi8sIFwiL3YyL2FjY291bnRzL21mYUVucm9sbG1lbnQ6d2l0aGRyYXdcIiAvKiBFbmRwb2ludC5XSVRIRFJBV19NRkEgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XG59XG5cbmNsYXNzIE11bHRpRmFjdG9yVXNlckltcGwge1xuICAgIGNvbnN0cnVjdG9yKHVzZXIpIHtcbiAgICAgICAgdGhpcy51c2VyID0gdXNlcjtcbiAgICAgICAgdGhpcy5lbnJvbGxlZEZhY3RvcnMgPSBbXTtcbiAgICAgICAgdXNlci5fb25SZWxvYWQodXNlckluZm8gPT4ge1xuICAgICAgICAgICAgaWYgKHVzZXJJbmZvLm1mYUluZm8pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVucm9sbGVkRmFjdG9ycyA9IHVzZXJJbmZvLm1mYUluZm8ubWFwKGVucm9sbG1lbnQgPT4gTXVsdGlGYWN0b3JJbmZvSW1wbC5fZnJvbVNlcnZlclJlc3BvbnNlKHVzZXIuYXV0aCwgZW5yb2xsbWVudCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc3RhdGljIF9mcm9tVXNlcih1c2VyKSB7XG4gICAgICAgIHJldHVybiBuZXcgTXVsdGlGYWN0b3JVc2VySW1wbCh1c2VyKTtcbiAgICB9XG4gICAgYXN5bmMgZ2V0U2Vzc2lvbigpIHtcbiAgICAgICAgcmV0dXJuIE11bHRpRmFjdG9yU2Vzc2lvbkltcGwuX2Zyb21JZHRva2VuKGF3YWl0IHRoaXMudXNlci5nZXRJZFRva2VuKCksIHRoaXMudXNlcik7XG4gICAgfVxuICAgIGFzeW5jIGVucm9sbChhc3NlcnRpb25FeHRlcm4sIGRpc3BsYXlOYW1lKSB7XG4gICAgICAgIGNvbnN0IGFzc2VydGlvbiA9IGFzc2VydGlvbkV4dGVybjtcbiAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IChhd2FpdCB0aGlzLmdldFNlc3Npb24oKSk7XG4gICAgICAgIGNvbnN0IGZpbmFsaXplTWZhUmVzcG9uc2UgPSBhd2FpdCBfbG9nb3V0SWZJbnZhbGlkYXRlZCh0aGlzLnVzZXIsIGFzc2VydGlvbi5fcHJvY2Vzcyh0aGlzLnVzZXIuYXV0aCwgc2Vzc2lvbiwgZGlzcGxheU5hbWUpKTtcbiAgICAgICAgLy8gTmV3IHRva2VucyB3aWxsIGJlIGlzc3VlZCBhZnRlciBlbnJvbGxtZW50IG9mIHRoZSBuZXcgc2Vjb25kIGZhY3RvcnMuXG4gICAgICAgIC8vIFRoZXkgbmVlZCB0byBiZSB1cGRhdGVkIG9uIHRoZSB1c2VyLlxuICAgICAgICBhd2FpdCB0aGlzLnVzZXIuX3VwZGF0ZVRva2Vuc0lmTmVjZXNzYXJ5KGZpbmFsaXplTWZhUmVzcG9uc2UpO1xuICAgICAgICAvLyBUaGUgdXNlciBuZWVkcyB0byBiZSByZWxvYWRlZCB0byBnZXQgdGhlIG5ldyBtdWx0aS1mYWN0b3IgaW5mb3JtYXRpb25cbiAgICAgICAgLy8gZnJvbSBzZXJ2ZXIuIFVTRVJfUkVMT0FERUQgZXZlbnQgd2lsbCBiZSB0cmlnZ2VyZWQgYW5kIGBlbnJvbGxlZEZhY3RvcnNgXG4gICAgICAgIC8vIHdpbGwgYmUgdXBkYXRlZC5cbiAgICAgICAgcmV0dXJuIHRoaXMudXNlci5yZWxvYWQoKTtcbiAgICB9XG4gICAgYXN5bmMgdW5lbnJvbGwoaW5mb09yVWlkKSB7XG4gICAgICAgIGNvbnN0IG1mYUVucm9sbG1lbnRJZCA9IHR5cGVvZiBpbmZvT3JVaWQgPT09ICdzdHJpbmcnID8gaW5mb09yVWlkIDogaW5mb09yVWlkLnVpZDtcbiAgICAgICAgY29uc3QgaWRUb2tlbiA9IGF3YWl0IHRoaXMudXNlci5nZXRJZFRva2VuKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBpZFRva2VuUmVzcG9uc2UgPSBhd2FpdCBfbG9nb3V0SWZJbnZhbGlkYXRlZCh0aGlzLnVzZXIsIHdpdGhkcmF3TWZhKHRoaXMudXNlci5hdXRoLCB7XG4gICAgICAgICAgICAgICAgaWRUb2tlbixcbiAgICAgICAgICAgICAgICBtZmFFbnJvbGxtZW50SWRcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgc2Vjb25kIGZhY3RvciBmcm9tIHRoZSB1c2VyJ3MgbGlzdC5cbiAgICAgICAgICAgIHRoaXMuZW5yb2xsZWRGYWN0b3JzID0gdGhpcy5lbnJvbGxlZEZhY3RvcnMuZmlsdGVyKCh7IHVpZCB9KSA9PiB1aWQgIT09IG1mYUVucm9sbG1lbnRJZCk7XG4gICAgICAgICAgICAvLyBEZXBlbmRpbmcgb24gd2hldGhlciB0aGUgYmFja2VuZCBkZWNpZGVkIHRvIHJldm9rZSB0aGUgdXNlcidzIHNlc3Npb24sXG4gICAgICAgICAgICAvLyB0aGUgdG9rZW5SZXNwb25zZSBtYXkgYmUgZW1wdHkuIElmIHRoZSB0b2tlbnMgd2VyZSBub3QgdXBkYXRlZCAoYW5kIHRoZXlcbiAgICAgICAgICAgIC8vIGFyZSBub3cgaW52YWxpZCksIHJlbG9hZGluZyB0aGUgdXNlciB3aWxsIGRpc2NvdmVyIHRoaXMgYW5kIGludmFsaWRhdGVcbiAgICAgICAgICAgIC8vIHRoZSB1c2VyJ3Mgc3RhdGUgYWNjb3JkaW5nbHkuXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnVzZXIuX3VwZGF0ZVRva2Vuc0lmTmVjZXNzYXJ5KGlkVG9rZW5SZXNwb25zZSk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnVzZXIucmVsb2FkKCk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgIH1cbiAgICB9XG59XG5jb25zdCBtdWx0aUZhY3RvclVzZXJDYWNoZSA9IG5ldyBXZWFrTWFwKCk7XG4vKipcbiAqIFRoZSB7QGxpbmsgTXVsdGlGYWN0b3JVc2VyfSBjb3JyZXNwb25kaW5nIHRvIHRoZSB1c2VyLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUaGlzIGlzIHVzZWQgdG8gYWNjZXNzIGFsbCBtdWx0aS1mYWN0b3IgcHJvcGVydGllcyBhbmQgb3BlcmF0aW9ucyByZWxhdGVkIHRvIHRoZSB1c2VyLlxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiBtdWx0aUZhY3Rvcih1c2VyKSB7XG4gICAgY29uc3QgdXNlck1vZHVsYXIgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcik7XG4gICAgaWYgKCFtdWx0aUZhY3RvclVzZXJDYWNoZS5oYXModXNlck1vZHVsYXIpKSB7XG4gICAgICAgIG11bHRpRmFjdG9yVXNlckNhY2hlLnNldCh1c2VyTW9kdWxhciwgTXVsdGlGYWN0b3JVc2VySW1wbC5fZnJvbVVzZXIodXNlck1vZHVsYXIpKTtcbiAgICB9XG4gICAgcmV0dXJuIG11bHRpRmFjdG9yVXNlckNhY2hlLmdldCh1c2VyTW9kdWxhcik7XG59XG5cbmNvbnN0IFNUT1JBR0VfQVZBSUxBQkxFX0tFWSA9ICdfX3Nhayc7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFNoaW0gZm9yIFByb21pc2UuYWxsU2V0dGxlZCwgbm90ZSB0aGUgc2xpZ2h0bHkgZGlmZmVyZW50IGZvcm1hdCBvZiBgZnVsZmlsbGVkYCB2cyBgc3RhdHVzYC5cbiAqXG4gKiBAcGFyYW0gcHJvbWlzZXMgLSBBcnJheSBvZiBwcm9taXNlcyB0byB3YWl0IG9uLlxuICovXG5mdW5jdGlvbiBfYWxsU2V0dGxlZChwcm9taXNlcykge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChwcm9taXNlcy5tYXAoYXN5bmMgKHByb21pc2UpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gYXdhaXQgcHJvbWlzZTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZnVsZmlsbGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIHZhbHVlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChyZWFzb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZnVsZmlsbGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICByZWFzb25cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9KSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEludGVyZmFjZSBjbGFzcyBmb3IgcmVjZWl2aW5nIG1lc3NhZ2VzLlxuICpcbiAqL1xuY2xhc3MgUmVjZWl2ZXIge1xuICAgIGNvbnN0cnVjdG9yKGV2ZW50VGFyZ2V0KSB7XG4gICAgICAgIHRoaXMuZXZlbnRUYXJnZXQgPSBldmVudFRhcmdldDtcbiAgICAgICAgdGhpcy5oYW5kbGVyc01hcCA9IHt9O1xuICAgICAgICB0aGlzLmJvdW5kRXZlbnRIYW5kbGVyID0gdGhpcy5oYW5kbGVFdmVudC5iaW5kKHRoaXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBPYnRhaW4gYW4gaW5zdGFuY2Ugb2YgYSBSZWNlaXZlciBmb3IgYSBnaXZlbiBldmVudCB0YXJnZXQsIGlmIG5vbmUgZXhpc3RzIGl0IHdpbGwgYmUgY3JlYXRlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBldmVudFRhcmdldCAtIEFuIGV2ZW50IHRhcmdldCAoc3VjaCBhcyB3aW5kb3cgb3Igc2VsZikgdGhyb3VnaCB3aGljaCB0aGUgdW5kZXJseWluZ1xuICAgICAqIG1lc3NhZ2VzIHdpbGwgYmUgcmVjZWl2ZWQuXG4gICAgICovXG4gICAgc3RhdGljIF9nZXRJbnN0YW5jZShldmVudFRhcmdldCkge1xuICAgICAgICAvLyBUaGUgcmVzdWx0cyBhcmUgc3RvcmVkIGluIGFuIGFycmF5IHNpbmNlIG9iamVjdHMgY2FuJ3QgYmUga2V5cyBmb3Igb3RoZXJcbiAgICAgICAgLy8gb2JqZWN0cy4gSW4gYWRkaXRpb24sIHNldHRpbmcgYSB1bmlxdWUgcHJvcGVydHkgb24gYW4gZXZlbnQgdGFyZ2V0IGFzIGFcbiAgICAgICAgLy8gaGFzaCBtYXAga2V5IG1heSBub3QgYmUgYWxsb3dlZCBkdWUgdG8gQ09SUyByZXN0cmljdGlvbnMuXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nSW5zdGFuY2UgPSB0aGlzLnJlY2VpdmVycy5maW5kKHJlY2VpdmVyID0+IHJlY2VpdmVyLmlzTGlzdGVuaW5ndG8oZXZlbnRUYXJnZXQpKTtcbiAgICAgICAgaWYgKGV4aXN0aW5nSW5zdGFuY2UpIHtcbiAgICAgICAgICAgIHJldHVybiBleGlzdGluZ0luc3RhbmNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5ld0luc3RhbmNlID0gbmV3IFJlY2VpdmVyKGV2ZW50VGFyZ2V0KTtcbiAgICAgICAgdGhpcy5yZWNlaXZlcnMucHVzaChuZXdJbnN0YW5jZSk7XG4gICAgICAgIHJldHVybiBuZXdJbnN0YW5jZTtcbiAgICB9XG4gICAgaXNMaXN0ZW5pbmd0byhldmVudFRhcmdldCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ldmVudFRhcmdldCA9PT0gZXZlbnRUYXJnZXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZhbnMgb3V0IGEgTWVzc2FnZUV2ZW50IHRvIHRoZSBhcHByb3ByaWF0ZSBsaXN0ZW5lcnMuXG4gICAgICpcbiAgICAgKiBAcmVtYXJrc1xuICAgICAqIFNlbmRzIGFuIHtAbGluayBTdGF0dXMuQUNLfSB1cG9uIHJlY2VpcHQgYW5kIGEge0BsaW5rIFN0YXR1cy5ET05FfSBvbmNlIGFsbCBoYW5kbGVycyBoYXZlXG4gICAgICogZmluaXNoZWQgcHJvY2Vzc2luZy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBldmVudCAtIFRoZSBNZXNzYWdlRXZlbnQuXG4gICAgICpcbiAgICAgKi9cbiAgICBhc3luYyBoYW5kbGVFdmVudChldmVudCkge1xuICAgICAgICBjb25zdCBtZXNzYWdlRXZlbnQgPSBldmVudDtcbiAgICAgICAgY29uc3QgeyBldmVudElkLCBldmVudFR5cGUsIGRhdGEgfSA9IG1lc3NhZ2VFdmVudC5kYXRhO1xuICAgICAgICBjb25zdCBoYW5kbGVycyA9IHRoaXMuaGFuZGxlcnNNYXBbZXZlbnRUeXBlXTtcbiAgICAgICAgaWYgKCFoYW5kbGVycz8uc2l6ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIG1lc3NhZ2VFdmVudC5wb3J0c1swXS5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICBzdGF0dXM6IFwiYWNrXCIgLyogX1N0YXR1cy5BQ0sgKi8sXG4gICAgICAgICAgICBldmVudElkLFxuICAgICAgICAgICAgZXZlbnRUeXBlXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBwcm9taXNlcyA9IEFycmF5LmZyb20oaGFuZGxlcnMpLm1hcChhc3luYyAoaGFuZGxlcikgPT4gaGFuZGxlcihtZXNzYWdlRXZlbnQub3JpZ2luLCBkYXRhKSk7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgX2FsbFNldHRsZWQocHJvbWlzZXMpO1xuICAgICAgICBtZXNzYWdlRXZlbnQucG9ydHNbMF0ucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgc3RhdHVzOiBcImRvbmVcIiAvKiBfU3RhdHVzLkRPTkUgKi8sXG4gICAgICAgICAgICBldmVudElkLFxuICAgICAgICAgICAgZXZlbnRUeXBlLFxuICAgICAgICAgICAgcmVzcG9uc2VcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN1YnNjcmliZSBhbiBldmVudCBoYW5kbGVyIGZvciBhIHBhcnRpY3VsYXIgZXZlbnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXZlbnRUeXBlIC0gRXZlbnQgbmFtZSB0byBzdWJzY3JpYmUgdG8uXG4gICAgICogQHBhcmFtIGV2ZW50SGFuZGxlciAtIFRoZSBldmVudCBoYW5kbGVyIHdoaWNoIHNob3VsZCByZWNlaXZlIHRoZSBldmVudHMuXG4gICAgICpcbiAgICAgKi9cbiAgICBfc3Vic2NyaWJlKGV2ZW50VHlwZSwgZXZlbnRIYW5kbGVyKSB7XG4gICAgICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLmhhbmRsZXJzTWFwKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRUYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRoaXMuYm91bmRFdmVudEhhbmRsZXIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5oYW5kbGVyc01hcFtldmVudFR5cGVdKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZXJzTWFwW2V2ZW50VHlwZV0gPSBuZXcgU2V0KCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5oYW5kbGVyc01hcFtldmVudFR5cGVdLmFkZChldmVudEhhbmRsZXIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVbnN1YnNjcmliZSBhbiBldmVudCBoYW5kbGVyIGZyb20gYSBwYXJ0aWN1bGFyIGV2ZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIGV2ZW50VHlwZSAtIEV2ZW50IG5hbWUgdG8gdW5zdWJzY3JpYmUgZnJvbS5cbiAgICAgKiBAcGFyYW0gZXZlbnRIYW5kbGVyIC0gT3B0aW9uYWwgZXZlbnQgaGFuZGxlciwgaWYgbm9uZSBwcm92aWRlZCwgdW5zdWJzY3JpYmUgYWxsIGhhbmRsZXJzIG9uIHRoaXMgZXZlbnQuXG4gICAgICpcbiAgICAgKi9cbiAgICBfdW5zdWJzY3JpYmUoZXZlbnRUeXBlLCBldmVudEhhbmRsZXIpIHtcbiAgICAgICAgaWYgKHRoaXMuaGFuZGxlcnNNYXBbZXZlbnRUeXBlXSAmJiBldmVudEhhbmRsZXIpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlcnNNYXBbZXZlbnRUeXBlXS5kZWxldGUoZXZlbnRIYW5kbGVyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWV2ZW50SGFuZGxlciB8fCB0aGlzLmhhbmRsZXJzTWFwW2V2ZW50VHlwZV0uc2l6ZSA9PT0gMCkge1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuaGFuZGxlcnNNYXBbZXZlbnRUeXBlXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5oYW5kbGVyc01hcCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmV2ZW50VGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLmJvdW5kRXZlbnRIYW5kbGVyKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblJlY2VpdmVyLnJlY2VpdmVycyA9IFtdO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuZnVuY3Rpb24gX2dlbmVyYXRlRXZlbnRJZChwcmVmaXggPSAnJywgZGlnaXRzID0gMTApIHtcbiAgICBsZXQgcmFuZG9tID0gJyc7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkaWdpdHM7IGkrKykge1xuICAgICAgICByYW5kb20gKz0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgIH1cbiAgICByZXR1cm4gcHJlZml4ICsgcmFuZG9tO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBJbnRlcmZhY2UgZm9yIHNlbmRpbmcgbWVzc2FnZXMgYW5kIHdhaXRpbmcgZm9yIGEgY29tcGxldGlvbiByZXNwb25zZS5cbiAqXG4gKi9cbmNsYXNzIFNlbmRlciB7XG4gICAgY29uc3RydWN0b3IodGFyZ2V0KSB7XG4gICAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xuICAgICAgICB0aGlzLmhhbmRsZXJzID0gbmV3IFNldCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVbnN1YnNjcmliZSB0aGUgaGFuZGxlciBhbmQgcmVtb3ZlIGl0IGZyb20gb3VyIHRyYWNraW5nIFNldC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBoYW5kbGVyIC0gVGhlIGhhbmRsZXIgdG8gdW5zdWJzY3JpYmUuXG4gICAgICovXG4gICAgcmVtb3ZlTWVzc2FnZUhhbmRsZXIoaGFuZGxlcikge1xuICAgICAgICBpZiAoaGFuZGxlci5tZXNzYWdlQ2hhbm5lbCkge1xuICAgICAgICAgICAgaGFuZGxlci5tZXNzYWdlQ2hhbm5lbC5wb3J0MS5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgaGFuZGxlci5vbk1lc3NhZ2UpO1xuICAgICAgICAgICAgaGFuZGxlci5tZXNzYWdlQ2hhbm5lbC5wb3J0MS5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaGFuZGxlcnMuZGVsZXRlKGhhbmRsZXIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZW5kIGEgbWVzc2FnZSB0byB0aGUgUmVjZWl2ZXIgbG9jYXRlZCBhdCB7QGxpbmsgdGFyZ2V0fS5cbiAgICAgKlxuICAgICAqIEByZW1hcmtzXG4gICAgICogV2UnbGwgZmlyc3Qgd2FpdCBhIGJpdCBmb3IgYW4gQUNLICwgaWYgd2UgZ2V0IG9uZSB3ZSB3aWxsIHdhaXQgc2lnbmlmaWNhbnRseSBsb25nZXIgdW50aWwgdGhlXG4gICAgICogcmVjZWl2ZXIgaGFzIGhhZCBhIGNoYW5jZSB0byBmdWxseSBwcm9jZXNzIHRoZSBldmVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBldmVudFR5cGUgLSBUeXBlIG9mIGV2ZW50IHRvIHNlbmQuXG4gICAgICogQHBhcmFtIGRhdGEgLSBUaGUgcGF5bG9hZCBvZiB0aGUgZXZlbnQuXG4gICAgICogQHBhcmFtIHRpbWVvdXQgLSBUaW1lb3V0IGZvciB3YWl0aW5nIG9uIGFuIEFDSyBmcm9tIHRoZSByZWNlaXZlci5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIEFuIGFycmF5IG9mIHNldHRsZWQgcHJvbWlzZXMgZnJvbSBhbGwgdGhlIGhhbmRsZXJzIHRoYXQgd2VyZSBsaXN0ZW5pbmcgb24gdGhlIHJlY2VpdmVyLlxuICAgICAqL1xuICAgIGFzeW5jIF9zZW5kKGV2ZW50VHlwZSwgZGF0YSwgdGltZW91dCA9IDUwIC8qIF9UaW1lb3V0RHVyYXRpb24uQUNLICovKSB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2VDaGFubmVsID0gdHlwZW9mIE1lc3NhZ2VDaGFubmVsICE9PSAndW5kZWZpbmVkJyA/IG5ldyBNZXNzYWdlQ2hhbm5lbCgpIDogbnVsbDtcbiAgICAgICAgaWYgKCFtZXNzYWdlQ2hhbm5lbCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiY29ubmVjdGlvbl91bmF2YWlsYWJsZVwiIC8qIF9NZXNzYWdlRXJyb3IuQ09OTkVDVElPTl9VTkFWQUlMQUJMRSAqLyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gTm9kZSB0aW1lcnMgYW5kIGJyb3dzZXIgdGltZXJzIHJldHVybiBmdW5kYW1lbnRhbGx5IGRpZmZlcmVudCB0eXBlcy5cbiAgICAgICAgLy8gV2UgZG9uJ3QgYWN0dWFsbHkgY2FyZSB3aGF0IHRoZSB2YWx1ZSBpcyBidXQgVFMgd29uJ3QgYWNjZXB0IHVua25vd24gYW5kXG4gICAgICAgIC8vIHdlIGNhbid0IGNhc3QgcHJvcGVybHkgaW4gYm90aCBlbnZpcm9ubWVudHMuXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIGxldCBjb21wbGV0aW9uVGltZXI7XG4gICAgICAgIGxldCBoYW5kbGVyO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZXZlbnRJZCA9IF9nZW5lcmF0ZUV2ZW50SWQoJycsIDIwKTtcbiAgICAgICAgICAgIG1lc3NhZ2VDaGFubmVsLnBvcnQxLnN0YXJ0KCk7XG4gICAgICAgICAgICBjb25zdCBhY2tUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoXCJ1bnN1cHBvcnRlZF9ldmVudFwiIC8qIF9NZXNzYWdlRXJyb3IuVU5TVVBQT1JURURfRVZFTlQgKi8pKTtcbiAgICAgICAgICAgIH0sIHRpbWVvdXQpO1xuICAgICAgICAgICAgaGFuZGxlciA9IHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlQ2hhbm5lbCxcbiAgICAgICAgICAgICAgICBvbk1lc3NhZ2UoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZUV2ZW50ID0gZXZlbnQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlRXZlbnQuZGF0YS5ldmVudElkICE9PSBldmVudElkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChtZXNzYWdlRXZlbnQuZGF0YS5zdGF0dXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJhY2tcIiAvKiBfU3RhdHVzLkFDSyAqLzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcmVjZWl2ZXIgc2hvdWxkIEFDSyBmaXJzdC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoYWNrVGltZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRpb25UaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKFwidGltZW91dFwiIC8qIF9NZXNzYWdlRXJyb3IuVElNRU9VVCAqLykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDMwMDAgLyogX1RpbWVvdXREdXJhdGlvbi5DT01QTEVUSU9OICovKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJkb25lXCIgLyogX1N0YXR1cy5ET05FICovOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9uY2UgdGhlIHJlY2VpdmVyJ3MgaGFuZGxlcnMgYXJlIGZpbmlzaGVkIHdlIHdpbGwgZ2V0IHRoZSByZXN1bHRzLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChjb21wbGV0aW9uVGltZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUobWVzc2FnZUV2ZW50LmRhdGEucmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoYWNrVGltZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChjb21wbGV0aW9uVGltZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoXCJpbnZhbGlkX3Jlc3BvbnNlXCIgLyogX01lc3NhZ2VFcnJvci5JTlZBTElEX1JFU1BPTlNFICovKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVycy5hZGQoaGFuZGxlcik7XG4gICAgICAgICAgICBtZXNzYWdlQ2hhbm5lbC5wb3J0MS5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgaGFuZGxlci5vbk1lc3NhZ2UpO1xuICAgICAgICAgICAgdGhpcy50YXJnZXQucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgICAgIGV2ZW50VHlwZSxcbiAgICAgICAgICAgICAgICBldmVudElkLFxuICAgICAgICAgICAgICAgIGRhdGFcbiAgICAgICAgICAgIH0sIFttZXNzYWdlQ2hhbm5lbC5wb3J0Ml0pO1xuICAgICAgICB9KS5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgIGlmIChoYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVNZXNzYWdlSGFuZGxlcihoYW5kbGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBMYXp5IGFjY2Vzc29yIGZvciB3aW5kb3csIHNpbmNlIHRoZSBjb21wYXQgbGF5ZXIgd29uJ3QgdHJlZSBzaGFrZSB0aGlzIG91dCxcbiAqIHdlIG5lZWQgdG8gbWFrZSBzdXJlIG5vdCB0byBtZXNzIHdpdGggd2luZG93IHVubGVzcyB3ZSBoYXZlIHRvXG4gKi9cbmZ1bmN0aW9uIF93aW5kb3coKSB7XG4gICAgcmV0dXJuIHdpbmRvdztcbn1cbmZ1bmN0aW9uIF9zZXRXaW5kb3dMb2NhdGlvbih1cmwpIHtcbiAgICBfd2luZG93KCkubG9jYXRpb24uaHJlZiA9IHVybDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5mdW5jdGlvbiBfaXNXb3JrZXIoKSB7XG4gICAgcmV0dXJuICh0eXBlb2YgX3dpbmRvdygpWydXb3JrZXJHbG9iYWxTY29wZSddICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICB0eXBlb2YgX3dpbmRvdygpWydpbXBvcnRTY3JpcHRzJ10gPT09ICdmdW5jdGlvbicpO1xufVxuYXN5bmMgZnVuY3Rpb24gX2dldEFjdGl2ZVNlcnZpY2VXb3JrZXIoKSB7XG4gICAgaWYgKCFuYXZpZ2F0b3I/LnNlcnZpY2VXb3JrZXIpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlZ2lzdHJhdGlvbiA9IGF3YWl0IG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlYWR5O1xuICAgICAgICByZXR1cm4gcmVnaXN0cmF0aW9uLmFjdGl2ZTtcbiAgICB9XG4gICAgY2F0Y2gge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59XG5mdW5jdGlvbiBfZ2V0U2VydmljZVdvcmtlckNvbnRyb2xsZXIoKSB7XG4gICAgcmV0dXJuIG5hdmlnYXRvcj8uc2VydmljZVdvcmtlcj8uY29udHJvbGxlciB8fCBudWxsO1xufVxuZnVuY3Rpb24gX2dldFdvcmtlckdsb2JhbFNjb3BlKCkge1xuICAgIHJldHVybiBfaXNXb3JrZXIoKSA/IHNlbGYgOiBudWxsO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY29uc3QgREJfTkFNRSA9ICdmaXJlYmFzZUxvY2FsU3RvcmFnZURiJztcbmNvbnN0IERCX1ZFUlNJT04gPSAxO1xuY29uc3QgREJfT0JKRUNUU1RPUkVfTkFNRSA9ICdmaXJlYmFzZUxvY2FsU3RvcmFnZSc7XG5jb25zdCBEQl9EQVRBX0tFWVBBVEggPSAnZmJhc2Vfa2V5Jztcbi8qKlxuICogUHJvbWlzZSB3cmFwcGVyIGZvciBJREJSZXF1ZXN0XG4gKlxuICogVW5mb3J0dW5hdGVseSB3ZSBjYW4ndCBjbGVhbmx5IGV4dGVuZCBQcm9taXNlPFQ+IHNpbmNlIHByb21pc2VzIGFyZSBub3QgY2FsbGFibGUgaW4gRVM2XG4gKlxuICovXG5jbGFzcyBEQlByb21pc2Uge1xuICAgIGNvbnN0cnVjdG9yKHJlcXVlc3QpIHtcbiAgICAgICAgdGhpcy5yZXF1ZXN0ID0gcmVxdWVzdDtcbiAgICB9XG4gICAgdG9Qcm9taXNlKCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5yZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Y2Nlc3MnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLnJlcXVlc3QucmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5yZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHJlamVjdCh0aGlzLnJlcXVlc3QuZXJyb3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdldE9iamVjdFN0b3JlKGRiLCBpc1JlYWRXcml0ZSkge1xuICAgIHJldHVybiBkYlxuICAgICAgICAudHJhbnNhY3Rpb24oW0RCX09CSkVDVFNUT1JFX05BTUVdLCBpc1JlYWRXcml0ZSA/ICdyZWFkd3JpdGUnIDogJ3JlYWRvbmx5JylcbiAgICAgICAgLm9iamVjdFN0b3JlKERCX09CSkVDVFNUT1JFX05BTUUpO1xufVxuZnVuY3Rpb24gX2RlbGV0ZURhdGFiYXNlKCkge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBpbmRleGVkREIuZGVsZXRlRGF0YWJhc2UoREJfTkFNRSk7XG4gICAgcmV0dXJuIG5ldyBEQlByb21pc2UocmVxdWVzdCkudG9Qcm9taXNlKCk7XG59XG5mdW5jdGlvbiBfb3BlbkRhdGFiYXNlKCkge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBpbmRleGVkREIub3BlbihEQl9OQU1FLCBEQl9WRVJTSU9OKTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgKCkgPT4ge1xuICAgICAgICAgICAgcmVqZWN0KHJlcXVlc3QuZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCd1cGdyYWRlbmVlZGVkJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZGIgPSByZXF1ZXN0LnJlc3VsdDtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZGIuY3JlYXRlT2JqZWN0U3RvcmUoREJfT0JKRUNUU1RPUkVfTkFNRSwgeyBrZXlQYXRoOiBEQl9EQVRBX0tFWVBBVEggfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcignc3VjY2VzcycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRiID0gcmVxdWVzdC5yZXN1bHQ7XG4gICAgICAgICAgICAvLyBTdHJhbmdlIGJ1ZyB0aGF0IG9jY3VycyBpbiBGaXJlZm94IHdoZW4gbXVsdGlwbGUgdGFicyBhcmUgb3BlbmVkIGF0IHRoZVxuICAgICAgICAgICAgLy8gc2FtZSB0aW1lLiBUaGUgb25seSB3YXkgdG8gcmVjb3ZlciBzZWVtcyB0byBiZSBkZWxldGluZyB0aGUgZGF0YWJhc2VcbiAgICAgICAgICAgIC8vIGFuZCByZS1pbml0aWFsaXppbmcgaXQuXG4gICAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZmlyZWJhc2UvZmlyZWJhc2UtanMtc2RrL2lzc3Vlcy82MzRcbiAgICAgICAgICAgIGlmICghZGIub2JqZWN0U3RvcmVOYW1lcy5jb250YWlucyhEQl9PQkpFQ1RTVE9SRV9OQU1FKSkge1xuICAgICAgICAgICAgICAgIC8vIE5lZWQgdG8gY2xvc2UgdGhlIGRhdGFiYXNlIG9yIGVsc2UgeW91IGdldCBhIGBibG9ja2VkYCBldmVudFxuICAgICAgICAgICAgICAgIGRiLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgX2RlbGV0ZURhdGFiYXNlKCk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShhd2FpdCBfb3BlbkRhdGFiYXNlKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShkYik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuYXN5bmMgZnVuY3Rpb24gX3B1dE9iamVjdChkYiwga2V5LCB2YWx1ZSkge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBnZXRPYmplY3RTdG9yZShkYiwgdHJ1ZSkucHV0KHtcbiAgICAgICAgW0RCX0RBVEFfS0VZUEFUSF06IGtleSxcbiAgICAgICAgdmFsdWVcbiAgICB9KTtcbiAgICByZXR1cm4gbmV3IERCUHJvbWlzZShyZXF1ZXN0KS50b1Byb21pc2UoKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGdldE9iamVjdChkYiwga2V5KSB7XG4gICAgY29uc3QgcmVxdWVzdCA9IGdldE9iamVjdFN0b3JlKGRiLCBmYWxzZSkuZ2V0KGtleSk7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IG5ldyBEQlByb21pc2UocmVxdWVzdCkudG9Qcm9taXNlKCk7XG4gICAgcmV0dXJuIGRhdGEgPT09IHVuZGVmaW5lZCA/IG51bGwgOiBkYXRhLnZhbHVlO1xufVxuZnVuY3Rpb24gX2RlbGV0ZU9iamVjdChkYiwga2V5KSB7XG4gICAgY29uc3QgcmVxdWVzdCA9IGdldE9iamVjdFN0b3JlKGRiLCB0cnVlKS5kZWxldGUoa2V5KTtcbiAgICByZXR1cm4gbmV3IERCUHJvbWlzZShyZXF1ZXN0KS50b1Byb21pc2UoKTtcbn1cbmNvbnN0IF9QT0xMSU5HX0lOVEVSVkFMX01TID0gODAwO1xuY29uc3QgX1RSQU5TQUNUSU9OX1JFVFJZX0NPVU5UID0gMztcbmNsYXNzIEluZGV4ZWREQkxvY2FsUGVyc2lzdGVuY2Uge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnR5cGUgPSBcIkxPQ0FMXCIgLyogUGVyc2lzdGVuY2VUeXBlLkxPQ0FMICovO1xuICAgICAgICB0aGlzLl9zaG91bGRBbGxvd01pZ3JhdGlvbiA9IHRydWU7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0ge307XG4gICAgICAgIHRoaXMubG9jYWxDYWNoZSA9IHt9O1xuICAgICAgICAvLyBzZXRUaW1lb3V0IHJldHVybiB2YWx1ZSBpcyBwbGF0Zm9ybSBzcGVjaWZpY1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICB0aGlzLnBvbGxUaW1lciA9IG51bGw7XG4gICAgICAgIHRoaXMucGVuZGluZ1dyaXRlcyA9IDA7XG4gICAgICAgIHRoaXMucmVjZWl2ZXIgPSBudWxsO1xuICAgICAgICB0aGlzLnNlbmRlciA9IG51bGw7XG4gICAgICAgIHRoaXMuc2VydmljZVdvcmtlclJlY2VpdmVyQXZhaWxhYmxlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYWN0aXZlU2VydmljZVdvcmtlciA9IG51bGw7XG4gICAgICAgIC8vIEZpcmUgJiBmb3JnZXQgdGhlIHNlcnZpY2Ugd29ya2VyIHJlZ2lzdHJhdGlvbiBhcyBpdCBtYXkgbmV2ZXIgcmVzb2x2ZVxuICAgICAgICB0aGlzLl93b3JrZXJJbml0aWFsaXphdGlvblByb21pc2UgPVxuICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplU2VydmljZVdvcmtlck1lc3NhZ2luZygpLnRoZW4oKCkgPT4geyB9LCAoKSA9PiB7IH0pO1xuICAgIH1cbiAgICBhc3luYyBfb3BlbkRiKCkge1xuICAgICAgICBpZiAodGhpcy5kYikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGI7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kYiA9IGF3YWl0IF9vcGVuRGF0YWJhc2UoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGI7XG4gICAgfVxuICAgIGFzeW5jIF93aXRoUmV0cmllcyhvcCkge1xuICAgICAgICBsZXQgbnVtQXR0ZW1wdHMgPSAwO1xuICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYiA9IGF3YWl0IHRoaXMuX29wZW5EYigpO1xuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCBvcChkYik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGlmIChudW1BdHRlbXB0cysrID4gX1RSQU5TQUNUSU9OX1JFVFJZX0NPVU5UKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGIuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYiA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gVE9ETzogY29uc2lkZXIgYWRkaW5nIGV4cG9uZW50aWFsIGJhY2tvZmZcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbmRleGVkREIgZXZlbnRzIGRvIG5vdCBwcm9wYWdhdGUgZnJvbSB0aGUgbWFpbiB3aW5kb3cgdG8gdGhlIHdvcmtlciBjb250ZXh0LiAgV2UgcmVseSBvbiBhXG4gICAgICogcG9zdE1lc3NhZ2UgaW50ZXJmYWNlIHRvIHNlbmQgdGhlc2UgZXZlbnRzIHRvIHRoZSB3b3JrZXIgb3Vyc2VsdmVzLlxuICAgICAqL1xuICAgIGFzeW5jIGluaXRpYWxpemVTZXJ2aWNlV29ya2VyTWVzc2FnaW5nKCkge1xuICAgICAgICByZXR1cm4gX2lzV29ya2VyKCkgPyB0aGlzLmluaXRpYWxpemVSZWNlaXZlcigpIDogdGhpcy5pbml0aWFsaXplU2VuZGVyKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFzIHRoZSB3b3JrZXIgd2Ugc2hvdWxkIGxpc3RlbiB0byBldmVudHMgZnJvbSB0aGUgbWFpbiB3aW5kb3cuXG4gICAgICovXG4gICAgYXN5bmMgaW5pdGlhbGl6ZVJlY2VpdmVyKCkge1xuICAgICAgICB0aGlzLnJlY2VpdmVyID0gUmVjZWl2ZXIuX2dldEluc3RhbmNlKF9nZXRXb3JrZXJHbG9iYWxTY29wZSgpKTtcbiAgICAgICAgLy8gUmVmcmVzaCBmcm9tIHBlcnNpc3RlbmNlIGlmIHdlIHJlY2VpdmUgYSBLZXlDaGFuZ2VkIG1lc3NhZ2UuXG4gICAgICAgIHRoaXMucmVjZWl2ZXIuX3N1YnNjcmliZShcImtleUNoYW5nZWRcIiAvKiBfRXZlbnRUeXBlLktFWV9DSEFOR0VEICovLCBhc3luYyAoX29yaWdpbiwgZGF0YSkgPT4ge1xuICAgICAgICAgICAgY29uc3Qga2V5cyA9IGF3YWl0IHRoaXMuX3BvbGwoKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAga2V5UHJvY2Vzc2VkOiBrZXlzLmluY2x1ZGVzKGRhdGEua2V5KVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIExldCB0aGUgc2VuZGVyIGtub3cgdGhhdCB3ZSBhcmUgbGlzdGVuaW5nIHNvIHRoZXkgZ2l2ZSB1cyBtb3JlIHRpbWVvdXQuXG4gICAgICAgIHRoaXMucmVjZWl2ZXIuX3N1YnNjcmliZShcInBpbmdcIiAvKiBfRXZlbnRUeXBlLlBJTkcgKi8sIGFzeW5jIChfb3JpZ2luLCBfZGF0YSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIFtcImtleUNoYW5nZWRcIiAvKiBfRXZlbnRUeXBlLktFWV9DSEFOR0VEICovXTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFzIHRoZSBtYWluIHdpbmRvdywgd2Ugc2hvdWxkIGxldCB0aGUgd29ya2VyIGtub3cgd2hlbiBrZXlzIGNoYW5nZSAoc2V0IGFuZCByZW1vdmUpLlxuICAgICAqXG4gICAgICogQHJlbWFya3NcbiAgICAgKiB7QGxpbmsgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL1NlcnZpY2VXb3JrZXJDb250YWluZXIvcmVhZHkgfCBTZXJ2aWNlV29ya2VyQ29udGFpbmVyLnJlYWR5fVxuICAgICAqIG1heSBub3QgcmVzb2x2ZS5cbiAgICAgKi9cbiAgICBhc3luYyBpbml0aWFsaXplU2VuZGVyKCkge1xuICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhlcmUncyBhbiBhY3RpdmUgc2VydmljZSB3b3JrZXIuXG4gICAgICAgIHRoaXMuYWN0aXZlU2VydmljZVdvcmtlciA9IGF3YWl0IF9nZXRBY3RpdmVTZXJ2aWNlV29ya2VyKCk7XG4gICAgICAgIGlmICghdGhpcy5hY3RpdmVTZXJ2aWNlV29ya2VyKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZW5kZXIgPSBuZXcgU2VuZGVyKHRoaXMuYWN0aXZlU2VydmljZVdvcmtlcik7XG4gICAgICAgIC8vIFBpbmcgdGhlIHNlcnZpY2Ugd29ya2VyIHRvIGNoZWNrIHdoYXQgZXZlbnRzIHRoZXkgY2FuIGhhbmRsZS5cbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHRoaXMuc2VuZGVyLl9zZW5kKFwicGluZ1wiIC8qIF9FdmVudFR5cGUuUElORyAqLywge30sIDgwMCAvKiBfVGltZW91dER1cmF0aW9uLkxPTkdfQUNLICovKTtcbiAgICAgICAgaWYgKCFyZXN1bHRzKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlc3VsdHNbMF0/LmZ1bGZpbGxlZCAmJlxuICAgICAgICAgICAgcmVzdWx0c1swXT8udmFsdWUuaW5jbHVkZXMoXCJrZXlDaGFuZ2VkXCIgLyogX0V2ZW50VHlwZS5LRVlfQ0hBTkdFRCAqLykpIHtcbiAgICAgICAgICAgIHRoaXMuc2VydmljZVdvcmtlclJlY2VpdmVyQXZhaWxhYmxlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBMZXQgdGhlIHdvcmtlciBrbm93IGFib3V0IGEgY2hhbmdlZCBrZXksIHRoZSBleGFjdCBrZXkgZG9lc24ndCB0ZWNobmljYWxseSBtYXR0ZXIgc2luY2UgdGhlXG4gICAgICogd29ya2VyIHdpbGwganVzdCB0cmlnZ2VyIGEgZnVsbCBzeW5jIGFueXdheS5cbiAgICAgKlxuICAgICAqIEByZW1hcmtzXG4gICAgICogRm9yIG5vdywgd2Ugb25seSBzdXBwb3J0IG9uZSBzZXJ2aWNlIHdvcmtlciBwZXIgcGFnZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBrZXkgLSBTdG9yYWdlIGtleSB3aGljaCBjaGFuZ2VkLlxuICAgICAqL1xuICAgIGFzeW5jIG5vdGlmeVNlcnZpY2VXb3JrZXIoa2V5KSB7XG4gICAgICAgIGlmICghdGhpcy5zZW5kZXIgfHxcbiAgICAgICAgICAgICF0aGlzLmFjdGl2ZVNlcnZpY2VXb3JrZXIgfHxcbiAgICAgICAgICAgIF9nZXRTZXJ2aWNlV29ya2VyQ29udHJvbGxlcigpICE9PSB0aGlzLmFjdGl2ZVNlcnZpY2VXb3JrZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5zZW5kZXIuX3NlbmQoXCJrZXlDaGFuZ2VkXCIgLyogX0V2ZW50VHlwZS5LRVlfQ0hBTkdFRCAqLywgeyBrZXkgfSwgXG4gICAgICAgICAgICAvLyBVc2UgbG9uZyB0aW1lb3V0IGlmIHJlY2VpdmVyIGhhcyBwcmV2aW91c2x5IHJlc3BvbmRlZCB0byBhIHBpbmcgZnJvbSB1cy5cbiAgICAgICAgICAgIHRoaXMuc2VydmljZVdvcmtlclJlY2VpdmVyQXZhaWxhYmxlXG4gICAgICAgICAgICAgICAgPyA4MDAgLyogX1RpbWVvdXREdXJhdGlvbi5MT05HX0FDSyAqL1xuICAgICAgICAgICAgICAgIDogNTAgLyogX1RpbWVvdXREdXJhdGlvbi5BQ0sgKi8pO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBiZXN0IGVmZm9ydCBhcHByb2FjaC4gSWdub3JlIGVycm9ycy5cbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBfaXNBdmFpbGFibGUoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoIWluZGV4ZWREQikge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGRiID0gYXdhaXQgX29wZW5EYXRhYmFzZSgpO1xuICAgICAgICAgICAgYXdhaXQgX3B1dE9iamVjdChkYiwgU1RPUkFHRV9BVkFJTEFCTEVfS0VZLCAnMScpO1xuICAgICAgICAgICAgYXdhaXQgX2RlbGV0ZU9iamVjdChkYiwgU1RPUkFHRV9BVkFJTEFCTEVfS0VZKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIHsgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGFzeW5jIF93aXRoUGVuZGluZ1dyaXRlKHdyaXRlKSB7XG4gICAgICAgIHRoaXMucGVuZGluZ1dyaXRlcysrO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgd3JpdGUoKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMucGVuZGluZ1dyaXRlcy0tO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFzeW5jIF9zZXQoa2V5LCB2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fd2l0aFBlbmRpbmdXcml0ZShhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLl93aXRoUmV0cmllcygoZGIpID0+IF9wdXRPYmplY3QoZGIsIGtleSwgdmFsdWUpKTtcbiAgICAgICAgICAgIHRoaXMubG9jYWxDYWNoZVtrZXldID0gdmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ub3RpZnlTZXJ2aWNlV29ya2VyKGtleSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhc3luYyBfZ2V0KGtleSkge1xuICAgICAgICBjb25zdCBvYmogPSAoYXdhaXQgdGhpcy5fd2l0aFJldHJpZXMoKGRiKSA9PiBnZXRPYmplY3QoZGIsIGtleSkpKTtcbiAgICAgICAgdGhpcy5sb2NhbENhY2hlW2tleV0gPSBvYmo7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgfVxuICAgIGFzeW5jIF9yZW1vdmUoa2V5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl93aXRoUGVuZGluZ1dyaXRlKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuX3dpdGhSZXRyaWVzKChkYikgPT4gX2RlbGV0ZU9iamVjdChkYiwga2V5KSk7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5sb2NhbENhY2hlW2tleV07XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ub3RpZnlTZXJ2aWNlV29ya2VyKGtleSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhc3luYyBfcG9sbCgpIHtcbiAgICAgICAgLy8gVE9ETzogY2hlY2sgaWYgd2UgbmVlZCB0byBmYWxsYmFjayBpZiBnZXRBbGwgaXMgbm90IHN1cHBvcnRlZFxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLl93aXRoUmV0cmllcygoZGIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGdldEFsbFJlcXVlc3QgPSBnZXRPYmplY3RTdG9yZShkYiwgZmFsc2UpLmdldEFsbCgpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBEQlByb21pc2UoZ2V0QWxsUmVxdWVzdCkudG9Qcm9taXNlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIC8vIElmIHdlIGhhdmUgcGVuZGluZyB3cml0ZXMgaW4gcHJvZ3Jlc3MgYWJvcnQsIHdlJ2xsIGdldCBwaWNrZWQgdXAgb24gdGhlIG5leHQgcG9sbFxuICAgICAgICBpZiAodGhpcy5wZW5kaW5nV3JpdGVzICE9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qga2V5cyA9IFtdO1xuICAgICAgICBjb25zdCBrZXlzSW5SZXN1bHQgPSBuZXcgU2V0KCk7XG4gICAgICAgIGlmIChyZXN1bHQubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHsgZmJhc2Vfa2V5OiBrZXksIHZhbHVlIH0gb2YgcmVzdWx0KSB7XG4gICAgICAgICAgICAgICAga2V5c0luUmVzdWx0LmFkZChrZXkpO1xuICAgICAgICAgICAgICAgIGlmIChKU09OLnN0cmluZ2lmeSh0aGlzLmxvY2FsQ2FjaGVba2V5XSkgIT09IEpTT04uc3RyaW5naWZ5KHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeUxpc3RlbmVycyhrZXksIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAga2V5cy5wdXNoKGtleSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgbG9jYWxLZXkgb2YgT2JqZWN0LmtleXModGhpcy5sb2NhbENhY2hlKSkge1xuICAgICAgICAgICAgaWYgKHRoaXMubG9jYWxDYWNoZVtsb2NhbEtleV0gJiYgIWtleXNJblJlc3VsdC5oYXMobG9jYWxLZXkpKSB7XG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlZFxuICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5TGlzdGVuZXJzKGxvY2FsS2V5LCBudWxsKTtcbiAgICAgICAgICAgICAgICBrZXlzLnB1c2gobG9jYWxLZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBrZXlzO1xuICAgIH1cbiAgICBub3RpZnlMaXN0ZW5lcnMoa2V5LCBuZXdWYWx1ZSkge1xuICAgICAgICB0aGlzLmxvY2FsQ2FjaGVba2V5XSA9IG5ld1ZhbHVlO1xuICAgICAgICBjb25zdCBsaXN0ZW5lcnMgPSB0aGlzLmxpc3RlbmVyc1trZXldO1xuICAgICAgICBpZiAobGlzdGVuZXJzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIEFycmF5LmZyb20obGlzdGVuZXJzKSkge1xuICAgICAgICAgICAgICAgIGxpc3RlbmVyKG5ld1ZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGFydFBvbGxpbmcoKSB7XG4gICAgICAgIHRoaXMuc3RvcFBvbGxpbmcoKTtcbiAgICAgICAgdGhpcy5wb2xsVGltZXIgPSBzZXRJbnRlcnZhbChhc3luYyAoKSA9PiB0aGlzLl9wb2xsKCksIF9QT0xMSU5HX0lOVEVSVkFMX01TKTtcbiAgICB9XG4gICAgc3RvcFBvbGxpbmcoKSB7XG4gICAgICAgIGlmICh0aGlzLnBvbGxUaW1lcikge1xuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnBvbGxUaW1lcik7XG4gICAgICAgICAgICB0aGlzLnBvbGxUaW1lciA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2FkZExpc3RlbmVyKGtleSwgbGlzdGVuZXIpIHtcbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKHRoaXMubGlzdGVuZXJzKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRQb2xsaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLmxpc3RlbmVyc1trZXldKSB7XG4gICAgICAgICAgICB0aGlzLmxpc3RlbmVyc1trZXldID0gbmV3IFNldCgpO1xuICAgICAgICAgICAgLy8gUG9wdWxhdGUgdGhlIGNhY2hlIHRvIGF2b2lkIHNwdXJpb3VzbHkgdHJpZ2dlcmluZyBvbiBmaXJzdCBwb2xsLlxuICAgICAgICAgICAgdm9pZCB0aGlzLl9nZXQoa2V5KTsgLy8gVGhpcyBjYW4gaGFwcGVuIGluIHRoZSBiYWNrZ3JvdW5kIGFzeW5jIGFuZCB3ZSBjYW4gcmV0dXJuIGltbWVkaWF0ZWx5LlxuICAgICAgICB9XG4gICAgICAgIHRoaXMubGlzdGVuZXJzW2tleV0uYWRkKGxpc3RlbmVyKTtcbiAgICB9XG4gICAgX3JlbW92ZUxpc3RlbmVyKGtleSwgbGlzdGVuZXIpIHtcbiAgICAgICAgaWYgKHRoaXMubGlzdGVuZXJzW2tleV0pIHtcbiAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzW2tleV0uZGVsZXRlKGxpc3RlbmVyKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmxpc3RlbmVyc1trZXldLnNpemUgPT09IDApIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5saXN0ZW5lcnNba2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5saXN0ZW5lcnMpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5zdG9wUG9sbGluZygpO1xuICAgICAgICB9XG4gICAgfVxufVxuSW5kZXhlZERCTG9jYWxQZXJzaXN0ZW5jZS50eXBlID0gJ0xPQ0FMJztcbi8qKlxuICogQW4gaW1wbGVtZW50YXRpb24gb2Yge0BsaW5rIFBlcnNpc3RlbmNlfSBvZiB0eXBlIGBMT0NBTGAgdXNpbmcgYGluZGV4ZWREQmBcbiAqIGZvciB0aGUgdW5kZXJseWluZyBzdG9yYWdlLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuY29uc3QgaW5kZXhlZERCTG9jYWxQZXJzaXN0ZW5jZSA9IEluZGV4ZWREQkxvY2FsUGVyc2lzdGVuY2U7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5mdW5jdGlvbiBzdGFydFNpZ25JblBob25lTWZhKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjIvYWNjb3VudHMvbWZhU2lnbkluOnN0YXJ0XCIgLyogRW5kcG9pbnQuU1RBUlRfTUZBX1NJR05fSU4gKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XG59XG5mdW5jdGlvbiBmaW5hbGl6ZVNpZ25JblBob25lTWZhKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjIvYWNjb3VudHMvbWZhU2lnbkluOmZpbmFsaXplXCIgLyogRW5kcG9pbnQuRklOQUxJWkVfTUZBX1NJR05fSU4gKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XG59XG5mdW5jdGlvbiBmaW5hbGl6ZVNpZ25JblRvdHBNZmEoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92Mi9hY2NvdW50cy9tZmFTaWduSW46ZmluYWxpemVcIiAvKiBFbmRwb2ludC5GSU5BTElaRV9NRkFfU0lHTl9JTiAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcbn1cblxuY2xhc3MgTXVsdGlGYWN0b3JBc3NlcnRpb25JbXBsIHtcbiAgICBjb25zdHJ1Y3RvcihmYWN0b3JJZCkge1xuICAgICAgICB0aGlzLmZhY3RvcklkID0gZmFjdG9ySWQ7XG4gICAgfVxuICAgIF9wcm9jZXNzKGF1dGgsIHNlc3Npb24sIGRpc3BsYXlOYW1lKSB7XG4gICAgICAgIHN3aXRjaCAoc2Vzc2lvbi50eXBlKSB7XG4gICAgICAgICAgICBjYXNlIFwiZW5yb2xsXCIgLyogTXVsdGlGYWN0b3JTZXNzaW9uVHlwZS5FTlJPTEwgKi86XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2ZpbmFsaXplRW5yb2xsKGF1dGgsIHNlc3Npb24uY3JlZGVudGlhbCwgZGlzcGxheU5hbWUpO1xuICAgICAgICAgICAgY2FzZSBcInNpZ25pblwiIC8qIE11bHRpRmFjdG9yU2Vzc2lvblR5cGUuU0lHTl9JTiAqLzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZmluYWxpemVTaWduSW4oYXV0aCwgc2Vzc2lvbi5jcmVkZW50aWFsKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlYnVnRmFpbCgndW5leHBlY3RlZCBNdWx0aUZhY3RvclNlc3Npb25UeXBlJyk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8qKlxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcgYSB7QGxpbmsgVG90cE11bHRpRmFjdG9yQXNzZXJ0aW9ufS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmNsYXNzIFRvdHBNdWx0aUZhY3RvckdlbmVyYXRvciB7XG4gICAgLyoqXG4gICAgICogUHJvdmlkZXMgYSB7QGxpbmsgVG90cE11bHRpRmFjdG9yQXNzZXJ0aW9ufSB0byBjb25maXJtIG93bmVyc2hpcCBvZlxuICAgICAqIHRoZSBUT1RQICh0aW1lLWJhc2VkIG9uZS10aW1lIHBhc3N3b3JkKSBzZWNvbmQgZmFjdG9yLlxuICAgICAqIFRoaXMgYXNzZXJ0aW9uIGlzIHVzZWQgdG8gY29tcGxldGUgZW5yb2xsbWVudCBpbiBUT1RQIHNlY29uZCBmYWN0b3IuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2VjcmV0IEEge0BsaW5rIFRvdHBTZWNyZXR9IGNvbnRhaW5pbmcgdGhlIHNoYXJlZCBzZWNyZXQga2V5IGFuZCBvdGhlciBUT1RQIHBhcmFtZXRlcnMuXG4gICAgICogQHBhcmFtIG9uZVRpbWVQYXNzd29yZCBPbmUtdGltZSBwYXNzd29yZCBmcm9tIFRPVFAgQXBwLlxuICAgICAqIEByZXR1cm5zIEEge0BsaW5rIFRvdHBNdWx0aUZhY3RvckFzc2VydGlvbn0gd2hpY2ggY2FuIGJlIHVzZWQgd2l0aFxuICAgICAqIHtAbGluayBNdWx0aUZhY3RvclVzZXIuZW5yb2xsfS5cbiAgICAgKi9cbiAgICBzdGF0aWMgYXNzZXJ0aW9uRm9yRW5yb2xsbWVudChzZWNyZXQsIG9uZVRpbWVQYXNzd29yZCkge1xuICAgICAgICByZXR1cm4gVG90cE11bHRpRmFjdG9yQXNzZXJ0aW9uSW1wbC5fZnJvbVNlY3JldChzZWNyZXQsIG9uZVRpbWVQYXNzd29yZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFByb3ZpZGVzIGEge0BsaW5rIFRvdHBNdWx0aUZhY3RvckFzc2VydGlvbn0gdG8gY29uZmlybSBvd25lcnNoaXAgb2YgdGhlIFRPVFAgc2Vjb25kIGZhY3Rvci5cbiAgICAgKiBUaGlzIGFzc2VydGlvbiBpcyB1c2VkIHRvIGNvbXBsZXRlIHNpZ25JbiB3aXRoIFRPVFAgYXMgdGhlIHNlY29uZCBmYWN0b3IuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZW5yb2xsbWVudElkIGlkZW50aWZpZXMgdGhlIGVucm9sbGVkIFRPVFAgc2Vjb25kIGZhY3Rvci5cbiAgICAgKiBAcGFyYW0gb25lVGltZVBhc3N3b3JkIE9uZS10aW1lIHBhc3N3b3JkIGZyb20gVE9UUCBBcHAuXG4gICAgICogQHJldHVybnMgQSB7QGxpbmsgVG90cE11bHRpRmFjdG9yQXNzZXJ0aW9ufSB3aGljaCBjYW4gYmUgdXNlZCB3aXRoXG4gICAgICoge0BsaW5rIE11bHRpRmFjdG9yUmVzb2x2ZXIucmVzb2x2ZVNpZ25Jbn0uXG4gICAgICovXG4gICAgc3RhdGljIGFzc2VydGlvbkZvclNpZ25JbihlbnJvbGxtZW50SWQsIG9uZVRpbWVQYXNzd29yZCkge1xuICAgICAgICByZXR1cm4gVG90cE11bHRpRmFjdG9yQXNzZXJ0aW9uSW1wbC5fZnJvbUVucm9sbG1lbnRJZChlbnJvbGxtZW50SWQsIG9uZVRpbWVQYXNzd29yZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBwcm9taXNlIHRvIHtAbGluayBUb3RwU2VjcmV0fSB3aGljaCBjb250YWlucyB0aGUgVE9UUCBzaGFyZWQgc2VjcmV0IGtleSBhbmQgb3RoZXIgcGFyYW1ldGVycy5cbiAgICAgKiBDcmVhdGVzIGEgVE9UUCBzZWNyZXQgYXMgcGFydCBvZiBlbnJvbGxpbmcgYSBUT1RQIHNlY29uZCBmYWN0b3IuXG4gICAgICogVXNlZCBmb3IgZ2VuZXJhdGluZyBhIFFSIGNvZGUgVVJMIG9yIGlucHV0dGluZyBpbnRvIGEgVE9UUCBhcHAuXG4gICAgICogVGhpcyBtZXRob2QgdXNlcyB0aGUgYXV0aCBpbnN0YW5jZSBjb3JyZXNwb25kaW5nIHRvIHRoZSB1c2VyIGluIHRoZSBtdWx0aUZhY3RvclNlc3Npb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2Vzc2lvbiBUaGUge0BsaW5rIE11bHRpRmFjdG9yU2Vzc2lvbn0gdGhhdCB0aGUgdXNlciBpcyBwYXJ0IG9mLlxuICAgICAqIEByZXR1cm5zIEEgcHJvbWlzZSB0byB7QGxpbmsgVG90cFNlY3JldH0uXG4gICAgICovXG4gICAgc3RhdGljIGFzeW5jIGdlbmVyYXRlU2VjcmV0KHNlc3Npb24pIHtcbiAgICAgICAgY29uc3QgbWZhU2Vzc2lvbiA9IHNlc3Npb247XG4gICAgICAgIF9hc3NlcnQodHlwZW9mIG1mYVNlc3Npb24udXNlcj8uYXV0aCAhPT0gJ3VuZGVmaW5lZCcsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzdGFydEVucm9sbFRvdHBNZmEobWZhU2Vzc2lvbi51c2VyLmF1dGgsIHtcbiAgICAgICAgICAgIGlkVG9rZW46IG1mYVNlc3Npb24uY3JlZGVudGlhbCxcbiAgICAgICAgICAgIHRvdHBFbnJvbGxtZW50SW5mbzoge31cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBUb3RwU2VjcmV0Ll9mcm9tU3RhcnRUb3RwTWZhRW5yb2xsbWVudFJlc3BvbnNlKHJlc3BvbnNlLCBtZmFTZXNzaW9uLnVzZXIuYXV0aCk7XG4gICAgfVxufVxuLyoqXG4gKiBUaGUgaWRlbnRpZmllciBvZiB0aGUgVE9UUCBzZWNvbmQgZmFjdG9yOiBgdG90cGAuXG4gKi9cblRvdHBNdWx0aUZhY3RvckdlbmVyYXRvci5GQUNUT1JfSUQgPSBcInRvdHBcIiAvKiBGYWN0b3JJZC5UT1RQICovO1xuY2xhc3MgVG90cE11bHRpRmFjdG9yQXNzZXJ0aW9uSW1wbCBleHRlbmRzIE11bHRpRmFjdG9yQXNzZXJ0aW9uSW1wbCB7XG4gICAgY29uc3RydWN0b3Iob3RwLCBlbnJvbGxtZW50SWQsIHNlY3JldCkge1xuICAgICAgICBzdXBlcihcInRvdHBcIiAvKiBGYWN0b3JJZC5UT1RQICovKTtcbiAgICAgICAgdGhpcy5vdHAgPSBvdHA7XG4gICAgICAgIHRoaXMuZW5yb2xsbWVudElkID0gZW5yb2xsbWVudElkO1xuICAgICAgICB0aGlzLnNlY3JldCA9IHNlY3JldDtcbiAgICB9XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIHN0YXRpYyBfZnJvbVNlY3JldChzZWNyZXQsIG90cCkge1xuICAgICAgICByZXR1cm4gbmV3IFRvdHBNdWx0aUZhY3RvckFzc2VydGlvbkltcGwob3RwLCB1bmRlZmluZWQsIHNlY3JldCk7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBzdGF0aWMgX2Zyb21FbnJvbGxtZW50SWQoZW5yb2xsbWVudElkLCBvdHApIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUb3RwTXVsdGlGYWN0b3JBc3NlcnRpb25JbXBsKG90cCwgZW5yb2xsbWVudElkKTtcbiAgICB9XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIGFzeW5jIF9maW5hbGl6ZUVucm9sbChhdXRoLCBpZFRva2VuLCBkaXNwbGF5TmFtZSkge1xuICAgICAgICBfYXNzZXJ0KHR5cGVvZiB0aGlzLnNlY3JldCAhPT0gJ3VuZGVmaW5lZCcsIGF1dGgsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SICovKTtcbiAgICAgICAgcmV0dXJuIGZpbmFsaXplRW5yb2xsVG90cE1mYShhdXRoLCB7XG4gICAgICAgICAgICBpZFRva2VuLFxuICAgICAgICAgICAgZGlzcGxheU5hbWUsXG4gICAgICAgICAgICB0b3RwVmVyaWZpY2F0aW9uSW5mbzogdGhpcy5zZWNyZXQuX21ha2VUb3RwVmVyaWZpY2F0aW9uSW5mbyh0aGlzLm90cClcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBhc3luYyBfZmluYWxpemVTaWduSW4oYXV0aCwgbWZhUGVuZGluZ0NyZWRlbnRpYWwpIHtcbiAgICAgICAgX2Fzc2VydCh0aGlzLmVucm9sbG1lbnRJZCAhPT0gdW5kZWZpbmVkICYmIHRoaXMub3RwICE9PSB1bmRlZmluZWQsIGF1dGgsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SICovKTtcbiAgICAgICAgY29uc3QgdG90cFZlcmlmaWNhdGlvbkluZm8gPSB7IHZlcmlmaWNhdGlvbkNvZGU6IHRoaXMub3RwIH07XG4gICAgICAgIHJldHVybiBmaW5hbGl6ZVNpZ25JblRvdHBNZmEoYXV0aCwge1xuICAgICAgICAgICAgbWZhUGVuZGluZ0NyZWRlbnRpYWwsXG4gICAgICAgICAgICBtZmFFbnJvbGxtZW50SWQ6IHRoaXMuZW5yb2xsbWVudElkLFxuICAgICAgICAgICAgdG90cFZlcmlmaWNhdGlvbkluZm9cbiAgICAgICAgfSk7XG4gICAgfVxufVxuLyoqXG4gKiBQcm92aWRlciBmb3IgZ2VuZXJhdGluZyBhIHtAbGluayBUb3RwTXVsdGlGYWN0b3JBc3NlcnRpb259LlxuICpcbiAqIFN0b3JlcyB0aGUgc2hhcmVkIHNlY3JldCBrZXkgYW5kIG90aGVyIHBhcmFtZXRlcnMgdG8gZ2VuZXJhdGUgdGltZS1iYXNlZCBPVFBzLlxuICogSW1wbGVtZW50cyBtZXRob2RzIHRvIHJldHJpZXZlIHRoZSBzaGFyZWQgc2VjcmV0IGtleSBhbmQgZ2VuZXJhdGUgYSBRUiBjb2RlIFVSTC5cbiAqIEBwdWJsaWNcbiAqL1xuY2xhc3MgVG90cFNlY3JldCB7XG4gICAgLy8gVGhlIHB1YmxpYyBtZW1iZXJzIGFyZSBkZWNsYXJlZCBvdXRzaWRlIHRoZSBjb25zdHJ1Y3RvciBzbyB0aGUgZG9jcyBjYW4gYmUgZ2VuZXJhdGVkLlxuICAgIGNvbnN0cnVjdG9yKHNlY3JldEtleSwgaGFzaGluZ0FsZ29yaXRobSwgY29kZUxlbmd0aCwgY29kZUludGVydmFsU2Vjb25kcywgZW5yb2xsbWVudENvbXBsZXRpb25EZWFkbGluZSwgc2Vzc2lvbkluZm8sIGF1dGgpIHtcbiAgICAgICAgdGhpcy5zZXNzaW9uSW5mbyA9IHNlc3Npb25JbmZvO1xuICAgICAgICB0aGlzLmF1dGggPSBhdXRoO1xuICAgICAgICB0aGlzLnNlY3JldEtleSA9IHNlY3JldEtleTtcbiAgICAgICAgdGhpcy5oYXNoaW5nQWxnb3JpdGhtID0gaGFzaGluZ0FsZ29yaXRobTtcbiAgICAgICAgdGhpcy5jb2RlTGVuZ3RoID0gY29kZUxlbmd0aDtcbiAgICAgICAgdGhpcy5jb2RlSW50ZXJ2YWxTZWNvbmRzID0gY29kZUludGVydmFsU2Vjb25kcztcbiAgICAgICAgdGhpcy5lbnJvbGxtZW50Q29tcGxldGlvbkRlYWRsaW5lID0gZW5yb2xsbWVudENvbXBsZXRpb25EZWFkbGluZTtcbiAgICB9XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIHN0YXRpYyBfZnJvbVN0YXJ0VG90cE1mYUVucm9sbG1lbnRSZXNwb25zZShyZXNwb25zZSwgYXV0aCkge1xuICAgICAgICByZXR1cm4gbmV3IFRvdHBTZWNyZXQocmVzcG9uc2UudG90cFNlc3Npb25JbmZvLnNoYXJlZFNlY3JldEtleSwgcmVzcG9uc2UudG90cFNlc3Npb25JbmZvLmhhc2hpbmdBbGdvcml0aG0sIHJlc3BvbnNlLnRvdHBTZXNzaW9uSW5mby52ZXJpZmljYXRpb25Db2RlTGVuZ3RoLCByZXNwb25zZS50b3RwU2Vzc2lvbkluZm8ucGVyaW9kU2VjLCBuZXcgRGF0ZShyZXNwb25zZS50b3RwU2Vzc2lvbkluZm8uZmluYWxpemVFbnJvbGxtZW50VGltZSkudG9VVENTdHJpbmcoKSwgcmVzcG9uc2UudG90cFNlc3Npb25JbmZvLnNlc3Npb25JbmZvLCBhdXRoKTtcbiAgICB9XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIF9tYWtlVG90cFZlcmlmaWNhdGlvbkluZm8ob3RwKSB7XG4gICAgICAgIHJldHVybiB7IHNlc3Npb25JbmZvOiB0aGlzLnNlc3Npb25JbmZvLCB2ZXJpZmljYXRpb25Db2RlOiBvdHAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIFFSIGNvZGUgVVJMIGFzIGRlc2NyaWJlZCBpblxuICAgICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvZ29vZ2xlLWF1dGhlbnRpY2F0b3Ivd2lraS9LZXktVXJpLUZvcm1hdFxuICAgICAqIFRoaXMgY2FuIGJlIGRpc3BsYXllZCB0byB0aGUgdXNlciBhcyBhIFFSIGNvZGUgdG8gYmUgc2Nhbm5lZCBpbnRvIGEgVE9UUCBhcHAgbGlrZSBHb29nbGUgQXV0aGVudGljYXRvci5cbiAgICAgKiBJZiB0aGUgb3B0aW9uYWwgcGFyYW1ldGVycyBhcmUgdW5zcGVjaWZpZWQsIGFuIGFjY291bnROYW1lIG9mIDx1c2VyRW1haWw+IGFuZCBpc3N1ZXIgb2YgPGZpcmViYXNlQXBwTmFtZT4gYXJlIHVzZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYWNjb3VudE5hbWUgdGhlIG5hbWUgb2YgdGhlIGFjY291bnQvYXBwIGFsb25nIHdpdGggYSB1c2VyIGlkZW50aWZpZXIuXG4gICAgICogQHBhcmFtIGlzc3VlciBpc3N1ZXIgb2YgdGhlIFRPVFAgKGxpa2VseSB0aGUgYXBwIG5hbWUpLlxuICAgICAqIEByZXR1cm5zIEEgUVIgY29kZSBVUkwgc3RyaW5nLlxuICAgICAqL1xuICAgIGdlbmVyYXRlUXJDb2RlVXJsKGFjY291bnROYW1lLCBpc3N1ZXIpIHtcbiAgICAgICAgbGV0IHVzZURlZmF1bHRzID0gZmFsc2U7XG4gICAgICAgIGlmIChfaXNFbXB0eVN0cmluZyhhY2NvdW50TmFtZSkgfHwgX2lzRW1wdHlTdHJpbmcoaXNzdWVyKSkge1xuICAgICAgICAgICAgdXNlRGVmYXVsdHMgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1c2VEZWZhdWx0cykge1xuICAgICAgICAgICAgaWYgKF9pc0VtcHR5U3RyaW5nKGFjY291bnROYW1lKSkge1xuICAgICAgICAgICAgICAgIGFjY291bnROYW1lID0gdGhpcy5hdXRoLmN1cnJlbnRVc2VyPy5lbWFpbCB8fCAndW5rbm93bnVzZXInO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKF9pc0VtcHR5U3RyaW5nKGlzc3VlcikpIHtcbiAgICAgICAgICAgICAgICBpc3N1ZXIgPSB0aGlzLmF1dGgubmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYG90cGF1dGg6Ly90b3RwLyR7aXNzdWVyfToke2FjY291bnROYW1lfT9zZWNyZXQ9JHt0aGlzLnNlY3JldEtleX0maXNzdWVyPSR7aXNzdWVyfSZhbGdvcml0aG09JHt0aGlzLmhhc2hpbmdBbGdvcml0aG19JmRpZ2l0cz0ke3RoaXMuY29kZUxlbmd0aH1gO1xuICAgIH1cbn1cbi8qKiBAaW50ZXJuYWwgKi9cbmZ1bmN0aW9uIF9pc0VtcHR5U3RyaW5nKGlucHV0KSB7XG4gICAgcmV0dXJuIHR5cGVvZiBpbnB1dCA9PT0gJ3VuZGVmaW5lZCcgfHwgaW5wdXQ/Lmxlbmd0aCA9PT0gMDtcbn1cblxudmFyIG5hbWUgPSBcIkBmaXJlYmFzZS9hdXRoXCI7XG52YXIgdmVyc2lvbiA9IFwiMS4xMS4xXCI7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jbGFzcyBBdXRoSW50ZXJvcCB7XG4gICAgY29uc3RydWN0b3IoYXV0aCkge1xuICAgICAgICB0aGlzLmF1dGggPSBhdXRoO1xuICAgICAgICB0aGlzLmludGVybmFsTGlzdGVuZXJzID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgICBnZXRVaWQoKSB7XG4gICAgICAgIHRoaXMuYXNzZXJ0QXV0aENvbmZpZ3VyZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXV0aC5jdXJyZW50VXNlcj8udWlkIHx8IG51bGw7XG4gICAgfVxuICAgIGFzeW5jIGdldFRva2VuKGZvcmNlUmVmcmVzaCkge1xuICAgICAgICB0aGlzLmFzc2VydEF1dGhDb25maWd1cmVkKCk7XG4gICAgICAgIGF3YWl0IHRoaXMuYXV0aC5faW5pdGlhbGl6YXRpb25Qcm9taXNlO1xuICAgICAgICBpZiAoIXRoaXMuYXV0aC5jdXJyZW50VXNlcikge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCB0aGlzLmF1dGguY3VycmVudFVzZXIuZ2V0SWRUb2tlbihmb3JjZVJlZnJlc2gpO1xuICAgICAgICByZXR1cm4geyBhY2Nlc3NUb2tlbiB9O1xuICAgIH1cbiAgICBhZGRBdXRoVG9rZW5MaXN0ZW5lcihsaXN0ZW5lcikge1xuICAgICAgICB0aGlzLmFzc2VydEF1dGhDb25maWd1cmVkKCk7XG4gICAgICAgIGlmICh0aGlzLmludGVybmFsTGlzdGVuZXJzLmhhcyhsaXN0ZW5lcikpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB1bnN1YnNjcmliZSA9IHRoaXMuYXV0aC5vbklkVG9rZW5DaGFuZ2VkKHVzZXIgPT4ge1xuICAgICAgICAgICAgbGlzdGVuZXIodXNlcj8uc3RzVG9rZW5NYW5hZ2VyLmFjY2Vzc1Rva2VuIHx8IG51bGwpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5pbnRlcm5hbExpc3RlbmVycy5zZXQobGlzdGVuZXIsIHVuc3Vic2NyaWJlKTtcbiAgICAgICAgdGhpcy51cGRhdGVQcm9hY3RpdmVSZWZyZXNoKCk7XG4gICAgfVxuICAgIHJlbW92ZUF1dGhUb2tlbkxpc3RlbmVyKGxpc3RlbmVyKSB7XG4gICAgICAgIHRoaXMuYXNzZXJ0QXV0aENvbmZpZ3VyZWQoKTtcbiAgICAgICAgY29uc3QgdW5zdWJzY3JpYmUgPSB0aGlzLmludGVybmFsTGlzdGVuZXJzLmdldChsaXN0ZW5lcik7XG4gICAgICAgIGlmICghdW5zdWJzY3JpYmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmludGVybmFsTGlzdGVuZXJzLmRlbGV0ZShsaXN0ZW5lcik7XG4gICAgICAgIHVuc3Vic2NyaWJlKCk7XG4gICAgICAgIHRoaXMudXBkYXRlUHJvYWN0aXZlUmVmcmVzaCgpO1xuICAgIH1cbiAgICBhc3NlcnRBdXRoQ29uZmlndXJlZCgpIHtcbiAgICAgICAgX2Fzc2VydCh0aGlzLmF1dGguX2luaXRpYWxpemF0aW9uUHJvbWlzZSwgXCJkZXBlbmRlbnQtc2RrLWluaXRpYWxpemVkLWJlZm9yZS1hdXRoXCIgLyogQXV0aEVycm9yQ29kZS5ERVBFTkRFTlRfU0RLX0lOSVRfQkVGT1JFX0FVVEggKi8pO1xuICAgIH1cbiAgICB1cGRhdGVQcm9hY3RpdmVSZWZyZXNoKCkge1xuICAgICAgICBpZiAodGhpcy5pbnRlcm5hbExpc3RlbmVycy5zaXplID4gMCkge1xuICAgICAgICAgICAgdGhpcy5hdXRoLl9zdGFydFByb2FjdGl2ZVJlZnJlc2goKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYXV0aC5fc3RvcFByb2FjdGl2ZVJlZnJlc2goKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmZ1bmN0aW9uIGdldFZlcnNpb25Gb3JQbGF0Zm9ybShjbGllbnRQbGF0Zm9ybSkge1xuICAgIHN3aXRjaCAoY2xpZW50UGxhdGZvcm0pIHtcbiAgICAgICAgY2FzZSBcIk5vZGVcIiAvKiBDbGllbnRQbGF0Zm9ybS5OT0RFICovOlxuICAgICAgICAgICAgcmV0dXJuICdub2RlJztcbiAgICAgICAgY2FzZSBcIlJlYWN0TmF0aXZlXCIgLyogQ2xpZW50UGxhdGZvcm0uUkVBQ1RfTkFUSVZFICovOlxuICAgICAgICAgICAgcmV0dXJuICdybic7XG4gICAgICAgIGNhc2UgXCJXb3JrZXJcIiAvKiBDbGllbnRQbGF0Zm9ybS5XT1JLRVIgKi86XG4gICAgICAgICAgICByZXR1cm4gJ3dlYndvcmtlcic7XG4gICAgICAgIGNhc2UgXCJDb3Jkb3ZhXCIgLyogQ2xpZW50UGxhdGZvcm0uQ09SRE9WQSAqLzpcbiAgICAgICAgICAgIHJldHVybiAnY29yZG92YSc7XG4gICAgICAgIGNhc2UgXCJXZWJFeHRlbnNpb25cIiAvKiBDbGllbnRQbGF0Zm9ybS5XRUJfRVhURU5TSU9OICovOlxuICAgICAgICAgICAgcmV0dXJuICd3ZWItZXh0ZW5zaW9uJztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxufVxuLyoqIEBpbnRlcm5hbCAqL1xuZnVuY3Rpb24gcmVnaXN0ZXJBdXRoKGNsaWVudFBsYXRmb3JtKSB7XG4gICAgX3JlZ2lzdGVyQ29tcG9uZW50KG5ldyBDb21wb25lbnQoXCJhdXRoXCIgLyogX0NvbXBvbmVudE5hbWUuQVVUSCAqLywgKGNvbnRhaW5lciwgeyBvcHRpb25zOiBkZXBzIH0pID0+IHtcbiAgICAgICAgY29uc3QgYXBwID0gY29udGFpbmVyLmdldFByb3ZpZGVyKCdhcHAnKS5nZXRJbW1lZGlhdGUoKTtcbiAgICAgICAgY29uc3QgaGVhcnRiZWF0U2VydmljZVByb3ZpZGVyID0gY29udGFpbmVyLmdldFByb3ZpZGVyKCdoZWFydGJlYXQnKTtcbiAgICAgICAgY29uc3QgYXBwQ2hlY2tTZXJ2aWNlUHJvdmlkZXIgPSBjb250YWluZXIuZ2V0UHJvdmlkZXIoJ2FwcC1jaGVjay1pbnRlcm5hbCcpO1xuICAgICAgICBjb25zdCB7IGFwaUtleSwgYXV0aERvbWFpbiB9ID0gYXBwLm9wdGlvbnM7XG4gICAgICAgIF9hc3NlcnQoYXBpS2V5ICYmICFhcGlLZXkuaW5jbHVkZXMoJzonKSwgXCJpbnZhbGlkLWFwaS1rZXlcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfQVBJX0tFWSAqLywgeyBhcHBOYW1lOiBhcHAubmFtZSB9KTtcbiAgICAgICAgY29uc3QgY29uZmlnID0ge1xuICAgICAgICAgICAgYXBpS2V5LFxuICAgICAgICAgICAgYXV0aERvbWFpbixcbiAgICAgICAgICAgIGNsaWVudFBsYXRmb3JtLFxuICAgICAgICAgICAgYXBpSG9zdDogXCJpZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb21cIiAvKiBEZWZhdWx0Q29uZmlnLkFQSV9IT1NUICovLFxuICAgICAgICAgICAgdG9rZW5BcGlIb3N0OiBcInNlY3VyZXRva2VuLmdvb2dsZWFwaXMuY29tXCIgLyogRGVmYXVsdENvbmZpZy5UT0tFTl9BUElfSE9TVCAqLyxcbiAgICAgICAgICAgIGFwaVNjaGVtZTogXCJodHRwc1wiIC8qIERlZmF1bHRDb25maWcuQVBJX1NDSEVNRSAqLyxcbiAgICAgICAgICAgIHNka0NsaWVudFZlcnNpb246IF9nZXRDbGllbnRWZXJzaW9uKGNsaWVudFBsYXRmb3JtKVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBhdXRoSW5zdGFuY2UgPSBuZXcgQXV0aEltcGwoYXBwLCBoZWFydGJlYXRTZXJ2aWNlUHJvdmlkZXIsIGFwcENoZWNrU2VydmljZVByb3ZpZGVyLCBjb25maWcpO1xuICAgICAgICBfaW5pdGlhbGl6ZUF1dGhJbnN0YW5jZShhdXRoSW5zdGFuY2UsIGRlcHMpO1xuICAgICAgICByZXR1cm4gYXV0aEluc3RhbmNlO1xuICAgIH0sIFwiUFVCTElDXCIgLyogQ29tcG9uZW50VHlwZS5QVUJMSUMgKi8pXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBdXRoIGNhbiBvbmx5IGJlIGluaXRpYWxpemVkIGJ5IGV4cGxpY2l0bHkgY2FsbGluZyBnZXRBdXRoKCkgb3IgaW5pdGlhbGl6ZUF1dGgoKVxuICAgICAgICAgKiBGb3Igd2h5IHdlIGRvIHRoaXMsIFNlZSBnby9maXJlYmFzZS1uZXh0LWF1dGgtaW5pdFxuICAgICAgICAgKi9cbiAgICAgICAgLnNldEluc3RhbnRpYXRpb25Nb2RlKFwiRVhQTElDSVRcIiAvKiBJbnN0YW50aWF0aW9uTW9kZS5FWFBMSUNJVCAqLylcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEJlY2F1c2UgYWxsIGZpcmViYXNlIHByb2R1Y3RzIHRoYXQgZGVwZW5kIG9uIGF1dGggZGVwZW5kIG9uIGF1dGgtaW50ZXJuYWwgZGlyZWN0bHksXG4gICAgICAgICAqIHdlIG5lZWQgdG8gaW5pdGlhbGl6ZSBhdXRoLWludGVybmFsIGFmdGVyIGF1dGggaXMgaW5pdGlhbGl6ZWQgdG8gbWFrZSBpdCBhdmFpbGFibGUgdG8gb3RoZXIgZmlyZWJhc2UgcHJvZHVjdHMuXG4gICAgICAgICAqL1xuICAgICAgICAuc2V0SW5zdGFuY2VDcmVhdGVkQ2FsbGJhY2soKGNvbnRhaW5lciwgX2luc3RhbmNlSWRlbnRpZmllciwgX2luc3RhbmNlKSA9PiB7XG4gICAgICAgIGNvbnN0IGF1dGhJbnRlcm5hbFByb3ZpZGVyID0gY29udGFpbmVyLmdldFByb3ZpZGVyKFwiYXV0aC1pbnRlcm5hbFwiIC8qIF9Db21wb25lbnROYW1lLkFVVEhfSU5URVJOQUwgKi8pO1xuICAgICAgICBhdXRoSW50ZXJuYWxQcm92aWRlci5pbml0aWFsaXplKCk7XG4gICAgfSkpO1xuICAgIF9yZWdpc3RlckNvbXBvbmVudChuZXcgQ29tcG9uZW50KFwiYXV0aC1pbnRlcm5hbFwiIC8qIF9Db21wb25lbnROYW1lLkFVVEhfSU5URVJOQUwgKi8sIGNvbnRhaW5lciA9PiB7XG4gICAgICAgIGNvbnN0IGF1dGggPSBfY2FzdEF1dGgoY29udGFpbmVyLmdldFByb3ZpZGVyKFwiYXV0aFwiIC8qIF9Db21wb25lbnROYW1lLkFVVEggKi8pLmdldEltbWVkaWF0ZSgpKTtcbiAgICAgICAgcmV0dXJuIChhdXRoID0+IG5ldyBBdXRoSW50ZXJvcChhdXRoKSkoYXV0aCk7XG4gICAgfSwgXCJQUklWQVRFXCIgLyogQ29tcG9uZW50VHlwZS5QUklWQVRFICovKS5zZXRJbnN0YW50aWF0aW9uTW9kZShcIkVYUExJQ0lUXCIgLyogSW5zdGFudGlhdGlvbk1vZGUuRVhQTElDSVQgKi8pKTtcbiAgICByZWdpc3RlclZlcnNpb24obmFtZSwgdmVyc2lvbiwgZ2V0VmVyc2lvbkZvclBsYXRmb3JtKGNsaWVudFBsYXRmb3JtKSk7XG4gICAgLy8gQlVJTERfVEFSR0VUIHdpbGwgYmUgcmVwbGFjZWQgYnkgdmFsdWVzIGxpa2UgZXNtLCBjanMsIGV0YyBkdXJpbmcgdGhlIGNvbXBpbGF0aW9uXG4gICAgcmVnaXN0ZXJWZXJzaW9uKG5hbWUsIHZlcnNpb24sICdlc20yMDIwJyk7XG59XG5cbmV4cG9ydCB7IHVwZGF0ZUVtYWlsIGFzICQsIEFVVEhfRVJST1JfQ09ERVNfTUFQX0RPX05PVF9VU0VfSU5URVJOQUxMWSBhcyBBLCBsaW5rV2l0aENyZWRlbnRpYWwgYXMgQiwgcmVhdXRoZW50aWNhdGVXaXRoQ3JlZGVudGlhbCBhcyBDLCBzaWduSW5XaXRoQ3VzdG9tVG9rZW4gYXMgRCwgRW1haWxBdXRoQ3JlZGVudGlhbCBhcyBFLCBGYWNlYm9va0F1dGhQcm92aWRlciBhcyBGLCBHb29nbGVBdXRoUHJvdmlkZXIgYXMgRywgc2VuZFBhc3N3b3JkUmVzZXRFbWFpbCBhcyBILCBjb25maXJtUGFzc3dvcmRSZXNldCBhcyBJLCBhcHBseUFjdGlvbkNvZGUgYXMgSiwgY2hlY2tBY3Rpb25Db2RlIGFzIEssIHZlcmlmeVBhc3N3b3JkUmVzZXRDb2RlIGFzIEwsIGNyZWF0ZVVzZXJXaXRoRW1haWxBbmRQYXNzd29yZCBhcyBNLCBzaWduSW5XaXRoRW1haWxBbmRQYXNzd29yZCBhcyBOLCBPQXV0aENyZWRlbnRpYWwgYXMgTywgUGhvbmVBdXRoQ3JlZGVudGlhbCBhcyBQLCBzZW5kU2lnbkluTGlua1RvRW1haWwgYXMgUSwgaXNTaWduSW5XaXRoRW1haWxMaW5rIGFzIFIsIFNBTUxBdXRoUHJvdmlkZXIgYXMgUywgVG90cE11bHRpRmFjdG9yR2VuZXJhdG9yIGFzIFQsIHNpZ25JbldpdGhFbWFpbExpbmsgYXMgVSwgZmV0Y2hTaWduSW5NZXRob2RzRm9yRW1haWwgYXMgViwgc2VuZEVtYWlsVmVyaWZpY2F0aW9uIGFzIFcsIHZlcmlmeUJlZm9yZVVwZGF0ZUVtYWlsIGFzIFgsIEFjdGlvbkNvZGVVUkwgYXMgWSwgcGFyc2VBY3Rpb25Db2RlVVJMIGFzIFosIHVwZGF0ZVByb2ZpbGUgYXMgXywgaW5kZXhlZERCTG9jYWxQZXJzaXN0ZW5jZSBhcyBhLCBGZXRjaFByb3ZpZGVyIGFzIGEkLCB1cGRhdGVQYXNzd29yZCBhcyBhMCwgZ2V0SWRUb2tlbiBhcyBhMSwgZ2V0SWRUb2tlblJlc3VsdCBhcyBhMiwgdW5saW5rIGFzIGEzLCBnZXRBZGRpdGlvbmFsVXNlckluZm8gYXMgYTQsIHJlbG9hZCBhcyBhNSwgZ2V0TXVsdGlGYWN0b3JSZXNvbHZlciBhcyBhNiwgbXVsdGlGYWN0b3IgYXMgYTcsIFNUT1JBR0VfQVZBSUxBQkxFX0tFWSBhcyBhOCwgX2lzTW9iaWxlQnJvd3NlciBhcyBhOSwgc2lnbkluV2l0aElkcCBhcyBhQSwgX2ZhaWwgYXMgYUIsIGRlYnVnQXNzZXJ0IGFzIGFDLCBfYXNzZXJ0SW5zdGFuY2VPZiBhcyBhRCwgX2dlbmVyYXRlRXZlbnRJZCBhcyBhRSwgRmVkZXJhdGVkQXV0aFByb3ZpZGVyIGFzIGFGLCBfcGVyc2lzdGVuY2VLZXlOYW1lIGFzIGFHLCBfcGVyZm9ybUFwaVJlcXVlc3QgYXMgYUgsIF9nZXRDdXJyZW50VXJsIGFzIGFJLCBfZ2FwaVNjcmlwdFVybCBhcyBhSiwgX2VtdWxhdG9yVXJsIGFzIGFLLCBfaXNDaHJvbWVJT1MgYXMgYUwsIF9pc0ZpcmVmb3ggYXMgYU0sIF9pc0lPU1N0YW5kYWxvbmUgYXMgYU4sIEJhc2VPQXV0aFByb3ZpZGVyIGFzIGFPLCBfc2V0V2luZG93TG9jYXRpb24gYXMgYVAsIF9pc1NhZmFyaSBhcyBhUSwgX2lzSU9TIGFzIGFSLCBNdWx0aUZhY3RvckFzc2VydGlvbkltcGwgYXMgYVMsIGZpbmFsaXplRW5yb2xsUGhvbmVNZmEgYXMgYVQsIGZpbmFsaXplU2lnbkluUGhvbmVNZmEgYXMgYVUsIF9zZXRFeHRlcm5hbEpTUHJvdmlkZXIgYXMgYVYsIF9pc0FuZHJvaWQgYXMgYVcsIF9pc0lPUzdPcjggYXMgYVgsIFVzZXJJbXBsIGFzIGFZLCBBdXRoSW1wbCBhcyBhWiwgX2dldENsaWVudFZlcnNpb24gYXMgYV8sIF9pc0lFMTAgYXMgYWEsIERlbGF5IGFzIGFiLCBfd2luZG93IGFzIGFjLCBfYXNzZXJ0IGFzIGFkLCBpc1YyIGFzIGFlLCBfY3JlYXRlRXJyb3IgYXMgYWYsIF9yZWNhcHRjaGFWMlNjcmlwdFVybCBhcyBhZywgX2xvYWRKUyBhcyBhaCwgTW9ja1JlQ2FwdGNoYSBhcyBhaSwgX2dlbmVyYXRlQ2FsbGJhY2tOYW1lIGFzIGFqLCBfY2FzdEF1dGggYXMgYWssIF9pc0h0dHBPckh0dHBzIGFzIGFsLCBfaXNXb3JrZXIgYXMgYW0sIGdldFJlY2FwdGNoYVBhcmFtcyBhcyBhbiwgX3NlcnZlckFwcEN1cnJlbnRVc2VyT3BlcmF0aW9uTm90U3VwcG9ydGVkRXJyb3IgYXMgYW8sIF9hc3NlcnRMaW5rZWRTdGF0dXMgYXMgYXAsIF9pbml0aWFsaXplUmVjYXB0Y2hhQ29uZmlnIGFzIGFxLCBGQUtFX1RPS0VOIGFzIGFyLCBzdGFydEVucm9sbFBob25lTWZhIGFzIGFzLCBoYW5kbGVSZWNhcHRjaGFGbG93IGFzIGF0LCBzdGFydFNpZ25JblBob25lTWZhIGFzIGF1LCBzZW5kUGhvbmVWZXJpZmljYXRpb25Db2RlIGFzIGF2LCBfbGluayBhcyBhdywgX2dldEluc3RhbmNlIGFzIGF4LCBfc2lnbkluV2l0aENyZWRlbnRpYWwgYXMgYXksIF9yZWF1dGhlbnRpY2F0ZSBhcyBheiwgVG90cFNlY3JldCBhcyBiLCBTQU1MQXV0aENyZWRlbnRpYWwgYXMgYjAsIGNvbm5lY3RBdXRoRW11bGF0b3IgYXMgYywgaW5pdGlhbGl6ZVJlY2FwdGNoYUNvbmZpZyBhcyBkLCBiZWZvcmVBdXRoU3RhdGVDaGFuZ2VkIGFzIGUsIG9uQXV0aFN0YXRlQ2hhbmdlZCBhcyBmLCB1cGRhdGVDdXJyZW50VXNlciBhcyBnLCBzaWduT3V0IGFzIGgsIGluaXRpYWxpemVBdXRoIGFzIGksIHJldm9rZUFjY2Vzc1Rva2VuIGFzIGosIGRlbGV0ZVVzZXIgYXMgaywgZGVidWdFcnJvck1hcCBhcyBsLCBBdXRoQ3JlZGVudGlhbCBhcyBtLCBpbk1lbW9yeVBlcnNpc3RlbmNlIGFzIG4sIG9uSWRUb2tlbkNoYW5nZWQgYXMgbywgcHJvZEVycm9yTWFwIGFzIHAsIEVtYWlsQXV0aFByb3ZpZGVyIGFzIHEsIHJlZ2lzdGVyQXV0aCBhcyByLCBzZXRQZXJzaXN0ZW5jZSBhcyBzLCBHaXRodWJBdXRoUHJvdmlkZXIgYXMgdCwgdXNlRGV2aWNlTGFuZ3VhZ2UgYXMgdSwgdmFsaWRhdGVQYXNzd29yZCBhcyB2LCBPQXV0aFByb3ZpZGVyIGFzIHcsIFR3aXR0ZXJBdXRoUHJvdmlkZXIgYXMgeCwgc2lnbkluQW5vbnltb3VzbHkgYXMgeSwgc2lnbkluV2l0aENyZWRlbnRpYWwgYXMgeiB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cmVnaXN0ZXItNzk5M2I3YWYuanMubWFwXG4iLCJpbXBvcnQgeyBnZXREZWZhdWx0c0Zyb21Qb3N0aW5zdGFsbCB9IGZyb20gJy4vcG9zdGluc3RhbGwubWpzJztcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQGZpbGVvdmVydmlldyBGaXJlYmFzZSBjb25zdGFudHMuICBTb21lIG9mIHRoZXNlIChAZGVmaW5lcykgY2FuIGJlIG92ZXJyaWRkZW4gYXQgY29tcGlsZS10aW1lLlxuICovXG5jb25zdCBDT05TVEFOVFMgPSB7XG4gICAgLyoqXG4gICAgICogQGRlZmluZSB7Ym9vbGVhbn0gV2hldGhlciB0aGlzIGlzIHRoZSBjbGllbnQgTm9kZS5qcyBTREsuXG4gICAgICovXG4gICAgTk9ERV9DTElFTlQ6IGZhbHNlLFxuICAgIC8qKlxuICAgICAqIEBkZWZpbmUge2Jvb2xlYW59IFdoZXRoZXIgdGhpcyBpcyB0aGUgQWRtaW4gTm9kZS5qcyBTREsuXG4gICAgICovXG4gICAgTk9ERV9BRE1JTjogZmFsc2UsXG4gICAgLyoqXG4gICAgICogRmlyZWJhc2UgU0RLIFZlcnNpb25cbiAgICAgKi9cbiAgICBTREtfVkVSU0lPTjogJyR7SlNDT1JFX1ZFUlNJT059J1xufTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVGhyb3dzIGFuIGVycm9yIGlmIHRoZSBwcm92aWRlZCBhc3NlcnRpb24gaXMgZmFsc3lcbiAqL1xuY29uc3QgYXNzZXJ0ID0gZnVuY3Rpb24gKGFzc2VydGlvbiwgbWVzc2FnZSkge1xuICAgIGlmICghYXNzZXJ0aW9uKSB7XG4gICAgICAgIHRocm93IGFzc2VydGlvbkVycm9yKG1lc3NhZ2UpO1xuICAgIH1cbn07XG4vKipcbiAqIFJldHVybnMgYW4gRXJyb3Igb2JqZWN0IHN1aXRhYmxlIGZvciB0aHJvd2luZy5cbiAqL1xuY29uc3QgYXNzZXJ0aW9uRXJyb3IgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgIHJldHVybiBuZXcgRXJyb3IoJ0ZpcmViYXNlIERhdGFiYXNlICgnICtcbiAgICAgICAgQ09OU1RBTlRTLlNES19WRVJTSU9OICtcbiAgICAgICAgJykgSU5URVJOQUwgQVNTRVJUIEZBSUxFRDogJyArXG4gICAgICAgIG1lc3NhZ2UpO1xufTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IHN0cmluZ1RvQnl0ZUFycmF5JDEgPSBmdW5jdGlvbiAoc3RyKSB7XG4gICAgLy8gVE9ETyh1c2VyKTogVXNlIG5hdGl2ZSBpbXBsZW1lbnRhdGlvbnMgaWYvd2hlbiBhdmFpbGFibGVcbiAgICBjb25zdCBvdXQgPSBbXTtcbiAgICBsZXQgcCA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGV0IGMgPSBzdHIuY2hhckNvZGVBdChpKTtcbiAgICAgICAgaWYgKGMgPCAxMjgpIHtcbiAgICAgICAgICAgIG91dFtwKytdID0gYztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjIDwgMjA0OCkge1xuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyA+PiA2KSB8IDE5MjtcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoKGMgJiAweGZjMDApID09PSAweGQ4MDAgJiZcbiAgICAgICAgICAgIGkgKyAxIDwgc3RyLmxlbmd0aCAmJlxuICAgICAgICAgICAgKHN0ci5jaGFyQ29kZUF0KGkgKyAxKSAmIDB4ZmMwMCkgPT09IDB4ZGMwMCkge1xuICAgICAgICAgICAgLy8gU3Vycm9nYXRlIFBhaXJcbiAgICAgICAgICAgIGMgPSAweDEwMDAwICsgKChjICYgMHgwM2ZmKSA8PCAxMCkgKyAoc3RyLmNoYXJDb2RlQXQoKytpKSAmIDB4MDNmZik7XG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjID4+IDE4KSB8IDI0MDtcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDEyKSAmIDYzKSB8IDEyODtcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDYpICYgNjMpIHwgMTI4O1xuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyAmIDYzKSB8IDEyODtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gMTIpIHwgMjI0O1xuICAgICAgICAgICAgb3V0W3ArK10gPSAoKGMgPj4gNikgJiA2MykgfCAxMjg7XG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59O1xuLyoqXG4gKiBUdXJucyBhbiBhcnJheSBvZiBudW1iZXJzIGludG8gdGhlIHN0cmluZyBnaXZlbiBieSB0aGUgY29uY2F0ZW5hdGlvbiBvZiB0aGVcbiAqIGNoYXJhY3RlcnMgdG8gd2hpY2ggdGhlIG51bWJlcnMgY29ycmVzcG9uZC5cbiAqIEBwYXJhbSBieXRlcyBBcnJheSBvZiBudW1iZXJzIHJlcHJlc2VudGluZyBjaGFyYWN0ZXJzLlxuICogQHJldHVybiBTdHJpbmdpZmljYXRpb24gb2YgdGhlIGFycmF5LlxuICovXG5jb25zdCBieXRlQXJyYXlUb1N0cmluZyA9IGZ1bmN0aW9uIChieXRlcykge1xuICAgIC8vIFRPRE8odXNlcik6IFVzZSBuYXRpdmUgaW1wbGVtZW50YXRpb25zIGlmL3doZW4gYXZhaWxhYmxlXG4gICAgY29uc3Qgb3V0ID0gW107XG4gICAgbGV0IHBvcyA9IDAsIGMgPSAwO1xuICAgIHdoaWxlIChwb3MgPCBieXRlcy5sZW5ndGgpIHtcbiAgICAgICAgY29uc3QgYzEgPSBieXRlc1twb3MrK107XG4gICAgICAgIGlmIChjMSA8IDEyOCkge1xuICAgICAgICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGMxKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjMSA+IDE5MSAmJiBjMSA8IDIyNCkge1xuICAgICAgICAgICAgY29uc3QgYzIgPSBieXRlc1twb3MrK107XG4gICAgICAgICAgICBvdXRbYysrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChjMSAmIDMxKSA8PCA2KSB8IChjMiAmIDYzKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYzEgPiAyMzkgJiYgYzEgPCAzNjUpIHtcbiAgICAgICAgICAgIC8vIFN1cnJvZ2F0ZSBQYWlyXG4gICAgICAgICAgICBjb25zdCBjMiA9IGJ5dGVzW3BvcysrXTtcbiAgICAgICAgICAgIGNvbnN0IGMzID0gYnl0ZXNbcG9zKytdO1xuICAgICAgICAgICAgY29uc3QgYzQgPSBieXRlc1twb3MrK107XG4gICAgICAgICAgICBjb25zdCB1ID0gKCgoYzEgJiA3KSA8PCAxOCkgfCAoKGMyICYgNjMpIDw8IDEyKSB8ICgoYzMgJiA2MykgPDwgNikgfCAoYzQgJiA2MykpIC1cbiAgICAgICAgICAgICAgICAweDEwMDAwO1xuICAgICAgICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4ZDgwMCArICh1ID4+IDEwKSk7XG4gICAgICAgICAgICBvdXRbYysrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoMHhkYzAwICsgKHUgJiAxMDIzKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBjMiA9IGJ5dGVzW3BvcysrXTtcbiAgICAgICAgICAgIGNvbnN0IGMzID0gYnl0ZXNbcG9zKytdO1xuICAgICAgICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYzEgJiAxNSkgPDwgMTIpIHwgKChjMiAmIDYzKSA8PCA2KSB8IChjMyAmIDYzKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG91dC5qb2luKCcnKTtcbn07XG4vLyBXZSBkZWZpbmUgaXQgYXMgYW4gb2JqZWN0IGxpdGVyYWwgaW5zdGVhZCBvZiBhIGNsYXNzIGJlY2F1c2UgYSBjbGFzcyBjb21waWxlZCBkb3duIHRvIGVzNSBjYW4ndFxuLy8gYmUgdHJlZXNoYWtlZC4gaHR0cHM6Ly9naXRodWIuY29tL3JvbGx1cC9yb2xsdXAvaXNzdWVzLzE2OTFcbi8vIFN0YXRpYyBsb29rdXAgbWFwcywgbGF6aWx5IHBvcHVsYXRlZCBieSBpbml0XygpXG4vLyBUT0RPKGRsYXJvY3F1ZSk6IERlZmluZSB0aGlzIGFzIGEgY2xhc3MsIHNpbmNlIHdlIG5vIGxvbmdlciB0YXJnZXQgRVM1LlxuY29uc3QgYmFzZTY0ID0ge1xuICAgIC8qKlxuICAgICAqIE1hcHMgYnl0ZXMgdG8gY2hhcmFjdGVycy5cbiAgICAgKi9cbiAgICBieXRlVG9DaGFyTWFwXzogbnVsbCxcbiAgICAvKipcbiAgICAgKiBNYXBzIGNoYXJhY3RlcnMgdG8gYnl0ZXMuXG4gICAgICovXG4gICAgY2hhclRvQnl0ZU1hcF86IG51bGwsXG4gICAgLyoqXG4gICAgICogTWFwcyBieXRlcyB0byB3ZWJzYWZlIGNoYXJhY3RlcnMuXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBieXRlVG9DaGFyTWFwV2ViU2FmZV86IG51bGwsXG4gICAgLyoqXG4gICAgICogTWFwcyB3ZWJzYWZlIGNoYXJhY3RlcnMgdG8gYnl0ZXMuXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBjaGFyVG9CeXRlTWFwV2ViU2FmZV86IG51bGwsXG4gICAgLyoqXG4gICAgICogT3VyIGRlZmF1bHQgYWxwaGFiZXQsIHNoYXJlZCBiZXR3ZWVuXG4gICAgICogRU5DT0RFRF9WQUxTIGFuZCBFTkNPREVEX1ZBTFNfV0VCU0FGRVxuICAgICAqL1xuICAgIEVOQ09ERURfVkFMU19CQVNFOiAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVonICsgJ2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6JyArICcwMTIzNDU2Nzg5JyxcbiAgICAvKipcbiAgICAgKiBPdXIgZGVmYXVsdCBhbHBoYWJldC4gVmFsdWUgNjQgKD0pIGlzIHNwZWNpYWw7IGl0IG1lYW5zIFwibm90aGluZy5cIlxuICAgICAqL1xuICAgIGdldCBFTkNPREVEX1ZBTFMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkVOQ09ERURfVkFMU19CQVNFICsgJysvPSc7XG4gICAgfSxcbiAgICAvKipcbiAgICAgKiBPdXIgd2Vic2FmZSBhbHBoYWJldC5cbiAgICAgKi9cbiAgICBnZXQgRU5DT0RFRF9WQUxTX1dFQlNBRkUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkVOQ09ERURfVkFMU19CQVNFICsgJy1fLic7XG4gICAgfSxcbiAgICAvKipcbiAgICAgKiBXaGV0aGVyIHRoaXMgYnJvd3NlciBzdXBwb3J0cyB0aGUgYXRvYiBhbmQgYnRvYSBmdW5jdGlvbnMuIFRoaXMgZXh0ZW5zaW9uXG4gICAgICogc3RhcnRlZCBhdCBNb3ppbGxhIGJ1dCBpcyBub3cgaW1wbGVtZW50ZWQgYnkgbWFueSBicm93c2Vycy4gV2UgdXNlIHRoZVxuICAgICAqIEFTU1VNRV8qIHZhcmlhYmxlcyB0byBhdm9pZCBwdWxsaW5nIGluIHRoZSBmdWxsIHVzZXJhZ2VudCBkZXRlY3Rpb24gbGlicmFyeVxuICAgICAqIGJ1dCBzdGlsbCBhbGxvd2luZyB0aGUgc3RhbmRhcmQgcGVyLWJyb3dzZXIgY29tcGlsYXRpb25zLlxuICAgICAqXG4gICAgICovXG4gICAgSEFTX05BVElWRV9TVVBQT1JUOiB0eXBlb2YgYXRvYiA9PT0gJ2Z1bmN0aW9uJyxcbiAgICAvKipcbiAgICAgKiBCYXNlNjQtZW5jb2RlIGFuIGFycmF5IG9mIGJ5dGVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIGlucHV0IEFuIGFycmF5IG9mIGJ5dGVzIChudW1iZXJzIHdpdGhcbiAgICAgKiAgICAgdmFsdWUgaW4gWzAsIDI1NV0pIHRvIGVuY29kZS5cbiAgICAgKiBAcGFyYW0gd2ViU2FmZSBCb29sZWFuIGluZGljYXRpbmcgd2Ugc2hvdWxkIHVzZSB0aGVcbiAgICAgKiAgICAgYWx0ZXJuYXRpdmUgYWxwaGFiZXQuXG4gICAgICogQHJldHVybiBUaGUgYmFzZTY0IGVuY29kZWQgc3RyaW5nLlxuICAgICAqL1xuICAgIGVuY29kZUJ5dGVBcnJheShpbnB1dCwgd2ViU2FmZSkge1xuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoaW5wdXQpKSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcignZW5jb2RlQnl0ZUFycmF5IHRha2VzIGFuIGFycmF5IGFzIGEgcGFyYW1ldGVyJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbml0XygpO1xuICAgICAgICBjb25zdCBieXRlVG9DaGFyTWFwID0gd2ViU2FmZVxuICAgICAgICAgICAgPyB0aGlzLmJ5dGVUb0NoYXJNYXBXZWJTYWZlX1xuICAgICAgICAgICAgOiB0aGlzLmJ5dGVUb0NoYXJNYXBfO1xuICAgICAgICBjb25zdCBvdXRwdXQgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7IGkgKz0gMykge1xuICAgICAgICAgICAgY29uc3QgYnl0ZTEgPSBpbnB1dFtpXTtcbiAgICAgICAgICAgIGNvbnN0IGhhdmVCeXRlMiA9IGkgKyAxIDwgaW5wdXQubGVuZ3RoO1xuICAgICAgICAgICAgY29uc3QgYnl0ZTIgPSBoYXZlQnl0ZTIgPyBpbnB1dFtpICsgMV0gOiAwO1xuICAgICAgICAgICAgY29uc3QgaGF2ZUJ5dGUzID0gaSArIDIgPCBpbnB1dC5sZW5ndGg7XG4gICAgICAgICAgICBjb25zdCBieXRlMyA9IGhhdmVCeXRlMyA/IGlucHV0W2kgKyAyXSA6IDA7XG4gICAgICAgICAgICBjb25zdCBvdXRCeXRlMSA9IGJ5dGUxID4+IDI7XG4gICAgICAgICAgICBjb25zdCBvdXRCeXRlMiA9ICgoYnl0ZTEgJiAweDAzKSA8PCA0KSB8IChieXRlMiA+PiA0KTtcbiAgICAgICAgICAgIGxldCBvdXRCeXRlMyA9ICgoYnl0ZTIgJiAweDBmKSA8PCAyKSB8IChieXRlMyA+PiA2KTtcbiAgICAgICAgICAgIGxldCBvdXRCeXRlNCA9IGJ5dGUzICYgMHgzZjtcbiAgICAgICAgICAgIGlmICghaGF2ZUJ5dGUzKSB7XG4gICAgICAgICAgICAgICAgb3V0Qnl0ZTQgPSA2NDtcbiAgICAgICAgICAgICAgICBpZiAoIWhhdmVCeXRlMikge1xuICAgICAgICAgICAgICAgICAgICBvdXRCeXRlMyA9IDY0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG91dHB1dC5wdXNoKGJ5dGVUb0NoYXJNYXBbb3V0Qnl0ZTFdLCBieXRlVG9DaGFyTWFwW291dEJ5dGUyXSwgYnl0ZVRvQ2hhck1hcFtvdXRCeXRlM10sIGJ5dGVUb0NoYXJNYXBbb3V0Qnl0ZTRdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0cHV0LmpvaW4oJycpO1xuICAgIH0sXG4gICAgLyoqXG4gICAgICogQmFzZTY0LWVuY29kZSBhIHN0cmluZy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpbnB1dCBBIHN0cmluZyB0byBlbmNvZGUuXG4gICAgICogQHBhcmFtIHdlYlNhZmUgSWYgdHJ1ZSwgd2Ugc2hvdWxkIHVzZSB0aGVcbiAgICAgKiAgICAgYWx0ZXJuYXRpdmUgYWxwaGFiZXQuXG4gICAgICogQHJldHVybiBUaGUgYmFzZTY0IGVuY29kZWQgc3RyaW5nLlxuICAgICAqL1xuICAgIGVuY29kZVN0cmluZyhpbnB1dCwgd2ViU2FmZSkge1xuICAgICAgICAvLyBTaG9ydGN1dCBmb3IgTW96aWxsYSBicm93c2VycyB0aGF0IGltcGxlbWVudFxuICAgICAgICAvLyBhIG5hdGl2ZSBiYXNlNjQgZW5jb2RlciBpbiB0aGUgZm9ybSBvZiBcImJ0b2EvYXRvYlwiXG4gICAgICAgIGlmICh0aGlzLkhBU19OQVRJVkVfU1VQUE9SVCAmJiAhd2ViU2FmZSkge1xuICAgICAgICAgICAgcmV0dXJuIGJ0b2EoaW5wdXQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmVuY29kZUJ5dGVBcnJheShzdHJpbmdUb0J5dGVBcnJheSQxKGlucHV0KSwgd2ViU2FmZSk7XG4gICAgfSxcbiAgICAvKipcbiAgICAgKiBCYXNlNjQtZGVjb2RlIGEgc3RyaW5nLlxuICAgICAqXG4gICAgICogQHBhcmFtIGlucHV0IHRvIGRlY29kZS5cbiAgICAgKiBAcGFyYW0gd2ViU2FmZSBUcnVlIGlmIHdlIHNob3VsZCB1c2UgdGhlXG4gICAgICogICAgIGFsdGVybmF0aXZlIGFscGhhYmV0LlxuICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgZGVjb2RlZCB2YWx1ZS5cbiAgICAgKi9cbiAgICBkZWNvZGVTdHJpbmcoaW5wdXQsIHdlYlNhZmUpIHtcbiAgICAgICAgLy8gU2hvcnRjdXQgZm9yIE1vemlsbGEgYnJvd3NlcnMgdGhhdCBpbXBsZW1lbnRcbiAgICAgICAgLy8gYSBuYXRpdmUgYmFzZTY0IGVuY29kZXIgaW4gdGhlIGZvcm0gb2YgXCJidG9hL2F0b2JcIlxuICAgICAgICBpZiAodGhpcy5IQVNfTkFUSVZFX1NVUFBPUlQgJiYgIXdlYlNhZmUpIHtcbiAgICAgICAgICAgIHJldHVybiBhdG9iKGlucHV0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYnl0ZUFycmF5VG9TdHJpbmcodGhpcy5kZWNvZGVTdHJpbmdUb0J5dGVBcnJheShpbnB1dCwgd2ViU2FmZSkpO1xuICAgIH0sXG4gICAgLyoqXG4gICAgICogQmFzZTY0LWRlY29kZSBhIHN0cmluZy5cbiAgICAgKlxuICAgICAqIEluIGJhc2UtNjQgZGVjb2RpbmcsIGdyb3VwcyBvZiBmb3VyIGNoYXJhY3RlcnMgYXJlIGNvbnZlcnRlZCBpbnRvIHRocmVlXG4gICAgICogYnl0ZXMuICBJZiB0aGUgZW5jb2RlciBkaWQgbm90IGFwcGx5IHBhZGRpbmcsIHRoZSBpbnB1dCBsZW5ndGggbWF5IG5vdFxuICAgICAqIGJlIGEgbXVsdGlwbGUgb2YgNC5cbiAgICAgKlxuICAgICAqIEluIHRoaXMgY2FzZSwgdGhlIGxhc3QgZ3JvdXAgd2lsbCBoYXZlIGZld2VyIHRoYW4gNCBjaGFyYWN0ZXJzLCBhbmRcbiAgICAgKiBwYWRkaW5nIHdpbGwgYmUgaW5mZXJyZWQuICBJZiB0aGUgZ3JvdXAgaGFzIG9uZSBvciB0d28gY2hhcmFjdGVycywgaXQgZGVjb2Rlc1xuICAgICAqIHRvIG9uZSBieXRlLiAgSWYgdGhlIGdyb3VwIGhhcyB0aHJlZSBjaGFyYWN0ZXJzLCBpdCBkZWNvZGVzIHRvIHR3byBieXRlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpbnB1dCBJbnB1dCB0byBkZWNvZGUuXG4gICAgICogQHBhcmFtIHdlYlNhZmUgVHJ1ZSBpZiB3ZSBzaG91bGQgdXNlIHRoZSB3ZWItc2FmZSBhbHBoYWJldC5cbiAgICAgKiBAcmV0dXJuIGJ5dGVzIHJlcHJlc2VudGluZyB0aGUgZGVjb2RlZCB2YWx1ZS5cbiAgICAgKi9cbiAgICBkZWNvZGVTdHJpbmdUb0J5dGVBcnJheShpbnB1dCwgd2ViU2FmZSkge1xuICAgICAgICB0aGlzLmluaXRfKCk7XG4gICAgICAgIGNvbnN0IGNoYXJUb0J5dGVNYXAgPSB3ZWJTYWZlXG4gICAgICAgICAgICA/IHRoaXMuY2hhclRvQnl0ZU1hcFdlYlNhZmVfXG4gICAgICAgICAgICA6IHRoaXMuY2hhclRvQnl0ZU1hcF87XG4gICAgICAgIGNvbnN0IG91dHB1dCA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDspIHtcbiAgICAgICAgICAgIGNvbnN0IGJ5dGUxID0gY2hhclRvQnl0ZU1hcFtpbnB1dC5jaGFyQXQoaSsrKV07XG4gICAgICAgICAgICBjb25zdCBoYXZlQnl0ZTIgPSBpIDwgaW5wdXQubGVuZ3RoO1xuICAgICAgICAgICAgY29uc3QgYnl0ZTIgPSBoYXZlQnl0ZTIgPyBjaGFyVG9CeXRlTWFwW2lucHV0LmNoYXJBdChpKV0gOiAwO1xuICAgICAgICAgICAgKytpO1xuICAgICAgICAgICAgY29uc3QgaGF2ZUJ5dGUzID0gaSA8IGlucHV0Lmxlbmd0aDtcbiAgICAgICAgICAgIGNvbnN0IGJ5dGUzID0gaGF2ZUJ5dGUzID8gY2hhclRvQnl0ZU1hcFtpbnB1dC5jaGFyQXQoaSldIDogNjQ7XG4gICAgICAgICAgICArK2k7XG4gICAgICAgICAgICBjb25zdCBoYXZlQnl0ZTQgPSBpIDwgaW5wdXQubGVuZ3RoO1xuICAgICAgICAgICAgY29uc3QgYnl0ZTQgPSBoYXZlQnl0ZTQgPyBjaGFyVG9CeXRlTWFwW2lucHV0LmNoYXJBdChpKV0gOiA2NDtcbiAgICAgICAgICAgICsraTtcbiAgICAgICAgICAgIGlmIChieXRlMSA9PSBudWxsIHx8IGJ5dGUyID09IG51bGwgfHwgYnl0ZTMgPT0gbnVsbCB8fCBieXRlNCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IERlY29kZUJhc2U2NFN0cmluZ0Vycm9yKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBvdXRCeXRlMSA9IChieXRlMSA8PCAyKSB8IChieXRlMiA+PiA0KTtcbiAgICAgICAgICAgIG91dHB1dC5wdXNoKG91dEJ5dGUxKTtcbiAgICAgICAgICAgIGlmIChieXRlMyAhPT0gNjQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvdXRCeXRlMiA9ICgoYnl0ZTIgPDwgNCkgJiAweGYwKSB8IChieXRlMyA+PiAyKTtcbiAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChvdXRCeXRlMik7XG4gICAgICAgICAgICAgICAgaWYgKGJ5dGU0ICE9PSA2NCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBvdXRCeXRlMyA9ICgoYnl0ZTMgPDwgNikgJiAweGMwKSB8IGJ5dGU0O1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChvdXRCeXRlMyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfSxcbiAgICAvKipcbiAgICAgKiBMYXp5IHN0YXRpYyBpbml0aWFsaXphdGlvbiBmdW5jdGlvbi4gQ2FsbGVkIGJlZm9yZVxuICAgICAqIGFjY2Vzc2luZyBhbnkgb2YgdGhlIHN0YXRpYyBtYXAgdmFyaWFibGVzLlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgaW5pdF8oKSB7XG4gICAgICAgIGlmICghdGhpcy5ieXRlVG9DaGFyTWFwXykge1xuICAgICAgICAgICAgdGhpcy5ieXRlVG9DaGFyTWFwXyA9IHt9O1xuICAgICAgICAgICAgdGhpcy5jaGFyVG9CeXRlTWFwXyA9IHt9O1xuICAgICAgICAgICAgdGhpcy5ieXRlVG9DaGFyTWFwV2ViU2FmZV8gPSB7fTtcbiAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcFdlYlNhZmVfID0ge307XG4gICAgICAgICAgICAvLyBXZSB3YW50IHF1aWNrIG1hcHBpbmdzIGJhY2sgYW5kIGZvcnRoLCBzbyB3ZSBwcmVjb21wdXRlIHR3byBtYXBzLlxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLkVOQ09ERURfVkFMUy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuYnl0ZVRvQ2hhck1hcF9baV0gPSB0aGlzLkVOQ09ERURfVkFMUy5jaGFyQXQoaSk7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGFyVG9CeXRlTWFwX1t0aGlzLmJ5dGVUb0NoYXJNYXBfW2ldXSA9IGk7XG4gICAgICAgICAgICAgICAgdGhpcy5ieXRlVG9DaGFyTWFwV2ViU2FmZV9baV0gPSB0aGlzLkVOQ09ERURfVkFMU19XRUJTQUZFLmNoYXJBdChpKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBXZWJTYWZlX1t0aGlzLmJ5dGVUb0NoYXJNYXBXZWJTYWZlX1tpXV0gPSBpO1xuICAgICAgICAgICAgICAgIC8vIEJlIGZvcmdpdmluZyB3aGVuIGRlY29kaW5nIGFuZCBjb3JyZWN0bHkgZGVjb2RlIGJvdGggZW5jb2RpbmdzLlxuICAgICAgICAgICAgICAgIGlmIChpID49IHRoaXMuRU5DT0RFRF9WQUxTX0JBU0UubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcF9bdGhpcy5FTkNPREVEX1ZBTFNfV0VCU0FGRS5jaGFyQXQoaSldID0gaTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFyVG9CeXRlTWFwV2ViU2FmZV9bdGhpcy5FTkNPREVEX1ZBTFMuY2hhckF0KGkpXSA9IGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufTtcbi8qKlxuICogQW4gZXJyb3IgZW5jb3VudGVyZWQgd2hpbGUgZGVjb2RpbmcgYmFzZTY0IHN0cmluZy5cbiAqL1xuY2xhc3MgRGVjb2RlQmFzZTY0U3RyaW5nRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKC4uLmFyZ3VtZW50cyk7XG4gICAgICAgIHRoaXMubmFtZSA9ICdEZWNvZGVCYXNlNjRTdHJpbmdFcnJvcic7XG4gICAgfVxufVxuLyoqXG4gKiBVUkwtc2FmZSBiYXNlNjQgZW5jb2RpbmdcbiAqL1xuY29uc3QgYmFzZTY0RW5jb2RlID0gZnVuY3Rpb24gKHN0cikge1xuICAgIGNvbnN0IHV0ZjhCeXRlcyA9IHN0cmluZ1RvQnl0ZUFycmF5JDEoc3RyKTtcbiAgICByZXR1cm4gYmFzZTY0LmVuY29kZUJ5dGVBcnJheSh1dGY4Qnl0ZXMsIHRydWUpO1xufTtcbi8qKlxuICogVVJMLXNhZmUgYmFzZTY0IGVuY29kaW5nICh3aXRob3V0IFwiLlwiIHBhZGRpbmcgaW4gdGhlIGVuZCkuXG4gKiBlLmcuIFVzZWQgaW4gSlNPTiBXZWIgVG9rZW4gKEpXVCkgcGFydHMuXG4gKi9cbmNvbnN0IGJhc2U2NHVybEVuY29kZVdpdGhvdXRQYWRkaW5nID0gZnVuY3Rpb24gKHN0cikge1xuICAgIC8vIFVzZSBiYXNlNjR1cmwgZW5jb2RpbmcgYW5kIHJlbW92ZSBwYWRkaW5nIGluIHRoZSBlbmQgKGRvdCBjaGFyYWN0ZXJzKS5cbiAgICByZXR1cm4gYmFzZTY0RW5jb2RlKHN0cikucmVwbGFjZSgvXFwuL2csICcnKTtcbn07XG4vKipcbiAqIFVSTC1zYWZlIGJhc2U2NCBkZWNvZGluZ1xuICpcbiAqIE5PVEU6IERPIE5PVCB1c2UgdGhlIGdsb2JhbCBhdG9iKCkgZnVuY3Rpb24gLSBpdCBkb2VzIE5PVCBzdXBwb3J0IHRoZVxuICogYmFzZTY0VXJsIHZhcmlhbnQgZW5jb2RpbmcuXG4gKlxuICogQHBhcmFtIHN0ciBUbyBiZSBkZWNvZGVkXG4gKiBAcmV0dXJuIERlY29kZWQgcmVzdWx0LCBpZiBwb3NzaWJsZVxuICovXG5jb25zdCBiYXNlNjREZWNvZGUgPSBmdW5jdGlvbiAoc3RyKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIGJhc2U2NC5kZWNvZGVTdHJpbmcoc3RyLCB0cnVlKTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignYmFzZTY0RGVjb2RlIGZhaWxlZDogJywgZSk7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogRG8gYSBkZWVwLWNvcHkgb2YgYmFzaWMgSmF2YVNjcmlwdCBPYmplY3RzIG9yIEFycmF5cy5cbiAqL1xuZnVuY3Rpb24gZGVlcENvcHkodmFsdWUpIHtcbiAgICByZXR1cm4gZGVlcEV4dGVuZCh1bmRlZmluZWQsIHZhbHVlKTtcbn1cbi8qKlxuICogQ29weSBwcm9wZXJ0aWVzIGZyb20gc291cmNlIHRvIHRhcmdldCAocmVjdXJzaXZlbHkgYWxsb3dzIGV4dGVuc2lvblxuICogb2YgT2JqZWN0cyBhbmQgQXJyYXlzKS4gIFNjYWxhciB2YWx1ZXMgaW4gdGhlIHRhcmdldCBhcmUgb3Zlci13cml0dGVuLlxuICogSWYgdGFyZ2V0IGlzIHVuZGVmaW5lZCwgYW4gb2JqZWN0IG9mIHRoZSBhcHByb3ByaWF0ZSB0eXBlIHdpbGwgYmUgY3JlYXRlZFxuICogKGFuZCByZXR1cm5lZCkuXG4gKlxuICogV2UgcmVjdXJzaXZlbHkgY29weSBhbGwgY2hpbGQgcHJvcGVydGllcyBvZiBwbGFpbiBPYmplY3RzIGluIHRoZSBzb3VyY2UtIHNvXG4gKiB0aGF0IG5hbWVzcGFjZS0gbGlrZSBkaWN0aW9uYXJpZXMgYXJlIG1lcmdlZC5cbiAqXG4gKiBOb3RlIHRoYXQgdGhlIHRhcmdldCBjYW4gYmUgYSBmdW5jdGlvbiwgaW4gd2hpY2ggY2FzZSB0aGUgcHJvcGVydGllcyBpblxuICogdGhlIHNvdXJjZSBPYmplY3QgYXJlIGNvcGllZCBvbnRvIGl0IGFzIHN0YXRpYyBwcm9wZXJ0aWVzIG9mIHRoZSBGdW5jdGlvbi5cbiAqXG4gKiBOb3RlOiB3ZSBkb24ndCBtZXJnZSBfX3Byb3RvX18gdG8gcHJldmVudCBwcm90b3R5cGUgcG9sbHV0aW9uXG4gKi9cbmZ1bmN0aW9uIGRlZXBFeHRlbmQodGFyZ2V0LCBzb3VyY2UpIHtcbiAgICBpZiAoIShzb3VyY2UgaW5zdGFuY2VvZiBPYmplY3QpKSB7XG4gICAgICAgIHJldHVybiBzb3VyY2U7XG4gICAgfVxuICAgIHN3aXRjaCAoc291cmNlLmNvbnN0cnVjdG9yKSB7XG4gICAgICAgIGNhc2UgRGF0ZTpcbiAgICAgICAgICAgIC8vIFRyZWF0IERhdGVzIGxpa2Ugc2NhbGFyczsgaWYgdGhlIHRhcmdldCBkYXRlIG9iamVjdCBoYWQgYW55IGNoaWxkXG4gICAgICAgICAgICAvLyBwcm9wZXJ0aWVzIC0gdGhleSB3aWxsIGJlIGxvc3QhXG4gICAgICAgICAgICBjb25zdCBkYXRlVmFsdWUgPSBzb3VyY2U7XG4gICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoZGF0ZVZhbHVlLmdldFRpbWUoKSk7XG4gICAgICAgIGNhc2UgT2JqZWN0OlxuICAgICAgICAgICAgaWYgKHRhcmdldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0ge307XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBBcnJheTpcbiAgICAgICAgICAgIC8vIEFsd2F5cyBjb3B5IHRoZSBhcnJheSBzb3VyY2UgYW5kIG92ZXJ3cml0ZSB0aGUgdGFyZ2V0LlxuICAgICAgICAgICAgdGFyZ2V0ID0gW107XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIC8vIE5vdCBhIHBsYWluIE9iamVjdCAtIHRyZWF0IGl0IGFzIGEgc2NhbGFyLlxuICAgICAgICAgICAgcmV0dXJuIHNvdXJjZTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBwcm9wIGluIHNvdXJjZSkge1xuICAgICAgICAvLyB1c2UgaXNWYWxpZEtleSB0byBndWFyZCBhZ2FpbnN0IHByb3RvdHlwZSBwb2xsdXRpb24uIFNlZSBodHRwczovL3NueWsuaW8vdnVsbi9TTllLLUpTLUxPREFTSC00NTAyMDJcbiAgICAgICAgaWYgKCFzb3VyY2UuaGFzT3duUHJvcGVydHkocHJvcCkgfHwgIWlzVmFsaWRLZXkocHJvcCkpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHRhcmdldFtwcm9wXSA9IGRlZXBFeHRlbmQodGFyZ2V0W3Byb3BdLCBzb3VyY2VbcHJvcF0pO1xuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0O1xufVxuZnVuY3Rpb24gaXNWYWxpZEtleShrZXkpIHtcbiAgICByZXR1cm4ga2V5ICE9PSAnX19wcm90b19fJztcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUG9seWZpbGwgZm9yIGBnbG9iYWxUaGlzYCBvYmplY3QuXG4gKiBAcmV0dXJucyB0aGUgYGdsb2JhbFRoaXNgIG9iamVjdCBmb3IgdGhlIGdpdmVuIGVudmlyb25tZW50LlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiBnZXRHbG9iYWwoKSB7XG4gICAgaWYgKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm4gc2VsZjtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybiB3aW5kb3c7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm4gZ2xvYmFsO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byBsb2NhdGUgZ2xvYmFsIG9iamVjdC4nKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IGdldERlZmF1bHRzRnJvbUdsb2JhbCA9ICgpID0+IGdldEdsb2JhbCgpLl9fRklSRUJBU0VfREVGQVVMVFNfXztcbi8qKlxuICogQXR0ZW1wdCB0byByZWFkIGRlZmF1bHRzIGZyb20gYSBKU09OIHN0cmluZyBwcm92aWRlZCB0b1xuICogcHJvY2VzcyguKWVudiguKV9fRklSRUJBU0VfREVGQVVMVFNfXyBvciBhIEpTT04gZmlsZSB3aG9zZSBwYXRoIGlzIGluXG4gKiBwcm9jZXNzKC4pZW52KC4pX19GSVJFQkFTRV9ERUZBVUxUU19QQVRIX19cbiAqIFRoZSBkb3RzIGFyZSBpbiBwYXJlbnMgYmVjYXVzZSBjZXJ0YWluIGNvbXBpbGVycyAoVml0ZT8pIGNhbm5vdFxuICogaGFuZGxlIHNlZWluZyB0aGF0IHZhcmlhYmxlIGluIGNvbW1lbnRzLlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9maXJlYmFzZS9maXJlYmFzZS1qcy1zZGsvaXNzdWVzLzY4MzhcbiAqL1xuY29uc3QgZ2V0RGVmYXVsdHNGcm9tRW52VmFyaWFibGUgPSAoKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBwcm9jZXNzID09PSAndW5kZWZpbmVkJyB8fCB0eXBlb2YgcHJvY2Vzcy5lbnYgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgZGVmYXVsdHNKc29uU3RyaW5nID0gcHJvY2Vzcy5lbnYuX19GSVJFQkFTRV9ERUZBVUxUU19fO1xuICAgIGlmIChkZWZhdWx0c0pzb25TdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoZGVmYXVsdHNKc29uU3RyaW5nKTtcbiAgICB9XG59O1xuY29uc3QgZ2V0RGVmYXVsdHNGcm9tQ29va2llID0gKCkgPT4ge1xuICAgIGlmICh0eXBlb2YgZG9jdW1lbnQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbGV0IG1hdGNoO1xuICAgIHRyeSB7XG4gICAgICAgIG1hdGNoID0gZG9jdW1lbnQuY29va2llLm1hdGNoKC9fX0ZJUkVCQVNFX0RFRkFVTFRTX189KFteO10rKS8pO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICAvLyBTb21lIGVudmlyb25tZW50cyBzdWNoIGFzIEFuZ3VsYXIgVW5pdmVyc2FsIFNTUiBoYXZlIGFcbiAgICAgICAgLy8gYGRvY3VtZW50YCBvYmplY3QgYnV0IGVycm9yIG9uIGFjY2Vzc2luZyBgZG9jdW1lbnQuY29va2llYC5cbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBkZWNvZGVkID0gbWF0Y2ggJiYgYmFzZTY0RGVjb2RlKG1hdGNoWzFdKTtcbiAgICByZXR1cm4gZGVjb2RlZCAmJiBKU09OLnBhcnNlKGRlY29kZWQpO1xufTtcbi8qKlxuICogR2V0IHRoZSBfX0ZJUkVCQVNFX0RFRkFVTFRTX18gb2JqZWN0LiBJdCBjaGVja3MgaW4gb3JkZXI6XG4gKiAoMSkgaWYgc3VjaCBhbiBvYmplY3QgZXhpc3RzIGFzIGEgcHJvcGVydHkgb2YgYGdsb2JhbFRoaXNgXG4gKiAoMikgaWYgc3VjaCBhbiBvYmplY3Qgd2FzIHByb3ZpZGVkIG9uIGEgc2hlbGwgZW52aXJvbm1lbnQgdmFyaWFibGVcbiAqICgzKSBpZiBzdWNoIGFuIG9iamVjdCBleGlzdHMgaW4gYSBjb29raWVcbiAqIEBwdWJsaWNcbiAqL1xuY29uc3QgZ2V0RGVmYXVsdHMgPSAoKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIChnZXREZWZhdWx0c0Zyb21Qb3N0aW5zdGFsbCgpIHx8XG4gICAgICAgICAgICBnZXREZWZhdWx0c0Zyb21HbG9iYWwoKSB8fFxuICAgICAgICAgICAgZ2V0RGVmYXVsdHNGcm9tRW52VmFyaWFibGUoKSB8fFxuICAgICAgICAgICAgZ2V0RGVmYXVsdHNGcm9tQ29va2llKCkpO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICAvKipcbiAgICAgICAgICogQ2F0Y2gtYWxsIGZvciBiZWluZyB1bmFibGUgdG8gZ2V0IF9fRklSRUJBU0VfREVGQVVMVFNfXyBkdWVcbiAgICAgICAgICogdG8gYW55IGVudmlyb25tZW50IGNhc2Ugd2UgaGF2ZSBub3QgYWNjb3VudGVkIGZvci4gTG9nIHRvXG4gICAgICAgICAqIGluZm8gaW5zdGVhZCBvZiBzd2FsbG93aW5nIHNvIHdlIGNhbiBmaW5kIHRoZXNlIHVua25vd24gY2FzZXNcbiAgICAgICAgICogYW5kIGFkZCBwYXRocyBmb3IgdGhlbSBpZiBuZWVkZWQuXG4gICAgICAgICAqL1xuICAgICAgICBjb25zb2xlLmluZm8oYFVuYWJsZSB0byBnZXQgX19GSVJFQkFTRV9ERUZBVUxUU19fIGR1ZSB0bzogJHtlfWApO1xuICAgICAgICByZXR1cm47XG4gICAgfVxufTtcbi8qKlxuICogUmV0dXJucyBlbXVsYXRvciBob3N0IHN0b3JlZCBpbiB0aGUgX19GSVJFQkFTRV9ERUZBVUxUU19fIG9iamVjdFxuICogZm9yIHRoZSBnaXZlbiBwcm9kdWN0LlxuICogQHJldHVybnMgYSBVUkwgaG9zdCBmb3JtYXR0ZWQgbGlrZSBgMTI3LjAuMC4xOjk5OTlgIG9yIGBbOjoxXTo0MDAwYCBpZiBhdmFpbGFibGVcbiAqIEBwdWJsaWNcbiAqL1xuY29uc3QgZ2V0RGVmYXVsdEVtdWxhdG9ySG9zdCA9IChwcm9kdWN0TmFtZSkgPT4gZ2V0RGVmYXVsdHMoKT8uZW11bGF0b3JIb3N0cz8uW3Byb2R1Y3ROYW1lXTtcbi8qKlxuICogUmV0dXJucyBlbXVsYXRvciBob3N0bmFtZSBhbmQgcG9ydCBzdG9yZWQgaW4gdGhlIF9fRklSRUJBU0VfREVGQVVMVFNfXyBvYmplY3RcbiAqIGZvciB0aGUgZ2l2ZW4gcHJvZHVjdC5cbiAqIEByZXR1cm5zIGEgcGFpciBvZiBob3N0bmFtZSBhbmQgcG9ydCBsaWtlIGBbXCI6OjFcIiwgNDAwMF1gIGlmIGF2YWlsYWJsZVxuICogQHB1YmxpY1xuICovXG5jb25zdCBnZXREZWZhdWx0RW11bGF0b3JIb3N0bmFtZUFuZFBvcnQgPSAocHJvZHVjdE5hbWUpID0+IHtcbiAgICBjb25zdCBob3N0ID0gZ2V0RGVmYXVsdEVtdWxhdG9ySG9zdChwcm9kdWN0TmFtZSk7XG4gICAgaWYgKCFob3N0KSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGNvbnN0IHNlcGFyYXRvckluZGV4ID0gaG9zdC5sYXN0SW5kZXhPZignOicpOyAvLyBGaW5kaW5nIHRoZSBsYXN0IHNpbmNlIElQdjYgYWRkciBhbHNvIGhhcyBjb2xvbnMuXG4gICAgaWYgKHNlcGFyYXRvckluZGV4IDw9IDAgfHwgc2VwYXJhdG9ySW5kZXggKyAxID09PSBob3N0Lmxlbmd0aCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgaG9zdCAke2hvc3R9IHdpdGggbm8gc2VwYXJhdGUgaG9zdG5hbWUgYW5kIHBvcnQhYCk7XG4gICAgfVxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLWdsb2JhbHNcbiAgICBjb25zdCBwb3J0ID0gcGFyc2VJbnQoaG9zdC5zdWJzdHJpbmcoc2VwYXJhdG9ySW5kZXggKyAxKSwgMTApO1xuICAgIGlmIChob3N0WzBdID09PSAnWycpIHtcbiAgICAgICAgLy8gQnJhY2tldC1xdW90ZWQgYFtpcHY2YWRkcl06cG9ydGAgPT4gcmV0dXJuIFwiaXB2NmFkZHJcIiAod2l0aG91dCBicmFja2V0cykuXG4gICAgICAgIHJldHVybiBbaG9zdC5zdWJzdHJpbmcoMSwgc2VwYXJhdG9ySW5kZXggLSAxKSwgcG9ydF07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gW2hvc3Quc3Vic3RyaW5nKDAsIHNlcGFyYXRvckluZGV4KSwgcG9ydF07XG4gICAgfVxufTtcbi8qKlxuICogUmV0dXJucyBGaXJlYmFzZSBhcHAgY29uZmlnIHN0b3JlZCBpbiB0aGUgX19GSVJFQkFTRV9ERUZBVUxUU19fIG9iamVjdC5cbiAqIEBwdWJsaWNcbiAqL1xuY29uc3QgZ2V0RGVmYXVsdEFwcENvbmZpZyA9ICgpID0+IGdldERlZmF1bHRzKCk/LmNvbmZpZztcbi8qKlxuICogUmV0dXJucyBhbiBleHBlcmltZW50YWwgc2V0dGluZyBvbiB0aGUgX19GSVJFQkFTRV9ERUZBVUxUU19fIG9iamVjdCAocHJvcGVydGllc1xuICogcHJlZml4ZWQgYnkgXCJfXCIpXG4gKiBAcHVibGljXG4gKi9cbmNvbnN0IGdldEV4cGVyaW1lbnRhbFNldHRpbmcgPSAobmFtZSkgPT4gZ2V0RGVmYXVsdHMoKT8uW2BfJHtuYW1lfWBdO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3MgRGVmZXJyZWQge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnJlamVjdCA9ICgpID0+IHsgfTtcbiAgICAgICAgdGhpcy5yZXNvbHZlID0gKCkgPT4geyB9O1xuICAgICAgICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlc29sdmUgPSByZXNvbHZlO1xuICAgICAgICAgICAgdGhpcy5yZWplY3QgPSByZWplY3Q7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBPdXIgQVBJIGludGVybmFscyBhcmUgbm90IHByb21pc2lmaWVkIGFuZCBjYW5ub3QgYmVjYXVzZSBvdXIgY2FsbGJhY2sgQVBJcyBoYXZlIHN1YnRsZSBleHBlY3RhdGlvbnMgYXJvdW5kXG4gICAgICogaW52b2tpbmcgcHJvbWlzZXMgaW5saW5lLCB3aGljaCBQcm9taXNlcyBhcmUgZm9yYmlkZGVuIHRvIGRvLiBUaGlzIG1ldGhvZCBhY2NlcHRzIGFuIG9wdGlvbmFsIG5vZGUtc3R5bGUgY2FsbGJhY2tcbiAgICAgKiBhbmQgcmV0dXJucyBhIG5vZGUtc3R5bGUgY2FsbGJhY2sgd2hpY2ggd2lsbCByZXNvbHZlIG9yIHJlamVjdCB0aGUgRGVmZXJyZWQncyBwcm9taXNlLlxuICAgICAqL1xuICAgIHdyYXBDYWxsYmFjayhjYWxsYmFjaykge1xuICAgICAgICByZXR1cm4gKGVycm9yLCB2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNvbHZlKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAvLyBBdHRhY2hpbmcgbm9vcCBoYW5kbGVyIGp1c3QgaW4gY2FzZSBkZXZlbG9wZXIgd2Fzbid0IGV4cGVjdGluZ1xuICAgICAgICAgICAgICAgIC8vIHByb21pc2VzXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9taXNlLmNhdGNoKCgpID0+IHsgfSk7XG4gICAgICAgICAgICAgICAgLy8gU29tZSBvZiBvdXIgY2FsbGJhY2tzIGRvbid0IGV4cGVjdCBhIHZhbHVlIGFuZCBvdXIgb3duIHRlc3RzXG4gICAgICAgICAgICAgICAgLy8gYXNzZXJ0IHRoYXQgdGhlIHBhcmFtZXRlciBsZW5ndGggaXMgMVxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjay5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyNSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBDaGVja3Mgd2hldGhlciBob3N0IGlzIGEgY2xvdWQgd29ya3N0YXRpb24gb3Igbm90LlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiBpc0Nsb3VkV29ya3N0YXRpb24odXJsKSB7XG4gICAgLy8gYGlzQ2xvdWRXb3Jrc3RhdGlvbmAgaXMgY2FsbGVkIHdpdGhvdXQgcHJvdG9jb2wgaW4gY2VydGFpbiBjb25uZWN0KkVtdWxhdG9yIGZ1bmN0aW9uc1xuICAgIC8vIEluIEhUVFAgcmVxdWVzdCBidWlsZGVycywgaXQncyBjYWxsZWQgd2l0aCB0aGUgcHJvdG9jb2wuXG4gICAgLy8gSWYgY2FsbGVkIHdpdGggcHJvdG9jb2wgcHJlZml4LCBpdCdzIGEgdmFsaWQgVVJMLCBzbyB3ZSBleHRyYWN0IHRoZSBob3N0bmFtZVxuICAgIC8vIElmIGNhbGxlZCB3aXRob3V0LCB3ZSBhc3N1bWUgdGhlIHN0cmluZyBpcyB0aGUgaG9zdG5hbWUuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgaG9zdCA9IHVybC5zdGFydHNXaXRoKCdodHRwOi8vJykgfHwgdXJsLnN0YXJ0c1dpdGgoJ2h0dHBzOi8vJylcbiAgICAgICAgICAgID8gbmV3IFVSTCh1cmwpLmhvc3RuYW1lXG4gICAgICAgICAgICA6IHVybDtcbiAgICAgICAgcmV0dXJuIGhvc3QuZW5kc1dpdGgoJy5jbG91ZHdvcmtzdGF0aW9ucy5kZXYnKTtcbiAgICB9XG4gICAgY2F0Y2gge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuLyoqXG4gKiBNYWtlcyBhIGZldGNoIHJlcXVlc3QgdG8gdGhlIGdpdmVuIHNlcnZlci5cbiAqIE1vc3RseSB1c2VkIGZvciBmb3J3YXJkaW5nIGNvb2tpZXMgaW4gRmlyZWJhc2UgU3R1ZGlvLlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiBwaW5nU2VydmVyKGVuZHBvaW50KSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZmV0Y2goZW5kcG9pbnQsIHtcbiAgICAgICAgY3JlZGVudGlhbHM6ICdpbmNsdWRlJ1xuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHQub2s7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIxIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5mdW5jdGlvbiBjcmVhdGVNb2NrVXNlclRva2VuKHRva2VuLCBwcm9qZWN0SWQpIHtcbiAgICBpZiAodG9rZW4udWlkKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIFwidWlkXCIgZmllbGQgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZCBieSBtb2NrVXNlclRva2VuLiBQbGVhc2UgdXNlIFwic3ViXCIgaW5zdGVhZCBmb3IgRmlyZWJhc2UgQXV0aCBVc2VyIElELicpO1xuICAgIH1cbiAgICAvLyBVbnNlY3VyZWQgSldUcyB1c2UgXCJub25lXCIgYXMgdGhlIGFsZ29yaXRobS5cbiAgICBjb25zdCBoZWFkZXIgPSB7XG4gICAgICAgIGFsZzogJ25vbmUnLFxuICAgICAgICB0eXBlOiAnSldUJ1xuICAgIH07XG4gICAgY29uc3QgcHJvamVjdCA9IHByb2plY3RJZCB8fCAnZGVtby1wcm9qZWN0JztcbiAgICBjb25zdCBpYXQgPSB0b2tlbi5pYXQgfHwgMDtcbiAgICBjb25zdCBzdWIgPSB0b2tlbi5zdWIgfHwgdG9rZW4udXNlcl9pZDtcbiAgICBpZiAoIXN1Yikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJtb2NrVXNlclRva2VuIG11c3QgY29udGFpbiAnc3ViJyBvciAndXNlcl9pZCcgZmllbGQhXCIpO1xuICAgIH1cbiAgICBjb25zdCBwYXlsb2FkID0ge1xuICAgICAgICAvLyBTZXQgYWxsIHJlcXVpcmVkIGZpZWxkcyB0byBkZWNlbnQgZGVmYXVsdHNcbiAgICAgICAgaXNzOiBgaHR0cHM6Ly9zZWN1cmV0b2tlbi5nb29nbGUuY29tLyR7cHJvamVjdH1gLFxuICAgICAgICBhdWQ6IHByb2plY3QsXG4gICAgICAgIGlhdCxcbiAgICAgICAgZXhwOiBpYXQgKyAzNjAwLFxuICAgICAgICBhdXRoX3RpbWU6IGlhdCxcbiAgICAgICAgc3ViLFxuICAgICAgICB1c2VyX2lkOiBzdWIsXG4gICAgICAgIGZpcmViYXNlOiB7XG4gICAgICAgICAgICBzaWduX2luX3Byb3ZpZGVyOiAnY3VzdG9tJyxcbiAgICAgICAgICAgIGlkZW50aXRpZXM6IHt9XG4gICAgICAgIH0sXG4gICAgICAgIC8vIE92ZXJyaWRlIHdpdGggdXNlciBvcHRpb25zXG4gICAgICAgIC4uLnRva2VuXG4gICAgfTtcbiAgICAvLyBVbnNlY3VyZWQgSldUcyB1c2UgdGhlIGVtcHR5IHN0cmluZyBhcyBhIHNpZ25hdHVyZS5cbiAgICBjb25zdCBzaWduYXR1cmUgPSAnJztcbiAgICByZXR1cm4gW1xuICAgICAgICBiYXNlNjR1cmxFbmNvZGVXaXRob3V0UGFkZGluZyhKU09OLnN0cmluZ2lmeShoZWFkZXIpKSxcbiAgICAgICAgYmFzZTY0dXJsRW5jb2RlV2l0aG91dFBhZGRpbmcoSlNPTi5zdHJpbmdpZnkocGF5bG9hZCkpLFxuICAgICAgICBzaWduYXR1cmVcbiAgICBdLmpvaW4oJy4nKTtcbn1cbmNvbnN0IGVtdWxhdG9yU3RhdHVzID0ge307XG4vLyBDaGVja3Mgd2hldGhlciBhbnkgcHJvZHVjdHMgYXJlIHJ1bm5pbmcgb24gYW4gZW11bGF0b3JcbmZ1bmN0aW9uIGdldEVtdWxhdG9yU3VtbWFyeSgpIHtcbiAgICBjb25zdCBzdW1tYXJ5ID0ge1xuICAgICAgICBwcm9kOiBbXSxcbiAgICAgICAgZW11bGF0b3I6IFtdXG4gICAgfTtcbiAgICBmb3IgKGNvbnN0IGtleSBvZiBPYmplY3Qua2V5cyhlbXVsYXRvclN0YXR1cykpIHtcbiAgICAgICAgaWYgKGVtdWxhdG9yU3RhdHVzW2tleV0pIHtcbiAgICAgICAgICAgIHN1bW1hcnkuZW11bGF0b3IucHVzaChrZXkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3VtbWFyeS5wcm9kLnB1c2goa2V5KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc3VtbWFyeTtcbn1cbmZ1bmN0aW9uIGdldE9yQ3JlYXRlRWwoaWQpIHtcbiAgICBsZXQgcGFyZW50RGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuICAgIGxldCBjcmVhdGVkID0gZmFsc2U7XG4gICAgaWYgKCFwYXJlbnREaXYpIHtcbiAgICAgICAgcGFyZW50RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHBhcmVudERpdi5zZXRBdHRyaWJ1dGUoJ2lkJywgaWQpO1xuICAgICAgICBjcmVhdGVkID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHsgY3JlYXRlZCwgZWxlbWVudDogcGFyZW50RGl2IH07XG59XG5sZXQgcHJldmlvdXNseURpc21pc3NlZCA9IGZhbHNlO1xuLyoqXG4gKiBVcGRhdGVzIEVtdWxhdG9yIEJhbm5lci4gUHJpbWFyaWx5IHVzZWQgZm9yIEZpcmViYXNlIFN0dWRpb1xuICogQHBhcmFtIG5hbWVcbiAqIEBwYXJhbSBpc1J1bm5pbmdFbXVsYXRvclxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiB1cGRhdGVFbXVsYXRvckJhbm5lcihuYW1lLCBpc1J1bm5pbmdFbXVsYXRvcikge1xuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJyB8fFxuICAgICAgICB0eXBlb2YgZG9jdW1lbnQgPT09ICd1bmRlZmluZWQnIHx8XG4gICAgICAgICFpc0Nsb3VkV29ya3N0YXRpb24od2luZG93LmxvY2F0aW9uLmhvc3QpIHx8XG4gICAgICAgIGVtdWxhdG9yU3RhdHVzW25hbWVdID09PSBpc1J1bm5pbmdFbXVsYXRvciB8fFxuICAgICAgICBlbXVsYXRvclN0YXR1c1tuYW1lXSB8fCAvLyBJZiBhbHJlYWR5IHNldCB0byB1c2UgZW11bGF0b3IsIGNhbid0IGdvIGJhY2sgdG8gcHJvZC5cbiAgICAgICAgcHJldmlvdXNseURpc21pc3NlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGVtdWxhdG9yU3RhdHVzW25hbWVdID0gaXNSdW5uaW5nRW11bGF0b3I7XG4gICAgZnVuY3Rpb24gcHJlZml4ZWRJZChpZCkge1xuICAgICAgICByZXR1cm4gYF9fZmlyZWJhc2VfX2Jhbm5lcl9fJHtpZH1gO1xuICAgIH1cbiAgICBjb25zdCBiYW5uZXJJZCA9ICdfX2ZpcmViYXNlX19iYW5uZXInO1xuICAgIGNvbnN0IHN1bW1hcnkgPSBnZXRFbXVsYXRvclN1bW1hcnkoKTtcbiAgICBjb25zdCBzaG93RXJyb3IgPSBzdW1tYXJ5LnByb2QubGVuZ3RoID4gMDtcbiAgICBmdW5jdGlvbiB0ZWFyRG93bigpIHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGJhbm5lcklkKTtcbiAgICAgICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gc2V0dXBCYW5uZXJTdHlsZXMoYmFubmVyRWwpIHtcbiAgICAgICAgYmFubmVyRWwuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcbiAgICAgICAgYmFubmVyRWwuc3R5bGUuYmFja2dyb3VuZCA9ICcjN2ZhYWYwJztcbiAgICAgICAgYmFubmVyRWwuc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnO1xuICAgICAgICBiYW5uZXJFbC5zdHlsZS5ib3R0b20gPSAnNXB4JztcbiAgICAgICAgYmFubmVyRWwuc3R5bGUubGVmdCA9ICc1cHgnO1xuICAgICAgICBiYW5uZXJFbC5zdHlsZS5wYWRkaW5nID0gJy41ZW0nO1xuICAgICAgICBiYW5uZXJFbC5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnNXB4JztcbiAgICAgICAgYmFubmVyRWwuc3R5bGUuYWxpZ25JdGVtcyA9ICdjZW50ZXInO1xuICAgIH1cbiAgICBmdW5jdGlvbiBzZXR1cEljb25TdHlsZXMocHJlcGVuZEljb24sIGljb25JZCkge1xuICAgICAgICBwcmVwZW5kSWNvbi5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgJzI0Jyk7XG4gICAgICAgIHByZXBlbmRJY29uLnNldEF0dHJpYnV0ZSgnaWQnLCBpY29uSWQpO1xuICAgICAgICBwcmVwZW5kSWNvbi5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICcyNCcpO1xuICAgICAgICBwcmVwZW5kSWNvbi5zZXRBdHRyaWJ1dGUoJ3ZpZXdCb3gnLCAnMCAwIDI0IDI0Jyk7XG4gICAgICAgIHByZXBlbmRJY29uLnNldEF0dHJpYnV0ZSgnZmlsbCcsICdub25lJyk7XG4gICAgICAgIHByZXBlbmRJY29uLnN0eWxlLm1hcmdpbkxlZnQgPSAnLTZweCc7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNldHVwQ2xvc2VCdG4oKSB7XG4gICAgICAgIGNvbnN0IGNsb3NlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICBjbG9zZUJ0bi5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7XG4gICAgICAgIGNsb3NlQnRuLnN0eWxlLm1hcmdpbkxlZnQgPSAnMTZweCc7XG4gICAgICAgIGNsb3NlQnRuLnN0eWxlLmZvbnRTaXplID0gJzI0cHgnO1xuICAgICAgICBjbG9zZUJ0bi5pbm5lckhUTUwgPSAnICZ0aW1lczsnO1xuICAgICAgICBjbG9zZUJ0bi5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgcHJldmlvdXNseURpc21pc3NlZCA9IHRydWU7XG4gICAgICAgICAgICB0ZWFyRG93bigpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gY2xvc2VCdG47XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNldHVwTGlua1N0eWxlcyhsZWFybk1vcmVMaW5rLCBsZWFybk1vcmVJZCkge1xuICAgICAgICBsZWFybk1vcmVMaW5rLnNldEF0dHJpYnV0ZSgnaWQnLCBsZWFybk1vcmVJZCk7XG4gICAgICAgIGxlYXJuTW9yZUxpbmsuaW5uZXJUZXh0ID0gJ0xlYXJuIG1vcmUnO1xuICAgICAgICBsZWFybk1vcmVMaW5rLmhyZWYgPVxuICAgICAgICAgICAgJ2h0dHBzOi8vZmlyZWJhc2UuZ29vZ2xlLmNvbS9kb2NzL3N0dWRpby9wcmV2aWV3LWFwcHMjcHJldmlldy1iYWNrZW5kJztcbiAgICAgICAgbGVhcm5Nb3JlTGluay5zZXRBdHRyaWJ1dGUoJ3RhcmdldCcsICdfX2JsYW5rJyk7XG4gICAgICAgIGxlYXJuTW9yZUxpbmsuc3R5bGUucGFkZGluZ0xlZnQgPSAnNXB4JztcbiAgICAgICAgbGVhcm5Nb3JlTGluay5zdHlsZS50ZXh0RGVjb3JhdGlvbiA9ICd1bmRlcmxpbmUnO1xuICAgIH1cbiAgICBmdW5jdGlvbiBzZXR1cERvbSgpIHtcbiAgICAgICAgY29uc3QgYmFubmVyID0gZ2V0T3JDcmVhdGVFbChiYW5uZXJJZCk7XG4gICAgICAgIGNvbnN0IGZpcmViYXNlVGV4dElkID0gcHJlZml4ZWRJZCgndGV4dCcpO1xuICAgICAgICBjb25zdCBmaXJlYmFzZVRleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmaXJlYmFzZVRleHRJZCkgfHwgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICBjb25zdCBsZWFybk1vcmVJZCA9IHByZWZpeGVkSWQoJ2xlYXJubW9yZScpO1xuICAgICAgICBjb25zdCBsZWFybk1vcmVMaW5rID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobGVhcm5Nb3JlSWQpIHx8XG4gICAgICAgICAgICBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICAgIGNvbnN0IHByZXBlbmRJY29uSWQgPSBwcmVmaXhlZElkKCdwcmVwcmVuZEljb24nKTtcbiAgICAgICAgY29uc3QgcHJlcGVuZEljb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwcmVwZW5kSWNvbklkKSB8fFxuICAgICAgICAgICAgZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdzdmcnKTtcbiAgICAgICAgaWYgKGJhbm5lci5jcmVhdGVkKSB7XG4gICAgICAgICAgICAvLyB1cGRhdGUgc3R5bGVzXG4gICAgICAgICAgICBjb25zdCBiYW5uZXJFbCA9IGJhbm5lci5lbGVtZW50O1xuICAgICAgICAgICAgc2V0dXBCYW5uZXJTdHlsZXMoYmFubmVyRWwpO1xuICAgICAgICAgICAgc2V0dXBMaW5rU3R5bGVzKGxlYXJuTW9yZUxpbmssIGxlYXJuTW9yZUlkKTtcbiAgICAgICAgICAgIGNvbnN0IGNsb3NlQnRuID0gc2V0dXBDbG9zZUJ0bigpO1xuICAgICAgICAgICAgc2V0dXBJY29uU3R5bGVzKHByZXBlbmRJY29uLCBwcmVwZW5kSWNvbklkKTtcbiAgICAgICAgICAgIGJhbm5lckVsLmFwcGVuZChwcmVwZW5kSWNvbiwgZmlyZWJhc2VUZXh0LCBsZWFybk1vcmVMaW5rLCBjbG9zZUJ0bik7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGJhbm5lckVsKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2hvd0Vycm9yKSB7XG4gICAgICAgICAgICBmaXJlYmFzZVRleHQuaW5uZXJUZXh0ID0gYFByZXZpZXcgYmFja2VuZCBkaXNjb25uZWN0ZWQuYDtcbiAgICAgICAgICAgIHByZXBlbmRJY29uLmlubmVySFRNTCA9IGA8ZyBjbGlwLXBhdGg9XCJ1cmwoI2NsaXAwXzYwMTNfMzM4NTgpXCI+XG48cGF0aCBkPVwiTTQuOCAxNy42TDEyIDUuNkwxOS4yIDE3LjZINC44Wk02LjkxNjY3IDE2LjRIMTcuMDgzM0wxMiA3LjkzMzMzTDYuOTE2NjcgMTYuNFpNMTIgMTUuNkMxMi4xNjY3IDE1LjYgMTIuMzA1NiAxNS41NDQ0IDEyLjQxNjcgMTUuNDMzM0MxMi41Mzg5IDE1LjMxMTEgMTIuNiAxNS4xNjY3IDEyLjYgMTVDMTIuNiAxNC44MzMzIDEyLjUzODkgMTQuNjk0NCAxMi40MTY3IDE0LjU4MzNDMTIuMzA1NiAxNC40NjExIDEyLjE2NjcgMTQuNCAxMiAxNC40QzExLjgzMzMgMTQuNCAxMS42ODg5IDE0LjQ2MTEgMTEuNTY2NyAxNC41ODMzQzExLjQ1NTYgMTQuNjk0NCAxMS40IDE0LjgzMzMgMTEuNCAxNUMxMS40IDE1LjE2NjcgMTEuNDU1NiAxNS4zMTExIDExLjU2NjcgMTUuNDMzM0MxMS42ODg5IDE1LjU0NDQgMTEuODMzMyAxNS42IDEyIDE1LjZaTTExLjQgMTMuNkgxMi42VjEwLjRIMTEuNFYxMy42WlwiIGZpbGw9XCIjMjEyMTIxXCIvPlxuPC9nPlxuPGRlZnM+XG48Y2xpcFBhdGggaWQ9XCJjbGlwMF82MDEzXzMzODU4XCI+XG48cmVjdCB3aWR0aD1cIjI0XCIgaGVpZ2h0PVwiMjRcIiBmaWxsPVwid2hpdGVcIi8+XG48L2NsaXBQYXRoPlxuPC9kZWZzPmA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwcmVwZW5kSWNvbi5pbm5lckhUTUwgPSBgPGcgY2xpcC1wYXRoPVwidXJsKCNjbGlwMF82MDgzXzM0ODA0KVwiPlxuPHBhdGggZD1cIk0xMS40IDE1LjJIMTIuNlYxMS4ySDExLjRWMTUuMlpNMTIgMTBDMTIuMTY2NyAxMCAxMi4zMDU2IDkuOTQ0NDQgMTIuNDE2NyA5LjgzMzMzQzEyLjUzODkgOS43MTExMSAxMi42IDkuNTY2NjcgMTIuNiA5LjRDMTIuNiA5LjIzMzMzIDEyLjUzODkgOS4wOTQ0NCAxMi40MTY3IDguOTgzMzNDMTIuMzA1NiA4Ljg2MTExIDEyLjE2NjcgOC44IDEyIDguOEMxMS44MzMzIDguOCAxMS42ODg5IDguODYxMTEgMTEuNTY2NyA4Ljk4MzMzQzExLjQ1NTYgOS4wOTQ0NCAxMS40IDkuMjMzMzMgMTEuNCA5LjRDMTEuNCA5LjU2NjY3IDExLjQ1NTYgOS43MTExMSAxMS41NjY3IDkuODMzMzNDMTEuNjg4OSA5Ljk0NDQ0IDExLjgzMzMgMTAgMTIgMTBaTTEyIDE4LjRDMTEuMTIyMiAxOC40IDEwLjI5NDQgMTguMjMzMyA5LjUxNjY3IDE3LjlDOC43Mzg4OSAxNy41NjY3IDguMDU1NTYgMTcuMTExMSA3LjQ2NjY3IDE2LjUzMzNDNi44ODg4OSAxNS45NDQ0IDYuNDMzMzMgMTUuMjYxMSA2LjEgMTQuNDgzM0M1Ljc2NjY3IDEzLjcwNTYgNS42IDEyLjg3NzggNS42IDEyQzUuNiAxMS4xMTExIDUuNzY2NjcgMTAuMjgzMyA2LjEgOS41MTY2N0M2LjQzMzMzIDguNzM4ODkgNi44ODg4OSA4LjA2MTExIDcuNDY2NjcgNy40ODMzM0M4LjA1NTU2IDYuODk0NDQgOC43Mzg4OSA2LjQzMzMzIDkuNTE2NjcgNi4xQzEwLjI5NDQgNS43NjY2NyAxMS4xMjIyIDUuNiAxMiA1LjZDMTIuODg4OSA1LjYgMTMuNzE2NyA1Ljc2NjY3IDE0LjQ4MzMgNi4xQzE1LjI2MTEgNi40MzMzMyAxNS45Mzg5IDYuODk0NDQgMTYuNTE2NyA3LjQ4MzMzQzE3LjEwNTYgOC4wNjExMSAxNy41NjY3IDguNzM4ODkgMTcuOSA5LjUxNjY3QzE4LjIzMzMgMTAuMjgzMyAxOC40IDExLjExMTEgMTguNCAxMkMxOC40IDEyLjg3NzggMTguMjMzMyAxMy43MDU2IDE3LjkgMTQuNDgzM0MxNy41NjY3IDE1LjI2MTEgMTcuMTA1NiAxNS45NDQ0IDE2LjUxNjcgMTYuNTMzM0MxNS45Mzg5IDE3LjExMTEgMTUuMjYxMSAxNy41NjY3IDE0LjQ4MzMgMTcuOUMxMy43MTY3IDE4LjIzMzMgMTIuODg4OSAxOC40IDEyIDE4LjRaTTEyIDE3LjJDMTMuNDQ0NCAxNy4yIDE0LjY3MjIgMTYuNjk0NCAxNS42ODMzIDE1LjY4MzNDMTYuNjk0NCAxNC42NzIyIDE3LjIgMTMuNDQ0NCAxNy4yIDEyQzE3LjIgMTAuNTU1NiAxNi42OTQ0IDkuMzI3NzggMTUuNjgzMyA4LjMxNjY3QzE0LjY3MjIgNy4zMDU1NSAxMy40NDQ0IDYuOCAxMiA2LjhDMTAuNTU1NiA2LjggOS4zMjc3OCA3LjMwNTU1IDguMzE2NjcgOC4zMTY2N0M3LjMwNTU2IDkuMzI3NzggNi44IDEwLjU1NTYgNi44IDEyQzYuOCAxMy40NDQ0IDcuMzA1NTYgMTQuNjcyMiA4LjMxNjY3IDE1LjY4MzNDOS4zMjc3OCAxNi42OTQ0IDEwLjU1NTYgMTcuMiAxMiAxNy4yWlwiIGZpbGw9XCIjMjEyMTIxXCIvPlxuPC9nPlxuPGRlZnM+XG48Y2xpcFBhdGggaWQ9XCJjbGlwMF82MDgzXzM0ODA0XCI+XG48cmVjdCB3aWR0aD1cIjI0XCIgaGVpZ2h0PVwiMjRcIiBmaWxsPVwid2hpdGVcIi8+XG48L2NsaXBQYXRoPlxuPC9kZWZzPmA7XG4gICAgICAgICAgICBmaXJlYmFzZVRleHQuaW5uZXJUZXh0ID0gJ1ByZXZpZXcgYmFja2VuZCBydW5uaW5nIGluIHRoaXMgd29ya3NwYWNlLic7XG4gICAgICAgIH1cbiAgICAgICAgZmlyZWJhc2VUZXh0LnNldEF0dHJpYnV0ZSgnaWQnLCBmaXJlYmFzZVRleHRJZCk7XG4gICAgfVxuICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSAnbG9hZGluZycpIHtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBzZXR1cERvbSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBzZXR1cERvbSgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmV0dXJucyBuYXZpZ2F0b3IudXNlckFnZW50IHN0cmluZyBvciAnJyBpZiBpdCdzIG5vdCBkZWZpbmVkLlxuICogQHJldHVybiB1c2VyIGFnZW50IHN0cmluZ1xuICovXG5mdW5jdGlvbiBnZXRVQSgpIHtcbiAgICBpZiAodHlwZW9mIG5hdmlnYXRvciAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgICAgdHlwZW9mIG5hdmlnYXRvclsndXNlckFnZW50J10gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHJldHVybiBuYXZpZ2F0b3JbJ3VzZXJBZ2VudCddO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbn1cbi8qKlxuICogRGV0ZWN0IENvcmRvdmEgLyBQaG9uZUdhcCAvIElvbmljIGZyYW1ld29ya3Mgb24gYSBtb2JpbGUgZGV2aWNlLlxuICpcbiAqIERlbGliZXJhdGVseSBkb2VzIG5vdCByZWx5IG9uIGNoZWNraW5nIGBmaWxlOi8vYCBVUkxzIChhcyB0aGlzIGZhaWxzIFBob25lR2FwXG4gKiBpbiB0aGUgUmlwcGxlIGVtdWxhdG9yKSBub3IgQ29yZG92YSBgb25EZXZpY2VSZWFkeWAsIHdoaWNoIHdvdWxkIG5vcm1hbGx5XG4gKiB3YWl0IGZvciBhIGNhbGxiYWNrLlxuICovXG5mdW5jdGlvbiBpc01vYmlsZUNvcmRvdmEoKSB7XG4gICAgcmV0dXJuICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICAvLyBAdHMtaWdub3JlIFNldHRpbmcgdXAgYW4gYnJvYWRseSBhcHBsaWNhYmxlIGluZGV4IHNpZ25hdHVyZSBmb3IgV2luZG93XG4gICAgICAgIC8vIGp1c3QgdG8gZGVhbCB3aXRoIHRoaXMgY2FzZSB3b3VsZCBwcm9iYWJseSBiZSBhIGJhZCBpZGVhLlxuICAgICAgICAhISh3aW5kb3dbJ2NvcmRvdmEnXSB8fCB3aW5kb3dbJ3Bob25lZ2FwJ10gfHwgd2luZG93WydQaG9uZUdhcCddKSAmJlxuICAgICAgICAvaW9zfGlwaG9uZXxpcG9kfGlwYWR8YW5kcm9pZHxibGFja2JlcnJ5fGllbW9iaWxlL2kudGVzdChnZXRVQSgpKSk7XG59XG4vKipcbiAqIERldGVjdCBOb2RlLmpzLlxuICpcbiAqIEByZXR1cm4gdHJ1ZSBpZiBOb2RlLmpzIGVudmlyb25tZW50IGlzIGRldGVjdGVkIG9yIHNwZWNpZmllZC5cbiAqL1xuLy8gTm9kZSBkZXRlY3Rpb24gbG9naWMgZnJvbTogaHR0cHM6Ly9naXRodWIuY29tL2lsaWFrYW4vZGV0ZWN0LW5vZGUvXG5mdW5jdGlvbiBpc05vZGUoKSB7XG4gICAgY29uc3QgZm9yY2VFbnZpcm9ubWVudCA9IGdldERlZmF1bHRzKCk/LmZvcmNlRW52aXJvbm1lbnQ7XG4gICAgaWYgKGZvcmNlRW52aXJvbm1lbnQgPT09ICdub2RlJykge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZm9yY2VFbnZpcm9ubWVudCA9PT0gJ2Jyb3dzZXInKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZ2xvYmFsLnByb2Nlc3MpID09PSAnW29iamVjdCBwcm9jZXNzXScpO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuLyoqXG4gKiBEZXRlY3QgQnJvd3NlciBFbnZpcm9ubWVudC5cbiAqIE5vdGU6IFRoaXMgd2lsbCByZXR1cm4gdHJ1ZSBmb3IgY2VydGFpbiB0ZXN0IGZyYW1ld29ya3MgdGhhdCBhcmUgaW5jb21wbGV0ZWx5XG4gKiBtaW1pY2tpbmcgYSBicm93c2VyLCBhbmQgc2hvdWxkIG5vdCBsZWFkIHRvIGFzc3VtaW5nIGFsbCBicm93c2VyIEFQSXMgYXJlXG4gKiBhdmFpbGFibGUuXG4gKi9cbmZ1bmN0aW9uIGlzQnJvd3NlcigpIHtcbiAgICByZXR1cm4gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgfHwgaXNXZWJXb3JrZXIoKTtcbn1cbi8qKlxuICogRGV0ZWN0IFdlYiBXb3JrZXIgY29udGV4dC5cbiAqL1xuZnVuY3Rpb24gaXNXZWJXb3JrZXIoKSB7XG4gICAgcmV0dXJuICh0eXBlb2YgV29ya2VyR2xvYmFsU2NvcGUgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgIHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICBzZWxmIGluc3RhbmNlb2YgV29ya2VyR2xvYmFsU2NvcGUpO1xufVxuLyoqXG4gKiBEZXRlY3QgQ2xvdWRmbGFyZSBXb3JrZXIgY29udGV4dC5cbiAqL1xuZnVuY3Rpb24gaXNDbG91ZGZsYXJlV29ya2VyKCkge1xuICAgIHJldHVybiAodHlwZW9mIG5hdmlnYXRvciAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgICAgbmF2aWdhdG9yLnVzZXJBZ2VudCA9PT0gJ0Nsb3VkZmxhcmUtV29ya2VycycpO1xufVxuZnVuY3Rpb24gaXNCcm93c2VyRXh0ZW5zaW9uKCkge1xuICAgIGNvbnN0IHJ1bnRpbWUgPSB0eXBlb2YgY2hyb21lID09PSAnb2JqZWN0J1xuICAgICAgICA/IGNocm9tZS5ydW50aW1lXG4gICAgICAgIDogdHlwZW9mIGJyb3dzZXIgPT09ICdvYmplY3QnXG4gICAgICAgICAgICA/IGJyb3dzZXIucnVudGltZVxuICAgICAgICAgICAgOiB1bmRlZmluZWQ7XG4gICAgcmV0dXJuIHR5cGVvZiBydW50aW1lID09PSAnb2JqZWN0JyAmJiBydW50aW1lLmlkICE9PSB1bmRlZmluZWQ7XG59XG4vKipcbiAqIERldGVjdCBSZWFjdCBOYXRpdmUuXG4gKlxuICogQHJldHVybiB0cnVlIGlmIFJlYWN0TmF0aXZlIGVudmlyb25tZW50IGlzIGRldGVjdGVkLlxuICovXG5mdW5jdGlvbiBpc1JlYWN0TmF0aXZlKCkge1xuICAgIHJldHVybiAodHlwZW9mIG5hdmlnYXRvciA9PT0gJ29iamVjdCcgJiYgbmF2aWdhdG9yWydwcm9kdWN0J10gPT09ICdSZWFjdE5hdGl2ZScpO1xufVxuLyoqIERldGVjdHMgRWxlY3Ryb24gYXBwcy4gKi9cbmZ1bmN0aW9uIGlzRWxlY3Ryb24oKSB7XG4gICAgcmV0dXJuIGdldFVBKCkuaW5kZXhPZignRWxlY3Ryb24vJykgPj0gMDtcbn1cbi8qKiBEZXRlY3RzIEludGVybmV0IEV4cGxvcmVyLiAqL1xuZnVuY3Rpb24gaXNJRSgpIHtcbiAgICBjb25zdCB1YSA9IGdldFVBKCk7XG4gICAgcmV0dXJuIHVhLmluZGV4T2YoJ01TSUUgJykgPj0gMCB8fCB1YS5pbmRleE9mKCdUcmlkZW50LycpID49IDA7XG59XG4vKiogRGV0ZWN0cyBVbml2ZXJzYWwgV2luZG93cyBQbGF0Zm9ybSBhcHBzLiAqL1xuZnVuY3Rpb24gaXNVV1AoKSB7XG4gICAgcmV0dXJuIGdldFVBKCkuaW5kZXhPZignTVNBcHBIb3N0LycpID49IDA7XG59XG4vKipcbiAqIERldGVjdCB3aGV0aGVyIHRoZSBjdXJyZW50IFNESyBidWlsZCBpcyB0aGUgTm9kZSB2ZXJzaW9uLlxuICpcbiAqIEByZXR1cm4gdHJ1ZSBpZiBpdCdzIHRoZSBOb2RlIFNESyBidWlsZC5cbiAqL1xuZnVuY3Rpb24gaXNOb2RlU2RrKCkge1xuICAgIHJldHVybiBDT05TVEFOVFMuTk9ERV9DTElFTlQgPT09IHRydWUgfHwgQ09OU1RBTlRTLk5PREVfQURNSU4gPT09IHRydWU7XG59XG4vKiogUmV0dXJucyB0cnVlIGlmIHdlIGFyZSBydW5uaW5nIGluIFNhZmFyaS4gKi9cbmZ1bmN0aW9uIGlzU2FmYXJpKCkge1xuICAgIHJldHVybiAoIWlzTm9kZSgpICYmXG4gICAgICAgICEhbmF2aWdhdG9yLnVzZXJBZ2VudCAmJlxuICAgICAgICBuYXZpZ2F0b3IudXNlckFnZW50LmluY2x1ZGVzKCdTYWZhcmknKSAmJlxuICAgICAgICAhbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmNsdWRlcygnQ2hyb21lJykpO1xufVxuLyoqIFJldHVybnMgdHJ1ZSBpZiB3ZSBhcmUgcnVubmluZyBpbiBTYWZhcmkgb3IgV2ViS2l0ICovXG5mdW5jdGlvbiBpc1NhZmFyaU9yV2Via2l0KCkge1xuICAgIHJldHVybiAoIWlzTm9kZSgpICYmXG4gICAgICAgICEhbmF2aWdhdG9yLnVzZXJBZ2VudCAmJlxuICAgICAgICAobmF2aWdhdG9yLnVzZXJBZ2VudC5pbmNsdWRlcygnU2FmYXJpJykgfHxcbiAgICAgICAgICAgIG5hdmlnYXRvci51c2VyQWdlbnQuaW5jbHVkZXMoJ1dlYktpdCcpKSAmJlxuICAgICAgICAhbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmNsdWRlcygnQ2hyb21lJykpO1xufVxuLyoqXG4gKiBUaGlzIG1ldGhvZCBjaGVja3MgaWYgaW5kZXhlZERCIGlzIHN1cHBvcnRlZCBieSBjdXJyZW50IGJyb3dzZXIvc2VydmljZSB3b3JrZXIgY29udGV4dFxuICogQHJldHVybiB0cnVlIGlmIGluZGV4ZWREQiBpcyBzdXBwb3J0ZWQgYnkgY3VycmVudCBicm93c2VyL3NlcnZpY2Ugd29ya2VyIGNvbnRleHRcbiAqL1xuZnVuY3Rpb24gaXNJbmRleGVkREJBdmFpbGFibGUoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBpbmRleGVkREIgPT09ICdvYmplY3QnO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuLyoqXG4gKiBUaGlzIG1ldGhvZCB2YWxpZGF0ZXMgYnJvd3Nlci9zdyBjb250ZXh0IGZvciBpbmRleGVkREIgYnkgb3BlbmluZyBhIGR1bW15IGluZGV4ZWREQiBkYXRhYmFzZSBhbmQgcmVqZWN0XG4gKiBpZiBlcnJvcnMgb2NjdXIgZHVyaW5nIHRoZSBkYXRhYmFzZSBvcGVuIG9wZXJhdGlvbi5cbiAqXG4gKiBAdGhyb3dzIGV4Y2VwdGlvbiBpZiBjdXJyZW50IGJyb3dzZXIvc3cgY29udGV4dCBjYW4ndCBydW4gaWRiLm9wZW4gKGV4OiBTYWZhcmkgaWZyYW1lLCBGaXJlZm94XG4gKiBwcml2YXRlIGJyb3dzaW5nKVxuICovXG5mdW5jdGlvbiB2YWxpZGF0ZUluZGV4ZWREQk9wZW5hYmxlKCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsZXQgcHJlRXhpc3QgPSB0cnVlO1xuICAgICAgICAgICAgY29uc3QgREJfQ0hFQ0tfTkFNRSA9ICd2YWxpZGF0ZS1icm93c2VyLWNvbnRleHQtZm9yLWluZGV4ZWRkYi1hbmFseXRpY3MtbW9kdWxlJztcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3QgPSBzZWxmLmluZGV4ZWREQi5vcGVuKERCX0NIRUNLX05BTUUpO1xuICAgICAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdC5yZXN1bHQuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAvLyBkZWxldGUgZGF0YWJhc2Ugb25seSB3aGVuIGl0IGRvZXNuJ3QgcHJlLWV4aXN0XG4gICAgICAgICAgICAgICAgaWYgKCFwcmVFeGlzdCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmluZGV4ZWREQi5kZWxldGVEYXRhYmFzZShEQl9DSEVDS19OQU1FKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBwcmVFeGlzdCA9IGZhbHNlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJlcXVlc3Qub25lcnJvciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICByZWplY3QocmVxdWVzdC5lcnJvcj8ubWVzc2FnZSB8fCAnJyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuLyoqXG4gKlxuICogVGhpcyBtZXRob2QgY2hlY2tzIHdoZXRoZXIgY29va2llIGlzIGVuYWJsZWQgd2l0aGluIGN1cnJlbnQgYnJvd3NlclxuICogQHJldHVybiB0cnVlIGlmIGNvb2tpZSBpcyBlbmFibGVkIHdpdGhpbiBjdXJyZW50IGJyb3dzZXJcbiAqL1xuZnVuY3Rpb24gYXJlQ29va2llc0VuYWJsZWQoKSB7XG4gICAgaWYgKHR5cGVvZiBuYXZpZ2F0b3IgPT09ICd1bmRlZmluZWQnIHx8ICFuYXZpZ2F0b3IuY29va2llRW5hYmxlZCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IFN0YW5kYXJkaXplZCBGaXJlYmFzZSBFcnJvci5cbiAqXG4gKiBVc2FnZTpcbiAqXG4gKiAgIC8vIFR5cGVTY3JpcHQgc3RyaW5nIGxpdGVyYWxzIGZvciB0eXBlLXNhZmUgY29kZXNcbiAqICAgdHlwZSBFcnIgPVxuICogICAgICd1bmtub3duJyB8XG4gKiAgICAgJ29iamVjdC1ub3QtZm91bmQnXG4gKiAgICAgO1xuICpcbiAqICAgLy8gQ2xvc3VyZSBlbnVtIGZvciB0eXBlLXNhZmUgZXJyb3IgY29kZXNcbiAqICAgLy8gYXQtZW51bSB7c3RyaW5nfVxuICogICB2YXIgRXJyID0ge1xuICogICAgIFVOS05PV046ICd1bmtub3duJyxcbiAqICAgICBPQkpFQ1RfTk9UX0ZPVU5EOiAnb2JqZWN0LW5vdC1mb3VuZCcsXG4gKiAgIH1cbiAqXG4gKiAgIGxldCBlcnJvcnM6IE1hcDxFcnIsIHN0cmluZz4gPSB7XG4gKiAgICAgJ2dlbmVyaWMtZXJyb3InOiBcIlVua25vd24gZXJyb3JcIixcbiAqICAgICAnZmlsZS1ub3QtZm91bmQnOiBcIkNvdWxkIG5vdCBmaW5kIGZpbGU6IHskZmlsZX1cIixcbiAqICAgfTtcbiAqXG4gKiAgIC8vIFR5cGUtc2FmZSBmdW5jdGlvbiAtIG11c3QgcGFzcyBhIHZhbGlkIGVycm9yIGNvZGUgYXMgcGFyYW0uXG4gKiAgIGxldCBlcnJvciA9IG5ldyBFcnJvckZhY3Rvcnk8RXJyPignc2VydmljZScsICdTZXJ2aWNlJywgZXJyb3JzKTtcbiAqXG4gKiAgIC4uLlxuICogICB0aHJvdyBlcnJvci5jcmVhdGUoRXJyLkdFTkVSSUMpO1xuICogICAuLi5cbiAqICAgdGhyb3cgZXJyb3IuY3JlYXRlKEVyci5GSUxFX05PVF9GT1VORCwgeydmaWxlJzogZmlsZU5hbWV9KTtcbiAqICAgLi4uXG4gKiAgIC8vIFNlcnZpY2U6IENvdWxkIG5vdCBmaWxlIGZpbGU6IGZvby50eHQgKHNlcnZpY2UvZmlsZS1ub3QtZm91bmQpLlxuICpcbiAqICAgY2F0Y2ggKGUpIHtcbiAqICAgICBhc3NlcnQoZS5tZXNzYWdlID09PSBcIkNvdWxkIG5vdCBmaW5kIGZpbGU6IGZvby50eHQuXCIpO1xuICogICAgIGlmICgoZSBhcyBGaXJlYmFzZUVycm9yKT8uY29kZSA9PT0gJ3NlcnZpY2UvZmlsZS1ub3QtZm91bmQnKSB7XG4gKiAgICAgICBjb25zb2xlLmxvZyhcIkNvdWxkIG5vdCByZWFkIGZpbGU6IFwiICsgZVsnZmlsZSddKTtcbiAqICAgICB9XG4gKiAgIH1cbiAqL1xuY29uc3QgRVJST1JfTkFNRSA9ICdGaXJlYmFzZUVycm9yJztcbi8vIEJhc2VkIG9uIGNvZGUgZnJvbTpcbi8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0Vycm9yI0N1c3RvbV9FcnJvcl9UeXBlc1xuY2xhc3MgRmlyZWJhc2VFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogVGhlIGVycm9yIGNvZGUgZm9yIHRoaXMgZXJyb3IuICovXG4gICAgY29kZSwgbWVzc2FnZSwgXG4gICAgLyoqIEN1c3RvbSBkYXRhIGZvciB0aGlzIGVycm9yLiAqL1xuICAgIGN1c3RvbURhdGEpIHtcbiAgICAgICAgc3VwZXIobWVzc2FnZSk7XG4gICAgICAgIHRoaXMuY29kZSA9IGNvZGU7XG4gICAgICAgIHRoaXMuY3VzdG9tRGF0YSA9IGN1c3RvbURhdGE7XG4gICAgICAgIC8qKiBUaGUgY3VzdG9tIG5hbWUgZm9yIGFsbCBGaXJlYmFzZUVycm9ycy4gKi9cbiAgICAgICAgdGhpcy5uYW1lID0gRVJST1JfTkFNRTtcbiAgICAgICAgLy8gRml4IEZvciBFUzVcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL01pY3Jvc29mdC9UeXBlU2NyaXB0LXdpa2kvYmxvYi9tYXN0ZXIvQnJlYWtpbmctQ2hhbmdlcy5tZCNleHRlbmRpbmctYnVpbHQtaW5zLWxpa2UtZXJyb3ItYXJyYXktYW5kLW1hcC1tYXktbm8tbG9uZ2VyLXdvcmtcbiAgICAgICAgLy8gVE9ETyhkbGFyb2NxdWUpOiBSZXBsYWNlIHRoaXMgd2l0aCBgbmV3LnRhcmdldGA6IGh0dHBzOi8vd3d3LnR5cGVzY3JpcHRsYW5nLm9yZy9kb2NzL2hhbmRib29rL3JlbGVhc2Utbm90ZXMvdHlwZXNjcmlwdC0yLTIuaHRtbCNzdXBwb3J0LWZvci1uZXd0YXJnZXRcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgd2hpY2ggd2UgY2FuIG5vdyB1c2Ugc2luY2Ugd2Ugbm8gbG9uZ2VyIHRhcmdldCBFUzUuXG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBGaXJlYmFzZUVycm9yLnByb3RvdHlwZSk7XG4gICAgICAgIC8vIE1haW50YWlucyBwcm9wZXIgc3RhY2sgdHJhY2UgZm9yIHdoZXJlIG91ciBlcnJvciB3YXMgdGhyb3duLlxuICAgICAgICAvLyBPbmx5IGF2YWlsYWJsZSBvbiBWOC5cbiAgICAgICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICAgICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCBFcnJvckZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5jbGFzcyBFcnJvckZhY3Rvcnkge1xuICAgIGNvbnN0cnVjdG9yKHNlcnZpY2UsIHNlcnZpY2VOYW1lLCBlcnJvcnMpIHtcbiAgICAgICAgdGhpcy5zZXJ2aWNlID0gc2VydmljZTtcbiAgICAgICAgdGhpcy5zZXJ2aWNlTmFtZSA9IHNlcnZpY2VOYW1lO1xuICAgICAgICB0aGlzLmVycm9ycyA9IGVycm9ycztcbiAgICB9XG4gICAgY3JlYXRlKGNvZGUsIC4uLmRhdGEpIHtcbiAgICAgICAgY29uc3QgY3VzdG9tRGF0YSA9IGRhdGFbMF0gfHwge307XG4gICAgICAgIGNvbnN0IGZ1bGxDb2RlID0gYCR7dGhpcy5zZXJ2aWNlfS8ke2NvZGV9YDtcbiAgICAgICAgY29uc3QgdGVtcGxhdGUgPSB0aGlzLmVycm9yc1tjb2RlXTtcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IHRlbXBsYXRlID8gcmVwbGFjZVRlbXBsYXRlKHRlbXBsYXRlLCBjdXN0b21EYXRhKSA6ICdFcnJvcic7XG4gICAgICAgIC8vIFNlcnZpY2UgTmFtZTogRXJyb3IgbWVzc2FnZSAoc2VydmljZS9jb2RlKS5cbiAgICAgICAgY29uc3QgZnVsbE1lc3NhZ2UgPSBgJHt0aGlzLnNlcnZpY2VOYW1lfTogJHttZXNzYWdlfSAoJHtmdWxsQ29kZX0pLmA7XG4gICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEZpcmViYXNlRXJyb3IoZnVsbENvZGUsIGZ1bGxNZXNzYWdlLCBjdXN0b21EYXRhKTtcbiAgICAgICAgcmV0dXJuIGVycm9yO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHJlcGxhY2VUZW1wbGF0ZSh0ZW1wbGF0ZSwgZGF0YSkge1xuICAgIHJldHVybiB0ZW1wbGF0ZS5yZXBsYWNlKFBBVFRFUk4sIChfLCBrZXkpID0+IHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBkYXRhW2tleV07XG4gICAgICAgIHJldHVybiB2YWx1ZSAhPSBudWxsID8gU3RyaW5nKHZhbHVlKSA6IGA8JHtrZXl9Pz5gO1xuICAgIH0pO1xufVxuY29uc3QgUEFUVEVSTiA9IC9cXHtcXCQoW159XSspfS9nO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBFdmFsdWF0ZXMgYSBKU09OIHN0cmluZyBpbnRvIGEgamF2YXNjcmlwdCBvYmplY3QuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHN0ciBBIHN0cmluZyBjb250YWluaW5nIEpTT04uXG4gKiBAcmV0dXJuIHsqfSBUaGUgamF2YXNjcmlwdCBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBzcGVjaWZpZWQgSlNPTi5cbiAqL1xuZnVuY3Rpb24ganNvbkV2YWwoc3RyKSB7XG4gICAgcmV0dXJuIEpTT04ucGFyc2Uoc3RyKTtcbn1cbi8qKlxuICogUmV0dXJucyBKU09OIHJlcHJlc2VudGluZyBhIGphdmFzY3JpcHQgb2JqZWN0LlxuICogQHBhcmFtIHsqfSBkYXRhIEphdmFTY3JpcHQgb2JqZWN0IHRvIGJlIHN0cmluZ2lmaWVkLlxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgSlNPTiBjb250ZW50cyBvZiB0aGUgb2JqZWN0LlxuICovXG5mdW5jdGlvbiBzdHJpbmdpZnkoZGF0YSkge1xuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShkYXRhKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogRGVjb2RlcyBhIEZpcmViYXNlIGF1dGguIHRva2VuIGludG8gY29uc3RpdHVlbnQgcGFydHMuXG4gKlxuICogTm90ZXM6XG4gKiAtIE1heSByZXR1cm4gd2l0aCBpbnZhbGlkIC8gaW5jb21wbGV0ZSBjbGFpbXMgaWYgdGhlcmUncyBubyBuYXRpdmUgYmFzZTY0IGRlY29kaW5nIHN1cHBvcnQuXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxuICovXG5jb25zdCBkZWNvZGUgPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICBsZXQgaGVhZGVyID0ge30sIGNsYWltcyA9IHt9LCBkYXRhID0ge30sIHNpZ25hdHVyZSA9ICcnO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHBhcnRzID0gdG9rZW4uc3BsaXQoJy4nKTtcbiAgICAgICAgaGVhZGVyID0ganNvbkV2YWwoYmFzZTY0RGVjb2RlKHBhcnRzWzBdKSB8fCAnJyk7XG4gICAgICAgIGNsYWltcyA9IGpzb25FdmFsKGJhc2U2NERlY29kZShwYXJ0c1sxXSkgfHwgJycpO1xuICAgICAgICBzaWduYXR1cmUgPSBwYXJ0c1syXTtcbiAgICAgICAgZGF0YSA9IGNsYWltc1snZCddIHx8IHt9O1xuICAgICAgICBkZWxldGUgY2xhaW1zWydkJ107XG4gICAgfVxuICAgIGNhdGNoIChlKSB7IH1cbiAgICByZXR1cm4ge1xuICAgICAgICBoZWFkZXIsXG4gICAgICAgIGNsYWltcyxcbiAgICAgICAgZGF0YSxcbiAgICAgICAgc2lnbmF0dXJlXG4gICAgfTtcbn07XG4vKipcbiAqIERlY29kZXMgYSBGaXJlYmFzZSBhdXRoLiB0b2tlbiBhbmQgY2hlY2tzIHRoZSB2YWxpZGl0eSBvZiBpdHMgdGltZS1iYXNlZCBjbGFpbXMuIFdpbGwgcmV0dXJuIHRydWUgaWYgdGhlXG4gKiB0b2tlbiBpcyB3aXRoaW4gdGhlIHRpbWUgd2luZG93IGF1dGhvcml6ZWQgYnkgdGhlICduYmYnIChub3QtYmVmb3JlKSBhbmQgJ2lhdCcgKGlzc3VlZC1hdCkgY2xhaW1zLlxuICpcbiAqIE5vdGVzOlxuICogLSBNYXkgcmV0dXJuIGEgZmFsc2UgbmVnYXRpdmUgaWYgdGhlcmUncyBubyBuYXRpdmUgYmFzZTY0IGRlY29kaW5nIHN1cHBvcnQuXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxuICovXG5jb25zdCBpc1ZhbGlkVGltZXN0YW1wID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgY29uc3QgY2xhaW1zID0gZGVjb2RlKHRva2VuKS5jbGFpbXM7XG4gICAgY29uc3Qgbm93ID0gTWF0aC5mbG9vcihuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApO1xuICAgIGxldCB2YWxpZFNpbmNlID0gMCwgdmFsaWRVbnRpbCA9IDA7XG4gICAgaWYgKHR5cGVvZiBjbGFpbXMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIGlmIChjbGFpbXMuaGFzT3duUHJvcGVydHkoJ25iZicpKSB7XG4gICAgICAgICAgICB2YWxpZFNpbmNlID0gY2xhaW1zWyduYmYnXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjbGFpbXMuaGFzT3duUHJvcGVydHkoJ2lhdCcpKSB7XG4gICAgICAgICAgICB2YWxpZFNpbmNlID0gY2xhaW1zWydpYXQnXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2xhaW1zLmhhc093blByb3BlcnR5KCdleHAnKSkge1xuICAgICAgICAgICAgdmFsaWRVbnRpbCA9IGNsYWltc1snZXhwJ107XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyB0b2tlbiB3aWxsIGV4cGlyZSBhZnRlciAyNGggYnkgZGVmYXVsdFxuICAgICAgICAgICAgdmFsaWRVbnRpbCA9IHZhbGlkU2luY2UgKyA4NjQwMDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gKCEhbm93ICYmXG4gICAgICAgICEhdmFsaWRTaW5jZSAmJlxuICAgICAgICAhIXZhbGlkVW50aWwgJiZcbiAgICAgICAgbm93ID49IHZhbGlkU2luY2UgJiZcbiAgICAgICAgbm93IDw9IHZhbGlkVW50aWwpO1xufTtcbi8qKlxuICogRGVjb2RlcyBhIEZpcmViYXNlIGF1dGguIHRva2VuIGFuZCByZXR1cm5zIGl0cyBpc3N1ZWQgYXQgdGltZSBpZiB2YWxpZCwgbnVsbCBvdGhlcndpc2UuXG4gKlxuICogTm90ZXM6XG4gKiAtIE1heSByZXR1cm4gbnVsbCBpZiB0aGVyZSdzIG5vIG5hdGl2ZSBiYXNlNjQgZGVjb2Rpbmcgc3VwcG9ydC5cbiAqIC0gRG9lc24ndCBjaGVjayBpZiB0aGUgdG9rZW4gaXMgYWN0dWFsbHkgdmFsaWQuXG4gKi9cbmNvbnN0IGlzc3VlZEF0VGltZSA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgIGNvbnN0IGNsYWltcyA9IGRlY29kZSh0b2tlbikuY2xhaW1zO1xuICAgIGlmICh0eXBlb2YgY2xhaW1zID09PSAnb2JqZWN0JyAmJiBjbGFpbXMuaGFzT3duUHJvcGVydHkoJ2lhdCcpKSB7XG4gICAgICAgIHJldHVybiBjbGFpbXNbJ2lhdCddO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn07XG4vKipcbiAqIERlY29kZXMgYSBGaXJlYmFzZSBhdXRoLiB0b2tlbiBhbmQgY2hlY2tzIHRoZSB2YWxpZGl0eSBvZiBpdHMgZm9ybWF0LiBFeHBlY3RzIGEgdmFsaWQgaXNzdWVkLWF0IHRpbWUuXG4gKlxuICogTm90ZXM6XG4gKiAtIE1heSByZXR1cm4gYSBmYWxzZSBuZWdhdGl2ZSBpZiB0aGVyZSdzIG5vIG5hdGl2ZSBiYXNlNjQgZGVjb2Rpbmcgc3VwcG9ydC5cbiAqIC0gRG9lc24ndCBjaGVjayBpZiB0aGUgdG9rZW4gaXMgYWN0dWFsbHkgdmFsaWQuXG4gKi9cbmNvbnN0IGlzVmFsaWRGb3JtYXQgPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICBjb25zdCBkZWNvZGVkID0gZGVjb2RlKHRva2VuKSwgY2xhaW1zID0gZGVjb2RlZC5jbGFpbXM7XG4gICAgcmV0dXJuICEhY2xhaW1zICYmIHR5cGVvZiBjbGFpbXMgPT09ICdvYmplY3QnICYmIGNsYWltcy5oYXNPd25Qcm9wZXJ0eSgnaWF0Jyk7XG59O1xuLyoqXG4gKiBBdHRlbXB0cyB0byBwZWVyIGludG8gYW4gYXV0aCB0b2tlbiBhbmQgZGV0ZXJtaW5lIGlmIGl0J3MgYW4gYWRtaW4gYXV0aCB0b2tlbiBieSBsb29raW5nIGF0IHRoZSBjbGFpbXMgcG9ydGlvbi5cbiAqXG4gKiBOb3RlczpcbiAqIC0gTWF5IHJldHVybiBhIGZhbHNlIG5lZ2F0aXZlIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxuICogLSBEb2Vzbid0IGNoZWNrIGlmIHRoZSB0b2tlbiBpcyBhY3R1YWxseSB2YWxpZC5cbiAqL1xuY29uc3QgaXNBZG1pbiA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgIGNvbnN0IGNsYWltcyA9IGRlY29kZSh0b2tlbikuY2xhaW1zO1xuICAgIHJldHVybiB0eXBlb2YgY2xhaW1zID09PSAnb2JqZWN0JyAmJiBjbGFpbXNbJ2FkbWluJ10gPT09IHRydWU7XG59O1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuZnVuY3Rpb24gY29udGFpbnMob2JqLCBrZXkpIHtcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KTtcbn1cbmZ1bmN0aW9uIHNhZmVHZXQob2JqLCBrZXkpIHtcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xuICAgICAgICByZXR1cm4gb2JqW2tleV07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGlzRW1wdHkob2JqKSB7XG4gICAgZm9yIChjb25zdCBrZXkgaW4gb2JqKSB7XG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59XG5mdW5jdGlvbiBtYXAob2JqLCBmbiwgY29udGV4dE9iaikge1xuICAgIGNvbnN0IHJlcyA9IHt9O1xuICAgIGZvciAoY29uc3Qga2V5IGluIG9iaikge1xuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xuICAgICAgICAgICAgcmVzW2tleV0gPSBmbi5jYWxsKGNvbnRleHRPYmosIG9ialtrZXldLCBrZXksIG9iaik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlcztcbn1cbi8qKlxuICogRGVlcCBlcXVhbCB0d28gb2JqZWN0cy4gU3VwcG9ydCBBcnJheXMgYW5kIE9iamVjdHMuXG4gKi9cbmZ1bmN0aW9uIGRlZXBFcXVhbChhLCBiKSB7XG4gICAgaWYgKGEgPT09IGIpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGNvbnN0IGFLZXlzID0gT2JqZWN0LmtleXMoYSk7XG4gICAgY29uc3QgYktleXMgPSBPYmplY3Qua2V5cyhiKTtcbiAgICBmb3IgKGNvbnN0IGsgb2YgYUtleXMpIHtcbiAgICAgICAgaWYgKCFiS2V5cy5pbmNsdWRlcyhrKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFQcm9wID0gYVtrXTtcbiAgICAgICAgY29uc3QgYlByb3AgPSBiW2tdO1xuICAgICAgICBpZiAoaXNPYmplY3QoYVByb3ApICYmIGlzT2JqZWN0KGJQcm9wKSkge1xuICAgICAgICAgICAgaWYgKCFkZWVwRXF1YWwoYVByb3AsIGJQcm9wKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChhUHJvcCAhPT0gYlByb3ApIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IGsgb2YgYktleXMpIHtcbiAgICAgICAgaWYgKCFhS2V5cy5pbmNsdWRlcyhrKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuZnVuY3Rpb24gaXNPYmplY3QodGhpbmcpIHtcbiAgICByZXR1cm4gdGhpbmcgIT09IG51bGwgJiYgdHlwZW9mIHRoaW5nID09PSAnb2JqZWN0Jztcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmVqZWN0cyBpZiB0aGUgZ2l2ZW4gcHJvbWlzZSBkb2Vzbid0IHJlc29sdmUgaW4gdGltZUluTVMgbWlsbGlzZWNvbmRzLlxuICogQGludGVybmFsXG4gKi9cbmZ1bmN0aW9uIHByb21pc2VXaXRoVGltZW91dChwcm9taXNlLCB0aW1lSW5NUyA9IDIwMDApIHtcbiAgICBjb25zdCBkZWZlcnJlZFByb21pc2UgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICBzZXRUaW1lb3V0KCgpID0+IGRlZmVycmVkUHJvbWlzZS5yZWplY3QoJ3RpbWVvdXQhJyksIHRpbWVJbk1TKTtcbiAgICBwcm9taXNlLnRoZW4oZGVmZXJyZWRQcm9taXNlLnJlc29sdmUsIGRlZmVycmVkUHJvbWlzZS5yZWplY3QpO1xuICAgIHJldHVybiBkZWZlcnJlZFByb21pc2UucHJvbWlzZTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmV0dXJucyBhIHF1ZXJ5c3RyaW5nLWZvcm1hdHRlZCBzdHJpbmcgKGUuZy4gJmFyZz12YWwmYXJnMj12YWwyKSBmcm9tIGFcbiAqIHBhcmFtcyBvYmplY3QgKGUuZy4ge2FyZzogJ3ZhbCcsIGFyZzI6ICd2YWwyJ30pXG4gKiBOb3RlOiBZb3UgbXVzdCBwcmVwZW5kIGl0IHdpdGggPyB3aGVuIGFkZGluZyBpdCB0byBhIFVSTC5cbiAqL1xuZnVuY3Rpb24gcXVlcnlzdHJpbmcocXVlcnlzdHJpbmdQYXJhbXMpIHtcbiAgICBjb25zdCBwYXJhbXMgPSBbXTtcbiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhxdWVyeXN0cmluZ1BhcmFtcykpIHtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgICB2YWx1ZS5mb3JFYWNoKGFycmF5VmFsID0+IHtcbiAgICAgICAgICAgICAgICBwYXJhbXMucHVzaChlbmNvZGVVUklDb21wb25lbnQoa2V5KSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudChhcnJheVZhbCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwYXJhbXMucHVzaChlbmNvZGVVUklDb21wb25lbnQoa2V5KSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwYXJhbXMubGVuZ3RoID8gJyYnICsgcGFyYW1zLmpvaW4oJyYnKSA6ICcnO1xufVxuLyoqXG4gKiBEZWNvZGVzIGEgcXVlcnlzdHJpbmcgKGUuZy4gP2FyZz12YWwmYXJnMj12YWwyKSBpbnRvIGEgcGFyYW1zIG9iamVjdFxuICogKGUuZy4ge2FyZzogJ3ZhbCcsIGFyZzI6ICd2YWwyJ30pXG4gKi9cbmZ1bmN0aW9uIHF1ZXJ5c3RyaW5nRGVjb2RlKHF1ZXJ5c3RyaW5nKSB7XG4gICAgY29uc3Qgb2JqID0ge307XG4gICAgY29uc3QgdG9rZW5zID0gcXVlcnlzdHJpbmcucmVwbGFjZSgvXlxcPy8sICcnKS5zcGxpdCgnJicpO1xuICAgIHRva2Vucy5mb3JFYWNoKHRva2VuID0+IHtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgICBjb25zdCBba2V5LCB2YWx1ZV0gPSB0b2tlbi5zcGxpdCgnPScpO1xuICAgICAgICAgICAgb2JqW2RlY29kZVVSSUNvbXBvbmVudChrZXkpXSA9IGRlY29kZVVSSUNvbXBvbmVudCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gb2JqO1xufVxuLyoqXG4gKiBFeHRyYWN0IHRoZSBxdWVyeSBzdHJpbmcgcGFydCBvZiBhIFVSTCwgaW5jbHVkaW5nIHRoZSBsZWFkaW5nIHF1ZXN0aW9uIG1hcmsgKGlmIHByZXNlbnQpLlxuICovXG5mdW5jdGlvbiBleHRyYWN0UXVlcnlzdHJpbmcodXJsKSB7XG4gICAgY29uc3QgcXVlcnlTdGFydCA9IHVybC5pbmRleE9mKCc/Jyk7XG4gICAgaWYgKCFxdWVyeVN0YXJ0KSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG4gICAgY29uc3QgZnJhZ21lbnRTdGFydCA9IHVybC5pbmRleE9mKCcjJywgcXVlcnlTdGFydCk7XG4gICAgcmV0dXJuIHVybC5zdWJzdHJpbmcocXVlcnlTdGFydCwgZnJhZ21lbnRTdGFydCA+IDAgPyBmcmFnbWVudFN0YXJ0IDogdW5kZWZpbmVkKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQGZpbGVvdmVydmlldyBTSEEtMSBjcnlwdG9ncmFwaGljIGhhc2guXG4gKiBWYXJpYWJsZSBuYW1lcyBmb2xsb3cgdGhlIG5vdGF0aW9uIGluIEZJUFMgUFVCIDE4MC0zOlxuICogaHR0cDovL2NzcmMubmlzdC5nb3YvcHVibGljYXRpb25zL2ZpcHMvZmlwczE4MC0zL2ZpcHMxODAtM19maW5hbC5wZGYuXG4gKlxuICogVXNhZ2U6XG4gKiAgIHZhciBzaGExID0gbmV3IHNoYTEoKTtcbiAqICAgc2hhMS51cGRhdGUoYnl0ZXMpO1xuICogICB2YXIgaGFzaCA9IHNoYTEuZGlnZXN0KCk7XG4gKlxuICogUGVyZm9ybWFuY2U6XG4gKiAgIENocm9tZSAyMzogICB+NDAwIE1iaXQvc1xuICogICBGaXJlZm94IDE2OiAgfjI1MCBNYml0L3NcbiAqXG4gKi9cbi8qKlxuICogU0hBLTEgY3J5cHRvZ3JhcGhpYyBoYXNoIGNvbnN0cnVjdG9yLlxuICpcbiAqIFRoZSBwcm9wZXJ0aWVzIGRlY2xhcmVkIGhlcmUgYXJlIGRpc2N1c3NlZCBpbiB0aGUgYWJvdmUgYWxnb3JpdGhtIGRvY3VtZW50LlxuICogQGNvbnN0cnVjdG9yXG4gKiBAZmluYWxcbiAqIEBzdHJ1Y3RcbiAqL1xuY2xhc3MgU2hhMSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBIb2xkcyB0aGUgcHJldmlvdXMgdmFsdWVzIG9mIGFjY3VtdWxhdGVkIHZhcmlhYmxlcyBhLWUgaW4gdGhlIGNvbXByZXNzX1xuICAgICAgICAgKiBmdW5jdGlvbi5cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2hhaW5fID0gW107XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGJ1ZmZlciBob2xkaW5nIHRoZSBwYXJ0aWFsbHkgY29tcHV0ZWQgaGFzaCByZXN1bHQuXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJ1Zl8gPSBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFuIGFycmF5IG9mIDgwIGJ5dGVzLCBlYWNoIGEgcGFydCBvZiB0aGUgbWVzc2FnZSB0byBiZSBoYXNoZWQuICBSZWZlcnJlZCB0b1xuICAgICAgICAgKiBhcyB0aGUgbWVzc2FnZSBzY2hlZHVsZSBpbiB0aGUgZG9jcy5cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuV18gPSBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbnRhaW5zIGRhdGEgbmVlZGVkIHRvIHBhZCBtZXNzYWdlcyBsZXNzIHRoYW4gNjQgYnl0ZXMuXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnBhZF8gPSBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBwcml2YXRlIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmluYnVmXyA9IDA7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcHJpdmF0ZSB7bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50b3RhbF8gPSAwO1xuICAgICAgICB0aGlzLmJsb2NrU2l6ZSA9IDUxMiAvIDg7XG4gICAgICAgIHRoaXMucGFkX1swXSA9IDEyODtcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCB0aGlzLmJsb2NrU2l6ZTsgKytpKSB7XG4gICAgICAgICAgICB0aGlzLnBhZF9baV0gPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVzZXQoKTtcbiAgICB9XG4gICAgcmVzZXQoKSB7XG4gICAgICAgIHRoaXMuY2hhaW5fWzBdID0gMHg2NzQ1MjMwMTtcbiAgICAgICAgdGhpcy5jaGFpbl9bMV0gPSAweGVmY2RhYjg5O1xuICAgICAgICB0aGlzLmNoYWluX1syXSA9IDB4OThiYWRjZmU7XG4gICAgICAgIHRoaXMuY2hhaW5fWzNdID0gMHgxMDMyNTQ3NjtcbiAgICAgICAgdGhpcy5jaGFpbl9bNF0gPSAweGMzZDJlMWYwO1xuICAgICAgICB0aGlzLmluYnVmXyA9IDA7XG4gICAgICAgIHRoaXMudG90YWxfID0gMDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW50ZXJuYWwgY29tcHJlc3MgaGVscGVyIGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSBidWYgQmxvY2sgdG8gY29tcHJlc3MuXG4gICAgICogQHBhcmFtIG9mZnNldCBPZmZzZXQgb2YgdGhlIGJsb2NrIGluIHRoZSBidWZmZXIuXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBjb21wcmVzc18oYnVmLCBvZmZzZXQpIHtcbiAgICAgICAgaWYgKCFvZmZzZXQpIHtcbiAgICAgICAgICAgIG9mZnNldCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgVyA9IHRoaXMuV187XG4gICAgICAgIC8vIGdldCAxNiBiaWcgZW5kaWFuIHdvcmRzXG4gICAgICAgIGlmICh0eXBlb2YgYnVmID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgLy8gVE9ETyh1c2VyKTogW2J1ZyA4MTQwMTIyXSBSZWNlbnQgdmVyc2lvbnMgb2YgU2FmYXJpIGZvciBNYWMgT1MgYW5kIGlPU1xuICAgICAgICAgICAgICAgIC8vIGhhdmUgYSBidWcgdGhhdCB0dXJucyB0aGUgcG9zdC1pbmNyZW1lbnQgKysgb3BlcmF0b3IgaW50byBwcmUtaW5jcmVtZW50XG4gICAgICAgICAgICAgICAgLy8gZHVyaW5nIEpJVCBjb21waWxhdGlvbi4gIFdlIGhhdmUgY29kZSB0aGF0IGRlcGVuZHMgaGVhdmlseSBvbiBTSEEtMSBmb3JcbiAgICAgICAgICAgICAgICAvLyBjb3JyZWN0bmVzcyBhbmQgd2hpY2ggaXMgYWZmZWN0ZWQgYnkgdGhpcyBidWcsIHNvIEkndmUgcmVtb3ZlZCBhbGwgdXNlc1xuICAgICAgICAgICAgICAgIC8vIG9mIHBvc3QtaW5jcmVtZW50ICsrIGluIHdoaWNoIHRoZSByZXN1bHQgdmFsdWUgaXMgdXNlZC4gIFdlIGNhbiByZXZlcnRcbiAgICAgICAgICAgICAgICAvLyB0aGlzIGNoYW5nZSBvbmNlIHRoZSBTYWZhcmkgYnVnXG4gICAgICAgICAgICAgICAgLy8gKGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0xMDkwMzYpIGhhcyBiZWVuIGZpeGVkIGFuZFxuICAgICAgICAgICAgICAgIC8vIG1vc3QgY2xpZW50cyBoYXZlIGJlZW4gdXBkYXRlZC5cbiAgICAgICAgICAgICAgICBXW2ldID1cbiAgICAgICAgICAgICAgICAgICAgKGJ1Zi5jaGFyQ29kZUF0KG9mZnNldCkgPDwgMjQpIHxcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWYuY2hhckNvZGVBdChvZmZzZXQgKyAxKSA8PCAxNikgfFxuICAgICAgICAgICAgICAgICAgICAgICAgKGJ1Zi5jaGFyQ29kZUF0KG9mZnNldCArIDIpIDw8IDgpIHxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1Zi5jaGFyQ29kZUF0KG9mZnNldCArIDMpO1xuICAgICAgICAgICAgICAgIG9mZnNldCArPSA0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgV1tpXSA9XG4gICAgICAgICAgICAgICAgICAgIChidWZbb2Zmc2V0XSA8PCAyNCkgfFxuICAgICAgICAgICAgICAgICAgICAgICAgKGJ1ZltvZmZzZXQgKyAxXSA8PCAxNikgfFxuICAgICAgICAgICAgICAgICAgICAgICAgKGJ1ZltvZmZzZXQgKyAyXSA8PCA4KSB8XG4gICAgICAgICAgICAgICAgICAgICAgICBidWZbb2Zmc2V0ICsgM107XG4gICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gZXhwYW5kIHRvIDgwIHdvcmRzXG4gICAgICAgIGZvciAobGV0IGkgPSAxNjsgaSA8IDgwOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBXW2kgLSAzXSBeIFdbaSAtIDhdIF4gV1tpIC0gMTRdIF4gV1tpIC0gMTZdO1xuICAgICAgICAgICAgV1tpXSA9ICgodCA8PCAxKSB8ICh0ID4+PiAzMSkpICYgMHhmZmZmZmZmZjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgYSA9IHRoaXMuY2hhaW5fWzBdO1xuICAgICAgICBsZXQgYiA9IHRoaXMuY2hhaW5fWzFdO1xuICAgICAgICBsZXQgYyA9IHRoaXMuY2hhaW5fWzJdO1xuICAgICAgICBsZXQgZCA9IHRoaXMuY2hhaW5fWzNdO1xuICAgICAgICBsZXQgZSA9IHRoaXMuY2hhaW5fWzRdO1xuICAgICAgICBsZXQgZiwgaztcbiAgICAgICAgLy8gVE9ETyh1c2VyKTogVHJ5IHRvIHVucm9sbCB0aGlzIGxvb3AgdG8gc3BlZWQgdXAgdGhlIGNvbXB1dGF0aW9uLlxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDgwOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChpIDwgNDApIHtcbiAgICAgICAgICAgICAgICBpZiAoaSA8IDIwKSB7XG4gICAgICAgICAgICAgICAgICAgIGYgPSBkIF4gKGIgJiAoYyBeIGQpKTtcbiAgICAgICAgICAgICAgICAgICAgayA9IDB4NWE4Mjc5OTk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmID0gYiBeIGMgXiBkO1xuICAgICAgICAgICAgICAgICAgICBrID0gMHg2ZWQ5ZWJhMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoaSA8IDYwKSB7XG4gICAgICAgICAgICAgICAgICAgIGYgPSAoYiAmIGMpIHwgKGQgJiAoYiB8IGMpKTtcbiAgICAgICAgICAgICAgICAgICAgayA9IDB4OGYxYmJjZGM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmID0gYiBeIGMgXiBkO1xuICAgICAgICAgICAgICAgICAgICBrID0gMHhjYTYyYzFkNjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB0ID0gKCgoYSA8PCA1KSB8IChhID4+PiAyNykpICsgZiArIGUgKyBrICsgV1tpXSkgJiAweGZmZmZmZmZmO1xuICAgICAgICAgICAgZSA9IGQ7XG4gICAgICAgICAgICBkID0gYztcbiAgICAgICAgICAgIGMgPSAoKGIgPDwgMzApIHwgKGIgPj4+IDIpKSAmIDB4ZmZmZmZmZmY7XG4gICAgICAgICAgICBiID0gYTtcbiAgICAgICAgICAgIGEgPSB0O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2hhaW5fWzBdID0gKHRoaXMuY2hhaW5fWzBdICsgYSkgJiAweGZmZmZmZmZmO1xuICAgICAgICB0aGlzLmNoYWluX1sxXSA9ICh0aGlzLmNoYWluX1sxXSArIGIpICYgMHhmZmZmZmZmZjtcbiAgICAgICAgdGhpcy5jaGFpbl9bMl0gPSAodGhpcy5jaGFpbl9bMl0gKyBjKSAmIDB4ZmZmZmZmZmY7XG4gICAgICAgIHRoaXMuY2hhaW5fWzNdID0gKHRoaXMuY2hhaW5fWzNdICsgZCkgJiAweGZmZmZmZmZmO1xuICAgICAgICB0aGlzLmNoYWluX1s0XSA9ICh0aGlzLmNoYWluX1s0XSArIGUpICYgMHhmZmZmZmZmZjtcbiAgICB9XG4gICAgdXBkYXRlKGJ5dGVzLCBsZW5ndGgpIHtcbiAgICAgICAgLy8gVE9ETyhqb2hubGVueik6IHRpZ2h0ZW4gdGhlIGZ1bmN0aW9uIHNpZ25hdHVyZSBhbmQgcmVtb3ZlIHRoaXMgY2hlY2tcbiAgICAgICAgaWYgKGJ5dGVzID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGxlbmd0aCA9IGJ5dGVzLmxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBsZW5ndGhNaW51c0Jsb2NrID0gbGVuZ3RoIC0gdGhpcy5ibG9ja1NpemU7XG4gICAgICAgIGxldCBuID0gMDtcbiAgICAgICAgLy8gVXNpbmcgbG9jYWwgaW5zdGVhZCBvZiBtZW1iZXIgdmFyaWFibGVzIGdpdmVzIH41JSBzcGVlZHVwIG9uIEZpcmVmb3ggMTYuXG4gICAgICAgIGNvbnN0IGJ1ZiA9IHRoaXMuYnVmXztcbiAgICAgICAgbGV0IGluYnVmID0gdGhpcy5pbmJ1Zl87XG4gICAgICAgIC8vIFRoZSBvdXRlciB3aGlsZSBsb29wIHNob3VsZCBleGVjdXRlIGF0IG1vc3QgdHdpY2UuXG4gICAgICAgIHdoaWxlIChuIDwgbGVuZ3RoKSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGhhdmUgbm8gZGF0YSBpbiB0aGUgYmxvY2sgdG8gdG9wIHVwLCB3ZSBjYW4gZGlyZWN0bHkgcHJvY2VzcyB0aGVcbiAgICAgICAgICAgIC8vIGlucHV0IGJ1ZmZlciAoYXNzdW1pbmcgaXQgY29udGFpbnMgc3VmZmljaWVudCBkYXRhKS4gVGhpcyBnaXZlcyB+MjUlXG4gICAgICAgICAgICAvLyBzcGVlZHVwIG9uIENocm9tZSAyMyBhbmQgfjE1JSBzcGVlZHVwIG9uIEZpcmVmb3ggMTYsIGJ1dCByZXF1aXJlcyB0aGF0XG4gICAgICAgICAgICAvLyB0aGUgZGF0YSBpcyBwcm92aWRlZCBpbiBsYXJnZSBjaHVua3MgKG9yIGluIG11bHRpcGxlcyBvZiA2NCBieXRlcykuXG4gICAgICAgICAgICBpZiAoaW5idWYgPT09IDApIHtcbiAgICAgICAgICAgICAgICB3aGlsZSAobiA8PSBsZW5ndGhNaW51c0Jsb2NrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHJlc3NfKGJ5dGVzLCBuKTtcbiAgICAgICAgICAgICAgICAgICAgbiArPSB0aGlzLmJsb2NrU2l6ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIGJ5dGVzID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHdoaWxlIChuIDwgbGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGJ1ZltpbmJ1Zl0gPSBieXRlcy5jaGFyQ29kZUF0KG4pO1xuICAgICAgICAgICAgICAgICAgICArK2luYnVmO1xuICAgICAgICAgICAgICAgICAgICArK247XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmJ1ZiA9PT0gdGhpcy5ibG9ja1NpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHJlc3NfKGJ1Zik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmJ1ZiA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBKdW1wIHRvIHRoZSBvdXRlciBsb29wIHNvIHdlIHVzZSB0aGUgZnVsbC1ibG9jayBvcHRpbWl6YXRpb24uXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHdoaWxlIChuIDwgbGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGJ1ZltpbmJ1Zl0gPSBieXRlc1tuXTtcbiAgICAgICAgICAgICAgICAgICAgKytpbmJ1ZjtcbiAgICAgICAgICAgICAgICAgICAgKytuO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5idWYgPT09IHRoaXMuYmxvY2tTaXplKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXByZXNzXyhidWYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5idWYgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSnVtcCB0byB0aGUgb3V0ZXIgbG9vcCBzbyB3ZSB1c2UgdGhlIGZ1bGwtYmxvY2sgb3B0aW1pemF0aW9uLlxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbmJ1Zl8gPSBpbmJ1ZjtcbiAgICAgICAgdGhpcy50b3RhbF8gKz0gbGVuZ3RoO1xuICAgIH1cbiAgICAvKiogQG92ZXJyaWRlICovXG4gICAgZGlnZXN0KCkge1xuICAgICAgICBjb25zdCBkaWdlc3QgPSBbXTtcbiAgICAgICAgbGV0IHRvdGFsQml0cyA9IHRoaXMudG90YWxfICogODtcbiAgICAgICAgLy8gQWRkIHBhZCAweDgwIDB4MDAqLlxuICAgICAgICBpZiAodGhpcy5pbmJ1Zl8gPCA1Nikge1xuICAgICAgICAgICAgdGhpcy51cGRhdGUodGhpcy5wYWRfLCA1NiAtIHRoaXMuaW5idWZfKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKHRoaXMucGFkXywgdGhpcy5ibG9ja1NpemUgLSAodGhpcy5pbmJ1Zl8gLSA1NikpO1xuICAgICAgICB9XG4gICAgICAgIC8vIEFkZCAjIGJpdHMuXG4gICAgICAgIGZvciAobGV0IGkgPSB0aGlzLmJsb2NrU2l6ZSAtIDE7IGkgPj0gNTY7IGktLSkge1xuICAgICAgICAgICAgdGhpcy5idWZfW2ldID0gdG90YWxCaXRzICYgMjU1O1xuICAgICAgICAgICAgdG90YWxCaXRzIC89IDI1NjsgLy8gRG9uJ3QgdXNlIGJpdC1zaGlmdGluZyBoZXJlIVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29tcHJlc3NfKHRoaXMuYnVmXyk7XG4gICAgICAgIGxldCBuID0gMDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA1OyBpKyspIHtcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAyNDsgaiA+PSAwOyBqIC09IDgpIHtcbiAgICAgICAgICAgICAgICBkaWdlc3Rbbl0gPSAodGhpcy5jaGFpbl9baV0gPj4gaikgJiAyNTU7XG4gICAgICAgICAgICAgICAgKytuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkaWdlc3Q7XG4gICAgfVxufVxuXG4vKipcbiAqIEhlbHBlciB0byBtYWtlIGEgU3Vic2NyaWJlIGZ1bmN0aW9uIChqdXN0IGxpa2UgUHJvbWlzZSBoZWxwcyBtYWtlIGFcbiAqIFRoZW5hYmxlKS5cbiAqXG4gKiBAcGFyYW0gZXhlY3V0b3IgRnVuY3Rpb24gd2hpY2ggY2FuIG1ha2UgY2FsbHMgdG8gYSBzaW5nbGUgT2JzZXJ2ZXJcbiAqICAgICBhcyBhIHByb3h5LlxuICogQHBhcmFtIG9uTm9PYnNlcnZlcnMgQ2FsbGJhY2sgd2hlbiBjb3VudCBvZiBPYnNlcnZlcnMgZ29lcyB0byB6ZXJvLlxuICovXG5mdW5jdGlvbiBjcmVhdGVTdWJzY3JpYmUoZXhlY3V0b3IsIG9uTm9PYnNlcnZlcnMpIHtcbiAgICBjb25zdCBwcm94eSA9IG5ldyBPYnNlcnZlclByb3h5KGV4ZWN1dG9yLCBvbk5vT2JzZXJ2ZXJzKTtcbiAgICByZXR1cm4gcHJveHkuc3Vic2NyaWJlLmJpbmQocHJveHkpO1xufVxuLyoqXG4gKiBJbXBsZW1lbnQgZmFuLW91dCBmb3IgYW55IG51bWJlciBvZiBPYnNlcnZlcnMgYXR0YWNoZWQgdmlhIGEgc3Vic2NyaWJlXG4gKiBmdW5jdGlvbi5cbiAqL1xuY2xhc3MgT2JzZXJ2ZXJQcm94eSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIGV4ZWN1dG9yIEZ1bmN0aW9uIHdoaWNoIGNhbiBtYWtlIGNhbGxzIHRvIGEgc2luZ2xlIE9ic2VydmVyXG4gICAgICogICAgIGFzIGEgcHJveHkuXG4gICAgICogQHBhcmFtIG9uTm9PYnNlcnZlcnMgQ2FsbGJhY2sgd2hlbiBjb3VudCBvZiBPYnNlcnZlcnMgZ29lcyB0byB6ZXJvLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGV4ZWN1dG9yLCBvbk5vT2JzZXJ2ZXJzKSB7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzID0gW107XG4gICAgICAgIHRoaXMudW5zdWJzY3JpYmVzID0gW107XG4gICAgICAgIHRoaXMub2JzZXJ2ZXJDb3VudCA9IDA7XG4gICAgICAgIC8vIE1pY3JvLXRhc2sgc2NoZWR1bGluZyBieSBjYWxsaW5nIHRhc2sudGhlbigpLlxuICAgICAgICB0aGlzLnRhc2sgPSBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgdGhpcy5maW5hbGl6ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5vbk5vT2JzZXJ2ZXJzID0gb25Ob09ic2VydmVycztcbiAgICAgICAgLy8gQ2FsbCB0aGUgZXhlY3V0b3IgYXN5bmNocm9ub3VzbHkgc28gc3Vic2NyaWJlcnMgdGhhdCBhcmUgY2FsbGVkXG4gICAgICAgIC8vIHN5bmNocm9ub3VzbHkgYWZ0ZXIgdGhlIGNyZWF0aW9uIG9mIHRoZSBzdWJzY3JpYmUgZnVuY3Rpb25cbiAgICAgICAgLy8gY2FuIHN0aWxsIHJlY2VpdmUgdGhlIHZlcnkgZmlyc3QgdmFsdWUgZ2VuZXJhdGVkIGluIHRoZSBleGVjdXRvci5cbiAgICAgICAgdGhpcy50YXNrXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBleGVjdXRvcih0aGlzKTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZXJyb3IoZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBuZXh0KHZhbHVlKSB7XG4gICAgICAgIHRoaXMuZm9yRWFjaE9ic2VydmVyKChvYnNlcnZlcikgPT4ge1xuICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dCh2YWx1ZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBlcnJvcihlcnJvcikge1xuICAgICAgICB0aGlzLmZvckVhY2hPYnNlcnZlcigob2JzZXJ2ZXIpID0+IHtcbiAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKGVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY2xvc2UoZXJyb3IpO1xuICAgIH1cbiAgICBjb21wbGV0ZSgpIHtcbiAgICAgICAgdGhpcy5mb3JFYWNoT2JzZXJ2ZXIoKG9ic2VydmVyKSA9PiB7XG4gICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdWJzY3JpYmUgZnVuY3Rpb24gdGhhdCBjYW4gYmUgdXNlZCB0byBhZGQgYW4gT2JzZXJ2ZXIgdG8gdGhlIGZhbi1vdXQgbGlzdC5cbiAgICAgKlxuICAgICAqIC0gV2UgcmVxdWlyZSB0aGF0IG5vIGV2ZW50IGlzIHNlbnQgdG8gYSBzdWJzY3JpYmVyIHN5bmNocm9ub3VzbHkgdG8gdGhlaXJcbiAgICAgKiAgIGNhbGwgdG8gc3Vic2NyaWJlKCkuXG4gICAgICovXG4gICAgc3Vic2NyaWJlKG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGUpIHtcbiAgICAgICAgbGV0IG9ic2VydmVyO1xuICAgICAgICBpZiAobmV4dE9yT2JzZXJ2ZXIgPT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgZXJyb3IgPT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgY29tcGxldGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIE9ic2VydmVyLicpO1xuICAgICAgICB9XG4gICAgICAgIC8vIEFzc2VtYmxlIGFuIE9ic2VydmVyIG9iamVjdCB3aGVuIHBhc3NlZCBhcyBjYWxsYmFjayBmdW5jdGlvbnMuXG4gICAgICAgIGlmIChpbXBsZW1lbnRzQW55TWV0aG9kcyhuZXh0T3JPYnNlcnZlciwgW1xuICAgICAgICAgICAgJ25leHQnLFxuICAgICAgICAgICAgJ2Vycm9yJyxcbiAgICAgICAgICAgICdjb21wbGV0ZSdcbiAgICAgICAgXSkpIHtcbiAgICAgICAgICAgIG9ic2VydmVyID0gbmV4dE9yT2JzZXJ2ZXI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBvYnNlcnZlciA9IHtcbiAgICAgICAgICAgICAgICBuZXh0OiBuZXh0T3JPYnNlcnZlcixcbiAgICAgICAgICAgICAgICBlcnJvcixcbiAgICAgICAgICAgICAgICBjb21wbGV0ZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob2JzZXJ2ZXIubmV4dCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBvYnNlcnZlci5uZXh0ID0gbm9vcDtcbiAgICAgICAgfVxuICAgICAgICBpZiAob2JzZXJ2ZXIuZXJyb3IgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgb2JzZXJ2ZXIuZXJyb3IgPSBub29wO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvYnNlcnZlci5jb21wbGV0ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSA9IG5vb3A7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdW5zdWIgPSB0aGlzLnVuc3Vic2NyaWJlT25lLmJpbmQodGhpcywgdGhpcy5vYnNlcnZlcnMubGVuZ3RoKTtcbiAgICAgICAgLy8gQXR0ZW1wdCB0byBzdWJzY3JpYmUgdG8gYSB0ZXJtaW5hdGVkIE9ic2VydmFibGUgLSB3ZVxuICAgICAgICAvLyBqdXN0IHJlc3BvbmQgdG8gdGhlIE9ic2VydmVyIHdpdGggdGhlIGZpbmFsIGVycm9yIG9yIGNvbXBsZXRlXG4gICAgICAgIC8vIGV2ZW50LlxuICAgICAgICBpZiAodGhpcy5maW5hbGl6ZWQpIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgICAgICAgICAgIHRoaXMudGFzay50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5maW5hbEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5lcnJvcih0aGlzLmZpbmFsRXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBub3RoaW5nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzLnB1c2gob2JzZXJ2ZXIpO1xuICAgICAgICByZXR1cm4gdW5zdWI7XG4gICAgfVxuICAgIC8vIFVuc3Vic2NyaWJlIGlzIHN5bmNocm9ub3VzIC0gd2UgZ3VhcmFudGVlIHRoYXQgbm8gZXZlbnRzIGFyZSBzZW50IHRvXG4gICAgLy8gYW55IHVuc3Vic2NyaWJlZCBPYnNlcnZlci5cbiAgICB1bnN1YnNjcmliZU9uZShpKSB7XG4gICAgICAgIGlmICh0aGlzLm9ic2VydmVycyA9PT0gdW5kZWZpbmVkIHx8IHRoaXMub2JzZXJ2ZXJzW2ldID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBkZWxldGUgdGhpcy5vYnNlcnZlcnNbaV07XG4gICAgICAgIHRoaXMub2JzZXJ2ZXJDb3VudCAtPSAxO1xuICAgICAgICBpZiAodGhpcy5vYnNlcnZlckNvdW50ID09PSAwICYmIHRoaXMub25Ob09ic2VydmVycyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLm9uTm9PYnNlcnZlcnModGhpcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZm9yRWFjaE9ic2VydmVyKGZuKSB7XG4gICAgICAgIGlmICh0aGlzLmZpbmFsaXplZCkge1xuICAgICAgICAgICAgLy8gQWxyZWFkeSBjbG9zZWQgYnkgcHJldmlvdXMgZXZlbnQuLi4uanVzdCBlYXQgdGhlIGFkZGl0aW9uYWwgdmFsdWVzLlxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIFNpbmNlIHNlbmRPbmUgY2FsbHMgYXN5bmNocm9ub3VzbHkgLSB0aGVyZSBpcyBubyBjaGFuY2UgdGhhdFxuICAgICAgICAvLyB0aGlzLm9ic2VydmVycyB3aWxsIGJlY29tZSB1bmRlZmluZWQuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5vYnNlcnZlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMuc2VuZE9uZShpLCBmbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gQ2FsbCB0aGUgT2JzZXJ2ZXIgdmlhIG9uZSBvZiBpdCdzIGNhbGxiYWNrIGZ1bmN0aW9uLiBXZSBhcmUgY2FyZWZ1bCB0b1xuICAgIC8vIGNvbmZpcm0gdGhhdCB0aGUgb2JzZXJ2ZSBoYXMgbm90IGJlZW4gdW5zdWJzY3JpYmVkIHNpbmNlIHRoaXMgYXN5bmNocm9ub3VzXG4gICAgLy8gZnVuY3Rpb24gaGFkIGJlZW4gcXVldWVkLlxuICAgIHNlbmRPbmUoaSwgZm4pIHtcbiAgICAgICAgLy8gRXhlY3V0ZSB0aGUgY2FsbGJhY2sgYXN5bmNocm9ub3VzbHlcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xuICAgICAgICB0aGlzLnRhc2sudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5vYnNlcnZlcnMgIT09IHVuZGVmaW5lZCAmJiB0aGlzLm9ic2VydmVyc1tpXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgZm4odGhpcy5vYnNlcnZlcnNbaV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgZXhjZXB0aW9ucyByYWlzZWQgaW4gT2JzZXJ2ZXJzIG9yIG1pc3NpbmcgbWV0aG9kcyBvZiBhblxuICAgICAgICAgICAgICAgICAgICAvLyBPYnNlcnZlci5cbiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGVycm9yIHRvIGNvbnNvbGUuIGIvMzE0MDQ4MDZcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiBjb25zb2xlLmVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgY2xvc2UoZXJyKSB7XG4gICAgICAgIGlmICh0aGlzLmZpbmFsaXplZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZmluYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgaWYgKGVyciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLmZpbmFsRXJyb3IgPSBlcnI7XG4gICAgICAgIH1cbiAgICAgICAgLy8gUHJveHkgaXMgbm8gbG9uZ2VyIG5lZWRlZCAtIGdhcmJhZ2UgY29sbGVjdCByZWZlcmVuY2VzXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgICAgICAgdGhpcy50YXNrLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5vYnNlcnZlcnMgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB0aGlzLm9uTm9PYnNlcnZlcnMgPSB1bmRlZmluZWQ7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbi8qKiBUdXJuIHN5bmNocm9ub3VzIGZ1bmN0aW9uIGludG8gb25lIGNhbGxlZCBhc3luY2hyb25vdXNseS4gKi9cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXR5cGVzXG5mdW5jdGlvbiBhc3luYyhmbiwgb25FcnJvcikge1xuICAgIHJldHVybiAoLi4uYXJncykgPT4ge1xuICAgICAgICBQcm9taXNlLnJlc29sdmUodHJ1ZSlcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGZuKC4uLmFyZ3MpO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbn1cbi8qKlxuICogUmV0dXJuIHRydWUgaWYgdGhlIG9iamVjdCBwYXNzZWQgaW4gaW1wbGVtZW50cyBhbnkgb2YgdGhlIG5hbWVkIG1ldGhvZHMuXG4gKi9cbmZ1bmN0aW9uIGltcGxlbWVudHNBbnlNZXRob2RzKG9iaiwgbWV0aG9kcykge1xuICAgIGlmICh0eXBlb2Ygb2JqICE9PSAnb2JqZWN0JyB8fCBvYmogPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IG1ldGhvZCBvZiBtZXRob2RzKSB7XG4gICAgICAgIGlmIChtZXRob2QgaW4gb2JqICYmIHR5cGVvZiBvYmpbbWV0aG9kXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuZnVuY3Rpb24gbm9vcCgpIHtcbiAgICAvLyBkbyBub3RoaW5nXG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIENoZWNrIHRvIG1ha2Ugc3VyZSB0aGUgYXBwcm9wcmlhdGUgbnVtYmVyIG9mIGFyZ3VtZW50cyBhcmUgcHJvdmlkZWQgZm9yIGEgcHVibGljIGZ1bmN0aW9uLlxuICogVGhyb3dzIGFuIGVycm9yIGlmIGl0IGZhaWxzLlxuICpcbiAqIEBwYXJhbSBmbk5hbWUgVGhlIGZ1bmN0aW9uIG5hbWVcbiAqIEBwYXJhbSBtaW5Db3VudCBUaGUgbWluaW11bSBudW1iZXIgb2YgYXJndW1lbnRzIHRvIGFsbG93IGZvciB0aGUgZnVuY3Rpb24gY2FsbFxuICogQHBhcmFtIG1heENvdW50IFRoZSBtYXhpbXVtIG51bWJlciBvZiBhcmd1bWVudCB0byBhbGxvdyBmb3IgdGhlIGZ1bmN0aW9uIGNhbGxcbiAqIEBwYXJhbSBhcmdDb3VudCBUaGUgYWN0dWFsIG51bWJlciBvZiBhcmd1bWVudHMgcHJvdmlkZWQuXG4gKi9cbmNvbnN0IHZhbGlkYXRlQXJnQ291bnQgPSBmdW5jdGlvbiAoZm5OYW1lLCBtaW5Db3VudCwgbWF4Q291bnQsIGFyZ0NvdW50KSB7XG4gICAgbGV0IGFyZ0Vycm9yO1xuICAgIGlmIChhcmdDb3VudCA8IG1pbkNvdW50KSB7XG4gICAgICAgIGFyZ0Vycm9yID0gJ2F0IGxlYXN0ICcgKyBtaW5Db3VudDtcbiAgICB9XG4gICAgZWxzZSBpZiAoYXJnQ291bnQgPiBtYXhDb3VudCkge1xuICAgICAgICBhcmdFcnJvciA9IG1heENvdW50ID09PSAwID8gJ25vbmUnIDogJ25vIG1vcmUgdGhhbiAnICsgbWF4Q291bnQ7XG4gICAgfVxuICAgIGlmIChhcmdFcnJvcikge1xuICAgICAgICBjb25zdCBlcnJvciA9IGZuTmFtZSArXG4gICAgICAgICAgICAnIGZhaWxlZDogV2FzIGNhbGxlZCB3aXRoICcgK1xuICAgICAgICAgICAgYXJnQ291bnQgK1xuICAgICAgICAgICAgKGFyZ0NvdW50ID09PSAxID8gJyBhcmd1bWVudC4nIDogJyBhcmd1bWVudHMuJykgK1xuICAgICAgICAgICAgJyBFeHBlY3RzICcgK1xuICAgICAgICAgICAgYXJnRXJyb3IgK1xuICAgICAgICAgICAgJy4nO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpO1xuICAgIH1cbn07XG4vKipcbiAqIEdlbmVyYXRlcyBhIHN0cmluZyB0byBwcmVmaXggYW4gZXJyb3IgbWVzc2FnZSBhYm91dCBmYWlsZWQgYXJndW1lbnQgdmFsaWRhdGlvblxuICpcbiAqIEBwYXJhbSBmbk5hbWUgVGhlIGZ1bmN0aW9uIG5hbWVcbiAqIEBwYXJhbSBhcmdOYW1lIFRoZSBuYW1lIG9mIHRoZSBhcmd1bWVudFxuICogQHJldHVybiBUaGUgcHJlZml4IHRvIGFkZCB0byB0aGUgZXJyb3IgdGhyb3duIGZvciB2YWxpZGF0aW9uLlxuICovXG5mdW5jdGlvbiBlcnJvclByZWZpeChmbk5hbWUsIGFyZ05hbWUpIHtcbiAgICByZXR1cm4gYCR7Zm5OYW1lfSBmYWlsZWQ6ICR7YXJnTmFtZX0gYXJndW1lbnQgYDtcbn1cbi8qKlxuICogQHBhcmFtIGZuTmFtZVxuICogQHBhcmFtIGFyZ3VtZW50TnVtYmVyXG4gKiBAcGFyYW0gbmFtZXNwYWNlXG4gKiBAcGFyYW0gb3B0aW9uYWxcbiAqL1xuZnVuY3Rpb24gdmFsaWRhdGVOYW1lc3BhY2UoZm5OYW1lLCBuYW1lc3BhY2UsIG9wdGlvbmFsKSB7XG4gICAgaWYgKG9wdGlvbmFsICYmICFuYW1lc3BhY2UpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIG5hbWVzcGFjZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgLy9UT0RPOiBJIHNob3VsZCBkbyBtb3JlIHZhbGlkYXRpb24gaGVyZS4gV2Ugb25seSBhbGxvdyBjZXJ0YWluIGNoYXJzIGluIG5hbWVzcGFjZXMuXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvclByZWZpeChmbk5hbWUsICduYW1lc3BhY2UnKSArICdtdXN0IGJlIGEgdmFsaWQgZmlyZWJhc2UgbmFtZXNwYWNlLicpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHZhbGlkYXRlQ2FsbGJhY2soZm5OYW1lLCBhcmd1bWVudE5hbWUsIFxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHlwZXNcbmNhbGxiYWNrLCBvcHRpb25hbCkge1xuICAgIGlmIChvcHRpb25hbCAmJiAhY2FsbGJhY2spIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGNhbGxiYWNrICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvclByZWZpeChmbk5hbWUsIGFyZ3VtZW50TmFtZSkgKyAnbXVzdCBiZSBhIHZhbGlkIGZ1bmN0aW9uLicpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHZhbGlkYXRlQ29udGV4dE9iamVjdChmbk5hbWUsIGFyZ3VtZW50TmFtZSwgY29udGV4dCwgb3B0aW9uYWwpIHtcbiAgICBpZiAob3B0aW9uYWwgJiYgIWNvbnRleHQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGNvbnRleHQgIT09ICdvYmplY3QnIHx8IGNvbnRleHQgPT09IG51bGwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yUHJlZml4KGZuTmFtZSwgYXJndW1lbnROYW1lKSArICdtdXN0IGJlIGEgdmFsaWQgY29udGV4dCBvYmplY3QuJyk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gQ29kZSBvcmlnaW5hbGx5IGNhbWUgZnJvbSBnb29nLmNyeXB0LnN0cmluZ1RvVXRmOEJ5dGVBcnJheSwgYnV0IGZvciBzb21lIHJlYXNvbiB0aGV5XG4vLyBhdXRvbWF0aWNhbGx5IHJlcGxhY2VkICdcXHJcXG4nIHdpdGggJ1xcbicsIGFuZCB0aGV5IGRpZG4ndCBoYW5kbGUgc3Vycm9nYXRlIHBhaXJzLFxuLy8gc28gaXQncyBiZWVuIG1vZGlmaWVkLlxuLy8gTm90ZSB0aGF0IG5vdCBhbGwgVW5pY29kZSBjaGFyYWN0ZXJzIGFwcGVhciBhcyBzaW5nbGUgY2hhcmFjdGVycyBpbiBKYXZhU2NyaXB0IHN0cmluZ3MuXG4vLyBmcm9tQ2hhckNvZGUgcmV0dXJucyB0aGUgVVRGLTE2IGVuY29kaW5nIG9mIGEgY2hhcmFjdGVyIC0gc28gc29tZSBVbmljb2RlIGNoYXJhY3RlcnNcbi8vIHVzZSAyIGNoYXJhY3RlcnMgaW4gSmF2YVNjcmlwdC4gIEFsbCA0LWJ5dGUgVVRGLTggY2hhcmFjdGVycyBiZWdpbiB3aXRoIGEgZmlyc3Rcbi8vIGNoYXJhY3RlciBpbiB0aGUgcmFuZ2UgMHhEODAwIC0gMHhEQkZGICh0aGUgZmlyc3QgY2hhcmFjdGVyIG9mIGEgc28tY2FsbGVkIHN1cnJvZ2F0ZVxuLy8gcGFpcikuXG4vLyBTZWUgaHR0cDovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzUuMS8jc2VjLTE1LjEuM1xuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyXG4gKiBAcmV0dXJuIHtBcnJheX1cbiAqL1xuY29uc3Qgc3RyaW5nVG9CeXRlQXJyYXkgPSBmdW5jdGlvbiAoc3RyKSB7XG4gICAgY29uc3Qgb3V0ID0gW107XG4gICAgbGV0IHAgPSAwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxldCBjID0gc3RyLmNoYXJDb2RlQXQoaSk7XG4gICAgICAgIC8vIElzIHRoaXMgdGhlIGxlYWQgc3Vycm9nYXRlIGluIGEgc3Vycm9nYXRlIHBhaXI/XG4gICAgICAgIGlmIChjID49IDB4ZDgwMCAmJiBjIDw9IDB4ZGJmZikge1xuICAgICAgICAgICAgY29uc3QgaGlnaCA9IGMgLSAweGQ4MDA7IC8vIHRoZSBoaWdoIDEwIGJpdHMuXG4gICAgICAgICAgICBpKys7XG4gICAgICAgICAgICBhc3NlcnQoaSA8IHN0ci5sZW5ndGgsICdTdXJyb2dhdGUgcGFpciBtaXNzaW5nIHRyYWlsIHN1cnJvZ2F0ZS4nKTtcbiAgICAgICAgICAgIGNvbnN0IGxvdyA9IHN0ci5jaGFyQ29kZUF0KGkpIC0gMHhkYzAwOyAvLyB0aGUgbG93IDEwIGJpdHMuXG4gICAgICAgICAgICBjID0gMHgxMDAwMCArIChoaWdoIDw8IDEwKSArIGxvdztcbiAgICAgICAgfVxuICAgICAgICBpZiAoYyA8IDEyOCkge1xuICAgICAgICAgICAgb3V0W3ArK10gPSBjO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGMgPCAyMDQ4KSB7XG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjID4+IDYpIHwgMTkyO1xuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyAmIDYzKSB8IDEyODtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjIDwgNjU1MzYpIHtcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gMTIpIHwgMjI0O1xuICAgICAgICAgICAgb3V0W3ArK10gPSAoKGMgPj4gNikgJiA2MykgfCAxMjg7XG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyA+PiAxOCkgfCAyNDA7XG4gICAgICAgICAgICBvdXRbcCsrXSA9ICgoYyA+PiAxMikgJiA2MykgfCAxMjg7XG4gICAgICAgICAgICBvdXRbcCsrXSA9ICgoYyA+PiA2KSAmIDYzKSB8IDEyODtcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG91dDtcbn07XG4vKipcbiAqIENhbGN1bGF0ZSBsZW5ndGggd2l0aG91dCBhY3R1YWxseSBjb252ZXJ0aW5nOyB1c2VmdWwgZm9yIGRvaW5nIGNoZWFwZXIgdmFsaWRhdGlvbi5cbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJcbiAqIEByZXR1cm4ge251bWJlcn1cbiAqL1xuY29uc3Qgc3RyaW5nTGVuZ3RoID0gZnVuY3Rpb24gKHN0cikge1xuICAgIGxldCBwID0gMDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBjID0gc3RyLmNoYXJDb2RlQXQoaSk7XG4gICAgICAgIGlmIChjIDwgMTI4KSB7XG4gICAgICAgICAgICBwKys7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYyA8IDIwNDgpIHtcbiAgICAgICAgICAgIHAgKz0gMjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjID49IDB4ZDgwMCAmJiBjIDw9IDB4ZGJmZikge1xuICAgICAgICAgICAgLy8gTGVhZCBzdXJyb2dhdGUgb2YgYSBzdXJyb2dhdGUgcGFpci4gIFRoZSBwYWlyIHRvZ2V0aGVyIHdpbGwgdGFrZSA0IGJ5dGVzIHRvIHJlcHJlc2VudC5cbiAgICAgICAgICAgIHAgKz0gNDtcbiAgICAgICAgICAgIGkrKzsgLy8gc2tpcCB0cmFpbCBzdXJyb2dhdGUuXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwICs9IDM7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHA7XG59O1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBUaGUgYW1vdW50IG9mIG1pbGxpc2Vjb25kcyB0byBleHBvbmVudGlhbGx5IGluY3JlYXNlLlxuICovXG5jb25zdCBERUZBVUxUX0lOVEVSVkFMX01JTExJUyA9IDEwMDA7XG4vKipcbiAqIFRoZSBmYWN0b3IgdG8gYmFja29mZiBieS5cbiAqIFNob3VsZCBiZSBhIG51bWJlciBncmVhdGVyIHRoYW4gMS5cbiAqL1xuY29uc3QgREVGQVVMVF9CQUNLT0ZGX0ZBQ1RPUiA9IDI7XG4vKipcbiAqIFRoZSBtYXhpbXVtIG1pbGxpc2Vjb25kcyB0byBpbmNyZWFzZSB0by5cbiAqXG4gKiA8cD5WaXNpYmxlIGZvciB0ZXN0aW5nXG4gKi9cbmNvbnN0IE1BWF9WQUxVRV9NSUxMSVMgPSA0ICogNjAgKiA2MCAqIDEwMDA7IC8vIEZvdXIgaG91cnMsIGxpa2UgaU9TIGFuZCBBbmRyb2lkLlxuLyoqXG4gKiBUaGUgcGVyY2VudGFnZSBvZiBiYWNrb2ZmIHRpbWUgdG8gcmFuZG9taXplIGJ5LlxuICogU2VlXG4gKiBodHRwOi8vZ28vc2FmZS1jbGllbnQtYmVoYXZpb3Ijc3RlcC0xLWRldGVybWluZS10aGUtYXBwcm9wcmlhdGUtcmV0cnktaW50ZXJ2YWwtdG8taGFuZGxlLXNwaWtlLXRyYWZmaWNcbiAqIGZvciBjb250ZXh0LlxuICpcbiAqIDxwPlZpc2libGUgZm9yIHRlc3RpbmdcbiAqL1xuY29uc3QgUkFORE9NX0ZBQ1RPUiA9IDAuNTtcbi8qKlxuICogQmFzZWQgb24gdGhlIGJhY2tvZmYgbWV0aG9kIGZyb21cbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvY2xvc3VyZS1saWJyYXJ5L2Jsb2IvbWFzdGVyL2Nsb3N1cmUvZ29vZy9tYXRoL2V4cG9uZW50aWFsYmFja29mZi5qcy5cbiAqIEV4dHJhY3RlZCBoZXJlIHNvIHdlIGRvbid0IG5lZWQgdG8gcGFzcyBtZXRhZGF0YSBhbmQgYSBzdGF0ZWZ1bCBFeHBvbmVudGlhbEJhY2tvZmYgb2JqZWN0IGFyb3VuZC5cbiAqL1xuZnVuY3Rpb24gY2FsY3VsYXRlQmFja29mZk1pbGxpcyhiYWNrb2ZmQ291bnQsIGludGVydmFsTWlsbGlzID0gREVGQVVMVF9JTlRFUlZBTF9NSUxMSVMsIGJhY2tvZmZGYWN0b3IgPSBERUZBVUxUX0JBQ0tPRkZfRkFDVE9SKSB7XG4gICAgLy8gQ2FsY3VsYXRlcyBhbiBleHBvbmVudGlhbGx5IGluY3JlYXNpbmcgdmFsdWUuXG4gICAgLy8gRGV2aWF0aW9uOiBjYWxjdWxhdGVzIHZhbHVlIGZyb20gY291bnQgYW5kIGEgY29uc3RhbnQgaW50ZXJ2YWwsIHNvIHdlIG9ubHkgbmVlZCB0byBzYXZlIHZhbHVlXG4gICAgLy8gYW5kIGNvdW50IHRvIHJlc3RvcmUgc3RhdGUuXG4gICAgY29uc3QgY3VyckJhc2VWYWx1ZSA9IGludGVydmFsTWlsbGlzICogTWF0aC5wb3coYmFja29mZkZhY3RvciwgYmFja29mZkNvdW50KTtcbiAgICAvLyBBIHJhbmRvbSBcImZ1enpcIiB0byBhdm9pZCB3YXZlcyBvZiByZXRyaWVzLlxuICAgIC8vIERldmlhdGlvbjogcmFuZG9tRmFjdG9yIGlzIHJlcXVpcmVkLlxuICAgIGNvbnN0IHJhbmRvbVdhaXQgPSBNYXRoLnJvdW5kKFxuICAgIC8vIEEgZnJhY3Rpb24gb2YgdGhlIGJhY2tvZmYgdmFsdWUgdG8gYWRkL3N1YnRyYWN0LlxuICAgIC8vIERldmlhdGlvbjogY2hhbmdlcyBtdWx0aXBsaWNhdGlvbiBvcmRlciB0byBpbXByb3ZlIHJlYWRhYmlsaXR5LlxuICAgIFJBTkRPTV9GQUNUT1IgKlxuICAgICAgICBjdXJyQmFzZVZhbHVlICpcbiAgICAgICAgLy8gQSByYW5kb20gZmxvYXQgKHJvdW5kZWQgdG8gaW50IGJ5IE1hdGgucm91bmQgYWJvdmUpIGluIHRoZSByYW5nZSBbLTEsIDFdLiBEZXRlcm1pbmVzXG4gICAgICAgIC8vIGlmIHdlIGFkZCBvciBzdWJ0cmFjdC5cbiAgICAgICAgKE1hdGgucmFuZG9tKCkgLSAwLjUpICpcbiAgICAgICAgMik7XG4gICAgLy8gTGltaXRzIGJhY2tvZmYgdG8gbWF4IHRvIGF2b2lkIGVmZmVjdGl2ZWx5IHBlcm1hbmVudCBiYWNrb2ZmLlxuICAgIHJldHVybiBNYXRoLm1pbihNQVhfVkFMVUVfTUlMTElTLCBjdXJyQmFzZVZhbHVlICsgcmFuZG9tV2FpdCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFByb3ZpZGUgRW5nbGlzaCBvcmRpbmFsIGxldHRlcnMgYWZ0ZXIgYSBudW1iZXJcbiAqL1xuZnVuY3Rpb24gb3JkaW5hbChpKSB7XG4gICAgaWYgKCFOdW1iZXIuaXNGaW5pdGUoaSkpIHtcbiAgICAgICAgcmV0dXJuIGAke2l9YDtcbiAgICB9XG4gICAgcmV0dXJuIGkgKyBpbmRpY2F0b3IoaSk7XG59XG5mdW5jdGlvbiBpbmRpY2F0b3IoaSkge1xuICAgIGkgPSBNYXRoLmFicyhpKTtcbiAgICBjb25zdCBjZW50ID0gaSAlIDEwMDtcbiAgICBpZiAoY2VudCA+PSAxMCAmJiBjZW50IDw9IDIwKSB7XG4gICAgICAgIHJldHVybiAndGgnO1xuICAgIH1cbiAgICBjb25zdCBkZWMgPSBpICUgMTA7XG4gICAgaWYgKGRlYyA9PT0gMSkge1xuICAgICAgICByZXR1cm4gJ3N0JztcbiAgICB9XG4gICAgaWYgKGRlYyA9PT0gMikge1xuICAgICAgICByZXR1cm4gJ25kJztcbiAgICB9XG4gICAgaWYgKGRlYyA9PT0gMykge1xuICAgICAgICByZXR1cm4gJ3JkJztcbiAgICB9XG4gICAgcmV0dXJuICd0aCc7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIxIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5mdW5jdGlvbiBnZXRNb2R1bGFySW5zdGFuY2Uoc2VydmljZSkge1xuICAgIGlmIChzZXJ2aWNlICYmIHNlcnZpY2UuX2RlbGVnYXRlKSB7XG4gICAgICAgIHJldHVybiBzZXJ2aWNlLl9kZWxlZ2F0ZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgQ09OU1RBTlRTLCBEZWNvZGVCYXNlNjRTdHJpbmdFcnJvciwgRGVmZXJyZWQsIEVycm9yRmFjdG9yeSwgRmlyZWJhc2VFcnJvciwgTUFYX1ZBTFVFX01JTExJUywgUkFORE9NX0ZBQ1RPUiwgU2hhMSwgYXJlQ29va2llc0VuYWJsZWQsIGFzc2VydCwgYXNzZXJ0aW9uRXJyb3IsIGFzeW5jLCBiYXNlNjQsIGJhc2U2NERlY29kZSwgYmFzZTY0RW5jb2RlLCBiYXNlNjR1cmxFbmNvZGVXaXRob3V0UGFkZGluZywgY2FsY3VsYXRlQmFja29mZk1pbGxpcywgY29udGFpbnMsIGNyZWF0ZU1vY2tVc2VyVG9rZW4sIGNyZWF0ZVN1YnNjcmliZSwgZGVjb2RlLCBkZWVwQ29weSwgZGVlcEVxdWFsLCBkZWVwRXh0ZW5kLCBlcnJvclByZWZpeCwgZXh0cmFjdFF1ZXJ5c3RyaW5nLCBnZXREZWZhdWx0QXBwQ29uZmlnLCBnZXREZWZhdWx0RW11bGF0b3JIb3N0LCBnZXREZWZhdWx0RW11bGF0b3JIb3N0bmFtZUFuZFBvcnQsIGdldERlZmF1bHRzLCBnZXRFeHBlcmltZW50YWxTZXR0aW5nLCBnZXRHbG9iYWwsIGdldE1vZHVsYXJJbnN0YW5jZSwgZ2V0VUEsIGlzQWRtaW4sIGlzQnJvd3NlciwgaXNCcm93c2VyRXh0ZW5zaW9uLCBpc0Nsb3VkV29ya3N0YXRpb24sIGlzQ2xvdWRmbGFyZVdvcmtlciwgaXNFbGVjdHJvbiwgaXNFbXB0eSwgaXNJRSwgaXNJbmRleGVkREJBdmFpbGFibGUsIGlzTW9iaWxlQ29yZG92YSwgaXNOb2RlLCBpc05vZGVTZGssIGlzUmVhY3ROYXRpdmUsIGlzU2FmYXJpLCBpc1NhZmFyaU9yV2Via2l0LCBpc1VXUCwgaXNWYWxpZEZvcm1hdCwgaXNWYWxpZFRpbWVzdGFtcCwgaXNXZWJXb3JrZXIsIGlzc3VlZEF0VGltZSwganNvbkV2YWwsIG1hcCwgb3JkaW5hbCwgcGluZ1NlcnZlciwgcHJvbWlzZVdpdGhUaW1lb3V0LCBxdWVyeXN0cmluZywgcXVlcnlzdHJpbmdEZWNvZGUsIHNhZmVHZXQsIHN0cmluZ0xlbmd0aCwgc3RyaW5nVG9CeXRlQXJyYXksIHN0cmluZ2lmeSwgdXBkYXRlRW11bGF0b3JCYW5uZXIsIHZhbGlkYXRlQXJnQ291bnQsIHZhbGlkYXRlQ2FsbGJhY2ssIHZhbGlkYXRlQ29udGV4dE9iamVjdCwgdmFsaWRhdGVJbmRleGVkREJPcGVuYWJsZSwgdmFsaWRhdGVOYW1lc3BhY2UgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmVzbS5qcy5tYXBcbiIsImltcG9ydCB7IERlZmVycmVkIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuXG4vKipcbiAqIENvbXBvbmVudCBmb3Igc2VydmljZSBuYW1lIFQsIGUuZy4gYGF1dGhgLCBgYXV0aC1pbnRlcm5hbGBcbiAqL1xuY2xhc3MgQ29tcG9uZW50IHtcbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSBuYW1lIFRoZSBwdWJsaWMgc2VydmljZSBuYW1lLCBlLmcuIGFwcCwgYXV0aCwgZmlyZXN0b3JlLCBkYXRhYmFzZVxuICAgICAqIEBwYXJhbSBpbnN0YW5jZUZhY3RvcnkgU2VydmljZSBmYWN0b3J5IHJlc3BvbnNpYmxlIGZvciBjcmVhdGluZyB0aGUgcHVibGljIGludGVyZmFjZVxuICAgICAqIEBwYXJhbSB0eXBlIHdoZXRoZXIgdGhlIHNlcnZpY2UgcHJvdmlkZWQgYnkgdGhlIGNvbXBvbmVudCBpcyBwdWJsaWMgb3IgcHJpdmF0ZVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKG5hbWUsIGluc3RhbmNlRmFjdG9yeSwgdHlwZSkge1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLmluc3RhbmNlRmFjdG9yeSA9IGluc3RhbmNlRmFjdG9yeTtcbiAgICAgICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICAgICAgdGhpcy5tdWx0aXBsZUluc3RhbmNlcyA9IGZhbHNlO1xuICAgICAgICAvKipcbiAgICAgICAgICogUHJvcGVydGllcyB0byBiZSBhZGRlZCB0byB0aGUgc2VydmljZSBuYW1lc3BhY2VcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2VydmljZVByb3BzID0ge307XG4gICAgICAgIHRoaXMuaW5zdGFudGlhdGlvbk1vZGUgPSBcIkxBWllcIiAvKiBJbnN0YW50aWF0aW9uTW9kZS5MQVpZICovO1xuICAgICAgICB0aGlzLm9uSW5zdGFuY2VDcmVhdGVkID0gbnVsbDtcbiAgICB9XG4gICAgc2V0SW5zdGFudGlhdGlvbk1vZGUobW9kZSkge1xuICAgICAgICB0aGlzLmluc3RhbnRpYXRpb25Nb2RlID0gbW9kZTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHNldE11bHRpcGxlSW5zdGFuY2VzKG11bHRpcGxlSW5zdGFuY2VzKSB7XG4gICAgICAgIHRoaXMubXVsdGlwbGVJbnN0YW5jZXMgPSBtdWx0aXBsZUluc3RhbmNlcztcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHNldFNlcnZpY2VQcm9wcyhwcm9wcykge1xuICAgICAgICB0aGlzLnNlcnZpY2VQcm9wcyA9IHByb3BzO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgc2V0SW5zdGFuY2VDcmVhdGVkQ2FsbGJhY2soY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5vbkluc3RhbmNlQ3JlYXRlZCA9IGNhbGxiYWNrO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jb25zdCBERUZBVUxUX0VOVFJZX05BTUUgPSAnW0RFRkFVTFRdJztcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUHJvdmlkZXIgZm9yIGluc3RhbmNlIGZvciBzZXJ2aWNlIG5hbWUgVCwgZS5nLiAnYXV0aCcsICdhdXRoLWludGVybmFsJ1xuICogTmFtZVNlcnZpY2VNYXBwaW5nW1RdIGlzIGFuIGFsaWFzIGZvciB0aGUgdHlwZSBvZiB0aGUgaW5zdGFuY2VcbiAqL1xuY2xhc3MgUHJvdmlkZXIge1xuICAgIGNvbnN0cnVjdG9yKG5hbWUsIGNvbnRhaW5lcikge1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICAgICAgdGhpcy5jb21wb25lbnQgPSBudWxsO1xuICAgICAgICB0aGlzLmluc3RhbmNlcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5pbnN0YW5jZXNEZWZlcnJlZCA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5pbnN0YW5jZXNPcHRpb25zID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLm9uSW5pdENhbGxiYWNrcyA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQHBhcmFtIGlkZW50aWZpZXIgQSBwcm92aWRlciBjYW4gcHJvdmlkZSBtdWx0aXBsZSBpbnN0YW5jZXMgb2YgYSBzZXJ2aWNlXG4gICAgICogaWYgdGhpcy5jb21wb25lbnQubXVsdGlwbGVJbnN0YW5jZXMgaXMgdHJ1ZS5cbiAgICAgKi9cbiAgICBnZXQoaWRlbnRpZmllcikge1xuICAgICAgICAvLyBpZiBtdWx0aXBsZUluc3RhbmNlcyBpcyBub3Qgc3VwcG9ydGVkLCB1c2UgdGhlIGRlZmF1bHQgbmFtZVxuICAgICAgICBjb25zdCBub3JtYWxpemVkSWRlbnRpZmllciA9IHRoaXMubm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyKGlkZW50aWZpZXIpO1xuICAgICAgICBpZiAoIXRoaXMuaW5zdGFuY2VzRGVmZXJyZWQuaGFzKG5vcm1hbGl6ZWRJZGVudGlmaWVyKSkge1xuICAgICAgICAgICAgY29uc3QgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzRGVmZXJyZWQuc2V0KG5vcm1hbGl6ZWRJZGVudGlmaWVyLCBkZWZlcnJlZCk7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0luaXRpYWxpemVkKG5vcm1hbGl6ZWRJZGVudGlmaWVyKSB8fFxuICAgICAgICAgICAgICAgIHRoaXMuc2hvdWxkQXV0b0luaXRpYWxpemUoKSkge1xuICAgICAgICAgICAgICAgIC8vIGluaXRpYWxpemUgdGhlIHNlcnZpY2UgaWYgaXQgY2FuIGJlIGF1dG8taW5pdGlhbGl6ZWRcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpbnN0YW5jZSA9IHRoaXMuZ2V0T3JJbml0aWFsaXplU2VydmljZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZUlkZW50aWZpZXI6IG5vcm1hbGl6ZWRJZGVudGlmaWVyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5zdGFuY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoaW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHdoZW4gdGhlIGluc3RhbmNlIGZhY3RvcnkgdGhyb3dzIGFuIGV4Y2VwdGlvbiBkdXJpbmcgZ2V0KCksIGl0IHNob3VsZCBub3QgY2F1c2VcbiAgICAgICAgICAgICAgICAgICAgLy8gYSBmYXRhbCBlcnJvci4gV2UganVzdCByZXR1cm4gdGhlIHVucmVzb2x2ZWQgcHJvbWlzZSBpbiB0aGlzIGNhc2UuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlc0RlZmVycmVkLmdldChub3JtYWxpemVkSWRlbnRpZmllcikucHJvbWlzZTtcbiAgICB9XG4gICAgZ2V0SW1tZWRpYXRlKG9wdGlvbnMpIHtcbiAgICAgICAgLy8gaWYgbXVsdGlwbGVJbnN0YW5jZXMgaXMgbm90IHN1cHBvcnRlZCwgdXNlIHRoZSBkZWZhdWx0IG5hbWVcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZElkZW50aWZpZXIgPSB0aGlzLm5vcm1hbGl6ZUluc3RhbmNlSWRlbnRpZmllcihvcHRpb25zPy5pZGVudGlmaWVyKTtcbiAgICAgICAgY29uc3Qgb3B0aW9uYWwgPSBvcHRpb25zPy5vcHRpb25hbCA/PyBmYWxzZTtcbiAgICAgICAgaWYgKHRoaXMuaXNJbml0aWFsaXplZChub3JtYWxpemVkSWRlbnRpZmllcikgfHxcbiAgICAgICAgICAgIHRoaXMuc2hvdWxkQXV0b0luaXRpYWxpemUoKSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRPckluaXRpYWxpemVTZXJ2aWNlKHtcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VJZGVudGlmaWVyOiBub3JtYWxpemVkSWRlbnRpZmllclxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9uYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIEluIGNhc2UgYSBjb21wb25lbnQgaXMgbm90IGluaXRpYWxpemVkIGFuZCBzaG91bGQvY2Fubm90IGJlIGF1dG8taW5pdGlhbGl6ZWQgYXQgdGhlIG1vbWVudCwgcmV0dXJuIG51bGwgaWYgdGhlIG9wdGlvbmFsIGZsYWcgaXMgc2V0LCBvciB0aHJvd1xuICAgICAgICAgICAgaWYgKG9wdGlvbmFsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcihgU2VydmljZSAke3RoaXMubmFtZX0gaXMgbm90IGF2YWlsYWJsZWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGdldENvbXBvbmVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tcG9uZW50O1xuICAgIH1cbiAgICBzZXRDb21wb25lbnQoY29tcG9uZW50KSB7XG4gICAgICAgIGlmIChjb21wb25lbnQubmFtZSAhPT0gdGhpcy5uYW1lKSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihgTWlzbWF0Y2hpbmcgQ29tcG9uZW50ICR7Y29tcG9uZW50Lm5hbWV9IGZvciBQcm92aWRlciAke3RoaXMubmFtZX0uYCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY29tcG9uZW50KSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihgQ29tcG9uZW50IGZvciAke3RoaXMubmFtZX0gaGFzIGFscmVhZHkgYmVlbiBwcm92aWRlZGApO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29tcG9uZW50ID0gY29tcG9uZW50O1xuICAgICAgICAvLyByZXR1cm4gZWFybHkgd2l0aG91dCBhdHRlbXB0aW5nIHRvIGluaXRpYWxpemUgdGhlIGNvbXBvbmVudCBpZiB0aGUgY29tcG9uZW50IHJlcXVpcmVzIGV4cGxpY2l0IGluaXRpYWxpemF0aW9uIChjYWxsaW5nIGBQcm92aWRlci5pbml0aWFsaXplKClgKVxuICAgICAgICBpZiAoIXRoaXMuc2hvdWxkQXV0b0luaXRpYWxpemUoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIGlmIHRoZSBzZXJ2aWNlIGlzIGVhZ2VyLCBpbml0aWFsaXplIHRoZSBkZWZhdWx0IGluc3RhbmNlXG4gICAgICAgIGlmIChpc0NvbXBvbmVudEVhZ2VyKGNvbXBvbmVudCkpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5nZXRPckluaXRpYWxpemVTZXJ2aWNlKHsgaW5zdGFuY2VJZGVudGlmaWVyOiBERUZBVUxUX0VOVFJZX05BTUUgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vIHdoZW4gdGhlIGluc3RhbmNlIGZhY3RvcnkgZm9yIGFuIGVhZ2VyIENvbXBvbmVudCB0aHJvd3MgYW4gZXhjZXB0aW9uIGR1cmluZyB0aGUgZWFnZXJcbiAgICAgICAgICAgICAgICAvLyBpbml0aWFsaXphdGlvbiwgaXQgc2hvdWxkIG5vdCBjYXVzZSBhIGZhdGFsIGVycm9yLlxuICAgICAgICAgICAgICAgIC8vIFRPRE86IEludmVzdGlnYXRlIGlmIHdlIG5lZWQgdG8gbWFrZSBpdCBjb25maWd1cmFibGUsIGJlY2F1c2Ugc29tZSBjb21wb25lbnQgbWF5IHdhbnQgdG8gY2F1c2VcbiAgICAgICAgICAgICAgICAvLyBhIGZhdGFsIGVycm9yIGluIHRoaXMgY2FzZT9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBDcmVhdGUgc2VydmljZSBpbnN0YW5jZXMgZm9yIHRoZSBwZW5kaW5nIHByb21pc2VzIGFuZCByZXNvbHZlIHRoZW1cbiAgICAgICAgLy8gTk9URTogaWYgdGhpcy5tdWx0aXBsZUluc3RhbmNlcyBpcyBmYWxzZSwgb25seSB0aGUgZGVmYXVsdCBpbnN0YW5jZSB3aWxsIGJlIGNyZWF0ZWRcbiAgICAgICAgLy8gYW5kIGFsbCBwcm9taXNlcyB3aXRoIHJlc29sdmUgd2l0aCBpdCByZWdhcmRsZXNzIG9mIHRoZSBpZGVudGlmaWVyLlxuICAgICAgICBmb3IgKGNvbnN0IFtpbnN0YW5jZUlkZW50aWZpZXIsIGluc3RhbmNlRGVmZXJyZWRdIG9mIHRoaXMuaW5zdGFuY2VzRGVmZXJyZWQuZW50cmllcygpKSB7XG4gICAgICAgICAgICBjb25zdCBub3JtYWxpemVkSWRlbnRpZmllciA9IHRoaXMubm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyKGluc3RhbmNlSWRlbnRpZmllcik7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIGBnZXRPckluaXRpYWxpemVTZXJ2aWNlKClgIHNob3VsZCBhbHdheXMgcmV0dXJuIGEgdmFsaWQgaW5zdGFuY2Ugc2luY2UgYSBjb21wb25lbnQgaXMgZ3VhcmFudGVlZC4gdXNlICEgdG8gbWFrZSB0eXBlc2NyaXB0IGhhcHB5LlxuICAgICAgICAgICAgICAgIGNvbnN0IGluc3RhbmNlID0gdGhpcy5nZXRPckluaXRpYWxpemVTZXJ2aWNlKHtcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VJZGVudGlmaWVyOiBub3JtYWxpemVkSWRlbnRpZmllclxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGluc3RhbmNlRGVmZXJyZWQucmVzb2x2ZShpbnN0YW5jZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vIHdoZW4gdGhlIGluc3RhbmNlIGZhY3RvcnkgdGhyb3dzIGFuIGV4Y2VwdGlvbiwgaXQgc2hvdWxkIG5vdCBjYXVzZVxuICAgICAgICAgICAgICAgIC8vIGEgZmF0YWwgZXJyb3IuIFdlIGp1c3QgbGVhdmUgdGhlIHByb21pc2UgdW5yZXNvbHZlZC5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjbGVhckluc3RhbmNlKGlkZW50aWZpZXIgPSBERUZBVUxUX0VOVFJZX05BTUUpIHtcbiAgICAgICAgdGhpcy5pbnN0YW5jZXNEZWZlcnJlZC5kZWxldGUoaWRlbnRpZmllcik7XG4gICAgICAgIHRoaXMuaW5zdGFuY2VzT3B0aW9ucy5kZWxldGUoaWRlbnRpZmllcik7XG4gICAgICAgIHRoaXMuaW5zdGFuY2VzLmRlbGV0ZShpZGVudGlmaWVyKTtcbiAgICB9XG4gICAgLy8gYXBwLmRlbGV0ZSgpIHdpbGwgY2FsbCB0aGlzIG1ldGhvZCBvbiBldmVyeSBwcm92aWRlciB0byBkZWxldGUgdGhlIHNlcnZpY2VzXG4gICAgLy8gVE9ETzogc2hvdWxkIHdlIG1hcmsgdGhlIHByb3ZpZGVyIGFzIGRlbGV0ZWQ/XG4gICAgYXN5bmMgZGVsZXRlKCkge1xuICAgICAgICBjb25zdCBzZXJ2aWNlcyA9IEFycmF5LmZyb20odGhpcy5pbnN0YW5jZXMudmFsdWVzKCkpO1xuICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgICAgICAuLi5zZXJ2aWNlc1xuICAgICAgICAgICAgICAgIC5maWx0ZXIoc2VydmljZSA9PiAnSU5URVJOQUwnIGluIHNlcnZpY2UpIC8vIGxlZ2FjeSBzZXJ2aWNlc1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgICAgLm1hcChzZXJ2aWNlID0+IHNlcnZpY2UuSU5URVJOQUwuZGVsZXRlKCkpLFxuICAgICAgICAgICAgLi4uc2VydmljZXNcbiAgICAgICAgICAgICAgICAuZmlsdGVyKHNlcnZpY2UgPT4gJ19kZWxldGUnIGluIHNlcnZpY2UpIC8vIG1vZHVsYXJpemVkIHNlcnZpY2VzXG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgICAgICAubWFwKHNlcnZpY2UgPT4gc2VydmljZS5fZGVsZXRlKCkpXG4gICAgICAgIF0pO1xuICAgIH1cbiAgICBpc0NvbXBvbmVudFNldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tcG9uZW50ICE9IG51bGw7XG4gICAgfVxuICAgIGlzSW5pdGlhbGl6ZWQoaWRlbnRpZmllciA9IERFRkFVTFRfRU5UUllfTkFNRSkge1xuICAgICAgICByZXR1cm4gdGhpcy5pbnN0YW5jZXMuaGFzKGlkZW50aWZpZXIpO1xuICAgIH1cbiAgICBnZXRPcHRpb25zKGlkZW50aWZpZXIgPSBERUZBVUxUX0VOVFJZX05BTUUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2VzT3B0aW9ucy5nZXQoaWRlbnRpZmllcikgfHwge307XG4gICAgfVxuICAgIGluaXRpYWxpemUob3B0cyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IHsgb3B0aW9ucyA9IHt9IH0gPSBvcHRzO1xuICAgICAgICBjb25zdCBub3JtYWxpemVkSWRlbnRpZmllciA9IHRoaXMubm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyKG9wdHMuaW5zdGFuY2VJZGVudGlmaWVyKTtcbiAgICAgICAgaWYgKHRoaXMuaXNJbml0aWFsaXplZChub3JtYWxpemVkSWRlbnRpZmllcikpIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKGAke3RoaXMubmFtZX0oJHtub3JtYWxpemVkSWRlbnRpZmllcn0pIGhhcyBhbHJlYWR5IGJlZW4gaW5pdGlhbGl6ZWRgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuaXNDb21wb25lbnRTZXQoKSkge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoYENvbXBvbmVudCAke3RoaXMubmFtZX0gaGFzIG5vdCBiZWVuIHJlZ2lzdGVyZWQgeWV0YCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaW5zdGFuY2UgPSB0aGlzLmdldE9ySW5pdGlhbGl6ZVNlcnZpY2Uoe1xuICAgICAgICAgICAgaW5zdGFuY2VJZGVudGlmaWVyOiBub3JtYWxpemVkSWRlbnRpZmllcixcbiAgICAgICAgICAgIG9wdGlvbnNcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIHJlc29sdmUgYW55IHBlbmRpbmcgcHJvbWlzZSB3YWl0aW5nIGZvciB0aGUgc2VydmljZSBpbnN0YW5jZVxuICAgICAgICBmb3IgKGNvbnN0IFtpbnN0YW5jZUlkZW50aWZpZXIsIGluc3RhbmNlRGVmZXJyZWRdIG9mIHRoaXMuaW5zdGFuY2VzRGVmZXJyZWQuZW50cmllcygpKSB7XG4gICAgICAgICAgICBjb25zdCBub3JtYWxpemVkRGVmZXJyZWRJZGVudGlmaWVyID0gdGhpcy5ub3JtYWxpemVJbnN0YW5jZUlkZW50aWZpZXIoaW5zdGFuY2VJZGVudGlmaWVyKTtcbiAgICAgICAgICAgIGlmIChub3JtYWxpemVkSWRlbnRpZmllciA9PT0gbm9ybWFsaXplZERlZmVycmVkSWRlbnRpZmllcikge1xuICAgICAgICAgICAgICAgIGluc3RhbmNlRGVmZXJyZWQucmVzb2x2ZShpbnN0YW5jZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGluc3RhbmNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSBjYWxsYmFjayAtIGEgZnVuY3Rpb24gdGhhdCB3aWxsIGJlIGludm9rZWQgIGFmdGVyIHRoZSBwcm92aWRlciBoYXMgYmVlbiBpbml0aWFsaXplZCBieSBjYWxsaW5nIHByb3ZpZGVyLmluaXRpYWxpemUoKS5cbiAgICAgKiBUaGUgZnVuY3Rpb24gaXMgaW52b2tlZCBTWU5DSFJPTk9VU0xZLCBzbyBpdCBzaG91bGQgbm90IGV4ZWN1dGUgYW55IGxvbmdydW5uaW5nIHRhc2tzIGluIG9yZGVyIHRvIG5vdCBibG9jayB0aGUgcHJvZ3JhbS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpZGVudGlmaWVyIEFuIG9wdGlvbmFsIGluc3RhbmNlIGlkZW50aWZpZXJcbiAgICAgKiBAcmV0dXJucyBhIGZ1bmN0aW9uIHRvIHVucmVnaXN0ZXIgdGhlIGNhbGxiYWNrXG4gICAgICovXG4gICAgb25Jbml0KGNhbGxiYWNrLCBpZGVudGlmaWVyKSB7XG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRJZGVudGlmaWVyID0gdGhpcy5ub3JtYWxpemVJbnN0YW5jZUlkZW50aWZpZXIoaWRlbnRpZmllcik7XG4gICAgICAgIGNvbnN0IGV4aXN0aW5nQ2FsbGJhY2tzID0gdGhpcy5vbkluaXRDYWxsYmFja3MuZ2V0KG5vcm1hbGl6ZWRJZGVudGlmaWVyKSA/P1xuICAgICAgICAgICAgbmV3IFNldCgpO1xuICAgICAgICBleGlzdGluZ0NhbGxiYWNrcy5hZGQoY2FsbGJhY2spO1xuICAgICAgICB0aGlzLm9uSW5pdENhbGxiYWNrcy5zZXQobm9ybWFsaXplZElkZW50aWZpZXIsIGV4aXN0aW5nQ2FsbGJhY2tzKTtcbiAgICAgICAgY29uc3QgZXhpc3RpbmdJbnN0YW5jZSA9IHRoaXMuaW5zdGFuY2VzLmdldChub3JtYWxpemVkSWRlbnRpZmllcik7XG4gICAgICAgIGlmIChleGlzdGluZ0luc3RhbmNlKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhleGlzdGluZ0luc3RhbmNlLCBub3JtYWxpemVkSWRlbnRpZmllcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIGV4aXN0aW5nQ2FsbGJhY2tzLmRlbGV0ZShjYWxsYmFjayk7XG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEludm9rZSBvbkluaXQgY2FsbGJhY2tzIHN5bmNocm9ub3VzbHlcbiAgICAgKiBAcGFyYW0gaW5zdGFuY2UgdGhlIHNlcnZpY2UgaW5zdGFuY2VgXG4gICAgICovXG4gICAgaW52b2tlT25Jbml0Q2FsbGJhY2tzKGluc3RhbmNlLCBpZGVudGlmaWVyKSB7XG4gICAgICAgIGNvbnN0IGNhbGxiYWNrcyA9IHRoaXMub25Jbml0Q2FsbGJhY2tzLmdldChpZGVudGlmaWVyKTtcbiAgICAgICAgaWYgKCFjYWxsYmFja3MpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IGNhbGxiYWNrIG9mIGNhbGxiYWNrcykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhpbnN0YW5jZSwgaWRlbnRpZmllcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCB7XG4gICAgICAgICAgICAgICAgLy8gaWdub3JlIGVycm9ycyBpbiB0aGUgb25Jbml0IGNhbGxiYWNrXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0T3JJbml0aWFsaXplU2VydmljZSh7IGluc3RhbmNlSWRlbnRpZmllciwgb3B0aW9ucyA9IHt9IH0pIHtcbiAgICAgICAgbGV0IGluc3RhbmNlID0gdGhpcy5pbnN0YW5jZXMuZ2V0KGluc3RhbmNlSWRlbnRpZmllcik7XG4gICAgICAgIGlmICghaW5zdGFuY2UgJiYgdGhpcy5jb21wb25lbnQpIHtcbiAgICAgICAgICAgIGluc3RhbmNlID0gdGhpcy5jb21wb25lbnQuaW5zdGFuY2VGYWN0b3J5KHRoaXMuY29udGFpbmVyLCB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2VJZGVudGlmaWVyOiBub3JtYWxpemVJZGVudGlmaWVyRm9yRmFjdG9yeShpbnN0YW5jZUlkZW50aWZpZXIpLFxuICAgICAgICAgICAgICAgIG9wdGlvbnNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5pbnN0YW5jZXMuc2V0KGluc3RhbmNlSWRlbnRpZmllciwgaW5zdGFuY2UpO1xuICAgICAgICAgICAgdGhpcy5pbnN0YW5jZXNPcHRpb25zLnNldChpbnN0YW5jZUlkZW50aWZpZXIsIG9wdGlvbnMpO1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBJbnZva2Ugb25Jbml0IGxpc3RlbmVycy5cbiAgICAgICAgICAgICAqIE5vdGUgdGhpcy5jb21wb25lbnQub25JbnN0YW5jZUNyZWF0ZWQgaXMgZGlmZmVyZW50LCB3aGljaCBpcyB1c2VkIGJ5IHRoZSBjb21wb25lbnQgY3JlYXRvcixcbiAgICAgICAgICAgICAqIHdoaWxlIG9uSW5pdCBsaXN0ZW5lcnMgYXJlIHJlZ2lzdGVyZWQgYnkgY29uc3VtZXJzIG9mIHRoZSBwcm92aWRlci5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdGhpcy5pbnZva2VPbkluaXRDYWxsYmFja3MoaW5zdGFuY2UsIGluc3RhbmNlSWRlbnRpZmllcik7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIE9yZGVyIGlzIGltcG9ydGFudFxuICAgICAgICAgICAgICogb25JbnN0YW5jZUNyZWF0ZWQoKSBzaG91bGQgYmUgY2FsbGVkIGFmdGVyIHRoaXMuaW5zdGFuY2VzLnNldChpbnN0YW5jZUlkZW50aWZpZXIsIGluc3RhbmNlKTsgd2hpY2hcbiAgICAgICAgICAgICAqIG1ha2VzIGBpc0luaXRpYWxpemVkKClgIHJldHVybiB0cnVlLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpZiAodGhpcy5jb21wb25lbnQub25JbnN0YW5jZUNyZWF0ZWQpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXBvbmVudC5vbkluc3RhbmNlQ3JlYXRlZCh0aGlzLmNvbnRhaW5lciwgaW5zdGFuY2VJZGVudGlmaWVyLCBpbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWdub3JlIGVycm9ycyBpbiB0aGUgb25JbnN0YW5jZUNyZWF0ZWRDYWxsYmFja1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5zdGFuY2UgfHwgbnVsbDtcbiAgICB9XG4gICAgbm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyKGlkZW50aWZpZXIgPSBERUZBVUxUX0VOVFJZX05BTUUpIHtcbiAgICAgICAgaWYgKHRoaXMuY29tcG9uZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb21wb25lbnQubXVsdGlwbGVJbnN0YW5jZXMgPyBpZGVudGlmaWVyIDogREVGQVVMVF9FTlRSWV9OQU1FO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGlkZW50aWZpZXI7IC8vIGFzc3VtZSBtdWx0aXBsZSBpbnN0YW5jZXMgYXJlIHN1cHBvcnRlZCBiZWZvcmUgdGhlIGNvbXBvbmVudCBpcyBwcm92aWRlZC5cbiAgICAgICAgfVxuICAgIH1cbiAgICBzaG91bGRBdXRvSW5pdGlhbGl6ZSgpIHtcbiAgICAgICAgcmV0dXJuICghIXRoaXMuY29tcG9uZW50ICYmXG4gICAgICAgICAgICB0aGlzLmNvbXBvbmVudC5pbnN0YW50aWF0aW9uTW9kZSAhPT0gXCJFWFBMSUNJVFwiIC8qIEluc3RhbnRpYXRpb25Nb2RlLkVYUExJQ0lUICovKTtcbiAgICB9XG59XG4vLyB1bmRlZmluZWQgc2hvdWxkIGJlIHBhc3NlZCB0byB0aGUgc2VydmljZSBmYWN0b3J5IGZvciB0aGUgZGVmYXVsdCBpbnN0YW5jZVxuZnVuY3Rpb24gbm9ybWFsaXplSWRlbnRpZmllckZvckZhY3RvcnkoaWRlbnRpZmllcikge1xuICAgIHJldHVybiBpZGVudGlmaWVyID09PSBERUZBVUxUX0VOVFJZX05BTUUgPyB1bmRlZmluZWQgOiBpZGVudGlmaWVyO1xufVxuZnVuY3Rpb24gaXNDb21wb25lbnRFYWdlcihjb21wb25lbnQpIHtcbiAgICByZXR1cm4gY29tcG9uZW50Lmluc3RhbnRpYXRpb25Nb2RlID09PSBcIkVBR0VSXCIgLyogSW5zdGFudGlhdGlvbk1vZGUuRUFHRVIgKi87XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIENvbXBvbmVudENvbnRhaW5lciB0aGF0IHByb3ZpZGVzIFByb3ZpZGVycyBmb3Igc2VydmljZSBuYW1lIFQsIGUuZy4gYGF1dGhgLCBgYXV0aC1pbnRlcm5hbGBcbiAqL1xuY2xhc3MgQ29tcG9uZW50Q29udGFpbmVyIHtcbiAgICBjb25zdHJ1Y3RvcihuYW1lKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMucHJvdmlkZXJzID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSBjb21wb25lbnQgQ29tcG9uZW50IGJlaW5nIGFkZGVkXG4gICAgICogQHBhcmFtIG92ZXJ3cml0ZSBXaGVuIGEgY29tcG9uZW50IHdpdGggdGhlIHNhbWUgbmFtZSBoYXMgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWQsXG4gICAgICogaWYgb3ZlcndyaXRlIGlzIHRydWU6IG92ZXJ3cml0ZSB0aGUgZXhpc3RpbmcgY29tcG9uZW50IHdpdGggdGhlIG5ldyBjb21wb25lbnQgYW5kIGNyZWF0ZSBhIG5ld1xuICAgICAqIHByb3ZpZGVyIHdpdGggdGhlIG5ldyBjb21wb25lbnQuIEl0IGNhbiBiZSB1c2VmdWwgaW4gdGVzdHMgd2hlcmUgeW91IHdhbnQgdG8gdXNlIGRpZmZlcmVudCBtb2Nrc1xuICAgICAqIGZvciBkaWZmZXJlbnQgdGVzdHMuXG4gICAgICogaWYgb3ZlcndyaXRlIGlzIGZhbHNlOiB0aHJvdyBhbiBleGNlcHRpb25cbiAgICAgKi9cbiAgICBhZGRDb21wb25lbnQoY29tcG9uZW50KSB7XG4gICAgICAgIGNvbnN0IHByb3ZpZGVyID0gdGhpcy5nZXRQcm92aWRlcihjb21wb25lbnQubmFtZSk7XG4gICAgICAgIGlmIChwcm92aWRlci5pc0NvbXBvbmVudFNldCgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENvbXBvbmVudCAke2NvbXBvbmVudC5uYW1lfSBoYXMgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWQgd2l0aCAke3RoaXMubmFtZX1gKTtcbiAgICAgICAgfVxuICAgICAgICBwcm92aWRlci5zZXRDb21wb25lbnQoY29tcG9uZW50KTtcbiAgICB9XG4gICAgYWRkT3JPdmVyd3JpdGVDb21wb25lbnQoY29tcG9uZW50KSB7XG4gICAgICAgIGNvbnN0IHByb3ZpZGVyID0gdGhpcy5nZXRQcm92aWRlcihjb21wb25lbnQubmFtZSk7XG4gICAgICAgIGlmIChwcm92aWRlci5pc0NvbXBvbmVudFNldCgpKSB7XG4gICAgICAgICAgICAvLyBkZWxldGUgdGhlIGV4aXN0aW5nIHByb3ZpZGVyIGZyb20gdGhlIGNvbnRhaW5lciwgc28gd2UgY2FuIHJlZ2lzdGVyIHRoZSBuZXcgY29tcG9uZW50XG4gICAgICAgICAgICB0aGlzLnByb3ZpZGVycy5kZWxldGUoY29tcG9uZW50Lm5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYWRkQ29tcG9uZW50KGNvbXBvbmVudCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIGdldFByb3ZpZGVyIHByb3ZpZGVzIGEgdHlwZSBzYWZlIGludGVyZmFjZSB3aGVyZSBpdCBjYW4gb25seSBiZSBjYWxsZWQgd2l0aCBhIGZpZWxkIG5hbWVcbiAgICAgKiBwcmVzZW50IGluIE5hbWVTZXJ2aWNlTWFwcGluZyBpbnRlcmZhY2UuXG4gICAgICpcbiAgICAgKiBGaXJlYmFzZSBTREtzIHByb3ZpZGluZyBzZXJ2aWNlcyBzaG91bGQgZXh0ZW5kIE5hbWVTZXJ2aWNlTWFwcGluZyBpbnRlcmZhY2UgdG8gcmVnaXN0ZXJcbiAgICAgKiB0aGVtc2VsdmVzLlxuICAgICAqL1xuICAgIGdldFByb3ZpZGVyKG5hbWUpIHtcbiAgICAgICAgaWYgKHRoaXMucHJvdmlkZXJzLmhhcyhuYW1lKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvdmlkZXJzLmdldChuYW1lKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBjcmVhdGUgYSBQcm92aWRlciBmb3IgYSBzZXJ2aWNlIHRoYXQgaGFzbid0IHJlZ2lzdGVyZWQgd2l0aCBGaXJlYmFzZVxuICAgICAgICBjb25zdCBwcm92aWRlciA9IG5ldyBQcm92aWRlcihuYW1lLCB0aGlzKTtcbiAgICAgICAgdGhpcy5wcm92aWRlcnMuc2V0KG5hbWUsIHByb3ZpZGVyKTtcbiAgICAgICAgcmV0dXJuIHByb3ZpZGVyO1xuICAgIH1cbiAgICBnZXRQcm92aWRlcnMoKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMucHJvdmlkZXJzLnZhbHVlcygpKTtcbiAgICB9XG59XG5cbmV4cG9ydCB7IENvbXBvbmVudCwgQ29tcG9uZW50Q29udGFpbmVyLCBQcm92aWRlciB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguZXNtLmpzLm1hcFxuIiwidmFyIGNvbW1vbmpzR2xvYmFsID0gdHlwZW9mIGdsb2JhbFRoaXMgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsVGhpcyA6IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyBnbG9iYWwgOiB0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDoge307XG5cbnZhciB3ZWJjaGFubmVsX2Jsb2JfZXMyMDE4ID0ge307XG5cbi8qKiBAbGljZW5zZVxuQ29weXJpZ2h0IFRoZSBDbG9zdXJlIExpYnJhcnkgQXV0aG9ycy5cblNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBBcGFjaGUtMi4wXG4qL1xuXG52YXIgWGhySW87XG52YXIgRmV0Y2hYbWxIdHRwRmFjdG9yeTtcbnZhciBXZWJDaGFubmVsO1xudmFyIEV2ZW50VHlwZTtcbnZhciBFcnJvckNvZGU7XG52YXIgU3RhdDtcbnZhciBFdmVudDtcbnZhciBnZXRTdGF0RXZlbnRUYXJnZXQ7XG52YXIgY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydDtcbihmdW5jdGlvbigpIHt2YXIgaCxhYT1PYmplY3QuZGVmaW5lUHJvcGVydHk7ZnVuY3Rpb24gYmEoYSl7YT1bXCJvYmplY3RcIj09dHlwZW9mIGdsb2JhbFRoaXMmJmdsb2JhbFRoaXMsYSxcIm9iamVjdFwiPT10eXBlb2Ygd2luZG93JiZ3aW5kb3csXCJvYmplY3RcIj09dHlwZW9mIHNlbGYmJnNlbGYsXCJvYmplY3RcIj09dHlwZW9mIGNvbW1vbmpzR2xvYmFsJiZjb21tb25qc0dsb2JhbF07Zm9yKHZhciBiPTA7YjxhLmxlbmd0aDsrK2Ipe3ZhciBjPWFbYl07aWYoYyYmYy5NYXRoPT1NYXRoKXJldHVybiBjfXRocm93IEVycm9yKFwiQ2Fubm90IGZpbmQgZ2xvYmFsIG9iamVjdFwiKTt9dmFyIGNhPWJhKHRoaXMpO1xuZnVuY3Rpb24gZGEoYSxiKXtpZihiKWE6e3ZhciBjPWNhO2E9YS5zcGxpdChcIi5cIik7Zm9yKHZhciBkPTA7ZDxhLmxlbmd0aC0xO2QrKyl7dmFyIGU9YVtkXTtpZighKGUgaW4gYykpYnJlYWsgYTtjPWNbZV07fWE9YVthLmxlbmd0aC0xXTtkPWNbYV07Yj1iKGQpO2IhPWQmJmIhPW51bGwmJmFhKGMsYSx7Y29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwLHZhbHVlOmJ9KTt9fWRhKFwiU3ltYm9sLmRpc3Bvc2VcIixmdW5jdGlvbihhKXtyZXR1cm4gYT9hOlN5bWJvbChcIlN5bWJvbC5kaXNwb3NlXCIpfSk7ZGEoXCJBcnJheS5wcm90b3R5cGUudmFsdWVzXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGE/YTpmdW5jdGlvbigpe3JldHVybiB0aGlzW1N5bWJvbC5pdGVyYXRvcl0oKX19KTtcbmRhKFwiT2JqZWN0LmVudHJpZXNcIixmdW5jdGlvbihhKXtyZXR1cm4gYT9hOmZ1bmN0aW9uKGIpe3ZhciBjPVtdLGQ7Zm9yKGQgaW4gYilPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYixkKSYmYy5wdXNoKFtkLGJbZF1dKTtyZXR1cm4gY319KTsvKiogQGxpY2Vuc2VcblxuIENvcHlyaWdodCBUaGUgQ2xvc3VyZSBMaWJyYXJ5IEF1dGhvcnMuXG4gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEFwYWNoZS0yLjBcbiovXG52YXIgZWE9ZWF8fHt9LGw9dGhpc3x8c2VsZjtmdW5jdGlvbiBuKGEpe3ZhciBiPXR5cGVvZiBhO3JldHVybiBiPT1cIm9iamVjdFwiJiZhIT1udWxsfHxiPT1cImZ1bmN0aW9uXCJ9ZnVuY3Rpb24gZmEoYSxiLGMpe3JldHVybiBhLmNhbGwuYXBwbHkoYS5iaW5kLGFyZ3VtZW50cyl9ZnVuY3Rpb24gcChhLGIsYyl7cD1mYTtyZXR1cm4gcC5hcHBseShudWxsLGFyZ3VtZW50cyl9ZnVuY3Rpb24gaGEoYSxiKXt2YXIgYz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSk7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGQ9Yy5zbGljZSgpO2QucHVzaC5hcHBseShkLGFyZ3VtZW50cyk7cmV0dXJuIGEuYXBwbHkodGhpcyxkKX19XG5mdW5jdGlvbiB0KGEsYil7ZnVuY3Rpb24gYygpe31jLnByb3RvdHlwZT1iLnByb3RvdHlwZTthLlo9Yi5wcm90b3R5cGU7YS5wcm90b3R5cGU9bmV3IGM7YS5wcm90b3R5cGUuY29uc3RydWN0b3I9YTthLk9iPWZ1bmN0aW9uKGQsZSxmKXtmb3IodmFyIGc9QXJyYXkoYXJndW1lbnRzLmxlbmd0aC0yKSxrPTI7azxhcmd1bWVudHMubGVuZ3RoO2srKylnW2stMl09YXJndW1lbnRzW2tdO3JldHVybiBiLnByb3RvdHlwZVtlXS5hcHBseShkLGcpfTt9dmFyIGlhPXR5cGVvZiBBc3luY0NvbnRleHQhPT1cInVuZGVmaW5lZFwiJiZ0eXBlb2YgQXN5bmNDb250ZXh0LlNuYXBzaG90PT09XCJmdW5jdGlvblwiP2E9PmEmJkFzeW5jQ29udGV4dC5TbmFwc2hvdC53cmFwKGEpOmE9PmE7ZnVuY3Rpb24gamEoYSl7Y29uc3QgYj1hLmxlbmd0aDtpZihiPjApe2NvbnN0IGM9QXJyYXkoYik7Zm9yKGxldCBkPTA7ZDxiO2QrKyljW2RdPWFbZF07cmV0dXJuIGN9cmV0dXJuIFtdfWZ1bmN0aW9uIGthKGEsYil7Zm9yKGxldCBkPTE7ZDxhcmd1bWVudHMubGVuZ3RoO2QrKyl7Y29uc3QgZT1hcmd1bWVudHNbZF07dmFyIGM9dHlwZW9mIGU7Yz1jIT1cIm9iamVjdFwiP2M6ZT9BcnJheS5pc0FycmF5KGUpP1wiYXJyYXlcIjpjOlwibnVsbFwiO2lmKGM9PVwiYXJyYXlcInx8Yz09XCJvYmplY3RcIiYmdHlwZW9mIGUubGVuZ3RoPT1cIm51bWJlclwiKXtjPWEubGVuZ3RofHwwO2NvbnN0IGY9ZS5sZW5ndGh8fDA7YS5sZW5ndGg9YytmO2ZvcihsZXQgZz0wO2c8ZjtnKyspYVtjK2ddPWVbZ107fWVsc2UgYS5wdXNoKGUpO319Y2xhc3MgbGF7Y29uc3RydWN0b3IoYSxiKXt0aGlzLmk9YTt0aGlzLmo9Yjt0aGlzLmg9MDt0aGlzLmc9bnVsbDt9Z2V0KCl7bGV0IGE7dGhpcy5oPjA/KHRoaXMuaC0tLGE9dGhpcy5nLHRoaXMuZz1hLm5leHQsYS5uZXh0PW51bGwpOmE9dGhpcy5pKCk7cmV0dXJuIGF9fWZ1bmN0aW9uIG1hKGEpe2wuc2V0VGltZW91dCgoKT0+e3Rocm93IGE7fSwwKTt9ZnVuY3Rpb24gbmEoKXt2YXIgYT1vYTtsZXQgYj1udWxsO2EuZyYmKGI9YS5nLGEuZz1hLmcubmV4dCxhLmd8fChhLmg9bnVsbCksYi5uZXh0PW51bGwpO3JldHVybiBifWNsYXNzIHBhe2NvbnN0cnVjdG9yKCl7dGhpcy5oPXRoaXMuZz1udWxsO31hZGQoYSxiKXtjb25zdCBjPXFhLmdldCgpO2Muc2V0KGEsYik7dGhpcy5oP3RoaXMuaC5uZXh0PWM6dGhpcy5nPWM7dGhpcy5oPWM7fX12YXIgcWE9bmV3IGxhKCgpPT5uZXcgcmEsYT0+YS5yZXNldCgpKTtjbGFzcyByYXtjb25zdHJ1Y3Rvcigpe3RoaXMubmV4dD10aGlzLmc9dGhpcy5oPW51bGw7fXNldChhLGIpe3RoaXMuaD1hO3RoaXMuZz1iO3RoaXMubmV4dD1udWxsO31yZXNldCgpe3RoaXMubmV4dD10aGlzLmc9dGhpcy5oPW51bGw7fX1sZXQgdSx2PSExLG9hPW5ldyBwYSx0YT0oKT0+e2NvbnN0IGE9UHJvbWlzZS5yZXNvbHZlKHZvaWQgMCk7dT0oKT0+e2EudGhlbihzYSk7fTt9O2Z1bmN0aW9uIHNhKCl7Zm9yKHZhciBhO2E9bmEoKTspe3RyeXthLmguY2FsbChhLmcpO31jYXRjaChjKXttYShjKTt9dmFyIGI9cWE7Yi5qKGEpO2IuaDwxMDAmJihiLmgrKyxhLm5leHQ9Yi5nLGIuZz1hKTt9dj0hMTt9ZnVuY3Rpb24gdygpe3RoaXMudT10aGlzLnU7dGhpcy5DPXRoaXMuQzt9dy5wcm90b3R5cGUudT0hMTt3LnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7dGhpcy51fHwodGhpcy51PSEwLHRoaXMuTigpKTt9O3cucHJvdG90eXBlW1N5bWJvbC5kaXNwb3NlXT1mdW5jdGlvbigpe3RoaXMuZGlzcG9zZSgpO307dy5wcm90b3R5cGUuTj1mdW5jdGlvbigpe2lmKHRoaXMuQylmb3IoO3RoaXMuQy5sZW5ndGg7KXRoaXMuQy5zaGlmdCgpKCk7fTtmdW5jdGlvbiB4KGEsYil7dGhpcy50eXBlPWE7dGhpcy5nPXRoaXMudGFyZ2V0PWI7dGhpcy5kZWZhdWx0UHJldmVudGVkPSExO314LnByb3RvdHlwZS5oPWZ1bmN0aW9uKCl7dGhpcy5kZWZhdWx0UHJldmVudGVkPSEwO307dmFyIHVhPWZ1bmN0aW9uKCl7aWYoIWwuYWRkRXZlbnRMaXN0ZW5lcnx8IU9iamVjdC5kZWZpbmVQcm9wZXJ0eSlyZXR1cm4gITE7dmFyIGE9ITEsYj1PYmplY3QuZGVmaW5lUHJvcGVydHkoe30sXCJwYXNzaXZlXCIse2dldDpmdW5jdGlvbigpe2E9ITA7fX0pO3RyeXtjb25zdCBjPSgpPT57fTtsLmFkZEV2ZW50TGlzdGVuZXIoXCJ0ZXN0XCIsYyxiKTtsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0ZXN0XCIsYyxiKTt9Y2F0Y2goYyl7fXJldHVybiBhfSgpO2Z1bmN0aW9uIHkoYSl7cmV0dXJuIC9eW1xcc1xceGEwXSokLy50ZXN0KGEpfWZ1bmN0aW9uIHooYSxiKXt4LmNhbGwodGhpcyxhP2EudHlwZTpcIlwiKTt0aGlzLnJlbGF0ZWRUYXJnZXQ9dGhpcy5nPXRoaXMudGFyZ2V0PW51bGw7dGhpcy5idXR0b249dGhpcy5zY3JlZW5ZPXRoaXMuc2NyZWVuWD10aGlzLmNsaWVudFk9dGhpcy5jbGllbnRYPTA7dGhpcy5rZXk9XCJcIjt0aGlzLm1ldGFLZXk9dGhpcy5zaGlmdEtleT10aGlzLmFsdEtleT10aGlzLmN0cmxLZXk9ITE7dGhpcy5zdGF0ZT1udWxsO3RoaXMucG9pbnRlcklkPTA7dGhpcy5wb2ludGVyVHlwZT1cIlwiO3RoaXMuaT1udWxsO2EmJnRoaXMuaW5pdChhLGIpO310KHoseCk7XG56LnByb3RvdHlwZS5pbml0PWZ1bmN0aW9uKGEsYil7Y29uc3QgYz10aGlzLnR5cGU9YS50eXBlLGQ9YS5jaGFuZ2VkVG91Y2hlcyYmYS5jaGFuZ2VkVG91Y2hlcy5sZW5ndGg/YS5jaGFuZ2VkVG91Y2hlc1swXTpudWxsO3RoaXMudGFyZ2V0PWEudGFyZ2V0fHxhLnNyY0VsZW1lbnQ7dGhpcy5nPWI7Yj1hLnJlbGF0ZWRUYXJnZXQ7Ynx8KGM9PVwibW91c2VvdmVyXCI/Yj1hLmZyb21FbGVtZW50OmM9PVwibW91c2VvdXRcIiYmKGI9YS50b0VsZW1lbnQpKTt0aGlzLnJlbGF0ZWRUYXJnZXQ9YjtkPyh0aGlzLmNsaWVudFg9ZC5jbGllbnRYIT09dm9pZCAwP2QuY2xpZW50WDpkLnBhZ2VYLHRoaXMuY2xpZW50WT1kLmNsaWVudFkhPT12b2lkIDA/ZC5jbGllbnRZOmQucGFnZVksdGhpcy5zY3JlZW5YPWQuc2NyZWVuWHx8MCx0aGlzLnNjcmVlblk9ZC5zY3JlZW5ZfHwwKToodGhpcy5jbGllbnRYPWEuY2xpZW50WCE9PXZvaWQgMD9hLmNsaWVudFg6YS5wYWdlWCx0aGlzLmNsaWVudFk9YS5jbGllbnRZIT09XG52b2lkIDA/YS5jbGllbnRZOmEucGFnZVksdGhpcy5zY3JlZW5YPWEuc2NyZWVuWHx8MCx0aGlzLnNjcmVlblk9YS5zY3JlZW5ZfHwwKTt0aGlzLmJ1dHRvbj1hLmJ1dHRvbjt0aGlzLmtleT1hLmtleXx8XCJcIjt0aGlzLmN0cmxLZXk9YS5jdHJsS2V5O3RoaXMuYWx0S2V5PWEuYWx0S2V5O3RoaXMuc2hpZnRLZXk9YS5zaGlmdEtleTt0aGlzLm1ldGFLZXk9YS5tZXRhS2V5O3RoaXMucG9pbnRlcklkPWEucG9pbnRlcklkfHwwO3RoaXMucG9pbnRlclR5cGU9YS5wb2ludGVyVHlwZTt0aGlzLnN0YXRlPWEuc3RhdGU7dGhpcy5pPWE7YS5kZWZhdWx0UHJldmVudGVkJiZ6LlouaC5jYWxsKHRoaXMpO307ei5wcm90b3R5cGUuaD1mdW5jdGlvbigpe3ouWi5oLmNhbGwodGhpcyk7Y29uc3QgYT10aGlzLmk7YS5wcmV2ZW50RGVmYXVsdD9hLnByZXZlbnREZWZhdWx0KCk6YS5yZXR1cm5WYWx1ZT0hMTt9O3ZhciBCPVwiY2xvc3VyZV9saXN0ZW5hYmxlX1wiKyhNYXRoLnJhbmRvbSgpKjFFNnwwKTt2YXIgdmE9MDtmdW5jdGlvbiB3YShhLGIsYyxkLGUpe3RoaXMubGlzdGVuZXI9YTt0aGlzLnByb3h5PW51bGw7dGhpcy5zcmM9Yjt0aGlzLnR5cGU9Yzt0aGlzLmNhcHR1cmU9ISFkO3RoaXMuaGE9ZTt0aGlzLmtleT0rK3ZhO3RoaXMuZGE9dGhpcy5mYT0hMTt9ZnVuY3Rpb24geGEoYSl7YS5kYT0hMDthLmxpc3RlbmVyPW51bGw7YS5wcm94eT1udWxsO2Euc3JjPW51bGw7YS5oYT1udWxsO31mdW5jdGlvbiB5YShhLGIsYyl7Zm9yKGNvbnN0IGQgaW4gYSliLmNhbGwoYyxhW2RdLGQsYSk7fWZ1bmN0aW9uIEFhKGEsYil7Zm9yKGNvbnN0IGMgaW4gYSliLmNhbGwodm9pZCAwLGFbY10sYyxhKTt9ZnVuY3Rpb24gQmEoYSl7Y29uc3QgYj17fTtmb3IoY29uc3QgYyBpbiBhKWJbY109YVtjXTtyZXR1cm4gYn1jb25zdCBDYT1cImNvbnN0cnVjdG9yIGhhc093blByb3BlcnR5IGlzUHJvdG90eXBlT2YgcHJvcGVydHlJc0VudW1lcmFibGUgdG9Mb2NhbGVTdHJpbmcgdG9TdHJpbmcgdmFsdWVPZlwiLnNwbGl0KFwiIFwiKTtmdW5jdGlvbiBEYShhLGIpe2xldCBjLGQ7Zm9yKGxldCBlPTE7ZTxhcmd1bWVudHMubGVuZ3RoO2UrKyl7ZD1hcmd1bWVudHNbZV07Zm9yKGMgaW4gZClhW2NdPWRbY107Zm9yKGxldCBmPTA7ZjxDYS5sZW5ndGg7ZisrKWM9Q2FbZl0sT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGQsYykmJihhW2NdPWRbY10pO319ZnVuY3Rpb24gRWEoYSl7dGhpcy5zcmM9YTt0aGlzLmc9e307dGhpcy5oPTA7fUVhLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oYSxiLGMsZCxlKXtjb25zdCBmPWEudG9TdHJpbmcoKTthPXRoaXMuZ1tmXTthfHwoYT10aGlzLmdbZl09W10sdGhpcy5oKyspO2NvbnN0IGc9RmEoYSxiLGQsZSk7Zz4tMT8oYj1hW2ddLGN8fChiLmZhPSExKSk6KGI9bmV3IHdhKGIsdGhpcy5zcmMsZiwhIWQsZSksYi5mYT1jLGEucHVzaChiKSk7cmV0dXJuIGJ9O2Z1bmN0aW9uIEdhKGEsYil7Y29uc3QgYz1iLnR5cGU7aWYoYyBpbiBhLmcpe3ZhciBkPWEuZ1tjXSxlPUFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoZCxiLHZvaWQgMCksZjsoZj1lPj0wKSYmQXJyYXkucHJvdG90eXBlLnNwbGljZS5jYWxsKGQsZSwxKTtmJiYoeGEoYiksYS5nW2NdLmxlbmd0aD09MCYmKGRlbGV0ZSBhLmdbY10sYS5oLS0pKTt9fVxuZnVuY3Rpb24gRmEoYSxiLGMsZCl7Zm9yKGxldCBlPTA7ZTxhLmxlbmd0aDsrK2Upe2NvbnN0IGY9YVtlXTtpZighZi5kYSYmZi5saXN0ZW5lcj09YiYmZi5jYXB0dXJlPT0hIWMmJmYuaGE9PWQpcmV0dXJuIGV9cmV0dXJuIC0xfXZhciBIYT1cImNsb3N1cmVfbG1fXCIrKE1hdGgucmFuZG9tKCkqMUU2fDApLElhPXt9O2Z1bmN0aW9uIEthKGEsYixjLGQsZSl7aWYoZCYmZC5vbmNlKXJldHVybiBMYShhLGIsYyxkLGUpO2lmKEFycmF5LmlzQXJyYXkoYikpe2ZvcihsZXQgZj0wO2Y8Yi5sZW5ndGg7ZisrKUthKGEsYltmXSxjLGQsZSk7cmV0dXJuIG51bGx9Yz1NYShjKTtyZXR1cm4gYSYmYVtCXT9hLkooYixjLG4oZCk/ISFkLmNhcHR1cmU6ISFkLGUpOk5hKGEsYixjLCExLGQsZSl9XG5mdW5jdGlvbiBOYShhLGIsYyxkLGUsZil7aWYoIWIpdGhyb3cgRXJyb3IoXCJJbnZhbGlkIGV2ZW50IHR5cGVcIik7Y29uc3QgZz1uKGUpPyEhZS5jYXB0dXJlOiEhZTtsZXQgaz1PYShhKTtrfHwoYVtIYV09az1uZXcgRWEoYSkpO2M9ay5hZGQoYixjLGQsZyxmKTtpZihjLnByb3h5KXJldHVybiBjO2Q9UGEoKTtjLnByb3h5PWQ7ZC5zcmM9YTtkLmxpc3RlbmVyPWM7aWYoYS5hZGRFdmVudExpc3RlbmVyKXVhfHwoZT1nKSxlPT09dm9pZCAwJiYoZT0hMSksYS5hZGRFdmVudExpc3RlbmVyKGIudG9TdHJpbmcoKSxkLGUpO2Vsc2UgaWYoYS5hdHRhY2hFdmVudClhLmF0dGFjaEV2ZW50KFFhKGIudG9TdHJpbmcoKSksZCk7ZWxzZSBpZihhLmFkZExpc3RlbmVyJiZhLnJlbW92ZUxpc3RlbmVyKWEuYWRkTGlzdGVuZXIoZCk7ZWxzZSB0aHJvdyBFcnJvcihcImFkZEV2ZW50TGlzdGVuZXIgYW5kIGF0dGFjaEV2ZW50IGFyZSB1bmF2YWlsYWJsZS5cIik7cmV0dXJuIGN9XG5mdW5jdGlvbiBQYSgpe2Z1bmN0aW9uIGEoYyl7cmV0dXJuIGIuY2FsbChhLnNyYyxhLmxpc3RlbmVyLGMpfWNvbnN0IGI9UmE7cmV0dXJuIGF9ZnVuY3Rpb24gTGEoYSxiLGMsZCxlKXtpZihBcnJheS5pc0FycmF5KGIpKXtmb3IobGV0IGY9MDtmPGIubGVuZ3RoO2YrKylMYShhLGJbZl0sYyxkLGUpO3JldHVybiBudWxsfWM9TWEoYyk7cmV0dXJuIGEmJmFbQl0/YS5LKGIsYyxuKGQpPyEhZC5jYXB0dXJlOiEhZCxlKTpOYShhLGIsYywhMCxkLGUpfVxuZnVuY3Rpb24gU2EoYSxiLGMsZCxlKXtpZihBcnJheS5pc0FycmF5KGIpKWZvcih2YXIgZj0wO2Y8Yi5sZW5ndGg7ZisrKVNhKGEsYltmXSxjLGQsZSk7ZWxzZSAoZD1uKGQpPyEhZC5jYXB0dXJlOiEhZCxjPU1hKGMpLGEmJmFbQl0pPyhhPWEuaSxmPVN0cmluZyhiKS50b1N0cmluZygpLGYgaW4gYS5nJiYoYj1hLmdbZl0sYz1GYShiLGMsZCxlKSxjPi0xJiYoeGEoYltjXSksQXJyYXkucHJvdG90eXBlLnNwbGljZS5jYWxsKGIsYywxKSxiLmxlbmd0aD09MCYmKGRlbGV0ZSBhLmdbZl0sYS5oLS0pKSkpOmEmJihhPU9hKGEpKSYmKGI9YS5nW2IudG9TdHJpbmcoKV0sYT0tMSxiJiYoYT1GYShiLGMsZCxlKSksKGM9YT4tMT9iW2FdOm51bGwpJiZUYShjKSk7fVxuZnVuY3Rpb24gVGEoYSl7aWYodHlwZW9mIGEhPT1cIm51bWJlclwiJiZhJiYhYS5kYSl7dmFyIGI9YS5zcmM7aWYoYiYmYltCXSlHYShiLmksYSk7ZWxzZSB7dmFyIGM9YS50eXBlLGQ9YS5wcm94eTtiLnJlbW92ZUV2ZW50TGlzdGVuZXI/Yi5yZW1vdmVFdmVudExpc3RlbmVyKGMsZCxhLmNhcHR1cmUpOmIuZGV0YWNoRXZlbnQ/Yi5kZXRhY2hFdmVudChRYShjKSxkKTpiLmFkZExpc3RlbmVyJiZiLnJlbW92ZUxpc3RlbmVyJiZiLnJlbW92ZUxpc3RlbmVyKGQpOyhjPU9hKGIpKT8oR2EoYyxhKSxjLmg9PTAmJihjLnNyYz1udWxsLGJbSGFdPW51bGwpKTp4YShhKTt9fX1mdW5jdGlvbiBRYShhKXtyZXR1cm4gYSBpbiBJYT9JYVthXTpJYVthXT1cIm9uXCIrYX1mdW5jdGlvbiBSYShhLGIpe2lmKGEuZGEpYT0hMDtlbHNlIHtiPW5ldyB6KGIsdGhpcyk7Y29uc3QgYz1hLmxpc3RlbmVyLGQ9YS5oYXx8YS5zcmM7YS5mYSYmVGEoYSk7YT1jLmNhbGwoZCxiKTt9cmV0dXJuIGF9XG5mdW5jdGlvbiBPYShhKXthPWFbSGFdO3JldHVybiBhIGluc3RhbmNlb2YgRWE/YTpudWxsfXZhciBVYT1cIl9fY2xvc3VyZV9ldmVudHNfZm5fXCIrKE1hdGgucmFuZG9tKCkqMUU5Pj4+MCk7ZnVuY3Rpb24gTWEoYSl7aWYodHlwZW9mIGE9PT1cImZ1bmN0aW9uXCIpcmV0dXJuIGE7YVtVYV18fChhW1VhXT1mdW5jdGlvbihiKXtyZXR1cm4gYS5oYW5kbGVFdmVudChiKX0pO3JldHVybiBhW1VhXX1mdW5jdGlvbiBDKCl7dy5jYWxsKHRoaXMpO3RoaXMuaT1uZXcgRWEodGhpcyk7dGhpcy5NPXRoaXM7dGhpcy5HPW51bGw7fXQoQyx3KTtDLnByb3RvdHlwZVtCXT0hMDtDLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyPWZ1bmN0aW9uKGEsYixjLGQpe1NhKHRoaXMsYSxiLGMsZCk7fTtcbmZ1bmN0aW9uIEQoYSxiKXt2YXIgYyxkPWEuRztpZihkKWZvcihjPVtdO2Q7ZD1kLkcpYy5wdXNoKGQpO2E9YS5NO2Q9Yi50eXBlfHxiO2lmKHR5cGVvZiBiPT09XCJzdHJpbmdcIiliPW5ldyB4KGIsYSk7ZWxzZSBpZihiIGluc3RhbmNlb2YgeCliLnRhcmdldD1iLnRhcmdldHx8YTtlbHNlIHt2YXIgZT1iO2I9bmV3IHgoZCxhKTtEYShiLGUpO31lPSEwO2xldCBmLGc7aWYoYylmb3IoZz1jLmxlbmd0aC0xO2c+PTA7Zy0tKWY9Yi5nPWNbZ10sZT1WYShmLGQsITAsYikmJmU7Zj1iLmc9YTtlPVZhKGYsZCwhMCxiKSYmZTtlPVZhKGYsZCwhMSxiKSYmZTtpZihjKWZvcihnPTA7ZzxjLmxlbmd0aDtnKyspZj1iLmc9Y1tnXSxlPVZhKGYsZCwhMSxiKSYmZTt9XG5DLnByb3RvdHlwZS5OPWZ1bmN0aW9uKCl7Qy5aLk4uY2FsbCh0aGlzKTtpZih0aGlzLmkpe3ZhciBhPXRoaXMuaTtmb3IoY29uc3QgYyBpbiBhLmcpe2NvbnN0IGQ9YS5nW2NdO2ZvcihsZXQgZT0wO2U8ZC5sZW5ndGg7ZSsrKXhhKGRbZV0pO2RlbGV0ZSBhLmdbY107YS5oLS07fX10aGlzLkc9bnVsbDt9O0MucHJvdG90eXBlLko9ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHRoaXMuaS5hZGQoU3RyaW5nKGEpLGIsITEsYyxkKX07Qy5wcm90b3R5cGUuSz1mdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gdGhpcy5pLmFkZChTdHJpbmcoYSksYiwhMCxjLGQpfTtcbmZ1bmN0aW9uIFZhKGEsYixjLGQpe2I9YS5pLmdbU3RyaW5nKGIpXTtpZighYilyZXR1cm4gITA7Yj1iLmNvbmNhdCgpO2xldCBlPSEwO2ZvcihsZXQgZj0wO2Y8Yi5sZW5ndGg7KytmKXtjb25zdCBnPWJbZl07aWYoZyYmIWcuZGEmJmcuY2FwdHVyZT09Yyl7Y29uc3Qgaz1nLmxpc3RlbmVyLHE9Zy5oYXx8Zy5zcmM7Zy5mYSYmR2EoYS5pLGcpO2U9ay5jYWxsKHEsZCkhPT0hMSYmZTt9fXJldHVybiBlJiYhZC5kZWZhdWx0UHJldmVudGVkfWZ1bmN0aW9uIFdhKGEsYil7aWYodHlwZW9mIGEhPT1cImZ1bmN0aW9uXCIpaWYoYSYmdHlwZW9mIGEuaGFuZGxlRXZlbnQ9PVwiZnVuY3Rpb25cIilhPXAoYS5oYW5kbGVFdmVudCxhKTtlbHNlIHRocm93IEVycm9yKFwiSW52YWxpZCBsaXN0ZW5lciBhcmd1bWVudFwiKTtyZXR1cm4gTnVtYmVyKGIpPjIxNDc0ODM2NDc/LTE6bC5zZXRUaW1lb3V0KGEsYnx8MCl9ZnVuY3Rpb24gWGEoYSl7YS5nPVdhKCgpPT57YS5nPW51bGw7YS5pJiYoYS5pPSExLFhhKGEpKTt9LGEubCk7Y29uc3QgYj1hLmg7YS5oPW51bGw7YS5tLmFwcGx5KG51bGwsYik7fWNsYXNzIFlhIGV4dGVuZHMgd3tjb25zdHJ1Y3RvcihhLGIpe3N1cGVyKCk7dGhpcy5tPWE7dGhpcy5sPWI7dGhpcy5oPW51bGw7dGhpcy5pPSExO3RoaXMuZz1udWxsO31qKGEpe3RoaXMuaD1hcmd1bWVudHM7dGhpcy5nP3RoaXMuaT0hMDpYYSh0aGlzKTt9Tigpe3N1cGVyLk4oKTt0aGlzLmcmJihsLmNsZWFyVGltZW91dCh0aGlzLmcpLHRoaXMuZz1udWxsLHRoaXMuaT0hMSx0aGlzLmg9bnVsbCk7fX1mdW5jdGlvbiBFKGEpe3cuY2FsbCh0aGlzKTt0aGlzLmg9YTt0aGlzLmc9e307fXQoRSx3KTt2YXIgWmE9W107ZnVuY3Rpb24gJGEoYSl7eWEoYS5nLGZ1bmN0aW9uKGIsYyl7dGhpcy5nLmhhc093blByb3BlcnR5KGMpJiZUYShiKTt9LGEpO2EuZz17fTt9RS5wcm90b3R5cGUuTj1mdW5jdGlvbigpe0UuWi5OLmNhbGwodGhpcyk7JGEodGhpcyk7fTtFLnByb3RvdHlwZS5oYW5kbGVFdmVudD1mdW5jdGlvbigpe3Rocm93IEVycm9yKFwiRXZlbnRIYW5kbGVyLmhhbmRsZUV2ZW50IG5vdCBpbXBsZW1lbnRlZFwiKTt9O3ZhciBhYj1sLkpTT04uc3RyaW5naWZ5O3ZhciBjYj1sLkpTT04ucGFyc2U7dmFyIGRiPWNsYXNze3N0cmluZ2lmeShhKXtyZXR1cm4gbC5KU09OLnN0cmluZ2lmeShhLHZvaWQgMCl9cGFyc2UoYSl7cmV0dXJuIGwuSlNPTi5wYXJzZShhLHZvaWQgMCl9fTtmdW5jdGlvbiBlYigpe31mdW5jdGlvbiBmYigpe312YXIgSD17T1BFTjpcImFcIixoYjpcImJcIixFUlJPUjpcImNcIix0YjpcImRcIn07ZnVuY3Rpb24gZ2IoKXt4LmNhbGwodGhpcyxcImRcIik7fXQoZ2IseCk7ZnVuY3Rpb24gaGIoKXt4LmNhbGwodGhpcyxcImNcIik7fXQoaGIseCk7dmFyIEk9e30saWI9bnVsbDtmdW5jdGlvbiBqYigpe3JldHVybiBpYj1pYnx8bmV3IEN9SS5JYT1cInNlcnZlcnJlYWNoYWJpbGl0eVwiO2Z1bmN0aW9uIGtiKGEpe3guY2FsbCh0aGlzLEkuSWEsYSk7fXQoa2IseCk7ZnVuY3Rpb24gbGIoYSl7Y29uc3QgYj1qYigpO0QoYixuZXcga2IoYikpO31JLlNUQVRfRVZFTlQ9XCJzdGF0ZXZlbnRcIjtmdW5jdGlvbiBtYihhLGIpe3guY2FsbCh0aGlzLEkuU1RBVF9FVkVOVCxhKTt0aGlzLnN0YXQ9Yjt9dChtYix4KTtmdW5jdGlvbiBKKGEpe2NvbnN0IGI9amIoKTtEKGIsbmV3IG1iKGIsYSkpO31JLkphPVwidGltaW5nZXZlbnRcIjtmdW5jdGlvbiBuYihhLGIpe3guY2FsbCh0aGlzLEkuSmEsYSk7dGhpcy5zaXplPWI7fXQobmIseCk7XG5mdW5jdGlvbiBvYihhLGIpe2lmKHR5cGVvZiBhIT09XCJmdW5jdGlvblwiKXRocm93IEVycm9yKFwiRm4gbXVzdCBub3QgYmUgbnVsbCBhbmQgbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO3JldHVybiBsLnNldFRpbWVvdXQoZnVuY3Rpb24oKXthKCk7fSxiKX1mdW5jdGlvbiBwYigpe3RoaXMuZz0hMDt9cGIucHJvdG90eXBlLnVhPWZ1bmN0aW9uKCl7dGhpcy5nPSExO307ZnVuY3Rpb24gcWIoYSxiLGMsZCxlLGYpe2EuaW5mbyhmdW5jdGlvbigpe2lmKGEuZylpZihmKXt2YXIgZz1cIlwiO3ZhciBrPWYuc3BsaXQoXCImXCIpO2ZvcihsZXQgbT0wO208ay5sZW5ndGg7bSsrKXt2YXIgcT1rW21dLnNwbGl0KFwiPVwiKTtpZihxLmxlbmd0aD4xKXtjb25zdCByPXFbMF07cT1xWzFdO2NvbnN0IEE9ci5zcGxpdChcIl9cIik7Zz1BLmxlbmd0aD49MiYmQVsxXT09XCJ0eXBlXCI/ZysocitcIj1cIitxK1wiJlwiKTpnKyhyK1wiPXJlZGFjdGVkJlwiKTt9fX1lbHNlIGc9bnVsbDtlbHNlIGc9ZjtyZXR1cm4gXCJYTUxIVFRQIFJFUSAoXCIrZCtcIikgW2F0dGVtcHQgXCIrZStcIl06IFwiK2IrXCJcXG5cIitjK1wiXFxuXCIrZ30pO31cbmZ1bmN0aW9uIHJiKGEsYixjLGQsZSxmLGcpe2EuaW5mbyhmdW5jdGlvbigpe3JldHVybiBcIlhNTEhUVFAgUkVTUCAoXCIrZCtcIikgWyBhdHRlbXB0IFwiK2UrXCJdOiBcIitiK1wiXFxuXCIrYytcIlxcblwiK2YrXCIgXCIrZ30pO31mdW5jdGlvbiBLKGEsYixjLGQpe2EuaW5mbyhmdW5jdGlvbigpe3JldHVybiBcIlhNTEhUVFAgVEVYVCAoXCIrYitcIik6IFwiK3NiKGEsYykrKGQ/XCIgXCIrZDpcIlwiKX0pO31mdW5jdGlvbiB0YihhLGIpe2EuaW5mbyhmdW5jdGlvbigpe3JldHVybiBcIlRJTUVPVVQ6IFwiK2J9KTt9cGIucHJvdG90eXBlLmluZm89ZnVuY3Rpb24oKXt9O1xuZnVuY3Rpb24gc2IoYSxiKXtpZighYS5nKXJldHVybiBiO2lmKCFiKXJldHVybiBudWxsO3RyeXtjb25zdCBmPUpTT04ucGFyc2UoYik7aWYoZilmb3IoYT0wO2E8Zi5sZW5ndGg7YSsrKWlmKEFycmF5LmlzQXJyYXkoZlthXSkpe3ZhciBjPWZbYV07aWYoIShjLmxlbmd0aDwyKSl7dmFyIGQ9Y1sxXTtpZihBcnJheS5pc0FycmF5KGQpJiYhKGQubGVuZ3RoPDEpKXt2YXIgZT1kWzBdO2lmKGUhPVwibm9vcFwiJiZlIT1cInN0b3BcIiYmZSE9XCJjbG9zZVwiKWZvcihsZXQgZz0xO2c8ZC5sZW5ndGg7ZysrKWRbZ109XCJcIjt9fX1yZXR1cm4gYWIoZil9Y2F0Y2goZil7cmV0dXJuIGJ9fXZhciB1Yj17Tk9fRVJST1I6MCxjYjoxLHFiOjIscGI6MyxrYjo0LG9iOjUscmI6NixHYTo3LFRJTUVPVVQ6OCx1Yjo5fTt2YXIgdmI9e2liOlwiY29tcGxldGVcIixGYjpcInN1Y2Nlc3NcIixFUlJPUjpcImVycm9yXCIsR2E6XCJhYm9ydFwiLHhiOlwicmVhZHlcIix5YjpcInJlYWR5c3RhdGVjaGFuZ2VcIixUSU1FT1VUOlwidGltZW91dFwiLHNiOlwiaW5jcmVtZW50YWxkYXRhXCIsd2I6XCJwcm9ncmVzc1wiLGxiOlwiZG93bmxvYWRwcm9ncmVzc1wiLE5iOlwidXBsb2FkcHJvZ3Jlc3NcIn07dmFyIHdiO2Z1bmN0aW9uIHhiKCl7fXQoeGIsZWIpO3hiLnByb3RvdHlwZS5nPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBYTUxIdHRwUmVxdWVzdH07d2I9bmV3IHhiO2Z1bmN0aW9uIEwoYSl7cmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChTdHJpbmcoYSkpfWZ1bmN0aW9uIHliKGEpe3ZhciBiPTE7YT1hLnNwbGl0KFwiOlwiKTtjb25zdCBjPVtdO2Zvcig7Yj4wJiZhLmxlbmd0aDspYy5wdXNoKGEuc2hpZnQoKSksYi0tO2EubGVuZ3RoJiZjLnB1c2goYS5qb2luKFwiOlwiKSk7cmV0dXJuIGN9ZnVuY3Rpb24gTihhLGIsYyxkKXt0aGlzLmo9YTt0aGlzLmk9Yjt0aGlzLmw9Yzt0aGlzLlM9ZHx8MTt0aGlzLlY9bmV3IEUodGhpcyk7dGhpcy5IPTQ1RTM7dGhpcy5KPW51bGw7dGhpcy5vPSExO3RoaXMudT10aGlzLkI9dGhpcy5BPXRoaXMuTT10aGlzLkY9dGhpcy5UPXRoaXMuRD1udWxsO3RoaXMuRz1bXTt0aGlzLmc9bnVsbDt0aGlzLkM9MDt0aGlzLm09dGhpcy52PW51bGw7dGhpcy5YPS0xO3RoaXMuSz0hMTt0aGlzLlA9MDt0aGlzLk89bnVsbDt0aGlzLlc9dGhpcy5MPXRoaXMuVT10aGlzLlI9ITE7dGhpcy5oPW5ldyB6Yjt9ZnVuY3Rpb24gemIoKXt0aGlzLmk9bnVsbDt0aGlzLmc9XCJcIjt0aGlzLmg9ITE7fXZhciBBYj17fSxCYj17fTtmdW5jdGlvbiBDYihhLGIsYyl7YS5NPTE7YS5BPURiKE8oYikpO2EudT1jO2EuUj0hMDtFYihhLG51bGwpO31cbmZ1bmN0aW9uIEViKGEsYil7YS5GPURhdGUubm93KCk7RmIoYSk7YS5CPU8oYS5BKTt2YXIgYz1hLkIsZD1hLlM7QXJyYXkuaXNBcnJheShkKXx8KGQ9W1N0cmluZyhkKV0pO0diKGMuaSxcInRcIixkKTthLkM9MDtjPWEuai5MO2EuaD1uZXcgemI7YS5nPUhiKGEuaixjP2I6bnVsbCwhYS51KTthLlA+MCYmKGEuTz1uZXcgWWEocChhLlksYSxhLmcpLGEuUCkpO2I9YS5WO2M9YS5nO2Q9YS5iYTt2YXIgZT1cInJlYWR5c3RhdGVjaGFuZ2VcIjtBcnJheS5pc0FycmF5KGUpfHwoZSYmKFphWzBdPWUudG9TdHJpbmcoKSksZT1aYSk7Zm9yKGxldCBmPTA7ZjxlLmxlbmd0aDtmKyspe2NvbnN0IGc9S2EoYyxlW2ZdLGR8fGIuaGFuZGxlRXZlbnQsITEsYi5ofHxiKTtpZighZylicmVhaztiLmdbZy5rZXldPWc7fWI9YS5KP0JhKGEuSik6e307YS51PyhhLnZ8fChhLnY9XCJQT1NUXCIpLGJbXCJDb250ZW50LVR5cGVcIl09XCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIixhLmcuZWEoYS5CLGEudixcbmEudSxiKSk6KGEudj1cIkdFVFwiLGEuZy5lYShhLkIsYS52LG51bGwsYikpO2xiKCk7cWIoYS5pLGEudixhLkIsYS5sLGEuUyxhLnUpO31OLnByb3RvdHlwZS5iYT1mdW5jdGlvbihhKXthPWEudGFyZ2V0O2NvbnN0IGI9dGhpcy5PO2ImJlAoYSk9PTM/Yi5qKCk6dGhpcy5ZKGEpO307XG5OLnByb3RvdHlwZS5ZPWZ1bmN0aW9uKGEpe3RyeXtpZihhPT10aGlzLmcpYTp7Y29uc3Qgaz1QKHRoaXMuZykscT10aGlzLmcueWEoKSxtPXRoaXMuZy5jYSgpO2lmKCEoazwzKSYmKGshPTN8fHRoaXMuZyYmKHRoaXMuaC5ofHx0aGlzLmcubGEoKXx8SWIodGhpcy5nKSkpKXt0aGlzLkt8fGshPTR8fHE9PTd8fChxPT04fHxtPD0wP2xiKDMpOmxiKDIpKTtKYih0aGlzKTt2YXIgYj10aGlzLmcuY2EoKTt0aGlzLlg9Yjt2YXIgYz1LYih0aGlzKTt0aGlzLm89Yj09MjAwO3JiKHRoaXMuaSx0aGlzLnYsdGhpcy5CLHRoaXMubCx0aGlzLlMsayxiKTtpZih0aGlzLm8pe2lmKHRoaXMuVSYmIXRoaXMuTCl7Yjp7aWYodGhpcy5nKXt2YXIgZCxlPXRoaXMuZztpZigoZD1lLmc/ZS5nLmdldFJlc3BvbnNlSGVhZGVyKFwiWC1IVFRQLUluaXRpYWwtUmVzcG9uc2VcIik6bnVsbCkmJiF5KGQpKXt2YXIgZj1kO2JyZWFrIGJ9fWY9bnVsbDt9aWYoYT1mKUsodGhpcy5pLHRoaXMubCxhLFwiSW5pdGlhbCBoYW5kc2hha2UgcmVzcG9uc2UgdmlhIFgtSFRUUC1Jbml0aWFsLVJlc3BvbnNlXCIpLFxudGhpcy5MPSEwLExiKHRoaXMsYSk7ZWxzZSB7dGhpcy5vPSExO3RoaXMubT0zO0ooMTIpO1EodGhpcyk7TWIodGhpcyk7YnJlYWsgYX19aWYodGhpcy5SKXthPSEwO2xldCByO2Zvcig7IXRoaXMuSyYmdGhpcy5DPGMubGVuZ3RoOylpZihyPU5iKHRoaXMsYykscj09QmIpe2s9PTQmJih0aGlzLm09NCxKKDE0KSxhPSExKTtLKHRoaXMuaSx0aGlzLmwsbnVsbCxcIltJbmNvbXBsZXRlIFJlc3BvbnNlXVwiKTticmVha31lbHNlIGlmKHI9PUFiKXt0aGlzLm09NDtKKDE1KTtLKHRoaXMuaSx0aGlzLmwsYyxcIltJbnZhbGlkIENodW5rXVwiKTthPSExO2JyZWFrfWVsc2UgSyh0aGlzLmksdGhpcy5sLHIsbnVsbCksTGIodGhpcyxyKTtPYih0aGlzKSYmdGhpcy5DIT0wJiYodGhpcy5oLmc9dGhpcy5oLmcuc2xpY2UodGhpcy5DKSx0aGlzLkM9MCk7ayE9NHx8Yy5sZW5ndGghPTB8fHRoaXMuaC5ofHwodGhpcy5tPTEsSigxNiksYT0hMSk7dGhpcy5vPXRoaXMubyYmYTtpZighYSlLKHRoaXMuaSx0aGlzLmwsXG5jLFwiW0ludmFsaWQgQ2h1bmtlZCBSZXNwb25zZV1cIiksUSh0aGlzKSxNYih0aGlzKTtlbHNlIGlmKGMubGVuZ3RoPjAmJiF0aGlzLlcpe3RoaXMuVz0hMDt2YXIgZz10aGlzLmo7Zy5nPT10aGlzJiZnLmFhJiYhZy5QJiYoZy5qLmluZm8oXCJHcmVhdCwgbm8gYnVmZmVyaW5nIHByb3h5IGRldGVjdGVkLiBCeXRlcyByZWNlaXZlZDogXCIrYy5sZW5ndGgpLFBiKGcpLGcuUD0hMCxKKDExKSk7fX1lbHNlIEsodGhpcy5pLHRoaXMubCxjLG51bGwpLExiKHRoaXMsYyk7az09NCYmUSh0aGlzKTt0aGlzLm8mJiF0aGlzLksmJihrPT00P1FiKHRoaXMuaix0aGlzKToodGhpcy5vPSExLEZiKHRoaXMpKSk7fWVsc2UgUmIodGhpcy5nKSxiPT00MDAmJmMuaW5kZXhPZihcIlVua25vd24gU0lEXCIpPjA/KHRoaXMubT0zLEooMTIpKToodGhpcy5tPTAsSigxMykpLFEodGhpcyksTWIodGhpcyk7fX19Y2F0Y2goayl7fWZpbmFsbHl7fX07XG5mdW5jdGlvbiBLYihhKXtpZighT2IoYSkpcmV0dXJuIGEuZy5sYSgpO2NvbnN0IGI9SWIoYS5nKTtpZihiPT09XCJcIilyZXR1cm4gXCJcIjtsZXQgYz1cIlwiO2NvbnN0IGQ9Yi5sZW5ndGgsZT1QKGEuZyk9PTQ7aWYoIWEuaC5pKXtpZih0eXBlb2YgVGV4dERlY29kZXI9PT1cInVuZGVmaW5lZFwiKXJldHVybiBRKGEpLE1iKGEpLFwiXCI7YS5oLmk9bmV3IGwuVGV4dERlY29kZXI7fWZvcihsZXQgZj0wO2Y8ZDtmKyspYS5oLmg9ITAsYys9YS5oLmkuZGVjb2RlKGJbZl0se3N0cmVhbTohKGUmJmY9PWQtMSl9KTtiLmxlbmd0aD0wO2EuaC5nKz1jO2EuQz0wO3JldHVybiBhLmguZ31mdW5jdGlvbiBPYihhKXtyZXR1cm4gYS5nP2Eudj09XCJHRVRcIiYmYS5NIT0yJiZhLmouQWE6ITF9XG5mdW5jdGlvbiBOYihhLGIpe3ZhciBjPWEuQyxkPWIuaW5kZXhPZihcIlxcblwiLGMpO2lmKGQ9PS0xKXJldHVybiBCYjtjPU51bWJlcihiLnN1YnN0cmluZyhjLGQpKTtpZihpc05hTihjKSlyZXR1cm4gQWI7ZCs9MTtpZihkK2M+Yi5sZW5ndGgpcmV0dXJuIEJiO2I9Yi5zbGljZShkLGQrYyk7YS5DPWQrYztyZXR1cm4gYn1OLnByb3RvdHlwZS5jYW5jZWw9ZnVuY3Rpb24oKXt0aGlzLks9ITA7USh0aGlzKTt9O2Z1bmN0aW9uIEZiKGEpe2EuVD1EYXRlLm5vdygpK2EuSDtTYihhLGEuSCk7fWZ1bmN0aW9uIFNiKGEsYil7aWYoYS5EIT1udWxsKXRocm93IEVycm9yKFwiV2F0Y2hEb2cgdGltZXIgbm90IG51bGxcIik7YS5EPW9iKHAoYS5hYSxhKSxiKTt9ZnVuY3Rpb24gSmIoYSl7YS5EJiYobC5jbGVhclRpbWVvdXQoYS5EKSxhLkQ9bnVsbCk7fVxuTi5wcm90b3R5cGUuYWE9ZnVuY3Rpb24oKXt0aGlzLkQ9bnVsbDtjb25zdCBhPURhdGUubm93KCk7YS10aGlzLlQ+PTA/KHRiKHRoaXMuaSx0aGlzLkIpLHRoaXMuTSE9MiYmKGxiKCksSigxNykpLFEodGhpcyksdGhpcy5tPTIsTWIodGhpcykpOlNiKHRoaXMsdGhpcy5ULWEpO307ZnVuY3Rpb24gTWIoYSl7YS5qLkk9PTB8fGEuS3x8UWIoYS5qLGEpO31mdW5jdGlvbiBRKGEpe0piKGEpO3ZhciBiPWEuTztiJiZ0eXBlb2YgYi5kaXNwb3NlPT1cImZ1bmN0aW9uXCImJmIuZGlzcG9zZSgpO2EuTz1udWxsOyRhKGEuVik7YS5nJiYoYj1hLmcsYS5nPW51bGwsYi5hYm9ydCgpLGIuZGlzcG9zZSgpKTt9XG5mdW5jdGlvbiBMYihhLGIpe3RyeXt2YXIgYz1hLmo7aWYoYy5JIT0wJiYoYy5nPT1hfHxUYihjLmgsYSkpKWlmKCFhLkwmJlRiKGMuaCxhKSYmYy5JPT0zKXt0cnl7dmFyIGQ9Yy5CYS5nLnBhcnNlKGIpO31jYXRjaChtKXtkPW51bGw7fWlmKEFycmF5LmlzQXJyYXkoZCkmJmQubGVuZ3RoPT0zKXt2YXIgZT1kO2lmKGVbMF09PTApYTp7aWYoIWMudil7aWYoYy5nKWlmKGMuZy5GKzNFMzxhLkYpVWIoYyksVmIoYyk7ZWxzZSBicmVhayBhO1diKGMpO0ooMTgpO319ZWxzZSBjLnhhPWVbMV0sMDxjLnhhLWMuSyYmZVsyXTwzNzUwMCYmYy5GJiZjLkE9PTAmJiFjLkMmJihjLkM9b2IocChjLlZhLGMpLDZFMykpO1hiKGMuaCk8PTEmJmMudGEmJihjLnRhPXZvaWQgMCk7fWVsc2UgUihjLDExKTt9ZWxzZSBpZigoYS5MfHxjLmc9PWEpJiZVYihjKSwheShiKSlmb3IoZT1jLkJhLmcucGFyc2UoYiksYj0wO2I8ZS5sZW5ndGg7YisrKXtsZXQgbT1lW2JdO2NvbnN0IHI9bVswXTtpZighKHI8PWMuSykpaWYoYy5LPVxucixtPW1bMV0sYy5JPT0yKWlmKG1bMF09PVwiY1wiKXtjLk09bVsxXTtjLmJhPW1bMl07Y29uc3QgQT1tWzNdO0EhPW51bGwmJihjLmthPUEsYy5qLmluZm8oXCJWRVI9XCIrYy5rYSkpO2NvbnN0IE09bVs0XTtNIT1udWxsJiYoYy56YT1NLGMuai5pbmZvKFwiU1ZFUj1cIitjLnphKSk7Y29uc3QgRj1tWzVdO0YhPW51bGwmJnR5cGVvZiBGPT09XCJudW1iZXJcIiYmRj4wJiYoZD0xLjUqRixjLk89ZCxjLmouaW5mbyhcImJhY2tDaGFubmVsUmVxdWVzdFRpbWVvdXRNc189XCIrZCkpO2Q9Yztjb25zdCBHPWEuZztpZihHKXtjb25zdCB6YT1HLmc/Ry5nLmdldFJlc3BvbnNlSGVhZGVyKFwiWC1DbGllbnQtV2lyZS1Qcm90b2NvbFwiKTpudWxsO2lmKHphKXt2YXIgZj1kLmg7Zi5nfHx6YS5pbmRleE9mKFwic3BkeVwiKT09LTEmJnphLmluZGV4T2YoXCJxdWljXCIpPT0tMSYmemEuaW5kZXhPZihcImgyXCIpPT0tMXx8KGYuaj1mLmwsZi5nPW5ldyBTZXQsZi5oJiYoWWIoZixmLmgpLGYuaD1udWxsKSk7fWlmKGQuRyl7Y29uc3QgYmI9XG5HLmc/Ry5nLmdldFJlc3BvbnNlSGVhZGVyKFwiWC1IVFRQLVNlc3Npb24tSWRcIik6bnVsbDtiYiYmKGQud2E9YmIsUyhkLkosZC5HLGJiKSk7fX1jLkk9MztjLmwmJmMubC5yYSgpO2MuYWEmJihjLlQ9RGF0ZS5ub3coKS1hLkYsYy5qLmluZm8oXCJIYW5kc2hha2UgUlRUOiBcIitjLlQrXCJtc1wiKSk7ZD1jO3ZhciBnPWE7ZC5uYT1aYihkLGQuTD9kLmJhOm51bGwsZC5XKTtpZihnLkwpeyRiKGQuaCxnKTt2YXIgaz1nLHE9ZC5PO3EmJihrLkg9cSk7ay5EJiYoSmIoayksRmIoaykpO2QuZz1nO31lbHNlIGFjKGQpO2MuaS5sZW5ndGg+MCYmYmMoYyk7fWVsc2UgbVswXSE9XCJzdG9wXCImJm1bMF0hPVwiY2xvc2VcInx8UihjLDcpO2Vsc2UgYy5JPT0zJiYobVswXT09XCJzdG9wXCJ8fG1bMF09PVwiY2xvc2VcIj9tWzBdPT1cInN0b3BcIj9SKGMsNyk6Y2MoYyk6bVswXSE9XCJub29wXCImJmMubCYmYy5sLnFhKG0pLGMuQT0wKTt9bGIoNCk7fWNhdGNoKG0pe319dmFyIGRjPWNsYXNze2NvbnN0cnVjdG9yKGEsYil7dGhpcy5nPWE7dGhpcy5tYXA9Yjt9fTtmdW5jdGlvbiBlYyhhKXt0aGlzLmw9YXx8MTA7bC5QZXJmb3JtYW5jZU5hdmlnYXRpb25UaW1pbmc/KGE9bC5wZXJmb3JtYW5jZS5nZXRFbnRyaWVzQnlUeXBlKFwibmF2aWdhdGlvblwiKSxhPWEubGVuZ3RoPjAmJihhWzBdLm5leHRIb3BQcm90b2NvbD09XCJocVwifHxhWzBdLm5leHRIb3BQcm90b2NvbD09XCJoMlwiKSk6YT0hIShsLmNocm9tZSYmbC5jaHJvbWUubG9hZFRpbWVzJiZsLmNocm9tZS5sb2FkVGltZXMoKSYmbC5jaHJvbWUubG9hZFRpbWVzKCkud2FzRmV0Y2hlZFZpYVNwZHkpO3RoaXMuaj1hP3RoaXMubDoxO3RoaXMuZz1udWxsO3RoaXMuaj4xJiYodGhpcy5nPW5ldyBTZXQpO3RoaXMuaD1udWxsO3RoaXMuaT1bXTt9ZnVuY3Rpb24gZmMoYSl7cmV0dXJuIGEuaD8hMDphLmc/YS5nLnNpemU+PWEuajohMX1mdW5jdGlvbiBYYihhKXtyZXR1cm4gYS5oPzE6YS5nP2EuZy5zaXplOjB9ZnVuY3Rpb24gVGIoYSxiKXtyZXR1cm4gYS5oP2EuaD09YjphLmc/YS5nLmhhcyhiKTohMX1cbmZ1bmN0aW9uIFliKGEsYil7YS5nP2EuZy5hZGQoYik6YS5oPWI7fWZ1bmN0aW9uICRiKGEsYil7YS5oJiZhLmg9PWI/YS5oPW51bGw6YS5nJiZhLmcuaGFzKGIpJiZhLmcuZGVsZXRlKGIpO31lYy5wcm90b3R5cGUuY2FuY2VsPWZ1bmN0aW9uKCl7dGhpcy5pPWhjKHRoaXMpO2lmKHRoaXMuaCl0aGlzLmguY2FuY2VsKCksdGhpcy5oPW51bGw7ZWxzZSBpZih0aGlzLmcmJnRoaXMuZy5zaXplIT09MCl7Zm9yKGNvbnN0IGEgb2YgdGhpcy5nLnZhbHVlcygpKWEuY2FuY2VsKCk7dGhpcy5nLmNsZWFyKCk7fX07ZnVuY3Rpb24gaGMoYSl7aWYoYS5oIT1udWxsKXJldHVybiBhLmkuY29uY2F0KGEuaC5HKTtpZihhLmchPW51bGwmJmEuZy5zaXplIT09MCl7bGV0IGI9YS5pO2Zvcihjb25zdCBjIG9mIGEuZy52YWx1ZXMoKSliPWIuY29uY2F0KGMuRyk7cmV0dXJuIGJ9cmV0dXJuIGphKGEuaSl9dmFyIGljPVJlZ0V4cChcIl4oPzooW146Lz8jLl0rKTopPyg/Oi8vKD86KFteXFxcXFxcXFwvPyNdKilAKT8oW15cXFxcXFxcXC8/I10qPykoPzo6KFswLTldKykpPyg/PVtcXFxcXFxcXC8/I118JCkpPyhbXj8jXSspPyg/OlxcXFw/KFteI10qKSk/KD86IyhbXFxcXHNcXFxcU10qKSk/JFwiKTtmdW5jdGlvbiBqYyhhLGIpe2lmKGEpe2E9YS5zcGxpdChcIiZcIik7Zm9yKGxldCBjPTA7YzxhLmxlbmd0aDtjKyspe2NvbnN0IGQ9YVtjXS5pbmRleE9mKFwiPVwiKTtsZXQgZSxmPW51bGw7ZD49MD8oZT1hW2NdLnN1YnN0cmluZygwLGQpLGY9YVtjXS5zdWJzdHJpbmcoZCsxKSk6ZT1hW2NdO2IoZSxmP2RlY29kZVVSSUNvbXBvbmVudChmLnJlcGxhY2UoL1xcKy9nLFwiIFwiKSk6XCJcIik7fX19ZnVuY3Rpb24gVChhKXt0aGlzLmc9dGhpcy5vPXRoaXMuaj1cIlwiO3RoaXMudT1udWxsO3RoaXMubT10aGlzLmg9XCJcIjt0aGlzLmw9ITE7bGV0IGI7YSBpbnN0YW5jZW9mIFQ/KHRoaXMubD1hLmwsa2ModGhpcyxhLmopLHRoaXMubz1hLm8sdGhpcy5nPWEuZyxsYyh0aGlzLGEudSksdGhpcy5oPWEuaCxtYyh0aGlzLG5jKGEuaSkpLHRoaXMubT1hLm0pOmEmJihiPVN0cmluZyhhKS5tYXRjaChpYykpPyh0aGlzLmw9ITEsa2ModGhpcyxiWzFdfHxcIlwiLCEwKSx0aGlzLm89b2MoYlsyXXx8XCJcIiksdGhpcy5nPW9jKGJbM118fFwiXCIsITApLGxjKHRoaXMsYls0XSksdGhpcy5oPW9jKGJbNV18fFwiXCIsITApLG1jKHRoaXMsYls2XXx8XCJcIiwhMCksdGhpcy5tPW9jKGJbN118fFwiXCIpKToodGhpcy5sPSExLHRoaXMuaT1uZXcgcGMobnVsbCx0aGlzLmwpKTt9XG5ULnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe2NvbnN0IGE9W107dmFyIGI9dGhpcy5qO2ImJmEucHVzaChxYyhiLHJjLCEwKSxcIjpcIik7dmFyIGM9dGhpcy5nO2lmKGN8fGI9PVwiZmlsZVwiKWEucHVzaChcIi8vXCIpLChiPXRoaXMubykmJmEucHVzaChxYyhiLHJjLCEwKSxcIkBcIiksYS5wdXNoKEwoYykucmVwbGFjZSgvJTI1KFswLTlhLWZBLUZdezJ9KS9nLFwiJSQxXCIpKSxjPXRoaXMudSxjIT1udWxsJiZhLnB1c2goXCI6XCIsU3RyaW5nKGMpKTtpZihjPXRoaXMuaCl0aGlzLmcmJmMuY2hhckF0KDApIT1cIi9cIiYmYS5wdXNoKFwiL1wiKSxhLnB1c2gocWMoYyxjLmNoYXJBdCgwKT09XCIvXCI/c2M6dGMsITApKTsoYz10aGlzLmkudG9TdHJpbmcoKSkmJmEucHVzaChcIj9cIixjKTsoYz10aGlzLm0pJiZhLnB1c2goXCIjXCIscWMoYyx1YykpO3JldHVybiBhLmpvaW4oXCJcIil9O1xuVC5wcm90b3R5cGUucmVzb2x2ZT1mdW5jdGlvbihhKXtjb25zdCBiPU8odGhpcyk7bGV0IGM9ISFhLmo7Yz9rYyhiLGEuaik6Yz0hIWEubztjP2Iubz1hLm86Yz0hIWEuZztjP2IuZz1hLmc6Yz1hLnUhPW51bGw7dmFyIGQ9YS5oO2lmKGMpbGMoYixhLnUpO2Vsc2UgaWYoYz0hIWEuaCl7aWYoZC5jaGFyQXQoMCkhPVwiL1wiKWlmKHRoaXMuZyYmIXRoaXMuaClkPVwiL1wiK2Q7ZWxzZSB7dmFyIGU9Yi5oLmxhc3RJbmRleE9mKFwiL1wiKTtlIT0tMSYmKGQ9Yi5oLnNsaWNlKDAsZSsxKStkKTt9ZT1kO2lmKGU9PVwiLi5cInx8ZT09XCIuXCIpZD1cIlwiO2Vsc2UgaWYoZS5pbmRleE9mKFwiLi9cIikhPS0xfHxlLmluZGV4T2YoXCIvLlwiKSE9LTEpe2Q9ZS5sYXN0SW5kZXhPZihcIi9cIiwwKT09MDtlPWUuc3BsaXQoXCIvXCIpO2NvbnN0IGY9W107Zm9yKGxldCBnPTA7ZzxlLmxlbmd0aDspe2NvbnN0IGs9ZVtnKytdO2s9PVwiLlwiP2QmJmc9PWUubGVuZ3RoJiZmLnB1c2goXCJcIik6az09XCIuLlwiPygoZi5sZW5ndGg+MXx8Zi5sZW5ndGg9PVxuMSYmZlswXSE9XCJcIikmJmYucG9wKCksZCYmZz09ZS5sZW5ndGgmJmYucHVzaChcIlwiKSk6KGYucHVzaChrKSxkPSEwKTt9ZD1mLmpvaW4oXCIvXCIpO31lbHNlIGQ9ZTt9Yz9iLmg9ZDpjPWEuaS50b1N0cmluZygpIT09XCJcIjtjP21jKGIsbmMoYS5pKSk6Yz0hIWEubTtjJiYoYi5tPWEubSk7cmV0dXJuIGJ9O2Z1bmN0aW9uIE8oYSl7cmV0dXJuIG5ldyBUKGEpfWZ1bmN0aW9uIGtjKGEsYixjKXthLmo9Yz9vYyhiLCEwKTpiO2EuaiYmKGEuaj1hLmoucmVwbGFjZSgvOiQvLFwiXCIpKTt9ZnVuY3Rpb24gbGMoYSxiKXtpZihiKXtiPU51bWJlcihiKTtpZihpc05hTihiKXx8YjwwKXRocm93IEVycm9yKFwiQmFkIHBvcnQgbnVtYmVyIFwiK2IpO2EudT1iO31lbHNlIGEudT1udWxsO31mdW5jdGlvbiBtYyhhLGIsYyl7YiBpbnN0YW5jZW9mIHBjPyhhLmk9Yix2YyhhLmksYS5sKSk6KGN8fChiPXFjKGIsd2MpKSxhLmk9bmV3IHBjKGIsYS5sKSk7fWZ1bmN0aW9uIFMoYSxiLGMpe2EuaS5zZXQoYixjKTt9XG5mdW5jdGlvbiBEYihhKXtTKGEsXCJ6eFwiLE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSoyMTQ3NDgzNjQ4KS50b1N0cmluZygzNikrTWF0aC5hYnMoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjIxNDc0ODM2NDgpXkRhdGUubm93KCkpLnRvU3RyaW5nKDM2KSk7cmV0dXJuIGF9ZnVuY3Rpb24gb2MoYSxiKXtyZXR1cm4gYT9iP2RlY29kZVVSSShhLnJlcGxhY2UoLyUyNS9nLFwiJTI1MjVcIikpOmRlY29kZVVSSUNvbXBvbmVudChhKTpcIlwifWZ1bmN0aW9uIHFjKGEsYixjKXtyZXR1cm4gdHlwZW9mIGE9PT1cInN0cmluZ1wiPyhhPWVuY29kZVVSSShhKS5yZXBsYWNlKGIseGMpLGMmJihhPWEucmVwbGFjZSgvJTI1KFswLTlhLWZBLUZdezJ9KS9nLFwiJSQxXCIpKSxhKTpudWxsfWZ1bmN0aW9uIHhjKGEpe2E9YS5jaGFyQ29kZUF0KDApO3JldHVybiBcIiVcIisoYT4+NCYxNSkudG9TdHJpbmcoMTYpKyhhJjE1KS50b1N0cmluZygxNil9XG52YXIgcmM9L1sjXFwvXFw/QF0vZyx0Yz0vWyNcXD86XS9nLHNjPS9bI1xcP10vZyx3Yz0vWyNcXD9AXS9nLHVjPS8jL2c7ZnVuY3Rpb24gcGMoYSxiKXt0aGlzLmg9dGhpcy5nPW51bGw7dGhpcy5pPWF8fG51bGw7dGhpcy5qPSEhYjt9ZnVuY3Rpb24gVShhKXthLmd8fChhLmc9bmV3IE1hcCxhLmg9MCxhLmkmJmpjKGEuaSxmdW5jdGlvbihiLGMpe2EuYWRkKGRlY29kZVVSSUNvbXBvbmVudChiLnJlcGxhY2UoL1xcKy9nLFwiIFwiKSksYyk7fSkpO31oPXBjLnByb3RvdHlwZTtoLmFkZD1mdW5jdGlvbihhLGIpe1UodGhpcyk7dGhpcy5pPW51bGw7YT1WKHRoaXMsYSk7bGV0IGM9dGhpcy5nLmdldChhKTtjfHx0aGlzLmcuc2V0KGEsYz1bXSk7Yy5wdXNoKGIpO3RoaXMuaCs9MTtyZXR1cm4gdGhpc307ZnVuY3Rpb24geWMoYSxiKXtVKGEpO2I9VihhLGIpO2EuZy5oYXMoYikmJihhLmk9bnVsbCxhLmgtPWEuZy5nZXQoYikubGVuZ3RoLGEuZy5kZWxldGUoYikpO31cbmZ1bmN0aW9uIHpjKGEsYil7VShhKTtiPVYoYSxiKTtyZXR1cm4gYS5nLmhhcyhiKX1oLmZvckVhY2g9ZnVuY3Rpb24oYSxiKXtVKHRoaXMpO3RoaXMuZy5mb3JFYWNoKGZ1bmN0aW9uKGMsZCl7Yy5mb3JFYWNoKGZ1bmN0aW9uKGUpe2EuY2FsbChiLGUsZCx0aGlzKTt9LHRoaXMpO30sdGhpcyk7fTtmdW5jdGlvbiBBYyhhLGIpe1UoYSk7bGV0IGM9W107aWYodHlwZW9mIGI9PT1cInN0cmluZ1wiKXpjKGEsYikmJihjPWMuY29uY2F0KGEuZy5nZXQoVihhLGIpKSkpO2Vsc2UgZm9yKGE9QXJyYXkuZnJvbShhLmcudmFsdWVzKCkpLGI9MDtiPGEubGVuZ3RoO2IrKyljPWMuY29uY2F0KGFbYl0pO3JldHVybiBjfWguc2V0PWZ1bmN0aW9uKGEsYil7VSh0aGlzKTt0aGlzLmk9bnVsbDthPVYodGhpcyxhKTt6Yyh0aGlzLGEpJiYodGhpcy5oLT10aGlzLmcuZ2V0KGEpLmxlbmd0aCk7dGhpcy5nLnNldChhLFtiXSk7dGhpcy5oKz0xO3JldHVybiB0aGlzfTtcbmguZ2V0PWZ1bmN0aW9uKGEsYil7aWYoIWEpcmV0dXJuIGI7YT1BYyh0aGlzLGEpO3JldHVybiBhLmxlbmd0aD4wP1N0cmluZyhhWzBdKTpifTtmdW5jdGlvbiBHYihhLGIsYyl7eWMoYSxiKTtjLmxlbmd0aD4wJiYoYS5pPW51bGwsYS5nLnNldChWKGEsYiksamEoYykpLGEuaCs9Yy5sZW5ndGgpO31oLnRvU3RyaW5nPWZ1bmN0aW9uKCl7aWYodGhpcy5pKXJldHVybiB0aGlzLmk7aWYoIXRoaXMuZylyZXR1cm4gXCJcIjtjb25zdCBhPVtdLGI9QXJyYXkuZnJvbSh0aGlzLmcua2V5cygpKTtmb3IobGV0IGQ9MDtkPGIubGVuZ3RoO2QrKyl7dmFyIGM9YltkXTtjb25zdCBlPUwoYyk7Yz1BYyh0aGlzLGMpO2ZvcihsZXQgZj0wO2Y8Yy5sZW5ndGg7ZisrKXtsZXQgZz1lO2NbZl0hPT1cIlwiJiYoZys9XCI9XCIrTChjW2ZdKSk7YS5wdXNoKGcpO319cmV0dXJuIHRoaXMuaT1hLmpvaW4oXCImXCIpfTtcbmZ1bmN0aW9uIG5jKGEpe2NvbnN0IGI9bmV3IHBjO2IuaT1hLmk7YS5nJiYoYi5nPW5ldyBNYXAoYS5nKSxiLmg9YS5oKTtyZXR1cm4gYn1mdW5jdGlvbiBWKGEsYil7Yj1TdHJpbmcoYik7YS5qJiYoYj1iLnRvTG93ZXJDYXNlKCkpO3JldHVybiBifWZ1bmN0aW9uIHZjKGEsYil7YiYmIWEuaiYmKFUoYSksYS5pPW51bGwsYS5nLmZvckVhY2goZnVuY3Rpb24oYyxkKXtjb25zdCBlPWQudG9Mb3dlckNhc2UoKTtkIT1lJiYoeWModGhpcyxkKSxHYih0aGlzLGUsYykpO30sYSkpO2Euaj1iO31mdW5jdGlvbiBCYyhhLGIpe2NvbnN0IGM9bmV3IHBiO2lmKGwuSW1hZ2Upe2NvbnN0IGQ9bmV3IEltYWdlO2Qub25sb2FkPWhhKFcsYyxcIlRlc3RMb2FkSW1hZ2U6IGxvYWRlZFwiLCEwLGIsZCk7ZC5vbmVycm9yPWhhKFcsYyxcIlRlc3RMb2FkSW1hZ2U6IGVycm9yXCIsITEsYixkKTtkLm9uYWJvcnQ9aGEoVyxjLFwiVGVzdExvYWRJbWFnZTogYWJvcnRcIiwhMSxiLGQpO2Qub250aW1lb3V0PWhhKFcsYyxcIlRlc3RMb2FkSW1hZ2U6IHRpbWVvdXRcIiwhMSxiLGQpO2wuc2V0VGltZW91dChmdW5jdGlvbigpe2lmKGQub250aW1lb3V0KWQub250aW1lb3V0KCk7fSwxRTQpO2Quc3JjPWE7fWVsc2UgYighMSk7fVxuZnVuY3Rpb24gQ2MoYSxiKXtjb25zdCBjPW5ldyBwYixkPW5ldyBBYm9ydENvbnRyb2xsZXIsZT1zZXRUaW1lb3V0KCgpPT57ZC5hYm9ydCgpO1coYyxcIlRlc3RQaW5nU2VydmVyOiB0aW1lb3V0XCIsITEsYik7fSwxRTQpO2ZldGNoKGEse3NpZ25hbDpkLnNpZ25hbH0pLnRoZW4oZj0+e2NsZWFyVGltZW91dChlKTtmLm9rP1coYyxcIlRlc3RQaW5nU2VydmVyOiBva1wiLCEwLGIpOlcoYyxcIlRlc3RQaW5nU2VydmVyOiBzZXJ2ZXIgZXJyb3JcIiwhMSxiKTt9KS5jYXRjaCgoKT0+e2NsZWFyVGltZW91dChlKTtXKGMsXCJUZXN0UGluZ1NlcnZlcjogZXJyb3JcIiwhMSxiKTt9KTt9ZnVuY3Rpb24gVyhhLGIsYyxkLGUpe3RyeXtlJiYoZS5vbmxvYWQ9bnVsbCxlLm9uZXJyb3I9bnVsbCxlLm9uYWJvcnQ9bnVsbCxlLm9udGltZW91dD1udWxsKSxkKGMpO31jYXRjaChmKXt9fWZ1bmN0aW9uIERjKCl7dGhpcy5nPW5ldyBkYjt9ZnVuY3Rpb24gRWMoYSl7dGhpcy5pPWEuU2J8fG51bGw7dGhpcy5oPWEuYWJ8fCExO310KEVjLGViKTtFYy5wcm90b3R5cGUuZz1mdW5jdGlvbigpe3JldHVybiBuZXcgRmModGhpcy5pLHRoaXMuaCl9O2Z1bmN0aW9uIEZjKGEsYil7Qy5jYWxsKHRoaXMpO3RoaXMuSD1hO3RoaXMubz1iO3RoaXMubT12b2lkIDA7dGhpcy5zdGF0dXM9dGhpcy5yZWFkeVN0YXRlPTA7dGhpcy5yZXNwb25zZVR5cGU9dGhpcy5yZXNwb25zZVRleHQ9dGhpcy5yZXNwb25zZT10aGlzLnN0YXR1c1RleHQ9XCJcIjt0aGlzLm9ucmVhZHlzdGF0ZWNoYW5nZT1udWxsO3RoaXMuQT1uZXcgSGVhZGVyczt0aGlzLmg9bnVsbDt0aGlzLkY9XCJHRVRcIjt0aGlzLkQ9XCJcIjt0aGlzLmc9ITE7dGhpcy5CPXRoaXMuaj10aGlzLmw9bnVsbDt0aGlzLnY9bmV3IEFib3J0Q29udHJvbGxlcjt9dChGYyxDKTtoPUZjLnByb3RvdHlwZTtcbmgub3Blbj1mdW5jdGlvbihhLGIpe2lmKHRoaXMucmVhZHlTdGF0ZSE9MCl0aHJvdyB0aGlzLmFib3J0KCksRXJyb3IoXCJFcnJvciByZW9wZW5pbmcgYSBjb25uZWN0aW9uXCIpO3RoaXMuRj1hO3RoaXMuRD1iO3RoaXMucmVhZHlTdGF0ZT0xO0djKHRoaXMpO307aC5zZW5kPWZ1bmN0aW9uKGEpe2lmKHRoaXMucmVhZHlTdGF0ZSE9MSl0aHJvdyB0aGlzLmFib3J0KCksRXJyb3IoXCJuZWVkIHRvIGNhbGwgb3BlbigpIGZpcnN0LiBcIik7aWYodGhpcy52LnNpZ25hbC5hYm9ydGVkKXRocm93IHRoaXMuYWJvcnQoKSxFcnJvcihcIlJlcXVlc3Qgd2FzIGFib3J0ZWQuXCIpO3RoaXMuZz0hMDtjb25zdCBiPXtoZWFkZXJzOnRoaXMuQSxtZXRob2Q6dGhpcy5GLGNyZWRlbnRpYWxzOnRoaXMubSxjYWNoZTp2b2lkIDAsc2lnbmFsOnRoaXMudi5zaWduYWx9O2EmJihiLmJvZHk9YSk7KHRoaXMuSHx8bCkuZmV0Y2gobmV3IFJlcXVlc3QodGhpcy5ELGIpKS50aGVuKHRoaXMuUGEuYmluZCh0aGlzKSx0aGlzLmdhLmJpbmQodGhpcykpO307XG5oLmFib3J0PWZ1bmN0aW9uKCl7dGhpcy5yZXNwb25zZT10aGlzLnJlc3BvbnNlVGV4dD1cIlwiO3RoaXMuQT1uZXcgSGVhZGVyczt0aGlzLnN0YXR1cz0wO3RoaXMudi5hYm9ydCgpO3RoaXMuaiYmdGhpcy5qLmNhbmNlbChcIlJlcXVlc3Qgd2FzIGFib3J0ZWQuXCIpLmNhdGNoKCgpPT57fSk7dGhpcy5yZWFkeVN0YXRlPj0xJiZ0aGlzLmcmJnRoaXMucmVhZHlTdGF0ZSE9NCYmKHRoaXMuZz0hMSxIYyh0aGlzKSk7dGhpcy5yZWFkeVN0YXRlPTA7fTtcbmguUGE9ZnVuY3Rpb24oYSl7aWYodGhpcy5nJiYodGhpcy5sPWEsdGhpcy5ofHwodGhpcy5zdGF0dXM9dGhpcy5sLnN0YXR1cyx0aGlzLnN0YXR1c1RleHQ9dGhpcy5sLnN0YXR1c1RleHQsdGhpcy5oPWEuaGVhZGVycyx0aGlzLnJlYWR5U3RhdGU9MixHYyh0aGlzKSksdGhpcy5nJiYodGhpcy5yZWFkeVN0YXRlPTMsR2ModGhpcyksdGhpcy5nKSkpaWYodGhpcy5yZXNwb25zZVR5cGU9PT1cImFycmF5YnVmZmVyXCIpYS5hcnJheUJ1ZmZlcigpLnRoZW4odGhpcy5OYS5iaW5kKHRoaXMpLHRoaXMuZ2EuYmluZCh0aGlzKSk7ZWxzZSBpZih0eXBlb2YgbC5SZWFkYWJsZVN0cmVhbSE9PVwidW5kZWZpbmVkXCImJlwiYm9keVwiaW4gYSl7dGhpcy5qPWEuYm9keS5nZXRSZWFkZXIoKTtpZih0aGlzLm8pe2lmKHRoaXMucmVzcG9uc2VUeXBlKXRocm93IEVycm9yKCdyZXNwb25zZVR5cGUgbXVzdCBiZSBlbXB0eSBmb3IgXCJzdHJlYW1CaW5hcnlDaHVua3NcIiBtb2RlIHJlc3BvbnNlcy4nKTt0aGlzLnJlc3BvbnNlPVxuW107fWVsc2UgdGhpcy5yZXNwb25zZT10aGlzLnJlc3BvbnNlVGV4dD1cIlwiLHRoaXMuQj1uZXcgVGV4dERlY29kZXI7SWModGhpcyk7fWVsc2UgYS50ZXh0KCkudGhlbih0aGlzLk9hLmJpbmQodGhpcyksdGhpcy5nYS5iaW5kKHRoaXMpKTt9O2Z1bmN0aW9uIEljKGEpe2Euai5yZWFkKCkudGhlbihhLk1hLmJpbmQoYSkpLmNhdGNoKGEuZ2EuYmluZChhKSk7fWguTWE9ZnVuY3Rpb24oYSl7aWYodGhpcy5nKXtpZih0aGlzLm8mJmEudmFsdWUpdGhpcy5yZXNwb25zZS5wdXNoKGEudmFsdWUpO2Vsc2UgaWYoIXRoaXMubyl7dmFyIGI9YS52YWx1ZT9hLnZhbHVlOm5ldyBVaW50OEFycmF5KDApO2lmKGI9dGhpcy5CLmRlY29kZShiLHtzdHJlYW06IWEuZG9uZX0pKXRoaXMucmVzcG9uc2U9dGhpcy5yZXNwb25zZVRleHQrPWI7fWEuZG9uZT9IYyh0aGlzKTpHYyh0aGlzKTt0aGlzLnJlYWR5U3RhdGU9PTMmJkljKHRoaXMpO319O1xuaC5PYT1mdW5jdGlvbihhKXt0aGlzLmcmJih0aGlzLnJlc3BvbnNlPXRoaXMucmVzcG9uc2VUZXh0PWEsSGModGhpcykpO307aC5OYT1mdW5jdGlvbihhKXt0aGlzLmcmJih0aGlzLnJlc3BvbnNlPWEsSGModGhpcykpO307aC5nYT1mdW5jdGlvbigpe3RoaXMuZyYmSGModGhpcyk7fTtmdW5jdGlvbiBIYyhhKXthLnJlYWR5U3RhdGU9NDthLmw9bnVsbDthLmo9bnVsbDthLkI9bnVsbDtHYyhhKTt9aC5zZXRSZXF1ZXN0SGVhZGVyPWZ1bmN0aW9uKGEsYil7dGhpcy5BLmFwcGVuZChhLGIpO307aC5nZXRSZXNwb25zZUhlYWRlcj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5oP3RoaXMuaC5nZXQoYS50b0xvd2VyQ2FzZSgpKXx8XCJcIjpcIlwifTtcbmguZ2V0QWxsUmVzcG9uc2VIZWFkZXJzPWZ1bmN0aW9uKCl7aWYoIXRoaXMuaClyZXR1cm4gXCJcIjtjb25zdCBhPVtdLGI9dGhpcy5oLmVudHJpZXMoKTtmb3IodmFyIGM9Yi5uZXh0KCk7IWMuZG9uZTspYz1jLnZhbHVlLGEucHVzaChjWzBdK1wiOiBcIitjWzFdKSxjPWIubmV4dCgpO3JldHVybiBhLmpvaW4oXCJcXHJcXG5cIil9O2Z1bmN0aW9uIEdjKGEpe2Eub25yZWFkeXN0YXRlY2hhbmdlJiZhLm9ucmVhZHlzdGF0ZWNoYW5nZS5jYWxsKGEpO31PYmplY3QuZGVmaW5lUHJvcGVydHkoRmMucHJvdG90eXBlLFwid2l0aENyZWRlbnRpYWxzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm09PT1cImluY2x1ZGVcIn0sc2V0OmZ1bmN0aW9uKGEpe3RoaXMubT1hP1wiaW5jbHVkZVwiOlwic2FtZS1vcmlnaW5cIjt9fSk7ZnVuY3Rpb24gSmMoYSl7bGV0IGI9XCJcIjt5YShhLGZ1bmN0aW9uKGMsZCl7Yis9ZDtiKz1cIjpcIjtiKz1jO2IrPVwiXFxyXFxuXCI7fSk7cmV0dXJuIGJ9ZnVuY3Rpb24gS2MoYSxiLGMpe2E6e2ZvcihkIGluIGMpe3ZhciBkPSExO2JyZWFrIGF9ZD0hMDt9ZHx8KGM9SmMoYyksdHlwZW9mIGE9PT1cInN0cmluZ1wiPyhjIT1udWxsJiZMKGMpKTpTKGEsYixjKSk7fWZ1bmN0aW9uIFgoYSl7Qy5jYWxsKHRoaXMpO3RoaXMuaGVhZGVycz1uZXcgTWFwO3RoaXMuTD1hfHxudWxsO3RoaXMuaD0hMTt0aGlzLmc9bnVsbDt0aGlzLkQ9XCJcIjt0aGlzLm89MDt0aGlzLmw9XCJcIjt0aGlzLmo9dGhpcy5CPXRoaXMudj10aGlzLkE9ITE7dGhpcy5tPW51bGw7dGhpcy5GPVwiXCI7dGhpcy5IPSExO310KFgsQyk7dmFyIExjPS9eaHR0cHM/JC9pLE1jPVtcIlBPU1RcIixcIlBVVFwiXTtoPVgucHJvdG90eXBlO2guRmE9ZnVuY3Rpb24oYSl7dGhpcy5IPWE7fTtcbmguZWE9ZnVuY3Rpb24oYSxiLGMsZCl7aWYodGhpcy5nKXRocm93IEVycm9yKFwiW2dvb2cubmV0LlhocklvXSBPYmplY3QgaXMgYWN0aXZlIHdpdGggYW5vdGhlciByZXF1ZXN0PVwiK3RoaXMuRCtcIjsgbmV3VXJpPVwiK2EpO2I9Yj9iLnRvVXBwZXJDYXNlKCk6XCJHRVRcIjt0aGlzLkQ9YTt0aGlzLmw9XCJcIjt0aGlzLm89MDt0aGlzLkE9ITE7dGhpcy5oPSEwO3RoaXMuZz10aGlzLkw/dGhpcy5MLmcoKTp3Yi5nKCk7dGhpcy5nLm9ucmVhZHlzdGF0ZWNoYW5nZT1pYShwKHRoaXMuQ2EsdGhpcykpO3RyeXt0aGlzLkI9ITAsdGhpcy5nLm9wZW4oYixTdHJpbmcoYSksITApLHRoaXMuQj0hMTt9Y2F0Y2goZil7TmModGhpcyxmKTtyZXR1cm59YT1jfHxcIlwiO2M9bmV3IE1hcCh0aGlzLmhlYWRlcnMpO2lmKGQpaWYoT2JqZWN0LmdldFByb3RvdHlwZU9mKGQpPT09T2JqZWN0LnByb3RvdHlwZSlmb3IodmFyIGUgaW4gZCljLnNldChlLGRbZV0pO2Vsc2UgaWYodHlwZW9mIGQua2V5cz09PVwiZnVuY3Rpb25cIiYmXG50eXBlb2YgZC5nZXQ9PT1cImZ1bmN0aW9uXCIpZm9yKGNvbnN0IGYgb2YgZC5rZXlzKCkpYy5zZXQoZixkLmdldChmKSk7ZWxzZSB0aHJvdyBFcnJvcihcIlVua25vd24gaW5wdXQgdHlwZSBmb3Igb3B0X2hlYWRlcnM6IFwiK1N0cmluZyhkKSk7ZD1BcnJheS5mcm9tKGMua2V5cygpKS5maW5kKGY9PlwiY29udGVudC10eXBlXCI9PWYudG9Mb3dlckNhc2UoKSk7ZT1sLkZvcm1EYXRhJiZhIGluc3RhbmNlb2YgbC5Gb3JtRGF0YTshKEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoTWMsYix2b2lkIDApPj0wKXx8ZHx8ZXx8Yy5zZXQoXCJDb250ZW50LVR5cGVcIixcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDtjaGFyc2V0PXV0Zi04XCIpO2Zvcihjb25zdCBbZixnXW9mIGMpdGhpcy5nLnNldFJlcXVlc3RIZWFkZXIoZixnKTt0aGlzLkYmJih0aGlzLmcucmVzcG9uc2VUeXBlPXRoaXMuRik7XCJ3aXRoQ3JlZGVudGlhbHNcImluIHRoaXMuZyYmdGhpcy5nLndpdGhDcmVkZW50aWFscyE9PVxudGhpcy5IJiYodGhpcy5nLndpdGhDcmVkZW50aWFscz10aGlzLkgpO3RyeXt0aGlzLm0mJihjbGVhclRpbWVvdXQodGhpcy5tKSx0aGlzLm09bnVsbCksdGhpcy52PSEwLHRoaXMuZy5zZW5kKGEpLHRoaXMudj0hMTt9Y2F0Y2goZil7TmModGhpcyxmKTt9fTtmdW5jdGlvbiBOYyhhLGIpe2EuaD0hMTthLmcmJihhLmo9ITAsYS5nLmFib3J0KCksYS5qPSExKTthLmw9YjthLm89NTtPYyhhKTtQYyhhKTt9ZnVuY3Rpb24gT2MoYSl7YS5BfHwoYS5BPSEwLEQoYSxcImNvbXBsZXRlXCIpLEQoYSxcImVycm9yXCIpKTt9aC5hYm9ydD1mdW5jdGlvbihhKXt0aGlzLmcmJnRoaXMuaCYmKHRoaXMuaD0hMSx0aGlzLmo9ITAsdGhpcy5nLmFib3J0KCksdGhpcy5qPSExLHRoaXMubz1hfHw3LEQodGhpcyxcImNvbXBsZXRlXCIpLEQodGhpcyxcImFib3J0XCIpLFBjKHRoaXMpKTt9O1xuaC5OPWZ1bmN0aW9uKCl7dGhpcy5nJiYodGhpcy5oJiYodGhpcy5oPSExLHRoaXMuaj0hMCx0aGlzLmcuYWJvcnQoKSx0aGlzLmo9ITEpLFBjKHRoaXMsITApKTtYLlouTi5jYWxsKHRoaXMpO307aC5DYT1mdW5jdGlvbigpe3RoaXMudXx8KHRoaXMuQnx8dGhpcy52fHx0aGlzLmo/UWModGhpcyk6dGhpcy5YYSgpKTt9O2guWGE9ZnVuY3Rpb24oKXtRYyh0aGlzKTt9O1xuZnVuY3Rpb24gUWMoYSl7aWYoYS5oJiZ0eXBlb2YgZWEhPVwidW5kZWZpbmVkXCIpaWYoYS52JiZQKGEpPT00KXNldFRpbWVvdXQoYS5DYS5iaW5kKGEpLDApO2Vsc2UgaWYoRChhLFwicmVhZHlzdGF0ZWNoYW5nZVwiKSxQKGEpPT00KXthLmg9ITE7dHJ5e2NvbnN0IGY9YS5jYSgpO2E6c3dpdGNoKGYpe2Nhc2UgMjAwOmNhc2UgMjAxOmNhc2UgMjAyOmNhc2UgMjA0OmNhc2UgMjA2OmNhc2UgMzA0OmNhc2UgMTIyMzp2YXIgYj0hMDticmVhayBhO2RlZmF1bHQ6Yj0hMTt9dmFyIGM7aWYoIShjPWIpKXt2YXIgZDtpZihkPWY9PT0wKXtsZXQgZz1TdHJpbmcoYS5EKS5tYXRjaChpYylbMV18fG51bGw7IWcmJmwuc2VsZiYmbC5zZWxmLmxvY2F0aW9uJiYoZz1sLnNlbGYubG9jYXRpb24ucHJvdG9jb2wuc2xpY2UoMCwtMSkpO2Q9IUxjLnRlc3QoZz9nLnRvTG93ZXJDYXNlKCk6XCJcIik7fWM9ZDt9aWYoYylEKGEsXCJjb21wbGV0ZVwiKSxEKGEsXCJzdWNjZXNzXCIpO2Vsc2Uge2Eubz02O3RyeXt2YXIgZT1QKGEpPlxuMj9hLmcuc3RhdHVzVGV4dDpcIlwiO31jYXRjaChnKXtlPVwiXCI7fWEubD1lK1wiIFtcIithLmNhKCkrXCJdXCI7T2MoYSk7fX1maW5hbGx5e1BjKGEpO319fWZ1bmN0aW9uIFBjKGEsYil7aWYoYS5nKXthLm0mJihjbGVhclRpbWVvdXQoYS5tKSxhLm09bnVsbCk7Y29uc3QgYz1hLmc7YS5nPW51bGw7Ynx8RChhLFwicmVhZHlcIik7dHJ5e2Mub25yZWFkeXN0YXRlY2hhbmdlPW51bGw7fWNhdGNoKGQpe319fWguaXNBY3RpdmU9ZnVuY3Rpb24oKXtyZXR1cm4gISF0aGlzLmd9O2Z1bmN0aW9uIFAoYSl7cmV0dXJuIGEuZz9hLmcucmVhZHlTdGF0ZTowfWguY2E9ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIFAodGhpcyk+Mj90aGlzLmcuc3RhdHVzOi0xfWNhdGNoKGEpe3JldHVybiAtMX19O2gubGE9ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIHRoaXMuZz90aGlzLmcucmVzcG9uc2VUZXh0OlwiXCJ9Y2F0Y2goYSl7cmV0dXJuIFwiXCJ9fTtcbmguTGE9ZnVuY3Rpb24oYSl7aWYodGhpcy5nKXt2YXIgYj10aGlzLmcucmVzcG9uc2VUZXh0O2EmJmIuaW5kZXhPZihhKT09MCYmKGI9Yi5zdWJzdHJpbmcoYS5sZW5ndGgpKTtyZXR1cm4gY2IoYil9fTtmdW5jdGlvbiBJYihhKXt0cnl7aWYoIWEuZylyZXR1cm4gbnVsbDtpZihcInJlc3BvbnNlXCJpbiBhLmcpcmV0dXJuIGEuZy5yZXNwb25zZTtzd2l0Y2goYS5GKXtjYXNlIFwiXCI6Y2FzZSBcInRleHRcIjpyZXR1cm4gYS5nLnJlc3BvbnNlVGV4dDtjYXNlIFwiYXJyYXlidWZmZXJcIjppZihcIm1velJlc3BvbnNlQXJyYXlCdWZmZXJcImluIGEuZylyZXR1cm4gYS5nLm1velJlc3BvbnNlQXJyYXlCdWZmZXJ9cmV0dXJuIG51bGx9Y2F0Y2goYil7cmV0dXJuIG51bGx9fVxuZnVuY3Rpb24gUmIoYSl7Y29uc3QgYj17fTthPShhLmcmJlAoYSk+PTI/YS5nLmdldEFsbFJlc3BvbnNlSGVhZGVycygpfHxcIlwiOlwiXCIpLnNwbGl0KFwiXFxyXFxuXCIpO2ZvcihsZXQgZD0wO2Q8YS5sZW5ndGg7ZCsrKXtpZih5KGFbZF0pKWNvbnRpbnVlO3ZhciBjPXliKGFbZF0pO2NvbnN0IGU9Y1swXTtjPWNbMV07aWYodHlwZW9mIGMhPT1cInN0cmluZ1wiKWNvbnRpbnVlO2M9Yy50cmltKCk7Y29uc3QgZj1iW2VdfHxbXTtiW2VdPWY7Zi5wdXNoKGMpO31BYShiLGZ1bmN0aW9uKGQpe3JldHVybiBkLmpvaW4oXCIsIFwiKX0pO31oLnlhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub307aC5IYT1mdW5jdGlvbigpe3JldHVybiB0eXBlb2YgdGhpcy5sPT09XCJzdHJpbmdcIj90aGlzLmw6U3RyaW5nKHRoaXMubCl9O2Z1bmN0aW9uIFJjKGEsYixjKXtyZXR1cm4gYyYmYy5pbnRlcm5hbENoYW5uZWxQYXJhbXM/Yy5pbnRlcm5hbENoYW5uZWxQYXJhbXNbYV18fGI6Yn1cbmZ1bmN0aW9uIFNjKGEpe3RoaXMuemE9MDt0aGlzLmk9W107dGhpcy5qPW5ldyBwYjt0aGlzLmJhPXRoaXMubmE9dGhpcy5KPXRoaXMuVz10aGlzLmc9dGhpcy53YT10aGlzLkc9dGhpcy5IPXRoaXMudT10aGlzLlU9dGhpcy5vPW51bGw7dGhpcy5ZYT10aGlzLlY9MDt0aGlzLlNhPVJjKFwiZmFpbEZhc3RcIiwhMSxhKTt0aGlzLkY9dGhpcy5DPXRoaXMudj10aGlzLm09dGhpcy5sPW51bGw7dGhpcy5YPSEwO3RoaXMueGE9dGhpcy5LPS0xO3RoaXMuWT10aGlzLkE9dGhpcy5EPTA7dGhpcy5RYT1SYyhcImJhc2VSZXRyeURlbGF5TXNcIiw1RTMsYSk7dGhpcy5aYT1SYyhcInJldHJ5RGVsYXlTZWVkTXNcIiwxRTQsYSk7dGhpcy5UYT1SYyhcImZvcndhcmRDaGFubmVsTWF4UmV0cmllc1wiLDIsYSk7dGhpcy52YT1SYyhcImZvcndhcmRDaGFubmVsUmVxdWVzdFRpbWVvdXRNc1wiLDJFNCxhKTt0aGlzLm1hPWEmJmEueG1sSHR0cEZhY3Rvcnl8fHZvaWQgMDt0aGlzLlVhPWEmJmEuUmJ8fHZvaWQgMDt0aGlzLkFhPVxuYSYmYS51c2VGZXRjaFN0cmVhbXN8fCExO3RoaXMuTz12b2lkIDA7dGhpcy5MPWEmJmEuc3VwcG9ydHNDcm9zc0RvbWFpblhocnx8ITE7dGhpcy5NPVwiXCI7dGhpcy5oPW5ldyBlYyhhJiZhLmNvbmN1cnJlbnRSZXF1ZXN0TGltaXQpO3RoaXMuQmE9bmV3IERjO3RoaXMuUz1hJiZhLmZhc3RIYW5kc2hha2V8fCExO3RoaXMuUj1hJiZhLmVuY29kZUluaXRNZXNzYWdlSGVhZGVyc3x8ITE7dGhpcy5TJiZ0aGlzLlImJih0aGlzLlI9ITEpO3RoaXMuUmE9YSYmYS5QYnx8ITE7YSYmYS51YSYmdGhpcy5qLnVhKCk7YSYmYS5mb3JjZUxvbmdQb2xsaW5nJiYodGhpcy5YPSExKTt0aGlzLmFhPSF0aGlzLlMmJnRoaXMuWCYmYSYmYS5kZXRlY3RCdWZmZXJpbmdQcm94eXx8ITE7dGhpcy5pYT12b2lkIDA7YSYmYS5sb25nUG9sbGluZ1RpbWVvdXQmJmEubG9uZ1BvbGxpbmdUaW1lb3V0PjAmJih0aGlzLmlhPWEubG9uZ1BvbGxpbmdUaW1lb3V0KTt0aGlzLnRhPXZvaWQgMDt0aGlzLlQ9MDt0aGlzLlA9XG4hMTt0aGlzLmphPXRoaXMuQj1udWxsO31oPVNjLnByb3RvdHlwZTtoLmthPTg7aC5JPTE7aC5jb25uZWN0PWZ1bmN0aW9uKGEsYixjLGQpe0ooMCk7dGhpcy5XPWE7dGhpcy5IPWJ8fHt9O2MmJmQhPT12b2lkIDAmJih0aGlzLkguT1NJRD1jLHRoaXMuSC5PQUlEPWQpO3RoaXMuRj10aGlzLlg7dGhpcy5KPVpiKHRoaXMsbnVsbCx0aGlzLlcpO2JjKHRoaXMpO307XG5mdW5jdGlvbiBjYyhhKXtUYyhhKTtpZihhLkk9PTMpe3ZhciBiPWEuVisrLGM9TyhhLkopO1MoYyxcIlNJRFwiLGEuTSk7UyhjLFwiUklEXCIsYik7UyhjLFwiVFlQRVwiLFwidGVybWluYXRlXCIpO1VjKGEsYyk7Yj1uZXcgTihhLGEuaixiKTtiLk09MjtiLkE9RGIoTyhjKSk7Yz0hMTtpZihsLm5hdmlnYXRvciYmbC5uYXZpZ2F0b3Iuc2VuZEJlYWNvbil0cnl7Yz1sLm5hdmlnYXRvci5zZW5kQmVhY29uKGIuQS50b1N0cmluZygpLFwiXCIpO31jYXRjaChkKXt9IWMmJmwuSW1hZ2UmJigobmV3IEltYWdlKS5zcmM9Yi5BLGM9ITApO2N8fChiLmc9SGIoYi5qLG51bGwpLGIuZy5lYShiLkEpKTtiLkY9RGF0ZS5ub3coKTtGYihiKTt9VmMoYSk7fWZ1bmN0aW9uIFZiKGEpe2EuZyYmKFBiKGEpLGEuZy5jYW5jZWwoKSxhLmc9bnVsbCk7fVxuZnVuY3Rpb24gVGMoYSl7VmIoYSk7YS52JiYobC5jbGVhclRpbWVvdXQoYS52KSxhLnY9bnVsbCk7VWIoYSk7YS5oLmNhbmNlbCgpO2EubSYmKHR5cGVvZiBhLm09PT1cIm51bWJlclwiJiZsLmNsZWFyVGltZW91dChhLm0pLGEubT1udWxsKTt9ZnVuY3Rpb24gYmMoYSl7aWYoIWZjKGEuaCkmJiFhLm0pe2EubT0hMDt2YXIgYj1hLkVhO3V8fHRhKCk7dnx8KHUoKSx2PSEwKTtvYS5hZGQoYixhKTthLkQ9MDt9fWZ1bmN0aW9uIFdjKGEsYil7aWYoWGIoYS5oKT49YS5oLmotKGEubT8xOjApKXJldHVybiAhMTtpZihhLm0pcmV0dXJuIGEuaT1iLkcuY29uY2F0KGEuaSksITA7aWYoYS5JPT0xfHxhLkk9PTJ8fGEuRD49KGEuU2E/MDphLlRhKSlyZXR1cm4gITE7YS5tPW9iKHAoYS5FYSxhLGIpLFhjKGEsYS5EKSk7YS5EKys7cmV0dXJuICEwfVxuaC5FYT1mdW5jdGlvbihhKXtpZih0aGlzLm0paWYodGhpcy5tPW51bGwsdGhpcy5JPT0xKXtpZighYSl7dGhpcy5WPU1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSoxRTUpO2E9dGhpcy5WKys7Y29uc3QgZT1uZXcgTih0aGlzLHRoaXMuaixhKTtsZXQgZj10aGlzLm87dGhpcy5VJiYoZj8oZj1CYShmKSxEYShmLHRoaXMuVSkpOmY9dGhpcy5VKTt0aGlzLnUhPT1udWxsfHx0aGlzLlJ8fChlLko9ZixmPW51bGwpO2lmKHRoaXMuUylhOnt2YXIgYj0wO2Zvcih2YXIgYz0wO2M8dGhpcy5pLmxlbmd0aDtjKyspe2I6e3ZhciBkPXRoaXMuaVtjXTtpZihcIl9fZGF0YV9fXCJpbiBkLm1hcCYmKGQ9ZC5tYXAuX19kYXRhX18sdHlwZW9mIGQ9PT1cInN0cmluZ1wiKSl7ZD1kLmxlbmd0aDticmVhayBifWQ9dm9pZCAwO31pZihkPT09dm9pZCAwKWJyZWFrO2IrPWQ7aWYoYj40MDk2KXtiPWM7YnJlYWsgYX1pZihiPT09NDA5Nnx8Yz09PXRoaXMuaS5sZW5ndGgtMSl7Yj1jKzE7YnJlYWsgYX19Yj0xRTM7fWVsc2UgYj1cbjFFMztiPVljKHRoaXMsZSxiKTtjPU8odGhpcy5KKTtTKGMsXCJSSURcIixhKTtTKGMsXCJDVkVSXCIsMjIpO3RoaXMuRyYmUyhjLFwiWC1IVFRQLVNlc3Npb24tSWRcIix0aGlzLkcpO1VjKHRoaXMsYyk7ZiYmKHRoaXMuUj9iPVwiaGVhZGVycz1cIitMKEpjKGYpKStcIiZcIitiOnRoaXMudSYmS2MoYyx0aGlzLnUsZikpO1liKHRoaXMuaCxlKTt0aGlzLlJhJiZTKGMsXCJUWVBFXCIsXCJpbml0XCIpO3RoaXMuUz8oUyhjLFwiJHJlcVwiLGIpLFMoYyxcIlNJRFwiLFwibnVsbFwiKSxlLlU9ITAsQ2IoZSxjLG51bGwpKTpDYihlLGMsYik7dGhpcy5JPTI7fX1lbHNlIHRoaXMuST09MyYmKGE/WmModGhpcyxhKTp0aGlzLmkubGVuZ3RoPT0wfHxmYyh0aGlzLmgpfHxaYyh0aGlzKSk7fTtcbmZ1bmN0aW9uIFpjKGEsYil7dmFyIGM7Yj9jPWIubDpjPWEuVisrO2NvbnN0IGQ9TyhhLkopO1MoZCxcIlNJRFwiLGEuTSk7UyhkLFwiUklEXCIsYyk7UyhkLFwiQUlEXCIsYS5LKTtVYyhhLGQpO2EudSYmYS5vJiZLYyhkLGEudSxhLm8pO2M9bmV3IE4oYSxhLmosYyxhLkQrMSk7YS51PT09bnVsbCYmKGMuSj1hLm8pO2ImJihhLmk9Yi5HLmNvbmNhdChhLmkpKTtiPVljKGEsYywxRTMpO2MuSD1NYXRoLnJvdW5kKGEudmEqLjUpK01hdGgucm91bmQoYS52YSouNSpNYXRoLnJhbmRvbSgpKTtZYihhLmgsYyk7Q2IoYyxkLGIpO31mdW5jdGlvbiBVYyhhLGIpe2EuSCYmeWEoYS5ILGZ1bmN0aW9uKGMsZCl7UyhiLGQsYyk7fSk7YS5sJiZ5YSh7fSxmdW5jdGlvbihjLGQpe1MoYixkLGMpO30pO31cbmZ1bmN0aW9uIFljKGEsYixjKXtjPU1hdGgubWluKGEuaS5sZW5ndGgsYyk7Y29uc3QgZD1hLmw/cChhLmwuS2EsYS5sLGEpOm51bGw7YTp7dmFyIGU9YS5pO2xldCBrPS0xO2Zvcig7Oyl7Y29uc3QgcT1bXCJjb3VudD1cIitjXTtrPT0tMT9jPjA/KGs9ZVswXS5nLHEucHVzaChcIm9mcz1cIitrKSk6az0wOnEucHVzaChcIm9mcz1cIitrKTtsZXQgbT0hMDtmb3IobGV0IHI9MDtyPGM7cisrKXt2YXIgZj1lW3JdLmc7Y29uc3QgQT1lW3JdLm1hcDtmLT1rO2lmKGY8MClrPU1hdGgubWF4KDAsZVtyXS5nLTEwMCksbT0hMTtlbHNlIHRyeXtmPVwicmVxXCIrZitcIl9cInx8XCJcIjt0cnl7dmFyIGc9QSBpbnN0YW5jZW9mIE1hcD9BOk9iamVjdC5lbnRyaWVzKEEpO2Zvcihjb25zdCBbTSxGXW9mIGcpe2xldCBHPUY7bihGKSYmKEc9YWIoRikpO3EucHVzaChmK00rXCI9XCIrZW5jb2RlVVJJQ29tcG9uZW50KEcpKTt9fWNhdGNoKE0pe3Rocm93IHEucHVzaChmK1widHlwZT1cIitlbmNvZGVVUklDb21wb25lbnQoXCJfYmFkbWFwXCIpKSxcbk07fX1jYXRjaChNKXtkJiZkKEEpO319aWYobSl7Zz1xLmpvaW4oXCImXCIpO2JyZWFrIGF9fWc9dm9pZCAwO31hPWEuaS5zcGxpY2UoMCxjKTtiLkc9YTtyZXR1cm4gZ31mdW5jdGlvbiBhYyhhKXtpZighYS5nJiYhYS52KXthLlk9MTt2YXIgYj1hLkRhO3V8fHRhKCk7dnx8KHUoKSx2PSEwKTtvYS5hZGQoYixhKTthLkE9MDt9fWZ1bmN0aW9uIFdiKGEpe2lmKGEuZ3x8YS52fHxhLkE+PTMpcmV0dXJuICExO2EuWSsrO2Eudj1vYihwKGEuRGEsYSksWGMoYSxhLkEpKTthLkErKztyZXR1cm4gITB9aC5EYT1mdW5jdGlvbigpe3RoaXMudj1udWxsOyRjKHRoaXMpO2lmKHRoaXMuYWEmJiEodGhpcy5QfHx0aGlzLmc9PW51bGx8fHRoaXMuVDw9MCkpe3ZhciBhPTQqdGhpcy5UO3RoaXMuai5pbmZvKFwiQlAgZGV0ZWN0aW9uIHRpbWVyIGVuYWJsZWQ6IFwiK2EpO3RoaXMuQj1vYihwKHRoaXMuV2EsdGhpcyksYSk7fX07XG5oLldhPWZ1bmN0aW9uKCl7dGhpcy5CJiYodGhpcy5CPW51bGwsdGhpcy5qLmluZm8oXCJCUCBkZXRlY3Rpb24gdGltZW91dCByZWFjaGVkLlwiKSx0aGlzLmouaW5mbyhcIkJ1ZmZlcmluZyBwcm94eSBkZXRlY3RlZCBhbmQgc3dpdGNoIHRvIGxvbmctcG9sbGluZyFcIiksdGhpcy5GPSExLHRoaXMuUD0hMCxKKDEwKSxWYih0aGlzKSwkYyh0aGlzKSk7fTtmdW5jdGlvbiBQYihhKXthLkIhPW51bGwmJihsLmNsZWFyVGltZW91dChhLkIpLGEuQj1udWxsKTt9XG5mdW5jdGlvbiAkYyhhKXthLmc9bmV3IE4oYSxhLmosXCJycGNcIixhLlkpO2EudT09PW51bGwmJihhLmcuSj1hLm8pO2EuZy5QPTA7dmFyIGI9TyhhLm5hKTtTKGIsXCJSSURcIixcInJwY1wiKTtTKGIsXCJTSURcIixhLk0pO1MoYixcIkFJRFwiLGEuSyk7UyhiLFwiQ0lcIixhLkY/XCIwXCI6XCIxXCIpOyFhLkYmJmEuaWEmJlMoYixcIlRPXCIsYS5pYSk7UyhiLFwiVFlQRVwiLFwieG1saHR0cFwiKTtVYyhhLGIpO2EudSYmYS5vJiZLYyhiLGEudSxhLm8pO2EuTyYmKGEuZy5IPWEuTyk7dmFyIGM9YS5nO2E9YS5iYTtjLk09MTtjLkE9RGIoTyhiKSk7Yy51PW51bGw7Yy5SPSEwO0ViKGMsYSk7fWguVmE9ZnVuY3Rpb24oKXt0aGlzLkMhPW51bGwmJih0aGlzLkM9bnVsbCxWYih0aGlzKSxXYih0aGlzKSxKKDE5KSk7fTtmdW5jdGlvbiBVYihhKXthLkMhPW51bGwmJihsLmNsZWFyVGltZW91dChhLkMpLGEuQz1udWxsKTt9XG5mdW5jdGlvbiBRYihhLGIpe3ZhciBjPW51bGw7aWYoYS5nPT1iKXtVYihhKTtQYihhKTthLmc9bnVsbDt2YXIgZD0yO31lbHNlIGlmKFRiKGEuaCxiKSljPWIuRywkYihhLmgsYiksZD0xO2Vsc2UgcmV0dXJuO2lmKGEuSSE9MClpZihiLm8paWYoZD09MSl7Yz1iLnU/Yi51Lmxlbmd0aDowO2I9RGF0ZS5ub3coKS1iLkY7dmFyIGU9YS5EO2Q9amIoKTtEKGQsbmV3IG5iKGQsYykpO2JjKGEpO31lbHNlIGFjKGEpO2Vsc2UgaWYoZT1iLm0sZT09M3x8ZT09MCYmYi5YPjB8fCEoZD09MSYmV2MoYSxiKXx8ZD09MiYmV2IoYSkpKXN3aXRjaChjJiZjLmxlbmd0aD4wJiYoYj1hLmgsYi5pPWIuaS5jb25jYXQoYykpLGUpe2Nhc2UgMTpSKGEsNSk7YnJlYWs7Y2FzZSA0OlIoYSwxMCk7YnJlYWs7Y2FzZSAzOlIoYSw2KTticmVhaztkZWZhdWx0OlIoYSwyKTt9fVxuZnVuY3Rpb24gWGMoYSxiKXtsZXQgYz1hLlFhK01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSphLlphKTthLmlzQWN0aXZlKCl8fChjKj0yKTtyZXR1cm4gYypifWZ1bmN0aW9uIFIoYSxiKXthLmouaW5mbyhcIkVycm9yIGNvZGUgXCIrYik7aWYoYj09Mil7dmFyIGM9cChhLmJiLGEpLGQ9YS5VYTtjb25zdCBlPSFkO2Q9bmV3IFQoZHx8XCIvL3d3dy5nb29nbGUuY29tL2ltYWdlcy9jbGVhcmRvdC5naWZcIik7bC5sb2NhdGlvbiYmbC5sb2NhdGlvbi5wcm90b2NvbD09XCJodHRwXCJ8fGtjKGQsXCJodHRwc1wiKTtEYihkKTtlP0JjKGQudG9TdHJpbmcoKSxjKTpDYyhkLnRvU3RyaW5nKCksYyk7fWVsc2UgSigyKTthLkk9MDthLmwmJmEubC5wYShiKTtWYyhhKTtUYyhhKTt9aC5iYj1mdW5jdGlvbihhKXthPyh0aGlzLmouaW5mbyhcIlN1Y2Nlc3NmdWxseSBwaW5nZWQgZ29vZ2xlLmNvbVwiKSxKKDIpKToodGhpcy5qLmluZm8oXCJGYWlsZWQgdG8gcGluZyBnb29nbGUuY29tXCIpLEooMSkpO307XG5mdW5jdGlvbiBWYyhhKXthLkk9MDthLmphPVtdO2lmKGEubCl7Y29uc3QgYj1oYyhhLmgpO2lmKGIubGVuZ3RoIT0wfHxhLmkubGVuZ3RoIT0wKWthKGEuamEsYiksa2EoYS5qYSxhLmkpLGEuaC5pLmxlbmd0aD0wLGphKGEuaSksYS5pLmxlbmd0aD0wO2EubC5vYSgpO319ZnVuY3Rpb24gWmIoYSxiLGMpe3ZhciBkPWMgaW5zdGFuY2VvZiBUP08oYyk6bmV3IFQoYyk7aWYoZC5nIT1cIlwiKWImJihkLmc9YitcIi5cIitkLmcpLGxjKGQsZC51KTtlbHNlIHt2YXIgZT1sLmxvY2F0aW9uO2Q9ZS5wcm90b2NvbDtiPWI/YitcIi5cIitlLmhvc3RuYW1lOmUuaG9zdG5hbWU7ZT0rZS5wb3J0O2NvbnN0IGY9bmV3IFQobnVsbCk7ZCYma2MoZixkKTtiJiYoZi5nPWIpO2UmJmxjKGYsZSk7YyYmKGYuaD1jKTtkPWY7fWM9YS5HO2I9YS53YTtjJiZiJiZTKGQsYyxiKTtTKGQsXCJWRVJcIixhLmthKTtVYyhhLGQpO3JldHVybiBkfVxuZnVuY3Rpb24gSGIoYSxiLGMpe2lmKGImJiFhLkwpdGhyb3cgRXJyb3IoXCJDYW4ndCBjcmVhdGUgc2Vjb25kYXJ5IGRvbWFpbiBjYXBhYmxlIFhocklvIG9iamVjdC5cIik7Yj1hLkFhJiYhYS5tYT9uZXcgWChuZXcgRWMoe2FiOmN9KSk6bmV3IFgoYS5tYSk7Yi5GYShhLkwpO3JldHVybiBifWguaXNBY3RpdmU9ZnVuY3Rpb24oKXtyZXR1cm4gISF0aGlzLmwmJnRoaXMubC5pc0FjdGl2ZSh0aGlzKX07ZnVuY3Rpb24gYWQoKXt9aD1hZC5wcm90b3R5cGU7aC5yYT1mdW5jdGlvbigpe307aC5xYT1mdW5jdGlvbigpe307aC5wYT1mdW5jdGlvbigpe307aC5vYT1mdW5jdGlvbigpe307aC5pc0FjdGl2ZT1mdW5jdGlvbigpe3JldHVybiAhMH07aC5LYT1mdW5jdGlvbigpe307ZnVuY3Rpb24gYmQoKXt9YmQucHJvdG90eXBlLmc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IFkoYSxiKX07XG5mdW5jdGlvbiBZKGEsYil7Qy5jYWxsKHRoaXMpO3RoaXMuZz1uZXcgU2MoYik7dGhpcy5sPWE7dGhpcy5oPWImJmIubWVzc2FnZVVybFBhcmFtc3x8bnVsbDthPWImJmIubWVzc2FnZUhlYWRlcnN8fG51bGw7YiYmYi5jbGllbnRQcm90b2NvbEhlYWRlclJlcXVpcmVkJiYoYT9hW1wiWC1DbGllbnQtUHJvdG9jb2xcIl09XCJ3ZWJjaGFubmVsXCI6YT17XCJYLUNsaWVudC1Qcm90b2NvbFwiOlwid2ViY2hhbm5lbFwifSk7dGhpcy5nLm89YTthPWImJmIuaW5pdE1lc3NhZ2VIZWFkZXJzfHxudWxsO2ImJmIubWVzc2FnZUNvbnRlbnRUeXBlJiYoYT9hW1wiWC1XZWJDaGFubmVsLUNvbnRlbnQtVHlwZVwiXT1iLm1lc3NhZ2VDb250ZW50VHlwZTphPXtcIlgtV2ViQ2hhbm5lbC1Db250ZW50LVR5cGVcIjpiLm1lc3NhZ2VDb250ZW50VHlwZX0pO2ImJmIuc2EmJihhP2FbXCJYLVdlYkNoYW5uZWwtQ2xpZW50LVByb2ZpbGVcIl09Yi5zYTphPXtcIlgtV2ViQ2hhbm5lbC1DbGllbnQtUHJvZmlsZVwiOmIuc2F9KTt0aGlzLmcuVT1cbmE7KGE9YiYmYi5RYikmJiF5KGEpJiYodGhpcy5nLnU9YSk7dGhpcy5BPWImJmIuc3VwcG9ydHNDcm9zc0RvbWFpblhocnx8ITE7dGhpcy52PWImJmIuc2VuZFJhd0pzb258fCExOyhiPWImJmIuaHR0cFNlc3Npb25JZFBhcmFtKSYmIXkoYikmJih0aGlzLmcuRz1iLGE9dGhpcy5oLGEhPT1udWxsJiZiIGluIGEmJihhPXRoaXMuaCxiIGluIGEmJmRlbGV0ZSBhW2JdKSk7dGhpcy5qPW5ldyBaKHRoaXMpO310KFksQyk7WS5wcm90b3R5cGUubT1mdW5jdGlvbigpe3RoaXMuZy5sPXRoaXMuajt0aGlzLkEmJih0aGlzLmcuTD0hMCk7dGhpcy5nLmNvbm5lY3QodGhpcy5sLHRoaXMuaHx8dm9pZCAwKTt9O1kucHJvdG90eXBlLmNsb3NlPWZ1bmN0aW9uKCl7Y2ModGhpcy5nKTt9O1xuWS5wcm90b3R5cGUubz1mdW5jdGlvbihhKXt2YXIgYj10aGlzLmc7aWYodHlwZW9mIGE9PT1cInN0cmluZ1wiKXt2YXIgYz17fTtjLl9fZGF0YV9fPWE7YT1jO31lbHNlIHRoaXMudiYmKGM9e30sYy5fX2RhdGFfXz1hYihhKSxhPWMpO2IuaS5wdXNoKG5ldyBkYyhiLllhKyssYSkpO2IuST09MyYmYmMoYik7fTtZLnByb3RvdHlwZS5OPWZ1bmN0aW9uKCl7dGhpcy5nLmw9bnVsbDtkZWxldGUgdGhpcy5qO2NjKHRoaXMuZyk7ZGVsZXRlIHRoaXMuZztZLlouTi5jYWxsKHRoaXMpO307XG5mdW5jdGlvbiBjZChhKXtnYi5jYWxsKHRoaXMpO2EuX19oZWFkZXJzX18mJih0aGlzLmhlYWRlcnM9YS5fX2hlYWRlcnNfXyx0aGlzLnN0YXR1c0NvZGU9YS5fX3N0YXR1c19fLGRlbGV0ZSBhLl9faGVhZGVyc19fLGRlbGV0ZSBhLl9fc3RhdHVzX18pO3ZhciBiPWEuX19zbV9fO2lmKGIpe2E6e2Zvcihjb25zdCBjIGluIGIpe2E9YzticmVhayBhfWE9dm9pZCAwO31pZih0aGlzLmk9YSlhPXRoaXMuaSxiPWIhPT1udWxsJiZhIGluIGI/YlthXTp2b2lkIDA7dGhpcy5kYXRhPWI7fWVsc2UgdGhpcy5kYXRhPWE7fXQoY2QsZ2IpO2Z1bmN0aW9uIGRkKCl7aGIuY2FsbCh0aGlzKTt0aGlzLnN0YXR1cz0xO310KGRkLGhiKTtmdW5jdGlvbiBaKGEpe3RoaXMuZz1hO310KFosYWQpO1oucHJvdG90eXBlLnJhPWZ1bmN0aW9uKCl7RCh0aGlzLmcsXCJhXCIpO307Wi5wcm90b3R5cGUucWE9ZnVuY3Rpb24oYSl7RCh0aGlzLmcsbmV3IGNkKGEpKTt9O1xuWi5wcm90b3R5cGUucGE9ZnVuY3Rpb24oYSl7RCh0aGlzLmcsbmV3IGRkKCkpO307Wi5wcm90b3R5cGUub2E9ZnVuY3Rpb24oKXtEKHRoaXMuZyxcImJcIik7fTtiZC5wcm90b3R5cGUuY3JlYXRlV2ViQ2hhbm5lbD1iZC5wcm90b3R5cGUuZztZLnByb3RvdHlwZS5zZW5kPVkucHJvdG90eXBlLm87WS5wcm90b3R5cGUub3Blbj1ZLnByb3RvdHlwZS5tO1kucHJvdG90eXBlLmNsb3NlPVkucHJvdG90eXBlLmNsb3NlO2NyZWF0ZVdlYkNoYW5uZWxUcmFuc3BvcnQgPSB3ZWJjaGFubmVsX2Jsb2JfZXMyMDE4LmNyZWF0ZVdlYkNoYW5uZWxUcmFuc3BvcnQ9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGJkfTtnZXRTdGF0RXZlbnRUYXJnZXQgPSB3ZWJjaGFubmVsX2Jsb2JfZXMyMDE4LmdldFN0YXRFdmVudFRhcmdldD1mdW5jdGlvbigpe3JldHVybiBqYigpfTtFdmVudCA9IHdlYmNoYW5uZWxfYmxvYl9lczIwMTguRXZlbnQ9STtTdGF0ID0gd2ViY2hhbm5lbF9ibG9iX2VzMjAxOC5TdGF0PXtqYjowLG1iOjEsbmI6MixIYjozLE1iOjQsSmI6NSxLYjo2LEliOjcsR2I6OCxMYjo5LFBST1hZOjEwLE5PUFJPWFk6MTEsRWI6MTIsQWI6MTMsQmI6MTQsemI6MTUsQ2I6MTYsRGI6MTcsZmI6MTgsZWI6MTksZ2I6MjB9O3ViLk5PX0VSUk9SPTA7dWIuVElNRU9VVD04O3ViLkhUVFBfRVJST1I9NjtcbkVycm9yQ29kZSA9IHdlYmNoYW5uZWxfYmxvYl9lczIwMTguRXJyb3JDb2RlPXViO3ZiLkNPTVBMRVRFPVwiY29tcGxldGVcIjtFdmVudFR5cGUgPSB3ZWJjaGFubmVsX2Jsb2JfZXMyMDE4LkV2ZW50VHlwZT12YjtmYi5FdmVudFR5cGU9SDtILk9QRU49XCJhXCI7SC5DTE9TRT1cImJcIjtILkVSUk9SPVwiY1wiO0guTUVTU0FHRT1cImRcIjtDLnByb3RvdHlwZS5saXN0ZW49Qy5wcm90b3R5cGUuSjtXZWJDaGFubmVsID0gd2ViY2hhbm5lbF9ibG9iX2VzMjAxOC5XZWJDaGFubmVsPWZiO0ZldGNoWG1sSHR0cEZhY3RvcnkgPSB3ZWJjaGFubmVsX2Jsb2JfZXMyMDE4LkZldGNoWG1sSHR0cEZhY3Rvcnk9RWM7WC5wcm90b3R5cGUubGlzdGVuT25jZT1YLnByb3RvdHlwZS5LO1gucHJvdG90eXBlLmdldExhc3RFcnJvcj1YLnByb3RvdHlwZS5IYTtYLnByb3RvdHlwZS5nZXRMYXN0RXJyb3JDb2RlPVgucHJvdG90eXBlLnlhO1gucHJvdG90eXBlLmdldFN0YXR1cz1YLnByb3RvdHlwZS5jYTtYLnByb3RvdHlwZS5nZXRSZXNwb25zZUpzb249WC5wcm90b3R5cGUuTGE7WC5wcm90b3R5cGUuZ2V0UmVzcG9uc2VUZXh0PVgucHJvdG90eXBlLmxhO1xuWC5wcm90b3R5cGUuc2VuZD1YLnByb3RvdHlwZS5lYTtYLnByb3RvdHlwZS5zZXRXaXRoQ3JlZGVudGlhbHM9WC5wcm90b3R5cGUuRmE7WGhySW8gPSB3ZWJjaGFubmVsX2Jsb2JfZXMyMDE4LlhocklvPVg7fSkuYXBwbHkoIHR5cGVvZiBjb21tb25qc0dsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyBjb21tb25qc0dsb2JhbCA6IHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyA/IHNlbGYgIDogdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgIDoge30pO1xuXG5leHBvcnQgeyBFcnJvckNvZGUsIEV2ZW50LCBFdmVudFR5cGUsIEZldGNoWG1sSHR0cEZhY3RvcnksIFN0YXQsIFdlYkNoYW5uZWwsIFhocklvLCBjcmVhdGVXZWJDaGFubmVsVHJhbnNwb3J0LCB3ZWJjaGFubmVsX2Jsb2JfZXMyMDE4IGFzIGRlZmF1bHQsIGdldFN0YXRFdmVudFRhcmdldCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9d2ViY2hhbm5lbF9ibG9iX2VzMjAxOC5qcy5tYXBcbiIsInZhciBjb21tb25qc0dsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbFRoaXMgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9O1xuXG52YXIgYmxvb21fYmxvYl9lczIwMTggPSB7fTtcblxuLyoqIEBsaWNlbnNlXG5Db3B5cmlnaHQgVGhlIENsb3N1cmUgTGlicmFyeSBBdXRob3JzLlxuU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEFwYWNoZS0yLjBcbiovXG5cbnZhciBJbnRlZ2VyO1xudmFyIE1kNTtcbihmdW5jdGlvbigpIHt2YXIgaDsvKiogQGxpY2Vuc2VcblxuIENvcHlyaWdodCBUaGUgQ2xvc3VyZSBMaWJyYXJ5IEF1dGhvcnMuXG4gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEFwYWNoZS0yLjBcbiovXG5mdW5jdGlvbiBrKGQsYSl7ZnVuY3Rpb24gYygpe31jLnByb3RvdHlwZT1hLnByb3RvdHlwZTtkLkY9YS5wcm90b3R5cGU7ZC5wcm90b3R5cGU9bmV3IGM7ZC5wcm90b3R5cGUuY29uc3RydWN0b3I9ZDtkLkQ9ZnVuY3Rpb24oZixlLGcpe2Zvcih2YXIgYj1BcnJheShhcmd1bWVudHMubGVuZ3RoLTIpLHI9MjtyPGFyZ3VtZW50cy5sZW5ndGg7cisrKWJbci0yXT1hcmd1bWVudHNbcl07cmV0dXJuIGEucHJvdG90eXBlW2VdLmFwcGx5KGYsYil9O31mdW5jdGlvbiBsKCl7dGhpcy5ibG9ja1NpemU9LTE7fWZ1bmN0aW9uIG0oKXt0aGlzLmJsb2NrU2l6ZT0tMTt0aGlzLmJsb2NrU2l6ZT02NDt0aGlzLmc9QXJyYXkoNCk7dGhpcy5DPUFycmF5KHRoaXMuYmxvY2tTaXplKTt0aGlzLm89dGhpcy5oPTA7dGhpcy51KCk7fWsobSxsKTttLnByb3RvdHlwZS51PWZ1bmN0aW9uKCl7dGhpcy5nWzBdPTE3MzI1ODQxOTM7dGhpcy5nWzFdPTQwMjMyMzM0MTc7dGhpcy5nWzJdPTI1NjIzODMxMDI7dGhpcy5nWzNdPTI3MTczMzg3ODt0aGlzLm89dGhpcy5oPTA7fTtcbmZ1bmN0aW9uIG4oZCxhLGMpe2N8fChjPTApO2NvbnN0IGY9QXJyYXkoMTYpO2lmKHR5cGVvZiBhPT09XCJzdHJpbmdcIilmb3IodmFyIGU9MDtlPDE2OysrZSlmW2VdPWEuY2hhckNvZGVBdChjKyspfGEuY2hhckNvZGVBdChjKyspPDw4fGEuY2hhckNvZGVBdChjKyspPDwxNnxhLmNoYXJDb2RlQXQoYysrKTw8MjQ7ZWxzZSBmb3IoZT0wO2U8MTY7KytlKWZbZV09YVtjKytdfGFbYysrXTw8OHxhW2MrK108PDE2fGFbYysrXTw8MjQ7YT1kLmdbMF07Yz1kLmdbMV07ZT1kLmdbMl07bGV0IGc9ZC5nWzNdLGI7Yj1hKyhnXmMmKGVeZykpK2ZbMF0rMzYxNDA5MDM2MCY0Mjk0OTY3Mjk1O2E9YysoYjw8NyY0Mjk0OTY3Mjk1fGI+Pj4yNSk7Yj1nKyhlXmEmKGNeZSkpK2ZbMV0rMzkwNTQwMjcxMCY0Mjk0OTY3Mjk1O2c9YSsoYjw8MTImNDI5NDk2NzI5NXxiPj4+MjApO2I9ZSsoY15nJihhXmMpKStmWzJdKzYwNjEwNTgxOSY0Mjk0OTY3Mjk1O2U9ZysoYjw8MTcmNDI5NDk2NzI5NXxiPj4+MTUpO1xuYj1jKyhhXmUmKGdeYSkpK2ZbM10rMzI1MDQ0MTk2NiY0Mjk0OTY3Mjk1O2M9ZSsoYjw8MjImNDI5NDk2NzI5NXxiPj4+MTApO2I9YSsoZ15jJihlXmcpKStmWzRdKzQxMTg1NDgzOTkmNDI5NDk2NzI5NTthPWMrKGI8PDcmNDI5NDk2NzI5NXxiPj4+MjUpO2I9ZysoZV5hJihjXmUpKStmWzVdKzEyMDAwODA0MjYmNDI5NDk2NzI5NTtnPWErKGI8PDEyJjQyOTQ5NjcyOTV8Yj4+PjIwKTtiPWUrKGNeZyYoYV5jKSkrZls2XSsyODIxNzM1OTU1JjQyOTQ5NjcyOTU7ZT1nKyhiPDwxNyY0Mjk0OTY3Mjk1fGI+Pj4xNSk7Yj1jKyhhXmUmKGdeYSkpK2ZbN10rNDI0OTI2MTMxMyY0Mjk0OTY3Mjk1O2M9ZSsoYjw8MjImNDI5NDk2NzI5NXxiPj4+MTApO2I9YSsoZ15jJihlXmcpKStmWzhdKzE3NzAwMzU0MTYmNDI5NDk2NzI5NTthPWMrKGI8PDcmNDI5NDk2NzI5NXxiPj4+MjUpO2I9ZysoZV5hJihjXmUpKStmWzldKzIzMzY1NTI4NzkmNDI5NDk2NzI5NTtnPWErKGI8PDEyJjQyOTQ5NjcyOTV8XG5iPj4+MjApO2I9ZSsoY15nJihhXmMpKStmWzEwXSs0Mjk0OTI1MjMzJjQyOTQ5NjcyOTU7ZT1nKyhiPDwxNyY0Mjk0OTY3Mjk1fGI+Pj4xNSk7Yj1jKyhhXmUmKGdeYSkpK2ZbMTFdKzIzMDQ1NjMxMzQmNDI5NDk2NzI5NTtjPWUrKGI8PDIyJjQyOTQ5NjcyOTV8Yj4+PjEwKTtiPWErKGdeYyYoZV5nKSkrZlsxMl0rMTgwNDYwMzY4MiY0Mjk0OTY3Mjk1O2E9YysoYjw8NyY0Mjk0OTY3Mjk1fGI+Pj4yNSk7Yj1nKyhlXmEmKGNeZSkpK2ZbMTNdKzQyNTQ2MjYxOTUmNDI5NDk2NzI5NTtnPWErKGI8PDEyJjQyOTQ5NjcyOTV8Yj4+PjIwKTtiPWUrKGNeZyYoYV5jKSkrZlsxNF0rMjc5Mjk2NTAwNiY0Mjk0OTY3Mjk1O2U9ZysoYjw8MTcmNDI5NDk2NzI5NXxiPj4+MTUpO2I9YysoYV5lJihnXmEpKStmWzE1XSsxMjM2NTM1MzI5JjQyOTQ5NjcyOTU7Yz1lKyhiPDwyMiY0Mjk0OTY3Mjk1fGI+Pj4xMCk7Yj1hKyhlXmcmKGNeZSkpK2ZbMV0rNDEyOTE3MDc4NiY0Mjk0OTY3Mjk1O2E9YysoYjw8XG41JjQyOTQ5NjcyOTV8Yj4+PjI3KTtiPWcrKGNeZSYoYV5jKSkrZls2XSszMjI1NDY1NjY0JjQyOTQ5NjcyOTU7Zz1hKyhiPDw5JjQyOTQ5NjcyOTV8Yj4+PjIzKTtiPWUrKGFeYyYoZ15hKSkrZlsxMV0rNjQzNzE3NzEzJjQyOTQ5NjcyOTU7ZT1nKyhiPDwxNCY0Mjk0OTY3Mjk1fGI+Pj4xOCk7Yj1jKyhnXmEmKGVeZykpK2ZbMF0rMzkyMTA2OTk5NCY0Mjk0OTY3Mjk1O2M9ZSsoYjw8MjAmNDI5NDk2NzI5NXxiPj4+MTIpO2I9YSsoZV5nJihjXmUpKStmWzVdKzM1OTM0MDg2MDUmNDI5NDk2NzI5NTthPWMrKGI8PDUmNDI5NDk2NzI5NXxiPj4+MjcpO2I9ZysoY15lJihhXmMpKStmWzEwXSszODAxNjA4MyY0Mjk0OTY3Mjk1O2c9YSsoYjw8OSY0Mjk0OTY3Mjk1fGI+Pj4yMyk7Yj1lKyhhXmMmKGdeYSkpK2ZbMTVdKzM2MzQ0ODg5NjEmNDI5NDk2NzI5NTtlPWcrKGI8PDE0JjQyOTQ5NjcyOTV8Yj4+PjE4KTtiPWMrKGdeYSYoZV5nKSkrZls0XSszODg5NDI5NDQ4JjQyOTQ5NjcyOTU7Yz1cbmUrKGI8PDIwJjQyOTQ5NjcyOTV8Yj4+PjEyKTtiPWErKGVeZyYoY15lKSkrZls5XSs1Njg0NDY0MzgmNDI5NDk2NzI5NTthPWMrKGI8PDUmNDI5NDk2NzI5NXxiPj4+MjcpO2I9ZysoY15lJihhXmMpKStmWzE0XSszMjc1MTYzNjA2JjQyOTQ5NjcyOTU7Zz1hKyhiPDw5JjQyOTQ5NjcyOTV8Yj4+PjIzKTtiPWUrKGFeYyYoZ15hKSkrZlszXSs0MTA3NjAzMzM1JjQyOTQ5NjcyOTU7ZT1nKyhiPDwxNCY0Mjk0OTY3Mjk1fGI+Pj4xOCk7Yj1jKyhnXmEmKGVeZykpK2ZbOF0rMTE2MzUzMTUwMSY0Mjk0OTY3Mjk1O2M9ZSsoYjw8MjAmNDI5NDk2NzI5NXxiPj4+MTIpO2I9YSsoZV5nJihjXmUpKStmWzEzXSsyODUwMjg1ODI5JjQyOTQ5NjcyOTU7YT1jKyhiPDw1JjQyOTQ5NjcyOTV8Yj4+PjI3KTtiPWcrKGNeZSYoYV5jKSkrZlsyXSs0MjQzNTYzNTEyJjQyOTQ5NjcyOTU7Zz1hKyhiPDw5JjQyOTQ5NjcyOTV8Yj4+PjIzKTtiPWUrKGFeYyYoZ15hKSkrZls3XSsxNzM1MzI4NDczJjQyOTQ5NjcyOTU7XG5lPWcrKGI8PDE0JjQyOTQ5NjcyOTV8Yj4+PjE4KTtiPWMrKGdeYSYoZV5nKSkrZlsxMl0rMjM2ODM1OTU2MiY0Mjk0OTY3Mjk1O2M9ZSsoYjw8MjAmNDI5NDk2NzI5NXxiPj4+MTIpO2I9YSsoY15lXmcpK2ZbNV0rNDI5NDU4ODczOCY0Mjk0OTY3Mjk1O2E9YysoYjw8NCY0Mjk0OTY3Mjk1fGI+Pj4yOCk7Yj1nKyhhXmNeZSkrZls4XSsyMjcyMzkyODMzJjQyOTQ5NjcyOTU7Zz1hKyhiPDwxMSY0Mjk0OTY3Mjk1fGI+Pj4yMSk7Yj1lKyhnXmFeYykrZlsxMV0rMTgzOTAzMDU2MiY0Mjk0OTY3Mjk1O2U9ZysoYjw8MTYmNDI5NDk2NzI5NXxiPj4+MTYpO2I9YysoZV5nXmEpK2ZbMTRdKzQyNTk2NTc3NDAmNDI5NDk2NzI5NTtjPWUrKGI8PDIzJjQyOTQ5NjcyOTV8Yj4+PjkpO2I9YSsoY15lXmcpK2ZbMV0rMjc2Mzk3NTIzNiY0Mjk0OTY3Mjk1O2E9YysoYjw8NCY0Mjk0OTY3Mjk1fGI+Pj4yOCk7Yj1nKyhhXmNeZSkrZls0XSsxMjcyODkzMzUzJjQyOTQ5NjcyOTU7Zz1hKyhiPDwxMSY0Mjk0OTY3Mjk1fFxuYj4+PjIxKTtiPWUrKGdeYV5jKStmWzddKzQxMzk0Njk2NjQmNDI5NDk2NzI5NTtlPWcrKGI8PDE2JjQyOTQ5NjcyOTV8Yj4+PjE2KTtiPWMrKGVeZ15hKStmWzEwXSszMjAwMjM2NjU2JjQyOTQ5NjcyOTU7Yz1lKyhiPDwyMyY0Mjk0OTY3Mjk1fGI+Pj45KTtiPWErKGNeZV5nKStmWzEzXSs2ODEyNzkxNzQmNDI5NDk2NzI5NTthPWMrKGI8PDQmNDI5NDk2NzI5NXxiPj4+MjgpO2I9ZysoYV5jXmUpK2ZbMF0rMzkzNjQzMDA3NCY0Mjk0OTY3Mjk1O2c9YSsoYjw8MTEmNDI5NDk2NzI5NXxiPj4+MjEpO2I9ZSsoZ15hXmMpK2ZbM10rMzU3MjQ0NTMxNyY0Mjk0OTY3Mjk1O2U9ZysoYjw8MTYmNDI5NDk2NzI5NXxiPj4+MTYpO2I9YysoZV5nXmEpK2ZbNl0rNzYwMjkxODkmNDI5NDk2NzI5NTtjPWUrKGI8PDIzJjQyOTQ5NjcyOTV8Yj4+PjkpO2I9YSsoY15lXmcpK2ZbOV0rMzY1NDYwMjgwOSY0Mjk0OTY3Mjk1O2E9YysoYjw8NCY0Mjk0OTY3Mjk1fGI+Pj4yOCk7Yj1nKyhhXmNeZSkrZlsxMl0rXG4zODczMTUxNDYxJjQyOTQ5NjcyOTU7Zz1hKyhiPDwxMSY0Mjk0OTY3Mjk1fGI+Pj4yMSk7Yj1lKyhnXmFeYykrZlsxNV0rNTMwNzQyNTIwJjQyOTQ5NjcyOTU7ZT1nKyhiPDwxNiY0Mjk0OTY3Mjk1fGI+Pj4xNik7Yj1jKyhlXmdeYSkrZlsyXSszMjk5NjI4NjQ1JjQyOTQ5NjcyOTU7Yz1lKyhiPDwyMyY0Mjk0OTY3Mjk1fGI+Pj45KTtiPWErKGVeKGN8fmcpKStmWzBdKzQwOTYzMzY0NTImNDI5NDk2NzI5NTthPWMrKGI8PDYmNDI5NDk2NzI5NXxiPj4+MjYpO2I9ZysoY14oYXx+ZSkpK2ZbN10rMTEyNjg5MTQxNSY0Mjk0OTY3Mjk1O2c9YSsoYjw8MTAmNDI5NDk2NzI5NXxiPj4+MjIpO2I9ZSsoYV4oZ3x+YykpK2ZbMTRdKzI4Nzg2MTIzOTEmNDI5NDk2NzI5NTtlPWcrKGI8PDE1JjQyOTQ5NjcyOTV8Yj4+PjE3KTtiPWMrKGdeKGV8fmEpKStmWzVdKzQyMzc1MzMyNDEmNDI5NDk2NzI5NTtjPWUrKGI8PDIxJjQyOTQ5NjcyOTV8Yj4+PjExKTtiPWErKGVeKGN8fmcpKStmWzEyXSsxNzAwNDg1NTcxJlxuNDI5NDk2NzI5NTthPWMrKGI8PDYmNDI5NDk2NzI5NXxiPj4+MjYpO2I9ZysoY14oYXx+ZSkpK2ZbM10rMjM5OTk4MDY5MCY0Mjk0OTY3Mjk1O2c9YSsoYjw8MTAmNDI5NDk2NzI5NXxiPj4+MjIpO2I9ZSsoYV4oZ3x+YykpK2ZbMTBdKzQyOTM5MTU3NzMmNDI5NDk2NzI5NTtlPWcrKGI8PDE1JjQyOTQ5NjcyOTV8Yj4+PjE3KTtiPWMrKGdeKGV8fmEpKStmWzFdKzIyNDAwNDQ0OTcmNDI5NDk2NzI5NTtjPWUrKGI8PDIxJjQyOTQ5NjcyOTV8Yj4+PjExKTtiPWErKGVeKGN8fmcpKStmWzhdKzE4NzMzMTMzNTkmNDI5NDk2NzI5NTthPWMrKGI8PDYmNDI5NDk2NzI5NXxiPj4+MjYpO2I9ZysoY14oYXx+ZSkpK2ZbMTVdKzQyNjQzNTU1NTImNDI5NDk2NzI5NTtnPWErKGI8PDEwJjQyOTQ5NjcyOTV8Yj4+PjIyKTtiPWUrKGFeKGd8fmMpKStmWzZdKzI3MzQ3Njg5MTYmNDI5NDk2NzI5NTtlPWcrKGI8PDE1JjQyOTQ5NjcyOTV8Yj4+PjE3KTtiPWMrKGdeKGV8fmEpKStmWzEzXSsxMzA5MTUxNjQ5JlxuNDI5NDk2NzI5NTtjPWUrKGI8PDIxJjQyOTQ5NjcyOTV8Yj4+PjExKTtiPWErKGVeKGN8fmcpKStmWzRdKzQxNDk0NDQyMjYmNDI5NDk2NzI5NTthPWMrKGI8PDYmNDI5NDk2NzI5NXxiPj4+MjYpO2I9ZysoY14oYXx+ZSkpK2ZbMTFdKzMxNzQ3NTY5MTcmNDI5NDk2NzI5NTtnPWErKGI8PDEwJjQyOTQ5NjcyOTV8Yj4+PjIyKTtiPWUrKGFeKGd8fmMpKStmWzJdKzcxODc4NzI1OSY0Mjk0OTY3Mjk1O2U9ZysoYjw8MTUmNDI5NDk2NzI5NXxiPj4+MTcpO2I9YysoZ14oZXx+YSkpK2ZbOV0rMzk1MTQ4MTc0NSY0Mjk0OTY3Mjk1O2QuZ1swXT1kLmdbMF0rYSY0Mjk0OTY3Mjk1O2QuZ1sxXT1kLmdbMV0rKGUrKGI8PDIxJjQyOTQ5NjcyOTV8Yj4+PjExKSkmNDI5NDk2NzI5NTtkLmdbMl09ZC5nWzJdK2UmNDI5NDk2NzI5NTtkLmdbM109ZC5nWzNdK2cmNDI5NDk2NzI5NTt9XG5tLnByb3RvdHlwZS52PWZ1bmN0aW9uKGQsYSl7YT09PXZvaWQgMCYmKGE9ZC5sZW5ndGgpO2NvbnN0IGM9YS10aGlzLmJsb2NrU2l6ZSxmPXRoaXMuQztsZXQgZT10aGlzLmgsZz0wO2Zvcig7ZzxhOyl7aWYoZT09MClmb3IoO2c8PWM7KW4odGhpcyxkLGcpLGcrPXRoaXMuYmxvY2tTaXplO2lmKHR5cGVvZiBkPT09XCJzdHJpbmdcIilmb3IoO2c8YTspe2lmKGZbZSsrXT1kLmNoYXJDb2RlQXQoZysrKSxlPT10aGlzLmJsb2NrU2l6ZSl7bih0aGlzLGYpO2U9MDticmVha319ZWxzZSBmb3IoO2c8YTspaWYoZltlKytdPWRbZysrXSxlPT10aGlzLmJsb2NrU2l6ZSl7bih0aGlzLGYpO2U9MDticmVha319dGhpcy5oPWU7dGhpcy5vKz1hO307XG5tLnByb3RvdHlwZS5BPWZ1bmN0aW9uKCl7dmFyIGQ9QXJyYXkoKHRoaXMuaDw1Nj90aGlzLmJsb2NrU2l6ZTp0aGlzLmJsb2NrU2l6ZSoyKS10aGlzLmgpO2RbMF09MTI4O2Zvcih2YXIgYT0xO2E8ZC5sZW5ndGgtODsrK2EpZFthXT0wO2E9dGhpcy5vKjg7Zm9yKHZhciBjPWQubGVuZ3RoLTg7YzxkLmxlbmd0aDsrK2MpZFtjXT1hJjI1NSxhLz0yNTY7dGhpcy52KGQpO2Q9QXJyYXkoMTYpO2E9MDtmb3IoYz0wO2M8NDsrK2MpZm9yKGxldCBmPTA7ZjwzMjtmKz04KWRbYSsrXT10aGlzLmdbY10+Pj5mJjI1NTtyZXR1cm4gZH07ZnVuY3Rpb24gcChkLGEpe3ZhciBjPXE7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChjLGQpP2NbZF06Y1tkXT1hKGQpfWZ1bmN0aW9uIHQoZCxhKXt0aGlzLmg9YTtjb25zdCBjPVtdO2xldCBmPSEwO2ZvcihsZXQgZT1kLmxlbmd0aC0xO2U+PTA7ZS0tKXtjb25zdCBnPWRbZV18MDtmJiZnPT1hfHwoY1tlXT1nLGY9ITEpO310aGlzLmc9Yzt9dmFyIHE9e307ZnVuY3Rpb24gdShkKXtyZXR1cm4gLTEyODw9ZCYmZDwxMjg/cChkLGZ1bmN0aW9uKGEpe3JldHVybiBuZXcgdChbYXwwXSxhPDA/LTE6MCl9KTpuZXcgdChbZHwwXSxkPDA/LTE6MCl9ZnVuY3Rpb24gdihkKXtpZihpc05hTihkKXx8IWlzRmluaXRlKGQpKXJldHVybiB3O2lmKGQ8MClyZXR1cm4geCh2KC1kKSk7Y29uc3QgYT1bXTtsZXQgYz0xO2ZvcihsZXQgZj0wO2Q+PWM7ZisrKWFbZl09ZC9jfDAsYyo9NDI5NDk2NzI5NjtyZXR1cm4gbmV3IHQoYSwwKX1cbmZ1bmN0aW9uIHkoZCxhKXtpZihkLmxlbmd0aD09MCl0aHJvdyBFcnJvcihcIm51bWJlciBmb3JtYXQgZXJyb3I6IGVtcHR5IHN0cmluZ1wiKTthPWF8fDEwO2lmKGE8Mnx8MzY8YSl0aHJvdyBFcnJvcihcInJhZGl4IG91dCBvZiByYW5nZTogXCIrYSk7aWYoZC5jaGFyQXQoMCk9PVwiLVwiKXJldHVybiB4KHkoZC5zdWJzdHJpbmcoMSksYSkpO2lmKGQuaW5kZXhPZihcIi1cIik+PTApdGhyb3cgRXJyb3IoJ251bWJlciBmb3JtYXQgZXJyb3I6IGludGVyaW9yIFwiLVwiIGNoYXJhY3RlcicpO2NvbnN0IGM9dihNYXRoLnBvdyhhLDgpKTtsZXQgZj13O2ZvcihsZXQgZz0wO2c8ZC5sZW5ndGg7Zys9OCl7dmFyIGU9TWF0aC5taW4oOCxkLmxlbmd0aC1nKTtjb25zdCBiPXBhcnNlSW50KGQuc3Vic3RyaW5nKGcsZytlKSxhKTtlPDg/KGU9dihNYXRoLnBvdyhhLGUpKSxmPWYuaihlKS5hZGQodihiKSkpOihmPWYuaihjKSxmPWYuYWRkKHYoYikpKTt9cmV0dXJuIGZ9dmFyIHc9dSgwKSx6PXUoMSksQT11KDE2Nzc3MjE2KTtcbmg9dC5wcm90b3R5cGU7aC5tPWZ1bmN0aW9uKCl7aWYoQih0aGlzKSlyZXR1cm4gLXgodGhpcykubSgpO2xldCBkPTAsYT0xO2ZvcihsZXQgYz0wO2M8dGhpcy5nLmxlbmd0aDtjKyspe2NvbnN0IGY9dGhpcy5pKGMpO2QrPShmPj0wP2Y6NDI5NDk2NzI5NitmKSphO2EqPTQyOTQ5NjcyOTY7fXJldHVybiBkfTtcbmgudG9TdHJpbmc9ZnVuY3Rpb24oZCl7ZD1kfHwxMDtpZihkPDJ8fDM2PGQpdGhyb3cgRXJyb3IoXCJyYWRpeCBvdXQgb2YgcmFuZ2U6IFwiK2QpO2lmKEModGhpcykpcmV0dXJuIFwiMFwiO2lmKEIodGhpcykpcmV0dXJuIFwiLVwiK3godGhpcykudG9TdHJpbmcoZCk7Y29uc3QgYT12KE1hdGgucG93KGQsNikpO3ZhciBjPXRoaXM7bGV0IGY9XCJcIjtmb3IoOzspe2NvbnN0IGU9RChjLGEpLmc7Yz1GKGMsZS5qKGEpKTtsZXQgZz0oKGMuZy5sZW5ndGg+MD9jLmdbMF06Yy5oKT4+PjApLnRvU3RyaW5nKGQpO2M9ZTtpZihDKGMpKXJldHVybiBnK2Y7Zm9yKDtnLmxlbmd0aDw2OylnPVwiMFwiK2c7Zj1nK2Y7fX07aC5pPWZ1bmN0aW9uKGQpe3JldHVybiBkPDA/MDpkPHRoaXMuZy5sZW5ndGg/dGhpcy5nW2RdOnRoaXMuaH07ZnVuY3Rpb24gQyhkKXtpZihkLmghPTApcmV0dXJuICExO2ZvcihsZXQgYT0wO2E8ZC5nLmxlbmd0aDthKyspaWYoZC5nW2FdIT0wKXJldHVybiAhMTtyZXR1cm4gITB9XG5mdW5jdGlvbiBCKGQpe3JldHVybiBkLmg9PS0xfWgubD1mdW5jdGlvbihkKXtkPUYodGhpcyxkKTtyZXR1cm4gQihkKT8tMTpDKGQpPzA6MX07ZnVuY3Rpb24geChkKXtjb25zdCBhPWQuZy5sZW5ndGgsYz1bXTtmb3IobGV0IGY9MDtmPGE7ZisrKWNbZl09fmQuZ1tmXTtyZXR1cm4gKG5ldyB0KGMsfmQuaCkpLmFkZCh6KX1oLmFicz1mdW5jdGlvbigpe3JldHVybiBCKHRoaXMpP3godGhpcyk6dGhpc307aC5hZGQ9ZnVuY3Rpb24oZCl7Y29uc3QgYT1NYXRoLm1heCh0aGlzLmcubGVuZ3RoLGQuZy5sZW5ndGgpLGM9W107bGV0IGY9MDtmb3IobGV0IGU9MDtlPD1hO2UrKyl7bGV0IGc9ZisodGhpcy5pKGUpJjY1NTM1KSsoZC5pKGUpJjY1NTM1KSxiPShnPj4+MTYpKyh0aGlzLmkoZSk+Pj4xNikrKGQuaShlKT4+PjE2KTtmPWI+Pj4xNjtnJj02NTUzNTtiJj02NTUzNTtjW2VdPWI8PDE2fGc7fXJldHVybiBuZXcgdChjLGNbYy5sZW5ndGgtMV0mLTIxNDc0ODM2NDg/LTE6MCl9O1xuZnVuY3Rpb24gRihkLGEpe3JldHVybiBkLmFkZCh4KGEpKX1cbmguaj1mdW5jdGlvbihkKXtpZihDKHRoaXMpfHxDKGQpKXJldHVybiB3O2lmKEIodGhpcykpcmV0dXJuIEIoZCk/eCh0aGlzKS5qKHgoZCkpOngoeCh0aGlzKS5qKGQpKTtpZihCKGQpKXJldHVybiB4KHRoaXMuaih4KGQpKSk7aWYodGhpcy5sKEEpPDAmJmQubChBKTwwKXJldHVybiB2KHRoaXMubSgpKmQubSgpKTtjb25zdCBhPXRoaXMuZy5sZW5ndGgrZC5nLmxlbmd0aCxjPVtdO2Zvcih2YXIgZj0wO2Y8MiphO2YrKyljW2ZdPTA7Zm9yKGY9MDtmPHRoaXMuZy5sZW5ndGg7ZisrKWZvcihsZXQgZT0wO2U8ZC5nLmxlbmd0aDtlKyspe2NvbnN0IGc9dGhpcy5pKGYpPj4+MTYsYj10aGlzLmkoZikmNjU1MzUscj1kLmkoZSk+Pj4xNixFPWQuaShlKSY2NTUzNTtjWzIqZisyKmVdKz1iKkU7RyhjLDIqZisyKmUpO2NbMipmKzIqZSsxXSs9ZypFO0coYywyKmYrMiplKzEpO2NbMipmKzIqZSsxXSs9YipyO0coYywyKmYrMiplKzEpO2NbMipmKzIqZSsyXSs9ZypyO0coYywyKmYrMiplKzIpO31mb3IoZD1cbjA7ZDxhO2QrKyljW2RdPWNbMipkKzFdPDwxNnxjWzIqZF07Zm9yKGQ9YTtkPDIqYTtkKyspY1tkXT0wO3JldHVybiBuZXcgdChjLDApfTtmdW5jdGlvbiBHKGQsYSl7Zm9yKDsoZFthXSY2NTUzNSkhPWRbYV07KWRbYSsxXSs9ZFthXT4+PjE2LGRbYV0mPTY1NTM1LGErKzt9ZnVuY3Rpb24gSChkLGEpe3RoaXMuZz1kO3RoaXMuaD1hO31cbmZ1bmN0aW9uIEQoZCxhKXtpZihDKGEpKXRocm93IEVycm9yKFwiZGl2aXNpb24gYnkgemVyb1wiKTtpZihDKGQpKXJldHVybiBuZXcgSCh3LHcpO2lmKEIoZCkpcmV0dXJuIGE9RCh4KGQpLGEpLG5ldyBIKHgoYS5nKSx4KGEuaCkpO2lmKEIoYSkpcmV0dXJuIGE9RChkLHgoYSkpLG5ldyBIKHgoYS5nKSxhLmgpO2lmKGQuZy5sZW5ndGg+MzApe2lmKEIoZCl8fEIoYSkpdGhyb3cgRXJyb3IoXCJzbG93RGl2aWRlXyBvbmx5IHdvcmtzIHdpdGggcG9zaXRpdmUgaW50ZWdlcnMuXCIpO2Zvcih2YXIgYz16LGY9YTtmLmwoZCk8PTA7KWM9SShjKSxmPUkoZik7dmFyIGU9SihjLDEpLGc9SihmLDEpO2Y9SihmLDIpO2ZvcihjPUooYywyKTshQyhmKTspe3ZhciBiPWcuYWRkKGYpO2IubChkKTw9MCYmKGU9ZS5hZGQoYyksZz1iKTtmPUooZiwxKTtjPUooYywxKTt9YT1GKGQsZS5qKGEpKTtyZXR1cm4gbmV3IEgoZSxhKX1mb3IoZT13O2QubChhKT49MDspe2M9TWF0aC5tYXgoMSxNYXRoLmZsb29yKGQubSgpL1xuYS5tKCkpKTtmPU1hdGguY2VpbChNYXRoLmxvZyhjKS9NYXRoLkxOMik7Zj1mPD00OD8xOk1hdGgucG93KDIsZi00OCk7Zz12KGMpO2ZvcihiPWcuaihhKTtCKGIpfHxiLmwoZCk+MDspYy09ZixnPXYoYyksYj1nLmooYSk7QyhnKSYmKGc9eik7ZT1lLmFkZChnKTtkPUYoZCxiKTt9cmV0dXJuIG5ldyBIKGUsZCl9aC5CPWZ1bmN0aW9uKGQpe3JldHVybiBEKHRoaXMsZCkuaH07aC5hbmQ9ZnVuY3Rpb24oZCl7Y29uc3QgYT1NYXRoLm1heCh0aGlzLmcubGVuZ3RoLGQuZy5sZW5ndGgpLGM9W107Zm9yKGxldCBmPTA7ZjxhO2YrKyljW2ZdPXRoaXMuaShmKSZkLmkoZik7cmV0dXJuIG5ldyB0KGMsdGhpcy5oJmQuaCl9O2gub3I9ZnVuY3Rpb24oZCl7Y29uc3QgYT1NYXRoLm1heCh0aGlzLmcubGVuZ3RoLGQuZy5sZW5ndGgpLGM9W107Zm9yKGxldCBmPTA7ZjxhO2YrKyljW2ZdPXRoaXMuaShmKXxkLmkoZik7cmV0dXJuIG5ldyB0KGMsdGhpcy5ofGQuaCl9O1xuaC54b3I9ZnVuY3Rpb24oZCl7Y29uc3QgYT1NYXRoLm1heCh0aGlzLmcubGVuZ3RoLGQuZy5sZW5ndGgpLGM9W107Zm9yKGxldCBmPTA7ZjxhO2YrKyljW2ZdPXRoaXMuaShmKV5kLmkoZik7cmV0dXJuIG5ldyB0KGMsdGhpcy5oXmQuaCl9O2Z1bmN0aW9uIEkoZCl7Y29uc3QgYT1kLmcubGVuZ3RoKzEsYz1bXTtmb3IobGV0IGY9MDtmPGE7ZisrKWNbZl09ZC5pKGYpPDwxfGQuaShmLTEpPj4+MzE7cmV0dXJuIG5ldyB0KGMsZC5oKX1mdW5jdGlvbiBKKGQsYSl7Y29uc3QgYz1hPj41O2ElPTMyO2NvbnN0IGY9ZC5nLmxlbmd0aC1jLGU9W107Zm9yKGxldCBnPTA7ZzxmO2crKyllW2ddPWE+MD9kLmkoZytjKT4+PmF8ZC5pKGcrYysxKTw8MzItYTpkLmkoZytjKTtyZXR1cm4gbmV3IHQoZSxkLmgpfW0ucHJvdG90eXBlLmRpZ2VzdD1tLnByb3RvdHlwZS5BO20ucHJvdG90eXBlLnJlc2V0PW0ucHJvdG90eXBlLnU7bS5wcm90b3R5cGUudXBkYXRlPW0ucHJvdG90eXBlLnY7TWQ1ID0gYmxvb21fYmxvYl9lczIwMTguTWQ1PW07dC5wcm90b3R5cGUuYWRkPXQucHJvdG90eXBlLmFkZDt0LnByb3RvdHlwZS5tdWx0aXBseT10LnByb3RvdHlwZS5qO3QucHJvdG90eXBlLm1vZHVsbz10LnByb3RvdHlwZS5CO3QucHJvdG90eXBlLmNvbXBhcmU9dC5wcm90b3R5cGUubDt0LnByb3RvdHlwZS50b051bWJlcj10LnByb3RvdHlwZS5tO3QucHJvdG90eXBlLnRvU3RyaW5nPXQucHJvdG90eXBlLnRvU3RyaW5nO3QucHJvdG90eXBlLmdldEJpdHM9dC5wcm90b3R5cGUuaTt0LmZyb21OdW1iZXI9djt0LmZyb21TdHJpbmc9eTtJbnRlZ2VyID0gYmxvb21fYmxvYl9lczIwMTguSW50ZWdlcj10O30pLmFwcGx5KCB0eXBlb2YgY29tbW9uanNHbG9iYWwgIT09ICd1bmRlZmluZWQnID8gY29tbW9uanNHbG9iYWwgOiB0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmICA6IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93ICA6IHt9KTtcblxuZXhwb3J0IHsgSW50ZWdlciwgTWQ1LCBibG9vbV9ibG9iX2VzMjAxOCBhcyBkZWZhdWx0IH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ibG9vbV9ibG9iX2VzMjAxOC5qcy5tYXBcbiIsImltcG9ydCB7IHIgYXMgcmVnaXN0ZXJBdXRoLCBpIGFzIGluaXRpYWxpemVBdXRoLCBhIGFzIGluZGV4ZWREQkxvY2FsUGVyc2lzdGVuY2UsIGMgYXMgY29ubmVjdEF1dGhFbXVsYXRvciB9IGZyb20gJy4vcmVnaXN0ZXItNzk5M2I3YWYuanMnO1xuZXhwb3J0IHsgWSBhcyBBY3Rpb25Db2RlVVJMLCBtIGFzIEF1dGhDcmVkZW50aWFsLCBBIGFzIEF1dGhFcnJvckNvZGVzLCBFIGFzIEVtYWlsQXV0aENyZWRlbnRpYWwsIHEgYXMgRW1haWxBdXRoUHJvdmlkZXIsIEYgYXMgRmFjZWJvb2tBdXRoUHJvdmlkZXIsIHQgYXMgR2l0aHViQXV0aFByb3ZpZGVyLCBHIGFzIEdvb2dsZUF1dGhQcm92aWRlciwgTyBhcyBPQXV0aENyZWRlbnRpYWwsIHcgYXMgT0F1dGhQcm92aWRlciwgUCBhcyBQaG9uZUF1dGhDcmVkZW50aWFsLCBTIGFzIFNBTUxBdXRoUHJvdmlkZXIsIFQgYXMgVG90cE11bHRpRmFjdG9yR2VuZXJhdG9yLCBiIGFzIFRvdHBTZWNyZXQsIHggYXMgVHdpdHRlckF1dGhQcm92aWRlciwgSiBhcyBhcHBseUFjdGlvbkNvZGUsIGUgYXMgYmVmb3JlQXV0aFN0YXRlQ2hhbmdlZCwgSyBhcyBjaGVja0FjdGlvbkNvZGUsIEkgYXMgY29uZmlybVBhc3N3b3JkUmVzZXQsIGMgYXMgY29ubmVjdEF1dGhFbXVsYXRvciwgTSBhcyBjcmVhdGVVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQsIGwgYXMgZGVidWdFcnJvck1hcCwgayBhcyBkZWxldGVVc2VyLCBWIGFzIGZldGNoU2lnbkluTWV0aG9kc0ZvckVtYWlsLCBhNCBhcyBnZXRBZGRpdGlvbmFsVXNlckluZm8sIGExIGFzIGdldElkVG9rZW4sIGEyIGFzIGdldElkVG9rZW5SZXN1bHQsIGE2IGFzIGdldE11bHRpRmFjdG9yUmVzb2x2ZXIsIG4gYXMgaW5NZW1vcnlQZXJzaXN0ZW5jZSwgYSBhcyBpbmRleGVkREJMb2NhbFBlcnNpc3RlbmNlLCBpIGFzIGluaXRpYWxpemVBdXRoLCBkIGFzIGluaXRpYWxpemVSZWNhcHRjaGFDb25maWcsIFIgYXMgaXNTaWduSW5XaXRoRW1haWxMaW5rLCBCIGFzIGxpbmtXaXRoQ3JlZGVudGlhbCwgYTcgYXMgbXVsdGlGYWN0b3IsIGYgYXMgb25BdXRoU3RhdGVDaGFuZ2VkLCBvIGFzIG9uSWRUb2tlbkNoYW5nZWQsIFogYXMgcGFyc2VBY3Rpb25Db2RlVVJMLCBwIGFzIHByb2RFcnJvck1hcCwgQyBhcyByZWF1dGhlbnRpY2F0ZVdpdGhDcmVkZW50aWFsLCBhNSBhcyByZWxvYWQsIGogYXMgcmV2b2tlQWNjZXNzVG9rZW4sIFcgYXMgc2VuZEVtYWlsVmVyaWZpY2F0aW9uLCBIIGFzIHNlbmRQYXNzd29yZFJlc2V0RW1haWwsIFEgYXMgc2VuZFNpZ25JbkxpbmtUb0VtYWlsLCBzIGFzIHNldFBlcnNpc3RlbmNlLCB5IGFzIHNpZ25JbkFub255bW91c2x5LCB6IGFzIHNpZ25JbldpdGhDcmVkZW50aWFsLCBEIGFzIHNpZ25JbldpdGhDdXN0b21Ub2tlbiwgTiBhcyBzaWduSW5XaXRoRW1haWxBbmRQYXNzd29yZCwgVSBhcyBzaWduSW5XaXRoRW1haWxMaW5rLCBoIGFzIHNpZ25PdXQsIGEzIGFzIHVubGluaywgZyBhcyB1cGRhdGVDdXJyZW50VXNlciwgJCBhcyB1cGRhdGVFbWFpbCwgYTAgYXMgdXBkYXRlUGFzc3dvcmQsIF8gYXMgdXBkYXRlUHJvZmlsZSwgdSBhcyB1c2VEZXZpY2VMYW5ndWFnZSwgdiBhcyB2YWxpZGF0ZVBhc3N3b3JkLCBYIGFzIHZlcmlmeUJlZm9yZVVwZGF0ZUVtYWlsLCBMIGFzIHZlcmlmeVBhc3N3b3JkUmVzZXRDb2RlIH0gZnJvbSAnLi9yZWdpc3Rlci03OTkzYjdhZi5qcyc7XG5pbXBvcnQgeyBfZ2V0UHJvdmlkZXIsIGdldEFwcCB9IGZyb20gJ0BmaXJlYmFzZS9hcHAnO1xuaW1wb3J0IHsgZ2V0RGVmYXVsdEVtdWxhdG9ySG9zdCB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmltcG9ydCAnQGZpcmViYXNlL2NvbXBvbmVudCc7XG5pbXBvcnQgJ0BmaXJlYmFzZS9sb2dnZXInO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBBdXRoIGluc3RhbmNlIGFzc29jaWF0ZWQgd2l0aCB0aGUgcHJvdmlkZWQge0BsaW5rIEBmaXJlYmFzZS9hcHAjRmlyZWJhc2VBcHB9LlxuICogSWYgbm8gaW5zdGFuY2UgZXhpc3RzLCBpbml0aWFsaXplcyBhbiBBdXRoIGluc3RhbmNlIHdpdGggcGxhdGZvcm0tc3BlY2lmaWMgZGVmYXVsdCBkZXBlbmRlbmNpZXMuXG4gKlxuICogQHBhcmFtIGFwcCAtIFRoZSBGaXJlYmFzZSBBcHAuXG4gKlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiBnZXRBdXRoKGFwcCA9IGdldEFwcCgpKSB7XG4gICAgY29uc3QgcHJvdmlkZXIgPSBfZ2V0UHJvdmlkZXIoYXBwLCAnYXV0aCcpO1xuICAgIGlmIChwcm92aWRlci5pc0luaXRpYWxpemVkKCkpIHtcbiAgICAgICAgcmV0dXJuIHByb3ZpZGVyLmdldEltbWVkaWF0ZSgpO1xuICAgIH1cbiAgICBjb25zdCBhdXRoID0gaW5pdGlhbGl6ZUF1dGgoYXBwLCB7XG4gICAgICAgIHBlcnNpc3RlbmNlOiBbaW5kZXhlZERCTG9jYWxQZXJzaXN0ZW5jZV1cbiAgICB9KTtcbiAgICBjb25zdCBhdXRoRW11bGF0b3JIb3N0ID0gZ2V0RGVmYXVsdEVtdWxhdG9ySG9zdCgnYXV0aCcpO1xuICAgIGlmIChhdXRoRW11bGF0b3JIb3N0KSB7XG4gICAgICAgIGNvbm5lY3RBdXRoRW11bGF0b3IoYXV0aCwgYGh0dHA6Ly8ke2F1dGhFbXVsYXRvckhvc3R9YCk7XG4gICAgfVxuICAgIHJldHVybiBhdXRoO1xufVxucmVnaXN0ZXJBdXRoKFwiV2ViRXh0ZW5zaW9uXCIgLyogQ2xpZW50UGxhdGZvcm0uV0VCX0VYVEVOU0lPTiAqLyk7XG5cbmV4cG9ydCB7IGdldEF1dGggfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcFxuIiwiaW1wb3J0IHsgX3JlZ2lzdGVyQ29tcG9uZW50LCByZWdpc3RlclZlcnNpb24sIF9pc0ZpcmViYXNlU2VydmVyQXBwLCBfZ2V0UHJvdmlkZXIsIGdldEFwcCwgX3JlbW92ZVNlcnZpY2VJbnN0YW5jZSwgU0RLX1ZFUlNJT04gfSBmcm9tICdAZmlyZWJhc2UvYXBwJztcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJ0BmaXJlYmFzZS9jb21wb25lbnQnO1xuaW1wb3J0IHsgTG9nZ2VyLCBMb2dMZXZlbCB9IGZyb20gJ0BmaXJlYmFzZS9sb2dnZXInO1xuaW1wb3J0IHsgRmlyZWJhc2VFcnJvciwgaXNDbG91ZFdvcmtzdGF0aW9uLCBwaW5nU2VydmVyLCB1cGRhdGVFbXVsYXRvckJhbm5lciwgZGVlcEVxdWFsLCBjcmVhdGVNb2NrVXNlclRva2VuLCBnZXRNb2R1bGFySW5zdGFuY2UsIGdldERlZmF1bHRFbXVsYXRvckhvc3RuYW1lQW5kUG9ydCwgZ2V0R2xvYmFsLCBpc0luZGV4ZWREQkF2YWlsYWJsZSwgZ2V0VUEsIGlzU2FmYXJpLCBpc1NhZmFyaU9yV2Via2l0IH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuaW1wb3J0IHsgSW50ZWdlciwgTWQ1IH0gZnJvbSAnQGZpcmViYXNlL3dlYmNoYW5uZWwtd3JhcHBlci9ibG9vbS1ibG9iJztcbmltcG9ydCB7IFhocklvLCBFdmVudFR5cGUsIEVycm9yQ29kZSwgY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydCwgZ2V0U3RhdEV2ZW50VGFyZ2V0LCBXZWJDaGFubmVsLCBFdmVudCwgU3RhdCB9IGZyb20gJ0BmaXJlYmFzZS93ZWJjaGFubmVsLXdyYXBwZXIvd2ViY2hhbm5lbC1ibG9iJztcblxuY29uc3QgRiA9IFwiQGZpcmViYXNlL2ZpcmVzdG9yZVwiLCBNID0gXCI0LjkuMlwiO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBTaW1wbGUgd3JhcHBlciBhcm91bmQgYSBudWxsYWJsZSBVSUQuIE1vc3RseSBleGlzdHMgdG8gbWFrZSBjb2RlIG1vcmVcbiAqIHJlYWRhYmxlLlxuICovXG5jbGFzcyBVc2VyIHtcbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHRoaXMudWlkID0gZTtcbiAgICB9XG4gICAgaXNBdXRoZW50aWNhdGVkKCkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPSB0aGlzLnVpZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGtleSByZXByZXNlbnRpbmcgdGhpcyB1c2VyLCBzdWl0YWJsZSBmb3IgaW5jbHVzaW9uIGluIGFcbiAgICAgKiBkaWN0aW9uYXJ5LlxuICAgICAqLyAgICB0b0tleSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNBdXRoZW50aWNhdGVkKCkgPyBcInVpZDpcIiArIHRoaXMudWlkIDogXCJhbm9ueW1vdXMtdXNlclwiO1xuICAgIH1cbiAgICBpc0VxdWFsKGUpIHtcbiAgICAgICAgcmV0dXJuIGUudWlkID09PSB0aGlzLnVpZDtcbiAgICB9XG59XG5cbi8qKiBBIHVzZXIgd2l0aCBhIG51bGwgVUlELiAqLyBVc2VyLlVOQVVUSEVOVElDQVRFRCA9IG5ldyBVc2VyKG51bGwpLCBcbi8vIFRPRE8obWlrZWxlaGVuKTogTG9vayBpbnRvIGdldHRpbmcgYSBwcm9wZXIgdWlkLWVxdWl2YWxlbnQgZm9yXG4vLyBub24tRmlyZWJhc2VBdXRoIHByb3ZpZGVycy5cblVzZXIuR09PR0xFX0NSRURFTlRJQUxTID0gbmV3IFVzZXIoXCJnb29nbGUtY3JlZGVudGlhbHMtdWlkXCIpLCBVc2VyLkZJUlNUX1BBUlRZID0gbmV3IFVzZXIoXCJmaXJzdC1wYXJ0eS11aWRcIiksIFxuVXNlci5NT0NLX1VTRVIgPSBuZXcgVXNlcihcIm1vY2stdXNlclwiKTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmxldCB4ID0gXCIxMi4zLjBcIjtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IE8gPSBuZXcgTG9nZ2VyKFwiQGZpcmViYXNlL2ZpcmVzdG9yZVwiKTtcblxuLy8gSGVscGVyIG1ldGhvZHMgYXJlIG5lZWRlZCBiZWNhdXNlIHZhcmlhYmxlcyBjYW4ndCBiZSBleHBvcnRlZCBhcyByZWFkL3dyaXRlXG5mdW5jdGlvbiBfX1BSSVZBVEVfZ2V0TG9nTGV2ZWwoKSB7XG4gICAgcmV0dXJuIE8ubG9nTGV2ZWw7XG59XG5cbi8qKlxuICogU2V0cyB0aGUgdmVyYm9zaXR5IG9mIENsb3VkIEZpcmVzdG9yZSBsb2dzIChkZWJ1ZywgZXJyb3IsIG9yIHNpbGVudCkuXG4gKlxuICogQHBhcmFtIGxvZ0xldmVsIC0gVGhlIHZlcmJvc2l0eSB5b3Ugc2V0IGZvciBhY3Rpdml0eSBhbmQgZXJyb3IgbG9nZ2luZy4gQ2FuXG4gKiAgIGJlIGFueSBvZiB0aGUgZm9sbG93aW5nIHZhbHVlczpcbiAqXG4gKiAgIDx1bD5cbiAqICAgICA8bGk+YGRlYnVnYCBmb3IgdGhlIG1vc3QgdmVyYm9zZSBsb2dnaW5nIGxldmVsLCBwcmltYXJpbHkgZm9yXG4gKiAgICAgZGVidWdnaW5nLjwvbGk+XG4gKiAgICAgPGxpPmBlcnJvcmAgdG8gbG9nIGVycm9ycyBvbmx5LjwvbGk+XG4gKiAgICAgPGxpPjxjb2RlPmBzaWxlbnRgIHRvIHR1cm4gb2ZmIGxvZ2dpbmcuPC9saT5cbiAqICAgPC91bD5cbiAqLyBmdW5jdGlvbiBzZXRMb2dMZXZlbChlKSB7XG4gICAgTy5zZXRMb2dMZXZlbChlKTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2xvZ0RlYnVnKGUsIC4uLnQpIHtcbiAgICBpZiAoTy5sb2dMZXZlbCA8PSBMb2dMZXZlbC5ERUJVRykge1xuICAgICAgICBjb25zdCBuID0gdC5tYXAoX19QUklWQVRFX2FyZ1RvU3RyaW5nKTtcbiAgICAgICAgTy5kZWJ1ZyhgRmlyZXN0b3JlICgke3h9KTogJHtlfWAsIC4uLm4pO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2xvZ0Vycm9yKGUsIC4uLnQpIHtcbiAgICBpZiAoTy5sb2dMZXZlbCA8PSBMb2dMZXZlbC5FUlJPUikge1xuICAgICAgICBjb25zdCBuID0gdC5tYXAoX19QUklWQVRFX2FyZ1RvU3RyaW5nKTtcbiAgICAgICAgTy5lcnJvcihgRmlyZXN0b3JlICgke3h9KTogJHtlfWAsIC4uLm4pO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfbG9nV2FybihlLCAuLi50KSB7XG4gICAgaWYgKE8ubG9nTGV2ZWwgPD0gTG9nTGV2ZWwuV0FSTikge1xuICAgICAgICBjb25zdCBuID0gdC5tYXAoX19QUklWQVRFX2FyZ1RvU3RyaW5nKTtcbiAgICAgICAgTy53YXJuKGBGaXJlc3RvcmUgKCR7eH0pOiAke2V9YCwgLi4ubik7XG4gICAgfVxufVxuXG4vKipcbiAqIENvbnZlcnRzIGFuIGFkZGl0aW9uYWwgbG9nIHBhcmFtZXRlciB0byBhIHN0cmluZyByZXByZXNlbnRhdGlvbi5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfYXJnVG9TdHJpbmcoZSkge1xuICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiBlKSByZXR1cm4gZTtcbiAgICB0cnkge1xuICAgICAgICAvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuICAgICAgICAvKiogRm9ybWF0cyBhbiBvYmplY3QgYXMgYSBKU09OIHN0cmluZywgc3VpdGFibGUgZm9yIGxvZ2dpbmcuICovXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBfX1BSSVZBVEVfZm9ybWF0SlNPTihlKSB7XG4gICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZSk7XG4gICAgICAgIH0oZSk7XG4gICAgfSBjYXRjaCAodCkge1xuICAgICAgICAvLyBDb252ZXJ0aW5nIHRvIEpTT04gZmFpbGVkLCBqdXN0IGxvZyB0aGUgb2JqZWN0IGRpcmVjdGx5XG4gICAgICAgIHJldHVybiBlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gZnVuY3Rpb24gZmFpbChlLCB0LCBuKSB7XG4gICAgbGV0IHIgPSBcIlVuZXhwZWN0ZWQgc3RhdGVcIjtcbiAgICBcInN0cmluZ1wiID09IHR5cGVvZiB0ID8gciA9IHQgOiBuID0gdCwgX19QUklWQVRFX19mYWlsKGUsIHIsIG4pO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfX2ZhaWwoZSwgdCwgbikge1xuICAgIC8vIExvZyB0aGUgZmFpbHVyZSBpbiBhZGRpdGlvbiB0byB0aHJvdyBhbiBleGNlcHRpb24sIGp1c3QgaW4gY2FzZSB0aGVcbiAgICAvLyBleGNlcHRpb24gaXMgc3dhbGxvd2VkLlxuICAgIGxldCByID0gYEZJUkVTVE9SRSAoJHt4fSkgSU5URVJOQUwgQVNTRVJUSU9OIEZBSUxFRDogJHt0fSAoSUQ6ICR7ZS50b1N0cmluZygxNil9KWA7XG4gICAgaWYgKHZvaWQgMCAhPT0gbikgdHJ5IHtcbiAgICAgICAgciArPSBcIiBDT05URVhUOiBcIiArIEpTT04uc3RyaW5naWZ5KG4pO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgciArPSBcIiBDT05URVhUOiBcIiArIG47XG4gICAgfVxuICAgIC8vIE5PVEU6IFdlIGRvbid0IHVzZSBGaXJlc3RvcmVFcnJvciBoZXJlIGJlY2F1c2UgdGhlc2UgYXJlIGludGVybmFsIGZhaWx1cmVzXG4gICAgLy8gdGhhdCBjYW5ub3QgYmUgaGFuZGxlZCBieSB0aGUgdXNlci4gKEFsc28gaXQgd291bGQgY3JlYXRlIGEgY2lyY3VsYXJcbiAgICAvLyBkZXBlbmRlbmN5IGJldHdlZW4gdGhlIGVycm9yIGFuZCBhc3NlcnQgbW9kdWxlcyB3aGljaCBkb2Vzbid0IHdvcmsuKVxuICAgIHRocm93IF9fUFJJVkFURV9sb2dFcnJvcihyKSwgbmV3IEVycm9yKHIpO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfaGFyZEFzc2VydChlLCB0LCBuLCByKSB7XG4gICAgbGV0IGkgPSBcIlVuZXhwZWN0ZWQgc3RhdGVcIjtcbiAgICBcInN0cmluZ1wiID09IHR5cGVvZiBuID8gaSA9IG4gOiByID0gbiwgZSB8fCBfX1BSSVZBVEVfX2ZhaWwodCwgaSwgcik7XG59XG5cbi8qKlxuICogRmFpbHMgaWYgdGhlIGdpdmVuIGFzc2VydGlvbiBjb25kaXRpb24gaXMgZmFsc2UsIHRocm93aW5nIGFuIEVycm9yIHdpdGggdGhlXG4gKiBnaXZlbiBtZXNzYWdlIGlmIGl0IGRpZC5cbiAqXG4gKiBUaGUgY29kZSBvZiBjYWxsc2l0ZXMgaW52b2tpbmcgdGhpcyBmdW5jdGlvbiBhcmUgc3RyaXBwZWQgb3V0IGluIHByb2R1Y3Rpb25cbiAqIGJ1aWxkcy4gQW55IHNpZGUtZWZmZWN0cyBvZiBjb2RlIHdpdGhpbiB0aGUgZGVidWdBc3NlcnQoKSBpbnZvY2F0aW9uIHdpbGwgbm90XG4gKiBoYXBwZW4gaW4gdGhpcyBjYXNlLlxuICpcbiAqIEBpbnRlcm5hbFxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9kZWJ1Z0Fzc2VydChlLCB0KSB7XG4gICAgZSB8fCBmYWlsKDU3MDE0LCB0KTtcbn1cblxuLyoqXG4gKiBDYXN0cyBgb2JqYCB0byBgVGAuIEluIG5vbi1wcm9kdWN0aW9uIGJ1aWxkcywgdmVyaWZpZXMgdGhhdCBgb2JqYCBpcyBhblxuICogaW5zdGFuY2Ugb2YgYFRgIGJlZm9yZSBjYXN0aW5nLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSwgXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxudCkge1xuICAgIHJldHVybiBlO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCBOID0ge1xuICAgIC8vIENhdXNlcyBhcmUgY29waWVkIGZyb206XG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2dycGMvZ3JwYy9ibG9iL2JjZWVjOTRlYTRmYzVmMDA4NWQ4MTIzNWQ4ZTFjMDY3OThkYzM0MWEvaW5jbHVkZS9ncnBjJTJCJTJCL2ltcGwvY29kZWdlbi9zdGF0dXNfY29kZV9lbnVtLmhcbiAgICAvKiogTm90IGFuIGVycm9yOyByZXR1cm5lZCBvbiBzdWNjZXNzLiAqL1xuICAgIE9LOiBcIm9rXCIsXG4gICAgLyoqIFRoZSBvcGVyYXRpb24gd2FzIGNhbmNlbGxlZCAodHlwaWNhbGx5IGJ5IHRoZSBjYWxsZXIpLiAqL1xuICAgIENBTkNFTExFRDogXCJjYW5jZWxsZWRcIixcbiAgICAvKiogVW5rbm93biBlcnJvciBvciBhbiBlcnJvciBmcm9tIGEgZGlmZmVyZW50IGVycm9yIGRvbWFpbi4gKi9cbiAgICBVTktOT1dOOiBcInVua25vd25cIixcbiAgICAvKipcbiAgICAgKiBDbGllbnQgc3BlY2lmaWVkIGFuIGludmFsaWQgYXJndW1lbnQuIE5vdGUgdGhhdCB0aGlzIGRpZmZlcnMgZnJvbVxuICAgICAqIEZBSUxFRF9QUkVDT05ESVRJT04uIElOVkFMSURfQVJHVU1FTlQgaW5kaWNhdGVzIGFyZ3VtZW50cyB0aGF0IGFyZVxuICAgICAqIHByb2JsZW1hdGljIHJlZ2FyZGxlc3Mgb2YgdGhlIHN0YXRlIG9mIHRoZSBzeXN0ZW0gKGUuZy4sIGEgbWFsZm9ybWVkIGZpbGVcbiAgICAgKiBuYW1lKS5cbiAgICAgKi9cbiAgICBJTlZBTElEX0FSR1VNRU5UOiBcImludmFsaWQtYXJndW1lbnRcIixcbiAgICAvKipcbiAgICAgKiBEZWFkbGluZSBleHBpcmVkIGJlZm9yZSBvcGVyYXRpb24gY291bGQgY29tcGxldGUuIEZvciBvcGVyYXRpb25zIHRoYXRcbiAgICAgKiBjaGFuZ2UgdGhlIHN0YXRlIG9mIHRoZSBzeXN0ZW0sIHRoaXMgZXJyb3IgbWF5IGJlIHJldHVybmVkIGV2ZW4gaWYgdGhlXG4gICAgICogb3BlcmF0aW9uIGhhcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LiBGb3IgZXhhbXBsZSwgYSBzdWNjZXNzZnVsIHJlc3BvbnNlXG4gICAgICogZnJvbSBhIHNlcnZlciBjb3VsZCBoYXZlIGJlZW4gZGVsYXllZCBsb25nIGVub3VnaCBmb3IgdGhlIGRlYWRsaW5lIHRvXG4gICAgICogZXhwaXJlLlxuICAgICAqL1xuICAgIERFQURMSU5FX0VYQ0VFREVEOiBcImRlYWRsaW5lLWV4Y2VlZGVkXCIsXG4gICAgLyoqIFNvbWUgcmVxdWVzdGVkIGVudGl0eSAoZS5nLiwgZmlsZSBvciBkaXJlY3RvcnkpIHdhcyBub3QgZm91bmQuICovXG4gICAgTk9UX0ZPVU5EOiBcIm5vdC1mb3VuZFwiLFxuICAgIC8qKlxuICAgICAqIFNvbWUgZW50aXR5IHRoYXQgd2UgYXR0ZW1wdGVkIHRvIGNyZWF0ZSAoZS5nLiwgZmlsZSBvciBkaXJlY3RvcnkpIGFscmVhZHlcbiAgICAgKiBleGlzdHMuXG4gICAgICovXG4gICAgQUxSRUFEWV9FWElTVFM6IFwiYWxyZWFkeS1leGlzdHNcIixcbiAgICAvKipcbiAgICAgKiBUaGUgY2FsbGVyIGRvZXMgbm90IGhhdmUgcGVybWlzc2lvbiB0byBleGVjdXRlIHRoZSBzcGVjaWZpZWQgb3BlcmF0aW9uLlxuICAgICAqIFBFUk1JU1NJT05fREVOSUVEIG11c3Qgbm90IGJlIHVzZWQgZm9yIHJlamVjdGlvbnMgY2F1c2VkIGJ5IGV4aGF1c3RpbmdcbiAgICAgKiBzb21lIHJlc291cmNlICh1c2UgUkVTT1VSQ0VfRVhIQVVTVEVEIGluc3RlYWQgZm9yIHRob3NlIGVycm9ycykuXG4gICAgICogUEVSTUlTU0lPTl9ERU5JRUQgbXVzdCBub3QgYmUgdXNlZCBpZiB0aGUgY2FsbGVyIGNhbm5vdCBiZSBpZGVudGlmaWVkXG4gICAgICogKHVzZSBVTkFVVEhFTlRJQ0FURUQgaW5zdGVhZCBmb3IgdGhvc2UgZXJyb3JzKS5cbiAgICAgKi9cbiAgICBQRVJNSVNTSU9OX0RFTklFRDogXCJwZXJtaXNzaW9uLWRlbmllZFwiLFxuICAgIC8qKlxuICAgICAqIFRoZSByZXF1ZXN0IGRvZXMgbm90IGhhdmUgdmFsaWQgYXV0aGVudGljYXRpb24gY3JlZGVudGlhbHMgZm9yIHRoZVxuICAgICAqIG9wZXJhdGlvbi5cbiAgICAgKi9cbiAgICBVTkFVVEhFTlRJQ0FURUQ6IFwidW5hdXRoZW50aWNhdGVkXCIsXG4gICAgLyoqXG4gICAgICogU29tZSByZXNvdXJjZSBoYXMgYmVlbiBleGhhdXN0ZWQsIHBlcmhhcHMgYSBwZXItdXNlciBxdW90YSwgb3IgcGVyaGFwcyB0aGVcbiAgICAgKiBlbnRpcmUgZmlsZSBzeXN0ZW0gaXMgb3V0IG9mIHNwYWNlLlxuICAgICAqL1xuICAgIFJFU09VUkNFX0VYSEFVU1RFRDogXCJyZXNvdXJjZS1leGhhdXN0ZWRcIixcbiAgICAvKipcbiAgICAgKiBPcGVyYXRpb24gd2FzIHJlamVjdGVkIGJlY2F1c2UgdGhlIHN5c3RlbSBpcyBub3QgaW4gYSBzdGF0ZSByZXF1aXJlZCBmb3JcbiAgICAgKiB0aGUgb3BlcmF0aW9uJ3MgZXhlY3V0aW9uLiBGb3IgZXhhbXBsZSwgZGlyZWN0b3J5IHRvIGJlIGRlbGV0ZWQgbWF5IGJlXG4gICAgICogbm9uLWVtcHR5LCBhbiBybWRpciBvcGVyYXRpb24gaXMgYXBwbGllZCB0byBhIG5vbi1kaXJlY3RvcnksIGV0Yy5cbiAgICAgKlxuICAgICAqIEEgbGl0bXVzIHRlc3QgdGhhdCBtYXkgaGVscCBhIHNlcnZpY2UgaW1wbGVtZW50b3IgaW4gZGVjaWRpbmdcbiAgICAgKiBiZXR3ZWVuIEZBSUxFRF9QUkVDT05ESVRJT04sIEFCT1JURUQsIGFuZCBVTkFWQUlMQUJMRTpcbiAgICAgKiAgKGEpIFVzZSBVTkFWQUlMQUJMRSBpZiB0aGUgY2xpZW50IGNhbiByZXRyeSBqdXN0IHRoZSBmYWlsaW5nIGNhbGwuXG4gICAgICogIChiKSBVc2UgQUJPUlRFRCBpZiB0aGUgY2xpZW50IHNob3VsZCByZXRyeSBhdCBhIGhpZ2hlci1sZXZlbFxuICAgICAqICAgICAgKGUuZy4sIHJlc3RhcnRpbmcgYSByZWFkLW1vZGlmeS13cml0ZSBzZXF1ZW5jZSkuXG4gICAgICogIChjKSBVc2UgRkFJTEVEX1BSRUNPTkRJVElPTiBpZiB0aGUgY2xpZW50IHNob3VsZCBub3QgcmV0cnkgdW50aWxcbiAgICAgKiAgICAgIHRoZSBzeXN0ZW0gc3RhdGUgaGFzIGJlZW4gZXhwbGljaXRseSBmaXhlZC4gRS5nLiwgaWYgYW4gXCJybWRpclwiXG4gICAgICogICAgICBmYWlscyBiZWNhdXNlIHRoZSBkaXJlY3RvcnkgaXMgbm9uLWVtcHR5LCBGQUlMRURfUFJFQ09ORElUSU9OXG4gICAgICogICAgICBzaG91bGQgYmUgcmV0dXJuZWQgc2luY2UgdGhlIGNsaWVudCBzaG91bGQgbm90IHJldHJ5IHVubGVzc1xuICAgICAqICAgICAgdGhleSBoYXZlIGZpcnN0IGZpeGVkIHVwIHRoZSBkaXJlY3RvcnkgYnkgZGVsZXRpbmcgZmlsZXMgZnJvbSBpdC5cbiAgICAgKiAgKGQpIFVzZSBGQUlMRURfUFJFQ09ORElUSU9OIGlmIHRoZSBjbGllbnQgcGVyZm9ybXMgY29uZGl0aW9uYWxcbiAgICAgKiAgICAgIFJFU1QgR2V0L1VwZGF0ZS9EZWxldGUgb24gYSByZXNvdXJjZSBhbmQgdGhlIHJlc291cmNlIG9uIHRoZVxuICAgICAqICAgICAgc2VydmVyIGRvZXMgbm90IG1hdGNoIHRoZSBjb25kaXRpb24uIEUuZy4sIGNvbmZsaWN0aW5nXG4gICAgICogICAgICByZWFkLW1vZGlmeS13cml0ZSBvbiB0aGUgc2FtZSByZXNvdXJjZS5cbiAgICAgKi9cbiAgICBGQUlMRURfUFJFQ09ORElUSU9OOiBcImZhaWxlZC1wcmVjb25kaXRpb25cIixcbiAgICAvKipcbiAgICAgKiBUaGUgb3BlcmF0aW9uIHdhcyBhYm9ydGVkLCB0eXBpY2FsbHkgZHVlIHRvIGEgY29uY3VycmVuY3kgaXNzdWUgbGlrZVxuICAgICAqIHNlcXVlbmNlciBjaGVjayBmYWlsdXJlcywgdHJhbnNhY3Rpb24gYWJvcnRzLCBldGMuXG4gICAgICpcbiAgICAgKiBTZWUgbGl0bXVzIHRlc3QgYWJvdmUgZm9yIGRlY2lkaW5nIGJldHdlZW4gRkFJTEVEX1BSRUNPTkRJVElPTiwgQUJPUlRFRCxcbiAgICAgKiBhbmQgVU5BVkFJTEFCTEUuXG4gICAgICovXG4gICAgQUJPUlRFRDogXCJhYm9ydGVkXCIsXG4gICAgLyoqXG4gICAgICogT3BlcmF0aW9uIHdhcyBhdHRlbXB0ZWQgcGFzdCB0aGUgdmFsaWQgcmFuZ2UuIEUuZy4sIHNlZWtpbmcgb3IgcmVhZGluZ1xuICAgICAqIHBhc3QgZW5kIG9mIGZpbGUuXG4gICAgICpcbiAgICAgKiBVbmxpa2UgSU5WQUxJRF9BUkdVTUVOVCwgdGhpcyBlcnJvciBpbmRpY2F0ZXMgYSBwcm9ibGVtIHRoYXQgbWF5IGJlIGZpeGVkXG4gICAgICogaWYgdGhlIHN5c3RlbSBzdGF0ZSBjaGFuZ2VzLiBGb3IgZXhhbXBsZSwgYSAzMi1iaXQgZmlsZSBzeXN0ZW0gd2lsbFxuICAgICAqIGdlbmVyYXRlIElOVkFMSURfQVJHVU1FTlQgaWYgYXNrZWQgdG8gcmVhZCBhdCBhbiBvZmZzZXQgdGhhdCBpcyBub3QgaW4gdGhlXG4gICAgICogcmFuZ2UgWzAsMl4zMi0xXSwgYnV0IGl0IHdpbGwgZ2VuZXJhdGUgT1VUX09GX1JBTkdFIGlmIGFza2VkIHRvIHJlYWQgZnJvbVxuICAgICAqIGFuIG9mZnNldCBwYXN0IHRoZSBjdXJyZW50IGZpbGUgc2l6ZS5cbiAgICAgKlxuICAgICAqIFRoZXJlIGlzIGEgZmFpciBiaXQgb2Ygb3ZlcmxhcCBiZXR3ZWVuIEZBSUxFRF9QUkVDT05ESVRJT04gYW5kXG4gICAgICogT1VUX09GX1JBTkdFLiBXZSByZWNvbW1lbmQgdXNpbmcgT1VUX09GX1JBTkdFICh0aGUgbW9yZSBzcGVjaWZpYyBlcnJvcilcbiAgICAgKiB3aGVuIGl0IGFwcGxpZXMgc28gdGhhdCBjYWxsZXJzIHdobyBhcmUgaXRlcmF0aW5nIHRocm91Z2ggYSBzcGFjZSBjYW5cbiAgICAgKiBlYXNpbHkgbG9vayBmb3IgYW4gT1VUX09GX1JBTkdFIGVycm9yIHRvIGRldGVjdCB3aGVuIHRoZXkgYXJlIGRvbmUuXG4gICAgICovXG4gICAgT1VUX09GX1JBTkdFOiBcIm91dC1vZi1yYW5nZVwiLFxuICAgIC8qKiBPcGVyYXRpb24gaXMgbm90IGltcGxlbWVudGVkIG9yIG5vdCBzdXBwb3J0ZWQvZW5hYmxlZCBpbiB0aGlzIHNlcnZpY2UuICovXG4gICAgVU5JTVBMRU1FTlRFRDogXCJ1bmltcGxlbWVudGVkXCIsXG4gICAgLyoqXG4gICAgICogSW50ZXJuYWwgZXJyb3JzLiBNZWFucyBzb21lIGludmFyaWFudHMgZXhwZWN0ZWQgYnkgdW5kZXJseWluZyBTeXN0ZW0gaGFzXG4gICAgICogYmVlbiBicm9rZW4uIElmIHlvdSBzZWUgb25lIG9mIHRoZXNlIGVycm9ycywgU29tZXRoaW5nIGlzIHZlcnkgYnJva2VuLlxuICAgICAqL1xuICAgIElOVEVSTkFMOiBcImludGVybmFsXCIsXG4gICAgLyoqXG4gICAgICogVGhlIHNlcnZpY2UgaXMgY3VycmVudGx5IHVuYXZhaWxhYmxlLiBUaGlzIGlzIGEgbW9zdCBsaWtlbHkgYSB0cmFuc2llbnRcbiAgICAgKiBjb25kaXRpb24gYW5kIG1heSBiZSBjb3JyZWN0ZWQgYnkgcmV0cnlpbmcgd2l0aCBhIGJhY2tvZmYuXG4gICAgICpcbiAgICAgKiBTZWUgbGl0bXVzIHRlc3QgYWJvdmUgZm9yIGRlY2lkaW5nIGJldHdlZW4gRkFJTEVEX1BSRUNPTkRJVElPTiwgQUJPUlRFRCxcbiAgICAgKiBhbmQgVU5BVkFJTEFCTEUuXG4gICAgICovXG4gICAgVU5BVkFJTEFCTEU6IFwidW5hdmFpbGFibGVcIixcbiAgICAvKiogVW5yZWNvdmVyYWJsZSBkYXRhIGxvc3Mgb3IgY29ycnVwdGlvbi4gKi9cbiAgICBEQVRBX0xPU1M6IFwiZGF0YS1sb3NzXCJcbn07XG5cbi8qKiBBbiBlcnJvciByZXR1cm5lZCBieSBhIEZpcmVzdG9yZSBvcGVyYXRpb24uICovIGNsYXNzIEZpcmVzdG9yZUVycm9yIGV4dGVuZHMgRmlyZWJhc2VFcnJvciB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgYmFja2VuZCBlcnJvciBjb2RlIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGVycm9yLlxuICAgICAqL1xuICAgIGUsIFxuICAgIC8qKlxuICAgICAqIEEgY3VzdG9tIGVycm9yIGRlc2NyaXB0aW9uLlxuICAgICAqL1xuICAgIHQpIHtcbiAgICAgICAgc3VwZXIoZSwgdCksIHRoaXMuY29kZSA9IGUsIHRoaXMubWVzc2FnZSA9IHQsIFxuICAgICAgICAvLyBIQUNLOiBXZSB3cml0ZSBhIHRvU3RyaW5nIHByb3BlcnR5IGRpcmVjdGx5IGJlY2F1c2UgRXJyb3IgaXMgbm90IGEgcmVhbFxuICAgICAgICAvLyBjbGFzcyBhbmQgc28gaW5oZXJpdGFuY2UgZG9lcyBub3Qgd29yayBjb3JyZWN0bHkuIFdlIGNvdWxkIGFsdGVybmF0aXZlbHlcbiAgICAgICAgLy8gZG8gdGhlIHNhbWUgXCJiYWNrLWRvb3IgaW5oZXJpdGFuY2VcIiB0cmljayB0aGF0IEZpcmViYXNlRXJyb3IgZG9lcy5cbiAgICAgICAgdGhpcy50b1N0cmluZyA9ICgpID0+IGAke3RoaXMubmFtZX06IFtjb2RlPSR7dGhpcy5jb2RlfV06ICR7dGhpcy5tZXNzYWdlfWA7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBfX1BSSVZBVEVfRGVmZXJyZWQge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZSgoKGUsIHQpID0+IHtcbiAgICAgICAgICAgIHRoaXMucmVzb2x2ZSA9IGUsIHRoaXMucmVqZWN0ID0gdDtcbiAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgX19QUklWQVRFX09BdXRoVG9rZW4ge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQpIHtcbiAgICAgICAgdGhpcy51c2VyID0gdCwgdGhpcy50eXBlID0gXCJPQXV0aFwiLCB0aGlzLmhlYWRlcnMgPSBuZXcgTWFwLCB0aGlzLmhlYWRlcnMuc2V0KFwiQXV0aG9yaXphdGlvblwiLCBgQmVhcmVyICR7ZX1gKTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBDcmVkZW50aWFsc1Byb3ZpZGVyIHRoYXQgYWx3YXlzIHlpZWxkcyBhbiBlbXB0eSB0b2tlbi5cbiAqIEBpbnRlcm5hbFxuICovIGNsYXNzIF9fUFJJVkFURV9FbXB0eUF1dGhDcmVkZW50aWFsc1Byb3ZpZGVyIHtcbiAgICBnZXRUb2tlbigpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShudWxsKTtcbiAgICB9XG4gICAgaW52YWxpZGF0ZVRva2VuKCkge31cbiAgICBzdGFydChlLCB0KSB7XG4gICAgICAgIC8vIEZpcmUgd2l0aCBpbml0aWFsIHVzZXIuXG4gICAgICAgIGUuZW5xdWV1ZVJldHJ5YWJsZSgoKCkgPT4gdChVc2VyLlVOQVVUSEVOVElDQVRFRCkpKTtcbiAgICB9XG4gICAgc2h1dGRvd24oKSB7fVxufVxuXG4vKipcbiAqIEEgQ3JlZGVudGlhbHNQcm92aWRlciB0aGF0IGFsd2F5cyByZXR1cm5zIGEgY29uc3RhbnQgdG9rZW4uIFVzZWQgZm9yXG4gKiBlbXVsYXRvciB0b2tlbiBtb2NraW5nLlxuICovIGNsYXNzIF9fUFJJVkFURV9FbXVsYXRvckF1dGhDcmVkZW50aWFsc1Byb3ZpZGVyIHtcbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHRoaXMudG9rZW4gPSBlLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFN0b3JlcyB0aGUgbGlzdGVuZXIgcmVnaXN0ZXJlZCB3aXRoIHNldENoYW5nZUxpc3RlbmVyKClcbiAgICAgICAgICogVGhpcyBpc24ndCBhY3R1YWxseSBuZWNlc3Nhcnkgc2luY2UgdGhlIFVJRCBuZXZlciBjaGFuZ2VzLCBidXQgd2UgdXNlIHRoaXNcbiAgICAgICAgICogdG8gdmVyaWZ5IHRoZSBsaXN0ZW4gY29udHJhY3QgaXMgYWRoZXJlZCB0byBpbiB0ZXN0cy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2hhbmdlTGlzdGVuZXIgPSBudWxsO1xuICAgIH1cbiAgICBnZXRUb2tlbigpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLnRva2VuKTtcbiAgICB9XG4gICAgaW52YWxpZGF0ZVRva2VuKCkge31cbiAgICBzdGFydChlLCB0KSB7XG4gICAgICAgIHRoaXMuY2hhbmdlTGlzdGVuZXIgPSB0LCBcbiAgICAgICAgLy8gRmlyZSB3aXRoIGluaXRpYWwgdXNlci5cbiAgICAgICAgZS5lbnF1ZXVlUmV0cnlhYmxlKCgoKSA9PiB0KHRoaXMudG9rZW4udXNlcikpKTtcbiAgICB9XG4gICAgc2h1dGRvd24oKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlTGlzdGVuZXIgPSBudWxsO1xuICAgIH1cbn1cblxuY2xhc3MgX19QUklWQVRFX0ZpcmViYXNlQXV0aENyZWRlbnRpYWxzUHJvdmlkZXIge1xuICAgIGNvbnN0cnVjdG9yKGUpIHtcbiAgICAgICAgdGhpcy50ID0gZSwgXG4gICAgICAgIC8qKiBUcmFja3MgdGhlIGN1cnJlbnQgVXNlci4gKi9cbiAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IFVzZXIuVU5BVVRIRU5USUNBVEVELCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvdW50ZXIgdXNlZCB0byBkZXRlY3QgaWYgdGhlIHRva2VuIGNoYW5nZWQgd2hpbGUgYSBnZXRUb2tlbiByZXF1ZXN0IHdhc1xuICAgICAgICAgKiBvdXRzdGFuZGluZy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaSA9IDAsIHRoaXMuZm9yY2VSZWZyZXNoID0gITEsIHRoaXMuYXV0aCA9IG51bGw7XG4gICAgfVxuICAgIHN0YXJ0KGUsIHQpIHtcbiAgICAgICAgX19QUklWQVRFX2hhcmRBc3NlcnQodm9pZCAwID09PSB0aGlzLm8sIDQyMzA0KTtcbiAgICAgICAgbGV0IG4gPSB0aGlzLmk7XG4gICAgICAgIC8vIEEgY2hhbmdlIGxpc3RlbmVyIHRoYXQgcHJldmVudHMgZG91YmxlLWZpcmluZyBmb3IgdGhlIHNhbWUgdG9rZW4gY2hhbmdlLlxuICAgICAgICAgICAgICAgIGNvbnN0IF9fUFJJVkFURV9ndWFyZGVkQ2hhbmdlTGlzdGVuZXIgPSBlID0+IHRoaXMuaSAhPT0gbiA/IChuID0gdGhpcy5pLCBcbiAgICAgICAgdChlKSkgOiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgLy8gQSBwcm9taXNlIHRoYXQgY2FuIGJlIHdhaXRlZCBvbiB0byBibG9jayBvbiB0aGUgbmV4dCB0b2tlbiBjaGFuZ2UuXG4gICAgICAgIC8vIFRoaXMgcHJvbWlzZSBpcyByZS1jcmVhdGVkIGFmdGVyIGVhY2ggY2hhbmdlLlxuICAgICAgICAgICAgICAgIGxldCByID0gbmV3IF9fUFJJVkFURV9EZWZlcnJlZDtcbiAgICAgICAgdGhpcy5vID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5pKyssIHRoaXMuY3VycmVudFVzZXIgPSB0aGlzLnUoKSwgci5yZXNvbHZlKCksIHIgPSBuZXcgX19QUklWQVRFX0RlZmVycmVkLCBcbiAgICAgICAgICAgIGUuZW5xdWV1ZVJldHJ5YWJsZSgoKCkgPT4gX19QUklWQVRFX2d1YXJkZWRDaGFuZ2VMaXN0ZW5lcih0aGlzLmN1cnJlbnRVc2VyKSkpO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBfX1BSSVZBVEVfYXdhaXROZXh0VG9rZW4gPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0ID0gcjtcbiAgICAgICAgICAgIGUuZW5xdWV1ZVJldHJ5YWJsZSgoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGF3YWl0IHQucHJvbWlzZSwgYXdhaXQgX19QUklWQVRFX2d1YXJkZWRDaGFuZ2VMaXN0ZW5lcih0aGlzLmN1cnJlbnRVc2VyKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSwgX19QUklWQVRFX3JlZ2lzdGVyQXV0aCA9IGUgPT4ge1xuICAgICAgICAgICAgX19QUklWQVRFX2xvZ0RlYnVnKFwiRmlyZWJhc2VBdXRoQ3JlZGVudGlhbHNQcm92aWRlclwiLCBcIkF1dGggZGV0ZWN0ZWRcIiksIHRoaXMuYXV0aCA9IGUsIFxuICAgICAgICAgICAgdGhpcy5vICYmICh0aGlzLmF1dGguYWRkQXV0aFRva2VuTGlzdGVuZXIodGhpcy5vKSwgX19QUklWQVRFX2F3YWl0TmV4dFRva2VuKCkpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnQub25Jbml0KChlID0+IF9fUFJJVkFURV9yZWdpc3RlckF1dGgoZSkpKSwgXG4gICAgICAgIC8vIE91ciB1c2VycyBjYW4gaW5pdGlhbGl6ZSBBdXRoIHJpZ2h0IGFmdGVyIEZpcmVzdG9yZSwgc28gd2UgZ2l2ZSBpdFxuICAgICAgICAvLyBhIGNoYW5jZSB0byByZWdpc3RlciBpdHNlbGYgd2l0aCB0aGUgY29tcG9uZW50IGZyYW1ld29yayBiZWZvcmUgd2VcbiAgICAgICAgLy8gZGV0ZXJtaW5lIHdoZXRoZXIgdG8gc3RhcnQgdXAgaW4gdW5hdXRoZW50aWNhdGVkIG1vZGUuXG4gICAgICAgIHNldFRpbWVvdXQoKCgpID0+IHtcbiAgICAgICAgICAgIGlmICghdGhpcy5hdXRoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMudC5nZXRJbW1lZGlhdGUoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogITBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBlID8gX19QUklWQVRFX3JlZ2lzdGVyQXV0aChlKSA6IChcbiAgICAgICAgICAgICAgICAvLyBJZiBhdXRoIGlzIHN0aWxsIG5vdCBhdmFpbGFibGUsIHByb2NlZWQgd2l0aCBgbnVsbGAgdXNlclxuICAgICAgICAgICAgICAgIF9fUFJJVkFURV9sb2dEZWJ1ZyhcIkZpcmViYXNlQXV0aENyZWRlbnRpYWxzUHJvdmlkZXJcIiwgXCJBdXRoIG5vdCB5ZXQgZGV0ZWN0ZWRcIiksIFxuICAgICAgICAgICAgICAgIHIucmVzb2x2ZSgpLCByID0gbmV3IF9fUFJJVkFURV9EZWZlcnJlZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLCAwKSwgX19QUklWQVRFX2F3YWl0TmV4dFRva2VuKCk7XG4gICAgfVxuICAgIGdldFRva2VuKCkge1xuICAgICAgICAvLyBUYWtlIG5vdGUgb2YgdGhlIGN1cnJlbnQgdmFsdWUgb2YgdGhlIHRva2VuQ291bnRlciBzbyB0aGF0IHRoaXMgbWV0aG9kXG4gICAgICAgIC8vIGNhbiBmYWlsICh3aXRoIGFuIEFCT1JURUQgZXJyb3IpIGlmIHRoZXJlIGlzIGEgdG9rZW4gY2hhbmdlIHdoaWxlIHRoZVxuICAgICAgICAvLyByZXF1ZXN0IGlzIG91dHN0YW5kaW5nLlxuICAgICAgICBjb25zdCBlID0gdGhpcy5pLCB0ID0gdGhpcy5mb3JjZVJlZnJlc2g7XG4gICAgICAgIHJldHVybiB0aGlzLmZvcmNlUmVmcmVzaCA9ICExLCB0aGlzLmF1dGggPyB0aGlzLmF1dGguZ2V0VG9rZW4odCkudGhlbigodCA9PiBcbiAgICAgICAgLy8gQ2FuY2VsIHRoZSByZXF1ZXN0IHNpbmNlIHRoZSB0b2tlbiBjaGFuZ2VkIHdoaWxlIHRoZSByZXF1ZXN0IHdhc1xuICAgICAgICAvLyBvdXRzdGFuZGluZyBzbyB0aGUgcmVzcG9uc2UgaXMgcG90ZW50aWFsbHkgZm9yIGEgcHJldmlvdXMgdXNlciAod2hpY2hcbiAgICAgICAgLy8gdXNlciwgd2UgY2FuJ3QgYmUgc3VyZSkuXG4gICAgICAgIHRoaXMuaSAhPT0gZSA/IChfX1BSSVZBVEVfbG9nRGVidWcoXCJGaXJlYmFzZUF1dGhDcmVkZW50aWFsc1Byb3ZpZGVyXCIsIFwiZ2V0VG9rZW4gYWJvcnRlZCBkdWUgdG8gdG9rZW4gY2hhbmdlLlwiKSwgXG4gICAgICAgIHRoaXMuZ2V0VG9rZW4oKSkgOiB0ID8gKF9fUFJJVkFURV9oYXJkQXNzZXJ0KFwic3RyaW5nXCIgPT0gdHlwZW9mIHQuYWNjZXNzVG9rZW4sIDMxODM3LCB7XG4gICAgICAgICAgICBsOiB0XG4gICAgICAgIH0pLCBuZXcgX19QUklWQVRFX09BdXRoVG9rZW4odC5hY2Nlc3NUb2tlbiwgdGhpcy5jdXJyZW50VXNlcikpIDogbnVsbCkpIDogUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xuICAgIH1cbiAgICBpbnZhbGlkYXRlVG9rZW4oKSB7XG4gICAgICAgIHRoaXMuZm9yY2VSZWZyZXNoID0gITA7XG4gICAgfVxuICAgIHNodXRkb3duKCkge1xuICAgICAgICB0aGlzLmF1dGggJiYgdGhpcy5vICYmIHRoaXMuYXV0aC5yZW1vdmVBdXRoVG9rZW5MaXN0ZW5lcih0aGlzLm8pLCB0aGlzLm8gPSB2b2lkIDA7XG4gICAgfVxuICAgIC8vIEF1dGguZ2V0VWlkKCkgY2FuIHJldHVybiBudWxsIGV2ZW4gd2l0aCBhIHVzZXIgbG9nZ2VkIGluLiBJdCBpcyBiZWNhdXNlXG4gICAgLy8gZ2V0VWlkKCkgaXMgc3luY2hyb25vdXMsIGJ1dCB0aGUgYXV0aCBjb2RlIHBvcHVsYXRpbmcgVWlkIGlzIGFzeW5jaHJvbm91cy5cbiAgICAvLyBUaGlzIG1ldGhvZCBzaG91bGQgb25seSBiZSBjYWxsZWQgaW4gdGhlIEF1dGhUb2tlbkxpc3RlbmVyIGNhbGxiYWNrXG4gICAgLy8gdG8gZ3VhcmFudGVlIHRvIGdldCB0aGUgYWN0dWFsIHVzZXIuXG4gICAgdSgpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuYXV0aCAmJiB0aGlzLmF1dGguZ2V0VWlkKCk7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfaGFyZEFzc2VydChudWxsID09PSBlIHx8IFwic3RyaW5nXCIgPT0gdHlwZW9mIGUsIDIwNTUsIHtcbiAgICAgICAgICAgIGg6IGVcbiAgICAgICAgfSksIG5ldyBVc2VyKGUpO1xuICAgIH1cbn1cblxuLypcbiAqIEZpcnN0UGFydHlUb2tlbiBwcm92aWRlcyBhIGZyZXNoIHRva2VuIGVhY2ggdGltZSBpdHMgdmFsdWVcbiAqIGlzIHJlcXVlc3RlZCwgYmVjYXVzZSBpZiB0aGUgdG9rZW4gaXMgdG9vIG9sZCwgcmVxdWVzdHMgd2lsbCBiZSByZWplY3RlZC5cbiAqIFRlY2huaWNhbGx5IHRoaXMgbWF5IG5vIGxvbmdlciBiZSBuZWNlc3Nhcnkgc2luY2UgdGhlIFNESyBzaG91bGQgZ3JhY2VmdWxseVxuICogcmVjb3ZlciBmcm9tIHVuYXV0aGVudGljYXRlZCBlcnJvcnMgKHNlZSBiLzMzMTQ3ODE4IGZvciBjb250ZXh0KSwgYnV0IGl0J3NcbiAqIHNhZmVyIHRvIGtlZXAgdGhlIGltcGxlbWVudGF0aW9uIGFzLWlzLlxuICovIGNsYXNzIF9fUFJJVkFURV9GaXJzdFBhcnR5VG9rZW4ge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4pIHtcbiAgICAgICAgdGhpcy5QID0gZSwgdGhpcy5UID0gdCwgdGhpcy5JID0gbiwgdGhpcy50eXBlID0gXCJGaXJzdFBhcnR5XCIsIHRoaXMudXNlciA9IFVzZXIuRklSU1RfUEFSVFksIFxuICAgICAgICB0aGlzLkEgPSBuZXcgTWFwO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIGFuIGF1dGhvcml6YXRpb24gdG9rZW4sIHVzaW5nIGEgcHJvdmlkZWQgZmFjdG9yeSBmdW5jdGlvbiwgb3IgcmV0dXJuXG4gICAgICogbnVsbC5cbiAgICAgKi8gICAgUigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSSA/IHRoaXMuSSgpIDogbnVsbDtcbiAgICB9XG4gICAgZ2V0IGhlYWRlcnMoKSB7XG4gICAgICAgIHRoaXMuQS5zZXQoXCJYLUdvb2ctQXV0aFVzZXJcIiwgdGhpcy5QKTtcbiAgICAgICAgLy8gVXNlIGFycmF5IG5vdGF0aW9uIHRvIHByZXZlbnQgbWluaWZpY2F0aW9uXG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLlIoKTtcbiAgICAgICAgcmV0dXJuIGUgJiYgdGhpcy5BLnNldChcIkF1dGhvcml6YXRpb25cIiwgZSksIHRoaXMuVCAmJiB0aGlzLkEuc2V0KFwiWC1Hb29nLUlhbS1BdXRob3JpemF0aW9uLVRva2VuXCIsIHRoaXMuVCksIFxuICAgICAgICB0aGlzLkE7XG4gICAgfVxufVxuXG4vKlxuICogUHJvdmlkZXMgdXNlciBjcmVkZW50aWFscyByZXF1aXJlZCBmb3IgdGhlIEZpcmVzdG9yZSBKYXZhU2NyaXB0IFNES1xuICogdG8gYXV0aGVudGljYXRlIHRoZSB1c2VyLCB1c2luZyB0ZWNobmlxdWUgdGhhdCBpcyBvbmx5IGF2YWlsYWJsZVxuICogdG8gYXBwbGljYXRpb25zIGhvc3RlZCBieSBHb29nbGUuXG4gKi8gY2xhc3MgX19QUklWQVRFX0ZpcnN0UGFydHlBdXRoQ3JlZGVudGlhbHNQcm92aWRlciB7XG4gICAgY29uc3RydWN0b3IoZSwgdCwgbikge1xuICAgICAgICB0aGlzLlAgPSBlLCB0aGlzLlQgPSB0LCB0aGlzLkkgPSBuO1xuICAgIH1cbiAgICBnZXRUb2tlbigpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXcgX19QUklWQVRFX0ZpcnN0UGFydHlUb2tlbih0aGlzLlAsIHRoaXMuVCwgdGhpcy5JKSk7XG4gICAgfVxuICAgIHN0YXJ0KGUsIHQpIHtcbiAgICAgICAgLy8gRmlyZSB3aXRoIGluaXRpYWwgdWlkLlxuICAgICAgICBlLmVucXVldWVSZXRyeWFibGUoKCgpID0+IHQoVXNlci5GSVJTVF9QQVJUWSkpKTtcbiAgICB9XG4gICAgc2h1dGRvd24oKSB7fVxuICAgIGludmFsaWRhdGVUb2tlbigpIHt9XG59XG5cbmNsYXNzIEFwcENoZWNrVG9rZW4ge1xuICAgIGNvbnN0cnVjdG9yKGUpIHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IGUsIHRoaXMudHlwZSA9IFwiQXBwQ2hlY2tcIiwgdGhpcy5oZWFkZXJzID0gbmV3IE1hcCwgZSAmJiBlLmxlbmd0aCA+IDAgJiYgdGhpcy5oZWFkZXJzLnNldChcIngtZmlyZWJhc2UtYXBwY2hlY2tcIiwgdGhpcy52YWx1ZSk7XG4gICAgfVxufVxuXG5jbGFzcyBfX1BSSVZBVEVfRmlyZWJhc2VBcHBDaGVja1Rva2VuUHJvdmlkZXIge1xuICAgIGNvbnN0cnVjdG9yKHQsIG4pIHtcbiAgICAgICAgdGhpcy5WID0gbiwgdGhpcy5mb3JjZVJlZnJlc2ggPSAhMSwgdGhpcy5hcHBDaGVjayA9IG51bGwsIHRoaXMubSA9IG51bGwsIHRoaXMucCA9IG51bGwsIFxuICAgICAgICBfaXNGaXJlYmFzZVNlcnZlckFwcCh0KSAmJiB0LnNldHRpbmdzLmFwcENoZWNrVG9rZW4gJiYgKHRoaXMucCA9IHQuc2V0dGluZ3MuYXBwQ2hlY2tUb2tlbik7XG4gICAgfVxuICAgIHN0YXJ0KGUsIHQpIHtcbiAgICAgICAgX19QUklWQVRFX2hhcmRBc3NlcnQodm9pZCAwID09PSB0aGlzLm8sIDM1MTIpO1xuICAgICAgICBjb25zdCBvblRva2VuQ2hhbmdlZCA9IGUgPT4ge1xuICAgICAgICAgICAgbnVsbCAhPSBlLmVycm9yICYmIF9fUFJJVkFURV9sb2dEZWJ1ZyhcIkZpcmViYXNlQXBwQ2hlY2tUb2tlblByb3ZpZGVyXCIsIGBFcnJvciBnZXR0aW5nIEFwcCBDaGVjayB0b2tlbjsgdXNpbmcgcGxhY2Vob2xkZXIgdG9rZW4gaW5zdGVhZC4gRXJyb3I6ICR7ZS5lcnJvci5tZXNzYWdlfWApO1xuICAgICAgICAgICAgY29uc3QgbiA9IGUudG9rZW4gIT09IHRoaXMubTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm0gPSBlLnRva2VuLCBfX1BSSVZBVEVfbG9nRGVidWcoXCJGaXJlYmFzZUFwcENoZWNrVG9rZW5Qcm92aWRlclwiLCBgUmVjZWl2ZWQgJHtuID8gXCJuZXdcIiA6IFwiZXhpc3RpbmdcIn0gdG9rZW4uYCksIFxuICAgICAgICAgICAgbiA/IHQoZS50b2tlbikgOiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5vID0gdCA9PiB7XG4gICAgICAgICAgICBlLmVucXVldWVSZXRyeWFibGUoKCgpID0+IG9uVG9rZW5DaGFuZ2VkKHQpKSk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IF9fUFJJVkFURV9yZWdpc3RlckFwcENoZWNrID0gZSA9PiB7XG4gICAgICAgICAgICBfX1BSSVZBVEVfbG9nRGVidWcoXCJGaXJlYmFzZUFwcENoZWNrVG9rZW5Qcm92aWRlclwiLCBcIkFwcENoZWNrIGRldGVjdGVkXCIpLCB0aGlzLmFwcENoZWNrID0gZSwgXG4gICAgICAgICAgICB0aGlzLm8gJiYgdGhpcy5hcHBDaGVjay5hZGRUb2tlbkxpc3RlbmVyKHRoaXMubyk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuVi5vbkluaXQoKGUgPT4gX19QUklWQVRFX3JlZ2lzdGVyQXBwQ2hlY2soZSkpKSwgXG4gICAgICAgIC8vIE91ciB1c2VycyBjYW4gaW5pdGlhbGl6ZSBBcHBDaGVjayBhZnRlciBGaXJlc3RvcmUsIHNvIHdlIGdpdmUgaXRcbiAgICAgICAgLy8gYSBjaGFuY2UgdG8gcmVnaXN0ZXIgaXRzZWxmIHdpdGggdGhlIGNvbXBvbmVudCBmcmFtZXdvcmsuXG4gICAgICAgIHNldFRpbWVvdXQoKCgpID0+IHtcbiAgICAgICAgICAgIGlmICghdGhpcy5hcHBDaGVjaykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLlYuZ2V0SW1tZWRpYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6ICEwXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZSA/IF9fUFJJVkFURV9yZWdpc3RlckFwcENoZWNrKGUpIDogXG4gICAgICAgICAgICAgICAgLy8gSWYgQXBwQ2hlY2sgaXMgc3RpbGwgbm90IGF2YWlsYWJsZSwgcHJvY2VlZCB3aXRob3V0IGl0LlxuICAgICAgICAgICAgICAgIF9fUFJJVkFURV9sb2dEZWJ1ZyhcIkZpcmViYXNlQXBwQ2hlY2tUb2tlblByb3ZpZGVyXCIsIFwiQXBwQ2hlY2sgbm90IHlldCBkZXRlY3RlZFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSksIDApO1xuICAgIH1cbiAgICBnZXRUb2tlbigpIHtcbiAgICAgICAgaWYgKHRoaXMucCkgcmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXcgQXBwQ2hlY2tUb2tlbih0aGlzLnApKTtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZm9yY2VSZWZyZXNoO1xuICAgICAgICByZXR1cm4gdGhpcy5mb3JjZVJlZnJlc2ggPSAhMSwgdGhpcy5hcHBDaGVjayA/IHRoaXMuYXBwQ2hlY2suZ2V0VG9rZW4oZSkudGhlbigoZSA9PiBlID8gKF9fUFJJVkFURV9oYXJkQXNzZXJ0KFwic3RyaW5nXCIgPT0gdHlwZW9mIGUudG9rZW4sIDQ0NTU4LCB7XG4gICAgICAgICAgICB0b2tlblJlc3VsdDogZVxuICAgICAgICB9KSwgdGhpcy5tID0gZS50b2tlbiwgbmV3IEFwcENoZWNrVG9rZW4oZS50b2tlbikpIDogbnVsbCkpIDogUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xuICAgIH1cbiAgICBpbnZhbGlkYXRlVG9rZW4oKSB7XG4gICAgICAgIHRoaXMuZm9yY2VSZWZyZXNoID0gITA7XG4gICAgfVxuICAgIHNodXRkb3duKCkge1xuICAgICAgICB0aGlzLmFwcENoZWNrICYmIHRoaXMubyAmJiB0aGlzLmFwcENoZWNrLnJlbW92ZVRva2VuTGlzdGVuZXIodGhpcy5vKSwgdGhpcy5vID0gdm9pZCAwO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBbiBBcHBDaGVjayB0b2tlbiBwcm92aWRlciB0aGF0IGFsd2F5cyB5aWVsZHMgYW4gZW1wdHkgdG9rZW4uXG4gKiBAaW50ZXJuYWxcbiAqLyBjbGFzcyBfX1BSSVZBVEVfRW1wdHlBcHBDaGVja1Rva2VuUHJvdmlkZXIge1xuICAgIGdldFRva2VuKCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBBcHBDaGVja1Rva2VuKFwiXCIpKTtcbiAgICB9XG4gICAgaW52YWxpZGF0ZVRva2VuKCkge31cbiAgICBzdGFydChlLCB0KSB7fVxuICAgIHNodXRkb3duKCkge31cbn1cblxuLyoqXG4gKiBCdWlsZHMgYSBDcmVkZW50aWFsc1Byb3ZpZGVyIGRlcGVuZGluZyBvbiB0aGUgdHlwZSBvZlxuICogdGhlIGNyZWRlbnRpYWxzIHBhc3NlZCBpbi5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogR2VuZXJhdGVzIGBuQnl0ZXNgIG9mIHJhbmRvbSBieXRlcy5cbiAqXG4gKiBJZiBgbkJ5dGVzIDwgMGAgLCBhbiBlcnJvciB3aWxsIGJlIHRocm93bi5cbiAqL1xuZnVuY3Rpb24gX19QUklWQVRFX3JhbmRvbUJ5dGVzKGUpIHtcbiAgICAvLyBQb2x5ZmlsbHMgZm9yIElFIGFuZCBXZWJXb3JrZXIgYnkgdXNpbmcgYHNlbGZgIGFuZCBgbXNDcnlwdG9gIHdoZW4gYGNyeXB0b2AgaXMgbm90IGF2YWlsYWJsZS5cbiAgICBjb25zdCB0ID0gXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBzZWxmICYmIChzZWxmLmNyeXB0byB8fCBzZWxmLm1zQ3J5cHRvKSwgbiA9IG5ldyBVaW50OEFycmF5KGUpO1xuICAgIGlmICh0ICYmIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgdC5nZXRSYW5kb21WYWx1ZXMpIHQuZ2V0UmFuZG9tVmFsdWVzKG4pOyBlbHNlIFxuICAgIC8vIEZhbGxzIGJhY2sgdG8gTWF0aC5yYW5kb21cbiAgICBmb3IgKGxldCB0ID0gMDsgdCA8IGU7IHQrKykgblt0XSA9IE1hdGguZmxvb3IoMjU2ICogTWF0aC5yYW5kb20oKSk7XG4gICAgcmV0dXJuIG47XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgdXRpbGl0eSBjbGFzcyBmb3IgZ2VuZXJhdGluZyB1bmlxdWUgYWxwaGFudW1lcmljIElEcyBvZiBhIHNwZWNpZmllZCBsZW5ndGguXG4gKlxuICogQGludGVybmFsXG4gKiBFeHBvcnRlZCBpbnRlcm5hbGx5IGZvciB0ZXN0aW5nIHB1cnBvc2VzLlxuICovIGNsYXNzIF9fUFJJVkFURV9BdXRvSWQge1xuICAgIHN0YXRpYyBuZXdJZCgpIHtcbiAgICAgICAgLy8gQWxwaGFudW1lcmljIGNoYXJhY3RlcnNcbiAgICAgICAgY29uc3QgZSA9IFwiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODlcIiwgdCA9IDYyICogTWF0aC5mbG9vcigyNTYgLyA2Mik7XG4gICAgICAgIC8vIFRoZSBsYXJnZXN0IGJ5dGUgdmFsdWUgdGhhdCBpcyBhIG11bHRpcGxlIG9mIGBjaGFyLmxlbmd0aGAuXG4gICAgICAgICAgICAgICAgbGV0IG4gPSBcIlwiO1xuICAgICAgICBmb3IgKDtuLmxlbmd0aCA8IDIwOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfcmFuZG9tQnl0ZXMoNDApO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByLmxlbmd0aDsgKytpKSBcbiAgICAgICAgICAgIC8vIE9ubHkgYWNjZXB0IHZhbHVlcyB0aGF0IGFyZSBbMCwgbWF4TXVsdGlwbGUpLCB0aGlzIGVuc3VyZXMgdGhleSBjYW5cbiAgICAgICAgICAgIC8vIGJlIGV2ZW5seSBtYXBwZWQgdG8gaW5kaWNlcyBvZiBgY2hhcnNgIHZpYSBhIG1vZHVsbyBvcGVyYXRpb24uXG4gICAgICAgICAgICBuLmxlbmd0aCA8IDIwICYmIHJbaV0gPCB0ICYmIChuICs9IGUuY2hhckF0KHJbaV0gJSA2MikpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IoZSwgdCkge1xuICAgIHJldHVybiBlIDwgdCA/IC0xIDogZSA+IHQgPyAxIDogMDtcbn1cblxuLyoqIENvbXBhcmUgc3RyaW5ncyBpbiBVVEYtOCBlbmNvZGVkIGJ5dGUgb3JkZXIgKi8gZnVuY3Rpb24gX19QUklWQVRFX2NvbXBhcmVVdGY4U3RyaW5ncyhlLCB0KSB7XG4gICAgLy8gRmluZCB0aGUgZmlyc3QgZGlmZmVyaW5nIGNoYXJhY3RlciAoYS5rLmEuIFwiVVRGLTE2IGNvZGUgdW5pdFwiKSBpbiB0aGUgdHdvIHN0cmluZ3MgYW5kLFxuICAgIC8vIGlmIGZvdW5kLCB1c2UgdGhhdCBjaGFyYWN0ZXIgdG8gZGV0ZXJtaW5lIHRoZSByZWxhdGl2ZSBvcmRlcmluZyBvZiB0aGUgdHdvIHN0cmluZ3MgYXMgYVxuICAgIC8vIHdob2xlLiBDb21wYXJpbmcgVVRGLTE2IHN0cmluZ3MgaW4gVVRGLTggYnl0ZSBvcmRlciBjYW4gYmUgZG9uZSBzaW1wbHkgYW5kIGVmZmljaWVudGx5IGJ5XG4gICAgLy8gY29tcGFyaW5nIHRoZSBVVEYtMTYgY29kZSB1bml0cyAoY2hhcnMpLiBUaGlzIHNlcmVuZGlwaXRvdXNseSB3b3JrcyBiZWNhdXNlIG9mIHRoZSB3YXkgVVRGLThcbiAgICAvLyBhbmQgVVRGLTE2IGhhcHBlbiB0byByZXByZXNlbnQgVW5pY29kZSBjb2RlIHBvaW50cy5cbiAgICAvLyBBZnRlciBmaW5kaW5nIHRoZSBmaXJzdCBwYWlyIG9mIGRpZmZlcmluZyBjaGFyYWN0ZXJzLCB0aGVyZSBhcmUgdHdvIGNhc2VzOlxuICAgIC8vIENhc2UgMTogQm90aCBjaGFyYWN0ZXJzIGFyZSBub24tc3Vycm9nYXRlcyAoY29kZSBwb2ludHMgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIDB4RkZGRikgb3JcbiAgICAvLyBib3RoIGFyZSBzdXJyb2dhdGVzIGZyb20gYSBzdXJyb2dhdGUgcGFpciAodGhhdCBjb2xsZWN0aXZlbHkgcmVwcmVzZW50IGNvZGUgcG9pbnRzIGdyZWF0ZXJcbiAgICAvLyB0aGFuIDB4RkZGRikuIEluIHRoaXMgY2FzZSB0aGVpciBudW1lcmljIG9yZGVyIGFzIFVURi0xNiBjb2RlIHVuaXRzIGlzIHRoZSBzYW1lIGFzIHRoZVxuICAgIC8vIGxleGljb2dyYXBoaWNhbCBvcmRlciBvZiB0aGVpciBjb3JyZXNwb25kaW5nIFVURi04IGJ5dGUgc2VxdWVuY2VzLiBBIGRpcmVjdCBjb21wYXJpc29uIGlzXG4gICAgLy8gc3VmZmljaWVudC5cbiAgICAvLyBDYXNlIDI6IE9uZSBjaGFyYWN0ZXIgaXMgYSBzdXJyb2dhdGUgYW5kIHRoZSBvdGhlciBpcyBub3QuIEluIHRoaXMgY2FzZSB0aGUgc3Vycm9nYXRlLVxuICAgIC8vIGNvbnRhaW5pbmcgc3RyaW5nIGlzIGFsd2F5cyBvcmRlcmVkIGFmdGVyIHRoZSBub24tc3Vycm9nYXRlLiBUaGlzIGlzIGJlY2F1c2Ugc3Vycm9nYXRlcyBhcmVcbiAgICAvLyB1c2VkIHRvIHJlcHJlc2VudCBjb2RlIHBvaW50cyBncmVhdGVyIHRoYW4gMHhGRkZGIHdoaWNoIGhhdmUgNC1ieXRlIFVURi04IHJlcHJlc2VudGF0aW9uc1xuICAgIC8vIGFuZCBhcmUgbGV4aWNvZ3JhcGhpY2FsbHkgZ3JlYXRlciB0aGFuIHRoZSAxLCAyLCBvciAzLWJ5dGUgcmVwcmVzZW50YXRpb25zIG9mIGNvZGUgcG9pbnRzXG4gICAgLy8gbGVzcyB0aGFuIG9yIGVxdWFsIHRvIDB4RkZGRi5cbiAgICAvLyBBbiBleGFtcGxlIG9mIHdoeSBDYXNlIDIgaXMgcmVxdWlyZWQgaXMgY29tcGFyaW5nIHRoZSBmb2xsb3dpbmcgdHdvIFVuaWNvZGUgY29kZSBwb2ludHM6XG4gICAgLy8gfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS18XG4gICAgLy8gfCBOYW1lICAgICAgICAgICAgICAgICAgfCBDb2RlIFBvaW50IHwgVVRGLTggRW5jb2RpbmcgICAgICB8IFVURi0xNiBFbmNvZGluZyB8XG4gICAgLy8gfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS18XG4gICAgLy8gfCBSZXBsYWNlbWVudCBDaGFyYWN0ZXIgfCBVK0ZGRkQgICAgIHwgMHhFRiAweEJGIDB4QkQgICAgICB8IDB4RkZGRCAgICAgICAgICB8XG4gICAgLy8gfCBHcmlubmluZyBGYWNlICAgICAgICAgfCBVKzFGNjAwICAgIHwgMHhGMCAweDlGIDB4OTggMHg4MCB8IDB4RDgzRCAweERFMDAgICB8XG4gICAgLy8gfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS18XG4gICAgLy8gQSBsZXhpY29ncmFwaGljYWwgY29tcGFyaXNvbiBvZiB0aGUgVVRGLTggZW5jb2RpbmdzIG9mIHRoZXNlIGNvZGUgcG9pbnRzIHdvdWxkIG9yZGVyXG4gICAgLy8gXCJSZXBsYWNlbWVudCBDaGFyYWN0ZXJcIiBfYmVmb3JlXyBcIkdyaW5uaW5nIEZhY2VcIiBiZWNhdXNlIDB4RUYgaXMgbGVzcyB0aGFuIDB4RjAuIEhvd2V2ZXIsIGFcbiAgICAvLyBkaXJlY3QgY29tcGFyaXNvbiBvZiB0aGUgVVRGLTE2IGNvZGUgdW5pdHMsIGFzIHdvdWxkIGJlIGRvbmUgaW4gY2FzZSAxLCB3b3VsZCBlcnJvbmVvdXNseVxuICAgIC8vIHByb2R1Y2UgdGhlIF9vcHBvc2l0ZV8gb3JkZXJpbmcsIGJlY2F1c2UgMHhGRkZEIGlzIF9ncmVhdGVyIHRoYW5fIDB4RDgzRC4gQXMgaXQgdHVybnMgb3V0LFxuICAgIC8vIHRoaXMgcmVsYXRpdmUgb3JkZXJpbmcgaG9sZHMgZm9yIGFsbCBjb21wYXJpc29ucyBvZiBVVEYtMTYgY29kZSBwb2ludHMgcmVxdWlyaW5nIGEgc3Vycm9nYXRlXG4gICAgLy8gcGFpciB3aXRoIHRob3NlIHRoYXQgZG8gbm90LlxuICAgIGNvbnN0IG4gPSBNYXRoLm1pbihlLmxlbmd0aCwgdC5sZW5ndGgpO1xuICAgIGZvciAobGV0IHIgPSAwOyByIDwgbjsgcisrKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLmNoYXJBdChyKSwgaSA9IHQuY2hhckF0KHIpO1xuICAgICAgICBpZiAobiAhPT0gaSkgcmV0dXJuIF9fUFJJVkFURV9pc1N1cnJvZ2F0ZShuKSA9PT0gX19QUklWQVRFX2lzU3Vycm9nYXRlKGkpID8gX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IobiwgaSkgOiBfX1BSSVZBVEVfaXNTdXJyb2dhdGUobikgPyAxIDogLTE7XG4gICAgfVxuICAgIC8vIFVzZSB0aGUgbGVuZ3RocyBvZiB0aGUgc3RyaW5ncyB0byBkZXRlcm1pbmUgdGhlIG92ZXJhbGwgY29tcGFyaXNvbiByZXN1bHQgc2luY2UgZWl0aGVyIHRoZVxuICAgIC8vIHN0cmluZ3Mgd2VyZSBlcXVhbCBvciBvbmUgaXMgYSBwcmVmaXggb2YgdGhlIG90aGVyLlxuICAgICAgICByZXR1cm4gX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IoZS5sZW5ndGgsIHQubGVuZ3RoKTtcbn1cblxuY29uc3QgQiA9IDU1Mjk2LCBMID0gNTczNDM7XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9pc1N1cnJvZ2F0ZShlKSB7XG4gICAgY29uc3QgdCA9IGUuY2hhckNvZGVBdCgwKTtcbiAgICByZXR1cm4gdCA+PSBCICYmIHQgPD0gTDtcbn1cblxuLyoqIEhlbHBlciB0byBjb21wYXJlIGFycmF5cyB1c2luZyBpc0VxdWFsKCkuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9hcnJheUVxdWFscyhlLCB0LCBuKSB7XG4gICAgcmV0dXJuIGUubGVuZ3RoID09PSB0Lmxlbmd0aCAmJiBlLmV2ZXJ5KCgoZSwgcikgPT4gbihlLCB0W3JdKSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGltbWVkaWF0ZSBsZXhpY29ncmFwaGljYWxseS1mb2xsb3dpbmcgc3RyaW5nLiBUaGlzIGlzIHVzZWZ1bCB0b1xuICogY29uc3RydWN0IGFuIGluY2x1c2l2ZSByYW5nZSBmb3IgaW5kZXhlZGRiIGl0ZXJhdG9ycy5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfaW1tZWRpYXRlU3VjY2Vzc29yKGUpIHtcbiAgICAvLyBSZXR1cm4gdGhlIGlucHV0IHN0cmluZywgd2l0aCBhbiBhZGRpdGlvbmFsIE5VTCBieXRlIGFwcGVuZGVkLlxuICAgIHJldHVybiBlICsgXCJcXDBcIjtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY29uc3QgayA9IFwiX19uYW1lX19cIjtcblxuLyoqXG4gKiBQYXRoIHJlcHJlc2VudHMgYW4gb3JkZXJlZCBzZXF1ZW5jZSBvZiBzdHJpbmcgc2VnbWVudHMuXG4gKi8gY2xhc3MgQmFzZVBhdGgge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4pIHtcbiAgICAgICAgdm9pZCAwID09PSB0ID8gdCA9IDAgOiB0ID4gZS5sZW5ndGggJiYgZmFpbCg2MzcsIHtcbiAgICAgICAgICAgIG9mZnNldDogdCxcbiAgICAgICAgICAgIHJhbmdlOiBlLmxlbmd0aFxuICAgICAgICB9KSwgdm9pZCAwID09PSBuID8gbiA9IGUubGVuZ3RoIC0gdCA6IG4gPiBlLmxlbmd0aCAtIHQgJiYgZmFpbCgxNzQ2LCB7XG4gICAgICAgICAgICBsZW5ndGg6IG4sXG4gICAgICAgICAgICByYW5nZTogZS5sZW5ndGggLSB0XG4gICAgICAgIH0pLCB0aGlzLnNlZ21lbnRzID0gZSwgdGhpcy5vZmZzZXQgPSB0LCB0aGlzLmxlbiA9IG47XG4gICAgfVxuICAgIGdldCBsZW5ndGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxlbjtcbiAgICB9XG4gICAgaXNFcXVhbChlKSB7XG4gICAgICAgIHJldHVybiAwID09PSBCYXNlUGF0aC5jb21wYXJhdG9yKHRoaXMsIGUpO1xuICAgIH1cbiAgICBjaGlsZChlKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLnNlZ21lbnRzLnNsaWNlKHRoaXMub2Zmc2V0LCB0aGlzLmxpbWl0KCkpO1xuICAgICAgICByZXR1cm4gZSBpbnN0YW5jZW9mIEJhc2VQYXRoID8gZS5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIHQucHVzaChlKTtcbiAgICAgICAgfSkpIDogdC5wdXNoKGUpLCB0aGlzLmNvbnN0cnVjdCh0KTtcbiAgICB9XG4gICAgLyoqIFRoZSBpbmRleCBvZiBvbmUgcGFzdCB0aGUgbGFzdCBzZWdtZW50IG9mIHRoZSBwYXRoLiAqLyAgICBsaW1pdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub2Zmc2V0ICsgdGhpcy5sZW5ndGg7XG4gICAgfVxuICAgIHBvcEZpcnN0KGUpIHtcbiAgICAgICAgcmV0dXJuIGUgPSB2b2lkIDAgPT09IGUgPyAxIDogZSwgdGhpcy5jb25zdHJ1Y3QodGhpcy5zZWdtZW50cywgdGhpcy5vZmZzZXQgKyBlLCB0aGlzLmxlbmd0aCAtIGUpO1xuICAgIH1cbiAgICBwb3BMYXN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3QodGhpcy5zZWdtZW50cywgdGhpcy5vZmZzZXQsIHRoaXMubGVuZ3RoIC0gMSk7XG4gICAgfVxuICAgIGZpcnN0U2VnbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VnbWVudHNbdGhpcy5vZmZzZXRdO1xuICAgIH1cbiAgICBsYXN0U2VnbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0KHRoaXMubGVuZ3RoIC0gMSk7XG4gICAgfVxuICAgIGdldChlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlZ21lbnRzW3RoaXMub2Zmc2V0ICsgZV07XG4gICAgfVxuICAgIGlzRW1wdHkoKSB7XG4gICAgICAgIHJldHVybiAwID09PSB0aGlzLmxlbmd0aDtcbiAgICB9XG4gICAgaXNQcmVmaXhPZihlKSB7XG4gICAgICAgIGlmIChlLmxlbmd0aCA8IHRoaXMubGVuZ3RoKSByZXR1cm4gITE7XG4gICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgdGhpcy5sZW5ndGg7IHQrKykgaWYgKHRoaXMuZ2V0KHQpICE9PSBlLmdldCh0KSkgcmV0dXJuICExO1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIGlzSW1tZWRpYXRlUGFyZW50T2YoZSkge1xuICAgICAgICBpZiAodGhpcy5sZW5ndGggKyAxICE9PSBlLmxlbmd0aCkgcmV0dXJuICExO1xuICAgICAgICBmb3IgKGxldCB0ID0gMDsgdCA8IHRoaXMubGVuZ3RoOyB0KyspIGlmICh0aGlzLmdldCh0KSAhPT0gZS5nZXQodCkpIHJldHVybiAhMTtcbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH1cbiAgICBmb3JFYWNoKGUpIHtcbiAgICAgICAgZm9yIChsZXQgdCA9IHRoaXMub2Zmc2V0LCBuID0gdGhpcy5saW1pdCgpOyB0IDwgbjsgdCsrKSBlKHRoaXMuc2VnbWVudHNbdF0pO1xuICAgIH1cbiAgICB0b0FycmF5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZWdtZW50cy5zbGljZSh0aGlzLm9mZnNldCwgdGhpcy5saW1pdCgpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29tcGFyZSAyIHBhdGhzIHNlZ21lbnQgYnkgc2VnbWVudCwgcHJpb3JpdGl6aW5nIG51bWVyaWMgSURzXG4gICAgICogKGUuZy4sIFwiX19pZDEyM19fXCIpIGluIG51bWVyaWMgYXNjZW5kaW5nIG9yZGVyLCBmb2xsb3dlZCBieSBzdHJpbmdcbiAgICAgKiBzZWdtZW50cyBpbiBsZXhpY29ncmFwaGljYWwgb3JkZXIuXG4gICAgICovICAgIHN0YXRpYyBjb21wYXJhdG9yKGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IE1hdGgubWluKGUubGVuZ3RoLCB0Lmxlbmd0aCk7XG4gICAgICAgIGZvciAobGV0IHIgPSAwOyByIDwgbjsgcisrKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gQmFzZVBhdGguY29tcGFyZVNlZ21lbnRzKGUuZ2V0KHIpLCB0LmdldChyKSk7XG4gICAgICAgICAgICBpZiAoMCAhPT0gbikgcmV0dXJuIG47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9wcmltaXRpdmVDb21wYXJhdG9yKGUubGVuZ3RoLCB0Lmxlbmd0aCk7XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJlU2VnbWVudHMoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gQmFzZVBhdGguaXNOdW1lcmljSWQoZSksIHIgPSBCYXNlUGF0aC5pc051bWVyaWNJZCh0KTtcbiAgICAgICAgcmV0dXJuIG4gJiYgIXIgPyAtMSA6ICFuICYmIHIgPyAxIDogbiAmJiByID8gQmFzZVBhdGguZXh0cmFjdE51bWVyaWNJZChlKS5jb21wYXJlKEJhc2VQYXRoLmV4dHJhY3ROdW1lcmljSWQodCkpIDogX19QUklWQVRFX2NvbXBhcmVVdGY4U3RyaW5ncyhlLCB0KTtcbiAgICB9XG4gICAgLy8gQ2hlY2tzIGlmIGEgc2VnbWVudCBpcyBhIG51bWVyaWMgSUQgKHN0YXJ0cyB3aXRoIFwiX19pZFwiIGFuZCBlbmRzIHdpdGggXCJfX1wiKS5cbiAgICBzdGF0aWMgaXNOdW1lcmljSWQoZSkge1xuICAgICAgICByZXR1cm4gZS5zdGFydHNXaXRoKFwiX19pZFwiKSAmJiBlLmVuZHNXaXRoKFwiX19cIik7XG4gICAgfVxuICAgIHN0YXRpYyBleHRyYWN0TnVtZXJpY0lkKGUpIHtcbiAgICAgICAgcmV0dXJuIEludGVnZXIuZnJvbVN0cmluZyhlLnN1YnN0cmluZyg0LCBlLmxlbmd0aCAtIDIpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBzbGFzaC1zZXBhcmF0ZWQgcGF0aCBmb3IgbmF2aWdhdGluZyByZXNvdXJjZXMgKGRvY3VtZW50cyBhbmQgY29sbGVjdGlvbnMpXG4gKiB3aXRoaW4gRmlyZXN0b3JlLlxuICpcbiAqIEBpbnRlcm5hbFxuICovIGNsYXNzIFJlc291cmNlUGF0aCBleHRlbmRzIEJhc2VQYXRoIHtcbiAgICBjb25zdHJ1Y3QoZSwgdCwgbikge1xuICAgICAgICByZXR1cm4gbmV3IFJlc291cmNlUGF0aChlLCB0LCBuKTtcbiAgICB9XG4gICAgY2Fub25pY2FsU3RyaW5nKCkge1xuICAgICAgICAvLyBOT1RFOiBUaGUgY2xpZW50IGlzIGlnbm9yYW50IG9mIGFueSBwYXRoIHNlZ21lbnRzIGNvbnRhaW5pbmcgZXNjYXBlXG4gICAgICAgIC8vIHNlcXVlbmNlcyAoZS5nLiBfX2lkMTIzX18pIGFuZCBqdXN0IHBhc3NlcyB0aGVtIHRocm91Z2ggcmF3ICh0aGV5IGV4aXN0XG4gICAgICAgIC8vIGZvciBsZWdhY3kgcmVhc29ucyBhbmQgc2hvdWxkIG5vdCBiZSB1c2VkIGZyZXF1ZW50bHkpLlxuICAgICAgICByZXR1cm4gdGhpcy50b0FycmF5KCkuam9pbihcIi9cIik7XG4gICAgfVxuICAgIHRvU3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jYW5vbmljYWxTdHJpbmcoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGlzIHBhdGhcbiAgICAgKiB3aGVyZSBlYWNoIHBhdGggc2VnbWVudCBoYXMgYmVlbiBlbmNvZGVkIHdpdGhcbiAgICAgKiBgZW5jb2RlVVJJQ29tcG9uZW50YC5cbiAgICAgKi8gICAgdG9VcmlFbmNvZGVkU3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b0FycmF5KCkubWFwKGVuY29kZVVSSUNvbXBvbmVudCkuam9pbihcIi9cIik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSByZXNvdXJjZSBwYXRoIGZyb20gdGhlIGdpdmVuIHNsYXNoLWRlbGltaXRlZCBzdHJpbmcuIElmIG11bHRpcGxlXG4gICAgICogYXJndW1lbnRzIGFyZSBwcm92aWRlZCwgYWxsIGNvbXBvbmVudHMgYXJlIGNvbWJpbmVkLiBMZWFkaW5nIGFuZCB0cmFpbGluZ1xuICAgICAqIHNsYXNoZXMgZnJvbSBhbGwgY29tcG9uZW50cyBhcmUgaWdub3JlZC5cbiAgICAgKi8gICAgc3RhdGljIGZyb21TdHJpbmcoLi4uZSkge1xuICAgICAgICAvLyBOT1RFOiBUaGUgY2xpZW50IGlzIGlnbm9yYW50IG9mIGFueSBwYXRoIHNlZ21lbnRzIGNvbnRhaW5pbmcgZXNjYXBlXG4gICAgICAgIC8vIHNlcXVlbmNlcyAoZS5nLiBfX2lkMTIzX18pIGFuZCBqdXN0IHBhc3NlcyB0aGVtIHRocm91Z2ggcmF3ICh0aGV5IGV4aXN0XG4gICAgICAgIC8vIGZvciBsZWdhY3kgcmVhc29ucyBhbmQgc2hvdWxkIG5vdCBiZSB1c2VkIGZyZXF1ZW50bHkpLlxuICAgICAgICBjb25zdCB0ID0gW107XG4gICAgICAgIGZvciAoY29uc3QgbiBvZiBlKSB7XG4gICAgICAgICAgICBpZiAobi5pbmRleE9mKFwiLy9cIikgPj0gMCkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgc2VnbWVudCAoJHtufSkuIFBhdGhzIG11c3Qgbm90IGNvbnRhaW4gLy8gaW4gdGhlbS5gKTtcbiAgICAgICAgICAgIC8vIFN0cmlwIGxlYWRpbmcgYW5kIHRyYWlsaW5nIHNsYXNoZWQuXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnB1c2goLi4ubi5zcGxpdChcIi9cIikuZmlsdGVyKChlID0+IGUubGVuZ3RoID4gMCkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFJlc291cmNlUGF0aCh0KTtcbiAgICB9XG4gICAgc3RhdGljIGVtcHR5UGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZXNvdXJjZVBhdGgoW10pO1xuICAgIH1cbn1cblxuY29uc3QgcSA9IC9eW19hLXpBLVpdW19hLXpBLVowLTldKiQvO1xuXG4vKipcbiAqIEEgZG90LXNlcGFyYXRlZCBwYXRoIGZvciBuYXZpZ2F0aW5nIHN1Yi1vYmplY3RzIHdpdGhpbiBhIGRvY3VtZW50LlxuICogQGludGVybmFsXG4gKi8gY2xhc3MgRmllbGRQYXRoJDEgZXh0ZW5kcyBCYXNlUGF0aCB7XG4gICAgY29uc3RydWN0KGUsIHQsIG4pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBGaWVsZFBhdGgkMShlLCB0LCBuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBzdHJpbmcgY291bGQgYmUgdXNlZCBhcyBhIHNlZ21lbnQgaW4gYSBmaWVsZCBwYXRoXG4gICAgICogd2l0aG91dCBlc2NhcGluZy5cbiAgICAgKi8gICAgc3RhdGljIGlzVmFsaWRJZGVudGlmaWVyKGUpIHtcbiAgICAgICAgcmV0dXJuIHEudGVzdChlKTtcbiAgICB9XG4gICAgY2Fub25pY2FsU3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b0FycmF5KCkubWFwKChlID0+IChlID0gZS5yZXBsYWNlKC9cXFxcL2csIFwiXFxcXFxcXFxcIikucmVwbGFjZSgvYC9nLCBcIlxcXFxgXCIpLCBcbiAgICAgICAgRmllbGRQYXRoJDEuaXNWYWxpZElkZW50aWZpZXIoZSkgfHwgKGUgPSBcImBcIiArIGUgKyBcImBcIiksIGUpKSkuam9pbihcIi5cIik7XG4gICAgfVxuICAgIHRvU3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jYW5vbmljYWxTdHJpbmcoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoaXMgZmllbGQgcmVmZXJlbmNlcyB0aGUga2V5IG9mIGEgZG9jdW1lbnQuXG4gICAgICovICAgIGlzS2V5RmllbGQoKSB7XG4gICAgICAgIHJldHVybiAxID09PSB0aGlzLmxlbmd0aCAmJiB0aGlzLmdldCgwKSA9PT0gaztcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGZpZWxkIGRlc2lnbmF0aW5nIHRoZSBrZXkgb2YgYSBkb2N1bWVudC5cbiAgICAgKi8gICAgc3RhdGljIGtleUZpZWxkKCkge1xuICAgICAgICByZXR1cm4gbmV3IEZpZWxkUGF0aCQxKFsgayBdKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgZmllbGQgc3RyaW5nIGZyb20gdGhlIGdpdmVuIHNlcnZlci1mb3JtYXR0ZWQgc3RyaW5nLlxuICAgICAqXG4gICAgICogLSBTcGxpdHRpbmcgdGhlIGVtcHR5IHN0cmluZyBpcyBub3QgYWxsb3dlZCAoZm9yIG5vdyBhdCBsZWFzdCkuXG4gICAgICogLSBFbXB0eSBzZWdtZW50cyB3aXRoaW4gdGhlIHN0cmluZyAoZS5nLiBpZiB0aGVyZSBhcmUgdHdvIGNvbnNlY3V0aXZlXG4gICAgICogICBzZXBhcmF0b3JzKSBhcmUgbm90IGFsbG93ZWQuXG4gICAgICpcbiAgICAgKiBUT0RPKGIvMzcyNDQxNTcpOiB3ZSBzaG91bGQgbWFrZSB0aGlzIG1vcmUgc3RyaWN0LiBSaWdodCBub3csIGl0IGFsbG93c1xuICAgICAqIG5vbi1pZGVudGlmaWVyIHBhdGggY29tcG9uZW50cywgZXZlbiBpZiB0aGV5IGFyZW4ndCBlc2NhcGVkLlxuICAgICAqLyAgICBzdGF0aWMgZnJvbVNlcnZlckZvcm1hdChlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgbGV0IG4gPSBcIlwiLCByID0gMDtcbiAgICAgICAgY29uc3QgX19QUklWQVRFX2FkZEN1cnJlbnRTZWdtZW50ID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKDAgPT09IG4ubGVuZ3RoKSB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBmaWVsZCBwYXRoICgke2V9KS4gUGF0aHMgbXVzdCBub3QgYmUgZW1wdHksIGJlZ2luIHdpdGggJy4nLCBlbmQgd2l0aCAnLicsIG9yIGNvbnRhaW4gJy4uJ2ApO1xuICAgICAgICAgICAgdC5wdXNoKG4pLCBuID0gXCJcIjtcbiAgICAgICAgfTtcbiAgICAgICAgbGV0IGkgPSAhMTtcbiAgICAgICAgZm9yICg7ciA8IGUubGVuZ3RoOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBlW3JdO1xuICAgICAgICAgICAgaWYgKFwiXFxcXFwiID09PSB0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHIgKyAxID09PSBlLmxlbmd0aCkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgXCJQYXRoIGhhcyB0cmFpbGluZyBlc2NhcGUgY2hhcmFjdGVyOiBcIiArIGUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlW3IgKyAxXTtcbiAgICAgICAgICAgICAgICBpZiAoXCJcXFxcXCIgIT09IHQgJiYgXCIuXCIgIT09IHQgJiYgXCJgXCIgIT09IHQpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIFwiUGF0aCBoYXMgaW52YWxpZCBlc2NhcGUgc2VxdWVuY2U6IFwiICsgZSk7XG4gICAgICAgICAgICAgICAgbiArPSB0LCByICs9IDI7XG4gICAgICAgICAgICB9IGVsc2UgXCJgXCIgPT09IHQgPyAoaSA9ICFpLCByKyspIDogXCIuXCIgIT09IHQgfHwgaSA/IChuICs9IHQsIHIrKykgOiAoX19QUklWQVRFX2FkZEN1cnJlbnRTZWdtZW50KCksIFxuICAgICAgICAgICAgcisrKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoX19QUklWQVRFX2FkZEN1cnJlbnRTZWdtZW50KCksIGkpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIFwiVW50ZXJtaW5hdGVkIGAgaW4gcGF0aDogXCIgKyBlKTtcbiAgICAgICAgcmV0dXJuIG5ldyBGaWVsZFBhdGgkMSh0KTtcbiAgICB9XG4gICAgc3RhdGljIGVtcHR5UGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBGaWVsZFBhdGgkMShbXSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqLyBjbGFzcyBEb2N1bWVudEtleSB7XG4gICAgY29uc3RydWN0b3IoZSkge1xuICAgICAgICB0aGlzLnBhdGggPSBlO1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbVBhdGgoZSkge1xuICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50S2V5KFJlc291cmNlUGF0aC5mcm9tU3RyaW5nKGUpKTtcbiAgICB9XG4gICAgc3RhdGljIGZyb21OYW1lKGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudEtleShSZXNvdXJjZVBhdGguZnJvbVN0cmluZyhlKS5wb3BGaXJzdCg1KSk7XG4gICAgfVxuICAgIHN0YXRpYyBlbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudEtleShSZXNvdXJjZVBhdGguZW1wdHlQYXRoKCkpO1xuICAgIH1cbiAgICBnZXQgY29sbGVjdGlvbkdyb3VwKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXRoLnBvcExhc3QoKS5sYXN0U2VnbWVudCgpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyB0cnVlIGlmIHRoZSBkb2N1bWVudCBpcyBpbiB0aGUgc3BlY2lmaWVkIGNvbGxlY3Rpb25JZC4gKi8gICAgaGFzQ29sbGVjdGlvbklkKGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGF0aC5sZW5ndGggPj0gMiAmJiB0aGlzLnBhdGguZ2V0KHRoaXMucGF0aC5sZW5ndGggLSAyKSA9PT0gZTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgdGhlIGNvbGxlY3Rpb24gZ3JvdXAgKGkuZS4gdGhlIG5hbWUgb2YgdGhlIHBhcmVudCBjb2xsZWN0aW9uKSBmb3IgdGhpcyBrZXkuICovICAgIGdldENvbGxlY3Rpb25Hcm91cCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGF0aC5nZXQodGhpcy5wYXRoLmxlbmd0aCAtIDIpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyB0aGUgZnVsbHkgcXVhbGlmaWVkIHBhdGggdG8gdGhlIHBhcmVudCBjb2xsZWN0aW9uLiAqLyAgICBnZXRDb2xsZWN0aW9uUGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGF0aC5wb3BMYXN0KCk7XG4gICAgfVxuICAgIGlzRXF1YWwoZSkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gZSAmJiAwID09PSBSZXNvdXJjZVBhdGguY29tcGFyYXRvcih0aGlzLnBhdGgsIGUucGF0aCk7XG4gICAgfVxuICAgIHRvU3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXRoLnRvU3RyaW5nKCk7XG4gICAgfVxuICAgIHN0YXRpYyBjb21wYXJhdG9yKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIFJlc291cmNlUGF0aC5jb21wYXJhdG9yKGUucGF0aCwgdC5wYXRoKTtcbiAgICB9XG4gICAgc3RhdGljIGlzRG9jdW1lbnRLZXkoZSkge1xuICAgICAgICByZXR1cm4gZS5sZW5ndGggJSAyID09IDA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIHJldHVybnMgYSBuZXcgZG9jdW1lbnQga2V5IHdpdGggdGhlIGdpdmVuIHNlZ21lbnRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHNlZ21lbnRzIC0gVGhlIHNlZ21lbnRzIG9mIHRoZSBwYXRoIHRvIHRoZSBkb2N1bWVudFxuICAgICAqIEByZXR1cm5zIEEgbmV3IGluc3RhbmNlIG9mIERvY3VtZW50S2V5XG4gICAgICovICAgIHN0YXRpYyBmcm9tU2VnbWVudHMoZSkge1xuICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50S2V5KG5ldyBSZXNvdXJjZVBhdGgoZS5zbGljZSgpKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfdmFsaWRhdGVOb25FbXB0eUFyZ3VtZW50KGUsIHQsIG4pIHtcbiAgICBpZiAoIW4pIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIGBGdW5jdGlvbiAke2V9KCkgY2Fubm90IGJlIGNhbGxlZCB3aXRoIGFuIGVtcHR5ICR7dH0uYCk7XG59XG5cbi8qKlxuICogVmFsaWRhdGVzIHRoYXQgdHdvIGJvb2xlYW4gb3B0aW9ucyBhcmUgbm90IHNldCBhdCB0aGUgc2FtZSB0aW1lLlxuICogQGludGVybmFsXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX3ZhbGlkYXRlSXNOb3RVc2VkVG9nZXRoZXIoZSwgdCwgbiwgcikge1xuICAgIGlmICghMCA9PT0gdCAmJiAhMCA9PT0gcikgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgYCR7ZX0gYW5kICR7bn0gY2Fubm90IGJlIHVzZWQgdG9nZXRoZXIuYCk7XG59XG5cbi8qKlxuICogVmFsaWRhdGVzIHRoYXQgYHBhdGhgIHJlZmVycyB0byBhIGRvY3VtZW50IChpbmRpY2F0ZWQgYnkgdGhlIGZhY3QgaXQgY29udGFpbnNcbiAqIGFuIGV2ZW4gbnVtYmVycyBvZiBzZWdtZW50cykuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX3ZhbGlkYXRlRG9jdW1lbnRQYXRoKGUpIHtcbiAgICBpZiAoIURvY3VtZW50S2V5LmlzRG9jdW1lbnRLZXkoZSkpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIGRvY3VtZW50IHJlZmVyZW5jZS4gRG9jdW1lbnQgcmVmZXJlbmNlcyBtdXN0IGhhdmUgYW4gZXZlbiBudW1iZXIgb2Ygc2VnbWVudHMsIGJ1dCAke2V9IGhhcyAke2UubGVuZ3RofS5gKTtcbn1cblxuLyoqXG4gKiBWYWxpZGF0ZXMgdGhhdCBgcGF0aGAgcmVmZXJzIHRvIGEgY29sbGVjdGlvbiAoaW5kaWNhdGVkIGJ5IHRoZSBmYWN0IGl0XG4gKiBjb250YWlucyBhbiBvZGQgbnVtYmVycyBvZiBzZWdtZW50cykuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX3ZhbGlkYXRlQ29sbGVjdGlvblBhdGgoZSkge1xuICAgIGlmIChEb2N1bWVudEtleS5pc0RvY3VtZW50S2V5KGUpKSB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBjb2xsZWN0aW9uIHJlZmVyZW5jZS4gQ29sbGVjdGlvbiByZWZlcmVuY2VzIG11c3QgaGF2ZSBhbiBvZGQgbnVtYmVyIG9mIHNlZ21lbnRzLCBidXQgJHtlfSBoYXMgJHtlLmxlbmd0aH0uYCk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIGl0J3MgYSBub24tbnVsbCBvYmplY3Qgd2l0aG91dCBhIGN1c3RvbSBwcm90b3R5cGVcbiAqIChpLmUuIGV4Y2x1ZGVzIEFycmF5LCBEYXRlLCBldGMuKS5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfaXNQbGFpbk9iamVjdChlKSB7XG4gICAgcmV0dXJuIFwib2JqZWN0XCIgPT0gdHlwZW9mIGUgJiYgbnVsbCAhPT0gZSAmJiAoT2JqZWN0LmdldFByb3RvdHlwZU9mKGUpID09PSBPYmplY3QucHJvdG90eXBlIHx8IG51bGwgPT09IE9iamVjdC5nZXRQcm90b3R5cGVPZihlKSk7XG59XG5cbi8qKiBSZXR1cm5zIGEgc3RyaW5nIGRlc2NyaWJpbmcgdGhlIHR5cGUgLyB2YWx1ZSBvZiB0aGUgcHJvdmlkZWQgaW5wdXQuICovIGZ1bmN0aW9uIF9fUFJJVkFURV92YWx1ZURlc2NyaXB0aW9uKGUpIHtcbiAgICBpZiAodm9pZCAwID09PSBlKSByZXR1cm4gXCJ1bmRlZmluZWRcIjtcbiAgICBpZiAobnVsbCA9PT0gZSkgcmV0dXJuIFwibnVsbFwiO1xuICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiBlKSByZXR1cm4gZS5sZW5ndGggPiAyMCAmJiAoZSA9IGAke2Uuc3Vic3RyaW5nKDAsIDIwKX0uLi5gKSwgXG4gICAgSlNPTi5zdHJpbmdpZnkoZSk7XG4gICAgaWYgKFwibnVtYmVyXCIgPT0gdHlwZW9mIGUgfHwgXCJib29sZWFuXCIgPT0gdHlwZW9mIGUpIHJldHVybiBcIlwiICsgZTtcbiAgICBpZiAoXCJvYmplY3RcIiA9PSB0eXBlb2YgZSkge1xuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEFycmF5KSByZXR1cm4gXCJhbiBhcnJheVwiO1xuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB0ID0gXG4gICAgICAgICAgICAvKiogdHJ5IHRvIGdldCB0aGUgY29uc3RydWN0b3IgbmFtZSBmb3IgYW4gb2JqZWN0LiAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gX19QUklWQVRFX3RyeUdldEN1c3RvbU9iamVjdFR5cGUoZSkge1xuICAgICAgICAgICAgICAgIGlmIChlLmNvbnN0cnVjdG9yKSByZXR1cm4gZS5jb25zdHJ1Y3Rvci5uYW1lO1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gKiBDYXN0cyBgb2JqYCB0byBgVGAsIG9wdGlvbmFsbHkgdW53cmFwcGluZyBDb21wYXQgdHlwZXMgdG8gZXhwb3NlIHRoZVxuICogdW5kZXJseWluZyBpbnN0YW5jZS4gVGhyb3dzIGlmICBgb2JqYCBpcyBub3QgYW4gaW5zdGFuY2Ugb2YgYFRgLlxuICpcbiAqIFRoaXMgY2FzdCBpcyB1c2VkIGluIHRoZSBMaXRlIGFuZCBGdWxsIFNESyB0byB2ZXJpZnkgaW5zdGFuY2UgdHlwZXMgZm9yXG4gKiBhcmd1bWVudHMgcGFzc2VkIHRvIHRoZSBwdWJsaWMgQVBJLlxuICogQGludGVybmFsXG4gKi8gKGUpO1xuICAgICAgICAgICAgcmV0dXJuIHQgPyBgYSBjdXN0b20gJHt0fSBvYmplY3RgIDogXCJhbiBvYmplY3RcIjtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gXCJmdW5jdGlvblwiID09IHR5cGVvZiBlID8gXCJhIGZ1bmN0aW9uXCIgOiBmYWlsKDEyMzI5LCB7XG4gICAgICAgIHR5cGU6IHR5cGVvZiBlXG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9jYXN0KGUsIFxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbnQpIHtcbiAgICBpZiAoXCJfZGVsZWdhdGVcIiBpbiBlICYmIChcbiAgICAvLyBVbndyYXAgQ29tcGF0IHR5cGVzXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBlID0gZS5fZGVsZWdhdGUpLCAhKGUgaW5zdGFuY2VvZiB0KSkge1xuICAgICAgICBpZiAodC5uYW1lID09PSBlLmNvbnN0cnVjdG9yLm5hbWUpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIFwiVHlwZSBkb2VzIG5vdCBtYXRjaCB0aGUgZXhwZWN0ZWQgaW5zdGFuY2UuIERpZCB5b3UgcGFzcyBhIHJlZmVyZW5jZSBmcm9tIGEgZGlmZmVyZW50IEZpcmVzdG9yZSBTREs/XCIpO1xuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX3ZhbHVlRGVzY3JpcHRpb24oZSk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBgRXhwZWN0ZWQgdHlwZSAnJHt0Lm5hbWV9JywgYnV0IGl0IHdhczogJHtufWApO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBlO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfdmFsaWRhdGVQb3NpdGl2ZU51bWJlcihlLCB0KSB7XG4gICAgaWYgKHQgPD0gMCkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgYEZ1bmN0aW9uICR7ZX0oKSByZXF1aXJlcyBhIHBvc2l0aXZlIG51bWJlciwgYnV0IGl0IHdhczogJHt0fS5gKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjUgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogSGVscGVyIGZ1bmN0aW9uIHRvIGRlZmluZSBhIEpTT04gc2NoZW1hIHtAbGluayBQcm9wZXJ0eX0uXG4gKiBAcHJpdmF0ZVxuICogQGludGVybmFsXG4gKi8gZnVuY3Rpb24gcHJvcGVydHkoZSwgdCkge1xuICAgIGNvbnN0IG4gPSB7XG4gICAgICAgIHR5cGVTdHJpbmc6IGVcbiAgICB9O1xuICAgIHJldHVybiB0ICYmIChuLnZhbHVlID0gdCksIG47XG59XG5cbi8qKlxuICogVmFsaWRhdGVzIHRoZSBKU09OIG9iamVjdCBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgc2NoZW1hLCBhbmQgbmFycm93cyB0aGUgdHlwZSB0byB0aGUgcHJvdmlkZWRcbiAqIEpTT04gc2NoZW1hLlxuICogQHByaXZhdGVcbiAqIEBpbnRlcm5hbFxuICpcbiAqIEBwYXJhbSBqc29uIEEgSlNPTiBvYmplY3QgdG8gdmFsaWRhdGUuXG4gKiBAcGFyYW0gc2NoZW1lIGEge0BsaW5rIEpzb25TY2hlbWF9IHRoYXQgZGVmaW5lcyB0aGUgcHJvcGVydGllcyB0byB2YWxpZGF0ZS5cbiAqIEByZXR1cm5zIHRydWUgaWYgdGhlIEpTT04gc2NoZW1hIGV4aXN0cyB3aXRoaW4gdGhlIG9iamVjdC4gVGhyb3dzIGEgRmlyZXN0b3JlRXJyb3Igb3RoZXJ3aXNlLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV92YWxpZGF0ZUpTT04oZSwgdCkge1xuICAgIGlmICghX19QUklWQVRFX2lzUGxhaW5PYmplY3QoZSkpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIFwiSlNPTiBtdXN0IGJlIGFuIG9iamVjdFwiKTtcbiAgICBsZXQgbjtcbiAgICBmb3IgKGNvbnN0IHIgaW4gdCkgaWYgKHRbcl0pIHtcbiAgICAgICAgY29uc3QgaSA9IHRbcl0udHlwZVN0cmluZywgcyA9IFwidmFsdWVcIiBpbiB0W3JdID8ge1xuICAgICAgICAgICAgdmFsdWU6IHRbcl0udmFsdWVcbiAgICAgICAgfSA6IHZvaWQgMDtcbiAgICAgICAgaWYgKCEociBpbiBlKSkge1xuICAgICAgICAgICAgbiA9IGBKU09OIG1pc3NpbmcgcmVxdWlyZWQgZmllbGQ6ICcke3J9J2A7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBlW3JdO1xuICAgICAgICBpZiAoaSAmJiB0eXBlb2YgbyAhPT0gaSkge1xuICAgICAgICAgICAgbiA9IGBKU09OIGZpZWxkICcke3J9JyBtdXN0IGJlIGEgJHtpfS5gO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZvaWQgMCAhPT0gcyAmJiBvICE9PSBzLnZhbHVlKSB7XG4gICAgICAgICAgICBuID0gYEV4cGVjdGVkICcke3J9JyBmaWVsZCB0byBlcXVhbCAnJHtzLnZhbHVlfSdgO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKG4pIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIG4pO1xuICAgIHJldHVybiAhMDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8vIFRoZSBlYXJsaWVzdCBkYXRlIHN1cHBvcnRlZCBieSBGaXJlc3RvcmUgdGltZXN0YW1wcyAoMDAwMS0wMS0wMVQwMDowMDowMFopLlxuY29uc3QgUSA9IC02MjEzNTU5NjgwMCwgJCA9IDFlNjtcblxuLy8gTnVtYmVyIG9mIG5hbm9zZWNvbmRzIGluIGEgbWlsbGlzZWNvbmQuXG4vKipcbiAqIEEgYFRpbWVzdGFtcGAgcmVwcmVzZW50cyBhIHBvaW50IGluIHRpbWUgaW5kZXBlbmRlbnQgb2YgYW55IHRpbWUgem9uZSBvclxuICogY2FsZW5kYXIsIHJlcHJlc2VudGVkIGFzIHNlY29uZHMgYW5kIGZyYWN0aW9ucyBvZiBzZWNvbmRzIGF0IG5hbm9zZWNvbmRcbiAqIHJlc29sdXRpb24gaW4gVVRDIEVwb2NoIHRpbWUuXG4gKlxuICogSXQgaXMgZW5jb2RlZCB1c2luZyB0aGUgUHJvbGVwdGljIEdyZWdvcmlhbiBDYWxlbmRhciB3aGljaCBleHRlbmRzIHRoZVxuICogR3JlZ29yaWFuIGNhbGVuZGFyIGJhY2t3YXJkcyB0byB5ZWFyIG9uZS4gSXQgaXMgZW5jb2RlZCBhc3N1bWluZyBhbGwgbWludXRlc1xuICogYXJlIDYwIHNlY29uZHMgbG9uZywgaS5lLiBsZWFwIHNlY29uZHMgYXJlIFwic21lYXJlZFwiIHNvIHRoYXQgbm8gbGVhcCBzZWNvbmRcbiAqIHRhYmxlIGlzIG5lZWRlZCBmb3IgaW50ZXJwcmV0YXRpb24uIFJhbmdlIGlzIGZyb20gMDAwMS0wMS0wMVQwMDowMDowMFogdG9cbiAqIDk5OTktMTItMzFUMjM6NTk6NTkuOTk5OTk5OTk5Wi5cbiAqXG4gKiBGb3IgZXhhbXBsZXMgYW5kIGZ1cnRoZXIgc3BlY2lmaWNhdGlvbnMsIHJlZmVyIHRvIHRoZVxuICoge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvcHJvdG9idWYvYmxvYi9tYXN0ZXIvc3JjL2dvb2dsZS9wcm90b2J1Zi90aW1lc3RhbXAucHJvdG8gfCBUaW1lc3RhbXAgZGVmaW5pdGlvbn0uXG4gKi9cbmNsYXNzIFRpbWVzdGFtcCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyB0aW1lc3RhbXAgd2l0aCB0aGUgY3VycmVudCBkYXRlLCB3aXRoIG1pbGxpc2Vjb25kIHByZWNpc2lvbi5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIGEgbmV3IHRpbWVzdGFtcCByZXByZXNlbnRpbmcgdGhlIGN1cnJlbnQgZGF0ZS5cbiAgICAgKi9cbiAgICBzdGF0aWMgbm93KCkge1xuICAgICAgICByZXR1cm4gVGltZXN0YW1wLmZyb21NaWxsaXMoRGF0ZS5ub3coKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgdGltZXN0YW1wIGZyb20gdGhlIGdpdmVuIGRhdGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZGF0ZSAtIFRoZSBkYXRlIHRvIGluaXRpYWxpemUgdGhlIGBUaW1lc3RhbXBgIGZyb20uXG4gICAgICogQHJldHVybnMgQSBuZXcgYFRpbWVzdGFtcGAgcmVwcmVzZW50aW5nIHRoZSBzYW1lIHBvaW50IGluIHRpbWUgYXMgdGhlIGdpdmVuXG4gICAgICogICAgIGRhdGUuXG4gICAgICovICAgIHN0YXRpYyBmcm9tRGF0ZShlKSB7XG4gICAgICAgIHJldHVybiBUaW1lc3RhbXAuZnJvbU1pbGxpcyhlLmdldFRpbWUoKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgdGltZXN0YW1wIGZyb20gdGhlIGdpdmVuIG51bWJlciBvZiBtaWxsaXNlY29uZHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbWlsbGlzZWNvbmRzIC0gTnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBzaW5jZSBVbml4IGVwb2NoXG4gICAgICogICAgIDE5NzAtMDEtMDFUMDA6MDA6MDBaLlxuICAgICAqIEByZXR1cm5zIEEgbmV3IGBUaW1lc3RhbXBgIHJlcHJlc2VudGluZyB0aGUgc2FtZSBwb2ludCBpbiB0aW1lIGFzIHRoZSBnaXZlblxuICAgICAqICAgICBudW1iZXIgb2YgbWlsbGlzZWNvbmRzLlxuICAgICAqLyAgICBzdGF0aWMgZnJvbU1pbGxpcyhlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBNYXRoLmZsb29yKGUgLyAxZTMpLCBuID0gTWF0aC5mbG9vcigoZSAtIDFlMyAqIHQpICogJCk7XG4gICAgICAgIHJldHVybiBuZXcgVGltZXN0YW1wKHQsIG4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IHRpbWVzdGFtcC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzZWNvbmRzIC0gVGhlIG51bWJlciBvZiBzZWNvbmRzIG9mIFVUQyB0aW1lIHNpbmNlIFVuaXggZXBvY2hcbiAgICAgKiAgICAgMTk3MC0wMS0wMVQwMDowMDowMFouIE11c3QgYmUgZnJvbSAwMDAxLTAxLTAxVDAwOjAwOjAwWiB0b1xuICAgICAqICAgICA5OTk5LTEyLTMxVDIzOjU5OjU5WiBpbmNsdXNpdmUuXG4gICAgICogQHBhcmFtIG5hbm9zZWNvbmRzIC0gVGhlIG5vbi1uZWdhdGl2ZSBmcmFjdGlvbnMgb2YgYSBzZWNvbmQgYXQgbmFub3NlY29uZFxuICAgICAqICAgICByZXNvbHV0aW9uLiBOZWdhdGl2ZSBzZWNvbmQgdmFsdWVzIHdpdGggZnJhY3Rpb25zIG11c3Qgc3RpbGwgaGF2ZVxuICAgICAqICAgICBub24tbmVnYXRpdmUgbmFub3NlY29uZHMgdmFsdWVzIHRoYXQgY291bnQgZm9yd2FyZCBpbiB0aW1lLiBNdXN0IGJlXG4gICAgICogICAgIGZyb20gMCB0byA5OTksOTk5LDk5OSBpbmNsdXNpdmUuXG4gICAgICovICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBudW1iZXIgb2Ygc2Vjb25kcyBvZiBVVEMgdGltZSBzaW5jZSBVbml4IGVwb2NoIDE5NzAtMDEtMDFUMDA6MDA6MDBaLlxuICAgICAqL1xuICAgIGUsIFxuICAgIC8qKlxuICAgICAqIFRoZSBmcmFjdGlvbnMgb2YgYSBzZWNvbmQgYXQgbmFub3NlY29uZCByZXNvbHV0aW9uLipcbiAgICAgKi9cbiAgICB0KSB7XG4gICAgICAgIGlmICh0aGlzLnNlY29uZHMgPSBlLCB0aGlzLm5hbm9zZWNvbmRzID0gdCwgdCA8IDApIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIFwiVGltZXN0YW1wIG5hbm9zZWNvbmRzIG91dCBvZiByYW5nZTogXCIgKyB0KTtcbiAgICAgICAgaWYgKHQgPj0gMWU5KSB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBcIlRpbWVzdGFtcCBuYW5vc2Vjb25kcyBvdXQgb2YgcmFuZ2U6IFwiICsgdCk7XG4gICAgICAgIGlmIChlIDwgUSkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgXCJUaW1lc3RhbXAgc2Vjb25kcyBvdXQgb2YgcmFuZ2U6IFwiICsgZSk7XG4gICAgICAgIC8vIFRoaXMgd2lsbCBicmVhayBpbiB0aGUgeWVhciAxMCwwMDAuXG4gICAgICAgICAgICAgICAgaWYgKGUgPj0gMjUzNDAyMzAwODAwKSB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBcIlRpbWVzdGFtcCBzZWNvbmRzIG91dCBvZiByYW5nZTogXCIgKyBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29udmVydHMgYSBgVGltZXN0YW1wYCB0byBhIEphdmFTY3JpcHQgYERhdGVgIG9iamVjdC4gVGhpcyBjb252ZXJzaW9uXG4gICAgICogY2F1c2VzIGEgbG9zcyBvZiBwcmVjaXNpb24gc2luY2UgYERhdGVgIG9iamVjdHMgb25seSBzdXBwb3J0IG1pbGxpc2Vjb25kXG4gICAgICogcHJlY2lzaW9uLlxuICAgICAqXG4gICAgICogQHJldHVybnMgSmF2YVNjcmlwdCBgRGF0ZWAgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgc2FtZSBwb2ludCBpbiB0aW1lIGFzXG4gICAgICogICAgIHRoaXMgYFRpbWVzdGFtcGAsIHdpdGggbWlsbGlzZWNvbmQgcHJlY2lzaW9uLlxuICAgICAqLyAgICB0b0RhdGUoKSB7XG4gICAgICAgIHJldHVybiBuZXcgRGF0ZSh0aGlzLnRvTWlsbGlzKCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBhIGBUaW1lc3RhbXBgIHRvIGEgbnVtZXJpYyB0aW1lc3RhbXAgKGluIG1pbGxpc2Vjb25kcyBzaW5jZVxuICAgICAqIGVwb2NoKS4gVGhpcyBvcGVyYXRpb24gY2F1c2VzIGEgbG9zcyBvZiBwcmVjaXNpb24uXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBUaGUgcG9pbnQgaW4gdGltZSBjb3JyZXNwb25kaW5nIHRvIHRoaXMgdGltZXN0YW1wLCByZXByZXNlbnRlZCBhc1xuICAgICAqICAgICB0aGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBzaW5jZSBVbml4IGVwb2NoIDE5NzAtMDEtMDFUMDA6MDA6MDBaLlxuICAgICAqLyAgICB0b01pbGxpcygpIHtcbiAgICAgICAgcmV0dXJuIDFlMyAqIHRoaXMuc2Vjb25kcyArIHRoaXMubmFub3NlY29uZHMgLyAkO1xuICAgIH1cbiAgICBfY29tcGFyZVRvKGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2Vjb25kcyA9PT0gZS5zZWNvbmRzID8gX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IodGhpcy5uYW5vc2Vjb25kcywgZS5uYW5vc2Vjb25kcykgOiBfX1BSSVZBVEVfcHJpbWl0aXZlQ29tcGFyYXRvcih0aGlzLnNlY29uZHMsIGUuc2Vjb25kcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGBUaW1lc3RhbXBgIGlzIGVxdWFsIHRvIHRoZSBwcm92aWRlZCBvbmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb3RoZXIgLSBUaGUgYFRpbWVzdGFtcGAgdG8gY29tcGFyZSBhZ2FpbnN0LlxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhpcyBgVGltZXN0YW1wYCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqLyAgICBpc0VxdWFsKGUpIHtcbiAgICAgICAgcmV0dXJuIGUuc2Vjb25kcyA9PT0gdGhpcy5zZWNvbmRzICYmIGUubmFub3NlY29uZHMgPT09IHRoaXMubmFub3NlY29uZHM7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgdGV4dHVhbCByZXByZXNlbnRhdGlvbiBvZiB0aGlzIGBUaW1lc3RhbXBgLiAqLyAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIFwiVGltZXN0YW1wKHNlY29uZHM9XCIgKyB0aGlzLnNlY29uZHMgKyBcIiwgbmFub3NlY29uZHM9XCIgKyB0aGlzLm5hbm9zZWNvbmRzICsgXCIpXCI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBKU09OLXNlcmlhbGl6YWJsZSByZXByZXNlbnRhdGlvbiBvZiB0aGlzIGBUaW1lc3RhbXBgLlxuICAgICAqLyAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiBUaW1lc3RhbXAuX2pzb25TY2hlbWFWZXJzaW9uLFxuICAgICAgICAgICAgc2Vjb25kczogdGhpcy5zZWNvbmRzLFxuICAgICAgICAgICAgbmFub3NlY29uZHM6IHRoaXMubmFub3NlY29uZHNcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQnVpbGRzIGEgYFRpbWVzdGFtcGAgaW5zdGFuY2UgZnJvbSBhIEpTT04gb2JqZWN0IGNyZWF0ZWQgYnkge0BsaW5rIFRpbWVzdGFtcC50b0pTT059LlxuICAgICAqLyAgICBzdGF0aWMgZnJvbUpTT04oZSkge1xuICAgICAgICBpZiAoX19QUklWQVRFX3ZhbGlkYXRlSlNPTihlLCBUaW1lc3RhbXAuX2pzb25TY2hlbWEpKSByZXR1cm4gbmV3IFRpbWVzdGFtcChlLnNlY29uZHMsIGUubmFub3NlY29uZHMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyB0aGlzIG9iamVjdCB0byBhIHByaW1pdGl2ZSBzdHJpbmcsIHdoaWNoIGFsbG93cyBgVGltZXN0YW1wYCBvYmplY3RzXG4gICAgICogdG8gYmUgY29tcGFyZWQgdXNpbmcgdGhlIGA+YCwgYDw9YCwgYD49YCBhbmQgYD5gIG9wZXJhdG9ycy5cbiAgICAgKi8gICAgdmFsdWVPZigpIHtcbiAgICAgICAgLy8gVGhpcyBtZXRob2QgcmV0dXJucyBhIHN0cmluZyBvZiB0aGUgZm9ybSA8c2Vjb25kcz4uPG5hbm9zZWNvbmRzPiB3aGVyZVxuICAgICAgICAvLyA8c2Vjb25kcz4gaXMgdHJhbnNsYXRlZCB0byBoYXZlIGEgbm9uLW5lZ2F0aXZlIHZhbHVlIGFuZCBib3RoIDxzZWNvbmRzPlxuICAgICAgICAvLyBhbmQgPG5hbm9zZWNvbmRzPiBhcmUgbGVmdC1wYWRkZWQgd2l0aCB6ZXJvZXMgdG8gYmUgYSBjb25zaXN0ZW50IGxlbmd0aC5cbiAgICAgICAgLy8gU3RyaW5ncyB3aXRoIHRoaXMgZm9ybWF0IHRoZW4gaGF2ZSBhIGxleGljb2dyYXBoaWNhbCBvcmRlcmluZyB0aGF0IG1hdGNoZXNcbiAgICAgICAgLy8gdGhlIGV4cGVjdGVkIG9yZGVyaW5nLiBUaGUgPHNlY29uZHM+IHRyYW5zbGF0aW9uIGlzIGRvbmUgdG8gYXZvaWQgaGF2aW5nXG4gICAgICAgIC8vIGEgbGVhZGluZyBuZWdhdGl2ZSBzaWduIChpLmUuIGEgbGVhZGluZyAnLScgY2hhcmFjdGVyKSBpbiBpdHMgc3RyaW5nXG4gICAgICAgIC8vIHJlcHJlc2VudGF0aW9uLCB3aGljaCB3b3VsZCBhZmZlY3QgaXRzIGxleGljb2dyYXBoaWNhbCBvcmRlcmluZy5cbiAgICAgICAgY29uc3QgZSA9IHRoaXMuc2Vjb25kcyAtIFE7XG4gICAgICAgIC8vIE5vdGU6IFVwIHRvIDEyIGRlY2ltYWwgZGlnaXRzIGFyZSByZXF1aXJlZCB0byByZXByZXNlbnQgYWxsIHZhbGlkXG4gICAgICAgIC8vICdzZWNvbmRzJyB2YWx1ZXMuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFN0cmluZyhlKS5wYWRTdGFydCgxMiwgXCIwXCIpICsgXCIuXCIgKyBTdHJpbmcodGhpcy5uYW5vc2Vjb25kcykucGFkU3RhcnQoOSwgXCIwXCIpO1xuICAgIH1cbn1cblxuVGltZXN0YW1wLl9qc29uU2NoZW1hVmVyc2lvbiA9IFwiZmlyZXN0b3JlL3RpbWVzdGFtcC8xLjBcIiwgVGltZXN0YW1wLl9qc29uU2NoZW1hID0ge1xuICAgIHR5cGU6IHByb3BlcnR5KFwic3RyaW5nXCIsIFRpbWVzdGFtcC5fanNvblNjaGVtYVZlcnNpb24pLFxuICAgIHNlY29uZHM6IHByb3BlcnR5KFwibnVtYmVyXCIpLFxuICAgIG5hbm9zZWNvbmRzOiBwcm9wZXJ0eShcIm51bWJlclwiKVxufTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSB2ZXJzaW9uIG9mIGEgZG9jdW1lbnQgaW4gRmlyZXN0b3JlLiBUaGlzIGNvcnJlc3BvbmRzIHRvIHRoZSB2ZXJzaW9uXG4gKiB0aW1lc3RhbXAsIHN1Y2ggYXMgdXBkYXRlX3RpbWUgb3IgcmVhZF90aW1lLlxuICovXG5jbGFzcyBTbmFwc2hvdFZlcnNpb24ge1xuICAgIHN0YXRpYyBmcm9tVGltZXN0YW1wKGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTbmFwc2hvdFZlcnNpb24oZSk7XG4gICAgfVxuICAgIHN0YXRpYyBtaW4oKSB7XG4gICAgICAgIHJldHVybiBuZXcgU25hcHNob3RWZXJzaW9uKG5ldyBUaW1lc3RhbXAoMCwgMCkpO1xuICAgIH1cbiAgICBzdGF0aWMgbWF4KCkge1xuICAgICAgICByZXR1cm4gbmV3IFNuYXBzaG90VmVyc2lvbihuZXcgVGltZXN0YW1wKDI1MzQwMjMwMDc5OSwgOTk5OTk5OTk5KSk7XG4gICAgfVxuICAgIGNvbnN0cnVjdG9yKGUpIHtcbiAgICAgICAgdGhpcy50aW1lc3RhbXAgPSBlO1xuICAgIH1cbiAgICBjb21wYXJlVG8oZSkge1xuICAgICAgICByZXR1cm4gdGhpcy50aW1lc3RhbXAuX2NvbXBhcmVUbyhlLnRpbWVzdGFtcCk7XG4gICAgfVxuICAgIGlzRXF1YWwoZSkge1xuICAgICAgICByZXR1cm4gdGhpcy50aW1lc3RhbXAuaXNFcXVhbChlLnRpbWVzdGFtcCk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgbnVtYmVyIHJlcHJlc2VudGF0aW9uIG9mIHRoZSB2ZXJzaW9uIGZvciB1c2UgaW4gc3BlYyB0ZXN0cy4gKi8gICAgdG9NaWNyb3NlY29uZHMoKSB7XG4gICAgICAgIC8vIENvbnZlcnQgdG8gbWljcm9zZWNvbmRzLlxuICAgICAgICByZXR1cm4gMWU2ICogdGhpcy50aW1lc3RhbXAuc2Vjb25kcyArIHRoaXMudGltZXN0YW1wLm5hbm9zZWNvbmRzIC8gMWUzO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIFwiU25hcHNob3RWZXJzaW9uKFwiICsgdGhpcy50aW1lc3RhbXAudG9TdHJpbmcoKSArIFwiKVwiO1xuICAgIH1cbiAgICB0b1RpbWVzdGFtcCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVGhlIGluaXRpYWwgbXV0YXRpb24gYmF0Y2ggaWQgZm9yIGVhY2ggaW5kZXguIEdldHMgdXBkYXRlZCBkdXJpbmcgaW5kZXhcbiAqIGJhY2tmaWxsLlxuICovIGNvbnN0IFUgPSAtMTtcblxuLyoqXG4gKiBUaGUgaW5pdGlhbCBzZXF1ZW5jZSBudW1iZXIgZm9yIGVhY2ggaW5kZXguIEdldHMgdXBkYXRlZCBkdXJpbmcgaW5kZXhcbiAqIGJhY2tmaWxsLlxuICovXG4vKipcbiAqIEFuIGluZGV4IGRlZmluaXRpb24gZm9yIGZpZWxkIGluZGV4ZXMgaW4gRmlyZXN0b3JlLlxuICpcbiAqIEV2ZXJ5IGluZGV4IGlzIGFzc29jaWF0ZWQgd2l0aCBhIGNvbGxlY3Rpb24uIFRoZSBkZWZpbml0aW9uIGNvbnRhaW5zIGEgbGlzdFxuICogb2YgZmllbGRzIGFuZCB0aGVpciBpbmRleCBraW5kICh3aGljaCBjYW4gYmUgYEFTQ0VORElOR2AsIGBERVNDRU5ESU5HYCBvclxuICogYENPTlRBSU5TYCBmb3IgQXJyYXlDb250YWlucy9BcnJheUNvbnRhaW5zQW55IHF1ZXJpZXMpLlxuICpcbiAqIFVubGlrZSB0aGUgYmFja2VuZCwgdGhlIFNESyBkb2VzIG5vdCBkaWZmZXJlbnRpYXRlIGJldHdlZW4gY29sbGVjdGlvbiBvclxuICogY29sbGVjdGlvbiBncm91cC1zY29wZWQgaW5kaWNlcy4gRXZlcnkgaW5kZXggY2FuIGJlIHVzZWQgZm9yIGJvdGggc2luZ2xlXG4gKiBjb2xsZWN0aW9uIGFuZCBjb2xsZWN0aW9uIGdyb3VwIHF1ZXJpZXMuXG4gKi9cbmNsYXNzIEZpZWxkSW5kZXgge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBpbmRleCBJRC4gUmV0dXJucyAtMSBpZiB0aGUgaW5kZXggSUQgaXMgbm90IGF2YWlsYWJsZSAoZS5nLiB0aGUgaW5kZXhcbiAgICAgKiBoYXMgbm90IHlldCBiZWVuIHBlcnNpc3RlZCkuXG4gICAgICovXG4gICAgZSwgXG4gICAgLyoqIFRoZSBjb2xsZWN0aW9uIElEIHRoaXMgaW5kZXggYXBwbGllcyB0by4gKi9cbiAgICB0LCBcbiAgICAvKiogVGhlIGZpZWxkIHNlZ21lbnRzIGZvciB0aGlzIGluZGV4LiAqL1xuICAgIG4sIFxuICAgIC8qKiBTaG93cyBob3cgdXAtdG8tZGF0ZSB0aGUgaW5kZXggaXMgZm9yIHRoZSBjdXJyZW50IHVzZXIuICovXG4gICAgcikge1xuICAgICAgICB0aGlzLmluZGV4SWQgPSBlLCB0aGlzLmNvbGxlY3Rpb25Hcm91cCA9IHQsIHRoaXMuZmllbGRzID0gbiwgdGhpcy5pbmRleFN0YXRlID0gcjtcbiAgICB9XG59XG5cbi8qKiBBbiBJRCBmb3IgYW4gaW5kZXggdGhhdCBoYXMgbm90IHlldCBiZWVuIGFkZGVkIHRvIHBlcnNpc3RlbmNlLiAgKi9cbi8qKiBSZXR1cm5zIHRoZSBBcnJheUNvbnRhaW5zL0FycmF5Q29udGFpbnNBbnkgc2VnbWVudCBmb3IgdGhpcyBpbmRleC4gKi9cbmZ1bmN0aW9uIF9fUFJJVkFURV9maWVsZEluZGV4R2V0QXJyYXlTZWdtZW50KGUpIHtcbiAgICByZXR1cm4gZS5maWVsZHMuZmluZCgoZSA9PiAyIC8qIEluZGV4S2luZC5DT05UQUlOUyAqLyA9PT0gZS5raW5kKSk7XG59XG5cbi8qKiBSZXR1cm5zIGFsbCBkaXJlY3Rpb25hbCAoYXNjZW5kaW5nL2Rlc2NlbmRpbmcpIHNlZ21lbnRzIGZvciB0aGlzIGluZGV4LiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfZmllbGRJbmRleEdldERpcmVjdGlvbmFsU2VnbWVudHMoZSkge1xuICAgIHJldHVybiBlLmZpZWxkcy5maWx0ZXIoKGUgPT4gMiAvKiBJbmRleEtpbmQuQ09OVEFJTlMgKi8gIT09IGUua2luZCkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIG9yZGVyIG9mIHRoZSBkb2N1bWVudCBrZXkgY29tcG9uZW50IGZvciB0aGUgZ2l2ZW4gaW5kZXguXG4gKlxuICogUE9SVElORyBOT1RFOiBUaGlzIGlzIG9ubHkgdXNlZCBpbiB0aGUgV2ViIEluZGV4ZWREYiBpbXBsZW1lbnRhdGlvbi5cbiAqL1xuLyoqXG4gKiBDb21wYXJlcyBpbmRleGVzIGJ5IGNvbGxlY3Rpb24gZ3JvdXAgYW5kIHNlZ21lbnRzLiBJZ25vcmVzIHVwZGF0ZSB0aW1lIGFuZFxuICogaW5kZXggSUQuXG4gKi9cbmZ1bmN0aW9uIF9fUFJJVkFURV9maWVsZEluZGV4U2VtYW50aWNDb21wYXJhdG9yKGUsIHQpIHtcbiAgICBsZXQgbiA9IF9fUFJJVkFURV9wcmltaXRpdmVDb21wYXJhdG9yKGUuY29sbGVjdGlvbkdyb3VwLCB0LmNvbGxlY3Rpb25Hcm91cCk7XG4gICAgaWYgKDAgIT09IG4pIHJldHVybiBuO1xuICAgIGZvciAobGV0IHIgPSAwOyByIDwgTWF0aC5taW4oZS5maWVsZHMubGVuZ3RoLCB0LmZpZWxkcy5sZW5ndGgpOyArK3IpIGlmIChuID0gX19QUklWQVRFX2luZGV4U2VnbWVudENvbXBhcmF0b3IoZS5maWVsZHNbcl0sIHQuZmllbGRzW3JdKSwgXG4gICAgMCAhPT0gbikgcmV0dXJuIG47XG4gICAgcmV0dXJuIF9fUFJJVkFURV9wcmltaXRpdmVDb21wYXJhdG9yKGUuZmllbGRzLmxlbmd0aCwgdC5maWVsZHMubGVuZ3RoKTtcbn1cblxuLyoqIFJldHVybnMgYSBkZWJ1ZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgZmllbGQgaW5kZXggKi8gRmllbGRJbmRleC5VTktOT1dOX0lEID0gLTE7XG5cbi8qKiBBbiBpbmRleCBjb21wb25lbnQgY29uc2lzdGluZyBvZiBmaWVsZCBwYXRoIGFuZCBpbmRleCB0eXBlLiAgKi9cbmNsYXNzIEluZGV4U2VnbWVudCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqIFRoZSBmaWVsZCBwYXRoIG9mIHRoZSBjb21wb25lbnQuICovXG4gICAgZSwgXG4gICAgLyoqIFRoZSBmaWVsZHMgc29ydGluZyBvcmRlci4gKi9cbiAgICB0KSB7XG4gICAgICAgIHRoaXMuZmllbGRQYXRoID0gZSwgdGhpcy5raW5kID0gdDtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9pbmRleFNlZ21lbnRDb21wYXJhdG9yKGUsIHQpIHtcbiAgICBjb25zdCBuID0gRmllbGRQYXRoJDEuY29tcGFyYXRvcihlLmZpZWxkUGF0aCwgdC5maWVsZFBhdGgpO1xuICAgIHJldHVybiAwICE9PSBuID8gbiA6IF9fUFJJVkFURV9wcmltaXRpdmVDb21wYXJhdG9yKGUua2luZCwgdC5raW5kKTtcbn1cblxuLyoqXG4gKiBTdG9yZXMgdGhlIFwiaGlnaCB3YXRlciBtYXJrXCIgdGhhdCBpbmRpY2F0ZXMgaG93IHVwZGF0ZWQgdGhlIEluZGV4IGlzIGZvciB0aGVcbiAqIGN1cnJlbnQgdXNlci5cbiAqLyBjbGFzcyBJbmRleFN0YXRlIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgd2hlbiB0aGUgaW5kZXggd2FzIGxhc3QgdXBkYXRlZCAocmVsYXRpdmUgdG8gb3RoZXIgaW5kZXhlcykuXG4gICAgICovXG4gICAgZSwgXG4gICAgLyoqIFRoZSB0aGUgbGF0ZXN0IGluZGV4ZWQgcmVhZCB0aW1lLCBkb2N1bWVudCBhbmQgYmF0Y2ggaWQuICovXG4gICAgdCkge1xuICAgICAgICB0aGlzLnNlcXVlbmNlTnVtYmVyID0gZSwgdGhpcy5vZmZzZXQgPSB0O1xuICAgIH1cbiAgICAvKiogVGhlIHN0YXRlIG9mIGFuIGluZGV4IHRoYXQgaGFzIG5vdCB5ZXQgYmVlbiBiYWNrZmlsbGVkLiAqLyAgICBzdGF0aWMgZW1wdHkoKSB7XG4gICAgICAgIHJldHVybiBuZXcgSW5kZXhTdGF0ZSgwLCBJbmRleE9mZnNldC5taW4oKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYW4gb2Zmc2V0IHRoYXQgbWF0Y2hlcyBhbGwgZG9jdW1lbnRzIHdpdGggYSByZWFkIHRpbWUgaGlnaGVyIHRoYW5cbiAqIGByZWFkVGltZWAuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX25ld0luZGV4T2Zmc2V0U3VjY2Vzc29yRnJvbVJlYWRUaW1lKGUsIHQpIHtcbiAgICAvLyBXZSB3YW50IHRvIGNyZWF0ZSBhbiBvZmZzZXQgdGhhdCBtYXRjaGVzIGFsbCBkb2N1bWVudHMgd2l0aCBhIHJlYWQgdGltZVxuICAgIC8vIGdyZWF0ZXIgdGhhbiB0aGUgcHJvdmlkZWQgcmVhZCB0aW1lLiBUbyBkbyBzbywgd2UgdGVjaG5pY2FsbHkgbmVlZCB0b1xuICAgIC8vIGNyZWF0ZSBhbiBvZmZzZXQgZm9yIGAocmVhZFRpbWUsIE1BWF9ET0NVTUVOVF9LRVkpYC4gV2hpbGUgd2UgY291bGQgdXNlXG4gICAgLy8gVW5pY29kZSBjb2RlcG9pbnRzIHRvIGdlbmVyYXRlIE1BWF9ET0NVTUVOVF9LRVksIGl0IGlzIG11Y2ggZWFzaWVyIHRvIHVzZVxuICAgIC8vIGAocmVhZFRpbWUgKyAxLCBEb2N1bWVudEtleS5lbXB0eSgpKWAgc2luY2UgYD4gRG9jdW1lbnRLZXkuZW1wdHkoKWAgbWF0Y2hlc1xuICAgIC8vIGFsbCB2YWxpZCBkb2N1bWVudCBJRHMuXG4gICAgY29uc3QgbiA9IGUudG9UaW1lc3RhbXAoKS5zZWNvbmRzLCByID0gZS50b1RpbWVzdGFtcCgpLm5hbm9zZWNvbmRzICsgMSwgaSA9IFNuYXBzaG90VmVyc2lvbi5mcm9tVGltZXN0YW1wKDFlOSA9PT0gciA/IG5ldyBUaW1lc3RhbXAobiArIDEsIDApIDogbmV3IFRpbWVzdGFtcChuLCByKSk7XG4gICAgcmV0dXJuIG5ldyBJbmRleE9mZnNldChpLCBEb2N1bWVudEtleS5lbXB0eSgpLCB0KTtcbn1cblxuLyoqIENyZWF0ZXMgYSBuZXcgb2Zmc2V0IGJhc2VkIG9uIHRoZSBwcm92aWRlZCBkb2N1bWVudC4gKi8gZnVuY3Rpb24gX19QUklWQVRFX25ld0luZGV4T2Zmc2V0RnJvbURvY3VtZW50KGUpIHtcbiAgICByZXR1cm4gbmV3IEluZGV4T2Zmc2V0KGUucmVhZFRpbWUsIGUua2V5LCBVKTtcbn1cblxuLyoqXG4gKiBTdG9yZXMgdGhlIGxhdGVzdCByZWFkIHRpbWUsIGRvY3VtZW50IGFuZCBiYXRjaCBJRCB0aGF0IHdlcmUgcHJvY2Vzc2VkIGZvciBhblxuICogaW5kZXguXG4gKi8gY2xhc3MgSW5kZXhPZmZzZXQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBsYXRlc3QgcmVhZCB0aW1lIHZlcnNpb24gdGhhdCBoYXMgYmVlbiBpbmRleGVkIGJ5IEZpcmVzdG9yZSBmb3IgdGhpc1xuICAgICAqIGZpZWxkIGluZGV4LlxuICAgICAqL1xuICAgIGUsIFxuICAgIC8qKlxuICAgICAqIFRoZSBrZXkgb2YgdGhlIGxhc3QgZG9jdW1lbnQgdGhhdCB3YXMgaW5kZXhlZCBmb3IgdGhpcyBxdWVyeS4gVXNlXG4gICAgICogYERvY3VtZW50S2V5LmVtcHR5KClgIGlmIG5vIGRvY3VtZW50IGhhcyBiZWVuIGluZGV4ZWQuXG4gICAgICovXG4gICAgdCwgXG4gICAgLypcbiAgICAgKiBUaGUgbGFyZ2VzdCBtdXRhdGlvbiBiYXRjaCBpZCB0aGF0J3MgYmVlbiBwcm9jZXNzZWQgYnkgRmlyZXN0b3JlLlxuICAgICAqL1xuICAgIG4pIHtcbiAgICAgICAgdGhpcy5yZWFkVGltZSA9IGUsIHRoaXMuZG9jdW1lbnRLZXkgPSB0LCB0aGlzLmxhcmdlc3RCYXRjaElkID0gbjtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgYW4gb2Zmc2V0IHRoYXQgc29ydHMgYmVmb3JlIGFsbCByZWd1bGFyIG9mZnNldHMuICovICAgIHN0YXRpYyBtaW4oKSB7XG4gICAgICAgIHJldHVybiBuZXcgSW5kZXhPZmZzZXQoU25hcHNob3RWZXJzaW9uLm1pbigpLCBEb2N1bWVudEtleS5lbXB0eSgpLCBVKTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgYW4gb2Zmc2V0IHRoYXQgc29ydHMgYWZ0ZXIgYWxsIHJlZ3VsYXIgb2Zmc2V0cy4gKi8gICAgc3RhdGljIG1heCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBJbmRleE9mZnNldChTbmFwc2hvdFZlcnNpb24ubWF4KCksIERvY3VtZW50S2V5LmVtcHR5KCksIFUpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2luZGV4T2Zmc2V0Q29tcGFyYXRvcihlLCB0KSB7XG4gICAgbGV0IG4gPSBlLnJlYWRUaW1lLmNvbXBhcmVUbyh0LnJlYWRUaW1lKTtcbiAgICByZXR1cm4gMCAhPT0gbiA/IG4gOiAobiA9IERvY3VtZW50S2V5LmNvbXBhcmF0b3IoZS5kb2N1bWVudEtleSwgdC5kb2N1bWVudEtleSksIFxuICAgIDAgIT09IG4gPyBuIDogX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IoZS5sYXJnZXN0QmF0Y2hJZCwgdC5sYXJnZXN0QmF0Y2hJZCkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCBLID0gXCJUaGUgY3VycmVudCB0YWIgaXMgbm90IGluIHRoZSByZXF1aXJlZCBzdGF0ZSB0byBwZXJmb3JtIHRoaXMgb3BlcmF0aW9uLiBJdCBtaWdodCBiZSBuZWNlc3NhcnkgdG8gcmVmcmVzaCB0aGUgYnJvd3NlciB0YWIuXCI7XG5cbi8qKlxuICogQSBiYXNlIGNsYXNzIHJlcHJlc2VudGluZyBhIHBlcnNpc3RlbmNlIHRyYW5zYWN0aW9uLCBlbmNhcHN1bGF0aW5nIGJvdGggdGhlXG4gKiB0cmFuc2FjdGlvbidzIHNlcXVlbmNlIG51bWJlcnMgYXMgd2VsbCBhcyBhIGxpc3Qgb2Ygb25Db21taXR0ZWQgbGlzdGVuZXJzLlxuICpcbiAqIFdoZW4geW91IGNhbGwgUGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oKSwgaXQgd2lsbCBjcmVhdGUgYSB0cmFuc2FjdGlvbiBhbmRcbiAqIHBhc3MgaXQgdG8geW91ciBjYWxsYmFjay4gWW91IHRoZW4gcGFzcyBpdCB0byBhbnkgbWV0aG9kIHRoYXQgb3BlcmF0ZXNcbiAqIG9uIHBlcnNpc3RlbmNlLlxuICovIGNsYXNzIFBlcnNpc3RlbmNlVHJhbnNhY3Rpb24ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLm9uQ29tbWl0dGVkTGlzdGVuZXJzID0gW107XG4gICAgfVxuICAgIGFkZE9uQ29tbWl0dGVkTGlzdGVuZXIoZSkge1xuICAgICAgICB0aGlzLm9uQ29tbWl0dGVkTGlzdGVuZXJzLnB1c2goZSk7XG4gICAgfVxuICAgIHJhaXNlT25Db21taXR0ZWRFdmVudCgpIHtcbiAgICAgICAgdGhpcy5vbkNvbW1pdHRlZExpc3RlbmVycy5mb3JFYWNoKChlID0+IGUoKSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVmVyaWZpZXMgdGhlIGVycm9yIHRocm93biBieSBhIExvY2FsU3RvcmUgb3BlcmF0aW9uLiBJZiBhIExvY2FsU3RvcmVcbiAqIG9wZXJhdGlvbiBmYWlscyBiZWNhdXNlIHRoZSBwcmltYXJ5IGxlYXNlIGhhcyBiZWVuIHRha2VuIGJ5IGFub3RoZXIgY2xpZW50LFxuICogd2UgaWdub3JlIHRoZSBlcnJvciAodGhlIHBlcnNpc3RlbmNlIGxheWVyIHdpbGwgaW1tZWRpYXRlbHkgY2FsbFxuICogYGFwcGx5UHJpbWFyeUxlYXNlYCB0byBwcm9wYWdhdGUgdGhlIHByaW1hcnkgc3RhdGUgY2hhbmdlKS4gQWxsIG90aGVyIGVycm9yc1xuICogYXJlIHJlLXRocm93bi5cbiAqXG4gKiBAcGFyYW0gZXJyIC0gQW4gZXJyb3IgcmV0dXJuZWQgYnkgYSBMb2NhbFN0b3JlIG9wZXJhdGlvbi5cbiAqIEByZXR1cm5zIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIGFmdGVyIHdlIHJlY292ZXJlZCwgb3IgdGhlIG9yaWdpbmFsIGVycm9yLlxuICovIGFzeW5jIGZ1bmN0aW9uIF9fUFJJVkFURV9pZ25vcmVJZlByaW1hcnlMZWFzZUxvc3MoZSkge1xuICAgIGlmIChlLmNvZGUgIT09IE4uRkFJTEVEX1BSRUNPTkRJVElPTiB8fCBlLm1lc3NhZ2UgIT09IEspIHRocm93IGU7XG4gICAgX19QUklWQVRFX2xvZ0RlYnVnKFwiTG9jYWxTdG9yZVwiLCBcIlVuZXhwZWN0ZWRseSBsb3N0IHByaW1hcnkgbGVhc2VcIik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFBlcnNpc3RlbmNlUHJvbWlzZSBpcyBlc3NlbnRpYWxseSBhIHJlLWltcGxlbWVudGF0aW9uIG9mIFByb21pc2UgZXhjZXB0XG4gKiBpdCBoYXMgYSAubmV4dCgpIG1ldGhvZCBpbnN0ZWFkIG9mIC50aGVuKCkgYW5kIC5uZXh0KCkgYW5kIC5jYXRjaCgpIGNhbGxiYWNrc1xuICogYXJlIGV4ZWN1dGVkIHN5bmNocm9ub3VzbHkgd2hlbiBhIFBlcnNpc3RlbmNlUHJvbWlzZSByZXNvbHZlcyByYXRoZXIgdGhhblxuICogYXN5bmNocm9ub3VzbHkgKFByb21pc2UgaW1wbGVtZW50YXRpb25zIHVzZSBzZXRJbW1lZGlhdGUoKSBvciBzaW1pbGFyKS5cbiAqXG4gKiBUaGlzIGlzIG5lY2Vzc2FyeSB0byBpbnRlcm9wZXJhdGUgd2l0aCBJbmRleGVkREIgd2hpY2ggd2lsbCBhdXRvbWF0aWNhbGx5XG4gKiBjb21taXQgdHJhbnNhY3Rpb25zIGlmIGNvbnRyb2wgaXMgcmV0dXJuZWQgdG8gdGhlIGV2ZW50IGxvb3Agd2l0aG91dFxuICogc3luY2hyb25vdXNseSBpbml0aWF0aW5nIGFub3RoZXIgb3BlcmF0aW9uIG9uIHRoZSB0cmFuc2FjdGlvbi5cbiAqXG4gKiBOT1RFOiAudGhlbigpIGFuZCAuY2F0Y2goKSBvbmx5IGFsbG93IGEgc2luZ2xlIGNvbnN1bWVyLCB1bmxpa2Ugbm9ybWFsXG4gKiBQcm9taXNlcy5cbiAqLyBjbGFzcyBQZXJzaXN0ZW5jZVByb21pc2Uge1xuICAgIGNvbnN0cnVjdG9yKGUpIHtcbiAgICAgICAgLy8gTk9URTogbmV4dC9jYXRjaENhbGxiYWNrIHdpbGwgYWx3YXlzIHBvaW50IHRvIG91ciBvd24gd3JhcHBlciBmdW5jdGlvbnMsXG4gICAgICAgIC8vIG5vdCB0aGUgdXNlcidzIHJhdyBuZXh0KCkgb3IgY2F0Y2goKSBjYWxsYmFja3MuXG4gICAgICAgIHRoaXMubmV4dENhbGxiYWNrID0gbnVsbCwgdGhpcy5jYXRjaENhbGxiYWNrID0gbnVsbCwgXG4gICAgICAgIC8vIFdoZW4gdGhlIG9wZXJhdGlvbiByZXNvbHZlcywgd2UnbGwgc2V0IHJlc3VsdCBvciBlcnJvciBhbmQgbWFyayBpc0RvbmUuXG4gICAgICAgIHRoaXMucmVzdWx0ID0gdm9pZCAwLCB0aGlzLmVycm9yID0gdm9pZCAwLCB0aGlzLmlzRG9uZSA9ICExLCBcbiAgICAgICAgLy8gU2V0IHRvIHRydWUgd2hlbiAudGhlbigpIG9yIC5jYXRjaCgpIGFyZSBjYWxsZWQgYW5kIHByZXZlbnRzIGFkZGl0aW9uYWxcbiAgICAgICAgLy8gY2hhaW5pbmcuXG4gICAgICAgIHRoaXMuY2FsbGJhY2tBdHRhY2hlZCA9ICExLCBlKChlID0+IHtcbiAgICAgICAgICAgIHRoaXMuaXNEb25lID0gITAsIHRoaXMucmVzdWx0ID0gZSwgdGhpcy5uZXh0Q2FsbGJhY2sgJiYgXG4gICAgICAgICAgICAvLyB2YWx1ZSBzaG91bGQgYmUgZGVmaW5lZCB1bmxlc3MgVCBpcyBWb2lkLCBidXQgd2UgY2FuJ3QgZXhwcmVzc1xuICAgICAgICAgICAgLy8gdGhhdCBpbiB0aGUgdHlwZSBzeXN0ZW0uXG4gICAgICAgICAgICB0aGlzLm5leHRDYWxsYmFjayhlKTtcbiAgICAgICAgfSksIChlID0+IHtcbiAgICAgICAgICAgIHRoaXMuaXNEb25lID0gITAsIHRoaXMuZXJyb3IgPSBlLCB0aGlzLmNhdGNoQ2FsbGJhY2sgJiYgdGhpcy5jYXRjaENhbGxiYWNrKGUpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGNhdGNoKGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmV4dCh2b2lkIDAsIGUpO1xuICAgIH1cbiAgICBuZXh0KGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FsbGJhY2tBdHRhY2hlZCAmJiBmYWlsKDU5NDQwKSwgdGhpcy5jYWxsYmFja0F0dGFjaGVkID0gITAsIHRoaXMuaXNEb25lID8gdGhpcy5lcnJvciA/IHRoaXMud3JhcEZhaWx1cmUodCwgdGhpcy5lcnJvcikgOiB0aGlzLndyYXBTdWNjZXNzKGUsIHRoaXMucmVzdWx0KSA6IG5ldyBQZXJzaXN0ZW5jZVByb21pc2UoKChuLCByKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm5leHRDYWxsYmFjayA9IHQgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMud3JhcFN1Y2Nlc3MoZSwgdCkubmV4dChuLCByKTtcbiAgICAgICAgICAgIH0sIHRoaXMuY2F0Y2hDYWxsYmFjayA9IGUgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMud3JhcEZhaWx1cmUodCwgZSkubmV4dChuLCByKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG9Qcm9taXNlKCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKChlLCB0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLm5leHQoZSwgdCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgd3JhcFVzZXJGdW5jdGlvbihlKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBQZXJzaXN0ZW5jZVByb21pc2UgPyB0IDogUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodCk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVqZWN0KGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHdyYXBTdWNjZXNzKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIGUgPyB0aGlzLndyYXBVc2VyRnVuY3Rpb24oKCgpID0+IGUodCkpKSA6IFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHQpO1xuICAgIH1cbiAgICB3cmFwRmFpbHVyZShlLCB0KSB7XG4gICAgICAgIHJldHVybiBlID8gdGhpcy53cmFwVXNlckZ1bmN0aW9uKCgoKSA9PiBlKHQpKSkgOiBQZXJzaXN0ZW5jZVByb21pc2UucmVqZWN0KHQpO1xuICAgIH1cbiAgICBzdGF0aWMgcmVzb2x2ZShlKSB7XG4gICAgICAgIHJldHVybiBuZXcgUGVyc2lzdGVuY2VQcm9taXNlKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgdChlKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBzdGF0aWMgcmVqZWN0KGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW5jZVByb21pc2UoKCh0LCBuKSA9PiB7XG4gICAgICAgICAgICBuKGUpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHN0YXRpYyB3YWl0Rm9yKFxuICAgIC8vIEFjY2VwdCBhbGwgUHJvbWlzZSB0eXBlcyBpbiB3YWl0Rm9yKCkuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBlKSB7XG4gICAgICAgIHJldHVybiBuZXcgUGVyc2lzdGVuY2VQcm9taXNlKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgbGV0IHIgPSAwLCBpID0gMCwgcyA9ICExO1xuICAgICAgICAgICAgZS5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgICAgICArK3IsIGUubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICArK2ksIHMgJiYgaSA9PT0gciAmJiB0KCk7XG4gICAgICAgICAgICAgICAgfSksIChlID0+IG4oZSkpKTtcbiAgICAgICAgICAgIH0pKSwgcyA9ICEwLCBpID09PSByICYmIHQoKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHaXZlbiBhbiBhcnJheSBvZiBwcmVkaWNhdGUgZnVuY3Rpb25zIHRoYXQgYXN5bmNocm9ub3VzbHkgZXZhbHVhdGUgdG8gYVxuICAgICAqIGJvb2xlYW4sIGltcGxlbWVudHMgYSBzaG9ydC1jaXJjdWl0aW5nIGBvcmAgYmV0d2VlbiB0aGUgcmVzdWx0cy4gUHJlZGljYXRlc1xuICAgICAqIHdpbGwgYmUgZXZhbHVhdGVkIHVudGlsIG9uZSBvZiB0aGVtIHJldHVybnMgYHRydWVgLCB0aGVuIHN0b3AuIFRoZSBmaW5hbFxuICAgICAqIHJlc3VsdCB3aWxsIGJlIHdoZXRoZXIgYW55IG9mIHRoZW0gcmV0dXJuZWQgYHRydWVgLlxuICAgICAqLyAgICBzdGF0aWMgb3IoZSkge1xuICAgICAgICBsZXQgdCA9IFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCExKTtcbiAgICAgICAgZm9yIChjb25zdCBuIG9mIGUpIHQgPSB0Lm5leHQoKGUgPT4gZSA/IFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKGUpIDogbigpKSk7XG4gICAgICAgIHJldHVybiB0O1xuICAgIH1cbiAgICBzdGF0aWMgZm9yRWFjaChlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSBbXTtcbiAgICAgICAgcmV0dXJuIGUuZm9yRWFjaCgoKGUsIHIpID0+IHtcbiAgICAgICAgICAgIG4ucHVzaCh0LmNhbGwodGhpcywgZSwgcikpO1xuICAgICAgICB9KSksIHRoaXMud2FpdEZvcihuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29uY3VycmVudGx5IG1hcCBhbGwgYXJyYXkgZWxlbWVudHMgdGhyb3VnaCBhc3luY2hyb25vdXMgZnVuY3Rpb24uXG4gICAgICovICAgIHN0YXRpYyBtYXBBcnJheShlLCB0KSB7XG4gICAgICAgIHJldHVybiBuZXcgUGVyc2lzdGVuY2VQcm9taXNlKCgobiwgcikgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IGUubGVuZ3RoLCBzID0gbmV3IEFycmF5KGkpO1xuICAgICAgICAgICAgbGV0IG8gPSAwO1xuICAgICAgICAgICAgZm9yIChsZXQgXyA9IDA7IF8gPCBpOyBfKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gXztcbiAgICAgICAgICAgICAgICB0KGVbYV0pLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzW2FdID0gZSwgKytvLCBvID09PSBpICYmIG4ocyk7XG4gICAgICAgICAgICAgICAgfSksIChlID0+IHIoZSkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBbiBhbHRlcm5hdGl2ZSB0byByZWN1cnNpdmUgUGVyc2lzdGVuY2VQcm9taXNlIGNhbGxzLCB0aGF0IGF2b2lkc1xuICAgICAqIHBvdGVudGlhbCBtZW1vcnkgcHJvYmxlbXMgZnJvbSB1bmJvdW5kZWQgY2hhaW5zIG9mIHByb21pc2VzLlxuICAgICAqXG4gICAgICogVGhlIGBhY3Rpb25gIHdpbGwgYmUgY2FsbGVkIHJlcGVhdGVkbHkgd2hpbGUgYGNvbmRpdGlvbmAgaXMgdHJ1ZS5cbiAgICAgKi8gICAgc3RhdGljIGRvV2hpbGUoZSwgdCkge1xuICAgICAgICByZXR1cm4gbmV3IFBlcnNpc3RlbmNlUHJvbWlzZSgoKG4sIHIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHByb2Nlc3MgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgITAgPT09IGUoKSA/IHQoKS5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3MoKTtcbiAgICAgICAgICAgICAgICB9KSwgcikgOiBuKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcHJvY2VzcygpO1xuICAgICAgICB9KSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gUmVmZXJlbmNlcyB0byBgaW5kZXhlZERCYCBhcmUgZ3VhcmRlZCBieSBTaW1wbGVEYi5pc0F2YWlsYWJsZSgpIGFuZCBnZXRHbG9iYWwoKVxuLyogZXNsaW50LWRpc2FibGUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzICovIGNvbnN0IFcgPSBcIlNpbXBsZURiXCI7XG5cbi8qKlxuICogVGhlIG1heGltdW0gbnVtYmVyIG9mIHJldHJ5IGF0dGVtcHRzIGZvciBhbiBJbmRleGVkRGIgdHJhbnNhY3Rpb24gdGhhdCBmYWlsc1xuICogd2l0aCBhIERPTUV4Y2VwdGlvbi5cbiAqL1xuLyoqXG4gKiBXcmFwcyBhbiBJREJUcmFuc2FjdGlvbiBhbmQgZXhwb3NlcyBhIHN0b3JlKCkgbWV0aG9kIHRvIGdldCBhIGhhbmRsZSB0byBhXG4gKiBzcGVjaWZpYyBvYmplY3Qgc3RvcmUuXG4gKi9cbmNsYXNzIF9fUFJJVkFURV9TaW1wbGVEYlRyYW5zYWN0aW9uIHtcbiAgICBzdGF0aWMgb3BlbihlLCB0LCBuLCByKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9TaW1wbGVEYlRyYW5zYWN0aW9uKHQsIGUudHJhbnNhY3Rpb24ociwgbikpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgX19QUklWQVRFX0luZGV4ZWREYlRyYW5zYWN0aW9uRXJyb3IodCwgZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICB0aGlzLmFjdGlvbiA9IGUsIHRoaXMudHJhbnNhY3Rpb24gPSB0LCB0aGlzLmFib3J0ZWQgPSAhMSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGBQcm9taXNlYCB0aGF0IHJlc29sdmVzIHdpdGggdGhlIHJlc3VsdCBvZiB0aGUgSW5kZXhlZERiIHRyYW5zYWN0aW9uLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5TID0gbmV3IF9fUFJJVkFURV9EZWZlcnJlZCwgdGhpcy50cmFuc2FjdGlvbi5vbmNvbXBsZXRlID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5TLnJlc29sdmUoKTtcbiAgICAgICAgfSwgdGhpcy50cmFuc2FjdGlvbi5vbmFib3J0ID0gKCkgPT4ge1xuICAgICAgICAgICAgdC5lcnJvciA/IHRoaXMuUy5yZWplY3QobmV3IF9fUFJJVkFURV9JbmRleGVkRGJUcmFuc2FjdGlvbkVycm9yKGUsIHQuZXJyb3IpKSA6IHRoaXMuUy5yZXNvbHZlKCk7XG4gICAgICAgIH0sIHRoaXMudHJhbnNhY3Rpb24ub25lcnJvciA9IHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgbiA9IF9fUFJJVkFURV9jaGVja0ZvckFuZFJlcG9ydGlPU0Vycm9yKHQudGFyZ2V0LmVycm9yKTtcbiAgICAgICAgICAgIHRoaXMuUy5yZWplY3QobmV3IF9fUFJJVkFURV9JbmRleGVkRGJUcmFuc2FjdGlvbkVycm9yKGUsIG4pKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZ2V0IEQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlMucHJvbWlzZTtcbiAgICB9XG4gICAgYWJvcnQoZSkge1xuICAgICAgICBlICYmIHRoaXMuUy5yZWplY3QoZSksIHRoaXMuYWJvcnRlZCB8fCAoX19QUklWQVRFX2xvZ0RlYnVnKFcsIFwiQWJvcnRpbmcgdHJhbnNhY3Rpb246XCIsIGUgPyBlLm1lc3NhZ2UgOiBcIkNsaWVudC1pbml0aWF0ZWQgYWJvcnRcIiksIFxuICAgICAgICB0aGlzLmFib3J0ZWQgPSAhMCwgdGhpcy50cmFuc2FjdGlvbi5hYm9ydCgpKTtcbiAgICB9XG4gICAgQygpIHtcbiAgICAgICAgLy8gSWYgdGhlIGJyb3dzZXIgc3VwcG9ydHMgVjMgSW5kZXhlZERCLCB3ZSBpbnZva2UgY29tbWl0KCkgZXhwbGljaXRseSB0b1xuICAgICAgICAvLyBzcGVlZCB1cCBpbmRleCBEQiBwcm9jZXNzaW5nIGlmIHRoZSBldmVudCBsb29wIHJlbWFpbnMgYmxvY2tzLlxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICBjb25zdCBlID0gdGhpcy50cmFuc2FjdGlvbjtcbiAgICAgICAgdGhpcy5hYm9ydGVkIHx8IFwiZnVuY3Rpb25cIiAhPSB0eXBlb2YgZS5jb21taXQgfHwgZS5jb21taXQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIFNpbXBsZURiU3RvcmU8S2V5VHlwZSwgVmFsdWVUeXBlPiBmb3IgdGhlIHNwZWNpZmllZCBzdG9yZS4gQWxsXG4gICAgICogb3BlcmF0aW9ucyBwZXJmb3JtZWQgb24gdGhlIFNpbXBsZURiU3RvcmUgaGFwcGVuIHdpdGhpbiB0aGUgY29udGV4dCBvZiB0aGlzXG4gICAgICogdHJhbnNhY3Rpb24gYW5kIGl0IGNhbm5vdCBiZSB1c2VkIGFueW1vcmUgb25jZSB0aGUgdHJhbnNhY3Rpb24gaXNcbiAgICAgKiBjb21wbGV0ZWQuXG4gICAgICpcbiAgICAgKiBOb3RlIHRoYXQgd2UgY2FuJ3QgYWN0dWFsbHkgZW5mb3JjZSB0aGF0IHRoZSBLZXlUeXBlIGFuZCBWYWx1ZVR5cGUgYXJlXG4gICAgICogY29ycmVjdCwgYnV0IHRoZXkgYWxsb3cgdHlwZSBzYWZldHkgdGhyb3VnaCB0aGUgcmVzdCBvZiB0aGUgY29uc3VtaW5nIGNvZGUuXG4gICAgICovICAgIHN0b3JlKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMudHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoZSk7XG4gICAgICAgIHJldHVybiBuZXcgX19QUklWQVRFX1NpbXBsZURiU3RvcmUodCk7XG4gICAgfVxufVxuXG4vKipcbiAqIFByb3ZpZGVzIGEgd3JhcHBlciBhcm91bmQgSW5kZXhlZERiIHdpdGggYSBzaW1wbGlmaWVkIGludGVyZmFjZSB0aGF0IHVzZXNcbiAqIFByb21pc2UtbGlrZSByZXR1cm4gdmFsdWVzIHRvIGNoYWluIG9wZXJhdGlvbnMuIFJlYWwgcHJvbWlzZXMgY2Fubm90IGJlIHVzZWRcbiAqIHNpbmNlIC50aGVuKCkgY29udGludWF0aW9ucyBhcmUgZXhlY3V0ZWQgYXN5bmNocm9ub3VzbHkgKGUuZy4gdmlhXG4gKiAuc2V0SW1tZWRpYXRlKSwgd2hpY2ggd291bGQgY2F1c2UgSW5kZXhlZERCIHRvIGVuZCB0aGUgdHJhbnNhY3Rpb24uXG4gKiBTZWUgUGVyc2lzdGVuY2VQcm9taXNlIGZvciBtb3JlIGRldGFpbHMuXG4gKi8gY2xhc3MgX19QUklWQVRFX1NpbXBsZURiIHtcbiAgICAvKiogRGVsZXRlcyB0aGUgc3BlY2lmaWVkIGRhdGFiYXNlLiAqL1xuICAgIHN0YXRpYyBkZWxldGUoZSkge1xuICAgICAgICBfX1BSSVZBVEVfbG9nRGVidWcoVywgXCJSZW1vdmluZyBkYXRhYmFzZTpcIiwgZSk7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfd3JhcFJlcXVlc3QoZ2V0R2xvYmFsKCkuaW5kZXhlZERCLmRlbGV0ZURhdGFiYXNlKGUpKS50b1Byb21pc2UoKTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgdHJ1ZSBpZiBJbmRleGVkREIgaXMgYXZhaWxhYmxlIGluIHRoZSBjdXJyZW50IGVudmlyb25tZW50LiAqLyAgICBzdGF0aWMgdigpIHtcbiAgICAgICAgaWYgKCFpc0luZGV4ZWREQkF2YWlsYWJsZSgpKSByZXR1cm4gITE7XG4gICAgICAgIGlmIChfX1BSSVZBVEVfU2ltcGxlRGIuRigpKSByZXR1cm4gITA7XG4gICAgICAgIC8vIFdlIGV4dGVuc2l2ZWx5IHVzZSBpbmRleGVkIGFycmF5IHZhbHVlcyBhbmQgY29tcG91bmQga2V5cyxcbiAgICAgICAgLy8gd2hpY2ggSUUgYW5kIEVkZ2UgZG8gbm90IHN1cHBvcnQuIEhvd2V2ZXIsIHRoZXkgc3RpbGwgaGF2ZSBpbmRleGVkREJcbiAgICAgICAgLy8gZGVmaW5lZCBvbiB0aGUgd2luZG93LCBzbyB3ZSBuZWVkIHRvIGNoZWNrIGZvciB0aGVtIGhlcmUgYW5kIG1ha2Ugc3VyZVxuICAgICAgICAvLyB0byByZXR1cm4gdGhhdCBwZXJzaXN0ZW5jZSBpcyBub3QgZW5hYmxlZCBmb3IgdGhvc2UgYnJvd3NlcnMuXG4gICAgICAgIC8vIEZvciB0cmFja2luZyBzdXBwb3J0IG9mIHRoaXMgZmVhdHVyZSwgc2VlIGhlcmU6XG4gICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1pY3Jvc29mdC5jb20vZW4tdXMvbWljcm9zb2Z0LWVkZ2UvcGxhdGZvcm0vc3RhdHVzL2luZGV4ZWRkYmFycmF5c2FuZG11bHRpZW50cnlzdXBwb3J0L1xuICAgICAgICAvLyBDaGVjayB0aGUgVUEgc3RyaW5nIHRvIGZpbmQgb3V0IHRoZSBicm93c2VyLlxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBnZXRVQSgpLCB0ID0gX19QUklWQVRFX1NpbXBsZURiLk0oZSksIG4gPSAwIDwgdCAmJiB0IDwgMTAsIHIgPSBfX1BSSVZBVEVfZ2V0QW5kcm9pZFZlcnNpb24oZSksIGkgPSAwIDwgciAmJiByIDwgNC41O1xuICAgICAgICAvLyBJRSAxMFxuICAgICAgICAvLyB1YSA9ICdNb3ppbGxhLzUuMCAoY29tcGF0aWJsZTsgTVNJRSAxMC4wOyBXaW5kb3dzIE5UIDYuMjsgVHJpZGVudC82LjApJztcbiAgICAgICAgLy8gSUUgMTFcbiAgICAgICAgLy8gdWEgPSAnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4zOyBUcmlkZW50LzcuMDsgcnY6MTEuMCkgbGlrZSBHZWNrbyc7XG4gICAgICAgIC8vIEVkZ2VcbiAgICAgICAgLy8gdWEgPSAnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsXG4gICAgICAgIC8vIGxpa2UgR2Vja28pIENocm9tZS8zOS4wLjIxNzEuNzEgU2FmYXJpLzUzNy4zNiBFZGdlLzEyLjAnO1xuICAgICAgICAvLyBpT1MgU2FmYXJpOiBEaXNhYmxlIGZvciB1c2VycyBydW5uaW5nIGlPUyB2ZXJzaW9uIDwgMTAuXG4gICAgICAgICAgICAgICAgcmV0dXJuICEoZS5pbmRleE9mKFwiTVNJRSBcIikgPiAwIHx8IGUuaW5kZXhPZihcIlRyaWRlbnQvXCIpID4gMCB8fCBlLmluZGV4T2YoXCJFZGdlL1wiKSA+IDAgfHwgbiB8fCBpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBiYWNraW5nIEluZGV4ZWREQiBzdG9yZSBpcyB0aGUgTm9kZSBJbmRleGVkREJTaGltXG4gICAgICogKHNlZSBodHRwczovL2dpdGh1Yi5jb20vYXhlbWNsaW9uL0luZGV4ZWREQlNoaW0pLlxuICAgICAqLyAgICBzdGF0aWMgRigpIHtcbiAgICAgICAgcmV0dXJuIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIHByb2Nlc3MgJiYgXCJZRVNcIiA9PT0gcHJvY2Vzcy5fX1BSSVZBVEVfZW52Py5fX1BSSVZBVEVfVVNFX01PQ0tfUEVSU0lTVEVOQ0U7XG4gICAgfVxuICAgIC8qKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmcm9tIGEgdHJhbnNhY3Rpb24uICovICAgIHN0YXRpYyBPKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIGUuc3RvcmUodCk7XG4gICAgfVxuICAgIC8vIHZpc2libGUgZm9yIHRlc3RpbmdcbiAgICAvKiogUGFyc2UgVXNlciBBZ2VudCB0byBkZXRlcm1pbmUgaU9TIHZlcnNpb24uIFJldHVybnMgLTEgaWYgbm90IGZvdW5kLiAqL1xuICAgIHN0YXRpYyBNKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IGUubWF0Y2goL2koPzpwaG9uZXxwYWR8cG9kKSBvcyAoW1xcZF9dKykvaSksIG4gPSB0ID8gdFsxXS5zcGxpdChcIl9cIikuc2xpY2UoMCwgMikuam9pbihcIi5cIikgOiBcIi0xXCI7XG4gICAgICAgIHJldHVybiBOdW1iZXIobik7XG4gICAgfVxuICAgIC8qXG4gICAgICogQ3JlYXRlcyBhIG5ldyBTaW1wbGVEYiB3cmFwcGVyIGZvciBJbmRleGVkRGIgZGF0YWJhc2UgYG5hbWVgLlxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IGB2ZXJzaW9uYCBtdXN0IG5vdCBiZSBhIGRvd25ncmFkZS4gSW5kZXhlZERCIGRvZXMgbm90IHN1cHBvcnRcbiAgICAgKiBkb3duZ3JhZGluZyB0aGUgc2NoZW1hIHZlcnNpb24uIFdlIGN1cnJlbnRseSBkbyBub3Qgc3VwcG9ydCBhbnkgd2F5IHRvIGRvXG4gICAgICogdmVyc2lvbmluZyBvdXRzaWRlIG9mIEluZGV4ZWREQidzIHZlcnNpb25pbmcgbWVjaGFuaXNtLCBhcyBvbmx5XG4gICAgICogdmVyc2lvbi11cGdyYWRlIHRyYW5zYWN0aW9ucyBhcmUgYWxsb3dlZCB0byBkbyB0aGluZ3MgbGlrZSBjcmVhdGVcbiAgICAgKiBvYmplY3RzdG9yZXMuXG4gICAgICovICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4pIHtcbiAgICAgICAgdGhpcy5uYW1lID0gZSwgdGhpcy52ZXJzaW9uID0gdCwgdGhpcy5OID0gbiwgdGhpcy5CID0gbnVsbDtcbiAgICAgICAgLy8gTk9URTogQWNjb3JkaW5nIHRvIGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0xOTcwNTAsIHRoZVxuICAgICAgICAvLyBidWcgd2UncmUgY2hlY2tpbmcgZm9yIHNob3VsZCBleGlzdCBpbiBpT1MgPj0gMTIuMiBhbmQgPCAxMywgYnV0IGZvclxuICAgICAgICAvLyB3aGF0ZXZlciByZWFzb24gaXQncyBtdWNoIGhhcmRlciB0byBoaXQgYWZ0ZXIgMTIuMiBzbyB3ZSBvbmx5IHByb2FjdGl2ZWx5XG4gICAgICAgIC8vIGxvZyBvbiAxMi4yLlxuICAgICAgICAxMi4yID09PSBfX1BSSVZBVEVfU2ltcGxlRGIuTShnZXRVQSgpKSAmJiBfX1BSSVZBVEVfbG9nRXJyb3IoXCJGaXJlc3RvcmUgcGVyc2lzdGVuY2Ugc3VmZmVycyBmcm9tIGEgYnVnIGluIGlPUyAxMi4yIFNhZmFyaSB0aGF0IG1heSBjYXVzZSB5b3VyIGFwcCB0byBzdG9wIHdvcmtpbmcuIFNlZSBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3EvNTY0OTYyOTYvMTEwOTE1IGZvciBkZXRhaWxzIGFuZCBhIHBvdGVudGlhbCB3b3JrYXJvdW5kLlwiKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogT3BlbnMgdGhlIHNwZWNpZmllZCBkYXRhYmFzZSwgY3JlYXRpbmcgb3IgdXBncmFkaW5nIGl0IGlmIG5lY2Vzc2FyeS5cbiAgICAgKi8gICAgYXN5bmMgTChlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRiIHx8IChfX1BSSVZBVEVfbG9nRGVidWcoVywgXCJPcGVuaW5nIGRhdGFiYXNlOlwiLCB0aGlzLm5hbWUpLCB0aGlzLmRiID0gYXdhaXQgbmV3IFByb21pc2UoKCh0LCBuKSA9PiB7XG4gICAgICAgICAgICAvLyBUT0RPKG1pa2VsZWhlbik6IEludmVzdGlnYXRlIGJyb3dzZXIgY29tcGF0aWJpbGl0eS5cbiAgICAgICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9JbmRleGVkREJfQVBJL1VzaW5nX0luZGV4ZWREQlxuICAgICAgICAgICAgLy8gc3VnZ2VzdHMgSUU5IGFuZCBvbGRlciBXZWJLaXQgYnJvd3NlcnMgaGFuZGxlIHVwZ3JhZGVcbiAgICAgICAgICAgIC8vIGRpZmZlcmVudGx5LiBUaGV5IGV4cGVjdCBzZXRWZXJzaW9uLCBhcyBkZXNjcmliZWQgaGVyZTpcbiAgICAgICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9JREJWZXJzaW9uQ2hhbmdlUmVxdWVzdC9zZXRWZXJzaW9uXG4gICAgICAgICAgICBjb25zdCByID0gaW5kZXhlZERCLm9wZW4odGhpcy5uYW1lLCB0aGlzLnZlcnNpb24pO1xuICAgICAgICAgICAgci5vbnN1Y2Nlc3MgPSBlID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gZS50YXJnZXQucmVzdWx0O1xuICAgICAgICAgICAgICAgIHQobik7XG4gICAgICAgICAgICB9LCByLm9uYmxvY2tlZCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBuKG5ldyBfX1BSSVZBVEVfSW5kZXhlZERiVHJhbnNhY3Rpb25FcnJvcihlLCBcIkNhbm5vdCB1cGdyYWRlIEluZGV4ZWREQiBzY2hlbWEgd2hpbGUgYW5vdGhlciB0YWIgaXMgb3Blbi4gQ2xvc2UgYWxsIHRhYnMgdGhhdCBhY2Nlc3MgRmlyZXN0b3JlIGFuZCByZWxvYWQgdGhpcyBwYWdlIHRvIHByb2NlZWQuXCIpKTtcbiAgICAgICAgICAgIH0sIHIub25lcnJvciA9IHQgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSB0LnRhcmdldC5lcnJvcjtcbiAgICAgICAgICAgICAgICBcIlZlcnNpb25FcnJvclwiID09PSByLm5hbWUgPyBuKG5ldyBGaXJlc3RvcmVFcnJvcihOLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiQSBuZXdlciB2ZXJzaW9uIG9mIHRoZSBGaXJlc3RvcmUgU0RLIHdhcyBwcmV2aW91c2x5IHVzZWQgYW5kIHNvIHRoZSBwZXJzaXN0ZWQgZGF0YSBpcyBub3QgY29tcGF0aWJsZSB3aXRoIHRoZSB2ZXJzaW9uIG9mIHRoZSBTREsgeW91IGFyZSBub3cgdXNpbmcuIFRoZSBTREsgd2lsbCBvcGVyYXRlIHdpdGggcGVyc2lzdGVuY2UgZGlzYWJsZWQuIElmIHlvdSBuZWVkIHBlcnNpc3RlbmNlLCBwbGVhc2UgcmUtdXBncmFkZSB0byBhIG5ld2VyIHZlcnNpb24gb2YgdGhlIFNESyBvciBlbHNlIGNsZWFyIHRoZSBwZXJzaXN0ZWQgSW5kZXhlZERCIGRhdGEgZm9yIHlvdXIgYXBwIHRvIHN0YXJ0IGZyZXNoLlwiKSkgOiBcIkludmFsaWRTdGF0ZUVycm9yXCIgPT09IHIubmFtZSA/IG4obmV3IEZpcmVzdG9yZUVycm9yKE4uRkFJTEVEX1BSRUNPTkRJVElPTiwgXCJVbmFibGUgdG8gb3BlbiBhbiBJbmRleGVkREIgY29ubmVjdGlvbi4gVGhpcyBjb3VsZCBiZSBkdWUgdG8gcnVubmluZyBpbiBhIHByaXZhdGUgYnJvd3Npbmcgc2Vzc2lvbiBvbiBhIGJyb3dzZXIgd2hvc2UgcHJpdmF0ZSBicm93c2luZyBzZXNzaW9ucyBkbyBub3Qgc3VwcG9ydCBJbmRleGVkREI6IFwiICsgcikpIDogbihuZXcgX19QUklWQVRFX0luZGV4ZWREYlRyYW5zYWN0aW9uRXJyb3IoZSwgcikpO1xuICAgICAgICAgICAgfSwgci5vbnVwZ3JhZGVuZWVkZWQgPSBlID0+IHtcbiAgICAgICAgICAgICAgICBfX1BSSVZBVEVfbG9nRGVidWcoVywgJ0RhdGFiYXNlIFwiJyArIHRoaXMubmFtZSArICdcIiByZXF1aXJlcyB1cGdyYWRlIGZyb20gdmVyc2lvbjonLCBlLm9sZFZlcnNpb24pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlLnRhcmdldC5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgdGhpcy5OLmsodCwgci50cmFuc2FjdGlvbiwgZS5vbGRWZXJzaW9uLCB0aGlzLnZlcnNpb24pLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgX19QUklWQVRFX2xvZ0RlYnVnKFcsIFwiRGF0YWJhc2UgdXBncmFkZSB0byB2ZXJzaW9uIFwiICsgdGhpcy52ZXJzaW9uICsgXCIgY29tcGxldGVcIik7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSkpKSwgdGhpcy5xICYmICh0aGlzLmRiLm9udmVyc2lvbmNoYW5nZSA9IGUgPT4gdGhpcy5xKGUpKSwgdGhpcy5kYjtcbiAgICB9XG4gICAgJChlKSB7XG4gICAgICAgIHRoaXMucSA9IGUsIHRoaXMuZGIgJiYgKHRoaXMuZGIub252ZXJzaW9uY2hhbmdlID0gdCA9PiBlKHQpKTtcbiAgICB9XG4gICAgYXN5bmMgcnVuVHJhbnNhY3Rpb24oZSwgdCwgbiwgcikge1xuICAgICAgICBjb25zdCBpID0gXCJyZWFkb25seVwiID09PSB0O1xuICAgICAgICBsZXQgcyA9IDA7XG4gICAgICAgIGZvciAoOzspIHtcbiAgICAgICAgICAgICsrcztcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kYiA9IGF3YWl0IHRoaXMuTChlKTtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gX19QUklWQVRFX1NpbXBsZURiVHJhbnNhY3Rpb24ub3Blbih0aGlzLmRiLCBlLCBpID8gXCJyZWFkb25seVwiIDogXCJyZWFkd3JpdGVcIiwgbiksIHMgPSByKHQpLm5leHQoKGUgPT4gKHQuQygpLCBcbiAgICAgICAgICAgICAgICBlKSkpLmNhdGNoKChlID0+IChcbiAgICAgICAgICAgICAgICAvLyBBYm9ydCB0aGUgdHJhbnNhY3Rpb24gaWYgdGhlcmUgd2FzIGFuIGVycm9yLlxuICAgICAgICAgICAgICAgIHQuYWJvcnQoZSksIFBlcnNpc3RlbmNlUHJvbWlzZS5yZWplY3QoZSkpKSkudG9Qcm9taXNlKCk7XG4gICAgICAgICAgICAgICAgLy8gQXMgbm90ZWQgYWJvdmUsIGVycm9ycyBhcmUgcHJvcGFnYXRlZCBieSBhYm9ydGluZyB0aGUgdHJhbnNhY3Rpb24uIFNvXG4gICAgICAgICAgICAgICAgLy8gd2Ugc3dhbGxvdyBhbnkgZXJyb3IgaGVyZSB0byBhdm9pZCB0aGUgYnJvd3NlciBsb2dnaW5nIGl0IGFzIHVuaGFuZGxlZC5cbiAgICAgICAgICAgICAgICByZXR1cm4gcy5jYXRjaCgoKCkgPT4ge30pKSwgXG4gICAgICAgICAgICAgICAgLy8gV2FpdCBmb3IgdGhlIHRyYW5zYWN0aW9uIHRvIGNvbXBsZXRlIChpLmUuIEluZGV4ZWREYidzIG9uc3VjY2VzcyBldmVudCB0b1xuICAgICAgICAgICAgICAgIC8vIGZpcmUpLCBidXQgc3RpbGwgcmV0dXJuIHRoZSBvcmlnaW5hbCB0cmFuc2FjdGlvbkZuUmVzdWx0IGJhY2sgdG8gdGhlXG4gICAgICAgICAgICAgICAgLy8gY2FsbGVyLlxuICAgICAgICAgICAgICAgIGF3YWl0IHQuRCwgcztcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gZSwgbiA9IFwiRmlyZWJhc2VFcnJvclwiICE9PSB0Lm5hbWUgJiYgcyA8IDM7XG4gICAgICAgICAgICAgICAgLy8gVE9ETyhzY2htaWR0LXNlYmFzdGlhbik6IFdlIGNvdWxkIHByb2JhYmx5IGJlIHNtYXJ0ZXIgYWJvdXQgdGhpcyBhbmRcbiAgICAgICAgICAgICAgICAvLyBub3QgcmV0cnkgZXhjZXB0aW9ucyB0aGF0IGFyZSBsaWtlbHkgdW5yZWNvdmVyYWJsZSAoc3VjaCBhcyBxdW90YVxuICAgICAgICAgICAgICAgIC8vIGV4Y2VlZGVkIGVycm9ycykuXG4gICAgICAgICAgICAgICAgLy8gTm90ZTogV2UgY2Fubm90IHVzZSBhbiBpbnN0YW5jZW9mIGNoZWNrIGZvciBGaXJlc3RvcmVFeGNlcHRpb24sIHNpbmNlIHRoZVxuICAgICAgICAgICAgICAgIC8vIGV4Y2VwdGlvbiBpcyB3cmFwcGVkIGluIGEgZ2VuZXJpYyBlcnJvciBieSBvdXIgYXN5bmMvYXdhaXQgaGFuZGxpbmcuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfX1BSSVZBVEVfbG9nRGVidWcoVywgXCJUcmFuc2FjdGlvbiBmYWlsZWQgd2l0aCBlcnJvcjpcIiwgdC5tZXNzYWdlLCBcIlJldHJ5aW5nOlwiLCBuKSwgXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpLCAhbikgcmV0dXJuIFByb21pc2UucmVqZWN0KHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgICB0aGlzLmRiICYmIHRoaXMuZGIuY2xvc2UoKSwgdGhpcy5kYiA9IHZvaWQgMDtcbiAgICB9XG59XG5cbi8qKiBQYXJzZSBVc2VyIEFnZW50IHRvIGRldGVybWluZSBBbmRyb2lkIHZlcnNpb24uIFJldHVybnMgLTEgaWYgbm90IGZvdW5kLiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfZ2V0QW5kcm9pZFZlcnNpb24oZSkge1xuICAgIGNvbnN0IHQgPSBlLm1hdGNoKC9BbmRyb2lkIChbXFxkLl0rKS9pKSwgbiA9IHQgPyB0WzFdLnNwbGl0KFwiLlwiKS5zbGljZSgwLCAyKS5qb2luKFwiLlwiKSA6IFwiLTFcIjtcbiAgICByZXR1cm4gTnVtYmVyKG4pO1xufVxuXG4vKipcbiAqIEEgY29udHJvbGxlciBmb3IgaXRlcmF0aW5nIG92ZXIgYSBrZXkgcmFuZ2Ugb3IgaW5kZXguIEl0IGFsbG93cyBhbiBpdGVyYXRlXG4gKiBjYWxsYmFjayB0byBkZWxldGUgdGhlIGN1cnJlbnRseS1yZWZlcmVuY2VkIG9iamVjdCwgb3IganVtcCB0byBhIG5ldyBrZXlcbiAqIHdpdGhpbiB0aGUga2V5IHJhbmdlIG9yIGluZGV4LlxuICovIGNsYXNzIF9fUFJJVkFURV9JdGVyYXRpb25Db250cm9sbGVyIHtcbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHRoaXMuVSA9IGUsIHRoaXMuSyA9ICExLCB0aGlzLlcgPSBudWxsO1xuICAgIH1cbiAgICBnZXQgaXNEb25lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5LO1xuICAgIH1cbiAgICBnZXQgRygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuVztcbiAgICB9XG4gICAgc2V0IGN1cnNvcihlKSB7XG4gICAgICAgIHRoaXMuVSA9IGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoaXMgZnVuY3Rpb24gY2FuIGJlIGNhbGxlZCB0byBzdG9wIGl0ZXJhdGlvbiBhdCBhbnkgcG9pbnQuXG4gICAgICovICAgIGRvbmUoKSB7XG4gICAgICAgIHRoaXMuSyA9ICEwO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIGNhbiBiZSBjYWxsZWQgdG8gc2tpcCB0byB0aGF0IG5leHQga2V5LCB3aGljaCBjb3VsZCBiZVxuICAgICAqIGFuIGluZGV4IG9yIGEgcHJpbWFyeSBrZXkuXG4gICAgICovICAgIGooZSkge1xuICAgICAgICB0aGlzLlcgPSBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWxldGUgdGhlIGN1cnJlbnQgY3Vyc29yIHZhbHVlIGZyb20gdGhlIG9iamVjdCBzdG9yZS5cbiAgICAgKlxuICAgICAqIE5PVEU6IFlvdSBDQU5OT1QgZG8gdGhpcyB3aXRoIGEga2V5c09ubHkgcXVlcnkuXG4gICAgICovICAgIGRlbGV0ZSgpIHtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV93cmFwUmVxdWVzdCh0aGlzLlUuZGVsZXRlKCkpO1xuICAgIH1cbn1cblxuLyoqIEFuIGVycm9yIHRoYXQgd3JhcHMgZXhjZXB0aW9ucyB0aGF0IHRocm93biBkdXJpbmcgSW5kZXhlZERCIGV4ZWN1dGlvbi4gKi8gY2xhc3MgX19QUklWQVRFX0luZGV4ZWREYlRyYW5zYWN0aW9uRXJyb3IgZXh0ZW5kcyBGaXJlc3RvcmVFcnJvciB7XG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICBzdXBlcihOLlVOQVZBSUxBQkxFLCBgSW5kZXhlZERCIHRyYW5zYWN0aW9uICcke2V9JyBmYWlsZWQ6ICR7dH1gKSwgdGhpcy5uYW1lID0gXCJJbmRleGVkRGJUcmFuc2FjdGlvbkVycm9yXCI7XG4gICAgfVxufVxuXG4vKiogVmVyaWZpZXMgd2hldGhlciBgZWAgaXMgYW4gSW5kZXhlZERiVHJhbnNhY3Rpb25FcnJvci4gKi8gZnVuY3Rpb24gX19QUklWQVRFX2lzSW5kZXhlZERiVHJhbnNhY3Rpb25FcnJvcihlKSB7XG4gICAgLy8gVXNlIG5hbWUgZXF1YWxpdHksIGFzIGluc3RhbmNlb2YgY2hlY2tzIG9uIGVycm9ycyBkb24ndCB3b3JrIHdpdGggZXJyb3JzXG4gICAgLy8gdGhhdCB3cmFwIG90aGVyIGVycm9ycy5cbiAgICByZXR1cm4gXCJJbmRleGVkRGJUcmFuc2FjdGlvbkVycm9yXCIgPT09IGUubmFtZTtcbn1cblxuLyoqXG4gKiBBIHdyYXBwZXIgYXJvdW5kIGFuIElEQk9iamVjdFN0b3JlIHByb3ZpZGluZyBhbiBBUEkgdGhhdDpcbiAqXG4gKiAxKSBIYXMgZ2VuZXJpYyBLZXlUeXBlIC8gVmFsdWVUeXBlIHBhcmFtZXRlcnMgdG8gcHJvdmlkZSBzdHJvbmdseS10eXBlZFxuICogbWV0aG9kcyBmb3IgYWN0aW5nIGFnYWluc3QgdGhlIG9iamVjdCBzdG9yZS5cbiAqIDIpIERlYWxzIHdpdGggSW5kZXhlZERCJ3Mgb25zdWNjZXNzIC8gb25lcnJvciBldmVudCBjYWxsYmFja3MsIG1ha2luZyBldmVyeVxuICogbWV0aG9kIHJldHVybiBhIFBlcnNpc3RlbmNlUHJvbWlzZSBpbnN0ZWFkLlxuICogMykgUHJvdmlkZXMgYSBoaWdoZXItbGV2ZWwgQVBJIHRvIGF2b2lkIG5lZWRpbmcgdG8gZG8gZXhjZXNzaXZlIHdyYXBwaW5nIG9mXG4gKiBpbnRlcm1lZGlhdGUgSW5kZXhlZERCIHR5cGVzIChJREJDdXJzb3JXaXRoVmFsdWUsIGV0Yy4pXG4gKi8gY2xhc3MgX19QUklWQVRFX1NpbXBsZURiU3RvcmUge1xuICAgIGNvbnN0cnVjdG9yKGUpIHtcbiAgICAgICAgdGhpcy5zdG9yZSA9IGU7XG4gICAgfVxuICAgIHB1dChlLCB0KSB7XG4gICAgICAgIGxldCBuO1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSB0ID8gKF9fUFJJVkFURV9sb2dEZWJ1ZyhXLCBcIlBVVFwiLCB0aGlzLnN0b3JlLm5hbWUsIGUsIHQpLCBuID0gdGhpcy5zdG9yZS5wdXQodCwgZSkpIDogKF9fUFJJVkFURV9sb2dEZWJ1ZyhXLCBcIlBVVFwiLCB0aGlzLnN0b3JlLm5hbWUsIFwiPGF1dG8ta2V5PlwiLCBlKSwgXG4gICAgICAgIG4gPSB0aGlzLnN0b3JlLnB1dChlKSksIF9fUFJJVkFURV93cmFwUmVxdWVzdChuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhIG5ldyB2YWx1ZSBpbnRvIGFuIE9iamVjdCBTdG9yZSBhbmQgcmV0dXJucyB0aGUgbmV3IGtleS4gU2ltaWxhciB0b1xuICAgICAqIEluZGV4ZWREYidzIGBhZGQoKWAsIHRoaXMgbWV0aG9kIHdpbGwgZmFpbCBvbiBwcmltYXJ5IGtleSBjb2xsaXNpb25zLlxuICAgICAqXG4gICAgICogQHBhcmFtIHZhbHVlIC0gVGhlIG9iamVjdCB0byB3cml0ZS5cbiAgICAgKiBAcmV0dXJucyBUaGUga2V5IG9mIHRoZSB2YWx1ZSB0byBhZGQuXG4gICAgICovICAgIGFkZChlKSB7XG4gICAgICAgIF9fUFJJVkFURV9sb2dEZWJ1ZyhXLCBcIkFERFwiLCB0aGlzLnN0b3JlLm5hbWUsIGUsIGUpO1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX3dyYXBSZXF1ZXN0KHRoaXMuc3RvcmUuYWRkKGUpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgb2JqZWN0IHdpdGggdGhlIHNwZWNpZmllZCBrZXkgZnJvbSB0aGUgc3BlY2lmaWVkIHN0b3JlLCBvciBudWxsXG4gICAgICogaWYgbm8gb2JqZWN0IGV4aXN0cyB3aXRoIHRoZSBzcGVjaWZpZWQga2V5LlxuICAgICAqXG4gICAgICogQGtleSBUaGUga2V5IG9mIHRoZSBvYmplY3QgdG8gZ2V0LlxuICAgICAqIEByZXR1cm5zIFRoZSBvYmplY3Qgd2l0aCB0aGUgc3BlY2lmaWVkIGtleSBvciBudWxsIGlmIG5vIG9iamVjdCBleGlzdHMuXG4gICAgICovICAgIGdldChlKSB7XG4gICAgICAgIC8vIFdlJ3JlIGRvaW5nIGFuIHVuc2FmZSBjYXN0IHRvIFZhbHVlVHlwZS5cbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV93cmFwUmVxdWVzdCh0aGlzLnN0b3JlLmdldChlKSkubmV4dCgodCA9PiAoXG4gICAgICAgIC8vIE5vcm1hbGl6ZSBub25leGlzdGVuY2UgdG8gbnVsbC5cbiAgICAgICAgdm9pZCAwID09PSB0ICYmICh0ID0gbnVsbCksIF9fUFJJVkFURV9sb2dEZWJ1ZyhXLCBcIkdFVFwiLCB0aGlzLnN0b3JlLm5hbWUsIGUsIHQpLCBcbiAgICAgICAgdCkpKTtcbiAgICB9XG4gICAgZGVsZXRlKGUpIHtcbiAgICAgICAgX19QUklWQVRFX2xvZ0RlYnVnKFcsIFwiREVMRVRFXCIsIHRoaXMuc3RvcmUubmFtZSwgZSk7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfd3JhcFJlcXVlc3QodGhpcy5zdG9yZS5kZWxldGUoZSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJZiB3ZSBldmVyIG5lZWQgbW9yZSBvZiB0aGUgY291bnQgdmFyaWFudHMsIHdlIGNhbiBhZGQgb3ZlcmxvYWRzLiBGb3Igbm93LFxuICAgICAqIGFsbCB3ZSBuZWVkIGlzIHRvIGNvdW50IGV2ZXJ5dGhpbmcgaW4gYSBzdG9yZS5cbiAgICAgKlxuICAgICAqIFJldHVybnMgdGhlIG51bWJlciBvZiByb3dzIGluIHRoZSBzdG9yZS5cbiAgICAgKi8gICAgY291bnQoKSB7XG4gICAgICAgIF9fUFJJVkFURV9sb2dEZWJ1ZyhXLCBcIkNPVU5UXCIsIHRoaXMuc3RvcmUubmFtZSk7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfd3JhcFJlcXVlc3QodGhpcy5zdG9yZS5jb3VudCgpKTtcbiAgICB9XG4gICAgSihlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLm9wdGlvbnMoZSwgdCksIHIgPSBuLmluZGV4ID8gdGhpcy5zdG9yZS5pbmRleChuLmluZGV4KSA6IHRoaXMuc3RvcmU7XG4gICAgICAgIC8vIFVzZSBgZ2V0QWxsKClgIGlmIHRoZSBicm93c2VyIHN1cHBvcnRzIEluZGV4ZWREQiB2MywgYXMgaXQgaXMgcm91Z2hseVxuICAgICAgICAvLyAyMCUgZmFzdGVyLlxuICAgICAgICAgICAgICAgIGlmIChcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIHIuZ2V0QWxsKSB7XG4gICAgICAgICAgICBjb25zdCBlID0gci5nZXRBbGwobi5yYW5nZSk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFBlcnNpc3RlbmNlUHJvbWlzZSgoKHQsIG4pID0+IHtcbiAgICAgICAgICAgICAgICBlLm9uZXJyb3IgPSBlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbihlLnRhcmdldC5lcnJvcik7XG4gICAgICAgICAgICAgICAgfSwgZS5vbnN1Y2Nlc3MgPSBlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdChlLnRhcmdldC5yZXN1bHQpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuY3Vyc29yKG4pLCB0ID0gW107XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5IKGUsICgoZSwgbikgPT4ge1xuICAgICAgICAgICAgICAgIHQucHVzaChuKTtcbiAgICAgICAgICAgIH0pKS5uZXh0KCgoKSA9PiB0KSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogTG9hZHMgdGhlIGZpcnN0IGBjb3VudGAgZWxlbWVudHMgZnJvbSB0aGUgcHJvdmlkZWQgaW5kZXggcmFuZ2UuIExvYWRzIGFsbFxuICAgICAqIGVsZW1lbnRzIGlmIG5vIGxpbWl0IGlzIHByb3ZpZGVkLlxuICAgICAqLyAgICBZKGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuc3RvcmUuZ2V0QWxsKGUsIG51bGwgPT09IHQgPyB2b2lkIDAgOiB0KTtcbiAgICAgICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW5jZVByb21pc2UoKChlLCB0KSA9PiB7XG4gICAgICAgICAgICBuLm9uZXJyb3IgPSBlID0+IHtcbiAgICAgICAgICAgICAgICB0KGUudGFyZ2V0LmVycm9yKTtcbiAgICAgICAgICAgIH0sIG4ub25zdWNjZXNzID0gdCA9PiB7XG4gICAgICAgICAgICAgICAgZSh0LnRhcmdldC5yZXN1bHQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBaKGUsIHQpIHtcbiAgICAgICAgX19QUklWQVRFX2xvZ0RlYnVnKFcsIFwiREVMRVRFIEFMTFwiLCB0aGlzLnN0b3JlLm5hbWUpO1xuICAgICAgICBjb25zdCBuID0gdGhpcy5vcHRpb25zKGUsIHQpO1xuICAgICAgICBuLlggPSAhMTtcbiAgICAgICAgY29uc3QgciA9IHRoaXMuY3Vyc29yKG4pO1xuICAgICAgICByZXR1cm4gdGhpcy5IKHIsICgoZSwgdCwgbikgPT4gbi5kZWxldGUoKSkpO1xuICAgIH1cbiAgICBlZShlLCB0KSB7XG4gICAgICAgIGxldCBuO1xuICAgICAgICB0ID8gbiA9IGUgOiAobiA9IHt9LCB0ID0gZSk7XG4gICAgICAgIGNvbnN0IHIgPSB0aGlzLmN1cnNvcihuKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuSChyLCB0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSXRlcmF0ZXMgb3ZlciBhIHN0b3JlLCBidXQgd2FpdHMgZm9yIHRoZSBnaXZlbiBjYWxsYmFjayB0byBjb21wbGV0ZSBmb3JcbiAgICAgKiBlYWNoIGVudHJ5IGJlZm9yZSBpdGVyYXRpbmcgdGhlIG5leHQgZW50cnkuIFRoaXMgYWxsb3dzIHRoZSBjYWxsYmFjayB0byBkb1xuICAgICAqIGFzeW5jaHJvbm91cyB3b3JrIHRvIGRldGVybWluZSBpZiB0aGlzIGl0ZXJhdGlvbiBzaG91bGQgY29udGludWUuXG4gICAgICpcbiAgICAgKiBUaGUgcHJvdmlkZWQgY2FsbGJhY2sgc2hvdWxkIHJldHVybiBgdHJ1ZWAgdG8gY29udGludWUgaXRlcmF0aW9uLCBhbmRcbiAgICAgKiBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICAgKi8gICAgdGUoZSkge1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5jdXJzb3Ioe30pO1xuICAgICAgICByZXR1cm4gbmV3IFBlcnNpc3RlbmNlUHJvbWlzZSgoKG4sIHIpID0+IHtcbiAgICAgICAgICAgIHQub25lcnJvciA9IGUgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBfX1BSSVZBVEVfY2hlY2tGb3JBbmRSZXBvcnRpT1NFcnJvcihlLnRhcmdldC5lcnJvcik7XG4gICAgICAgICAgICAgICAgcih0KTtcbiAgICAgICAgICAgIH0sIHQub25zdWNjZXNzID0gdCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICByID8gZShyLnByaW1hcnlLZXksIHIudmFsdWUpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBlID8gci5jb250aW51ZSgpIDogbigpO1xuICAgICAgICAgICAgICAgIH0pKSA6IG4oKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgSChlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSBbXTtcbiAgICAgICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW5jZVByb21pc2UoKChyLCBpKSA9PiB7XG4gICAgICAgICAgICBlLm9uZXJyb3IgPSBlID0+IHtcbiAgICAgICAgICAgICAgICBpKGUudGFyZ2V0LmVycm9yKTtcbiAgICAgICAgICAgIH0sIGUub25zdWNjZXNzID0gZSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICBpZiAoIWkpIHJldHVybiB2b2lkIHIoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gbmV3IF9fUFJJVkFURV9JdGVyYXRpb25Db250cm9sbGVyKGkpLCBvID0gdChpLnByaW1hcnlLZXksIGkudmFsdWUsIHMpO1xuICAgICAgICAgICAgICAgIGlmIChvIGluc3RhbmNlb2YgUGVyc2lzdGVuY2VQcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBvLmNhdGNoKChlID0+IChzLmRvbmUoKSwgUGVyc2lzdGVuY2VQcm9taXNlLnJlamVjdChlKSkpKTtcbiAgICAgICAgICAgICAgICAgICAgbi5wdXNoKGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzLmlzRG9uZSA/IHIoKSA6IG51bGwgPT09IHMuRyA/IGkuY29udGludWUoKSA6IGkuY29udGludWUocy5HKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihuKSkpO1xuICAgIH1cbiAgICBvcHRpb25zKGUsIHQpIHtcbiAgICAgICAgbGV0IG47XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IGUgJiYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIGUgPyBuID0gZSA6IHQgPSBlKSwge1xuICAgICAgICAgICAgaW5kZXg6IG4sXG4gICAgICAgICAgICByYW5nZTogdFxuICAgICAgICB9O1xuICAgIH1cbiAgICBjdXJzb3IoZSkge1xuICAgICAgICBsZXQgdCA9IFwibmV4dFwiO1xuICAgICAgICBpZiAoZS5yZXZlcnNlICYmICh0ID0gXCJwcmV2XCIpLCBlLmluZGV4KSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdGhpcy5zdG9yZS5pbmRleChlLmluZGV4KTtcbiAgICAgICAgICAgIHJldHVybiBlLlggPyBuLm9wZW5LZXlDdXJzb3IoZS5yYW5nZSwgdCkgOiBuLm9wZW5DdXJzb3IoZS5yYW5nZSwgdCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmUub3BlbkN1cnNvcihlLnJhbmdlLCB0KTtcbiAgICB9XG59XG5cbi8qKlxuICogV3JhcHMgYW4gSURCUmVxdWVzdCBpbiBhIFBlcnNpc3RlbmNlUHJvbWlzZSwgdXNpbmcgdGhlIG9uc3VjY2VzcyAvIG9uZXJyb3JcbiAqIGhhbmRsZXJzIHRvIHJlc29sdmUgLyByZWplY3QgdGhlIFBlcnNpc3RlbmNlUHJvbWlzZSBhcyBhcHByb3ByaWF0ZS5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfd3JhcFJlcXVlc3QoZSkge1xuICAgIHJldHVybiBuZXcgUGVyc2lzdGVuY2VQcm9taXNlKCgodCwgbikgPT4ge1xuICAgICAgICBlLm9uc3VjY2VzcyA9IGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgbiA9IGUudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgIHQobik7XG4gICAgICAgIH0sIGUub25lcnJvciA9IGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgdCA9IF9fUFJJVkFURV9jaGVja0ZvckFuZFJlcG9ydGlPU0Vycm9yKGUudGFyZ2V0LmVycm9yKTtcbiAgICAgICAgICAgIG4odCk7XG4gICAgICAgIH07XG4gICAgfSkpO1xufVxuXG4vLyBHdWFyZCBzbyB3ZSBvbmx5IHJlcG9ydCB0aGUgZXJyb3Igb25jZS5cbmxldCBHID0gITE7XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9jaGVja0ZvckFuZFJlcG9ydGlPU0Vycm9yKGUpIHtcbiAgICBjb25zdCB0ID0gX19QUklWQVRFX1NpbXBsZURiLk0oZ2V0VUEoKSk7XG4gICAgaWYgKHQgPj0gMTIuMiAmJiB0IDwgMTMpIHtcbiAgICAgICAgY29uc3QgdCA9IFwiQW4gaW50ZXJuYWwgZXJyb3Igd2FzIGVuY291bnRlcmVkIGluIHRoZSBJbmRleGVkIERhdGFiYXNlIHNlcnZlclwiO1xuICAgICAgICBpZiAoZS5tZXNzYWdlLmluZGV4T2YodCkgPj0gMCkge1xuICAgICAgICAgICAgLy8gV3JhcCBlcnJvciBpbiBhIG1vcmUgZGVzY3JpcHRpdmUgb25lLlxuICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBGaXJlc3RvcmVFcnJvcihcImludGVybmFsXCIsIGBJT1NfSU5ERVhFRERCX0JVRzE6IEluZGV4ZWREYiBoYXMgdGhyb3duICcke3R9Jy4gVGhpcyBpcyBsaWtlbHkgZHVlIHRvIGFuIHVuYXZvaWRhYmxlIGJ1ZyBpbiBpT1MuIFNlZSBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3EvNTY0OTYyOTYvMTEwOTE1IGZvciBkZXRhaWxzIGFuZCBhIHBvdGVudGlhbCB3b3JrYXJvdW5kLmApO1xuICAgICAgICAgICAgcmV0dXJuIEcgfHwgKEcgPSAhMCwgXG4gICAgICAgICAgICAvLyBUaHJvdyBhIGdsb2JhbCBleGNlcHRpb24gb3V0c2lkZSBvZiB0aGlzIHByb21pc2UgY2hhaW4sIGZvciB0aGUgdXNlciB0b1xuICAgICAgICAgICAgLy8gcG90ZW50aWFsbHkgY2F0Y2guXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgICAgIH0pLCAwKSksIGU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGU7XG59XG5cbmNvbnN0IHogPSBcIkluZGV4QmFja2ZpbGxlclwiO1xuXG4vKiogSG93IGxvbmcgd2Ugd2FpdCB0byB0cnkgcnVubmluZyBpbmRleCBiYWNrZmlsbCBhZnRlciBTREsgaW5pdGlhbGl6YXRpb24uICovXG4vKiogVGhpcyBjbGFzcyBpcyByZXNwb25zaWJsZSBmb3IgdGhlIHNjaGVkdWxpbmcgb2YgSW5kZXggQmFja2ZpbGxlci4gKi9cbmNsYXNzIF9fUFJJVkFURV9JbmRleEJhY2tmaWxsZXJTY2hlZHVsZXIge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQpIHtcbiAgICAgICAgdGhpcy5hc3luY1F1ZXVlID0gZSwgdGhpcy5uZSA9IHQsIHRoaXMudGFzayA9IG51bGw7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICB0aGlzLnJlKDE1ZTMpO1xuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICB0aGlzLnRhc2sgJiYgKHRoaXMudGFzay5jYW5jZWwoKSwgdGhpcy50YXNrID0gbnVsbCk7XG4gICAgfVxuICAgIGdldCBzdGFydGVkKCkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gdGhpcy50YXNrO1xuICAgIH1cbiAgICByZShlKSB7XG4gICAgICAgIF9fUFJJVkFURV9sb2dEZWJ1Zyh6LCBgU2NoZWR1bGVkIGluICR7ZX1tc2ApLCB0aGlzLnRhc2sgPSB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFmdGVyRGVsYXkoXCJpbmRleF9iYWNrZmlsbFwiIC8qIFRpbWVySWQuSW5kZXhCYWNrZmlsbCAqLyAsIGUsIChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnRhc2sgPSBudWxsO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gYXdhaXQgdGhpcy5uZS5pZSgpO1xuICAgICAgICAgICAgICAgIF9fUFJJVkFURV9sb2dEZWJ1Zyh6LCBgRG9jdW1lbnRzIHdyaXR0ZW46ICR7ZX1gKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBfX1BSSVZBVEVfaXNJbmRleGVkRGJUcmFuc2FjdGlvbkVycm9yKGUpID8gX19QUklWQVRFX2xvZ0RlYnVnKHosIFwiSWdub3JpbmcgSW5kZXhlZERCIGVycm9yIGR1cmluZyBpbmRleCBiYWNrZmlsbDogXCIsIGUpIDogYXdhaXQgX19QUklWQVRFX2lnbm9yZUlmUHJpbWFyeUxlYXNlTG9zcyhlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF3YWl0IHRoaXMucmUoNmU0KTtcbiAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuLyoqIEltcGxlbWVudHMgdGhlIHN0ZXBzIGZvciBiYWNrZmlsbGluZyBpbmRleGVzLiAqLyBjbGFzcyBfX1BSSVZBVEVfSW5kZXhCYWNrZmlsbGVyIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBMb2NhbFN0b3JlIHByb3ZpZGVzIGFjY2VzcyB0byBJbmRleE1hbmFnZXIgYW5kIExvY2FsRG9jdW1lbnRWaWV3LlxuICAgICAqIFRoZXNlIHByb3BlcnRpZXMgd2lsbCB1cGRhdGUgd2hlbiB0aGUgdXNlciBjaGFuZ2VzLiBDb25zZXF1ZW50bHksXG4gICAgICogbWFraW5nIGEgbG9jYWwgY29weSBvZiBJbmRleE1hbmFnZXIgYW5kIExvY2FsRG9jdW1lbnRWaWV3IHdpbGwgcmVxdWlyZVxuICAgICAqIHVwZGF0ZXMgb3ZlciB0aW1lLiBUaGUgc2ltcGxlciBzb2x1dGlvbiBpcyB0byByZWx5IG9uIExvY2FsU3RvcmUgdG8gaGF2ZVxuICAgICAqIGFuIHVwLXRvLWRhdGUgcmVmZXJlbmNlcyB0byBJbmRleE1hbmFnZXIgYW5kIExvY2FsRG9jdW1lbnRTdG9yZS5cbiAgICAgKi9cbiAgICBlLCB0KSB7XG4gICAgICAgIHRoaXMubG9jYWxTdG9yZSA9IGUsIHRoaXMucGVyc2lzdGVuY2UgPSB0O1xuICAgIH1cbiAgICBhc3luYyBpZShlID0gNTApIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJCYWNrZmlsbCBJbmRleGVzXCIsIFwicmVhZHdyaXRlLXByaW1hcnlcIiwgKHQgPT4gdGhpcy5zZSh0LCBlKSkpO1xuICAgIH1cbiAgICAvKiogV3JpdGVzIGluZGV4IGVudHJpZXMgdW50aWwgdGhlIGNhcCBpcyByZWFjaGVkLiBSZXR1cm5zIHRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIHByb2Nlc3NlZC4gKi8gICAgc2UoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gbmV3IFNldDtcbiAgICAgICAgbGV0IHIgPSB0LCBpID0gITA7XG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UuZG9XaGlsZSgoKCkgPT4gITAgPT09IGkgJiYgciA+IDApLCAoKCkgPT4gdGhpcy5sb2NhbFN0b3JlLmluZGV4TWFuYWdlci5nZXROZXh0Q29sbGVjdGlvbkdyb3VwVG9VcGRhdGUoZSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBpZiAobnVsbCAhPT0gdCAmJiAhbi5oYXModCkpIHJldHVybiBfX1BSSVZBVEVfbG9nRGVidWcoeiwgYFByb2Nlc3NpbmcgY29sbGVjdGlvbjogJHt0fWApLCBcbiAgICAgICAgICAgIHRoaXMub2UoZSwgdCwgcikubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgciAtPSBlLCBuLmFkZCh0KTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIGkgPSAhMTtcbiAgICAgICAgfSkpKSkubmV4dCgoKCkgPT4gdCAtIHIpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogV3JpdGVzIGVudHJpZXMgZm9yIHRoZSBwcm92aWRlZCBjb2xsZWN0aW9uIGdyb3VwLiBSZXR1cm5zIHRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIHByb2Nlc3NlZC5cbiAgICAgKi8gICAgb2UoZSwgdCwgbikge1xuICAgICAgICAvLyBVc2UgdGhlIGVhcmxpZXN0IG9mZnNldCBvZiBhbGwgZmllbGQgaW5kZXhlcyB0byBxdWVyeSB0aGUgbG9jYWwgY2FjaGUuXG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsU3RvcmUuaW5kZXhNYW5hZ2VyLmdldE1pbk9mZnNldEZyb21Db2xsZWN0aW9uR3JvdXAoZSwgdCkubmV4dCgociA9PiB0aGlzLmxvY2FsU3RvcmUubG9jYWxEb2N1bWVudHMuZ2V0TmV4dERvY3VtZW50cyhlLCB0LCByLCBuKS5uZXh0KChuID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBuLmNoYW5nZXM7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbFN0b3JlLmluZGV4TWFuYWdlci51cGRhdGVJbmRleEVudHJpZXMoZSwgaSkubmV4dCgoKCkgPT4gdGhpcy5fZShyLCBuKSkpLm5leHQoKG4gPT4gKF9fUFJJVkFURV9sb2dEZWJ1Zyh6LCBgVXBkYXRpbmcgb2Zmc2V0OiAke259YCksIFxuICAgICAgICAgICAgdGhpcy5sb2NhbFN0b3JlLmluZGV4TWFuYWdlci51cGRhdGVDb2xsZWN0aW9uR3JvdXAoZSwgdCwgbikpKSkubmV4dCgoKCkgPT4gaS5zaXplKSk7XG4gICAgICAgIH0pKSkpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyB0aGUgbmV4dCBvZmZzZXQgYmFzZWQgb24gdGhlIHByb3ZpZGVkIGRvY3VtZW50cy4gKi8gICAgX2UoZSwgdCkge1xuICAgICAgICBsZXQgbiA9IGU7XG4gICAgICAgIHJldHVybiB0LmNoYW5nZXMuZm9yRWFjaCgoKGUsIHQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfbmV3SW5kZXhPZmZzZXRGcm9tRG9jdW1lbnQodCk7XG4gICAgICAgICAgICBfX1BSSVZBVEVfaW5kZXhPZmZzZXRDb21wYXJhdG9yKHIsIG4pID4gMCAmJiAobiA9IHIpO1xuICAgICAgICB9KSksIG5ldyBJbmRleE9mZnNldChuLnJlYWRUaW1lLCBuLmRvY3VtZW50S2V5LCBNYXRoLm1heCh0LmJhdGNoSWQsIGUubGFyZ2VzdEJhdGNoSWQpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE4IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIGBMaXN0ZW5TZXF1ZW5jZWAgaXMgYSBtb25vdG9uaWMgc2VxdWVuY2UuIEl0IGlzIGluaXRpYWxpemVkIHdpdGggYSBtaW5pbXVtIHZhbHVlIHRvXG4gKiBleGNlZWQuIEFsbCBzdWJzZXF1ZW50IGNhbGxzIHRvIG5leHQgd2lsbCByZXR1cm4gaW5jcmVhc2luZyB2YWx1ZXMuIElmIHByb3ZpZGVkIHdpdGggYVxuICogYFNlcXVlbmNlTnVtYmVyU3luY2VyYCwgaXQgd2lsbCBhZGRpdGlvbmFsbHkgYnVtcCBpdHMgbmV4dCB2YWx1ZSB3aGVuIHRvbGQgb2YgYSBuZXcgdmFsdWUsIGFzXG4gKiB3ZWxsIGFzIHdyaXRlIG91dCBzZXF1ZW5jZSBudW1iZXJzIHRoYXQgaXQgcHJvZHVjZXMgdmlhIGBuZXh0KClgLlxuICovIGNsYXNzIF9fUFJJVkFURV9MaXN0ZW5TZXF1ZW5jZSB7XG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICB0aGlzLnByZXZpb3VzVmFsdWUgPSBlLCB0ICYmICh0LnNlcXVlbmNlTnVtYmVySGFuZGxlciA9IGUgPT4gdGhpcy5hZShlKSwgdGhpcy51ZSA9IGUgPT4gdC53cml0ZVNlcXVlbmNlTnVtYmVyKGUpKTtcbiAgICB9XG4gICAgYWUoZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcmV2aW91c1ZhbHVlID0gTWF0aC5tYXgoZSwgdGhpcy5wcmV2aW91c1ZhbHVlKSwgdGhpcy5wcmV2aW91c1ZhbHVlO1xuICAgIH1cbiAgICBuZXh0KCkge1xuICAgICAgICBjb25zdCBlID0gKyt0aGlzLnByZXZpb3VzVmFsdWU7XG4gICAgICAgIHJldHVybiB0aGlzLnVlICYmIHRoaXMudWUoZSksIGU7XG4gICAgfVxufVxuXG5fX1BSSVZBVEVfTGlzdGVuU2VxdWVuY2UuY2UgPSAtMTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBTZW50aW5lbCB2YWx1ZSB0aGF0IHNvcnRzIGJlZm9yZSBhbnkgTXV0YXRpb24gQmF0Y2ggSUQuICovXG5jb25zdCBqID0gLTE7XG5cbi8qKlxuICogUmV0dXJucyB3aGV0aGVyIGEgdmFyaWFibGUgaXMgZWl0aGVyIHVuZGVmaW5lZCBvciBudWxsLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9pc051bGxPclVuZGVmaW5lZChlKSB7XG4gICAgcmV0dXJuIG51bGwgPT0gZTtcbn1cblxuLyoqIFJldHVybnMgd2hldGhlciB0aGUgdmFsdWUgcmVwcmVzZW50cyAtMC4gKi8gZnVuY3Rpb24gX19QUklWQVRFX2lzTmVnYXRpdmVaZXJvKGUpIHtcbiAgICAvLyBEZXRlY3QgaWYgdGhlIHZhbHVlIGlzIC0wLjAuIEJhc2VkIG9uIHBvbHlmaWxsIGZyb21cbiAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9PYmplY3QvaXNcbiAgICByZXR1cm4gMCA9PT0gZSAmJiAxIC8gZSA9PSAtMSAvIDA7XG59XG5cbi8qKlxuICogUmV0dXJucyB3aGV0aGVyIGEgdmFsdWUgaXMgYW4gaW50ZWdlciBhbmQgaW4gdGhlIHNhZmUgaW50ZWdlciByYW5nZVxuICogQHBhcmFtIHZhbHVlIC0gVGhlIHZhbHVlIHRvIHRlc3QgZm9yIGJlaW5nIGFuIGludGVnZXIgYW5kIGluIHRoZSBzYWZlIHJhbmdlXG4gKi8gZnVuY3Rpb24gaXNTYWZlSW50ZWdlcihlKSB7XG4gICAgcmV0dXJuIFwibnVtYmVyXCIgPT0gdHlwZW9mIGUgJiYgTnVtYmVyLmlzSW50ZWdlcihlKSAmJiAhX19QUklWQVRFX2lzTmVnYXRpdmVaZXJvKGUpICYmIGUgPD0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIgJiYgZSA+PSBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUjtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY29uc3QgSiA9IFwiXHUwMDAxXCI7XG5cbi8qKlxuICogRW5jb2RlcyBhIHJlc291cmNlIHBhdGggaW50byBhIEluZGV4ZWREYi1jb21wYXRpYmxlIHN0cmluZyBmb3JtLlxuICovXG5mdW5jdGlvbiBfX1BSSVZBVEVfZW5jb2RlUmVzb3VyY2VQYXRoKGUpIHtcbiAgICBsZXQgdCA9IFwiXCI7XG4gICAgZm9yIChsZXQgbiA9IDA7IG4gPCBlLmxlbmd0aDsgbisrKSB0Lmxlbmd0aCA+IDAgJiYgKHQgPSBfX1BSSVZBVEVfZW5jb2RlU2VwYXJhdG9yKHQpKSwgXG4gICAgdCA9IF9fUFJJVkFURV9lbmNvZGVTZWdtZW50KGUuZ2V0KG4pLCB0KTtcbiAgICByZXR1cm4gX19QUklWQVRFX2VuY29kZVNlcGFyYXRvcih0KTtcbn1cblxuLyoqIEVuY29kZXMgYSBzaW5nbGUgc2VnbWVudCBvZiBhIHJlc291cmNlIHBhdGggaW50byB0aGUgZ2l2ZW4gcmVzdWx0ICovIGZ1bmN0aW9uIF9fUFJJVkFURV9lbmNvZGVTZWdtZW50KGUsIHQpIHtcbiAgICBsZXQgbiA9IHQ7XG4gICAgY29uc3QgciA9IGUubGVuZ3RoO1xuICAgIGZvciAobGV0IHQgPSAwOyB0IDwgcjsgdCsrKSB7XG4gICAgICAgIGNvbnN0IHIgPSBlLmNoYXJBdCh0KTtcbiAgICAgICAgc3dpdGNoIChyKSB7XG4gICAgICAgICAgY2FzZSBcIlxcMFwiOlxuICAgICAgICAgICAgbiArPSBcIlx1MDAwMVx1MDAxMFwiO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIEo6XG4gICAgICAgICAgICBuICs9IFwiXHUwMDAxXHUwMDExXCI7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBuICs9IHI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG47XG59XG5cbi8qKiBFbmNvZGVzIGEgcGF0aCBzZXBhcmF0b3IgaW50byB0aGUgZ2l2ZW4gcmVzdWx0ICovIGZ1bmN0aW9uIF9fUFJJVkFURV9lbmNvZGVTZXBhcmF0b3IoZSkge1xuICAgIHJldHVybiBlICsgSiArIFwiXHUwMDAxXCI7XG59XG5cbi8qKlxuICogRGVjb2RlcyB0aGUgZ2l2ZW4gSW5kZXhlZERiLWNvbXBhdGlibGUgc3RyaW5nIGZvcm0gb2YgYSByZXNvdXJjZSBwYXRoIGludG9cbiAqIGEgUmVzb3VyY2VQYXRoIGluc3RhbmNlLiBOb3RlIHRoYXQgdGhpcyBtZXRob2QgaXMgbm90IHN1aXRhYmxlIGZvciB1c2Ugd2l0aFxuICogZGVjb2RpbmcgcmVzb3VyY2UgbmFtZXMgZnJvbSB0aGUgc2VydmVyOyB0aG9zZSBhcmUgT25lIFBsYXRmb3JtIGZvcm1hdFxuICogc3RyaW5ncy5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfZGVjb2RlUmVzb3VyY2VQYXRoKGUpIHtcbiAgICAvLyBFdmVudCB0aGUgZW1wdHkgcGF0aCBtdXN0IGVuY29kZSBhcyBhIHBhdGggb2YgYXQgbGVhc3QgbGVuZ3RoIDIuIEEgcGF0aFxuICAgIC8vIHdpdGggZXhhY3RseSAyIG11c3QgYmUgdGhlIGVtcHR5IHBhdGguXG4gICAgY29uc3QgdCA9IGUubGVuZ3RoO1xuICAgIGlmIChfX1BSSVZBVEVfaGFyZEFzc2VydCh0ID49IDIsIDY0NDA4LCB7XG4gICAgICAgIHBhdGg6IGVcbiAgICB9KSwgMiA9PT0gdCkgcmV0dXJuIF9fUFJJVkFURV9oYXJkQXNzZXJ0KGUuY2hhckF0KDApID09PSBKICYmIFwiXHUwMDAxXCIgPT09IGUuY2hhckF0KDEpLCA1NjE0NSwge1xuICAgICAgICBwYXRoOiBlXG4gICAgfSksIFJlc291cmNlUGF0aC5lbXB0eVBhdGgoKTtcbiAgICAvLyBFc2NhcGUgY2hhcmFjdGVycyBjYW5ub3QgZXhpc3QgcGFzdCB0aGUgc2Vjb25kLXRvLWxhc3QgcG9zaXRpb24gaW4gdGhlXG4gICAgLy8gc291cmNlIHZhbHVlLlxuICAgICAgICBjb25zdCBfX1BSSVZBVEVfbGFzdFJlYXNvbmFibGVFc2NhcGVJbmRleCA9IHQgLSAyLCBuID0gW107XG4gICAgbGV0IHIgPSBcIlwiO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdDsgKSB7XG4gICAgICAgIC8vIFRoZSBsYXN0IHR3byBjaGFyYWN0ZXJzIG9mIGEgdmFsaWQgZW5jb2RlZCBwYXRoIG11c3QgYmUgYSBzZXBhcmF0b3IsIHNvXG4gICAgICAgIC8vIHRoZXJlIG11c3QgYmUgYW4gZW5kIHRvIHRoaXMgc2VnbWVudC5cbiAgICAgICAgY29uc3QgdCA9IGUuaW5kZXhPZihKLCBpKTtcbiAgICAgICAgKHQgPCAwIHx8IHQgPiBfX1BSSVZBVEVfbGFzdFJlYXNvbmFibGVFc2NhcGVJbmRleCkgJiYgZmFpbCg1MDUxNSwge1xuICAgICAgICAgICAgcGF0aDogZVxuICAgICAgICB9KTtcbiAgICAgICAgc3dpdGNoIChlLmNoYXJBdCh0ICsgMSkpIHtcbiAgICAgICAgICBjYXNlIFwiXHUwMDAxXCI6XG4gICAgICAgICAgICBjb25zdCBzID0gZS5zdWJzdHJpbmcoaSwgdCk7XG4gICAgICAgICAgICBsZXQgbztcbiAgICAgICAgICAgIDAgPT09IHIubGVuZ3RoID8gXG4gICAgICAgICAgICAvLyBBdm9pZCBjb3B5aW5nIGZvciB0aGUgY29tbW9uIGNhc2Ugb2YgYSBzZWdtZW50IHRoYXQgZXhjbHVkZXMgXFwwXG4gICAgICAgICAgICAvLyBhbmQgXFwwMDFcbiAgICAgICAgICAgIG8gPSBzIDogKHIgKz0gcywgbyA9IHIsIHIgPSBcIlwiKSwgbi5wdXNoKG8pO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIFwiXHUwMDEwXCI6XG4gICAgICAgICAgICByICs9IGUuc3Vic3RyaW5nKGksIHQpLCByICs9IFwiXFwwXCI7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgXCJcdTAwMTFcIjpcbiAgICAgICAgICAgIC8vIFRoZSBlc2NhcGUgY2hhcmFjdGVyIGNhbiBiZSB1c2VkIGluIHRoZSBvdXRwdXQgdG8gZW5jb2RlIGl0c2VsZi5cbiAgICAgICAgICAgIHIgKz0gZS5zdWJzdHJpbmcoaSwgdCArIDEpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgZmFpbCg2MTE2Nywge1xuICAgICAgICAgICAgICAgIHBhdGg6IGVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGkgPSB0ICsgMjtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBSZXNvdXJjZVBhdGgobik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IEggPSBcInJlbW90ZURvY3VtZW50c1wiLCBZID0gXCJvd25lclwiLCBaID0gXCJvd25lclwiLCBYID0gXCJtdXRhdGlvblF1ZXVlc1wiLCBlZSA9IFwidXNlcklkXCIsIHRlID0gXCJtdXRhdGlvbnNcIiwgbmUgPSBcImJhdGNoSWRcIiwgcmUgPSBcInVzZXJNdXRhdGlvbnNJbmRleFwiLCBpZSA9IFsgXCJ1c2VySWRcIiwgXCJiYXRjaElkXCIgXTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogTmFtZSBvZiB0aGUgSW5kZXhlZERiIG9iamVjdCBzdG9yZS5cbiAqXG4gKiBOb3RlIHRoYXQgdGhlIG5hbWUgJ293bmVyJyBpcyBjaG9zZW4gdG8gZW5zdXJlIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IHdpdGhcbiAqIG9sZGVyIGNsaWVudHMgdGhhdCBvbmx5IHN1cHBvcnRlZCBzaW5nbGUgbG9ja2VkIGFjY2VzcyB0byB0aGUgcGVyc2lzdGVuY2VcbiAqIGxheWVyLlxuICovXG4vKipcbiAqIENyZWF0ZXMgYSBbdXNlcklkLCBlbmNvZGVkUGF0aF0ga2V5IGZvciB1c2UgaW4gdGhlIERiRG9jdW1lbnRNdXRhdGlvbnNcbiAqIGluZGV4IHRvIGl0ZXJhdGUgb3ZlciBhbGwgYXQgZG9jdW1lbnQgbXV0YXRpb25zIGZvciBhIGdpdmVuIHBhdGggb3IgbG93ZXIuXG4gKi9cbmZ1bmN0aW9uIF9fUFJJVkFURV9uZXdEYkRvY3VtZW50TXV0YXRpb25QcmVmaXhGb3JQYXRoKGUsIHQpIHtcbiAgICByZXR1cm4gWyBlLCBfX1BSSVZBVEVfZW5jb2RlUmVzb3VyY2VQYXRoKHQpIF07XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIGZ1bGwgaW5kZXgga2V5IG9mIFt1c2VySWQsIGVuY29kZWRQYXRoLCBiYXRjaElkXSBmb3IgaW5zZXJ0aW5nXG4gKiBhbmQgZGVsZXRpbmcgaW50byB0aGUgRGJEb2N1bWVudE11dGF0aW9ucyBpbmRleC5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfbmV3RGJEb2N1bWVudE11dGF0aW9uS2V5KGUsIHQsIG4pIHtcbiAgICByZXR1cm4gWyBlLCBfX1BSSVZBVEVfZW5jb2RlUmVzb3VyY2VQYXRoKHQpLCBuIF07XG59XG5cbi8qKlxuICogQmVjYXVzZSB3ZSBzdG9yZSBhbGwgdGhlIHVzZWZ1bCBpbmZvcm1hdGlvbiBmb3IgdGhpcyBzdG9yZSBpbiB0aGUga2V5LFxuICogdGhlcmUgaXMgbm8gdXNlZnVsIGluZm9ybWF0aW9uIHRvIHN0b3JlIGFzIHRoZSB2YWx1ZS4gVGhlIHJhdyAodW5lbmNvZGVkKVxuICogcGF0aCBjYW5ub3QgYmUgc3RvcmVkIGJlY2F1c2UgSW5kZXhlZERiIGRvZXNuJ3Qgc3RvcmUgcHJvdG90eXBlXG4gKiBpbmZvcm1hdGlvbi5cbiAqLyBjb25zdCBzZSA9IHt9LCBvZSA9IFwiZG9jdW1lbnRNdXRhdGlvbnNcIiwgX2UgPSBcInJlbW90ZURvY3VtZW50c1YxNFwiLCBhZSA9IFsgXCJwcmVmaXhQYXRoXCIsIFwiY29sbGVjdGlvbkdyb3VwXCIsIFwicmVhZFRpbWVcIiwgXCJkb2N1bWVudElkXCIgXSwgdWUgPSBcImRvY3VtZW50S2V5SW5kZXhcIiwgY2UgPSBbIFwicHJlZml4UGF0aFwiLCBcImNvbGxlY3Rpb25Hcm91cFwiLCBcImRvY3VtZW50SWRcIiBdLCBsZSA9IFwiY29sbGVjdGlvbkdyb3VwSW5kZXhcIiwgaGUgPSBbIFwiY29sbGVjdGlvbkdyb3VwXCIsIFwicmVhZFRpbWVcIiwgXCJwcmVmaXhQYXRoXCIsIFwiZG9jdW1lbnRJZFwiIF0sIFBlID0gXCJyZW1vdGVEb2N1bWVudEdsb2JhbFwiLCBUZSA9IFwicmVtb3RlRG9jdW1lbnRHbG9iYWxLZXlcIiwgSWUgPSBcInRhcmdldHNcIiwgRWUgPSBcInF1ZXJ5VGFyZ2V0c0luZGV4XCIsIGRlID0gWyBcImNhbm9uaWNhbElkXCIsIFwidGFyZ2V0SWRcIiBdLCBBZSA9IFwidGFyZ2V0RG9jdW1lbnRzXCIsIFJlID0gWyBcInRhcmdldElkXCIsIFwicGF0aFwiIF0sIFZlID0gXCJkb2N1bWVudFRhcmdldHNJbmRleFwiLCBtZSA9IFsgXCJwYXRoXCIsIFwidGFyZ2V0SWRcIiBdLCBmZSA9IFwidGFyZ2V0R2xvYmFsS2V5XCIsIGdlID0gXCJ0YXJnZXRHbG9iYWxcIiwgcGUgPSBcImNvbGxlY3Rpb25QYXJlbnRzXCIsIHllID0gWyBcImNvbGxlY3Rpb25JZFwiLCBcInBhcmVudFwiIF0sIHdlID0gXCJjbGllbnRNZXRhZGF0YVwiLCBTZSA9IFwiY2xpZW50SWRcIiwgYmUgPSBcImJ1bmRsZXNcIiwgRGUgPSBcImJ1bmRsZUlkXCIsIENlID0gXCJuYW1lZFF1ZXJpZXNcIiwgdmUgPSBcIm5hbWVcIiwgRmUgPSBcImluZGV4Q29uZmlndXJhdGlvblwiLCBNZSA9IFwiaW5kZXhJZFwiLCB4ZSA9IFwiY29sbGVjdGlvbkdyb3VwSW5kZXhcIiwgT2UgPSBcImNvbGxlY3Rpb25Hcm91cFwiLCBOZSA9IFwiaW5kZXhTdGF0ZVwiLCBCZSA9IFsgXCJpbmRleElkXCIsIFwidWlkXCIgXSwgTGUgPSBcInNlcXVlbmNlTnVtYmVySW5kZXhcIiwga2UgPSBbIFwidWlkXCIsIFwic2VxdWVuY2VOdW1iZXJcIiBdLCBxZSA9IFwiaW5kZXhFbnRyaWVzXCIsIFFlID0gWyBcImluZGV4SWRcIiwgXCJ1aWRcIiwgXCJhcnJheVZhbHVlXCIsIFwiZGlyZWN0aW9uYWxWYWx1ZVwiLCBcIm9yZGVyZWREb2N1bWVudEtleVwiLCBcImRvY3VtZW50S2V5XCIgXSwgJGUgPSBcImRvY3VtZW50S2V5SW5kZXhcIiwgVWUgPSBbIFwiaW5kZXhJZFwiLCBcInVpZFwiLCBcIm9yZGVyZWREb2N1bWVudEtleVwiIF0sIEtlID0gXCJkb2N1bWVudE92ZXJsYXlzXCIsIFdlID0gWyBcInVzZXJJZFwiLCBcImNvbGxlY3Rpb25QYXRoXCIsIFwiZG9jdW1lbnRJZFwiIF0sIEdlID0gXCJjb2xsZWN0aW9uUGF0aE92ZXJsYXlJbmRleFwiLCB6ZSA9IFsgXCJ1c2VySWRcIiwgXCJjb2xsZWN0aW9uUGF0aFwiLCBcImxhcmdlc3RCYXRjaElkXCIgXSwgamUgPSBcImNvbGxlY3Rpb25Hcm91cE92ZXJsYXlJbmRleFwiLCBKZSA9IFsgXCJ1c2VySWRcIiwgXCJjb2xsZWN0aW9uR3JvdXBcIiwgXCJsYXJnZXN0QmF0Y2hJZFwiIF0sIEhlID0gXCJnbG9iYWxzXCIsIFllID0gXCJuYW1lXCIsIFplID0gWyAuLi5bIC4uLlsgLi4uWyAuLi5bIFgsIHRlLCBvZSwgSCwgSWUsIFksIGdlLCBBZSBdLCB3ZSBdLCBQZSBdLCBwZSBdLCBiZSwgQ2UgXSwgWGUgPSBbIC4uLlplLCBLZSBdLCBldCA9IFsgWCwgdGUsIG9lLCBfZSwgSWUsIFksIGdlLCBBZSwgd2UsIFBlLCBwZSwgYmUsIENlLCBLZSBdLCB0dCA9IGV0LCBudCA9IFsgLi4udHQsIEZlLCBOZSwgcWUgXSwgcnQgPSBudCwgaXQgPSBbIC4uLm50LCBIZSBdLCBzdCA9IGl0O1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3MgX19QUklWQVRFX0luZGV4ZWREYlRyYW5zYWN0aW9uIGV4dGVuZHMgUGVyc2lzdGVuY2VUcmFuc2FjdGlvbiB7XG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmxlID0gZSwgdGhpcy5jdXJyZW50U2VxdWVuY2VOdW1iZXIgPSB0O1xuICAgIH1cbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2dldFN0b3JlKGUsIHQpIHtcbiAgICBjb25zdCBuID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKTtcbiAgICByZXR1cm4gX19QUklWQVRFX1NpbXBsZURiLk8obi5sZSwgdCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9vYmplY3RTaXplKGUpIHtcbiAgICBsZXQgdCA9IDA7XG4gICAgZm9yIChjb25zdCBuIGluIGUpIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLCBuKSAmJiB0Kys7XG4gICAgcmV0dXJuIHQ7XG59XG5cbmZ1bmN0aW9uIGZvckVhY2goZSwgdCkge1xuICAgIGZvciAoY29uc3QgbiBpbiBlKSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSwgbikgJiYgdChuLCBlW25dKTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX21hcFRvQXJyYXkoZSwgdCkge1xuICAgIGNvbnN0IG4gPSBbXTtcbiAgICBmb3IgKGNvbnN0IHIgaW4gZSkgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsIHIpICYmIG4ucHVzaCh0KGVbcl0sIHIsIGUpKTtcbiAgICByZXR1cm4gbjtcbn1cblxuZnVuY3Rpb24gaXNFbXB0eShlKSB7XG4gICAgZm9yIChjb25zdCB0IGluIGUpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSwgdCkpIHJldHVybiAhMTtcbiAgICByZXR1cm4gITA7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBBbiBpbW11dGFibGUgc29ydGVkIG1hcCBpbXBsZW1lbnRhdGlvbiwgYmFzZWQgb24gYSBMZWZ0LWxlYW5pbmcgUmVkLUJsYWNrXG4vLyB0cmVlLlxuY2xhc3MgU29ydGVkTWFwIHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0KSB7XG4gICAgICAgIHRoaXMuY29tcGFyYXRvciA9IGUsIHRoaXMucm9vdCA9IHQgfHwgTExSQk5vZGUuRU1QVFk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSBtYXAsIHdpdGggdGhlIHNwZWNpZmllZCBrZXkvdmFsdWUgYWRkZWQgb3IgcmVwbGFjZWQuXG4gICAgaW5zZXJ0KGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTb3J0ZWRNYXAodGhpcy5jb21wYXJhdG9yLCB0aGlzLnJvb3QuaW5zZXJ0KGUsIHQsIHRoaXMuY29tcGFyYXRvcikuY29weShudWxsLCBudWxsLCBMTFJCTm9kZS5CTEFDSywgbnVsbCwgbnVsbCkpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgbWFwLCB3aXRoIHRoZSBzcGVjaWZpZWQga2V5IHJlbW92ZWQuXG4gICAgcmVtb3ZlKGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTb3J0ZWRNYXAodGhpcy5jb21wYXJhdG9yLCB0aGlzLnJvb3QucmVtb3ZlKGUsIHRoaXMuY29tcGFyYXRvcikuY29weShudWxsLCBudWxsLCBMTFJCTm9kZS5CTEFDSywgbnVsbCwgbnVsbCkpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIHRoZSB2YWx1ZSBvZiB0aGUgbm9kZSB3aXRoIHRoZSBnaXZlbiBrZXksIG9yIG51bGwuXG4gICAgZ2V0KGUpIHtcbiAgICAgICAgbGV0IHQgPSB0aGlzLnJvb3Q7XG4gICAgICAgIGZvciAoOyF0LmlzRW1wdHkoKTsgKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdGhpcy5jb21wYXJhdG9yKGUsIHQua2V5KTtcbiAgICAgICAgICAgIGlmICgwID09PSBuKSByZXR1cm4gdC52YWx1ZTtcbiAgICAgICAgICAgIG4gPCAwID8gdCA9IHQubGVmdCA6IG4gPiAwICYmICh0ID0gdC5yaWdodCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIC8vIFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBlbGVtZW50IGluIHRoaXMgc29ydGVkIG1hcCwgb3IgLTEgaWYgaXQgZG9lc24ndFxuICAgIC8vIGV4aXN0LlxuICAgIGluZGV4T2YoZSkge1xuICAgICAgICAvLyBOdW1iZXIgb2Ygbm9kZXMgdGhhdCB3ZXJlIHBydW5lZCB3aGVuIGRlc2NlbmRpbmcgcmlnaHRcbiAgICAgICAgbGV0IHQgPSAwLCBuID0gdGhpcy5yb290O1xuICAgICAgICBmb3IgKDshbi5pc0VtcHR5KCk7ICkge1xuICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuY29tcGFyYXRvcihlLCBuLmtleSk7XG4gICAgICAgICAgICBpZiAoMCA9PT0gcikgcmV0dXJuIHQgKyBuLmxlZnQuc2l6ZTtcbiAgICAgICAgICAgIHIgPCAwID8gbiA9IG4ubGVmdCA6IChcbiAgICAgICAgICAgIC8vIENvdW50IGFsbCBub2RlcyBsZWZ0IG9mIHRoZSBub2RlIHBsdXMgdGhlIG5vZGUgaXRzZWxmXG4gICAgICAgICAgICB0ICs9IG4ubGVmdC5zaXplICsgMSwgbiA9IG4ucmlnaHQpO1xuICAgICAgICB9XG4gICAgICAgIC8vIE5vZGUgbm90IGZvdW5kXG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb290LmlzRW1wdHkoKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyB0aGUgdG90YWwgbnVtYmVyIG9mIG5vZGVzIGluIHRoZSBtYXAuXG4gICAgZ2V0IHNpemUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvb3Quc2l6ZTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyB0aGUgbWluaW11bSBrZXkgaW4gdGhlIG1hcC5cbiAgICBtaW5LZXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvb3QubWluS2V5KCk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgdGhlIG1heGltdW0ga2V5IGluIHRoZSBtYXAuXG4gICAgbWF4S2V5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb290Lm1heEtleSgpO1xuICAgIH1cbiAgICAvLyBUcmF2ZXJzZXMgdGhlIG1hcCBpbiBrZXkgb3JkZXIgYW5kIGNhbGxzIHRoZSBzcGVjaWZpZWQgYWN0aW9uIGZ1bmN0aW9uXG4gICAgLy8gZm9yIGVhY2gga2V5L3ZhbHVlIHBhaXIuIElmIGFjdGlvbiByZXR1cm5zIHRydWUsIHRyYXZlcnNhbCBpcyBhYm9ydGVkLlxuICAgIC8vIFJldHVybnMgdGhlIGZpcnN0IHRydXRoeSB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24sIG9yIHRoZSBsYXN0IGZhbHNleVxuICAgIC8vIHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbi5cbiAgICBpbm9yZGVyVHJhdmVyc2FsKGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdC5pbm9yZGVyVHJhdmVyc2FsKGUpO1xuICAgIH1cbiAgICBmb3JFYWNoKGUpIHtcbiAgICAgICAgdGhpcy5pbm9yZGVyVHJhdmVyc2FsKCgodCwgbikgPT4gKGUodCwgbiksICExKSkpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICByZXR1cm4gdGhpcy5pbm9yZGVyVHJhdmVyc2FsKCgodCwgbikgPT4gKGUucHVzaChgJHt0fToke259YCksICExKSkpLCBgeyR7ZS5qb2luKFwiLCBcIil9fWA7XG4gICAgfVxuICAgIC8vIFRyYXZlcnNlcyB0aGUgbWFwIGluIHJldmVyc2Uga2V5IG9yZGVyIGFuZCBjYWxscyB0aGUgc3BlY2lmaWVkIGFjdGlvblxuICAgIC8vIGZ1bmN0aW9uIGZvciBlYWNoIGtleS92YWx1ZSBwYWlyLiBJZiBhY3Rpb24gcmV0dXJucyB0cnVlLCB0cmF2ZXJzYWwgaXNcbiAgICAvLyBhYm9ydGVkLlxuICAgIC8vIFJldHVybnMgdGhlIGZpcnN0IHRydXRoeSB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24sIG9yIHRoZSBsYXN0IGZhbHNleVxuICAgIC8vIHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbi5cbiAgICByZXZlcnNlVHJhdmVyc2FsKGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdC5yZXZlcnNlVHJhdmVyc2FsKGUpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIGFuIGl0ZXJhdG9yIG92ZXIgdGhlIFNvcnRlZE1hcC5cbiAgICBnZXRJdGVyYXRvcigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTb3J0ZWRNYXBJdGVyYXRvcih0aGlzLnJvb3QsIG51bGwsIHRoaXMuY29tcGFyYXRvciwgITEpO1xuICAgIH1cbiAgICBnZXRJdGVyYXRvckZyb20oZSkge1xuICAgICAgICByZXR1cm4gbmV3IFNvcnRlZE1hcEl0ZXJhdG9yKHRoaXMucm9vdCwgZSwgdGhpcy5jb21wYXJhdG9yLCAhMSk7XG4gICAgfVxuICAgIGdldFJldmVyc2VJdGVyYXRvcigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTb3J0ZWRNYXBJdGVyYXRvcih0aGlzLnJvb3QsIG51bGwsIHRoaXMuY29tcGFyYXRvciwgITApO1xuICAgIH1cbiAgICBnZXRSZXZlcnNlSXRlcmF0b3JGcm9tKGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTb3J0ZWRNYXBJdGVyYXRvcih0aGlzLnJvb3QsIGUsIHRoaXMuY29tcGFyYXRvciwgITApO1xuICAgIH1cbn1cblxuIC8vIGVuZCBTb3J0ZWRNYXBcbi8vIEFuIGl0ZXJhdG9yIG92ZXIgYW4gTExSQk5vZGUuXG5jbGFzcyBTb3J0ZWRNYXBJdGVyYXRvciB7XG4gICAgY29uc3RydWN0b3IoZSwgdCwgbiwgcikge1xuICAgICAgICB0aGlzLmlzUmV2ZXJzZSA9IHIsIHRoaXMubm9kZVN0YWNrID0gW107XG4gICAgICAgIGxldCBpID0gMTtcbiAgICAgICAgZm9yICg7IWUuaXNFbXB0eSgpOyApIGlmIChpID0gdCA/IG4oZS5rZXksIHQpIDogMSwgXG4gICAgICAgIC8vIGZsaXAgdGhlIGNvbXBhcmlzb24gaWYgd2UncmUgZ29pbmcgaW4gcmV2ZXJzZVxuICAgICAgICB0ICYmIHIgJiYgKGkgKj0gLTEpLCBpIDwgMCkgXG4gICAgICAgIC8vIFRoaXMgbm9kZSBpcyBsZXNzIHRoYW4gb3VyIHN0YXJ0IGtleS4gaWdub3JlIGl0XG4gICAgICAgIGUgPSB0aGlzLmlzUmV2ZXJzZSA/IGUubGVmdCA6IGUucmlnaHQ7IGVsc2Uge1xuICAgICAgICAgICAgaWYgKDAgPT09IGkpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIG5vZGUgaXMgZXhhY3RseSBlcXVhbCB0byBvdXIgc3RhcnQga2V5LiBQdXNoIGl0IG9uIHRoZSBzdGFjayxcbiAgICAgICAgICAgICAgICAvLyBidXQgc3RvcCBpdGVyYXRpbmc7XG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlU3RhY2sucHVzaChlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFRoaXMgbm9kZSBpcyBncmVhdGVyIHRoYW4gb3VyIHN0YXJ0IGtleSwgYWRkIGl0IHRvIHRoZSBzdGFjayBhbmQgbW92ZVxuICAgICAgICAgICAgLy8gdG8gdGhlIG5leHQgb25lXG4gICAgICAgICAgICB0aGlzLm5vZGVTdGFjay5wdXNoKGUpLCBlID0gdGhpcy5pc1JldmVyc2UgPyBlLnJpZ2h0IDogZS5sZWZ0O1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldE5leHQoKSB7XG4gICAgICAgIGxldCBlID0gdGhpcy5ub2RlU3RhY2sucG9wKCk7XG4gICAgICAgIGNvbnN0IHQgPSB7XG4gICAgICAgICAgICBrZXk6IGUua2V5LFxuICAgICAgICAgICAgdmFsdWU6IGUudmFsdWVcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuaXNSZXZlcnNlKSBmb3IgKGUgPSBlLmxlZnQ7ICFlLmlzRW1wdHkoKTsgKSB0aGlzLm5vZGVTdGFjay5wdXNoKGUpLCBlID0gZS5yaWdodDsgZWxzZSBmb3IgKGUgPSBlLnJpZ2h0OyAhZS5pc0VtcHR5KCk7ICkgdGhpcy5ub2RlU3RhY2sucHVzaChlKSwgXG4gICAgICAgIGUgPSBlLmxlZnQ7XG4gICAgICAgIHJldHVybiB0O1xuICAgIH1cbiAgICBoYXNOZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ub2RlU3RhY2subGVuZ3RoID4gMDtcbiAgICB9XG4gICAgcGVlaygpIHtcbiAgICAgICAgaWYgKDAgPT09IHRoaXMubm9kZVN0YWNrLmxlbmd0aCkgcmV0dXJuIG51bGw7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLm5vZGVTdGFja1t0aGlzLm5vZGVTdGFjay5sZW5ndGggLSAxXTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGtleTogZS5rZXksXG4gICAgICAgICAgICB2YWx1ZTogZS52YWx1ZVxuICAgICAgICB9O1xuICAgIH1cbn1cblxuIC8vIGVuZCBTb3J0ZWRNYXBJdGVyYXRvclxuLy8gUmVwcmVzZW50cyBhIG5vZGUgaW4gYSBMZWZ0LWxlYW5pbmcgUmVkLUJsYWNrIHRyZWUuXG5jbGFzcyBMTFJCTm9kZSB7XG4gICAgY29uc3RydWN0b3IoZSwgdCwgbiwgciwgaSkge1xuICAgICAgICB0aGlzLmtleSA9IGUsIHRoaXMudmFsdWUgPSB0LCB0aGlzLmNvbG9yID0gbnVsbCAhPSBuID8gbiA6IExMUkJOb2RlLlJFRCwgdGhpcy5sZWZ0ID0gbnVsbCAhPSByID8gciA6IExMUkJOb2RlLkVNUFRZLCBcbiAgICAgICAgdGhpcy5yaWdodCA9IG51bGwgIT0gaSA/IGkgOiBMTFJCTm9kZS5FTVBUWSwgdGhpcy5zaXplID0gdGhpcy5sZWZ0LnNpemUgKyAxICsgdGhpcy5yaWdodC5zaXplO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgY3VycmVudCBub2RlLCBvcHRpb25hbGx5IHJlcGxhY2luZyBwaWVjZXMgb2YgaXQuXG4gICAgY29weShlLCB0LCBuLCByLCBpKSB7XG4gICAgICAgIHJldHVybiBuZXcgTExSQk5vZGUobnVsbCAhPSBlID8gZSA6IHRoaXMua2V5LCBudWxsICE9IHQgPyB0IDogdGhpcy52YWx1ZSwgbnVsbCAhPSBuID8gbiA6IHRoaXMuY29sb3IsIG51bGwgIT0gciA/IHIgOiB0aGlzLmxlZnQsIG51bGwgIT0gaSA/IGkgOiB0aGlzLnJpZ2h0KTtcbiAgICB9XG4gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuICExO1xuICAgIH1cbiAgICAvLyBUcmF2ZXJzZXMgdGhlIHRyZWUgaW4ga2V5IG9yZGVyIGFuZCBjYWxscyB0aGUgc3BlY2lmaWVkIGFjdGlvbiBmdW5jdGlvblxuICAgIC8vIGZvciBlYWNoIG5vZGUuIElmIGFjdGlvbiByZXR1cm5zIHRydWUsIHRyYXZlcnNhbCBpcyBhYm9ydGVkLlxuICAgIC8vIFJldHVybnMgdGhlIGZpcnN0IHRydXRoeSB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24sIG9yIHRoZSBsYXN0IGZhbHNleVxuICAgIC8vIHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbi5cbiAgICBpbm9yZGVyVHJhdmVyc2FsKGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGVmdC5pbm9yZGVyVHJhdmVyc2FsKGUpIHx8IGUodGhpcy5rZXksIHRoaXMudmFsdWUpIHx8IHRoaXMucmlnaHQuaW5vcmRlclRyYXZlcnNhbChlKTtcbiAgICB9XG4gICAgLy8gVHJhdmVyc2VzIHRoZSB0cmVlIGluIHJldmVyc2Uga2V5IG9yZGVyIGFuZCBjYWxscyB0aGUgc3BlY2lmaWVkIGFjdGlvblxuICAgIC8vIGZ1bmN0aW9uIGZvciBlYWNoIG5vZGUuIElmIGFjdGlvbiByZXR1cm5zIHRydWUsIHRyYXZlcnNhbCBpcyBhYm9ydGVkLlxuICAgIC8vIFJldHVybnMgdGhlIGZpcnN0IHRydXRoeSB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24sIG9yIHRoZSBsYXN0IGZhbHNleVxuICAgIC8vIHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbi5cbiAgICByZXZlcnNlVHJhdmVyc2FsKGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmlnaHQucmV2ZXJzZVRyYXZlcnNhbChlKSB8fCBlKHRoaXMua2V5LCB0aGlzLnZhbHVlKSB8fCB0aGlzLmxlZnQucmV2ZXJzZVRyYXZlcnNhbChlKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyB0aGUgbWluaW11bSBub2RlIGluIHRoZSB0cmVlLlxuICAgIG1pbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGVmdC5pc0VtcHR5KCkgPyB0aGlzIDogdGhpcy5sZWZ0Lm1pbigpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIHRoZSBtYXhpbXVtIGtleSBpbiB0aGUgdHJlZS5cbiAgICBtaW5LZXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1pbigpLmtleTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyB0aGUgbWF4aW11bSBrZXkgaW4gdGhlIHRyZWUuXG4gICAgbWF4S2V5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yaWdodC5pc0VtcHR5KCkgPyB0aGlzLmtleSA6IHRoaXMucmlnaHQubWF4S2V5KCk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgbmV3IHRyZWUsIHdpdGggdGhlIGtleS92YWx1ZSBhZGRlZC5cbiAgICBpbnNlcnQoZSwgdCwgbikge1xuICAgICAgICBsZXQgciA9IHRoaXM7XG4gICAgICAgIGNvbnN0IGkgPSBuKGUsIHIua2V5KTtcbiAgICAgICAgcmV0dXJuIHIgPSBpIDwgMCA/IHIuY29weShudWxsLCBudWxsLCBudWxsLCByLmxlZnQuaW5zZXJ0KGUsIHQsIG4pLCBudWxsKSA6IDAgPT09IGkgPyByLmNvcHkobnVsbCwgdCwgbnVsbCwgbnVsbCwgbnVsbCkgOiByLmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgci5yaWdodC5pbnNlcnQoZSwgdCwgbikpLCBcbiAgICAgICAgci5maXhVcCgpO1xuICAgIH1cbiAgICByZW1vdmVNaW4oKSB7XG4gICAgICAgIGlmICh0aGlzLmxlZnQuaXNFbXB0eSgpKSByZXR1cm4gTExSQk5vZGUuRU1QVFk7XG4gICAgICAgIGxldCBlID0gdGhpcztcbiAgICAgICAgcmV0dXJuIGUubGVmdC5pc1JlZCgpIHx8IGUubGVmdC5sZWZ0LmlzUmVkKCkgfHwgKGUgPSBlLm1vdmVSZWRMZWZ0KCkpLCBlID0gZS5jb3B5KG51bGwsIG51bGwsIG51bGwsIGUubGVmdC5yZW1vdmVNaW4oKSwgbnVsbCksIFxuICAgICAgICBlLmZpeFVwKCk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgbmV3IHRyZWUsIHdpdGggdGhlIHNwZWNpZmllZCBpdGVtIHJlbW92ZWQuXG4gICAgcmVtb3ZlKGUsIHQpIHtcbiAgICAgICAgbGV0IG4sIHIgPSB0aGlzO1xuICAgICAgICBpZiAodChlLCByLmtleSkgPCAwKSByLmxlZnQuaXNFbXB0eSgpIHx8IHIubGVmdC5pc1JlZCgpIHx8IHIubGVmdC5sZWZ0LmlzUmVkKCkgfHwgKHIgPSByLm1vdmVSZWRMZWZ0KCkpLCBcbiAgICAgICAgciA9IHIuY29weShudWxsLCBudWxsLCBudWxsLCByLmxlZnQucmVtb3ZlKGUsIHQpLCBudWxsKTsgZWxzZSB7XG4gICAgICAgICAgICBpZiAoci5sZWZ0LmlzUmVkKCkgJiYgKHIgPSByLnJvdGF0ZVJpZ2h0KCkpLCByLnJpZ2h0LmlzRW1wdHkoKSB8fCByLnJpZ2h0LmlzUmVkKCkgfHwgci5yaWdodC5sZWZ0LmlzUmVkKCkgfHwgKHIgPSByLm1vdmVSZWRSaWdodCgpKSwgXG4gICAgICAgICAgICAwID09PSB0KGUsIHIua2V5KSkge1xuICAgICAgICAgICAgICAgIGlmIChyLnJpZ2h0LmlzRW1wdHkoKSkgcmV0dXJuIExMUkJOb2RlLkVNUFRZO1xuICAgICAgICAgICAgICAgIG4gPSByLnJpZ2h0Lm1pbigpLCByID0gci5jb3B5KG4ua2V5LCBuLnZhbHVlLCBudWxsLCBudWxsLCByLnJpZ2h0LnJlbW92ZU1pbigpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHIgPSByLmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgci5yaWdodC5yZW1vdmUoZSwgdCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByLmZpeFVwKCk7XG4gICAgfVxuICAgIGlzUmVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb2xvcjtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBuZXcgdHJlZSBhZnRlciBwZXJmb3JtaW5nIGFueSBuZWVkZWQgcm90YXRpb25zLlxuICAgIGZpeFVwKCkge1xuICAgICAgICBsZXQgZSA9IHRoaXM7XG4gICAgICAgIHJldHVybiBlLnJpZ2h0LmlzUmVkKCkgJiYgIWUubGVmdC5pc1JlZCgpICYmIChlID0gZS5yb3RhdGVMZWZ0KCkpLCBlLmxlZnQuaXNSZWQoKSAmJiBlLmxlZnQubGVmdC5pc1JlZCgpICYmIChlID0gZS5yb3RhdGVSaWdodCgpKSwgXG4gICAgICAgIGUubGVmdC5pc1JlZCgpICYmIGUucmlnaHQuaXNSZWQoKSAmJiAoZSA9IGUuY29sb3JGbGlwKCkpLCBlO1xuICAgIH1cbiAgICBtb3ZlUmVkTGVmdCgpIHtcbiAgICAgICAgbGV0IGUgPSB0aGlzLmNvbG9yRmxpcCgpO1xuICAgICAgICByZXR1cm4gZS5yaWdodC5sZWZ0LmlzUmVkKCkgJiYgKGUgPSBlLmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgZS5yaWdodC5yb3RhdGVSaWdodCgpKSwgXG4gICAgICAgIGUgPSBlLnJvdGF0ZUxlZnQoKSwgZSA9IGUuY29sb3JGbGlwKCkpLCBlO1xuICAgIH1cbiAgICBtb3ZlUmVkUmlnaHQoKSB7XG4gICAgICAgIGxldCBlID0gdGhpcy5jb2xvckZsaXAoKTtcbiAgICAgICAgcmV0dXJuIGUubGVmdC5sZWZ0LmlzUmVkKCkgJiYgKGUgPSBlLnJvdGF0ZVJpZ2h0KCksIGUgPSBlLmNvbG9yRmxpcCgpKSwgZTtcbiAgICB9XG4gICAgcm90YXRlTGVmdCgpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuY29weShudWxsLCBudWxsLCBMTFJCTm9kZS5SRUQsIG51bGwsIHRoaXMucmlnaHQubGVmdCk7XG4gICAgICAgIHJldHVybiB0aGlzLnJpZ2h0LmNvcHkobnVsbCwgbnVsbCwgdGhpcy5jb2xvciwgZSwgbnVsbCk7XG4gICAgfVxuICAgIHJvdGF0ZVJpZ2h0KCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5jb3B5KG51bGwsIG51bGwsIExMUkJOb2RlLlJFRCwgdGhpcy5sZWZ0LnJpZ2h0LCBudWxsKTtcbiAgICAgICAgcmV0dXJuIHRoaXMubGVmdC5jb3B5KG51bGwsIG51bGwsIHRoaXMuY29sb3IsIG51bGwsIGUpO1xuICAgIH1cbiAgICBjb2xvckZsaXAoKSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmxlZnQuY29weShudWxsLCBudWxsLCAhdGhpcy5sZWZ0LmNvbG9yLCBudWxsLCBudWxsKSwgdCA9IHRoaXMucmlnaHQuY29weShudWxsLCBudWxsLCAhdGhpcy5yaWdodC5jb2xvciwgbnVsbCwgbnVsbCk7XG4gICAgICAgIHJldHVybiB0aGlzLmNvcHkobnVsbCwgbnVsbCwgIXRoaXMuY29sb3IsIGUsIHQpO1xuICAgIH1cbiAgICAvLyBGb3IgdGVzdGluZy5cbiAgICBjaGVja01heERlcHRoKCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5jaGVjaygpO1xuICAgICAgICByZXR1cm4gTWF0aC5wb3coMiwgZSkgPD0gdGhpcy5zaXplICsgMTtcbiAgICB9XG4gICAgLy8gSW4gYSBiYWxhbmNlZCBSQiB0cmVlLCB0aGUgYmxhY2stZGVwdGggKG51bWJlciBvZiBibGFjayBub2RlcykgZnJvbSByb290IHRvXG4gICAgLy8gbGVhdmVzIGlzIGVxdWFsIG9uIGJvdGggc2lkZXMuICBUaGlzIGZ1bmN0aW9uIHZlcmlmaWVzIHRoYXQgb3IgYXNzZXJ0cy5cbiAgICBjaGVjaygpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNSZWQoKSAmJiB0aGlzLmxlZnQuaXNSZWQoKSkgdGhyb3cgZmFpbCg0MzczMCwge1xuICAgICAgICAgICAga2V5OiB0aGlzLmtleSxcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLnZhbHVlXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodGhpcy5yaWdodC5pc1JlZCgpKSB0aHJvdyBmYWlsKDE0MTEzLCB7XG4gICAgICAgICAgICBrZXk6IHRoaXMua2V5LFxuICAgICAgICAgICAgdmFsdWU6IHRoaXMudmFsdWVcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmxlZnQuY2hlY2soKTtcbiAgICAgICAgaWYgKGUgIT09IHRoaXMucmlnaHQuY2hlY2soKSkgdGhyb3cgZmFpbCgyNzk0OSk7XG4gICAgICAgIHJldHVybiBlICsgKHRoaXMuaXNSZWQoKSA/IDAgOiAxKTtcbiAgICB9XG59XG5cbiAvLyBlbmQgTExSQk5vZGVcbi8vIEVtcHR5IG5vZGUgaXMgc2hhcmVkIGJldHdlZW4gYWxsIExMUkIgdHJlZXMuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuTExSQk5vZGUuRU1QVFkgPSBudWxsLCBMTFJCTm9kZS5SRUQgPSAhMCwgTExSQk5vZGUuQkxBQ0sgPSAhMTtcblxuLy8gZW5kIExMUkJFbXB0eU5vZGVcbkxMUkJOb2RlLkVNUFRZID0gbmV3IFxuLy8gUmVwcmVzZW50cyBhbiBlbXB0eSBub2RlIChhIGxlYWYgbm9kZSBpbiB0aGUgUmVkLUJsYWNrIFRyZWUpLlxuY2xhc3MgTExSQkVtcHR5Tm9kZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuc2l6ZSA9IDA7XG4gICAgfVxuICAgIGdldCBrZXkoKSB7XG4gICAgICAgIHRocm93IGZhaWwoNTc3NjYpO1xuICAgIH1cbiAgICBnZXQgdmFsdWUoKSB7XG4gICAgICAgIHRocm93IGZhaWwoMTYxNDEpO1xuICAgIH1cbiAgICBnZXQgY29sb3IoKSB7XG4gICAgICAgIHRocm93IGZhaWwoMTY3MjcpO1xuICAgIH1cbiAgICBnZXQgbGVmdCgpIHtcbiAgICAgICAgdGhyb3cgZmFpbCgyOTcyNik7XG4gICAgfVxuICAgIGdldCByaWdodCgpIHtcbiAgICAgICAgdGhyb3cgZmFpbCgzNjg5NCk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSBjdXJyZW50IG5vZGUuXG4gICAgY29weShlLCB0LCBuLCByLCBpKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgdHJlZSwgd2l0aCB0aGUgc3BlY2lmaWVkIGtleS92YWx1ZSBhZGRlZC5cbiAgICBpbnNlcnQoZSwgdCwgbikge1xuICAgICAgICByZXR1cm4gbmV3IExMUkJOb2RlKGUsIHQpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgdHJlZSwgd2l0aCB0aGUgc3BlY2lmaWVkIGtleSByZW1vdmVkLlxuICAgIHJlbW92ZShlLCB0KSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIGlub3JkZXJUcmF2ZXJzYWwoZSkge1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIHJldmVyc2VUcmF2ZXJzYWwoZSkge1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIG1pbktleSgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIG1heEtleSgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGlzUmVkKCkge1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIC8vIEZvciB0ZXN0aW5nLlxuICAgIGNoZWNrTWF4RGVwdGgoKSB7XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgY2hlY2soKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbn07XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFNvcnRlZFNldCBpcyBhbiBpbW11dGFibGUgKGNvcHktb24td3JpdGUpIGNvbGxlY3Rpb24gdGhhdCBob2xkcyBlbGVtZW50c1xuICogaW4gb3JkZXIgc3BlY2lmaWVkIGJ5IHRoZSBwcm92aWRlZCBjb21wYXJhdG9yLlxuICpcbiAqIE5PVEU6IGlmIHByb3ZpZGVkIGNvbXBhcmF0b3IgcmV0dXJucyAwIGZvciB0d28gZWxlbWVudHMsIHdlIGNvbnNpZGVyIHRoZW0gdG9cbiAqIGJlIGVxdWFsIVxuICovXG5jbGFzcyBTb3J0ZWRTZXQge1xuICAgIGNvbnN0cnVjdG9yKGUpIHtcbiAgICAgICAgdGhpcy5jb21wYXJhdG9yID0gZSwgdGhpcy5kYXRhID0gbmV3IFNvcnRlZE1hcCh0aGlzLmNvbXBhcmF0b3IpO1xuICAgIH1cbiAgICBoYXMoZSkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gdGhpcy5kYXRhLmdldChlKTtcbiAgICB9XG4gICAgZmlyc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEubWluS2V5KCk7XG4gICAgfVxuICAgIGxhc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEubWF4S2V5KCk7XG4gICAgfVxuICAgIGdldCBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLnNpemU7XG4gICAgfVxuICAgIGluZGV4T2YoZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLmluZGV4T2YoZSk7XG4gICAgfVxuICAgIC8qKiBJdGVyYXRlcyBlbGVtZW50cyBpbiBvcmRlciBkZWZpbmVkIGJ5IFwiY29tcGFyYXRvclwiICovICAgIGZvckVhY2goZSkge1xuICAgICAgICB0aGlzLmRhdGEuaW5vcmRlclRyYXZlcnNhbCgoKHQsIG4pID0+IChlKHQpLCAhMSkpKTtcbiAgICB9XG4gICAgLyoqIEl0ZXJhdGVzIG92ZXIgYGVsZW1gcyBzdWNoIHRoYXQ6IHJhbmdlWzBdICZsdDs9IGVsZW0gJmx0OyByYW5nZVsxXS4gKi8gICAgZm9yRWFjaEluUmFuZ2UoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gdGhpcy5kYXRhLmdldEl0ZXJhdG9yRnJvbShlWzBdKTtcbiAgICAgICAgZm9yICg7bi5oYXNOZXh0KCk7ICkge1xuICAgICAgICAgICAgY29uc3QgciA9IG4uZ2V0TmV4dCgpO1xuICAgICAgICAgICAgaWYgKHRoaXMuY29tcGFyYXRvcihyLmtleSwgZVsxXSkgPj0gMCkgcmV0dXJuO1xuICAgICAgICAgICAgdChyLmtleSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogSXRlcmF0ZXMgb3ZlciBgZWxlbWBzIHN1Y2ggdGhhdDogc3RhcnQgJmx0Oz0gZWxlbSB1bnRpbCBmYWxzZSBpcyByZXR1cm5lZC5cbiAgICAgKi8gICAgZm9yRWFjaFdoaWxlKGUsIHQpIHtcbiAgICAgICAgbGV0IG47XG4gICAgICAgIGZvciAobiA9IHZvaWQgMCAhPT0gdCA/IHRoaXMuZGF0YS5nZXRJdGVyYXRvckZyb20odCkgOiB0aGlzLmRhdGEuZ2V0SXRlcmF0b3IoKTsgbi5oYXNOZXh0KCk7ICkge1xuICAgICAgICAgICAgaWYgKCFlKG4uZ2V0TmV4dCgpLmtleSkpIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKiogRmluZHMgdGhlIGxlYXN0IGVsZW1lbnQgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIGBlbGVtYC4gKi8gICAgZmlyc3RBZnRlck9yRXF1YWwoZSkge1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5kYXRhLmdldEl0ZXJhdG9yRnJvbShlKTtcbiAgICAgICAgcmV0dXJuIHQuaGFzTmV4dCgpID8gdC5nZXROZXh0KCkua2V5IDogbnVsbDtcbiAgICB9XG4gICAgZ2V0SXRlcmF0b3IoKSB7XG4gICAgICAgIHJldHVybiBuZXcgU29ydGVkU2V0SXRlcmF0b3IodGhpcy5kYXRhLmdldEl0ZXJhdG9yKCkpO1xuICAgIH1cbiAgICBnZXRJdGVyYXRvckZyb20oZSkge1xuICAgICAgICByZXR1cm4gbmV3IFNvcnRlZFNldEl0ZXJhdG9yKHRoaXMuZGF0YS5nZXRJdGVyYXRvckZyb20oZSkpO1xuICAgIH1cbiAgICAvKiogSW5zZXJ0cyBvciB1cGRhdGVzIGFuIGVsZW1lbnQgKi8gICAgYWRkKGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29weSh0aGlzLmRhdGEucmVtb3ZlKGUpLmluc2VydChlLCAhMCkpO1xuICAgIH1cbiAgICAvKiogRGVsZXRlcyBhbiBlbGVtZW50ICovICAgIGRlbGV0ZShlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhhcyhlKSA/IHRoaXMuY29weSh0aGlzLmRhdGEucmVtb3ZlKGUpKSA6IHRoaXM7XG4gICAgfVxuICAgIGlzRW1wdHkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEuaXNFbXB0eSgpO1xuICAgIH1cbiAgICB1bmlvbldpdGgoZSkge1xuICAgICAgICBsZXQgdCA9IHRoaXM7XG4gICAgICAgIC8vIE1ha2Ugc3VyZSBgcmVzdWx0YCBhbHdheXMgcmVmZXJzIHRvIHRoZSBsYXJnZXIgb25lIG9mIHRoZSB0d28gc2V0cy5cbiAgICAgICAgICAgICAgICByZXR1cm4gdC5zaXplIDwgZS5zaXplICYmICh0ID0gZSwgZSA9IHRoaXMpLCBlLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgdCA9IHQuYWRkKGUpO1xuICAgICAgICB9KSksIHQ7XG4gICAgfVxuICAgIGlzRXF1YWwoZSkge1xuICAgICAgICBpZiAoIShlIGluc3RhbmNlb2YgU29ydGVkU2V0KSkgcmV0dXJuICExO1xuICAgICAgICBpZiAodGhpcy5zaXplICE9PSBlLnNpemUpIHJldHVybiAhMTtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuZGF0YS5nZXRJdGVyYXRvcigpLCBuID0gZS5kYXRhLmdldEl0ZXJhdG9yKCk7XG4gICAgICAgIGZvciAoO3QuaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LmdldE5leHQoKS5rZXksIHIgPSBuLmdldE5leHQoKS5rZXk7XG4gICAgICAgICAgICBpZiAoMCAhPT0gdGhpcy5jb21wYXJhdG9yKGUsIHIpKSByZXR1cm4gITE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH1cbiAgICB0b0FycmF5KCkge1xuICAgICAgICBjb25zdCBlID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgZS5wdXNoKHQpO1xuICAgICAgICB9KSksIGU7XG4gICAgfVxuICAgIHRvU3RyaW5nKCkge1xuICAgICAgICBjb25zdCBlID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLmZvckVhY2goKHQgPT4gZS5wdXNoKHQpKSksIFwiU29ydGVkU2V0KFwiICsgZS50b1N0cmluZygpICsgXCIpXCI7XG4gICAgfVxuICAgIGNvcHkoZSkge1xuICAgICAgICBjb25zdCB0ID0gbmV3IFNvcnRlZFNldCh0aGlzLmNvbXBhcmF0b3IpO1xuICAgICAgICByZXR1cm4gdC5kYXRhID0gZSwgdDtcbiAgICB9XG59XG5cbmNsYXNzIFNvcnRlZFNldEl0ZXJhdG9yIHtcbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHRoaXMuaXRlciA9IGU7XG4gICAgfVxuICAgIGdldE5leHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLml0ZXIuZ2V0TmV4dCgpLmtleTtcbiAgICB9XG4gICAgaGFzTmV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlci5oYXNOZXh0KCk7XG4gICAgfVxufVxuXG4vKipcbiAqIENvbXBhcmVzIHR3byBzb3J0ZWQgc2V0cyBmb3IgZXF1YWxpdHkgdXNpbmcgdGhlaXIgbmF0dXJhbCBvcmRlcmluZy4gVGhlXG4gKiBtZXRob2QgY29tcHV0ZXMgdGhlIGludGVyc2VjdGlvbiBhbmQgaW52b2tlcyBgb25BZGRgIGZvciBldmVyeSBlbGVtZW50IHRoYXRcbiAqIGlzIGluIGBhZnRlcmAgYnV0IG5vdCBgYmVmb3JlYC4gYG9uUmVtb3ZlYCBpcyBpbnZva2VkIGZvciBldmVyeSBlbGVtZW50IGluXG4gKiBgYmVmb3JlYCBidXQgbWlzc2luZyBmcm9tIGBhZnRlcmAuXG4gKlxuICogVGhlIG1ldGhvZCBjcmVhdGVzIGEgY29weSBvZiBib3RoIGBiZWZvcmVgIGFuZCBgYWZ0ZXJgIGFuZCBydW5zIGluIE8obiBsb2dcbiAqIG4pLCB3aGVyZSBuIGlzIHRoZSBzaXplIG9mIHRoZSB0d28gbGlzdHMuXG4gKlxuICogQHBhcmFtIGJlZm9yZSAtIFRoZSBlbGVtZW50cyB0aGF0IGV4aXN0IGluIHRoZSBvcmlnaW5hbCBzZXQuXG4gKiBAcGFyYW0gYWZ0ZXIgLSBUaGUgZWxlbWVudHMgdG8gZGlmZiBhZ2FpbnN0IHRoZSBvcmlnaW5hbCBzZXQuXG4gKiBAcGFyYW0gY29tcGFyYXRvciAtIFRoZSBjb21wYXJhdG9yIGZvciB0aGUgZWxlbWVudHMgaW4gYmVmb3JlIGFuZCBhZnRlci5cbiAqIEBwYXJhbSBvbkFkZCAtIEEgZnVuY3Rpb24gdG8gaW52b2tlIGZvciBldmVyeSBlbGVtZW50IHRoYXQgaXMgcGFydCBvZiBgXG4gKiBhZnRlcmAgYnV0IG5vdCBgYmVmb3JlYC5cbiAqIEBwYXJhbSBvblJlbW92ZSAtIEEgZnVuY3Rpb24gdG8gaW52b2tlIGZvciBldmVyeSBlbGVtZW50IHRoYXQgaXMgcGFydCBvZlxuICogYGJlZm9yZWAgYnV0IG5vdCBgYWZ0ZXJgLlxuICovXG4vKipcbiAqIFJldHVybnMgdGhlIG5leHQgZWxlbWVudCBmcm9tIHRoZSBpdGVyYXRvciBvciBgdW5kZWZpbmVkYCBpZiBub25lIGF2YWlsYWJsZS5cbiAqL1xuZnVuY3Rpb24gX19QUklWQVRFX2FkdmFuY2VJdGVyYXRvcihlKSB7XG4gICAgcmV0dXJuIGUuaGFzTmV4dCgpID8gZS5nZXROZXh0KCkgOiB2b2lkIDA7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFByb3ZpZGVzIGEgc2V0IG9mIGZpZWxkcyB0aGF0IGNhbiBiZSB1c2VkIHRvIHBhcnRpYWxseSBwYXRjaCBhIGRvY3VtZW50LlxuICogRmllbGRNYXNrIGlzIHVzZWQgaW4gY29uanVuY3Rpb24gd2l0aCBPYmplY3RWYWx1ZS5cbiAqIEV4YW1wbGVzOlxuICogICBmb28gLSBPdmVyd3JpdGVzIGZvbyBlbnRpcmVseSB3aXRoIHRoZSBwcm92aWRlZCB2YWx1ZS4gSWYgZm9vIGlzIG5vdFxuICogICAgICAgICBwcmVzZW50IGluIHRoZSBjb21wYW5pb24gT2JqZWN0VmFsdWUsIHRoZSBmaWVsZCBpcyBkZWxldGVkLlxuICogICBmb28uYmFyIC0gT3ZlcndyaXRlcyBvbmx5IHRoZSBmaWVsZCBiYXIgb2YgdGhlIG9iamVjdCBmb28uXG4gKiAgICAgICAgICAgICBJZiBmb28gaXMgbm90IGFuIG9iamVjdCwgZm9vIGlzIHJlcGxhY2VkIHdpdGggYW4gb2JqZWN0XG4gKiAgICAgICAgICAgICBjb250YWluaW5nIGZvb1xuICovIGNsYXNzIEZpZWxkTWFzayB7XG4gICAgY29uc3RydWN0b3IoZSkge1xuICAgICAgICB0aGlzLmZpZWxkcyA9IGUsIFxuICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IHZhbGlkYXRpb24gb2YgRmllbGRNYXNrXG4gICAgICAgIC8vIFNvcnQgdGhlIGZpZWxkIG1hc2sgdG8gc3VwcG9ydCBgRmllbGRNYXNrLmlzRXF1YWwoKWAgYW5kIGFzc2VydCBiZWxvdy5cbiAgICAgICAgZS5zb3J0KEZpZWxkUGF0aCQxLmNvbXBhcmF0b3IpO1xuICAgIH1cbiAgICBzdGF0aWMgZW1wdHkoKSB7XG4gICAgICAgIHJldHVybiBuZXcgRmllbGRNYXNrKFtdKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIG5ldyBGaWVsZE1hc2sgb2JqZWN0IHRoYXQgaXMgdGhlIHJlc3VsdCBvZiBhZGRpbmcgYWxsIHRoZSBnaXZlblxuICAgICAqIGZpZWxkcyBwYXRocyB0byB0aGlzIGZpZWxkIG1hc2suXG4gICAgICovICAgIHVuaW9uV2l0aChlKSB7XG4gICAgICAgIGxldCB0ID0gbmV3IFNvcnRlZFNldChGaWVsZFBhdGgkMS5jb21wYXJhdG9yKTtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMuZmllbGRzKSB0ID0gdC5hZGQoZSk7XG4gICAgICAgIGZvciAoY29uc3QgbiBvZiBlKSB0ID0gdC5hZGQobik7XG4gICAgICAgIHJldHVybiBuZXcgRmllbGRNYXNrKHQudG9BcnJheSgpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVmVyaWZpZXMgdGhhdCBgZmllbGRQYXRoYCBpcyBpbmNsdWRlZCBieSBhdCBsZWFzdCBvbmUgZmllbGQgaW4gdGhpcyBmaWVsZFxuICAgICAqIG1hc2suXG4gICAgICpcbiAgICAgKiBUaGlzIGlzIGFuIE8obikgb3BlcmF0aW9uLCB3aGVyZSBgbmAgaXMgdGhlIHNpemUgb2YgdGhlIGZpZWxkIG1hc2suXG4gICAgICovICAgIGNvdmVycyhlKSB7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLmZpZWxkcykgaWYgKHQuaXNQcmVmaXhPZihlKSkgcmV0dXJuICEwO1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIGlzRXF1YWwoZSkge1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX2FycmF5RXF1YWxzKHRoaXMuZmllbGRzLCBlLmZpZWxkcywgKChlLCB0KSA9PiBlLmlzRXF1YWwodCkpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIzIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEFuIGVycm9yIGVuY291bnRlcmVkIHdoaWxlIGRlY29kaW5nIGJhc2U2NCBzdHJpbmcuXG4gKi8gY2xhc3MgX19QUklWQVRFX0Jhc2U2NERlY29kZUVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlciguLi5hcmd1bWVudHMpLCB0aGlzLm5hbWUgPSBcIkJhc2U2NERlY29kZUVycm9yXCI7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqIENvbnZlcnRzIGEgQmFzZTY0IGVuY29kZWQgc3RyaW5nIHRvIGEgYmluYXJ5IHN0cmluZy4gKi9cbi8qKiBUcnVlIGlmIGFuZCBvbmx5IGlmIHRoZSBCYXNlNjQgY29udmVyc2lvbiBmdW5jdGlvbnMgYXJlIGF2YWlsYWJsZS4gKi9cbmZ1bmN0aW9uIF9fUFJJVkFURV9pc0Jhc2U2NEF2YWlsYWJsZSgpIHtcbiAgICByZXR1cm4gXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgYXRvYjtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogSW1tdXRhYmxlIGNsYXNzIHRoYXQgcmVwcmVzZW50cyBhIFwicHJvdG9cIiBieXRlIHN0cmluZy5cbiAqXG4gKiBQcm90byBieXRlIHN0cmluZ3MgY2FuIGVpdGhlciBiZSBCYXNlNjQtZW5jb2RlZCBzdHJpbmdzIG9yIFVpbnQ4QXJyYXlzIHdoZW5cbiAqIHNlbnQgb24gdGhlIHdpcmUuIFRoaXMgY2xhc3MgYWJzdHJhY3RzIGF3YXkgdGhpcyBkaWZmZXJlbnRpYXRpb24gYnkgaG9sZGluZ1xuICogdGhlIHByb3RvIGJ5dGUgc3RyaW5nIGluIGEgY29tbW9uIGNsYXNzIHRoYXQgbXVzdCBiZSBjb252ZXJ0ZWQgaW50byBhIHN0cmluZ1xuICogYmVmb3JlIGJlaW5nIHNlbnQgYXMgYSBwcm90by5cbiAqIEBpbnRlcm5hbFxuICovIGNsYXNzIEJ5dGVTdHJpbmcge1xuICAgIGNvbnN0cnVjdG9yKGUpIHtcbiAgICAgICAgdGhpcy5iaW5hcnlTdHJpbmcgPSBlO1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbUJhc2U2NFN0cmluZyhlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBmdW5jdGlvbiBfX1BSSVZBVEVfZGVjb2RlQmFzZTY0KGUpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF0b2IoZSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgdGhhdCBgRE9NRXhjZXB0aW9uYCBpcyBkZWZpbmVkIGJlZm9yZSB1c2luZyBpdCB0byBhdm9pZFxuICAgICAgICAgICAgICAgIC8vIFwiUmVmZXJlbmNlRXJyb3I6IFByb3BlcnR5ICdET01FeGNlcHRpb24nIGRvZXNuJ3QgZXhpc3RcIiBpbiByZWFjdC1uYXRpdmUuXG4gICAgICAgICAgICAgICAgLy8gKGh0dHBzOi8vZ2l0aHViLmNvbS9maXJlYmFzZS9maXJlYmFzZS1qcy1zZGsvaXNzdWVzLzcxMTUpXG4gICAgICAgICAgICAgICAgdGhyb3cgXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgRE9NRXhjZXB0aW9uICYmIGUgaW5zdGFuY2VvZiBET01FeGNlcHRpb24gPyBuZXcgX19QUklWQVRFX0Jhc2U2NERlY29kZUVycm9yKFwiSW52YWxpZCBiYXNlNjQgc3RyaW5nOiBcIiArIGUpIDogZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKiogQ29udmVydHMgYSBiaW5hcnkgc3RyaW5nIHRvIGEgQmFzZTY0IGVuY29kZWQgc3RyaW5nLiAqLyAoZSk7XG4gICAgICAgIHJldHVybiBuZXcgQnl0ZVN0cmluZyh0KTtcbiAgICB9XG4gICAgc3RhdGljIGZyb21VaW50OEFycmF5KGUpIHtcbiAgICAgICAgLy8gVE9ETyhpbmRleGluZyk7IFJlbW92ZSB0aGUgY29weSBvZiB0aGUgYnl0ZSBzdHJpbmcgaGVyZSBhcyB0aGlzIG1ldGhvZFxuICAgICAgICAvLyBpcyBmcmVxdWVudGx5IGNhbGxlZCBkdXJpbmcgaW5kZXhpbmcuXG4gICAgICAgIGNvbnN0IHQgPSBcbiAgICAgICAgLyoqXG4gKiBIZWxwZXIgZnVuY3Rpb24gdG8gY29udmVydCBhbiBVaW50OGFycmF5IHRvIGEgYmluYXJ5IHN0cmluZy5cbiAqL1xuICAgICAgICBmdW5jdGlvbiBfX1BSSVZBVEVfYmluYXJ5U3RyaW5nRnJvbVVpbnQ4QXJyYXkoZSkge1xuICAgICAgICAgICAgbGV0IHQgPSBcIlwiO1xuICAgICAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCBlLmxlbmd0aDsgKytuKSB0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoZVtuXSk7XG4gICAgICAgICAgICByZXR1cm4gdDtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBjb252ZXJ0IGEgYmluYXJ5IHN0cmluZyB0byBhbiBVaW50OEFycmF5LlxuICovIChlKTtcbiAgICAgICAgcmV0dXJuIG5ldyBCeXRlU3RyaW5nKHQpO1xuICAgIH1cbiAgICBbU3ltYm9sLml0ZXJhdG9yXSgpIHtcbiAgICAgICAgbGV0IGUgPSAwO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmV4dDogKCkgPT4gZSA8IHRoaXMuYmluYXJ5U3RyaW5nLmxlbmd0aCA/IHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5iaW5hcnlTdHJpbmcuY2hhckNvZGVBdChlKyspLFxuICAgICAgICAgICAgICAgIGRvbmU6ICExXG4gICAgICAgICAgICB9IDoge1xuICAgICAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAsXG4gICAgICAgICAgICAgICAgZG9uZTogITBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG4gICAgdG9CYXNlNjQoKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBfX1BSSVZBVEVfZW5jb2RlQmFzZTY0KGUpIHtcbiAgICAgICAgICAgIHJldHVybiBidG9hKGUpO1xuICAgICAgICB9KHRoaXMuYmluYXJ5U3RyaW5nKTtcbiAgICB9XG4gICAgdG9VaW50OEFycmF5KCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX3VpbnQ4QXJyYXlGcm9tQmluYXJ5U3RyaW5nKGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBuZXcgVWludDhBcnJheShlLmxlbmd0aCk7XG4gICAgICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IGUubGVuZ3RoOyBuKyspIHRbbl0gPSBlLmNoYXJDb2RlQXQobik7XG4gICAgICAgICAgICByZXR1cm4gdDtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuICAgICAgICAvLyBBIFJlZ0V4cCBtYXRjaGluZyBJU08gODYwMSBVVEMgdGltZXN0YW1wcyB3aXRoIG9wdGlvbmFsIGZyYWN0aW9uLlxuICAgICAgICAodGhpcy5iaW5hcnlTdHJpbmcpO1xuICAgIH1cbiAgICBhcHByb3hpbWF0ZUJ5dGVTaXplKCkge1xuICAgICAgICByZXR1cm4gMiAqIHRoaXMuYmluYXJ5U3RyaW5nLmxlbmd0aDtcbiAgICB9XG4gICAgY29tcGFyZVRvKGUpIHtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9wcmltaXRpdmVDb21wYXJhdG9yKHRoaXMuYmluYXJ5U3RyaW5nLCBlLmJpbmFyeVN0cmluZyk7XG4gICAgfVxuICAgIGlzRXF1YWwoZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5iaW5hcnlTdHJpbmcgPT09IGUuYmluYXJ5U3RyaW5nO1xuICAgIH1cbn1cblxuQnl0ZVN0cmluZy5FTVBUWV9CWVRFX1NUUklORyA9IG5ldyBCeXRlU3RyaW5nKFwiXCIpO1xuXG5jb25zdCBvdCA9IG5ldyBSZWdFeHAoL15cXGR7NH0tXFxkXFxkLVxcZFxcZFRcXGRcXGQ6XFxkXFxkOlxcZFxcZCg/OlxcLihcXGQrKSk/WiQvKTtcblxuLyoqXG4gKiBDb252ZXJ0cyB0aGUgcG9zc2libGUgUHJvdG8gdmFsdWVzIGZvciBhIHRpbWVzdGFtcCB2YWx1ZSBpbnRvIGEgXCJzZWNvbmRzIGFuZFxuICogbmFub3NcIiByZXByZXNlbnRhdGlvbi5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfbm9ybWFsaXplVGltZXN0YW1wKGUpIHtcbiAgICAvLyBUaGUganNvbiBpbnRlcmZhY2UgKGZvciB0aGUgYnJvd3Nlcikgd2lsbCByZXR1cm4gYW4gaXNvIHRpbWVzdGFtcCBzdHJpbmcsXG4gICAgLy8gd2hpbGUgdGhlIHByb3RvIGpzIGxpYnJhcnkgKGZvciBub2RlKSB3aWxsIHJldHVybiBhXG4gICAgLy8gZ29vZ2xlLnByb3RvYnVmLlRpbWVzdGFtcCBpbnN0YW5jZS5cbiAgICBpZiAoX19QUklWQVRFX2hhcmRBc3NlcnQoISFlLCAzOTAxOCksIFwic3RyaW5nXCIgPT0gdHlwZW9mIGUpIHtcbiAgICAgICAgLy8gVGhlIGRhdGUgc3RyaW5nIGNhbiBoYXZlIGhpZ2hlciBwcmVjaXNpb24gKG5hbm9zKSB0aGFuIHRoZSBEYXRlIGNsYXNzXG4gICAgICAgIC8vIChtaWxsaXMpLCBzbyB3ZSBkbyBzb21lIGN1c3RvbSBwYXJzaW5nIGhlcmUuXG4gICAgICAgIC8vIFBhcnNlIHRoZSBuYW5vcyByaWdodCBvdXQgb2YgdGhlIHN0cmluZy5cbiAgICAgICAgbGV0IHQgPSAwO1xuICAgICAgICBjb25zdCBuID0gb3QuZXhlYyhlKTtcbiAgICAgICAgaWYgKF9fUFJJVkFURV9oYXJkQXNzZXJ0KCEhbiwgNDY1NTgsIHtcbiAgICAgICAgICAgIHRpbWVzdGFtcDogZVxuICAgICAgICB9KSwgblsxXSkge1xuICAgICAgICAgICAgLy8gUGFkIHRoZSBmcmFjdGlvbiBvdXQgdG8gOSBkaWdpdHMgKG5hbm9zKS5cbiAgICAgICAgICAgIGxldCBlID0gblsxXTtcbiAgICAgICAgICAgIGUgPSAoZSArIFwiMDAwMDAwMDAwXCIpLnN1YnN0cigwLCA5KSwgdCA9IE51bWJlcihlKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBQYXJzZSB0aGUgZGF0ZSB0byBnZXQgdGhlIHNlY29uZHMuXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG5ldyBEYXRlKGUpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc2Vjb25kczogTWF0aC5mbG9vcihyLmdldFRpbWUoKSAvIDFlMyksXG4gICAgICAgICAgICBuYW5vczogdFxuICAgICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBzZWNvbmRzOiBfX1BSSVZBVEVfbm9ybWFsaXplTnVtYmVyKGUuc2Vjb25kcyksXG4gICAgICAgIG5hbm9zOiBfX1BSSVZBVEVfbm9ybWFsaXplTnVtYmVyKGUubmFub3MpXG4gICAgfTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyB0aGUgcG9zc2libGUgUHJvdG8gdHlwZXMgZm9yIG51bWJlcnMgaW50byBhIEphdmFTY3JpcHQgbnVtYmVyLlxuICogUmV0dXJucyAwIGlmIHRoZSB2YWx1ZSBpcyBub3QgbnVtZXJpYy5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfbm9ybWFsaXplTnVtYmVyKGUpIHtcbiAgICAvLyBUT0RPKGJqb3JuaWNrKTogSGFuZGxlIGludDY0IGdyZWF0ZXIgdGhhbiA1MyBiaXRzLlxuICAgIHJldHVybiBcIm51bWJlclwiID09IHR5cGVvZiBlID8gZSA6IFwic3RyaW5nXCIgPT0gdHlwZW9mIGUgPyBOdW1iZXIoZSkgOiAwO1xufVxuXG4vKiogQ29udmVydHMgdGhlIHBvc3NpYmxlIFByb3RvIHR5cGVzIGZvciBCbG9icyBpbnRvIGEgQnl0ZVN0cmluZy4gKi8gZnVuY3Rpb24gX19QUklWQVRFX25vcm1hbGl6ZUJ5dGVTdHJpbmcoZSkge1xuICAgIHJldHVybiBcInN0cmluZ1wiID09IHR5cGVvZiBlID8gQnl0ZVN0cmluZy5mcm9tQmFzZTY0U3RyaW5nKGUpIDogQnl0ZVN0cmluZy5mcm9tVWludDhBcnJheShlKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmVwcmVzZW50cyBhIGxvY2FsbHktYXBwbGllZCBTZXJ2ZXJUaW1lc3RhbXAuXG4gKlxuICogU2VydmVyIFRpbWVzdGFtcHMgYXJlIGJhY2tlZCBieSBNYXBWYWx1ZXMgdGhhdCBjb250YWluIGFuIGludGVybmFsIGZpZWxkXG4gKiBgX190eXBlX19gIHdpdGggYSB2YWx1ZSBvZiBgc2VydmVyX3RpbWVzdGFtcGAuIFRoZSBwcmV2aW91cyB2YWx1ZSBhbmQgbG9jYWxcbiAqIHdyaXRlIHRpbWUgYXJlIHN0b3JlZCBpbiBpdHMgYF9fcHJldmlvdXNfdmFsdWVfX2AgYW5kIGBfX2xvY2FsX3dyaXRlX3RpbWVfX2BcbiAqIGZpZWxkcyByZXNwZWN0aXZlbHkuXG4gKlxuICogTm90ZXM6XG4gKiAtIFNlcnZlclRpbWVzdGFtcFZhbHVlIGluc3RhbmNlcyBhcmUgY3JlYXRlZCBhcyB0aGUgcmVzdWx0IG9mIGFwcGx5aW5nIGFcbiAqICAgdHJhbnNmb3JtLiBUaGV5IGNhbiBvbmx5IGV4aXN0IGluIHRoZSBsb2NhbCB2aWV3IG9mIGEgZG9jdW1lbnQuIFRoZXJlZm9yZVxuICogICB0aGV5IGRvIG5vdCBuZWVkIHRvIGJlIHBhcnNlZCBvciBzZXJpYWxpemVkLlxuICogLSBXaGVuIGV2YWx1YXRlZCBsb2NhbGx5IChlLmcuIGZvciBzbmFwc2hvdC5kYXRhKCkpLCB0aGV5IGJ5IGRlZmF1bHRcbiAqICAgZXZhbHVhdGUgdG8gYG51bGxgLiBUaGlzIGJlaGF2aW9yIGNhbiBiZSBjb25maWd1cmVkIGJ5IHBhc3NpbmcgY3VzdG9tXG4gKiAgIEZpZWxkVmFsdWVPcHRpb25zIHRvIHZhbHVlKCkuXG4gKiAtIFdpdGggcmVzcGVjdCB0byBvdGhlciBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZXMsIHRoZXkgc29ydCBieSB0aGVpclxuICogICBsb2NhbFdyaXRlVGltZS5cbiAqLyBjb25zdCBfdCA9IFwic2VydmVyX3RpbWVzdGFtcFwiLCBhdCA9IFwiX190eXBlX19cIiwgdXQgPSBcIl9fcHJldmlvdXNfdmFsdWVfX1wiLCBjdCA9IFwiX19sb2NhbF93cml0ZV90aW1lX19cIjtcblxuZnVuY3Rpb24gX19QUklWQVRFX2lzU2VydmVyVGltZXN0YW1wKGUpIHtcbiAgICBjb25zdCB0ID0gKGU/Lm1hcFZhbHVlPy5maWVsZHMgfHwge30pW2F0XT8uc3RyaW5nVmFsdWU7XG4gICAgcmV0dXJuIHQgPT09IF90O1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgU2VydmVyVGltZXN0YW1wIHByb3RvIHZhbHVlICh1c2luZyB0aGUgaW50ZXJuYWwgZm9ybWF0KS5cbiAqL1xuLyoqXG4gKiBSZXR1cm5zIHRoZSB2YWx1ZSBvZiB0aGUgZmllbGQgYmVmb3JlIHRoaXMgU2VydmVyVGltZXN0YW1wIHdhcyBzZXQuXG4gKlxuICogUHJlc2VydmluZyB0aGUgcHJldmlvdXMgdmFsdWVzIGFsbG93cyB0aGUgdXNlciB0byBkaXNwbGF5IHRoZSBsYXN0IHJlc29sZWRcbiAqIHZhbHVlIHVudGlsIHRoZSBiYWNrZW5kIHJlc3BvbmRzIHdpdGggdGhlIHRpbWVzdGFtcC5cbiAqL1xuZnVuY3Rpb24gX19QUklWQVRFX2dldFByZXZpb3VzVmFsdWUoZSkge1xuICAgIGNvbnN0IHQgPSBlLm1hcFZhbHVlLmZpZWxkc1t1dF07XG4gICAgcmV0dXJuIF9fUFJJVkFURV9pc1NlcnZlclRpbWVzdGFtcCh0KSA/IF9fUFJJVkFURV9nZXRQcmV2aW91c1ZhbHVlKHQpIDogdDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBsb2NhbCB0aW1lIGF0IHdoaWNoIHRoaXMgdGltZXN0YW1wIHdhcyBmaXJzdCBzZXQuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX2dldExvY2FsV3JpdGVUaW1lKGUpIHtcbiAgICBjb25zdCB0ID0gX19QUklWQVRFX25vcm1hbGl6ZVRpbWVzdGFtcChlLm1hcFZhbHVlLmZpZWxkc1tjdF0udGltZXN0YW1wVmFsdWUpO1xuICAgIHJldHVybiBuZXcgVGltZXN0YW1wKHQuc2Vjb25kcywgdC5uYW5vcyk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIERhdGFiYXNlSW5mbyB7XG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0cyBhIERhdGFiYXNlSW5mbyB1c2luZyB0aGUgcHJvdmlkZWQgaG9zdCwgZGF0YWJhc2VJZCBhbmRcbiAgICAgKiBwZXJzaXN0ZW5jZUtleS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkYXRhYmFzZUlkIC0gVGhlIGRhdGFiYXNlIHRvIHVzZS5cbiAgICAgKiBAcGFyYW0gYXBwSWQgLSBUaGUgRmlyZWJhc2UgQXBwIElkLlxuICAgICAqIEBwYXJhbSBwZXJzaXN0ZW5jZUtleSAtIEEgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoaXMgRmlyZXN0b3JlJ3MgbG9jYWxcbiAgICAgKiBzdG9yYWdlICh1c2VkIGluIGNvbmp1bmN0aW9uIHdpdGggdGhlIGRhdGFiYXNlSWQpLlxuICAgICAqIEBwYXJhbSBob3N0IC0gVGhlIEZpcmVzdG9yZSBiYWNrZW5kIGhvc3QgdG8gY29ubmVjdCB0by5cbiAgICAgKiBAcGFyYW0gc3NsIC0gV2hldGhlciB0byB1c2UgU1NMIHdoZW4gY29ubmVjdGluZy5cbiAgICAgKiBAcGFyYW0gZm9yY2VMb25nUG9sbGluZyAtIFdoZXRoZXIgdG8gdXNlIHRoZSBmb3JjZUxvbmdQb2xsaW5nIG9wdGlvblxuICAgICAqIHdoZW4gdXNpbmcgV2ViQ2hhbm5lbCBhcyB0aGUgbmV0d29yayB0cmFuc3BvcnQuXG4gICAgICogQHBhcmFtIGF1dG9EZXRlY3RMb25nUG9sbGluZyAtIFdoZXRoZXIgdG8gdXNlIHRoZSBkZXRlY3RCdWZmZXJpbmdQcm94eVxuICAgICAqIG9wdGlvbiB3aGVuIHVzaW5nIFdlYkNoYW5uZWwgYXMgdGhlIG5ldHdvcmsgdHJhbnNwb3J0LlxuICAgICAqIEBwYXJhbSBsb25nUG9sbGluZ09wdGlvbnMgT3B0aW9ucyB0aGF0IGNvbmZpZ3VyZSBsb25nLXBvbGxpbmcuXG4gICAgICogQHBhcmFtIHVzZUZldGNoU3RyZWFtcyBXaGV0aGVyIHRvIHVzZSB0aGUgRmV0Y2ggQVBJIGluc3RlYWQgb2ZcbiAgICAgKiBYTUxIVFRQUmVxdWVzdFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4sIHIsIGksIHMsIG8sIF8sIGEsIHUpIHtcbiAgICAgICAgdGhpcy5kYXRhYmFzZUlkID0gZSwgdGhpcy5hcHBJZCA9IHQsIHRoaXMucGVyc2lzdGVuY2VLZXkgPSBuLCB0aGlzLmhvc3QgPSByLCB0aGlzLnNzbCA9IGksIFxuICAgICAgICB0aGlzLmZvcmNlTG9uZ1BvbGxpbmcgPSBzLCB0aGlzLmF1dG9EZXRlY3RMb25nUG9sbGluZyA9IG8sIHRoaXMubG9uZ1BvbGxpbmdPcHRpb25zID0gXywgXG4gICAgICAgIHRoaXMudXNlRmV0Y2hTdHJlYW1zID0gYSwgdGhpcy5pc1VzaW5nRW11bGF0b3IgPSB1O1xuICAgIH1cbn1cblxuLyoqIFRoZSBkZWZhdWx0IGRhdGFiYXNlIG5hbWUgZm9yIGEgcHJvamVjdC4gKi8gY29uc3QgbHQgPSBcIihkZWZhdWx0KVwiO1xuXG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIGRhdGFiYXNlIElEIGEgRmlyZXN0b3JlIGNsaWVudCBpcyBhc3NvY2lhdGVkIHdpdGguXG4gKiBAaW50ZXJuYWxcbiAqLyBjbGFzcyBEYXRhYmFzZUlkIHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0KSB7XG4gICAgICAgIHRoaXMucHJvamVjdElkID0gZSwgdGhpcy5kYXRhYmFzZSA9IHQgfHwgbHQ7XG4gICAgfVxuICAgIHN0YXRpYyBlbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRhYmFzZUlkKFwiXCIsIFwiXCIpO1xuICAgIH1cbiAgICBnZXQgaXNEZWZhdWx0RGF0YWJhc2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFiYXNlID09PSBsdDtcbiAgICB9XG4gICAgaXNFcXVhbChlKSB7XG4gICAgICAgIHJldHVybiBlIGluc3RhbmNlb2YgRGF0YWJhc2VJZCAmJiBlLnByb2plY3RJZCA9PT0gdGhpcy5wcm9qZWN0SWQgJiYgZS5kYXRhYmFzZSA9PT0gdGhpcy5kYXRhYmFzZTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jb25zdCBodCA9IFwiX190eXBlX19cIiwgUHQgPSBcIl9fbWF4X19cIiwgVHQgPSB7XG4gICAgbWFwVmFsdWU6IHtcbiAgICAgICAgZmllbGRzOiB7XG4gICAgICAgICAgICBfX3R5cGVfXzoge1xuICAgICAgICAgICAgICAgIHN0cmluZ1ZhbHVlOiBQdFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSwgSXQgPSBcIl9fdmVjdG9yX19cIiwgRXQgPSBcInZhbHVlXCIsIGR0ID0ge1xuICAgIG51bGxWYWx1ZTogXCJOVUxMX1ZBTFVFXCJcbn07XG5cbi8qKiBFeHRyYWN0cyB0aGUgYmFja2VuZCdzIHR5cGUgb3JkZXIgZm9yIHRoZSBwcm92aWRlZCB2YWx1ZS4gKi9cbmZ1bmN0aW9uIF9fUFJJVkFURV90eXBlT3JkZXIoZSkge1xuICAgIHJldHVybiBcIm51bGxWYWx1ZVwiIGluIGUgPyAwIC8qIFR5cGVPcmRlci5OdWxsVmFsdWUgKi8gOiBcImJvb2xlYW5WYWx1ZVwiIGluIGUgPyAxIC8qIFR5cGVPcmRlci5Cb29sZWFuVmFsdWUgKi8gOiBcImludGVnZXJWYWx1ZVwiIGluIGUgfHwgXCJkb3VibGVWYWx1ZVwiIGluIGUgPyAyIC8qIFR5cGVPcmRlci5OdW1iZXJWYWx1ZSAqLyA6IFwidGltZXN0YW1wVmFsdWVcIiBpbiBlID8gMyAvKiBUeXBlT3JkZXIuVGltZXN0YW1wVmFsdWUgKi8gOiBcInN0cmluZ1ZhbHVlXCIgaW4gZSA/IDUgLyogVHlwZU9yZGVyLlN0cmluZ1ZhbHVlICovIDogXCJieXRlc1ZhbHVlXCIgaW4gZSA/IDYgLyogVHlwZU9yZGVyLkJsb2JWYWx1ZSAqLyA6IFwicmVmZXJlbmNlVmFsdWVcIiBpbiBlID8gNyAvKiBUeXBlT3JkZXIuUmVmVmFsdWUgKi8gOiBcImdlb1BvaW50VmFsdWVcIiBpbiBlID8gOCAvKiBUeXBlT3JkZXIuR2VvUG9pbnRWYWx1ZSAqLyA6IFwiYXJyYXlWYWx1ZVwiIGluIGUgPyA5IC8qIFR5cGVPcmRlci5BcnJheVZhbHVlICovIDogXCJtYXBWYWx1ZVwiIGluIGUgPyBfX1BSSVZBVEVfaXNTZXJ2ZXJUaW1lc3RhbXAoZSkgPyA0IC8qIFR5cGVPcmRlci5TZXJ2ZXJUaW1lc3RhbXBWYWx1ZSAqLyA6IF9fUFJJVkFURV9pc01heFZhbHVlKGUpID8gOTAwNzE5OTI1NDc0MDk5MSAvKiBUeXBlT3JkZXIuTWF4VmFsdWUgKi8gOiBfX1BSSVZBVEVfaXNWZWN0b3JWYWx1ZShlKSA/IDEwIC8qIFR5cGVPcmRlci5WZWN0b3JWYWx1ZSAqLyA6IDExIC8qIFR5cGVPcmRlci5PYmplY3RWYWx1ZSAqLyA6IGZhaWwoMjgyOTUsIHtcbiAgICAgICAgdmFsdWU6IGVcbiAgICB9KTtcbn1cblxuLyoqIFRlc3RzIGBsZWZ0YCBhbmQgYHJpZ2h0YCBmb3IgZXF1YWxpdHkgYmFzZWQgb24gdGhlIGJhY2tlbmQgc2VtYW50aWNzLiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfdmFsdWVFcXVhbHMoZSwgdCkge1xuICAgIGlmIChlID09PSB0KSByZXR1cm4gITA7XG4gICAgY29uc3QgbiA9IF9fUFJJVkFURV90eXBlT3JkZXIoZSk7XG4gICAgaWYgKG4gIT09IF9fUFJJVkFURV90eXBlT3JkZXIodCkpIHJldHVybiAhMTtcbiAgICBzd2l0Y2ggKG4pIHtcbiAgICAgIGNhc2UgMCAvKiBUeXBlT3JkZXIuTnVsbFZhbHVlICovIDpcbiAgICAgIGNhc2UgOTAwNzE5OTI1NDc0MDk5MSAvKiBUeXBlT3JkZXIuTWF4VmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gITA7XG5cbiAgICAgIGNhc2UgMSAvKiBUeXBlT3JkZXIuQm9vbGVhblZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGUuYm9vbGVhblZhbHVlID09PSB0LmJvb2xlYW5WYWx1ZTtcblxuICAgICAgY2FzZSA0IC8qIFR5cGVPcmRlci5TZXJ2ZXJUaW1lc3RhbXBWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfZ2V0TG9jYWxXcml0ZVRpbWUoZSkuaXNFcXVhbChfX1BSSVZBVEVfZ2V0TG9jYWxXcml0ZVRpbWUodCkpO1xuXG4gICAgICBjYXNlIDMgLyogVHlwZU9yZGVyLlRpbWVzdGFtcFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIF9fUFJJVkFURV90aW1lc3RhbXBFcXVhbHMoZSwgdCkge1xuICAgICAgICAgICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIGUudGltZXN0YW1wVmFsdWUgJiYgXCJzdHJpbmdcIiA9PSB0eXBlb2YgdC50aW1lc3RhbXBWYWx1ZSAmJiBlLnRpbWVzdGFtcFZhbHVlLmxlbmd0aCA9PT0gdC50aW1lc3RhbXBWYWx1ZS5sZW5ndGgpIFxuICAgICAgICAgICAgLy8gVXNlIHN0cmluZyBlcXVhbGl0eSBmb3IgSVNPIDg2MDEgdGltZXN0YW1wc1xuICAgICAgICAgICAgcmV0dXJuIGUudGltZXN0YW1wVmFsdWUgPT09IHQudGltZXN0YW1wVmFsdWU7XG4gICAgICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX25vcm1hbGl6ZVRpbWVzdGFtcChlLnRpbWVzdGFtcFZhbHVlKSwgciA9IF9fUFJJVkFURV9ub3JtYWxpemVUaW1lc3RhbXAodC50aW1lc3RhbXBWYWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gbi5zZWNvbmRzID09PSByLnNlY29uZHMgJiYgbi5uYW5vcyA9PT0gci5uYW5vcztcbiAgICAgICAgfShlLCB0KTtcblxuICAgICAgY2FzZSA1IC8qIFR5cGVPcmRlci5TdHJpbmdWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBlLnN0cmluZ1ZhbHVlID09PSB0LnN0cmluZ1ZhbHVlO1xuXG4gICAgICBjYXNlIDYgLyogVHlwZU9yZGVyLkJsb2JWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBfX1BSSVZBVEVfYmxvYkVxdWFscyhlLCB0KSB7XG4gICAgICAgICAgICByZXR1cm4gX19QUklWQVRFX25vcm1hbGl6ZUJ5dGVTdHJpbmcoZS5ieXRlc1ZhbHVlKS5pc0VxdWFsKF9fUFJJVkFURV9ub3JtYWxpemVCeXRlU3RyaW5nKHQuYnl0ZXNWYWx1ZSkpO1xuICAgICAgICB9KGUsIHQpO1xuXG4gICAgICBjYXNlIDcgLyogVHlwZU9yZGVyLlJlZlZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGUucmVmZXJlbmNlVmFsdWUgPT09IHQucmVmZXJlbmNlVmFsdWU7XG5cbiAgICAgIGNhc2UgOCAvKiBUeXBlT3JkZXIuR2VvUG9pbnRWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBfX1BSSVZBVEVfZ2VvUG9pbnRFcXVhbHMoZSwgdCkge1xuICAgICAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9ub3JtYWxpemVOdW1iZXIoZS5nZW9Qb2ludFZhbHVlLmxhdGl0dWRlKSA9PT0gX19QUklWQVRFX25vcm1hbGl6ZU51bWJlcih0Lmdlb1BvaW50VmFsdWUubGF0aXR1ZGUpICYmIF9fUFJJVkFURV9ub3JtYWxpemVOdW1iZXIoZS5nZW9Qb2ludFZhbHVlLmxvbmdpdHVkZSkgPT09IF9fUFJJVkFURV9ub3JtYWxpemVOdW1iZXIodC5nZW9Qb2ludFZhbHVlLmxvbmdpdHVkZSk7XG4gICAgICAgIH0oZSwgdCk7XG5cbiAgICAgIGNhc2UgMiAvKiBUeXBlT3JkZXIuTnVtYmVyVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX251bWJlckVxdWFscyhlLCB0KSB7XG4gICAgICAgICAgICBpZiAoXCJpbnRlZ2VyVmFsdWVcIiBpbiBlICYmIFwiaW50ZWdlclZhbHVlXCIgaW4gdCkgcmV0dXJuIF9fUFJJVkFURV9ub3JtYWxpemVOdW1iZXIoZS5pbnRlZ2VyVmFsdWUpID09PSBfX1BSSVZBVEVfbm9ybWFsaXplTnVtYmVyKHQuaW50ZWdlclZhbHVlKTtcbiAgICAgICAgICAgIGlmIChcImRvdWJsZVZhbHVlXCIgaW4gZSAmJiBcImRvdWJsZVZhbHVlXCIgaW4gdCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfbm9ybWFsaXplTnVtYmVyKGUuZG91YmxlVmFsdWUpLCByID0gX19QUklWQVRFX25vcm1hbGl6ZU51bWJlcih0LmRvdWJsZVZhbHVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbiA9PT0gciA/IF9fUFJJVkFURV9pc05lZ2F0aXZlWmVybyhuKSA9PT0gX19QUklWQVRFX2lzTmVnYXRpdmVaZXJvKHIpIDogaXNOYU4obikgJiYgaXNOYU4ocik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gITE7XG4gICAgICAgIH0oZSwgdCk7XG5cbiAgICAgIGNhc2UgOSAvKiBUeXBlT3JkZXIuQXJyYXlWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfYXJyYXlFcXVhbHMoZS5hcnJheVZhbHVlLnZhbHVlcyB8fCBbXSwgdC5hcnJheVZhbHVlLnZhbHVlcyB8fCBbXSwgX19QUklWQVRFX3ZhbHVlRXF1YWxzKTtcblxuICAgICAgY2FzZSAxMCAvKiBUeXBlT3JkZXIuVmVjdG9yVmFsdWUgKi8gOlxuICAgICAgY2FzZSAxMSAvKiBUeXBlT3JkZXIuT2JqZWN0VmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX29iamVjdEVxdWFscyhlLCB0KSB7XG4gICAgICAgICAgICBjb25zdCBuID0gZS5tYXBWYWx1ZS5maWVsZHMgfHwge30sIHIgPSB0Lm1hcFZhbHVlLmZpZWxkcyB8fCB7fTtcbiAgICAgICAgICAgIGlmIChfX1BSSVZBVEVfb2JqZWN0U2l6ZShuKSAhPT0gX19QUklWQVRFX29iamVjdFNpemUocikpIHJldHVybiAhMTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZSBpbiBuKSBpZiAobi5oYXNPd25Qcm9wZXJ0eShlKSAmJiAodm9pZCAwID09PSByW2VdIHx8ICFfX1BSSVZBVEVfdmFsdWVFcXVhbHMobltlXSwgcltlXSkpKSByZXR1cm4gITE7XG4gICAgICAgICAgICByZXR1cm4gITA7XG4gICAgICAgIH1cbiAgICAgICAgLyoqIFJldHVybnMgdHJ1ZSBpZiB0aGUgQXJyYXlWYWx1ZSBjb250YWlucyB0aGUgc3BlY2lmaWVkIGVsZW1lbnQuICovIChlLCB0KTtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIGZhaWwoNTIyMTYsIHtcbiAgICAgICAgICAgIGxlZnQ6IGVcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfYXJyYXlWYWx1ZUNvbnRhaW5zKGUsIHQpIHtcbiAgICByZXR1cm4gdm9pZCAwICE9PSAoZS52YWx1ZXMgfHwgW10pLmZpbmQoKGUgPT4gX19QUklWQVRFX3ZhbHVlRXF1YWxzKGUsIHQpKSk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV92YWx1ZUNvbXBhcmUoZSwgdCkge1xuICAgIGlmIChlID09PSB0KSByZXR1cm4gMDtcbiAgICBjb25zdCBuID0gX19QUklWQVRFX3R5cGVPcmRlcihlKSwgciA9IF9fUFJJVkFURV90eXBlT3JkZXIodCk7XG4gICAgaWYgKG4gIT09IHIpIHJldHVybiBfX1BSSVZBVEVfcHJpbWl0aXZlQ29tcGFyYXRvcihuLCByKTtcbiAgICBzd2l0Y2ggKG4pIHtcbiAgICAgIGNhc2UgMCAvKiBUeXBlT3JkZXIuTnVsbFZhbHVlICovIDpcbiAgICAgIGNhc2UgOTAwNzE5OTI1NDc0MDk5MSAvKiBUeXBlT3JkZXIuTWF4VmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gMDtcblxuICAgICAgY2FzZSAxIC8qIFR5cGVPcmRlci5Cb29sZWFuVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IoZS5ib29sZWFuVmFsdWUsIHQuYm9vbGVhblZhbHVlKTtcblxuICAgICAgY2FzZSAyIC8qIFR5cGVPcmRlci5OdW1iZXJWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBfX1BSSVZBVEVfY29tcGFyZU51bWJlcnMoZSwgdCkge1xuICAgICAgICAgICAgY29uc3QgbiA9IF9fUFJJVkFURV9ub3JtYWxpemVOdW1iZXIoZS5pbnRlZ2VyVmFsdWUgfHwgZS5kb3VibGVWYWx1ZSksIHIgPSBfX1BSSVZBVEVfbm9ybWFsaXplTnVtYmVyKHQuaW50ZWdlclZhbHVlIHx8IHQuZG91YmxlVmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIG4gPCByID8gLTEgOiBuID4gciA/IDEgOiBuID09PSByID8gMCA6IFxuICAgICAgICAgICAgLy8gb25lIG9yIGJvdGggYXJlIE5hTi5cbiAgICAgICAgICAgIGlzTmFOKG4pID8gaXNOYU4ocikgPyAwIDogLTEgOiAxO1xuICAgICAgICB9KGUsIHQpO1xuXG4gICAgICBjYXNlIDMgLyogVHlwZU9yZGVyLlRpbWVzdGFtcFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9jb21wYXJlVGltZXN0YW1wcyhlLnRpbWVzdGFtcFZhbHVlLCB0LnRpbWVzdGFtcFZhbHVlKTtcblxuICAgICAgY2FzZSA0IC8qIFR5cGVPcmRlci5TZXJ2ZXJUaW1lc3RhbXBWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfY29tcGFyZVRpbWVzdGFtcHMoX19QUklWQVRFX2dldExvY2FsV3JpdGVUaW1lKGUpLCBfX1BSSVZBVEVfZ2V0TG9jYWxXcml0ZVRpbWUodCkpO1xuXG4gICAgICBjYXNlIDUgLyogVHlwZU9yZGVyLlN0cmluZ1ZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9jb21wYXJlVXRmOFN0cmluZ3MoZS5zdHJpbmdWYWx1ZSwgdC5zdHJpbmdWYWx1ZSk7XG5cbiAgICAgIGNhc2UgNiAvKiBUeXBlT3JkZXIuQmxvYlZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIF9fUFJJVkFURV9jb21wYXJlQmxvYnMoZSwgdCkge1xuICAgICAgICAgICAgY29uc3QgbiA9IF9fUFJJVkFURV9ub3JtYWxpemVCeXRlU3RyaW5nKGUpLCByID0gX19QUklWQVRFX25vcm1hbGl6ZUJ5dGVTdHJpbmcodCk7XG4gICAgICAgICAgICByZXR1cm4gbi5jb21wYXJlVG8ocik7XG4gICAgICAgIH0oZS5ieXRlc1ZhbHVlLCB0LmJ5dGVzVmFsdWUpO1xuXG4gICAgICBjYXNlIDcgLyogVHlwZU9yZGVyLlJlZlZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIF9fUFJJVkFURV9jb21wYXJlUmVmZXJlbmNlcyhlLCB0KSB7XG4gICAgICAgICAgICBjb25zdCBuID0gZS5zcGxpdChcIi9cIiksIHIgPSB0LnNwbGl0KFwiL1wiKTtcbiAgICAgICAgICAgIGZvciAobGV0IGUgPSAwOyBlIDwgbi5sZW5ndGggJiYgZSA8IHIubGVuZ3RoOyBlKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IobltlXSwgcltlXSk7XG4gICAgICAgICAgICAgICAgaWYgKDAgIT09IHQpIHJldHVybiB0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9wcmltaXRpdmVDb21wYXJhdG9yKG4ubGVuZ3RoLCByLmxlbmd0aCk7XG4gICAgICAgIH0oZS5yZWZlcmVuY2VWYWx1ZSwgdC5yZWZlcmVuY2VWYWx1ZSk7XG5cbiAgICAgIGNhc2UgOCAvKiBUeXBlT3JkZXIuR2VvUG9pbnRWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBfX1BSSVZBVEVfY29tcGFyZUdlb1BvaW50cyhlLCB0KSB7XG4gICAgICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IoX19QUklWQVRFX25vcm1hbGl6ZU51bWJlcihlLmxhdGl0dWRlKSwgX19QUklWQVRFX25vcm1hbGl6ZU51bWJlcih0LmxhdGl0dWRlKSk7XG4gICAgICAgICAgICBpZiAoMCAhPT0gbikgcmV0dXJuIG47XG4gICAgICAgICAgICByZXR1cm4gX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IoX19QUklWQVRFX25vcm1hbGl6ZU51bWJlcihlLmxvbmdpdHVkZSksIF9fUFJJVkFURV9ub3JtYWxpemVOdW1iZXIodC5sb25naXR1ZGUpKTtcbiAgICAgICAgfShlLmdlb1BvaW50VmFsdWUsIHQuZ2VvUG9pbnRWYWx1ZSk7XG5cbiAgICAgIGNhc2UgOSAvKiBUeXBlT3JkZXIuQXJyYXlWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfY29tcGFyZUFycmF5cyhlLmFycmF5VmFsdWUsIHQuYXJyYXlWYWx1ZSk7XG5cbiAgICAgIGNhc2UgMTAgLyogVHlwZU9yZGVyLlZlY3RvclZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIF9fUFJJVkFURV9jb21wYXJlVmVjdG9ycyhlLCB0KSB7XG4gICAgICAgICAgICBjb25zdCBuID0gZS5maWVsZHMgfHwge30sIHIgPSB0LmZpZWxkcyB8fCB7fSwgaSA9IG5bRXRdPy5hcnJheVZhbHVlLCBzID0gcltFdF0/LmFycmF5VmFsdWUsIG8gPSBfX1BSSVZBVEVfcHJpbWl0aXZlQ29tcGFyYXRvcihpPy52YWx1ZXM/Lmxlbmd0aCB8fCAwLCBzPy52YWx1ZXM/Lmxlbmd0aCB8fCAwKTtcbiAgICAgICAgICAgIGlmICgwICE9PSBvKSByZXR1cm4gbztcbiAgICAgICAgICAgIHJldHVybiBfX1BSSVZBVEVfY29tcGFyZUFycmF5cyhpLCBzKTtcbiAgICAgICAgfShlLm1hcFZhbHVlLCB0Lm1hcFZhbHVlKTtcblxuICAgICAgY2FzZSAxMSAvKiBUeXBlT3JkZXIuT2JqZWN0VmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX2NvbXBhcmVNYXBzKGUsIHQpIHtcbiAgICAgICAgICAgIGlmIChlID09PSBUdC5tYXBWYWx1ZSAmJiB0ID09PSBUdC5tYXBWYWx1ZSkgcmV0dXJuIDA7XG4gICAgICAgICAgICBpZiAoZSA9PT0gVHQubWFwVmFsdWUpIHJldHVybiAxO1xuICAgICAgICAgICAgaWYgKHQgPT09IFR0Lm1hcFZhbHVlKSByZXR1cm4gLTE7XG4gICAgICAgICAgICBjb25zdCBuID0gZS5maWVsZHMgfHwge30sIHIgPSBPYmplY3Qua2V5cyhuKSwgaSA9IHQuZmllbGRzIHx8IHt9LCBzID0gT2JqZWN0LmtleXMoaSk7XG4gICAgICAgICAgICAvLyBFdmVuIHRob3VnaCBNYXBWYWx1ZXMgYXJlIGxpa2VseSBzb3J0ZWQgY29ycmVjdGx5IGJhc2VkIG9uIHRoZWlyIGluc2VydGlvblxuICAgICAgICAgICAgLy8gb3JkZXIgKGUuZy4gd2hlbiByZWNlaXZlZCBmcm9tIHRoZSBiYWNrZW5kKSwgbG9jYWwgbW9kaWZpY2F0aW9ucyBjYW4gYnJpbmdcbiAgICAgICAgICAgIC8vIGVsZW1lbnRzIG91dCBvZiBvcmRlci4gV2UgbmVlZCB0byByZS1zb3J0IHRoZSBlbGVtZW50cyB0byBlbnN1cmUgdGhhdFxuICAgICAgICAgICAgLy8gY2Fub25pY2FsIElEcyBhcmUgaW5kZXBlbmRlbnQgb2YgaW5zZXJ0aW9uIG9yZGVyLlxuICAgICAgICAgICAgci5zb3J0KCksIHMuc29ydCgpO1xuICAgICAgICAgICAgZm9yIChsZXQgZSA9IDA7IGUgPCByLmxlbmd0aCAmJiBlIDwgcy5sZW5ndGg7ICsrZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBfX1BSSVZBVEVfY29tcGFyZVV0ZjhTdHJpbmdzKHJbZV0sIHNbZV0pO1xuICAgICAgICAgICAgICAgIGlmICgwICE9PSB0KSByZXR1cm4gdDtcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gX19QUklWQVRFX3ZhbHVlQ29tcGFyZShuW3JbZV1dLCBpW3NbZV1dKTtcbiAgICAgICAgICAgICAgICBpZiAoMCAhPT0gbykgcmV0dXJuIG87XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3Ioci5sZW5ndGgsIHMubGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIEdlbmVyYXRlcyB0aGUgY2Fub25pY2FsIElEIGZvciB0aGUgcHJvdmlkZWQgZmllbGQgdmFsdWUgKGFzIHVzZWQgaW4gVGFyZ2V0XG4gKiBzZXJpYWxpemF0aW9uKS5cbiAqLyAoZS5tYXBWYWx1ZSwgdC5tYXBWYWx1ZSk7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IGZhaWwoMjMyNjQsIHtcbiAgICAgICAgICAgIGhlOiBuXG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2NvbXBhcmVUaW1lc3RhbXBzKGUsIHQpIHtcbiAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgZSAmJiBcInN0cmluZ1wiID09IHR5cGVvZiB0ICYmIGUubGVuZ3RoID09PSB0Lmxlbmd0aCkgcmV0dXJuIF9fUFJJVkFURV9wcmltaXRpdmVDb21wYXJhdG9yKGUsIHQpO1xuICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfbm9ybWFsaXplVGltZXN0YW1wKGUpLCByID0gX19QUklWQVRFX25vcm1hbGl6ZVRpbWVzdGFtcCh0KSwgaSA9IF9fUFJJVkFURV9wcmltaXRpdmVDb21wYXJhdG9yKG4uc2Vjb25kcywgci5zZWNvbmRzKTtcbiAgICByZXR1cm4gMCAhPT0gaSA/IGkgOiBfX1BSSVZBVEVfcHJpbWl0aXZlQ29tcGFyYXRvcihuLm5hbm9zLCByLm5hbm9zKTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2NvbXBhcmVBcnJheXMoZSwgdCkge1xuICAgIGNvbnN0IG4gPSBlLnZhbHVlcyB8fCBbXSwgciA9IHQudmFsdWVzIHx8IFtdO1xuICAgIGZvciAobGV0IGUgPSAwOyBlIDwgbi5sZW5ndGggJiYgZSA8IHIubGVuZ3RoOyArK2UpIHtcbiAgICAgICAgY29uc3QgdCA9IF9fUFJJVkFURV92YWx1ZUNvbXBhcmUobltlXSwgcltlXSk7XG4gICAgICAgIGlmICh0KSByZXR1cm4gdDtcbiAgICB9XG4gICAgcmV0dXJuIF9fUFJJVkFURV9wcmltaXRpdmVDb21wYXJhdG9yKG4ubGVuZ3RoLCByLmxlbmd0aCk7XG59XG5cbmZ1bmN0aW9uIGNhbm9uaWNhbElkKGUpIHtcbiAgICByZXR1cm4gX19QUklWQVRFX2Nhbm9uaWZ5VmFsdWUoZSk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9jYW5vbmlmeVZhbHVlKGUpIHtcbiAgICByZXR1cm4gXCJudWxsVmFsdWVcIiBpbiBlID8gXCJudWxsXCIgOiBcImJvb2xlYW5WYWx1ZVwiIGluIGUgPyBcIlwiICsgZS5ib29sZWFuVmFsdWUgOiBcImludGVnZXJWYWx1ZVwiIGluIGUgPyBcIlwiICsgZS5pbnRlZ2VyVmFsdWUgOiBcImRvdWJsZVZhbHVlXCIgaW4gZSA/IFwiXCIgKyBlLmRvdWJsZVZhbHVlIDogXCJ0aW1lc3RhbXBWYWx1ZVwiIGluIGUgPyBmdW5jdGlvbiBfX1BSSVZBVEVfY2Fub25pZnlUaW1lc3RhbXAoZSkge1xuICAgICAgICBjb25zdCB0ID0gX19QUklWQVRFX25vcm1hbGl6ZVRpbWVzdGFtcChlKTtcbiAgICAgICAgcmV0dXJuIGB0aW1lKCR7dC5zZWNvbmRzfSwke3QubmFub3N9KWA7XG4gICAgfShlLnRpbWVzdGFtcFZhbHVlKSA6IFwic3RyaW5nVmFsdWVcIiBpbiBlID8gZS5zdHJpbmdWYWx1ZSA6IFwiYnl0ZXNWYWx1ZVwiIGluIGUgPyBmdW5jdGlvbiBfX1BSSVZBVEVfY2Fub25pZnlCeXRlU3RyaW5nKGUpIHtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9ub3JtYWxpemVCeXRlU3RyaW5nKGUpLnRvQmFzZTY0KCk7XG4gICAgfShlLmJ5dGVzVmFsdWUpIDogXCJyZWZlcmVuY2VWYWx1ZVwiIGluIGUgPyBmdW5jdGlvbiBfX1BSSVZBVEVfY2Fub25pZnlSZWZlcmVuY2UoZSkge1xuICAgICAgICByZXR1cm4gRG9jdW1lbnRLZXkuZnJvbU5hbWUoZSkudG9TdHJpbmcoKTtcbiAgICB9KGUucmVmZXJlbmNlVmFsdWUpIDogXCJnZW9Qb2ludFZhbHVlXCIgaW4gZSA/IGZ1bmN0aW9uIF9fUFJJVkFURV9jYW5vbmlmeUdlb1BvaW50KGUpIHtcbiAgICAgICAgcmV0dXJuIGBnZW8oJHtlLmxhdGl0dWRlfSwke2UubG9uZ2l0dWRlfSlgO1xuICAgIH0oZS5nZW9Qb2ludFZhbHVlKSA6IFwiYXJyYXlWYWx1ZVwiIGluIGUgPyBmdW5jdGlvbiBfX1BSSVZBVEVfY2Fub25pZnlBcnJheShlKSB7XG4gICAgICAgIGxldCB0ID0gXCJbXCIsIG4gPSAhMDtcbiAgICAgICAgZm9yIChjb25zdCByIG9mIGUudmFsdWVzIHx8IFtdKSBuID8gbiA9ICExIDogdCArPSBcIixcIiwgdCArPSBfX1BSSVZBVEVfY2Fub25pZnlWYWx1ZShyKTtcbiAgICAgICAgcmV0dXJuIHQgKyBcIl1cIjtcbiAgICB9XG4gICAgLyoqXG4gKiBSZXR1cm5zIGFuIGFwcHJveGltYXRlIChhbmQgd2lsZGx5IGluYWNjdXJhdGUpIGluLW1lbW9yeSBzaXplIGZvciB0aGUgZmllbGRcbiAqIHZhbHVlLlxuICpcbiAqIFRoZSBtZW1vcnkgc2l6ZSB0YWtlcyBpbnRvIGFjY291bnQgb25seSB0aGUgYWN0dWFsIHVzZXIgZGF0YSBhcyBpdCByZXNpZGVzXG4gKiBpbiBtZW1vcnkgYW5kIGlnbm9yZXMgb2JqZWN0IG92ZXJoZWFkLlxuICovIChlLmFycmF5VmFsdWUpIDogXCJtYXBWYWx1ZVwiIGluIGUgPyBmdW5jdGlvbiBfX1BSSVZBVEVfY2Fub25pZnlNYXAoZSkge1xuICAgICAgICAvLyBJdGVyYXRpb24gb3JkZXIgaW4gSmF2YVNjcmlwdCBpcyBub3QgZ3VhcmFudGVlZC4gVG8gZW5zdXJlIHRoYXQgd2UgZ2VuZXJhdGVcbiAgICAgICAgLy8gbWF0Y2hpbmcgY2Fub25pY2FsIElEcyBmb3IgaWRlbnRpY2FsIG1hcHMsIHdlIG5lZWQgdG8gc29ydCB0aGUga2V5cy5cbiAgICAgICAgY29uc3QgdCA9IE9iamVjdC5rZXlzKGUuZmllbGRzIHx8IHt9KS5zb3J0KCk7XG4gICAgICAgIGxldCBuID0gXCJ7XCIsIHIgPSAhMDtcbiAgICAgICAgZm9yIChjb25zdCBpIG9mIHQpIHIgPyByID0gITEgOiBuICs9IFwiLFwiLCBuICs9IGAke2l9OiR7X19QUklWQVRFX2Nhbm9uaWZ5VmFsdWUoZS5maWVsZHNbaV0pfWA7XG4gICAgICAgIHJldHVybiBuICsgXCJ9XCI7XG4gICAgfShlLm1hcFZhbHVlKSA6IGZhaWwoNjEwMDUsIHtcbiAgICAgICAgdmFsdWU6IGVcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2VzdGltYXRlQnl0ZVNpemUoZSkge1xuICAgIHN3aXRjaCAoX19QUklWQVRFX3R5cGVPcmRlcihlKSkge1xuICAgICAgY2FzZSAwIC8qIFR5cGVPcmRlci5OdWxsVmFsdWUgKi8gOlxuICAgICAgY2FzZSAxIC8qIFR5cGVPcmRlci5Cb29sZWFuVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gNDtcblxuICAgICAgY2FzZSAyIC8qIFR5cGVPcmRlci5OdW1iZXJWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiA4O1xuXG4gICAgICBjYXNlIDMgLyogVHlwZU9yZGVyLlRpbWVzdGFtcFZhbHVlICovIDpcbiAgICAgIGNhc2UgOCAvKiBUeXBlT3JkZXIuR2VvUG9pbnRWYWx1ZSAqLyA6XG4gICAgICAgIC8vIEdlb1BvaW50cyBhcmUgbWFkZSB1cCBvZiB0d28gZGlzdGluY3QgbnVtYmVycyAobGF0aXR1ZGUgKyBsb25naXR1ZGUpXG4gICAgICAgIHJldHVybiAxNjtcblxuICAgICAgY2FzZSA0IC8qIFR5cGVPcmRlci5TZXJ2ZXJUaW1lc3RhbXBWYWx1ZSAqLyA6XG4gICAgICAgIGNvbnN0IHQgPSBfX1BSSVZBVEVfZ2V0UHJldmlvdXNWYWx1ZShlKTtcbiAgICAgICAgcmV0dXJuIHQgPyAxNiArIF9fUFJJVkFURV9lc3RpbWF0ZUJ5dGVTaXplKHQpIDogMTY7XG5cbiAgICAgIGNhc2UgNSAvKiBUeXBlT3JkZXIuU3RyaW5nVmFsdWUgKi8gOlxuICAgICAgICAvLyBTZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9EYXRhX3N0cnVjdHVyZXM6XG4gICAgICAgIC8vIFwiSmF2YVNjcmlwdCdzIFN0cmluZyB0eXBlIGlzIFsuLi5dIGEgc2V0IG9mIGVsZW1lbnRzIG9mIDE2LWJpdCB1bnNpZ25lZFxuICAgICAgICAvLyBpbnRlZ2VyIHZhbHVlc1wiXG4gICAgICAgIHJldHVybiAyICogZS5zdHJpbmdWYWx1ZS5sZW5ndGg7XG5cbiAgICAgIGNhc2UgNiAvKiBUeXBlT3JkZXIuQmxvYlZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9ub3JtYWxpemVCeXRlU3RyaW5nKGUuYnl0ZXNWYWx1ZSkuYXBwcm94aW1hdGVCeXRlU2l6ZSgpO1xuXG4gICAgICBjYXNlIDcgLyogVHlwZU9yZGVyLlJlZlZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGUucmVmZXJlbmNlVmFsdWUubGVuZ3RoO1xuXG4gICAgICBjYXNlIDkgLyogVHlwZU9yZGVyLkFycmF5VmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX2VzdGltYXRlQXJyYXlCeXRlU2l6ZShlKSB7XG4gICAgICAgICAgICByZXR1cm4gKGUudmFsdWVzIHx8IFtdKS5yZWR1Y2UoKChlLCB0KSA9PiBlICsgX19QUklWQVRFX2VzdGltYXRlQnl0ZVNpemUodCkpLCAwKTtcbiAgICAgICAgfVxuICAgICAgICAvKiogUmV0dXJucyBhIHJlZmVyZW5jZSB2YWx1ZSBmb3IgdGhlIHByb3ZpZGVkIGRhdGFiYXNlIGFuZCBrZXkuICovIChlLmFycmF5VmFsdWUpO1xuXG4gICAgICBjYXNlIDEwIC8qIFR5cGVPcmRlci5WZWN0b3JWYWx1ZSAqLyA6XG4gICAgICBjYXNlIDExIC8qIFR5cGVPcmRlci5PYmplY3RWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBfX1BSSVZBVEVfZXN0aW1hdGVNYXBCeXRlU2l6ZShlKSB7XG4gICAgICAgICAgICBsZXQgdCA9IDA7XG4gICAgICAgICAgICByZXR1cm4gZm9yRWFjaChlLmZpZWxkcywgKChlLCBuKSA9PiB7XG4gICAgICAgICAgICAgICAgdCArPSBlLmxlbmd0aCArIF9fUFJJVkFURV9lc3RpbWF0ZUJ5dGVTaXplKG4pO1xuICAgICAgICAgICAgfSkpLCB0O1xuICAgICAgICB9KGUubWFwVmFsdWUpO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBmYWlsKDEzNDg2LCB7XG4gICAgICAgICAgICB2YWx1ZTogZVxuICAgICAgICB9KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9yZWZWYWx1ZShlLCB0KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVmZXJlbmNlVmFsdWU6IGBwcm9qZWN0cy8ke2UucHJvamVjdElkfS9kYXRhYmFzZXMvJHtlLmRhdGFiYXNlfS9kb2N1bWVudHMvJHt0LnBhdGguY2Fub25pY2FsU3RyaW5nKCl9YFxuICAgIH07XG59XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgYHZhbHVlYCBpcyBhbiBJbnRlZ2VyVmFsdWUgLiAqLyBmdW5jdGlvbiBpc0ludGVnZXIoZSkge1xuICAgIHJldHVybiAhIWUgJiYgXCJpbnRlZ2VyVmFsdWVcIiBpbiBlO1xufVxuXG4vKiogUmV0dXJucyB0cnVlIGlmIGB2YWx1ZWAgaXMgYSBEb3VibGVWYWx1ZS4gKi9cbi8qKiBSZXR1cm5zIHRydWUgaWYgYHZhbHVlYCBpcyBhbiBBcnJheVZhbHVlLiAqL1xuZnVuY3Rpb24gaXNBcnJheShlKSB7XG4gICAgcmV0dXJuICEhZSAmJiBcImFycmF5VmFsdWVcIiBpbiBlO1xufVxuXG4vKiogUmV0dXJucyB0cnVlIGlmIGB2YWx1ZWAgaXMgYSBOdWxsVmFsdWUuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9pc051bGxWYWx1ZShlKSB7XG4gICAgcmV0dXJuICEhZSAmJiBcIm51bGxWYWx1ZVwiIGluIGU7XG59XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgYHZhbHVlYCBpcyBOYU4uICovIGZ1bmN0aW9uIF9fUFJJVkFURV9pc05hblZhbHVlKGUpIHtcbiAgICByZXR1cm4gISFlICYmIFwiZG91YmxlVmFsdWVcIiBpbiBlICYmIGlzTmFOKE51bWJlcihlLmRvdWJsZVZhbHVlKSk7XG59XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgYHZhbHVlYCBpcyBhIE1hcFZhbHVlLiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfaXNNYXBWYWx1ZShlKSB7XG4gICAgcmV0dXJuICEhZSAmJiBcIm1hcFZhbHVlXCIgaW4gZTtcbn1cblxuLyoqIFJldHVybnMgdHJ1ZSBpZiBgdmFsdWVgIGlzIGEgVmV0b3JWYWx1ZS4gKi8gZnVuY3Rpb24gX19QUklWQVRFX2lzVmVjdG9yVmFsdWUoZSkge1xuICAgIGNvbnN0IHQgPSAoZT8ubWFwVmFsdWU/LmZpZWxkcyB8fCB7fSlbaHRdPy5zdHJpbmdWYWx1ZTtcbiAgICByZXR1cm4gdCA9PT0gSXQ7XG59XG5cbi8qKiBDcmVhdGVzIGEgZGVlcCBjb3B5IG9mIGBzb3VyY2VgLiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfZGVlcENsb25lKGUpIHtcbiAgICBpZiAoZS5nZW9Qb2ludFZhbHVlKSByZXR1cm4ge1xuICAgICAgICBnZW9Qb2ludFZhbHVlOiB7XG4gICAgICAgICAgICAuLi5lLmdlb1BvaW50VmFsdWVcbiAgICAgICAgfVxuICAgIH07XG4gICAgaWYgKGUudGltZXN0YW1wVmFsdWUgJiYgXCJvYmplY3RcIiA9PSB0eXBlb2YgZS50aW1lc3RhbXBWYWx1ZSkgcmV0dXJuIHtcbiAgICAgICAgdGltZXN0YW1wVmFsdWU6IHtcbiAgICAgICAgICAgIC4uLmUudGltZXN0YW1wVmFsdWVcbiAgICAgICAgfVxuICAgIH07XG4gICAgaWYgKGUubWFwVmFsdWUpIHtcbiAgICAgICAgY29uc3QgdCA9IHtcbiAgICAgICAgICAgIG1hcFZhbHVlOiB7XG4gICAgICAgICAgICAgICAgZmllbGRzOiB7fVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZm9yRWFjaChlLm1hcFZhbHVlLmZpZWxkcywgKChlLCBuKSA9PiB0Lm1hcFZhbHVlLmZpZWxkc1tlXSA9IF9fUFJJVkFURV9kZWVwQ2xvbmUobikpKSwgXG4gICAgICAgIHQ7XG4gICAgfVxuICAgIGlmIChlLmFycmF5VmFsdWUpIHtcbiAgICAgICAgY29uc3QgdCA9IHtcbiAgICAgICAgICAgIGFycmF5VmFsdWU6IHtcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IFtdXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgKGUuYXJyYXlWYWx1ZS52YWx1ZXMgfHwgW10pLmxlbmd0aDsgKytuKSB0LmFycmF5VmFsdWUudmFsdWVzW25dID0gX19QUklWQVRFX2RlZXBDbG9uZShlLmFycmF5VmFsdWUudmFsdWVzW25dKTtcbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIC4uLmVcbiAgICB9O1xufVxuXG4vKiogUmV0dXJucyB0cnVlIGlmIHRoZSBWYWx1ZSByZXByZXNlbnRzIHRoZSBjYW5vbmljYWwge0BsaW5rICNNQVhfVkFMVUV9IC4gKi8gZnVuY3Rpb24gX19QUklWQVRFX2lzTWF4VmFsdWUoZSkge1xuICAgIHJldHVybiAoKChlLm1hcFZhbHVlIHx8IHt9KS5maWVsZHMgfHwge30pLl9fdHlwZV9fIHx8IHt9KS5zdHJpbmdWYWx1ZSA9PT0gUHQ7XG59XG5cbmNvbnN0IEF0ID0ge1xuICAgIG1hcFZhbHVlOiB7XG4gICAgICAgIGZpZWxkczoge1xuICAgICAgICAgICAgW2h0XToge1xuICAgICAgICAgICAgICAgIHN0cmluZ1ZhbHVlOiBJdFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFtFdF06IHtcbiAgICAgICAgICAgICAgICBhcnJheVZhbHVlOiB7fVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufTtcblxuLyoqIFJldHVybnMgdGhlIGxvd2VzdCB2YWx1ZSBmb3IgdGhlIGdpdmVuIHZhbHVlIHR5cGUgKGluY2x1c2l2ZSkuICovIGZ1bmN0aW9uIF9fUFJJVkFURV92YWx1ZXNHZXRMb3dlckJvdW5kKGUpIHtcbiAgICByZXR1cm4gXCJudWxsVmFsdWVcIiBpbiBlID8gZHQgOiBcImJvb2xlYW5WYWx1ZVwiIGluIGUgPyB7XG4gICAgICAgIGJvb2xlYW5WYWx1ZTogITFcbiAgICB9IDogXCJpbnRlZ2VyVmFsdWVcIiBpbiBlIHx8IFwiZG91YmxlVmFsdWVcIiBpbiBlID8ge1xuICAgICAgICBkb3VibGVWYWx1ZTogTmFOXG4gICAgfSA6IFwidGltZXN0YW1wVmFsdWVcIiBpbiBlID8ge1xuICAgICAgICB0aW1lc3RhbXBWYWx1ZToge1xuICAgICAgICAgICAgc2Vjb25kczogTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVJcbiAgICAgICAgfVxuICAgIH0gOiBcInN0cmluZ1ZhbHVlXCIgaW4gZSA/IHtcbiAgICAgICAgc3RyaW5nVmFsdWU6IFwiXCJcbiAgICB9IDogXCJieXRlc1ZhbHVlXCIgaW4gZSA/IHtcbiAgICAgICAgYnl0ZXNWYWx1ZTogXCJcIlxuICAgIH0gOiBcInJlZmVyZW5jZVZhbHVlXCIgaW4gZSA/IF9fUFJJVkFURV9yZWZWYWx1ZShEYXRhYmFzZUlkLmVtcHR5KCksIERvY3VtZW50S2V5LmVtcHR5KCkpIDogXCJnZW9Qb2ludFZhbHVlXCIgaW4gZSA/IHtcbiAgICAgICAgZ2VvUG9pbnRWYWx1ZToge1xuICAgICAgICAgICAgbGF0aXR1ZGU6IC05MCxcbiAgICAgICAgICAgIGxvbmdpdHVkZTogLTE4MFxuICAgICAgICB9XG4gICAgfSA6IFwiYXJyYXlWYWx1ZVwiIGluIGUgPyB7XG4gICAgICAgIGFycmF5VmFsdWU6IHt9XG4gICAgfSA6IFwibWFwVmFsdWVcIiBpbiBlID8gX19QUklWQVRFX2lzVmVjdG9yVmFsdWUoZSkgPyBBdCA6IHtcbiAgICAgICAgbWFwVmFsdWU6IHt9XG4gICAgfSA6IGZhaWwoMzU5NDIsIHtcbiAgICAgICAgdmFsdWU6IGVcbiAgICB9KTtcbn1cblxuLyoqIFJldHVybnMgdGhlIGxhcmdlc3QgdmFsdWUgZm9yIHRoZSBnaXZlbiB2YWx1ZSB0eXBlIChleGNsdXNpdmUpLiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfdmFsdWVzR2V0VXBwZXJCb3VuZChlKSB7XG4gICAgcmV0dXJuIFwibnVsbFZhbHVlXCIgaW4gZSA/IHtcbiAgICAgICAgYm9vbGVhblZhbHVlOiAhMVxuICAgIH0gOiBcImJvb2xlYW5WYWx1ZVwiIGluIGUgPyB7XG4gICAgICAgIGRvdWJsZVZhbHVlOiBOYU5cbiAgICB9IDogXCJpbnRlZ2VyVmFsdWVcIiBpbiBlIHx8IFwiZG91YmxlVmFsdWVcIiBpbiBlID8ge1xuICAgICAgICB0aW1lc3RhbXBWYWx1ZToge1xuICAgICAgICAgICAgc2Vjb25kczogTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVJcbiAgICAgICAgfVxuICAgIH0gOiBcInRpbWVzdGFtcFZhbHVlXCIgaW4gZSA/IHtcbiAgICAgICAgc3RyaW5nVmFsdWU6IFwiXCJcbiAgICB9IDogXCJzdHJpbmdWYWx1ZVwiIGluIGUgPyB7XG4gICAgICAgIGJ5dGVzVmFsdWU6IFwiXCJcbiAgICB9IDogXCJieXRlc1ZhbHVlXCIgaW4gZSA/IF9fUFJJVkFURV9yZWZWYWx1ZShEYXRhYmFzZUlkLmVtcHR5KCksIERvY3VtZW50S2V5LmVtcHR5KCkpIDogXCJyZWZlcmVuY2VWYWx1ZVwiIGluIGUgPyB7XG4gICAgICAgIGdlb1BvaW50VmFsdWU6IHtcbiAgICAgICAgICAgIGxhdGl0dWRlOiAtOTAsXG4gICAgICAgICAgICBsb25naXR1ZGU6IC0xODBcbiAgICAgICAgfVxuICAgIH0gOiBcImdlb1BvaW50VmFsdWVcIiBpbiBlID8ge1xuICAgICAgICBhcnJheVZhbHVlOiB7fVxuICAgIH0gOiBcImFycmF5VmFsdWVcIiBpbiBlID8gQXQgOiBcIm1hcFZhbHVlXCIgaW4gZSA/IF9fUFJJVkFURV9pc1ZlY3RvclZhbHVlKGUpID8ge1xuICAgICAgICBtYXBWYWx1ZToge31cbiAgICB9IDogVHQgOiBmYWlsKDYxOTU5LCB7XG4gICAgICAgIHZhbHVlOiBlXG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9sb3dlckJvdW5kQ29tcGFyZShlLCB0KSB7XG4gICAgY29uc3QgbiA9IF9fUFJJVkFURV92YWx1ZUNvbXBhcmUoZS52YWx1ZSwgdC52YWx1ZSk7XG4gICAgcmV0dXJuIDAgIT09IG4gPyBuIDogZS5pbmNsdXNpdmUgJiYgIXQuaW5jbHVzaXZlID8gLTEgOiAhZS5pbmNsdXNpdmUgJiYgdC5pbmNsdXNpdmUgPyAxIDogMDtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX3VwcGVyQm91bmRDb21wYXJlKGUsIHQpIHtcbiAgICBjb25zdCBuID0gX19QUklWQVRFX3ZhbHVlQ29tcGFyZShlLnZhbHVlLCB0LnZhbHVlKTtcbiAgICByZXR1cm4gMCAhPT0gbiA/IG4gOiBlLmluY2x1c2l2ZSAmJiAhdC5pbmNsdXNpdmUgPyAxIDogIWUuaW5jbHVzaXZlICYmIHQuaW5jbHVzaXZlID8gLTEgOiAwO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBbiBPYmplY3RWYWx1ZSByZXByZXNlbnRzIGEgTWFwVmFsdWUgaW4gdGhlIEZpcmVzdG9yZSBQcm90byBhbmQgb2ZmZXJzIHRoZVxuICogYWJpbGl0eSB0byBhZGQgYW5kIHJlbW92ZSBmaWVsZHMgKHZpYSB0aGUgT2JqZWN0VmFsdWVCdWlsZGVyKS5cbiAqLyBjbGFzcyBPYmplY3RWYWx1ZSB7XG4gICAgY29uc3RydWN0b3IoZSkge1xuICAgICAgICB0aGlzLnZhbHVlID0gZTtcbiAgICB9XG4gICAgc3RhdGljIGVtcHR5KCkge1xuICAgICAgICByZXR1cm4gbmV3IE9iamVjdFZhbHVlKHtcbiAgICAgICAgICAgIG1hcFZhbHVlOiB7fVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgdmFsdWUgYXQgdGhlIGdpdmVuIHBhdGggb3IgbnVsbC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXRoIC0gdGhlIHBhdGggdG8gc2VhcmNoXG4gICAgICogQHJldHVybnMgVGhlIHZhbHVlIGF0IHRoZSBwYXRoIG9yIG51bGwgaWYgdGhlIHBhdGggaXMgbm90IHNldC5cbiAgICAgKi8gICAgZmllbGQoZSkge1xuICAgICAgICBpZiAoZS5pc0VtcHR5KCkpIHJldHVybiB0aGlzLnZhbHVlO1xuICAgICAgICB7XG4gICAgICAgICAgICBsZXQgdCA9IHRoaXMudmFsdWU7XG4gICAgICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IGUubGVuZ3RoIC0gMTsgKytuKSBpZiAodCA9ICh0Lm1hcFZhbHVlLmZpZWxkcyB8fCB7fSlbZS5nZXQobildLCBcbiAgICAgICAgICAgICFfX1BSSVZBVEVfaXNNYXBWYWx1ZSh0KSkgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICByZXR1cm4gdCA9ICh0Lm1hcFZhbHVlLmZpZWxkcyB8fCB7fSlbZS5sYXN0U2VnbWVudCgpXSwgdCB8fCBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIGZpZWxkIHRvIHRoZSBwcm92aWRlZCB2YWx1ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXRoIC0gVGhlIGZpZWxkIHBhdGggdG8gc2V0LlxuICAgICAqIEBwYXJhbSB2YWx1ZSAtIFRoZSB2YWx1ZSB0byBzZXQuXG4gICAgICovICAgIHNldChlLCB0KSB7XG4gICAgICAgIHRoaXMuZ2V0RmllbGRzTWFwKGUucG9wTGFzdCgpKVtlLmxhc3RTZWdtZW50KCldID0gX19QUklWQVRFX2RlZXBDbG9uZSh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgcHJvdmlkZWQgZmllbGRzIHRvIHRoZSBwcm92aWRlZCB2YWx1ZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZGF0YSAtIEEgbWFwIG9mIGZpZWxkcyB0byB2YWx1ZXMgKG9yIG51bGwgZm9yIGRlbGV0ZXMpLlxuICAgICAqLyAgICBzZXRBbGwoZSkge1xuICAgICAgICBsZXQgdCA9IEZpZWxkUGF0aCQxLmVtcHR5UGF0aCgpLCBuID0ge30sIHIgPSBbXTtcbiAgICAgICAgZS5mb3JFYWNoKCgoZSwgaSkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0LmlzSW1tZWRpYXRlUGFyZW50T2YoaSkpIHtcbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgdGhlIGFjY3VtdWxhdGVkIGNoYW5nZXMgYXQgdGhpcyBwYXJlbnQgbG9jYXRpb25cbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5nZXRGaWVsZHNNYXAodCk7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBseUNoYW5nZXMoZSwgbiwgciksIG4gPSB7fSwgciA9IFtdLCB0ID0gaS5wb3BMYXN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlID8gbltpLmxhc3RTZWdtZW50KCldID0gX19QUklWQVRFX2RlZXBDbG9uZShlKSA6IHIucHVzaChpLmxhc3RTZWdtZW50KCkpO1xuICAgICAgICB9KSk7XG4gICAgICAgIGNvbnN0IGkgPSB0aGlzLmdldEZpZWxkc01hcCh0KTtcbiAgICAgICAgdGhpcy5hcHBseUNoYW5nZXMoaSwgbiwgcik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgdGhlIGZpZWxkIGF0IHRoZSBzcGVjaWZpZWQgcGF0aC4gSWYgdGhlcmUgaXMgbm8gZmllbGQgYXQgdGhlXG4gICAgICogc3BlY2lmaWVkIHBhdGgsIG5vdGhpbmcgaXMgY2hhbmdlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXRoIC0gVGhlIGZpZWxkIHBhdGggdG8gcmVtb3ZlLlxuICAgICAqLyAgICBkZWxldGUoZSkge1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5maWVsZChlLnBvcExhc3QoKSk7XG4gICAgICAgIF9fUFJJVkFURV9pc01hcFZhbHVlKHQpICYmIHQubWFwVmFsdWUuZmllbGRzICYmIGRlbGV0ZSB0Lm1hcFZhbHVlLmZpZWxkc1tlLmxhc3RTZWdtZW50KCldO1xuICAgIH1cbiAgICBpc0VxdWFsKGUpIHtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV92YWx1ZUVxdWFscyh0aGlzLnZhbHVlLCBlLnZhbHVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgbWFwIHRoYXQgY29udGFpbnMgdGhlIGxlYWYgZWxlbWVudCBvZiBgcGF0aGAuIElmIHRoZSBwYXJlbnRcbiAgICAgKiBlbnRyeSBkb2VzIG5vdCB5ZXQgZXhpc3QsIG9yIGlmIGl0IGlzIG5vdCBhIG1hcCwgYSBuZXcgbWFwIHdpbGwgYmUgY3JlYXRlZC5cbiAgICAgKi8gICAgZ2V0RmllbGRzTWFwKGUpIHtcbiAgICAgICAgbGV0IHQgPSB0aGlzLnZhbHVlO1xuICAgICAgICB0Lm1hcFZhbHVlLmZpZWxkcyB8fCAodC5tYXBWYWx1ZSA9IHtcbiAgICAgICAgICAgIGZpZWxkczoge31cbiAgICAgICAgfSk7XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgZS5sZW5ndGg7ICsrbikge1xuICAgICAgICAgICAgbGV0IHIgPSB0Lm1hcFZhbHVlLmZpZWxkc1tlLmdldChuKV07XG4gICAgICAgICAgICBfX1BSSVZBVEVfaXNNYXBWYWx1ZShyKSAmJiByLm1hcFZhbHVlLmZpZWxkcyB8fCAociA9IHtcbiAgICAgICAgICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZHM6IHt9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgdC5tYXBWYWx1ZS5maWVsZHNbZS5nZXQobildID0gciksIHQgPSByO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0Lm1hcFZhbHVlLmZpZWxkcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogTW9kaWZpZXMgYGZpZWxkc01hcGAgYnkgYWRkaW5nLCByZXBsYWNpbmcgb3IgZGVsZXRpbmcgdGhlIHNwZWNpZmllZFxuICAgICAqIGVudHJpZXMuXG4gICAgICovICAgIGFwcGx5Q2hhbmdlcyhlLCB0LCBuKSB7XG4gICAgICAgIGZvckVhY2godCwgKCh0LCBuKSA9PiBlW3RdID0gbikpO1xuICAgICAgICBmb3IgKGNvbnN0IHQgb2YgbikgZGVsZXRlIGVbdF07XG4gICAgfVxuICAgIGNsb25lKCkge1xuICAgICAgICByZXR1cm4gbmV3IE9iamVjdFZhbHVlKF9fUFJJVkFURV9kZWVwQ2xvbmUodGhpcy52YWx1ZSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgRmllbGRNYXNrIGJ1aWx0IGZyb20gYWxsIGZpZWxkcyBpbiBhIE1hcFZhbHVlLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9leHRyYWN0RmllbGRNYXNrKGUpIHtcbiAgICBjb25zdCB0ID0gW107XG4gICAgcmV0dXJuIGZvckVhY2goZS5maWVsZHMsICgoZSwgbikgPT4ge1xuICAgICAgICBjb25zdCByID0gbmV3IEZpZWxkUGF0aCQxKFsgZSBdKTtcbiAgICAgICAgaWYgKF9fUFJJVkFURV9pc01hcFZhbHVlKG4pKSB7XG4gICAgICAgICAgICBjb25zdCBlID0gX19QUklWQVRFX2V4dHJhY3RGaWVsZE1hc2sobi5tYXBWYWx1ZSkuZmllbGRzO1xuICAgICAgICAgICAgaWYgKDAgPT09IGUubGVuZ3RoKSBcbiAgICAgICAgICAgIC8vIFByZXNlcnZlIHRoZSBlbXB0eSBtYXAgYnkgYWRkaW5nIGl0IHRvIHRoZSBGaWVsZE1hc2suXG4gICAgICAgICAgICB0LnB1c2gocik7IGVsc2UgXG4gICAgICAgICAgICAvLyBGb3IgbmVzdGVkIGFuZCBub24tZW1wdHkgT2JqZWN0VmFsdWVzLCBhZGQgdGhlIEZpZWxkUGF0aCBvZiB0aGVcbiAgICAgICAgICAgIC8vIGxlYWYgbm9kZXMuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgZSkgdC5wdXNoKHIuY2hpbGQobikpO1xuICAgICAgICB9IGVsc2UgXG4gICAgICAgIC8vIEZvciBuZXN0ZWQgYW5kIG5vbi1lbXB0eSBPYmplY3RWYWx1ZXMsIGFkZCB0aGUgRmllbGRQYXRoIG9mIHRoZSBsZWFmXG4gICAgICAgIC8vIG5vZGVzLlxuICAgICAgICB0LnB1c2gocik7XG4gICAgfSkpLCBuZXcgRmllbGRNYXNrKHQpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZXByZXNlbnRzIGEgZG9jdW1lbnQgaW4gRmlyZXN0b3JlIHdpdGggYSBrZXksIHZlcnNpb24sIGRhdGEgYW5kIHdoZXRoZXIgaXRcbiAqIGhhcyBsb2NhbCBtdXRhdGlvbnMgYXBwbGllZCB0byBpdC5cbiAqXG4gKiBEb2N1bWVudHMgY2FuIHRyYW5zaXRpb24gYmV0d2VlbiBzdGF0ZXMgdmlhIGBjb252ZXJ0VG9Gb3VuZERvY3VtZW50KClgLFxuICogYGNvbnZlcnRUb05vRG9jdW1lbnQoKWAgYW5kIGBjb252ZXJ0VG9Vbmtub3duRG9jdW1lbnQoKWAuIElmIGEgZG9jdW1lbnQgZG9lc1xuICogbm90IHRyYW5zaXRpb24gdG8gb25lIG9mIHRoZXNlIHN0YXRlcyBldmVuIGFmdGVyIGFsbCBtdXRhdGlvbnMgaGF2ZSBiZWVuXG4gKiBhcHBsaWVkLCBgaXNWYWxpZERvY3VtZW50KClgIHJldHVybnMgZmFsc2UgYW5kIHRoZSBkb2N1bWVudCBzaG91bGQgYmUgcmVtb3ZlZFxuICogZnJvbSBhbGwgdmlld3MuXG4gKi8gY2xhc3MgTXV0YWJsZURvY3VtZW50IHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0LCBuLCByLCBpLCBzLCBvKSB7XG4gICAgICAgIHRoaXMua2V5ID0gZSwgdGhpcy5kb2N1bWVudFR5cGUgPSB0LCB0aGlzLnZlcnNpb24gPSBuLCB0aGlzLnJlYWRUaW1lID0gciwgdGhpcy5jcmVhdGVUaW1lID0gaSwgXG4gICAgICAgIHRoaXMuZGF0YSA9IHMsIHRoaXMuZG9jdW1lbnRTdGF0ZSA9IG87XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBkb2N1bWVudCB3aXRoIG5vIGtub3duIHZlcnNpb24gb3IgZGF0YSwgYnV0IHdoaWNoIGNhbiBzZXJ2ZSBhc1xuICAgICAqIGJhc2UgZG9jdW1lbnQgZm9yIG11dGF0aW9ucy5cbiAgICAgKi8gICAgc3RhdGljIG5ld0ludmFsaWREb2N1bWVudChlKSB7XG4gICAgICAgIHJldHVybiBuZXcgTXV0YWJsZURvY3VtZW50KGUsIDAgLyogRG9jdW1lbnRUeXBlLklOVkFMSUQgKi8gLCBcbiAgICAgICAgLyogdmVyc2lvbiAqLyBTbmFwc2hvdFZlcnNpb24ubWluKCksIFxuICAgICAgICAvKiByZWFkVGltZSAqLyBTbmFwc2hvdFZlcnNpb24ubWluKCksIFxuICAgICAgICAvKiBjcmVhdGVUaW1lICovIFNuYXBzaG90VmVyc2lvbi5taW4oKSwgT2JqZWN0VmFsdWUuZW1wdHkoKSwgMCAvKiBEb2N1bWVudFN0YXRlLlNZTkNFRCAqLyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgZG9jdW1lbnQgdGhhdCBpcyBrbm93biB0byBleGlzdCB3aXRoIHRoZSBnaXZlbiBkYXRhIGF0IHRoZVxuICAgICAqIGdpdmVuIHZlcnNpb24uXG4gICAgICovICAgIHN0YXRpYyBuZXdGb3VuZERvY3VtZW50KGUsIHQsIG4sIHIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNdXRhYmxlRG9jdW1lbnQoZSwgMSAvKiBEb2N1bWVudFR5cGUuRk9VTkRfRE9DVU1FTlQgKi8gLCBcbiAgICAgICAgLyogdmVyc2lvbiAqLyB0LCBcbiAgICAgICAgLyogcmVhZFRpbWUgKi8gU25hcHNob3RWZXJzaW9uLm1pbigpLCBcbiAgICAgICAgLyogY3JlYXRlVGltZSAqLyBuLCByLCAwIC8qIERvY3VtZW50U3RhdGUuU1lOQ0VEICovKTtcbiAgICB9XG4gICAgLyoqIENyZWF0ZXMgYSBuZXcgZG9jdW1lbnQgdGhhdCBpcyBrbm93biB0byBub3QgZXhpc3QgYXQgdGhlIGdpdmVuIHZlcnNpb24uICovICAgIHN0YXRpYyBuZXdOb0RvY3VtZW50KGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNdXRhYmxlRG9jdW1lbnQoZSwgMiAvKiBEb2N1bWVudFR5cGUuTk9fRE9DVU1FTlQgKi8gLCBcbiAgICAgICAgLyogdmVyc2lvbiAqLyB0LCBcbiAgICAgICAgLyogcmVhZFRpbWUgKi8gU25hcHNob3RWZXJzaW9uLm1pbigpLCBcbiAgICAgICAgLyogY3JlYXRlVGltZSAqLyBTbmFwc2hvdFZlcnNpb24ubWluKCksIE9iamVjdFZhbHVlLmVtcHR5KCksIDAgLyogRG9jdW1lbnRTdGF0ZS5TWU5DRUQgKi8pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IGRvY3VtZW50IHRoYXQgaXMga25vd24gdG8gZXhpc3QgYXQgdGhlIGdpdmVuIHZlcnNpb24gYnV0XG4gICAgICogd2hvc2UgZGF0YSBpcyBub3Qga25vd24gKGUuZy4gYSBkb2N1bWVudCB0aGF0IHdhcyB1cGRhdGVkIHdpdGhvdXQgYSBrbm93blxuICAgICAqIGJhc2UgZG9jdW1lbnQpLlxuICAgICAqLyAgICBzdGF0aWMgbmV3VW5rbm93bkRvY3VtZW50KGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNdXRhYmxlRG9jdW1lbnQoZSwgMyAvKiBEb2N1bWVudFR5cGUuVU5LTk9XTl9ET0NVTUVOVCAqLyAsIFxuICAgICAgICAvKiB2ZXJzaW9uICovIHQsIFxuICAgICAgICAvKiByZWFkVGltZSAqLyBTbmFwc2hvdFZlcnNpb24ubWluKCksIFxuICAgICAgICAvKiBjcmVhdGVUaW1lICovIFNuYXBzaG90VmVyc2lvbi5taW4oKSwgT2JqZWN0VmFsdWUuZW1wdHkoKSwgMiAvKiBEb2N1bWVudFN0YXRlLkhBU19DT01NSVRURURfTVVUQVRJT05TICovKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2hhbmdlcyB0aGUgZG9jdW1lbnQgdHlwZSB0byBpbmRpY2F0ZSB0aGF0IGl0IGV4aXN0cyBhbmQgdGhhdCBpdHMgdmVyc2lvblxuICAgICAqIGFuZCBkYXRhIGFyZSBrbm93bi5cbiAgICAgKi8gICAgY29udmVydFRvRm91bmREb2N1bWVudChlLCB0KSB7XG4gICAgICAgIC8vIElmIGEgZG9jdW1lbnQgaXMgc3dpdGNoaW5nIHN0YXRlIGZyb20gYmVpbmcgYW4gaW52YWxpZCBvciBkZWxldGVkXG4gICAgICAgIC8vIGRvY3VtZW50IHRvIGEgdmFsaWQgKEZPVU5EX0RPQ1VNRU5UKSBkb2N1bWVudCwgZWl0aGVyIGR1ZSB0byByZWNlaXZpbmcgYW5cbiAgICAgICAgLy8gdXBkYXRlIGZyb20gV2F0Y2ggb3IgZHVlIHRvIGFwcGx5aW5nIGEgbG9jYWwgc2V0IG11dGF0aW9uIG9uIHRvcFxuICAgICAgICAvLyBvZiBhIGRlbGV0ZWQgZG9jdW1lbnQsIG91ciBiZXN0IGd1ZXNzIGFib3V0IGl0cyBjcmVhdGVUaW1lIHdvdWxkIGJlIHRoZVxuICAgICAgICAvLyB2ZXJzaW9uIGF0IHdoaWNoIHRoZSBkb2N1bWVudCB0cmFuc2l0aW9uZWQgdG8gYSBGT1VORF9ET0NVTUVOVC5cbiAgICAgICAgcmV0dXJuICF0aGlzLmNyZWF0ZVRpbWUuaXNFcXVhbChTbmFwc2hvdFZlcnNpb24ubWluKCkpIHx8IDIgLyogRG9jdW1lbnRUeXBlLk5PX0RPQ1VNRU5UICovICE9PSB0aGlzLmRvY3VtZW50VHlwZSAmJiAwIC8qIERvY3VtZW50VHlwZS5JTlZBTElEICovICE9PSB0aGlzLmRvY3VtZW50VHlwZSB8fCAodGhpcy5jcmVhdGVUaW1lID0gZSksIFxuICAgICAgICB0aGlzLnZlcnNpb24gPSBlLCB0aGlzLmRvY3VtZW50VHlwZSA9IDEgLyogRG9jdW1lbnRUeXBlLkZPVU5EX0RPQ1VNRU5UICovICwgdGhpcy5kYXRhID0gdCwgXG4gICAgICAgIHRoaXMuZG9jdW1lbnRTdGF0ZSA9IDAgLyogRG9jdW1lbnRTdGF0ZS5TWU5DRUQgKi8gLCB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGFuZ2VzIHRoZSBkb2N1bWVudCB0eXBlIHRvIGluZGljYXRlIHRoYXQgaXQgZG9lc24ndCBleGlzdCBhdCB0aGUgZ2l2ZW5cbiAgICAgKiB2ZXJzaW9uLlxuICAgICAqLyAgICBjb252ZXJ0VG9Ob0RvY3VtZW50KGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmVyc2lvbiA9IGUsIHRoaXMuZG9jdW1lbnRUeXBlID0gMiAvKiBEb2N1bWVudFR5cGUuTk9fRE9DVU1FTlQgKi8gLCBcbiAgICAgICAgdGhpcy5kYXRhID0gT2JqZWN0VmFsdWUuZW1wdHkoKSwgdGhpcy5kb2N1bWVudFN0YXRlID0gMCAvKiBEb2N1bWVudFN0YXRlLlNZTkNFRCAqLyAsIFxuICAgICAgICB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGFuZ2VzIHRoZSBkb2N1bWVudCB0eXBlIHRvIGluZGljYXRlIHRoYXQgaXQgZXhpc3RzIGF0IGEgZ2l2ZW4gdmVyc2lvbiBidXRcbiAgICAgKiB0aGF0IGl0cyBkYXRhIGlzIG5vdCBrbm93biAoZS5nLiBhIGRvY3VtZW50IHRoYXQgd2FzIHVwZGF0ZWQgd2l0aG91dCBhIGtub3duXG4gICAgICogYmFzZSBkb2N1bWVudCkuXG4gICAgICovICAgIGNvbnZlcnRUb1Vua25vd25Eb2N1bWVudChlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnZlcnNpb24gPSBlLCB0aGlzLmRvY3VtZW50VHlwZSA9IDMgLyogRG9jdW1lbnRUeXBlLlVOS05PV05fRE9DVU1FTlQgKi8gLCBcbiAgICAgICAgdGhpcy5kYXRhID0gT2JqZWN0VmFsdWUuZW1wdHkoKSwgdGhpcy5kb2N1bWVudFN0YXRlID0gMiAvKiBEb2N1bWVudFN0YXRlLkhBU19DT01NSVRURURfTVVUQVRJT05TICovICwgXG4gICAgICAgIHRoaXM7XG4gICAgfVxuICAgIHNldEhhc0NvbW1pdHRlZE11dGF0aW9ucygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG9jdW1lbnRTdGF0ZSA9IDIgLyogRG9jdW1lbnRTdGF0ZS5IQVNfQ09NTUlUVEVEX01VVEFUSU9OUyAqLyAsIHRoaXM7XG4gICAgfVxuICAgIHNldEhhc0xvY2FsTXV0YXRpb25zKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kb2N1bWVudFN0YXRlID0gMSAvKiBEb2N1bWVudFN0YXRlLkhBU19MT0NBTF9NVVRBVElPTlMgKi8gLCB0aGlzLnZlcnNpb24gPSBTbmFwc2hvdFZlcnNpb24ubWluKCksIFxuICAgICAgICB0aGlzO1xuICAgIH1cbiAgICBzZXRSZWFkVGltZShlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlYWRUaW1lID0gZSwgdGhpcztcbiAgICB9XG4gICAgZ2V0IGhhc0xvY2FsTXV0YXRpb25zKCkge1xuICAgICAgICByZXR1cm4gMSAvKiBEb2N1bWVudFN0YXRlLkhBU19MT0NBTF9NVVRBVElPTlMgKi8gPT09IHRoaXMuZG9jdW1lbnRTdGF0ZTtcbiAgICB9XG4gICAgZ2V0IGhhc0NvbW1pdHRlZE11dGF0aW9ucygpIHtcbiAgICAgICAgcmV0dXJuIDIgLyogRG9jdW1lbnRTdGF0ZS5IQVNfQ09NTUlUVEVEX01VVEFUSU9OUyAqLyA9PT0gdGhpcy5kb2N1bWVudFN0YXRlO1xuICAgIH1cbiAgICBnZXQgaGFzUGVuZGluZ1dyaXRlcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGFzTG9jYWxNdXRhdGlvbnMgfHwgdGhpcy5oYXNDb21taXR0ZWRNdXRhdGlvbnM7XG4gICAgfVxuICAgIGlzVmFsaWREb2N1bWVudCgpIHtcbiAgICAgICAgcmV0dXJuIDAgLyogRG9jdW1lbnRUeXBlLklOVkFMSUQgKi8gIT09IHRoaXMuZG9jdW1lbnRUeXBlO1xuICAgIH1cbiAgICBpc0ZvdW5kRG9jdW1lbnQoKSB7XG4gICAgICAgIHJldHVybiAxIC8qIERvY3VtZW50VHlwZS5GT1VORF9ET0NVTUVOVCAqLyA9PT0gdGhpcy5kb2N1bWVudFR5cGU7XG4gICAgfVxuICAgIGlzTm9Eb2N1bWVudCgpIHtcbiAgICAgICAgcmV0dXJuIDIgLyogRG9jdW1lbnRUeXBlLk5PX0RPQ1VNRU5UICovID09PSB0aGlzLmRvY3VtZW50VHlwZTtcbiAgICB9XG4gICAgaXNVbmtub3duRG9jdW1lbnQoKSB7XG4gICAgICAgIHJldHVybiAzIC8qIERvY3VtZW50VHlwZS5VTktOT1dOX0RPQ1VNRU5UICovID09PSB0aGlzLmRvY3VtZW50VHlwZTtcbiAgICB9XG4gICAgaXNFcXVhbChlKSB7XG4gICAgICAgIHJldHVybiBlIGluc3RhbmNlb2YgTXV0YWJsZURvY3VtZW50ICYmIHRoaXMua2V5LmlzRXF1YWwoZS5rZXkpICYmIHRoaXMudmVyc2lvbi5pc0VxdWFsKGUudmVyc2lvbikgJiYgdGhpcy5kb2N1bWVudFR5cGUgPT09IGUuZG9jdW1lbnRUeXBlICYmIHRoaXMuZG9jdW1lbnRTdGF0ZSA9PT0gZS5kb2N1bWVudFN0YXRlICYmIHRoaXMuZGF0YS5pc0VxdWFsKGUuZGF0YSk7XG4gICAgfVxuICAgIG11dGFibGVDb3B5KCkge1xuICAgICAgICByZXR1cm4gbmV3IE11dGFibGVEb2N1bWVudCh0aGlzLmtleSwgdGhpcy5kb2N1bWVudFR5cGUsIHRoaXMudmVyc2lvbiwgdGhpcy5yZWFkVGltZSwgdGhpcy5jcmVhdGVUaW1lLCB0aGlzLmRhdGEuY2xvbmUoKSwgdGhpcy5kb2N1bWVudFN0YXRlKTtcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiBgRG9jdW1lbnQoJHt0aGlzLmtleX0sICR7dGhpcy52ZXJzaW9ufSwgJHtKU09OLnN0cmluZ2lmeSh0aGlzLmRhdGEudmFsdWUpfSwge2NyZWF0ZVRpbWU6ICR7dGhpcy5jcmVhdGVUaW1lfX0pLCB7ZG9jdW1lbnRUeXBlOiAke3RoaXMuZG9jdW1lbnRUeXBlfX0pLCB7ZG9jdW1lbnRTdGF0ZTogJHt0aGlzLmRvY3VtZW50U3RhdGV9fSlgO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDb21wYXJlcyB0aGUgdmFsdWUgZm9yIGZpZWxkIGBmaWVsZGAgaW4gdGhlIHByb3ZpZGVkIGRvY3VtZW50cy4gVGhyb3dzIGlmXG4gKiB0aGUgZmllbGQgZG9lcyBub3QgZXhpc3QgaW4gYm90aCBkb2N1bWVudHMuXG4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFJlcHJlc2VudHMgYSBib3VuZCBvZiBhIHF1ZXJ5LlxuICpcbiAqIFRoZSBib3VuZCBpcyBzcGVjaWZpZWQgd2l0aCB0aGUgZ2l2ZW4gY29tcG9uZW50cyByZXByZXNlbnRpbmcgYSBwb3NpdGlvbiBhbmRcbiAqIHdoZXRoZXIgaXQncyBqdXN0IGJlZm9yZSBvciBqdXN0IGFmdGVyIHRoZSBwb3NpdGlvbiAocmVsYXRpdmUgdG8gd2hhdGV2ZXIgdGhlXG4gKiBxdWVyeSBvcmRlciBpcykuXG4gKlxuICogVGhlIHBvc2l0aW9uIHJlcHJlc2VudHMgYSBsb2dpY2FsIGluZGV4IHBvc2l0aW9uIGZvciBhIHF1ZXJ5LiBJdCdzIGEgcHJlZml4XG4gKiBvZiB2YWx1ZXMgZm9yIHRoZSAocG90ZW50aWFsbHkgaW1wbGljaXQpIG9yZGVyIGJ5IGNsYXVzZXMgb2YgYSBxdWVyeS5cbiAqXG4gKiBCb3VuZCBwcm92aWRlcyBhIGZ1bmN0aW9uIHRvIGRldGVybWluZSB3aGV0aGVyIGEgZG9jdW1lbnQgY29tZXMgYmVmb3JlIG9yXG4gKiBhZnRlciBhIGJvdW5kLiBUaGlzIGlzIGluZmx1ZW5jZWQgYnkgd2hldGhlciB0aGUgcG9zaXRpb24gaXMganVzdCBiZWZvcmUgb3JcbiAqIGp1c3QgYWZ0ZXIgdGhlIHByb3ZpZGVkIHZhbHVlcy5cbiAqL1xuY2xhc3MgQm91bmQge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQpIHtcbiAgICAgICAgdGhpcy5wb3NpdGlvbiA9IGUsIHRoaXMuaW5jbHVzaXZlID0gdDtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9ib3VuZENvbXBhcmVUb0RvY3VtZW50KGUsIHQsIG4pIHtcbiAgICBsZXQgciA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlLnBvc2l0aW9uLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHMgPSB0W2ldLCBvID0gZS5wb3NpdGlvbltpXTtcbiAgICAgICAgaWYgKHMuZmllbGQuaXNLZXlGaWVsZCgpKSByID0gRG9jdW1lbnRLZXkuY29tcGFyYXRvcihEb2N1bWVudEtleS5mcm9tTmFtZShvLnJlZmVyZW5jZVZhbHVlKSwgbi5rZXkpOyBlbHNlIHtcbiAgICAgICAgICAgIHIgPSBfX1BSSVZBVEVfdmFsdWVDb21wYXJlKG8sIG4uZGF0YS5maWVsZChzLmZpZWxkKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwiZGVzY1wiIC8qIERpcmVjdGlvbi5ERVNDRU5ESU5HICovID09PSBzLmRpciAmJiAociAqPSAtMSksIDAgIT09IHIpIGJyZWFrO1xuICAgIH1cbiAgICByZXR1cm4gcjtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgYSBkb2N1bWVudCBzb3J0cyBhZnRlciBhIGJvdW5kIHVzaW5nIHRoZSBwcm92aWRlZCBzb3J0XG4gKiBvcmRlci5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfYm91bmRFcXVhbHMoZSwgdCkge1xuICAgIGlmIChudWxsID09PSBlKSByZXR1cm4gbnVsbCA9PT0gdDtcbiAgICBpZiAobnVsbCA9PT0gdCkgcmV0dXJuICExO1xuICAgIGlmIChlLmluY2x1c2l2ZSAhPT0gdC5pbmNsdXNpdmUgfHwgZS5wb3NpdGlvbi5sZW5ndGggIT09IHQucG9zaXRpb24ubGVuZ3RoKSByZXR1cm4gITE7XG4gICAgZm9yIChsZXQgbiA9IDA7IG4gPCBlLnBvc2l0aW9uLmxlbmd0aDsgbisrKSB7XG4gICAgICAgIGlmICghX19QUklWQVRFX3ZhbHVlRXF1YWxzKGUucG9zaXRpb25bbl0sIHQucG9zaXRpb25bbl0pKSByZXR1cm4gITE7XG4gICAgfVxuICAgIHJldHVybiAhMDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gb3JkZXJpbmcgb24gYSBmaWVsZCwgaW4gc29tZSBEaXJlY3Rpb24uIERpcmVjdGlvbiBkZWZhdWx0cyB0byBBU0NFTkRJTkcuXG4gKi8gY2xhc3MgT3JkZXJCeSB7XG4gICAgY29uc3RydWN0b3IoZSwgdCA9IFwiYXNjXCIgLyogRGlyZWN0aW9uLkFTQ0VORElORyAqLykge1xuICAgICAgICB0aGlzLmZpZWxkID0gZSwgdGhpcy5kaXIgPSB0O1xuICAgIH1cbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX29yZGVyQnlFcXVhbHMoZSwgdCkge1xuICAgIHJldHVybiBlLmRpciA9PT0gdC5kaXIgJiYgZS5maWVsZC5pc0VxdWFsKHQuZmllbGQpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBGaWx0ZXIge31cblxuY2xhc3MgRmllbGRGaWx0ZXIgZXh0ZW5kcyBGaWx0ZXIge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4pIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5maWVsZCA9IGUsIHRoaXMub3AgPSB0LCB0aGlzLnZhbHVlID0gbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZpbHRlciBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgYXJndW1lbnRzLlxuICAgICAqLyAgICBzdGF0aWMgY3JlYXRlKGUsIHQsIG4pIHtcbiAgICAgICAgcmV0dXJuIGUuaXNLZXlGaWVsZCgpID8gXCJpblwiIC8qIE9wZXJhdG9yLklOICovID09PSB0IHx8IFwibm90LWluXCIgLyogT3BlcmF0b3IuTk9UX0lOICovID09PSB0ID8gdGhpcy5jcmVhdGVLZXlGaWVsZEluRmlsdGVyKGUsIHQsIG4pIDogbmV3IF9fUFJJVkFURV9LZXlGaWVsZEZpbHRlcihlLCB0LCBuKSA6IFwiYXJyYXktY29udGFpbnNcIiAvKiBPcGVyYXRvci5BUlJBWV9DT05UQUlOUyAqLyA9PT0gdCA/IG5ldyBfX1BSSVZBVEVfQXJyYXlDb250YWluc0ZpbHRlcihlLCBuKSA6IFwiaW5cIiAvKiBPcGVyYXRvci5JTiAqLyA9PT0gdCA/IG5ldyBfX1BSSVZBVEVfSW5GaWx0ZXIoZSwgbikgOiBcIm5vdC1pblwiIC8qIE9wZXJhdG9yLk5PVF9JTiAqLyA9PT0gdCA/IG5ldyBfX1BSSVZBVEVfTm90SW5GaWx0ZXIoZSwgbikgOiBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIE9wZXJhdG9yLkFSUkFZX0NPTlRBSU5TX0FOWSAqLyA9PT0gdCA/IG5ldyBfX1BSSVZBVEVfQXJyYXlDb250YWluc0FueUZpbHRlcihlLCBuKSA6IG5ldyBGaWVsZEZpbHRlcihlLCB0LCBuKTtcbiAgICB9XG4gICAgc3RhdGljIGNyZWF0ZUtleUZpZWxkSW5GaWx0ZXIoZSwgdCwgbikge1xuICAgICAgICByZXR1cm4gXCJpblwiIC8qIE9wZXJhdG9yLklOICovID09PSB0ID8gbmV3IF9fUFJJVkFURV9LZXlGaWVsZEluRmlsdGVyKGUsIG4pIDogbmV3IF9fUFJJVkFURV9LZXlGaWVsZE5vdEluRmlsdGVyKGUsIG4pO1xuICAgIH1cbiAgICBtYXRjaGVzKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IGUuZGF0YS5maWVsZCh0aGlzLmZpZWxkKTtcbiAgICAgICAgLy8gVHlwZXMgZG8gbm90IGhhdmUgdG8gbWF0Y2ggaW4gTk9UX0VRVUFMIGZpbHRlcnMuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiIT1cIiAvKiBPcGVyYXRvci5OT1RfRVFVQUwgKi8gPT09IHRoaXMub3AgPyBudWxsICE9PSB0ICYmIHZvaWQgMCA9PT0gdC5udWxsVmFsdWUgJiYgdGhpcy5tYXRjaGVzQ29tcGFyaXNvbihfX1BSSVZBVEVfdmFsdWVDb21wYXJlKHQsIHRoaXMudmFsdWUpKSA6IG51bGwgIT09IHQgJiYgX19QUklWQVRFX3R5cGVPcmRlcih0aGlzLnZhbHVlKSA9PT0gX19QUklWQVRFX3R5cGVPcmRlcih0KSAmJiB0aGlzLm1hdGNoZXNDb21wYXJpc29uKF9fUFJJVkFURV92YWx1ZUNvbXBhcmUodCwgdGhpcy52YWx1ZSkpO1xuICAgICAgICAvLyBPbmx5IGNvbXBhcmUgdHlwZXMgd2l0aCBtYXRjaGluZyBiYWNrZW5kIG9yZGVyIChzdWNoIGFzIGRvdWJsZSBhbmQgaW50KS5cbiAgICAgICAgfVxuICAgIG1hdGNoZXNDb21wYXJpc29uKGUpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLm9wKSB7XG4gICAgICAgICAgY2FzZSBcIjxcIiAvKiBPcGVyYXRvci5MRVNTX1RIQU4gKi8gOlxuICAgICAgICAgICAgcmV0dXJuIGUgPCAwO1xuXG4gICAgICAgICAgY2FzZSBcIjw9XCIgLyogT3BlcmF0b3IuTEVTU19USEFOX09SX0VRVUFMICovIDpcbiAgICAgICAgICAgIHJldHVybiBlIDw9IDA7XG5cbiAgICAgICAgICBjYXNlIFwiPT1cIiAvKiBPcGVyYXRvci5FUVVBTCAqLyA6XG4gICAgICAgICAgICByZXR1cm4gMCA9PT0gZTtcblxuICAgICAgICAgIGNhc2UgXCIhPVwiIC8qIE9wZXJhdG9yLk5PVF9FUVVBTCAqLyA6XG4gICAgICAgICAgICByZXR1cm4gMCAhPT0gZTtcblxuICAgICAgICAgIGNhc2UgXCI+XCIgLyogT3BlcmF0b3IuR1JFQVRFUl9USEFOICovIDpcbiAgICAgICAgICAgIHJldHVybiBlID4gMDtcblxuICAgICAgICAgIGNhc2UgXCI+PVwiIC8qIE9wZXJhdG9yLkdSRUFURVJfVEhBTl9PUl9FUVVBTCAqLyA6XG4gICAgICAgICAgICByZXR1cm4gZSA+PSAwO1xuXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBmYWlsKDQ3MjY2LCB7XG4gICAgICAgICAgICAgICAgb3BlcmF0b3I6IHRoaXMub3BcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlzSW5lcXVhbGl0eSgpIHtcbiAgICAgICAgcmV0dXJuIFsgXCI8XCIgLyogT3BlcmF0b3IuTEVTU19USEFOICovICwgXCI8PVwiIC8qIE9wZXJhdG9yLkxFU1NfVEhBTl9PUl9FUVVBTCAqLyAsIFwiPlwiIC8qIE9wZXJhdG9yLkdSRUFURVJfVEhBTiAqLyAsIFwiPj1cIiAvKiBPcGVyYXRvci5HUkVBVEVSX1RIQU5fT1JfRVFVQUwgKi8gLCBcIiE9XCIgLyogT3BlcmF0b3IuTk9UX0VRVUFMICovICwgXCJub3QtaW5cIiAvKiBPcGVyYXRvci5OT1RfSU4gKi8gXS5pbmRleE9mKHRoaXMub3ApID49IDA7XG4gICAgfVxuICAgIGdldEZsYXR0ZW5lZEZpbHRlcnMoKSB7XG4gICAgICAgIHJldHVybiBbIHRoaXMgXTtcbiAgICB9XG4gICAgZ2V0RmlsdGVycygpIHtcbiAgICAgICAgcmV0dXJuIFsgdGhpcyBdO1xuICAgIH1cbn1cblxuY2xhc3MgQ29tcG9zaXRlRmlsdGVyIGV4dGVuZHMgRmlsdGVyIHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0KSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuZmlsdGVycyA9IGUsIHRoaXMub3AgPSB0LCB0aGlzLlBlID0gbnVsbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZpbHRlciBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgYXJndW1lbnRzLlxuICAgICAqLyAgICBzdGF0aWMgY3JlYXRlKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBDb21wb3NpdGVGaWx0ZXIoZSwgdCk7XG4gICAgfVxuICAgIG1hdGNoZXMoZSkge1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX2NvbXBvc2l0ZUZpbHRlcklzQ29uanVuY3Rpb24odGhpcykgPyB2b2lkIDAgPT09IHRoaXMuZmlsdGVycy5maW5kKCh0ID0+ICF0Lm1hdGNoZXMoZSkpKSA6IHZvaWQgMCAhPT0gdGhpcy5maWx0ZXJzLmZpbmQoKHQgPT4gdC5tYXRjaGVzKGUpKSk7XG4gICAgfVxuICAgIGdldEZsYXR0ZW5lZEZpbHRlcnMoKSB7XG4gICAgICAgIHJldHVybiBudWxsICE9PSB0aGlzLlBlIHx8ICh0aGlzLlBlID0gdGhpcy5maWx0ZXJzLnJlZHVjZSgoKGUsIHQpID0+IGUuY29uY2F0KHQuZ2V0RmxhdHRlbmVkRmlsdGVycygpKSksIFtdKSksIFxuICAgICAgICB0aGlzLlBlO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIGEgbXV0YWJsZSBjb3B5IG9mIGB0aGlzLmZpbHRlcnNgXG4gICAgZ2V0RmlsdGVycygpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oW10sIHRoaXMuZmlsdGVycyk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfY29tcG9zaXRlRmlsdGVySXNDb25qdW5jdGlvbihlKSB7XG4gICAgcmV0dXJuIFwiYW5kXCIgLyogQ29tcG9zaXRlT3BlcmF0b3IuQU5EICovID09PSBlLm9wO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfY29tcG9zaXRlRmlsdGVySXNEaXNqdW5jdGlvbihlKSB7XG4gICAgcmV0dXJuIFwib3JcIiAvKiBDb21wb3NpdGVPcGVyYXRvci5PUiAqLyA9PT0gZS5vcDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBmaWx0ZXIgaXMgYSBjb25qdW5jdGlvbiBvZiBmaWVsZCBmaWx0ZXJzIG9ubHkuIFJldHVybnMgZmFsc2Ugb3RoZXJ3aXNlLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9jb21wb3NpdGVGaWx0ZXJJc0ZsYXRDb25qdW5jdGlvbihlKSB7XG4gICAgcmV0dXJuIF9fUFJJVkFURV9jb21wb3NpdGVGaWx0ZXJJc0ZsYXQoZSkgJiYgX19QUklWQVRFX2NvbXBvc2l0ZUZpbHRlcklzQ29uanVuY3Rpb24oZSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoaXMgZmlsdGVyIGRvZXMgbm90IGNvbnRhaW4gYW55IGNvbXBvc2l0ZSBmaWx0ZXJzLiBSZXR1cm5zIGZhbHNlIG90aGVyd2lzZS5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfY29tcG9zaXRlRmlsdGVySXNGbGF0KGUpIHtcbiAgICBmb3IgKGNvbnN0IHQgb2YgZS5maWx0ZXJzKSBpZiAodCBpbnN0YW5jZW9mIENvbXBvc2l0ZUZpbHRlcikgcmV0dXJuICExO1xuICAgIHJldHVybiAhMDtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2Nhbm9uaWZ5RmlsdGVyKGUpIHtcbiAgICBpZiAoZSBpbnN0YW5jZW9mIEZpZWxkRmlsdGVyKSBcbiAgICAvLyBUT0RPKGIvMjkxODMxNjUpOiBUZWNobmljYWxseSwgdGhpcyB3b24ndCBiZSB1bmlxdWUgaWYgdHdvIHZhbHVlcyBoYXZlXG4gICAgLy8gdGhlIHNhbWUgZGVzY3JpcHRpb24sIHN1Y2ggYXMgdGhlIGludCAzIGFuZCB0aGUgc3RyaW5nIFwiM1wiLiBTbyB3ZSBzaG91bGRcbiAgICAvLyBhZGQgdGhlIHR5cGVzIGluIGhlcmUgc29tZWhvdywgdG9vLlxuICAgIHJldHVybiBlLmZpZWxkLmNhbm9uaWNhbFN0cmluZygpICsgZS5vcC50b1N0cmluZygpICsgY2Fub25pY2FsSWQoZS52YWx1ZSk7XG4gICAgaWYgKF9fUFJJVkFURV9jb21wb3NpdGVGaWx0ZXJJc0ZsYXRDb25qdW5jdGlvbihlKSkgXG4gICAgLy8gT2xkZXIgU0RLIHZlcnNpb25zIHVzZSBhbiBpbXBsaWNpdCBBTkQgb3BlcmF0aW9uIGJldHdlZW4gdGhlaXIgZmlsdGVycy5cbiAgICAvLyBJbiB0aGUgbmV3IFNESyB2ZXJzaW9ucywgdGhlIGRldmVsb3BlciBtYXkgdXNlIGFuIGV4cGxpY2l0IEFORCBmaWx0ZXIuXG4gICAgLy8gVG8gc3RheSBjb25zaXN0ZW50IHdpdGggdGhlIG9sZCB1c2FnZXMsIHdlIGFkZCBhIHNwZWNpYWwgY2FzZSB0byBlbnN1cmVcbiAgICAvLyB0aGUgY2Fub25pY2FsIElEIGZvciB0aGVzZSB0d28gYXJlIHRoZSBzYW1lLiBGb3IgZXhhbXBsZTpcbiAgICAvLyBgY29sLndoZXJlRXF1YWxzKFwiYVwiLCAxKS53aGVyZUVxdWFscyhcImJcIiwgMilgIHNob3VsZCBoYXZlIHRoZSBzYW1lXG4gICAgLy8gY2Fub25pY2FsIElEIGFzIGBjb2wud2hlcmUoYW5kKGVxdWFscyhcImFcIiwxKSwgZXF1YWxzKFwiYlwiLDIpKSlgLlxuICAgIHJldHVybiBlLmZpbHRlcnMubWFwKChlID0+IF9fUFJJVkFURV9jYW5vbmlmeUZpbHRlcihlKSkpLmpvaW4oXCIsXCIpO1xuICAgIHtcbiAgICAgICAgLy8gZmlsdGVyIGluc3RhbmNlb2YgQ29tcG9zaXRlRmlsdGVyXG4gICAgICAgIGNvbnN0IHQgPSBlLmZpbHRlcnMubWFwKChlID0+IF9fUFJJVkFURV9jYW5vbmlmeUZpbHRlcihlKSkpLmpvaW4oXCIsXCIpO1xuICAgICAgICByZXR1cm4gYCR7ZS5vcH0oJHt0fSlgO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2ZpbHRlckVxdWFscyhlLCB0KSB7XG4gICAgcmV0dXJuIGUgaW5zdGFuY2VvZiBGaWVsZEZpbHRlciA/IGZ1bmN0aW9uIF9fUFJJVkFURV9maWVsZEZpbHRlckVxdWFscyhlLCB0KSB7XG4gICAgICAgIHJldHVybiB0IGluc3RhbmNlb2YgRmllbGRGaWx0ZXIgJiYgZS5vcCA9PT0gdC5vcCAmJiBlLmZpZWxkLmlzRXF1YWwodC5maWVsZCkgJiYgX19QUklWQVRFX3ZhbHVlRXF1YWxzKGUudmFsdWUsIHQudmFsdWUpO1xuICAgIH0oZSwgdCkgOiBlIGluc3RhbmNlb2YgQ29tcG9zaXRlRmlsdGVyID8gZnVuY3Rpb24gX19QUklWQVRFX2NvbXBvc2l0ZUZpbHRlckVxdWFscyhlLCB0KSB7XG4gICAgICAgIGlmICh0IGluc3RhbmNlb2YgQ29tcG9zaXRlRmlsdGVyICYmIGUub3AgPT09IHQub3AgJiYgZS5maWx0ZXJzLmxlbmd0aCA9PT0gdC5maWx0ZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGUuZmlsdGVycy5yZWR1Y2UoKChlLCBuLCByKSA9PiBlICYmIF9fUFJJVkFURV9maWx0ZXJFcXVhbHMobiwgdC5maWx0ZXJzW3JdKSksICEwKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIC8qKlxuICogUmV0dXJucyBhIG5ldyBjb21wb3NpdGUgZmlsdGVyIHRoYXQgY29udGFpbnMgYWxsIGZpbHRlciBmcm9tXG4gKiBgY29tcG9zaXRlRmlsdGVyYCBwbHVzIGFsbCB0aGUgZ2l2ZW4gZmlsdGVycyBpbiBgb3RoZXJGaWx0ZXJzYC5cbiAqLyAoZSwgdCkgOiB2b2lkIGZhaWwoMTk0MzkpO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfY29tcG9zaXRlRmlsdGVyV2l0aEFkZGVkRmlsdGVycyhlLCB0KSB7XG4gICAgY29uc3QgbiA9IGUuZmlsdGVycy5jb25jYXQodCk7XG4gICAgcmV0dXJuIENvbXBvc2l0ZUZpbHRlci5jcmVhdGUobiwgZS5vcCk7XG59XG5cbi8qKiBSZXR1cm5zIGEgZGVidWcgZGVzY3JpcHRpb24gZm9yIGBmaWx0ZXJgLiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfc3RyaW5naWZ5RmlsdGVyKGUpIHtcbiAgICByZXR1cm4gZSBpbnN0YW5jZW9mIEZpZWxkRmlsdGVyID8gZnVuY3Rpb24gX19QUklWQVRFX3N0cmluZ2lmeUZpZWxkRmlsdGVyKGUpIHtcbiAgICAgICAgcmV0dXJuIGAke2UuZmllbGQuY2Fub25pY2FsU3RyaW5nKCl9ICR7ZS5vcH0gJHtjYW5vbmljYWxJZChlLnZhbHVlKX1gO1xuICAgIH1cbiAgICAvKiogRmlsdGVyIHRoYXQgbWF0Y2hlcyBvbiBrZXkgZmllbGRzIChpLmUuICdfX25hbWVfXycpLiAqLyAoZSkgOiBlIGluc3RhbmNlb2YgQ29tcG9zaXRlRmlsdGVyID8gZnVuY3Rpb24gX19QUklWQVRFX3N0cmluZ2lmeUNvbXBvc2l0ZUZpbHRlcihlKSB7XG4gICAgICAgIHJldHVybiBlLm9wLnRvU3RyaW5nKCkgKyBcIiB7XCIgKyBlLmdldEZpbHRlcnMoKS5tYXAoX19QUklWQVRFX3N0cmluZ2lmeUZpbHRlcikuam9pbihcIiAsXCIpICsgXCJ9XCI7XG4gICAgfShlKSA6IFwiRmlsdGVyXCI7XG59XG5cbmNsYXNzIF9fUFJJVkFURV9LZXlGaWVsZEZpbHRlciBleHRlbmRzIEZpZWxkRmlsdGVyIHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0LCBuKSB7XG4gICAgICAgIHN1cGVyKGUsIHQsIG4pLCB0aGlzLmtleSA9IERvY3VtZW50S2V5LmZyb21OYW1lKG4ucmVmZXJlbmNlVmFsdWUpO1xuICAgIH1cbiAgICBtYXRjaGVzKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IERvY3VtZW50S2V5LmNvbXBhcmF0b3IoZS5rZXksIHRoaXMua2V5KTtcbiAgICAgICAgcmV0dXJuIHRoaXMubWF0Y2hlc0NvbXBhcmlzb24odCk7XG4gICAgfVxufVxuXG4vKiogRmlsdGVyIHRoYXQgbWF0Y2hlcyBvbiBrZXkgZmllbGRzIHdpdGhpbiBhbiBhcnJheS4gKi8gY2xhc3MgX19QUklWQVRFX0tleUZpZWxkSW5GaWx0ZXIgZXh0ZW5kcyBGaWVsZEZpbHRlciB7XG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICBzdXBlcihlLCBcImluXCIgLyogT3BlcmF0b3IuSU4gKi8gLCB0KSwgdGhpcy5rZXlzID0gX19QUklWQVRFX2V4dHJhY3REb2N1bWVudEtleXNGcm9tQXJyYXlWYWx1ZShcImluXCIgLyogT3BlcmF0b3IuSU4gKi8gLCB0KTtcbiAgICB9XG4gICAgbWF0Y2hlcyhlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmtleXMuc29tZSgodCA9PiB0LmlzRXF1YWwoZS5rZXkpKSk7XG4gICAgfVxufVxuXG4vKiogRmlsdGVyIHRoYXQgbWF0Y2hlcyBvbiBrZXkgZmllbGRzIG5vdCBwcmVzZW50IHdpdGhpbiBhbiBhcnJheS4gKi8gY2xhc3MgX19QUklWQVRFX0tleUZpZWxkTm90SW5GaWx0ZXIgZXh0ZW5kcyBGaWVsZEZpbHRlciB7XG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICBzdXBlcihlLCBcIm5vdC1pblwiIC8qIE9wZXJhdG9yLk5PVF9JTiAqLyAsIHQpLCB0aGlzLmtleXMgPSBfX1BSSVZBVEVfZXh0cmFjdERvY3VtZW50S2V5c0Zyb21BcnJheVZhbHVlKFwibm90LWluXCIgLyogT3BlcmF0b3IuTk9UX0lOICovICwgdCk7XG4gICAgfVxuICAgIG1hdGNoZXMoZSkge1xuICAgICAgICByZXR1cm4gIXRoaXMua2V5cy5zb21lKCh0ID0+IHQuaXNFcXVhbChlLmtleSkpKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9leHRyYWN0RG9jdW1lbnRLZXlzRnJvbUFycmF5VmFsdWUoZSwgdCkge1xuICAgIHJldHVybiAodC5hcnJheVZhbHVlPy52YWx1ZXMgfHwgW10pLm1hcCgoZSA9PiBEb2N1bWVudEtleS5mcm9tTmFtZShlLnJlZmVyZW5jZVZhbHVlKSkpO1xufVxuXG4vKiogQSBGaWx0ZXIgdGhhdCBpbXBsZW1lbnRzIHRoZSBhcnJheS1jb250YWlucyBvcGVyYXRvci4gKi8gY2xhc3MgX19QUklWQVRFX0FycmF5Q29udGFpbnNGaWx0ZXIgZXh0ZW5kcyBGaWVsZEZpbHRlciB7XG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICBzdXBlcihlLCBcImFycmF5LWNvbnRhaW5zXCIgLyogT3BlcmF0b3IuQVJSQVlfQ09OVEFJTlMgKi8gLCB0KTtcbiAgICB9XG4gICAgbWF0Y2hlcyhlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBlLmRhdGEuZmllbGQodGhpcy5maWVsZCk7XG4gICAgICAgIHJldHVybiBpc0FycmF5KHQpICYmIF9fUFJJVkFURV9hcnJheVZhbHVlQ29udGFpbnModC5hcnJheVZhbHVlLCB0aGlzLnZhbHVlKTtcbiAgICB9XG59XG5cbi8qKiBBIEZpbHRlciB0aGF0IGltcGxlbWVudHMgdGhlIElOIG9wZXJhdG9yLiAqLyBjbGFzcyBfX1BSSVZBVEVfSW5GaWx0ZXIgZXh0ZW5kcyBGaWVsZEZpbHRlciB7XG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICBzdXBlcihlLCBcImluXCIgLyogT3BlcmF0b3IuSU4gKi8gLCB0KTtcbiAgICB9XG4gICAgbWF0Y2hlcyhlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBlLmRhdGEuZmllbGQodGhpcy5maWVsZCk7XG4gICAgICAgIHJldHVybiBudWxsICE9PSB0ICYmIF9fUFJJVkFURV9hcnJheVZhbHVlQ29udGFpbnModGhpcy52YWx1ZS5hcnJheVZhbHVlLCB0KTtcbiAgICB9XG59XG5cbi8qKiBBIEZpbHRlciB0aGF0IGltcGxlbWVudHMgdGhlIG5vdC1pbiBvcGVyYXRvci4gKi8gY2xhc3MgX19QUklWQVRFX05vdEluRmlsdGVyIGV4dGVuZHMgRmllbGRGaWx0ZXIge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQpIHtcbiAgICAgICAgc3VwZXIoZSwgXCJub3QtaW5cIiAvKiBPcGVyYXRvci5OT1RfSU4gKi8gLCB0KTtcbiAgICB9XG4gICAgbWF0Y2hlcyhlKSB7XG4gICAgICAgIGlmIChfX1BSSVZBVEVfYXJyYXlWYWx1ZUNvbnRhaW5zKHRoaXMudmFsdWUuYXJyYXlWYWx1ZSwge1xuICAgICAgICAgICAgbnVsbFZhbHVlOiBcIk5VTExfVkFMVUVcIlxuICAgICAgICB9KSkgcmV0dXJuICExO1xuICAgICAgICBjb25zdCB0ID0gZS5kYXRhLmZpZWxkKHRoaXMuZmllbGQpO1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gdCAmJiB2b2lkIDAgPT09IHQubnVsbFZhbHVlICYmICFfX1BSSVZBVEVfYXJyYXlWYWx1ZUNvbnRhaW5zKHRoaXMudmFsdWUuYXJyYXlWYWx1ZSwgdCk7XG4gICAgfVxufVxuXG4vKiogQSBGaWx0ZXIgdGhhdCBpbXBsZW1lbnRzIHRoZSBhcnJheS1jb250YWlucy1hbnkgb3BlcmF0b3IuICovIGNsYXNzIF9fUFJJVkFURV9BcnJheUNvbnRhaW5zQW55RmlsdGVyIGV4dGVuZHMgRmllbGRGaWx0ZXIge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQpIHtcbiAgICAgICAgc3VwZXIoZSwgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBPcGVyYXRvci5BUlJBWV9DT05UQUlOU19BTlkgKi8gLCB0KTtcbiAgICB9XG4gICAgbWF0Y2hlcyhlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBlLmRhdGEuZmllbGQodGhpcy5maWVsZCk7XG4gICAgICAgIHJldHVybiAhKCFpc0FycmF5KHQpIHx8ICF0LmFycmF5VmFsdWUudmFsdWVzKSAmJiB0LmFycmF5VmFsdWUudmFsdWVzLnNvbWUoKGUgPT4gX19QUklWQVRFX2FycmF5VmFsdWVDb250YWlucyh0aGlzLnZhbHVlLmFycmF5VmFsdWUsIGUpKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gVmlzaWJsZSBmb3IgdGVzdGluZ1xuY2xhc3MgX19QUklWQVRFX1RhcmdldEltcGwge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQgPSBudWxsLCBuID0gW10sIHIgPSBbXSwgaSA9IG51bGwsIHMgPSBudWxsLCBvID0gbnVsbCkge1xuICAgICAgICB0aGlzLnBhdGggPSBlLCB0aGlzLmNvbGxlY3Rpb25Hcm91cCA9IHQsIHRoaXMub3JkZXJCeSA9IG4sIHRoaXMuZmlsdGVycyA9IHIsIHRoaXMubGltaXQgPSBpLCBcbiAgICAgICAgdGhpcy5zdGFydEF0ID0gcywgdGhpcy5lbmRBdCA9IG8sIHRoaXMuVGUgPSBudWxsO1xuICAgIH1cbn1cblxuLyoqXG4gKiBJbml0aWFsaXplcyBhIFRhcmdldCB3aXRoIGEgcGF0aCBhbmQgb3B0aW9uYWwgYWRkaXRpb25hbCBxdWVyeSBjb25zdHJhaW50cy5cbiAqIFBhdGggbXVzdCBjdXJyZW50bHkgYmUgZW1wdHkgaWYgdGhpcyBpcyBhIGNvbGxlY3Rpb24gZ3JvdXAgcXVlcnkuXG4gKlxuICogTk9URTogeW91IHNob3VsZCBhbHdheXMgY29uc3RydWN0IGBUYXJnZXRgIGZyb20gYFF1ZXJ5LnRvVGFyZ2V0YCBpbnN0ZWFkIG9mXG4gKiB1c2luZyB0aGlzIGZhY3RvcnkgbWV0aG9kLCBiZWNhdXNlIGBRdWVyeWAgcHJvdmlkZXMgYW4gaW1wbGljaXQgYG9yZGVyQnlgXG4gKiBwcm9wZXJ0eS5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfbmV3VGFyZ2V0KGUsIHQgPSBudWxsLCBuID0gW10sIHIgPSBbXSwgaSA9IG51bGwsIHMgPSBudWxsLCBvID0gbnVsbCkge1xuICAgIHJldHVybiBuZXcgX19QUklWQVRFX1RhcmdldEltcGwoZSwgdCwgbiwgciwgaSwgcywgbyk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9jYW5vbmlmeVRhcmdldChlKSB7XG4gICAgY29uc3QgdCA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgaWYgKG51bGwgPT09IHQuVGUpIHtcbiAgICAgICAgbGV0IGUgPSB0LnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgICAgIG51bGwgIT09IHQuY29sbGVjdGlvbkdyb3VwICYmIChlICs9IFwifGNnOlwiICsgdC5jb2xsZWN0aW9uR3JvdXApLCBlICs9IFwifGY6XCIsIGUgKz0gdC5maWx0ZXJzLm1hcCgoZSA9PiBfX1BSSVZBVEVfY2Fub25pZnlGaWx0ZXIoZSkpKS5qb2luKFwiLFwiKSwgXG4gICAgICAgIGUgKz0gXCJ8b2I6XCIsIGUgKz0gdC5vcmRlckJ5Lm1hcCgoZSA9PiBmdW5jdGlvbiBfX1BSSVZBVEVfY2Fub25pZnlPcmRlckJ5KGUpIHtcbiAgICAgICAgICAgIC8vIFRPRE8oYi8yOTE4MzE2NSk6IE1ha2UgdGhpcyBjb2xsaXNpb24gcm9idXN0LlxuICAgICAgICAgICAgcmV0dXJuIGUuZmllbGQuY2Fub25pY2FsU3RyaW5nKCkgKyBlLmRpcjtcbiAgICAgICAgfShlKSkpLmpvaW4oXCIsXCIpLCBfX1BSSVZBVEVfaXNOdWxsT3JVbmRlZmluZWQodC5saW1pdCkgfHwgKGUgKz0gXCJ8bDpcIiwgZSArPSB0LmxpbWl0KSwgXG4gICAgICAgIHQuc3RhcnRBdCAmJiAoZSArPSBcInxsYjpcIiwgZSArPSB0LnN0YXJ0QXQuaW5jbHVzaXZlID8gXCJiOlwiIDogXCJhOlwiLCBlICs9IHQuc3RhcnRBdC5wb3NpdGlvbi5tYXAoKGUgPT4gY2Fub25pY2FsSWQoZSkpKS5qb2luKFwiLFwiKSksIFxuICAgICAgICB0LmVuZEF0ICYmIChlICs9IFwifHViOlwiLCBlICs9IHQuZW5kQXQuaW5jbHVzaXZlID8gXCJhOlwiIDogXCJiOlwiLCBlICs9IHQuZW5kQXQucG9zaXRpb24ubWFwKChlID0+IGNhbm9uaWNhbElkKGUpKSkuam9pbihcIixcIikpLCBcbiAgICAgICAgdC5UZSA9IGU7XG4gICAgfVxuICAgIHJldHVybiB0LlRlO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfdGFyZ2V0RXF1YWxzKGUsIHQpIHtcbiAgICBpZiAoZS5saW1pdCAhPT0gdC5saW1pdCkgcmV0dXJuICExO1xuICAgIGlmIChlLm9yZGVyQnkubGVuZ3RoICE9PSB0Lm9yZGVyQnkubGVuZ3RoKSByZXR1cm4gITE7XG4gICAgZm9yIChsZXQgbiA9IDA7IG4gPCBlLm9yZGVyQnkubGVuZ3RoOyBuKyspIGlmICghX19QUklWQVRFX29yZGVyQnlFcXVhbHMoZS5vcmRlckJ5W25dLCB0Lm9yZGVyQnlbbl0pKSByZXR1cm4gITE7XG4gICAgaWYgKGUuZmlsdGVycy5sZW5ndGggIT09IHQuZmlsdGVycy5sZW5ndGgpIHJldHVybiAhMTtcbiAgICBmb3IgKGxldCBuID0gMDsgbiA8IGUuZmlsdGVycy5sZW5ndGg7IG4rKykgaWYgKCFfX1BSSVZBVEVfZmlsdGVyRXF1YWxzKGUuZmlsdGVyc1tuXSwgdC5maWx0ZXJzW25dKSkgcmV0dXJuICExO1xuICAgIHJldHVybiBlLmNvbGxlY3Rpb25Hcm91cCA9PT0gdC5jb2xsZWN0aW9uR3JvdXAgJiYgKCEhZS5wYXRoLmlzRXF1YWwodC5wYXRoKSAmJiAoISFfX1BSSVZBVEVfYm91bmRFcXVhbHMoZS5zdGFydEF0LCB0LnN0YXJ0QXQpICYmIF9fUFJJVkFURV9ib3VuZEVxdWFscyhlLmVuZEF0LCB0LmVuZEF0KSkpO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfdGFyZ2V0SXNEb2N1bWVudFRhcmdldChlKSB7XG4gICAgcmV0dXJuIERvY3VtZW50S2V5LmlzRG9jdW1lbnRLZXkoZS5wYXRoKSAmJiBudWxsID09PSBlLmNvbGxlY3Rpb25Hcm91cCAmJiAwID09PSBlLmZpbHRlcnMubGVuZ3RoO1xufVxuXG4vKiogUmV0dXJucyB0aGUgZmllbGQgZmlsdGVycyB0aGF0IHRhcmdldCB0aGUgZ2l2ZW4gZmllbGQgcGF0aC4gKi8gZnVuY3Rpb24gX19QUklWQVRFX3RhcmdldEdldEZpZWxkRmlsdGVyc0ZvclBhdGgoZSwgdCkge1xuICAgIHJldHVybiBlLmZpbHRlcnMuZmlsdGVyKChlID0+IGUgaW5zdGFuY2VvZiBGaWVsZEZpbHRlciAmJiBlLmZpZWxkLmlzRXF1YWwodCkpKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSB2YWx1ZXMgdGhhdCBhcmUgdXNlZCBpbiBBUlJBWV9DT05UQUlOUyBvciBBUlJBWV9DT05UQUlOU19BTllcbiAqIGZpbHRlcnMuIFJldHVybnMgYG51bGxgIGlmIHRoZXJlIGFyZSBubyBzdWNoIGZpbHRlcnMuXG4gKi9cbi8qKlxuICogUmV0dXJucyB0aGUgdmFsdWUgdG8gdXNlIGFzIHRoZSBsb3dlciBib3VuZCBmb3IgYXNjZW5kaW5nIGluZGV4IHNlZ21lbnQgYXRcbiAqIHRoZSBwcm92aWRlZCBgZmllbGRQYXRoYCAob3IgdGhlIHVwcGVyIGJvdW5kIGZvciBhbiBkZXNjZW5kaW5nIHNlZ21lbnQpLlxuICovXG5mdW5jdGlvbiBfX1BSSVZBVEVfdGFyZ2V0R2V0QXNjZW5kaW5nQm91bmQoZSwgdCwgbikge1xuICAgIGxldCByID0gZHQsIGkgPSAhMDtcbiAgICAvLyBQcm9jZXNzIGFsbCBmaWx0ZXJzIHRvIGZpbmQgYSB2YWx1ZSBmb3IgdGhlIGN1cnJlbnQgZmllbGQgc2VnbWVudFxuICAgIGZvciAoY29uc3QgbiBvZiBfX1BSSVZBVEVfdGFyZ2V0R2V0RmllbGRGaWx0ZXJzRm9yUGF0aChlLCB0KSkge1xuICAgICAgICBsZXQgZSA9IGR0LCB0ID0gITA7XG4gICAgICAgIHN3aXRjaCAobi5vcCkge1xuICAgICAgICAgIGNhc2UgXCI8XCIgLyogT3BlcmF0b3IuTEVTU19USEFOICovIDpcbiAgICAgICAgICBjYXNlIFwiPD1cIiAvKiBPcGVyYXRvci5MRVNTX1RIQU5fT1JfRVFVQUwgKi8gOlxuICAgICAgICAgICAgZSA9IF9fUFJJVkFURV92YWx1ZXNHZXRMb3dlckJvdW5kKG4udmFsdWUpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIFwiPT1cIiAvKiBPcGVyYXRvci5FUVVBTCAqLyA6XG4gICAgICAgICAgY2FzZSBcImluXCIgLyogT3BlcmF0b3IuSU4gKi8gOlxuICAgICAgICAgIGNhc2UgXCI+PVwiIC8qIE9wZXJhdG9yLkdSRUFURVJfVEhBTl9PUl9FUVVBTCAqLyA6XG4gICAgICAgICAgICBlID0gbi52YWx1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBcIj5cIiAvKiBPcGVyYXRvci5HUkVBVEVSX1RIQU4gKi8gOlxuICAgICAgICAgICAgZSA9IG4udmFsdWUsIHQgPSAhMTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBcIiE9XCIgLyogT3BlcmF0b3IuTk9UX0VRVUFMICovIDpcbiAgICAgICAgICBjYXNlIFwibm90LWluXCIgLyogT3BlcmF0b3IuTk9UX0lOICovIDpcbiAgICAgICAgICAgIGUgPSBkdDtcbiAvLyBSZW1haW5pbmcgZmlsdGVycyBjYW5ub3QgYmUgdXNlZCBhcyBsb3dlciBib3VuZHMuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICBfX1BSSVZBVEVfbG93ZXJCb3VuZENvbXBhcmUoe1xuICAgICAgICAgICAgdmFsdWU6IHIsXG4gICAgICAgICAgICBpbmNsdXNpdmU6IGlcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdmFsdWU6IGUsXG4gICAgICAgICAgICBpbmNsdXNpdmU6IHRcbiAgICAgICAgfSkgPCAwICYmIChyID0gZSwgaSA9IHQpO1xuICAgIH1cbiAgICAvLyBJZiB0aGVyZSBpcyBhbiBhZGRpdGlvbmFsIGJvdW5kLCBjb21wYXJlIHRoZSB2YWx1ZXMgYWdhaW5zdCB0aGUgZXhpc3RpbmdcbiAgICAvLyByYW5nZSB0byBzZWUgaWYgd2UgY2FuIG5hcnJvdyB0aGUgc2NvcGUuXG4gICAgICAgIGlmIChudWxsICE9PSBuKSBmb3IgKGxldCBzID0gMDsgcyA8IGUub3JkZXJCeS5sZW5ndGg7ICsrcykge1xuICAgICAgICBpZiAoZS5vcmRlckJ5W3NdLmZpZWxkLmlzRXF1YWwodCkpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBuLnBvc2l0aW9uW3NdO1xuICAgICAgICAgICAgX19QUklWQVRFX2xvd2VyQm91bmRDb21wYXJlKHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogcixcbiAgICAgICAgICAgICAgICBpbmNsdXNpdmU6IGlcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogZSxcbiAgICAgICAgICAgICAgICBpbmNsdXNpdmU6IG4uaW5jbHVzaXZlXG4gICAgICAgICAgICB9KSA8IDAgJiYgKHIgPSBlLCBpID0gbi5pbmNsdXNpdmUpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IHIsXG4gICAgICAgIGluY2x1c2l2ZTogaVxuICAgIH07XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgdmFsdWUgdG8gdXNlIGFzIHRoZSB1cHBlciBib3VuZCBmb3IgYXNjZW5kaW5nIGluZGV4IHNlZ21lbnQgYXRcbiAqIHRoZSBwcm92aWRlZCBgZmllbGRQYXRoYCAob3IgdGhlIGxvd2VyIGJvdW5kIGZvciBhIGRlc2NlbmRpbmcgc2VnbWVudCkuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX3RhcmdldEdldERlc2NlbmRpbmdCb3VuZChlLCB0LCBuKSB7XG4gICAgbGV0IHIgPSBUdCwgaSA9ICEwO1xuICAgIC8vIFByb2Nlc3MgYWxsIGZpbHRlcnMgdG8gZmluZCBhIHZhbHVlIGZvciB0aGUgY3VycmVudCBmaWVsZCBzZWdtZW50XG4gICAgZm9yIChjb25zdCBuIG9mIF9fUFJJVkFURV90YXJnZXRHZXRGaWVsZEZpbHRlcnNGb3JQYXRoKGUsIHQpKSB7XG4gICAgICAgIGxldCBlID0gVHQsIHQgPSAhMDtcbiAgICAgICAgc3dpdGNoIChuLm9wKSB7XG4gICAgICAgICAgY2FzZSBcIj49XCIgLyogT3BlcmF0b3IuR1JFQVRFUl9USEFOX09SX0VRVUFMICovIDpcbiAgICAgICAgICBjYXNlIFwiPlwiIC8qIE9wZXJhdG9yLkdSRUFURVJfVEhBTiAqLyA6XG4gICAgICAgICAgICBlID0gX19QUklWQVRFX3ZhbHVlc0dldFVwcGVyQm91bmQobi52YWx1ZSksIHQgPSAhMTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBcIj09XCIgLyogT3BlcmF0b3IuRVFVQUwgKi8gOlxuICAgICAgICAgIGNhc2UgXCJpblwiIC8qIE9wZXJhdG9yLklOICovIDpcbiAgICAgICAgICBjYXNlIFwiPD1cIiAvKiBPcGVyYXRvci5MRVNTX1RIQU5fT1JfRVFVQUwgKi8gOlxuICAgICAgICAgICAgZSA9IG4udmFsdWU7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgXCI8XCIgLyogT3BlcmF0b3IuTEVTU19USEFOICovIDpcbiAgICAgICAgICAgIGUgPSBuLnZhbHVlLCB0ID0gITE7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgXCIhPVwiIC8qIE9wZXJhdG9yLk5PVF9FUVVBTCAqLyA6XG4gICAgICAgICAgY2FzZSBcIm5vdC1pblwiIC8qIE9wZXJhdG9yLk5PVF9JTiAqLyA6XG4gICAgICAgICAgICBlID0gVHQ7XG4gLy8gUmVtYWluaW5nIGZpbHRlcnMgY2Fubm90IGJlIHVzZWQgYXMgdXBwZXIgYm91bmRzLlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgX19QUklWQVRFX3VwcGVyQm91bmRDb21wYXJlKHtcbiAgICAgICAgICAgIHZhbHVlOiByLFxuICAgICAgICAgICAgaW5jbHVzaXZlOiBpXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIHZhbHVlOiBlLFxuICAgICAgICAgICAgaW5jbHVzaXZlOiB0XG4gICAgICAgIH0pID4gMCAmJiAociA9IGUsIGkgPSB0KTtcbiAgICB9XG4gICAgLy8gSWYgdGhlcmUgaXMgYW4gYWRkaXRpb25hbCBib3VuZCwgY29tcGFyZSB0aGUgdmFsdWVzIGFnYWluc3QgdGhlIGV4aXN0aW5nXG4gICAgLy8gcmFuZ2UgdG8gc2VlIGlmIHdlIGNhbiBuYXJyb3cgdGhlIHNjb3BlLlxuICAgICAgICBpZiAobnVsbCAhPT0gbikgZm9yIChsZXQgcyA9IDA7IHMgPCBlLm9yZGVyQnkubGVuZ3RoOyArK3MpIHtcbiAgICAgICAgaWYgKGUub3JkZXJCeVtzXS5maWVsZC5pc0VxdWFsKHQpKSB7XG4gICAgICAgICAgICBjb25zdCBlID0gbi5wb3NpdGlvbltzXTtcbiAgICAgICAgICAgIF9fUFJJVkFURV91cHBlckJvdW5kQ29tcGFyZSh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IHIsXG4gICAgICAgICAgICAgICAgaW5jbHVzaXZlOiBpXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IGUsXG4gICAgICAgICAgICAgICAgaW5jbHVzaXZlOiBuLmluY2x1c2l2ZVxuICAgICAgICAgICAgfSkgPiAwICYmIChyID0gZSwgaSA9IG4uaW5jbHVzaXZlKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiByLFxuICAgICAgICBpbmNsdXNpdmU6IGlcbiAgICB9O1xufVxuXG4vKiogUmV0dXJucyB0aGUgbnVtYmVyIG9mIHNlZ21lbnRzIG9mIGEgcGVyZmVjdCBpbmRleCBmb3IgdGhpcyB0YXJnZXQuICovXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBRdWVyeSBlbmNhcHN1bGF0ZXMgYWxsIHRoZSBxdWVyeSBhdHRyaWJ1dGVzIHdlIHN1cHBvcnQgaW4gdGhlIFNESy4gSXQgY2FuXG4gKiBiZSBydW4gYWdhaW5zdCB0aGUgTG9jYWxTdG9yZSwgYXMgd2VsbCBhcyBiZSBjb252ZXJ0ZWQgdG8gYSBgVGFyZ2V0YCB0b1xuICogcXVlcnkgdGhlIFJlbW90ZVN0b3JlIHJlc3VsdHMuXG4gKlxuICogVmlzaWJsZSBmb3IgdGVzdGluZy5cbiAqL1xuY2xhc3MgX19QUklWQVRFX1F1ZXJ5SW1wbCB7XG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZXMgYSBRdWVyeSB3aXRoIGEgcGF0aCBhbmQgb3B0aW9uYWwgYWRkaXRpb25hbCBxdWVyeSBjb25zdHJhaW50cy5cbiAgICAgKiBQYXRoIG11c3QgY3VycmVudGx5IGJlIGVtcHR5IGlmIHRoaXMgaXMgYSBjb2xsZWN0aW9uIGdyb3VwIHF1ZXJ5LlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGUsIHQgPSBudWxsLCBuID0gW10sIHIgPSBbXSwgaSA9IG51bGwsIHMgPSBcIkZcIiAvKiBMaW1pdFR5cGUuRmlyc3QgKi8gLCBvID0gbnVsbCwgXyA9IG51bGwpIHtcbiAgICAgICAgdGhpcy5wYXRoID0gZSwgdGhpcy5jb2xsZWN0aW9uR3JvdXAgPSB0LCB0aGlzLmV4cGxpY2l0T3JkZXJCeSA9IG4sIHRoaXMuZmlsdGVycyA9IHIsIFxuICAgICAgICB0aGlzLmxpbWl0ID0gaSwgdGhpcy5saW1pdFR5cGUgPSBzLCB0aGlzLnN0YXJ0QXQgPSBvLCB0aGlzLmVuZEF0ID0gXywgdGhpcy5JZSA9IG51bGwsIFxuICAgICAgICAvLyBUaGUgY29ycmVzcG9uZGluZyBgVGFyZ2V0YCBvZiB0aGlzIGBRdWVyeWAgaW5zdGFuY2UsIGZvciB1c2Ugd2l0aFxuICAgICAgICAvLyBub24tYWdncmVnYXRlIHF1ZXJpZXMuXG4gICAgICAgIHRoaXMuRWUgPSBudWxsLCBcbiAgICAgICAgLy8gVGhlIGNvcnJlc3BvbmRpbmcgYFRhcmdldGAgb2YgdGhpcyBgUXVlcnlgIGluc3RhbmNlLCBmb3IgdXNlIHdpdGhcbiAgICAgICAgLy8gYWdncmVnYXRlIHF1ZXJpZXMuIFVubGlrZSB0YXJnZXRzIGZvciBub24tYWdncmVnYXRlIHF1ZXJpZXMsXG4gICAgICAgIC8vIGFnZ3JlZ2F0ZSBxdWVyeSB0YXJnZXRzIGRvIG5vdCBjb250YWluIG5vcm1hbGl6ZWQgb3JkZXItYnlzLCB0aGV5IG9ubHlcbiAgICAgICAgLy8gY29udGFpbiBleHBsaWNpdCBvcmRlci1ieXMuXG4gICAgICAgIHRoaXMuZGUgPSBudWxsLCB0aGlzLnN0YXJ0QXQsIHRoaXMuZW5kQXQ7XG4gICAgfVxufVxuXG4vKiogQ3JlYXRlcyBhIG5ldyBRdWVyeSBpbnN0YW5jZSB3aXRoIHRoZSBvcHRpb25zIHByb3ZpZGVkLiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfbmV3UXVlcnkoZSwgdCwgbiwgciwgaSwgcywgbywgXykge1xuICAgIHJldHVybiBuZXcgX19QUklWQVRFX1F1ZXJ5SW1wbChlLCB0LCBuLCByLCBpLCBzLCBvLCBfKTtcbn1cblxuLyoqIENyZWF0ZXMgYSBuZXcgUXVlcnkgZm9yIGEgcXVlcnkgdGhhdCBtYXRjaGVzIGFsbCBkb2N1bWVudHMgYXQgYHBhdGhgICovIGZ1bmN0aW9uIF9fUFJJVkFURV9uZXdRdWVyeUZvclBhdGgoZSkge1xuICAgIHJldHVybiBuZXcgX19QUklWQVRFX1F1ZXJ5SW1wbChlKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gY29udmVydCBhIGNvbGxlY3Rpb24gZ3JvdXAgcXVlcnkgaW50byBhIGNvbGxlY3Rpb24gcXVlcnkgYXQgYVxuICogc3BlY2lmaWMgcGF0aC4gVGhpcyBpcyB1c2VkIHdoZW4gZXhlY3V0aW5nIGNvbGxlY3Rpb24gZ3JvdXAgcXVlcmllcywgc2luY2VcbiAqIHdlIGhhdmUgdG8gc3BsaXQgdGhlIHF1ZXJ5IGludG8gYSBzZXQgb2YgY29sbGVjdGlvbiBxdWVyaWVzIGF0IG11bHRpcGxlXG4gKiBwYXRocy5cbiAqL1xuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBxdWVyeSBkb2VzIG5vdCBzcGVjaWZ5IGFueSBxdWVyeSBjb25zdHJhaW50cyB0aGF0XG4gKiBjb3VsZCByZW1vdmUgcmVzdWx0cy5cbiAqL1xuZnVuY3Rpb24gX19QUklWQVRFX3F1ZXJ5TWF0Y2hlc0FsbERvY3VtZW50cyhlKSB7XG4gICAgcmV0dXJuIDAgPT09IGUuZmlsdGVycy5sZW5ndGggJiYgbnVsbCA9PT0gZS5saW1pdCAmJiBudWxsID09IGUuc3RhcnRBdCAmJiBudWxsID09IGUuZW5kQXQgJiYgKDAgPT09IGUuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCB8fCAxID09PSBlLmV4cGxpY2l0T3JkZXJCeS5sZW5ndGggJiYgZS5leHBsaWNpdE9yZGVyQnlbMF0uZmllbGQuaXNLZXlGaWVsZCgpKTtcbn1cblxuLy8gUmV0dXJucyB0aGUgc29ydGVkIHNldCBvZiBpbmVxdWFsaXR5IGZpbHRlciBmaWVsZHMgdXNlZCBpbiB0aGlzIHF1ZXJ5LlxuLyoqXG4gKiBSZXR1cm5zIHdoZXRoZXIgdGhlIHF1ZXJ5IG1hdGNoZXMgYSBjb2xsZWN0aW9uIGdyb3VwIHJhdGhlciB0aGFuIGEgc3BlY2lmaWNcbiAqIGNvbGxlY3Rpb24uXG4gKi9cbmZ1bmN0aW9uIF9fUFJJVkFURV9pc0NvbGxlY3Rpb25Hcm91cFF1ZXJ5KGUpIHtcbiAgICByZXR1cm4gbnVsbCAhPT0gZS5jb2xsZWN0aW9uR3JvdXA7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgbm9ybWFsaXplZCBvcmRlci1ieSBjb25zdHJhaW50IHRoYXQgaXMgdXNlZCB0byBleGVjdXRlIHRoZSBRdWVyeSxcbiAqIHdoaWNoIGNhbiBiZSBkaWZmZXJlbnQgZnJvbSB0aGUgb3JkZXItYnkgY29uc3RyYWludHMgdGhlIHVzZXIgcHJvdmlkZWQgKGUuZy5cbiAqIHRoZSBTREsgYW5kIGJhY2tlbmQgYWx3YXlzIG9yZGVycyBieSBgX19uYW1lX19gKS4gVGhlIG5vcm1hbGl6ZWQgb3JkZXItYnlcbiAqIGluY2x1ZGVzIGltcGxpY2l0IG9yZGVyLWJ5cyBpbiBhZGRpdGlvbiB0byB0aGUgZXhwbGljaXQgdXNlciBwcm92aWRlZFxuICogb3JkZXItYnlzLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9xdWVyeU5vcm1hbGl6ZWRPcmRlckJ5KGUpIHtcbiAgICBjb25zdCB0ID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKTtcbiAgICBpZiAobnVsbCA9PT0gdC5JZSkge1xuICAgICAgICB0LkllID0gW107XG4gICAgICAgIGNvbnN0IGUgPSBuZXcgU2V0O1xuICAgICAgICAvLyBBbnkgZXhwbGljaXQgb3JkZXIgYnkgZmllbGRzIHNob3VsZCBiZSBhZGRlZCBhcyBpcy5cbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdC5leHBsaWNpdE9yZGVyQnkpIHQuSWUucHVzaChuKSwgZS5hZGQobi5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSk7XG4gICAgICAgIC8vIFRoZSBvcmRlciBvZiB0aGUgaW1wbGljaXQgb3JkZXJpbmcgYWx3YXlzIG1hdGNoZXMgdGhlIGxhc3QgZXhwbGljaXQgb3JkZXIgYnkuXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCA+IDAgPyB0LmV4cGxpY2l0T3JkZXJCeVt0LmV4cGxpY2l0T3JkZXJCeS5sZW5ndGggLSAxXS5kaXIgOiBcImFzY1wiIC8qIERpcmVjdGlvbi5BU0NFTkRJTkcgKi8gLCByID0gZnVuY3Rpb24gX19QUklWQVRFX2dldEluZXF1YWxpdHlGaWx0ZXJGaWVsZHMoZSkge1xuICAgICAgICAgICAgbGV0IHQgPSBuZXcgU29ydGVkU2V0KEZpZWxkUGF0aCQxLmNvbXBhcmF0b3IpO1xuICAgICAgICAgICAgcmV0dXJuIGUuZmlsdGVycy5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgICAgICBlLmdldEZsYXR0ZW5lZEZpbHRlcnMoKS5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZS5pc0luZXF1YWxpdHkoKSAmJiAodCA9IHQuYWRkKGUuZmllbGQpKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9KSksIHQ7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBDcmVhdGVzIGEgbmV3IFF1ZXJ5IGZvciBhIGNvbGxlY3Rpb24gZ3JvdXAgcXVlcnkgdGhhdCBtYXRjaGVzIGFsbCBkb2N1bWVudHNcbiAqIHdpdGhpbiB0aGUgcHJvdmlkZWQgY29sbGVjdGlvbiBncm91cC5cbiAqLyAodCk7XG4gICAgICAgIC8vIEFueSBpbmVxdWFsaXR5IGZpZWxkcyBub3QgZXhwbGljaXRseSBvcmRlcmVkIHNob3VsZCBiZSBpbXBsaWNpdGx5IG9yZGVyZWQgaW4gYSBsZXhpY29ncmFwaGljYWxcbiAgICAgICAgLy8gb3JkZXIuIFdoZW4gdGhlcmUgYXJlIG11bHRpcGxlIGluZXF1YWxpdHkgZmlsdGVycyBvbiB0aGUgc2FtZSBmaWVsZCwgdGhlIGZpZWxkIHNob3VsZCBiZSBhZGRlZFxuICAgICAgICAvLyBvbmx5IG9uY2UuXG4gICAgICAgIC8vIE5vdGU6IGBTb3J0ZWRTZXQ8RmllbGRQYXRoPmAgc29ydHMgdGhlIGtleSBmaWVsZCBiZWZvcmUgb3RoZXIgZmllbGRzLiBIb3dldmVyLCB3ZSB3YW50IHRoZSBrZXlcbiAgICAgICAgLy8gZmllbGQgdG8gYmUgc29ydGVkIGxhc3QuXG4gICAgICAgICAgICAgICAgci5mb3JFYWNoKChyID0+IHtcbiAgICAgICAgICAgIGUuaGFzKHIuY2Fub25pY2FsU3RyaW5nKCkpIHx8IHIuaXNLZXlGaWVsZCgpIHx8IHQuSWUucHVzaChuZXcgT3JkZXJCeShyLCBuKSk7XG4gICAgICAgIH0pKSwgXG4gICAgICAgIC8vIEFkZCB0aGUgZG9jdW1lbnQga2V5IGZpZWxkIHRvIHRoZSBsYXN0IGlmIGl0IGlzIG5vdCBleHBsaWNpdGx5IG9yZGVyZWQuXG4gICAgICAgIGUuaGFzKEZpZWxkUGF0aCQxLmtleUZpZWxkKCkuY2Fub25pY2FsU3RyaW5nKCkpIHx8IHQuSWUucHVzaChuZXcgT3JkZXJCeShGaWVsZFBhdGgkMS5rZXlGaWVsZCgpLCBuKSk7XG4gICAgfVxuICAgIHJldHVybiB0LkllO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIHRoaXMgYFF1ZXJ5YCBpbnN0YW5jZSB0byBpdHMgY29ycmVzcG9uZGluZyBgVGFyZ2V0YCByZXByZXNlbnRhdGlvbi5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfcXVlcnlUb1RhcmdldChlKSB7XG4gICAgY29uc3QgdCA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgcmV0dXJuIHQuRWUgfHwgKHQuRWUgPSBfX1BSSVZBVEVfX3F1ZXJ5VG9UYXJnZXQodCwgX19QUklWQVRFX3F1ZXJ5Tm9ybWFsaXplZE9yZGVyQnkoZSkpKSwgXG4gICAgdC5FZTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyB0aGlzIGBRdWVyeWAgaW5zdGFuY2UgdG8gaXRzIGNvcnJlc3BvbmRpbmcgYFRhcmdldGAgcmVwcmVzZW50YXRpb24sXG4gKiBmb3IgdXNlIHdpdGhpbiBhbiBhZ2dyZWdhdGUgcXVlcnkuIFVubGlrZSB0YXJnZXRzIGZvciBub24tYWdncmVnYXRlIHF1ZXJpZXMsXG4gKiBhZ2dyZWdhdGUgcXVlcnkgdGFyZ2V0cyBkbyBub3QgY29udGFpbiBub3JtYWxpemVkIG9yZGVyLWJ5cywgdGhleSBvbmx5XG4gKiBjb250YWluIGV4cGxpY2l0IG9yZGVyLWJ5cy5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfcXVlcnlUb0FnZ3JlZ2F0ZVRhcmdldChlKSB7XG4gICAgY29uc3QgdCA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgcmV0dXJuIHQuZGUgfHwgKFxuICAgIC8vIERvIG5vdCBpbmNsdWRlIGltcGxpY2l0IG9yZGVyLWJ5cyBmb3IgYWdncmVnYXRlIHF1ZXJpZXMuXG4gICAgdC5kZSA9IF9fUFJJVkFURV9fcXVlcnlUb1RhcmdldCh0LCBlLmV4cGxpY2l0T3JkZXJCeSkpLCB0LmRlO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfX3F1ZXJ5VG9UYXJnZXQoZSwgdCkge1xuICAgIGlmIChcIkZcIiAvKiBMaW1pdFR5cGUuRmlyc3QgKi8gPT09IGUubGltaXRUeXBlKSByZXR1cm4gX19QUklWQVRFX25ld1RhcmdldChlLnBhdGgsIGUuY29sbGVjdGlvbkdyb3VwLCB0LCBlLmZpbHRlcnMsIGUubGltaXQsIGUuc3RhcnRBdCwgZS5lbmRBdCk7XG4gICAge1xuICAgICAgICAvLyBGbGlwIHRoZSBvcmRlckJ5IGRpcmVjdGlvbnMgc2luY2Ugd2Ugd2FudCB0aGUgbGFzdCByZXN1bHRzXG4gICAgICAgIHQgPSB0Lm1hcCgoZSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0ID0gXCJkZXNjXCIgLyogRGlyZWN0aW9uLkRFU0NFTkRJTkcgKi8gPT09IGUuZGlyID8gXCJhc2NcIiAvKiBEaXJlY3Rpb24uQVNDRU5ESU5HICovIDogXCJkZXNjXCIgLyogRGlyZWN0aW9uLkRFU0NFTkRJTkcgKi87XG4gICAgICAgICAgICByZXR1cm4gbmV3IE9yZGVyQnkoZS5maWVsZCwgdCk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgLy8gV2UgbmVlZCB0byBzd2FwIHRoZSBjdXJzb3JzIHRvIG1hdGNoIHRoZSBub3ctZmxpcHBlZCBxdWVyeSBvcmRlcmluZy5cbiAgICAgICAgY29uc3QgbiA9IGUuZW5kQXQgPyBuZXcgQm91bmQoZS5lbmRBdC5wb3NpdGlvbiwgZS5lbmRBdC5pbmNsdXNpdmUpIDogbnVsbCwgciA9IGUuc3RhcnRBdCA/IG5ldyBCb3VuZChlLnN0YXJ0QXQucG9zaXRpb24sIGUuc3RhcnRBdC5pbmNsdXNpdmUpIDogbnVsbDtcbiAgICAgICAgLy8gTm93IHJldHVybiBhcyBhIExpbWl0VHlwZS5GaXJzdCBxdWVyeS5cbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9uZXdUYXJnZXQoZS5wYXRoLCBlLmNvbGxlY3Rpb25Hcm91cCwgdCwgZS5maWx0ZXJzLCBlLmxpbWl0LCBuLCByKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9xdWVyeVdpdGhBZGRlZEZpbHRlcihlLCB0KSB7XG4gICAgY29uc3QgbiA9IGUuZmlsdGVycy5jb25jYXQoWyB0IF0pO1xuICAgIHJldHVybiBuZXcgX19QUklWQVRFX1F1ZXJ5SW1wbChlLnBhdGgsIGUuY29sbGVjdGlvbkdyb3VwLCBlLmV4cGxpY2l0T3JkZXJCeS5zbGljZSgpLCBuLCBlLmxpbWl0LCBlLmxpbWl0VHlwZSwgZS5zdGFydEF0LCBlLmVuZEF0KTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX3F1ZXJ5V2l0aExpbWl0KGUsIHQsIG4pIHtcbiAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9RdWVyeUltcGwoZS5wYXRoLCBlLmNvbGxlY3Rpb25Hcm91cCwgZS5leHBsaWNpdE9yZGVyQnkuc2xpY2UoKSwgZS5maWx0ZXJzLnNsaWNlKCksIHQsIG4sIGUuc3RhcnRBdCwgZS5lbmRBdCk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9xdWVyeUVxdWFscyhlLCB0KSB7XG4gICAgcmV0dXJuIF9fUFJJVkFURV90YXJnZXRFcXVhbHMoX19QUklWQVRFX3F1ZXJ5VG9UYXJnZXQoZSksIF9fUFJJVkFURV9xdWVyeVRvVGFyZ2V0KHQpKSAmJiBlLmxpbWl0VHlwZSA9PT0gdC5saW1pdFR5cGU7XG59XG5cbi8vIFRPRE8oYi8yOTE4MzE2NSk6IFRoaXMgaXMgdXNlZCB0byBnZXQgYSB1bmlxdWUgc3RyaW5nIGZyb20gYSBxdWVyeSB0bywgZm9yXG4vLyBleGFtcGxlLCB1c2UgYXMgYSBkaWN0aW9uYXJ5IGtleSwgYnV0IHRoZSBpbXBsZW1lbnRhdGlvbiBpcyBzdWJqZWN0IHRvXG4vLyBjb2xsaXNpb25zLiBNYWtlIGl0IGNvbGxpc2lvbi1mcmVlLlxuZnVuY3Rpb24gX19QUklWQVRFX2Nhbm9uaWZ5UXVlcnkoZSkge1xuICAgIHJldHVybiBgJHtfX1BSSVZBVEVfY2Fub25pZnlUYXJnZXQoX19QUklWQVRFX3F1ZXJ5VG9UYXJnZXQoZSkpfXxsdDoke2UubGltaXRUeXBlfWA7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9zdHJpbmdpZnlRdWVyeShlKSB7XG4gICAgcmV0dXJuIGBRdWVyeSh0YXJnZXQ9JHtmdW5jdGlvbiBfX1BSSVZBVEVfc3RyaW5naWZ5VGFyZ2V0KGUpIHtcbiAgICAgICAgbGV0IHQgPSBlLnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgICAgIHJldHVybiBudWxsICE9PSBlLmNvbGxlY3Rpb25Hcm91cCAmJiAodCArPSBcIiBjb2xsZWN0aW9uR3JvdXA9XCIgKyBlLmNvbGxlY3Rpb25Hcm91cCksIFxuICAgICAgICBlLmZpbHRlcnMubGVuZ3RoID4gMCAmJiAodCArPSBgLCBmaWx0ZXJzOiBbJHtlLmZpbHRlcnMubWFwKChlID0+IF9fUFJJVkFURV9zdHJpbmdpZnlGaWx0ZXIoZSkpKS5qb2luKFwiLCBcIil9XWApLCBcbiAgICAgICAgX19QUklWQVRFX2lzTnVsbE9yVW5kZWZpbmVkKGUubGltaXQpIHx8ICh0ICs9IFwiLCBsaW1pdDogXCIgKyBlLmxpbWl0KSwgZS5vcmRlckJ5Lmxlbmd0aCA+IDAgJiYgKHQgKz0gYCwgb3JkZXJCeTogWyR7ZS5vcmRlckJ5Lm1hcCgoZSA9PiBmdW5jdGlvbiBfX1BSSVZBVEVfc3RyaW5naWZ5T3JkZXJCeShlKSB7XG4gICAgICAgICAgICByZXR1cm4gYCR7ZS5maWVsZC5jYW5vbmljYWxTdHJpbmcoKX0gKCR7ZS5kaXJ9KWA7XG4gICAgICAgIH0oZSkpKS5qb2luKFwiLCBcIil9XWApLCBlLnN0YXJ0QXQgJiYgKHQgKz0gXCIsIHN0YXJ0QXQ6IFwiLCB0ICs9IGUuc3RhcnRBdC5pbmNsdXNpdmUgPyBcImI6XCIgOiBcImE6XCIsIFxuICAgICAgICB0ICs9IGUuc3RhcnRBdC5wb3NpdGlvbi5tYXAoKGUgPT4gY2Fub25pY2FsSWQoZSkpKS5qb2luKFwiLFwiKSksIGUuZW5kQXQgJiYgKHQgKz0gXCIsIGVuZEF0OiBcIiwgXG4gICAgICAgIHQgKz0gZS5lbmRBdC5pbmNsdXNpdmUgPyBcImE6XCIgOiBcImI6XCIsIHQgKz0gZS5lbmRBdC5wb3NpdGlvbi5tYXAoKGUgPT4gY2Fub25pY2FsSWQoZSkpKS5qb2luKFwiLFwiKSksIFxuICAgICAgICBgVGFyZ2V0KCR7dH0pYDtcbiAgICB9KF9fUFJJVkFURV9xdWVyeVRvVGFyZ2V0KGUpKX07IGxpbWl0VHlwZT0ke2UubGltaXRUeXBlfSlgO1xufVxuXG4vKiogUmV0dXJucyB3aGV0aGVyIGBkb2NgIG1hdGNoZXMgdGhlIGNvbnN0cmFpbnRzIG9mIGBxdWVyeWAuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9xdWVyeU1hdGNoZXMoZSwgdCkge1xuICAgIHJldHVybiB0LmlzRm91bmREb2N1bWVudCgpICYmIGZ1bmN0aW9uIF9fUFJJVkFURV9xdWVyeU1hdGNoZXNQYXRoQW5kQ29sbGVjdGlvbkdyb3VwKGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IHQua2V5LnBhdGg7XG4gICAgICAgIHJldHVybiBudWxsICE9PSBlLmNvbGxlY3Rpb25Hcm91cCA/IHQua2V5Lmhhc0NvbGxlY3Rpb25JZChlLmNvbGxlY3Rpb25Hcm91cCkgJiYgZS5wYXRoLmlzUHJlZml4T2YobikgOiBEb2N1bWVudEtleS5pc0RvY3VtZW50S2V5KGUucGF0aCkgPyBlLnBhdGguaXNFcXVhbChuKSA6IGUucGF0aC5pc0ltbWVkaWF0ZVBhcmVudE9mKG4pO1xuICAgIH1cbiAgICAvKipcbiAqIEEgZG9jdW1lbnQgbXVzdCBoYXZlIGEgdmFsdWUgZm9yIGV2ZXJ5IG9yZGVyaW5nIGNsYXVzZSBpbiBvcmRlciB0byBzaG93IHVwXG4gKiBpbiB0aGUgcmVzdWx0cy5cbiAqLyAoZSwgdCkgJiYgZnVuY3Rpb24gX19QUklWQVRFX3F1ZXJ5TWF0Y2hlc09yZGVyQnkoZSwgdCkge1xuICAgICAgICAvLyBXZSBtdXN0IHVzZSBgcXVlcnlOb3JtYWxpemVkT3JkZXJCeSgpYCB0byBnZXQgdGhlIGxpc3Qgb2YgYWxsIG9yZGVyQnlzIChib3RoIGltcGxpY2l0IGFuZCBleHBsaWNpdCkuXG4gICAgICAgIC8vIE5vdGUgdGhhdCBmb3IgT1IgcXVlcmllcywgb3JkZXJCeSBhcHBsaWVzIHRvIGFsbCBkaXNqdW5jdGlvbiB0ZXJtcyBhbmQgaW1wbGljaXQgb3JkZXJCeXMgbXVzdFxuICAgICAgICAvLyBiZSB0YWtlbiBpbnRvIGFjY291bnQuIEZvciBleGFtcGxlLCB0aGUgcXVlcnkgXCJhID4gMSB8fCBiPT0xXCIgaGFzIGFuIGltcGxpY2l0IFwib3JkZXJCeSBhXCIgZHVlXG4gICAgICAgIC8vIHRvIHRoZSBpbmVxdWFsaXR5LCBhbmQgaXMgZXZhbHVhdGVkIGFzIFwiYSA+IDEgb3JkZXJCeSBhIHx8IGI9PTEgb3JkZXJCeSBhXCIuXG4gICAgICAgIC8vIEEgZG9jdW1lbnQgd2l0aCBjb250ZW50IG9mIHtiOjF9IG1hdGNoZXMgdGhlIGZpbHRlcnMsIGJ1dCBkb2VzIG5vdCBtYXRjaCB0aGUgb3JkZXJCeSBiZWNhdXNlXG4gICAgICAgIC8vIGl0J3MgbWlzc2luZyB0aGUgZmllbGQgJ2EnLlxuICAgICAgICBmb3IgKGNvbnN0IG4gb2YgX19QUklWQVRFX3F1ZXJ5Tm9ybWFsaXplZE9yZGVyQnkoZSkpIFxuICAgICAgICAvLyBvcmRlci1ieSBrZXkgYWx3YXlzIG1hdGNoZXNcbiAgICAgICAgaWYgKCFuLmZpZWxkLmlzS2V5RmllbGQoKSAmJiBudWxsID09PSB0LmRhdGEuZmllbGQobi5maWVsZCkpIHJldHVybiAhMTtcbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH0oZSwgdCkgJiYgZnVuY3Rpb24gX19QUklWQVRFX3F1ZXJ5TWF0Y2hlc0ZpbHRlcnMoZSwgdCkge1xuICAgICAgICBmb3IgKGNvbnN0IG4gb2YgZS5maWx0ZXJzKSBpZiAoIW4ubWF0Y2hlcyh0KSkgcmV0dXJuICExO1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIC8qKiBNYWtlcyBzdXJlIGEgZG9jdW1lbnQgaXMgd2l0aGluIHRoZSBib3VuZHMsIGlmIHByb3ZpZGVkLiAqLyAoZSwgdCkgJiYgZnVuY3Rpb24gX19QUklWQVRFX3F1ZXJ5TWF0Y2hlc0JvdW5kcyhlLCB0KSB7XG4gICAgICAgIGlmIChlLnN0YXJ0QXQgJiYgIVxuICAgICAgICAvKipcbiAqIFJldHVybnMgdHJ1ZSBpZiBhIGRvY3VtZW50IHNvcnRzIGJlZm9yZSBhIGJvdW5kIHVzaW5nIHRoZSBwcm92aWRlZCBzb3J0XG4gKiBvcmRlci5cbiAqL1xuICAgICAgICBmdW5jdGlvbiBfX1BSSVZBVEVfYm91bmRTb3J0c0JlZm9yZURvY3VtZW50KGUsIHQsIG4pIHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfYm91bmRDb21wYXJlVG9Eb2N1bWVudChlLCB0LCBuKTtcbiAgICAgICAgICAgIHJldHVybiBlLmluY2x1c2l2ZSA/IHIgPD0gMCA6IHIgPCAwO1xuICAgICAgICB9KGUuc3RhcnRBdCwgX19QUklWQVRFX3F1ZXJ5Tm9ybWFsaXplZE9yZGVyQnkoZSksIHQpKSByZXR1cm4gITE7XG4gICAgICAgIGlmIChlLmVuZEF0ICYmICFmdW5jdGlvbiBfX1BSSVZBVEVfYm91bmRTb3J0c0FmdGVyRG9jdW1lbnQoZSwgdCwgbikge1xuICAgICAgICAgICAgY29uc3QgciA9IF9fUFJJVkFURV9ib3VuZENvbXBhcmVUb0RvY3VtZW50KGUsIHQsIG4pO1xuICAgICAgICAgICAgcmV0dXJuIGUuaW5jbHVzaXZlID8gciA+PSAwIDogciA+IDA7XG4gICAgICAgIH0oZS5lbmRBdCwgX19QUklWQVRFX3F1ZXJ5Tm9ybWFsaXplZE9yZGVyQnkoZSksIHQpKSByZXR1cm4gITE7XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgLyoqXG4gKiBSZXR1cm5zIHRoZSBjb2xsZWN0aW9uIGdyb3VwIHRoYXQgdGhpcyBxdWVyeSB0YXJnZXRzLlxuICpcbiAqIFBPUlRJTkcgTk9URTogVGhpcyBpcyBvbmx5IHVzZWQgaW4gdGhlIFdlYiBTREsgdG8gZmFjaWxpdGF0ZSBtdWx0aS10YWJcbiAqIHN5bmNocm9uaXphdGlvbiBmb3IgcXVlcnkgcmVzdWx0cy5cbiAqLyAoZSwgdCk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9xdWVyeUNvbGxlY3Rpb25Hcm91cChlKSB7XG4gICAgcmV0dXJuIGUuY29sbGVjdGlvbkdyb3VwIHx8IChlLnBhdGgubGVuZ3RoICUgMiA9PSAxID8gZS5wYXRoLmxhc3RTZWdtZW50KCkgOiBlLnBhdGguZ2V0KGUucGF0aC5sZW5ndGggLSAyKSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIG5ldyBjb21wYXJhdG9yIGZ1bmN0aW9uIHRoYXQgY2FuIGJlIHVzZWQgdG8gY29tcGFyZSB0d28gZG9jdW1lbnRzXG4gKiBiYXNlZCBvbiB0aGUgUXVlcnkncyBvcmRlcmluZyBjb25zdHJhaW50LlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9uZXdRdWVyeUNvbXBhcmF0b3IoZSkge1xuICAgIHJldHVybiAodCwgbikgPT4ge1xuICAgICAgICBsZXQgciA9ICExO1xuICAgICAgICBmb3IgKGNvbnN0IGkgb2YgX19QUklWQVRFX3F1ZXJ5Tm9ybWFsaXplZE9yZGVyQnkoZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBfX1BSSVZBVEVfY29tcGFyZURvY3MoaSwgdCwgbik7XG4gICAgICAgICAgICBpZiAoMCAhPT0gZSkgcmV0dXJuIGU7XG4gICAgICAgICAgICByID0gciB8fCBpLmZpZWxkLmlzS2V5RmllbGQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfY29tcGFyZURvY3MoZSwgdCwgbikge1xuICAgIGNvbnN0IHIgPSBlLmZpZWxkLmlzS2V5RmllbGQoKSA/IERvY3VtZW50S2V5LmNvbXBhcmF0b3IodC5rZXksIG4ua2V5KSA6IGZ1bmN0aW9uIF9fUFJJVkFURV9jb21wYXJlRG9jdW1lbnRzQnlGaWVsZChlLCB0LCBuKSB7XG4gICAgICAgIGNvbnN0IHIgPSB0LmRhdGEuZmllbGQoZSksIGkgPSBuLmRhdGEuZmllbGQoZSk7XG4gICAgICAgIHJldHVybiBudWxsICE9PSByICYmIG51bGwgIT09IGkgPyBfX1BSSVZBVEVfdmFsdWVDb21wYXJlKHIsIGkpIDogZmFpbCg0Mjg4Nik7XG4gICAgfShlLmZpZWxkLCB0LCBuKTtcbiAgICBzd2l0Y2ggKGUuZGlyKSB7XG4gICAgICBjYXNlIFwiYXNjXCIgLyogRGlyZWN0aW9uLkFTQ0VORElORyAqLyA6XG4gICAgICAgIHJldHVybiByO1xuXG4gICAgICBjYXNlIFwiZGVzY1wiIC8qIERpcmVjdGlvbi5ERVNDRU5ESU5HICovIDpcbiAgICAgICAgcmV0dXJuIC0xICogcjtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIGZhaWwoMTk3OTAsIHtcbiAgICAgICAgICAgIGRpcmVjdGlvbjogZS5kaXJcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIG1hcCBpbXBsZW1lbnRhdGlvbiB0aGF0IHVzZXMgb2JqZWN0cyBhcyBrZXlzLiBPYmplY3RzIG11c3QgaGF2ZSBhblxuICogYXNzb2NpYXRlZCBlcXVhbHMgZnVuY3Rpb24gYW5kIG11c3QgYmUgaW1tdXRhYmxlLiBFbnRyaWVzIGluIHRoZSBtYXAgYXJlXG4gKiBzdG9yZWQgdG9nZXRoZXIgd2l0aCB0aGUga2V5IGJlaW5nIHByb2R1Y2VkIGZyb20gdGhlIG1hcEtleUZuLiBUaGlzIG1hcFxuICogYXV0b21hdGljYWxseSBoYW5kbGVzIGNvbGxpc2lvbnMgb2Yga2V5cy5cbiAqLyBjbGFzcyBPYmplY3RNYXAge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQpIHtcbiAgICAgICAgdGhpcy5tYXBLZXlGbiA9IGUsIHRoaXMuZXF1YWxzRm4gPSB0LCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBpbm5lciBtYXAgZm9yIGEga2V5L3ZhbHVlIHBhaXIuIER1ZSB0byB0aGUgcG9zc2liaWxpdHkgb2YgY29sbGlzaW9ucyB3ZVxuICAgICAgICAgKiBrZWVwIGEgbGlzdCBvZiBlbnRyaWVzIHRoYXQgd2UgZG8gYSBsaW5lYXIgc2VhcmNoIHRocm91Z2ggdG8gZmluZCBhbiBhY3R1YWxcbiAgICAgICAgICogbWF0Y2guIE5vdGUgdGhhdCBjb2xsaXNpb25zIHNob3VsZCBiZSByYXJlLCBzbyB3ZSBzdGlsbCBleHBlY3QgbmVhclxuICAgICAgICAgKiBjb25zdGFudCB0aW1lIGxvb2t1cHMgaW4gcHJhY3RpY2UuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmlubmVyID0ge30sIFxuICAgICAgICAvKiogVGhlIG51bWJlciBvZiBlbnRyaWVzIHN0b3JlZCBpbiB0aGUgbWFwICovXG4gICAgICAgIHRoaXMuaW5uZXJTaXplID0gMDtcbiAgICB9XG4gICAgLyoqIEdldCBhIHZhbHVlIGZvciB0aGlzIGtleSwgb3IgdW5kZWZpbmVkIGlmIGl0IGRvZXMgbm90IGV4aXN0LiAqLyAgICBnZXQoZSkge1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5tYXBLZXlGbihlKSwgbiA9IHRoaXMuaW5uZXJbdF07XG4gICAgICAgIGlmICh2b2lkIDAgIT09IG4pIGZvciAoY29uc3QgW3QsIHJdIG9mIG4pIGlmICh0aGlzLmVxdWFsc0ZuKHQsIGUpKSByZXR1cm4gcjtcbiAgICB9XG4gICAgaGFzKGUpIHtcbiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gdGhpcy5nZXQoZSk7XG4gICAgfVxuICAgIC8qKiBQdXQgdGhpcyBrZXkgYW5kIHZhbHVlIGluIHRoZSBtYXAuICovICAgIHNldChlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLm1hcEtleUZuKGUpLCByID0gdGhpcy5pbm5lcltuXTtcbiAgICAgICAgaWYgKHZvaWQgMCA9PT0gcikgcmV0dXJuIHRoaXMuaW5uZXJbbl0gPSBbIFsgZSwgdCBdIF0sIHZvaWQgdGhpcy5pbm5lclNpemUrKztcbiAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCByLmxlbmd0aDsgbisrKSBpZiAodGhpcy5lcXVhbHNGbihyW25dWzBdLCBlKSkgXG4gICAgICAgIC8vIFRoaXMgaXMgdXBkYXRpbmcgYW4gZXhpc3RpbmcgZW50cnkgYW5kIGRvZXMgbm90IGluY3JlYXNlIGBpbm5lclNpemVgLlxuICAgICAgICByZXR1cm4gdm9pZCAocltuXSA9IFsgZSwgdCBdKTtcbiAgICAgICAgci5wdXNoKFsgZSwgdCBdKSwgdGhpcy5pbm5lclNpemUrKztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlIHRoaXMga2V5IGZyb20gdGhlIG1hcC4gUmV0dXJucyBhIGJvb2xlYW4gaWYgYW55dGhpbmcgd2FzIGRlbGV0ZWQuXG4gICAgICovICAgIGRlbGV0ZShlKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLm1hcEtleUZuKGUpLCBuID0gdGhpcy5pbm5lclt0XTtcbiAgICAgICAgaWYgKHZvaWQgMCA9PT0gbikgcmV0dXJuICExO1xuICAgICAgICBmb3IgKGxldCByID0gMDsgciA8IG4ubGVuZ3RoOyByKyspIGlmICh0aGlzLmVxdWFsc0ZuKG5bcl1bMF0sIGUpKSByZXR1cm4gMSA9PT0gbi5sZW5ndGggPyBkZWxldGUgdGhpcy5pbm5lclt0XSA6IG4uc3BsaWNlKHIsIDEpLCBcbiAgICAgICAgdGhpcy5pbm5lclNpemUtLSwgITA7XG4gICAgICAgIHJldHVybiAhMTtcbiAgICB9XG4gICAgZm9yRWFjaChlKSB7XG4gICAgICAgIGZvckVhY2godGhpcy5pbm5lciwgKCh0LCBuKSA9PiB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IFt0LCByXSBvZiBuKSBlKHQsIHIpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGlzRW1wdHkoKSB7XG4gICAgICAgIHJldHVybiBpc0VtcHR5KHRoaXMuaW5uZXIpO1xuICAgIH1cbiAgICBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pbm5lclNpemU7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCBSdCA9IG5ldyBTb3J0ZWRNYXAoRG9jdW1lbnRLZXkuY29tcGFyYXRvcik7XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9tdXRhYmxlRG9jdW1lbnRNYXAoKSB7XG4gICAgcmV0dXJuIFJ0O1xufVxuXG5jb25zdCBWdCA9IG5ldyBTb3J0ZWRNYXAoRG9jdW1lbnRLZXkuY29tcGFyYXRvcik7XG5cbmZ1bmN0aW9uIGRvY3VtZW50TWFwKC4uLmUpIHtcbiAgICBsZXQgdCA9IFZ0O1xuICAgIGZvciAoY29uc3QgbiBvZiBlKSB0ID0gdC5pbnNlcnQobi5rZXksIG4pO1xuICAgIHJldHVybiB0O1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfY29udmVydE92ZXJsYXllZERvY3VtZW50TWFwVG9Eb2N1bWVudE1hcChlKSB7XG4gICAgbGV0IHQgPSBWdDtcbiAgICByZXR1cm4gZS5mb3JFYWNoKCgoZSwgbikgPT4gdCA9IHQuaW5zZXJ0KGUsIG4ub3ZlcmxheWVkRG9jdW1lbnQpKSksIHQ7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9uZXdPdmVybGF5TWFwKCkge1xuICAgIHJldHVybiBfX1BSSVZBVEVfbmV3RG9jdW1lbnRLZXlNYXAoKTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX25ld011dGF0aW9uTWFwKCkge1xuICAgIHJldHVybiBfX1BSSVZBVEVfbmV3RG9jdW1lbnRLZXlNYXAoKTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX25ld0RvY3VtZW50S2V5TWFwKCkge1xuICAgIHJldHVybiBuZXcgT2JqZWN0TWFwKChlID0+IGUudG9TdHJpbmcoKSksICgoZSwgdCkgPT4gZS5pc0VxdWFsKHQpKSk7XG59XG5cbmNvbnN0IG10ID0gbmV3IFNvcnRlZE1hcChEb2N1bWVudEtleS5jb21wYXJhdG9yKTtcblxuY29uc3QgZnQgPSBuZXcgU29ydGVkU2V0KERvY3VtZW50S2V5LmNvbXBhcmF0b3IpO1xuXG5mdW5jdGlvbiBfX1BSSVZBVEVfZG9jdW1lbnRLZXlTZXQoLi4uZSkge1xuICAgIGxldCB0ID0gZnQ7XG4gICAgZm9yIChjb25zdCBuIG9mIGUpIHQgPSB0LmFkZChuKTtcbiAgICByZXR1cm4gdDtcbn1cblxuY29uc3QgZ3QgPSBuZXcgU29ydGVkU2V0KF9fUFJJVkFURV9wcmltaXRpdmVDb21wYXJhdG9yKTtcblxuZnVuY3Rpb24gX19QUklWQVRFX3RhcmdldElkU2V0KCkge1xuICAgIHJldHVybiBndDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmV0dXJucyBhbiBEb3VibGVWYWx1ZSBmb3IgYHZhbHVlYCB0aGF0IGlzIGVuY29kZWQgYmFzZWQgdGhlIHNlcmlhbGl6ZXInc1xuICogYHVzZVByb3RvM0pzb25gIHNldHRpbmcuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX3RvRG91YmxlKGUsIHQpIHtcbiAgICBpZiAoZS51c2VQcm90bzNKc29uKSB7XG4gICAgICAgIGlmIChpc05hTih0KSkgcmV0dXJuIHtcbiAgICAgICAgICAgIGRvdWJsZVZhbHVlOiBcIk5hTlwiXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0ID09PSAxIC8gMCkgcmV0dXJuIHtcbiAgICAgICAgICAgIGRvdWJsZVZhbHVlOiBcIkluZmluaXR5XCJcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHQgPT09IC0xIC8gMCkgcmV0dXJuIHtcbiAgICAgICAgICAgIGRvdWJsZVZhbHVlOiBcIi1JbmZpbml0eVwiXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGRvdWJsZVZhbHVlOiBfX1BSSVZBVEVfaXNOZWdhdGl2ZVplcm8odCkgPyBcIi0wXCIgOiB0XG4gICAgfTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGFuIEludGVnZXJWYWx1ZSBmb3IgYHZhbHVlYC5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfdG9JbnRlZ2VyKGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBpbnRlZ2VyVmFsdWU6IFwiXCIgKyBlXG4gICAgfTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgdmFsdWUgZm9yIGEgbnVtYmVyIHRoYXQncyBhcHByb3ByaWF0ZSB0byBwdXQgaW50byBhIHByb3RvLlxuICogVGhlIHJldHVybiB2YWx1ZSBpcyBhbiBJbnRlZ2VyVmFsdWUgaWYgaXQgY2FuIHNhZmVseSByZXByZXNlbnQgdGhlIHZhbHVlLFxuICogb3RoZXJ3aXNlIGEgRG91YmxlVmFsdWUgaXMgcmV0dXJuZWQuXG4gKi8gZnVuY3Rpb24gdG9OdW1iZXIoZSwgdCkge1xuICAgIHJldHVybiBpc1NhZmVJbnRlZ2VyKHQpID8gX19QUklWQVRFX3RvSW50ZWdlcih0KSA6IF9fUFJJVkFURV90b0RvdWJsZShlLCB0KTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBVc2VkIHRvIHJlcHJlc2VudCBhIGZpZWxkIHRyYW5zZm9ybSBvbiBhIG11dGF0aW9uLiAqLyBjbGFzcyBUcmFuc2Zvcm1PcGVyYXRpb24ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAvLyBNYWtlIHN1cmUgdGhhdCB0aGUgc3RydWN0dXJhbCB0eXBlIG9mIGBUcmFuc2Zvcm1PcGVyYXRpb25gIGlzIHVuaXF1ZS5cbiAgICAgICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9taWNyb3NvZnQvVHlwZVNjcmlwdC9pc3N1ZXMvNTQ1MVxuICAgICAgICB0aGlzLl8gPSB2b2lkIDA7XG4gICAgfVxufVxuXG4vKipcbiAqIENvbXB1dGVzIHRoZSBsb2NhbCB0cmFuc2Zvcm0gcmVzdWx0IGFnYWluc3QgdGhlIHByb3ZpZGVkIGBwcmV2aW91c1ZhbHVlYCxcbiAqIG9wdGlvbmFsbHkgdXNpbmcgdGhlIHByb3ZpZGVkIGxvY2FsV3JpdGVUaW1lLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9hcHBseVRyYW5zZm9ybU9wZXJhdGlvblRvTG9jYWxWaWV3KGUsIHQsIG4pIHtcbiAgICByZXR1cm4gZSBpbnN0YW5jZW9mIF9fUFJJVkFURV9TZXJ2ZXJUaW1lc3RhbXBUcmFuc2Zvcm0gPyBmdW5jdGlvbiBzZXJ2ZXJUaW1lc3RhbXAkMShlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSB7XG4gICAgICAgICAgICBmaWVsZHM6IHtcbiAgICAgICAgICAgICAgICBbYXRdOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0cmluZ1ZhbHVlOiBfdFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgW2N0XToge1xuICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXBWYWx1ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Vjb25kczogZS5zZWNvbmRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmFub3M6IGUubmFub3NlY29uZHNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLy8gV2Ugc2hvdWxkIGF2b2lkIHN0b3JpbmcgZGVlcGx5IG5lc3RlZCBzZXJ2ZXIgdGltZXN0YW1wIG1hcCB2YWx1ZXNcbiAgICAgICAgLy8gYmVjYXVzZSB3ZSBuZXZlciB1c2UgdGhlIGludGVybWVkaWF0ZSBcInByZXZpb3VzIHZhbHVlc1wiLlxuICAgICAgICAvLyBGb3IgZXhhbXBsZTpcbiAgICAgICAgLy8gcHJldmlvdXM6IDQyTCwgYWRkOiB0MSwgcmVzdWx0OiB0MSAtPiA0MkxcbiAgICAgICAgLy8gcHJldmlvdXM6IHQxLCAgYWRkOiB0MiwgcmVzdWx0OiB0MiAtPiA0MkwgKE5PVCB0MiAtPiB0MSAtPiA0MkwpXG4gICAgICAgIC8vIHByZXZpb3VzOiB0MiwgIGFkZDogdDMsIHJlc3VsdDogdDMgLT4gNDJMIChOT1QgdDMgLT4gdDIgLT4gdDEgLT4gNDJMKVxuICAgICAgICAvLyBgZ2V0UHJldmlvdXNWYWx1ZWAgcmVjdXJzaXZlbHkgdHJhdmVyc2VzIHNlcnZlciB0aW1lc3RhbXBzIHRvIGZpbmQgdGhlXG4gICAgICAgIC8vIGxlYXN0IHJlY2VudCBWYWx1ZS5cbiAgICAgICAgICAgICAgICByZXR1cm4gdCAmJiBfX1BSSVZBVEVfaXNTZXJ2ZXJUaW1lc3RhbXAodCkgJiYgKHQgPSBfX1BSSVZBVEVfZ2V0UHJldmlvdXNWYWx1ZSh0KSksIFxuICAgICAgICB0ICYmIChuLmZpZWxkc1t1dF0gPSB0KSwge1xuICAgICAgICAgICAgbWFwVmFsdWU6IG5cbiAgICAgICAgfTtcbiAgICB9KG4sIHQpIDogZSBpbnN0YW5jZW9mIF9fUFJJVkFURV9BcnJheVVuaW9uVHJhbnNmb3JtT3BlcmF0aW9uID8gX19QUklWQVRFX2FwcGx5QXJyYXlVbmlvblRyYW5zZm9ybU9wZXJhdGlvbihlLCB0KSA6IGUgaW5zdGFuY2VvZiBfX1BSSVZBVEVfQXJyYXlSZW1vdmVUcmFuc2Zvcm1PcGVyYXRpb24gPyBfX1BSSVZBVEVfYXBwbHlBcnJheVJlbW92ZVRyYW5zZm9ybU9wZXJhdGlvbihlLCB0KSA6IGZ1bmN0aW9uIF9fUFJJVkFURV9hcHBseU51bWVyaWNJbmNyZW1lbnRUcmFuc2Zvcm1PcGVyYXRpb25Ub0xvY2FsVmlldyhlLCB0KSB7XG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogU2luY2UgSmF2YVNjcmlwdCdzIGludGVnZXIgYXJpdGhtZXRpYyBpcyBsaW1pdGVkIHRvIDUzIGJpdFxuICAgICAgICAvLyBwcmVjaXNpb24gYW5kIHJlc29sdmVzIG92ZXJmbG93cyBieSByZWR1Y2luZyBwcmVjaXNpb24sIHdlIGRvIG5vdFxuICAgICAgICAvLyBtYW51YWxseSBjYXAgb3ZlcmZsb3dzIGF0IDJeNjMuXG4gICAgICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfY29tcHV0ZVRyYW5zZm9ybU9wZXJhdGlvbkJhc2VWYWx1ZShlLCB0KSwgciA9IGFzTnVtYmVyKG4pICsgYXNOdW1iZXIoZS5BZSk7XG4gICAgICAgIHJldHVybiBpc0ludGVnZXIobikgJiYgaXNJbnRlZ2VyKGUuQWUpID8gX19QUklWQVRFX3RvSW50ZWdlcihyKSA6IF9fUFJJVkFURV90b0RvdWJsZShlLnNlcmlhbGl6ZXIsIHIpO1xuICAgIH0oZSwgdCk7XG59XG5cbi8qKlxuICogQ29tcHV0ZXMgYSBmaW5hbCB0cmFuc2Zvcm0gcmVzdWx0IGFmdGVyIHRoZSB0cmFuc2Zvcm0gaGFzIGJlZW4gYWNrbm93bGVkZ2VkXG4gKiBieSB0aGUgc2VydmVyLCBwb3RlbnRpYWxseSB1c2luZyB0aGUgc2VydmVyLXByb3ZpZGVkIHRyYW5zZm9ybVJlc3VsdC5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfYXBwbHlUcmFuc2Zvcm1PcGVyYXRpb25Ub1JlbW90ZURvY3VtZW50KGUsIHQsIG4pIHtcbiAgICAvLyBUaGUgc2VydmVyIGp1c3Qgc2VuZHMgbnVsbCBhcyB0aGUgdHJhbnNmb3JtIHJlc3VsdCBmb3IgYXJyYXkgb3BlcmF0aW9ucyxcbiAgICAvLyBzbyB3ZSBoYXZlIHRvIGNhbGN1bGF0ZSBhIHJlc3VsdCB0aGUgc2FtZSBhcyB3ZSBkbyBmb3IgbG9jYWxcbiAgICAvLyBhcHBsaWNhdGlvbnMuXG4gICAgcmV0dXJuIGUgaW5zdGFuY2VvZiBfX1BSSVZBVEVfQXJyYXlVbmlvblRyYW5zZm9ybU9wZXJhdGlvbiA/IF9fUFJJVkFURV9hcHBseUFycmF5VW5pb25UcmFuc2Zvcm1PcGVyYXRpb24oZSwgdCkgOiBlIGluc3RhbmNlb2YgX19QUklWQVRFX0FycmF5UmVtb3ZlVHJhbnNmb3JtT3BlcmF0aW9uID8gX19QUklWQVRFX2FwcGx5QXJyYXlSZW1vdmVUcmFuc2Zvcm1PcGVyYXRpb24oZSwgdCkgOiBuO1xufVxuXG4vKipcbiAqIElmIHRoaXMgdHJhbnNmb3JtIG9wZXJhdGlvbiBpcyBub3QgaWRlbXBvdGVudCwgcmV0dXJucyB0aGUgYmFzZSB2YWx1ZSB0b1xuICogcGVyc2lzdCBmb3IgdGhpcyB0cmFuc2Zvcm0uIElmIGEgYmFzZSB2YWx1ZSBpcyByZXR1cm5lZCwgdGhlIHRyYW5zZm9ybVxuICogb3BlcmF0aW9uIGlzIGFsd2F5cyBhcHBsaWVkIHRvIHRoaXMgYmFzZSB2YWx1ZSwgZXZlbiBpZiBkb2N1bWVudCBoYXNcbiAqIGFscmVhZHkgYmVlbiB1cGRhdGVkLlxuICpcbiAqIEJhc2UgdmFsdWVzIHByb3ZpZGUgY29uc2lzdGVudCBiZWhhdmlvciBmb3Igbm9uLWlkZW1wb3RlbnQgdHJhbnNmb3JtcyBhbmRcbiAqIGFsbG93IHVzIHRvIHJldHVybiB0aGUgc2FtZSBsYXRlbmN5LWNvbXBlbnNhdGVkIHZhbHVlIGV2ZW4gaWYgdGhlIGJhY2tlbmRcbiAqIGhhcyBhbHJlYWR5IGFwcGxpZWQgdGhlIHRyYW5zZm9ybSBvcGVyYXRpb24uIFRoZSBiYXNlIHZhbHVlIGlzIG51bGwgZm9yXG4gKiBpZGVtcG90ZW50IHRyYW5zZm9ybXMsIGFzIHRoZXkgY2FuIGJlIHJlLXBsYXllZCBldmVuIGlmIHRoZSBiYWNrZW5kIGhhc1xuICogYWxyZWFkeSBhcHBsaWVkIHRoZW0uXG4gKlxuICogQHJldHVybnMgYSBiYXNlIHZhbHVlIHRvIHN0b3JlIGFsb25nIHdpdGggdGhlIG11dGF0aW9uLCBvciBudWxsIGZvclxuICogaWRlbXBvdGVudCB0cmFuc2Zvcm1zLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9jb21wdXRlVHJhbnNmb3JtT3BlcmF0aW9uQmFzZVZhbHVlKGUsIHQpIHtcbiAgICByZXR1cm4gZSBpbnN0YW5jZW9mIF9fUFJJVkFURV9OdW1lcmljSW5jcmVtZW50VHJhbnNmb3JtT3BlcmF0aW9uID8gXG4gICAgLyoqIFJldHVybnMgdHJ1ZSBpZiBgdmFsdWVgIGlzIGVpdGhlciBhbiBJbnRlZ2VyVmFsdWUgb3IgYSBEb3VibGVWYWx1ZS4gKi9cbiAgICBmdW5jdGlvbiBfX1BSSVZBVEVfaXNOdW1iZXIoZSkge1xuICAgICAgICByZXR1cm4gaXNJbnRlZ2VyKGUpIHx8IGZ1bmN0aW9uIF9fUFJJVkFURV9pc0RvdWJsZShlKSB7XG4gICAgICAgICAgICByZXR1cm4gISFlICYmIFwiZG91YmxlVmFsdWVcIiBpbiBlO1xuICAgICAgICB9KGUpO1xuICAgIH0odCkgPyB0IDoge1xuICAgICAgICBpbnRlZ2VyVmFsdWU6IDBcbiAgICB9IDogbnVsbDtcbn1cblxuLyoqIFRyYW5zZm9ybXMgYSB2YWx1ZSBpbnRvIGEgc2VydmVyLWdlbmVyYXRlZCB0aW1lc3RhbXAuICovXG5jbGFzcyBfX1BSSVZBVEVfU2VydmVyVGltZXN0YW1wVHJhbnNmb3JtIGV4dGVuZHMgVHJhbnNmb3JtT3BlcmF0aW9uIHt9XG5cbi8qKiBUcmFuc2Zvcm1zIGFuIGFycmF5IHZhbHVlIHZpYSBhIHVuaW9uIG9wZXJhdGlvbi4gKi8gY2xhc3MgX19QUklWQVRFX0FycmF5VW5pb25UcmFuc2Zvcm1PcGVyYXRpb24gZXh0ZW5kcyBUcmFuc2Zvcm1PcGVyYXRpb24ge1xuICAgIGNvbnN0cnVjdG9yKGUpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5lbGVtZW50cyA9IGU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfYXBwbHlBcnJheVVuaW9uVHJhbnNmb3JtT3BlcmF0aW9uKGUsIHQpIHtcbiAgICBjb25zdCBuID0gX19QUklWQVRFX2NvZXJjZWRGaWVsZFZhbHVlc0FycmF5KHQpO1xuICAgIGZvciAoY29uc3QgdCBvZiBlLmVsZW1lbnRzKSBuLnNvbWUoKGUgPT4gX19QUklWQVRFX3ZhbHVlRXF1YWxzKGUsIHQpKSkgfHwgbi5wdXNoKHQpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGFycmF5VmFsdWU6IHtcbiAgICAgICAgICAgIHZhbHVlczogblxuICAgICAgICB9XG4gICAgfTtcbn1cblxuLyoqIFRyYW5zZm9ybXMgYW4gYXJyYXkgdmFsdWUgdmlhIGEgcmVtb3ZlIG9wZXJhdGlvbi4gKi8gY2xhc3MgX19QUklWQVRFX0FycmF5UmVtb3ZlVHJhbnNmb3JtT3BlcmF0aW9uIGV4dGVuZHMgVHJhbnNmb3JtT3BlcmF0aW9uIHtcbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuZWxlbWVudHMgPSBlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2FwcGx5QXJyYXlSZW1vdmVUcmFuc2Zvcm1PcGVyYXRpb24oZSwgdCkge1xuICAgIGxldCBuID0gX19QUklWQVRFX2NvZXJjZWRGaWVsZFZhbHVlc0FycmF5KHQpO1xuICAgIGZvciAoY29uc3QgdCBvZiBlLmVsZW1lbnRzKSBuID0gbi5maWx0ZXIoKGUgPT4gIV9fUFJJVkFURV92YWx1ZUVxdWFscyhlLCB0KSkpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGFycmF5VmFsdWU6IHtcbiAgICAgICAgICAgIHZhbHVlczogblxuICAgICAgICB9XG4gICAgfTtcbn1cblxuLyoqXG4gKiBJbXBsZW1lbnRzIHRoZSBiYWNrZW5kIHNlbWFudGljcyBmb3IgbG9jYWxseSBjb21wdXRlZCBOVU1FUklDX0FERCAoaW5jcmVtZW50KVxuICogdHJhbnNmb3Jtcy4gQ29udmVydHMgYWxsIGZpZWxkIHZhbHVlcyB0byBpbnRlZ2VycyBvciBkb3VibGVzLCBidXQgdW5saWtlIHRoZVxuICogYmFja2VuZCBkb2VzIG5vdCBjYXAgaW50ZWdlciB2YWx1ZXMgYXQgMl42My4gSW5zdGVhZCwgSmF2YVNjcmlwdCBudW1iZXJcbiAqIGFyaXRobWV0aWMgaXMgdXNlZCBhbmQgcHJlY2lzaW9uIGxvc3MgY2FuIG9jY3VyIGZvciB2YWx1ZXMgZ3JlYXRlciB0aGFuIDJeNTMuXG4gKi8gY2xhc3MgX19QUklWQVRFX051bWVyaWNJbmNyZW1lbnRUcmFuc2Zvcm1PcGVyYXRpb24gZXh0ZW5kcyBUcmFuc2Zvcm1PcGVyYXRpb24ge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5zZXJpYWxpemVyID0gZSwgdGhpcy5BZSA9IHQ7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBhc051bWJlcihlKSB7XG4gICAgcmV0dXJuIF9fUFJJVkFURV9ub3JtYWxpemVOdW1iZXIoZS5pbnRlZ2VyVmFsdWUgfHwgZS5kb3VibGVWYWx1ZSk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9jb2VyY2VkRmllbGRWYWx1ZXNBcnJheShlKSB7XG4gICAgcmV0dXJuIGlzQXJyYXkoZSkgJiYgZS5hcnJheVZhbHVlLnZhbHVlcyA/IGUuYXJyYXlWYWx1ZS52YWx1ZXMuc2xpY2UoKSA6IFtdO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqIEEgZmllbGQgcGF0aCBhbmQgdGhlIFRyYW5zZm9ybU9wZXJhdGlvbiB0byBwZXJmb3JtIHVwb24gaXQuICovIGNsYXNzIEZpZWxkVHJhbnNmb3JtIHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0KSB7XG4gICAgICAgIHRoaXMuZmllbGQgPSBlLCB0aGlzLnRyYW5zZm9ybSA9IHQ7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfZmllbGRUcmFuc2Zvcm1FcXVhbHMoZSwgdCkge1xuICAgIHJldHVybiBlLmZpZWxkLmlzRXF1YWwodC5maWVsZCkgJiYgZnVuY3Rpb24gX19QUklWQVRFX3RyYW5zZm9ybU9wZXJhdGlvbkVxdWFscyhlLCB0KSB7XG4gICAgICAgIHJldHVybiBlIGluc3RhbmNlb2YgX19QUklWQVRFX0FycmF5VW5pb25UcmFuc2Zvcm1PcGVyYXRpb24gJiYgdCBpbnN0YW5jZW9mIF9fUFJJVkFURV9BcnJheVVuaW9uVHJhbnNmb3JtT3BlcmF0aW9uIHx8IGUgaW5zdGFuY2VvZiBfX1BSSVZBVEVfQXJyYXlSZW1vdmVUcmFuc2Zvcm1PcGVyYXRpb24gJiYgdCBpbnN0YW5jZW9mIF9fUFJJVkFURV9BcnJheVJlbW92ZVRyYW5zZm9ybU9wZXJhdGlvbiA/IF9fUFJJVkFURV9hcnJheUVxdWFscyhlLmVsZW1lbnRzLCB0LmVsZW1lbnRzLCBfX1BSSVZBVEVfdmFsdWVFcXVhbHMpIDogZSBpbnN0YW5jZW9mIF9fUFJJVkFURV9OdW1lcmljSW5jcmVtZW50VHJhbnNmb3JtT3BlcmF0aW9uICYmIHQgaW5zdGFuY2VvZiBfX1BSSVZBVEVfTnVtZXJpY0luY3JlbWVudFRyYW5zZm9ybU9wZXJhdGlvbiA/IF9fUFJJVkFURV92YWx1ZUVxdWFscyhlLkFlLCB0LkFlKSA6IGUgaW5zdGFuY2VvZiBfX1BSSVZBVEVfU2VydmVyVGltZXN0YW1wVHJhbnNmb3JtICYmIHQgaW5zdGFuY2VvZiBfX1BSSVZBVEVfU2VydmVyVGltZXN0YW1wVHJhbnNmb3JtO1xuICAgIH0oZS50cmFuc2Zvcm0sIHQudHJhbnNmb3JtKTtcbn1cblxuLyoqIFRoZSByZXN1bHQgb2Ygc3VjY2Vzc2Z1bGx5IGFwcGx5aW5nIGEgbXV0YXRpb24gdG8gdGhlIGJhY2tlbmQuICovXG5jbGFzcyBNdXRhdGlvblJlc3VsdCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIHZlcnNpb24gYXQgd2hpY2ggdGhlIG11dGF0aW9uIHdhcyBjb21taXR0ZWQ6XG4gICAgICpcbiAgICAgKiAtIEZvciBtb3N0IG9wZXJhdGlvbnMsIHRoaXMgaXMgdGhlIHVwZGF0ZVRpbWUgaW4gdGhlIFdyaXRlUmVzdWx0LlxuICAgICAqIC0gRm9yIGRlbGV0ZXMsIHRoZSBjb21taXRUaW1lIG9mIHRoZSBXcml0ZVJlc3BvbnNlIChiZWNhdXNlIGRlbGV0ZXMgYXJlXG4gICAgICogICBub3Qgc3RvcmVkIGFuZCBoYXZlIG5vIHVwZGF0ZVRpbWUpLlxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IHRoZXNlIHZlcnNpb25zIGNhbiBiZSBkaWZmZXJlbnQ6IE5vLW9wIHdyaXRlcyB3aWxsIG5vdCBjaGFuZ2VcbiAgICAgKiB0aGUgdXBkYXRlVGltZSBldmVuIHRob3VnaCB0aGUgY29tbWl0VGltZSBhZHZhbmNlcy5cbiAgICAgKi9cbiAgICBlLCBcbiAgICAvKipcbiAgICAgKiBUaGUgcmVzdWx0aW5nIGZpZWxkcyByZXR1cm5lZCBmcm9tIHRoZSBiYWNrZW5kIGFmdGVyIGEgbXV0YXRpb25cbiAgICAgKiBjb250YWluaW5nIGZpZWxkIHRyYW5zZm9ybXMgaGFzIGJlZW4gY29tbWl0dGVkLiBDb250YWlucyBvbmUgRmllbGRWYWx1ZVxuICAgICAqIGZvciBlYWNoIEZpZWxkVHJhbnNmb3JtIHRoYXQgd2FzIGluIHRoZSBtdXRhdGlvbi5cbiAgICAgKlxuICAgICAqIFdpbGwgYmUgZW1wdHkgaWYgdGhlIG11dGF0aW9uIGRpZCBub3QgY29udGFpbiBhbnkgZmllbGQgdHJhbnNmb3Jtcy5cbiAgICAgKi9cbiAgICB0KSB7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IGUsIHRoaXMudHJhbnNmb3JtUmVzdWx0cyA9IHQ7XG4gICAgfVxufVxuXG4vKipcbiAqIEVuY29kZXMgYSBwcmVjb25kaXRpb24gZm9yIGEgbXV0YXRpb24uIFRoaXMgZm9sbG93cyB0aGUgbW9kZWwgdGhhdCB0aGVcbiAqIGJhY2tlbmQgYWNjZXB0cyB3aXRoIHRoZSBzcGVjaWFsIGNhc2Ugb2YgYW4gZXhwbGljaXQgXCJlbXB0eVwiIHByZWNvbmRpdGlvblxuICogKG1lYW5pbmcgbm8gcHJlY29uZGl0aW9uKS5cbiAqLyBjbGFzcyBQcmVjb25kaXRpb24ge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQpIHtcbiAgICAgICAgdGhpcy51cGRhdGVUaW1lID0gZSwgdGhpcy5leGlzdHMgPSB0O1xuICAgIH1cbiAgICAvKiogQ3JlYXRlcyBhIG5ldyBlbXB0eSBQcmVjb25kaXRpb24uICovICAgIHN0YXRpYyBub25lKCkge1xuICAgICAgICByZXR1cm4gbmV3IFByZWNvbmRpdGlvbjtcbiAgICB9XG4gICAgLyoqIENyZWF0ZXMgYSBuZXcgUHJlY29uZGl0aW9uIHdpdGggYW4gZXhpc3RzIGZsYWcuICovICAgIHN0YXRpYyBleGlzdHMoZSkge1xuICAgICAgICByZXR1cm4gbmV3IFByZWNvbmRpdGlvbih2b2lkIDAsIGUpO1xuICAgIH1cbiAgICAvKiogQ3JlYXRlcyBhIG5ldyBQcmVjb25kaXRpb24gYmFzZWQgb24gYSB2ZXJzaW9uIGEgZG9jdW1lbnQgZXhpc3RzIGF0LiAqLyAgICBzdGF0aWMgdXBkYXRlVGltZShlKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJlY29uZGl0aW9uKGUpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyB3aGV0aGVyIHRoaXMgUHJlY29uZGl0aW9uIGlzIGVtcHR5LiAqLyAgICBnZXQgaXNOb25lKCkge1xuICAgICAgICByZXR1cm4gdm9pZCAwID09PSB0aGlzLnVwZGF0ZVRpbWUgJiYgdm9pZCAwID09PSB0aGlzLmV4aXN0cztcbiAgICB9XG4gICAgaXNFcXVhbChlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmV4aXN0cyA9PT0gZS5leGlzdHMgJiYgKHRoaXMudXBkYXRlVGltZSA/ICEhZS51cGRhdGVUaW1lICYmIHRoaXMudXBkYXRlVGltZS5pc0VxdWFsKGUudXBkYXRlVGltZSkgOiAhZS51cGRhdGVUaW1lKTtcbiAgICB9XG59XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgdGhlIHByZWNvbmRpdGlvbnMgaXMgdmFsaWQgZm9yIHRoZSBnaXZlbiBkb2N1bWVudC4gKi8gZnVuY3Rpb24gX19QUklWQVRFX3ByZWNvbmRpdGlvbklzVmFsaWRGb3JEb2N1bWVudChlLCB0KSB7XG4gICAgcmV0dXJuIHZvaWQgMCAhPT0gZS51cGRhdGVUaW1lID8gdC5pc0ZvdW5kRG9jdW1lbnQoKSAmJiB0LnZlcnNpb24uaXNFcXVhbChlLnVwZGF0ZVRpbWUpIDogdm9pZCAwID09PSBlLmV4aXN0cyB8fCBlLmV4aXN0cyA9PT0gdC5pc0ZvdW5kRG9jdW1lbnQoKTtcbn1cblxuLyoqXG4gKiBBIG11dGF0aW9uIGRlc2NyaWJlcyBhIHNlbGYtY29udGFpbmVkIGNoYW5nZSB0byBhIGRvY3VtZW50LiBNdXRhdGlvbnMgY2FuXG4gKiBjcmVhdGUsIHJlcGxhY2UsIGRlbGV0ZSwgYW5kIHVwZGF0ZSBzdWJzZXRzIG9mIGRvY3VtZW50cy5cbiAqXG4gKiBNdXRhdGlvbnMgbm90IG9ubHkgYWN0IG9uIHRoZSB2YWx1ZSBvZiB0aGUgZG9jdW1lbnQgYnV0IGFsc28gaXRzIHZlcnNpb24uXG4gKlxuICogRm9yIGxvY2FsIG11dGF0aW9ucyAobXV0YXRpb25zIHRoYXQgaGF2ZW4ndCBiZWVuIGNvbW1pdHRlZCB5ZXQpLCB3ZSBwcmVzZXJ2ZVxuICogdGhlIGV4aXN0aW5nIHZlcnNpb24gZm9yIFNldCBhbmQgUGF0Y2ggbXV0YXRpb25zLiBGb3IgRGVsZXRlIG11dGF0aW9ucywgd2VcbiAqIHJlc2V0IHRoZSB2ZXJzaW9uIHRvIDAuXG4gKlxuICogSGVyZSdzIHRoZSBleHBlY3RlZCB0cmFuc2l0aW9uIHRhYmxlLlxuICpcbiAqIE1VVEFUSU9OICAgICAgICAgICBBUFBMSUVEIFRPICAgICAgICAgICAgUkVTVUxUUyBJTlxuICpcbiAqIFNldE11dGF0aW9uICAgICAgICBEb2N1bWVudCh2MykgICAgICAgICAgRG9jdW1lbnQodjMpXG4gKiBTZXRNdXRhdGlvbiAgICAgICAgTm9Eb2N1bWVudCh2MykgICAgICAgIERvY3VtZW50KHYwKVxuICogU2V0TXV0YXRpb24gICAgICAgIEludmFsaWREb2N1bWVudCh2MCkgICBEb2N1bWVudCh2MClcbiAqIFBhdGNoTXV0YXRpb24gICAgICBEb2N1bWVudCh2MykgICAgICAgICAgRG9jdW1lbnQodjMpXG4gKiBQYXRjaE11dGF0aW9uICAgICAgTm9Eb2N1bWVudCh2MykgICAgICAgIE5vRG9jdW1lbnQodjMpXG4gKiBQYXRjaE11dGF0aW9uICAgICAgSW52YWxpZERvY3VtZW50KHYwKSAgIFVua25vd25Eb2N1bWVudCh2MylcbiAqIERlbGV0ZU11dGF0aW9uICAgICBEb2N1bWVudCh2MykgICAgICAgICAgTm9Eb2N1bWVudCh2MClcbiAqIERlbGV0ZU11dGF0aW9uICAgICBOb0RvY3VtZW50KHYzKSAgICAgICAgTm9Eb2N1bWVudCh2MClcbiAqIERlbGV0ZU11dGF0aW9uICAgICBJbnZhbGlkRG9jdW1lbnQodjApICAgTm9Eb2N1bWVudCh2MClcbiAqXG4gKiBGb3IgYWNrbm93bGVkZ2VkIG11dGF0aW9ucywgd2UgdXNlIHRoZSB1cGRhdGVUaW1lIG9mIHRoZSBXcml0ZVJlc3BvbnNlIGFzXG4gKiB0aGUgcmVzdWx0aW5nIHZlcnNpb24gZm9yIFNldCBhbmQgUGF0Y2ggbXV0YXRpb25zLiBBcyBkZWxldGVzIGhhdmUgbm9cbiAqIGV4cGxpY2l0IHVwZGF0ZSB0aW1lLCB3ZSB1c2UgdGhlIGNvbW1pdFRpbWUgb2YgdGhlIFdyaXRlUmVzcG9uc2UgZm9yXG4gKiBEZWxldGUgbXV0YXRpb25zLlxuICpcbiAqIElmIGEgbXV0YXRpb24gaXMgYWNrbm93bGVkZ2VkIGJ5IHRoZSBiYWNrZW5kIGJ1dCBmYWlscyB0aGUgcHJlY29uZGl0aW9uIGNoZWNrXG4gKiBsb2NhbGx5LCB3ZSB0cmFuc2l0aW9uIHRvIGFuIGBVbmtub3duRG9jdW1lbnRgIGFuZCByZWx5IG9uIFdhdGNoIHRvIHNlbmQgdXNcbiAqIHRoZSB1cGRhdGVkIHZlcnNpb24uXG4gKlxuICogRmllbGQgdHJhbnNmb3JtcyBhcmUgdXNlZCBvbmx5IHdpdGggUGF0Y2ggYW5kIFNldCBNdXRhdGlvbnMuIFdlIHVzZSB0aGVcbiAqIGB1cGRhdGVUcmFuc2Zvcm1zYCBtZXNzYWdlIHRvIHN0b3JlIHRyYW5zZm9ybXMsIHJhdGhlciB0aGFuIHRoZSBgdHJhbnNmb3Jtc2BzXG4gKiBtZXNzYWdlcy5cbiAqXG4gKiAjIyBTdWJjbGFzc2luZyBOb3Rlc1xuICpcbiAqIEV2ZXJ5IHR5cGUgb2YgbXV0YXRpb24gbmVlZHMgdG8gaW1wbGVtZW50IGl0cyBvd24gYXBwbHlUb1JlbW90ZURvY3VtZW50KCkgYW5kXG4gKiBhcHBseVRvTG9jYWxWaWV3KCkgdG8gaW1wbGVtZW50IHRoZSBhY3R1YWwgYmVoYXZpb3Igb2YgYXBwbHlpbmcgdGhlIG11dGF0aW9uXG4gKiB0byBzb21lIHNvdXJjZSBkb2N1bWVudCAoc2VlIGBzZXRNdXRhdGlvbkFwcGx5VG9SZW1vdGVEb2N1bWVudCgpYCBmb3IgYW5cbiAqIGV4YW1wbGUpLlxuICovIGNsYXNzIE11dGF0aW9uIHt9XG5cbi8qKlxuICogQSB1dGlsaXR5IG1ldGhvZCB0byBjYWxjdWxhdGUgYSBgTXV0YXRpb25gIHJlcHJlc2VudGluZyB0aGUgb3ZlcmxheSBmcm9tIHRoZVxuICogZmluYWwgc3RhdGUgb2YgdGhlIGRvY3VtZW50LCBhbmQgYSBgRmllbGRNYXNrYCByZXByZXNlbnRpbmcgdGhlIGZpZWxkcyB0aGF0XG4gKiBhcmUgbXV0YXRlZCBieSB0aGUgbG9jYWwgbXV0YXRpb25zLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9jYWxjdWxhdGVPdmVybGF5TXV0YXRpb24oZSwgdCkge1xuICAgIGlmICghZS5oYXNMb2NhbE11dGF0aW9ucyB8fCB0ICYmIDAgPT09IHQuZmllbGRzLmxlbmd0aCkgcmV0dXJuIG51bGw7XG4gICAgLy8gbWFzayBpcyBudWxsIHdoZW4gc2V0cyBvciBkZWxldGVzIGFyZSBhcHBsaWVkIHRvIHRoZSBjdXJyZW50IGRvY3VtZW50LlxuICAgICAgICBpZiAobnVsbCA9PT0gdCkgcmV0dXJuIGUuaXNOb0RvY3VtZW50KCkgPyBuZXcgX19QUklWQVRFX0RlbGV0ZU11dGF0aW9uKGUua2V5LCBQcmVjb25kaXRpb24ubm9uZSgpKSA6IG5ldyBfX1BSSVZBVEVfU2V0TXV0YXRpb24oZS5rZXksIGUuZGF0YSwgUHJlY29uZGl0aW9uLm5vbmUoKSk7XG4gICAge1xuICAgICAgICBjb25zdCBuID0gZS5kYXRhLCByID0gT2JqZWN0VmFsdWUuZW1wdHkoKTtcbiAgICAgICAgbGV0IGkgPSBuZXcgU29ydGVkU2V0KEZpZWxkUGF0aCQxLmNvbXBhcmF0b3IpO1xuICAgICAgICBmb3IgKGxldCBlIG9mIHQuZmllbGRzKSBpZiAoIWkuaGFzKGUpKSB7XG4gICAgICAgICAgICBsZXQgdCA9IG4uZmllbGQoZSk7XG4gICAgICAgICAgICAvLyBJZiB3ZSBhcmUgZGVsZXRpbmcgYSBuZXN0ZWQgZmllbGQsIHdlIHRha2UgdGhlIGltbWVkaWF0ZSBwYXJlbnQgYXNcbiAgICAgICAgICAgIC8vIHRoZSBtYXNrIHVzZWQgdG8gY29uc3RydWN0IHRoZSByZXN1bHRpbmcgbXV0YXRpb24uXG4gICAgICAgICAgICAvLyBKdXN0aWZpY2F0aW9uOiBOZXN0ZWQgZmllbGRzIGNhbiBjcmVhdGUgcGFyZW50IGZpZWxkcyBpbXBsaWNpdGx5LiBJZlxuICAgICAgICAgICAgLy8gb25seSBhIGxlYWYgZW50cnkgaXMgZGVsZXRlZCBpbiBsYXRlciBtdXRhdGlvbnMsIHRoZSBwYXJlbnQgZmllbGRcbiAgICAgICAgICAgIC8vIHNob3VsZCBzdGlsbCByZW1haW4sIGJ1dCB3ZSBtYXkgaGF2ZSBsb3N0IHRoaXMgaW5mb3JtYXRpb24uXG4gICAgICAgICAgICAvLyBDb25zaWRlciBtdXRhdGlvbiAoZm9vLmJhciAxKSwgdGhlbiBtdXRhdGlvbiAoZm9vLmJhciBkZWxldGUoKSkuXG4gICAgICAgICAgICAvLyBUaGlzIGxlYXZlcyB0aGUgZmluYWwgcmVzdWx0IChmb28sIHt9KS4gRGVzcGl0ZSB0aGUgZmFjdCB0aGF0IGBkb2NgXG4gICAgICAgICAgICAvLyBoYXMgdGhlIGNvcnJlY3QgcmVzdWx0LCBgZm9vYCBpcyBub3QgaW4gYG1hc2tgLCBhbmQgdGhlIHJlc3VsdGluZ1xuICAgICAgICAgICAgLy8gbXV0YXRpb24gd291bGQgbWlzcyBgZm9vYC5cbiAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgPT09IHQgJiYgZS5sZW5ndGggPiAxICYmIChlID0gZS5wb3BMYXN0KCksIHQgPSBuLmZpZWxkKGUpKSwgbnVsbCA9PT0gdCA/IHIuZGVsZXRlKGUpIDogci5zZXQoZSwgdCksIFxuICAgICAgICAgICAgaSA9IGkuYWRkKGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgX19QUklWQVRFX1BhdGNoTXV0YXRpb24oZS5rZXksIHIsIG5ldyBGaWVsZE1hc2soaS50b0FycmF5KCkpLCBQcmVjb25kaXRpb24ubm9uZSgpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQXBwbGllcyB0aGlzIG11dGF0aW9uIHRvIHRoZSBnaXZlbiBkb2N1bWVudCBmb3IgdGhlIHB1cnBvc2VzIG9mIGNvbXB1dGluZyBhXG4gKiBuZXcgcmVtb3RlIGRvY3VtZW50LiBJZiB0aGUgaW5wdXQgZG9jdW1lbnQgZG9lc24ndCBtYXRjaCB0aGUgZXhwZWN0ZWQgc3RhdGVcbiAqIChlLmcuIGl0IGlzIGludmFsaWQgb3Igb3V0ZGF0ZWQpLCB0aGUgZG9jdW1lbnQgdHlwZSBtYXkgdHJhbnNpdGlvbiB0b1xuICogdW5rbm93bi5cbiAqXG4gKiBAcGFyYW0gbXV0YXRpb24gLSBUaGUgbXV0YXRpb24gdG8gYXBwbHkuXG4gKiBAcGFyYW0gZG9jdW1lbnQgLSBUaGUgZG9jdW1lbnQgdG8gbXV0YXRlLiBUaGUgaW5wdXQgZG9jdW1lbnQgY2FuIGJlIGFuXG4gKiAgICAgaW52YWxpZCBkb2N1bWVudCBpZiB0aGUgY2xpZW50IGhhcyBubyBrbm93bGVkZ2Ugb2YgdGhlIHByZS1tdXRhdGlvbiBzdGF0ZVxuICogICAgIG9mIHRoZSBkb2N1bWVudC5cbiAqIEBwYXJhbSBtdXRhdGlvblJlc3VsdCAtIFRoZSByZXN1bHQgb2YgYXBwbHlpbmcgdGhlIG11dGF0aW9uIGZyb20gdGhlIGJhY2tlbmQuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX211dGF0aW9uQXBwbHlUb1JlbW90ZURvY3VtZW50KGUsIHQsIG4pIHtcbiAgICBlIGluc3RhbmNlb2YgX19QUklWQVRFX1NldE11dGF0aW9uID8gZnVuY3Rpb24gX19QUklWQVRFX3NldE11dGF0aW9uQXBwbHlUb1JlbW90ZURvY3VtZW50KGUsIHQsIG4pIHtcbiAgICAgICAgLy8gVW5saWtlIHNldE11dGF0aW9uQXBwbHlUb0xvY2FsVmlldywgaWYgd2UncmUgYXBwbHlpbmcgYSBtdXRhdGlvbiB0byBhXG4gICAgICAgIC8vIHJlbW90ZSBkb2N1bWVudCB0aGUgc2VydmVyIGhhcyBhY2NlcHRlZCB0aGUgbXV0YXRpb24gc28gdGhlIHByZWNvbmRpdGlvblxuICAgICAgICAvLyBtdXN0IGhhdmUgaGVsZC5cbiAgICAgICAgY29uc3QgciA9IGUudmFsdWUuY2xvbmUoKSwgaSA9IF9fUFJJVkFURV9zZXJ2ZXJUcmFuc2Zvcm1SZXN1bHRzKGUuZmllbGRUcmFuc2Zvcm1zLCB0LCBuLnRyYW5zZm9ybVJlc3VsdHMpO1xuICAgICAgICByLnNldEFsbChpKSwgdC5jb252ZXJ0VG9Gb3VuZERvY3VtZW50KG4udmVyc2lvbiwgcikuc2V0SGFzQ29tbWl0dGVkTXV0YXRpb25zKCk7XG4gICAgfShlLCB0LCBuKSA6IGUgaW5zdGFuY2VvZiBfX1BSSVZBVEVfUGF0Y2hNdXRhdGlvbiA/IGZ1bmN0aW9uIF9fUFJJVkFURV9wYXRjaE11dGF0aW9uQXBwbHlUb1JlbW90ZURvY3VtZW50KGUsIHQsIG4pIHtcbiAgICAgICAgaWYgKCFfX1BSSVZBVEVfcHJlY29uZGl0aW9uSXNWYWxpZEZvckRvY3VtZW50KGUucHJlY29uZGl0aW9uLCB0KSkgXG4gICAgICAgIC8vIFNpbmNlIHRoZSBtdXRhdGlvbiB3YXMgbm90IHJlamVjdGVkLCB3ZSBrbm93IHRoYXQgdGhlIHByZWNvbmRpdGlvblxuICAgICAgICAvLyBtYXRjaGVkIG9uIHRoZSBiYWNrZW5kLiBXZSB0aGVyZWZvcmUgbXVzdCBub3QgaGF2ZSB0aGUgZXhwZWN0ZWQgdmVyc2lvblxuICAgICAgICAvLyBvZiB0aGUgZG9jdW1lbnQgaW4gb3VyIGNhY2hlIGFuZCBjb252ZXJ0IHRvIGFuIFVua25vd25Eb2N1bWVudCB3aXRoIGFcbiAgICAgICAgLy8ga25vd24gdXBkYXRlVGltZS5cbiAgICAgICAgcmV0dXJuIHZvaWQgdC5jb252ZXJ0VG9Vbmtub3duRG9jdW1lbnQobi52ZXJzaW9uKTtcbiAgICAgICAgY29uc3QgciA9IF9fUFJJVkFURV9zZXJ2ZXJUcmFuc2Zvcm1SZXN1bHRzKGUuZmllbGRUcmFuc2Zvcm1zLCB0LCBuLnRyYW5zZm9ybVJlc3VsdHMpLCBpID0gdC5kYXRhO1xuICAgICAgICBpLnNldEFsbChfX1BSSVZBVEVfZ2V0UGF0Y2goZSkpLCBpLnNldEFsbChyKSwgdC5jb252ZXJ0VG9Gb3VuZERvY3VtZW50KG4udmVyc2lvbiwgaSkuc2V0SGFzQ29tbWl0dGVkTXV0YXRpb25zKCk7XG4gICAgfShlLCB0LCBuKSA6IGZ1bmN0aW9uIF9fUFJJVkFURV9kZWxldGVNdXRhdGlvbkFwcGx5VG9SZW1vdGVEb2N1bWVudChlLCB0LCBuKSB7XG4gICAgICAgIC8vIFVubGlrZSBhcHBseVRvTG9jYWxWaWV3LCBpZiB3ZSdyZSBhcHBseWluZyBhIG11dGF0aW9uIHRvIGEgcmVtb3RlXG4gICAgICAgIC8vIGRvY3VtZW50IHRoZSBzZXJ2ZXIgaGFzIGFjY2VwdGVkIHRoZSBtdXRhdGlvbiBzbyB0aGUgcHJlY29uZGl0aW9uIG11c3RcbiAgICAgICAgLy8gaGF2ZSBoZWxkLlxuICAgICAgICB0LmNvbnZlcnRUb05vRG9jdW1lbnQobi52ZXJzaW9uKS5zZXRIYXNDb21taXR0ZWRNdXRhdGlvbnMoKTtcbiAgICB9KDAsIHQsIG4pO1xufVxuXG4vKipcbiAqIEFwcGxpZXMgdGhpcyBtdXRhdGlvbiB0byB0aGUgZ2l2ZW4gZG9jdW1lbnQgZm9yIHRoZSBwdXJwb3NlcyBvZiBjb21wdXRpbmdcbiAqIHRoZSBuZXcgbG9jYWwgdmlldyBvZiBhIGRvY3VtZW50LiBJZiB0aGUgaW5wdXQgZG9jdW1lbnQgZG9lc24ndCBtYXRjaCB0aGVcbiAqIGV4cGVjdGVkIHN0YXRlLCB0aGUgZG9jdW1lbnQgaXMgbm90IG1vZGlmaWVkLlxuICpcbiAqIEBwYXJhbSBtdXRhdGlvbiAtIFRoZSBtdXRhdGlvbiB0byBhcHBseS5cbiAqIEBwYXJhbSBkb2N1bWVudCAtIFRoZSBkb2N1bWVudCB0byBtdXRhdGUuIFRoZSBpbnB1dCBkb2N1bWVudCBjYW4gYmUgYW5cbiAqICAgICBpbnZhbGlkIGRvY3VtZW50IGlmIHRoZSBjbGllbnQgaGFzIG5vIGtub3dsZWRnZSBvZiB0aGUgcHJlLW11dGF0aW9uIHN0YXRlXG4gKiAgICAgb2YgdGhlIGRvY3VtZW50LlxuICogQHBhcmFtIHByZXZpb3VzTWFzayAtIFRoZSBmaWVsZHMgdGhhdCBoYXZlIGJlZW4gdXBkYXRlZCBiZWZvcmUgYXBwbHlpbmcgdGhpcyBtdXRhdGlvbi5cbiAqIEBwYXJhbSBsb2NhbFdyaXRlVGltZSAtIEEgdGltZXN0YW1wIGluZGljYXRpbmcgdGhlIGxvY2FsIHdyaXRlIHRpbWUgb2YgdGhlXG4gKiAgICAgYmF0Y2ggdGhpcyBtdXRhdGlvbiBpcyBhIHBhcnQgb2YuXG4gKiBAcmV0dXJucyBBIGBGaWVsZE1hc2tgIHJlcHJlc2VudGluZyB0aGUgZmllbGRzIHRoYXQgYXJlIGNoYW5nZWQgYnkgYXBwbHlpbmcgdGhpcyBtdXRhdGlvbi5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfbXV0YXRpb25BcHBseVRvTG9jYWxWaWV3KGUsIHQsIG4sIHIpIHtcbiAgICByZXR1cm4gZSBpbnN0YW5jZW9mIF9fUFJJVkFURV9TZXRNdXRhdGlvbiA/IGZ1bmN0aW9uIF9fUFJJVkFURV9zZXRNdXRhdGlvbkFwcGx5VG9Mb2NhbFZpZXcoZSwgdCwgbiwgcikge1xuICAgICAgICBpZiAoIV9fUFJJVkFURV9wcmVjb25kaXRpb25Jc1ZhbGlkRm9yRG9jdW1lbnQoZS5wcmVjb25kaXRpb24sIHQpKSBcbiAgICAgICAgLy8gVGhlIG11dGF0aW9uIGZhaWxlZCB0byBhcHBseSAoZS5nLiBhIGRvY3VtZW50IElEIGNyZWF0ZWQgd2l0aCBhZGQoKVxuICAgICAgICAvLyBjYXVzZWQgYSBuYW1lIGNvbGxpc2lvbikuXG4gICAgICAgIHJldHVybiBuO1xuICAgICAgICBjb25zdCBpID0gZS52YWx1ZS5jbG9uZSgpLCBzID0gX19QUklWQVRFX2xvY2FsVHJhbnNmb3JtUmVzdWx0cyhlLmZpZWxkVHJhbnNmb3JtcywgciwgdCk7XG4gICAgICAgIHJldHVybiBpLnNldEFsbChzKSwgdC5jb252ZXJ0VG9Gb3VuZERvY3VtZW50KHQudmVyc2lvbiwgaSkuc2V0SGFzTG9jYWxNdXRhdGlvbnMoKSwgXG4gICAgICAgIG51bGw7XG4gLy8gU2V0TXV0YXRpb24gb3ZlcndyaXRlcyBhbGwgZmllbGRzLlxuICAgICAgICB9XG4gICAgLyoqXG4gKiBBIG11dGF0aW9uIHRoYXQgbW9kaWZpZXMgZmllbGRzIG9mIHRoZSBkb2N1bWVudCBhdCB0aGUgZ2l2ZW4ga2V5IHdpdGggdGhlXG4gKiBnaXZlbiB2YWx1ZXMuIFRoZSB2YWx1ZXMgYXJlIGFwcGxpZWQgdGhyb3VnaCBhIGZpZWxkIG1hc2s6XG4gKlxuICogICogV2hlbiBhIGZpZWxkIGlzIGluIGJvdGggdGhlIG1hc2sgYW5kIHRoZSB2YWx1ZXMsIHRoZSBjb3JyZXNwb25kaW5nIGZpZWxkXG4gKiAgICBpcyB1cGRhdGVkLlxuICogICogV2hlbiBhIGZpZWxkIGlzIGluIG5laXRoZXIgdGhlIG1hc2sgbm9yIHRoZSB2YWx1ZXMsIHRoZSBjb3JyZXNwb25kaW5nXG4gKiAgICBmaWVsZCBpcyB1bm1vZGlmaWVkLlxuICogICogV2hlbiBhIGZpZWxkIGlzIGluIHRoZSBtYXNrIGJ1dCBub3QgaW4gdGhlIHZhbHVlcywgdGhlIGNvcnJlc3BvbmRpbmcgZmllbGRcbiAqICAgIGlzIGRlbGV0ZWQuXG4gKiAgKiBXaGVuIGEgZmllbGQgaXMgbm90IGluIHRoZSBtYXNrIGJ1dCBpcyBpbiB0aGUgdmFsdWVzLCB0aGUgdmFsdWVzIG1hcCBpc1xuICogICAgaWdub3JlZC5cbiAqLyAoZSwgdCwgbiwgcikgOiBlIGluc3RhbmNlb2YgX19QUklWQVRFX1BhdGNoTXV0YXRpb24gPyBmdW5jdGlvbiBfX1BSSVZBVEVfcGF0Y2hNdXRhdGlvbkFwcGx5VG9Mb2NhbFZpZXcoZSwgdCwgbiwgcikge1xuICAgICAgICBpZiAoIV9fUFJJVkFURV9wcmVjb25kaXRpb25Jc1ZhbGlkRm9yRG9jdW1lbnQoZS5wcmVjb25kaXRpb24sIHQpKSByZXR1cm4gbjtcbiAgICAgICAgY29uc3QgaSA9IF9fUFJJVkFURV9sb2NhbFRyYW5zZm9ybVJlc3VsdHMoZS5maWVsZFRyYW5zZm9ybXMsIHIsIHQpLCBzID0gdC5kYXRhO1xuICAgICAgICBpZiAocy5zZXRBbGwoX19QUklWQVRFX2dldFBhdGNoKGUpKSwgcy5zZXRBbGwoaSksIHQuY29udmVydFRvRm91bmREb2N1bWVudCh0LnZlcnNpb24sIHMpLnNldEhhc0xvY2FsTXV0YXRpb25zKCksIFxuICAgICAgICBudWxsID09PSBuKSByZXR1cm4gbnVsbDtcbiAgICAgICAgcmV0dXJuIG4udW5pb25XaXRoKGUuZmllbGRNYXNrLmZpZWxkcykudW5pb25XaXRoKGUuZmllbGRUcmFuc2Zvcm1zLm1hcCgoZSA9PiBlLmZpZWxkKSkpO1xuICAgIH1cbiAgICAvKipcbiAqIFJldHVybnMgYSBGaWVsZFBhdGgvVmFsdWUgbWFwIHdpdGggdGhlIGNvbnRlbnQgb2YgdGhlIFBhdGNoTXV0YXRpb24uXG4gKi8gKGUsIHQsIG4sIHIpIDogZnVuY3Rpb24gX19QUklWQVRFX2RlbGV0ZU11dGF0aW9uQXBwbHlUb0xvY2FsVmlldyhlLCB0LCBuKSB7XG4gICAgICAgIGlmIChfX1BSSVZBVEVfcHJlY29uZGl0aW9uSXNWYWxpZEZvckRvY3VtZW50KGUucHJlY29uZGl0aW9uLCB0KSkgcmV0dXJuIHQuY29udmVydFRvTm9Eb2N1bWVudCh0LnZlcnNpb24pLnNldEhhc0xvY2FsTXV0YXRpb25zKCksIFxuICAgICAgICBudWxsO1xuICAgICAgICByZXR1cm4gbjtcbiAgICB9XG4gICAgLyoqXG4gKiBBIG11dGF0aW9uIHRoYXQgdmVyaWZpZXMgdGhlIGV4aXN0ZW5jZSBvZiB0aGUgZG9jdW1lbnQgYXQgdGhlIGdpdmVuIGtleSB3aXRoXG4gKiB0aGUgcHJvdmlkZWQgcHJlY29uZGl0aW9uLlxuICpcbiAqIFRoZSBgdmVyaWZ5YCBvcGVyYXRpb24gaXMgb25seSB1c2VkIGluIFRyYW5zYWN0aW9ucywgYW5kIHRoaXMgY2xhc3Mgc2VydmVzXG4gKiBwcmltYXJpbHkgdG8gZmFjaWxpdGF0ZSBzZXJpYWxpemF0aW9uIGludG8gcHJvdG9zLlxuICovIChlLCB0LCBuKTtcbn1cblxuLyoqXG4gKiBJZiB0aGlzIG11dGF0aW9uIGlzIG5vdCBpZGVtcG90ZW50LCByZXR1cm5zIHRoZSBiYXNlIHZhbHVlIHRvIHBlcnNpc3Qgd2l0aFxuICogdGhpcyBtdXRhdGlvbi4gSWYgYSBiYXNlIHZhbHVlIGlzIHJldHVybmVkLCB0aGUgbXV0YXRpb24gaXMgYWx3YXlzIGFwcGxpZWRcbiAqIHRvIHRoaXMgYmFzZSB2YWx1ZSwgZXZlbiBpZiBkb2N1bWVudCBoYXMgYWxyZWFkeSBiZWVuIHVwZGF0ZWQuXG4gKlxuICogVGhlIGJhc2UgdmFsdWUgaXMgYSBzcGFyc2Ugb2JqZWN0IHRoYXQgY29uc2lzdHMgb2Ygb25seSB0aGUgZG9jdW1lbnRcbiAqIGZpZWxkcyBmb3Igd2hpY2ggdGhpcyBtdXRhdGlvbiBjb250YWlucyBhIG5vbi1pZGVtcG90ZW50IHRyYW5zZm9ybWF0aW9uXG4gKiAoZS5nLiBhIG51bWVyaWMgaW5jcmVtZW50KS4gVGhlIHByb3ZpZGVkIHZhbHVlIGd1YXJhbnRlZXMgY29uc2lzdGVudFxuICogYmVoYXZpb3IgZm9yIG5vbi1pZGVtcG90ZW50IHRyYW5zZm9ybXMgYW5kIGFsbG93IHVzIHRvIHJldHVybiB0aGUgc2FtZVxuICogbGF0ZW5jeS1jb21wZW5zYXRlZCB2YWx1ZSBldmVuIGlmIHRoZSBiYWNrZW5kIGhhcyBhbHJlYWR5IGFwcGxpZWQgdGhlXG4gKiBtdXRhdGlvbi4gVGhlIGJhc2UgdmFsdWUgaXMgbnVsbCBmb3IgaWRlbXBvdGVudCBtdXRhdGlvbnMsIGFzIHRoZXkgY2FuIGJlXG4gKiByZS1wbGF5ZWQgZXZlbiBpZiB0aGUgYmFja2VuZCBoYXMgYWxyZWFkeSBhcHBsaWVkIHRoZW0uXG4gKlxuICogQHJldHVybnMgYSBiYXNlIHZhbHVlIHRvIHN0b3JlIGFsb25nIHdpdGggdGhlIG11dGF0aW9uLCBvciBudWxsIGZvclxuICogaWRlbXBvdGVudCBtdXRhdGlvbnMuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX211dGF0aW9uRXh0cmFjdEJhc2VWYWx1ZShlLCB0KSB7XG4gICAgbGV0IG4gPSBudWxsO1xuICAgIGZvciAoY29uc3QgciBvZiBlLmZpZWxkVHJhbnNmb3Jtcykge1xuICAgICAgICBjb25zdCBlID0gdC5kYXRhLmZpZWxkKHIuZmllbGQpLCBpID0gX19QUklWQVRFX2NvbXB1dGVUcmFuc2Zvcm1PcGVyYXRpb25CYXNlVmFsdWUoci50cmFuc2Zvcm0sIGUgfHwgbnVsbCk7XG4gICAgICAgIG51bGwgIT0gaSAmJiAobnVsbCA9PT0gbiAmJiAobiA9IE9iamVjdFZhbHVlLmVtcHR5KCkpLCBuLnNldChyLmZpZWxkLCBpKSk7XG4gICAgfVxuICAgIHJldHVybiBuIHx8IG51bGw7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9tdXRhdGlvbkVxdWFscyhlLCB0KSB7XG4gICAgcmV0dXJuIGUudHlwZSA9PT0gdC50eXBlICYmICghIWUua2V5LmlzRXF1YWwodC5rZXkpICYmICghIWUucHJlY29uZGl0aW9uLmlzRXF1YWwodC5wcmVjb25kaXRpb24pICYmICghIWZ1bmN0aW9uIF9fUFJJVkFURV9maWVsZFRyYW5zZm9ybXNBcmVFcXVhbChlLCB0KSB7XG4gICAgICAgIHJldHVybiB2b2lkIDAgPT09IGUgJiYgdm9pZCAwID09PSB0IHx8ICEoIWUgfHwgIXQpICYmIF9fUFJJVkFURV9hcnJheUVxdWFscyhlLCB0LCAoKGUsIHQpID0+IF9fUFJJVkFURV9maWVsZFRyYW5zZm9ybUVxdWFscyhlLCB0KSkpO1xuICAgIH0oZS5maWVsZFRyYW5zZm9ybXMsIHQuZmllbGRUcmFuc2Zvcm1zKSAmJiAoMCAvKiBNdXRhdGlvblR5cGUuU2V0ICovID09PSBlLnR5cGUgPyBlLnZhbHVlLmlzRXF1YWwodC52YWx1ZSkgOiAxIC8qIE11dGF0aW9uVHlwZS5QYXRjaCAqLyAhPT0gZS50eXBlIHx8IGUuZGF0YS5pc0VxdWFsKHQuZGF0YSkgJiYgZS5maWVsZE1hc2suaXNFcXVhbCh0LmZpZWxkTWFzaykpKSkpO1xufVxuXG4vKipcbiAqIEEgbXV0YXRpb24gdGhhdCBjcmVhdGVzIG9yIHJlcGxhY2VzIHRoZSBkb2N1bWVudCBhdCB0aGUgZ2l2ZW4ga2V5IHdpdGggdGhlXG4gKiBvYmplY3QgdmFsdWUgY29udGVudHMuXG4gKi8gY2xhc3MgX19QUklWQVRFX1NldE11dGF0aW9uIGV4dGVuZHMgTXV0YXRpb24ge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4sIHIgPSBbXSkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmtleSA9IGUsIHRoaXMudmFsdWUgPSB0LCB0aGlzLnByZWNvbmRpdGlvbiA9IG4sIHRoaXMuZmllbGRUcmFuc2Zvcm1zID0gciwgXG4gICAgICAgIHRoaXMudHlwZSA9IDAgLyogTXV0YXRpb25UeXBlLlNldCAqLztcbiAgICB9XG4gICAgZ2V0RmllbGRNYXNrKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59XG5cbmNsYXNzIF9fUFJJVkFURV9QYXRjaE11dGF0aW9uIGV4dGVuZHMgTXV0YXRpb24ge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4sIHIsIGkgPSBbXSkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmtleSA9IGUsIHRoaXMuZGF0YSA9IHQsIHRoaXMuZmllbGRNYXNrID0gbiwgdGhpcy5wcmVjb25kaXRpb24gPSByLCBcbiAgICAgICAgdGhpcy5maWVsZFRyYW5zZm9ybXMgPSBpLCB0aGlzLnR5cGUgPSAxIC8qIE11dGF0aW9uVHlwZS5QYXRjaCAqLztcbiAgICB9XG4gICAgZ2V0RmllbGRNYXNrKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5maWVsZE1hc2s7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfZ2V0UGF0Y2goZSkge1xuICAgIGNvbnN0IHQgPSBuZXcgTWFwO1xuICAgIHJldHVybiBlLmZpZWxkTWFzay5maWVsZHMuZm9yRWFjaCgobiA9PiB7XG4gICAgICAgIGlmICghbi5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBlLmRhdGEuZmllbGQobik7XG4gICAgICAgICAgICB0LnNldChuLCByKTtcbiAgICAgICAgfVxuICAgIH0pKSwgdDtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbGlzdCBvZiBcInRyYW5zZm9ybSByZXN1bHRzXCIgKGEgdHJhbnNmb3JtIHJlc3VsdCBpcyBhIGZpZWxkIHZhbHVlXG4gKiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdCBvZiBhcHBseWluZyBhIHRyYW5zZm9ybSkgZm9yIHVzZSBhZnRlciBhIG11dGF0aW9uXG4gKiBjb250YWluaW5nIHRyYW5zZm9ybXMgaGFzIGJlZW4gYWNrbm93bGVkZ2VkIGJ5IHRoZSBzZXJ2ZXIuXG4gKlxuICogQHBhcmFtIGZpZWxkVHJhbnNmb3JtcyAtIFRoZSBmaWVsZCB0cmFuc2Zvcm1zIHRvIGFwcGx5IHRoZSByZXN1bHQgdG8uXG4gKiBAcGFyYW0gbXV0YWJsZURvY3VtZW50IC0gVGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIGRvY3VtZW50IGFmdGVyIGFwcGx5aW5nIGFsbFxuICogcHJldmlvdXMgbXV0YXRpb25zLlxuICogQHBhcmFtIHNlcnZlclRyYW5zZm9ybVJlc3VsdHMgLSBUaGUgdHJhbnNmb3JtIHJlc3VsdHMgcmVjZWl2ZWQgYnkgdGhlIHNlcnZlci5cbiAqIEByZXR1cm5zIFRoZSB0cmFuc2Zvcm0gcmVzdWx0cyBsaXN0LlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9zZXJ2ZXJUcmFuc2Zvcm1SZXN1bHRzKGUsIHQsIG4pIHtcbiAgICBjb25zdCByID0gbmV3IE1hcDtcbiAgICBfX1BSSVZBVEVfaGFyZEFzc2VydChlLmxlbmd0aCA9PT0gbi5sZW5ndGgsIDMyNjU2LCB7XG4gICAgICAgIFJlOiBuLmxlbmd0aCxcbiAgICAgICAgVmU6IGUubGVuZ3RoXG4gICAgfSk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHMgPSBlW2ldLCBvID0gcy50cmFuc2Zvcm0sIF8gPSB0LmRhdGEuZmllbGQocy5maWVsZCk7XG4gICAgICAgIHIuc2V0KHMuZmllbGQsIF9fUFJJVkFURV9hcHBseVRyYW5zZm9ybU9wZXJhdGlvblRvUmVtb3RlRG9jdW1lbnQobywgXywgbltpXSkpO1xuICAgIH1cbiAgICByZXR1cm4gcjtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbGlzdCBvZiBcInRyYW5zZm9ybSByZXN1bHRzXCIgKGEgdHJhbnNmb3JtIHJlc3VsdCBpcyBhIGZpZWxkIHZhbHVlXG4gKiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdCBvZiBhcHBseWluZyBhIHRyYW5zZm9ybSkgZm9yIHVzZSB3aGVuIGFwcGx5aW5nIGFcbiAqIHRyYW5zZm9ybSBsb2NhbGx5LlxuICpcbiAqIEBwYXJhbSBmaWVsZFRyYW5zZm9ybXMgLSBUaGUgZmllbGQgdHJhbnNmb3JtcyB0byBhcHBseSB0aGUgcmVzdWx0IHRvLlxuICogQHBhcmFtIGxvY2FsV3JpdGVUaW1lIC0gVGhlIGxvY2FsIHRpbWUgb2YgdGhlIG11dGF0aW9uICh1c2VkIHRvXG4gKiAgICAgZ2VuZXJhdGUgU2VydmVyVGltZXN0YW1wVmFsdWVzKS5cbiAqIEBwYXJhbSBtdXRhYmxlRG9jdW1lbnQgLSBUaGUgZG9jdW1lbnQgdG8gYXBwbHkgdHJhbnNmb3JtcyBvbi5cbiAqIEByZXR1cm5zIFRoZSB0cmFuc2Zvcm0gcmVzdWx0cyBsaXN0LlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9sb2NhbFRyYW5zZm9ybVJlc3VsdHMoZSwgdCwgbikge1xuICAgIGNvbnN0IHIgPSBuZXcgTWFwO1xuICAgIGZvciAoY29uc3QgaSBvZiBlKSB7XG4gICAgICAgIGNvbnN0IGUgPSBpLnRyYW5zZm9ybSwgcyA9IG4uZGF0YS5maWVsZChpLmZpZWxkKTtcbiAgICAgICAgci5zZXQoaS5maWVsZCwgX19QUklWQVRFX2FwcGx5VHJhbnNmb3JtT3BlcmF0aW9uVG9Mb2NhbFZpZXcoZSwgcywgdCkpO1xuICAgIH1cbiAgICByZXR1cm4gcjtcbn1cblxuLyoqIEEgbXV0YXRpb24gdGhhdCBkZWxldGVzIHRoZSBkb2N1bWVudCBhdCB0aGUgZ2l2ZW4ga2V5LiAqLyBjbGFzcyBfX1BSSVZBVEVfRGVsZXRlTXV0YXRpb24gZXh0ZW5kcyBNdXRhdGlvbiB7XG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmtleSA9IGUsIHRoaXMucHJlY29uZGl0aW9uID0gdCwgdGhpcy50eXBlID0gMiAvKiBNdXRhdGlvblR5cGUuRGVsZXRlICovICwgXG4gICAgICAgIHRoaXMuZmllbGRUcmFuc2Zvcm1zID0gW107XG4gICAgfVxuICAgIGdldEZpZWxkTWFzaygpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxuXG5jbGFzcyBfX1BSSVZBVEVfVmVyaWZ5TXV0YXRpb24gZXh0ZW5kcyBNdXRhdGlvbiB7XG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmtleSA9IGUsIHRoaXMucHJlY29uZGl0aW9uID0gdCwgdGhpcy50eXBlID0gMyAvKiBNdXRhdGlvblR5cGUuVmVyaWZ5ICovICwgXG4gICAgICAgIHRoaXMuZmllbGRUcmFuc2Zvcm1zID0gW107XG4gICAgfVxuICAgIGdldEZpZWxkTWFzaygpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGJhdGNoIG9mIG11dGF0aW9ucyB0aGF0IHdpbGwgYmUgc2VudCBhcyBvbmUgdW5pdCB0byB0aGUgYmFja2VuZC5cbiAqLyBjbGFzcyBNdXRhdGlvbkJhdGNoIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gYmF0Y2hJZCAtIFRoZSB1bmlxdWUgSUQgb2YgdGhpcyBtdXRhdGlvbiBiYXRjaC5cbiAgICAgKiBAcGFyYW0gbG9jYWxXcml0ZVRpbWUgLSBUaGUgb3JpZ2luYWwgd3JpdGUgdGltZSBvZiB0aGlzIG11dGF0aW9uLlxuICAgICAqIEBwYXJhbSBiYXNlTXV0YXRpb25zIC0gTXV0YXRpb25zIHRoYXQgYXJlIHVzZWQgdG8gcG9wdWxhdGUgdGhlIGJhc2VcbiAgICAgKiB2YWx1ZXMgd2hlbiB0aGlzIG11dGF0aW9uIGlzIGFwcGxpZWQgbG9jYWxseS4gVGhpcyBjYW4gYmUgdXNlZCB0byBsb2NhbGx5XG4gICAgICogb3ZlcndyaXRlIHZhbHVlcyB0aGF0IGFyZSBwZXJzaXN0ZWQgaW4gdGhlIHJlbW90ZSBkb2N1bWVudCBjYWNoZS4gQmFzZVxuICAgICAqIG11dGF0aW9ucyBhcmUgbmV2ZXIgc2VudCB0byB0aGUgYmFja2VuZC5cbiAgICAgKiBAcGFyYW0gbXV0YXRpb25zIC0gVGhlIHVzZXItcHJvdmlkZWQgbXV0YXRpb25zIGluIHRoaXMgbXV0YXRpb24gYmF0Y2guXG4gICAgICogVXNlci1wcm92aWRlZCBtdXRhdGlvbnMgYXJlIGFwcGxpZWQgYm90aCBsb2NhbGx5IGFuZCByZW1vdGVseSBvbiB0aGVcbiAgICAgKiBiYWNrZW5kLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4sIHIpIHtcbiAgICAgICAgdGhpcy5iYXRjaElkID0gZSwgdGhpcy5sb2NhbFdyaXRlVGltZSA9IHQsIHRoaXMuYmFzZU11dGF0aW9ucyA9IG4sIHRoaXMubXV0YXRpb25zID0gcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXBwbGllcyBhbGwgdGhlIG11dGF0aW9ucyBpbiB0aGlzIE11dGF0aW9uQmF0Y2ggdG8gdGhlIHNwZWNpZmllZCBkb2N1bWVudFxuICAgICAqIHRvIGNvbXB1dGUgdGhlIHN0YXRlIG9mIHRoZSByZW1vdGUgZG9jdW1lbnRcbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudCAtIFRoZSBkb2N1bWVudCB0byBhcHBseSBtdXRhdGlvbnMgdG8uXG4gICAgICogQHBhcmFtIGJhdGNoUmVzdWx0IC0gVGhlIHJlc3VsdCBvZiBhcHBseWluZyB0aGUgTXV0YXRpb25CYXRjaCB0byB0aGVcbiAgICAgKiBiYWNrZW5kLlxuICAgICAqLyAgICBhcHBseVRvUmVtb3RlRG9jdW1lbnQoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gdC5tdXRhdGlvblJlc3VsdHM7XG4gICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgdGhpcy5tdXRhdGlvbnMubGVuZ3RoOyB0KyspIHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLm11dGF0aW9uc1t0XTtcbiAgICAgICAgICAgIGlmIChyLmtleS5pc0VxdWFsKGUua2V5KSkge1xuICAgICAgICAgICAgICAgIF9fUFJJVkFURV9tdXRhdGlvbkFwcGx5VG9SZW1vdGVEb2N1bWVudChyLCBlLCBuW3RdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb21wdXRlcyB0aGUgbG9jYWwgdmlldyBvZiBhIGRvY3VtZW50IGdpdmVuIGFsbCB0aGUgbXV0YXRpb25zIGluIHRoaXNcbiAgICAgKiBiYXRjaC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudCAtIFRoZSBkb2N1bWVudCB0byBhcHBseSBtdXRhdGlvbnMgdG8uXG4gICAgICogQHBhcmFtIG11dGF0ZWRGaWVsZHMgLSBGaWVsZHMgdGhhdCBoYXZlIGJlZW4gdXBkYXRlZCBiZWZvcmUgYXBwbHlpbmcgdGhpcyBtdXRhdGlvbiBiYXRjaC5cbiAgICAgKiBAcmV0dXJucyBBIGBGaWVsZE1hc2tgIHJlcHJlc2VudGluZyBhbGwgdGhlIGZpZWxkcyB0aGF0IGFyZSBtdXRhdGVkLlxuICAgICAqLyAgICBhcHBseVRvTG9jYWxWaWV3KGUsIHQpIHtcbiAgICAgICAgLy8gRmlyc3QsIGFwcGx5IHRoZSBiYXNlIHN0YXRlLiBUaGlzIGFsbG93cyB1cyB0byBhcHBseSBub24taWRlbXBvdGVudFxuICAgICAgICAvLyB0cmFuc2Zvcm0gYWdhaW5zdCBhIGNvbnNpc3RlbnQgc2V0IG9mIHZhbHVlcy5cbiAgICAgICAgZm9yIChjb25zdCBuIG9mIHRoaXMuYmFzZU11dGF0aW9ucykgbi5rZXkuaXNFcXVhbChlLmtleSkgJiYgKHQgPSBfX1BSSVZBVEVfbXV0YXRpb25BcHBseVRvTG9jYWxWaWV3KG4sIGUsIHQsIHRoaXMubG9jYWxXcml0ZVRpbWUpKTtcbiAgICAgICAgLy8gU2Vjb25kLCBhcHBseSBhbGwgdXNlci1wcm92aWRlZCBtdXRhdGlvbnMuXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIHRoaXMubXV0YXRpb25zKSBuLmtleS5pc0VxdWFsKGUua2V5KSAmJiAodCA9IF9fUFJJVkFURV9tdXRhdGlvbkFwcGx5VG9Mb2NhbFZpZXcobiwgZSwgdCwgdGhpcy5sb2NhbFdyaXRlVGltZSkpO1xuICAgICAgICByZXR1cm4gdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29tcHV0ZXMgdGhlIGxvY2FsIHZpZXcgZm9yIGFsbCBwcm92aWRlZCBkb2N1bWVudHMgZ2l2ZW4gdGhlIG11dGF0aW9ucyBpblxuICAgICAqIHRoaXMgYmF0Y2guIFJldHVybnMgYSBgRG9jdW1lbnRLZXlgIHRvIGBNdXRhdGlvbmAgbWFwIHdoaWNoIGNhbiBiZSB1c2VkIHRvXG4gICAgICogcmVwbGFjZSBhbGwgdGhlIG11dGF0aW9uIGFwcGxpY2F0aW9ucy5cbiAgICAgKi8gICAgYXBwbHlUb0xvY2FsRG9jdW1lbnRTZXQoZSwgdCkge1xuICAgICAgICAvLyBUT0RPKG1yc2NobWlkdCk6IFRoaXMgaW1wbGVtZW50YXRpb24gaXMgTyhuXjIpLiBJZiB3ZSBhcHBseSB0aGUgbXV0YXRpb25zXG4gICAgICAgIC8vIGRpcmVjdGx5IChhcyBkb25lIGluIGBhcHBseVRvTG9jYWxWaWV3KClgKSwgd2UgY2FuIHJlZHVjZSB0aGUgY29tcGxleGl0eVxuICAgICAgICAvLyB0byBPKG4pLlxuICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX25ld011dGF0aW9uTWFwKCk7XG4gICAgICAgIHJldHVybiB0aGlzLm11dGF0aW9ucy5mb3JFYWNoKChyID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBlLmdldChyLmtleSksIHMgPSBpLm92ZXJsYXllZERvY3VtZW50O1xuICAgICAgICAgICAgLy8gVE9ETyhtdXRhYmxlZG9jdW1lbnRzKTogVGhpcyBtZXRob2Qgc2hvdWxkIHRha2UgYSBNdXRhYmxlRG9jdW1lbnRNYXBcbiAgICAgICAgICAgIC8vIGFuZCB3ZSBzaG91bGQgcmVtb3ZlIHRoaXMgY2FzdC5cbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBvID0gdGhpcy5hcHBseVRvTG9jYWxWaWV3KHMsIGkubXV0YXRlZEZpZWxkcyk7XG4gICAgICAgICAgICAvLyBTZXQgbXV0YXRlZEZpZWxkcyB0byBudWxsIGlmIHRoZSBkb2N1bWVudCBpcyBvbmx5IGZyb20gbG9jYWwgbXV0YXRpb25zLlxuICAgICAgICAgICAgLy8gVGhpcyBjcmVhdGVzIGEgU2V0IG9yIERlbGV0ZSBtdXRhdGlvbiwgaW5zdGVhZCBvZiB0cnlpbmcgdG8gY3JlYXRlIGFcbiAgICAgICAgICAgIC8vIHBhdGNoIG11dGF0aW9uIGFzIHRoZSBvdmVybGF5LlxuICAgICAgICAgICAgICAgICAgICAgICAgbyA9IHQuaGFzKHIua2V5KSA/IG51bGwgOiBvO1xuICAgICAgICAgICAgY29uc3QgXyA9IF9fUFJJVkFURV9jYWxjdWxhdGVPdmVybGF5TXV0YXRpb24ocywgbyk7XG4gICAgICAgICAgICBudWxsICE9PSBfICYmIG4uc2V0KHIua2V5LCBfKSwgcy5pc1ZhbGlkRG9jdW1lbnQoKSB8fCBzLmNvbnZlcnRUb05vRG9jdW1lbnQoU25hcHNob3RWZXJzaW9uLm1pbigpKTtcbiAgICAgICAgfSkpLCBuO1xuICAgIH1cbiAgICBrZXlzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tdXRhdGlvbnMucmVkdWNlKCgoZSwgdCkgPT4gZS5hZGQodC5rZXkpKSwgX19QUklWQVRFX2RvY3VtZW50S2V5U2V0KCkpO1xuICAgIH1cbiAgICBpc0VxdWFsKGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmF0Y2hJZCA9PT0gZS5iYXRjaElkICYmIF9fUFJJVkFURV9hcnJheUVxdWFscyh0aGlzLm11dGF0aW9ucywgZS5tdXRhdGlvbnMsICgoZSwgdCkgPT4gX19QUklWQVRFX211dGF0aW9uRXF1YWxzKGUsIHQpKSkgJiYgX19QUklWQVRFX2FycmF5RXF1YWxzKHRoaXMuYmFzZU11dGF0aW9ucywgZS5iYXNlTXV0YXRpb25zLCAoKGUsIHQpID0+IF9fUFJJVkFURV9tdXRhdGlvbkVxdWFscyhlLCB0KSkpO1xuICAgIH1cbn1cblxuLyoqIFRoZSByZXN1bHQgb2YgYXBwbHlpbmcgYSBtdXRhdGlvbiBiYXRjaCB0byB0aGUgYmFja2VuZC4gKi8gY2xhc3MgTXV0YXRpb25CYXRjaFJlc3VsdCB7XG4gICAgY29uc3RydWN0b3IoZSwgdCwgbiwgXG4gICAgLyoqXG4gICAgICogQSBwcmUtY29tcHV0ZWQgbWFwcGluZyBmcm9tIGVhY2ggbXV0YXRlZCBkb2N1bWVudCB0byB0aGUgcmVzdWx0aW5nXG4gICAgICogdmVyc2lvbi5cbiAgICAgKi9cbiAgICByKSB7XG4gICAgICAgIHRoaXMuYmF0Y2ggPSBlLCB0aGlzLmNvbW1pdFZlcnNpb24gPSB0LCB0aGlzLm11dGF0aW9uUmVzdWx0cyA9IG4sIHRoaXMuZG9jVmVyc2lvbnMgPSByO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IE11dGF0aW9uQmF0Y2hSZXN1bHQgZm9yIHRoZSBnaXZlbiBiYXRjaCBhbmQgcmVzdWx0cy4gVGhlcmVcbiAgICAgKiBtdXN0IGJlIG9uZSByZXN1bHQgZm9yIGVhY2ggbXV0YXRpb24gaW4gdGhlIGJhdGNoLiBUaGlzIHN0YXRpYyBmYWN0b3J5XG4gICAgICogY2FjaGVzIGEgZG9jdW1lbnQ9Jmd0O3ZlcnNpb24gbWFwcGluZyAoZG9jVmVyc2lvbnMpLlxuICAgICAqLyAgICBzdGF0aWMgZnJvbShlLCB0LCBuKSB7XG4gICAgICAgIF9fUFJJVkFURV9oYXJkQXNzZXJ0KGUubXV0YXRpb25zLmxlbmd0aCA9PT0gbi5sZW5ndGgsIDU4ODQyLCB7XG4gICAgICAgICAgICBtZTogZS5tdXRhdGlvbnMubGVuZ3RoLFxuICAgICAgICAgICAgZmU6IG4ubGVuZ3RoXG4gICAgICAgIH0pO1xuICAgICAgICBsZXQgciA9IGZ1bmN0aW9uIF9fUFJJVkFURV9kb2N1bWVudFZlcnNpb25NYXAoKSB7XG4gICAgICAgICAgICByZXR1cm4gbXQ7XG4gICAgICAgIH0oKTtcbiAgICAgICAgY29uc3QgaSA9IGUubXV0YXRpb25zO1xuICAgICAgICBmb3IgKGxldCBlID0gMDsgZSA8IGkubGVuZ3RoOyBlKyspIHIgPSByLmluc2VydChpW2VdLmtleSwgbltlXS52ZXJzaW9uKTtcbiAgICAgICAgcmV0dXJuIG5ldyBNdXRhdGlvbkJhdGNoUmVzdWx0KGUsIHQsIG4sIHIpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmVwcmVzZW50YXRpb24gb2YgYW4gb3ZlcmxheSBjb21wdXRlZCBieSBGaXJlc3RvcmUuXG4gKlxuICogSG9sZHMgaW5mb3JtYXRpb24gYWJvdXQgYSBtdXRhdGlvbiBhbmQgdGhlIGxhcmdlc3QgYmF0Y2ggaWQgaW4gRmlyZXN0b3JlIHdoZW5cbiAqIHRoZSBtdXRhdGlvbiB3YXMgY3JlYXRlZC5cbiAqLyBjbGFzcyBPdmVybGF5IHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0KSB7XG4gICAgICAgIHRoaXMubGFyZ2VzdEJhdGNoSWQgPSBlLCB0aGlzLm11dGF0aW9uID0gdDtcbiAgICB9XG4gICAgZ2V0S2V5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tdXRhdGlvbi5rZXk7XG4gICAgfVxuICAgIGlzRXF1YWwoZSkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gZSAmJiB0aGlzLm11dGF0aW9uID09PSBlLm11dGF0aW9uO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIGBPdmVybGF5e1xcbiAgICAgIGxhcmdlc3RCYXRjaElkOiAke3RoaXMubGFyZ2VzdEJhdGNoSWR9LFxcbiAgICAgIG11dGF0aW9uOiAke3RoaXMubXV0YXRpb24udG9TdHJpbmcoKX1cXG4gICAgfWA7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBDb25jcmV0ZSBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgQWdncmVnYXRlIHR5cGUuXG4gKi8gY2xhc3MgX19QUklWQVRFX0FnZ3JlZ2F0ZUltcGwge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4pIHtcbiAgICAgICAgdGhpcy5hbGlhcyA9IGUsIHRoaXMuYWdncmVnYXRlVHlwZSA9IHQsIHRoaXMuZmllbGRQYXRoID0gbjtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIEV4aXN0ZW5jZUZpbHRlciB7XG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICB0aGlzLmNvdW50ID0gZSwgdGhpcy51bmNoYW5nZWROYW1lcyA9IHQ7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBFcnJvciBDb2RlcyBkZXNjcmliaW5nIHRoZSBkaWZmZXJlbnQgd2F5cyBHUlBDIGNhbiBmYWlsLiBUaGVzZSBhcmUgY29waWVkXG4gKiBkaXJlY3RseSBmcm9tIEdSUEMncyBzb3VyY2VzIGhlcmU6XG4gKlxuICogaHR0cHM6Ly9naXRodWIuY29tL2dycGMvZ3JwYy9ibG9iL2JjZWVjOTRlYTRmYzVmMDA4NWQ4MTIzNWQ4ZTFjMDY3OThkYzM0MWEvaW5jbHVkZS9ncnBjJTJCJTJCL2ltcGwvY29kZWdlbi9zdGF0dXNfY29kZV9lbnVtLmhcbiAqXG4gKiBJbXBvcnRhbnQhIFRoZSBuYW1lcyBvZiB0aGVzZSBpZGVudGlmaWVycyBtYXR0ZXIgYmVjYXVzZSB0aGUgc3RyaW5nIGZvcm1zXG4gKiBhcmUgdXNlZCBmb3IgcmV2ZXJzZSBsb29rdXBzIGZyb20gdGhlIHdlYmNoYW5uZWwgc3RyZWFtLiBEbyBOT1QgY2hhbmdlIHRoZVxuICogbmFtZXMgb2YgdGhlc2UgaWRlbnRpZmllcnMgb3IgY2hhbmdlIHRoaXMgaW50byBhIGNvbnN0IGVudW0uXG4gKi8gdmFyIHB0LCB5dDtcblxuLyoqXG4gKiBEZXRlcm1pbmVzIHdoZXRoZXIgYW4gZXJyb3IgY29kZSByZXByZXNlbnRzIGEgcGVybWFuZW50IGVycm9yIHdoZW4gcmVjZWl2ZWRcbiAqIGluIHJlc3BvbnNlIHRvIGEgbm9uLXdyaXRlIG9wZXJhdGlvbi5cbiAqXG4gKiBTZWUgaXNQZXJtYW5lbnRXcml0ZUVycm9yIGZvciBjbGFzc2lmeWluZyB3cml0ZSBlcnJvcnMuXG4gKi9cbmZ1bmN0aW9uIF9fUFJJVkFURV9pc1Blcm1hbmVudEVycm9yKGUpIHtcbiAgICBzd2l0Y2ggKGUpIHtcbiAgICAgIGNhc2UgTi5PSzpcbiAgICAgICAgcmV0dXJuIGZhaWwoNjQ5MzgpO1xuXG4gICAgICBjYXNlIE4uQ0FOQ0VMTEVEOlxuICAgICAgY2FzZSBOLlVOS05PV046XG4gICAgICBjYXNlIE4uREVBRExJTkVfRVhDRUVERUQ6XG4gICAgICBjYXNlIE4uUkVTT1VSQ0VfRVhIQVVTVEVEOlxuICAgICAgY2FzZSBOLklOVEVSTkFMOlxuICAgICAgY2FzZSBOLlVOQVZBSUxBQkxFOlxuIC8vIFVuYXV0aGVudGljYXRlZCBtZWFucyBzb21ldGhpbmcgd2VudCB3cm9uZyB3aXRoIG91ciB0b2tlbiBhbmQgd2UgbmVlZFxuICAgICAgICAvLyB0byByZXRyeSB3aXRoIG5ldyBjcmVkZW50aWFscyB3aGljaCB3aWxsIGhhcHBlbiBhdXRvbWF0aWNhbGx5LlxuICAgICAgICAgICAgICBjYXNlIE4uVU5BVVRIRU5USUNBVEVEOlxuICAgICAgICByZXR1cm4gITE7XG5cbiAgICAgIGNhc2UgTi5JTlZBTElEX0FSR1VNRU5UOlxuICAgICAgY2FzZSBOLk5PVF9GT1VORDpcbiAgICAgIGNhc2UgTi5BTFJFQURZX0VYSVNUUzpcbiAgICAgIGNhc2UgTi5QRVJNSVNTSU9OX0RFTklFRDpcbiAgICAgIGNhc2UgTi5GQUlMRURfUFJFQ09ORElUSU9OOlxuIC8vIEFib3J0ZWQgbWlnaHQgYmUgcmV0cmllZCBpbiBzb21lIHNjZW5hcmlvcywgYnV0IHRoYXQgaXMgZGVwZW5kZW50IG9uXG4gICAgICAgIC8vIHRoZSBjb250ZXh0IGFuZCBzaG91bGQgaGFuZGxlZCBpbmRpdmlkdWFsbHkgYnkgdGhlIGNhbGxpbmcgY29kZS5cbiAgICAgICAgLy8gU2VlIGh0dHBzOi8vY2xvdWQuZ29vZ2xlLmNvbS9hcGlzL2Rlc2lnbi9lcnJvcnMuXG4gICAgICAgICAgICAgIGNhc2UgTi5BQk9SVEVEOlxuICAgICAgY2FzZSBOLk9VVF9PRl9SQU5HRTpcbiAgICAgIGNhc2UgTi5VTklNUExFTUVOVEVEOlxuICAgICAgY2FzZSBOLkRBVEFfTE9TUzpcbiAgICAgICAgcmV0dXJuICEwO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gZmFpbCgxNTQ2Nywge1xuICAgICAgICAgICAgY29kZTogZVxuICAgICAgICB9KTtcbiAgICB9XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lcyB3aGV0aGVyIGFuIGVycm9yIGNvZGUgcmVwcmVzZW50cyBhIHBlcm1hbmVudCBlcnJvciB3aGVuIHJlY2VpdmVkXG4gKiBpbiByZXNwb25zZSB0byBhIHdyaXRlIG9wZXJhdGlvbi5cbiAqXG4gKiBXcml0ZSBvcGVyYXRpb25zIG11c3QgYmUgaGFuZGxlZCBzcGVjaWFsbHkgYmVjYXVzZSBhcyBvZiBiLzExOTQzNzc2NCwgQUJPUlRFRFxuICogZXJyb3JzIG9uIHRoZSB3cml0ZSBzdHJlYW0gc2hvdWxkIGJlIHJldHJpZWQgdG9vIChldmVuIHRob3VnaCBBQk9SVEVEIGVycm9yc1xuICogYXJlIG5vdCBnZW5lcmFsbHkgcmV0cnlhYmxlKS5cbiAqXG4gKiBOb3RlIHRoYXQgZHVyaW5nIHRoZSBpbml0aWFsIGhhbmRzaGFrZSBvbiB0aGUgd3JpdGUgc3RyZWFtIGFuIEFCT1JURUQgZXJyb3JcbiAqIHNpZ25hbHMgdGhhdCB3ZSBzaG91bGQgZGlzY2FyZCBvdXIgc3RyZWFtIHRva2VuIChpLmUuIGl0IGlzIHBlcm1hbmVudCkuIFRoaXNcbiAqIG1lYW5zIGEgaGFuZHNoYWtlIGVycm9yIHNob3VsZCBiZSBjbGFzc2lmaWVkIHdpdGggaXNQZXJtYW5lbnRFcnJvciwgYWJvdmUuXG4gKi9cbi8qKlxuICogTWFwcyBhbiBlcnJvciBDb2RlIGZyb20gR1JQQyBzdGF0dXMgY29kZSBudW1iZXIsIGxpa2UgMCwgMSwgb3IgMTQuIFRoZXNlXG4gKiBhcmUgbm90IHRoZSBzYW1lIGFzIEhUVFAgc3RhdHVzIGNvZGVzLlxuICpcbiAqIEByZXR1cm5zIFRoZSBDb2RlIGVxdWl2YWxlbnQgdG8gdGhlIGdpdmVuIEdSUEMgc3RhdHVzIGNvZGUuIEZhaWxzIGlmIHRoZXJlXG4gKiAgICAgaXMgbm8gbWF0Y2guXG4gKi9cbmZ1bmN0aW9uIF9fUFJJVkFURV9tYXBDb2RlRnJvbVJwY0NvZGUoZSkge1xuICAgIGlmICh2b2lkIDAgPT09IGUpIFxuICAgIC8vIFRoaXMgc2hvdWxkbid0IG5vcm1hbGx5IGhhcHBlbiwgYnV0IGluIGNlcnRhaW4gZXJyb3IgY2FzZXMgKGxpa2UgdHJ5aW5nXG4gICAgLy8gdG8gc2VuZCBpbnZhbGlkIHByb3RvIG1lc3NhZ2VzKSB3ZSBtYXkgZ2V0IGFuIGVycm9yIHdpdGggbm8gR1JQQyBjb2RlLlxuICAgIHJldHVybiBfX1BSSVZBVEVfbG9nRXJyb3IoXCJHUlBDIGVycm9yIGhhcyBubyAuY29kZVwiKSwgTi5VTktOT1dOO1xuICAgIHN3aXRjaCAoZSkge1xuICAgICAgY2FzZSBwdC5PSzpcbiAgICAgICAgcmV0dXJuIE4uT0s7XG5cbiAgICAgIGNhc2UgcHQuQ0FOQ0VMTEVEOlxuICAgICAgICByZXR1cm4gTi5DQU5DRUxMRUQ7XG5cbiAgICAgIGNhc2UgcHQuVU5LTk9XTjpcbiAgICAgICAgcmV0dXJuIE4uVU5LTk9XTjtcblxuICAgICAgY2FzZSBwdC5ERUFETElORV9FWENFRURFRDpcbiAgICAgICAgcmV0dXJuIE4uREVBRExJTkVfRVhDRUVERUQ7XG5cbiAgICAgIGNhc2UgcHQuUkVTT1VSQ0VfRVhIQVVTVEVEOlxuICAgICAgICByZXR1cm4gTi5SRVNPVVJDRV9FWEhBVVNURUQ7XG5cbiAgICAgIGNhc2UgcHQuSU5URVJOQUw6XG4gICAgICAgIHJldHVybiBOLklOVEVSTkFMO1xuXG4gICAgICBjYXNlIHB0LlVOQVZBSUxBQkxFOlxuICAgICAgICByZXR1cm4gTi5VTkFWQUlMQUJMRTtcblxuICAgICAgY2FzZSBwdC5VTkFVVEhFTlRJQ0FURUQ6XG4gICAgICAgIHJldHVybiBOLlVOQVVUSEVOVElDQVRFRDtcblxuICAgICAgY2FzZSBwdC5JTlZBTElEX0FSR1VNRU5UOlxuICAgICAgICByZXR1cm4gTi5JTlZBTElEX0FSR1VNRU5UO1xuXG4gICAgICBjYXNlIHB0Lk5PVF9GT1VORDpcbiAgICAgICAgcmV0dXJuIE4uTk9UX0ZPVU5EO1xuXG4gICAgICBjYXNlIHB0LkFMUkVBRFlfRVhJU1RTOlxuICAgICAgICByZXR1cm4gTi5BTFJFQURZX0VYSVNUUztcblxuICAgICAgY2FzZSBwdC5QRVJNSVNTSU9OX0RFTklFRDpcbiAgICAgICAgcmV0dXJuIE4uUEVSTUlTU0lPTl9ERU5JRUQ7XG5cbiAgICAgIGNhc2UgcHQuRkFJTEVEX1BSRUNPTkRJVElPTjpcbiAgICAgICAgcmV0dXJuIE4uRkFJTEVEX1BSRUNPTkRJVElPTjtcblxuICAgICAgY2FzZSBwdC5BQk9SVEVEOlxuICAgICAgICByZXR1cm4gTi5BQk9SVEVEO1xuXG4gICAgICBjYXNlIHB0Lk9VVF9PRl9SQU5HRTpcbiAgICAgICAgcmV0dXJuIE4uT1VUX09GX1JBTkdFO1xuXG4gICAgICBjYXNlIHB0LlVOSU1QTEVNRU5URUQ6XG4gICAgICAgIHJldHVybiBOLlVOSU1QTEVNRU5URUQ7XG5cbiAgICAgIGNhc2UgcHQuREFUQV9MT1NTOlxuICAgICAgICByZXR1cm4gTi5EQVRBX0xPU1M7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBmYWlsKDM5MzIzLCB7XG4gICAgICAgICAgICBjb2RlOiBlXG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhbiBIVFRQIHJlc3BvbnNlJ3MgZXJyb3Igc3RhdHVzIHRvIHRoZSBlcXVpdmFsZW50IGVycm9yIGNvZGUuXG4gKlxuICogQHBhcmFtIHN0YXR1cyAtIEFuIEhUVFAgZXJyb3IgcmVzcG9uc2Ugc3RhdHVzIChcIkZBSUxFRF9QUkVDT05ESVRJT05cIixcbiAqIFwiVU5LTk9XTlwiLCBldGMuKVxuICogQHJldHVybnMgVGhlIGVxdWl2YWxlbnQgQ29kZS4gTm9uLW1hdGNoaW5nIHJlc3BvbnNlcyBhcmUgbWFwcGVkIHRvXG4gKiAgICAgQ29kZS5VTktOT1dOLlxuICovICh5dCA9IHB0IHx8IChwdCA9IHt9KSlbeXQuT0sgPSAwXSA9IFwiT0tcIiwgeXRbeXQuQ0FOQ0VMTEVEID0gMV0gPSBcIkNBTkNFTExFRFwiLCBcbnl0W3l0LlVOS05PV04gPSAyXSA9IFwiVU5LTk9XTlwiLCB5dFt5dC5JTlZBTElEX0FSR1VNRU5UID0gM10gPSBcIklOVkFMSURfQVJHVU1FTlRcIiwgXG55dFt5dC5ERUFETElORV9FWENFRURFRCA9IDRdID0gXCJERUFETElORV9FWENFRURFRFwiLCB5dFt5dC5OT1RfRk9VTkQgPSA1XSA9IFwiTk9UX0ZPVU5EXCIsIFxueXRbeXQuQUxSRUFEWV9FWElTVFMgPSA2XSA9IFwiQUxSRUFEWV9FWElTVFNcIiwgeXRbeXQuUEVSTUlTU0lPTl9ERU5JRUQgPSA3XSA9IFwiUEVSTUlTU0lPTl9ERU5JRURcIiwgXG55dFt5dC5VTkFVVEhFTlRJQ0FURUQgPSAxNl0gPSBcIlVOQVVUSEVOVElDQVRFRFwiLCB5dFt5dC5SRVNPVVJDRV9FWEhBVVNURUQgPSA4XSA9IFwiUkVTT1VSQ0VfRVhIQVVTVEVEXCIsIFxueXRbeXQuRkFJTEVEX1BSRUNPTkRJVElPTiA9IDldID0gXCJGQUlMRURfUFJFQ09ORElUSU9OXCIsIHl0W3l0LkFCT1JURUQgPSAxMF0gPSBcIkFCT1JURURcIiwgXG55dFt5dC5PVVRfT0ZfUkFOR0UgPSAxMV0gPSBcIk9VVF9PRl9SQU5HRVwiLCB5dFt5dC5VTklNUExFTUVOVEVEID0gMTJdID0gXCJVTklNUExFTUVOVEVEXCIsIFxueXRbeXQuSU5URVJOQUwgPSAxM10gPSBcIklOVEVSTkFMXCIsIHl0W3l0LlVOQVZBSUxBQkxFID0gMTRdID0gXCJVTkFWQUlMQUJMRVwiLCB5dFt5dC5EQVRBX0xPU1MgPSAxNV0gPSBcIkRBVEFfTE9TU1wiO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBUaGUgZ2xvYmFsLCBzaW5nbGV0b24gaW5zdGFuY2Ugb2YgVGVzdGluZ0hvb2tzU3BpLlxuICpcbiAqIFRoaXMgdmFyaWFibGUgd2lsbCBiZSBgbnVsbGAgaW4gYWxsIGNhc2VzIF9leGNlcHRfIHdoZW4gcnVubmluZyBmcm9tXG4gKiBpbnRlZ3JhdGlvbiB0ZXN0cyB0aGF0IGhhdmUgcmVnaXN0ZXJlZCBjYWxsYmFja3MgdG8gYmUgbm90aWZpZWQgb2YgZXZlbnRzXG4gKiB0aGF0IGhhcHBlbiBkdXJpbmcgdGhlIHRlc3QgZXhlY3V0aW9uLlxuICovXG5sZXQgd3QgPSBudWxsO1xuXG4vKipcbiAqIFNldHMgdGhlIHZhbHVlIG9mIHRoZSBgdGVzdGluZ0hvb2tzU3BpYCBvYmplY3QuXG4gKiBAcGFyYW0gaW5zdGFuY2UgdGhlIGluc3RhbmNlIHRvIHNldC5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gaW5zdGFuY2Ugb2YgdGhlIFBsYXRmb3JtJ3MgJ1RleHRFbmNvZGVyJyBpbXBsZW1lbnRhdGlvbi5cbiAqL1xuZnVuY3Rpb24gX19QUklWQVRFX25ld1RleHRFbmNvZGVyKCkge1xuICAgIHJldHVybiBuZXcgVGV4dEVuY29kZXI7XG59XG5cbi8qKlxuICogQW4gaW5zdGFuY2Ugb2YgdGhlIFBsYXRmb3JtJ3MgJ1RleHREZWNvZGVyJyBpbXBsZW1lbnRhdGlvbi5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IFN0ID0gbmV3IEludGVnZXIoWyA0Mjk0OTY3Mjk1LCA0Mjk0OTY3Mjk1IF0sIDApO1xuXG4vLyBIYXNoIGEgc3RyaW5nIHVzaW5nIG1kNSBoYXNoaW5nIGFsZ29yaXRobS5cbmZ1bmN0aW9uIF9fUFJJVkFURV9nZXRNZDVIYXNoVmFsdWUoZSkge1xuICAgIGNvbnN0IHQgPSBfX1BSSVZBVEVfbmV3VGV4dEVuY29kZXIoKS5lbmNvZGUoZSksIG4gPSBuZXcgTWQ1O1xuICAgIHJldHVybiBuLnVwZGF0ZSh0KSwgbmV3IFVpbnQ4QXJyYXkobi5kaWdlc3QoKSk7XG59XG5cbi8vIEludGVycHJldCB0aGUgMTYgYnl0ZXMgYXJyYXkgYXMgdHdvIDY0LWJpdCB1bnNpZ25lZCBpbnRlZ2VycywgZW5jb2RlZCB1c2luZ1xuLy8gMuKAmXMgY29tcGxlbWVudCB1c2luZyBsaXR0bGUgZW5kaWFuLlxuZnVuY3Rpb24gX19QUklWQVRFX2dldDY0Qml0VWludHMoZSkge1xuICAgIGNvbnN0IHQgPSBuZXcgRGF0YVZpZXcoZS5idWZmZXIpLCBuID0gdC5nZXRVaW50MzIoMCwgLyogbGl0dGxlRW5kaWFuPSAqLyAhMCksIHIgPSB0LmdldFVpbnQzMig0LCAvKiBsaXR0bGVFbmRpYW49ICovICEwKSwgaSA9IHQuZ2V0VWludDMyKDgsIC8qIGxpdHRsZUVuZGlhbj0gKi8gITApLCBzID0gdC5nZXRVaW50MzIoMTIsIC8qIGxpdHRsZUVuZGlhbj0gKi8gITApO1xuICAgIHJldHVybiBbIG5ldyBJbnRlZ2VyKFsgbiwgciBdLCAwKSwgbmV3IEludGVnZXIoWyBpLCBzIF0sIDApIF07XG59XG5cbmNsYXNzIEJsb29tRmlsdGVyIHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0LCBuKSB7XG4gICAgICAgIGlmICh0aGlzLmJpdG1hcCA9IGUsIHRoaXMucGFkZGluZyA9IHQsIHRoaXMuaGFzaENvdW50ID0gbiwgdCA8IDAgfHwgdCA+PSA4KSB0aHJvdyBuZXcgX19QUklWQVRFX0Jsb29tRmlsdGVyRXJyb3IoYEludmFsaWQgcGFkZGluZzogJHt0fWApO1xuICAgICAgICBpZiAobiA8IDApIHRocm93IG5ldyBfX1BSSVZBVEVfQmxvb21GaWx0ZXJFcnJvcihgSW52YWxpZCBoYXNoIGNvdW50OiAke259YCk7XG4gICAgICAgIGlmIChlLmxlbmd0aCA+IDAgJiYgMCA9PT0gdGhpcy5oYXNoQ291bnQpIFxuICAgICAgICAvLyBPbmx5IGVtcHR5IGJsb29tIGZpbHRlciBjYW4gaGF2ZSAwIGhhc2ggY291bnQuXG4gICAgICAgIHRocm93IG5ldyBfX1BSSVZBVEVfQmxvb21GaWx0ZXJFcnJvcihgSW52YWxpZCBoYXNoIGNvdW50OiAke259YCk7XG4gICAgICAgIGlmICgwID09PSBlLmxlbmd0aCAmJiAwICE9PSB0KSBcbiAgICAgICAgLy8gRW1wdHkgYmxvb20gZmlsdGVyIHNob3VsZCBoYXZlIDAgcGFkZGluZy5cbiAgICAgICAgdGhyb3cgbmV3IF9fUFJJVkFURV9CbG9vbUZpbHRlckVycm9yKGBJbnZhbGlkIHBhZGRpbmcgd2hlbiBiaXRtYXAgbGVuZ3RoIGlzIDA6ICR7dH1gKTtcbiAgICAgICAgdGhpcy5nZSA9IDggKiBlLmxlbmd0aCAtIHQsIFxuICAgICAgICAvLyBTZXQgdGhlIGJpdCBjb3VudCBpbiBJbnRlZ2VyIHRvIGF2b2lkIHJlcGV0aXRpb24gaW4gbWlnaHRDb250YWluKCkuXG4gICAgICAgIHRoaXMucGUgPSBJbnRlZ2VyLmZyb21OdW1iZXIodGhpcy5nZSk7XG4gICAgfVxuICAgIC8vIENhbGN1bGF0ZSB0aGUgaXRoIGhhc2ggdmFsdWUgYmFzZWQgb24gdGhlIGhhc2hlZCA2NGJpdCBpbnRlZ2VycyxcbiAgICAvLyBhbmQgY2FsY3VsYXRlIGl0cyBjb3JyZXNwb25kaW5nIGJpdCBpbmRleCBpbiB0aGUgYml0bWFwIHRvIGJlIGNoZWNrZWQuXG4gICAgeWUoZSwgdCwgbikge1xuICAgICAgICAvLyBDYWxjdWxhdGUgaGFzaGVkIHZhbHVlIGgoaSkgPSBoMSArIChpICogaDIpLlxuICAgICAgICBsZXQgciA9IGUuYWRkKHQubXVsdGlwbHkoSW50ZWdlci5mcm9tTnVtYmVyKG4pKSk7XG4gICAgICAgIC8vIFdyYXAgaWYgaGFzaCB2YWx1ZSBvdmVyZmxvdyA2NGJpdC5cbiAgICAgICAgICAgICAgICByZXR1cm4gMSA9PT0gci5jb21wYXJlKFN0KSAmJiAociA9IG5ldyBJbnRlZ2VyKFsgci5nZXRCaXRzKDApLCByLmdldEJpdHMoMSkgXSwgMCkpLCBcbiAgICAgICAgci5tb2R1bG8odGhpcy5wZSkudG9OdW1iZXIoKTtcbiAgICB9XG4gICAgLy8gUmV0dXJuIHdoZXRoZXIgdGhlIGJpdCBvbiB0aGUgZ2l2ZW4gaW5kZXggaW4gdGhlIGJpdG1hcCBpcyBzZXQgdG8gMS5cbiAgICB3ZShlKSB7XG4gICAgICAgIHJldHVybiAhISh0aGlzLmJpdG1hcFtNYXRoLmZsb29yKGUgLyA4KV0gJiAxIDw8IGUgJSA4KTtcbiAgICB9XG4gICAgbWlnaHRDb250YWluKGUpIHtcbiAgICAgICAgLy8gRW1wdHkgYml0bWFwIHNob3VsZCBhbHdheXMgcmV0dXJuIGZhbHNlIG9uIG1lbWJlcnNoaXAgY2hlY2suXG4gICAgICAgIGlmICgwID09PSB0aGlzLmdlKSByZXR1cm4gITE7XG4gICAgICAgIGNvbnN0IHQgPSBfX1BSSVZBVEVfZ2V0TWQ1SGFzaFZhbHVlKGUpLCBbbiwgcl0gPSBfX1BSSVZBVEVfZ2V0NjRCaXRVaW50cyh0KTtcbiAgICAgICAgZm9yIChsZXQgZSA9IDA7IGUgPCB0aGlzLmhhc2hDb3VudDsgZSsrKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gdGhpcy55ZShuLCByLCBlKTtcbiAgICAgICAgICAgIGlmICghdGhpcy53ZSh0KSkgcmV0dXJuICExO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgLyoqIENyZWF0ZSBibG9vbSBmaWx0ZXIgZm9yIHRlc3RpbmcgcHVycG9zZXMgb25seS4gKi8gICAgc3RhdGljIGNyZWF0ZShlLCB0LCBuKSB7XG4gICAgICAgIGNvbnN0IHIgPSBlICUgOCA9PSAwID8gMCA6IDggLSBlICUgOCwgaSA9IG5ldyBVaW50OEFycmF5KE1hdGguY2VpbChlIC8gOCkpLCBzID0gbmV3IEJsb29tRmlsdGVyKGksIHIsIHQpO1xuICAgICAgICByZXR1cm4gbi5mb3JFYWNoKChlID0+IHMuaW5zZXJ0KGUpKSksIHM7XG4gICAgfVxuICAgIGluc2VydChlKSB7XG4gICAgICAgIGlmICgwID09PSB0aGlzLmdlKSByZXR1cm47XG4gICAgICAgIGNvbnN0IHQgPSBfX1BSSVZBVEVfZ2V0TWQ1SGFzaFZhbHVlKGUpLCBbbiwgcl0gPSBfX1BSSVZBVEVfZ2V0NjRCaXRVaW50cyh0KTtcbiAgICAgICAgZm9yIChsZXQgZSA9IDA7IGUgPCB0aGlzLmhhc2hDb3VudDsgZSsrKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gdGhpcy55ZShuLCByLCBlKTtcbiAgICAgICAgICAgIHRoaXMuU2UodCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgU2UoZSkge1xuICAgICAgICBjb25zdCB0ID0gTWF0aC5mbG9vcihlIC8gOCksIG4gPSBlICUgODtcbiAgICAgICAgdGhpcy5iaXRtYXBbdF0gfD0gMSA8PCBuO1xuICAgIH1cbn1cblxuY2xhc3MgX19QUklWQVRFX0Jsb29tRmlsdGVyRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKC4uLmFyZ3VtZW50cyksIHRoaXMubmFtZSA9IFwiQmxvb21GaWx0ZXJFcnJvclwiO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gZXZlbnQgZnJvbSB0aGUgUmVtb3RlU3RvcmUuIEl0IGlzIHNwbGl0IGludG8gdGFyZ2V0Q2hhbmdlcyAoY2hhbmdlcyB0byB0aGVcbiAqIHN0YXRlIG9yIHRoZSBzZXQgb2YgZG9jdW1lbnRzIGluIG91ciB3YXRjaGVkIHRhcmdldHMpIGFuZCBkb2N1bWVudFVwZGF0ZXNcbiAqIChjaGFuZ2VzIHRvIHRoZSBhY3R1YWwgZG9jdW1lbnRzKS5cbiAqLyBjbGFzcyBSZW1vdGVFdmVudCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIHNuYXBzaG90IHZlcnNpb24gdGhpcyBldmVudCBicmluZ3MgdXMgdXAgdG8sIG9yIE1JTiBpZiBub3Qgc2V0LlxuICAgICAqL1xuICAgIGUsIFxuICAgIC8qKlxuICAgICAqIEEgbWFwIGZyb20gdGFyZ2V0IHRvIGNoYW5nZXMgdG8gdGhlIHRhcmdldC4gU2VlIFRhcmdldENoYW5nZS5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBBIG1hcCBvZiB0YXJnZXRzIHRoYXQgaXMga25vd24gdG8gYmUgaW5jb25zaXN0ZW50LCBhbmQgdGhlIHB1cnBvc2UgZm9yXG4gICAgICogcmUtbGlzdGVuaW5nLiBMaXN0ZW5zIGZvciB0aGVzZSB0YXJnZXRzIHNob3VsZCBiZSByZS1lc3RhYmxpc2hlZCB3aXRob3V0XG4gICAgICogcmVzdW1lIHRva2Vucy5cbiAgICAgKi9cbiAgICBuLCBcbiAgICAvKipcbiAgICAgKiBBIHNldCBvZiB3aGljaCBkb2N1bWVudHMgaGF2ZSBjaGFuZ2VkIG9yIGJlZW4gZGVsZXRlZCwgYWxvbmcgd2l0aCB0aGVcbiAgICAgKiBkb2MncyBuZXcgdmFsdWVzIChpZiBub3QgZGVsZXRlZCkuXG4gICAgICovXG4gICAgciwgXG4gICAgLyoqXG4gICAgICogQSBzZXQgb2Ygd2hpY2ggZG9jdW1lbnQgdXBkYXRlcyBhcmUgZHVlIG9ubHkgdG8gbGltYm8gcmVzb2x1dGlvbiB0YXJnZXRzLlxuICAgICAqL1xuICAgIGkpIHtcbiAgICAgICAgdGhpcy5zbmFwc2hvdFZlcnNpb24gPSBlLCB0aGlzLnRhcmdldENoYW5nZXMgPSB0LCB0aGlzLnRhcmdldE1pc21hdGNoZXMgPSBuLCB0aGlzLmRvY3VtZW50VXBkYXRlcyA9IHIsIFxuICAgICAgICB0aGlzLnJlc29sdmVkTGltYm9Eb2N1bWVudHMgPSBpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBIQUNLOiBWaWV3cyByZXF1aXJlIFJlbW90ZUV2ZW50cyBpbiBvcmRlciB0byBkZXRlcm1pbmUgd2hldGhlciB0aGUgdmlldyBpc1xuICAgICAqIENVUlJFTlQsIGJ1dCBzZWNvbmRhcnkgdGFicyBkb24ndCByZWNlaXZlIHJlbW90ZSBldmVudHMuIFNvIHRoaXMgbWV0aG9kIGlzXG4gICAgICogdXNlZCB0byBjcmVhdGUgYSBzeW50aGVzaXplZCBSZW1vdGVFdmVudCB0aGF0IGNhbiBiZSB1c2VkIHRvIGFwcGx5IGFcbiAgICAgKiBDVVJSRU5UIHN0YXR1cyBjaGFuZ2UgdG8gYSBWaWV3LCBmb3IgcXVlcmllcyBleGVjdXRlZCBpbiBhIGRpZmZlcmVudCB0YWIuXG4gICAgICovXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seVxuICAgIHN0YXRpYyBjcmVhdGVTeW50aGVzaXplZFJlbW90ZUV2ZW50Rm9yQ3VycmVudENoYW5nZShlLCB0LCBuKSB7XG4gICAgICAgIGNvbnN0IHIgPSBuZXcgTWFwO1xuICAgICAgICByZXR1cm4gci5zZXQoZSwgVGFyZ2V0Q2hhbmdlLmNyZWF0ZVN5bnRoZXNpemVkVGFyZ2V0Q2hhbmdlRm9yQ3VycmVudENoYW5nZShlLCB0LCBuKSksIFxuICAgICAgICBuZXcgUmVtb3RlRXZlbnQoU25hcHNob3RWZXJzaW9uLm1pbigpLCByLCBuZXcgU29ydGVkTWFwKF9fUFJJVkFURV9wcmltaXRpdmVDb21wYXJhdG9yKSwgX19QUklWQVRFX211dGFibGVEb2N1bWVudE1hcCgpLCBfX1BSSVZBVEVfZG9jdW1lbnRLZXlTZXQoKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgVGFyZ2V0Q2hhbmdlIHNwZWNpZmllcyB0aGUgc2V0IG9mIGNoYW5nZXMgZm9yIGEgc3BlY2lmaWMgdGFyZ2V0IGFzIHBhcnQgb2ZcbiAqIGEgUmVtb3RlRXZlbnQuIFRoZXNlIGNoYW5nZXMgdHJhY2sgd2hpY2ggZG9jdW1lbnRzIGFyZSBhZGRlZCwgbW9kaWZpZWQgb3JcbiAqIHJlbW92ZWQsIGFzIHdlbGwgYXMgdGhlIHRhcmdldCdzIHJlc3VtZSB0b2tlbiBhbmQgd2hldGhlciB0aGUgdGFyZ2V0IGlzXG4gKiBtYXJrZWQgQ1VSUkVOVC5cbiAqIFRoZSBhY3R1YWwgY2hhbmdlcyAqdG8qIGRvY3VtZW50cyBhcmUgbm90IHBhcnQgb2YgdGhlIFRhcmdldENoYW5nZSBzaW5jZVxuICogZG9jdW1lbnRzIG1heSBiZSBwYXJ0IG9mIG11bHRpcGxlIHRhcmdldHMuXG4gKi8gY2xhc3MgVGFyZ2V0Q2hhbmdlIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBBbiBvcGFxdWUsIHNlcnZlci1hc3NpZ25lZCB0b2tlbiB0aGF0IGFsbG93cyB3YXRjaGluZyBhIHF1ZXJ5IHRvIGJlIHJlc3VtZWRcbiAgICAgKiBhZnRlciBkaXNjb25uZWN0aW5nIHdpdGhvdXQgcmV0cmFuc21pdHRpbmcgYWxsIHRoZSBkYXRhIHRoYXQgbWF0Y2hlcyB0aGVcbiAgICAgKiBxdWVyeS4gVGhlIHJlc3VtZSB0b2tlbiBlc3NlbnRpYWxseSBpZGVudGlmaWVzIGEgcG9pbnQgaW4gdGltZSBmcm9tIHdoaWNoXG4gICAgICogdGhlIHNlcnZlciBzaG91bGQgcmVzdW1lIHNlbmRpbmcgcmVzdWx0cy5cbiAgICAgKi9cbiAgICBlLCBcbiAgICAvKipcbiAgICAgKiBUaGUgXCJjdXJyZW50XCIgKHN5bmNlZCkgc3RhdHVzIG9mIHRoaXMgdGFyZ2V0LiBOb3RlIHRoYXQgXCJjdXJyZW50XCJcbiAgICAgKiBoYXMgc3BlY2lhbCBtZWFuaW5nIGluIHRoZSBSUEMgcHJvdG9jb2wgdGhhdCBpbXBsaWVzIHRoYXQgYSB0YXJnZXQgaXNcbiAgICAgKiBib3RoIHVwLXRvLWRhdGUgYW5kIGNvbnNpc3RlbnQgd2l0aCB0aGUgcmVzdCBvZiB0aGUgd2F0Y2ggc3RyZWFtLlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSBzZXQgb2YgZG9jdW1lbnRzIHRoYXQgd2VyZSBuZXdseSBhc3NpZ25lZCB0byB0aGlzIHRhcmdldCBhcyBwYXJ0IG9mXG4gICAgICogdGhpcyByZW1vdGUgZXZlbnQuXG4gICAgICovXG4gICAgbiwgXG4gICAgLyoqXG4gICAgICogVGhlIHNldCBvZiBkb2N1bWVudHMgdGhhdCB3ZXJlIGFscmVhZHkgYXNzaWduZWQgdG8gdGhpcyB0YXJnZXQgYnV0IHJlY2VpdmVkXG4gICAgICogYW4gdXBkYXRlIGR1cmluZyB0aGlzIHJlbW90ZSBldmVudC5cbiAgICAgKi9cbiAgICByLCBcbiAgICAvKipcbiAgICAgKiBUaGUgc2V0IG9mIGRvY3VtZW50cyB0aGF0IHdlcmUgcmVtb3ZlZCBmcm9tIHRoaXMgdGFyZ2V0IGFzIHBhcnQgb2YgdGhpc1xuICAgICAqIHJlbW90ZSBldmVudC5cbiAgICAgKi9cbiAgICBpKSB7XG4gICAgICAgIHRoaXMucmVzdW1lVG9rZW4gPSBlLCB0aGlzLmN1cnJlbnQgPSB0LCB0aGlzLmFkZGVkRG9jdW1lbnRzID0gbiwgdGhpcy5tb2RpZmllZERvY3VtZW50cyA9IHIsIFxuICAgICAgICB0aGlzLnJlbW92ZWREb2N1bWVudHMgPSBpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyB1c2VkIHRvIGNyZWF0ZSBhIHN5bnRoZXNpemVkIFRhcmdldENoYW5nZXMgdGhhdCBjYW4gYmUgdXNlZCB0b1xuICAgICAqIGFwcGx5IGEgQ1VSUkVOVCBzdGF0dXMgY2hhbmdlIHRvIGEgVmlldyAoZm9yIHF1ZXJpZXMgZXhlY3V0ZWQgaW4gYSBkaWZmZXJlbnRcbiAgICAgKiB0YWIpIG9yIGZvciBuZXcgcXVlcmllcyAodG8gcmFpc2Ugc25hcHNob3RzIHdpdGggY29ycmVjdCBDVVJSRU5UIHN0YXR1cykuXG4gICAgICovICAgIHN0YXRpYyBjcmVhdGVTeW50aGVzaXplZFRhcmdldENoYW5nZUZvckN1cnJlbnRDaGFuZ2UoZSwgdCwgbikge1xuICAgICAgICByZXR1cm4gbmV3IFRhcmdldENoYW5nZShuLCB0LCBfX1BSSVZBVEVfZG9jdW1lbnRLZXlTZXQoKSwgX19QUklWQVRFX2RvY3VtZW50S2V5U2V0KCksIF9fUFJJVkFURV9kb2N1bWVudEtleVNldCgpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFJlcHJlc2VudHMgYSBjaGFuZ2VkIGRvY3VtZW50IGFuZCBhIGxpc3Qgb2YgdGFyZ2V0IGlkcyB0byB3aGljaCB0aGlzIGNoYW5nZVxuICogYXBwbGllcy5cbiAqXG4gKiBJZiBkb2N1bWVudCBoYXMgYmVlbiBkZWxldGVkIE5vRG9jdW1lbnQgd2lsbCBiZSBwcm92aWRlZC5cbiAqLyBjbGFzcyBfX1BSSVZBVEVfRG9jdW1lbnRXYXRjaENoYW5nZSB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqIFRoZSBuZXcgZG9jdW1lbnQgYXBwbGllcyB0byBhbGwgb2YgdGhlc2UgdGFyZ2V0cy4gKi9cbiAgICBlLCBcbiAgICAvKiogVGhlIG5ldyBkb2N1bWVudCBpcyByZW1vdmVkIGZyb20gYWxsIG9mIHRoZXNlIHRhcmdldHMuICovXG4gICAgdCwgXG4gICAgLyoqIFRoZSBrZXkgb2YgdGhlIGRvY3VtZW50IGZvciB0aGlzIGNoYW5nZS4gKi9cbiAgICBuLCBcbiAgICAvKipcbiAgICAgKiBUaGUgbmV3IGRvY3VtZW50IG9yIE5vRG9jdW1lbnQgaWYgaXQgd2FzIGRlbGV0ZWQuIElzIG51bGwgaWYgdGhlXG4gICAgICogZG9jdW1lbnQgd2VudCBvdXQgb2YgdmlldyB3aXRob3V0IHRoZSBzZXJ2ZXIgc2VuZGluZyBhIG5ldyBkb2N1bWVudC5cbiAgICAgKi9cbiAgICByKSB7XG4gICAgICAgIHRoaXMuYmUgPSBlLCB0aGlzLnJlbW92ZWRUYXJnZXRJZHMgPSB0LCB0aGlzLmtleSA9IG4sIHRoaXMuRGUgPSByO1xuICAgIH1cbn1cblxuY2xhc3MgX19QUklWQVRFX0V4aXN0ZW5jZUZpbHRlckNoYW5nZSB7XG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICB0aGlzLnRhcmdldElkID0gZSwgdGhpcy5DZSA9IHQ7XG4gICAgfVxufVxuXG5jbGFzcyBfX1BSSVZBVEVfV2F0Y2hUYXJnZXRDaGFuZ2Uge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKiBXaGF0IGtpbmQgb2YgY2hhbmdlIG9jY3VycmVkIHRvIHRoZSB3YXRjaCB0YXJnZXQuICovXG4gICAgZSwgXG4gICAgLyoqIFRoZSB0YXJnZXQgSURzIHRoYXQgd2VyZSBhZGRlZC9yZW1vdmVkL3NldC4gKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBBbiBvcGFxdWUsIHNlcnZlci1hc3NpZ25lZCB0b2tlbiB0aGF0IGFsbG93cyB3YXRjaGluZyBhIHRhcmdldCB0byBiZVxuICAgICAqIHJlc3VtZWQgYWZ0ZXIgZGlzY29ubmVjdGluZyB3aXRob3V0IHJldHJhbnNtaXR0aW5nIGFsbCB0aGUgZGF0YSB0aGF0XG4gICAgICogbWF0Y2hlcyB0aGUgdGFyZ2V0LiBUaGUgcmVzdW1lIHRva2VuIGVzc2VudGlhbGx5IGlkZW50aWZpZXMgYSBwb2ludCBpblxuICAgICAqIHRpbWUgZnJvbSB3aGljaCB0aGUgc2VydmVyIHNob3VsZCByZXN1bWUgc2VuZGluZyByZXN1bHRzLlxuICAgICAqL1xuICAgIG4gPSBCeXRlU3RyaW5nLkVNUFRZX0JZVEVfU1RSSU5HXG4gICAgLyoqIEFuIFJQQyBlcnJvciBpbmRpY2F0aW5nIHdoeSB0aGUgd2F0Y2ggZmFpbGVkLiAqLyAsIHIgPSBudWxsKSB7XG4gICAgICAgIHRoaXMuc3RhdGUgPSBlLCB0aGlzLnRhcmdldElkcyA9IHQsIHRoaXMucmVzdW1lVG9rZW4gPSBuLCB0aGlzLmNhdXNlID0gcjtcbiAgICB9XG59XG5cbi8qKiBUcmFja3MgdGhlIGludGVybmFsIHN0YXRlIG9mIGEgV2F0Y2ggdGFyZ2V0LiAqLyBjbGFzcyBfX1BSSVZBVEVfVGFyZ2V0U3RhdGUge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIG51bWJlciBvZiBwZW5kaW5nIHJlc3BvbnNlcyAoYWRkcyBvciByZW1vdmVzKSB0aGF0IHdlIGFyZSB3YWl0aW5nIG9uLlxuICAgICAgICAgKiBXZSBvbmx5IGNvbnNpZGVyIHRhcmdldHMgYWN0aXZlIHRoYXQgaGF2ZSBubyBwZW5kaW5nIHJlc3BvbnNlcy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudmUgPSAwLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEtlZXBzIHRyYWNrIG9mIHRoZSBkb2N1bWVudCBjaGFuZ2VzIHNpbmNlIHRoZSBsYXN0IHJhaXNlZCBzbmFwc2hvdC5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhlc2UgY2hhbmdlcyBhcmUgY29udGludW91c2x5IHVwZGF0ZWQgYXMgd2UgcmVjZWl2ZSBkb2N1bWVudCB1cGRhdGVzIGFuZFxuICAgICAgICAgKiBhbHdheXMgcmVmbGVjdCB0aGUgY3VycmVudCBzZXQgb2YgY2hhbmdlcyBhZ2FpbnN0IHRoZSBsYXN0IGlzc3VlZCBzbmFwc2hvdC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuRmUgPSBfX1BSSVZBVEVfc25hcHNob3RDaGFuZ2VzTWFwKCksIFxuICAgICAgICAvKiogU2VlIHB1YmxpYyBnZXR0ZXJzIGZvciBleHBsYW5hdGlvbnMgb2YgdGhlc2UgZmllbGRzLiAqL1xuICAgICAgICB0aGlzLk1lID0gQnl0ZVN0cmluZy5FTVBUWV9CWVRFX1NUUklORywgdGhpcy54ZSA9ICExLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoZXRoZXIgdGhpcyB0YXJnZXQgc3RhdGUgc2hvdWxkIGJlIGluY2x1ZGVkIGluIHRoZSBuZXh0IHNuYXBzaG90LiBXZVxuICAgICAgICAgKiBpbml0aWFsaXplIHRvIHRydWUgc28gdGhhdCBuZXdseS1hZGRlZCB0YXJnZXRzIGFyZSBpbmNsdWRlZCBpbiB0aGUgbmV4dFxuICAgICAgICAgKiBSZW1vdGVFdmVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuT2UgPSAhMDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogV2hldGhlciB0aGlzIHRhcmdldCBoYXMgYmVlbiBtYXJrZWQgJ2N1cnJlbnQnLlxuICAgICAqXG4gICAgICogJ0N1cnJlbnQnIGhhcyBzcGVjaWFsIG1lYW5pbmcgaW4gdGhlIFJQQyBwcm90b2NvbDogSXQgaW1wbGllcyB0aGF0IHRoZVxuICAgICAqIFdhdGNoIGJhY2tlbmQgaGFzIHNlbnQgdXMgYWxsIGNoYW5nZXMgdXAgdG8gdGhlIHBvaW50IGF0IHdoaWNoIHRoZSB0YXJnZXRcbiAgICAgKiB3YXMgYWRkZWQgYW5kIHRoYXQgdGhlIHRhcmdldCBpcyBjb25zaXN0ZW50IHdpdGggdGhlIHJlc3Qgb2YgdGhlIHdhdGNoXG4gICAgICogc3RyZWFtLlxuICAgICAqLyAgICBnZXQgY3VycmVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMueGU7XG4gICAgfVxuICAgIC8qKiBUaGUgbGFzdCByZXN1bWUgdG9rZW4gc2VudCB0byB1cyBmb3IgdGhpcyB0YXJnZXQuICovICAgIGdldCByZXN1bWVUb2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuTWU7XG4gICAgfVxuICAgIC8qKiBXaGV0aGVyIHRoaXMgdGFyZ2V0IGhhcyBwZW5kaW5nIHRhcmdldCBhZGRzIG9yIHRhcmdldCByZW1vdmVzLiAqLyAgICBnZXQgTmUoKSB7XG4gICAgICAgIHJldHVybiAwICE9PSB0aGlzLnZlO1xuICAgIH1cbiAgICAvKiogV2hldGhlciB3ZSBoYXZlIG1vZGlmaWVkIGFueSBzdGF0ZSB0aGF0IHNob3VsZCB0cmlnZ2VyIGEgc25hcHNob3QuICovICAgIGdldCBCZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuT2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgdGhlIHJlc3VtZSB0b2tlbiB0byB0aGUgVGFyZ2V0Q2hhbmdlLCBidXQgb25seSB3aGVuIGl0IGhhcyBhIG5ld1xuICAgICAqIHZhbHVlLiBFbXB0eSByZXN1bWVUb2tlbnMgYXJlIGRpc2NhcmRlZC5cbiAgICAgKi8gICAgTGUoZSkge1xuICAgICAgICBlLmFwcHJveGltYXRlQnl0ZVNpemUoKSA+IDAgJiYgKHRoaXMuT2UgPSAhMCwgdGhpcy5NZSA9IGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgdGFyZ2V0IGNoYW5nZSBmcm9tIHRoZSBjdXJyZW50IHNldCBvZiBjaGFuZ2VzLlxuICAgICAqXG4gICAgICogVG8gcmVzZXQgdGhlIGRvY3VtZW50IGNoYW5nZXMgYWZ0ZXIgcmFpc2luZyB0aGlzIHNuYXBzaG90LCBjYWxsXG4gICAgICogYGNsZWFyUGVuZGluZ0NoYW5nZXMoKWAuXG4gICAgICovICAgIGtlKCkge1xuICAgICAgICBsZXQgZSA9IF9fUFJJVkFURV9kb2N1bWVudEtleVNldCgpLCB0ID0gX19QUklWQVRFX2RvY3VtZW50S2V5U2V0KCksIG4gPSBfX1BSSVZBVEVfZG9jdW1lbnRLZXlTZXQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuRmUuZm9yRWFjaCgoKHIsIGkpID0+IHtcbiAgICAgICAgICAgIHN3aXRjaCAoaSkge1xuICAgICAgICAgICAgICBjYXNlIDAgLyogQ2hhbmdlVHlwZS5BZGRlZCAqLyA6XG4gICAgICAgICAgICAgICAgZSA9IGUuYWRkKHIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGNhc2UgMiAvKiBDaGFuZ2VUeXBlLk1vZGlmaWVkICovIDpcbiAgICAgICAgICAgICAgICB0ID0gdC5hZGQocik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAxIC8qIENoYW5nZVR5cGUuUmVtb3ZlZCAqLyA6XG4gICAgICAgICAgICAgICAgbiA9IG4uYWRkKHIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgZmFpbCgzODAxNywge1xuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VUeXBlOiBpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKSwgbmV3IFRhcmdldENoYW5nZSh0aGlzLk1lLCB0aGlzLnhlLCBlLCB0LCBuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSBkb2N1bWVudCBjaGFuZ2VzIGFuZCBzZXRzIGBoYXNQZW5kaW5nQ2hhbmdlc2AgdG8gZmFsc2UuXG4gICAgICovICAgIHFlKCkge1xuICAgICAgICB0aGlzLk9lID0gITEsIHRoaXMuRmUgPSBfX1BSSVZBVEVfc25hcHNob3RDaGFuZ2VzTWFwKCk7XG4gICAgfVxuICAgIFFlKGUsIHQpIHtcbiAgICAgICAgdGhpcy5PZSA9ICEwLCB0aGlzLkZlID0gdGhpcy5GZS5pbnNlcnQoZSwgdCk7XG4gICAgfVxuICAgICRlKGUpIHtcbiAgICAgICAgdGhpcy5PZSA9ICEwLCB0aGlzLkZlID0gdGhpcy5GZS5yZW1vdmUoZSk7XG4gICAgfVxuICAgIFVlKCkge1xuICAgICAgICB0aGlzLnZlICs9IDE7XG4gICAgfVxuICAgIEtlKCkge1xuICAgICAgICB0aGlzLnZlIC09IDEsIF9fUFJJVkFURV9oYXJkQXNzZXJ0KHRoaXMudmUgPj0gMCwgMzI0MSwge1xuICAgICAgICAgICAgdmU6IHRoaXMudmVcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIFdlKCkge1xuICAgICAgICB0aGlzLk9lID0gITAsIHRoaXMueGUgPSAhMDtcbiAgICB9XG59XG5cbi8qKlxuICogQSBoZWxwZXIgY2xhc3MgdG8gYWNjdW11bGF0ZSB3YXRjaCBjaGFuZ2VzIGludG8gYSBSZW1vdGVFdmVudC5cbiAqL1xuY2xhc3MgX19QUklWQVRFX1dhdGNoQ2hhbmdlQWdncmVnYXRvciB7XG4gICAgY29uc3RydWN0b3IoZSkge1xuICAgICAgICB0aGlzLkdlID0gZSwgXG4gICAgICAgIC8qKiBUaGUgaW50ZXJuYWwgc3RhdGUgb2YgYWxsIHRyYWNrZWQgdGFyZ2V0cy4gKi9cbiAgICAgICAgdGhpcy56ZSA9IG5ldyBNYXAsIFxuICAgICAgICAvKiogS2VlcHMgdHJhY2sgb2YgdGhlIGRvY3VtZW50cyB0byB1cGRhdGUgc2luY2UgdGhlIGxhc3QgcmFpc2VkIHNuYXBzaG90LiAqL1xuICAgICAgICB0aGlzLmplID0gX19QUklWQVRFX211dGFibGVEb2N1bWVudE1hcCgpLCB0aGlzLkplID0gX19QUklWQVRFX2RvY3VtZW50VGFyZ2V0TWFwKCksIFxuICAgICAgICAvKiogQSBtYXBwaW5nIG9mIGRvY3VtZW50IGtleXMgdG8gdGhlaXIgc2V0IG9mIHRhcmdldCBJRHMuICovXG4gICAgICAgIHRoaXMuSGUgPSBfX1BSSVZBVEVfZG9jdW1lbnRUYXJnZXRNYXAoKSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIG1hcCBvZiB0YXJnZXRzIHdpdGggZXhpc3RlbmNlIGZpbHRlciBtaXNtYXRjaGVzLiBUaGVzZSB0YXJnZXRzIGFyZVxuICAgICAgICAgKiBrbm93biB0byBiZSBpbmNvbnNpc3RlbnQgYW5kIHRoZWlyIGxpc3RlbnMgbmVlZHMgdG8gYmUgcmUtZXN0YWJsaXNoZWQgYnlcbiAgICAgICAgICogUmVtb3RlU3RvcmUuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLlllID0gbmV3IFNvcnRlZE1hcChfX1BSSVZBVEVfcHJpbWl0aXZlQ29tcGFyYXRvcik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFByb2Nlc3NlcyBhbmQgYWRkcyB0aGUgRG9jdW1lbnRXYXRjaENoYW5nZSB0byB0aGUgY3VycmVudCBzZXQgb2YgY2hhbmdlcy5cbiAgICAgKi8gICAgWmUoZSkge1xuICAgICAgICBmb3IgKGNvbnN0IHQgb2YgZS5iZSkgZS5EZSAmJiBlLkRlLmlzRm91bmREb2N1bWVudCgpID8gdGhpcy5YZSh0LCBlLkRlKSA6IHRoaXMuZXQodCwgZS5rZXksIGUuRGUpO1xuICAgICAgICBmb3IgKGNvbnN0IHQgb2YgZS5yZW1vdmVkVGFyZ2V0SWRzKSB0aGlzLmV0KHQsIGUua2V5LCBlLkRlKTtcbiAgICB9XG4gICAgLyoqIFByb2Nlc3NlcyBhbmQgYWRkcyB0aGUgV2F0Y2hUYXJnZXRDaGFuZ2UgdG8gdGhlIGN1cnJlbnQgc2V0IG9mIGNoYW5nZXMuICovICAgIHR0KGUpIHtcbiAgICAgICAgdGhpcy5mb3JFYWNoVGFyZ2V0KGUsICh0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLm50KHQpO1xuICAgICAgICAgICAgc3dpdGNoIChlLnN0YXRlKSB7XG4gICAgICAgICAgICAgIGNhc2UgMCAvKiBXYXRjaFRhcmdldENoYW5nZVN0YXRlLk5vQ2hhbmdlICovIDpcbiAgICAgICAgICAgICAgICB0aGlzLnJ0KHQpICYmIG4uTGUoZS5yZXN1bWVUb2tlbik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAxIC8qIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuQWRkZWQgKi8gOlxuICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gZGVjcmVtZW50IHRoZSBudW1iZXIgb2YgcGVuZGluZyBhY2tzIG5lZWRlZCBmcm9tIHdhdGNoXG4gICAgICAgICAgICAgICAgLy8gZm9yIHRoaXMgdGFyZ2V0SWQuXG4gICAgICAgICAgICAgICAgbi5LZSgpLCBuLk5lIHx8IFxuICAgICAgICAgICAgICAgIC8vIFdlIGhhdmUgYSBmcmVzaGx5IGFkZGVkIHRhcmdldCwgc28gd2UgbmVlZCB0byByZXNldCBhbnkgc3RhdGVcbiAgICAgICAgICAgICAgICAvLyB0aGF0IHdlIGhhZCBwcmV2aW91c2x5LiBUaGlzIGNhbiBoYXBwZW4gZS5nLiB3aGVuIHJlbW92ZSBhbmQgYWRkXG4gICAgICAgICAgICAgICAgLy8gYmFjayBhIHRhcmdldCBmb3IgZXhpc3RlbmNlIGZpbHRlciBtaXNtYXRjaGVzLlxuICAgICAgICAgICAgICAgIG4ucWUoKSwgbi5MZShlLnJlc3VtZVRva2VuKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIDIgLyogV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5SZW1vdmVkICovIDpcbiAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIGtlZXAgdHJhY2sgb2YgcmVtb3ZlZCB0YXJnZXRzIHRvIHdlIGNhbiBwb3N0LWZpbHRlciBhbmRcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgYW55IHRhcmdldCBjaGFuZ2VzLlxuICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gZGVjcmVtZW50IHRoZSBudW1iZXIgb2YgcGVuZGluZyBhY2tzIG5lZWRlZCBmcm9tIHdhdGNoXG4gICAgICAgICAgICAgICAgLy8gZm9yIHRoaXMgdGFyZ2V0SWQuXG4gICAgICAgICAgICAgICAgbi5LZSgpLCBuLk5lIHx8IHRoaXMucmVtb3ZlVGFyZ2V0KHQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGNhc2UgMyAvKiBXYXRjaFRhcmdldENoYW5nZVN0YXRlLkN1cnJlbnQgKi8gOlxuICAgICAgICAgICAgICAgIHRoaXMucnQodCkgJiYgKG4uV2UoKSwgbi5MZShlLnJlc3VtZVRva2VuKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSA0IC8qIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuUmVzZXQgKi8gOlxuICAgICAgICAgICAgICAgIHRoaXMucnQodCkgJiYgKFxuICAgICAgICAgICAgICAgIC8vIFJlc2V0IHRoZSB0YXJnZXQgYW5kIHN5bnRoZXNpemVzIHJlbW92ZXMgZm9yIGFsbCBleGlzdGluZ1xuICAgICAgICAgICAgICAgIC8vIGRvY3VtZW50cy4gVGhlIGJhY2tlbmQgd2lsbCByZS1hZGQgYW55IGRvY3VtZW50cyB0aGF0IHN0aWxsXG4gICAgICAgICAgICAgICAgLy8gbWF0Y2ggdGhlIHRhcmdldCBiZWZvcmUgaXQgc2VuZHMgdGhlIG5leHQgZ2xvYmFsIHNuYXBzaG90LlxuICAgICAgICAgICAgICAgIHRoaXMuaXQodCksIG4uTGUoZS5yZXN1bWVUb2tlbikpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgZmFpbCg1Njc5MCwge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZTogZS5zdGF0ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEl0ZXJhdGVzIG92ZXIgYWxsIHRhcmdldElkcyB0aGF0IHRoZSB3YXRjaCBjaGFuZ2UgYXBwbGllcyB0bzogZWl0aGVyIHRoZVxuICAgICAqIHRhcmdldElkcyBleHBsaWNpdGx5IGxpc3RlZCBpbiB0aGUgY2hhbmdlIG9yIHRoZSB0YXJnZXRJZHMgb2YgYWxsIGN1cnJlbnRseVxuICAgICAqIGFjdGl2ZSB0YXJnZXRzLlxuICAgICAqLyAgICBmb3JFYWNoVGFyZ2V0KGUsIHQpIHtcbiAgICAgICAgZS50YXJnZXRJZHMubGVuZ3RoID4gMCA/IGUudGFyZ2V0SWRzLmZvckVhY2godCkgOiB0aGlzLnplLmZvckVhY2goKChlLCBuKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJ0KG4pICYmIHQobik7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSGFuZGxlcyBleGlzdGVuY2UgZmlsdGVycyBhbmQgc3ludGhlc2l6ZXMgZGVsZXRlcyBmb3IgZmlsdGVyIG1pc21hdGNoZXMuXG4gICAgICogVGFyZ2V0cyB0aGF0IGFyZSBpbnZhbGlkYXRlZCBieSBmaWx0ZXIgbWlzbWF0Y2hlcyBhcmUgYWRkZWQgdG9cbiAgICAgKiBgcGVuZGluZ1RhcmdldFJlc2V0c2AuXG4gICAgICovICAgIHN0KGUpIHtcbiAgICAgICAgY29uc3QgdCA9IGUudGFyZ2V0SWQsIG4gPSBlLkNlLmNvdW50LCByID0gdGhpcy5vdCh0KTtcbiAgICAgICAgaWYgKHIpIHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSByLnRhcmdldDtcbiAgICAgICAgICAgIGlmIChfX1BSSVZBVEVfdGFyZ2V0SXNEb2N1bWVudFRhcmdldChpKSkgaWYgKDAgPT09IG4pIHtcbiAgICAgICAgICAgICAgICAvLyBUaGUgZXhpc3RlbmNlIGZpbHRlciB0b2xkIHVzIHRoZSBkb2N1bWVudCBkb2VzIG5vdCBleGlzdC4gV2UgZGVkdWNlXG4gICAgICAgICAgICAgICAgLy8gdGhhdCB0aGlzIGRvY3VtZW50IGRvZXMgbm90IGV4aXN0IGFuZCBhcHBseSBhIGRlbGV0ZWQgZG9jdW1lbnQgdG9cbiAgICAgICAgICAgICAgICAvLyBvdXIgdXBkYXRlcy4gV2l0aG91dCBhcHBseWluZyB0aGlzIGRlbGV0ZWQgZG9jdW1lbnQgdGhlcmUgbWlnaHQgYmVcbiAgICAgICAgICAgICAgICAvLyBhbm90aGVyIHF1ZXJ5IHRoYXQgd2lsbCByYWlzZSB0aGlzIGRvY3VtZW50IGFzIHBhcnQgb2YgYSBzbmFwc2hvdFxuICAgICAgICAgICAgICAgIC8vIHVudGlsIGl0IGlzIHJlc29sdmVkLCBlc3NlbnRpYWxseSBleHBvc2luZyBpbmNvbnNpc3RlbmN5IGJldHdlZW5cbiAgICAgICAgICAgICAgICAvLyBxdWVyaWVzLlxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgRG9jdW1lbnRLZXkoaS5wYXRoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmV0KHQsIGUsIE11dGFibGVEb2N1bWVudC5uZXdOb0RvY3VtZW50KGUsIFNuYXBzaG90VmVyc2lvbi5taW4oKSkpO1xuICAgICAgICAgICAgfSBlbHNlIF9fUFJJVkFURV9oYXJkQXNzZXJ0KDEgPT09IG4sIDIwMDEzLCB7XG4gICAgICAgICAgICAgICAgZXhwZWN0ZWRDb3VudDogblxuICAgICAgICAgICAgfSk7IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLl90KHQpO1xuICAgICAgICAgICAgICAgIC8vIEV4aXN0ZW5jZSBmaWx0ZXIgbWlzbWF0Y2guIE1hcmsgdGhlIGRvY3VtZW50cyBhcyBiZWluZyBpbiBsaW1ibywgYW5kXG4gICAgICAgICAgICAgICAgLy8gcmFpc2UgYSBzbmFwc2hvdCB3aXRoIGBpc0Zyb21DYWNoZTp0cnVlYC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIgIT09IG4pIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQXBwbHkgYmxvb20gZmlsdGVyIHRvIGlkZW50aWZ5IGFuZCBtYXJrIHJlbW92ZWQgZG9jdW1lbnRzLlxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy51dChlKSwgaSA9IG4gPyB0aGlzLmN0KG4sIGUsIHIpIDogMSAvKiBCbG9vbUZpbHRlckFwcGxpY2F0aW9uU3RhdHVzLlNraXBwZWQgKi87XG4gICAgICAgICAgICAgICAgICAgIGlmICgwIC8qIEJsb29tRmlsdGVyQXBwbGljYXRpb25TdGF0dXMuU3VjY2VzcyAqLyAhPT0gaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgYmxvb20gZmlsdGVyIGFwcGxpY2F0aW9uIGZhaWxzLCB3ZSByZXNldCB0aGUgbWFwcGluZyBhbmRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRyaWdnZXIgcmUtcnVuIG9mIHRoZSBxdWVyeS5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXQodCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gMiAvKiBCbG9vbUZpbHRlckFwcGxpY2F0aW9uU3RhdHVzLkZhbHNlUG9zaXRpdmUgKi8gPT09IGkgPyBcIlRhcmdldFB1cnBvc2VFeGlzdGVuY2VGaWx0ZXJNaXNtYXRjaEJsb29tXCIgLyogVGFyZ2V0UHVycG9zZS5FeGlzdGVuY2VGaWx0ZXJNaXNtYXRjaEJsb29tICovIDogXCJUYXJnZXRQdXJwb3NlRXhpc3RlbmNlRmlsdGVyTWlzbWF0Y2hcIiAvKiBUYXJnZXRQdXJwb3NlLkV4aXN0ZW5jZUZpbHRlck1pc21hdGNoICovO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ZZSA9IHRoaXMuWWUuaW5zZXJ0KHQsIGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHd0Py5sdChmdW5jdGlvbiBfX1BSSVZBVEVfY3JlYXRlRXhpc3RlbmNlRmlsdGVyTWlzbWF0Y2hJbmZvRm9yVGVzdGluZ0hvb2tzKGUsIHQsIG4sIHIsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxDYWNoZUNvdW50OiBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4aXN0ZW5jZUZpbHRlckNvdW50OiB0LmNvdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFiYXNlSWQ6IG4uZGF0YWJhc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdElkOiBuLnByb2plY3RJZFxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgbyA9IHQudW5jaGFuZ2VkTmFtZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICBvICYmIChzLmJsb29tRmlsdGVyID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGxpZWQ6IDAgLyogQmxvb21GaWx0ZXJBcHBsaWNhdGlvblN0YXR1cy5TdWNjZXNzICovID09PSBpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc2hDb3VudDogbz8uaGFzaENvdW50ID8/IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYml0bWFwTGVuZ3RoOiBvPy5iaXRzPy5iaXRtYXA/Lmxlbmd0aCA/PyAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IG8/LmJpdHM/LnBhZGRpbmcgPz8gMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaWdodENvbnRhaW46IGUgPT4gcj8ubWlnaHRDb250YWluKGUpID8/ICExXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIChyLCBlLkNlLCB0aGlzLkdlLmh0KCksIG4sIGkpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2UgdGhlIGJsb29tIGZpbHRlciBmcm9tIHRoZSBcInVuY2hhbmdlZF9uYW1lc1wiIGZpZWxkIG9mIGFuIGV4aXN0ZW5jZVxuICAgICAqIGZpbHRlci5cbiAgICAgKi8gICAgdXQoZSkge1xuICAgICAgICBjb25zdCB0ID0gZS5DZS51bmNoYW5nZWROYW1lcztcbiAgICAgICAgaWYgKCF0IHx8ICF0LmJpdHMpIHJldHVybiBudWxsO1xuICAgICAgICBjb25zdCB7Yml0czoge2JpdG1hcDogbiA9IFwiXCIsIHBhZGRpbmc6IHIgPSAwfSwgaGFzaENvdW50OiBpID0gMH0gPSB0O1xuICAgICAgICBsZXQgcywgbztcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHMgPSBfX1BSSVZBVEVfbm9ybWFsaXplQnl0ZVN0cmluZyhuKS50b1VpbnQ4QXJyYXkoKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBfX1BSSVZBVEVfQmFzZTY0RGVjb2RlRXJyb3IpIHJldHVybiBfX1BSSVZBVEVfbG9nV2FybihcIkRlY29kaW5nIHRoZSBiYXNlNjQgYmxvb20gZmlsdGVyIGluIGV4aXN0ZW5jZSBmaWx0ZXIgZmFpbGVkIChcIiArIGUubWVzc2FnZSArIFwiKTsgaWdub3JpbmcgdGhlIGJsb29tIGZpbHRlciBhbmQgZmFsbGluZyBiYWNrIHRvIGZ1bGwgcmUtcXVlcnkuXCIpLCBcbiAgICAgICAgICAgIG51bGw7XG4gICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICB9XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBCbG9vbUZpbHRlciB0aHJvd3MgZXJyb3IgaWYgdGhlIGlucHV0cyBhcmUgaW52YWxpZC5cbiAgICAgICAgICAgIG8gPSBuZXcgQmxvb21GaWx0ZXIocywgciwgaSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJldHVybiBfX1BSSVZBVEVfbG9nV2FybihlIGluc3RhbmNlb2YgX19QUklWQVRFX0Jsb29tRmlsdGVyRXJyb3IgPyBcIkJsb29tRmlsdGVyIGVycm9yOiBcIiA6IFwiQXBwbHlpbmcgYmxvb20gZmlsdGVyIGZhaWxlZDogXCIsIGUpLCBcbiAgICAgICAgICAgIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDAgPT09IG8uZ2UgPyBudWxsIDogbztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXBwbHkgYmxvb20gZmlsdGVyIHRvIHJlbW92ZSB0aGUgZGVsZXRlZCBkb2N1bWVudHMsIGFuZCByZXR1cm4gdGhlXG4gICAgICogYXBwbGljYXRpb24gc3RhdHVzLlxuICAgICAqLyAgICBjdChlLCB0LCBuKSB7XG4gICAgICAgIHJldHVybiB0LkNlLmNvdW50ID09PSBuIC0gdGhpcy5QdChlLCB0LnRhcmdldElkKSA/IDAgLyogQmxvb21GaWx0ZXJBcHBsaWNhdGlvblN0YXR1cy5TdWNjZXNzICovIDogMiAvKiBCbG9vbUZpbHRlckFwcGxpY2F0aW9uU3RhdHVzLkZhbHNlUG9zaXRpdmUgKi87XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZpbHRlciBvdXQgcmVtb3ZlZCBkb2N1bWVudHMgYmFzZWQgb24gYmxvb20gZmlsdGVyIG1lbWJlcnNoaXAgcmVzdWx0IGFuZFxuICAgICAqIHJldHVybiBudW1iZXIgb2YgZG9jdW1lbnRzIHJlbW92ZWQuXG4gICAgICovICAgIFB0KGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuR2UuZ2V0UmVtb3RlS2V5c0ZvclRhcmdldCh0KTtcbiAgICAgICAgbGV0IHIgPSAwO1xuICAgICAgICByZXR1cm4gbi5mb3JFYWNoKChuID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLkdlLmh0KCksIHMgPSBgcHJvamVjdHMvJHtpLnByb2plY3RJZH0vZGF0YWJhc2VzLyR7aS5kYXRhYmFzZX0vZG9jdW1lbnRzLyR7bi5wYXRoLmNhbm9uaWNhbFN0cmluZygpfWA7XG4gICAgICAgICAgICBlLm1pZ2h0Q29udGFpbihzKSB8fCAodGhpcy5ldCh0LCBuLCAvKnVwZGF0ZWREb2N1bWVudD0qLyBudWxsKSwgcisrKTtcbiAgICAgICAgfSkpLCByO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyB0aGUgY3VycmVudGx5IGFjY3VtdWxhdGVkIHN0YXRlIGludG8gYSByZW1vdGUgZXZlbnQgYXQgdGhlXG4gICAgICogcHJvdmlkZWQgc25hcHNob3QgdmVyc2lvbi4gUmVzZXRzIHRoZSBhY2N1bXVsYXRlZCBjaGFuZ2VzIGJlZm9yZSByZXR1cm5pbmcuXG4gICAgICovICAgIFR0KGUpIHtcbiAgICAgICAgY29uc3QgdCA9IG5ldyBNYXA7XG4gICAgICAgIHRoaXMuemUuZm9yRWFjaCgoKG4sIHIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLm90KHIpO1xuICAgICAgICAgICAgaWYgKGkpIHtcbiAgICAgICAgICAgICAgICBpZiAobi5jdXJyZW50ICYmIF9fUFJJVkFURV90YXJnZXRJc0RvY3VtZW50VGFyZ2V0KGkudGFyZ2V0KSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBEb2N1bWVudCBxdWVyaWVzIGZvciBkb2N1bWVudCB0aGF0IGRvbid0IGV4aXN0IGNhbiBwcm9kdWNlIGFuIGVtcHR5XG4gICAgICAgICAgICAgICAgICAgIC8vIHJlc3VsdCBzZXQuIFRvIHVwZGF0ZSBvdXIgbG9jYWwgY2FjaGUsIHdlIHN5bnRoZXNpemUgYSBkb2N1bWVudFxuICAgICAgICAgICAgICAgICAgICAvLyBkZWxldGUgaWYgd2UgaGF2ZSBub3QgcHJldmlvdXNseSByZWNlaXZlZCB0aGUgZG9jdW1lbnQgZm9yIHRoaXNcbiAgICAgICAgICAgICAgICAgICAgLy8gdGFyZ2V0LiBUaGlzIHJlc29sdmVzIHRoZSBsaW1ibyBzdGF0ZSBvZiB0aGUgZG9jdW1lbnQsIHJlbW92aW5nIGl0XG4gICAgICAgICAgICAgICAgICAgIC8vIGZyb20gbGltYm9Eb2N1bWVudFJlZnMuXG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE8oZGltb25kKTogSWRlYWxseSB3ZSB3b3VsZCBoYXZlIGFuIGV4cGxpY2l0IGxvb2t1cCB0YXJnZXRcbiAgICAgICAgICAgICAgICAgICAgLy8gaW5zdGVhZCByZXN1bHRpbmcgaW4gYW4gZXhwbGljaXQgZGVsZXRlIG1lc3NhZ2UgYW5kIHdlIGNvdWxkXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSB0aGlzIHNwZWNpYWwgbG9naWMuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBuZXcgRG9jdW1lbnRLZXkoaS50YXJnZXQucGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuSXQodCkuaGFzKHIpIHx8IHRoaXMuRXQociwgdCkgfHwgdGhpcy5ldChyLCB0LCBNdXRhYmxlRG9jdW1lbnQubmV3Tm9Eb2N1bWVudCh0LCBlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG4uQmUgJiYgKHQuc2V0KHIsIG4ua2UoKSksIG4ucWUoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgbGV0IG4gPSBfX1BSSVZBVEVfZG9jdW1lbnRLZXlTZXQoKTtcbiAgICAgICAgLy8gV2UgZXh0cmFjdCB0aGUgc2V0IG9mIGxpbWJvLW9ubHkgZG9jdW1lbnQgdXBkYXRlcyBhcyB0aGUgR0MgbG9naWNcbiAgICAgICAgLy8gc3BlY2lhbC1jYXNlcyBkb2N1bWVudHMgdGhhdCBkbyBub3QgYXBwZWFyIGluIHRoZSB0YXJnZXQgY2FjaGUuXG4gICAgICAgIFxuICAgICAgICAvLyBUT0RPKGdzb2x0aXMpOiBFeHBhbmQgb24gdGhpcyBjb21tZW50IG9uY2UgR0MgaXMgYXZhaWxhYmxlIGluIHRoZSBKU1xuICAgICAgICAvLyBjbGllbnQuXG4gICAgICAgICAgICAgICAgdGhpcy5IZS5mb3JFYWNoKCgoZSwgdCkgPT4ge1xuICAgICAgICAgICAgbGV0IHIgPSAhMDtcbiAgICAgICAgICAgIHQuZm9yRWFjaFdoaWxlKChlID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5vdChlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gIXQgfHwgXCJUYXJnZXRQdXJwb3NlTGltYm9SZXNvbHV0aW9uXCIgLyogVGFyZ2V0UHVycG9zZS5MaW1ib1Jlc29sdXRpb24gKi8gPT09IHQucHVycG9zZSB8fCAociA9ICExLCBcbiAgICAgICAgICAgICAgICAhMSk7XG4gICAgICAgICAgICB9KSksIHIgJiYgKG4gPSBuLmFkZChlKSk7XG4gICAgICAgIH0pKSwgdGhpcy5qZS5mb3JFYWNoKCgodCwgbikgPT4gbi5zZXRSZWFkVGltZShlKSkpO1xuICAgICAgICBjb25zdCByID0gbmV3IFJlbW90ZUV2ZW50KGUsIHQsIHRoaXMuWWUsIHRoaXMuamUsIG4pO1xuICAgICAgICByZXR1cm4gdGhpcy5qZSA9IF9fUFJJVkFURV9tdXRhYmxlRG9jdW1lbnRNYXAoKSwgdGhpcy5KZSA9IF9fUFJJVkFURV9kb2N1bWVudFRhcmdldE1hcCgpLCBcbiAgICAgICAgdGhpcy5IZSA9IF9fUFJJVkFURV9kb2N1bWVudFRhcmdldE1hcCgpLCB0aGlzLlllID0gbmV3IFNvcnRlZE1hcChfX1BSSVZBVEVfcHJpbWl0aXZlQ29tcGFyYXRvciksIFxuICAgICAgICByO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIHRoZSBwcm92aWRlZCBkb2N1bWVudCB0byB0aGUgaW50ZXJuYWwgbGlzdCBvZiBkb2N1bWVudCB1cGRhdGVzIGFuZFxuICAgICAqIGl0cyBkb2N1bWVudCBrZXkgdG8gdGhlIGdpdmVuIHRhcmdldCdzIG1hcHBpbmcuXG4gICAgICovXG4gICAgLy8gVmlzaWJsZSBmb3IgdGVzdGluZy5cbiAgICBYZShlLCB0KSB7XG4gICAgICAgIGlmICghdGhpcy5ydChlKSkgcmV0dXJuO1xuICAgICAgICBjb25zdCBuID0gdGhpcy5FdChlLCB0LmtleSkgPyAyIC8qIENoYW5nZVR5cGUuTW9kaWZpZWQgKi8gOiAwIC8qIENoYW5nZVR5cGUuQWRkZWQgKi87XG4gICAgICAgIHRoaXMubnQoZSkuUWUodC5rZXksIG4pLCB0aGlzLmplID0gdGhpcy5qZS5pbnNlcnQodC5rZXksIHQpLCB0aGlzLkplID0gdGhpcy5KZS5pbnNlcnQodC5rZXksIHRoaXMuSXQodC5rZXkpLmFkZChlKSksIFxuICAgICAgICB0aGlzLkhlID0gdGhpcy5IZS5pbnNlcnQodC5rZXksIHRoaXMuZHQodC5rZXkpLmFkZChlKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgdGhlIHByb3ZpZGVkIGRvY3VtZW50IGZyb20gdGhlIHRhcmdldCBtYXBwaW5nLiBJZiB0aGVcbiAgICAgKiBkb2N1bWVudCBubyBsb25nZXIgbWF0Y2hlcyB0aGUgdGFyZ2V0LCBidXQgdGhlIGRvY3VtZW50J3Mgc3RhdGUgaXMgc3RpbGxcbiAgICAgKiBrbm93biAoZS5nLiB3ZSBrbm93IHRoYXQgdGhlIGRvY3VtZW50IHdhcyBkZWxldGVkIG9yIHdlIHJlY2VpdmVkIHRoZSBjaGFuZ2VcbiAgICAgKiB0aGF0IGNhdXNlZCB0aGUgZmlsdGVyIG1pc21hdGNoKSwgdGhlIG5ldyBkb2N1bWVudCBjYW4gYmUgcHJvdmlkZWRcbiAgICAgKiB0byB1cGRhdGUgdGhlIHJlbW90ZSBkb2N1bWVudCBjYWNoZS5cbiAgICAgKi9cbiAgICAvLyBWaXNpYmxlIGZvciB0ZXN0aW5nLlxuICAgIGV0KGUsIHQsIG4pIHtcbiAgICAgICAgaWYgKCF0aGlzLnJ0KGUpKSByZXR1cm47XG4gICAgICAgIGNvbnN0IHIgPSB0aGlzLm50KGUpO1xuICAgICAgICB0aGlzLkV0KGUsIHQpID8gci5RZSh0LCAxIC8qIENoYW5nZVR5cGUuUmVtb3ZlZCAqLykgOiBcbiAgICAgICAgLy8gVGhlIGRvY3VtZW50IG1heSBoYXZlIGVudGVyZWQgYW5kIGxlZnQgdGhlIHRhcmdldCBiZWZvcmUgd2UgcmFpc2VkIGFcbiAgICAgICAgLy8gc25hcHNob3QsIHNvIHdlIGNhbiBqdXN0IGlnbm9yZSB0aGUgY2hhbmdlLlxuICAgICAgICByLiRlKHQpLCB0aGlzLkhlID0gdGhpcy5IZS5pbnNlcnQodCwgdGhpcy5kdCh0KS5kZWxldGUoZSkpLCB0aGlzLkhlID0gdGhpcy5IZS5pbnNlcnQodCwgdGhpcy5kdCh0KS5hZGQoZSkpLCBcbiAgICAgICAgbiAmJiAodGhpcy5qZSA9IHRoaXMuamUuaW5zZXJ0KHQsIG4pKTtcbiAgICB9XG4gICAgcmVtb3ZlVGFyZ2V0KGUpIHtcbiAgICAgICAgdGhpcy56ZS5kZWxldGUoZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgY291bnQgb2YgZG9jdW1lbnRzIGluIHRoZSB0YXJnZXQuIFRoaXMgaW5jbHVkZXMgYm90aFxuICAgICAqIHRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIHRoYXQgdGhlIExvY2FsU3RvcmUgY29uc2lkZXJzIHRvIGJlIHBhcnQgb2YgdGhlXG4gICAgICogdGFyZ2V0IGFzIHdlbGwgYXMgYW55IGFjY3VtdWxhdGVkIGNoYW5nZXMuXG4gICAgICovICAgIF90KGUpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMubnQoZSkua2UoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuR2UuZ2V0UmVtb3RlS2V5c0ZvclRhcmdldChlKS5zaXplICsgdC5hZGRlZERvY3VtZW50cy5zaXplIC0gdC5yZW1vdmVkRG9jdW1lbnRzLnNpemU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEluY3JlbWVudCB0aGUgbnVtYmVyIG9mIGFja3MgbmVlZGVkIGZyb20gd2F0Y2ggYmVmb3JlIHdlIGNhbiBjb25zaWRlciB0aGVcbiAgICAgKiBzZXJ2ZXIgdG8gYmUgJ2luLXN5bmMnIHdpdGggdGhlIGNsaWVudCdzIGFjdGl2ZSB0YXJnZXRzLlxuICAgICAqLyAgICBVZShlKSB7XG4gICAgICAgIHRoaXMubnQoZSkuVWUoKTtcbiAgICB9XG4gICAgbnQoZSkge1xuICAgICAgICBsZXQgdCA9IHRoaXMuemUuZ2V0KGUpO1xuICAgICAgICByZXR1cm4gdCB8fCAodCA9IG5ldyBfX1BSSVZBVEVfVGFyZ2V0U3RhdGUsIHRoaXMuemUuc2V0KGUsIHQpKSwgdDtcbiAgICB9XG4gICAgZHQoZSkge1xuICAgICAgICBsZXQgdCA9IHRoaXMuSGUuZ2V0KGUpO1xuICAgICAgICByZXR1cm4gdCB8fCAodCA9IG5ldyBTb3J0ZWRTZXQoX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IpLCB0aGlzLkhlID0gdGhpcy5IZS5pbnNlcnQoZSwgdCkpLCBcbiAgICAgICAgdDtcbiAgICB9XG4gICAgSXQoZSkge1xuICAgICAgICBsZXQgdCA9IHRoaXMuSmUuZ2V0KGUpO1xuICAgICAgICByZXR1cm4gdCB8fCAodCA9IG5ldyBTb3J0ZWRTZXQoX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IpLCB0aGlzLkplID0gdGhpcy5KZS5pbnNlcnQoZSwgdCkpLCBcbiAgICAgICAgdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVmVyaWZpZXMgdGhhdCB0aGUgdXNlciBpcyBzdGlsbCBpbnRlcmVzdGVkIGluIHRoaXMgdGFyZ2V0IChieSBjYWxsaW5nXG4gICAgICogYGdldFRhcmdldERhdGFGb3JUYXJnZXQoKWApIGFuZCB0aGF0IHdlIGFyZSBub3Qgd2FpdGluZyBmb3IgcGVuZGluZyBBRERzXG4gICAgICogZnJvbSB3YXRjaC5cbiAgICAgKi8gICAgcnQoZSkge1xuICAgICAgICBjb25zdCB0ID0gbnVsbCAhPT0gdGhpcy5vdChlKTtcbiAgICAgICAgcmV0dXJuIHQgfHwgX19QUklWQVRFX2xvZ0RlYnVnKFwiV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yXCIsIFwiRGV0ZWN0ZWQgaW5hY3RpdmUgdGFyZ2V0XCIsIGUpLCBcbiAgICAgICAgdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgVGFyZ2V0RGF0YSBmb3IgYW4gYWN0aXZlIHRhcmdldCAoaS5lLiBhIHRhcmdldCB0aGF0IHRoZSB1c2VyXG4gICAgICogaXMgc3RpbGwgaW50ZXJlc3RlZCBpbiB0aGF0IGhhcyBubyBvdXRzdGFuZGluZyB0YXJnZXQgY2hhbmdlIHJlcXVlc3RzKS5cbiAgICAgKi8gICAgb3QoZSkge1xuICAgICAgICBjb25zdCB0ID0gdGhpcy56ZS5nZXQoZSk7XG4gICAgICAgIHJldHVybiB0ICYmIHQuTmUgPyBudWxsIDogdGhpcy5HZS5BdChlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSBzdGF0ZSBvZiBhIFdhdGNoIHRhcmdldCB0byBpdHMgaW5pdGlhbCBzdGF0ZSAoZS5nLiBzZXRzXG4gICAgICogJ2N1cnJlbnQnIHRvIGZhbHNlLCBjbGVhcnMgdGhlIHJlc3VtZSB0b2tlbiBhbmQgcmVtb3ZlcyBpdHMgdGFyZ2V0IG1hcHBpbmdcbiAgICAgKiBmcm9tIGFsbCBkb2N1bWVudHMpLlxuICAgICAqLyAgICBpdChlKSB7XG4gICAgICAgIHRoaXMuemUuc2V0KGUsIG5ldyBfX1BSSVZBVEVfVGFyZ2V0U3RhdGUpO1xuICAgICAgICB0aGlzLkdlLmdldFJlbW90ZUtleXNGb3JUYXJnZXQoZSkuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICB0aGlzLmV0KGUsIHQsIC8qdXBkYXRlZERvY3VtZW50PSovIG51bGwpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgd2hldGhlciB0aGUgTG9jYWxTdG9yZSBjb25zaWRlcnMgdGhlIGRvY3VtZW50IHRvIGJlIHBhcnQgb2YgdGhlXG4gICAgICogc3BlY2lmaWVkIHRhcmdldC5cbiAgICAgKi8gICAgRXQoZSwgdCkge1xuICAgICAgICByZXR1cm4gdGhpcy5HZS5nZXRSZW1vdGVLZXlzRm9yVGFyZ2V0KGUpLmhhcyh0KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9kb2N1bWVudFRhcmdldE1hcCgpIHtcbiAgICByZXR1cm4gbmV3IFNvcnRlZE1hcChEb2N1bWVudEtleS5jb21wYXJhdG9yKTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX3NuYXBzaG90Q2hhbmdlc01hcCgpIHtcbiAgICByZXR1cm4gbmV3IFNvcnRlZE1hcChEb2N1bWVudEtleS5jb21wYXJhdG9yKTtcbn1cblxuY29uc3QgYnQgPSAoKCkgPT4ge1xuICAgIGNvbnN0IGUgPSB7XG4gICAgICAgIGFzYzogXCJBU0NFTkRJTkdcIixcbiAgICAgICAgZGVzYzogXCJERVNDRU5ESU5HXCJcbiAgICB9O1xuICAgIHJldHVybiBlO1xufSkoKSwgRHQgPSAoKCkgPT4ge1xuICAgIGNvbnN0IGUgPSB7XG4gICAgICAgIFwiPFwiOiBcIkxFU1NfVEhBTlwiLFxuICAgICAgICBcIjw9XCI6IFwiTEVTU19USEFOX09SX0VRVUFMXCIsXG4gICAgICAgIFwiPlwiOiBcIkdSRUFURVJfVEhBTlwiLFxuICAgICAgICBcIj49XCI6IFwiR1JFQVRFUl9USEFOX09SX0VRVUFMXCIsXG4gICAgICAgIFwiPT1cIjogXCJFUVVBTFwiLFxuICAgICAgICBcIiE9XCI6IFwiTk9UX0VRVUFMXCIsXG4gICAgICAgIFwiYXJyYXktY29udGFpbnNcIjogXCJBUlJBWV9DT05UQUlOU1wiLFxuICAgICAgICBpbjogXCJJTlwiLFxuICAgICAgICBcIm5vdC1pblwiOiBcIk5PVF9JTlwiLFxuICAgICAgICBcImFycmF5LWNvbnRhaW5zLWFueVwiOiBcIkFSUkFZX0NPTlRBSU5TX0FOWVwiXG4gICAgfTtcbiAgICByZXR1cm4gZTtcbn0pKCksIEN0ID0gKCgpID0+IHtcbiAgICBjb25zdCBlID0ge1xuICAgICAgICBhbmQ6IFwiQU5EXCIsXG4gICAgICAgIG9yOiBcIk9SXCJcbiAgICB9O1xuICAgIHJldHVybiBlO1xufSkoKTtcblxuLyoqXG4gKiBUaGlzIGNsYXNzIGdlbmVyYXRlcyBKc29uT2JqZWN0IHZhbHVlcyBmb3IgdGhlIERhdGFzdG9yZSBBUEkgc3VpdGFibGUgZm9yXG4gKiBzZW5kaW5nIHRvIGVpdGhlciBHUlBDIHN0dWIgbWV0aG9kcyBvciB2aWEgdGhlIEpTT04vSFRUUCBSRVNUIEFQSS5cbiAqXG4gKiBUaGUgc2VyaWFsaXplciBzdXBwb3J0cyBib3RoIFByb3RvYnVmLmpzIGFuZCBQcm90bzMgSlNPTiBmb3JtYXRzLiBCeVxuICogc2V0dGluZyBgdXNlUHJvdG8zSnNvbmAgdG8gdHJ1ZSwgdGhlIHNlcmlhbGl6ZXIgd2lsbCB1c2UgdGhlIFByb3RvMyBKU09OXG4gKiBmb3JtYXQuXG4gKlxuICogRm9yIGEgZGVzY3JpcHRpb24gb2YgdGhlIFByb3RvMyBKU09OIGZvcm1hdCBjaGVja1xuICogaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vcHJvdG9jb2wtYnVmZmVycy9kb2NzL3Byb3RvMyNqc29uXG4gKlxuICogVE9ETyhrbGltdCk6IFdlIGNhbiByZW1vdmUgdGhlIGRhdGFiYXNlSWQgYXJndW1lbnQgaWYgd2Uga2VlcCB0aGUgZnVsbFxuICogcmVzb3VyY2UgbmFtZSBpbiBkb2N1bWVudHMuXG4gKi9cbmNsYXNzIEpzb25Qcm90b1NlcmlhbGl6ZXIge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQpIHtcbiAgICAgICAgdGhpcy5kYXRhYmFzZUlkID0gZSwgdGhpcy51c2VQcm90bzNKc29uID0gdDtcbiAgICB9XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHZhbHVlIGZvciBhIG51bWJlciAob3IgbnVsbCkgdGhhdCdzIGFwcHJvcHJpYXRlIHRvIHB1dCBpbnRvXG4gKiBhIGdvb2dsZS5wcm90b2J1Zi5JbnQzMlZhbHVlIHByb3RvLlxuICogRE8gTk9UIFVTRSBUSElTIEZPUiBBTllUSElORyBFTFNFLlxuICogVGhpcyBtZXRob2QgY2hlYXRzLiBJdCdzIHR5cGVkIGFzIHJldHVybmluZyBcIm51bWJlclwiIGJlY2F1c2UgdGhhdCdzIHdoYXRcbiAqIG91ciBnZW5lcmF0ZWQgcHJvdG8gaW50ZXJmYWNlcyBzYXkgSW50MzJWYWx1ZSBtdXN0IGJlLiBCdXQgR1JQQyBhY3R1YWxseVxuICogZXhwZWN0cyBhIHsgdmFsdWU6IDxudW1iZXI+IH0gc3RydWN0LlxuICovXG5mdW5jdGlvbiBfX1BSSVZBVEVfdG9JbnQzMlByb3RvKGUsIHQpIHtcbiAgICByZXR1cm4gZS51c2VQcm90bzNKc29uIHx8IF9fUFJJVkFURV9pc051bGxPclVuZGVmaW5lZCh0KSA/IHQgOiB7XG4gICAgICAgIHZhbHVlOiB0XG4gICAgfTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgbnVtYmVyIChvciBudWxsKSBmcm9tIGEgZ29vZ2xlLnByb3RvYnVmLkludDMyVmFsdWUgcHJvdG8uXG4gKi9cbi8qKlxuICogUmV0dXJucyBhIHZhbHVlIGZvciBhIERhdGUgdGhhdCdzIGFwcHJvcHJpYXRlIHRvIHB1dCBpbnRvIGEgcHJvdG8uXG4gKi9cbmZ1bmN0aW9uIHRvVGltZXN0YW1wKGUsIHQpIHtcbiAgICBpZiAoZS51c2VQcm90bzNKc29uKSB7XG4gICAgICAgIHJldHVybiBgJHtuZXcgRGF0ZSgxZTMgKiB0LnNlY29uZHMpLnRvSVNPU3RyaW5nKCkucmVwbGFjZSgvXFwuXFxkKi8sIFwiXCIpLnJlcGxhY2UoXCJaXCIsIFwiXCIpfS4keyhcIjAwMDAwMDAwMFwiICsgdC5uYW5vc2Vjb25kcykuc2xpY2UoLTkpfVpgO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBzZWNvbmRzOiBcIlwiICsgdC5zZWNvbmRzLFxuICAgICAgICBuYW5vczogdC5uYW5vc2Vjb25kc1xuICAgIH07XG59XG5cbi8qKlxuICogUmV0dXJucyBhIFRpbWVzdGFtcCB0eXBlZCBvYmplY3QgZ2l2ZW4gcHJvdG9idWYgdGltZXN0YW1wIHZhbHVlLlxuICovXG4vKipcbiAqIFJldHVybnMgYSB2YWx1ZSBmb3IgYnl0ZXMgdGhhdCdzIGFwcHJvcHJpYXRlIHRvIHB1dCBpbiBhIHByb3RvLlxuICpcbiAqIFZpc2libGUgZm9yIHRlc3RpbmcuXG4gKi9cbmZ1bmN0aW9uIF9fUFJJVkFURV90b0J5dGVzKGUsIHQpIHtcbiAgICByZXR1cm4gZS51c2VQcm90bzNKc29uID8gdC50b0Jhc2U2NCgpIDogdC50b1VpbnQ4QXJyYXkoKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgQnl0ZVN0cmluZyBiYXNlZCBvbiB0aGUgcHJvdG8gc3RyaW5nIHZhbHVlLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV90b1ZlcnNpb24oZSwgdCkge1xuICAgIHJldHVybiB0b1RpbWVzdGFtcChlLCB0LnRvVGltZXN0YW1wKCkpO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfZnJvbVZlcnNpb24oZSkge1xuICAgIHJldHVybiBfX1BSSVZBVEVfaGFyZEFzc2VydCghIWUsIDQ5MjMyKSwgU25hcHNob3RWZXJzaW9uLmZyb21UaW1lc3RhbXAoZnVuY3Rpb24gZnJvbVRpbWVzdGFtcChlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBfX1BSSVZBVEVfbm9ybWFsaXplVGltZXN0YW1wKGUpO1xuICAgICAgICByZXR1cm4gbmV3IFRpbWVzdGFtcCh0LnNlY29uZHMsIHQubmFub3MpO1xuICAgIH0oZSkpO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfdG9SZXNvdXJjZU5hbWUoZSwgdCkge1xuICAgIHJldHVybiBfX1BSSVZBVEVfdG9SZXNvdXJjZVBhdGgoZSwgdCkuY2Fub25pY2FsU3RyaW5nKCk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV90b1Jlc291cmNlUGF0aChlLCB0KSB7XG4gICAgY29uc3QgbiA9IGZ1bmN0aW9uIF9fUFJJVkFURV9mdWxseVF1YWxpZmllZFByZWZpeFBhdGgoZSkge1xuICAgICAgICByZXR1cm4gbmV3IFJlc291cmNlUGF0aChbIFwicHJvamVjdHNcIiwgZS5wcm9qZWN0SWQsIFwiZGF0YWJhc2VzXCIsIGUuZGF0YWJhc2UgXSk7XG4gICAgfShlKS5jaGlsZChcImRvY3VtZW50c1wiKTtcbiAgICByZXR1cm4gdm9pZCAwID09PSB0ID8gbiA6IG4uY2hpbGQodCk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9mcm9tUmVzb3VyY2VOYW1lKGUpIHtcbiAgICBjb25zdCB0ID0gUmVzb3VyY2VQYXRoLmZyb21TdHJpbmcoZSk7XG4gICAgcmV0dXJuIF9fUFJJVkFURV9oYXJkQXNzZXJ0KF9fUFJJVkFURV9pc1ZhbGlkUmVzb3VyY2VOYW1lKHQpLCAxMDE5MCwge1xuICAgICAgICBrZXk6IHQudG9TdHJpbmcoKVxuICAgIH0pLCB0O1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfdG9OYW1lKGUsIHQpIHtcbiAgICByZXR1cm4gX19QUklWQVRFX3RvUmVzb3VyY2VOYW1lKGUuZGF0YWJhc2VJZCwgdC5wYXRoKTtcbn1cblxuZnVuY3Rpb24gZnJvbU5hbWUoZSwgdCkge1xuICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfZnJvbVJlc291cmNlTmFtZSh0KTtcbiAgICBpZiAobi5nZXQoMSkgIT09IGUuZGF0YWJhc2VJZC5wcm9qZWN0SWQpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIFwiVHJpZWQgdG8gZGVzZXJpYWxpemUga2V5IGZyb20gZGlmZmVyZW50IHByb2plY3Q6IFwiICsgbi5nZXQoMSkgKyBcIiB2cyBcIiArIGUuZGF0YWJhc2VJZC5wcm9qZWN0SWQpO1xuICAgIGlmIChuLmdldCgzKSAhPT0gZS5kYXRhYmFzZUlkLmRhdGFiYXNlKSB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBcIlRyaWVkIHRvIGRlc2VyaWFsaXplIGtleSBmcm9tIGRpZmZlcmVudCBkYXRhYmFzZTogXCIgKyBuLmdldCgzKSArIFwiIHZzIFwiICsgZS5kYXRhYmFzZUlkLmRhdGFiYXNlKTtcbiAgICByZXR1cm4gbmV3IERvY3VtZW50S2V5KF9fUFJJVkFURV9leHRyYWN0TG9jYWxQYXRoRnJvbVJlc291cmNlTmFtZShuKSk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV90b1F1ZXJ5UGF0aChlLCB0KSB7XG4gICAgcmV0dXJuIF9fUFJJVkFURV90b1Jlc291cmNlTmFtZShlLmRhdGFiYXNlSWQsIHQpO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfZnJvbVF1ZXJ5UGF0aChlKSB7XG4gICAgY29uc3QgdCA9IF9fUFJJVkFURV9mcm9tUmVzb3VyY2VOYW1lKGUpO1xuICAgIC8vIEluIHYxYmV0YTEgcXVlcmllcyBmb3IgY29sbGVjdGlvbnMgYXQgdGhlIHJvb3QgZGlkIG5vdCBoYXZlIGEgdHJhaWxpbmdcbiAgICAvLyBcIi9kb2N1bWVudHNcIi4gSW4gdjEgYWxsIHJlc291cmNlIHBhdGhzIGNvbnRhaW4gXCIvZG9jdW1lbnRzXCIuIFByZXNlcnZlIHRoZVxuICAgIC8vIGFiaWxpdHkgdG8gcmVhZCB0aGUgdjFiZXRhMSBmb3JtIGZvciBjb21wYXRpYmlsaXR5IHdpdGggcXVlcmllcyBwZXJzaXN0ZWRcbiAgICAvLyBpbiB0aGUgbG9jYWwgdGFyZ2V0IGNhY2hlLlxuICAgICAgICByZXR1cm4gNCA9PT0gdC5sZW5ndGggPyBSZXNvdXJjZVBhdGguZW1wdHlQYXRoKCkgOiBfX1BSSVZBVEVfZXh0cmFjdExvY2FsUGF0aEZyb21SZXNvdXJjZU5hbWUodCk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9nZXRFbmNvZGVkRGF0YWJhc2VJZChlKSB7XG4gICAgcmV0dXJuIG5ldyBSZXNvdXJjZVBhdGgoWyBcInByb2plY3RzXCIsIGUuZGF0YWJhc2VJZC5wcm9qZWN0SWQsIFwiZGF0YWJhc2VzXCIsIGUuZGF0YWJhc2VJZC5kYXRhYmFzZSBdKS5jYW5vbmljYWxTdHJpbmcoKTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2V4dHJhY3RMb2NhbFBhdGhGcm9tUmVzb3VyY2VOYW1lKGUpIHtcbiAgICByZXR1cm4gX19QUklWQVRFX2hhcmRBc3NlcnQoZS5sZW5ndGggPiA0ICYmIFwiZG9jdW1lbnRzXCIgPT09IGUuZ2V0KDQpLCAyOTA5MSwge1xuICAgICAgICBrZXk6IGUudG9TdHJpbmcoKVxuICAgIH0pLCBlLnBvcEZpcnN0KDUpO1xufVxuXG4vKiogQ3JlYXRlcyBhIERvY3VtZW50IHByb3RvIGZyb20ga2V5IGFuZCBmaWVsZHMgKGJ1dCBubyBjcmVhdGUvdXBkYXRlIHRpbWUpICovIGZ1bmN0aW9uIF9fUFJJVkFURV90b011dGF0aW9uRG9jdW1lbnQoZSwgdCwgbikge1xuICAgIHJldHVybiB7XG4gICAgICAgIG5hbWU6IF9fUFJJVkFURV90b05hbWUoZSwgdCksXG4gICAgICAgIGZpZWxkczogbi52YWx1ZS5tYXBWYWx1ZS5maWVsZHNcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfZnJvbURvY3VtZW50KGUsIHQsIG4pIHtcbiAgICBjb25zdCByID0gZnJvbU5hbWUoZSwgdC5uYW1lKSwgaSA9IF9fUFJJVkFURV9mcm9tVmVyc2lvbih0LnVwZGF0ZVRpbWUpLCBzID0gdC5jcmVhdGVUaW1lID8gX19QUklWQVRFX2Zyb21WZXJzaW9uKHQuY3JlYXRlVGltZSkgOiBTbmFwc2hvdFZlcnNpb24ubWluKCksIG8gPSBuZXcgT2JqZWN0VmFsdWUoe1xuICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgZmllbGRzOiB0LmZpZWxkc1xuICAgICAgICB9XG4gICAgfSksIF8gPSBNdXRhYmxlRG9jdW1lbnQubmV3Rm91bmREb2N1bWVudChyLCBpLCBzLCBvKTtcbiAgICByZXR1cm4gbiAmJiBfLnNldEhhc0NvbW1pdHRlZE11dGF0aW9ucygpLCBuID8gXy5zZXRIYXNDb21taXR0ZWRNdXRhdGlvbnMoKSA6IF87XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9mcm9tQmF0Y2hHZXREb2N1bWVudHNSZXNwb25zZShlLCB0KSB7XG4gICAgcmV0dXJuIFwiZm91bmRcIiBpbiB0ID8gZnVuY3Rpb24gX19QUklWQVRFX2Zyb21Gb3VuZChlLCB0KSB7XG4gICAgICAgIF9fUFJJVkFURV9oYXJkQXNzZXJ0KCEhdC5mb3VuZCwgNDM1NzEpLCB0LmZvdW5kLm5hbWUsIHQuZm91bmQudXBkYXRlVGltZTtcbiAgICAgICAgY29uc3QgbiA9IGZyb21OYW1lKGUsIHQuZm91bmQubmFtZSksIHIgPSBfX1BSSVZBVEVfZnJvbVZlcnNpb24odC5mb3VuZC51cGRhdGVUaW1lKSwgaSA9IHQuZm91bmQuY3JlYXRlVGltZSA/IF9fUFJJVkFURV9mcm9tVmVyc2lvbih0LmZvdW5kLmNyZWF0ZVRpbWUpIDogU25hcHNob3RWZXJzaW9uLm1pbigpLCBzID0gbmV3IE9iamVjdFZhbHVlKHtcbiAgICAgICAgICAgIG1hcFZhbHVlOiB7XG4gICAgICAgICAgICAgICAgZmllbGRzOiB0LmZvdW5kLmZpZWxkc1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIE11dGFibGVEb2N1bWVudC5uZXdGb3VuZERvY3VtZW50KG4sIHIsIGksIHMpO1xuICAgIH0oZSwgdCkgOiBcIm1pc3NpbmdcIiBpbiB0ID8gZnVuY3Rpb24gX19QUklWQVRFX2Zyb21NaXNzaW5nKGUsIHQpIHtcbiAgICAgICAgX19QUklWQVRFX2hhcmRBc3NlcnQoISF0Lm1pc3NpbmcsIDM4OTQpLCBfX1BSSVZBVEVfaGFyZEFzc2VydCghIXQucmVhZFRpbWUsIDIyOTMzKTtcbiAgICAgICAgY29uc3QgbiA9IGZyb21OYW1lKGUsIHQubWlzc2luZyksIHIgPSBfX1BSSVZBVEVfZnJvbVZlcnNpb24odC5yZWFkVGltZSk7XG4gICAgICAgIHJldHVybiBNdXRhYmxlRG9jdW1lbnQubmV3Tm9Eb2N1bWVudChuLCByKTtcbiAgICB9KGUsIHQpIDogZmFpbCg3MjM0LCB7XG4gICAgICAgIHJlc3VsdDogdFxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfZnJvbVdhdGNoQ2hhbmdlKGUsIHQpIHtcbiAgICBsZXQgbjtcbiAgICBpZiAoXCJ0YXJnZXRDaGFuZ2VcIiBpbiB0KSB7XG4gICAgICAgIHQudGFyZ2V0Q2hhbmdlO1xuICAgICAgICAvLyBwcm90bzMgZGVmYXVsdCB2YWx1ZSBpcyB1bnNldCBpbiBKU09OICh1bmRlZmluZWQpLCBzbyB1c2UgJ05PX0NIQU5HRSdcbiAgICAgICAgLy8gaWYgdW5zZXRcbiAgICAgICAgY29uc3QgciA9IGZ1bmN0aW9uIF9fUFJJVkFURV9mcm9tV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZShlKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJOT19DSEFOR0VcIiA9PT0gZSA/IDAgLyogV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5Ob0NoYW5nZSAqLyA6IFwiQUREXCIgPT09IGUgPyAxIC8qIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuQWRkZWQgKi8gOiBcIlJFTU9WRVwiID09PSBlID8gMiAvKiBXYXRjaFRhcmdldENoYW5nZVN0YXRlLlJlbW92ZWQgKi8gOiBcIkNVUlJFTlRcIiA9PT0gZSA/IDMgLyogV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5DdXJyZW50ICovIDogXCJSRVNFVFwiID09PSBlID8gNCAvKiBXYXRjaFRhcmdldENoYW5nZVN0YXRlLlJlc2V0ICovIDogZmFpbCgzOTMxMywge1xuICAgICAgICAgICAgICAgIHN0YXRlOiBlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSh0LnRhcmdldENoYW5nZS50YXJnZXRDaGFuZ2VUeXBlIHx8IFwiTk9fQ0hBTkdFXCIpLCBpID0gdC50YXJnZXRDaGFuZ2UudGFyZ2V0SWRzIHx8IFtdLCBzID0gZnVuY3Rpb24gX19QUklWQVRFX2Zyb21CeXRlcyhlLCB0KSB7XG4gICAgICAgICAgICByZXR1cm4gZS51c2VQcm90bzNKc29uID8gKF9fUFJJVkFURV9oYXJkQXNzZXJ0KHZvaWQgMCA9PT0gdCB8fCBcInN0cmluZ1wiID09IHR5cGVvZiB0LCA1ODEyMyksIFxuICAgICAgICAgICAgQnl0ZVN0cmluZy5mcm9tQmFzZTY0U3RyaW5nKHQgfHwgXCJcIikpIDogKF9fUFJJVkFURV9oYXJkQXNzZXJ0KHZvaWQgMCA9PT0gdCB8fCBcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSB2YWx1ZSBpcyBhbiBpbnN0YW5jZSBvZiBib3RoIEJ1ZmZlciBhbmQgVWludDhBcnJheSxcbiAgICAgICAgICAgIC8vIGRlc3BpdGUgdGhlIGZhY3QgdGhhdCBCdWZmZXIgZXh0ZW5kcyBVaW50OEFycmF5LiBJbiBzb21lXG4gICAgICAgICAgICAvLyBlbnZpcm9ubWVudHMsIHN1Y2ggYXMganNkb20sIHRoZSBwcm90b3R5cGUgY2hhaW4gb2YgQnVmZmVyXG4gICAgICAgICAgICAvLyBkb2VzIG5vdCBpbmRpY2F0ZSB0aGF0IGl0IGV4dGVuZHMgVWludDhBcnJheS5cbiAgICAgICAgICAgIHQgaW5zdGFuY2VvZiBCdWZmZXIgfHwgdCBpbnN0YW5jZW9mIFVpbnQ4QXJyYXksIDE2MTkzKSwgQnl0ZVN0cmluZy5mcm9tVWludDhBcnJheSh0IHx8IG5ldyBVaW50OEFycmF5KSk7XG4gICAgICAgIH0oZSwgdC50YXJnZXRDaGFuZ2UucmVzdW1lVG9rZW4pLCBvID0gdC50YXJnZXRDaGFuZ2UuY2F1c2UsIF8gPSBvICYmIGZ1bmN0aW9uIF9fUFJJVkFURV9mcm9tUnBjU3RhdHVzKGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSB2b2lkIDAgPT09IGUuY29kZSA/IE4uVU5LTk9XTiA6IF9fUFJJVkFURV9tYXBDb2RlRnJvbVJwY0NvZGUoZS5jb2RlKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgRmlyZXN0b3JlRXJyb3IodCwgZS5tZXNzYWdlIHx8IFwiXCIpO1xuICAgICAgICB9KG8pO1xuICAgICAgICBuID0gbmV3IF9fUFJJVkFURV9XYXRjaFRhcmdldENoYW5nZShyLCBpLCBzLCBfIHx8IG51bGwpO1xuICAgIH0gZWxzZSBpZiAoXCJkb2N1bWVudENoYW5nZVwiIGluIHQpIHtcbiAgICAgICAgdC5kb2N1bWVudENoYW5nZTtcbiAgICAgICAgY29uc3QgciA9IHQuZG9jdW1lbnRDaGFuZ2U7XG4gICAgICAgIHIuZG9jdW1lbnQsIHIuZG9jdW1lbnQubmFtZSwgci5kb2N1bWVudC51cGRhdGVUaW1lO1xuICAgICAgICBjb25zdCBpID0gZnJvbU5hbWUoZSwgci5kb2N1bWVudC5uYW1lKSwgcyA9IF9fUFJJVkFURV9mcm9tVmVyc2lvbihyLmRvY3VtZW50LnVwZGF0ZVRpbWUpLCBvID0gci5kb2N1bWVudC5jcmVhdGVUaW1lID8gX19QUklWQVRFX2Zyb21WZXJzaW9uKHIuZG9jdW1lbnQuY3JlYXRlVGltZSkgOiBTbmFwc2hvdFZlcnNpb24ubWluKCksIF8gPSBuZXcgT2JqZWN0VmFsdWUoe1xuICAgICAgICAgICAgbWFwVmFsdWU6IHtcbiAgICAgICAgICAgICAgICBmaWVsZHM6IHIuZG9jdW1lbnQuZmllbGRzXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLCBhID0gTXV0YWJsZURvY3VtZW50Lm5ld0ZvdW5kRG9jdW1lbnQoaSwgcywgbywgXyksIHUgPSByLnRhcmdldElkcyB8fCBbXSwgYyA9IHIucmVtb3ZlZFRhcmdldElkcyB8fCBbXTtcbiAgICAgICAgbiA9IG5ldyBfX1BSSVZBVEVfRG9jdW1lbnRXYXRjaENoYW5nZSh1LCBjLCBhLmtleSwgYSk7XG4gICAgfSBlbHNlIGlmIChcImRvY3VtZW50RGVsZXRlXCIgaW4gdCkge1xuICAgICAgICB0LmRvY3VtZW50RGVsZXRlO1xuICAgICAgICBjb25zdCByID0gdC5kb2N1bWVudERlbGV0ZTtcbiAgICAgICAgci5kb2N1bWVudDtcbiAgICAgICAgY29uc3QgaSA9IGZyb21OYW1lKGUsIHIuZG9jdW1lbnQpLCBzID0gci5yZWFkVGltZSA/IF9fUFJJVkFURV9mcm9tVmVyc2lvbihyLnJlYWRUaW1lKSA6IFNuYXBzaG90VmVyc2lvbi5taW4oKSwgbyA9IE11dGFibGVEb2N1bWVudC5uZXdOb0RvY3VtZW50KGksIHMpLCBfID0gci5yZW1vdmVkVGFyZ2V0SWRzIHx8IFtdO1xuICAgICAgICBuID0gbmV3IF9fUFJJVkFURV9Eb2N1bWVudFdhdGNoQ2hhbmdlKFtdLCBfLCBvLmtleSwgbyk7XG4gICAgfSBlbHNlIGlmIChcImRvY3VtZW50UmVtb3ZlXCIgaW4gdCkge1xuICAgICAgICB0LmRvY3VtZW50UmVtb3ZlO1xuICAgICAgICBjb25zdCByID0gdC5kb2N1bWVudFJlbW92ZTtcbiAgICAgICAgci5kb2N1bWVudDtcbiAgICAgICAgY29uc3QgaSA9IGZyb21OYW1lKGUsIHIuZG9jdW1lbnQpLCBzID0gci5yZW1vdmVkVGFyZ2V0SWRzIHx8IFtdO1xuICAgICAgICBuID0gbmV3IF9fUFJJVkFURV9Eb2N1bWVudFdhdGNoQ2hhbmdlKFtdLCBzLCBpLCBudWxsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIShcImZpbHRlclwiIGluIHQpKSByZXR1cm4gZmFpbCgxMTYwMSwge1xuICAgICAgICAgICAgUnQ6IHRcbiAgICAgICAgfSk7XG4gICAgICAgIHtcbiAgICAgICAgICAgIHQuZmlsdGVyO1xuICAgICAgICAgICAgY29uc3QgZSA9IHQuZmlsdGVyO1xuICAgICAgICAgICAgZS50YXJnZXRJZDtcbiAgICAgICAgICAgIGNvbnN0IHtjb3VudDogciA9IDAsIHVuY2hhbmdlZE5hbWVzOiBpfSA9IGUsIHMgPSBuZXcgRXhpc3RlbmNlRmlsdGVyKHIsIGkpLCBvID0gZS50YXJnZXRJZDtcbiAgICAgICAgICAgIG4gPSBuZXcgX19QUklWQVRFX0V4aXN0ZW5jZUZpbHRlckNoYW5nZShvLCBzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbjtcbn1cblxuZnVuY3Rpb24gdG9NdXRhdGlvbihlLCB0KSB7XG4gICAgbGV0IG47XG4gICAgaWYgKHQgaW5zdGFuY2VvZiBfX1BSSVZBVEVfU2V0TXV0YXRpb24pIG4gPSB7XG4gICAgICAgIHVwZGF0ZTogX19QUklWQVRFX3RvTXV0YXRpb25Eb2N1bWVudChlLCB0LmtleSwgdC52YWx1ZSlcbiAgICB9OyBlbHNlIGlmICh0IGluc3RhbmNlb2YgX19QUklWQVRFX0RlbGV0ZU11dGF0aW9uKSBuID0ge1xuICAgICAgICBkZWxldGU6IF9fUFJJVkFURV90b05hbWUoZSwgdC5rZXkpXG4gICAgfTsgZWxzZSBpZiAodCBpbnN0YW5jZW9mIF9fUFJJVkFURV9QYXRjaE11dGF0aW9uKSBuID0ge1xuICAgICAgICB1cGRhdGU6IF9fUFJJVkFURV90b011dGF0aW9uRG9jdW1lbnQoZSwgdC5rZXksIHQuZGF0YSksXG4gICAgICAgIHVwZGF0ZU1hc2s6IF9fUFJJVkFURV90b0RvY3VtZW50TWFzayh0LmZpZWxkTWFzaylcbiAgICB9OyBlbHNlIHtcbiAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIF9fUFJJVkFURV9WZXJpZnlNdXRhdGlvbikpIHJldHVybiBmYWlsKDE2NTk5LCB7XG4gICAgICAgICAgICBWdDogdC50eXBlXG4gICAgICAgIH0pO1xuICAgICAgICBuID0ge1xuICAgICAgICAgICAgdmVyaWZ5OiBfX1BSSVZBVEVfdG9OYW1lKGUsIHQua2V5KVxuICAgICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gdC5maWVsZFRyYW5zZm9ybXMubGVuZ3RoID4gMCAmJiAobi51cGRhdGVUcmFuc2Zvcm1zID0gdC5maWVsZFRyYW5zZm9ybXMubWFwKChlID0+IGZ1bmN0aW9uIF9fUFJJVkFURV90b0ZpZWxkVHJhbnNmb3JtKGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IHQudHJhbnNmb3JtO1xuICAgICAgICBpZiAobiBpbnN0YW5jZW9mIF9fUFJJVkFURV9TZXJ2ZXJUaW1lc3RhbXBUcmFuc2Zvcm0pIHJldHVybiB7XG4gICAgICAgICAgICBmaWVsZFBhdGg6IHQuZmllbGQuY2Fub25pY2FsU3RyaW5nKCksXG4gICAgICAgICAgICBzZXRUb1NlcnZlclZhbHVlOiBcIlJFUVVFU1RfVElNRVwiXG4gICAgICAgIH07XG4gICAgICAgIGlmIChuIGluc3RhbmNlb2YgX19QUklWQVRFX0FycmF5VW5pb25UcmFuc2Zvcm1PcGVyYXRpb24pIHJldHVybiB7XG4gICAgICAgICAgICBmaWVsZFBhdGg6IHQuZmllbGQuY2Fub25pY2FsU3RyaW5nKCksXG4gICAgICAgICAgICBhcHBlbmRNaXNzaW5nRWxlbWVudHM6IHtcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IG4uZWxlbWVudHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgaWYgKG4gaW5zdGFuY2VvZiBfX1BSSVZBVEVfQXJyYXlSZW1vdmVUcmFuc2Zvcm1PcGVyYXRpb24pIHJldHVybiB7XG4gICAgICAgICAgICBmaWVsZFBhdGg6IHQuZmllbGQuY2Fub25pY2FsU3RyaW5nKCksXG4gICAgICAgICAgICByZW1vdmVBbGxGcm9tQXJyYXk6IHtcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IG4uZWxlbWVudHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgaWYgKG4gaW5zdGFuY2VvZiBfX1BSSVZBVEVfTnVtZXJpY0luY3JlbWVudFRyYW5zZm9ybU9wZXJhdGlvbikgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpZWxkUGF0aDogdC5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSxcbiAgICAgICAgICAgIGluY3JlbWVudDogbi5BZVxuICAgICAgICB9O1xuICAgICAgICB0aHJvdyBmYWlsKDIwOTMwLCB7XG4gICAgICAgICAgICB0cmFuc2Zvcm06IHQudHJhbnNmb3JtXG4gICAgICAgIH0pO1xuICAgIH0oMCwgZSkpKSksIHQucHJlY29uZGl0aW9uLmlzTm9uZSB8fCAobi5jdXJyZW50RG9jdW1lbnQgPSBmdW5jdGlvbiBfX1BSSVZBVEVfdG9QcmVjb25kaXRpb24oZSwgdCkge1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSB0LnVwZGF0ZVRpbWUgPyB7XG4gICAgICAgICAgICB1cGRhdGVUaW1lOiBfX1BSSVZBVEVfdG9WZXJzaW9uKGUsIHQudXBkYXRlVGltZSlcbiAgICAgICAgfSA6IHZvaWQgMCAhPT0gdC5leGlzdHMgPyB7XG4gICAgICAgICAgICBleGlzdHM6IHQuZXhpc3RzXG4gICAgICAgIH0gOiBmYWlsKDI3NDk3KTtcbiAgICB9KGUsIHQucHJlY29uZGl0aW9uKSksIG47XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9mcm9tTXV0YXRpb24oZSwgdCkge1xuICAgIGNvbnN0IG4gPSB0LmN1cnJlbnREb2N1bWVudCA/IGZ1bmN0aW9uIF9fUFJJVkFURV9mcm9tUHJlY29uZGl0aW9uKGUpIHtcbiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gZS51cGRhdGVUaW1lID8gUHJlY29uZGl0aW9uLnVwZGF0ZVRpbWUoX19QUklWQVRFX2Zyb21WZXJzaW9uKGUudXBkYXRlVGltZSkpIDogdm9pZCAwICE9PSBlLmV4aXN0cyA/IFByZWNvbmRpdGlvbi5leGlzdHMoZS5leGlzdHMpIDogUHJlY29uZGl0aW9uLm5vbmUoKTtcbiAgICB9KHQuY3VycmVudERvY3VtZW50KSA6IFByZWNvbmRpdGlvbi5ub25lKCksIHIgPSB0LnVwZGF0ZVRyYW5zZm9ybXMgPyB0LnVwZGF0ZVRyYW5zZm9ybXMubWFwKCh0ID0+IGZ1bmN0aW9uIF9fUFJJVkFURV9mcm9tRmllbGRUcmFuc2Zvcm0oZSwgdCkge1xuICAgICAgICBsZXQgbiA9IG51bGw7XG4gICAgICAgIGlmIChcInNldFRvU2VydmVyVmFsdWVcIiBpbiB0KSBfX1BSSVZBVEVfaGFyZEFzc2VydChcIlJFUVVFU1RfVElNRVwiID09PSB0LnNldFRvU2VydmVyVmFsdWUsIDE2NjMwLCB7XG4gICAgICAgICAgICBwcm90bzogdFxuICAgICAgICB9KSwgbiA9IG5ldyBfX1BSSVZBVEVfU2VydmVyVGltZXN0YW1wVHJhbnNmb3JtOyBlbHNlIGlmIChcImFwcGVuZE1pc3NpbmdFbGVtZW50c1wiIGluIHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LmFwcGVuZE1pc3NpbmdFbGVtZW50cy52YWx1ZXMgfHwgW107XG4gICAgICAgICAgICBuID0gbmV3IF9fUFJJVkFURV9BcnJheVVuaW9uVHJhbnNmb3JtT3BlcmF0aW9uKGUpO1xuICAgICAgICB9IGVsc2UgaWYgKFwicmVtb3ZlQWxsRnJvbUFycmF5XCIgaW4gdCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IHQucmVtb3ZlQWxsRnJvbUFycmF5LnZhbHVlcyB8fCBbXTtcbiAgICAgICAgICAgIG4gPSBuZXcgX19QUklWQVRFX0FycmF5UmVtb3ZlVHJhbnNmb3JtT3BlcmF0aW9uKGUpO1xuICAgICAgICB9IGVsc2UgXCJpbmNyZW1lbnRcIiBpbiB0ID8gbiA9IG5ldyBfX1BSSVZBVEVfTnVtZXJpY0luY3JlbWVudFRyYW5zZm9ybU9wZXJhdGlvbihlLCB0LmluY3JlbWVudCkgOiBmYWlsKDE2NTg0LCB7XG4gICAgICAgICAgICBwcm90bzogdFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgciA9IEZpZWxkUGF0aCQxLmZyb21TZXJ2ZXJGb3JtYXQodC5maWVsZFBhdGgpO1xuICAgICAgICByZXR1cm4gbmV3IEZpZWxkVHJhbnNmb3JtKHIsIG4pO1xuICAgIH0oZSwgdCkpKSA6IFtdO1xuICAgIGlmICh0LnVwZGF0ZSkge1xuICAgICAgICB0LnVwZGF0ZS5uYW1lO1xuICAgICAgICBjb25zdCBpID0gZnJvbU5hbWUoZSwgdC51cGRhdGUubmFtZSksIHMgPSBuZXcgT2JqZWN0VmFsdWUoe1xuICAgICAgICAgICAgbWFwVmFsdWU6IHtcbiAgICAgICAgICAgICAgICBmaWVsZHM6IHQudXBkYXRlLmZpZWxkc1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHQudXBkYXRlTWFzaykge1xuICAgICAgICAgICAgY29uc3QgZSA9IGZ1bmN0aW9uIF9fUFJJVkFURV9mcm9tRG9jdW1lbnRNYXNrKGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gZS5maWVsZFBhdGhzIHx8IFtdO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRmllbGRNYXNrKHQubWFwKChlID0+IEZpZWxkUGF0aCQxLmZyb21TZXJ2ZXJGb3JtYXQoZSkpKSk7XG4gICAgICAgICAgICB9KHQudXBkYXRlTWFzayk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9QYXRjaE11dGF0aW9uKGksIHMsIGUsIG4sIHIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgX19QUklWQVRFX1NldE11dGF0aW9uKGksIHMsIG4sIHIpO1xuICAgIH1cbiAgICBpZiAodC5kZWxldGUpIHtcbiAgICAgICAgY29uc3QgciA9IGZyb21OYW1lKGUsIHQuZGVsZXRlKTtcbiAgICAgICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfRGVsZXRlTXV0YXRpb24ociwgbik7XG4gICAgfVxuICAgIGlmICh0LnZlcmlmeSkge1xuICAgICAgICBjb25zdCByID0gZnJvbU5hbWUoZSwgdC52ZXJpZnkpO1xuICAgICAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9WZXJpZnlNdXRhdGlvbihyLCBuKTtcbiAgICB9XG4gICAgcmV0dXJuIGZhaWwoMTQ2Mywge1xuICAgICAgICBwcm90bzogdFxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfZnJvbVdyaXRlUmVzdWx0cyhlLCB0KSB7XG4gICAgcmV0dXJuIGUgJiYgZS5sZW5ndGggPiAwID8gKF9fUFJJVkFURV9oYXJkQXNzZXJ0KHZvaWQgMCAhPT0gdCwgMTQzNTMpLCBlLm1hcCgoZSA9PiBmdW5jdGlvbiBfX1BSSVZBVEVfZnJvbVdyaXRlUmVzdWx0KGUsIHQpIHtcbiAgICAgICAgLy8gTk9URTogRGVsZXRlcyBkb24ndCBoYXZlIGFuIHVwZGF0ZVRpbWUuXG4gICAgICAgIGxldCBuID0gZS51cGRhdGVUaW1lID8gX19QUklWQVRFX2Zyb21WZXJzaW9uKGUudXBkYXRlVGltZSkgOiBfX1BSSVZBVEVfZnJvbVZlcnNpb24odCk7XG4gICAgICAgIHJldHVybiBuLmlzRXF1YWwoU25hcHNob3RWZXJzaW9uLm1pbigpKSAmJiAoXG4gICAgICAgIC8vIFRoZSBGaXJlc3RvcmUgRW11bGF0b3IgY3VycmVudGx5IHJldHVybnMgYW4gdXBkYXRlIHRpbWUgb2YgMCBmb3JcbiAgICAgICAgLy8gZGVsZXRlcyBvZiBub24tZXhpc3RpbmcgZG9jdW1lbnRzIChyYXRoZXIgdGhhbiBudWxsKS4gVGhpcyBicmVha3MgdGhlXG4gICAgICAgIC8vIHRlc3QgXCJnZXQgZGVsZXRlZCBkb2Mgd2hpbGUgb2ZmbGluZSB3aXRoIHNvdXJjZT1jYWNoZVwiIGFzIE5vRG9jdW1lbnRzXG4gICAgICAgIC8vIHdpdGggdmVyc2lvbiAwIGFyZSBmaWx0ZXJlZCBieSBJbmRleGVkRGIncyBSZW1vdGVEb2N1bWVudENhY2hlLlxuICAgICAgICAvLyBUT0RPKCMyMTQ5KTogUmVtb3ZlIHRoaXMgd2hlbiBFbXVsYXRvciBpcyBmaXhlZFxuICAgICAgICBuID0gX19QUklWQVRFX2Zyb21WZXJzaW9uKHQpKSwgbmV3IE11dGF0aW9uUmVzdWx0KG4sIGUudHJhbnNmb3JtUmVzdWx0cyB8fCBbXSk7XG4gICAgfShlLCB0KSkpKSA6IFtdO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfdG9Eb2N1bWVudHNUYXJnZXQoZSwgdCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIGRvY3VtZW50czogWyBfX1BSSVZBVEVfdG9RdWVyeVBhdGgoZSwgdC5wYXRoKSBdXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX3RvUXVlcnlUYXJnZXQoZSwgdCkge1xuICAgIC8vIERpc3NlY3QgdGhlIHBhdGggaW50byBwYXJlbnQsIGNvbGxlY3Rpb25JZCwgYW5kIG9wdGlvbmFsIGtleSBmaWx0ZXIuXG4gICAgY29uc3QgbiA9IHtcbiAgICAgICAgc3RydWN0dXJlZFF1ZXJ5OiB7fVxuICAgIH0sIHIgPSB0LnBhdGg7XG4gICAgbGV0IGk7XG4gICAgbnVsbCAhPT0gdC5jb2xsZWN0aW9uR3JvdXAgPyAoaSA9IHIsIG4uc3RydWN0dXJlZFF1ZXJ5LmZyb20gPSBbIHtcbiAgICAgICAgY29sbGVjdGlvbklkOiB0LmNvbGxlY3Rpb25Hcm91cCxcbiAgICAgICAgYWxsRGVzY2VuZGFudHM6ICEwXG4gICAgfSBdKSA6IChpID0gci5wb3BMYXN0KCksIG4uc3RydWN0dXJlZFF1ZXJ5LmZyb20gPSBbIHtcbiAgICAgICAgY29sbGVjdGlvbklkOiByLmxhc3RTZWdtZW50KClcbiAgICB9IF0pLCBuLnBhcmVudCA9IF9fUFJJVkFURV90b1F1ZXJ5UGF0aChlLCBpKTtcbiAgICBjb25zdCBzID0gZnVuY3Rpb24gX19QUklWQVRFX3RvRmlsdGVycyhlKSB7XG4gICAgICAgIGlmICgwID09PSBlLmxlbmd0aCkgcmV0dXJuO1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX3RvRmlsdGVyKENvbXBvc2l0ZUZpbHRlci5jcmVhdGUoZSwgXCJhbmRcIiAvKiBDb21wb3NpdGVPcGVyYXRvci5BTkQgKi8pKTtcbiAgICB9KHQuZmlsdGVycyk7XG4gICAgcyAmJiAobi5zdHJ1Y3R1cmVkUXVlcnkud2hlcmUgPSBzKTtcbiAgICBjb25zdCBvID0gZnVuY3Rpb24gX19QUklWQVRFX3RvT3JkZXIoZSkge1xuICAgICAgICBpZiAoMCA9PT0gZS5sZW5ndGgpIHJldHVybjtcbiAgICAgICAgcmV0dXJuIGUubWFwKChlID0+IFxuICAgICAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXG4gICAgICAgIGZ1bmN0aW9uIF9fUFJJVkFURV90b1Byb3BlcnR5T3JkZXIoZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBmaWVsZDogX19QUklWQVRFX3RvRmllbGRQYXRoUmVmZXJlbmNlKGUuZmllbGQpLFxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogX19QUklWQVRFX3RvRGlyZWN0aW9uKGUuZGlyKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfShlKSkpO1xuICAgIH0odC5vcmRlckJ5KTtcbiAgICBvICYmIChuLnN0cnVjdHVyZWRRdWVyeS5vcmRlckJ5ID0gbyk7XG4gICAgY29uc3QgXyA9IF9fUFJJVkFURV90b0ludDMyUHJvdG8oZSwgdC5saW1pdCk7XG4gICAgcmV0dXJuIG51bGwgIT09IF8gJiYgKG4uc3RydWN0dXJlZFF1ZXJ5LmxpbWl0ID0gXyksIHQuc3RhcnRBdCAmJiAobi5zdHJ1Y3R1cmVkUXVlcnkuc3RhcnRBdCA9IGZ1bmN0aW9uIF9fUFJJVkFURV90b1N0YXJ0QXRDdXJzb3IoZSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYmVmb3JlOiBlLmluY2x1c2l2ZSxcbiAgICAgICAgICAgIHZhbHVlczogZS5wb3NpdGlvblxuICAgICAgICB9O1xuICAgIH0odC5zdGFydEF0KSksIHQuZW5kQXQgJiYgKG4uc3RydWN0dXJlZFF1ZXJ5LmVuZEF0ID0gZnVuY3Rpb24gX19QUklWQVRFX3RvRW5kQXRDdXJzb3IoZSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYmVmb3JlOiAhZS5pbmNsdXNpdmUsXG4gICAgICAgICAgICB2YWx1ZXM6IGUucG9zaXRpb25cbiAgICAgICAgfTtcbiAgICB9KHQuZW5kQXQpKSwge1xuICAgICAgICBmdDogbixcbiAgICAgICAgcGFyZW50OiBpXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX3RvUnVuQWdncmVnYXRpb25RdWVyeVJlcXVlc3QoZSwgdCwgbiwgcikge1xuICAgIGNvbnN0IHtmdDogaSwgcGFyZW50OiBzfSA9IF9fUFJJVkFURV90b1F1ZXJ5VGFyZ2V0KGUsIHQpLCBvID0ge30sIF8gPSBbXTtcbiAgICBsZXQgYSA9IDA7XG4gICAgcmV0dXJuIG4uZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgIC8vIE1hcCBhbGwgY2xpZW50LXNpZGUgYWxpYXNlcyB0byBhIHVuaXF1ZSBzaG9ydC1mb3JtXG4gICAgICAgIC8vIGFsaWFzLiBUaGlzIGF2b2lkcyBpc3N1ZXMgd2l0aCBjbGllbnQtc2lkZSBhbGlhc2VzIHRoYXRcbiAgICAgICAgLy8gZXhjZWVkIHRoZSAxNTAwLWJ5dGUgc3RyaW5nIHNpemUgbGltaXQuXG4gICAgICAgIGNvbnN0IHQgPSByID8gZS5hbGlhcyA6IFwiYWdncmVnYXRlX1wiICsgYSsrO1xuICAgICAgICBvW3RdID0gZS5hbGlhcywgXCJjb3VudFwiID09PSBlLmFnZ3JlZ2F0ZVR5cGUgPyBfLnB1c2goe1xuICAgICAgICAgICAgYWxpYXM6IHQsXG4gICAgICAgICAgICBjb3VudDoge31cbiAgICAgICAgfSkgOiBcImF2Z1wiID09PSBlLmFnZ3JlZ2F0ZVR5cGUgPyBfLnB1c2goe1xuICAgICAgICAgICAgYWxpYXM6IHQsXG4gICAgICAgICAgICBhdmc6IHtcbiAgICAgICAgICAgICAgICBmaWVsZDogX19QUklWQVRFX3RvRmllbGRQYXRoUmVmZXJlbmNlKGUuZmllbGRQYXRoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSA6IFwic3VtXCIgPT09IGUuYWdncmVnYXRlVHlwZSAmJiBfLnB1c2goe1xuICAgICAgICAgICAgYWxpYXM6IHQsXG4gICAgICAgICAgICBzdW06IHtcbiAgICAgICAgICAgICAgICBmaWVsZDogX19QUklWQVRFX3RvRmllbGRQYXRoUmVmZXJlbmNlKGUuZmllbGRQYXRoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KSksIHtcbiAgICAgICAgcmVxdWVzdDoge1xuICAgICAgICAgICAgc3RydWN0dXJlZEFnZ3JlZ2F0aW9uUXVlcnk6IHtcbiAgICAgICAgICAgICAgICBhZ2dyZWdhdGlvbnM6IF8sXG4gICAgICAgICAgICAgICAgc3RydWN0dXJlZFF1ZXJ5OiBpLnN0cnVjdHVyZWRRdWVyeVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHBhcmVudDogaS5wYXJlbnRcbiAgICAgICAgfSxcbiAgICAgICAgZ3Q6IG8sXG4gICAgICAgIHBhcmVudDogc1xuICAgIH07XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9jb252ZXJ0UXVlcnlUYXJnZXRUb1F1ZXJ5KGUpIHtcbiAgICBsZXQgdCA9IF9fUFJJVkFURV9mcm9tUXVlcnlQYXRoKGUucGFyZW50KTtcbiAgICBjb25zdCBuID0gZS5zdHJ1Y3R1cmVkUXVlcnksIHIgPSBuLmZyb20gPyBuLmZyb20ubGVuZ3RoIDogMDtcbiAgICBsZXQgaSA9IG51bGw7XG4gICAgaWYgKHIgPiAwKSB7XG4gICAgICAgIF9fUFJJVkFURV9oYXJkQXNzZXJ0KDEgPT09IHIsIDY1MDYyKTtcbiAgICAgICAgY29uc3QgZSA9IG4uZnJvbVswXTtcbiAgICAgICAgZS5hbGxEZXNjZW5kYW50cyA/IGkgPSBlLmNvbGxlY3Rpb25JZCA6IHQgPSB0LmNoaWxkKGUuY29sbGVjdGlvbklkKTtcbiAgICB9XG4gICAgbGV0IHMgPSBbXTtcbiAgICBuLndoZXJlICYmIChzID0gZnVuY3Rpb24gX19QUklWQVRFX2Zyb21GaWx0ZXJzKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IF9fUFJJVkFURV9mcm9tRmlsdGVyKGUpO1xuICAgICAgICBpZiAodCBpbnN0YW5jZW9mIENvbXBvc2l0ZUZpbHRlciAmJiBfX1BSSVZBVEVfY29tcG9zaXRlRmlsdGVySXNGbGF0Q29uanVuY3Rpb24odCkpIHJldHVybiB0LmdldEZpbHRlcnMoKTtcbiAgICAgICAgcmV0dXJuIFsgdCBdO1xuICAgIH0obi53aGVyZSkpO1xuICAgIGxldCBvID0gW107XG4gICAgbi5vcmRlckJ5ICYmIChvID0gZnVuY3Rpb24gX19QUklWQVRFX2Zyb21PcmRlcihlKSB7XG4gICAgICAgIHJldHVybiBlLm1hcCgoZSA9PiBmdW5jdGlvbiBfX1BSSVZBVEVfZnJvbVByb3BlcnR5T3JkZXIoZSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBPcmRlckJ5KF9fUFJJVkFURV9mcm9tRmllbGRQYXRoUmVmZXJlbmNlKGUuZmllbGQpLCBcbiAgICAgICAgICAgIC8vIHZpc2libGUgZm9yIHRlc3RpbmdcbiAgICAgICAgICAgIGZ1bmN0aW9uIF9fUFJJVkFURV9mcm9tRGlyZWN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgIGNhc2UgXCJBU0NFTkRJTkdcIjpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiYXNjXCIgLyogRGlyZWN0aW9uLkFTQ0VORElORyAqLztcblxuICAgICAgICAgICAgICAgICAgY2FzZSBcIkRFU0NFTkRJTkdcIjpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiZGVzY1wiIC8qIERpcmVjdGlvbi5ERVNDRU5ESU5HICovO1xuXG4gICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgICAgICAgICAgKGUuZGlyZWN0aW9uKSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgICAgICAoZSkpKTtcbiAgICB9KG4ub3JkZXJCeSkpO1xuICAgIGxldCBfID0gbnVsbDtcbiAgICBuLmxpbWl0ICYmIChfID0gZnVuY3Rpb24gX19QUklWQVRFX2Zyb21JbnQzMlByb3RvKGUpIHtcbiAgICAgICAgbGV0IHQ7XG4gICAgICAgIHJldHVybiB0ID0gXCJvYmplY3RcIiA9PSB0eXBlb2YgZSA/IGUudmFsdWUgOiBlLCBfX1BSSVZBVEVfaXNOdWxsT3JVbmRlZmluZWQodCkgPyBudWxsIDogdDtcbiAgICB9KG4ubGltaXQpKTtcbiAgICBsZXQgYSA9IG51bGw7XG4gICAgbi5zdGFydEF0ICYmIChhID0gZnVuY3Rpb24gX19QUklWQVRFX2Zyb21TdGFydEF0Q3Vyc29yKGUpIHtcbiAgICAgICAgY29uc3QgdCA9ICEhZS5iZWZvcmUsIG4gPSBlLnZhbHVlcyB8fCBbXTtcbiAgICAgICAgcmV0dXJuIG5ldyBCb3VuZChuLCB0KTtcbiAgICB9KG4uc3RhcnRBdCkpO1xuICAgIGxldCB1ID0gbnVsbDtcbiAgICByZXR1cm4gbi5lbmRBdCAmJiAodSA9IGZ1bmN0aW9uIF9fUFJJVkFURV9mcm9tRW5kQXRDdXJzb3IoZSkge1xuICAgICAgICBjb25zdCB0ID0gIWUuYmVmb3JlLCBuID0gZS52YWx1ZXMgfHwgW107XG4gICAgICAgIHJldHVybiBuZXcgQm91bmQobiwgdCk7XG4gICAgfVxuICAgIC8vIHZpc2libGUgZm9yIHRlc3RpbmdcbiAgICAobi5lbmRBdCkpLCBfX1BSSVZBVEVfbmV3UXVlcnkodCwgaSwgbywgcywgXywgXCJGXCIgLyogTGltaXRUeXBlLkZpcnN0ICovICwgYSwgdSk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV90b0xpc3RlblJlcXVlc3RMYWJlbHMoZSwgdCkge1xuICAgIGNvbnN0IG4gPSBmdW5jdGlvbiBfX1BSSVZBVEVfdG9MYWJlbChlKSB7XG4gICAgICAgIHN3aXRjaCAoZSkge1xuICAgICAgICAgIGNhc2UgXCJUYXJnZXRQdXJwb3NlTGlzdGVuXCIgLyogVGFyZ2V0UHVycG9zZS5MaXN0ZW4gKi8gOlxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICBjYXNlIFwiVGFyZ2V0UHVycG9zZUV4aXN0ZW5jZUZpbHRlck1pc21hdGNoXCIgLyogVGFyZ2V0UHVycG9zZS5FeGlzdGVuY2VGaWx0ZXJNaXNtYXRjaCAqLyA6XG4gICAgICAgICAgICByZXR1cm4gXCJleGlzdGVuY2UtZmlsdGVyLW1pc21hdGNoXCI7XG5cbiAgICAgICAgICBjYXNlIFwiVGFyZ2V0UHVycG9zZUV4aXN0ZW5jZUZpbHRlck1pc21hdGNoQmxvb21cIiAvKiBUYXJnZXRQdXJwb3NlLkV4aXN0ZW5jZUZpbHRlck1pc21hdGNoQmxvb20gKi8gOlxuICAgICAgICAgICAgcmV0dXJuIFwiZXhpc3RlbmNlLWZpbHRlci1taXNtYXRjaC1ibG9vbVwiO1xuXG4gICAgICAgICAgY2FzZSBcIlRhcmdldFB1cnBvc2VMaW1ib1Jlc29sdXRpb25cIiAvKiBUYXJnZXRQdXJwb3NlLkxpbWJvUmVzb2x1dGlvbiAqLyA6XG4gICAgICAgICAgICByZXR1cm4gXCJsaW1iby1kb2N1bWVudFwiO1xuXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBmYWlsKDI4OTg3LCB7XG4gICAgICAgICAgICAgICAgcHVycG9zZTogZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KHQucHVycG9zZSk7XG4gICAgcmV0dXJuIG51bGwgPT0gbiA/IG51bGwgOiB7XG4gICAgICAgIFwiZ29vZy1saXN0ZW4tdGFnc1wiOiBuXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2Zyb21GaWx0ZXIoZSkge1xuICAgIHJldHVybiB2b2lkIDAgIT09IGUudW5hcnlGaWx0ZXIgPyBmdW5jdGlvbiBfX1BSSVZBVEVfZnJvbVVuYXJ5RmlsdGVyKGUpIHtcbiAgICAgICAgc3dpdGNoIChlLnVuYXJ5RmlsdGVyLm9wKSB7XG4gICAgICAgICAgY2FzZSBcIklTX05BTlwiOlxuICAgICAgICAgICAgY29uc3QgdCA9IF9fUFJJVkFURV9mcm9tRmllbGRQYXRoUmVmZXJlbmNlKGUudW5hcnlGaWx0ZXIuZmllbGQpO1xuICAgICAgICAgICAgcmV0dXJuIEZpZWxkRmlsdGVyLmNyZWF0ZSh0LCBcIj09XCIgLyogT3BlcmF0b3IuRVFVQUwgKi8gLCB7XG4gICAgICAgICAgICAgICAgZG91YmxlVmFsdWU6IE5hTlxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICBjYXNlIFwiSVNfTlVMTFwiOlxuICAgICAgICAgICAgY29uc3QgbiA9IF9fUFJJVkFURV9mcm9tRmllbGRQYXRoUmVmZXJlbmNlKGUudW5hcnlGaWx0ZXIuZmllbGQpO1xuICAgICAgICAgICAgcmV0dXJuIEZpZWxkRmlsdGVyLmNyZWF0ZShuLCBcIj09XCIgLyogT3BlcmF0b3IuRVFVQUwgKi8gLCB7XG4gICAgICAgICAgICAgICAgbnVsbFZhbHVlOiBcIk5VTExfVkFMVUVcIlxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICBjYXNlIFwiSVNfTk9UX05BTlwiOlxuICAgICAgICAgICAgY29uc3QgciA9IF9fUFJJVkFURV9mcm9tRmllbGRQYXRoUmVmZXJlbmNlKGUudW5hcnlGaWx0ZXIuZmllbGQpO1xuICAgICAgICAgICAgcmV0dXJuIEZpZWxkRmlsdGVyLmNyZWF0ZShyLCBcIiE9XCIgLyogT3BlcmF0b3IuTk9UX0VRVUFMICovICwge1xuICAgICAgICAgICAgICAgIGRvdWJsZVZhbHVlOiBOYU5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgY2FzZSBcIklTX05PVF9OVUxMXCI6XG4gICAgICAgICAgICBjb25zdCBpID0gX19QUklWQVRFX2Zyb21GaWVsZFBhdGhSZWZlcmVuY2UoZS51bmFyeUZpbHRlci5maWVsZCk7XG4gICAgICAgICAgICByZXR1cm4gRmllbGRGaWx0ZXIuY3JlYXRlKGksIFwiIT1cIiAvKiBPcGVyYXRvci5OT1RfRVFVQUwgKi8gLCB7XG4gICAgICAgICAgICAgICAgbnVsbFZhbHVlOiBcIk5VTExfVkFMVUVcIlxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICBjYXNlIFwiT1BFUkFUT1JfVU5TUEVDSUZJRURcIjpcbiAgICAgICAgICAgIHJldHVybiBmYWlsKDYxMzEzKTtcblxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gZmFpbCg2MDcyNik7XG4gICAgICAgIH1cbiAgICB9KGUpIDogdm9pZCAwICE9PSBlLmZpZWxkRmlsdGVyID8gZnVuY3Rpb24gX19QUklWQVRFX2Zyb21GaWVsZEZpbHRlcihlKSB7XG4gICAgICAgIHJldHVybiBGaWVsZEZpbHRlci5jcmVhdGUoX19QUklWQVRFX2Zyb21GaWVsZFBhdGhSZWZlcmVuY2UoZS5maWVsZEZpbHRlci5maWVsZCksIGZ1bmN0aW9uIF9fUFJJVkFURV9mcm9tT3BlcmF0b3JOYW1lKGUpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoZSkge1xuICAgICAgICAgICAgICBjYXNlIFwiRVFVQUxcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCI9PVwiIC8qIE9wZXJhdG9yLkVRVUFMICovO1xuXG4gICAgICAgICAgICAgIGNhc2UgXCJOT1RfRVFVQUxcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCIhPVwiIC8qIE9wZXJhdG9yLk5PVF9FUVVBTCAqLztcblxuICAgICAgICAgICAgICBjYXNlIFwiR1JFQVRFUl9USEFOXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiPlwiIC8qIE9wZXJhdG9yLkdSRUFURVJfVEhBTiAqLztcblxuICAgICAgICAgICAgICBjYXNlIFwiR1JFQVRFUl9USEFOX09SX0VRVUFMXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiPj1cIiAvKiBPcGVyYXRvci5HUkVBVEVSX1RIQU5fT1JfRVFVQUwgKi87XG5cbiAgICAgICAgICAgICAgY2FzZSBcIkxFU1NfVEhBTlwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcIjxcIiAvKiBPcGVyYXRvci5MRVNTX1RIQU4gKi87XG5cbiAgICAgICAgICAgICAgY2FzZSBcIkxFU1NfVEhBTl9PUl9FUVVBTFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcIjw9XCIgLyogT3BlcmF0b3IuTEVTU19USEFOX09SX0VRVUFMICovO1xuXG4gICAgICAgICAgICAgIGNhc2UgXCJBUlJBWV9DT05UQUlOU1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcImFycmF5LWNvbnRhaW5zXCIgLyogT3BlcmF0b3IuQVJSQVlfQ09OVEFJTlMgKi87XG5cbiAgICAgICAgICAgICAgY2FzZSBcIklOXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiaW5cIiAvKiBPcGVyYXRvci5JTiAqLztcblxuICAgICAgICAgICAgICBjYXNlIFwiTk9UX0lOXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwibm90LWluXCIgLyogT3BlcmF0b3IuTk9UX0lOICovO1xuXG4gICAgICAgICAgICAgIGNhc2UgXCJBUlJBWV9DT05UQUlOU19BTllcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBPcGVyYXRvci5BUlJBWV9DT05UQUlOU19BTlkgKi87XG5cbiAgICAgICAgICAgICAgY2FzZSBcIk9QRVJBVE9SX1VOU1BFQ0lGSUVEXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhaWwoNTgxMTApO1xuXG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhaWwoNTA1MDYpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KGUuZmllbGRGaWx0ZXIub3ApLCBlLmZpZWxkRmlsdGVyLnZhbHVlKTtcbiAgICB9KGUpIDogdm9pZCAwICE9PSBlLmNvbXBvc2l0ZUZpbHRlciA/IGZ1bmN0aW9uIF9fUFJJVkFURV9mcm9tQ29tcG9zaXRlRmlsdGVyKGUpIHtcbiAgICAgICAgcmV0dXJuIENvbXBvc2l0ZUZpbHRlci5jcmVhdGUoZS5jb21wb3NpdGVGaWx0ZXIuZmlsdGVycy5tYXAoKGUgPT4gX19QUklWQVRFX2Zyb21GaWx0ZXIoZSkpKSwgZnVuY3Rpb24gX19QUklWQVRFX2Zyb21Db21wb3NpdGVPcGVyYXRvck5hbWUoZSkge1xuICAgICAgICAgICAgc3dpdGNoIChlKSB7XG4gICAgICAgICAgICAgIGNhc2UgXCJBTkRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJhbmRcIiAvKiBDb21wb3NpdGVPcGVyYXRvci5BTkQgKi87XG5cbiAgICAgICAgICAgICAgY2FzZSBcIk9SXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwib3JcIiAvKiBDb21wb3NpdGVPcGVyYXRvci5PUiAqLztcblxuICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBmYWlsKDEwMjYpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KGUuY29tcG9zaXRlRmlsdGVyLm9wKSk7XG4gICAgfShlKSA6IGZhaWwoMzAwOTcsIHtcbiAgICAgICAgZmlsdGVyOiBlXG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV90b0RpcmVjdGlvbihlKSB7XG4gICAgcmV0dXJuIGJ0W2VdO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfdG9PcGVyYXRvck5hbWUoZSkge1xuICAgIHJldHVybiBEdFtlXTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX3RvQ29tcG9zaXRlT3BlcmF0b3JOYW1lKGUpIHtcbiAgICByZXR1cm4gQ3RbZV07XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV90b0ZpZWxkUGF0aFJlZmVyZW5jZShlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZmllbGRQYXRoOiBlLmNhbm9uaWNhbFN0cmluZygpXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2Zyb21GaWVsZFBhdGhSZWZlcmVuY2UoZSkge1xuICAgIHJldHVybiBGaWVsZFBhdGgkMS5mcm9tU2VydmVyRm9ybWF0KGUuZmllbGRQYXRoKTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX3RvRmlsdGVyKGUpIHtcbiAgICByZXR1cm4gZSBpbnN0YW5jZW9mIEZpZWxkRmlsdGVyID8gZnVuY3Rpb24gX19QUklWQVRFX3RvVW5hcnlPckZpZWxkRmlsdGVyKGUpIHtcbiAgICAgICAgaWYgKFwiPT1cIiAvKiBPcGVyYXRvci5FUVVBTCAqLyA9PT0gZS5vcCkge1xuICAgICAgICAgICAgaWYgKF9fUFJJVkFURV9pc05hblZhbHVlKGUudmFsdWUpKSByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHVuYXJ5RmlsdGVyOiB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkOiBfX1BSSVZBVEVfdG9GaWVsZFBhdGhSZWZlcmVuY2UoZS5maWVsZCksXG4gICAgICAgICAgICAgICAgICAgIG9wOiBcIklTX05BTlwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmIChfX1BSSVZBVEVfaXNOdWxsVmFsdWUoZS52YWx1ZSkpIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdW5hcnlGaWx0ZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGQ6IF9fUFJJVkFURV90b0ZpZWxkUGF0aFJlZmVyZW5jZShlLmZpZWxkKSxcbiAgICAgICAgICAgICAgICAgICAgb3A6IFwiSVNfTlVMTFwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIGlmIChcIiE9XCIgLyogT3BlcmF0b3IuTk9UX0VRVUFMICovID09PSBlLm9wKSB7XG4gICAgICAgICAgICBpZiAoX19QUklWQVRFX2lzTmFuVmFsdWUoZS52YWx1ZSkpIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdW5hcnlGaWx0ZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGQ6IF9fUFJJVkFURV90b0ZpZWxkUGF0aFJlZmVyZW5jZShlLmZpZWxkKSxcbiAgICAgICAgICAgICAgICAgICAgb3A6IFwiSVNfTk9UX05BTlwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmIChfX1BSSVZBVEVfaXNOdWxsVmFsdWUoZS52YWx1ZSkpIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdW5hcnlGaWx0ZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGQ6IF9fUFJJVkFURV90b0ZpZWxkUGF0aFJlZmVyZW5jZShlLmZpZWxkKSxcbiAgICAgICAgICAgICAgICAgICAgb3A6IFwiSVNfTk9UX05VTExcIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpZWxkRmlsdGVyOiB7XG4gICAgICAgICAgICAgICAgZmllbGQ6IF9fUFJJVkFURV90b0ZpZWxkUGF0aFJlZmVyZW5jZShlLmZpZWxkKSxcbiAgICAgICAgICAgICAgICBvcDogX19QUklWQVRFX3RvT3BlcmF0b3JOYW1lKGUub3ApLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBlLnZhbHVlXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfShlKSA6IGUgaW5zdGFuY2VvZiBDb21wb3NpdGVGaWx0ZXIgPyBmdW5jdGlvbiBfX1BSSVZBVEVfdG9Db21wb3NpdGVGaWx0ZXIoZSkge1xuICAgICAgICBjb25zdCB0ID0gZS5nZXRGaWx0ZXJzKCkubWFwKChlID0+IF9fUFJJVkFURV90b0ZpbHRlcihlKSkpO1xuICAgICAgICBpZiAoMSA9PT0gdC5sZW5ndGgpIHJldHVybiB0WzBdO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY29tcG9zaXRlRmlsdGVyOiB7XG4gICAgICAgICAgICAgICAgb3A6IF9fUFJJVkFURV90b0NvbXBvc2l0ZU9wZXJhdG9yTmFtZShlLm9wKSxcbiAgICAgICAgICAgICAgICBmaWx0ZXJzOiB0XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfShlKSA6IGZhaWwoNTQ4NzcsIHtcbiAgICAgICAgZmlsdGVyOiBlXG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV90b0RvY3VtZW50TWFzayhlKSB7XG4gICAgY29uc3QgdCA9IFtdO1xuICAgIHJldHVybiBlLmZpZWxkcy5mb3JFYWNoKChlID0+IHQucHVzaChlLmNhbm9uaWNhbFN0cmluZygpKSkpLCB7XG4gICAgICAgIGZpZWxkUGF0aHM6IHRcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfaXNWYWxpZFJlc291cmNlTmFtZShlKSB7XG4gICAgLy8gUmVzb3VyY2UgbmFtZXMgaGF2ZSBhdCBsZWFzdCA0IGNvbXBvbmVudHMgKHByb2plY3QgSUQsIGRhdGFiYXNlIElEKVxuICAgIHJldHVybiBlLmxlbmd0aCA+PSA0ICYmIFwicHJvamVjdHNcIiA9PT0gZS5nZXQoMCkgJiYgXCJkYXRhYmFzZXNcIiA9PT0gZS5nZXQoMik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEFuIGltbXV0YWJsZSBzZXQgb2YgbWV0YWRhdGEgdGhhdCB0aGUgbG9jYWwgc3RvcmUgdHJhY2tzIGZvciBlYWNoIHRhcmdldC5cbiAqLyBjbGFzcyBUYXJnZXREYXRhIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogVGhlIHRhcmdldCBiZWluZyBsaXN0ZW5lZCB0by4gKi9cbiAgICBlLCBcbiAgICAvKipcbiAgICAgKiBUaGUgdGFyZ2V0IElEIHRvIHdoaWNoIHRoZSB0YXJnZXQgY29ycmVzcG9uZHM7IEFzc2lnbmVkIGJ5IHRoZVxuICAgICAqIExvY2FsU3RvcmUgZm9yIHVzZXIgbGlzdGVucyBhbmQgYnkgdGhlIFN5bmNFbmdpbmUgZm9yIGxpbWJvIHdhdGNoZXMuXG4gICAgICovXG4gICAgdCwgXG4gICAgLyoqIFRoZSBwdXJwb3NlIG9mIHRoZSB0YXJnZXQuICovXG4gICAgbiwgXG4gICAgLyoqXG4gICAgICogVGhlIHNlcXVlbmNlIG51bWJlciBvZiB0aGUgbGFzdCB0cmFuc2FjdGlvbiBkdXJpbmcgd2hpY2ggdGhpcyB0YXJnZXQgZGF0YVxuICAgICAqIHdhcyBtb2RpZmllZC5cbiAgICAgKi9cbiAgICByLCBcbiAgICAvKiogVGhlIGxhdGVzdCBzbmFwc2hvdCB2ZXJzaW9uIHNlZW4gZm9yIHRoaXMgdGFyZ2V0LiAqL1xuICAgIGkgPSBTbmFwc2hvdFZlcnNpb24ubWluKClcbiAgICAvKipcbiAgICAgKiBUaGUgbWF4aW11bSBzbmFwc2hvdCB2ZXJzaW9uIGF0IHdoaWNoIHRoZSBhc3NvY2lhdGVkIHZpZXdcbiAgICAgKiBjb250YWluZWQgbm8gbGltYm8gZG9jdW1lbnRzLlxuICAgICAqLyAsIHMgPSBTbmFwc2hvdFZlcnNpb24ubWluKClcbiAgICAvKipcbiAgICAgKiBBbiBvcGFxdWUsIHNlcnZlci1hc3NpZ25lZCB0b2tlbiB0aGF0IGFsbG93cyB3YXRjaGluZyBhIHRhcmdldCB0byBiZVxuICAgICAqIHJlc3VtZWQgYWZ0ZXIgZGlzY29ubmVjdGluZyB3aXRob3V0IHJldHJhbnNtaXR0aW5nIGFsbCB0aGUgZGF0YSB0aGF0XG4gICAgICogbWF0Y2hlcyB0aGUgdGFyZ2V0LiBUaGUgcmVzdW1lIHRva2VuIGVzc2VudGlhbGx5IGlkZW50aWZpZXMgYSBwb2ludCBpblxuICAgICAqIHRpbWUgZnJvbSB3aGljaCB0aGUgc2VydmVyIHNob3VsZCByZXN1bWUgc2VuZGluZyByZXN1bHRzLlxuICAgICAqLyAsIG8gPSBCeXRlU3RyaW5nLkVNUFRZX0JZVEVfU1RSSU5HXG4gICAgLyoqXG4gICAgICogVGhlIG51bWJlciBvZiBkb2N1bWVudHMgdGhhdCBsYXN0IG1hdGNoZWQgdGhlIHF1ZXJ5IGF0IHRoZSByZXN1bWUgdG9rZW4gb3JcbiAgICAgKiByZWFkIHRpbWUuIERvY3VtZW50cyBhcmUgY291bnRlZCBvbmx5IHdoZW4gbWFraW5nIGEgbGlzdGVuIHJlcXVlc3Qgd2l0aFxuICAgICAqIHJlc3VtZSB0b2tlbiBvciByZWFkIHRpbWUsIG90aGVyd2lzZSwga2VlcCBpdCBudWxsLlxuICAgICAqLyAsIF8gPSBudWxsKSB7XG4gICAgICAgIHRoaXMudGFyZ2V0ID0gZSwgdGhpcy50YXJnZXRJZCA9IHQsIHRoaXMucHVycG9zZSA9IG4sIHRoaXMuc2VxdWVuY2VOdW1iZXIgPSByLCB0aGlzLnNuYXBzaG90VmVyc2lvbiA9IGksIFxuICAgICAgICB0aGlzLmxhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24gPSBzLCB0aGlzLnJlc3VtZVRva2VuID0gbywgdGhpcy5leHBlY3RlZENvdW50ID0gXztcbiAgICB9XG4gICAgLyoqIENyZWF0ZXMgYSBuZXcgdGFyZ2V0IGRhdGEgaW5zdGFuY2Ugd2l0aCBhbiB1cGRhdGVkIHNlcXVlbmNlIG51bWJlci4gKi8gICAgd2l0aFNlcXVlbmNlTnVtYmVyKGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUYXJnZXREYXRhKHRoaXMudGFyZ2V0LCB0aGlzLnRhcmdldElkLCB0aGlzLnB1cnBvc2UsIGUsIHRoaXMuc25hcHNob3RWZXJzaW9uLCB0aGlzLmxhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24sIHRoaXMucmVzdW1lVG9rZW4sIHRoaXMuZXhwZWN0ZWRDb3VudCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgdGFyZ2V0IGRhdGEgaW5zdGFuY2Ugd2l0aCBhbiB1cGRhdGVkIHJlc3VtZSB0b2tlbiBhbmRcbiAgICAgKiBzbmFwc2hvdCB2ZXJzaW9uLlxuICAgICAqLyAgICB3aXRoUmVzdW1lVG9rZW4oZSwgdCkge1xuICAgICAgICByZXR1cm4gbmV3IFRhcmdldERhdGEodGhpcy50YXJnZXQsIHRoaXMudGFyZ2V0SWQsIHRoaXMucHVycG9zZSwgdGhpcy5zZXF1ZW5jZU51bWJlciwgdCwgdGhpcy5sYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uLCBlLCBcbiAgICAgICAgLyogZXhwZWN0ZWRDb3VudD0gKi8gbnVsbCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgdGFyZ2V0IGRhdGEgaW5zdGFuY2Ugd2l0aCBhbiB1cGRhdGVkIGV4cGVjdGVkIGNvdW50LlxuICAgICAqLyAgICB3aXRoRXhwZWN0ZWRDb3VudChlKSB7XG4gICAgICAgIHJldHVybiBuZXcgVGFyZ2V0RGF0YSh0aGlzLnRhcmdldCwgdGhpcy50YXJnZXRJZCwgdGhpcy5wdXJwb3NlLCB0aGlzLnNlcXVlbmNlTnVtYmVyLCB0aGlzLnNuYXBzaG90VmVyc2lvbiwgdGhpcy5sYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uLCB0aGlzLnJlc3VtZVRva2VuLCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyB0YXJnZXQgZGF0YSBpbnN0YW5jZSB3aXRoIGFuIHVwZGF0ZWQgbGFzdCBsaW1ibyBmcmVlXG4gICAgICogc25hcHNob3QgdmVyc2lvbiBudW1iZXIuXG4gICAgICovICAgIHdpdGhMYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uKGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUYXJnZXREYXRhKHRoaXMudGFyZ2V0LCB0aGlzLnRhcmdldElkLCB0aGlzLnB1cnBvc2UsIHRoaXMuc2VxdWVuY2VOdW1iZXIsIHRoaXMuc25hcHNob3RWZXJzaW9uLCBlLCB0aGlzLnJlc3VtZVRva2VuLCB0aGlzLmV4cGVjdGVkQ291bnQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBTZXJpYWxpemVyIGZvciB2YWx1ZXMgc3RvcmVkIGluIHRoZSBMb2NhbFN0b3JlLiAqLyBjbGFzcyBfX1BSSVZBVEVfTG9jYWxTZXJpYWxpemVyIHtcbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHRoaXMueXQgPSBlO1xuICAgIH1cbn1cblxuLyoqIERlY29kZXMgYSByZW1vdGUgZG9jdW1lbnQgZnJvbSBzdG9yYWdlIGxvY2FsbHkgdG8gYSBEb2N1bWVudC4gKi8gZnVuY3Rpb24gX19QUklWQVRFX2Zyb21EYlJlbW90ZURvY3VtZW50KGUsIHQpIHtcbiAgICBsZXQgbjtcbiAgICBpZiAodC5kb2N1bWVudCkgbiA9IF9fUFJJVkFURV9mcm9tRG9jdW1lbnQoZS55dCwgdC5kb2N1bWVudCwgISF0Lmhhc0NvbW1pdHRlZE11dGF0aW9ucyk7IGVsc2UgaWYgKHQubm9Eb2N1bWVudCkge1xuICAgICAgICBjb25zdCBlID0gRG9jdW1lbnRLZXkuZnJvbVNlZ21lbnRzKHQubm9Eb2N1bWVudC5wYXRoKSwgciA9IF9fUFJJVkFURV9mcm9tRGJUaW1lc3RhbXAodC5ub0RvY3VtZW50LnJlYWRUaW1lKTtcbiAgICAgICAgbiA9IE11dGFibGVEb2N1bWVudC5uZXdOb0RvY3VtZW50KGUsIHIpLCB0Lmhhc0NvbW1pdHRlZE11dGF0aW9ucyAmJiBuLnNldEhhc0NvbW1pdHRlZE11dGF0aW9ucygpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghdC51bmtub3duRG9jdW1lbnQpIHJldHVybiBmYWlsKDU2NzA5KTtcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgZSA9IERvY3VtZW50S2V5LmZyb21TZWdtZW50cyh0LnVua25vd25Eb2N1bWVudC5wYXRoKSwgciA9IF9fUFJJVkFURV9mcm9tRGJUaW1lc3RhbXAodC51bmtub3duRG9jdW1lbnQudmVyc2lvbik7XG4gICAgICAgICAgICBuID0gTXV0YWJsZURvY3VtZW50Lm5ld1Vua25vd25Eb2N1bWVudChlLCByKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdC5yZWFkVGltZSAmJiBuLnNldFJlYWRUaW1lKGZ1bmN0aW9uIF9fUFJJVkFURV9mcm9tRGJUaW1lc3RhbXBLZXkoZSkge1xuICAgICAgICBjb25zdCB0ID0gbmV3IFRpbWVzdGFtcChlWzBdLCBlWzFdKTtcbiAgICAgICAgcmV0dXJuIFNuYXBzaG90VmVyc2lvbi5mcm9tVGltZXN0YW1wKHQpO1xuICAgIH0odC5yZWFkVGltZSkpLCBuO1xufVxuXG4vKiogRW5jb2RlcyBhIGRvY3VtZW50IGZvciBzdG9yYWdlIGxvY2FsbHkuICovIGZ1bmN0aW9uIF9fUFJJVkFURV90b0RiUmVtb3RlRG9jdW1lbnQoZSwgdCkge1xuICAgIGNvbnN0IG4gPSB0LmtleSwgciA9IHtcbiAgICAgICAgcHJlZml4UGF0aDogbi5nZXRDb2xsZWN0aW9uUGF0aCgpLnBvcExhc3QoKS50b0FycmF5KCksXG4gICAgICAgIGNvbGxlY3Rpb25Hcm91cDogbi5jb2xsZWN0aW9uR3JvdXAsXG4gICAgICAgIGRvY3VtZW50SWQ6IG4ucGF0aC5sYXN0U2VnbWVudCgpLFxuICAgICAgICByZWFkVGltZTogX19QUklWQVRFX3RvRGJUaW1lc3RhbXBLZXkodC5yZWFkVGltZSksXG4gICAgICAgIGhhc0NvbW1pdHRlZE11dGF0aW9uczogdC5oYXNDb21taXR0ZWRNdXRhdGlvbnNcbiAgICB9O1xuICAgIGlmICh0LmlzRm91bmREb2N1bWVudCgpKSByLmRvY3VtZW50ID0gZnVuY3Rpb24gX19QUklWQVRFX3RvRG9jdW1lbnQoZSwgdCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmFtZTogX19QUklWQVRFX3RvTmFtZShlLCB0LmtleSksXG4gICAgICAgICAgICBmaWVsZHM6IHQuZGF0YS52YWx1ZS5tYXBWYWx1ZS5maWVsZHMsXG4gICAgICAgICAgICB1cGRhdGVUaW1lOiB0b1RpbWVzdGFtcChlLCB0LnZlcnNpb24udG9UaW1lc3RhbXAoKSksXG4gICAgICAgICAgICBjcmVhdGVUaW1lOiB0b1RpbWVzdGFtcChlLCB0LmNyZWF0ZVRpbWUudG9UaW1lc3RhbXAoKSlcbiAgICAgICAgfTtcbiAgICB9KGUueXQsIHQpOyBlbHNlIGlmICh0LmlzTm9Eb2N1bWVudCgpKSByLm5vRG9jdW1lbnQgPSB7XG4gICAgICAgIHBhdGg6IG4ucGF0aC50b0FycmF5KCksXG4gICAgICAgIHJlYWRUaW1lOiBfX1BSSVZBVEVfdG9EYlRpbWVzdGFtcCh0LnZlcnNpb24pXG4gICAgfTsgZWxzZSB7XG4gICAgICAgIGlmICghdC5pc1Vua25vd25Eb2N1bWVudCgpKSByZXR1cm4gZmFpbCg1NzkwNCwge1xuICAgICAgICAgICAgZG9jdW1lbnQ6IHRcbiAgICAgICAgfSk7XG4gICAgICAgIHIudW5rbm93bkRvY3VtZW50ID0ge1xuICAgICAgICAgICAgcGF0aDogbi5wYXRoLnRvQXJyYXkoKSxcbiAgICAgICAgICAgIHZlcnNpb246IF9fUFJJVkFURV90b0RiVGltZXN0YW1wKHQudmVyc2lvbilcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHI7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV90b0RiVGltZXN0YW1wS2V5KGUpIHtcbiAgICBjb25zdCB0ID0gZS50b1RpbWVzdGFtcCgpO1xuICAgIHJldHVybiBbIHQuc2Vjb25kcywgdC5uYW5vc2Vjb25kcyBdO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfdG9EYlRpbWVzdGFtcChlKSB7XG4gICAgY29uc3QgdCA9IGUudG9UaW1lc3RhbXAoKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBzZWNvbmRzOiB0LnNlY29uZHMsXG4gICAgICAgIG5hbm9zZWNvbmRzOiB0Lm5hbm9zZWNvbmRzXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2Zyb21EYlRpbWVzdGFtcChlKSB7XG4gICAgY29uc3QgdCA9IG5ldyBUaW1lc3RhbXAoZS5zZWNvbmRzLCBlLm5hbm9zZWNvbmRzKTtcbiAgICByZXR1cm4gU25hcHNob3RWZXJzaW9uLmZyb21UaW1lc3RhbXAodCk7XG59XG5cbi8qKiBFbmNvZGVzIGEgYmF0Y2ggb2YgbXV0YXRpb25zIGludG8gYSBEYk11dGF0aW9uQmF0Y2ggZm9yIGxvY2FsIHN0b3JhZ2UuICovXG4vKiogRGVjb2RlcyBhIERiTXV0YXRpb25CYXRjaCBpbnRvIGEgTXV0YXRpb25CYXRjaCAqL1xuZnVuY3Rpb24gX19QUklWQVRFX2Zyb21EYk11dGF0aW9uQmF0Y2goZSwgdCkge1xuICAgIGNvbnN0IG4gPSAodC5iYXNlTXV0YXRpb25zIHx8IFtdKS5tYXAoKHQgPT4gX19QUklWQVRFX2Zyb21NdXRhdGlvbihlLnl0LCB0KSkpO1xuICAgIC8vIFNxdWFzaCBvbGQgdHJhbnNmb3JtIG11dGF0aW9ucyBpbnRvIGV4aXN0aW5nIHBhdGNoIG9yIHNldCBtdXRhdGlvbnMuXG4gICAgLy8gVGhlIHJlcGxhY2VtZW50IG9mIHJlcHJlc2VudGluZyBgdHJhbnNmb3Jtc2Agd2l0aCBgdXBkYXRlX3RyYW5zZm9ybXNgXG4gICAgLy8gb24gdGhlIFNESyBtZWFucyB0aGF0IG9sZCBgdHJhbnNmb3JtYCBtdXRhdGlvbnMgc3RvcmVkIGluIEluZGV4ZWREQiBuZWVkXG4gICAgLy8gdG8gYmUgdXBkYXRlZCB0byBgdXBkYXRlX3RyYW5zZm9ybXNgLlxuICAgIC8vIFRPRE8oYi8xNzQ2MDgzNzQpOiBSZW1vdmUgdGhpcyBjb2RlIG9uY2Ugd2UgcGVyZm9ybSBhIHNjaGVtYSBtaWdyYXRpb24uXG4gICAgICAgIGZvciAobGV0IGUgPSAwOyBlIDwgdC5tdXRhdGlvbnMubGVuZ3RoIC0gMTsgKytlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0Lm11dGF0aW9uc1tlXTtcbiAgICAgICAgaWYgKGUgKyAxIDwgdC5tdXRhdGlvbnMubGVuZ3RoICYmIHZvaWQgMCAhPT0gdC5tdXRhdGlvbnNbZSArIDFdLnRyYW5zZm9ybSkge1xuICAgICAgICAgICAgY29uc3QgciA9IHQubXV0YXRpb25zW2UgKyAxXTtcbiAgICAgICAgICAgIG4udXBkYXRlVHJhbnNmb3JtcyA9IHIudHJhbnNmb3JtLmZpZWxkVHJhbnNmb3JtcywgdC5tdXRhdGlvbnMuc3BsaWNlKGUgKyAxLCAxKSwgXG4gICAgICAgICAgICArK2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgciA9IHQubXV0YXRpb25zLm1hcCgodCA9PiBfX1BSSVZBVEVfZnJvbU11dGF0aW9uKGUueXQsIHQpKSksIGkgPSBUaW1lc3RhbXAuZnJvbU1pbGxpcyh0LmxvY2FsV3JpdGVUaW1lTXMpO1xuICAgIHJldHVybiBuZXcgTXV0YXRpb25CYXRjaCh0LmJhdGNoSWQsIGksIG4sIHIpO1xufVxuXG4vKiogRGVjb2RlcyBhIERiVGFyZ2V0IGludG8gVGFyZ2V0RGF0YSAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfZnJvbURiVGFyZ2V0KGUpIHtcbiAgICBjb25zdCB0ID0gX19QUklWQVRFX2Zyb21EYlRpbWVzdGFtcChlLnJlYWRUaW1lKSwgbiA9IHZvaWQgMCAhPT0gZS5sYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uID8gX19QUklWQVRFX2Zyb21EYlRpbWVzdGFtcChlLmxhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24pIDogU25hcHNob3RWZXJzaW9uLm1pbigpO1xuICAgIGxldCByO1xuICAgIHJldHVybiByID0gXG4gICAgLyoqXG4gKiBBIGhlbHBlciBmdW5jdGlvbiBmb3IgZmlndXJpbmcgb3V0IHdoYXQga2luZCBvZiBxdWVyeSBoYXMgYmVlbiBzdG9yZWQuXG4gKi9cbiAgICBmdW5jdGlvbiBfX1BSSVZBVEVfaXNEb2N1bWVudFF1ZXJ5KGUpIHtcbiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gZS5kb2N1bWVudHM7XG4gICAgfVxuICAgIC8qKiBFbmNvZGVzIGEgRGJCdW5kbGUgdG8gYSBCdW5kbGVNZXRhZGF0YSBvYmplY3QuICovIChlLnF1ZXJ5KSA/IGZ1bmN0aW9uIF9fUFJJVkFURV9mcm9tRG9jdW1lbnRzVGFyZ2V0KGUpIHtcbiAgICAgICAgY29uc3QgdCA9IGUuZG9jdW1lbnRzLmxlbmd0aDtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9oYXJkQXNzZXJ0KDEgPT09IHQsIDE5NjYsIHtcbiAgICAgICAgICAgIGNvdW50OiB0XG4gICAgICAgIH0pLCBfX1BSSVZBVEVfcXVlcnlUb1RhcmdldChfX1BSSVZBVEVfbmV3UXVlcnlGb3JQYXRoKF9fUFJJVkFURV9mcm9tUXVlcnlQYXRoKGUuZG9jdW1lbnRzWzBdKSkpO1xuICAgIH0oZS5xdWVyeSkgOiBmdW5jdGlvbiBfX1BSSVZBVEVfZnJvbVF1ZXJ5VGFyZ2V0KGUpIHtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9xdWVyeVRvVGFyZ2V0KF9fUFJJVkFURV9jb252ZXJ0UXVlcnlUYXJnZXRUb1F1ZXJ5KGUpKTtcbiAgICB9KGUucXVlcnkpLCBuZXcgVGFyZ2V0RGF0YShyLCBlLnRhcmdldElkLCBcIlRhcmdldFB1cnBvc2VMaXN0ZW5cIiAvKiBUYXJnZXRQdXJwb3NlLkxpc3RlbiAqLyAsIGUubGFzdExpc3RlblNlcXVlbmNlTnVtYmVyLCB0LCBuLCBCeXRlU3RyaW5nLmZyb21CYXNlNjRTdHJpbmcoZS5yZXN1bWVUb2tlbikpO1xufVxuXG4vKiogRW5jb2RlcyBUYXJnZXREYXRhIGludG8gYSBEYlRhcmdldCBmb3Igc3RvcmFnZSBsb2NhbGx5LiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfdG9EYlRhcmdldChlLCB0KSB7XG4gICAgY29uc3QgbiA9IF9fUFJJVkFURV90b0RiVGltZXN0YW1wKHQuc25hcHNob3RWZXJzaW9uKSwgciA9IF9fUFJJVkFURV90b0RiVGltZXN0YW1wKHQubGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbik7XG4gICAgbGV0IGk7XG4gICAgaSA9IF9fUFJJVkFURV90YXJnZXRJc0RvY3VtZW50VGFyZ2V0KHQudGFyZ2V0KSA/IF9fUFJJVkFURV90b0RvY3VtZW50c1RhcmdldChlLnl0LCB0LnRhcmdldCkgOiBfX1BSSVZBVEVfdG9RdWVyeVRhcmdldChlLnl0LCB0LnRhcmdldCkuZnQ7XG4gICAgLy8gV2UgY2FuJ3Qgc3RvcmUgdGhlIHJlc3VtZVRva2VuIGFzIGEgQnl0ZVN0cmluZyBpbiBJbmRleGVkRGIsIHNvIHdlXG4gICAgLy8gY29udmVydCBpdCB0byBhIGJhc2U2NCBzdHJpbmcgZm9yIHN0b3JhZ2UuXG4gICAgICAgIGNvbnN0IHMgPSB0LnJlc3VtZVRva2VuLnRvQmFzZTY0KCk7XG4gICAgLy8gbGFzdExpc3RlblNlcXVlbmNlTnVtYmVyIGlzIGFsd2F5cyAwIHVudGlsIHdlIGRvIHJlYWwgR0MuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgIHRhcmdldElkOiB0LnRhcmdldElkLFxuICAgICAgICBjYW5vbmljYWxJZDogX19QUklWQVRFX2Nhbm9uaWZ5VGFyZ2V0KHQudGFyZ2V0KSxcbiAgICAgICAgcmVhZFRpbWU6IG4sXG4gICAgICAgIHJlc3VtZVRva2VuOiBzLFxuICAgICAgICBsYXN0TGlzdGVuU2VxdWVuY2VOdW1iZXI6IHQuc2VxdWVuY2VOdW1iZXIsXG4gICAgICAgIGxhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb246IHIsXG4gICAgICAgIHF1ZXJ5OiBpXG4gICAgfTtcbn1cblxuLyoqXG4gKiBFbmNvZGVzIGEgYEJ1bmRsZWRRdWVyeWAgZnJvbSBidW5kbGUgcHJvdG8gdG8gYSBRdWVyeSBvYmplY3QuXG4gKlxuICogVGhpcyByZWNvbnN0cnVjdHMgdGhlIG9yaWdpbmFsIHF1ZXJ5IHVzZWQgdG8gYnVpbGQgdGhlIGJ1bmRsZSBiZWluZyBsb2FkZWQsXG4gKiBpbmNsdWRpbmcgZmVhdHVyZXMgZXhpc3RzIG9ubHkgaW4gU0RLcyAoZm9yIGV4YW1wbGU6IGxpbWl0LXRvLWxhc3QpLlxuICovXG5mdW5jdGlvbiBfX1BSSVZBVEVfZnJvbUJ1bmRsZWRRdWVyeShlKSB7XG4gICAgY29uc3QgdCA9IF9fUFJJVkFURV9jb252ZXJ0UXVlcnlUYXJnZXRUb1F1ZXJ5KHtcbiAgICAgICAgcGFyZW50OiBlLnBhcmVudCxcbiAgICAgICAgc3RydWN0dXJlZFF1ZXJ5OiBlLnN0cnVjdHVyZWRRdWVyeVxuICAgIH0pO1xuICAgIHJldHVybiBcIkxBU1RcIiA9PT0gZS5saW1pdFR5cGUgPyBfX1BSSVZBVEVfcXVlcnlXaXRoTGltaXQodCwgdC5saW1pdCwgXCJMXCIgLyogTGltaXRUeXBlLkxhc3QgKi8pIDogdDtcbn1cblxuLyoqIEVuY29kZXMgYSBOYW1lZFF1ZXJ5IHByb3RvIG9iamVjdCB0byBhIE5hbWVkUXVlcnkgbW9kZWwgb2JqZWN0LiAqL1xuLyoqIEVuY29kZXMgYSBEYkRvY3VtZW50T3ZlcmxheSBvYmplY3QgdG8gYW4gT3ZlcmxheSBtb2RlbCBvYmplY3QuICovXG5mdW5jdGlvbiBfX1BSSVZBVEVfZnJvbURiRG9jdW1lbnRPdmVybGF5KGUsIHQpIHtcbiAgICByZXR1cm4gbmV3IE92ZXJsYXkodC5sYXJnZXN0QmF0Y2hJZCwgX19QUklWQVRFX2Zyb21NdXRhdGlvbihlLnl0LCB0Lm92ZXJsYXlNdXRhdGlvbikpO1xufVxuXG4vKiogRGVjb2RlcyBhbiBPdmVybGF5IG1vZGVsIG9iamVjdCBpbnRvIGEgRGJEb2N1bWVudE92ZXJsYXkgb2JqZWN0LiAqL1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBEYkRvY3VtZW50T3ZlcmxheUtleSBjb3JyZXNwb25kaW5nIHRvIHRoZSBnaXZlbiB1c2VyIGFuZFxuICogZG9jdW1lbnQga2V5LlxuICovXG5mdW5jdGlvbiBfX1BSSVZBVEVfdG9EYkRvY3VtZW50T3ZlcmxheUtleShlLCB0KSB7XG4gICAgY29uc3QgbiA9IHQucGF0aC5sYXN0U2VnbWVudCgpO1xuICAgIHJldHVybiBbIGUsIF9fUFJJVkFURV9lbmNvZGVSZXNvdXJjZVBhdGgodC5wYXRoLnBvcExhc3QoKSksIG4gXTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX3RvRGJJbmRleFN0YXRlKGUsIHQsIG4sIHIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBpbmRleElkOiBlLFxuICAgICAgICB1aWQ6IHQsXG4gICAgICAgIHNlcXVlbmNlTnVtYmVyOiBuLFxuICAgICAgICByZWFkVGltZTogX19QUklWQVRFX3RvRGJUaW1lc3RhbXAoci5yZWFkVGltZSksXG4gICAgICAgIGRvY3VtZW50S2V5OiBfX1BSSVZBVEVfZW5jb2RlUmVzb3VyY2VQYXRoKHIuZG9jdW1lbnRLZXkucGF0aCksXG4gICAgICAgIGxhcmdlc3RCYXRjaElkOiByLmxhcmdlc3RCYXRjaElkXG4gICAgfTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgX19QUklWQVRFX0luZGV4ZWREYkJ1bmRsZUNhY2hlIHtcbiAgICBnZXRCdW5kbGVNZXRhZGF0YShlLCB0KSB7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfYnVuZGxlc1N0b3JlKGUpLmdldCh0KS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgIGlmIChlKSByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX2Zyb21EYkJ1bmRsZShlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGUuYnVuZGxlSWQsXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZVRpbWU6IF9fUFJJVkFURV9mcm9tRGJUaW1lc3RhbXAoZS5jcmVhdGVUaW1lKSxcbiAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogZS52ZXJzaW9uXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qKiBFbmNvZGVzIGEgQnVuZGxlTWV0YWRhdGEgdG8gYSBEYkJ1bmRsZS4gKi8gKGUpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHNhdmVCdW5kbGVNZXRhZGF0YShlLCB0KSB7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfYnVuZGxlc1N0b3JlKGUpLnB1dChmdW5jdGlvbiBfX1BSSVZBVEVfdG9EYkJ1bmRsZShlKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGJ1bmRsZUlkOiBlLmlkLFxuICAgICAgICAgICAgICAgIGNyZWF0ZVRpbWU6IF9fUFJJVkFURV90b0RiVGltZXN0YW1wKF9fUFJJVkFURV9mcm9tVmVyc2lvbihlLmNyZWF0ZVRpbWUpKSxcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBlLnZlcnNpb25cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgLyoqIEVuY29kZXMgYSBEYk5hbWVkUXVlcnkgdG8gYSBOYW1lZFF1ZXJ5LiAqLyAodCkpO1xuICAgIH1cbiAgICBnZXROYW1lZFF1ZXJ5KGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9uYW1lZFF1ZXJpZXNTdG9yZShlKS5nZXQodCkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICBpZiAoZSkgcmV0dXJuIGZ1bmN0aW9uIF9fUFJJVkFURV9mcm9tRGJOYW1lZFF1ZXJ5KGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5OiBfX1BSSVZBVEVfZnJvbUJ1bmRsZWRRdWVyeShlLmJ1bmRsZWRRdWVyeSksXG4gICAgICAgICAgICAgICAgICAgIHJlYWRUaW1lOiBfX1BSSVZBVEVfZnJvbURiVGltZXN0YW1wKGUucmVhZFRpbWUpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qKiBFbmNvZGVzIGEgTmFtZWRRdWVyeSBmcm9tIGEgYnVuZGxlIHByb3RvIHRvIGEgRGJOYW1lZFF1ZXJ5LiAqLyAoZSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgc2F2ZU5hbWVkUXVlcnkoZSwgdCkge1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX25hbWVkUXVlcmllc1N0b3JlKGUpLnB1dChmdW5jdGlvbiBfX1BSSVZBVEVfdG9EYk5hbWVkUXVlcnkoZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBuYW1lOiBlLm5hbWUsXG4gICAgICAgICAgICAgICAgcmVhZFRpbWU6IF9fUFJJVkFURV90b0RiVGltZXN0YW1wKF9fUFJJVkFURV9mcm9tVmVyc2lvbihlLnJlYWRUaW1lKSksXG4gICAgICAgICAgICAgICAgYnVuZGxlZFF1ZXJ5OiBlLmJ1bmRsZWRRdWVyeVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSh0KSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgYnVuZGxlcyBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX2J1bmRsZXNTdG9yZShlKSB7XG4gICAgcmV0dXJuIF9fUFJJVkFURV9nZXRTdG9yZShlLCBiZSk7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBuYW1lZFF1ZXJpZXMgb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9uYW1lZFF1ZXJpZXNTdG9yZShlKSB7XG4gICAgcmV0dXJuIF9fUFJJVkFURV9nZXRTdG9yZShlLCBDZSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEltcGxlbWVudGF0aW9uIG9mIERvY3VtZW50T3ZlcmxheUNhY2hlIHVzaW5nIEluZGV4ZWREYi5cbiAqLyBjbGFzcyBfX1BSSVZBVEVfSW5kZXhlZERiRG9jdW1lbnRPdmVybGF5Q2FjaGUge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSBzZXJpYWxpemVyIC0gVGhlIGRvY3VtZW50IHNlcmlhbGl6ZXIuXG4gICAgICogQHBhcmFtIHVzZXJJZCAtIFRoZSB1c2VySWQgZm9yIHdoaWNoIHdlIGFyZSBhY2Nlc3Npbmcgb3ZlcmxheXMuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICB0aGlzLnNlcmlhbGl6ZXIgPSBlLCB0aGlzLnVzZXJJZCA9IHQ7XG4gICAgfVxuICAgIHN0YXRpYyB3dChlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSB0LnVpZCB8fCBcIlwiO1xuICAgICAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9JbmRleGVkRGJEb2N1bWVudE92ZXJsYXlDYWNoZShlLCBuKTtcbiAgICB9XG4gICAgZ2V0T3ZlcmxheShlLCB0KSB7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfZG9jdW1lbnRPdmVybGF5U3RvcmUoZSkuZ2V0KF9fUFJJVkFURV90b0RiRG9jdW1lbnRPdmVybGF5S2V5KHRoaXMudXNlcklkLCB0KSkubmV4dCgoZSA9PiBlID8gX19QUklWQVRFX2Zyb21EYkRvY3VtZW50T3ZlcmxheSh0aGlzLnNlcmlhbGl6ZXIsIGUpIDogbnVsbCkpO1xuICAgIH1cbiAgICBnZXRPdmVybGF5cyhlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfbmV3T3ZlcmxheU1hcCgpO1xuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2godCwgKHQgPT4gdGhpcy5nZXRPdmVybGF5KGUsIHQpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgbnVsbCAhPT0gZSAmJiBuLnNldCh0LCBlKTtcbiAgICAgICAgfSkpKSkubmV4dCgoKCkgPT4gbikpO1xuICAgIH1cbiAgICBzYXZlT3ZlcmxheXMoZSwgdCwgbikge1xuICAgICAgICBjb25zdCByID0gW107XG4gICAgICAgIHJldHVybiBuLmZvckVhY2goKChuLCBpKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gbmV3IE92ZXJsYXkodCwgaSk7XG4gICAgICAgICAgICByLnB1c2godGhpcy5TdChlLCBzKSk7XG4gICAgICAgIH0pKSwgUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3Iocik7XG4gICAgfVxuICAgIHJlbW92ZU92ZXJsYXlzRm9yQmF0Y2hJZChlLCB0LCBuKSB7XG4gICAgICAgIGNvbnN0IHIgPSBuZXcgU2V0O1xuICAgICAgICAvLyBHZXQgdGhlIHNldCBvZiB1bmlxdWUgY29sbGVjdGlvbiBwYXRocy5cbiAgICAgICAgICAgICAgICB0LmZvckVhY2goKGUgPT4gci5hZGQoX19QUklWQVRFX2VuY29kZVJlc291cmNlUGF0aChlLmdldENvbGxlY3Rpb25QYXRoKCkpKSkpO1xuICAgICAgICBjb25zdCBpID0gW107XG4gICAgICAgIHJldHVybiByLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgciA9IElEQktleVJhbmdlLmJvdW5kKFsgdGhpcy51c2VySWQsIHQsIG4gXSwgWyB0aGlzLnVzZXJJZCwgdCwgbiArIDEgXSwgXG4gICAgICAgICAgICAvKmxvd2VyT3Blbj0qLyAhMSwgXG4gICAgICAgICAgICAvKnVwcGVyT3Blbj0qLyAhMCk7XG4gICAgICAgICAgICBpLnB1c2goX19QUklWQVRFX2RvY3VtZW50T3ZlcmxheVN0b3JlKGUpLlooR2UsIHIpKTtcbiAgICAgICAgfSkpLCBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihpKTtcbiAgICB9XG4gICAgZ2V0T3ZlcmxheXNGb3JDb2xsZWN0aW9uKGUsIHQsIG4pIHtcbiAgICAgICAgY29uc3QgciA9IF9fUFJJVkFURV9uZXdPdmVybGF5TWFwKCksIGkgPSBfX1BSSVZBVEVfZW5jb2RlUmVzb3VyY2VQYXRoKHQpLCBzID0gSURCS2V5UmFuZ2UuYm91bmQoWyB0aGlzLnVzZXJJZCwgaSwgbiBdLCBbIHRoaXMudXNlcklkLCBpLCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkgXSwgXG4gICAgICAgIC8qbG93ZXJPcGVuPSovICEwKTtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9kb2N1bWVudE92ZXJsYXlTdG9yZShlKS5KKEdlLCBzKS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IF9fUFJJVkFURV9mcm9tRGJEb2N1bWVudE92ZXJsYXkodGhpcy5zZXJpYWxpemVyLCB0KTtcbiAgICAgICAgICAgICAgICByLnNldChlLmdldEtleSgpLCBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldE92ZXJsYXlzRm9yQ29sbGVjdGlvbkdyb3VwKGUsIHQsIG4sIHIpIHtcbiAgICAgICAgY29uc3QgaSA9IF9fUFJJVkFURV9uZXdPdmVybGF5TWFwKCk7XG4gICAgICAgIGxldCBzO1xuICAgICAgICAvLyBXZSB3YW50IGJhdGNoIElEcyBsYXJnZXIgdGhhbiBgc2luY2VCYXRjaElkYCwgYW5kIHNvIHRoZSBsb3dlciBib3VuZFxuICAgICAgICAvLyBpcyBub3QgaW5jbHVzaXZlLlxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBJREJLZXlSYW5nZS5ib3VuZChbIHRoaXMudXNlcklkLCB0LCBuIF0sIFsgdGhpcy51c2VySWQsIHQsIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSBdLCBcbiAgICAgICAgLypsb3dlck9wZW49Ki8gITApO1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX2RvY3VtZW50T3ZlcmxheVN0b3JlKGUpLmVlKHtcbiAgICAgICAgICAgIGluZGV4OiBqZSxcbiAgICAgICAgICAgIHJhbmdlOiBvXG4gICAgICAgIH0sICgoZSwgdCwgbikgPT4ge1xuICAgICAgICAgICAgLy8gV2UgZG8gbm90IHdhbnQgdG8gcmV0dXJuIHBhcnRpYWwgYmF0Y2ggb3ZlcmxheXMsIGV2ZW4gaWYgdGhlIHNpemVcbiAgICAgICAgICAgIC8vIG9mIHRoZSByZXN1bHQgc2V0IGV4Y2VlZHMgdGhlIGdpdmVuIGBjb3VudGAgYXJndW1lbnQuIFRoZXJlZm9yZSwgd2VcbiAgICAgICAgICAgIC8vIGNvbnRpbnVlIHRvIGFnZ3JlZ2F0ZSByZXN1bHRzIGV2ZW4gYWZ0ZXIgdGhlIHJlc3VsdCBzaXplIGV4Y2VlZHNcbiAgICAgICAgICAgIC8vIGBjb3VudGAgaWYgdGhlcmUgYXJlIG1vcmUgb3ZlcmxheXMgZnJvbSB0aGUgYGN1cnJlbnRCYXRjaElkYC5cbiAgICAgICAgICAgIGNvbnN0IG8gPSBfX1BSSVZBVEVfZnJvbURiRG9jdW1lbnRPdmVybGF5KHRoaXMuc2VyaWFsaXplciwgdCk7XG4gICAgICAgICAgICBpLnNpemUoKSA8IHIgfHwgby5sYXJnZXN0QmF0Y2hJZCA9PT0gcyA/IChpLnNldChvLmdldEtleSgpLCBvKSwgcyA9IG8ubGFyZ2VzdEJhdGNoSWQpIDogbi5kb25lKCk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBpKSk7XG4gICAgfVxuICAgIFN0KGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9kb2N1bWVudE92ZXJsYXlTdG9yZShlKS5wdXQoZnVuY3Rpb24gX19QUklWQVRFX3RvRGJEb2N1bWVudE92ZXJsYXkoZSwgdCwgbikge1xuICAgICAgICAgICAgY29uc3QgW3IsIGksIHNdID0gX19QUklWQVRFX3RvRGJEb2N1bWVudE92ZXJsYXlLZXkodCwgbi5tdXRhdGlvbi5rZXkpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB1c2VySWQ6IHQsXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvblBhdGg6IGksXG4gICAgICAgICAgICAgICAgZG9jdW1lbnRJZDogcyxcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uR3JvdXA6IG4ubXV0YXRpb24ua2V5LmdldENvbGxlY3Rpb25Hcm91cCgpLFxuICAgICAgICAgICAgICAgIGxhcmdlc3RCYXRjaElkOiBuLmxhcmdlc3RCYXRjaElkLFxuICAgICAgICAgICAgICAgIG92ZXJsYXlNdXRhdGlvbjogdG9NdXRhdGlvbihlLnl0LCBuLm11dGF0aW9uKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSh0aGlzLnNlcmlhbGl6ZXIsIHRoaXMudXNlcklkLCB0KSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgZG9jdW1lbnQgb3ZlcmxheSBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX2RvY3VtZW50T3ZlcmxheVN0b3JlKGUpIHtcbiAgICByZXR1cm4gX19QUklWQVRFX2dldFN0b3JlKGUsIEtlKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjQgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgX19QUklWQVRFX0luZGV4ZWREYkdsb2JhbHNDYWNoZSB7XG4gICAgYnQoZSkge1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX2dldFN0b3JlKGUsIEhlKTtcbiAgICB9XG4gICAgZ2V0U2Vzc2lvblRva2VuKGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYnQoZSkuZ2V0KFwic2Vzc2lvblRva2VuXCIpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgdCA9IGU/LnZhbHVlO1xuICAgICAgICAgICAgcmV0dXJuIHQgPyBCeXRlU3RyaW5nLmZyb21VaW50OEFycmF5KHQpIDogQnl0ZVN0cmluZy5FTVBUWV9CWVRFX1NUUklORztcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBzZXRTZXNzaW9uVG9rZW4oZSwgdCkge1xuICAgICAgICByZXR1cm4gdGhpcy5idChlKS5wdXQoe1xuICAgICAgICAgICAgbmFtZTogXCJzZXNzaW9uVG9rZW5cIixcbiAgICAgICAgICAgIHZhbHVlOiB0LnRvVWludDhBcnJheSgpXG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8vIE5vdGU6IFRoaXMgY29kZSBpcyBjb3BpZWQgZnJvbSB0aGUgYmFja2VuZC4gQ29kZSB0aGF0IGlzIG5vdCB1c2VkIGJ5XG4vLyBGaXJlc3RvcmUgd2FzIHJlbW92ZWQuXG4vKiogRmlyZXN0b3JlIGluZGV4IHZhbHVlIHdyaXRlci4gICovXG5jbGFzcyBfX1BSSVZBVEVfRmlyZXN0b3JlSW5kZXhWYWx1ZVdyaXRlciB7XG4gICAgY29uc3RydWN0b3IoKSB7fVxuICAgIC8vIFRoZSB3cml0ZSBtZXRob2RzIGJlbG93IHNob3J0LWNpcmN1aXQgd3JpdGluZyB0ZXJtaW5hdG9ycyBmb3IgdmFsdWVzXG4gICAgLy8gY29udGFpbmluZyBhICh0ZXJtaW5hdGluZykgdHJ1bmNhdGVkIHZhbHVlLlxuICAgIC8vIEFzIGFuIGV4YW1wbGUsIGNvbnNpZGVyIHRoZSByZXN1bHRpbmcgZW5jb2RpbmcgZm9yOlxuICAgIC8vIFtcImJhclwiLCBbMiwgXCJmb29cIl1dIC0+IChTVFJJTkcsIFwiYmFyXCIsIFRFUk0sIEFSUkFZLCBOVU1CRVIsIDIsIFNUUklORywgXCJmb29cIiwgVEVSTSwgVEVSTSwgVEVSTSlcbiAgICAvLyBbXCJiYXJcIiwgWzIsIHRydW5jYXRlZChcImZvb1wiKV1dIC0+IChTVFJJTkcsIFwiYmFyXCIsIFRFUk0sIEFSUkFZLCBOVU1CRVIsIDIsIFNUUklORywgXCJmb29cIiwgVFJVTkMpXG4gICAgLy8gW1wiYmFyXCIsIHRydW5jYXRlZChbXCJmb29cIl0pXSAtPiAoU1RSSU5HLCBcImJhclwiLCBURVJNLCBBUlJBWS4gU1RSSU5HLCBcImZvb1wiLCBURVJNLCBUUlVOQylcbiAgICAvKiogV3JpdGVzIGFuIGluZGV4IHZhbHVlLiAgKi9cbiAgICBEdChlLCB0KSB7XG4gICAgICAgIHRoaXMuQ3QoZSwgdCksIFxuICAgICAgICAvLyBXcml0ZSBzZXBhcmF0b3IgdG8gc3BsaXQgaW5kZXggdmFsdWVzXG4gICAgICAgIC8vIChzZWUgZ28vZmlyZXN0b3JlLXN0b3JhZ2UtZm9ybWF0I2VuY29kaW5ncykuXG4gICAgICAgIHQudnQoKTtcbiAgICB9XG4gICAgQ3QoZSwgdCkge1xuICAgICAgICBpZiAoXCJudWxsVmFsdWVcIiBpbiBlKSB0aGlzLkZ0KHQsIDUpOyBlbHNlIGlmIChcImJvb2xlYW5WYWx1ZVwiIGluIGUpIHRoaXMuRnQodCwgMTApLCBcbiAgICAgICAgdC5NdChlLmJvb2xlYW5WYWx1ZSA/IDEgOiAwKTsgZWxzZSBpZiAoXCJpbnRlZ2VyVmFsdWVcIiBpbiBlKSB0aGlzLkZ0KHQsIDE1KSwgdC5NdChfX1BSSVZBVEVfbm9ybWFsaXplTnVtYmVyKGUuaW50ZWdlclZhbHVlKSk7IGVsc2UgaWYgKFwiZG91YmxlVmFsdWVcIiBpbiBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX25vcm1hbGl6ZU51bWJlcihlLmRvdWJsZVZhbHVlKTtcbiAgICAgICAgICAgIGlzTmFOKG4pID8gdGhpcy5GdCh0LCAxMykgOiAodGhpcy5GdCh0LCAxNSksIF9fUFJJVkFURV9pc05lZ2F0aXZlWmVybyhuKSA/IFxuICAgICAgICAgICAgLy8gLTAuMCwgMCBhbmQgMC4wIGFyZSBhbGwgY29uc2lkZXJlZCB0aGUgc2FtZVxuICAgICAgICAgICAgdC5NdCgwKSA6IHQuTXQobikpO1xuICAgICAgICB9IGVsc2UgaWYgKFwidGltZXN0YW1wVmFsdWVcIiBpbiBlKSB7XG4gICAgICAgICAgICBsZXQgbiA9IGUudGltZXN0YW1wVmFsdWU7XG4gICAgICAgICAgICB0aGlzLkZ0KHQsIDIwKSwgXCJzdHJpbmdcIiA9PSB0eXBlb2YgbiAmJiAobiA9IF9fUFJJVkFURV9ub3JtYWxpemVUaW1lc3RhbXAobikpLCB0Lnh0KGAke24uc2Vjb25kcyB8fCBcIlwifWApLCBcbiAgICAgICAgICAgIHQuTXQobi5uYW5vcyB8fCAwKTtcbiAgICAgICAgfSBlbHNlIGlmIChcInN0cmluZ1ZhbHVlXCIgaW4gZSkgdGhpcy5PdChlLnN0cmluZ1ZhbHVlLCB0KSwgdGhpcy5OdCh0KTsgZWxzZSBpZiAoXCJieXRlc1ZhbHVlXCIgaW4gZSkgdGhpcy5GdCh0LCAzMCksIFxuICAgICAgICB0LkJ0KF9fUFJJVkFURV9ub3JtYWxpemVCeXRlU3RyaW5nKGUuYnl0ZXNWYWx1ZSkpLCB0aGlzLk50KHQpOyBlbHNlIGlmIChcInJlZmVyZW5jZVZhbHVlXCIgaW4gZSkgdGhpcy5MdChlLnJlZmVyZW5jZVZhbHVlLCB0KTsgZWxzZSBpZiAoXCJnZW9Qb2ludFZhbHVlXCIgaW4gZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IGUuZ2VvUG9pbnRWYWx1ZTtcbiAgICAgICAgICAgIHRoaXMuRnQodCwgNDUpLCB0Lk10KG4ubGF0aXR1ZGUgfHwgMCksIHQuTXQobi5sb25naXR1ZGUgfHwgMCk7XG4gICAgICAgIH0gZWxzZSBcIm1hcFZhbHVlXCIgaW4gZSA/IF9fUFJJVkFURV9pc01heFZhbHVlKGUpID8gdGhpcy5GdCh0LCBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUikgOiBfX1BSSVZBVEVfaXNWZWN0b3JWYWx1ZShlKSA/IHRoaXMua3QoZS5tYXBWYWx1ZSwgdCkgOiAodGhpcy5xdChlLm1hcFZhbHVlLCB0KSwgXG4gICAgICAgIHRoaXMuTnQodCkpIDogXCJhcnJheVZhbHVlXCIgaW4gZSA/ICh0aGlzLlF0KGUuYXJyYXlWYWx1ZSwgdCksIHRoaXMuTnQodCkpIDogZmFpbCgxOTAyMiwge1xuICAgICAgICAgICAgJHQ6IGVcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIE90KGUsIHQpIHtcbiAgICAgICAgdGhpcy5GdCh0LCAyNSksIHRoaXMuVXQoZSwgdCk7XG4gICAgfVxuICAgIFV0KGUsIHQpIHtcbiAgICAgICAgdC54dChlKTtcbiAgICB9XG4gICAgcXQoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gZS5maWVsZHMgfHwge307XG4gICAgICAgIHRoaXMuRnQodCwgNTUpO1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgT2JqZWN0LmtleXMobikpIHRoaXMuT3QoZSwgdCksIHRoaXMuQ3QobltlXSwgdCk7XG4gICAgfVxuICAgIGt0KGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IGUuZmllbGRzIHx8IHt9O1xuICAgICAgICB0aGlzLkZ0KHQsIDUzKTtcbiAgICAgICAgLy8gVmVjdG9ycyBzb3J0IGZpcnN0IGJ5IGxlbmd0aFxuICAgICAgICBjb25zdCByID0gRXQsIGkgPSBuW3JdLmFycmF5VmFsdWU/LnZhbHVlcz8ubGVuZ3RoIHx8IDA7XG4gICAgICAgIHRoaXMuRnQodCwgMTUpLCB0Lk10KF9fUFJJVkFURV9ub3JtYWxpemVOdW1iZXIoaSkpLCBcbiAgICAgICAgLy8gVmVjdG9ycyB0aGVuIHNvcnQgYnkgcG9zaXRpb24gdmFsdWVcbiAgICAgICAgdGhpcy5PdChyLCB0KSwgdGhpcy5DdChuW3JdLCB0KTtcbiAgICB9XG4gICAgUXQoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gZS52YWx1ZXMgfHwgW107XG4gICAgICAgIHRoaXMuRnQodCwgNTApO1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgbikgdGhpcy5DdChlLCB0KTtcbiAgICB9XG4gICAgTHQoZSwgdCkge1xuICAgICAgICB0aGlzLkZ0KHQsIDM3KTtcbiAgICAgICAgRG9jdW1lbnRLZXkuZnJvbU5hbWUoZSkucGF0aC5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIHRoaXMuRnQodCwgNjApLCB0aGlzLlV0KGUsIHQpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIEZ0KGUsIHQpIHtcbiAgICAgICAgZS5NdCh0KTtcbiAgICB9XG4gICAgTnQoZSkge1xuICAgICAgICAvLyBXaGlsZSB0aGUgU0RLIGRvZXMgbm90IGltcGxlbWVudCB0cnVuY2F0aW9uLCB0aGUgdHJ1bmNhdGlvbiBtYXJrZXIgaXNcbiAgICAgICAgLy8gdXNlZCB0byB0ZXJtaW5hdGUgYWxsIHZhcmlhYmxlIGxlbmd0aCB2YWx1ZXMgKHdoaWNoIGFyZSBzdHJpbmdzLCBieXRlcyxcbiAgICAgICAgLy8gcmVmZXJlbmNlcywgYXJyYXlzIGFuZCBtYXBzKS5cbiAgICAgICAgZS5NdCgyKTtcbiAgICB9XG59XG5cbl9fUFJJVkFURV9GaXJlc3RvcmVJbmRleFZhbHVlV3JpdGVyLkt0ID0gbmV3IF9fUFJJVkFURV9GaXJlc3RvcmVJbmRleFZhbHVlV3JpdGVyO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IHwgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgfCBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyB8IGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqIFRoZXNlIGNvbnN0YW50cyBhcmUgdGFrZW4gZnJvbSB0aGUgYmFja2VuZC4gKi9cbmNvbnN0IHZ0ID0gMjU1O1xuXG4vKipcbiAqIENvdW50cyB0aGUgbnVtYmVyIG9mIHplcm9zIGluIGEgYnl0ZS5cbiAqXG4gKiBWaXNpYmxlIGZvciB0ZXN0aW5nLlxuICovXG5mdW5jdGlvbiBfX1BSSVZBVEVfbnVtYmVyT2ZMZWFkaW5nWmVyb3NJbkJ5dGUoZSkge1xuICAgIGlmICgwID09PSBlKSByZXR1cm4gODtcbiAgICBsZXQgdCA9IDA7XG4gICAgcmV0dXJuIGUgPj4gNCB8fCAoXG4gICAgLy8gVGVzdCBpZiB0aGUgZmlyc3QgZm91ciBiaXRzIGFyZSB6ZXJvLlxuICAgIHQgKz0gNCwgZSA8PD0gNCksIGUgPj4gNiB8fCAoXG4gICAgLy8gVGVzdCBpZiB0aGUgZmlyc3QgdHdvIChvciBuZXh0IHR3bykgYml0cyBhcmUgemVyby5cbiAgICB0ICs9IDIsIGUgPDw9IDIpLCBlID4+IDcgfHwgKFxuICAgIC8vIFRlc3QgaWYgdGhlIHJlbWFpbmluZyBiaXQgaXMgemVyby5cbiAgICB0ICs9IDEpLCB0O1xufVxuXG4vKiogQ291bnRzIHRoZSBudW1iZXIgb2YgbGVhZGluZyB6ZXJvcyBpbiB0aGUgZ2l2ZW4gYnl0ZSBhcnJheS4gKi9cbi8qKlxuICogUmV0dXJucyB0aGUgbnVtYmVyIG9mIGJ5dGVzIHJlcXVpcmVkIHRvIHN0b3JlIFwidmFsdWVcIi4gTGVhZGluZyB6ZXJvIGJ5dGVzXG4gKiBhcmUgc2tpcHBlZC5cbiAqL1xuZnVuY3Rpb24gX19QUklWQVRFX3Vuc2lnbmVkTnVtTGVuZ3RoKGUpIHtcbiAgICAvLyBUaGlzIGlzIGp1c3QgdGhlIG51bWJlciBvZiBieXRlcyBmb3IgdGhlIHVuc2lnbmVkIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBudW1iZXIuXG4gICAgY29uc3QgdCA9IDY0IC0gZnVuY3Rpb24gX19QUklWQVRFX251bWJlck9mTGVhZGluZ1plcm9zKGUpIHtcbiAgICAgICAgbGV0IHQgPSAwO1xuICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IDg7ICsrbikge1xuICAgICAgICAgICAgY29uc3QgciA9IF9fUFJJVkFURV9udW1iZXJPZkxlYWRpbmdaZXJvc0luQnl0ZSgyNTUgJiBlW25dKTtcbiAgICAgICAgICAgIGlmICh0ICs9IHIsIDggIT09IHIpIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0O1xuICAgIH0oZSk7XG4gICAgcmV0dXJuIE1hdGguY2VpbCh0IC8gOCk7XG59XG5cbi8qKlxuICogT3JkZXJlZENvZGVXcml0ZXIgaXMgYSBtaW5pbWFsLWFsbG9jYXRpb24gaW1wbGVtZW50YXRpb24gb2YgdGhlIHdyaXRpbmdcbiAqIGJlaGF2aW9yIGRlZmluZWQgYnkgdGhlIGJhY2tlbmQuXG4gKlxuICogVGhlIGNvZGUgaXMgcG9ydGVkIGZyb20gaXRzIEphdmEgY291bnRlcnBhcnQuXG4gKi8gY2xhc3MgX19QUklWQVRFX09yZGVyZWRDb2RlV3JpdGVyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5idWZmZXIgPSBuZXcgVWludDhBcnJheSgxMDI0KSwgdGhpcy5wb3NpdGlvbiA9IDA7XG4gICAgfVxuICAgIFd0KGUpIHtcbiAgICAgICAgY29uc3QgdCA9IGVbU3ltYm9sLml0ZXJhdG9yXSgpO1xuICAgICAgICBsZXQgbiA9IHQubmV4dCgpO1xuICAgICAgICBmb3IgKDshbi5kb25lOyApIHRoaXMuR3Qobi52YWx1ZSksIG4gPSB0Lm5leHQoKTtcbiAgICAgICAgdGhpcy56dCgpO1xuICAgIH1cbiAgICBqdChlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBlW1N5bWJvbC5pdGVyYXRvcl0oKTtcbiAgICAgICAgbGV0IG4gPSB0Lm5leHQoKTtcbiAgICAgICAgZm9yICg7IW4uZG9uZTsgKSB0aGlzLkp0KG4udmFsdWUpLCBuID0gdC5uZXh0KCk7XG4gICAgICAgIHRoaXMuSHQoKTtcbiAgICB9XG4gICAgLyoqIFdyaXRlcyB1dGY4IGJ5dGVzIGludG8gdGhpcyBieXRlIHNlcXVlbmNlLCBhc2NlbmRpbmcuICovICAgIFl0KGUpIHtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LmNoYXJDb2RlQXQoMCk7XG4gICAgICAgICAgICBpZiAoZSA8IDEyOCkgdGhpcy5HdChlKTsgZWxzZSBpZiAoZSA8IDIwNDgpIHRoaXMuR3QoOTYwIHwgZSA+Pj4gNiksIHRoaXMuR3QoMTI4IHwgNjMgJiBlKTsgZWxzZSBpZiAodCA8IFwiXFx1ZDgwMFwiIHx8IFwiXFx1ZGJmZlwiIDwgdCkgdGhpcy5HdCg0ODAgfCBlID4+PiAxMiksIFxuICAgICAgICAgICAgdGhpcy5HdCgxMjggfCA2MyAmIGUgPj4+IDYpLCB0aGlzLkd0KDEyOCB8IDYzICYgZSk7IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmNvZGVQb2ludEF0KDApO1xuICAgICAgICAgICAgICAgIHRoaXMuR3QoMjQwIHwgZSA+Pj4gMTgpLCB0aGlzLkd0KDEyOCB8IDYzICYgZSA+Pj4gMTIpLCB0aGlzLkd0KDEyOCB8IDYzICYgZSA+Pj4gNiksIFxuICAgICAgICAgICAgICAgIHRoaXMuR3QoMTI4IHwgNjMgJiBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnp0KCk7XG4gICAgfVxuICAgIC8qKiBXcml0ZXMgdXRmOCBieXRlcyBpbnRvIHRoaXMgYnl0ZSBzZXF1ZW5jZSwgZGVzY2VuZGluZyAqLyAgICBadChlKSB7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBlKSB7XG4gICAgICAgICAgICBjb25zdCBlID0gdC5jaGFyQ29kZUF0KDApO1xuICAgICAgICAgICAgaWYgKGUgPCAxMjgpIHRoaXMuSnQoZSk7IGVsc2UgaWYgKGUgPCAyMDQ4KSB0aGlzLkp0KDk2MCB8IGUgPj4+IDYpLCB0aGlzLkp0KDEyOCB8IDYzICYgZSk7IGVsc2UgaWYgKHQgPCBcIlxcdWQ4MDBcIiB8fCBcIlxcdWRiZmZcIiA8IHQpIHRoaXMuSnQoNDgwIHwgZSA+Pj4gMTIpLCBcbiAgICAgICAgICAgIHRoaXMuSnQoMTI4IHwgNjMgJiBlID4+PiA2KSwgdGhpcy5KdCgxMjggfCA2MyAmIGUpOyBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5jb2RlUG9pbnRBdCgwKTtcbiAgICAgICAgICAgICAgICB0aGlzLkp0KDI0MCB8IGUgPj4+IDE4KSwgdGhpcy5KdCgxMjggfCA2MyAmIGUgPj4+IDEyKSwgdGhpcy5KdCgxMjggfCA2MyAmIGUgPj4+IDYpLCBcbiAgICAgICAgICAgICAgICB0aGlzLkp0KDEyOCB8IDYzICYgZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5IdCgpO1xuICAgIH1cbiAgICBYdChlKSB7XG4gICAgICAgIC8vIFZhbHVlcyBhcmUgZW5jb2RlZCB3aXRoIGEgc2luZ2xlIGJ5dGUgbGVuZ3RoIHByZWZpeCwgZm9sbG93ZWQgYnkgdGhlXG4gICAgICAgIC8vIGFjdHVhbCB2YWx1ZSBpbiBiaWctZW5kaWFuIGZvcm1hdCB3aXRoIGxlYWRpbmcgMCBieXRlcyBkcm9wcGVkLlxuICAgICAgICBjb25zdCB0ID0gdGhpcy5lbihlKSwgbiA9IF9fUFJJVkFURV91bnNpZ25lZE51bUxlbmd0aCh0KTtcbiAgICAgICAgdGhpcy50bigxICsgbiksIHRoaXMuYnVmZmVyW3RoaXMucG9zaXRpb24rK10gPSAyNTUgJiBuO1xuICAgICAgICAvLyBXcml0ZSB0aGUgbGVuZ3RoXG4gICAgICAgIGZvciAobGV0IGUgPSB0Lmxlbmd0aCAtIG47IGUgPCB0Lmxlbmd0aDsgKytlKSB0aGlzLmJ1ZmZlclt0aGlzLnBvc2l0aW9uKytdID0gMjU1ICYgdFtlXTtcbiAgICB9XG4gICAgbm4oZSkge1xuICAgICAgICAvLyBWYWx1ZXMgYXJlIGVuY29kZWQgd2l0aCBhIHNpbmdsZSBieXRlIGxlbmd0aCBwcmVmaXgsIGZvbGxvd2VkIGJ5IHRoZVxuICAgICAgICAvLyBpbnZlcnRlZCB2YWx1ZSBpbiBiaWctZW5kaWFuIGZvcm1hdCB3aXRoIGxlYWRpbmcgMCBieXRlcyBkcm9wcGVkLlxuICAgICAgICBjb25zdCB0ID0gdGhpcy5lbihlKSwgbiA9IF9fUFJJVkFURV91bnNpZ25lZE51bUxlbmd0aCh0KTtcbiAgICAgICAgdGhpcy50bigxICsgbiksIHRoaXMuYnVmZmVyW3RoaXMucG9zaXRpb24rK10gPSB+KDI1NSAmIG4pO1xuICAgICAgICAvLyBXcml0ZSB0aGUgbGVuZ3RoXG4gICAgICAgIGZvciAobGV0IGUgPSB0Lmxlbmd0aCAtIG47IGUgPCB0Lmxlbmd0aDsgKytlKSB0aGlzLmJ1ZmZlclt0aGlzLnBvc2l0aW9uKytdID0gfigyNTUgJiB0W2VdKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogV3JpdGVzIHRoZSBcImluZmluaXR5XCIgYnl0ZSBzZXF1ZW5jZSB0aGF0IHNvcnRzIGFmdGVyIGFsbCBvdGhlciBieXRlXG4gICAgICogc2VxdWVuY2VzIHdyaXR0ZW4gaW4gYXNjZW5kaW5nIG9yZGVyLlxuICAgICAqLyAgICBybigpIHtcbiAgICAgICAgdGhpcy5zbih2dCksIHRoaXMuc24oMjU1KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogV3JpdGVzIHRoZSBcImluZmluaXR5XCIgYnl0ZSBzZXF1ZW5jZSB0aGF0IHNvcnRzIGJlZm9yZSBhbGwgb3RoZXIgYnl0ZVxuICAgICAqIHNlcXVlbmNlcyB3cml0dGVuIGluIGRlc2NlbmRpbmcgb3JkZXIuXG4gICAgICovICAgIF9uKCkge1xuICAgICAgICB0aGlzLmFuKHZ0KSwgdGhpcy5hbigyNTUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXNldHMgdGhlIGJ1ZmZlciBzdWNoIHRoYXQgaXQgaXMgdGhlIHNhbWUgYXMgd2hlbiBpdCB3YXMgbmV3bHlcbiAgICAgKiBjb25zdHJ1Y3RlZC5cbiAgICAgKi8gICAgcmVzZXQoKSB7XG4gICAgICAgIHRoaXMucG9zaXRpb24gPSAwO1xuICAgIH1cbiAgICBzZWVkKGUpIHtcbiAgICAgICAgdGhpcy50bihlLmxlbmd0aCksIHRoaXMuYnVmZmVyLnNldChlLCB0aGlzLnBvc2l0aW9uKSwgdGhpcy5wb3NpdGlvbiArPSBlLmxlbmd0aDtcbiAgICB9XG4gICAgLyoqIE1ha2VzIGEgY29weSBvZiB0aGUgZW5jb2RlZCBieXRlcyBpbiB0aGlzIGJ1ZmZlci4gICovICAgIHVuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5idWZmZXIuc2xpY2UoMCwgdGhpcy5wb3NpdGlvbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVuY29kZXMgYHZhbGAgaW50byBhbiBlbmNvZGluZyBzbyB0aGF0IHRoZSBvcmRlciBtYXRjaGVzIHRoZSBJRUVFIDc1NFxuICAgICAqIGZsb2F0aW5nLXBvaW50IGNvbXBhcmlzb24gcmVzdWx0cyB3aXRoIHRoZSBmb2xsb3dpbmcgZXhjZXB0aW9uczpcbiAgICAgKiAgIC0wLjAgPCAwLjBcbiAgICAgKiAgIGFsbCBub24tTmFOIDwgTmFOXG4gICAgICogICBOYU4gPSBOYU5cbiAgICAgKi8gICAgZW4oZSkge1xuICAgICAgICBjb25zdCB0ID0gXG4gICAgICAgIC8qKiBDb252ZXJ0cyBhIEphdmFTY3JpcHQgbnVtYmVyIHRvIGEgYnl0ZSBhcnJheSAodXNpbmcgYmlnIGVuZGlhbiBlbmNvZGluZykuICovXG4gICAgICAgIGZ1bmN0aW9uIF9fUFJJVkFURV9kb3VibGVUb0xvbmdCaXRzKGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBuZXcgRGF0YVZpZXcobmV3IEFycmF5QnVmZmVyKDgpKTtcbiAgICAgICAgICAgIHJldHVybiB0LnNldEZsb2F0NjQoMCwgZSwgLyogbGl0dGxlRW5kaWFuPSAqLyAhMSksIG5ldyBVaW50OEFycmF5KHQuYnVmZmVyKTtcbiAgICAgICAgfShlKSwgbiA9ICEhKDEyOCAmIHRbMF0pO1xuICAgICAgICAvLyBDaGVjayBpZiB0aGUgZmlyc3QgYml0IGlzIHNldC4gV2UgdXNlIGEgYml0IG1hc2sgc2luY2UgdmFsdWVbMF0gaXNcbiAgICAgICAgLy8gZW5jb2RlZCBhcyBhIG51bWJlciBmcm9tIDAgdG8gMjU1LlxuICAgICAgICAgICAgICAgIC8vIFJldmVydCB0aGUgdHdvIGNvbXBsZW1lbnQgdG8gZ2V0IG5hdHVyYWwgb3JkZXJpbmdcbiAgICAgICAgdFswXSBePSBuID8gMjU1IDogMTI4O1xuICAgICAgICBmb3IgKGxldCBlID0gMTsgZSA8IHQubGVuZ3RoOyArK2UpIHRbZV0gXj0gbiA/IDI1NSA6IDA7XG4gICAgICAgIHJldHVybiB0O1xuICAgIH1cbiAgICAvKiogV3JpdGVzIGEgc2luZ2xlIGJ5dGUgYXNjZW5kaW5nIHRvIHRoZSBidWZmZXIuICovICAgIEd0KGUpIHtcbiAgICAgICAgY29uc3QgdCA9IDI1NSAmIGU7XG4gICAgICAgIDAgPT09IHQgPyAodGhpcy5zbigwKSwgdGhpcy5zbigyNTUpKSA6IHQgPT09IHZ0ID8gKHRoaXMuc24odnQpLCB0aGlzLnNuKDApKSA6IHRoaXMuc24odCk7XG4gICAgfVxuICAgIC8qKiBXcml0ZXMgYSBzaW5nbGUgYnl0ZSBkZXNjZW5kaW5nIHRvIHRoZSBidWZmZXIuICAqLyAgICBKdChlKSB7XG4gICAgICAgIGNvbnN0IHQgPSAyNTUgJiBlO1xuICAgICAgICAwID09PSB0ID8gKHRoaXMuYW4oMCksIHRoaXMuYW4oMjU1KSkgOiB0ID09PSB2dCA/ICh0aGlzLmFuKHZ0KSwgdGhpcy5hbigwKSkgOiB0aGlzLmFuKGUpO1xuICAgIH1cbiAgICB6dCgpIHtcbiAgICAgICAgdGhpcy5zbigwKSwgdGhpcy5zbigxKTtcbiAgICB9XG4gICAgSHQoKSB7XG4gICAgICAgIHRoaXMuYW4oMCksIHRoaXMuYW4oMSk7XG4gICAgfVxuICAgIHNuKGUpIHtcbiAgICAgICAgdGhpcy50bigxKSwgdGhpcy5idWZmZXJbdGhpcy5wb3NpdGlvbisrXSA9IGU7XG4gICAgfVxuICAgIGFuKGUpIHtcbiAgICAgICAgdGhpcy50bigxKSwgdGhpcy5idWZmZXJbdGhpcy5wb3NpdGlvbisrXSA9IH5lO1xuICAgIH1cbiAgICB0bihlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBlICsgdGhpcy5wb3NpdGlvbjtcbiAgICAgICAgaWYgKHQgPD0gdGhpcy5idWZmZXIubGVuZ3RoKSByZXR1cm47XG4gICAgICAgIC8vIFRyeSBkb3VibGluZy5cbiAgICAgICAgICAgICAgICBsZXQgbiA9IDIgKiB0aGlzLmJ1ZmZlci5sZW5ndGg7XG4gICAgICAgIC8vIFN0aWxsIG5vdCBiaWcgZW5vdWdoPyBKdXN0IGFsbG9jYXRlIHRoZSByaWdodCBzaXplLlxuICAgICAgICAgICAgICAgIG4gPCB0ICYmIChuID0gdCk7XG4gICAgICAgIC8vIENyZWF0ZSB0aGUgbmV3IGJ1ZmZlci5cbiAgICAgICAgICAgICAgICBjb25zdCByID0gbmV3IFVpbnQ4QXJyYXkobik7XG4gICAgICAgIHIuc2V0KHRoaXMuYnVmZmVyKSwgLy8gY29weSBvbGQgZGF0YVxuICAgICAgICB0aGlzLmJ1ZmZlciA9IHI7XG4gICAgfVxufVxuXG5jbGFzcyBfX1BSSVZBVEVfQXNjZW5kaW5nSW5kZXhCeXRlRW5jb2RlciB7XG4gICAgY29uc3RydWN0b3IoZSkge1xuICAgICAgICB0aGlzLmNuID0gZTtcbiAgICB9XG4gICAgQnQoZSkge1xuICAgICAgICB0aGlzLmNuLld0KGUpO1xuICAgIH1cbiAgICB4dChlKSB7XG4gICAgICAgIHRoaXMuY24uWXQoZSk7XG4gICAgfVxuICAgIE10KGUpIHtcbiAgICAgICAgdGhpcy5jbi5YdChlKTtcbiAgICB9XG4gICAgdnQoKSB7XG4gICAgICAgIHRoaXMuY24ucm4oKTtcbiAgICB9XG59XG5cbmNsYXNzIF9fUFJJVkFURV9EZXNjZW5kaW5nSW5kZXhCeXRlRW5jb2RlciB7XG4gICAgY29uc3RydWN0b3IoZSkge1xuICAgICAgICB0aGlzLmNuID0gZTtcbiAgICB9XG4gICAgQnQoZSkge1xuICAgICAgICB0aGlzLmNuLmp0KGUpO1xuICAgIH1cbiAgICB4dChlKSB7XG4gICAgICAgIHRoaXMuY24uWnQoZSk7XG4gICAgfVxuICAgIE10KGUpIHtcbiAgICAgICAgdGhpcy5jbi5ubihlKTtcbiAgICB9XG4gICAgdnQoKSB7XG4gICAgICAgIHRoaXMuY24uX24oKTtcbiAgICB9XG59XG5cbi8qKlxuICogSW1wbGVtZW50cyBgRGlyZWN0aW9uYWxJbmRleEJ5dGVFbmNvZGVyYCB1c2luZyBgT3JkZXJlZENvZGVXcml0ZXJgIGZvciB0aGVcbiAqIGFjdHVhbCBlbmNvZGluZy5cbiAqLyBjbGFzcyBfX1BSSVZBVEVfSW5kZXhCeXRlRW5jb2RlciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuY24gPSBuZXcgX19QUklWQVRFX09yZGVyZWRDb2RlV3JpdGVyLCB0aGlzLmxuID0gbmV3IF9fUFJJVkFURV9Bc2NlbmRpbmdJbmRleEJ5dGVFbmNvZGVyKHRoaXMuY24pLCBcbiAgICAgICAgdGhpcy5obiA9IG5ldyBfX1BSSVZBVEVfRGVzY2VuZGluZ0luZGV4Qnl0ZUVuY29kZXIodGhpcy5jbik7XG4gICAgfVxuICAgIHNlZWQoZSkge1xuICAgICAgICB0aGlzLmNuLnNlZWQoZSk7XG4gICAgfVxuICAgIFBuKGUpIHtcbiAgICAgICAgcmV0dXJuIDAgLyogSW5kZXhLaW5kLkFTQ0VORElORyAqLyA9PT0gZSA/IHRoaXMubG4gOiB0aGlzLmhuO1xuICAgIH1cbiAgICB1bigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY24udW4oKTtcbiAgICB9XG4gICAgcmVzZXQoKSB7XG4gICAgICAgIHRoaXMuY24ucmVzZXQoKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogUmVwcmVzZW50cyBhbiBpbmRleCBlbnRyeSBzYXZlZCBieSB0aGUgU0RLIGluIHBlcnNpc3RlZCBzdG9yYWdlLiAqLyBjbGFzcyBfX1BSSVZBVEVfSW5kZXhFbnRyeSB7XG4gICAgY29uc3RydWN0b3IoZSwgdCwgbiwgcikge1xuICAgICAgICB0aGlzLlRuID0gZSwgdGhpcy5JbiA9IHQsIHRoaXMuRW4gPSBuLCB0aGlzLmRuID0gcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhbiBJbmRleEVudHJ5IGVudHJ5IHRoYXQgc29ydHMgaW1tZWRpYXRlbHkgYWZ0ZXIgdGhlIGN1cnJlbnRcbiAgICAgKiBkaXJlY3Rpb25hbCB2YWx1ZS5cbiAgICAgKi8gICAgQW4oKSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmRuLmxlbmd0aCwgdCA9IDAgPT09IGUgfHwgMjU1ID09PSB0aGlzLmRuW2UgLSAxXSA/IGUgKyAxIDogZSwgbiA9IG5ldyBVaW50OEFycmF5KHQpO1xuICAgICAgICByZXR1cm4gbi5zZXQodGhpcy5kbiwgMCksIHQgIT09IGUgPyBuLnNldChbIDAgXSwgdGhpcy5kbi5sZW5ndGgpIDogKytuW24ubGVuZ3RoIC0gMV0sIFxuICAgICAgICBuZXcgX19QUklWQVRFX0luZGV4RW50cnkodGhpcy5UbiwgdGhpcy5JbiwgdGhpcy5Fbiwgbik7XG4gICAgfVxuICAgIC8vIENyZWF0ZSBhIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBJbmRleCBFbnRyeSBhcyBhIERiSW5kZXhFbnRyeVxuICAgIFJuKGUsIHQsIG4pIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGluZGV4SWQ6IHRoaXMuVG4sXG4gICAgICAgICAgICB1aWQ6IGUsXG4gICAgICAgICAgICBhcnJheVZhbHVlOiBfX1BSSVZBVEVfZW5jb2RlS2V5U2FmZUJ5dGVzKHRoaXMuRW4pLFxuICAgICAgICAgICAgZGlyZWN0aW9uYWxWYWx1ZTogX19QUklWQVRFX2VuY29kZUtleVNhZmVCeXRlcyh0aGlzLmRuKSxcbiAgICAgICAgICAgIG9yZGVyZWREb2N1bWVudEtleTogX19QUklWQVRFX2VuY29kZUtleVNhZmVCeXRlcyh0KSxcbiAgICAgICAgICAgIGRvY3VtZW50S2V5OiBuLnBhdGgudG9BcnJheSgpXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8vIENyZWF0ZSBhIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBJbmRleCBFbnRyeSBhcyBhIERiSW5kZXhFbnRyeUtleVxuICAgIFZuKGUsIHQsIG4pIHtcbiAgICAgICAgY29uc3QgciA9IHRoaXMuUm4oZSwgdCwgbik7XG4gICAgICAgIHJldHVybiBbIHIuaW5kZXhJZCwgci51aWQsIHIuYXJyYXlWYWx1ZSwgci5kaXJlY3Rpb25hbFZhbHVlLCByLm9yZGVyZWREb2N1bWVudEtleSwgci5kb2N1bWVudEtleSBdO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2luZGV4RW50cnlDb21wYXJhdG9yKGUsIHQpIHtcbiAgICBsZXQgbiA9IGUuVG4gLSB0LlRuO1xuICAgIHJldHVybiAwICE9PSBuID8gbiA6IChuID0gX19QUklWQVRFX2NvbXBhcmVCeXRlQXJyYXlzKGUuRW4sIHQuRW4pLCAwICE9PSBuID8gbiA6IChuID0gX19QUklWQVRFX2NvbXBhcmVCeXRlQXJyYXlzKGUuZG4sIHQuZG4pLCBcbiAgICAwICE9PSBuID8gbiA6IERvY3VtZW50S2V5LmNvbXBhcmF0b3IoZS5JbiwgdC5JbikpKTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2NvbXBhcmVCeXRlQXJyYXlzKGUsIHQpIHtcbiAgICBmb3IgKGxldCBuID0gMDsgbiA8IGUubGVuZ3RoICYmIG4gPCB0Lmxlbmd0aDsgKytuKSB7XG4gICAgICAgIGNvbnN0IHIgPSBlW25dIC0gdFtuXTtcbiAgICAgICAgaWYgKDAgIT09IHIpIHJldHVybiByO1xuICAgIH1cbiAgICByZXR1cm4gZS5sZW5ndGggLSB0Lmxlbmd0aDtcbn1cblxuLyoqXG4gKiBXb3JrYXJvdW5kIGZvciBXZWJLaXQgYnVnOiBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MjkyNzIxXG4gKiBDcmVhdGUgYSBrZXkgc2FmZSByZXByZXNlbnRhdGlvbiBvZiBVaW50OEFycmF5IHZhbHVlcy5cbiAqIElmIHRoZSBicm93c2VyIGlzIGRldGVjdGVkIGFzIFNhZmFyaSBvciBXZWJLaXQsIHRoZW5cbiAqIHRoZSBpbnB1dCBhcnJheSB3aWxsIGJlIGNvbnZlcnRlZCB0byBcInNvcnRhYmxlIGJ5dGUgc3RyaW5nXCIuXG4gKiBPdGhlcndpc2UsIHRoZSBpbnB1dCBhcnJheSB3aWxsIGJlIHJldHVybmVkIGluIGl0cyBvcmlnaW5hbCB0eXBlLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9lbmNvZGVLZXlTYWZlQnl0ZXMoZSkge1xuICAgIHJldHVybiBpc1NhZmFyaU9yV2Via2l0KCkgPyBcbiAgICAvKipcbiAqIEVuY29kZXMgYSBVaW50OEFycmF5IGludG8gYSBcInNvcnRhYmxlIGJ5dGUgc3RyaW5nXCIuXG4gKiBBIFwic29ydGFibGUgYnl0ZSBzdHJpbmdcIiBzb3J0cyBpbiB0aGUgc2FtZSBvcmRlciBhcyB0aGUgVWludDhBcnJheS5cbiAqIFRoaXMgd29ya3MgYmVjYXVzZSBKUyBzdHJpbmcgY29tcGFyaXNvbiBzb3J0cyBzdHJpbmdzIGJhc2VkIG9uIGNvZGUgcG9pbnRzLlxuICovXG4gICAgZnVuY3Rpb24gX19QUklWQVRFX2VuY29kZVVpbnQ4QXJyYXlUb1NvcnRhYmxlU3RyaW5nKGUpIHtcbiAgICAgICAgbGV0IHQgPSBcIlwiO1xuICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IGUubGVuZ3RoOyBuKyspIHQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShlW25dKTtcbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgfVxuICAgIC8qKlxuICogRGVjb2RlcyBhIFwic29ydGFibGUgYnl0ZSBzdHJpbmdcIiBiYWNrIGludG8gYSBVaW50OEFycmF5LlxuICogQSBcInNvcnRhYmxlIGJ5dGUgc3RyaW5nXCIgaXMgYXNzdW1lZCB0byBiZSBjcmVhdGVkIHdoZXJlIGVhY2ggY2hhcmFjdGVyJ3NcbiAqIFVuaWNvZGUgY29kZSBwb2ludCBkaXJlY3RseSBjb3JyZXNwb25kcyB0byBhIHNpbmdsZSBieXRlIHZhbHVlICgwLTI1NSkuXG4gKi8gKGUpIDogZTtcbn1cblxuLyoqXG4gKiBSZXZlcnRzIHRoZSBrZXkgc2FmZSByZXByZXNlbnRhdGlvbiBvZiBVaW50OEFycmF5IChjcmVhdGVkIGJ5XG4gKiBlbmNvZGVLZXlTYWZlQnl0ZXMpIHRvIGEgbm9ybWFsIFVpbnQ4QXJyYXkuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX2RlY29kZUtleVNhZmVCeXRlcyhlKSB7XG4gICAgcmV0dXJuIFwic3RyaW5nXCIgIT0gdHlwZW9mIGUgPyBlIDogZnVuY3Rpb24gX19QUklWQVRFX2RlY29kZVNvcnRhYmxlU3RyaW5nVG9VaW50OEFycmF5KGUpIHtcbiAgICAgICAgY29uc3QgdCA9IG5ldyBVaW50OEFycmF5KGUubGVuZ3RoKTtcbiAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCBlLmxlbmd0aDsgbisrKSB0W25dID0gZS5jaGFyQ29kZUF0KG4pO1xuICAgICAgICByZXR1cm4gdDtcbiAgICB9XG4gICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbiAgICAvKipcbiAqIEEgbGlnaHQgcXVlcnkgcGxhbm5lciBmb3IgRmlyZXN0b3JlLlxuICpcbiAqIFRoaXMgY2xhc3MgbWF0Y2hlcyBhIGBGaWVsZEluZGV4YCBhZ2FpbnN0IGEgRmlyZXN0b3JlIFF1ZXJ5IGBUYXJnZXRgLiBJdFxuICogZGV0ZXJtaW5lcyB3aGV0aGVyIGEgZ2l2ZW4gaW5kZXggY2FuIGJlIHVzZWQgdG8gc2VydmUgdGhlIHNwZWNpZmllZCB0YXJnZXQuXG4gKlxuICogVGhlIGZvbGxvd2luZyB0YWJsZSBzaG93Y2FzZXMgc29tZSBwb3NzaWJsZSBpbmRleCBjb25maWd1cmF0aW9uczpcbiAqXG4gKiBRdWVyeSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBJbmRleFxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIHdoZXJlKCdhJywgJz09JywgJ2EnKS53aGVyZSgnYicsICc9PScsICdiJykgICAgICAgICB8IGEgQVNDLCBiIERFU0NcbiAqIHdoZXJlKCdhJywgJz09JywgJ2EnKS53aGVyZSgnYicsICc9PScsICdiJykgICAgICAgICB8IGEgQVNDXG4gKiB3aGVyZSgnYScsICc9PScsICdhJykud2hlcmUoJ2InLCAnPT0nLCAnYicpICAgICAgICAgfCBiIERFU0NcbiAqIHdoZXJlKCdhJywgJz49JywgJ2EnKS5vcmRlckJ5KCdhJykgICAgICAgICAgICAgICAgICB8IGEgQVNDXG4gKiB3aGVyZSgnYScsICc+PScsICdhJykub3JkZXJCeSgnYScsICdkZXNjJykgICAgICAgICAgfCBhIERFU0NcbiAqIHdoZXJlKCdhJywgJz49JywgJ2EnKS5vcmRlckJ5KCdhJykub3JkZXJCeSgnYicpICAgICB8IGEgQVNDLCBiIEFTQ1xuICogd2hlcmUoJ2EnLCAnPj0nLCAnYScpLm9yZGVyQnkoJ2EnKS5vcmRlckJ5KCdiJykgICAgIHwgYSBBU0NcbiAqIHdoZXJlKCdhJywgJ2FycmF5LWNvbnRhaW5zJywgJ2EnKS5vcmRlckJ5KCdiJykgICAgICB8IGEgQ09OVEFJTlMsIGIgQVNDRU5ESU5HXG4gKiB3aGVyZSgnYScsICdhcnJheS1jb250YWlucycsICdhJykub3JkZXJCeSgnYicpICAgICAgfCBhIENPTlRBSU5TXG4gKi8gKGUpO1xufVxuXG5jbGFzcyBfX1BSSVZBVEVfVGFyZ2V0SW5kZXhNYXRjaGVyIHtcbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIC8vIFRoZSBpbmVxdWFsaXR5IGZpbHRlcnMgb2YgdGhlIHRhcmdldCAoaWYgaXQgZXhpc3RzKS5cbiAgICAgICAgLy8gTm90ZTogVGhlIHNvcnQgb24gRmllbGRGaWx0ZXJzIGlzIG5vdCByZXF1aXJlZC4gVXNpbmcgU29ydGVkU2V0IGhlcmUganVzdCB0byB1dGlsaXplIHRoZSBjdXN0b21cbiAgICAgICAgLy8gY29tcGFyYXRvci5cbiAgICAgICAgdGhpcy5tbiA9IG5ldyBTb3J0ZWRTZXQoKChlLCB0KSA9PiBGaWVsZFBhdGgkMS5jb21wYXJhdG9yKGUuZmllbGQsIHQuZmllbGQpKSksIHRoaXMuY29sbGVjdGlvbklkID0gbnVsbCAhPSBlLmNvbGxlY3Rpb25Hcm91cCA/IGUuY29sbGVjdGlvbkdyb3VwIDogZS5wYXRoLmxhc3RTZWdtZW50KCksIFxuICAgICAgICB0aGlzLmZuID0gZS5vcmRlckJ5LCB0aGlzLmduID0gW107XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBlLmZpbHRlcnMpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0O1xuICAgICAgICAgICAgZS5pc0luZXF1YWxpdHkoKSA/IHRoaXMubW4gPSB0aGlzLm1uLmFkZChlKSA6IHRoaXMuZ24ucHVzaChlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgcG4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1uLnNpemUgPiAxO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHdoZXRoZXIgdGhlIGluZGV4IGNhbiBiZSB1c2VkIHRvIHNlcnZlIHRoZSBUYXJnZXRJbmRleE1hdGNoZXInc1xuICAgICAqIHRhcmdldC5cbiAgICAgKlxuICAgICAqIEFuIGluZGV4IGlzIGNvbnNpZGVyZWQgY2FwYWJsZSBvZiBzZXJ2aW5nIHRoZSB0YXJnZXQgd2hlbjpcbiAgICAgKiAtIFRoZSB0YXJnZXQgdXNlcyBhbGwgaW5kZXggc2VnbWVudHMgZm9yIGl0cyBmaWx0ZXJzIGFuZCBvcmRlckJ5IGNsYXVzZXMuXG4gICAgICogICBUaGUgdGFyZ2V0IGNhbiBoYXZlIGFkZGl0aW9uYWwgZmlsdGVyIGFuZCBvcmRlckJ5IGNsYXVzZXMsIGJ1dCBub3RcbiAgICAgKiAgIGZld2VyLlxuICAgICAqIC0gSWYgYW4gQXJyYXlDb250YWlucy9BcnJheUNvbnRhaW5zQW55ZmlsdGVyIGlzIHVzZWQsIHRoZSBpbmRleCBtdXN0IGFsc29cbiAgICAgKiAgIGhhdmUgYSBjb3JyZXNwb25kaW5nIGBDT05UQUlOU2Agc2VnbWVudC5cbiAgICAgKiAtIEFsbCBkaXJlY3Rpb25hbCBpbmRleCBzZWdtZW50cyBjYW4gYmUgbWFwcGVkIHRvIHRoZSB0YXJnZXQgYXMgYSBzZXJpZXMgb2ZcbiAgICAgKiAgIGVxdWFsaXR5IGZpbHRlcnMsIGEgc2luZ2xlIGluZXF1YWxpdHkgZmlsdGVyIGFuZCBhIHNlcmllcyBvZiBvcmRlckJ5XG4gICAgICogICBjbGF1c2VzLlxuICAgICAqIC0gVGhlIHNlZ21lbnRzIHRoYXQgcmVwcmVzZW50IHRoZSBlcXVhbGl0eSBmaWx0ZXJzIG1heSBhcHBlYXIgb3V0IG9mIG9yZGVyLlxuICAgICAqIC0gVGhlIG9wdGlvbmFsIHNlZ21lbnQgZm9yIHRoZSBpbmVxdWFsaXR5IGZpbHRlciBtdXN0IGFwcGVhciBhZnRlciBhbGxcbiAgICAgKiAgIGVxdWFsaXR5IHNlZ21lbnRzLlxuICAgICAqIC0gVGhlIHNlZ21lbnRzIHRoYXQgcmVwcmVzZW50IHRoYXQgb3JkZXJCeSBjbGF1c2Ugb2YgdGhlIHRhcmdldCBtdXN0IGFwcGVhclxuICAgICAqICAgaW4gb3JkZXIgYWZ0ZXIgYWxsIGVxdWFsaXR5IGFuZCBpbmVxdWFsaXR5IHNlZ21lbnRzLiBTaW5nbGUgb3JkZXJCeVxuICAgICAqICAgY2xhdXNlcyBjYW5ub3QgYmUgc2tpcHBlZCwgYnV0IGEgY29udGludW91cyBvcmRlckJ5IHN1ZmZpeCBtYXkgYmVcbiAgICAgKiAgIG9taXR0ZWQuXG4gICAgICovICAgIHluKGUpIHtcbiAgICAgICAgaWYgKF9fUFJJVkFURV9oYXJkQXNzZXJ0KGUuY29sbGVjdGlvbkdyb3VwID09PSB0aGlzLmNvbGxlY3Rpb25JZCwgNDkyNzkpLCB0aGlzLnBuKSBcbiAgICAgICAgLy8gT25seSBzaW5nbGUgaW5lcXVhbGl0eSBpcyBzdXBwb3J0ZWQgZm9yIG5vdy5cbiAgICAgICAgLy8gVE9ETyhBZGQgc3VwcG9ydCBmb3IgbXVsdGlwbGUgaW5lcXVhbGl0eSBxdWVyeSk6IGIvMjk4NDQxMDQzXG4gICAgICAgIHJldHVybiAhMTtcbiAgICAgICAgLy8gSWYgdGhlcmUgaXMgYW4gYXJyYXkgZWxlbWVudCwgZmluZCBhIG1hdGNoaW5nIGZpbHRlci5cbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gX19QUklWQVRFX2ZpZWxkSW5kZXhHZXRBcnJheVNlZ21lbnQoZSk7XG4gICAgICAgIGlmICh2b2lkIDAgIT09IHQgJiYgIXRoaXMud24odCkpIHJldHVybiAhMTtcbiAgICAgICAgY29uc3QgbiA9IF9fUFJJVkFURV9maWVsZEluZGV4R2V0RGlyZWN0aW9uYWxTZWdtZW50cyhlKTtcbiAgICAgICAgbGV0IHIgPSBuZXcgU2V0LCBpID0gMCwgcyA9IDA7XG4gICAgICAgIC8vIFByb2Nlc3MgYWxsIGVxdWFsaXRpZXMgZmlyc3QuIEVxdWFsaXRpZXMgY2FuIGFwcGVhciBvdXQgb2Ygb3JkZXIuXG4gICAgICAgIGZvciAoO2kgPCBuLmxlbmd0aCAmJiB0aGlzLnduKG5baV0pOyArK2kpIHIgPSByLmFkZChuW2ldLmZpZWxkUGF0aC5jYW5vbmljYWxTdHJpbmcoKSk7XG4gICAgICAgIC8vIElmIHdlIGFscmVhZHkgaGF2ZSBwcm9jZXNzZWQgYWxsIHNlZ21lbnRzLCBhbGwgc2VnbWVudHMgYXJlIHVzZWQgdG8gc2VydmVcbiAgICAgICAgLy8gdGhlIGVxdWFsaXR5IGZpbHRlcnMgYW5kIHdlIGRvIG5vdCBuZWVkIHRvIG1hcCBhbnkgc2VnbWVudHMgdG8gdGhlXG4gICAgICAgIC8vIHRhcmdldCdzIGluZXF1YWxpdHkgYW5kIG9yZGVyQnkgY2xhdXNlcy5cbiAgICAgICAgICAgICAgICBpZiAoaSA9PT0gbi5sZW5ndGgpIHJldHVybiAhMDtcbiAgICAgICAgaWYgKHRoaXMubW4uc2l6ZSA+IDApIHtcbiAgICAgICAgICAgIC8vIE9ubHkgYSBzaW5nbGUgaW5lcXVhbGl0eSBpcyBjdXJyZW50bHkgc3VwcG9ydGVkLiBHZXQgdGhlIG9ubHkgZW50cnkgaW4gdGhlIHNldC5cbiAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLm1uLmdldEl0ZXJhdG9yKCkuZ2V0TmV4dCgpO1xuICAgICAgICAgICAgLy8gSWYgdGhlcmUgaXMgYW4gaW5lcXVhbGl0eSBmaWx0ZXIgYW5kIHRoZSBmaWVsZCB3YXMgbm90IGluIG9uZSBvZiB0aGVcbiAgICAgICAgICAgIC8vIGVxdWFsaXR5IGZpbHRlcnMgYWJvdmUsIHRoZSBuZXh0IHNlZ21lbnQgbXVzdCBtYXRjaCBib3RoIHRoZSBmaWx0ZXJcbiAgICAgICAgICAgIC8vIGFuZCB0aGUgZmlyc3Qgb3JkZXJCeSBjbGF1c2UuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXIuaGFzKGUuZmllbGQuY2Fub25pY2FsU3RyaW5nKCkpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IG5baV07XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLlNuKGUsIHQpIHx8ICF0aGlzLmJuKHRoaXMuZm5bcysrXSwgdCkpIHJldHVybiAhMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICsraTtcbiAgICAgICAgfVxuICAgICAgICAvLyBBbGwgcmVtYWluaW5nIHNlZ21lbnRzIG5lZWQgdG8gcmVwcmVzZW50IHRoZSBwcmVmaXggb2YgdGhlIHRhcmdldCdzXG4gICAgICAgIC8vIG9yZGVyQnkuXG4gICAgICAgICAgICAgICAgZm9yICg7aSA8IG4ubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBuW2ldO1xuICAgICAgICAgICAgaWYgKHMgPj0gdGhpcy5mbi5sZW5ndGggfHwgIXRoaXMuYm4odGhpcy5mbltzKytdLCBlKSkgcmV0dXJuICExO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGZ1bGwgbWF0Y2hlZCBmaWVsZCBpbmRleCBmb3IgdGhpcyB0YXJnZXQuIEN1cnJlbnRseSBtdWx0aXBsZVxuICAgICAqIGluZXF1YWxpdHkgcXVlcnkgaXMgbm90IHN1cHBvcnRlZCBzbyBmdW5jdGlvbiByZXR1cm5zIG51bGwuXG4gICAgICovICAgIERuKCkge1xuICAgICAgICBpZiAodGhpcy5wbikgcmV0dXJuIG51bGw7XG4gICAgICAgIC8vIFdlIHdhbnQgdG8gbWFrZSBzdXJlIG9ubHkgb25lIHNlZ21lbnQgY3JlYXRlZCBmb3Igb25lIGZpZWxkLiBGb3IgZXhhbXBsZSxcbiAgICAgICAgLy8gaW4gY2FzZSBsaWtlIGEgPT0gMyBhbmQgYSA+IDIsIEluZGV4IHthIEFTQ0VORElOR30gd2lsbCBvbmx5IGJlIGNyZWF0ZWRcbiAgICAgICAgLy8gb25jZS5cbiAgICAgICAgICAgICAgICBsZXQgZSA9IG5ldyBTb3J0ZWRTZXQoRmllbGRQYXRoJDEuY29tcGFyYXRvcik7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBuIG9mIHRoaXMuZ24pIHtcbiAgICAgICAgICAgIGlmIChuLmZpZWxkLmlzS2V5RmllbGQoKSkgY29udGludWU7XG4gICAgICAgICAgICBpZiAoXCJhcnJheS1jb250YWluc1wiIC8qIE9wZXJhdG9yLkFSUkFZX0NPTlRBSU5TICovID09PSBuLm9wIHx8IFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogT3BlcmF0b3IuQVJSQVlfQ09OVEFJTlNfQU5ZICovID09PSBuLm9wKSB0LnB1c2gobmV3IEluZGV4U2VnbWVudChuLmZpZWxkLCAyIC8qIEluZGV4S2luZC5DT05UQUlOUyAqLykpOyBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoZS5oYXMobi5maWVsZCkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGUgPSBlLmFkZChuLmZpZWxkKSwgdC5wdXNoKG5ldyBJbmRleFNlZ21lbnQobi5maWVsZCwgMCAvKiBJbmRleEtpbmQuQVNDRU5ESU5HICovKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gTm90ZTogV2UgZG8gbm90IGV4cGxpY2l0bHkgY2hlY2sgYHRoaXMuaW5lcXVhbGl0eUZpbHRlcmAgYnV0IHJhdGhlciByZWx5XG4gICAgICAgIC8vIG9uIHRoZSB0YXJnZXQgZGVmaW5pbmcgYW4gYXBwcm9wcmlhdGUgXCJvcmRlciBieVwiIHRvIGVuc3VyZSB0aGF0IHRoZVxuICAgICAgICAvLyByZXF1aXJlZCBpbmRleCBzZWdtZW50IGlzIGFkZGVkLiBUaGUgcXVlcnkgZW5naW5lIHdvdWxkIHJlamVjdCBhIHF1ZXJ5XG4gICAgICAgIC8vIHdpdGggYW4gaW5lcXVhbGl0eSBmaWx0ZXIgdGhhdCBsYWNrcyB0aGUgcmVxdWlyZWQgb3JkZXItYnkgY2xhdXNlLlxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbiBvZiB0aGlzLmZuKSBcbiAgICAgICAgLy8gU3RvcCBhZGRpbmcgbW9yZSBzZWdtZW50cyBpZiB3ZSBzZWUgYSBvcmRlci1ieSBvbiBrZXkuIFR5cGljYWxseSB0aGlzXG4gICAgICAgIC8vIGlzIHRoZSBkZWZhdWx0IGltcGxpY2l0IG9yZGVyLWJ5IHdoaWNoIGlzIGNvdmVyZWQgaW4gdGhlIGluZGV4X2VudHJ5XG4gICAgICAgIC8vIHRhYmxlIGFzIGEgc2VwYXJhdGUgY29sdW1uLiBJZiBpdCBpcyBub3QgdGhlIGRlZmF1bHQgb3JkZXItYnksIHRoZVxuICAgICAgICAvLyBnZW5lcmF0ZWQgaW5kZXggd2lsbCBiZSBtaXNzaW5nIHNvbWUgc2VnbWVudHMgb3B0aW1pemVkIGZvciBvcmRlci1ieXMsXG4gICAgICAgIC8vIHdoaWNoIGlzIHByb2JhYmx5IGZpbmUuXG4gICAgICAgIG4uZmllbGQuaXNLZXlGaWVsZCgpIHx8IGUuaGFzKG4uZmllbGQpIHx8IChlID0gZS5hZGQobi5maWVsZCksIHQucHVzaChuZXcgSW5kZXhTZWdtZW50KG4uZmllbGQsIFwiYXNjXCIgLyogRGlyZWN0aW9uLkFTQ0VORElORyAqLyA9PT0gbi5kaXIgPyAwIC8qIEluZGV4S2luZC5BU0NFTkRJTkcgKi8gOiAxIC8qIEluZGV4S2luZC5ERVNDRU5ESU5HICovKSkpO1xuICAgICAgICByZXR1cm4gbmV3IEZpZWxkSW5kZXgoRmllbGRJbmRleC5VTktOT1dOX0lELCB0aGlzLmNvbGxlY3Rpb25JZCwgdCwgSW5kZXhTdGF0ZS5lbXB0eSgpKTtcbiAgICB9XG4gICAgd24oZSkge1xuICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5nbikgaWYgKHRoaXMuU24odCwgZSkpIHJldHVybiAhMDtcbiAgICAgICAgcmV0dXJuICExO1xuICAgIH1cbiAgICBTbihlLCB0KSB7XG4gICAgICAgIGlmICh2b2lkIDAgPT09IGUgfHwgIWUuZmllbGQuaXNFcXVhbCh0LmZpZWxkUGF0aCkpIHJldHVybiAhMTtcbiAgICAgICAgY29uc3QgbiA9IFwiYXJyYXktY29udGFpbnNcIiAvKiBPcGVyYXRvci5BUlJBWV9DT05UQUlOUyAqLyA9PT0gZS5vcCB8fCBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIE9wZXJhdG9yLkFSUkFZX0NPTlRBSU5TX0FOWSAqLyA9PT0gZS5vcDtcbiAgICAgICAgcmV0dXJuIDIgLyogSW5kZXhLaW5kLkNPTlRBSU5TICovID09PSB0LmtpbmQgPT09IG47XG4gICAgfVxuICAgIGJuKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuICEhZS5maWVsZC5pc0VxdWFsKHQuZmllbGRQYXRoKSAmJiAoMCAvKiBJbmRleEtpbmQuQVNDRU5ESU5HICovID09PSB0LmtpbmQgJiYgXCJhc2NcIiAvKiBEaXJlY3Rpb24uQVNDRU5ESU5HICovID09PSBlLmRpciB8fCAxIC8qIEluZGV4S2luZC5ERVNDRU5ESU5HICovID09PSB0LmtpbmQgJiYgXCJkZXNjXCIgLyogRGlyZWN0aW9uLkRFU0NFTkRJTkcgKi8gPT09IGUuZGlyKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFByb3ZpZGVzIHV0aWxpdHkgZnVuY3Rpb25zIHRoYXQgaGVscCB3aXRoIGJvb2xlYW4gbG9naWMgdHJhbnNmb3JtYXRpb25zIG5lZWRlZCBmb3IgaGFuZGxpbmdcbiAqIGNvbXBsZXggZmlsdGVycyB1c2VkIGluIHF1ZXJpZXMuXG4gKi9cbi8qKlxuICogVGhlIGBpbmAgZmlsdGVyIGlzIG9ubHkgYSBzeW50YWN0aWMgc3VnYXIgb3ZlciBhIGRpc2p1bmN0aW9uIG9mIGVxdWFsaXRpZXMuIEZvciBpbnN0YW5jZTogYGEgaW5cbiAqIFsxLDIsM11gIGlzIGluIGZhY3QgYGE9PTEgfHwgYT09MiB8fCBhPT0zYC4gVGhpcyBtZXRob2QgZXhwYW5kcyBhbnkgYGluYCBmaWx0ZXIgaW4gdGhlIGdpdmVuXG4gKiBpbnB1dCBpbnRvIGEgZGlzanVuY3Rpb24gb2YgZXF1YWxpdHkgZmlsdGVycyBhbmQgcmV0dXJucyB0aGUgZXhwYW5kZWQgZmlsdGVyLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9jb21wdXRlSW5FeHBhbnNpb24oZSkge1xuICAgIGlmIChfX1BSSVZBVEVfaGFyZEFzc2VydChlIGluc3RhbmNlb2YgRmllbGRGaWx0ZXIgfHwgZSBpbnN0YW5jZW9mIENvbXBvc2l0ZUZpbHRlciwgMjAwMTIpLCBcbiAgICBlIGluc3RhbmNlb2YgRmllbGRGaWx0ZXIpIHtcbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBfX1BSSVZBVEVfSW5GaWx0ZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBlLnZhbHVlLmFycmF5VmFsdWU/LnZhbHVlcz8ubWFwKCh0ID0+IEZpZWxkRmlsdGVyLmNyZWF0ZShlLmZpZWxkLCBcIj09XCIgLyogT3BlcmF0b3IuRVFVQUwgKi8gLCB0KSkpIHx8IFtdO1xuICAgICAgICAgICAgcmV0dXJuIENvbXBvc2l0ZUZpbHRlci5jcmVhdGUodCwgXCJvclwiIC8qIENvbXBvc2l0ZU9wZXJhdG9yLk9SICovKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBXZSBoYXZlIHJlYWNoZWQgb3RoZXIga2luZHMgb2YgZmllbGQgZmlsdGVycy5cbiAgICAgICAgcmV0dXJuIGU7XG4gICAgfVxuICAgIC8vIFdlIGhhdmUgYSBjb21wb3NpdGUgZmlsdGVyLlxuICAgICAgICBjb25zdCB0ID0gZS5maWx0ZXJzLm1hcCgoZSA9PiBfX1BSSVZBVEVfY29tcHV0ZUluRXhwYW5zaW9uKGUpKSk7XG4gICAgcmV0dXJuIENvbXBvc2l0ZUZpbHRlci5jcmVhdGUodCwgZS5vcCk7XG59XG5cbi8qKlxuICogR2l2ZW4gYSBjb21wb3NpdGUgZmlsdGVyLCByZXR1cm5zIHRoZSBsaXN0IG9mIHRlcm1zIGluIGl0cyBkaXNqdW5jdGl2ZSBub3JtYWwgZm9ybS5cbiAqXG4gKiA8cD5FYWNoIGVsZW1lbnQgaW4gdGhlIHJldHVybiB2YWx1ZSBpcyBvbmUgdGVybSBvZiB0aGUgcmVzdWx0aW5nIERORi4gRm9yIGluc3RhbmNlOiBGb3IgdGhlXG4gKiBpbnB1dDogKEEgfHwgQikgJiYgQywgdGhlIERORiBmb3JtIGlzOiAoQSAmJiBDKSB8fCAoQiAmJiBDKSwgYW5kIHRoZSByZXR1cm4gdmFsdWUgaXMgYSBsaXN0XG4gKiB3aXRoIHR3byBlbGVtZW50czogYSBjb21wb3NpdGUgZmlsdGVyIHRoYXQgcGVyZm9ybXMgKEEgJiYgQyksIGFuZCBhIGNvbXBvc2l0ZSBmaWx0ZXIgdGhhdFxuICogcGVyZm9ybXMgKEIgJiYgQykuXG4gKlxuICogQHBhcmFtIGZpbHRlciB0aGUgY29tcG9zaXRlIGZpbHRlciB0byBjYWxjdWxhdGUgRE5GIHRyYW5zZm9ybSBmb3IuXG4gKiBAcmV0dXJuIHRoZSB0ZXJtcyBpbiB0aGUgRE5GIHRyYW5zZm9ybS5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfZ2V0RG5mVGVybXMoZSkge1xuICAgIGlmICgwID09PSBlLmdldEZpbHRlcnMoKS5sZW5ndGgpIHJldHVybiBbXTtcbiAgICBjb25zdCB0ID0gX19QUklWQVRFX2NvbXB1dGVEaXN0cmlidXRlZE5vcm1hbEZvcm0oX19QUklWQVRFX2NvbXB1dGVJbkV4cGFuc2lvbihlKSk7XG4gICAgcmV0dXJuIF9fUFJJVkFURV9oYXJkQXNzZXJ0KF9fUFJJVkFURV9pc0Rpc2p1bmN0aXZlTm9ybWFsRm9ybSh0KSwgNzM5MSksIF9fUFJJVkFURV9pc1NpbmdsZUZpZWxkRmlsdGVyKHQpIHx8IF9fUFJJVkFURV9pc0ZsYXRDb25qdW5jdGlvbih0KSA/IFsgdCBdIDogdC5nZXRGaWx0ZXJzKCk7XG59XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIGZpbHRlciBpcyBhIHNpbmdsZSBmaWVsZCBmaWx0ZXIuIGUuZy4gKGEgPT0gMTApLiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfaXNTaW5nbGVGaWVsZEZpbHRlcihlKSB7XG4gICAgcmV0dXJuIGUgaW5zdGFuY2VvZiBGaWVsZEZpbHRlcjtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIGZpbHRlciBpcyB0aGUgY29uanVuY3Rpb24gb2Ygb25lIG9yIG1vcmUgZmllbGQgZmlsdGVycy4gZS5nLiAoYSA9PSAxMFxuICogJiYgYiA9PSAyMClcbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfaXNGbGF0Q29uanVuY3Rpb24oZSkge1xuICAgIHJldHVybiBlIGluc3RhbmNlb2YgQ29tcG9zaXRlRmlsdGVyICYmIF9fUFJJVkFURV9jb21wb3NpdGVGaWx0ZXJJc0ZsYXRDb25qdW5jdGlvbihlKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHdoZXRoZXIgb3Igbm90IHRoZSBnaXZlbiBmaWx0ZXIgaXMgaW4gZGlzanVuY3RpdmUgbm9ybWFsIGZvcm0gKERORikuXG4gKlxuICogPHA+SW4gYm9vbGVhbiBsb2dpYywgYSBkaXNqdW5jdGl2ZSBub3JtYWwgZm9ybSAoRE5GKSBpcyBhIGNhbm9uaWNhbCBub3JtYWwgZm9ybSBvZiBhIGxvZ2ljYWxcbiAqIGZvcm11bGEgY29uc2lzdGluZyBvZiBhIGRpc2p1bmN0aW9uIG9mIGNvbmp1bmN0aW9uczsgaXQgY2FuIGFsc28gYmUgZGVzY3JpYmVkIGFzIGFuIE9SIG9mIEFORHMuXG4gKlxuICogPHA+Rm9yIG1vcmUgaW5mbywgdmlzaXQ6IGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0Rpc2p1bmN0aXZlX25vcm1hbF9mb3JtXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX2lzRGlzanVuY3RpdmVOb3JtYWxGb3JtKGUpIHtcbiAgICByZXR1cm4gX19QUklWQVRFX2lzU2luZ2xlRmllbGRGaWx0ZXIoZSkgfHwgX19QUklWQVRFX2lzRmxhdENvbmp1bmN0aW9uKGUpIHx8IFxuICAgIC8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBmaWx0ZXIgaXMgdGhlIGRpc2p1bmN0aW9uIG9mIG9uZSBvciBtb3JlIFwiZmxhdCBjb25qdW5jdGlvbnNcIiBhbmRcbiAqIGZpZWxkIGZpbHRlcnMuIGUuZy4gKGEgPT0gMTApIHx8IChiPT0yMCAmJiBjPT0zMClcbiAqL1xuICAgIGZ1bmN0aW9uIF9fUFJJVkFURV9pc0Rpc2p1bmN0aW9uT2ZGaWVsZEZpbHRlcnNBbmRGbGF0Q29uanVuY3Rpb25zKGUpIHtcbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBDb21wb3NpdGVGaWx0ZXIgJiYgX19QUklWQVRFX2NvbXBvc2l0ZUZpbHRlcklzRGlzanVuY3Rpb24oZSkpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBlLmdldEZpbHRlcnMoKSkgaWYgKCFfX1BSSVZBVEVfaXNTaW5nbGVGaWVsZEZpbHRlcih0KSAmJiAhX19QUklWQVRFX2lzRmxhdENvbmp1bmN0aW9uKHQpKSByZXR1cm4gITE7XG4gICAgICAgICAgICByZXR1cm4gITA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICExO1xuICAgIH0oZSk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9jb21wdXRlRGlzdHJpYnV0ZWROb3JtYWxGb3JtKGUpIHtcbiAgICBpZiAoX19QUklWQVRFX2hhcmRBc3NlcnQoZSBpbnN0YW5jZW9mIEZpZWxkRmlsdGVyIHx8IGUgaW5zdGFuY2VvZiBDb21wb3NpdGVGaWx0ZXIsIDM0MDE4KSwgXG4gICAgZSBpbnN0YW5jZW9mIEZpZWxkRmlsdGVyKSByZXR1cm4gZTtcbiAgICBpZiAoMSA9PT0gZS5maWx0ZXJzLmxlbmd0aCkgcmV0dXJuIF9fUFJJVkFURV9jb21wdXRlRGlzdHJpYnV0ZWROb3JtYWxGb3JtKGUuZmlsdGVyc1swXSk7XG4gICAgLy8gQ29tcHV0ZSBETkYgZm9yIGVhY2ggb2YgdGhlIHN1YmZpbHRlcnMgZmlyc3RcbiAgICAgICAgY29uc3QgdCA9IGUuZmlsdGVycy5tYXAoKGUgPT4gX19QUklWQVRFX2NvbXB1dGVEaXN0cmlidXRlZE5vcm1hbEZvcm0oZSkpKTtcbiAgICBsZXQgbiA9IENvbXBvc2l0ZUZpbHRlci5jcmVhdGUodCwgZS5vcCk7XG4gICAgcmV0dXJuIG4gPSBfX1BSSVZBVEVfYXBwbHlBc3NvY2lhdGlvbihuKSwgX19QUklWQVRFX2lzRGlzanVuY3RpdmVOb3JtYWxGb3JtKG4pID8gbiA6IChfX1BSSVZBVEVfaGFyZEFzc2VydChuIGluc3RhbmNlb2YgQ29tcG9zaXRlRmlsdGVyLCA2NDQ5OCksIFxuICAgIF9fUFJJVkFURV9oYXJkQXNzZXJ0KF9fUFJJVkFURV9jb21wb3NpdGVGaWx0ZXJJc0Nvbmp1bmN0aW9uKG4pLCA0MDI1MSksIF9fUFJJVkFURV9oYXJkQXNzZXJ0KG4uZmlsdGVycy5sZW5ndGggPiAxLCA1NzkyNyksIFxuICAgIG4uZmlsdGVycy5yZWR1Y2UoKChlLCB0KSA9PiBfX1BSSVZBVEVfYXBwbHlEaXN0cmlidXRpb24oZSwgdCkpKSk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9hcHBseURpc3RyaWJ1dGlvbihlLCB0KSB7XG4gICAgbGV0IG47XG4gICAgcmV0dXJuIF9fUFJJVkFURV9oYXJkQXNzZXJ0KGUgaW5zdGFuY2VvZiBGaWVsZEZpbHRlciB8fCBlIGluc3RhbmNlb2YgQ29tcG9zaXRlRmlsdGVyLCAzODM4OCksIFxuICAgIF9fUFJJVkFURV9oYXJkQXNzZXJ0KHQgaW5zdGFuY2VvZiBGaWVsZEZpbHRlciB8fCB0IGluc3RhbmNlb2YgQ29tcG9zaXRlRmlsdGVyLCAyNTQ3MyksIFxuICAgIC8vIEZpZWxkRmlsdGVyIEZpZWxkRmlsdGVyXG4gICAgbiA9IGUgaW5zdGFuY2VvZiBGaWVsZEZpbHRlciA/IHQgaW5zdGFuY2VvZiBGaWVsZEZpbHRlciA/IGZ1bmN0aW9uIF9fUFJJVkFURV9hcHBseURpc3RyaWJ1dGlvbkZpZWxkRmlsdGVycyhlLCB0KSB7XG4gICAgICAgIC8vIENvbmp1bmN0aW9uIGRpc3RyaWJ1dGlvbiBmb3IgdHdvIGZpZWxkIGZpbHRlcnMgaXMgdGhlIGNvbmp1bmN0aW9uIG9mIHRoZW0uXG4gICAgICAgIHJldHVybiBDb21wb3NpdGVGaWx0ZXIuY3JlYXRlKFsgZSwgdCBdLCBcImFuZFwiIC8qIENvbXBvc2l0ZU9wZXJhdG9yLkFORCAqLyk7XG4gICAgfShlLCB0KSA6IF9fUFJJVkFURV9hcHBseURpc3RyaWJ1dGlvbkZpZWxkQW5kQ29tcG9zaXRlRmlsdGVycyhlLCB0KSA6IHQgaW5zdGFuY2VvZiBGaWVsZEZpbHRlciA/IF9fUFJJVkFURV9hcHBseURpc3RyaWJ1dGlvbkZpZWxkQW5kQ29tcG9zaXRlRmlsdGVycyh0LCBlKSA6IGZ1bmN0aW9uIF9fUFJJVkFURV9hcHBseURpc3RyaWJ1dGlvbkNvbXBvc2l0ZUZpbHRlcnMoZSwgdCkge1xuICAgICAgICAvLyBUaGVyZSBhcmUgZm91ciBjYXNlczpcbiAgICAgICAgLy8gKEEgJiBCKSAmIChDICYgRCkgLS0+IChBICYgQiAmIEMgJiBEKVxuICAgICAgICAvLyAoQSAmIEIpICYgKEMgfCBEKSAtLT4gKEEgJiBCICYgQykgfCAoQSAmIEIgJiBEKVxuICAgICAgICAvLyAoQSB8IEIpICYgKEMgJiBEKSAtLT4gKEMgJiBEICYgQSkgfCAoQyAmIEQgJiBCKVxuICAgICAgICAvLyAoQSB8IEIpICYgKEMgfCBEKSAtLT4gKEEgJiBDKSB8IChBICYgRCkgfCAoQiAmIEMpIHwgKEIgJiBEKVxuICAgICAgICAvLyBDYXNlIDEgaXMgYSBtZXJnZS5cbiAgICAgICAgaWYgKF9fUFJJVkFURV9oYXJkQXNzZXJ0KGUuZmlsdGVycy5sZW5ndGggPiAwICYmIHQuZmlsdGVycy5sZW5ndGggPiAwLCA0ODAwNSksIF9fUFJJVkFURV9jb21wb3NpdGVGaWx0ZXJJc0Nvbmp1bmN0aW9uKGUpICYmIF9fUFJJVkFURV9jb21wb3NpdGVGaWx0ZXJJc0Nvbmp1bmN0aW9uKHQpKSByZXR1cm4gX19QUklWQVRFX2NvbXBvc2l0ZUZpbHRlcldpdGhBZGRlZEZpbHRlcnMoZSwgdC5nZXRGaWx0ZXJzKCkpO1xuICAgICAgICAvLyBDYXNlIDIsMyw0IGFsbCBoYXZlIGF0IGxlYXN0IG9uZSBzaWRlIChsaHMgb3IgcmhzKSB0aGF0IGlzIGEgZGlzanVuY3Rpb24uIEluIGFsbCB0aHJlZSBjYXNlc1xuICAgICAgICAvLyB3ZSBzaG91bGQgdGFrZSBlYWNoIGVsZW1lbnQgb2YgdGhlIGRpc2p1bmN0aW9uIGFuZCBkaXN0cmlidXRlIGl0IG92ZXIgdGhlIG90aGVyIHNpZGUsIGFuZFxuICAgICAgICAvLyByZXR1cm4gdGhlIGRpc2p1bmN0aW9uIG9mIHRoZSBkaXN0cmlidXRpb24gcmVzdWx0cy5cbiAgICAgICAgICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX2NvbXBvc2l0ZUZpbHRlcklzRGlzanVuY3Rpb24oZSkgPyBlIDogdCwgciA9IF9fUFJJVkFURV9jb21wb3NpdGVGaWx0ZXJJc0Rpc2p1bmN0aW9uKGUpID8gdCA6IGUsIGkgPSBuLmZpbHRlcnMubWFwKChlID0+IF9fUFJJVkFURV9hcHBseURpc3RyaWJ1dGlvbihlLCByKSkpO1xuICAgICAgICByZXR1cm4gQ29tcG9zaXRlRmlsdGVyLmNyZWF0ZShpLCBcIm9yXCIgLyogQ29tcG9zaXRlT3BlcmF0b3IuT1IgKi8pO1xuICAgIH0oZSwgdCksIF9fUFJJVkFURV9hcHBseUFzc29jaWF0aW9uKG4pO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfYXBwbHlEaXN0cmlidXRpb25GaWVsZEFuZENvbXBvc2l0ZUZpbHRlcnMoZSwgdCkge1xuICAgIC8vIFRoZXJlIGFyZSB0d28gY2FzZXM6XG4gICAgLy8gQSAmIChCICYgQykgLS0+IChBICYgQiAmIEMpXG4gICAgLy8gQSAmIChCIHwgQykgLS0+IChBICYgQikgfCAoQSAmIEMpXG4gICAgaWYgKF9fUFJJVkFURV9jb21wb3NpdGVGaWx0ZXJJc0Nvbmp1bmN0aW9uKHQpKSBcbiAgICAvLyBDYXNlIDFcbiAgICByZXR1cm4gX19QUklWQVRFX2NvbXBvc2l0ZUZpbHRlcldpdGhBZGRlZEZpbHRlcnModCwgZS5nZXRGaWx0ZXJzKCkpO1xuICAgIHtcbiAgICAgICAgLy8gQ2FzZSAyXG4gICAgICAgIGNvbnN0IG4gPSB0LmZpbHRlcnMubWFwKCh0ID0+IF9fUFJJVkFURV9hcHBseURpc3RyaWJ1dGlvbihlLCB0KSkpO1xuICAgICAgICByZXR1cm4gQ29tcG9zaXRlRmlsdGVyLmNyZWF0ZShuLCBcIm9yXCIgLyogQ29tcG9zaXRlT3BlcmF0b3IuT1IgKi8pO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBcHBsaWVzIHRoZSBhc3NvY2lhdGl2aXR5IHByb3BlcnR5IHRvIHRoZSBnaXZlbiBmaWx0ZXIgYW5kIHJldHVybnMgdGhlIHJlc3VsdGluZyBmaWx0ZXIuXG4gKlxuICogPHVsPlxuICogICA8bGk+QSB8IChCIHwgQykgPT0gKEEgfCBCKSB8IEMgPT0gKEEgfCBCIHwgQylcbiAqICAgPGxpPkEgJiAoQiAmIEMpID09IChBICYgQikgJiBDID09IChBICYgQiAmIEMpXG4gKiA8L3VsPlxuICpcbiAqIDxwPkZvciBtb3JlIGluZm8sIHZpc2l0OiBodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Bc3NvY2lhdGl2ZV9wcm9wZXJ0eSNQcm9wb3NpdGlvbmFsX2xvZ2ljXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX2FwcGx5QXNzb2NpYXRpb24oZSkge1xuICAgIGlmIChfX1BSSVZBVEVfaGFyZEFzc2VydChlIGluc3RhbmNlb2YgRmllbGRGaWx0ZXIgfHwgZSBpbnN0YW5jZW9mIENvbXBvc2l0ZUZpbHRlciwgMTE4NTApLCBcbiAgICBlIGluc3RhbmNlb2YgRmllbGRGaWx0ZXIpIHJldHVybiBlO1xuICAgIGNvbnN0IHQgPSBlLmdldEZpbHRlcnMoKTtcbiAgICAvLyBJZiB0aGUgY29tcG9zaXRlIGZpbHRlciBvbmx5IGNvbnRhaW5zIDEgZmlsdGVyLCBhcHBseSBhc3NvY2lhdGl2aXR5IHRvIGl0LlxuICAgICAgICBpZiAoMSA9PT0gdC5sZW5ndGgpIHJldHVybiBfX1BSSVZBVEVfYXBwbHlBc3NvY2lhdGlvbih0WzBdKTtcbiAgICAvLyBBc3NvY2lhdGl2aXR5IGFwcGxpZWQgdG8gYSBmbGF0IGNvbXBvc2l0ZSBmaWx0ZXIgcmVzdWx0cyBpcyBpdHNlbGYuXG4gICAgICAgIGlmIChfX1BSSVZBVEVfY29tcG9zaXRlRmlsdGVySXNGbGF0KGUpKSByZXR1cm4gZTtcbiAgICAvLyBGaXJzdCBhcHBseSBhc3NvY2lhdGl2aXR5IHRvIGFsbCBzdWJmaWx0ZXJzLiBUaGlzIHdpbGwgaW4gdHVybiByZWN1cnNpdmVseSBhcHBseVxuICAgIC8vIGFzc29jaWF0aXZpdHkgdG8gYWxsIG5lc3RlZCBjb21wb3NpdGUgZmlsdGVycyBhbmQgZmllbGQgZmlsdGVycy5cbiAgICAgICAgY29uc3QgbiA9IHQubWFwKChlID0+IF9fUFJJVkFURV9hcHBseUFzc29jaWF0aW9uKGUpKSksIHIgPSBbXTtcbiAgICAvLyBGb3IgY29tcG9zaXRlIHN1YmZpbHRlcnMgdGhhdCBwZXJmb3JtIHRoZSBzYW1lIGtpbmQgb2YgbG9naWNhbCBvcGVyYXRpb24gYXMgYGNvbXBvc2l0ZUZpbHRlcmBcbiAgICAvLyB0YWtlIG91dCB0aGVpciBmaWx0ZXJzIGFuZCBhZGQgdGhlbSB0byBgY29tcG9zaXRlRmlsdGVyYC4gRm9yIGV4YW1wbGU6XG4gICAgLy8gY29tcG9zaXRlRmlsdGVyID0gKEEgfCAoQiB8IEMgfCBEKSlcbiAgICAvLyBjb21wb3NpdGVTdWJmaWx0ZXIgPSAoQiB8IEMgfCBEKVxuICAgIC8vIFJlc3VsdDogKEEgfCBCIHwgQyB8IEQpXG4gICAgLy8gTm90ZSB0aGF0IHRoZSBgY29tcG9zaXRlU3ViZmlsdGVyYCBoYXMgYmVlbiBlbGltaW5hdGVkLCBhbmQgaXRzIGZpbHRlcnMgKEIsIEMsIEQpIGhhdmUgYmVlblxuICAgIC8vIGFkZGVkIHRvIHRoZSB0b3AtbGV2ZWwgXCJjb21wb3NpdGVGaWx0ZXJcIi5cbiAgICAgICAgcmV0dXJuIG4uZm9yRWFjaCgodCA9PiB7XG4gICAgICAgIHQgaW5zdGFuY2VvZiBGaWVsZEZpbHRlciA/IHIucHVzaCh0KSA6IHQgaW5zdGFuY2VvZiBDb21wb3NpdGVGaWx0ZXIgJiYgKHQub3AgPT09IGUub3AgPyBcbiAgICAgICAgLy8gY29tcG9zaXRlRmlsdGVyOiAoQSB8IChCIHwgQykpXG4gICAgICAgIC8vIGNvbXBvc2l0ZVN1YmZpbHRlcjogKEIgfCBDKVxuICAgICAgICAvLyBSZXN1bHQ6IChBIHwgQiB8IEMpXG4gICAgICAgIHIucHVzaCguLi50LmZpbHRlcnMpIDogXG4gICAgICAgIC8vIGNvbXBvc2l0ZUZpbHRlcjogKEEgfCAoQiAmIEMpKVxuICAgICAgICAvLyBjb21wb3NpdGVTdWJmaWx0ZXI6IChCICYgQylcbiAgICAgICAgLy8gUmVzdWx0OiAoQSB8IChCICYgQykpXG4gICAgICAgIHIucHVzaCh0KSk7XG4gICAgfSkpLCAxID09PSByLmxlbmd0aCA/IHJbMF0gOiBDb21wb3NpdGVGaWx0ZXIuY3JlYXRlKHIsIGUub3ApO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBbiBpbi1tZW1vcnkgaW1wbGVtZW50YXRpb24gb2YgSW5kZXhNYW5hZ2VyLlxuICovIGNsYXNzIF9fUFJJVkFURV9NZW1vcnlJbmRleE1hbmFnZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLkNuID0gbmV3IF9fUFJJVkFURV9NZW1vcnlDb2xsZWN0aW9uUGFyZW50SW5kZXg7XG4gICAgfVxuICAgIGFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuQ24uYWRkKHQpLCBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBnZXRDb2xsZWN0aW9uUGFyZW50cyhlLCB0KSB7XG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0aGlzLkNuLmdldEVudHJpZXModCkpO1xuICAgIH1cbiAgICBhZGRGaWVsZEluZGV4KGUsIHQpIHtcbiAgICAgICAgLy8gRmllbGQgaW5kaWNlcyBhcmUgbm90IHN1cHBvcnRlZCB3aXRoIG1lbW9yeSBwZXJzaXN0ZW5jZS5cbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGRlbGV0ZUZpZWxkSW5kZXgoZSwgdCkge1xuICAgICAgICAvLyBGaWVsZCBpbmRpY2VzIGFyZSBub3Qgc3VwcG9ydGVkIHdpdGggbWVtb3J5IHBlcnNpc3RlbmNlLlxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgZGVsZXRlQWxsRmllbGRJbmRleGVzKGUpIHtcbiAgICAgICAgLy8gRmllbGQgaW5kaWNlcyBhcmUgbm90IHN1cHBvcnRlZCB3aXRoIG1lbW9yeSBwZXJzaXN0ZW5jZS5cbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGNyZWF0ZVRhcmdldEluZGV4ZXMoZSwgdCkge1xuICAgICAgICAvLyBGaWVsZCBpbmRpY2VzIGFyZSBub3Qgc3VwcG9ydGVkIHdpdGggbWVtb3J5IHBlcnNpc3RlbmNlLlxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgZ2V0RG9jdW1lbnRzTWF0Y2hpbmdUYXJnZXQoZSwgdCkge1xuICAgICAgICAvLyBGaWVsZCBpbmRpY2VzIGFyZSBub3Qgc3VwcG9ydGVkIHdpdGggbWVtb3J5IHBlcnNpc3RlbmNlLlxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUobnVsbCk7XG4gICAgfVxuICAgIGdldEluZGV4VHlwZShlLCB0KSB7XG4gICAgICAgIC8vIEZpZWxkIGluZGljZXMgYXJlIG5vdCBzdXBwb3J0ZWQgd2l0aCBtZW1vcnkgcGVyc2lzdGVuY2UuXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgwIC8qIEluZGV4VHlwZS5OT05FICovKTtcbiAgICB9XG4gICAgZ2V0RmllbGRJbmRleGVzKGUsIHQpIHtcbiAgICAgICAgLy8gRmllbGQgaW5kaWNlcyBhcmUgbm90IHN1cHBvcnRlZCB3aXRoIG1lbW9yeSBwZXJzaXN0ZW5jZS5cbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKFtdKTtcbiAgICB9XG4gICAgZ2V0TmV4dENvbGxlY3Rpb25Hcm91cFRvVXBkYXRlKGUpIHtcbiAgICAgICAgLy8gRmllbGQgaW5kaWNlcyBhcmUgbm90IHN1cHBvcnRlZCB3aXRoIG1lbW9yeSBwZXJzaXN0ZW5jZS5cbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xuICAgIH1cbiAgICBnZXRNaW5PZmZzZXQoZSwgdCkge1xuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoSW5kZXhPZmZzZXQubWluKCkpO1xuICAgIH1cbiAgICBnZXRNaW5PZmZzZXRGcm9tQ29sbGVjdGlvbkdyb3VwKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKEluZGV4T2Zmc2V0Lm1pbigpKTtcbiAgICB9XG4gICAgdXBkYXRlQ29sbGVjdGlvbkdyb3VwKGUsIHQsIG4pIHtcbiAgICAgICAgLy8gRmllbGQgaW5kaWNlcyBhcmUgbm90IHN1cHBvcnRlZCB3aXRoIG1lbW9yeSBwZXJzaXN0ZW5jZS5cbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHVwZGF0ZUluZGV4RW50cmllcyhlLCB0KSB7XG4gICAgICAgIC8vIEZpZWxkIGluZGljZXMgYXJlIG5vdCBzdXBwb3J0ZWQgd2l0aCBtZW1vcnkgcGVyc2lzdGVuY2UuXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBJbnRlcm5hbCBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgY29sbGVjdGlvbi1wYXJlbnQgaW5kZXggZXhwb3NlZCBieSBNZW1vcnlJbmRleE1hbmFnZXIuXG4gKiBBbHNvIHVzZWQgZm9yIGluLW1lbW9yeSBjYWNoaW5nIGJ5IEluZGV4ZWREYkluZGV4TWFuYWdlciBhbmQgaW5pdGlhbCBpbmRleCBwb3B1bGF0aW9uXG4gKiBpbiBpbmRleGVkZGJfc2NoZW1hLnRzXG4gKi8gY2xhc3MgX19QUklWQVRFX01lbW9yeUNvbGxlY3Rpb25QYXJlbnRJbmRleCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuaW5kZXggPSB7fTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBmYWxzZSBpZiB0aGUgZW50cnkgYWxyZWFkeSBleGlzdGVkLlxuICAgIGFkZChlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBlLmxhc3RTZWdtZW50KCksIG4gPSBlLnBvcExhc3QoKSwgciA9IHRoaXMuaW5kZXhbdF0gfHwgbmV3IFNvcnRlZFNldChSZXNvdXJjZVBhdGguY29tcGFyYXRvciksIGkgPSAhci5oYXMobik7XG4gICAgICAgIHJldHVybiB0aGlzLmluZGV4W3RdID0gci5hZGQobiksIGk7XG4gICAgfVxuICAgIGhhcyhlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBlLmxhc3RTZWdtZW50KCksIG4gPSBlLnBvcExhc3QoKSwgciA9IHRoaXMuaW5kZXhbdF07XG4gICAgICAgIHJldHVybiByICYmIHIuaGFzKG4pO1xuICAgIH1cbiAgICBnZXRFbnRyaWVzKGUpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLmluZGV4W2VdIHx8IG5ldyBTb3J0ZWRTZXQoUmVzb3VyY2VQYXRoLmNvbXBhcmF0b3IpKS50b0FycmF5KCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCBGdCA9IFwiSW5kZXhlZERiSW5kZXhNYW5hZ2VyXCIsIE10ID0gbmV3IFVpbnQ4QXJyYXkoMCk7XG5cbi8qKlxuICogQSBwZXJzaXN0ZWQgaW1wbGVtZW50YXRpb24gb2YgSW5kZXhNYW5hZ2VyLlxuICpcbiAqIFBPUlRJTkcgTk9URTogVW5saWtlIGlPUyBhbmQgQW5kcm9pZCwgdGhlIFdlYiBTREsgZG9lcyBub3QgbWVtb2l6ZSBpbmRleFxuICogZGF0YSBhcyBpdCBzdXBwb3J0cyBtdWx0aS10YWIgYWNjZXNzLlxuICovXG5jbGFzcyBfX1BSSVZBVEVfSW5kZXhlZERiSW5kZXhNYW5hZ2VyIHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0KSB7XG4gICAgICAgIHRoaXMuZGF0YWJhc2VJZCA9IHQsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQW4gaW4tbWVtb3J5IGNvcHkgb2YgdGhlIGluZGV4IGVudHJpZXMgd2UndmUgYWxyZWFkeSB3cml0dGVuIHNpbmNlIHRoZSBTREtcbiAgICAgICAgICogbGF1bmNoZWQuIFVzZWQgdG8gYXZvaWQgcmUtd3JpdGluZyB0aGUgc2FtZSBlbnRyeSByZXBlYXRlZGx5LlxuICAgICAgICAgKlxuICAgICAgICAgKiBUaGlzIGlzICpOT1QqIGEgY29tcGxldGUgY2FjaGUgb2Ygd2hhdCdzIGluIHBlcnNpc3RlbmNlIGFuZCBzbyBjYW4gbmV2ZXIgYmVcbiAgICAgICAgICogdXNlZCB0byBzYXRpc2Z5IHJlYWRzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy52biA9IG5ldyBfX1BSSVZBVEVfTWVtb3J5Q29sbGVjdGlvblBhcmVudEluZGV4LCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1hcHMgZnJvbSBhIHRhcmdldCB0byBpdHMgZXF1aXZhbGVudCBsaXN0IG9mIHN1Yi10YXJnZXRzLiBFYWNoIHN1Yi10YXJnZXRcbiAgICAgICAgICogY29udGFpbnMgb25seSBvbmUgdGVybSBmcm9tIHRoZSB0YXJnZXQncyBkaXNqdW5jdGl2ZSBub3JtYWwgZm9ybSAoRE5GKS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuRm4gPSBuZXcgT2JqZWN0TWFwKChlID0+IF9fUFJJVkFURV9jYW5vbmlmeVRhcmdldChlKSksICgoZSwgdCkgPT4gX19QUklWQVRFX3RhcmdldEVxdWFscyhlLCB0KSkpLCBcbiAgICAgICAgdGhpcy51aWQgPSBlLnVpZCB8fCBcIlwiO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgbmV3IGVudHJ5IHRvIHRoZSBjb2xsZWN0aW9uIHBhcmVudCBpbmRleC5cbiAgICAgKlxuICAgICAqIFJlcGVhdGVkIGNhbGxzIGZvciB0aGUgc2FtZSBjb2xsZWN0aW9uUGF0aCBzaG91bGQgYmUgYXZvaWRlZCB3aXRoaW4gYVxuICAgICAqIHRyYW5zYWN0aW9uIGFzIEluZGV4ZWREYkluZGV4TWFuYWdlciBvbmx5IGNhY2hlcyB3cml0ZXMgb25jZSBhIHRyYW5zYWN0aW9uXG4gICAgICogaGFzIGJlZW4gY29tbWl0dGVkLlxuICAgICAqLyAgICBhZGRUb0NvbGxlY3Rpb25QYXJlbnRJbmRleChlLCB0KSB7XG4gICAgICAgIGlmICghdGhpcy52bi5oYXModCkpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0Lmxhc3RTZWdtZW50KCksIHIgPSB0LnBvcExhc3QoKTtcbiAgICAgICAgICAgIGUuYWRkT25Db21taXR0ZWRMaXN0ZW5lcigoKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgY29sbGVjdGlvbiB0byB0aGUgaW4gbWVtb3J5IGNhY2hlIG9ubHkgaWYgdGhlIHRyYW5zYWN0aW9uIHdhc1xuICAgICAgICAgICAgICAgIC8vIHN1Y2Nlc3NmdWxseSBjb21taXR0ZWQuXG4gICAgICAgICAgICAgICAgdGhpcy52bi5hZGQodCk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBjb25zdCBpID0ge1xuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb25JZDogbixcbiAgICAgICAgICAgICAgICBwYXJlbnQ6IF9fUFJJVkFURV9lbmNvZGVSZXNvdXJjZVBhdGgocilcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gX19QUklWQVRFX2NvbGxlY3Rpb25QYXJlbnRzU3RvcmUoZSkucHV0KGkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBnZXRDb2xsZWN0aW9uUGFyZW50cyhlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSBbXSwgciA9IElEQktleVJhbmdlLmJvdW5kKFsgdCwgXCJcIiBdLCBbIF9fUFJJVkFURV9pbW1lZGlhdGVTdWNjZXNzb3IodCksIFwiXCIgXSwgXG4gICAgICAgIC8qbG93ZXJPcGVuPSovICExLCBcbiAgICAgICAgLyp1cHBlck9wZW49Ki8gITApO1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX2NvbGxlY3Rpb25QYXJlbnRzU3RvcmUoZSkuSihyKS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgciBvZiBlKSB7XG4gICAgICAgICAgICAgICAgLy8gVGhpcyBjb2xsZWN0aW9uSWQgZ3VhcmQgc2hvdWxkbid0IGJlIG5lY2Vzc2FyeSAoYW5kIGlzbid0IGFzIGxvbmdcbiAgICAgICAgICAgICAgICAvLyBhcyB3ZSdyZSBydW5uaW5nIGluIGEgcmVhbCBicm93c2VyKSwgYnV0IHRoZXJlJ3MgYSBidWcgaW5cbiAgICAgICAgICAgICAgICAvLyBpbmRleGVkZGJzaGltIHRoYXQgYnJlYWtzIG91ciByYW5nZSBpbiBvdXIgdGVzdHMgcnVubmluZyBpbiBub2RlOlxuICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9heGVtY2xpb24vSW5kZXhlZERCU2hpbS9pc3N1ZXMvMzM0XG4gICAgICAgICAgICAgICAgaWYgKHIuY29sbGVjdGlvbklkICE9PSB0KSBicmVhaztcbiAgICAgICAgICAgICAgICBuLnB1c2goX19QUklWQVRFX2RlY29kZVJlc291cmNlUGF0aChyLnBhcmVudCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG47XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgYWRkRmllbGRJbmRleChlLCB0KSB7XG4gICAgICAgIC8vIFRPRE8oaW5kZXhpbmcpOiBWZXJpZnkgdGhhdCB0aGUgYXV0by1pbmNyZW1lbnRpbmcgaW5kZXggSUQgd29ya3MgaW5cbiAgICAgICAgLy8gU2FmYXJpICYgRmlyZWZveC5cbiAgICAgICAgY29uc3QgbiA9IF9fUFJJVkFURV9pbmRleENvbmZpZ3VyYXRpb25TdG9yZShlKSwgciA9IGZ1bmN0aW9uIF9fUFJJVkFURV90b0RiSW5kZXhDb25maWd1cmF0aW9uKGUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaW5kZXhJZDogZS5pbmRleElkLFxuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb25Hcm91cDogZS5jb2xsZWN0aW9uR3JvdXAsXG4gICAgICAgICAgICAgICAgZmllbGRzOiBlLmZpZWxkcy5tYXAoKGUgPT4gWyBlLmZpZWxkUGF0aC5jYW5vbmljYWxTdHJpbmcoKSwgZS5raW5kIF0pKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSh0KTtcbiAgICAgICAgZGVsZXRlIHIuaW5kZXhJZDtcbiAgICAgICAgLy8gYGluZGV4SWRgIGlzIGF1dG8tcG9wdWxhdGVkIGJ5IEluZGV4ZWREYlxuICAgICAgICBjb25zdCBpID0gbi5hZGQocik7XG4gICAgICAgIGlmICh0LmluZGV4U3RhdGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfaW5kZXhTdGF0ZVN0b3JlKGUpO1xuICAgICAgICAgICAgcmV0dXJuIGkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgbi5wdXQoX19QUklWQVRFX3RvRGJJbmRleFN0YXRlKGUsIHRoaXMudWlkLCB0LmluZGV4U3RhdGUuc2VxdWVuY2VOdW1iZXIsIHQuaW5kZXhTdGF0ZS5vZmZzZXQpKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaS5uZXh0KCk7XG4gICAgfVxuICAgIGRlbGV0ZUZpZWxkSW5kZXgoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX2luZGV4Q29uZmlndXJhdGlvblN0b3JlKGUpLCByID0gX19QUklWQVRFX2luZGV4U3RhdGVTdG9yZShlKSwgaSA9IF9fUFJJVkFURV9pbmRleEVudHJpZXNTdG9yZShlKTtcbiAgICAgICAgcmV0dXJuIG4uZGVsZXRlKHQuaW5kZXhJZCkubmV4dCgoKCkgPT4gci5kZWxldGUoSURCS2V5UmFuZ2UuYm91bmQoWyB0LmluZGV4SWQgXSwgWyB0LmluZGV4SWQgKyAxIF0sIFxuICAgICAgICAvKmxvd2VyT3Blbj0qLyAhMSwgXG4gICAgICAgIC8qdXBwZXJPcGVuPSovICEwKSkpKS5uZXh0KCgoKSA9PiBpLmRlbGV0ZShJREJLZXlSYW5nZS5ib3VuZChbIHQuaW5kZXhJZCBdLCBbIHQuaW5kZXhJZCArIDEgXSwgXG4gICAgICAgIC8qbG93ZXJPcGVuPSovICExLCBcbiAgICAgICAgLyp1cHBlck9wZW49Ki8gITApKSkpO1xuICAgIH1cbiAgICBkZWxldGVBbGxGaWVsZEluZGV4ZXMoZSkge1xuICAgICAgICBjb25zdCB0ID0gX19QUklWQVRFX2luZGV4Q29uZmlndXJhdGlvblN0b3JlKGUpLCBuID0gX19QUklWQVRFX2luZGV4RW50cmllc1N0b3JlKGUpLCByID0gX19QUklWQVRFX2luZGV4U3RhdGVTdG9yZShlKTtcbiAgICAgICAgcmV0dXJuIHQuWigpLm5leHQoKCgpID0+IG4uWigpKSkubmV4dCgoKCkgPT4gci5aKCkpKTtcbiAgICB9XG4gICAgY3JlYXRlVGFyZ2V0SW5kZXhlcyhlLCB0KSB7XG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaCh0aGlzLk1uKHQpLCAodCA9PiB0aGlzLmdldEluZGV4VHlwZShlLCB0KS5uZXh0KChuID0+IHtcbiAgICAgICAgICAgIGlmICgwIC8qIEluZGV4VHlwZS5OT05FICovID09PSBuIHx8IDEgLyogSW5kZXhUeXBlLlBBUlRJQUwgKi8gPT09IG4pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gbmV3IF9fUFJJVkFURV9UYXJnZXRJbmRleE1hdGNoZXIodCkuRG4oKTtcbiAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSBuKSByZXR1cm4gdGhpcy5hZGRGaWVsZEluZGV4KGUsIG4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSkpKTtcbiAgICB9XG4gICAgZ2V0RG9jdW1lbnRzTWF0Y2hpbmdUYXJnZXQoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX2luZGV4RW50cmllc1N0b3JlKGUpO1xuICAgICAgICBsZXQgciA9ICEwO1xuICAgICAgICBjb25zdCBpID0gbmV3IE1hcDtcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKHRoaXMuTW4odCksICh0ID0+IHRoaXMueG4oZSwgdCkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICByICYmIChyID0gISFlKSwgaS5zZXQodCwgZSk7XG4gICAgICAgIH0pKSkpLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIGlmIChyKSB7XG4gICAgICAgICAgICAgICAgbGV0IGUgPSBfX1BSSVZBVEVfZG9jdW1lbnRLZXlTZXQoKTtcbiAgICAgICAgICAgICAgICBjb25zdCByID0gW107XG4gICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKGksICgoaSwgcykgPT4ge1xuICAgICAgICAgICAgICAgICAgICBfX1BSSVZBVEVfbG9nRGVidWcoRnQsIGBVc2luZyBpbmRleCAke2Z1bmN0aW9uIF9fUFJJVkFURV9maWVsZEluZGV4VG9TdHJpbmcoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBpZD0ke2UuaW5kZXhJZH18Y2c9JHtlLmNvbGxlY3Rpb25Hcm91cH18Zj0ke2UuZmllbGRzLm1hcCgoZSA9PiBgJHtlLmZpZWxkUGF0aH06JHtlLmtpbmR9YCkpLmpvaW4oXCIsXCIpfWA7XG4gICAgICAgICAgICAgICAgICAgIH0oaSl9IHRvIGV4ZWN1dGUgJHtfX1BSSVZBVEVfY2Fub25pZnlUYXJnZXQodCl9YCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBmdW5jdGlvbiBfX1BSSVZBVEVfdGFyZ2V0R2V0QXJyYXlWYWx1ZXMoZSwgdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IF9fUFJJVkFURV9maWVsZEluZGV4R2V0QXJyYXlTZWdtZW50KHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZvaWQgMCA9PT0gbikgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgX19QUklWQVRFX3RhcmdldEdldEZpZWxkRmlsdGVyc0ZvclBhdGgoZSwgbi5maWVsZFBhdGgpKSBzd2l0Y2ggKHQub3ApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIE9wZXJhdG9yLkFSUkFZX0NPTlRBSU5TX0FOWSAqLyA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQudmFsdWUuYXJyYXlWYWx1ZS52YWx1ZXMgfHwgW107XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImFycmF5LWNvbnRhaW5zXCIgLyogT3BlcmF0b3IuQVJSQVlfQ09OVEFJTlMgKi8gOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbIHQudmFsdWUgXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1haW5pbmcgZmlsdGVycyBhcmUgbm90IGFycmF5IGZpbHRlcnMuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvKipcbiAqIFJldHVybnMgdGhlIGxpc3Qgb2YgdmFsdWVzIHRoYXQgYXJlIHVzZWQgaW4gIT0gb3IgTk9UX0lOIGZpbHRlcnMuIFJldHVybnNcbiAqIGBudWxsYCBpZiB0aGVyZSBhcmUgbm8gc3VjaCBmaWx0ZXJzLlxuICovIChzLCBpKSwgXyA9IGZ1bmN0aW9uIF9fUFJJVkFURV90YXJnZXRHZXROb3RJblZhbHVlcyhlLCB0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gbmV3IE1hcDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgciBvZiBfX1BSSVZBVEVfZmllbGRJbmRleEdldERpcmVjdGlvbmFsU2VnbWVudHModCkpIGZvciAoY29uc3QgdCBvZiBfX1BSSVZBVEVfdGFyZ2V0R2V0RmllbGRGaWx0ZXJzRm9yUGF0aChlLCByLmZpZWxkUGF0aCkpIHN3aXRjaCAodC5vcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiPT1cIiAvKiBPcGVyYXRvci5FUVVBTCAqLyA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJpblwiIC8qIE9wZXJhdG9yLklOICovIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBFbmNvZGUgZXF1YWxpdHkgcHJlZml4LCB3aGljaCBpcyBlbmNvZGVkIGluIHRoZSBpbmRleCB2YWx1ZSBiZWZvcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgaW5lcXVhbGl0eSAoZS5nLiBgYSA9PSAnYScgJiYgYiAhPSAnYidgIGlzIGVuY29kZWQgdG9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBgdmFsdWUgIT0gJ2FiJ2ApLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4uc2V0KHIuZmllbGRQYXRoLmNhbm9uaWNhbFN0cmluZygpLCB0LnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwibm90LWluXCIgLyogT3BlcmF0b3IuTk9UX0lOICovIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIiE9XCIgLyogT3BlcmF0b3IuTk9UX0VRVUFMICovIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RJbi9Ob3RFcXVhbCBpcyBhbHdheXMgYSBzdWZmaXguIFRoZXJlIGNhbm5vdCBiZSBhbnkgcmVtYWluaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VnbWVudHMgYW5kIGhlbmNlIHdlIGNhbiByZXR1cm4gZWFybHkgaGVyZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbi5zZXQoci5maWVsZFBhdGguY2Fub25pY2FsU3RyaW5nKCksIHQudmFsdWUpLCBBcnJheS5mcm9tKG4udmFsdWVzKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbWFpbmluZyBmaWx0ZXJzIGNhbm5vdCBiZSB1c2VkIGFzIG5vdEluIGJvdW5kcy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICogUmV0dXJucyBhIGxvd2VyIGJvdW5kIG9mIGZpZWxkIHZhbHVlcyB0aGF0IGNhbiBiZSB1c2VkIGFzIGEgc3RhcnRpbmcgcG9pbnQgdG9cbiAqIHNjYW4gdGhlIGluZGV4IGRlZmluZWQgYnkgYGZpZWxkSW5kZXhgLiBSZXR1cm5zIGBNSU5fVkFMVUVgIGlmIG5vIGxvd2VyIGJvdW5kXG4gKiBleGlzdHMuXG4gKi8gKHMsIGkpLCBhID0gZnVuY3Rpb24gX19QUklWQVRFX3RhcmdldEdldExvd2VyQm91bmQoZSwgdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHIgPSAhMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvciBlYWNoIHNlZ21lbnQsIHJldHJpZXZlIGEgbG93ZXIgYm91bmQgaWYgdGhlcmUgaXMgYSBzdWl0YWJsZSBmaWx0ZXIgb3JcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0YXJ0QXQuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgX19QUklWQVRFX2ZpZWxkSW5kZXhHZXREaXJlY3Rpb25hbFNlZ21lbnRzKHQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IDAgLyogSW5kZXhLaW5kLkFTQ0VORElORyAqLyA9PT0gaS5raW5kID8gX19QUklWQVRFX3RhcmdldEdldEFzY2VuZGluZ0JvdW5kKGUsIGkuZmllbGRQYXRoLCBlLnN0YXJ0QXQpIDogX19QUklWQVRFX3RhcmdldEdldERlc2NlbmRpbmdCb3VuZChlLCBpLmZpZWxkUGF0aCwgZS5zdGFydEF0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLnB1c2godC52YWx1ZSksIHIgJiYgKHIgPSB0LmluY2x1c2l2ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEJvdW5kKG4sIHIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICogUmV0dXJucyBhbiB1cHBlciBib3VuZCBvZiBmaWVsZCB2YWx1ZXMgdGhhdCBjYW4gYmUgdXNlZCBhcyBhbiBlbmRpbmcgcG9pbnRcbiAqIHdoZW4gc2Nhbm5pbmcgdGhlIGluZGV4IGRlZmluZWQgYnkgYGZpZWxkSW5kZXhgLiBSZXR1cm5zIGBNQVhfVkFMVUVgIGlmIG5vXG4gKiB1cHBlciBib3VuZCBleGlzdHMuXG4gKi8gKHMsIGkpLCB1ID0gZnVuY3Rpb24gX19QUklWQVRFX3RhcmdldEdldFVwcGVyQm91bmQoZSwgdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHIgPSAhMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvciBlYWNoIHNlZ21lbnQsIHJldHJpZXZlIGFuIHVwcGVyIGJvdW5kIGlmIHRoZXJlIGlzIGEgc3VpdGFibGUgZmlsdGVyIG9yXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlbmRBdC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiBfX1BSSVZBVEVfZmllbGRJbmRleEdldERpcmVjdGlvbmFsU2VnbWVudHModCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gMCAvKiBJbmRleEtpbmQuQVNDRU5ESU5HICovID09PSBpLmtpbmQgPyBfX1BSSVZBVEVfdGFyZ2V0R2V0RGVzY2VuZGluZ0JvdW5kKGUsIGkuZmllbGRQYXRoLCBlLmVuZEF0KSA6IF9fUFJJVkFURV90YXJnZXRHZXRBc2NlbmRpbmdCb3VuZChlLCBpLmZpZWxkUGF0aCwgZS5lbmRBdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbi5wdXNoKHQudmFsdWUpLCByICYmIChyID0gdC5pbmNsdXNpdmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBCb3VuZChuLCByKTtcbiAgICAgICAgICAgICAgICAgICAgfShzLCBpKSwgYyA9IHRoaXMuT24oaSwgcywgYSksIGwgPSB0aGlzLk9uKGksIHMsIHUpLCBoID0gdGhpcy5ObihpLCBzLCBfKSwgUCA9IHRoaXMuQm4oaS5pbmRleElkLCBvLCBjLCBhLmluY2x1c2l2ZSwgbCwgdS5pbmNsdXNpdmUsIGgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2goUCwgKGkgPT4gbi5ZKGksIHQubGltaXQpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdC5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gRG9jdW1lbnRLZXkuZnJvbVNlZ21lbnRzKHQuZG9jdW1lbnRLZXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuaGFzKG4pIHx8IChlID0gZS5hZGQobiksIHIucHVzaChuKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIH0pKSkpO1xuICAgICAgICAgICAgICAgIH0pKS5uZXh0KCgoKSA9PiByKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUobnVsbCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgTW4oZSkge1xuICAgICAgICBsZXQgdCA9IHRoaXMuRm4uZ2V0KGUpO1xuICAgICAgICBpZiAodCkgcmV0dXJuIHQ7XG4gICAgICAgIGlmICgwID09PSBlLmZpbHRlcnMubGVuZ3RoKSB0ID0gWyBlIF07IGVsc2Uge1xuICAgICAgICAgICAgdCA9IF9fUFJJVkFURV9nZXREbmZUZXJtcyhDb21wb3NpdGVGaWx0ZXIuY3JlYXRlKGUuZmlsdGVycywgXCJhbmRcIiAvKiBDb21wb3NpdGVPcGVyYXRvci5BTkQgKi8pKS5tYXAoKHQgPT4gX19QUklWQVRFX25ld1RhcmdldChlLnBhdGgsIGUuY29sbGVjdGlvbkdyb3VwLCBlLm9yZGVyQnksIHQuZ2V0RmlsdGVycygpLCBlLmxpbWl0LCBlLnN0YXJ0QXQsIGUuZW5kQXQpKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuRm4uc2V0KGUsIHQpLCB0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3RzIGEga2V5IHJhbmdlIHF1ZXJ5IG9uIGBEYkluZGV4RW50cnlTdG9yZWAgdGhhdCB1bmlvbnMgYWxsXG4gICAgICogYm91bmRzLlxuICAgICAqLyAgICBCbihlLCB0LCBuLCByLCBpLCBzLCBvKSB7XG4gICAgICAgIC8vIFRoZSBudW1iZXIgb2YgdG90YWwgaW5kZXggc2NhbnMgd2UgdW5pb24gdG9nZXRoZXIuIFRoaXMgaXMgc2ltaWxhciB0byBhXG4gICAgICAgIC8vIGRpc3RyaWJ1dGVkIG5vcm1hbCBmb3JtLCBidXQgYWRhcHRlZCBmb3IgYXJyYXkgdmFsdWVzLiBXZSBjcmVhdGUgYSBzaW5nbGVcbiAgICAgICAgLy8gaW5kZXggcmFuZ2UgcGVyIHZhbHVlIGluIGFuIEFSUkFZX0NPTlRBSU5TIG9yIEFSUkFZX0NPTlRBSU5TX0FOWSBmaWx0ZXJcbiAgICAgICAgLy8gY29tYmluZWQgd2l0aCB0aGUgdmFsdWVzIGZyb20gdGhlIHF1ZXJ5IGJvdW5kcy5cbiAgICAgICAgY29uc3QgXyA9IChudWxsICE9IHQgPyB0Lmxlbmd0aCA6IDEpICogTWF0aC5tYXgobi5sZW5ndGgsIGkubGVuZ3RoKSwgYSA9IF8gLyAobnVsbCAhPSB0ID8gdC5sZW5ndGggOiAxKSwgdSA9IFtdO1xuICAgICAgICBmb3IgKGxldCBjID0gMDsgYyA8IF87ICsrYykge1xuICAgICAgICAgICAgY29uc3QgXyA9IHQgPyB0aGlzLkxuKHRbYyAvIGFdKSA6IE10LCBsID0gdGhpcy5rbihlLCBfLCBuW2MgJSBhXSwgciksIGggPSB0aGlzLnFuKGUsIF8sIGlbYyAlIGFdLCBzKSwgUCA9IG8ubWFwKCh0ID0+IHRoaXMua24oZSwgXywgdCwgXG4gICAgICAgICAgICAvKiBpbmNsdXNpdmU9ICovICEwKSkpO1xuICAgICAgICAgICAgdS5wdXNoKC4uLnRoaXMuY3JlYXRlUmFuZ2UobCwgaCwgUCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1O1xuICAgIH1cbiAgICAvKiogR2VuZXJhdGVzIHRoZSBsb3dlciBib3VuZCBmb3IgYGFycmF5VmFsdWVgIGFuZCBgZGlyZWN0aW9uYWxWYWx1ZWAuICovICAgIGtuKGUsIHQsIG4sIHIpIHtcbiAgICAgICAgY29uc3QgaSA9IG5ldyBfX1BSSVZBVEVfSW5kZXhFbnRyeShlLCBEb2N1bWVudEtleS5lbXB0eSgpLCB0LCBuKTtcbiAgICAgICAgcmV0dXJuIHIgPyBpIDogaS5BbigpO1xuICAgIH1cbiAgICAvKiogR2VuZXJhdGVzIHRoZSB1cHBlciBib3VuZCBmb3IgYGFycmF5VmFsdWVgIGFuZCBgZGlyZWN0aW9uYWxWYWx1ZWAuICovICAgIHFuKGUsIHQsIG4sIHIpIHtcbiAgICAgICAgY29uc3QgaSA9IG5ldyBfX1BSSVZBVEVfSW5kZXhFbnRyeShlLCBEb2N1bWVudEtleS5lbXB0eSgpLCB0LCBuKTtcbiAgICAgICAgcmV0dXJuIHIgPyBpLkFuKCkgOiBpO1xuICAgIH1cbiAgICB4bihlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgX19QUklWQVRFX1RhcmdldEluZGV4TWF0Y2hlcih0KSwgciA9IG51bGwgIT0gdC5jb2xsZWN0aW9uR3JvdXAgPyB0LmNvbGxlY3Rpb25Hcm91cCA6IHQucGF0aC5sYXN0U2VnbWVudCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRGaWVsZEluZGV4ZXMoZSwgcikubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICAvLyBSZXR1cm4gdGhlIGluZGV4IHdpdGggdGhlIG1vc3QgbnVtYmVyIG9mIHNlZ21lbnRzLlxuICAgICAgICAgICAgbGV0IHQgPSBudWxsO1xuICAgICAgICAgICAgZm9yIChjb25zdCByIG9mIGUpIHtcbiAgICAgICAgICAgICAgICBuLnluKHIpICYmICghdCB8fCByLmZpZWxkcy5sZW5ndGggPiB0LmZpZWxkcy5sZW5ndGgpICYmICh0ID0gcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdDtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBnZXRJbmRleFR5cGUoZSwgdCkge1xuICAgICAgICBsZXQgbiA9IDIgLyogSW5kZXhUeXBlLkZVTEwgKi87XG4gICAgICAgIGNvbnN0IHIgPSB0aGlzLk1uKHQpO1xuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2gociwgKHQgPT4gdGhpcy54bihlLCB0KS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgIGUgPyAwIC8qIEluZGV4VHlwZS5OT05FICovICE9PSBuICYmIGUuZmllbGRzLmxlbmd0aCA8IGZ1bmN0aW9uIF9fUFJJVkFURV90YXJnZXRHZXRTZWdtZW50Q291bnQoZSkge1xuICAgICAgICAgICAgICAgIGxldCB0ID0gbmV3IFNvcnRlZFNldChGaWVsZFBhdGgkMS5jb21wYXJhdG9yKSwgbiA9ICExO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgciBvZiBlLmZpbHRlcnMpIGZvciAoY29uc3QgZSBvZiByLmdldEZsYXR0ZW5lZEZpbHRlcnMoKSkgXG4gICAgICAgICAgICAgICAgLy8gX19uYW1lX18gaXMgbm90IGFuIGV4cGxpY2l0IHNlZ21lbnQgb2YgYW55IGluZGV4LCBzbyB3ZSBkb24ndCBuZWVkIHRvXG4gICAgICAgICAgICAgICAgLy8gY291bnQgaXQuXG4gICAgICAgICAgICAgICAgZS5maWVsZC5pc0tleUZpZWxkKCkgfHwgKFxuICAgICAgICAgICAgICAgIC8vIEFSUkFZX0NPTlRBSU5TIG9yIEFSUkFZX0NPTlRBSU5TX0FOWSBmaWx0ZXJzIG11c3QgYmUgY291bnRlZCBzZXBhcmF0ZWx5LlxuICAgICAgICAgICAgICAgIC8vIEZvciBpbnN0YW5jZSwgaXQgaXMgcG9zc2libGUgdG8gaGF2ZSBhbiBpbmRleCBmb3IgXCJhIEFSUkFZIGEgQVNDXCIuIEV2ZW5cbiAgICAgICAgICAgICAgICAvLyB0aG91Z2ggdGhlc2UgYXJlIG9uIHRoZSBzYW1lIGZpZWxkLCB0aGV5IHNob3VsZCBiZSBjb3VudGVkIGFzIHR3b1xuICAgICAgICAgICAgICAgIC8vIHNlcGFyYXRlIHNlZ21lbnRzIGluIGFuIGluZGV4LlxuICAgICAgICAgICAgICAgIFwiYXJyYXktY29udGFpbnNcIiAvKiBPcGVyYXRvci5BUlJBWV9DT05UQUlOUyAqLyA9PT0gZS5vcCB8fCBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIE9wZXJhdG9yLkFSUkFZX0NPTlRBSU5TX0FOWSAqLyA9PT0gZS5vcCA/IG4gPSAhMCA6IHQgPSB0LmFkZChlLmZpZWxkKSk7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIGUub3JkZXJCeSkgXG4gICAgICAgICAgICAgICAgLy8gX19uYW1lX18gaXMgbm90IGFuIGV4cGxpY2l0IHNlZ21lbnQgb2YgYW55IGluZGV4LCBzbyB3ZSBkb24ndCBuZWVkIHRvXG4gICAgICAgICAgICAgICAgLy8gY291bnQgaXQuXG4gICAgICAgICAgICAgICAgbi5maWVsZC5pc0tleUZpZWxkKCkgfHwgKHQgPSB0LmFkZChuLmZpZWxkKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHQuc2l6ZSArIChuID8gMSA6IDApO1xuICAgICAgICAgICAgfSh0KSAmJiAobiA9IDEgLyogSW5kZXhUeXBlLlBBUlRJQUwgKi8pIDogbiA9IDAgLyogSW5kZXhUeXBlLk5PTkUgKi87XG4gICAgICAgIH0pKSkpLm5leHQoKCgpID0+IFxuICAgICAgICAvLyBPUiBxdWVyaWVzIGhhdmUgbW9yZSB0aGFuIG9uZSBzdWItdGFyZ2V0IChvbmUgc3ViLXRhcmdldCBwZXIgRE5GIHRlcm0pLiBXZSBjdXJyZW50bHkgY29uc2lkZXJcbiAgICAgICAgLy8gT1IgcXVlcmllcyB0aGF0IGhhdmUgYSBgbGltaXRgIHRvIGhhdmUgYSBwYXJ0aWFsIGluZGV4LiBGb3Igc3VjaCBxdWVyaWVzIHdlIHBlcmZvcm0gc29ydGluZ1xuICAgICAgICAvLyBhbmQgYXBwbHkgdGhlIGxpbWl0IGluIG1lbW9yeSBhcyBhIHBvc3QtcHJvY2Vzc2luZyBzdGVwLlxuICAgICAgICBmdW5jdGlvbiBfX1BSSVZBVEVfdGFyZ2V0SGFzTGltaXQoZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGwgIT09IGUubGltaXQ7XG4gICAgICAgIH0odCkgJiYgci5sZW5ndGggPiAxICYmIDIgLyogSW5kZXhUeXBlLkZVTEwgKi8gPT09IG4gPyAxIC8qIEluZGV4VHlwZS5QQVJUSUFMICovIDogbikpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBieXRlIGVuY29kZWQgZm9ybSBvZiB0aGUgZGlyZWN0aW9uYWwgdmFsdWVzIGluIHRoZSBmaWVsZCBpbmRleC5cbiAgICAgKiBSZXR1cm5zIGBudWxsYCBpZiB0aGUgZG9jdW1lbnQgZG9lcyBub3QgaGF2ZSBhbGwgZmllbGRzIHNwZWNpZmllZCBpbiB0aGVcbiAgICAgKiBpbmRleC5cbiAgICAgKi8gICAgUW4oZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gbmV3IF9fUFJJVkFURV9JbmRleEJ5dGVFbmNvZGVyO1xuICAgICAgICBmb3IgKGNvbnN0IHIgb2YgX19QUklWQVRFX2ZpZWxkSW5kZXhHZXREaXJlY3Rpb25hbFNlZ21lbnRzKGUpKSB7XG4gICAgICAgICAgICBjb25zdCBlID0gdC5kYXRhLmZpZWxkKHIuZmllbGRQYXRoKTtcbiAgICAgICAgICAgIGlmIChudWxsID09IGUpIHJldHVybiBudWxsO1xuICAgICAgICAgICAgY29uc3QgaSA9IG4uUG4oci5raW5kKTtcbiAgICAgICAgICAgIF9fUFJJVkFURV9GaXJlc3RvcmVJbmRleFZhbHVlV3JpdGVyLkt0LkR0KGUsIGkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuLnVuKCk7XG4gICAgfVxuICAgIC8qKiBFbmNvZGVzIGEgc2luZ2xlIHZhbHVlIHRvIHRoZSBhc2NlbmRpbmcgaW5kZXggZm9ybWF0LiAqLyAgICBMbihlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBuZXcgX19QUklWQVRFX0luZGV4Qnl0ZUVuY29kZXI7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfRmlyZXN0b3JlSW5kZXhWYWx1ZVdyaXRlci5LdC5EdChlLCB0LlBuKDAgLyogSW5kZXhLaW5kLkFTQ0VORElORyAqLykpLCBcbiAgICAgICAgdC51bigpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFuIGVuY29kZWQgZm9ybSBvZiB0aGUgZG9jdW1lbnQga2V5IHRoYXQgc29ydHMgYmFzZWQgb24gdGhlIGtleVxuICAgICAqIG9yZGVyaW5nIG9mIHRoZSBmaWVsZCBpbmRleC5cbiAgICAgKi8gICAgJG4oZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gbmV3IF9fUFJJVkFURV9JbmRleEJ5dGVFbmNvZGVyO1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX0ZpcmVzdG9yZUluZGV4VmFsdWVXcml0ZXIuS3QuRHQoX19QUklWQVRFX3JlZlZhbHVlKHRoaXMuZGF0YWJhc2VJZCwgdCksIG4uUG4oZnVuY3Rpb24gX19QUklWQVRFX2ZpZWxkSW5kZXhHZXRLZXlPcmRlcihlKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gX19QUklWQVRFX2ZpZWxkSW5kZXhHZXREaXJlY3Rpb25hbFNlZ21lbnRzKGUpO1xuICAgICAgICAgICAgcmV0dXJuIDAgPT09IHQubGVuZ3RoID8gMCAvKiBJbmRleEtpbmQuQVNDRU5ESU5HICovIDogdFt0Lmxlbmd0aCAtIDFdLmtpbmQ7XG4gICAgICAgIH0oZSkpKSwgbi51bigpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbmNvZGVzIHRoZSBnaXZlbiBmaWVsZCB2YWx1ZXMgYWNjb3JkaW5nIHRvIHRoZSBzcGVjaWZpY2F0aW9uIGluIGB0YXJnZXRgLlxuICAgICAqIEZvciBJTiBxdWVyaWVzLCBhIGxpc3Qgb2YgcG9zc2libGUgdmFsdWVzIGlzIHJldHVybmVkLlxuICAgICAqLyAgICBObihlLCB0LCBuKSB7XG4gICAgICAgIGlmIChudWxsID09PSBuKSByZXR1cm4gW107XG4gICAgICAgIGxldCByID0gW107XG4gICAgICAgIHIucHVzaChuZXcgX19QUklWQVRFX0luZGV4Qnl0ZUVuY29kZXIpO1xuICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgIGZvciAoY29uc3QgcyBvZiBfX1BSSVZBVEVfZmllbGRJbmRleEdldERpcmVjdGlvbmFsU2VnbWVudHMoZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBuW2krK107XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgcikgaWYgKHRoaXMuVW4odCwgcy5maWVsZFBhdGgpICYmIGlzQXJyYXkoZSkpIHIgPSB0aGlzLktuKHIsIHMsIGUpOyBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbi5QbihzLmtpbmQpO1xuICAgICAgICAgICAgICAgIF9fUFJJVkFURV9GaXJlc3RvcmVJbmRleFZhbHVlV3JpdGVyLkt0LkR0KGUsIHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLlduKHIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbmNvZGVzIHRoZSBnaXZlbiBib3VuZHMgYWNjb3JkaW5nIHRvIHRoZSBzcGVjaWZpY2F0aW9uIGluIGB0YXJnZXRgLiBGb3IgSU5cbiAgICAgKiBxdWVyaWVzLCBhIGxpc3Qgb2YgcG9zc2libGUgdmFsdWVzIGlzIHJldHVybmVkLlxuICAgICAqLyAgICBPbihlLCB0LCBuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLk5uKGUsIHQsIG4ucG9zaXRpb24pO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyB0aGUgYnl0ZSByZXByZXNlbnRhdGlvbiBmb3IgdGhlIHByb3ZpZGVkIGVuY29kZXJzLiAqLyAgICBXbihlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCBlLmxlbmd0aDsgKytuKSB0W25dID0gZVtuXS51bigpO1xuICAgICAgICByZXR1cm4gdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIHNlcGFyYXRlIGVuY29kZXIgZm9yIGVhY2ggZWxlbWVudCBvZiBhbiBhcnJheS5cbiAgICAgKlxuICAgICAqIFRoZSBtZXRob2QgYXBwZW5kcyBlYWNoIHZhbHVlIHRvIGFsbCBleGlzdGluZyBlbmNvZGVycyAoZS5nLiBmaWx0ZXIoXCJhXCIsXG4gICAgICogXCI9PVwiLCBcImExXCIpLmZpbHRlcihcImJcIiwgXCJpblwiLCBbXCJiMVwiLCBcImIyXCJdKSBiZWNvbWVzIFtcImExLGIxXCIsIFwiYTEsYjJcIl0pLiBBXG4gICAgICogbGlzdCBvZiBuZXcgZW5jb2RlcnMgaXMgcmV0dXJuZWQuXG4gICAgICovICAgIEtuKGUsIHQsIG4pIHtcbiAgICAgICAgY29uc3QgciA9IFsgLi4uZSBdLCBpID0gW107XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiBuLmFycmF5VmFsdWUudmFsdWVzIHx8IFtdKSBmb3IgKGNvbnN0IG4gb2Ygcikge1xuICAgICAgICAgICAgY29uc3QgciA9IG5ldyBfX1BSSVZBVEVfSW5kZXhCeXRlRW5jb2RlcjtcbiAgICAgICAgICAgIHIuc2VlZChuLnVuKCkpLCBfX1BSSVZBVEVfRmlyZXN0b3JlSW5kZXhWYWx1ZVdyaXRlci5LdC5EdChlLCByLlBuKHQua2luZCkpLCBpLnB1c2gocik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGk7XG4gICAgfVxuICAgIFVuKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuICEhZS5maWx0ZXJzLmZpbmQoKGUgPT4gZSBpbnN0YW5jZW9mIEZpZWxkRmlsdGVyICYmIGUuZmllbGQuaXNFcXVhbCh0KSAmJiAoXCJpblwiIC8qIE9wZXJhdG9yLklOICovID09PSBlLm9wIHx8IFwibm90LWluXCIgLyogT3BlcmF0b3IuTk9UX0lOICovID09PSBlLm9wKSkpO1xuICAgIH1cbiAgICBnZXRGaWVsZEluZGV4ZXMoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX2luZGV4Q29uZmlndXJhdGlvblN0b3JlKGUpLCByID0gX19QUklWQVRFX2luZGV4U3RhdGVTdG9yZShlKTtcbiAgICAgICAgcmV0dXJuICh0ID8gbi5KKHhlLCBJREJLZXlSYW5nZS5ib3VuZCh0LCB0KSkgOiBuLkooKSkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0ID0gW107XG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2goZSwgKGUgPT4gci5nZXQoWyBlLmluZGV4SWQsIHRoaXMudWlkIF0pLm5leHQoKG4gPT4ge1xuICAgICAgICAgICAgICAgIHQucHVzaChmdW5jdGlvbiBfX1BSSVZBVEVfZnJvbURiSW5kZXhDb25maWd1cmF0aW9uKGUsIHQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHQgPyBuZXcgSW5kZXhTdGF0ZSh0LnNlcXVlbmNlTnVtYmVyLCBuZXcgSW5kZXhPZmZzZXQoX19QUklWQVRFX2Zyb21EYlRpbWVzdGFtcCh0LnJlYWRUaW1lKSwgbmV3IERvY3VtZW50S2V5KF9fUFJJVkFURV9kZWNvZGVSZXNvdXJjZVBhdGgodC5kb2N1bWVudEtleSkpLCB0Lmxhcmdlc3RCYXRjaElkKSkgOiBJbmRleFN0YXRlLmVtcHR5KCksIHIgPSBlLmZpZWxkcy5tYXAoKChbZSwgdF0pID0+IG5ldyBJbmRleFNlZ21lbnQoRmllbGRQYXRoJDEuZnJvbVNlcnZlckZvcm1hdChlKSwgdCkpKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGaWVsZEluZGV4KGUuaW5kZXhJZCwgZS5jb2xsZWN0aW9uR3JvdXAsIHIsIG4pO1xuICAgICAgICAgICAgICAgIH0oZSwgbikpO1xuICAgICAgICAgICAgfSkpKSkubmV4dCgoKCkgPT4gdCkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldE5leHRDb2xsZWN0aW9uR3JvdXBUb1VwZGF0ZShlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEZpZWxkSW5kZXhlcyhlKS5uZXh0KChlID0+IDAgPT09IGUubGVuZ3RoID8gbnVsbCA6IChlLnNvcnQoKChlLCB0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gZS5pbmRleFN0YXRlLnNlcXVlbmNlTnVtYmVyIC0gdC5pbmRleFN0YXRlLnNlcXVlbmNlTnVtYmVyO1xuICAgICAgICAgICAgcmV0dXJuIDAgIT09IG4gPyBuIDogX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IoZS5jb2xsZWN0aW9uR3JvdXAsIHQuY29sbGVjdGlvbkdyb3VwKTtcbiAgICAgICAgfSkpLCBlWzBdLmNvbGxlY3Rpb25Hcm91cCkpKTtcbiAgICB9XG4gICAgdXBkYXRlQ29sbGVjdGlvbkdyb3VwKGUsIHQsIG4pIHtcbiAgICAgICAgY29uc3QgciA9IF9fUFJJVkFURV9pbmRleENvbmZpZ3VyYXRpb25TdG9yZShlKSwgaSA9IF9fUFJJVkFURV9pbmRleFN0YXRlU3RvcmUoZSk7XG4gICAgICAgIHJldHVybiB0aGlzLkduKGUpLm5leHQoKGUgPT4gci5KKHhlLCBJREJLZXlSYW5nZS5ib3VuZCh0LCB0KSkubmV4dCgodCA9PiBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaCh0LCAodCA9PiBpLnB1dChfX1BSSVZBVEVfdG9EYkluZGV4U3RhdGUodC5pbmRleElkLCB0aGlzLnVpZCwgZSwgbikpKSkpKSkpO1xuICAgIH1cbiAgICB1cGRhdGVJbmRleEVudHJpZXMoZSwgdCkge1xuICAgICAgICAvLyBQb3J0aW5nIE5vdGU6IGBnZXRGaWVsZEluZGV4ZXMoKWAgb24gV2ViIGRvZXMgbm90IGNhY2hlIGluZGV4IGxvb2t1cHMgYXNcbiAgICAgICAgLy8gaXQgY291bGQgYmUgdXNlZCBhY3Jvc3MgZGlmZmVyZW50IEluZGV4ZWREQiB0cmFuc2FjdGlvbnMuIEFzIGFueSBjYWNoZWRcbiAgICAgICAgLy8gZGF0YSBtaWdodCBiZSBpbnZhbGlkYXRlZCBieSBvdGhlciBtdWx0aS10YWIgY2xpZW50cywgd2UgY2FuIG9ubHkgdHJ1c3RcbiAgICAgICAgLy8gZGF0YSB3aXRoaW4gYSBzaW5nbGUgSW5kZXhlZERCIHRyYW5zYWN0aW9uLiBXZSB0aGVyZWZvcmUgYWRkIGEgY2FjaGVcbiAgICAgICAgLy8gaGVyZS5cbiAgICAgICAgY29uc3QgbiA9IG5ldyBNYXA7XG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaCh0LCAoKHQsIHIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBuLmdldCh0LmNvbGxlY3Rpb25Hcm91cCk7XG4gICAgICAgICAgICByZXR1cm4gKGkgPyBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShpKSA6IHRoaXMuZ2V0RmllbGRJbmRleGVzKGUsIHQuY29sbGVjdGlvbkdyb3VwKSkubmV4dCgoaSA9PiAobi5zZXQodC5jb2xsZWN0aW9uR3JvdXAsIGkpLCBcbiAgICAgICAgICAgIFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKGksIChuID0+IHRoaXMuem4oZSwgdCwgbikubmV4dCgodCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuam4ociwgbik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHQuaXNFcXVhbChpKSA/IFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCkgOiB0aGlzLkpuKGUsIHIsIG4sIHQsIGkpO1xuICAgICAgICAgICAgfSkpKSkpKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgSG4oZSwgdCwgbiwgcikge1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX2luZGV4RW50cmllc1N0b3JlKGUpLnB1dChyLlJuKHRoaXMudWlkLCB0aGlzLiRuKG4sIHQua2V5KSwgdC5rZXkpKTtcbiAgICB9XG4gICAgWW4oZSwgdCwgbiwgcikge1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX2luZGV4RW50cmllc1N0b3JlKGUpLmRlbGV0ZShyLlZuKHRoaXMudWlkLCB0aGlzLiRuKG4sIHQua2V5KSwgdC5rZXkpKTtcbiAgICB9XG4gICAgem4oZSwgdCwgbikge1xuICAgICAgICBjb25zdCByID0gX19QUklWQVRFX2luZGV4RW50cmllc1N0b3JlKGUpO1xuICAgICAgICBsZXQgaSA9IG5ldyBTb3J0ZWRTZXQoX19QUklWQVRFX2luZGV4RW50cnlDb21wYXJhdG9yKTtcbiAgICAgICAgcmV0dXJuIHIuZWUoe1xuICAgICAgICAgICAgaW5kZXg6ICRlLFxuICAgICAgICAgICAgcmFuZ2U6IElEQktleVJhbmdlLm9ubHkoWyBuLmluZGV4SWQsIHRoaXMudWlkLCBfX1BSSVZBVEVfZW5jb2RlS2V5U2FmZUJ5dGVzKHRoaXMuJG4obiwgdCkpIF0pXG4gICAgICAgIH0sICgoZSwgcikgPT4ge1xuICAgICAgICAgICAgaSA9IGkuYWRkKG5ldyBfX1BSSVZBVEVfSW5kZXhFbnRyeShuLmluZGV4SWQsIHQsIF9fUFJJVkFURV9kZWNvZGVLZXlTYWZlQnl0ZXMoci5hcnJheVZhbHVlKSwgX19QUklWQVRFX2RlY29kZUtleVNhZmVCeXRlcyhyLmRpcmVjdGlvbmFsVmFsdWUpKSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBpKSk7XG4gICAgfVxuICAgIC8qKiBDcmVhdGVzIHRoZSBpbmRleCBlbnRyaWVzIGZvciB0aGUgZ2l2ZW4gZG9jdW1lbnQuICovICAgIGpuKGUsIHQpIHtcbiAgICAgICAgbGV0IG4gPSBuZXcgU29ydGVkU2V0KF9fUFJJVkFURV9pbmRleEVudHJ5Q29tcGFyYXRvcik7XG4gICAgICAgIGNvbnN0IHIgPSB0aGlzLlFuKHQsIGUpO1xuICAgICAgICBpZiAobnVsbCA9PSByKSByZXR1cm4gbjtcbiAgICAgICAgY29uc3QgaSA9IF9fUFJJVkFURV9maWVsZEluZGV4R2V0QXJyYXlTZWdtZW50KHQpO1xuICAgICAgICBpZiAobnVsbCAhPSBpKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gZS5kYXRhLmZpZWxkKGkuZmllbGRQYXRoKTtcbiAgICAgICAgICAgIGlmIChpc0FycmF5KHMpKSBmb3IgKGNvbnN0IGkgb2Ygcy5hcnJheVZhbHVlLnZhbHVlcyB8fCBbXSkgbiA9IG4uYWRkKG5ldyBfX1BSSVZBVEVfSW5kZXhFbnRyeSh0LmluZGV4SWQsIGUua2V5LCB0aGlzLkxuKGkpLCByKSk7XG4gICAgICAgIH0gZWxzZSBuID0gbi5hZGQobmV3IF9fUFJJVkFURV9JbmRleEVudHJ5KHQuaW5kZXhJZCwgZS5rZXksIE10LCByKSk7XG4gICAgICAgIHJldHVybiBuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSBpbmRleCBlbnRyaWVzIGZvciB0aGUgcHJvdmlkZWQgZG9jdW1lbnQgYnkgZGVsZXRpbmcgZW50cmllc1xuICAgICAqIHRoYXQgYXJlIG5vIGxvbmdlciByZWZlcmVuY2VkIGluIGBuZXdFbnRyaWVzYCBhbmQgYWRkaW5nIGFsbCBuZXdseSBhZGRlZFxuICAgICAqIGVudHJpZXMuXG4gICAgICovICAgIEpuKGUsIHQsIG4sIHIsIGkpIHtcbiAgICAgICAgX19QUklWQVRFX2xvZ0RlYnVnKEZ0LCBcIlVwZGF0aW5nIGluZGV4IGVudHJpZXMgZm9yIGRvY3VtZW50ICclcydcIiwgdC5rZXkpO1xuICAgICAgICBjb25zdCBzID0gW107XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBfX1BSSVZBVEVfZGlmZlNvcnRlZFNldHMoZSwgdCwgbiwgciwgaSkge1xuICAgICAgICAgICAgY29uc3QgcyA9IGUuZ2V0SXRlcmF0b3IoKSwgbyA9IHQuZ2V0SXRlcmF0b3IoKTtcbiAgICAgICAgICAgIGxldCBfID0gX19QUklWQVRFX2FkdmFuY2VJdGVyYXRvcihzKSwgYSA9IF9fUFJJVkFURV9hZHZhbmNlSXRlcmF0b3Iobyk7XG4gICAgICAgICAgICAvLyBXYWxrIHRocm91Z2ggdGhlIHR3byBzZXRzIGF0IHRoZSBzYW1lIHRpbWUsIHVzaW5nIHRoZSBvcmRlcmluZyBkZWZpbmVkIGJ5XG4gICAgICAgICAgICAvLyBgY29tcGFyYXRvcmAuXG4gICAgICAgICAgICBmb3IgKDtfIHx8IGE7ICkge1xuICAgICAgICAgICAgICAgIGxldCBlID0gITEsIHQgPSAhMTtcbiAgICAgICAgICAgICAgICBpZiAoXyAmJiBhKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuKF8sIGEpO1xuICAgICAgICAgICAgICAgICAgICByIDwgMCA/IFxuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZWxlbWVudCB3YXMgcmVtb3ZlZCBpZiB0aGUgbmV4dCBlbGVtZW50IGluIG91ciBvcmRlcmVkXG4gICAgICAgICAgICAgICAgICAgIC8vIHdhbGt0aHJvdWdoIGlzIG9ubHkgaW4gYGJlZm9yZWAuXG4gICAgICAgICAgICAgICAgICAgIHQgPSAhMCA6IHIgPiAwICYmIChcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGVsZW1lbnQgd2FzIGFkZGVkIGlmIHRoZSBuZXh0IGVsZW1lbnQgaW4gb3VyIG9yZGVyZWQgd2Fsa3Rocm91Z2hcbiAgICAgICAgICAgICAgICAgICAgLy8gaXMgb25seSBpbiBgYWZ0ZXJgLlxuICAgICAgICAgICAgICAgICAgICBlID0gITApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBudWxsICE9IF8gPyB0ID0gITAgOiBlID0gITA7XG4gICAgICAgICAgICAgICAgZSA/IChyKGEpLCBhID0gX19QUklWQVRFX2FkdmFuY2VJdGVyYXRvcihvKSkgOiB0ID8gKGkoXyksIF8gPSBfX1BSSVZBVEVfYWR2YW5jZUl0ZXJhdG9yKHMpKSA6IChfID0gX19QUklWQVRFX2FkdmFuY2VJdGVyYXRvcihzKSwgXG4gICAgICAgICAgICAgICAgYSA9IF9fUFJJVkFURV9hZHZhbmNlSXRlcmF0b3IobykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KHIsIGksIF9fUFJJVkFURV9pbmRleEVudHJ5Q29tcGFyYXRvciwgKFxuICAgICAgICAvKiBvbkFkZD0gKi8gciA9PiB7XG4gICAgICAgICAgICBzLnB1c2godGhpcy5IbihlLCB0LCBuLCByKSk7XG4gICAgICAgIH0pLCAoXG4gICAgICAgIC8qIG9uUmVtb3ZlPSAqLyByID0+IHtcbiAgICAgICAgICAgIHMucHVzaCh0aGlzLlluKGUsIHQsIG4sIHIpKTtcbiAgICAgICAgfSkpLCBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihzKTtcbiAgICB9XG4gICAgR24oZSkge1xuICAgICAgICBsZXQgdCA9IDE7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfaW5kZXhTdGF0ZVN0b3JlKGUpLmVlKHtcbiAgICAgICAgICAgIGluZGV4OiBMZSxcbiAgICAgICAgICAgIHJldmVyc2U6ICEwLFxuICAgICAgICAgICAgcmFuZ2U6IElEQktleVJhbmdlLnVwcGVyQm91bmQoWyB0aGlzLnVpZCwgTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIgXSlcbiAgICAgICAgfSwgKChlLCBuLCByKSA9PiB7XG4gICAgICAgICAgICByLmRvbmUoKSwgdCA9IG4uc2VxdWVuY2VOdW1iZXIgKyAxO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gdCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IHNldCBvZiBJREIgcmFuZ2VzIHRoYXQgc3BsaXRzIHRoZSBleGlzdGluZyByYW5nZSBhbmQgZXhjbHVkZXNcbiAgICAgKiBhbnkgdmFsdWVzIHRoYXQgbWF0Y2ggdGhlIGBub3RJblZhbHVlYCBmcm9tIHRoZXNlIHJhbmdlcy4gQXMgYW4gZXhhbXBsZSxcbiAgICAgKiAnW2ZvbyA+IDIgJiYgZm9vICE9IDNdYCBiZWNvbWVzICBgW2ZvbyA+IDIgJiYgPCAzLCBmb28gPiAzXWAuXG4gICAgICovICAgIGNyZWF0ZVJhbmdlKGUsIHQsIG4pIHtcbiAgICAgICAgLy8gVGhlIG5vdEluIHZhbHVlcyBuZWVkIHRvIGJlIHNvcnRlZCBhbmQgdW5pcXVlIHNvIHRoYXQgd2UgY2FuIHJldHVybiBhXG4gICAgICAgIC8vIHNvcnRlZCBzZXQgb2Ygbm9uLW92ZXJsYXBwaW5nIHJhbmdlcy5cbiAgICAgICAgbiA9IG4uc29ydCgoKGUsIHQpID0+IF9fUFJJVkFURV9pbmRleEVudHJ5Q29tcGFyYXRvcihlLCB0KSkpLmZpbHRlcigoKGUsIHQsIG4pID0+ICF0IHx8IDAgIT09IF9fUFJJVkFURV9pbmRleEVudHJ5Q29tcGFyYXRvcihlLCBuW3QgLSAxXSkpKTtcbiAgICAgICAgY29uc3QgciA9IFtdO1xuICAgICAgICByLnB1c2goZSk7XG4gICAgICAgIGZvciAoY29uc3QgaSBvZiBuKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX2luZGV4RW50cnlDb21wYXJhdG9yKGksIGUpLCBzID0gX19QUklWQVRFX2luZGV4RW50cnlDb21wYXJhdG9yKGksIHQpO1xuICAgICAgICAgICAgaWYgKDAgPT09IG4pIFxuICAgICAgICAgICAgLy8gYG5vdEluVmFsdWVgIGlzIHRoZSBsb3dlciBib3VuZC4gV2UgdGhlcmVmb3JlIG5lZWQgdG8gcmFpc2UgdGhlIGJvdW5kXG4gICAgICAgICAgICAvLyB0byB0aGUgbmV4dCB2YWx1ZS5cbiAgICAgICAgICAgIHJbMF0gPSBlLkFuKCk7IGVsc2UgaWYgKG4gPiAwICYmIHMgPCAwKSBcbiAgICAgICAgICAgIC8vIGBub3RJblZhbHVlYCBpcyBpbiB0aGUgbWlkZGxlIG9mIHRoZSByYW5nZVxuICAgICAgICAgICAgci5wdXNoKGkpLCByLnB1c2goaS5BbigpKTsgZWxzZSBpZiAocyA+IDApIFxuICAgICAgICAgICAgLy8gYG5vdEluVmFsdWVgIChhbmQgYWxsIGZvbGxvd2luZyB2YWx1ZXMpIGFyZSBvdXQgb2YgdGhlIHJhbmdlXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByLnB1c2godCk7XG4gICAgICAgIGNvbnN0IGkgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgZSA9IDA7IGUgPCByLmxlbmd0aDsgZSArPSAyKSB7XG4gICAgICAgICAgICAvLyBJZiB3ZSBlbmNvdW50ZXIgdHdvIGJvdW5kcyB0aGF0IHdpbGwgY3JlYXRlIGFuIHVubWF0Y2hhYmxlIGtleSByYW5nZSxcbiAgICAgICAgICAgIC8vIHRoZW4gd2UgcmV0dXJuIGFuIGVtcHR5IHNldCBvZiBrZXkgcmFuZ2VzLlxuICAgICAgICAgICAgaWYgKHRoaXMuWm4ocltlXSwgcltlICsgMV0pKSByZXR1cm4gW107XG4gICAgICAgICAgICBjb25zdCB0ID0gcltlXS5Wbih0aGlzLnVpZCwgTXQsIERvY3VtZW50S2V5LmVtcHR5KCkpLCBuID0gcltlICsgMV0uVm4odGhpcy51aWQsIE10LCBEb2N1bWVudEtleS5lbXB0eSgpKTtcbiAgICAgICAgICAgIGkucHVzaChJREJLZXlSYW5nZS5ib3VuZCh0LCBuKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGk7XG4gICAgfVxuICAgIFpuKGUsIHQpIHtcbiAgICAgICAgLy8gSWYgbG93ZXIgYm91bmQgaXMgZ3JlYXRlciB0aGFuIHRoZSB1cHBlciBib3VuZCwgdGhlbiB0aGUga2V5XG4gICAgICAgIC8vIHJhbmdlIGNhbiBuZXZlciBiZSBtYXRjaGVkLlxuICAgICAgICByZXR1cm4gX19QUklWQVRFX2luZGV4RW50cnlDb21wYXJhdG9yKGUsIHQpID4gMDtcbiAgICB9XG4gICAgZ2V0TWluT2Zmc2V0RnJvbUNvbGxlY3Rpb25Hcm91cChlLCB0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEZpZWxkSW5kZXhlcyhlLCB0KS5uZXh0KF9fUFJJVkFURV9nZXRNaW5PZmZzZXRGcm9tRmllbGRJbmRleGVzKTtcbiAgICB9XG4gICAgZ2V0TWluT2Zmc2V0KGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5tYXBBcnJheSh0aGlzLk1uKHQpLCAodCA9PiB0aGlzLnhuKGUsIHQpLm5leHQoKGUgPT4gZSB8fCBmYWlsKDQ0NDI2KSkpKSkubmV4dChfX1BSSVZBVEVfZ2V0TWluT2Zmc2V0RnJvbUZpZWxkSW5kZXhlcyk7XG4gICAgfVxufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgY29sbGVjdGlvblBhcmVudHNcbiAqIGRvY3VtZW50IHN0b3JlLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9jb2xsZWN0aW9uUGFyZW50c1N0b3JlKGUpIHtcbiAgICByZXR1cm4gX19QUklWQVRFX2dldFN0b3JlKGUsIHBlKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIGluZGV4IGVudHJ5IG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfaW5kZXhFbnRyaWVzU3RvcmUoZSkge1xuICAgIHJldHVybiBfX1BSSVZBVEVfZ2V0U3RvcmUoZSwgcWUpO1xufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgaW5kZXggY29uZmlndXJhdGlvbiBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX2luZGV4Q29uZmlndXJhdGlvblN0b3JlKGUpIHtcbiAgICByZXR1cm4gX19QUklWQVRFX2dldFN0b3JlKGUsIEZlKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIGluZGV4IHN0YXRlIG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfaW5kZXhTdGF0ZVN0b3JlKGUpIHtcbiAgICByZXR1cm4gX19QUklWQVRFX2dldFN0b3JlKGUsIE5lKTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2dldE1pbk9mZnNldEZyb21GaWVsZEluZGV4ZXMoZSkge1xuICAgIF9fUFJJVkFURV9oYXJkQXNzZXJ0KDAgIT09IGUubGVuZ3RoLCAyODgyNSk7XG4gICAgbGV0IHQgPSBlWzBdLmluZGV4U3RhdGUub2Zmc2V0LCBuID0gdC5sYXJnZXN0QmF0Y2hJZDtcbiAgICBmb3IgKGxldCByID0gMTsgciA8IGUubGVuZ3RoOyByKyspIHtcbiAgICAgICAgY29uc3QgaSA9IGVbcl0uaW5kZXhTdGF0ZS5vZmZzZXQ7XG4gICAgICAgIF9fUFJJVkFURV9pbmRleE9mZnNldENvbXBhcmF0b3IoaSwgdCkgPCAwICYmICh0ID0gaSksIG4gPCBpLmxhcmdlc3RCYXRjaElkICYmIChuID0gaS5sYXJnZXN0QmF0Y2hJZCk7XG4gICAgfVxuICAgIHJldHVybiBuZXcgSW5kZXhPZmZzZXQodC5yZWFkVGltZSwgdC5kb2N1bWVudEtleSwgbik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE4IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IHh0ID0ge1xuICAgIGRpZFJ1bjogITEsXG4gICAgc2VxdWVuY2VOdW1iZXJzQ29sbGVjdGVkOiAwLFxuICAgIHRhcmdldHNSZW1vdmVkOiAwLFxuICAgIGRvY3VtZW50c1JlbW92ZWQ6IDBcbn0sIE90ID0gNDE5NDMwNDA7XG5cbmNsYXNzIExydVBhcmFtcyB7XG4gICAgc3RhdGljIHdpdGhDYWNoZVNpemUoZSkge1xuICAgICAgICByZXR1cm4gbmV3IExydVBhcmFtcyhlLCBMcnVQYXJhbXMuREVGQVVMVF9DT0xMRUNUSU9OX1BFUkNFTlRJTEUsIExydVBhcmFtcy5ERUZBVUxUX01BWF9TRVFVRU5DRV9OVU1CRVJTX1RPX0NPTExFQ1QpO1xuICAgIH1cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvLyBXaGVuIHdlIGF0dGVtcHQgdG8gY29sbGVjdCwgd2Ugd2lsbCBvbmx5IGRvIHNvIGlmIHRoZSBjYWNoZSBzaXplIGlzIGdyZWF0ZXIgdGhhbiB0aGlzXG4gICAgLy8gdGhyZXNob2xkLiBQYXNzaW5nIGBDT0xMRUNUSU9OX0RJU0FCTEVEYCBoZXJlIHdpbGwgY2F1c2UgY29sbGVjdGlvbiB0byBhbHdheXMgYmUgc2tpcHBlZC5cbiAgICBlLCBcbiAgICAvLyBUaGUgcGVyY2VudGFnZSBvZiBzZXF1ZW5jZSBudW1iZXJzIHRoYXQgd2Ugd2lsbCBhdHRlbXB0IHRvIGNvbGxlY3RcbiAgICB0LCBcbiAgICAvLyBBIGNhcCBvbiB0aGUgdG90YWwgbnVtYmVyIG9mIHNlcXVlbmNlIG51bWJlcnMgdGhhdCB3aWxsIGJlIGNvbGxlY3RlZC4gVGhpcyBwcmV2ZW50c1xuICAgIC8vIHVzIGZyb20gY29sbGVjdGluZyBhIGh1Z2UgbnVtYmVyIG9mIHNlcXVlbmNlIG51bWJlcnMgaWYgdGhlIGNhY2hlIGhhcyBncm93biB2ZXJ5IGxhcmdlLlxuICAgIG4pIHtcbiAgICAgICAgdGhpcy5jYWNoZVNpemVDb2xsZWN0aW9uVGhyZXNob2xkID0gZSwgdGhpcy5wZXJjZW50aWxlVG9Db2xsZWN0ID0gdCwgdGhpcy5tYXhpbXVtU2VxdWVuY2VOdW1iZXJzVG9Db2xsZWN0ID0gbjtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIERlbGV0ZSBhIG11dGF0aW9uIGJhdGNoIGFuZCB0aGUgYXNzb2NpYXRlZCBkb2N1bWVudCBtdXRhdGlvbnMuXG4gKiBAcmV0dXJucyBBIFBlcnNpc3RlbmNlUHJvbWlzZSBvZiB0aGUgZG9jdW1lbnQgbXV0YXRpb25zIHRoYXQgd2VyZSByZW1vdmVkLlxuICovXG5mdW5jdGlvbiByZW1vdmVNdXRhdGlvbkJhdGNoKGUsIHQsIG4pIHtcbiAgICBjb25zdCByID0gZS5zdG9yZSh0ZSksIGkgPSBlLnN0b3JlKG9lKSwgcyA9IFtdLCBvID0gSURCS2V5UmFuZ2Uub25seShuLmJhdGNoSWQpO1xuICAgIGxldCBfID0gMDtcbiAgICBjb25zdCBhID0gci5lZSh7XG4gICAgICAgIHJhbmdlOiBvXG4gICAgfSwgKChlLCB0LCBuKSA9PiAoXysrLCBuLmRlbGV0ZSgpKSkpO1xuICAgIHMucHVzaChhLm5leHQoKCgpID0+IHtcbiAgICAgICAgX19QUklWQVRFX2hhcmRBc3NlcnQoMSA9PT0gXywgNDcwNzAsIHtcbiAgICAgICAgICAgIGJhdGNoSWQ6IG4uYmF0Y2hJZFxuICAgICAgICB9KTtcbiAgICB9KSkpO1xuICAgIGNvbnN0IHUgPSBbXTtcbiAgICBmb3IgKGNvbnN0IGUgb2Ygbi5tdXRhdGlvbnMpIHtcbiAgICAgICAgY29uc3QgciA9IF9fUFJJVkFURV9uZXdEYkRvY3VtZW50TXV0YXRpb25LZXkodCwgZS5rZXkucGF0aCwgbi5iYXRjaElkKTtcbiAgICAgICAgcy5wdXNoKGkuZGVsZXRlKHIpKSwgdS5wdXNoKGUua2V5KTtcbiAgICB9XG4gICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKHMpLm5leHQoKCgpID0+IHUpKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGFuIGFwcHJveGltYXRlIHNpemUgZm9yIHRoZSBnaXZlbiBkb2N1bWVudC5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfZGJEb2N1bWVudFNpemUoZSkge1xuICAgIGlmICghZSkgcmV0dXJuIDA7XG4gICAgbGV0IHQ7XG4gICAgaWYgKGUuZG9jdW1lbnQpIHQgPSBlLmRvY3VtZW50OyBlbHNlIGlmIChlLnVua25vd25Eb2N1bWVudCkgdCA9IGUudW5rbm93bkRvY3VtZW50OyBlbHNlIHtcbiAgICAgICAgaWYgKCFlLm5vRG9jdW1lbnQpIHRocm93IGZhaWwoMTQ3MzEpO1xuICAgICAgICB0ID0gZS5ub0RvY3VtZW50O1xuICAgIH1cbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodCkubGVuZ3RoO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqIEEgbXV0YXRpb24gcXVldWUgZm9yIGEgc3BlY2lmaWMgdXNlciwgYmFja2VkIGJ5IEluZGV4ZWREQi4gKi8gTHJ1UGFyYW1zLkRFRkFVTFRfQ09MTEVDVElPTl9QRVJDRU5USUxFID0gMTAsIFxuTHJ1UGFyYW1zLkRFRkFVTFRfTUFYX1NFUVVFTkNFX05VTUJFUlNfVE9fQ09MTEVDVCA9IDFlMywgTHJ1UGFyYW1zLkRFRkFVTFQgPSBuZXcgTHJ1UGFyYW1zKE90LCBMcnVQYXJhbXMuREVGQVVMVF9DT0xMRUNUSU9OX1BFUkNFTlRJTEUsIExydVBhcmFtcy5ERUZBVUxUX01BWF9TRVFVRU5DRV9OVU1CRVJTX1RPX0NPTExFQ1QpLCBcbkxydVBhcmFtcy5ESVNBQkxFRCA9IG5ldyBMcnVQYXJhbXMoLTEsIDAsIDApO1xuXG5jbGFzcyBfX1BSSVZBVEVfSW5kZXhlZERiTXV0YXRpb25RdWV1ZSB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIG5vcm1hbGl6ZWQgdXNlcklkIChlLmcuIG51bGwgVUlEID0+IFwiXCIgdXNlcklkKSB1c2VkIHRvIHN0b3JlIC9cbiAgICAgKiByZXRyaWV2ZSBtdXRhdGlvbnMuXG4gICAgICovXG4gICAgZSwgdCwgbiwgcikge1xuICAgICAgICB0aGlzLnVzZXJJZCA9IGUsIHRoaXMuc2VyaWFsaXplciA9IHQsIHRoaXMuaW5kZXhNYW5hZ2VyID0gbiwgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSA9IHIsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FjaGVzIHRoZSBkb2N1bWVudCBrZXlzIGZvciBwZW5kaW5nIG11dGF0aW9uIGJhdGNoZXMuIElmIHRoZSBtdXRhdGlvblxuICAgICAgICAgKiBoYXMgYmVlbiByZW1vdmVkIGZyb20gSW5kZXhlZERiLCB0aGUgY2FjaGVkIHZhbHVlIG1heSBjb250aW51ZSB0b1xuICAgICAgICAgKiBiZSB1c2VkIHRvIHJldHJpZXZlIHRoZSBiYXRjaCdzIGRvY3VtZW50IGtleXMuIFRvIHJlbW92ZSBhIGNhY2hlZCB2YWx1ZVxuICAgICAgICAgKiBsb2NhbGx5LCBgcmVtb3ZlQ2FjaGVkTXV0YXRpb25LZXlzKClgIHNob3VsZCBiZSBpbnZva2VkIGVpdGhlciBkaXJlY3RseVxuICAgICAgICAgKiBvciB0aHJvdWdoIGByZW1vdmVNdXRhdGlvbkJhdGNoZXMoKWAuXG4gICAgICAgICAqXG4gICAgICAgICAqIFdpdGggbXVsdGktdGFiLCB3aGVuIHRoZSBwcmltYXJ5IGNsaWVudCBhY2tub3dsZWRnZXMgb3IgcmVqZWN0cyBhIG11dGF0aW9uLFxuICAgICAgICAgKiB0aGlzIGNhY2hlIGlzIHVzZWQgYnkgc2Vjb25kYXJ5IGNsaWVudHMgdG8gaW52YWxpZGF0ZSB0aGUgbG9jYWxcbiAgICAgICAgICogdmlldyBvZiB0aGUgZG9jdW1lbnRzIHRoYXQgd2VyZSBwcmV2aW91c2x5IGFmZmVjdGVkIGJ5IHRoZSBtdXRhdGlvbi5cbiAgICAgICAgICovXG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXG4gICAgICAgIHRoaXMuWG4gPSB7fTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBtdXRhdGlvbiBxdWV1ZSBmb3IgdGhlIGdpdmVuIHVzZXIuXG4gICAgICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlciBmb3Igd2hpY2ggdG8gY3JlYXRlIGEgbXV0YXRpb24gcXVldWUuXG4gICAgICogQHBhcmFtIHNlcmlhbGl6ZXIgLSBUaGUgc2VyaWFsaXplciB0byB1c2Ugd2hlbiBwZXJzaXN0aW5nIHRvIEluZGV4ZWREYi5cbiAgICAgKi8gICAgc3RhdGljIHd0KGUsIHQsIG4sIHIpIHtcbiAgICAgICAgLy8gVE9ETyhtY2cpOiBGaWd1cmUgb3V0IHdoYXQgY29uc3RyYWludHMgdGhlcmUgYXJlIG9uIHVzZXJJRHNcbiAgICAgICAgLy8gSW4gcGFydGljdWxhciwgYXJlIHRoZXJlIGFueSByZXNlcnZlZCBjaGFyYWN0ZXJzPyBhcmUgZW1wdHkgaWRzIGFsbG93ZWQ/XG4gICAgICAgIC8vIEZvciB0aGUgbW9tZW50IHN0b3JlIHRoZXNlIHRvZ2V0aGVyIGluIHRoZSBzYW1lIG11dGF0aW9ucyB0YWJsZSBhc3N1bWluZ1xuICAgICAgICAvLyB0aGF0IGVtcHR5IHVzZXJJRHMgYXJlbid0IGFsbG93ZWQuXG4gICAgICAgIF9fUFJJVkFURV9oYXJkQXNzZXJ0KFwiXCIgIT09IGUudWlkLCA2NDM4Nyk7XG4gICAgICAgIGNvbnN0IGkgPSBlLmlzQXV0aGVudGljYXRlZCgpID8gZS51aWQgOiBcIlwiO1xuICAgICAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9JbmRleGVkRGJNdXRhdGlvblF1ZXVlKGksIHQsIG4sIHIpO1xuICAgIH1cbiAgICBjaGVja0VtcHR5KGUpIHtcbiAgICAgICAgbGV0IHQgPSAhMDtcbiAgICAgICAgY29uc3QgbiA9IElEQktleVJhbmdlLmJvdW5kKFsgdGhpcy51c2VySWQsIE51bWJlci5ORUdBVElWRV9JTkZJTklUWSBdLCBbIHRoaXMudXNlcklkLCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkgXSk7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfbXV0YXRpb25zU3RvcmUoZSkuZWUoe1xuICAgICAgICAgICAgaW5kZXg6IHJlLFxuICAgICAgICAgICAgcmFuZ2U6IG5cbiAgICAgICAgfSwgKChlLCBuLCByKSA9PiB7XG4gICAgICAgICAgICB0ID0gITEsIHIuZG9uZSgpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gdCkpO1xuICAgIH1cbiAgICBhZGRNdXRhdGlvbkJhdGNoKGUsIHQsIG4sIHIpIHtcbiAgICAgICAgY29uc3QgaSA9IF9fUFJJVkFURV9kb2N1bWVudE11dGF0aW9uc1N0b3JlKGUpLCBzID0gX19QUklWQVRFX211dGF0aW9uc1N0b3JlKGUpO1xuICAgICAgICAvLyBUaGUgSW5kZXhlZERiIGltcGxlbWVudGF0aW9uIGluIENocm9tZSAoYW5kIEZpcmVmb3gpIGRvZXMgbm90IGhhbmRsZVxuICAgICAgICAvLyBjb21wb3VuZCBpbmRpY2VzIHRoYXQgaW5jbHVkZSBhdXRvLWdlbmVyYXRlZCBrZXlzIGNvcnJlY3RseS4gVG8gZW5zdXJlXG4gICAgICAgIC8vIHRoYXQgdGhlIGluZGV4IGVudHJ5IGlzIGFkZGVkIGNvcnJlY3RseSBpbiBhbGwgYnJvd3NlcnMsIHdlIHBlcmZvcm0gdHdvXG4gICAgICAgIC8vIHdyaXRlczogVGhlIGZpcnN0IHdyaXRlIGlzIHVzZWQgdG8gcmV0cmlldmUgdGhlIG5leHQgYXV0by1nZW5lcmF0ZWQgQmF0Y2hcbiAgICAgICAgLy8gSUQsIGFuZCB0aGUgc2Vjb25kIHdyaXRlIHBvcHVsYXRlcyB0aGUgaW5kZXggYW5kIHN0b3JlcyB0aGUgYWN0dWFsXG4gICAgICAgIC8vIG11dGF0aW9uIGJhdGNoLlxuICAgICAgICAvLyBTZWU6IGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTcwMTk3MlxuICAgICAgICAvLyBXZSB3cml0ZSBhbiBlbXB0eSBvYmplY3QgdG8gb2J0YWluIGtleVxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICByZXR1cm4gcy5hZGQoe30pLm5leHQoKG8gPT4ge1xuICAgICAgICAgICAgX19QUklWQVRFX2hhcmRBc3NlcnQoXCJudW1iZXJcIiA9PSB0eXBlb2YgbywgNDkwMTkpO1xuICAgICAgICAgICAgY29uc3QgXyA9IG5ldyBNdXRhdGlvbkJhdGNoKG8sIHQsIG4sIHIpLCBhID0gZnVuY3Rpb24gX19QUklWQVRFX3RvRGJNdXRhdGlvbkJhdGNoKGUsIHQsIG4pIHtcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbi5iYXNlTXV0YXRpb25zLm1hcCgodCA9PiB0b011dGF0aW9uKGUueXQsIHQpKSksIGkgPSBuLm11dGF0aW9ucy5tYXAoKHQgPT4gdG9NdXRhdGlvbihlLnl0LCB0KSkpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZDogdCxcbiAgICAgICAgICAgICAgICAgICAgYmF0Y2hJZDogbi5iYXRjaElkLFxuICAgICAgICAgICAgICAgICAgICBsb2NhbFdyaXRlVGltZU1zOiBuLmxvY2FsV3JpdGVUaW1lLnRvTWlsbGlzKCksXG4gICAgICAgICAgICAgICAgICAgIGJhc2VNdXRhdGlvbnM6IHIsXG4gICAgICAgICAgICAgICAgICAgIG11dGF0aW9uczogaVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KHRoaXMuc2VyaWFsaXplciwgdGhpcy51c2VySWQsIF8pLCB1ID0gW107XG4gICAgICAgICAgICBsZXQgYyA9IG5ldyBTb3J0ZWRTZXQoKChlLCB0KSA9PiBfX1BSSVZBVEVfcHJpbWl0aXZlQ29tcGFyYXRvcihlLmNhbm9uaWNhbFN0cmluZygpLCB0LmNhbm9uaWNhbFN0cmluZygpKSkpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gX19QUklWQVRFX25ld0RiRG9jdW1lbnRNdXRhdGlvbktleSh0aGlzLnVzZXJJZCwgZS5rZXkucGF0aCwgbyk7XG4gICAgICAgICAgICAgICAgYyA9IGMuYWRkKGUua2V5LnBhdGgucG9wTGFzdCgpKSwgdS5wdXNoKHMucHV0KGEpKSwgdS5wdXNoKGkucHV0KHQsIHNlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYy5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICB1LnB1c2godGhpcy5pbmRleE1hbmFnZXIuYWRkVG9Db2xsZWN0aW9uUGFyZW50SW5kZXgoZSwgdCkpO1xuICAgICAgICAgICAgfSkpLCBlLmFkZE9uQ29tbWl0dGVkTGlzdGVuZXIoKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLlhuW29dID0gXy5rZXlzKCk7XG4gICAgICAgICAgICB9KSksIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKHUpLm5leHQoKCgpID0+IF8pKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBsb29rdXBNdXRhdGlvbkJhdGNoKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9tdXRhdGlvbnNTdG9yZShlKS5nZXQodCkubmV4dCgoZSA9PiBlID8gKF9fUFJJVkFURV9oYXJkQXNzZXJ0KGUudXNlcklkID09PSB0aGlzLnVzZXJJZCwgNDgsIFwiVW5leHBlY3RlZCB1c2VyIGZvciBtdXRhdGlvbiBiYXRjaFwiLCB7XG4gICAgICAgICAgICB1c2VySWQ6IGUudXNlcklkLFxuICAgICAgICAgICAgYmF0Y2hJZDogdFxuICAgICAgICB9KSwgX19QUklWQVRFX2Zyb21EYk11dGF0aW9uQmF0Y2godGhpcy5zZXJpYWxpemVyLCBlKSkgOiBudWxsKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGRvY3VtZW50IGtleXMgZm9yIHRoZSBtdXRhdGlvbiBiYXRjaCB3aXRoIHRoZSBnaXZlbiBiYXRjaElkLlxuICAgICAqIEZvciBwcmltYXJ5IGNsaWVudHMsIHRoaXMgbWV0aG9kIHJldHVybnMgYG51bGxgIGFmdGVyXG4gICAgICogYHJlbW92ZU11dGF0aW9uQmF0Y2hlcygpYCBoYXMgYmVlbiBjYWxsZWQuIFNlY29uZGFyeSBjbGllbnRzIHJldHVybiBhXG4gICAgICogY2FjaGVkIHJlc3VsdCB1bnRpbCBgcmVtb3ZlQ2FjaGVkTXV0YXRpb25LZXlzKClgIGlzIGludm9rZWQuXG4gICAgICovXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cbiAgICBlcihlLCB0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLlhuW3RdID8gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy5Yblt0XSkgOiB0aGlzLmxvb2t1cE11dGF0aW9uQmF0Y2goZSwgdCkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICBpZiAoZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLmtleXMoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5Yblt0XSA9IG4sIG47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBnZXROZXh0TXV0YXRpb25CYXRjaEFmdGVyQmF0Y2hJZChlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSB0ICsgMSwgciA9IElEQktleVJhbmdlLmxvd2VyQm91bmQoWyB0aGlzLnVzZXJJZCwgbiBdKTtcbiAgICAgICAgbGV0IGkgPSBudWxsO1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX211dGF0aW9uc1N0b3JlKGUpLmVlKHtcbiAgICAgICAgICAgIGluZGV4OiByZSxcbiAgICAgICAgICAgIHJhbmdlOiByXG4gICAgICAgIH0sICgoZSwgdCwgcikgPT4ge1xuICAgICAgICAgICAgdC51c2VySWQgPT09IHRoaXMudXNlcklkICYmIChfX1BSSVZBVEVfaGFyZEFzc2VydCh0LmJhdGNoSWQgPj0gbiwgNDc1MjQsIHtcbiAgICAgICAgICAgICAgICB0cjogblxuICAgICAgICAgICAgfSksIGkgPSBfX1BSSVZBVEVfZnJvbURiTXV0YXRpb25CYXRjaCh0aGlzLnNlcmlhbGl6ZXIsIHQpKSwgci5kb25lKCk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBpKSk7XG4gICAgfVxuICAgIGdldEhpZ2hlc3RVbmFja25vd2xlZGdlZEJhdGNoSWQoZSkge1xuICAgICAgICBjb25zdCB0ID0gSURCS2V5UmFuZ2UudXBwZXJCb3VuZChbIHRoaXMudXNlcklkLCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkgXSk7XG4gICAgICAgIGxldCBuID0gajtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9tdXRhdGlvbnNTdG9yZShlKS5lZSh7XG4gICAgICAgICAgICBpbmRleDogcmUsXG4gICAgICAgICAgICByYW5nZTogdCxcbiAgICAgICAgICAgIHJldmVyc2U6ICEwXG4gICAgICAgIH0sICgoZSwgdCwgcikgPT4ge1xuICAgICAgICAgICAgbiA9IHQuYmF0Y2hJZCwgci5kb25lKCk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBuKSk7XG4gICAgfVxuICAgIGdldEFsbE11dGF0aW9uQmF0Y2hlcyhlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBJREJLZXlSYW5nZS5ib3VuZChbIHRoaXMudXNlcklkLCBqIF0sIFsgdGhpcy51c2VySWQsIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSBdKTtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9tdXRhdGlvbnNTdG9yZShlKS5KKHJlLCB0KS5uZXh0KChlID0+IGUubWFwKChlID0+IF9fUFJJVkFURV9mcm9tRGJNdXRhdGlvbkJhdGNoKHRoaXMuc2VyaWFsaXplciwgZSkpKSkpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleShlLCB0KSB7XG4gICAgICAgIC8vIFNjYW4gdGhlIGRvY3VtZW50LW11dGF0aW9uIGluZGV4IHN0YXJ0aW5nIHdpdGggYSBwcmVmaXggc3RhcnRpbmcgd2l0aFxuICAgICAgICAvLyB0aGUgZ2l2ZW4gZG9jdW1lbnRLZXkuXG4gICAgICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfbmV3RGJEb2N1bWVudE11dGF0aW9uUHJlZml4Rm9yUGF0aCh0aGlzLnVzZXJJZCwgdC5wYXRoKSwgciA9IElEQktleVJhbmdlLmxvd2VyQm91bmQobiksIGkgPSBbXTtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9kb2N1bWVudE11dGF0aW9uc1N0b3JlKGUpLmVlKHtcbiAgICAgICAgICAgIHJhbmdlOiByXG4gICAgICAgIH0sICgobiwgciwgcykgPT4ge1xuICAgICAgICAgICAgY29uc3QgW28sIF8sIGFdID0gbiwgdSA9IF9fUFJJVkFURV9kZWNvZGVSZXNvdXJjZVBhdGgoXyk7XG4gICAgICAgICAgICAvLyBPbmx5IGNvbnNpZGVyIHJvd3MgbWF0Y2hpbmcgZXhhY3RseSB0aGUgc3BlY2lmaWMga2V5IG9mXG4gICAgICAgICAgICAvLyBpbnRlcmVzdC4gTm90ZSB0aGF0IGJlY2F1c2Ugd2Ugb3JkZXIgYnkgcGF0aCBmaXJzdCwgYW5kIHdlXG4gICAgICAgICAgICAvLyBvcmRlciB0ZXJtaW5hdG9ycyBiZWZvcmUgcGF0aCBzZXBhcmF0b3JzLCB3ZSdsbCBlbmNvdW50ZXIgYWxsXG4gICAgICAgICAgICAvLyB0aGUgaW5kZXggcm93cyBmb3IgZG9jdW1lbnRLZXkgY29udGlndW91c2x5LiBJbiBwYXJ0aWN1bGFyLCBhbGxcbiAgICAgICAgICAgIC8vIHRoZSByb3dzIGZvciBkb2N1bWVudEtleSB3aWxsIG9jY3VyIGJlZm9yZSBhbnkgcm93cyBmb3JcbiAgICAgICAgICAgIC8vIGRvY3VtZW50cyBuZXN0ZWQgaW4gYSBzdWJjb2xsZWN0aW9uIGJlbmVhdGggZG9jdW1lbnRLZXkgc28gd2VcbiAgICAgICAgICAgIC8vIGNhbiBzdG9wIGFzIHNvb24gYXMgd2UgaGl0IGFueSBzdWNoIHJvdy5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvID09PSB0aGlzLnVzZXJJZCAmJiB0LnBhdGguaXNFcXVhbCh1KSkgXG4gICAgICAgICAgICAvLyBMb29rIHVwIHRoZSBtdXRhdGlvbiBiYXRjaCBpbiB0aGUgc3RvcmUuXG4gICAgICAgICAgICByZXR1cm4gX19QUklWQVRFX211dGF0aW9uc1N0b3JlKGUpLmdldChhKS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWUpIHRocm93IGZhaWwoNjE0ODAsIHtcbiAgICAgICAgICAgICAgICAgICAgbnI6IG4sXG4gICAgICAgICAgICAgICAgICAgIGJhdGNoSWQ6IGFcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfX1BSSVZBVEVfaGFyZEFzc2VydChlLnVzZXJJZCA9PT0gdGhpcy51c2VySWQsIDEwNTAzLCBcIlVuZXhwZWN0ZWQgdXNlciBmb3IgbXV0YXRpb24gYmF0Y2hcIiwge1xuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGUudXNlcklkLFxuICAgICAgICAgICAgICAgICAgICBiYXRjaElkOiBhXG4gICAgICAgICAgICAgICAgfSksIGkucHVzaChfX1BSSVZBVEVfZnJvbURiTXV0YXRpb25CYXRjaCh0aGlzLnNlcmlhbGl6ZXIsIGUpKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHMuZG9uZSgpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gaSkpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleXMoZSwgdCkge1xuICAgICAgICBsZXQgbiA9IG5ldyBTb3J0ZWRTZXQoX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IpO1xuICAgICAgICBjb25zdCByID0gW107XG4gICAgICAgIHJldHVybiB0LmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IF9fUFJJVkFURV9uZXdEYkRvY3VtZW50TXV0YXRpb25QcmVmaXhGb3JQYXRoKHRoaXMudXNlcklkLCB0LnBhdGgpLCBzID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZChpKSwgbyA9IF9fUFJJVkFURV9kb2N1bWVudE11dGF0aW9uc1N0b3JlKGUpLmVlKHtcbiAgICAgICAgICAgICAgICByYW5nZTogc1xuICAgICAgICAgICAgfSwgKChlLCByLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgW3MsIG8sIF9dID0gZSwgYSA9IF9fUFJJVkFURV9kZWNvZGVSZXNvdXJjZVBhdGgobyk7XG4gICAgICAgICAgICAgICAgLy8gT25seSBjb25zaWRlciByb3dzIG1hdGNoaW5nIGV4YWN0bHkgdGhlIHNwZWNpZmljIGtleSBvZlxuICAgICAgICAgICAgICAgIC8vIGludGVyZXN0LiBOb3RlIHRoYXQgYmVjYXVzZSB3ZSBvcmRlciBieSBwYXRoIGZpcnN0LCBhbmQgd2VcbiAgICAgICAgICAgICAgICAvLyBvcmRlciB0ZXJtaW5hdG9ycyBiZWZvcmUgcGF0aCBzZXBhcmF0b3JzLCB3ZSdsbCBlbmNvdW50ZXIgYWxsXG4gICAgICAgICAgICAgICAgLy8gdGhlIGluZGV4IHJvd3MgZm9yIGRvY3VtZW50S2V5IGNvbnRpZ3VvdXNseS4gSW4gcGFydGljdWxhciwgYWxsXG4gICAgICAgICAgICAgICAgLy8gdGhlIHJvd3MgZm9yIGRvY3VtZW50S2V5IHdpbGwgb2NjdXIgYmVmb3JlIGFueSByb3dzIGZvclxuICAgICAgICAgICAgICAgIC8vIGRvY3VtZW50cyBuZXN0ZWQgaW4gYSBzdWJjb2xsZWN0aW9uIGJlbmVhdGggZG9jdW1lbnRLZXkgc28gd2VcbiAgICAgICAgICAgICAgICAvLyBjYW4gc3RvcCBhcyBzb29uIGFzIHdlIGhpdCBhbnkgc3VjaCByb3cuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHMgPT09IHRoaXMudXNlcklkICYmIHQucGF0aC5pc0VxdWFsKGEpID8gbiA9IG4uYWRkKF8pIDogaS5kb25lKCk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICByLnB1c2gobyk7XG4gICAgICAgIH0pKSwgUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IocikubmV4dCgoKCkgPT4gdGhpcy5ycihlLCBuKSkpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdRdWVyeShlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSB0LnBhdGgsIHIgPSBuLmxlbmd0aCArIDEsIGkgPSBfX1BSSVZBVEVfbmV3RGJEb2N1bWVudE11dGF0aW9uUHJlZml4Rm9yUGF0aCh0aGlzLnVzZXJJZCwgbiksIHMgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKGkpO1xuICAgICAgICAvLyBDb2xsZWN0IHVwIHVuaXF1ZSBiYXRjaElEcyBlbmNvdW50ZXJlZCBkdXJpbmcgYSBzY2FuIG9mIHRoZSBpbmRleC4gVXNlIGFcbiAgICAgICAgLy8gU29ydGVkU2V0IHRvIGFjY3VtdWxhdGUgYmF0Y2ggSURzIHNvIHRoZXkgY2FuIGJlIHRyYXZlcnNlZCBpbiBvcmRlciBpbiBhXG4gICAgICAgIC8vIHNjYW4gb2YgdGhlIG1haW4gdGFibGUuXG4gICAgICAgIGxldCBvID0gbmV3IFNvcnRlZFNldChfX1BSSVZBVEVfcHJpbWl0aXZlQ29tcGFyYXRvcik7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfZG9jdW1lbnRNdXRhdGlvbnNTdG9yZShlKS5lZSh7XG4gICAgICAgICAgICByYW5nZTogc1xuICAgICAgICB9LCAoKGUsIHQsIGkpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IFtzLCBfLCBhXSA9IGUsIHUgPSBfX1BSSVZBVEVfZGVjb2RlUmVzb3VyY2VQYXRoKF8pO1xuICAgICAgICAgICAgcyA9PT0gdGhpcy51c2VySWQgJiYgbi5pc1ByZWZpeE9mKHUpID8gXG4gICAgICAgICAgICAvLyBSb3dzIHdpdGggZG9jdW1lbnQga2V5cyBtb3JlIHRoYW4gb25lIHNlZ21lbnQgbG9uZ2VyIHRoYW4gdGhlXG4gICAgICAgICAgICAvLyBxdWVyeSBwYXRoIGNhbid0IGJlIG1hdGNoZXMuIEZvciBleGFtcGxlLCBhIHF1ZXJ5IG9uICdyb29tcydcbiAgICAgICAgICAgIC8vIGNhbid0IG1hdGNoIHRoZSBkb2N1bWVudCAvcm9vbXMvYWJjL21lc3NhZ2VzL3h5eC5cbiAgICAgICAgICAgIC8vIFRPRE8obWNnKTogd2UnbGwgbmVlZCBhIGRpZmZlcmVudCBzY2FubmVyIHdoZW4gd2UgaW1wbGVtZW50XG4gICAgICAgICAgICAvLyBhbmNlc3RvciBxdWVyaWVzLlxuICAgICAgICAgICAgdS5sZW5ndGggPT09IHIgJiYgKG8gPSBvLmFkZChhKSkgOiBpLmRvbmUoKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHRoaXMucnIoZSwgbykpKTtcbiAgICB9XG4gICAgcnIoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gW10sIHIgPSBbXTtcbiAgICAgICAgLy8gVE9ETyhyb2Nrd29vZCk6IEltcGxlbWVudCB0aGlzIHVzaW5nIGl0ZXJhdGUuXG4gICAgICAgIHJldHVybiB0LmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgci5wdXNoKF9fUFJJVkFURV9tdXRhdGlvbnNTdG9yZShlKS5nZXQodCkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKG51bGwgPT09IGUpIHRocm93IGZhaWwoMzUyNzQsIHtcbiAgICAgICAgICAgICAgICAgICAgYmF0Y2hJZDogdFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF9fUFJJVkFURV9oYXJkQXNzZXJ0KGUudXNlcklkID09PSB0aGlzLnVzZXJJZCwgOTc0OCwgXCJVbmV4cGVjdGVkIHVzZXIgZm9yIG11dGF0aW9uIGJhdGNoXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBlLnVzZXJJZCxcbiAgICAgICAgICAgICAgICAgICAgYmF0Y2hJZDogdFxuICAgICAgICAgICAgICAgIH0pLCBuLnB1c2goX19QUklWQVRFX2Zyb21EYk11dGF0aW9uQmF0Y2godGhpcy5zZXJpYWxpemVyLCBlKSk7XG4gICAgICAgICAgICB9KSkpO1xuICAgICAgICB9KSksIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKHIpLm5leHQoKCgpID0+IG4pKTtcbiAgICB9XG4gICAgcmVtb3ZlTXV0YXRpb25CYXRjaChlLCB0KSB7XG4gICAgICAgIHJldHVybiByZW1vdmVNdXRhdGlvbkJhdGNoKGUubGUsIHRoaXMudXNlcklkLCB0KS5uZXh0KChuID0+IChlLmFkZE9uQ29tbWl0dGVkTGlzdGVuZXIoKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuaXIodC5iYXRjaElkKTtcbiAgICAgICAgfSkpLCBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaChuLCAodCA9PiB0aGlzLnJlZmVyZW5jZURlbGVnYXRlLm1hcmtQb3RlbnRpYWxseU9ycGhhbmVkKGUsIHQpKSkpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsZWFycyB0aGUgY2FjaGVkIGtleXMgZm9yIGEgbXV0YXRpb24gYmF0Y2guIFRoaXMgbWV0aG9kIHNob3VsZCBiZVxuICAgICAqIGNhbGxlZCBieSBzZWNvbmRhcnkgY2xpZW50cyBhZnRlciB0aGV5IHByb2Nlc3MgbXV0YXRpb24gdXBkYXRlcy5cbiAgICAgKlxuICAgICAqIE5vdGUgdGhhdCB0aGlzIG1ldGhvZCBkb2VzIG5vdCBoYXZlIHRvIGJlIGNhbGxlZCBmcm9tIHByaW1hcnkgY2xpZW50cyBhc1xuICAgICAqIHRoZSBjb3JyZXNwb25kaW5nIGNhY2hlIGVudHJpZXMgYXJlIGNsZWFyZWQgd2hlbiBhbiBhY2tub3dsZWRnZWQgb3JcbiAgICAgKiByZWplY3RlZCBiYXRjaCBpcyByZW1vdmVkIGZyb20gdGhlIG11dGF0aW9uIHF1ZXVlLlxuICAgICAqL1xuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHlcbiAgICBpcihlKSB7XG4gICAgICAgIGRlbGV0ZSB0aGlzLlhuW2VdO1xuICAgIH1cbiAgICBwZXJmb3JtQ29uc2lzdGVuY3lDaGVjayhlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNoZWNrRW1wdHkoZSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBpZiAoIXQpIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICAgICAgLy8gVmVyaWZ5IHRoYXQgdGhlcmUgYXJlIG5vIGVudHJpZXMgaW4gdGhlIGRvY3VtZW50TXV0YXRpb25zIGluZGV4IGlmXG4gICAgICAgICAgICAvLyB0aGUgcXVldWUgaXMgZW1wdHkuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZChcbiAgICAgICAgICAgIC8qKlxuICogQ3JlYXRlcyBhIFt1c2VySWRdIGtleSBmb3IgdXNlIGluIHRoZSBEYkRvY3VtZW50TXV0YXRpb25zIGluZGV4IHRvIGl0ZXJhdGVcbiAqIG92ZXIgYWxsIG9mIGEgdXNlcidzIGRvY3VtZW50IG11dGF0aW9ucy5cbiAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gX19QUklWQVRFX25ld0RiRG9jdW1lbnRNdXRhdGlvblByZWZpeEZvclVzZXIoZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbIGUgXTtcbiAgICAgICAgICAgIH0odGhpcy51c2VySWQpKSwgciA9IFtdO1xuICAgICAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9kb2N1bWVudE11dGF0aW9uc1N0b3JlKGUpLmVlKHtcbiAgICAgICAgICAgICAgICByYW5nZTogblxuICAgICAgICAgICAgfSwgKChlLCB0LCBuKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGVbMF0gPT09IHRoaXMudXNlcklkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBfX1BSSVZBVEVfZGVjb2RlUmVzb3VyY2VQYXRoKGVbMV0pO1xuICAgICAgICAgICAgICAgICAgICByLnB1c2godCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIG4uZG9uZSgpO1xuICAgICAgICAgICAgfSkpLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgICAgICBfX1BSSVZBVEVfaGFyZEFzc2VydCgwID09PSByLmxlbmd0aCwgNTY3MjAsIHtcbiAgICAgICAgICAgICAgICAgICAgc3I6IHIubWFwKChlID0+IGUuY2Fub25pY2FsU3RyaW5nKCkpKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGNvbnRhaW5zS2V5KGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9tdXRhdGlvblF1ZXVlQ29udGFpbnNLZXkoZSwgdGhpcy51c2VySWQsIHQpO1xuICAgIH1cbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5IChzdGF0ZSBpcyBoZWxkIGluIG1lbW9yeSBpbiBvdGhlciBjbGllbnRzKS5cbiAgICAvKiogUmV0dXJucyB0aGUgbXV0YXRpb24gcXVldWUncyBtZXRhZGF0YSBmcm9tIEluZGV4ZWREYi4gKi9cbiAgICBfcihlKSB7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfbXV0YXRpb25RdWV1ZXNTdG9yZShlKS5nZXQodGhpcy51c2VySWQpLm5leHQoKGUgPT4gZSB8fCB7XG4gICAgICAgICAgICB1c2VySWQ6IHRoaXMudXNlcklkLFxuICAgICAgICAgICAgbGFzdEFja25vd2xlZGdlZEJhdGNoSWQ6IGosXG4gICAgICAgICAgICBsYXN0U3RyZWFtVG9rZW46IFwiXCJcbiAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAcmV0dXJucyB0cnVlIGlmIHRoZSBtdXRhdGlvbiBxdWV1ZSBmb3IgdGhlIGdpdmVuIHVzZXIgY29udGFpbnMgYSBwZW5kaW5nXG4gKiAgICAgICAgIG11dGF0aW9uIGZvciB0aGUgZ2l2ZW4ga2V5LlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9tdXRhdGlvblF1ZXVlQ29udGFpbnNLZXkoZSwgdCwgbikge1xuICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfbmV3RGJEb2N1bWVudE11dGF0aW9uUHJlZml4Rm9yUGF0aCh0LCBuLnBhdGgpLCBpID0gclsxXSwgcyA9IElEQktleVJhbmdlLmxvd2VyQm91bmQocik7XG4gICAgbGV0IG8gPSAhMTtcbiAgICByZXR1cm4gX19QUklWQVRFX2RvY3VtZW50TXV0YXRpb25zU3RvcmUoZSkuZWUoe1xuICAgICAgICByYW5nZTogcyxcbiAgICAgICAgWDogITBcbiAgICB9LCAoKGUsIG4sIHIpID0+IHtcbiAgICAgICAgY29uc3QgW3MsIF8sIC8qYmF0Y2hJRCovIGFdID0gZTtcbiAgICAgICAgcyA9PT0gdCAmJiBfID09PSBpICYmIChvID0gITApLCByLmRvbmUoKTtcbiAgICB9KSkubmV4dCgoKCkgPT4gbykpO1xufVxuXG4vKiogUmV0dXJucyB0cnVlIGlmIGFueSBtdXRhdGlvbiBxdWV1ZSBjb250YWlucyB0aGUgZ2l2ZW4gZG9jdW1lbnQuICovXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgbXV0YXRpb25zIG9iamVjdCBzdG9yZS5cbiAqL1xuZnVuY3Rpb24gX19QUklWQVRFX211dGF0aW9uc1N0b3JlKGUpIHtcbiAgICByZXR1cm4gX19QUklWQVRFX2dldFN0b3JlKGUsIHRlKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIG11dGF0aW9uUXVldWVzIG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfZG9jdW1lbnRNdXRhdGlvbnNTdG9yZShlKSB7XG4gICAgcmV0dXJuIF9fUFJJVkFURV9nZXRTdG9yZShlLCBvZSk7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBtdXRhdGlvblF1ZXVlcyBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX211dGF0aW9uUXVldWVzU3RvcmUoZSkge1xuICAgIHJldHVybiBfX1BSSVZBVEVfZ2V0U3RvcmUoZSwgWCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogT2Zmc2V0IHRvIGVuc3VyZSBub24tb3ZlcmxhcHBpbmcgdGFyZ2V0IGlkcy4gKi9cbi8qKlxuICogR2VuZXJhdGVzIG1vbm90b25pY2FsbHkgaW5jcmVhc2luZyB0YXJnZXQgSURzIGZvciBzZW5kaW5nIHRhcmdldHMgdG8gdGhlXG4gKiB3YXRjaCBzdHJlYW0uXG4gKlxuICogVGhlIGNsaWVudCBjb25zdHJ1Y3RzIHR3byBnZW5lcmF0b3JzLCBvbmUgZm9yIHRoZSB0YXJnZXQgY2FjaGUsIGFuZCBvbmUgZm9yXG4gKiBmb3IgdGhlIHN5bmMgZW5naW5lICh0byBnZW5lcmF0ZSBsaW1ibyBkb2N1bWVudHMgdGFyZ2V0cykuIFRoZXNlXG4gKiBnZW5lcmF0b3JzIHByb2R1Y2Ugbm9uLW92ZXJsYXBwaW5nIElEcyAoYnkgdXNpbmcgZXZlbiBhbmQgb2RkIElEc1xuICogcmVzcGVjdGl2ZWx5KS5cbiAqXG4gKiBCeSBzZXBhcmF0aW5nIHRoZSB0YXJnZXQgSUQgc3BhY2UsIHRoZSBxdWVyeSBjYWNoZSBjYW4gZ2VuZXJhdGUgdGFyZ2V0IElEc1xuICogdGhhdCBwZXJzaXN0IGFjcm9zcyBjbGllbnQgcmVzdGFydHMsIHdoaWxlIHN5bmMgZW5naW5lIGNhbiBpbmRlcGVuZGVudGx5XG4gKiBnZW5lcmF0ZSBpbi1tZW1vcnkgdGFyZ2V0IElEcyB0aGF0IGFyZSB0cmFuc2llbnQgYW5kIGNhbiBiZSByZXVzZWQgYWZ0ZXIgYVxuICogcmVzdGFydC5cbiAqL1xuY2xhc3MgX19QUklWQVRFX1RhcmdldElkR2VuZXJhdG9yIHtcbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHRoaXMuYXIgPSBlO1xuICAgIH1cbiAgICBuZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hciArPSAyLCB0aGlzLmFyO1xuICAgIH1cbiAgICBzdGF0aWMgdXIoKSB7XG4gICAgICAgIC8vIFRoZSB0YXJnZXQgY2FjaGUgZ2VuZXJhdG9yIG11c3QgcmV0dXJuICcyJyBpbiBpdHMgZmlyc3QgY2FsbCB0byBgbmV4dCgpYFxuICAgICAgICAvLyBhcyB0aGVyZSBpcyBubyBkaWZmZXJlbnRpYXRpb24gaW4gdGhlIHByb3RvY29sIGxheWVyIGJldHdlZW4gYW4gdW5zZXRcbiAgICAgICAgLy8gbnVtYmVyIGFuZCB0aGUgbnVtYmVyICcwJy4gSWYgd2Ugd2VyZSB0byBzZW50IGEgdGFyZ2V0IHdpdGggdGFyZ2V0IElEXG4gICAgICAgIC8vICcwJywgdGhlIGJhY2tlbmQgd291bGQgY29uc2lkZXIgaXQgdW5zZXQgYW5kIHJlcGxhY2UgaXQgd2l0aCBpdHMgb3duIElELlxuICAgICAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9UYXJnZXRJZEdlbmVyYXRvcigwKTtcbiAgICB9XG4gICAgc3RhdGljIGNyKCkge1xuICAgICAgICAvLyBTeW5jIGVuZ2luZSBhc3NpZ25zIHRhcmdldCBJRHMgZm9yIGxpbWJvIGRvY3VtZW50IGRldGVjdGlvbi5cbiAgICAgICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfVGFyZ2V0SWRHZW5lcmF0b3IoLTEpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgX19QUklWQVRFX0luZGV4ZWREYlRhcmdldENhY2hlIHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0KSB7XG4gICAgICAgIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUgPSBlLCB0aGlzLnNlcmlhbGl6ZXIgPSB0O1xuICAgIH1cbiAgICAvLyBQT1JUSU5HIE5PVEU6IFdlIGRvbid0IGNhY2hlIGdsb2JhbCBtZXRhZGF0YSBmb3IgdGhlIHRhcmdldCBjYWNoZSwgc2luY2VcbiAgICAvLyBzb21lIG9mIGl0IChpbiBwYXJ0aWN1bGFyIGBoaWdoZXN0VGFyZ2V0SWRgKSBjYW4gYmUgbW9kaWZpZWQgYnkgc2Vjb25kYXJ5XG4gICAgLy8gdGFicy4gV2UgY291bGQgcGVyaGFwcyBiZSBtb3JlIGdyYW51bGFyIChhbmQgZS5nLiBzdGlsbCBjYWNoZVxuICAgIC8vIGBsYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uYCBpbiBtZW1vcnkpIGJ1dCBmb3Igc2ltcGxpY2l0eSB3ZSBjdXJyZW50bHkgZ29cbiAgICAvLyB0byBJbmRleGVkRGIgd2hlbmV2ZXIgd2UgbmVlZCB0byByZWFkIG1ldGFkYXRhLiBXZSBjYW4gcmV2aXNpdCBpZiBpdCB0dXJuc1xuICAgIC8vIG91dCB0byBoYXZlIGEgbWVhbmluZ2Z1bCBwZXJmb3JtYW5jZSBpbXBhY3QuXG4gICAgYWxsb2NhdGVUYXJnZXRJZChlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxyKGUpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgbiA9IG5ldyBfX1BSSVZBVEVfVGFyZ2V0SWRHZW5lcmF0b3IodC5oaWdoZXN0VGFyZ2V0SWQpO1xuICAgICAgICAgICAgcmV0dXJuIHQuaGlnaGVzdFRhcmdldElkID0gbi5uZXh0KCksIHRoaXMuaHIoZSwgdCkubmV4dCgoKCkgPT4gdC5oaWdoZXN0VGFyZ2V0SWQpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBnZXRMYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubHIoZSkubmV4dCgoZSA9PiBTbmFwc2hvdFZlcnNpb24uZnJvbVRpbWVzdGFtcChuZXcgVGltZXN0YW1wKGUubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbi5zZWNvbmRzLCBlLmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24ubmFub3NlY29uZHMpKSkpO1xuICAgIH1cbiAgICBnZXRIaWdoZXN0U2VxdWVuY2VOdW1iZXIoZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5scihlKS5uZXh0KChlID0+IGUuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyKSk7XG4gICAgfVxuICAgIHNldFRhcmdldHNNZXRhZGF0YShlLCB0LCBuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxyKGUpLm5leHQoKHIgPT4gKHIuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyID0gdCwgbiAmJiAoci5sYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uID0gbi50b1RpbWVzdGFtcCgpKSwgXG4gICAgICAgIHQgPiByLmhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciAmJiAoci5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgPSB0KSwgdGhpcy5ocihlLCByKSkpKTtcbiAgICB9XG4gICAgYWRkVGFyZ2V0RGF0YShlLCB0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLlByKGUsIHQpLm5leHQoKCgpID0+IHRoaXMubHIoZSkubmV4dCgobiA9PiAobi50YXJnZXRDb3VudCArPSAxLCB0aGlzLlRyKHQsIG4pLCBcbiAgICAgICAgdGhpcy5ocihlLCBuKSkpKSkpO1xuICAgIH1cbiAgICB1cGRhdGVUYXJnZXREYXRhKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuUHIoZSwgdCk7XG4gICAgfVxuICAgIHJlbW92ZVRhcmdldERhdGEoZSwgdCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZChlLCB0LnRhcmdldElkKS5uZXh0KCgoKSA9PiBfX1BSSVZBVEVfdGFyZ2V0c1N0b3JlKGUpLmRlbGV0ZSh0LnRhcmdldElkKSkpLm5leHQoKCgpID0+IHRoaXMubHIoZSkpKS5uZXh0KCh0ID0+IChfX1BSSVZBVEVfaGFyZEFzc2VydCh0LnRhcmdldENvdW50ID4gMCwgODA2NSksIFxuICAgICAgICB0LnRhcmdldENvdW50IC09IDEsIHRoaXMuaHIoZSwgdCkpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERyb3BzIGFueSB0YXJnZXRzIHdpdGggc2VxdWVuY2UgbnVtYmVyIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgdXBwZXIgYm91bmQsIGV4Y2VwdGluZyB0aG9zZVxuICAgICAqIHByZXNlbnQgaW4gYGFjdGl2ZVRhcmdldElkc2AuIERvY3VtZW50IGFzc29jaWF0aW9ucyBmb3IgdGhlIHJlbW92ZWQgdGFyZ2V0cyBhcmUgYWxzbyByZW1vdmVkLlxuICAgICAqIFJldHVybnMgdGhlIG51bWJlciBvZiB0YXJnZXRzIHJlbW92ZWQuXG4gICAgICovICAgIHJlbW92ZVRhcmdldHMoZSwgdCwgbikge1xuICAgICAgICBsZXQgciA9IDA7XG4gICAgICAgIGNvbnN0IGkgPSBbXTtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV90YXJnZXRzU3RvcmUoZSkuZWUoKChzLCBvKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBfID0gX19QUklWQVRFX2Zyb21EYlRhcmdldChvKTtcbiAgICAgICAgICAgIF8uc2VxdWVuY2VOdW1iZXIgPD0gdCAmJiBudWxsID09PSBuLmdldChfLnRhcmdldElkKSAmJiAocisrLCBpLnB1c2godGhpcy5yZW1vdmVUYXJnZXREYXRhKGUsIF8pKSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihpKSkpLm5leHQoKCgpID0+IHIpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbCBwcm92aWRlZCBmdW5jdGlvbiB3aXRoIGVhY2ggYFRhcmdldERhdGFgIHRoYXQgd2UgaGF2ZSBjYWNoZWQuXG4gICAgICovICAgIGZvckVhY2hUYXJnZXQoZSwgdCkge1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX3RhcmdldHNTdG9yZShlKS5lZSgoKGUsIG4pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfZnJvbURiVGFyZ2V0KG4pO1xuICAgICAgICAgICAgdChyKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBscihlKSB7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfZ2xvYmFsVGFyZ2V0U3RvcmUoZSkuZ2V0KGZlKS5uZXh0KChlID0+IChfX1BSSVZBVEVfaGFyZEFzc2VydChudWxsICE9PSBlLCAyODg4KSwgXG4gICAgICAgIGUpKSk7XG4gICAgfVxuICAgIGhyKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9nbG9iYWxUYXJnZXRTdG9yZShlKS5wdXQoZmUsIHQpO1xuICAgIH1cbiAgICBQcihlLCB0KSB7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfdGFyZ2V0c1N0b3JlKGUpLnB1dChfX1BSSVZBVEVfdG9EYlRhcmdldCh0aGlzLnNlcmlhbGl6ZXIsIHQpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW4tcGxhY2UgdXBkYXRlcyB0aGUgcHJvdmlkZWQgbWV0YWRhdGEgdG8gYWNjb3VudCBmb3IgdmFsdWVzIGluIHRoZSBnaXZlblxuICAgICAqIFRhcmdldERhdGEuIFNhdmluZyBpcyBkb25lIHNlcGFyYXRlbHkuIFJldHVybnMgdHJ1ZSBpZiB0aGVyZSB3ZXJlIGFueVxuICAgICAqIGNoYW5nZXMgdG8gdGhlIG1ldGFkYXRhLlxuICAgICAqLyAgICBUcihlLCB0KSB7XG4gICAgICAgIGxldCBuID0gITE7XG4gICAgICAgIHJldHVybiBlLnRhcmdldElkID4gdC5oaWdoZXN0VGFyZ2V0SWQgJiYgKHQuaGlnaGVzdFRhcmdldElkID0gZS50YXJnZXRJZCwgbiA9ICEwKSwgXG4gICAgICAgIGUuc2VxdWVuY2VOdW1iZXIgPiB0LmhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciAmJiAodC5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgPSBlLnNlcXVlbmNlTnVtYmVyLCBcbiAgICAgICAgbiA9ICEwKSwgbjtcbiAgICB9XG4gICAgZ2V0VGFyZ2V0Q291bnQoZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5scihlKS5uZXh0KChlID0+IGUudGFyZ2V0Q291bnQpKTtcbiAgICB9XG4gICAgZ2V0VGFyZ2V0RGF0YShlLCB0KSB7XG4gICAgICAgIC8vIEl0ZXJhdGluZyBieSB0aGUgY2Fub25pY2FsSWQgbWF5IHlpZWxkIG1vcmUgdGhhbiBvbmUgcmVzdWx0IGJlY2F1c2VcbiAgICAgICAgLy8gY2Fub25pY2FsSWQgdmFsdWVzIGFyZSBub3QgcmVxdWlyZWQgdG8gYmUgdW5pcXVlIHBlciB0YXJnZXQuIFRoaXMgcXVlcnlcbiAgICAgICAgLy8gZGVwZW5kcyBvbiB0aGUgcXVlcnlUYXJnZXRzIGluZGV4IHRvIGJlIGVmZmljaWVudC5cbiAgICAgICAgY29uc3QgbiA9IF9fUFJJVkFURV9jYW5vbmlmeVRhcmdldCh0KSwgciA9IElEQktleVJhbmdlLmJvdW5kKFsgbiwgTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZIF0sIFsgbiwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZIF0pO1xuICAgICAgICBsZXQgaSA9IG51bGw7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfdGFyZ2V0c1N0b3JlKGUpLmVlKHtcbiAgICAgICAgICAgIHJhbmdlOiByLFxuICAgICAgICAgICAgaW5kZXg6IEVlXG4gICAgICAgIH0sICgoZSwgbiwgcikgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IF9fUFJJVkFURV9mcm9tRGJUYXJnZXQobik7XG4gICAgICAgICAgICAvLyBBZnRlciBmaW5kaW5nIGEgcG90ZW50aWFsIG1hdGNoLCBjaGVjayB0aGF0IHRoZSB0YXJnZXQgaXNcbiAgICAgICAgICAgIC8vIGFjdHVhbGx5IGVxdWFsIHRvIHRoZSByZXF1ZXN0ZWQgdGFyZ2V0LlxuICAgICAgICAgICAgICAgICAgICAgICAgX19QUklWQVRFX3RhcmdldEVxdWFscyh0LCBzLnRhcmdldCkgJiYgKGkgPSBzLCByLmRvbmUoKSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBpKSk7XG4gICAgfVxuICAgIGFkZE1hdGNoaW5nS2V5cyhlLCB0LCBuKSB7XG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogVGhlIHJldmVyc2UgaW5kZXggKGRvY3VtZW50c1RhcmdldHMpIGlzIG1haW50YWluZWQgYnlcbiAgICAgICAgLy8gSW5kZXhlZERiLlxuICAgICAgICBjb25zdCByID0gW10sIGkgPSBfX1BSSVZBVEVfZG9jdW1lbnRUYXJnZXRTdG9yZShlKTtcbiAgICAgICAgcmV0dXJuIHQuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gX19QUklWQVRFX2VuY29kZVJlc291cmNlUGF0aCh0LnBhdGgpO1xuICAgICAgICAgICAgci5wdXNoKGkucHV0KHtcbiAgICAgICAgICAgICAgICB0YXJnZXRJZDogbixcbiAgICAgICAgICAgICAgICBwYXRoOiBzXG4gICAgICAgICAgICB9KSksIHIucHVzaCh0aGlzLnJlZmVyZW5jZURlbGVnYXRlLmFkZFJlZmVyZW5jZShlLCBuLCB0KSk7XG4gICAgICAgIH0pKSwgUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3Iocik7XG4gICAgfVxuICAgIHJlbW92ZU1hdGNoaW5nS2V5cyhlLCB0LCBuKSB7XG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogVGhlIHJldmVyc2UgaW5kZXggKGRvY3VtZW50c1RhcmdldHMpIGlzIG1haW50YWluZWQgYnlcbiAgICAgICAgLy8gSW5kZXhlZERiLlxuICAgICAgICBjb25zdCByID0gX19QUklWQVRFX2RvY3VtZW50VGFyZ2V0U3RvcmUoZSk7XG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaCh0LCAodCA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gX19QUklWQVRFX2VuY29kZVJlc291cmNlUGF0aCh0LnBhdGgpO1xuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKFsgci5kZWxldGUoWyBuLCBpIF0pLCB0aGlzLnJlZmVyZW5jZURlbGVnYXRlLnJlbW92ZVJlZmVyZW5jZShlLCBuLCB0KSBdKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICByZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZChlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfZG9jdW1lbnRUYXJnZXRTdG9yZShlKSwgciA9IElEQktleVJhbmdlLmJvdW5kKFsgdCBdLCBbIHQgKyAxIF0sIFxuICAgICAgICAvKmxvd2VyT3Blbj0qLyAhMSwgXG4gICAgICAgIC8qdXBwZXJPcGVuPSovICEwKTtcbiAgICAgICAgcmV0dXJuIG4uZGVsZXRlKHIpO1xuICAgIH1cbiAgICBnZXRNYXRjaGluZ0tleXNGb3JUYXJnZXRJZChlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSBJREJLZXlSYW5nZS5ib3VuZChbIHQgXSwgWyB0ICsgMSBdLCBcbiAgICAgICAgLypsb3dlck9wZW49Ki8gITEsIFxuICAgICAgICAvKnVwcGVyT3Blbj0qLyAhMCksIHIgPSBfX1BSSVZBVEVfZG9jdW1lbnRUYXJnZXRTdG9yZShlKTtcbiAgICAgICAgbGV0IGkgPSBfX1BSSVZBVEVfZG9jdW1lbnRLZXlTZXQoKTtcbiAgICAgICAgcmV0dXJuIHIuZWUoe1xuICAgICAgICAgICAgcmFuZ2U6IG4sXG4gICAgICAgICAgICBYOiAhMFxuICAgICAgICB9LCAoKGUsIHQsIG4pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfZGVjb2RlUmVzb3VyY2VQYXRoKGVbMV0pLCBzID0gbmV3IERvY3VtZW50S2V5KHIpO1xuICAgICAgICAgICAgaSA9IGkuYWRkKHMpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gaSkpO1xuICAgIH1cbiAgICBjb250YWluc0tleShlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfZW5jb2RlUmVzb3VyY2VQYXRoKHQucGF0aCksIHIgPSBJREJLZXlSYW5nZS5ib3VuZChbIG4gXSwgWyBfX1BSSVZBVEVfaW1tZWRpYXRlU3VjY2Vzc29yKG4pIF0sIFxuICAgICAgICAvKmxvd2VyT3Blbj0qLyAhMSwgXG4gICAgICAgIC8qdXBwZXJPcGVuPSovICEwKTtcbiAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX2RvY3VtZW50VGFyZ2V0U3RvcmUoZSkuZWUoe1xuICAgICAgICAgICAgaW5kZXg6IFZlLFxuICAgICAgICAgICAgWDogITAsXG4gICAgICAgICAgICByYW5nZTogclxuICAgICAgICB9LCAoKFtlLCB0XSwgbiwgcikgPT4ge1xuICAgICAgICAgICAgLy8gSGF2aW5nIGEgc2VudGluZWwgcm93IGZvciBhIGRvY3VtZW50IGRvZXMgbm90IGNvdW50IGFzIGNvbnRhaW5pbmcgdGhhdCBkb2N1bWVudDtcbiAgICAgICAgICAgIC8vIEZvciB0aGUgdGFyZ2V0IGNhY2hlLCBjb250YWluaW5nIHRoZSBkb2N1bWVudCBtZWFucyB0aGUgZG9jdW1lbnQgaXMgcGFydCBvZiBzb21lXG4gICAgICAgICAgICAvLyB0YXJnZXQuXG4gICAgICAgICAgICAwICE9PSBlICYmIChpKyssIHIuZG9uZSgpKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IGkgPiAwKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvb2tzIHVwIGEgVGFyZ2V0RGF0YSBlbnRyeSBieSB0YXJnZXQgSUQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdGFyZ2V0SWQgLSBUaGUgdGFyZ2V0IElEIG9mIHRoZSBUYXJnZXREYXRhIGVudHJ5IHRvIGxvb2sgdXAuXG4gICAgICogQHJldHVybnMgVGhlIGNhY2hlZCBUYXJnZXREYXRhIGVudHJ5LCBvciBudWxsIGlmIHRoZSBjYWNoZSBoYXMgbm8gZW50cnkgZm9yXG4gICAgICogdGhlIHRhcmdldC5cbiAgICAgKi9cbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxuICAgIEF0KGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV90YXJnZXRzU3RvcmUoZSkuZ2V0KHQpLm5leHQoKGUgPT4gZSA/IF9fUFJJVkFURV9mcm9tRGJUYXJnZXQoZSkgOiBudWxsKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgcXVlcmllcyBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX3RhcmdldHNTdG9yZShlKSB7XG4gICAgcmV0dXJuIF9fUFJJVkFURV9nZXRTdG9yZShlLCBJZSk7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSB0YXJnZXQgZ2xvYmFscyBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX2dsb2JhbFRhcmdldFN0b3JlKGUpIHtcbiAgICByZXR1cm4gX19QUklWQVRFX2dldFN0b3JlKGUsIGdlKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIGRvY3VtZW50IHRhcmdldCBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX2RvY3VtZW50VGFyZ2V0U3RvcmUoZSkge1xuICAgIHJldHVybiBfX1BSSVZBVEVfZ2V0U3RvcmUoZSwgQWUpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCBOdCA9IFwiTHJ1R2FyYmFnZUNvbGxlY3RvclwiLCBCdCA9IDEwNDg1NzY7XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9idWZmZXJFbnRyeUNvbXBhcmF0b3IoW2UsIHRdLCBbbiwgcl0pIHtcbiAgICBjb25zdCBpID0gX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IoZSwgbik7XG4gICAgcmV0dXJuIDAgPT09IGkgPyBfX1BSSVZBVEVfcHJpbWl0aXZlQ29tcGFyYXRvcih0LCByKSA6IGk7XG59XG5cbi8qKlxuICogVXNlZCB0byBjYWxjdWxhdGUgdGhlIG50aCBzZXF1ZW5jZSBudW1iZXIuIEtlZXBzIGEgcm9sbGluZyBidWZmZXIgb2YgdGhlXG4gKiBsb3dlc3QgbiB2YWx1ZXMgcGFzc2VkIHRvIGBhZGRFbGVtZW50YCwgYW5kIGZpbmFsbHkgcmVwb3J0cyB0aGUgbGFyZ2VzdCBvZlxuICogdGhlbSBpbiBgbWF4VmFsdWVgLlxuICovIGNsYXNzIF9fUFJJVkFURV9Sb2xsaW5nU2VxdWVuY2VOdW1iZXJCdWZmZXIge1xuICAgIGNvbnN0cnVjdG9yKGUpIHtcbiAgICAgICAgdGhpcy5JciA9IGUsIHRoaXMuYnVmZmVyID0gbmV3IFNvcnRlZFNldChfX1BSSVZBVEVfYnVmZmVyRW50cnlDb21wYXJhdG9yKSwgdGhpcy5FciA9IDA7XG4gICAgfVxuICAgIGRyKCkge1xuICAgICAgICByZXR1cm4gKyt0aGlzLkVyO1xuICAgIH1cbiAgICBBcihlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbIGUsIHRoaXMuZHIoKSBdO1xuICAgICAgICBpZiAodGhpcy5idWZmZXIuc2l6ZSA8IHRoaXMuSXIpIHRoaXMuYnVmZmVyID0gdGhpcy5idWZmZXIuYWRkKHQpOyBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmJ1ZmZlci5sYXN0KCk7XG4gICAgICAgICAgICBfX1BSSVZBVEVfYnVmZmVyRW50cnlDb21wYXJhdG9yKHQsIGUpIDwgMCAmJiAodGhpcy5idWZmZXIgPSB0aGlzLmJ1ZmZlci5kZWxldGUoZSkuYWRkKHQpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgbWF4VmFsdWUoKSB7XG4gICAgICAgIC8vIEd1YXJhbnRlZWQgdG8gYmUgbm9uLWVtcHR5LiBJZiB3ZSBkZWNpZGUgd2UgYXJlIG5vdCBjb2xsZWN0aW5nIGFueVxuICAgICAgICAvLyBzZXF1ZW5jZSBudW1iZXJzLCBudGhTZXF1ZW5jZU51bWJlciBiZWxvdyBzaG9ydC1jaXJjdWl0cy4gSWYgd2UgaGF2ZVxuICAgICAgICAvLyBkZWNpZGVkIHRoYXQgd2UgYXJlIGNvbGxlY3RpbmcgbiBzZXF1ZW5jZSBudW1iZXJzLCBpdCdzIGJlY2F1c2UgbiBpcyBzb21lXG4gICAgICAgIC8vIHBlcmNlbnRhZ2Ugb2YgdGhlIGV4aXN0aW5nIHNlcXVlbmNlIG51bWJlcnMuIFRoYXQgbWVhbnMgd2Ugc2hvdWxkIG5ldmVyXG4gICAgICAgIC8vIGJlIGluIGEgc2l0dWF0aW9uIHdoZXJlIHdlIGFyZSBjb2xsZWN0aW5nIHNlcXVlbmNlIG51bWJlcnMgYnV0IGRvbid0XG4gICAgICAgIC8vIGFjdHVhbGx5IGhhdmUgYW55LlxuICAgICAgICByZXR1cm4gdGhpcy5idWZmZXIubGFzdCgpWzBdO1xuICAgIH1cbn1cblxuLyoqXG4gKiBUaGlzIGNsYXNzIGlzIHJlc3BvbnNpYmxlIGZvciB0aGUgc2NoZWR1bGluZyBvZiBMUlUgZ2FyYmFnZSBjb2xsZWN0aW9uLiBJdCBoYW5kbGVzIGNoZWNraW5nXG4gKiB3aGV0aGVyIG9yIG5vdCBHQyBpcyBlbmFibGVkLCBhcyB3ZWxsIGFzIHdoaWNoIGRlbGF5IHRvIHVzZSBiZWZvcmUgdGhlIG5leHQgcnVuLlxuICovIGNsYXNzIF9fUFJJVkFURV9McnVTY2hlZHVsZXIge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4pIHtcbiAgICAgICAgdGhpcy5nYXJiYWdlQ29sbGVjdG9yID0gZSwgdGhpcy5hc3luY1F1ZXVlID0gdCwgdGhpcy5sb2NhbFN0b3JlID0gbiwgdGhpcy5SciA9IG51bGw7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICAtMSAhPT0gdGhpcy5nYXJiYWdlQ29sbGVjdG9yLnBhcmFtcy5jYWNoZVNpemVDb2xsZWN0aW9uVGhyZXNob2xkICYmIHRoaXMuVnIoNmU0KTtcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgdGhpcy5SciAmJiAodGhpcy5Sci5jYW5jZWwoKSwgdGhpcy5SciA9IG51bGwpO1xuICAgIH1cbiAgICBnZXQgc3RhcnRlZCgpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgIT09IHRoaXMuUnI7XG4gICAgfVxuICAgIFZyKGUpIHtcbiAgICAgICAgX19QUklWQVRFX2xvZ0RlYnVnKE50LCBgR2FyYmFnZSBjb2xsZWN0aW9uIHNjaGVkdWxlZCBpbiAke2V9bXNgKSwgdGhpcy5SciA9IHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlQWZ0ZXJEZWxheShcImxydV9nYXJiYWdlX2NvbGxlY3Rpb25cIiAvKiBUaW1lcklkLkxydUdhcmJhZ2VDb2xsZWN0aW9uICovICwgZSwgKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuUnIgPSBudWxsO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmxvY2FsU3RvcmUuY29sbGVjdEdhcmJhZ2UodGhpcy5nYXJiYWdlQ29sbGVjdG9yKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBfX1BSSVZBVEVfaXNJbmRleGVkRGJUcmFuc2FjdGlvbkVycm9yKGUpID8gX19QUklWQVRFX2xvZ0RlYnVnKE50LCBcIklnbm9yaW5nIEluZGV4ZWREQiBlcnJvciBkdXJpbmcgZ2FyYmFnZSBjb2xsZWN0aW9uOiBcIiwgZSkgOiBhd2FpdCBfX1BSSVZBVEVfaWdub3JlSWZQcmltYXJ5TGVhc2VMb3NzKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5WcigzZTUpO1xuICAgICAgICB9KSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEltcGxlbWVudHMgdGhlIHN0ZXBzIGZvciBMUlUgZ2FyYmFnZSBjb2xsZWN0aW9uLlxuICovIGNsYXNzIF9fUFJJVkFURV9McnVHYXJiYWdlQ29sbGVjdG9ySW1wbCB7XG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICB0aGlzLm1yID0gZSwgdGhpcy5wYXJhbXMgPSB0O1xuICAgIH1cbiAgICBjYWxjdWxhdGVUYXJnZXRDb3VudChlLCB0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1yLmdyKGUpLm5leHQoKGUgPT4gTWF0aC5mbG9vcih0IC8gMTAwICogZSkpKTtcbiAgICB9XG4gICAgbnRoU2VxdWVuY2VOdW1iZXIoZSwgdCkge1xuICAgICAgICBpZiAoMCA9PT0gdCkgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKF9fUFJJVkFURV9MaXN0ZW5TZXF1ZW5jZS5jZSk7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgX19QUklWQVRFX1JvbGxpbmdTZXF1ZW5jZU51bWJlckJ1ZmZlcih0KTtcbiAgICAgICAgcmV0dXJuIHRoaXMubXIuZm9yRWFjaFRhcmdldChlLCAoZSA9PiBuLkFyKGUuc2VxdWVuY2VOdW1iZXIpKSkubmV4dCgoKCkgPT4gdGhpcy5tci5wcihlLCAoZSA9PiBuLkFyKGUpKSkpKS5uZXh0KCgoKSA9PiBuLm1heFZhbHVlKSk7XG4gICAgfVxuICAgIHJlbW92ZVRhcmdldHMoZSwgdCwgbikge1xuICAgICAgICByZXR1cm4gdGhpcy5tci5yZW1vdmVUYXJnZXRzKGUsIHQsIG4pO1xuICAgIH1cbiAgICByZW1vdmVPcnBoYW5lZERvY3VtZW50cyhlLCB0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1yLnJlbW92ZU9ycGhhbmVkRG9jdW1lbnRzKGUsIHQpO1xuICAgIH1cbiAgICBjb2xsZWN0KGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIC0xID09PSB0aGlzLnBhcmFtcy5jYWNoZVNpemVDb2xsZWN0aW9uVGhyZXNob2xkID8gKF9fUFJJVkFURV9sb2dEZWJ1ZyhcIkxydUdhcmJhZ2VDb2xsZWN0b3JcIiwgXCJHYXJiYWdlIGNvbGxlY3Rpb24gc2tpcHBlZDsgZGlzYWJsZWRcIiksIFxuICAgICAgICBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh4dCkpIDogdGhpcy5nZXRDYWNoZVNpemUoZSkubmV4dCgobiA9PiBuIDwgdGhpcy5wYXJhbXMuY2FjaGVTaXplQ29sbGVjdGlvblRocmVzaG9sZCA/IChfX1BSSVZBVEVfbG9nRGVidWcoXCJMcnVHYXJiYWdlQ29sbGVjdG9yXCIsIGBHYXJiYWdlIGNvbGxlY3Rpb24gc2tpcHBlZDsgQ2FjaGUgc2l6ZSAke259IGlzIGxvd2VyIHRoYW4gdGhyZXNob2xkICR7dGhpcy5wYXJhbXMuY2FjaGVTaXplQ29sbGVjdGlvblRocmVzaG9sZH1gKSwgXG4gICAgICAgIHh0KSA6IHRoaXMueXIoZSwgdCkpKTtcbiAgICB9XG4gICAgZ2V0Q2FjaGVTaXplKGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubXIuZ2V0Q2FjaGVTaXplKGUpO1xuICAgIH1cbiAgICB5cihlLCB0KSB7XG4gICAgICAgIGxldCBuLCByLCBpLCBzLCBvLCBfLCB1O1xuICAgICAgICBjb25zdCBjID0gRGF0ZS5ub3coKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FsY3VsYXRlVGFyZ2V0Q291bnQoZSwgdGhpcy5wYXJhbXMucGVyY2VudGlsZVRvQ29sbGVjdCkubmV4dCgodCA9PiAoXG4gICAgICAgIC8vIENhcCBhdCB0aGUgY29uZmlndXJlZCBtYXhcbiAgICAgICAgdCA+IHRoaXMucGFyYW1zLm1heGltdW1TZXF1ZW5jZU51bWJlcnNUb0NvbGxlY3QgPyAoX19QUklWQVRFX2xvZ0RlYnVnKFwiTHJ1R2FyYmFnZUNvbGxlY3RvclwiLCBgQ2FwcGluZyBzZXF1ZW5jZSBudW1iZXJzIHRvIGNvbGxlY3QgZG93biB0byB0aGUgbWF4aW11bSBvZiAke3RoaXMucGFyYW1zLm1heGltdW1TZXF1ZW5jZU51bWJlcnNUb0NvbGxlY3R9IGZyb20gJHt0fWApLCBcbiAgICAgICAgciA9IHRoaXMucGFyYW1zLm1heGltdW1TZXF1ZW5jZU51bWJlcnNUb0NvbGxlY3QpIDogciA9IHQsIHMgPSBEYXRlLm5vdygpLCB0aGlzLm50aFNlcXVlbmNlTnVtYmVyKGUsIHIpKSkpLm5leHQoKHIgPT4gKG4gPSByLCBcbiAgICAgICAgbyA9IERhdGUubm93KCksIHRoaXMucmVtb3ZlVGFyZ2V0cyhlLCBuLCB0KSkpKS5uZXh0KCh0ID0+IChpID0gdCwgXyA9IERhdGUubm93KCksIFxuICAgICAgICB0aGlzLnJlbW92ZU9ycGhhbmVkRG9jdW1lbnRzKGUsIG4pKSkpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgaWYgKHUgPSBEYXRlLm5vdygpLCBfX1BSSVZBVEVfZ2V0TG9nTGV2ZWwoKSA8PSBMb2dMZXZlbC5ERUJVRykge1xuICAgICAgICAgICAgICAgIF9fUFJJVkFURV9sb2dEZWJ1ZyhcIkxydUdhcmJhZ2VDb2xsZWN0b3JcIiwgYExSVSBHYXJiYWdlIENvbGxlY3Rpb25cXG5cXHRDb3VudGVkIHRhcmdldHMgaW4gJHtzIC0gY31tc1xcblxcdERldGVybWluZWQgbGVhc3QgcmVjZW50bHkgdXNlZCAke3J9IGluIGAgKyAobyAtIHMpICsgXCJtc1xcblwiICsgYFxcdFJlbW92ZWQgJHtpfSB0YXJnZXRzIGluIGAgKyAoXyAtIG8pICsgXCJtc1xcblwiICsgYFxcdFJlbW92ZWQgJHtlfSBkb2N1bWVudHMgaW4gYCArICh1IC0gXykgKyBcIm1zXFxuXCIgKyBgVG90YWwgRHVyYXRpb246ICR7dSAtIGN9bXNgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgICAgZGlkUnVuOiAhMCxcbiAgICAgICAgICAgICAgICBzZXF1ZW5jZU51bWJlcnNDb2xsZWN0ZWQ6IHIsXG4gICAgICAgICAgICAgICAgdGFyZ2V0c1JlbW92ZWQ6IGksXG4gICAgICAgICAgICAgICAgZG9jdW1lbnRzUmVtb3ZlZDogZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9uZXdMcnVHYXJiYWdlQ29sbGVjdG9yKGUsIHQpIHtcbiAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9McnVHYXJiYWdlQ29sbGVjdG9ySW1wbChlLCB0KTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBQcm92aWRlcyBMUlUgZnVuY3Rpb25hbGl0eSBmb3IgSW5kZXhlZERCIHBlcnNpc3RlbmNlLiAqLyBjbGFzcyBfX1BSSVZBVEVfSW5kZXhlZERiTHJ1RGVsZWdhdGVJbXBsIHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0KSB7XG4gICAgICAgIHRoaXMuZGIgPSBlLCB0aGlzLmdhcmJhZ2VDb2xsZWN0b3IgPSBfX1BSSVZBVEVfbmV3THJ1R2FyYmFnZUNvbGxlY3Rvcih0aGlzLCB0KTtcbiAgICB9XG4gICAgZ3IoZSkge1xuICAgICAgICBjb25zdCB0ID0gdGhpcy53cihlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGIuZ2V0VGFyZ2V0Q2FjaGUoKS5nZXRUYXJnZXRDb3VudChlKS5uZXh0KChlID0+IHQubmV4dCgodCA9PiBlICsgdCkpKSk7XG4gICAgfVxuICAgIHdyKGUpIHtcbiAgICAgICAgbGV0IHQgPSAwO1xuICAgICAgICByZXR1cm4gdGhpcy5wcihlLCAoZSA9PiB7XG4gICAgICAgICAgICB0Kys7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiB0KSk7XG4gICAgfVxuICAgIGZvckVhY2hUYXJnZXQoZSwgdCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYi5nZXRUYXJnZXRDYWNoZSgpLmZvckVhY2hUYXJnZXQoZSwgdCk7XG4gICAgfVxuICAgIHByKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuU3IoZSwgKChlLCBuKSA9PiB0KG4pKSk7XG4gICAgfVxuICAgIGFkZFJlZmVyZW5jZShlLCB0LCBuKSB7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfd3JpdGVTZW50aW5lbEtleShlLCBuKTtcbiAgICB9XG4gICAgcmVtb3ZlUmVmZXJlbmNlKGUsIHQsIG4pIHtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV93cml0ZVNlbnRpbmVsS2V5KGUsIG4pO1xuICAgIH1cbiAgICByZW1vdmVUYXJnZXRzKGUsIHQsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGIuZ2V0VGFyZ2V0Q2FjaGUoKS5yZW1vdmVUYXJnZXRzKGUsIHQsIG4pO1xuICAgIH1cbiAgICBtYXJrUG90ZW50aWFsbHlPcnBoYW5lZChlLCB0KSB7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfd3JpdGVTZW50aW5lbEtleShlLCB0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIGFueXRoaW5nIHdvdWxkIHByZXZlbnQgdGhpcyBkb2N1bWVudCBmcm9tIGJlaW5nIGdhcmJhZ2VcbiAgICAgKiBjb2xsZWN0ZWQsIGdpdmVuIHRoYXQgdGhlIGRvY3VtZW50IGluIHF1ZXN0aW9uIGlzIG5vdCBwcmVzZW50IGluIGFueVxuICAgICAqIHRhcmdldHMgYW5kIGhhcyBhIHNlcXVlbmNlIG51bWJlciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gdGhlIHVwcGVyIGJvdW5kIGZvclxuICAgICAqIHRoZSBjb2xsZWN0aW9uIHJ1bi5cbiAgICAgKi8gICAgYnIoZSwgdCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX211dGF0aW9uUXVldWVzQ29udGFpbktleShlLCB0KSB7XG4gICAgICAgICAgICBsZXQgbiA9ICExO1xuICAgICAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9tdXRhdGlvblF1ZXVlc1N0b3JlKGUpLnRlKChyID0+IF9fUFJJVkFURV9tdXRhdGlvblF1ZXVlQ29udGFpbnNLZXkoZSwgciwgdCkubmV4dCgoZSA9PiAoZSAmJiAobiA9ICEwKSwgXG4gICAgICAgICAgICBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSghZSkpKSkpKS5uZXh0KCgoKSA9PiBuKSk7XG4gICAgICAgIH0oZSwgdCk7XG4gICAgfVxuICAgIHJlbW92ZU9ycGhhbmVkRG9jdW1lbnRzKGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuZGIuZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSgpLm5ld0NoYW5nZUJ1ZmZlcigpLCByID0gW107XG4gICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgcmV0dXJuIHRoaXMuU3IoZSwgKChzLCBvKSA9PiB7XG4gICAgICAgICAgICBpZiAobyA8PSB0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuYnIoZSwgcykubmV4dCgodCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdCkgXG4gICAgICAgICAgICAgICAgICAgIC8vIE91ciBzaXplIGFjY291bnRpbmcgcmVxdWlyZXMgdXMgdG8gcmVhZCBhbGwgZG9jdW1lbnRzIGJlZm9yZVxuICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmluZyB0aGVtLlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaSsrLCBuLmdldEVudHJ5KGUsIHMpLm5leHQoKCgpID0+IChuLnJlbW92ZUVudHJ5KHMsIFNuYXBzaG90VmVyc2lvbi5taW4oKSksIFxuICAgICAgICAgICAgICAgICAgICBfX1BSSVZBVEVfZG9jdW1lbnRUYXJnZXRTdG9yZShlKS5kZWxldGUoZnVuY3Rpb24gX19QUklWQVRFX3NlbnRpbmVsS2V5JDEoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsgMCwgX19QUklWQVRFX2VuY29kZVJlc291cmNlUGF0aChlLnBhdGgpIF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gKiBAcmV0dXJucyBBIHZhbHVlIHN1aXRhYmxlIGZvciB3cml0aW5nIGEgc2VudGluZWwgcm93IGluIHRoZSB0YXJnZXQtZG9jdW1lbnRcbiAqIHN0b3JlLlxuICovIChzKSkpKSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIHIucHVzaCh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpLm5leHQoKCgpID0+IFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKHIpKSkubmV4dCgoKCkgPT4gbi5hcHBseShlKSkpLm5leHQoKCgpID0+IGkpKTtcbiAgICB9XG4gICAgcmVtb3ZlVGFyZ2V0KGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IHQud2l0aFNlcXVlbmNlTnVtYmVyKGUuY3VycmVudFNlcXVlbmNlTnVtYmVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGIuZ2V0VGFyZ2V0Q2FjaGUoKS51cGRhdGVUYXJnZXREYXRhKGUsIG4pO1xuICAgIH1cbiAgICB1cGRhdGVMaW1ib0RvY3VtZW50KGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV93cml0ZVNlbnRpbmVsS2V5KGUsIHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsIHByb3ZpZGVkIGZ1bmN0aW9uIGZvciBlYWNoIGRvY3VtZW50IGluIHRoZSBjYWNoZSB0aGF0IGlzICdvcnBoYW5lZCcuIE9ycGhhbmVkXG4gICAgICogbWVhbnMgbm90IGEgcGFydCBvZiBhbnkgdGFyZ2V0LCBzbyB0aGUgb25seSBlbnRyeSBpbiB0aGUgdGFyZ2V0LWRvY3VtZW50IGluZGV4IGZvclxuICAgICAqIHRoYXQgZG9jdW1lbnQgd2lsbCBiZSB0aGUgc2VudGluZWwgcm93ICh0YXJnZXRJZCAwKSwgd2hpY2ggd2lsbCBhbHNvIGhhdmUgdGhlIHNlcXVlbmNlXG4gICAgICogbnVtYmVyIGZvciB0aGUgbGFzdCB0aW1lIHRoZSBkb2N1bWVudCB3YXMgYWNjZXNzZWQuXG4gICAgICovICAgIFNyKGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IF9fUFJJVkFURV9kb2N1bWVudFRhcmdldFN0b3JlKGUpO1xuICAgICAgICBsZXQgciwgaSA9IF9fUFJJVkFURV9MaXN0ZW5TZXF1ZW5jZS5jZTtcbiAgICAgICAgcmV0dXJuIG4uZWUoe1xuICAgICAgICAgICAgaW5kZXg6IFZlXG4gICAgICAgIH0sICgoW2UsIG5dLCB7cGF0aDogcywgc2VxdWVuY2VOdW1iZXI6IG99KSA9PiB7XG4gICAgICAgICAgICAwID09PSBlID8gKFxuICAgICAgICAgICAgLy8gaWYgbmV4dFRvUmVwb3J0IGlzIHZhbGlkLCByZXBvcnQgaXQsIHRoaXMgaXMgYSBuZXcga2V5IHNvIHRoZVxuICAgICAgICAgICAgLy8gbGFzdCBvbmUgbXVzdCBub3QgYmUgYSBtZW1iZXIgb2YgYW55IHRhcmdldHMuXG4gICAgICAgICAgICBpICE9PSBfX1BSSVZBVEVfTGlzdGVuU2VxdWVuY2UuY2UgJiYgdChuZXcgRG9jdW1lbnRLZXkoX19QUklWQVRFX2RlY29kZVJlc291cmNlUGF0aChyKSksIGkpLCBcbiAgICAgICAgICAgIC8vIHNldCBuZXh0VG9SZXBvcnQgdG8gYmUgdGhpcyBzZXF1ZW5jZSBudW1iZXIuIEl0J3MgdGhlIG5leHQgb25lIHdlXG4gICAgICAgICAgICAvLyBtaWdodCByZXBvcnQsIGlmIHdlIGRvbid0IGZpbmQgYW55IHRhcmdldHMgZm9yIHRoaXMgZG9jdW1lbnQuXG4gICAgICAgICAgICAvLyBOb3RlIHRoYXQgdGhlIHNlcXVlbmNlIG51bWJlciBtdXN0IGJlIGRlZmluZWQgd2hlbiB0aGUgdGFyZ2V0SWRcbiAgICAgICAgICAgIC8vIGlzIDAuXG4gICAgICAgICAgICBpID0gbywgciA9IHMpIDogXG4gICAgICAgICAgICAvLyBzZXQgbmV4dFRvUmVwb3J0IHRvIGJlIGludmFsaWQsIHdlIGtub3cgd2UgZG9uJ3QgbmVlZCB0byByZXBvcnRcbiAgICAgICAgICAgIC8vIHRoaXMgb25lIHNpbmNlIHdlIGZvdW5kIGEgdGFyZ2V0IGZvciBpdC5cbiAgICAgICAgICAgIGkgPSBfX1BSSVZBVEVfTGlzdGVuU2VxdWVuY2UuY2U7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICAvLyBTaW5jZSB3ZSByZXBvcnQgc2VxdWVuY2UgbnVtYmVycyBhZnRlciBnZXR0aW5nIHRvIHRoZSBuZXh0IGtleSwgd2VcbiAgICAgICAgICAgIC8vIG5lZWQgdG8gY2hlY2sgaWYgdGhlIGxhc3Qga2V5IHdlIGl0ZXJhdGVkIG92ZXIgd2FzIGFuIG9ycGhhbmVkXG4gICAgICAgICAgICAvLyBkb2N1bWVudCBhbmQgcmVwb3J0IGl0LlxuICAgICAgICAgICAgaSAhPT0gX19QUklWQVRFX0xpc3RlblNlcXVlbmNlLmNlICYmIHQobmV3IERvY3VtZW50S2V5KF9fUFJJVkFURV9kZWNvZGVSZXNvdXJjZVBhdGgocikpLCBpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBnZXRDYWNoZVNpemUoZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYi5nZXRSZW1vdGVEb2N1bWVudENhY2hlKCkuZ2V0U2l6ZShlKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV93cml0ZVNlbnRpbmVsS2V5KGUsIHQpIHtcbiAgICByZXR1cm4gX19QUklWQVRFX2RvY3VtZW50VGFyZ2V0U3RvcmUoZSkucHV0KGZ1bmN0aW9uIF9fUFJJVkFURV9zZW50aW5lbFJvdyhlLCB0KSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0YXJnZXRJZDogMCxcbiAgICAgICAgICAgIHBhdGg6IF9fUFJJVkFURV9lbmNvZGVSZXNvdXJjZVBhdGgoZS5wYXRoKSxcbiAgICAgICAgICAgIHNlcXVlbmNlTnVtYmVyOiB0XG4gICAgICAgIH07XG4gICAgfSh0LCBlLmN1cnJlbnRTZXF1ZW5jZU51bWJlcikpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBbiBpbi1tZW1vcnkgYnVmZmVyIG9mIGVudHJpZXMgdG8gYmUgd3JpdHRlbiB0byBhIFJlbW90ZURvY3VtZW50Q2FjaGUuXG4gKiBJdCBjYW4gYmUgdXNlZCB0byBiYXRjaCB1cCBhIHNldCBvZiBjaGFuZ2VzIHRvIGJlIHdyaXR0ZW4gdG8gdGhlIGNhY2hlLCBidXRcbiAqIGFkZGl0aW9uYWxseSBzdXBwb3J0cyByZWFkaW5nIGVudHJpZXMgYmFjayB3aXRoIHRoZSBgZ2V0RW50cnkoKWAgbWV0aG9kLFxuICogZmFsbGluZyBiYWNrIHRvIHRoZSB1bmRlcmx5aW5nIFJlbW90ZURvY3VtZW50Q2FjaGUgaWYgbm8gZW50cnkgaXNcbiAqIGJ1ZmZlcmVkLlxuICpcbiAqIEVudHJpZXMgYWRkZWQgdG8gdGhlIGNhY2hlICptdXN0KiBiZSByZWFkIGZpcnN0LiBUaGlzIGlzIHRvIGZhY2lsaXRhdGVcbiAqIGNhbGN1bGF0aW5nIHRoZSBzaXplIGRlbHRhIG9mIHRoZSBwZW5kaW5nIGNoYW5nZXMuXG4gKlxuICogUE9SVElORyBOT1RFOiBUaGlzIGNsYXNzIHdhcyBpbXBsZW1lbnRlZCB0aGVuIHJlbW92ZWQgZnJvbSBvdGhlciBwbGF0Zm9ybXMuXG4gKiBJZiBieXRlLWNvdW50aW5nIGVuZHMgdXAgYmVpbmcgbmVlZGVkIG9uIHRoZSBvdGhlciBwbGF0Zm9ybXMsIGNvbnNpZGVyXG4gKiBwb3J0aW5nIHRoaXMgY2xhc3MgYXMgcGFydCBvZiB0aGF0IGltcGxlbWVudGF0aW9uIHdvcmsuXG4gKi8gY2xhc3MgUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAvLyBBIG1hcHBpbmcgb2YgZG9jdW1lbnQga2V5IHRvIHRoZSBuZXcgY2FjaGUgZW50cnkgdGhhdCBzaG91bGQgYmUgd3JpdHRlbi5cbiAgICAgICAgdGhpcy5jaGFuZ2VzID0gbmV3IE9iamVjdE1hcCgoZSA9PiBlLnRvU3RyaW5nKCkpLCAoKGUsIHQpID0+IGUuaXNFcXVhbCh0KSkpLCB0aGlzLmNoYW5nZXNBcHBsaWVkID0gITE7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEJ1ZmZlcnMgYSBgUmVtb3RlRG9jdW1lbnRDYWNoZS5hZGRFbnRyeSgpYCBjYWxsLlxuICAgICAqXG4gICAgICogWW91IGNhbiBvbmx5IG1vZGlmeSBkb2N1bWVudHMgdGhhdCBoYXZlIGFscmVhZHkgYmVlbiByZXRyaWV2ZWQgdmlhXG4gICAgICogYGdldEVudHJ5KCkvZ2V0RW50cmllcygpYCAoZW5mb3JjZWQgdmlhIEluZGV4ZWREYnMgYGFwcGx5KClgKS5cbiAgICAgKi8gICAgYWRkRW50cnkoZSkge1xuICAgICAgICB0aGlzLmFzc2VydE5vdEFwcGxpZWQoKSwgdGhpcy5jaGFuZ2VzLnNldChlLmtleSwgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEJ1ZmZlcnMgYSBgUmVtb3RlRG9jdW1lbnRDYWNoZS5yZW1vdmVFbnRyeSgpYCBjYWxsLlxuICAgICAqXG4gICAgICogWW91IGNhbiBvbmx5IHJlbW92ZSBkb2N1bWVudHMgdGhhdCBoYXZlIGFscmVhZHkgYmVlbiByZXRyaWV2ZWQgdmlhXG4gICAgICogYGdldEVudHJ5KCkvZ2V0RW50cmllcygpYCAoZW5mb3JjZWQgdmlhIEluZGV4ZWREYnMgYGFwcGx5KClgKS5cbiAgICAgKi8gICAgcmVtb3ZlRW50cnkoZSwgdCkge1xuICAgICAgICB0aGlzLmFzc2VydE5vdEFwcGxpZWQoKSwgdGhpcy5jaGFuZ2VzLnNldChlLCBNdXRhYmxlRG9jdW1lbnQubmV3SW52YWxpZERvY3VtZW50KGUpLnNldFJlYWRUaW1lKHQpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTG9va3MgdXAgYW4gZW50cnkgaW4gdGhlIGNhY2hlLiBUaGUgYnVmZmVyZWQgY2hhbmdlcyB3aWxsIGZpcnN0IGJlIGNoZWNrZWQsXG4gICAgICogYW5kIGlmIG5vIGJ1ZmZlcmVkIGNoYW5nZSBhcHBsaWVzLCB0aGlzIHdpbGwgZm9yd2FyZCB0b1xuICAgICAqIGBSZW1vdGVEb2N1bWVudENhY2hlLmdldEVudHJ5KClgLlxuICAgICAqXG4gICAgICogQHBhcmFtIHRyYW5zYWN0aW9uIC0gVGhlIHRyYW5zYWN0aW9uIGluIHdoaWNoIHRvIHBlcmZvcm0gYW55IHBlcnNpc3RlbmNlXG4gICAgICogICAgIG9wZXJhdGlvbnMuXG4gICAgICogQHBhcmFtIGRvY3VtZW50S2V5IC0gVGhlIGtleSBvZiB0aGUgZW50cnkgdG8gbG9vayB1cC5cbiAgICAgKiBAcmV0dXJucyBUaGUgY2FjaGVkIGRvY3VtZW50IG9yIGFuIGludmFsaWQgZG9jdW1lbnQgaWYgd2UgaGF2ZSBub3RoaW5nXG4gICAgICogY2FjaGVkLlxuICAgICAqLyAgICBnZXRFbnRyeShlLCB0KSB7XG4gICAgICAgIHRoaXMuYXNzZXJ0Tm90QXBwbGllZCgpO1xuICAgICAgICBjb25zdCBuID0gdGhpcy5jaGFuZ2VzLmdldCh0KTtcbiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gbiA/IFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKG4pIDogdGhpcy5nZXRGcm9tQ2FjaGUoZSwgdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvb2tzIHVwIHNldmVyYWwgZW50cmllcyBpbiB0aGUgY2FjaGUsIGZvcndhcmRpbmcgdG9cbiAgICAgKiBgUmVtb3RlRG9jdW1lbnRDYWNoZS5nZXRFbnRyeSgpYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0cmFuc2FjdGlvbiAtIFRoZSB0cmFuc2FjdGlvbiBpbiB3aGljaCB0byBwZXJmb3JtIGFueSBwZXJzaXN0ZW5jZVxuICAgICAqICAgICBvcGVyYXRpb25zLlxuICAgICAqIEBwYXJhbSBkb2N1bWVudEtleXMgLSBUaGUga2V5cyBvZiB0aGUgZW50cmllcyB0byBsb29rIHVwLlxuICAgICAqIEByZXR1cm5zIEEgbWFwIG9mIGNhY2hlZCBkb2N1bWVudHMsIGluZGV4ZWQgYnkga2V5LiBJZiBhbiBlbnRyeSBjYW5ub3QgYmVcbiAgICAgKiAgICAgZm91bmQsIHRoZSBjb3JyZXNwb25kaW5nIGtleSB3aWxsIGJlIG1hcHBlZCB0byBhbiBpbnZhbGlkIGRvY3VtZW50LlxuICAgICAqLyAgICBnZXRFbnRyaWVzKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QWxsRnJvbUNhY2hlKGUsIHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIGJ1ZmZlcmVkIGNoYW5nZXMgdG8gdGhlIHVuZGVybHlpbmcgUmVtb3RlRG9jdW1lbnRDYWNoZSwgdXNpbmdcbiAgICAgKiB0aGUgcHJvdmlkZWQgdHJhbnNhY3Rpb24uXG4gICAgICovICAgIGFwcGx5KGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXNzZXJ0Tm90QXBwbGllZCgpLCB0aGlzLmNoYW5nZXNBcHBsaWVkID0gITAsIHRoaXMuYXBwbHlDaGFuZ2VzKGUpO1xuICAgIH1cbiAgICAvKiogSGVscGVyIHRvIGFzc2VydCB0aGlzLmNoYW5nZXMgaXMgbm90IG51bGwgICovICAgIGFzc2VydE5vdEFwcGxpZWQoKSB7fVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBUaGUgUmVtb3RlRG9jdW1lbnRDYWNoZSBmb3IgSW5kZXhlZERiLiBUbyBjb25zdHJ1Y3QsIGludm9rZVxuICogYG5ld0luZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUoKWAuXG4gKi8gY2xhc3MgX19QUklWQVRFX0luZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGVJbXBsIHtcbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHRoaXMuc2VyaWFsaXplciA9IGU7XG4gICAgfVxuICAgIHNldEluZGV4TWFuYWdlcihlKSB7XG4gICAgICAgIHRoaXMuaW5kZXhNYW5hZ2VyID0gZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyB0aGUgc3VwcGxpZWQgZW50cmllcyB0byB0aGUgY2FjaGUuXG4gICAgICpcbiAgICAgKiBBbGwgY2FsbHMgb2YgYGFkZEVudHJ5YCBhcmUgcmVxdWlyZWQgdG8gZ28gdGhyb3VnaCB0aGUgUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXJcbiAgICAgKiByZXR1cm5lZCBieSBgbmV3Q2hhbmdlQnVmZmVyKClgIHRvIGVuc3VyZSBwcm9wZXIgYWNjb3VudGluZyBvZiBtZXRhZGF0YS5cbiAgICAgKi8gICAgYWRkRW50cnkoZSwgdCwgbikge1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX3JlbW90ZURvY3VtZW50c1N0b3JlKGUpLnB1dChuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBhIGRvY3VtZW50IGZyb20gdGhlIGNhY2hlLlxuICAgICAqXG4gICAgICogQWxsIGNhbGxzIG9mIGByZW1vdmVFbnRyeWAgIGFyZSByZXF1aXJlZCB0byBnbyB0aHJvdWdoIHRoZSBSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlclxuICAgICAqIHJldHVybmVkIGJ5IGBuZXdDaGFuZ2VCdWZmZXIoKWAgdG8gZW5zdXJlIHByb3BlciBhY2NvdW50aW5nIG9mIG1ldGFkYXRhLlxuICAgICAqLyAgICByZW1vdmVFbnRyeShlLCB0LCBuKSB7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfcmVtb3RlRG9jdW1lbnRzU3RvcmUoZSkuZGVsZXRlKFxuICAgICAgICAvKipcbiAqIFJldHVybnMgYSBrZXkgdGhhdCBjYW4gYmUgdXNlZCBmb3IgZG9jdW1lbnQgbG9va3VwcyB2aWEgdGhlIHByaW1hcnkga2V5IG9mXG4gKiB0aGUgRGJSZW1vdGVEb2N1bWVudCBvYmplY3Qgc3RvcmUuXG4gKi9cbiAgICAgICAgZnVuY3Rpb24gX19QUklWQVRFX2RiUmVhZFRpbWVLZXkoZSwgdCkge1xuICAgICAgICAgICAgY29uc3QgbiA9IGUucGF0aC50b0FycmF5KCk7XG4gICAgICAgICAgICByZXR1cm4gWyBcbiAgICAgICAgICAgIC8qIHByZWZpeCBwYXRoICovIG4uc2xpY2UoMCwgbi5sZW5ndGggLSAyKSwgXG4gICAgICAgICAgICAvKiBjb2xsZWN0aW9uIGlkICovIG5bbi5sZW5ndGggLSAyXSwgX19QUklWQVRFX3RvRGJUaW1lc3RhbXBLZXkodCksIFxuICAgICAgICAgICAgLyogZG9jdW1lbnQgaWQgKi8gbltuLmxlbmd0aCAtIDFdIF07XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBSZXR1cm5zIGEga2V5IHRoYXQgY2FuIGJlIHVzZWQgZm9yIGRvY3VtZW50IGxvb2t1cHMgb24gdGhlXG4gKiBgRGJSZW1vdGVEb2N1bWVudERvY3VtZW50Q29sbGVjdGlvbkdyb3VwSW5kZXhgIGluZGV4LlxuICovICh0LCBuKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIGN1cnJlbnQgY2FjaGUgc2l6ZS5cbiAgICAgKlxuICAgICAqIENhbGxlcnMgdG8gYGFkZEVudHJ5KClgIGFuZCBgcmVtb3ZlRW50cnkoKWAgKm11c3QqIGNhbGwgdGhpcyBhZnRlcndhcmRzIHRvIHVwZGF0ZSB0aGVcbiAgICAgKiBjYWNoZSdzIG1ldGFkYXRhLlxuICAgICAqLyAgICB1cGRhdGVNZXRhZGF0YShlLCB0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldE1ldGFkYXRhKGUpLm5leHQoKG4gPT4gKG4uYnl0ZVNpemUgKz0gdCwgdGhpcy5EcihlLCBuKSkpKTtcbiAgICB9XG4gICAgZ2V0RW50cnkoZSwgdCkge1xuICAgICAgICBsZXQgbiA9IE11dGFibGVEb2N1bWVudC5uZXdJbnZhbGlkRG9jdW1lbnQodCk7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfcmVtb3RlRG9jdW1lbnRzU3RvcmUoZSkuZWUoe1xuICAgICAgICAgICAgaW5kZXg6IHVlLFxuICAgICAgICAgICAgcmFuZ2U6IElEQktleVJhbmdlLm9ubHkoX19QUklWQVRFX2RiS2V5KHQpKVxuICAgICAgICB9LCAoKGUsIHIpID0+IHtcbiAgICAgICAgICAgIG4gPSB0aGlzLkNyKHQsIHIpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gbikpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBMb29rcyB1cCBhbiBlbnRyeSBpbiB0aGUgY2FjaGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRLZXkgLSBUaGUga2V5IG9mIHRoZSBlbnRyeSB0byBsb29rIHVwLlxuICAgICAqIEByZXR1cm5zIFRoZSBjYWNoZWQgZG9jdW1lbnQgZW50cnkgYW5kIGl0cyBzaXplLlxuICAgICAqLyAgICB2cihlLCB0KSB7XG4gICAgICAgIGxldCBuID0ge1xuICAgICAgICAgICAgc2l6ZTogMCxcbiAgICAgICAgICAgIGRvY3VtZW50OiBNdXRhYmxlRG9jdW1lbnQubmV3SW52YWxpZERvY3VtZW50KHQpXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfcmVtb3RlRG9jdW1lbnRzU3RvcmUoZSkuZWUoe1xuICAgICAgICAgICAgaW5kZXg6IHVlLFxuICAgICAgICAgICAgcmFuZ2U6IElEQktleVJhbmdlLm9ubHkoX19QUklWQVRFX2RiS2V5KHQpKVxuICAgICAgICB9LCAoKGUsIHIpID0+IHtcbiAgICAgICAgICAgIG4gPSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQ6IHRoaXMuQ3IodCwgciksXG4gICAgICAgICAgICAgICAgc2l6ZTogX19QUklWQVRFX2RiRG9jdW1lbnRTaXplKHIpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gbikpO1xuICAgIH1cbiAgICBnZXRFbnRyaWVzKGUsIHQpIHtcbiAgICAgICAgbGV0IG4gPSBfX1BSSVZBVEVfbXV0YWJsZURvY3VtZW50TWFwKCk7XG4gICAgICAgIHJldHVybiB0aGlzLkZyKGUsIHQsICgoZSwgdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuQ3IoZSwgdCk7XG4gICAgICAgICAgICBuID0gbi5pbnNlcnQoZSwgcik7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBuKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvb2tzIHVwIHNldmVyYWwgZW50cmllcyBpbiB0aGUgY2FjaGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRLZXlzIC0gVGhlIHNldCBvZiBrZXlzIGVudHJpZXMgdG8gbG9vayB1cC5cbiAgICAgKiBAcmV0dXJucyBBIG1hcCBvZiBkb2N1bWVudHMgaW5kZXhlZCBieSBrZXkgYW5kIGEgbWFwIG9mIHNpemVzIGluZGV4ZWQgYnlcbiAgICAgKiAgICAga2V5ICh6ZXJvIGlmIHRoZSBkb2N1bWVudCBkb2VzIG5vdCBleGlzdCkuXG4gICAgICovICAgIE1yKGUsIHQpIHtcbiAgICAgICAgbGV0IG4gPSBfX1BSSVZBVEVfbXV0YWJsZURvY3VtZW50TWFwKCksIHIgPSBuZXcgU29ydGVkTWFwKERvY3VtZW50S2V5LmNvbXBhcmF0b3IpO1xuICAgICAgICByZXR1cm4gdGhpcy5GcihlLCB0LCAoKGUsIHQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLkNyKGUsIHQpO1xuICAgICAgICAgICAgbiA9IG4uaW5zZXJ0KGUsIGkpLCByID0gci5pbnNlcnQoZSwgX19QUklWQVRFX2RiRG9jdW1lbnRTaXplKHQpKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+ICh7XG4gICAgICAgICAgICBkb2N1bWVudHM6IG4sXG4gICAgICAgICAgICBPcjogclxuICAgICAgICB9KSkpO1xuICAgIH1cbiAgICBGcihlLCB0LCBuKSB7XG4gICAgICAgIGlmICh0LmlzRW1wdHkoKSkgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIGxldCByID0gbmV3IFNvcnRlZFNldChfX1BSSVZBVEVfZGJLZXlDb21wYXJhdG9yKTtcbiAgICAgICAgdC5mb3JFYWNoKChlID0+IHIgPSByLmFkZChlKSkpO1xuICAgICAgICBjb25zdCBpID0gSURCS2V5UmFuZ2UuYm91bmQoX19QUklWQVRFX2RiS2V5KHIuZmlyc3QoKSksIF9fUFJJVkFURV9kYktleShyLmxhc3QoKSkpLCBzID0gci5nZXRJdGVyYXRvcigpO1xuICAgICAgICBsZXQgbyA9IHMuZ2V0TmV4dCgpO1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX3JlbW90ZURvY3VtZW50c1N0b3JlKGUpLmVlKHtcbiAgICAgICAgICAgIGluZGV4OiB1ZSxcbiAgICAgICAgICAgIHJhbmdlOiBpXG4gICAgICAgIH0sICgoZSwgdCwgcikgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IERvY3VtZW50S2V5LmZyb21TZWdtZW50cyhbIC4uLnQucHJlZml4UGF0aCwgdC5jb2xsZWN0aW9uR3JvdXAsIHQuZG9jdW1lbnRJZCBdKTtcbiAgICAgICAgICAgIC8vIEdvIHRocm91Z2gga2V5cyBub3QgZm91bmQgaW4gY2FjaGUuXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKDtvICYmIF9fUFJJVkFURV9kYktleUNvbXBhcmF0b3IobywgaSkgPCAwOyApIG4obywgbnVsbCksIG8gPSBzLmdldE5leHQoKTtcbiAgICAgICAgICAgIG8gJiYgby5pc0VxdWFsKGkpICYmIChcbiAgICAgICAgICAgIC8vIEtleSBmb3VuZCBpbiBjYWNoZS5cbiAgICAgICAgICAgIG4obywgdCksIG8gPSBzLmhhc05leHQoKSA/IHMuZ2V0TmV4dCgpIDogbnVsbCksIFxuICAgICAgICAgICAgLy8gU2tpcCB0byB0aGUgbmV4dCBrZXkgKGlmIHRoZXJlIGlzIG9uZSkuXG4gICAgICAgICAgICBvID8gci5qKF9fUFJJVkFURV9kYktleShvKSkgOiByLmRvbmUoKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIC8vIFRoZSByZXN0IG9mIHRoZSBrZXlzIGFyZSBub3QgaW4gdGhlIGNhY2hlLiBPbmUgY2FzZSB3aGVyZSBgaXRlcmF0ZWBcbiAgICAgICAgICAgIC8vIGFib3ZlIHdvbid0IGdvIHRocm91Z2ggdGhlbSBpcyB3aGVuIHRoZSBjYWNoZSBpcyBlbXB0eS5cbiAgICAgICAgICAgIGZvciAoO287ICkgbihvLCBudWxsKSwgbyA9IHMuaGFzTmV4dCgpID8gcy5nZXROZXh0KCkgOiBudWxsO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldERvY3VtZW50c01hdGNoaW5nUXVlcnkoZSwgdCwgbiwgciwgaSkge1xuICAgICAgICBjb25zdCBzID0gdC5wYXRoLCBvID0gWyBzLnBvcExhc3QoKS50b0FycmF5KCksIHMubGFzdFNlZ21lbnQoKSwgX19QUklWQVRFX3RvRGJUaW1lc3RhbXBLZXkobi5yZWFkVGltZSksIG4uZG9jdW1lbnRLZXkucGF0aC5pc0VtcHR5KCkgPyBcIlwiIDogbi5kb2N1bWVudEtleS5wYXRoLmxhc3RTZWdtZW50KCkgXSwgXyA9IFsgcy5wb3BMYXN0KCkudG9BcnJheSgpLCBzLmxhc3RTZWdtZW50KCksIFsgTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIsIE51bWJlci5NQVhfU0FGRV9JTlRFR0VSIF0sIFwiXCIgXTtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9yZW1vdGVEb2N1bWVudHNTdG9yZShlKS5KKElEQktleVJhbmdlLmJvdW5kKG8sIF8sICEwKSkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICBpPy5pbmNyZW1lbnREb2N1bWVudFJlYWRDb3VudChlLmxlbmd0aCk7XG4gICAgICAgICAgICBsZXQgbiA9IF9fUFJJVkFURV9tdXRhYmxlRG9jdW1lbnRNYXAoKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiBlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuQ3IoRG9jdW1lbnRLZXkuZnJvbVNlZ21lbnRzKGkucHJlZml4UGF0aC5jb25jYXQoaS5jb2xsZWN0aW9uR3JvdXAsIGkuZG9jdW1lbnRJZCkpLCBpKTtcbiAgICAgICAgICAgICAgICBlLmlzRm91bmREb2N1bWVudCgpICYmIChfX1BSSVZBVEVfcXVlcnlNYXRjaGVzKHQsIGUpIHx8IHIuaGFzKGUua2V5KSkgJiYgKFxuICAgICAgICAgICAgICAgIC8vIEVpdGhlciB0aGUgZG9jdW1lbnQgbWF0Y2hlcyB0aGUgZ2l2ZW4gcXVlcnksIG9yIGl0IGlzIG11dGF0ZWQuXG4gICAgICAgICAgICAgICAgbiA9IG4uaW5zZXJ0KGUua2V5LCBlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbjtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBnZXRBbGxGcm9tQ29sbGVjdGlvbkdyb3VwKGUsIHQsIG4sIHIpIHtcbiAgICAgICAgbGV0IGkgPSBfX1BSSVZBVEVfbXV0YWJsZURvY3VtZW50TWFwKCk7XG4gICAgICAgIGNvbnN0IHMgPSBfX1BSSVZBVEVfZGJDb2xsZWN0aW9uR3JvdXBLZXkodCwgbiksIG8gPSBfX1BSSVZBVEVfZGJDb2xsZWN0aW9uR3JvdXBLZXkodCwgSW5kZXhPZmZzZXQubWF4KCkpO1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX3JlbW90ZURvY3VtZW50c1N0b3JlKGUpLmVlKHtcbiAgICAgICAgICAgIGluZGV4OiBsZSxcbiAgICAgICAgICAgIHJhbmdlOiBJREJLZXlSYW5nZS5ib3VuZChzLCBvLCAhMClcbiAgICAgICAgfSwgKChlLCB0LCBuKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gdGhpcy5DcihEb2N1bWVudEtleS5mcm9tU2VnbWVudHModC5wcmVmaXhQYXRoLmNvbmNhdCh0LmNvbGxlY3Rpb25Hcm91cCwgdC5kb2N1bWVudElkKSksIHQpO1xuICAgICAgICAgICAgaSA9IGkuaW5zZXJ0KHMua2V5LCBzKSwgaS5zaXplID09PSByICYmIG4uZG9uZSgpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gaSkpO1xuICAgIH1cbiAgICBuZXdDaGFuZ2VCdWZmZXIoZSkge1xuICAgICAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9JbmRleGVkRGJSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlcih0aGlzLCAhIWUgJiYgZS50cmFja1JlbW92YWxzKTtcbiAgICB9XG4gICAgZ2V0U2l6ZShlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldE1ldGFkYXRhKGUpLm5leHQoKGUgPT4gZS5ieXRlU2l6ZSkpO1xuICAgIH1cbiAgICBnZXRNZXRhZGF0YShlKSB7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfZG9jdW1lbnRHbG9iYWxTdG9yZShlKS5nZXQoVGUpLm5leHQoKGUgPT4gKF9fUFJJVkFURV9oYXJkQXNzZXJ0KCEhZSwgMjAwMjEpLCBcbiAgICAgICAgZSkpKTtcbiAgICB9XG4gICAgRHIoZSwgdCkge1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX2RvY3VtZW50R2xvYmFsU3RvcmUoZSkucHV0KFRlLCB0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVjb2RlcyBgZGJSZW1vdGVEb2NgIGFuZCByZXR1cm5zIHRoZSBkb2N1bWVudCAob3IgYW4gaW52YWxpZCBkb2N1bWVudCBpZlxuICAgICAqIHRoZSBkb2N1bWVudCBjb3JyZXNwb25kcyB0byB0aGUgZm9ybWF0IHVzZWQgZm9yIHNlbnRpbmVsIGRlbGV0ZXMpLlxuICAgICAqLyAgICBDcihlLCB0KSB7XG4gICAgICAgIGlmICh0KSB7XG4gICAgICAgICAgICBjb25zdCBlID0gX19QUklWQVRFX2Zyb21EYlJlbW90ZURvY3VtZW50KHRoaXMuc2VyaWFsaXplciwgdCk7XG4gICAgICAgICAgICAvLyBXaGV0aGVyIHRoZSBkb2N1bWVudCBpcyBhIHNlbnRpbmVsIHJlbW92YWwgYW5kIHNob3VsZCBvbmx5IGJlIHVzZWQgaW4gdGhlXG4gICAgICAgICAgICAvLyBgZ2V0TmV3RG9jdW1lbnRDaGFuZ2VzKClgXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShlLmlzTm9Eb2N1bWVudCgpICYmIGUudmVyc2lvbi5pc0VxdWFsKFNuYXBzaG90VmVyc2lvbi5taW4oKSkpKSByZXR1cm4gZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTXV0YWJsZURvY3VtZW50Lm5ld0ludmFsaWREb2N1bWVudChlKTtcbiAgICB9XG59XG5cbi8qKiBDcmVhdGVzIGEgbmV3IEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9uZXdJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlKGUpIHtcbiAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9JbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlSW1wbChlKTtcbn1cblxuLyoqXG4gKiBIYW5kbGVzIHRoZSBkZXRhaWxzIG9mIGFkZGluZyBhbmQgdXBkYXRpbmcgZG9jdW1lbnRzIGluIHRoZSBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlLlxuICpcbiAqIFVubGlrZSB0aGUgTWVtb3J5UmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIsIHRoZSBJbmRleGVkRGIgaW1wbGVtZW50YXRpb24gY29tcHV0ZXMgdGhlIHNpemVcbiAqIGRlbHRhIGZvciBhbGwgc3VibWl0dGVkIGNoYW5nZXMuIFRoaXMgYXZvaWRzIGhhdmluZyB0byByZS1yZWFkIGFsbCBkb2N1bWVudHMgZnJvbSBJbmRleGVkRGJcbiAqIHdoZW4gd2UgYXBwbHkgdGhlIGNoYW5nZXMuXG4gKi8gY2xhc3MgX19QUklWQVRFX0luZGV4ZWREYlJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyIGV4dGVuZHMgUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudENhY2hlIC0gVGhlIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUgdG8gYXBwbHkgdGhlIGNoYW5nZXMgdG8uXG4gICAgICogQHBhcmFtIHRyYWNrUmVtb3ZhbHMgLSBXaGV0aGVyIHRvIGNyZWF0ZSBzZW50aW5lbCBkZWxldGVzIHRoYXQgY2FuIGJlIHRyYWNrZWQgYnlcbiAgICAgKiBgZ2V0TmV3RG9jdW1lbnRDaGFuZ2VzKClgLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGUsIHQpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5OciA9IGUsIHRoaXMudHJhY2tSZW1vdmFscyA9IHQsIFxuICAgICAgICAvLyBBIG1hcCBvZiBkb2N1bWVudCBzaXplcyBhbmQgcmVhZCB0aW1lcyBwcmlvciB0byBhcHBseWluZyB0aGUgY2hhbmdlcyBpblxuICAgICAgICAvLyB0aGlzIGJ1ZmZlci5cbiAgICAgICAgdGhpcy5CciA9IG5ldyBPYmplY3RNYXAoKGUgPT4gZS50b1N0cmluZygpKSwgKChlLCB0KSA9PiBlLmlzRXF1YWwodCkpKTtcbiAgICB9XG4gICAgYXBwbHlDaGFuZ2VzKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IFtdO1xuICAgICAgICBsZXQgbiA9IDAsIHIgPSBuZXcgU29ydGVkU2V0KCgoZSwgdCkgPT4gX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IoZS5jYW5vbmljYWxTdHJpbmcoKSwgdC5jYW5vbmljYWxTdHJpbmcoKSkpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hhbmdlcy5mb3JFYWNoKCgoaSwgcykgPT4ge1xuICAgICAgICAgICAgY29uc3QgbyA9IHRoaXMuQnIuZ2V0KGkpO1xuICAgICAgICAgICAgaWYgKHQucHVzaCh0aGlzLk5yLnJlbW92ZUVudHJ5KGUsIGksIG8ucmVhZFRpbWUpKSwgcy5pc1ZhbGlkRG9jdW1lbnQoKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IF8gPSBfX1BSSVZBVEVfdG9EYlJlbW90ZURvY3VtZW50KHRoaXMuTnIuc2VyaWFsaXplciwgcyk7XG4gICAgICAgICAgICAgICAgciA9IHIuYWRkKGkucGF0aC5wb3BMYXN0KCkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBfX1BSSVZBVEVfZGJEb2N1bWVudFNpemUoXyk7XG4gICAgICAgICAgICAgICAgbiArPSBhIC0gby5zaXplLCB0LnB1c2godGhpcy5Oci5hZGRFbnRyeShlLCBpLCBfKSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG4gLT0gby5zaXplLCB0aGlzLnRyYWNrUmVtb3ZhbHMpIHtcbiAgICAgICAgICAgICAgICAvLyBJbiBvcmRlciB0byB0cmFjayByZW1vdmFscywgd2Ugc3RvcmUgYSBcInNlbnRpbmVsIGRlbGV0ZVwiIGluIHRoZVxuICAgICAgICAgICAgICAgIC8vIFJlbW90ZURvY3VtZW50Q2FjaGUuIFRoaXMgZW50cnkgaXMgcmVwcmVzZW50ZWQgYnkgYSBOb0RvY3VtZW50XG4gICAgICAgICAgICAgICAgLy8gd2l0aCBhIHZlcnNpb24gb2YgMCBhbmQgaWdub3JlZCBieSBgbWF5YmVEZWNvZGVEb2N1bWVudCgpYCBidXRcbiAgICAgICAgICAgICAgICAvLyBwcmVzZXJ2ZWQgaW4gYGdldE5ld0RvY3VtZW50Q2hhbmdlcygpYC5cbiAgICAgICAgICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX3RvRGJSZW1vdGVEb2N1bWVudCh0aGlzLk5yLnNlcmlhbGl6ZXIsIHMuY29udmVydFRvTm9Eb2N1bWVudChTbmFwc2hvdFZlcnNpb24ubWluKCkpKTtcbiAgICAgICAgICAgICAgICB0LnB1c2godGhpcy5Oci5hZGRFbnRyeShlLCBpLCBuKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKSwgci5mb3JFYWNoKChuID0+IHtcbiAgICAgICAgICAgIHQucHVzaCh0aGlzLk5yLmluZGV4TWFuYWdlci5hZGRUb0NvbGxlY3Rpb25QYXJlbnRJbmRleChlLCBuKSk7XG4gICAgICAgIH0pKSwgdC5wdXNoKHRoaXMuTnIudXBkYXRlTWV0YWRhdGEoZSwgbikpLCBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcih0KTtcbiAgICB9XG4gICAgZ2V0RnJvbUNhY2hlKGUsIHQpIHtcbiAgICAgICAgLy8gUmVjb3JkIHRoZSBzaXplIG9mIGV2ZXJ5dGhpbmcgd2UgbG9hZCBmcm9tIHRoZSBjYWNoZSBzbyB3ZSBjYW4gY29tcHV0ZSBhIGRlbHRhIGxhdGVyLlxuICAgICAgICByZXR1cm4gdGhpcy5Oci52cihlLCB0KS5uZXh0KChlID0+ICh0aGlzLkJyLnNldCh0LCB7XG4gICAgICAgICAgICBzaXplOiBlLnNpemUsXG4gICAgICAgICAgICByZWFkVGltZTogZS5kb2N1bWVudC5yZWFkVGltZVxuICAgICAgICB9KSwgZS5kb2N1bWVudCkpKTtcbiAgICB9XG4gICAgZ2V0QWxsRnJvbUNhY2hlKGUsIHQpIHtcbiAgICAgICAgLy8gUmVjb3JkIHRoZSBzaXplIG9mIGV2ZXJ5dGhpbmcgd2UgbG9hZCBmcm9tIHRoZSBjYWNoZSBzbyB3ZSBjYW4gY29tcHV0ZVxuICAgICAgICAvLyBhIGRlbHRhIGxhdGVyLlxuICAgICAgICByZXR1cm4gdGhpcy5Oci5NcihlLCB0KS5uZXh0KCgoe2RvY3VtZW50czogZSwgT3I6IHR9KSA9PiAoXG4gICAgICAgIC8vIE5vdGU6IGBnZXRBbGxGcm9tQ2FjaGVgIHJldHVybnMgdHdvIG1hcHMgaW5zdGVhZCBvZiBhIHNpbmdsZSBtYXAgZnJvbVxuICAgICAgICAvLyBrZXlzIHRvIGBEb2N1bWVudFNpemVFbnRyeWBzLiBUaGlzIGlzIHRvIGFsbG93IHJldHVybmluZyB0aGVcbiAgICAgICAgLy8gYE11dGFibGVEb2N1bWVudE1hcGAgZGlyZWN0bHksIHdpdGhvdXQgYSBjb252ZXJzaW9uLlxuICAgICAgICB0LmZvckVhY2goKCh0LCBuKSA9PiB7XG4gICAgICAgICAgICB0aGlzLkJyLnNldCh0LCB7XG4gICAgICAgICAgICAgICAgc2l6ZTogbixcbiAgICAgICAgICAgICAgICByZWFkVGltZTogZS5nZXQodCkucmVhZFRpbWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KSksIGUpKSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfZG9jdW1lbnRHbG9iYWxTdG9yZShlKSB7XG4gICAgcmV0dXJuIF9fUFJJVkFURV9nZXRTdG9yZShlLCBQZSk7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSByZW1vdGVEb2N1bWVudHMgb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9yZW1vdGVEb2N1bWVudHNTdG9yZShlKSB7XG4gICAgcmV0dXJuIF9fUFJJVkFURV9nZXRTdG9yZShlLCBfZSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIGtleSB0aGF0IGNhbiBiZSB1c2VkIGZvciBkb2N1bWVudCBsb29rdXBzIG9uIHRoZVxuICogYERiUmVtb3RlRG9jdW1lbnREb2N1bWVudEtleUluZGV4YCBpbmRleC5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfZGJLZXkoZSkge1xuICAgIGNvbnN0IHQgPSBlLnBhdGgudG9BcnJheSgpO1xuICAgIHJldHVybiBbIFxuICAgIC8qIHByZWZpeCBwYXRoICovIHQuc2xpY2UoMCwgdC5sZW5ndGggLSAyKSwgXG4gICAgLyogY29sbGVjdGlvbiBpZCAqLyB0W3QubGVuZ3RoIC0gMl0sIFxuICAgIC8qIGRvY3VtZW50IGlkICovIHRbdC5sZW5ndGggLSAxXSBdO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfZGJDb2xsZWN0aW9uR3JvdXBLZXkoZSwgdCkge1xuICAgIGNvbnN0IG4gPSB0LmRvY3VtZW50S2V5LnBhdGgudG9BcnJheSgpO1xuICAgIHJldHVybiBbIFxuICAgIC8qIGNvbGxlY3Rpb24gaWQgKi8gZSwgX19QUklWQVRFX3RvRGJUaW1lc3RhbXBLZXkodC5yZWFkVGltZSksIFxuICAgIC8qIHByZWZpeCBwYXRoICovIG4uc2xpY2UoMCwgbi5sZW5ndGggLSAyKSwgXG4gICAgLyogZG9jdW1lbnQgaWQgKi8gbi5sZW5ndGggPiAwID8gbltuLmxlbmd0aCAtIDFdIDogXCJcIiBdO1xufVxuXG4vKipcbiAqIENvbXBhcmF0b3IgdGhhdCBjb21wYXJlcyBkb2N1bWVudCBrZXlzIGFjY29yZGluZyB0byB0aGUgcHJpbWFyeSBrZXkgc29ydGluZ1xuICogdXNlZCBieSB0aGUgYERiUmVtb3RlRG9jdW1lbnREb2N1bWVudGAgc3RvcmUgKGJ5IHByZWZpeCBwYXRoLCBjb2xsZWN0aW9uIGlkXG4gKiBhbmQgdGhlbiBkb2N1bWVudCBJRCkuXG4gKlxuICogVmlzaWJsZSBmb3IgdGVzdGluZy5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfZGJLZXlDb21wYXJhdG9yKGUsIHQpIHtcbiAgICBjb25zdCBuID0gZS5wYXRoLnRvQXJyYXkoKSwgciA9IHQucGF0aC50b0FycmF5KCk7XG4gICAgLy8gVGhlIG9yZGVyaW5nIGlzIGJhc2VkIG9uIGh0dHBzOi8vY2hyb21pdW0uZ29vZ2xlc291cmNlLmNvbS9jaHJvbWl1bS9ibGluay8rL2ZlNWMyMWZlZjk0ZGFlNzFjMWMzMzQ0Nzc1YjhkOGE3ZjdlNmQ5ZWMvU291cmNlL21vZHVsZXMvaW5kZXhlZGRiL0lEQktleS5jcHAjNzRcbiAgICBsZXQgaSA9IDA7XG4gICAgZm9yIChsZXQgZSA9IDA7IGUgPCBuLmxlbmd0aCAtIDIgJiYgZSA8IHIubGVuZ3RoIC0gMjsgKytlKSBpZiAoaSA9IF9fUFJJVkFURV9wcmltaXRpdmVDb21wYXJhdG9yKG5bZV0sIHJbZV0pLCBcbiAgICBpKSByZXR1cm4gaTtcbiAgICByZXR1cm4gaSA9IF9fUFJJVkFURV9wcmltaXRpdmVDb21wYXJhdG9yKG4ubGVuZ3RoLCByLmxlbmd0aCksIGkgfHwgKGkgPSBfX1BSSVZBVEVfcHJpbWl0aXZlQ29tcGFyYXRvcihuW24ubGVuZ3RoIC0gMl0sIHJbci5sZW5ndGggLSAyXSksIFxuICAgIGkgfHwgX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IobltuLmxlbmd0aCAtIDFdLCByW3IubGVuZ3RoIC0gMV0pKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogU2NoZW1hIFZlcnNpb24gZm9yIHRoZSBXZWIgY2xpZW50OlxuICogMS4gIEluaXRpYWwgdmVyc2lvbiBpbmNsdWRpbmcgTXV0YXRpb24gUXVldWUsIFF1ZXJ5IENhY2hlLCBhbmQgUmVtb3RlXG4gKiAgICAgRG9jdW1lbnQgQ2FjaGVcbiAqIDIuICBVc2VkIHRvIGVuc3VyZSBhIHRhcmdldEdsb2JhbCBvYmplY3QgZXhpc3RzIGFuZCBhZGQgdGFyZ2V0Q291bnQgdG8gaXQuIE5vXG4gKiAgICAgbG9uZ2VyIHJlcXVpcmVkIGJlY2F1c2UgbWlncmF0aW9uIDMgdW5jb25kaXRpb25hbGx5IGNsZWFycyBpdC5cbiAqIDMuICBEcm9wcGVkIGFuZCByZS1jcmVhdGVkIFF1ZXJ5IENhY2hlIHRvIGRlYWwgd2l0aCBjYWNoZSBjb3JydXB0aW9uIHJlbGF0ZWRcbiAqICAgICB0byBsaW1ibyByZXNvbHV0aW9uLiBBZGRyZXNzZXNcbiAqICAgICBodHRwczovL2dpdGh1Yi5jb20vZmlyZWJhc2UvZmlyZWJhc2UtaW9zLXNkay9pc3N1ZXMvMTU0OFxuICogNC4gIE11bHRpLVRhYiBTdXBwb3J0LlxuICogNS4gIFJlbW92YWwgb2YgaGVsZCB3cml0ZSBhY2tzLlxuICogNi4gIENyZWF0ZSBkb2N1bWVudCBnbG9iYWwgZm9yIHRyYWNraW5nIGRvY3VtZW50IGNhY2hlIHNpemUuXG4gKiA3LiAgRW5zdXJlIGV2ZXJ5IGNhY2hlZCBkb2N1bWVudCBoYXMgYSBzZW50aW5lbCByb3cgd2l0aCBhIHNlcXVlbmNlIG51bWJlci5cbiAqIDguICBBZGQgY29sbGVjdGlvbi1wYXJlbnQgaW5kZXggZm9yIENvbGxlY3Rpb24gR3JvdXAgcXVlcmllcy5cbiAqIDkuICBDaGFuZ2UgUmVtb3RlRG9jdW1lbnRDaGFuZ2VzIHN0b3JlIHRvIGJlIGtleWVkIGJ5IHJlYWRUaW1lIHJhdGhlciB0aGFuXG4gKiAgICAgYW4gYXV0by1pbmNyZW1lbnRpbmcgSUQuIFRoaXMgaXMgcmVxdWlyZWQgZm9yIEluZGV4LUZyZWUgcXVlcmllcy5cbiAqIDEwLiBSZXdyaXRlIHRoZSBjYW5vbmljYWwgSURzIHRvIHRoZSBleHBsaWNpdCBQcm90b2J1Zi1iYXNlZCBmb3JtYXQuXG4gKiAxMS4gQWRkIGJ1bmRsZXMgYW5kIG5hbWVkX3F1ZXJpZXMgZm9yIGJ1bmRsZSBzdXBwb3J0LlxuICogMTIuIEFkZCBkb2N1bWVudCBvdmVybGF5cy5cbiAqIDEzLiBSZXdyaXRlIHRoZSBrZXlzIG9mIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGUgdG8gYWxsb3cgZm9yIGVmZmljaWVudFxuICogICAgIGRvY3VtZW50IGxvb2t1cCB2aWEgYGdldEFsbCgpYC5cbiAqIDE0LiBBZGQgb3ZlcmxheXMuXG4gKiAxNS4gQWRkIGluZGV4aW5nIHN1cHBvcnQuXG4gKiAxNi4gUGFyc2UgdGltZXN0YW1wIHN0cmluZ3MgYmVmb3JlIGNyZWF0aW5nIGluZGV4IGVudHJpZXMuXG4gKiAxNy4gVE9ETyh0b21hbmRlcnNlbilcbiAqIDE4LiBFbmNvZGUga2V5IHNhZmUgcmVwcmVzZW50YXRpb25zIG9mIEluZGV4RW50cnkgaW4gRGJJbmRleEVudHJ5U3RvcmUuXG4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFJlcHJlc2VudHMgYSBsb2NhbCB2aWV3IChvdmVybGF5KSBvZiBhIGRvY3VtZW50LCBhbmQgdGhlIGZpZWxkcyB0aGF0IGFyZVxuICogbG9jYWxseSBtdXRhdGVkLlxuICovXG5jbGFzcyBPdmVybGF5ZWREb2N1bWVudCB7XG4gICAgY29uc3RydWN0b3IoZSwgXG4gICAgLyoqXG4gICAgICogVGhlIGZpZWxkcyB0aGF0IGFyZSBsb2NhbGx5IG11dGF0ZWQgYnkgcGF0Y2ggbXV0YXRpb25zLlxuICAgICAqXG4gICAgICogSWYgdGhlIG92ZXJsYXllZFx0ZG9jdW1lbnQgaXMgZnJvbSBzZXQgb3IgZGVsZXRlIG11dGF0aW9ucywgdGhpcyBpcyBgbnVsbGAuXG4gICAgICogSWYgdGhlcmUgaXMgbm8gb3ZlcmxheSAobXV0YXRpb24pIGZvciB0aGUgZG9jdW1lbnQsIHRoaXMgaXMgYW4gZW1wdHkgYEZpZWxkTWFza2AuXG4gICAgICovXG4gICAgdCkge1xuICAgICAgICB0aGlzLm92ZXJsYXllZERvY3VtZW50ID0gZSwgdGhpcy5tdXRhdGVkRmllbGRzID0gdDtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgcmVhZG9ubHkgdmlldyBvZiB0aGUgbG9jYWwgc3RhdGUgb2YgYWxsIGRvY3VtZW50cyB3ZSdyZSB0cmFja2luZyAoaS5lLiB3ZVxuICogaGF2ZSBhIGNhY2hlZCB2ZXJzaW9uIGluIHJlbW90ZURvY3VtZW50Q2FjaGUgb3IgbG9jYWwgbXV0YXRpb25zIGZvciB0aGVcbiAqIGRvY3VtZW50KS4gVGhlIHZpZXcgaXMgY29tcHV0ZWQgYnkgYXBwbHlpbmcgdGhlIG11dGF0aW9ucyBpbiB0aGVcbiAqIE11dGF0aW9uUXVldWUgdG8gdGhlIFJlbW90ZURvY3VtZW50Q2FjaGUuXG4gKi8gY2xhc3MgTG9jYWxEb2N1bWVudHNWaWV3IHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0LCBuLCByKSB7XG4gICAgICAgIHRoaXMucmVtb3RlRG9jdW1lbnRDYWNoZSA9IGUsIHRoaXMubXV0YXRpb25RdWV1ZSA9IHQsIHRoaXMuZG9jdW1lbnRPdmVybGF5Q2FjaGUgPSBuLCBcbiAgICAgICAgdGhpcy5pbmRleE1hbmFnZXIgPSByO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGxvY2FsIHZpZXcgb2YgdGhlIGRvY3VtZW50IGlkZW50aWZpZWQgYnkgYGtleWAuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBMb2NhbCB2aWV3IG9mIHRoZSBkb2N1bWVudCBvciBudWxsIGlmIHdlIGRvbid0IGhhdmUgYW55IGNhY2hlZFxuICAgICAqIHN0YXRlIGZvciBpdC5cbiAgICAgKi8gICAgZ2V0RG9jdW1lbnQoZSwgdCkge1xuICAgICAgICBsZXQgbiA9IG51bGw7XG4gICAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50T3ZlcmxheUNhY2hlLmdldE92ZXJsYXkoZSwgdCkubmV4dCgociA9PiAobiA9IHIsIHRoaXMucmVtb3RlRG9jdW1lbnRDYWNoZS5nZXRFbnRyeShlLCB0KSkpKS5uZXh0KChlID0+IChudWxsICE9PSBuICYmIF9fUFJJVkFURV9tdXRhdGlvbkFwcGx5VG9Mb2NhbFZpZXcobi5tdXRhdGlvbiwgZSwgRmllbGRNYXNrLmVtcHR5KCksIFRpbWVzdGFtcC5ub3coKSksIFxuICAgICAgICBlKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBsb2NhbCB2aWV3IG9mIHRoZSBkb2N1bWVudHMgaWRlbnRpZmllZCBieSBga2V5c2AuXG4gICAgICpcbiAgICAgKiBJZiB3ZSBkb24ndCBoYXZlIGNhY2hlZCBzdGF0ZSBmb3IgYSBkb2N1bWVudCBpbiBga2V5c2AsIGEgTm9Eb2N1bWVudCB3aWxsXG4gICAgICogYmUgc3RvcmVkIGZvciB0aGF0IGtleSBpbiB0aGUgcmVzdWx0aW5nIHNldC5cbiAgICAgKi8gICAgZ2V0RG9jdW1lbnRzKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVtb3RlRG9jdW1lbnRDYWNoZS5nZXRFbnRyaWVzKGUsIHQpLm5leHQoKHQgPT4gdGhpcy5nZXRMb2NhbFZpZXdPZkRvY3VtZW50cyhlLCB0LCBfX1BSSVZBVEVfZG9jdW1lbnRLZXlTZXQoKSkubmV4dCgoKCkgPT4gdCkpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNpbWlsYXIgdG8gYGdldERvY3VtZW50c2AsIGJ1dCBjcmVhdGVzIHRoZSBsb2NhbCB2aWV3IGZyb20gdGhlIGdpdmVuXG4gICAgICogYGJhc2VEb2NzYCB3aXRob3V0IHJldHJpZXZpbmcgZG9jdW1lbnRzIGZyb20gdGhlIGxvY2FsIHN0b3JlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHRyYW5zYWN0aW9uIC0gVGhlIHRyYW5zYWN0aW9uIHRoaXMgb3BlcmF0aW9uIGlzIHNjb3BlZCB0by5cbiAgICAgKiBAcGFyYW0gZG9jcyAtIFRoZSBkb2N1bWVudHMgdG8gYXBwbHkgbG9jYWwgbXV0YXRpb25zIHRvIGdldCB0aGUgbG9jYWwgdmlld3MuXG4gICAgICogQHBhcmFtIGV4aXN0ZW5jZVN0YXRlQ2hhbmdlZCAtIFRoZSBzZXQgb2YgZG9jdW1lbnQga2V5cyB3aG9zZSBleGlzdGVuY2Ugc3RhdGVcbiAgICAgKiAgIGlzIGNoYW5nZWQuIFRoaXMgaXMgdXNlZnVsIHRvIGRldGVybWluZSBpZiBzb21lIGRvY3VtZW50cyBvdmVybGF5IG5lZWRzXG4gICAgICogICB0byBiZSByZWNhbGN1bGF0ZWQuXG4gICAgICovICAgIGdldExvY2FsVmlld09mRG9jdW1lbnRzKGUsIHQsIG4gPSBfX1BSSVZBVEVfZG9jdW1lbnRLZXlTZXQoKSkge1xuICAgICAgICBjb25zdCByID0gX19QUklWQVRFX25ld092ZXJsYXlNYXAoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucG9wdWxhdGVPdmVybGF5cyhlLCByLCB0KS5uZXh0KCgoKSA9PiB0aGlzLmNvbXB1dGVWaWV3cyhlLCB0LCByLCBuKS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgIGxldCB0ID0gZG9jdW1lbnRNYXAoKTtcbiAgICAgICAgICAgIHJldHVybiBlLmZvckVhY2goKChlLCBuKSA9PiB7XG4gICAgICAgICAgICAgICAgdCA9IHQuaW5zZXJ0KGUsIG4ub3ZlcmxheWVkRG9jdW1lbnQpO1xuICAgICAgICAgICAgfSkpLCB0O1xuICAgICAgICB9KSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgb3ZlcmxheWVkIGRvY3VtZW50cyBmb3IgdGhlIGdpdmVuIGRvY3VtZW50IG1hcCwgd2hpY2ggd2lsbCBpbmNsdWRlXG4gICAgICogdGhlIGxvY2FsIHZpZXcgb2YgdGhvc2UgZG9jdW1lbnRzIGFuZCBhIGBGaWVsZE1hc2tgIGluZGljYXRpbmcgd2hpY2ggZmllbGRzXG4gICAgICogYXJlIG11dGF0ZWQgbG9jYWxseSwgYG51bGxgIGlmIG92ZXJsYXkgaXMgYSBTZXQgb3IgRGVsZXRlIG11dGF0aW9uLlxuICAgICAqLyAgICBnZXRPdmVybGF5ZWREb2N1bWVudHMoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX25ld092ZXJsYXlNYXAoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucG9wdWxhdGVPdmVybGF5cyhlLCBuLCB0KS5uZXh0KCgoKSA9PiB0aGlzLmNvbXB1dGVWaWV3cyhlLCB0LCBuLCBfX1BSSVZBVEVfZG9jdW1lbnRLZXlTZXQoKSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRmV0Y2hlcyB0aGUgb3ZlcmxheXMgZm9yIHtAY29kZSBkb2NzfSBhbmQgYWRkcyB0aGVtIHRvIHByb3ZpZGVkIG92ZXJsYXkgbWFwXG4gICAgICogaWYgdGhlIG1hcCBkb2VzIG5vdCBhbHJlYWR5IGNvbnRhaW4gYW4gZW50cnkgZm9yIHRoZSBnaXZlbiBkb2N1bWVudCBrZXkuXG4gICAgICovICAgIHBvcHVsYXRlT3ZlcmxheXMoZSwgdCwgbikge1xuICAgICAgICBjb25zdCByID0gW107XG4gICAgICAgIHJldHVybiBuLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgdC5oYXMoZSkgfHwgci5wdXNoKGUpO1xuICAgICAgICB9KSksIHRoaXMuZG9jdW1lbnRPdmVybGF5Q2FjaGUuZ2V0T3ZlcmxheXMoZSwgcikubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICBlLmZvckVhY2goKChlLCBuKSA9PiB7XG4gICAgICAgICAgICAgICAgdC5zZXQoZSwgbik7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29tcHV0ZXMgdGhlIGxvY2FsIHZpZXcgZm9yIHRoZSBnaXZlbiBkb2N1bWVudHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jcyAtIFRoZSBkb2N1bWVudHMgdG8gY29tcHV0ZSB2aWV3cyBmb3IuIEl0IGFsc28gaGFzIHRoZSBiYXNlXG4gICAgICogICB2ZXJzaW9uIG9mIHRoZSBkb2N1bWVudHMuXG4gICAgICogQHBhcmFtIG92ZXJsYXlzIC0gVGhlIG92ZXJsYXlzIHRoYXQgbmVlZCB0byBiZSBhcHBsaWVkIHRvIHRoZSBnaXZlbiBiYXNlXG4gICAgICogICB2ZXJzaW9uIG9mIHRoZSBkb2N1bWVudHMuXG4gICAgICogQHBhcmFtIGV4aXN0ZW5jZVN0YXRlQ2hhbmdlZCAtIEEgc2V0IG9mIGRvY3VtZW50cyB3aG9zZSBleGlzdGVuY2Ugc3RhdGVzXG4gICAgICogICBtaWdodCBoYXZlIGNoYW5nZWQuIFRoaXMgaXMgdXNlZCB0byBkZXRlcm1pbmUgaWYgd2UgbmVlZCB0byByZS1jYWxjdWxhdGVcbiAgICAgKiAgIG92ZXJsYXlzIGZyb20gbXV0YXRpb24gcXVldWVzLlxuICAgICAqIEByZXR1cm4gQSBtYXAgcmVwcmVzZW50cyB0aGUgbG9jYWwgZG9jdW1lbnRzIHZpZXcuXG4gICAgICovICAgIGNvbXB1dGVWaWV3cyhlLCB0LCBuLCByKSB7XG4gICAgICAgIGxldCBpID0gX19QUklWQVRFX211dGFibGVEb2N1bWVudE1hcCgpO1xuICAgICAgICBjb25zdCBzID0gX19QUklWQVRFX25ld0RvY3VtZW50S2V5TWFwKCksIG8gPSBmdW5jdGlvbiBfX1BSSVZBVEVfbmV3T3ZlcmxheWVkRG9jdW1lbnRNYXAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX19QUklWQVRFX25ld0RvY3VtZW50S2V5TWFwKCk7XG4gICAgICAgIH0oKTtcbiAgICAgICAgcmV0dXJuIHQuZm9yRWFjaCgoKGUsIHQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG8gPSBuLmdldCh0LmtleSk7XG4gICAgICAgICAgICAvLyBSZWNhbGN1bGF0ZSBhbiBvdmVybGF5IGlmIHRoZSBkb2N1bWVudCdzIGV4aXN0ZW5jZSBzdGF0ZSBjaGFuZ2VkIGR1ZSB0b1xuICAgICAgICAgICAgLy8gYSByZW1vdGUgZXZlbnQgKmFuZCogdGhlIG92ZXJsYXkgaXMgYSBQYXRjaE11dGF0aW9uLiBUaGlzIGlzIGJlY2F1c2VcbiAgICAgICAgICAgIC8vIGRvY3VtZW50IGV4aXN0ZW5jZSBzdGF0ZSBjYW4gY2hhbmdlIGlmIHNvbWUgcGF0Y2ggbXV0YXRpb24nc1xuICAgICAgICAgICAgLy8gcHJlY29uZGl0aW9ucyBhcmUgbWV0LlxuICAgICAgICAgICAgLy8gTk9URTogd2UgcmVjYWxjdWxhdGUgd2hlbiBgb3ZlcmxheWAgaXMgdW5kZWZpbmVkIGFzIHdlbGwsIGJlY2F1c2UgdGhlcmVcbiAgICAgICAgICAgIC8vIG1pZ2h0IGJlIGEgcGF0Y2ggbXV0YXRpb24gd2hvc2UgcHJlY29uZGl0aW9uIGRvZXMgbm90IG1hdGNoIGJlZm9yZSB0aGVcbiAgICAgICAgICAgIC8vIGNoYW5nZSAoaGVuY2Ugb3ZlcmxheSBpcyB1bmRlZmluZWQpLCBidXQgd291bGQgbm93IG1hdGNoLlxuICAgICAgICAgICAgICAgICAgICAgICAgci5oYXModC5rZXkpICYmICh2b2lkIDAgPT09IG8gfHwgby5tdXRhdGlvbiBpbnN0YW5jZW9mIF9fUFJJVkFURV9QYXRjaE11dGF0aW9uKSA/IGkgPSBpLmluc2VydCh0LmtleSwgdCkgOiB2b2lkIDAgIT09IG8gPyAocy5zZXQodC5rZXksIG8ubXV0YXRpb24uZ2V0RmllbGRNYXNrKCkpLCBcbiAgICAgICAgICAgIF9fUFJJVkFURV9tdXRhdGlvbkFwcGx5VG9Mb2NhbFZpZXcoby5tdXRhdGlvbiwgdCwgby5tdXRhdGlvbi5nZXRGaWVsZE1hc2soKSwgVGltZXN0YW1wLm5vdygpKSkgOiBcbiAgICAgICAgICAgIC8vIG5vIG92ZXJsYXkgZXhpc3RzXG4gICAgICAgICAgICAvLyBVc2luZyBFTVBUWSB0byBpbmRpY2F0ZSB0aGVyZSBpcyBubyBvdmVybGF5IGZvciB0aGUgZG9jdW1lbnQuXG4gICAgICAgICAgICBzLnNldCh0LmtleSwgRmllbGRNYXNrLmVtcHR5KCkpO1xuICAgICAgICB9KSksIHRoaXMucmVjYWxjdWxhdGVBbmRTYXZlT3ZlcmxheXMoZSwgaSkubmV4dCgoZSA9PiAoZS5mb3JFYWNoKCgoZSwgdCkgPT4gcy5zZXQoZSwgdCkpKSwgXG4gICAgICAgIHQuZm9yRWFjaCgoKGUsIHQpID0+IG8uc2V0KGUsIG5ldyBPdmVybGF5ZWREb2N1bWVudCh0LCBzLmdldChlKSA/PyBudWxsKSkpKSwgbykpKTtcbiAgICB9XG4gICAgcmVjYWxjdWxhdGVBbmRTYXZlT3ZlcmxheXMoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX25ld0RvY3VtZW50S2V5TWFwKCk7XG4gICAgICAgIC8vIEEgcmV2ZXJzZSBsb29rdXAgbWFwIGZyb20gYmF0Y2ggaWQgdG8gdGhlIGRvY3VtZW50cyB3aXRoaW4gdGhhdCBiYXRjaC5cbiAgICAgICAgICAgICAgICBsZXQgciA9IG5ldyBTb3J0ZWRNYXAoKChlLCB0KSA9PiBlIC0gdCkpLCBpID0gX19QUklWQVRFX2RvY3VtZW50S2V5U2V0KCk7XG4gICAgICAgIHJldHVybiB0aGlzLm11dGF0aW9uUXVldWUuZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXlzKGUsIHQpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIGUpIGkua2V5cygpLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSB0LmdldChlKTtcbiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PT0gcykgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGxldCBvID0gbi5nZXQoZSkgfHwgRmllbGRNYXNrLmVtcHR5KCk7XG4gICAgICAgICAgICAgICAgbyA9IGkuYXBwbHlUb0xvY2FsVmlldyhzLCBvKSwgbi5zZXQoZSwgbyk7XG4gICAgICAgICAgICAgICAgY29uc3QgXyA9IChyLmdldChpLmJhdGNoSWQpIHx8IF9fUFJJVkFURV9kb2N1bWVudEtleVNldCgpKS5hZGQoZSk7XG4gICAgICAgICAgICAgICAgciA9IHIuaW5zZXJ0KGkuYmF0Y2hJZCwgXyk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gW10sIG8gPSByLmdldFJldmVyc2VJdGVyYXRvcigpO1xuICAgICAgICAgICAgLy8gSXRlcmF0ZSBpbiBkZXNjZW5kaW5nIG9yZGVyIG9mIGJhdGNoIElEcywgYW5kIHNraXAgZG9jdW1lbnRzIHRoYXQgYXJlXG4gICAgICAgICAgICAvLyBhbHJlYWR5IHNhdmVkLlxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICg7by5oYXNOZXh0KCk7ICkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBvLmdldE5leHQoKSwgXyA9IHIua2V5LCBhID0gci52YWx1ZSwgdSA9IF9fUFJJVkFURV9uZXdNdXRhdGlvbk1hcCgpO1xuICAgICAgICAgICAgICAgIGEuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaS5oYXMoZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfY2FsY3VsYXRlT3ZlcmxheU11dGF0aW9uKHQuZ2V0KGUpLCBuLmdldChlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBudWxsICE9PSByICYmIHUuc2V0KGUsIHIpLCBpID0gaS5hZGQoZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSksIHMucHVzaCh0aGlzLmRvY3VtZW50T3ZlcmxheUNhY2hlLnNhdmVPdmVybGF5cyhlLCBfLCB1KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3Iocyk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBuKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlY2FsY3VsYXRlcyBvdmVybGF5cyBieSByZWFkaW5nIHRoZSBkb2N1bWVudHMgZnJvbSByZW1vdGUgZG9jdW1lbnQgY2FjaGVcbiAgICAgKiBmaXJzdCwgYW5kIHNhdmVzIHRoZW0gYWZ0ZXIgdGhleSBhcmUgY2FsY3VsYXRlZC5cbiAgICAgKi8gICAgcmVjYWxjdWxhdGVBbmRTYXZlT3ZlcmxheXNGb3JEb2N1bWVudEtleXMoZSwgdCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlLmdldEVudHJpZXMoZSwgdCkubmV4dCgodCA9PiB0aGlzLnJlY2FsY3VsYXRlQW5kU2F2ZU92ZXJsYXlzKGUsIHQpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBlcmZvcm1zIGEgcXVlcnkgYWdhaW5zdCB0aGUgbG9jYWwgdmlldyBvZiBhbGwgZG9jdW1lbnRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHRyYW5zYWN0aW9uIC0gVGhlIHBlcnNpc3RlbmNlIHRyYW5zYWN0aW9uLlxuICAgICAqIEBwYXJhbSBxdWVyeSAtIFRoZSBxdWVyeSB0byBtYXRjaCBkb2N1bWVudHMgYWdhaW5zdC5cbiAgICAgKiBAcGFyYW0gb2Zmc2V0IC0gUmVhZCB0aW1lIGFuZCBrZXkgdG8gc3RhcnQgc2Nhbm5pbmcgYnkgKGV4Y2x1c2l2ZSkuXG4gICAgICogQHBhcmFtIGNvbnRleHQgLSBBIG9wdGlvbmFsIHRyYWNrZXIgdG8ga2VlcCBhIHJlY29yZCBvZiBpbXBvcnRhbnQgZGV0YWlsc1xuICAgICAqICAgZHVyaW5nIGRhdGFiYXNlIGxvY2FsIHF1ZXJ5IGV4ZWN1dGlvbi5cbiAgICAgKi8gICAgZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeShlLCB0LCBuLCByKSB7XG4gICAgICAgIC8qKlxuICogUmV0dXJucyB3aGV0aGVyIHRoZSBxdWVyeSBtYXRjaGVzIGEgc2luZ2xlIGRvY3VtZW50IGJ5IHBhdGggKHJhdGhlciB0aGFuIGFcbiAqIGNvbGxlY3Rpb24pLlxuICovXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBfX1BSSVZBVEVfaXNEb2N1bWVudFF1ZXJ5JDEoZSkge1xuICAgICAgICAgICAgcmV0dXJuIERvY3VtZW50S2V5LmlzRG9jdW1lbnRLZXkoZS5wYXRoKSAmJiBudWxsID09PSBlLmNvbGxlY3Rpb25Hcm91cCAmJiAwID09PSBlLmZpbHRlcnMubGVuZ3RoO1xuICAgICAgICB9KHQpID8gdGhpcy5nZXREb2N1bWVudHNNYXRjaGluZ0RvY3VtZW50UXVlcnkoZSwgdC5wYXRoKSA6IF9fUFJJVkFURV9pc0NvbGxlY3Rpb25Hcm91cFF1ZXJ5KHQpID8gdGhpcy5nZXREb2N1bWVudHNNYXRjaGluZ0NvbGxlY3Rpb25Hcm91cFF1ZXJ5KGUsIHQsIG4sIHIpIDogdGhpcy5nZXREb2N1bWVudHNNYXRjaGluZ0NvbGxlY3Rpb25RdWVyeShlLCB0LCBuLCByKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2l2ZW4gYSBjb2xsZWN0aW9uIGdyb3VwLCByZXR1cm5zIHRoZSBuZXh0IGRvY3VtZW50cyB0aGF0IGZvbGxvdyB0aGUgcHJvdmlkZWQgb2Zmc2V0LCBhbG9uZ1xuICAgICAqIHdpdGggYW4gdXBkYXRlZCBiYXRjaCBJRC5cbiAgICAgKlxuICAgICAqIDxwPlRoZSBkb2N1bWVudHMgcmV0dXJuZWQgYnkgdGhpcyBtZXRob2QgYXJlIG9yZGVyZWQgYnkgcmVtb3RlIHZlcnNpb24gZnJvbSB0aGUgcHJvdmlkZWRcbiAgICAgKiBvZmZzZXQuIElmIHRoZXJlIGFyZSBubyBtb3JlIHJlbW90ZSBkb2N1bWVudHMgYWZ0ZXIgdGhlIHByb3ZpZGVkIG9mZnNldCwgZG9jdW1lbnRzIHdpdGhcbiAgICAgKiBtdXRhdGlvbnMgaW4gb3JkZXIgb2YgYmF0Y2ggaWQgZnJvbSB0aGUgb2Zmc2V0IGFyZSByZXR1cm5lZC4gU2luY2UgYWxsIGRvY3VtZW50cyBpbiBhIGJhdGNoIGFyZVxuICAgICAqIHJldHVybmVkIHRvZ2V0aGVyLCB0aGUgdG90YWwgbnVtYmVyIG9mIGRvY3VtZW50cyByZXR1cm5lZCBjYW4gZXhjZWVkIHtAY29kZSBjb3VudH0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdHJhbnNhY3Rpb25cbiAgICAgKiBAcGFyYW0gY29sbGVjdGlvbkdyb3VwIFRoZSBjb2xsZWN0aW9uIGdyb3VwIGZvciB0aGUgZG9jdW1lbnRzLlxuICAgICAqIEBwYXJhbSBvZmZzZXQgVGhlIG9mZnNldCB0byBpbmRleCBpbnRvLlxuICAgICAqIEBwYXJhbSBjb3VudCBUaGUgbnVtYmVyIG9mIGRvY3VtZW50cyB0byByZXR1cm5cbiAgICAgKiBAcmV0dXJuIEEgTG9jYWxXcml0ZVJlc3VsdCB3aXRoIHRoZSBkb2N1bWVudHMgdGhhdCBmb2xsb3cgdGhlIHByb3ZpZGVkIG9mZnNldCBhbmQgdGhlIGxhc3QgcHJvY2Vzc2VkIGJhdGNoIGlkLlxuICAgICAqLyAgICBnZXROZXh0RG9jdW1lbnRzKGUsIHQsIG4sIHIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVtb3RlRG9jdW1lbnRDYWNoZS5nZXRBbGxGcm9tQ29sbGVjdGlvbkdyb3VwKGUsIHQsIG4sIHIpLm5leHQoKGkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IHIgLSBpLnNpemUgPiAwID8gdGhpcy5kb2N1bWVudE92ZXJsYXlDYWNoZS5nZXRPdmVybGF5c0ZvckNvbGxlY3Rpb25Hcm91cChlLCB0LCBuLmxhcmdlc3RCYXRjaElkLCByIC0gaS5zaXplKSA6IFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKF9fUFJJVkFURV9uZXdPdmVybGF5TWFwKCkpO1xuICAgICAgICAgICAgLy8gVGhlIGNhbGxzaXRlIHdpbGwgdXNlIHRoZSBsYXJnZXN0IGJhdGNoIElEIHRvZ2V0aGVyIHdpdGggdGhlIGxhdGVzdCByZWFkIHRpbWUgdG8gY3JlYXRlXG4gICAgICAgICAgICAvLyBhIG5ldyBpbmRleCBvZmZzZXQuIFNpbmNlIHdlIG9ubHkgcHJvY2VzcyBiYXRjaCBJRHMgaWYgYWxsIHJlbW90ZSBkb2N1bWVudHMgaGF2ZSBiZWVuIHJlYWQsXG4gICAgICAgICAgICAvLyBubyBvdmVybGF5IHdpbGwgaW5jcmVhc2UgdGhlIG92ZXJhbGwgcmVhZCB0aW1lLiBUaGlzIGlzIHdoeSB3ZSBvbmx5IG5lZWQgdG8gc3BlY2lhbCBjYXNlXG4gICAgICAgICAgICAvLyB0aGUgYmF0Y2ggaWQuXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbyA9IFUsIF8gPSBpO1xuICAgICAgICAgICAgcmV0dXJuIHMubmV4dCgodCA9PiBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaCh0LCAoKHQsIG4pID0+IChvIDwgbi5sYXJnZXN0QmF0Y2hJZCAmJiAobyA9IG4ubGFyZ2VzdEJhdGNoSWQpLCBcbiAgICAgICAgICAgIGkuZ2V0KHQpID8gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKSA6IHRoaXMucmVtb3RlRG9jdW1lbnRDYWNoZS5nZXRFbnRyeShlLCB0KS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgICAgICBfID0gXy5pbnNlcnQodCwgZSk7XG4gICAgICAgICAgICB9KSkpKSkubmV4dCgoKCkgPT4gdGhpcy5wb3B1bGF0ZU92ZXJsYXlzKGUsIHQsIGkpKSkubmV4dCgoKCkgPT4gdGhpcy5jb21wdXRlVmlld3MoZSwgXywgdCwgX19QUklWQVRFX2RvY3VtZW50S2V5U2V0KCkpKSkubmV4dCgoZSA9PiAoe1xuICAgICAgICAgICAgICAgIGJhdGNoSWQ6IG8sXG4gICAgICAgICAgICAgICAgY2hhbmdlczogX19QUklWQVRFX2NvbnZlcnRPdmVybGF5ZWREb2N1bWVudE1hcFRvRG9jdW1lbnRNYXAoZSlcbiAgICAgICAgICAgIH0pKSkpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBnZXREb2N1bWVudHNNYXRjaGluZ0RvY3VtZW50UXVlcnkoZSwgdCkge1xuICAgICAgICAvLyBKdXN0IGRvIGEgc2ltcGxlIGRvY3VtZW50IGxvb2t1cC5cbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RG9jdW1lbnQoZSwgbmV3IERvY3VtZW50S2V5KHQpKS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgIGxldCB0ID0gZG9jdW1lbnRNYXAoKTtcbiAgICAgICAgICAgIHJldHVybiBlLmlzRm91bmREb2N1bWVudCgpICYmICh0ID0gdC5pbnNlcnQoZS5rZXksIGUpKSwgdDtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBnZXREb2N1bWVudHNNYXRjaGluZ0NvbGxlY3Rpb25Hcm91cFF1ZXJ5KGUsIHQsIG4sIHIpIHtcbiAgICAgICAgY29uc3QgaSA9IHQuY29sbGVjdGlvbkdyb3VwO1xuICAgICAgICBsZXQgcyA9IGRvY3VtZW50TWFwKCk7XG4gICAgICAgIHJldHVybiB0aGlzLmluZGV4TWFuYWdlci5nZXRDb2xsZWN0aW9uUGFyZW50cyhlLCBpKS5uZXh0KChvID0+IFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKG8sIChvID0+IHtcbiAgICAgICAgICAgIGNvbnN0IF8gPSBmdW5jdGlvbiBfX1BSSVZBVEVfYXNDb2xsZWN0aW9uUXVlcnlBdFBhdGgoZSwgdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgX19QUklWQVRFX1F1ZXJ5SW1wbCh0LCBcbiAgICAgICAgICAgICAgICAvKmNvbGxlY3Rpb25Hcm91cD0qLyBudWxsLCBlLmV4cGxpY2l0T3JkZXJCeS5zbGljZSgpLCBlLmZpbHRlcnMuc2xpY2UoKSwgZS5saW1pdCwgZS5saW1pdFR5cGUsIGUuc3RhcnRBdCwgZS5lbmRBdCk7XG4gICAgICAgICAgICB9KHQsIG8uY2hpbGQoaSkpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RG9jdW1lbnRzTWF0Y2hpbmdDb2xsZWN0aW9uUXVlcnkoZSwgXywgbiwgcikubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgZS5mb3JFYWNoKCgoZSwgdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzID0gcy5pbnNlcnQoZSwgdCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gcykpKSk7XG4gICAgfVxuICAgIGdldERvY3VtZW50c01hdGNoaW5nQ29sbGVjdGlvblF1ZXJ5KGUsIHQsIG4sIHIpIHtcbiAgICAgICAgLy8gUXVlcnkgdGhlIHJlbW90ZSBkb2N1bWVudHMgYW5kIG92ZXJsYXkgbXV0YXRpb25zLlxuICAgICAgICBsZXQgaTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG9jdW1lbnRPdmVybGF5Q2FjaGUuZ2V0T3ZlcmxheXNGb3JDb2xsZWN0aW9uKGUsIHQucGF0aCwgbi5sYXJnZXN0QmF0Y2hJZCkubmV4dCgocyA9PiAoaSA9IHMsIFxuICAgICAgICB0aGlzLnJlbW90ZURvY3VtZW50Q2FjaGUuZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeShlLCB0LCBuLCBpLCByKSkpKS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgIC8vIEFzIGRvY3VtZW50cyBtaWdodCBtYXRjaCB0aGUgcXVlcnkgYmVjYXVzZSBvZiB0aGVpciBvdmVybGF5IHdlIG5lZWQgdG9cbiAgICAgICAgICAgIC8vIGluY2x1ZGUgZG9jdW1lbnRzIGZvciBhbGwgb3ZlcmxheXMgaW4gdGhlIGluaXRpYWwgZG9jdW1lbnQgc2V0LlxuICAgICAgICAgICAgaS5mb3JFYWNoKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuLmdldEtleSgpO1xuICAgICAgICAgICAgICAgIG51bGwgPT09IGUuZ2V0KHIpICYmIChlID0gZS5pbnNlcnQociwgTXV0YWJsZURvY3VtZW50Lm5ld0ludmFsaWREb2N1bWVudChyKSkpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgLy8gQXBwbHkgdGhlIG92ZXJsYXlzIGFuZCBtYXRjaCBhZ2FpbnN0IHRoZSBxdWVyeS5cbiAgICAgICAgICAgIGxldCBuID0gZG9jdW1lbnRNYXAoKTtcbiAgICAgICAgICAgIHJldHVybiBlLmZvckVhY2goKChlLCByKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IGkuZ2V0KGUpO1xuICAgICAgICAgICAgICAgIHZvaWQgMCAhPT0gcyAmJiBfX1BSSVZBVEVfbXV0YXRpb25BcHBseVRvTG9jYWxWaWV3KHMubXV0YXRpb24sIHIsIEZpZWxkTWFzay5lbXB0eSgpLCBUaW1lc3RhbXAubm93KCkpLCBcbiAgICAgICAgICAgICAgICAvLyBGaW5hbGx5LCBpbnNlcnQgdGhlIGRvY3VtZW50cyB0aGF0IHN0aWxsIG1hdGNoIHRoZSBxdWVyeVxuICAgICAgICAgICAgICAgIF9fUFJJVkFURV9xdWVyeU1hdGNoZXModCwgcikgJiYgKG4gPSBuLmluc2VydChlLCByKSk7XG4gICAgICAgICAgICB9KSksIG47XG4gICAgICAgIH0pKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIF9fUFJJVkFURV9NZW1vcnlCdW5kbGVDYWNoZSB7XG4gICAgY29uc3RydWN0b3IoZSkge1xuICAgICAgICB0aGlzLnNlcmlhbGl6ZXIgPSBlLCB0aGlzLkxyID0gbmV3IE1hcCwgdGhpcy5rciA9IG5ldyBNYXA7XG4gICAgfVxuICAgIGdldEJ1bmRsZU1ldGFkYXRhKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMuTHIuZ2V0KHQpKTtcbiAgICB9XG4gICAgc2F2ZUJ1bmRsZU1ldGFkYXRhKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuTHIuc2V0KHQuaWQsIFxuICAgICAgICAvKiogRGVjb2RlcyBhIEJ1bmRsZU1ldGFkYXRhIHByb3RvIGludG8gYSBCdW5kbGVNZXRhZGF0YSBvYmplY3QuICovXG4gICAgICAgIGZ1bmN0aW9uIF9fUFJJVkFURV9mcm9tQnVuZGxlTWV0YWRhdGEoZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpZDogZS5pZCxcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBlLnZlcnNpb24sXG4gICAgICAgICAgICAgICAgY3JlYXRlVGltZTogX19QUklWQVRFX2Zyb21WZXJzaW9uKGUuY3JlYXRlVGltZSlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0odCkpLCBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBnZXROYW1lZFF1ZXJ5KGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMua3IuZ2V0KHQpKTtcbiAgICB9XG4gICAgc2F2ZU5hbWVkUXVlcnkoZSwgdCkge1xuICAgICAgICByZXR1cm4gdGhpcy5rci5zZXQodC5uYW1lLCBmdW5jdGlvbiBfX1BSSVZBVEVfZnJvbVByb3RvTmFtZWRRdWVyeShlKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWU6IGUubmFtZSxcbiAgICAgICAgICAgICAgICBxdWVyeTogX19QUklWQVRFX2Zyb21CdW5kbGVkUXVlcnkoZS5idW5kbGVkUXVlcnkpLFxuICAgICAgICAgICAgICAgIHJlYWRUaW1lOiBfX1BSSVZBVEVfZnJvbVZlcnNpb24oZS5yZWFkVGltZSlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0odCkpLCBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gaW4tbWVtb3J5IGltcGxlbWVudGF0aW9uIG9mIERvY3VtZW50T3ZlcmxheUNhY2hlLlxuICovIGNsYXNzIF9fUFJJVkFURV9NZW1vcnlEb2N1bWVudE92ZXJsYXlDYWNoZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIC8vIEEgbWFwIHNvcnRlZCBieSBEb2N1bWVudEtleSwgd2hvc2UgdmFsdWUgaXMgYSBwYWlyIG9mIHRoZSBsYXJnZXN0IGJhdGNoIGlkXG4gICAgICAgIC8vIGZvciB0aGUgb3ZlcmxheSBhbmQgdGhlIG92ZXJsYXkgaXRzZWxmLlxuICAgICAgICB0aGlzLm92ZXJsYXlzID0gbmV3IFNvcnRlZE1hcChEb2N1bWVudEtleS5jb21wYXJhdG9yKSwgdGhpcy5xciA9IG5ldyBNYXA7XG4gICAgfVxuICAgIGdldE92ZXJsYXkoZSwgdCkge1xuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy5vdmVybGF5cy5nZXQodCkpO1xuICAgIH1cbiAgICBnZXRPdmVybGF5cyhlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfbmV3T3ZlcmxheU1hcCgpO1xuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2godCwgKHQgPT4gdGhpcy5nZXRPdmVybGF5KGUsIHQpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgbnVsbCAhPT0gZSAmJiBuLnNldCh0LCBlKTtcbiAgICAgICAgfSkpKSkubmV4dCgoKCkgPT4gbikpO1xuICAgIH1cbiAgICBzYXZlT3ZlcmxheXMoZSwgdCwgbikge1xuICAgICAgICByZXR1cm4gbi5mb3JFYWNoKCgobiwgcikgPT4ge1xuICAgICAgICAgICAgdGhpcy5TdChlLCB0LCByKTtcbiAgICAgICAgfSkpLCBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICByZW1vdmVPdmVybGF5c0ZvckJhdGNoSWQoZSwgdCwgbikge1xuICAgICAgICBjb25zdCByID0gdGhpcy5xci5nZXQobik7XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IHIgJiYgKHIuZm9yRWFjaCgoZSA9PiB0aGlzLm92ZXJsYXlzID0gdGhpcy5vdmVybGF5cy5yZW1vdmUoZSkpKSwgXG4gICAgICAgIHRoaXMucXIuZGVsZXRlKG4pKSwgUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgZ2V0T3ZlcmxheXNGb3JDb2xsZWN0aW9uKGUsIHQsIG4pIHtcbiAgICAgICAgY29uc3QgciA9IF9fUFJJVkFURV9uZXdPdmVybGF5TWFwKCksIGkgPSB0Lmxlbmd0aCArIDEsIHMgPSBuZXcgRG9jdW1lbnRLZXkodC5jaGlsZChcIlwiKSksIG8gPSB0aGlzLm92ZXJsYXlzLmdldEl0ZXJhdG9yRnJvbShzKTtcbiAgICAgICAgZm9yICg7by5oYXNOZXh0KCk7ICkge1xuICAgICAgICAgICAgY29uc3QgZSA9IG8uZ2V0TmV4dCgpLnZhbHVlLCBzID0gZS5nZXRLZXkoKTtcbiAgICAgICAgICAgIGlmICghdC5pc1ByZWZpeE9mKHMucGF0aCkpIGJyZWFrO1xuICAgICAgICAgICAgLy8gRG9jdW1lbnRzIGZyb20gc3ViLWNvbGxlY3Rpb25zXG4gICAgICAgICAgICAgICAgICAgICAgICBzLnBhdGgubGVuZ3RoID09PSBpICYmIChlLmxhcmdlc3RCYXRjaElkID4gbiAmJiByLnNldChlLmdldEtleSgpLCBlKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHIpO1xuICAgIH1cbiAgICBnZXRPdmVybGF5c0ZvckNvbGxlY3Rpb25Hcm91cChlLCB0LCBuLCByKSB7XG4gICAgICAgIGxldCBpID0gbmV3IFNvcnRlZE1hcCgoKGUsIHQpID0+IGUgLSB0KSk7XG4gICAgICAgIGNvbnN0IHMgPSB0aGlzLm92ZXJsYXlzLmdldEl0ZXJhdG9yKCk7XG4gICAgICAgIGZvciAoO3MuaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBzLmdldE5leHQoKS52YWx1ZTtcbiAgICAgICAgICAgIGlmIChlLmdldEtleSgpLmdldENvbGxlY3Rpb25Hcm91cCgpID09PSB0ICYmIGUubGFyZ2VzdEJhdGNoSWQgPiBuKSB7XG4gICAgICAgICAgICAgICAgbGV0IHQgPSBpLmdldChlLmxhcmdlc3RCYXRjaElkKTtcbiAgICAgICAgICAgICAgICBudWxsID09PSB0ICYmICh0ID0gX19QUklWQVRFX25ld092ZXJsYXlNYXAoKSwgaSA9IGkuaW5zZXJ0KGUubGFyZ2VzdEJhdGNoSWQsIHQpKSwgXG4gICAgICAgICAgICAgICAgdC5zZXQoZS5nZXRLZXkoKSwgZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbyA9IF9fUFJJVkFURV9uZXdPdmVybGF5TWFwKCksIF8gPSBpLmdldEl0ZXJhdG9yKCk7XG4gICAgICAgIGZvciAoO18uaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGlmIChfLmdldE5leHQoKS52YWx1ZS5mb3JFYWNoKCgoZSwgdCkgPT4gby5zZXQoZSwgdCkpKSwgby5zaXplKCkgPj0gcikgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKG8pO1xuICAgIH1cbiAgICBTdChlLCB0LCBuKSB7XG4gICAgICAgIC8vIFJlbW92ZSB0aGUgYXNzb2NpYXRpb24gb2YgdGhlIG92ZXJsYXkgdG8gaXRzIGJhdGNoIGlkLlxuICAgICAgICBjb25zdCByID0gdGhpcy5vdmVybGF5cy5nZXQobi5rZXkpO1xuICAgICAgICBpZiAobnVsbCAhPT0gcikge1xuICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMucXIuZ2V0KHIubGFyZ2VzdEJhdGNoSWQpLmRlbGV0ZShuLmtleSk7XG4gICAgICAgICAgICB0aGlzLnFyLnNldChyLmxhcmdlc3RCYXRjaElkLCBlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm92ZXJsYXlzID0gdGhpcy5vdmVybGF5cy5pbnNlcnQobi5rZXksIG5ldyBPdmVybGF5KHQsIG4pKTtcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBhc3NvY2lhdGlvbiBvZiB0aGlzIG92ZXJsYXkgdG8gdGhlIGdpdmVuIGxhcmdlc3RCYXRjaElkLlxuICAgICAgICBsZXQgaSA9IHRoaXMucXIuZ2V0KHQpO1xuICAgICAgICB2b2lkIDAgPT09IGkgJiYgKGkgPSBfX1BSSVZBVEVfZG9jdW1lbnRLZXlTZXQoKSwgdGhpcy5xci5zZXQodCwgaSkpLCB0aGlzLnFyLnNldCh0LCBpLmFkZChuLmtleSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjQgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgX19QUklWQVRFX01lbW9yeUdsb2JhbHNDYWNoZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuc2Vzc2lvblRva2VuID0gQnl0ZVN0cmluZy5FTVBUWV9CWVRFX1NUUklORztcbiAgICB9XG4gICAgZ2V0U2Vzc2lvblRva2VuKGUpIHtcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMuc2Vzc2lvblRva2VuKTtcbiAgICB9XG4gICAgc2V0U2Vzc2lvblRva2VuKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2Vzc2lvblRva2VuID0gdCwgUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgY29sbGVjdGlvbiBvZiByZWZlcmVuY2VzIHRvIGEgZG9jdW1lbnQgZnJvbSBzb21lIGtpbmQgb2YgbnVtYmVyZWQgZW50aXR5XG4gKiAoZWl0aGVyIGEgdGFyZ2V0IElEIG9yIGJhdGNoIElEKS4gQXMgcmVmZXJlbmNlcyBhcmUgYWRkZWQgdG8gb3IgcmVtb3ZlZCBmcm9tXG4gKiB0aGUgc2V0IGNvcnJlc3BvbmRpbmcgZXZlbnRzIGFyZSBlbWl0dGVkIHRvIGEgcmVnaXN0ZXJlZCBnYXJiYWdlIGNvbGxlY3Rvci5cbiAqXG4gKiBFYWNoIHJlZmVyZW5jZSBpcyByZXByZXNlbnRlZCBieSBhIERvY3VtZW50UmVmZXJlbmNlIG9iamVjdC4gRWFjaCBvZiB0aGVtXG4gKiBjb250YWlucyBlbm91Z2ggaW5mb3JtYXRpb24gdG8gdW5pcXVlbHkgaWRlbnRpZnkgdGhlIHJlZmVyZW5jZS4gVGhleSBhcmUgYWxsXG4gKiBzdG9yZWQgcHJpbWFyaWx5IGluIGEgc2V0IHNvcnRlZCBieSBrZXkuIEEgZG9jdW1lbnQgaXMgY29uc2lkZXJlZCBnYXJiYWdlIGlmXG4gKiB0aGVyZSdzIG5vIHJlZmVyZW5jZXMgaW4gdGhhdCBzZXQgKHRoaXMgY2FuIGJlIGVmZmljaWVudGx5IGNoZWNrZWQgdGhhbmtzIHRvXG4gKiBzb3J0aW5nIGJ5IGtleSkuXG4gKlxuICogUmVmZXJlbmNlU2V0IGFsc28ga2VlcHMgYSBzZWNvbmRhcnkgc2V0IHRoYXQgY29udGFpbnMgcmVmZXJlbmNlcyBzb3J0ZWQgYnlcbiAqIElEcy4gVGhpcyBvbmUgaXMgdXNlZCB0byBlZmZpY2llbnRseSBpbXBsZW1lbnQgcmVtb3ZhbCBvZiBhbGwgcmVmZXJlbmNlcyBieVxuICogc29tZSB0YXJnZXQgSUQuXG4gKi8gY2xhc3MgX19QUklWQVRFX1JlZmVyZW5jZVNldCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIC8vIEEgc2V0IG9mIG91dHN0YW5kaW5nIHJlZmVyZW5jZXMgdG8gYSBkb2N1bWVudCBzb3J0ZWQgYnkga2V5LlxuICAgICAgICB0aGlzLlFyID0gbmV3IFNvcnRlZFNldChfX1BSSVZBVEVfRG9jUmVmZXJlbmNlLiRyKSwgXG4gICAgICAgIC8vIEEgc2V0IG9mIG91dHN0YW5kaW5nIHJlZmVyZW5jZXMgdG8gYSBkb2N1bWVudCBzb3J0ZWQgYnkgdGFyZ2V0IGlkLlxuICAgICAgICB0aGlzLlVyID0gbmV3IFNvcnRlZFNldChfX1BSSVZBVEVfRG9jUmVmZXJlbmNlLktyKTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgdHJ1ZSBpZiB0aGUgcmVmZXJlbmNlIHNldCBjb250YWlucyBubyByZWZlcmVuY2VzLiAqLyAgICBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5Rci5pc0VtcHR5KCk7XG4gICAgfVxuICAgIC8qKiBBZGRzIGEgcmVmZXJlbmNlIHRvIHRoZSBnaXZlbiBkb2N1bWVudCBrZXkgZm9yIHRoZSBnaXZlbiBJRC4gKi8gICAgYWRkUmVmZXJlbmNlKGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IG5ldyBfX1BSSVZBVEVfRG9jUmVmZXJlbmNlKGUsIHQpO1xuICAgICAgICB0aGlzLlFyID0gdGhpcy5Rci5hZGQobiksIHRoaXMuVXIgPSB0aGlzLlVyLmFkZChuKTtcbiAgICB9XG4gICAgLyoqIEFkZCByZWZlcmVuY2VzIHRvIHRoZSBnaXZlbiBkb2N1bWVudCBrZXlzIGZvciB0aGUgZ2l2ZW4gSUQuICovICAgIFdyKGUsIHQpIHtcbiAgICAgICAgZS5mb3JFYWNoKChlID0+IHRoaXMuYWRkUmVmZXJlbmNlKGUsIHQpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgYSByZWZlcmVuY2UgdG8gdGhlIGdpdmVuIGRvY3VtZW50IGtleSBmb3IgdGhlIGdpdmVuXG4gICAgICogSUQuXG4gICAgICovICAgIHJlbW92ZVJlZmVyZW5jZShlLCB0KSB7XG4gICAgICAgIHRoaXMuR3IobmV3IF9fUFJJVkFURV9Eb2NSZWZlcmVuY2UoZSwgdCkpO1xuICAgIH1cbiAgICB6cihlLCB0KSB7XG4gICAgICAgIGUuZm9yRWFjaCgoZSA9PiB0aGlzLnJlbW92ZVJlZmVyZW5jZShlLCB0KSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbGVhcnMgYWxsIHJlZmVyZW5jZXMgd2l0aCBhIGdpdmVuIElELiBDYWxscyByZW1vdmVSZWYoKSBmb3IgZWFjaCBrZXlcbiAgICAgKiByZW1vdmVkLlxuICAgICAqLyAgICBqcihlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBuZXcgRG9jdW1lbnRLZXkobmV3IFJlc291cmNlUGF0aChbXSkpLCBuID0gbmV3IF9fUFJJVkFURV9Eb2NSZWZlcmVuY2UodCwgZSksIHIgPSBuZXcgX19QUklWQVRFX0RvY1JlZmVyZW5jZSh0LCBlICsgMSksIGkgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuVXIuZm9yRWFjaEluUmFuZ2UoWyBuLCByIF0sIChlID0+IHtcbiAgICAgICAgICAgIHRoaXMuR3IoZSksIGkucHVzaChlLmtleSk7XG4gICAgICAgIH0pKSwgaTtcbiAgICB9XG4gICAgSnIoKSB7XG4gICAgICAgIHRoaXMuUXIuZm9yRWFjaCgoZSA9PiB0aGlzLkdyKGUpKSk7XG4gICAgfVxuICAgIEdyKGUpIHtcbiAgICAgICAgdGhpcy5RciA9IHRoaXMuUXIuZGVsZXRlKGUpLCB0aGlzLlVyID0gdGhpcy5Vci5kZWxldGUoZSk7XG4gICAgfVxuICAgIEhyKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IG5ldyBEb2N1bWVudEtleShuZXcgUmVzb3VyY2VQYXRoKFtdKSksIG4gPSBuZXcgX19QUklWQVRFX0RvY1JlZmVyZW5jZSh0LCBlKSwgciA9IG5ldyBfX1BSSVZBVEVfRG9jUmVmZXJlbmNlKHQsIGUgKyAxKTtcbiAgICAgICAgbGV0IGkgPSBfX1BSSVZBVEVfZG9jdW1lbnRLZXlTZXQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuVXIuZm9yRWFjaEluUmFuZ2UoWyBuLCByIF0sIChlID0+IHtcbiAgICAgICAgICAgIGkgPSBpLmFkZChlLmtleSk7XG4gICAgICAgIH0pKSwgaTtcbiAgICB9XG4gICAgY29udGFpbnNLZXkoZSkge1xuICAgICAgICBjb25zdCB0ID0gbmV3IF9fUFJJVkFURV9Eb2NSZWZlcmVuY2UoZSwgMCksIG4gPSB0aGlzLlFyLmZpcnN0QWZ0ZXJPckVxdWFsKHQpO1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gbiAmJiBlLmlzRXF1YWwobi5rZXkpO1xuICAgIH1cbn1cblxuY2xhc3MgX19QUklWQVRFX0RvY1JlZmVyZW5jZSB7XG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICB0aGlzLmtleSA9IGUsIHRoaXMuWXIgPSB0O1xuICAgIH1cbiAgICAvKiogQ29tcGFyZSBieSBrZXkgdGhlbiBieSBJRCAqLyAgICBzdGF0aWMgJHIoZSwgdCkge1xuICAgICAgICByZXR1cm4gRG9jdW1lbnRLZXkuY29tcGFyYXRvcihlLmtleSwgdC5rZXkpIHx8IF9fUFJJVkFURV9wcmltaXRpdmVDb21wYXJhdG9yKGUuWXIsIHQuWXIpO1xuICAgIH1cbiAgICAvKiogQ29tcGFyZSBieSBJRCB0aGVuIGJ5IGtleSAqLyAgICBzdGF0aWMgS3IoZSwgdCkge1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IoZS5ZciwgdC5ZcikgfHwgRG9jdW1lbnRLZXkuY29tcGFyYXRvcihlLmtleSwgdC5rZXkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgX19QUklWQVRFX01lbW9yeU11dGF0aW9uUXVldWUge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQpIHtcbiAgICAgICAgdGhpcy5pbmRleE1hbmFnZXIgPSBlLCB0aGlzLnJlZmVyZW5jZURlbGVnYXRlID0gdCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgc2V0IG9mIGFsbCBtdXRhdGlvbnMgdGhhdCBoYXZlIGJlZW4gc2VudCBidXQgbm90IHlldCBiZWVuIGFwcGxpZWQgdG9cbiAgICAgICAgICogdGhlIGJhY2tlbmQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBbXSwgXG4gICAgICAgIC8qKiBOZXh0IHZhbHVlIHRvIHVzZSB3aGVuIGFzc2lnbmluZyBzZXF1ZW50aWFsIElEcyB0byBlYWNoIG11dGF0aW9uIGJhdGNoLiAqL1xuICAgICAgICB0aGlzLnRyID0gMSwgXG4gICAgICAgIC8qKiBBbiBvcmRlcmVkIG1hcHBpbmcgYmV0d2VlbiBkb2N1bWVudHMgYW5kIHRoZSBtdXRhdGlvbnMgYmF0Y2ggSURzLiAqL1xuICAgICAgICB0aGlzLlpyID0gbmV3IFNvcnRlZFNldChfX1BSSVZBVEVfRG9jUmVmZXJlbmNlLiRyKTtcbiAgICB9XG4gICAgY2hlY2tFbXB0eShlKSB7XG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgwID09PSB0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoKTtcbiAgICB9XG4gICAgYWRkTXV0YXRpb25CYXRjaChlLCB0LCBuLCByKSB7XG4gICAgICAgIGNvbnN0IGkgPSB0aGlzLnRyO1xuICAgICAgICB0aGlzLnRyKyssIHRoaXMubXV0YXRpb25RdWV1ZS5sZW5ndGggPiAwICYmIHRoaXMubXV0YXRpb25RdWV1ZVt0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoIC0gMV07XG4gICAgICAgIGNvbnN0IHMgPSBuZXcgTXV0YXRpb25CYXRjaChpLCB0LCBuLCByKTtcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLnB1c2gocyk7XG4gICAgICAgIC8vIFRyYWNrIHJlZmVyZW5jZXMgYnkgZG9jdW1lbnQga2V5IGFuZCBpbmRleCBjb2xsZWN0aW9uIHBhcmVudHMuXG4gICAgICAgIGZvciAoY29uc3QgdCBvZiByKSB0aGlzLlpyID0gdGhpcy5aci5hZGQobmV3IF9fUFJJVkFURV9Eb2NSZWZlcmVuY2UodC5rZXksIGkpKSwgXG4gICAgICAgIHRoaXMuaW5kZXhNYW5hZ2VyLmFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KGUsIHQua2V5LnBhdGgucG9wTGFzdCgpKTtcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHMpO1xuICAgIH1cbiAgICBsb29rdXBNdXRhdGlvbkJhdGNoKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMuWHIodCkpO1xuICAgIH1cbiAgICBnZXROZXh0TXV0YXRpb25CYXRjaEFmdGVyQmF0Y2hJZChlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSB0ICsgMSwgciA9IHRoaXMuZWkobiksIGkgPSByIDwgMCA/IDAgOiByO1xuICAgICAgICAvLyBUaGUgcmVxdWVzdGVkIGJhdGNoSWQgbWF5IHN0aWxsIGJlIG91dCBvZiByYW5nZSBzbyBub3JtYWxpemUgaXQgdG8gdGhlXG4gICAgICAgIC8vIHN0YXJ0IG9mIHRoZSBxdWV1ZS5cbiAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy5tdXRhdGlvblF1ZXVlLmxlbmd0aCA+IGkgPyB0aGlzLm11dGF0aW9uUXVldWVbaV0gOiBudWxsKTtcbiAgICB9XG4gICAgZ2V0SGlnaGVzdFVuYWNrbm93bGVkZ2VkQmF0Y2hJZCgpIHtcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKDAgPT09IHRoaXMubXV0YXRpb25RdWV1ZS5sZW5ndGggPyBqIDogdGhpcy50ciAtIDEpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXMoZSkge1xuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy5tdXRhdGlvblF1ZXVlLnNsaWNlKCkpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleShlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgX19QUklWQVRFX0RvY1JlZmVyZW5jZSh0LCAwKSwgciA9IG5ldyBfX1BSSVZBVEVfRG9jUmVmZXJlbmNlKHQsIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSksIGkgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuWnIuZm9yRWFjaEluUmFuZ2UoWyBuLCByIF0sIChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLlhyKGUuWXIpO1xuICAgICAgICAgICAgaS5wdXNoKHQpO1xuICAgICAgICB9KSksIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKGkpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleXMoZSwgdCkge1xuICAgICAgICBsZXQgbiA9IG5ldyBTb3J0ZWRTZXQoX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IpO1xuICAgICAgICByZXR1cm4gdC5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBuZXcgX19QUklWQVRFX0RvY1JlZmVyZW5jZShlLCAwKSwgciA9IG5ldyBfX1BSSVZBVEVfRG9jUmVmZXJlbmNlKGUsIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSk7XG4gICAgICAgICAgICB0aGlzLlpyLmZvckVhY2hJblJhbmdlKFsgdCwgciBdLCAoZSA9PiB7XG4gICAgICAgICAgICAgICAgbiA9IG4uYWRkKGUuWXIpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSksIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMudGkobikpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdRdWVyeShlLCB0KSB7XG4gICAgICAgIC8vIFVzZSB0aGUgcXVlcnkgcGF0aCBhcyBhIHByZWZpeCBmb3IgdGVzdGluZyBpZiBhIGRvY3VtZW50IG1hdGNoZXMgdGhlXG4gICAgICAgIC8vIHF1ZXJ5LlxuICAgICAgICBjb25zdCBuID0gdC5wYXRoLCByID0gbi5sZW5ndGggKyAxO1xuICAgICAgICAvLyBDb25zdHJ1Y3QgYSBkb2N1bWVudCByZWZlcmVuY2UgZm9yIGFjdHVhbGx5IHNjYW5uaW5nIHRoZSBpbmRleC4gVW5saWtlXG4gICAgICAgIC8vIHRoZSBwcmVmaXggdGhlIGRvY3VtZW50IGtleSBpbiB0aGlzIHJlZmVyZW5jZSBtdXN0IGhhdmUgYW4gZXZlbiBudW1iZXIgb2ZcbiAgICAgICAgLy8gc2VnbWVudHMuIFRoZSBlbXB0eSBzZWdtZW50IGNhbiBiZSB1c2VkIGEgc3VmZml4IG9mIHRoZSBxdWVyeSBwYXRoXG4gICAgICAgIC8vIGJlY2F1c2UgaXQgcHJlY2VkZXMgYWxsIG90aGVyIHNlZ21lbnRzIGluIGFuIG9yZGVyZWQgdHJhdmVyc2FsLlxuICAgICAgICBsZXQgaSA9IG47XG4gICAgICAgIERvY3VtZW50S2V5LmlzRG9jdW1lbnRLZXkoaSkgfHwgKGkgPSBpLmNoaWxkKFwiXCIpKTtcbiAgICAgICAgY29uc3QgcyA9IG5ldyBfX1BSSVZBVEVfRG9jUmVmZXJlbmNlKG5ldyBEb2N1bWVudEtleShpKSwgMCk7XG4gICAgICAgIC8vIEZpbmQgdW5pcXVlIGJhdGNoSURzIHJlZmVyZW5jZWQgYnkgYWxsIGRvY3VtZW50cyBwb3RlbnRpYWxseSBtYXRjaGluZyB0aGVcbiAgICAgICAgLy8gcXVlcnkuXG4gICAgICAgICAgICAgICAgbGV0IG8gPSBuZXcgU29ydGVkU2V0KF9fUFJJVkFURV9wcmltaXRpdmVDb21wYXJhdG9yKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuWnIuZm9yRWFjaFdoaWxlKChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBlLmtleS5wYXRoO1xuICAgICAgICAgICAgcmV0dXJuICEhbi5pc1ByZWZpeE9mKHQpICYmIChcbiAgICAgICAgICAgIC8vIFJvd3Mgd2l0aCBkb2N1bWVudCBrZXlzIG1vcmUgdGhhbiBvbmUgc2VnbWVudCBsb25nZXIgdGhhbiB0aGUgcXVlcnlcbiAgICAgICAgICAgIC8vIHBhdGggY2FuJ3QgYmUgbWF0Y2hlcy4gRm9yIGV4YW1wbGUsIGEgcXVlcnkgb24gJ3Jvb21zJyBjYW4ndCBtYXRjaFxuICAgICAgICAgICAgLy8gdGhlIGRvY3VtZW50IC9yb29tcy9hYmMvbWVzc2FnZXMveHl4LlxuICAgICAgICAgICAgLy8gVE9ETyhtY2cpOiB3ZSdsbCBuZWVkIGEgZGlmZmVyZW50IHNjYW5uZXIgd2hlbiB3ZSBpbXBsZW1lbnRcbiAgICAgICAgICAgIC8vIGFuY2VzdG9yIHF1ZXJpZXMuXG4gICAgICAgICAgICB0Lmxlbmd0aCA9PT0gciAmJiAobyA9IG8uYWRkKGUuWXIpKSwgITApO1xuICAgICAgICB9KSwgcyksIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMudGkobykpO1xuICAgIH1cbiAgICB0aShlKSB7XG4gICAgICAgIC8vIENvbnN0cnVjdCBhbiBhcnJheSBvZiBtYXRjaGluZyBiYXRjaGVzLCBzb3J0ZWQgYnkgYmF0Y2hJRCB0byBlbnN1cmUgdGhhdFxuICAgICAgICAvLyBtdWx0aXBsZSBtdXRhdGlvbnMgYWZmZWN0aW5nIHRoZSBzYW1lIGRvY3VtZW50IGtleSBhcmUgYXBwbGllZCBpbiBvcmRlci5cbiAgICAgICAgY29uc3QgdCA9IFtdO1xuICAgICAgICByZXR1cm4gZS5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLlhyKGUpO1xuICAgICAgICAgICAgbnVsbCAhPT0gbiAmJiB0LnB1c2gobik7XG4gICAgICAgIH0pKSwgdDtcbiAgICB9XG4gICAgcmVtb3ZlTXV0YXRpb25CYXRjaChlLCB0KSB7XG4gICAgICAgIF9fUFJJVkFURV9oYXJkQXNzZXJ0KDAgPT09IHRoaXMubmkodC5iYXRjaElkLCBcInJlbW92ZWRcIiksIDU1MDAzKSwgdGhpcy5tdXRhdGlvblF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgIGxldCBuID0gdGhpcy5acjtcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKHQubXV0YXRpb25zLCAociA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gbmV3IF9fUFJJVkFURV9Eb2NSZWZlcmVuY2Uoci5rZXksIHQuYmF0Y2hJZCk7XG4gICAgICAgICAgICByZXR1cm4gbiA9IG4uZGVsZXRlKGkpLCB0aGlzLnJlZmVyZW5jZURlbGVnYXRlLm1hcmtQb3RlbnRpYWxseU9ycGhhbmVkKGUsIHIua2V5KTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuWnIgPSBuO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGlyKGUpIHtcbiAgICAgICAgLy8gTm8tb3Agc2luY2UgdGhlIG1lbW9yeSBtdXRhdGlvbiBxdWV1ZSBkb2VzIG5vdCBtYWludGFpbiBhIHNlcGFyYXRlIGNhY2hlLlxuICAgIH1cbiAgICBjb250YWluc0tleShlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgX19QUklWQVRFX0RvY1JlZmVyZW5jZSh0LCAwKSwgciA9IHRoaXMuWnIuZmlyc3RBZnRlck9yRXF1YWwobik7XG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0LmlzRXF1YWwociAmJiByLmtleSkpO1xuICAgIH1cbiAgICBwZXJmb3JtQ29uc2lzdGVuY3lDaGVjayhlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoLCBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGaW5kcyB0aGUgaW5kZXggb2YgdGhlIGdpdmVuIGJhdGNoSWQgaW4gdGhlIG11dGF0aW9uIHF1ZXVlIGFuZCBhc3NlcnRzIHRoYXRcbiAgICAgKiB0aGUgcmVzdWx0aW5nIGluZGV4IGlzIHdpdGhpbiB0aGUgYm91bmRzIG9mIHRoZSBxdWV1ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBiYXRjaElkIC0gVGhlIGJhdGNoSWQgdG8gc2VhcmNoIGZvclxuICAgICAqIEBwYXJhbSBhY3Rpb24gLSBBIGRlc2NyaXB0aW9uIG9mIHdoYXQgdGhlIGNhbGxlciBpcyBkb2luZywgcGhyYXNlZCBpbiBwYXNzaXZlXG4gICAgICogZm9ybSAoZS5nLiBcImFja25vd2xlZGdlZFwiIGluIGEgcm91dGluZSB0aGF0IGFja25vd2xlZGdlcyBiYXRjaGVzKS5cbiAgICAgKi8gICAgbmkoZSwgdCkge1xuICAgICAgICByZXR1cm4gdGhpcy5laShlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRmluZHMgdGhlIGluZGV4IG9mIHRoZSBnaXZlbiBiYXRjaElkIGluIHRoZSBtdXRhdGlvbiBxdWV1ZS4gVGhpcyBvcGVyYXRpb25cbiAgICAgKiBpcyBPKDEpLlxuICAgICAqXG4gICAgICogQHJldHVybnMgVGhlIGNvbXB1dGVkIGluZGV4IG9mIHRoZSBiYXRjaCB3aXRoIHRoZSBnaXZlbiBiYXRjaElkLCBiYXNlZCBvblxuICAgICAqIHRoZSBzdGF0ZSBvZiB0aGUgcXVldWUuIE5vdGUgdGhpcyBpbmRleCBjYW4gYmUgbmVnYXRpdmUgaWYgdGhlIHJlcXVlc3RlZFxuICAgICAqIGJhdGNoSWQgaGFzIGFscmVhZHkgYmVlbiByZW1vdmVkIGZyb20gdGhlIHF1ZXVlIG9yIHBhc3QgdGhlIGVuZCBvZiB0aGVcbiAgICAgKiBxdWV1ZSBpZiB0aGUgYmF0Y2hJZCBpcyBsYXJnZXIgdGhhbiB0aGUgbGFzdCBhZGRlZCBiYXRjaC5cbiAgICAgKi8gICAgZWkoZSkge1xuICAgICAgICBpZiAoMCA9PT0gdGhpcy5tdXRhdGlvblF1ZXVlLmxlbmd0aCkgXG4gICAgICAgIC8vIEFzIGFuIGluZGV4IHRoaXMgaXMgcGFzdCB0aGUgZW5kIG9mIHRoZSBxdWV1ZVxuICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgLy8gRXhhbWluZSB0aGUgZnJvbnQgb2YgdGhlIHF1ZXVlIHRvIGZpZ3VyZSBvdXQgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGVcbiAgICAgICAgLy8gYmF0Y2hJZCBhbmQgaW5kZXhlcyBpbiB0aGUgYXJyYXkuIE5vdGUgdGhhdCBzaW5jZSB0aGUgcXVldWUgaXMgb3JkZXJlZFxuICAgICAgICAvLyBieSBiYXRjaElkLCBpZiB0aGUgZmlyc3QgYmF0Y2ggaGFzIGEgbGFyZ2VyIGJhdGNoSWQgdGhlbiB0aGUgcmVxdWVzdGVkXG4gICAgICAgIC8vIGJhdGNoSWQgZG9lc24ndCBleGlzdCBpbiB0aGUgcXVldWUuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGUgLSB0aGlzLm11dGF0aW9uUXVldWVbMF0uYmF0Y2hJZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQSB2ZXJzaW9uIG9mIGxvb2t1cE11dGF0aW9uQmF0Y2ggdGhhdCBkb2Vzbid0IHJldHVybiBhIHByb21pc2UsIHRoaXMgbWFrZXNcbiAgICAgKiBvdGhlciBmdW5jdGlvbnMgdGhhdCB1c2VzIHRoaXMgY29kZSBlYXNpZXIgdG8gcmVhZCBhbmQgbW9yZSBlZmZpY2llbnQuXG4gICAgICovICAgIFhyKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuZWkoZSk7XG4gICAgICAgIGlmICh0IDwgMCB8fCB0ID49IHRoaXMubXV0YXRpb25RdWV1ZS5sZW5ndGgpIHJldHVybiBudWxsO1xuICAgICAgICByZXR1cm4gdGhpcy5tdXRhdGlvblF1ZXVlW3RdO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVGhlIHNtYWxsZXN0IHZhbHVlIHJlcHJlc2VudGFibGUgYnkgYSA2NC1iaXQgc2lnbmVkIGludGVnZXIgKGxvbmcpLlxuICovXG4vKipcbiAqIFRoZSBtZW1vcnktb25seSBSZW1vdGVEb2N1bWVudENhY2hlIGZvciBJbmRleGVkRGIuIFRvIGNvbnN0cnVjdCwgaW52b2tlXG4gKiBgbmV3TWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZSgpYC5cbiAqL1xuY2xhc3MgX19QUklWQVRFX01lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGVJbXBsIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gc2l6ZXIgLSBVc2VkIHRvIGFzc2VzcyB0aGUgc2l6ZSBvZiBhIGRvY3VtZW50LiBGb3IgZWFnZXIgR0MsIHRoaXMgaXNcbiAgICAgKiBleHBlY3RlZCB0byBqdXN0IHJldHVybiAwIHRvIGF2b2lkIHVubmVjZXNzYXJpbHkgZG9pbmcgdGhlIHdvcmsgb2ZcbiAgICAgKiBjYWxjdWxhdGluZyB0aGUgc2l6ZS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHRoaXMucmkgPSBlLCBcbiAgICAgICAgLyoqIFVuZGVybHlpbmcgY2FjaGUgb2YgZG9jdW1lbnRzIGFuZCB0aGVpciByZWFkIHRpbWVzLiAqL1xuICAgICAgICB0aGlzLmRvY3MgPSBmdW5jdGlvbiBfX1BSSVZBVEVfZG9jdW1lbnRFbnRyeU1hcCgpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgU29ydGVkTWFwKERvY3VtZW50S2V5LmNvbXBhcmF0b3IpO1xuICAgICAgICB9KCksIFxuICAgICAgICAvKiogU2l6ZSBvZiBhbGwgY2FjaGVkIGRvY3VtZW50cy4gKi9cbiAgICAgICAgdGhpcy5zaXplID0gMDtcbiAgICB9XG4gICAgc2V0SW5kZXhNYW5hZ2VyKGUpIHtcbiAgICAgICAgdGhpcy5pbmRleE1hbmFnZXIgPSBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIHRoZSBzdXBwbGllZCBlbnRyeSB0byB0aGUgY2FjaGUgYW5kIHVwZGF0ZXMgdGhlIGNhY2hlIHNpemUgYXMgYXBwcm9wcmlhdGUuXG4gICAgICpcbiAgICAgKiBBbGwgY2FsbHMgb2YgYGFkZEVudHJ5YCAgYXJlIHJlcXVpcmVkIHRvIGdvIHRocm91Z2ggdGhlIFJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyXG4gICAgICogcmV0dXJuZWQgYnkgYG5ld0NoYW5nZUJ1ZmZlcigpYC5cbiAgICAgKi8gICAgYWRkRW50cnkoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gdC5rZXksIHIgPSB0aGlzLmRvY3MuZ2V0KG4pLCBpID0gciA/IHIuc2l6ZSA6IDAsIHMgPSB0aGlzLnJpKHQpO1xuICAgICAgICByZXR1cm4gdGhpcy5kb2NzID0gdGhpcy5kb2NzLmluc2VydChuLCB7XG4gICAgICAgICAgICBkb2N1bWVudDogdC5tdXRhYmxlQ29weSgpLFxuICAgICAgICAgICAgc2l6ZTogc1xuICAgICAgICB9KSwgdGhpcy5zaXplICs9IHMgLSBpLCB0aGlzLmluZGV4TWFuYWdlci5hZGRUb0NvbGxlY3Rpb25QYXJlbnRJbmRleChlLCBuLnBhdGgucG9wTGFzdCgpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyB0aGUgc3BlY2lmaWVkIGVudHJ5IGZyb20gdGhlIGNhY2hlIGFuZCB1cGRhdGVzIHRoZSBjYWNoZSBzaXplIGFzIGFwcHJvcHJpYXRlLlxuICAgICAqXG4gICAgICogQWxsIGNhbGxzIG9mIGByZW1vdmVFbnRyeWAgYXJlIHJlcXVpcmVkIHRvIGdvIHRocm91Z2ggdGhlIFJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyXG4gICAgICogcmV0dXJuZWQgYnkgYG5ld0NoYW5nZUJ1ZmZlcigpYC5cbiAgICAgKi8gICAgcmVtb3ZlRW50cnkoZSkge1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5kb2NzLmdldChlKTtcbiAgICAgICAgdCAmJiAodGhpcy5kb2NzID0gdGhpcy5kb2NzLnJlbW92ZShlKSwgdGhpcy5zaXplIC09IHQuc2l6ZSk7XG4gICAgfVxuICAgIGdldEVudHJ5KGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuZG9jcy5nZXQodCk7XG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShuID8gbi5kb2N1bWVudC5tdXRhYmxlQ29weSgpIDogTXV0YWJsZURvY3VtZW50Lm5ld0ludmFsaWREb2N1bWVudCh0KSk7XG4gICAgfVxuICAgIGdldEVudHJpZXMoZSwgdCkge1xuICAgICAgICBsZXQgbiA9IF9fUFJJVkFURV9tdXRhYmxlRG9jdW1lbnRNYXAoKTtcbiAgICAgICAgcmV0dXJuIHQuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5kb2NzLmdldChlKTtcbiAgICAgICAgICAgIG4gPSBuLmluc2VydChlLCB0ID8gdC5kb2N1bWVudC5tdXRhYmxlQ29weSgpIDogTXV0YWJsZURvY3VtZW50Lm5ld0ludmFsaWREb2N1bWVudChlKSk7XG4gICAgICAgIH0pKSwgUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUobik7XG4gICAgfVxuICAgIGdldERvY3VtZW50c01hdGNoaW5nUXVlcnkoZSwgdCwgbiwgcikge1xuICAgICAgICBsZXQgaSA9IF9fUFJJVkFURV9tdXRhYmxlRG9jdW1lbnRNYXAoKTtcbiAgICAgICAgLy8gRG9jdW1lbnRzIGFyZSBvcmRlcmVkIGJ5IGtleSwgc28gd2UgY2FuIHVzZSBhIHByZWZpeCBzY2FuIHRvIG5hcnJvdyBkb3duXG4gICAgICAgIC8vIHRoZSBkb2N1bWVudHMgd2UgbmVlZCB0byBtYXRjaCB0aGUgcXVlcnkgYWdhaW5zdC5cbiAgICAgICAgICAgICAgICBjb25zdCBzID0gdC5wYXRoLCBvID0gbmV3IERvY3VtZW50S2V5KHMuY2hpbGQoXCJfX2lkLTkyMjMzNzIwMzY4NTQ3NzU4MDhfX1wiKSksIF8gPSB0aGlzLmRvY3MuZ2V0SXRlcmF0b3JGcm9tKG8pO1xuICAgICAgICAvLyBEb2N1bWVudCBrZXlzIGFyZSBvcmRlcmVkIGZpcnN0IGJ5IG51bWVyaWMgdmFsdWUgKFwiX19pZDxMb25nPl9fXCIpLFxuICAgICAgICAvLyB0aGVuIGxleGljb2dyYXBoaWNhbGx5IGJ5IHN0cmluZyB2YWx1ZS4gU3RhcnQgdGhlIGl0ZXJhdG9yIGF0IHRoZSBtaW5pbXVtXG4gICAgICAgIC8vIHBvc3NpYmxlIERvY3VtZW50IGtleSB2YWx1ZS5cbiAgICAgICAgICAgICAgICBmb3IgKDtfLmhhc05leHQoKTsgKSB7XG4gICAgICAgICAgICBjb25zdCB7a2V5OiBlLCB2YWx1ZToge2RvY3VtZW50OiBvfX0gPSBfLmdldE5leHQoKTtcbiAgICAgICAgICAgIGlmICghcy5pc1ByZWZpeE9mKGUucGF0aCkpIGJyZWFrO1xuICAgICAgICAgICAgZS5wYXRoLmxlbmd0aCA+IHMubGVuZ3RoICsgMSB8fCAoX19QUklWQVRFX2luZGV4T2Zmc2V0Q29tcGFyYXRvcihfX1BSSVZBVEVfbmV3SW5kZXhPZmZzZXRGcm9tRG9jdW1lbnQobyksIG4pIDw9IDAgfHwgKHIuaGFzKG8ua2V5KSB8fCBfX1BSSVZBVEVfcXVlcnlNYXRjaGVzKHQsIG8pKSAmJiAoaSA9IGkuaW5zZXJ0KG8ua2V5LCBvLm11dGFibGVDb3B5KCkpKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKGkpO1xuICAgIH1cbiAgICBnZXRBbGxGcm9tQ29sbGVjdGlvbkdyb3VwKGUsIHQsIG4sIHIpIHtcbiAgICAgICAgLy8gVGhpcyBtZXRob2Qgc2hvdWxkIG9ubHkgYmUgY2FsbGVkIGZyb20gdGhlIEluZGV4QmFja2ZpbGxlciBpZiBwZXJzaXN0ZW5jZVxuICAgICAgICAvLyBpcyBlbmFibGVkLlxuICAgICAgICBmYWlsKDk1MDApO1xuICAgIH1cbiAgICBpaShlLCB0KSB7XG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaCh0aGlzLmRvY3MsIChlID0+IHQoZSkpKTtcbiAgICB9XG4gICAgbmV3Q2hhbmdlQnVmZmVyKGUpIHtcbiAgICAgICAgLy8gYHRyYWNrUmVtb3ZhbHNgIGlzIGlnbm9yZXMgc2luY2UgdGhlIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUga2VlcHNcbiAgICAgICAgLy8gYSBzZXBhcmF0ZSBjaGFuZ2Vsb2cgYW5kIGRvZXMgbm90IG5lZWQgc3BlY2lhbCBoYW5kbGluZyBmb3IgcmVtb3ZhbHMuXG4gICAgICAgIHJldHVybiBuZXcgX19QUklWQVRFX01lbW9yeVJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyKHRoaXMpO1xuICAgIH1cbiAgICBnZXRTaXplKGUpIHtcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMuc2l6ZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgbWVtb3J5LW9ubHkgUmVtb3RlRG9jdW1lbnRDYWNoZS5cbiAqXG4gKiBAcGFyYW0gc2l6ZXIgLSBVc2VkIHRvIGFzc2VzcyB0aGUgc2l6ZSBvZiBhIGRvY3VtZW50LiBGb3IgZWFnZXIgR0MsIHRoaXMgaXNcbiAqIGV4cGVjdGVkIHRvIGp1c3QgcmV0dXJuIDAgdG8gYXZvaWQgdW5uZWNlc3NhcmlseSBkb2luZyB0aGUgd29yayBvZlxuICogY2FsY3VsYXRpbmcgdGhlIHNpemUuXG4gKi9cbi8qKlxuICogSGFuZGxlcyB0aGUgZGV0YWlscyBvZiBhZGRpbmcgYW5kIHVwZGF0aW5nIGRvY3VtZW50cyBpbiB0aGUgTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZS5cbiAqL1xuY2xhc3MgX19QUklWQVRFX01lbW9yeVJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyIGV4dGVuZHMgUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIge1xuICAgIGNvbnN0cnVjdG9yKGUpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5OciA9IGU7XG4gICAgfVxuICAgIGFwcGx5Q2hhbmdlcyhlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hhbmdlcy5mb3JFYWNoKCgobiwgcikgPT4ge1xuICAgICAgICAgICAgci5pc1ZhbGlkRG9jdW1lbnQoKSA/IHQucHVzaCh0aGlzLk5yLmFkZEVudHJ5KGUsIHIpKSA6IHRoaXMuTnIucmVtb3ZlRW50cnkobik7XG4gICAgICAgIH0pKSwgUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IodCk7XG4gICAgfVxuICAgIGdldEZyb21DYWNoZShlLCB0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLk5yLmdldEVudHJ5KGUsIHQpO1xuICAgIH1cbiAgICBnZXRBbGxGcm9tQ2FjaGUoZSwgdCkge1xuICAgICAgICByZXR1cm4gdGhpcy5Oci5nZXRFbnRyaWVzKGUsIHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgX19QUklWQVRFX01lbW9yeVRhcmdldENhY2hlIHtcbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UgPSBlLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1hcHMgYSB0YXJnZXQgdG8gdGhlIGRhdGEgYWJvdXQgdGhhdCB0YXJnZXRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2kgPSBuZXcgT2JqZWN0TWFwKChlID0+IF9fUFJJVkFURV9jYW5vbmlmeVRhcmdldChlKSksIF9fUFJJVkFURV90YXJnZXRFcXVhbHMpLCBcbiAgICAgICAgLyoqIFRoZSBsYXN0IHJlY2VpdmVkIHNuYXBzaG90IHZlcnNpb24uICovXG4gICAgICAgIHRoaXMubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbiA9IFNuYXBzaG90VmVyc2lvbi5taW4oKSwgXG4gICAgICAgIC8qKiBUaGUgaGlnaGVzdCBudW1iZXJlZCB0YXJnZXQgSUQgZW5jb3VudGVyZWQuICovXG4gICAgICAgIHRoaXMuaGlnaGVzdFRhcmdldElkID0gMCwgXG4gICAgICAgIC8qKiBUaGUgaGlnaGVzdCBzZXF1ZW5jZSBudW1iZXIgZW5jb3VudGVyZWQuICovXG4gICAgICAgIHRoaXMub2kgPSAwLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgb3JkZXJlZCBiaWRpcmVjdGlvbmFsIG1hcHBpbmcgYmV0d2VlbiBkb2N1bWVudHMgYW5kIHRoZSByZW1vdGUgdGFyZ2V0XG4gICAgICAgICAqIElEcy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2kgPSBuZXcgX19QUklWQVRFX1JlZmVyZW5jZVNldCwgdGhpcy50YXJnZXRDb3VudCA9IDAsIHRoaXMuYWkgPSBfX1BSSVZBVEVfVGFyZ2V0SWRHZW5lcmF0b3IudXIoKTtcbiAgICB9XG4gICAgZm9yRWFjaFRhcmdldChlLCB0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNpLmZvckVhY2goKChlLCBuKSA9PiB0KG4pKSksIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24oZSkge1xuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy5sYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKTtcbiAgICB9XG4gICAgZ2V0SGlnaGVzdFNlcXVlbmNlTnVtYmVyKGUpIHtcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMub2kpO1xuICAgIH1cbiAgICBhbGxvY2F0ZVRhcmdldElkKGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGlnaGVzdFRhcmdldElkID0gdGhpcy5haS5uZXh0KCksIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMuaGlnaGVzdFRhcmdldElkKTtcbiAgICB9XG4gICAgc2V0VGFyZ2V0c01ldGFkYXRhKGUsIHQsIG4pIHtcbiAgICAgICAgcmV0dXJuIG4gJiYgKHRoaXMubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbiA9IG4pLCB0ID4gdGhpcy5vaSAmJiAodGhpcy5vaSA9IHQpLCBcbiAgICAgICAgUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgUHIoZSkge1xuICAgICAgICB0aGlzLnNpLnNldChlLnRhcmdldCwgZSk7XG4gICAgICAgIGNvbnN0IHQgPSBlLnRhcmdldElkO1xuICAgICAgICB0ID4gdGhpcy5oaWdoZXN0VGFyZ2V0SWQgJiYgKHRoaXMuYWkgPSBuZXcgX19QUklWQVRFX1RhcmdldElkR2VuZXJhdG9yKHQpLCB0aGlzLmhpZ2hlc3RUYXJnZXRJZCA9IHQpLCBcbiAgICAgICAgZS5zZXF1ZW5jZU51bWJlciA+IHRoaXMub2kgJiYgKHRoaXMub2kgPSBlLnNlcXVlbmNlTnVtYmVyKTtcbiAgICB9XG4gICAgYWRkVGFyZ2V0RGF0YShlLCB0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLlByKHQpLCB0aGlzLnRhcmdldENvdW50ICs9IDEsIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHVwZGF0ZVRhcmdldERhdGEoZSwgdCkge1xuICAgICAgICByZXR1cm4gdGhpcy5Qcih0KSwgUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgcmVtb3ZlVGFyZ2V0RGF0YShlLCB0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNpLmRlbGV0ZSh0LnRhcmdldCksIHRoaXMuX2kuanIodC50YXJnZXRJZCksIHRoaXMudGFyZ2V0Q291bnQgLT0gMSwgXG4gICAgICAgIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJlbW92ZVRhcmdldHMoZSwgdCwgbikge1xuICAgICAgICBsZXQgciA9IDA7XG4gICAgICAgIGNvbnN0IGkgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2kuZm9yRWFjaCgoKHMsIG8pID0+IHtcbiAgICAgICAgICAgIG8uc2VxdWVuY2VOdW1iZXIgPD0gdCAmJiBudWxsID09PSBuLmdldChvLnRhcmdldElkKSAmJiAodGhpcy5zaS5kZWxldGUocyksIGkucHVzaCh0aGlzLnJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkKGUsIG8udGFyZ2V0SWQpKSwgXG4gICAgICAgICAgICByKyspO1xuICAgICAgICB9KSksIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKGkpLm5leHQoKCgpID0+IHIpKTtcbiAgICB9XG4gICAgZ2V0VGFyZ2V0Q291bnQoZSkge1xuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy50YXJnZXRDb3VudCk7XG4gICAgfVxuICAgIGdldFRhcmdldERhdGEoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gdGhpcy5zaS5nZXQodCkgfHwgbnVsbDtcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKG4pO1xuICAgIH1cbiAgICBhZGRNYXRjaGluZ0tleXMoZSwgdCwgbikge1xuICAgICAgICByZXR1cm4gdGhpcy5faS5Xcih0LCBuKSwgUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgcmVtb3ZlTWF0Y2hpbmdLZXlzKGUsIHQsIG4pIHtcbiAgICAgICAgdGhpcy5faS56cih0LCBuKTtcbiAgICAgICAgY29uc3QgciA9IHRoaXMucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUsIGkgPSBbXTtcbiAgICAgICAgcmV0dXJuIHIgJiYgdC5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIGkucHVzaChyLm1hcmtQb3RlbnRpYWxseU9ycGhhbmVkKGUsIHQpKTtcbiAgICAgICAgfSkpLCBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihpKTtcbiAgICB9XG4gICAgcmVtb3ZlTWF0Y2hpbmdLZXlzRm9yVGFyZ2V0SWQoZSwgdCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faS5qcih0KSwgUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgZ2V0TWF0Y2hpbmdLZXlzRm9yVGFyZ2V0SWQoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gdGhpcy5faS5Icih0KTtcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKG4pO1xuICAgIH1cbiAgICBjb250YWluc0tleShlLCB0KSB7XG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0aGlzLl9pLmNvbnRhaW5zS2V5KHQpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgbWVtb3J5LWJhY2tlZCBpbnN0YW5jZSBvZiBQZXJzaXN0ZW5jZS4gRGF0YSBpcyBzdG9yZWQgb25seSBpbiBSQU0gYW5kXG4gKiBub3QgcGVyc2lzdGVkIGFjcm9zcyBzZXNzaW9ucy5cbiAqL1xuY2xhc3MgX19QUklWQVRFX01lbW9yeVBlcnNpc3RlbmNlIHtcbiAgICAvKipcbiAgICAgKiBUaGUgY29uc3RydWN0b3IgYWNjZXB0cyBhIGZhY3RvcnkgZm9yIGNyZWF0aW5nIGEgcmVmZXJlbmNlIGRlbGVnYXRlLiBUaGlzXG4gICAgICogYWxsb3dzIGJvdGggdGhlIGRlbGVnYXRlIGFuZCB0aGlzIGluc3RhbmNlIHRvIGhhdmUgc3Ryb25nIHJlZmVyZW5jZXMgdG9cbiAgICAgKiBlYWNoIG90aGVyIHdpdGhvdXQgaGF2aW5nIG51bGxhYmxlIGZpZWxkcyB0aGF0IHdvdWxkIHRoZW4gbmVlZCB0byBiZVxuICAgICAqIGNoZWNrZWQgb3IgYXNzZXJ0ZWQgb24gZXZlcnkgYWNjZXNzLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGUsIHQpIHtcbiAgICAgICAgdGhpcy51aSA9IHt9LCB0aGlzLm92ZXJsYXlzID0ge30sIHRoaXMuY2kgPSBuZXcgX19QUklWQVRFX0xpc3RlblNlcXVlbmNlKDApLCB0aGlzLmxpID0gITEsIFxuICAgICAgICB0aGlzLmxpID0gITAsIHRoaXMuaGkgPSBuZXcgX19QUklWQVRFX01lbW9yeUdsb2JhbHNDYWNoZSwgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSA9IGUodGhpcyksIFxuICAgICAgICB0aGlzLlBpID0gbmV3IF9fUFJJVkFURV9NZW1vcnlUYXJnZXRDYWNoZSh0aGlzKTtcbiAgICAgICAgdGhpcy5pbmRleE1hbmFnZXIgPSBuZXcgX19QUklWQVRFX01lbW9yeUluZGV4TWFuYWdlciwgdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlID0gZnVuY3Rpb24gX19QUklWQVRFX25ld01lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUoZSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZUltcGwoZSk7XG4gICAgICAgIH0oKGUgPT4gdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZS5UaShlKSkpLCB0aGlzLnNlcmlhbGl6ZXIgPSBuZXcgX19QUklWQVRFX0xvY2FsU2VyaWFsaXplcih0KSwgXG4gICAgICAgIHRoaXMuSWkgPSBuZXcgX19QUklWQVRFX01lbW9yeUJ1bmRsZUNhY2hlKHRoaXMuc2VyaWFsaXplcik7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHNodXRkb3duKCkge1xuICAgICAgICAvLyBObyBkdXJhYmxlIHN0YXRlIHRvIGVuc3VyZSBpcyBjbG9zZWQgb24gc2h1dGRvd24uXG4gICAgICAgIHJldHVybiB0aGlzLmxpID0gITEsIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBnZXQgc3RhcnRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGk7XG4gICAgfVxuICAgIHNldERhdGFiYXNlRGVsZXRlZExpc3RlbmVyKCkge1xuICAgICAgICAvLyBObyBvcC5cbiAgICB9XG4gICAgc2V0TmV0d29ya0VuYWJsZWQoKSB7XG4gICAgICAgIC8vIE5vIG9wLlxuICAgIH1cbiAgICBnZXRJbmRleE1hbmFnZXIoZSkge1xuICAgICAgICAvLyBXZSBkbyBub3QgY3VycmVudGx5IHN1cHBvcnQgaW5kaWNlcyBmb3IgbWVtb3J5IHBlcnNpc3RlbmNlLCBzbyB3ZSBjYW5cbiAgICAgICAgLy8gcmV0dXJuIHRoZSBzYW1lIHNoYXJlZCBpbnN0YW5jZSBvZiB0aGUgbWVtb3J5IGluZGV4IG1hbmFnZXIuXG4gICAgICAgIHJldHVybiB0aGlzLmluZGV4TWFuYWdlcjtcbiAgICB9XG4gICAgZ2V0RG9jdW1lbnRPdmVybGF5Q2FjaGUoZSkge1xuICAgICAgICBsZXQgdCA9IHRoaXMub3ZlcmxheXNbZS50b0tleSgpXTtcbiAgICAgICAgcmV0dXJuIHQgfHwgKHQgPSBuZXcgX19QUklWQVRFX01lbW9yeURvY3VtZW50T3ZlcmxheUNhY2hlLCB0aGlzLm92ZXJsYXlzW2UudG9LZXkoKV0gPSB0KSwgXG4gICAgICAgIHQ7XG4gICAgfVxuICAgIGdldE11dGF0aW9uUXVldWUoZSwgdCkge1xuICAgICAgICBsZXQgbiA9IHRoaXMudWlbZS50b0tleSgpXTtcbiAgICAgICAgcmV0dXJuIG4gfHwgKG4gPSBuZXcgX19QUklWQVRFX01lbW9yeU11dGF0aW9uUXVldWUodCwgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSksIHRoaXMudWlbZS50b0tleSgpXSA9IG4pLCBcbiAgICAgICAgbjtcbiAgICB9XG4gICAgZ2V0R2xvYmFsc0NhY2hlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oaTtcbiAgICB9XG4gICAgZ2V0VGFyZ2V0Q2FjaGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlBpO1xuICAgIH1cbiAgICBnZXRSZW1vdGVEb2N1bWVudENhY2hlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlO1xuICAgIH1cbiAgICBnZXRCdW5kbGVDYWNoZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSWk7XG4gICAgfVxuICAgIHJ1blRyYW5zYWN0aW9uKGUsIHQsIG4pIHtcbiAgICAgICAgX19QUklWQVRFX2xvZ0RlYnVnKFwiTWVtb3J5UGVyc2lzdGVuY2VcIiwgXCJTdGFydGluZyB0cmFuc2FjdGlvbjpcIiwgZSk7XG4gICAgICAgIGNvbnN0IHIgPSBuZXcgX19QUklWQVRFX01lbW9yeVRyYW5zYWN0aW9uKHRoaXMuY2kubmV4dCgpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUuRWkoKSwgbihyKS5uZXh0KChlID0+IHRoaXMucmVmZXJlbmNlRGVsZWdhdGUuZGkocikubmV4dCgoKCkgPT4gZSkpKSkudG9Qcm9taXNlKCkudGhlbigoZSA9PiAoci5yYWlzZU9uQ29tbWl0dGVkRXZlbnQoKSwgXG4gICAgICAgIGUpKSk7XG4gICAgfVxuICAgIEFpKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5vcihPYmplY3QudmFsdWVzKHRoaXMudWkpLm1hcCgobiA9PiAoKSA9PiBuLmNvbnRhaW5zS2V5KGUsIHQpKSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBNZW1vcnkgcGVyc2lzdGVuY2UgaXMgbm90IGFjdHVhbGx5IHRyYW5zYWN0aW9uYWwsIGJ1dCBmdXR1cmUgaW1wbGVtZW50YXRpb25zXG4gKiBtYXkgaGF2ZSB0cmFuc2FjdGlvbi1zY29wZWQgc3RhdGUuXG4gKi8gY2xhc3MgX19QUklWQVRFX01lbW9yeVRyYW5zYWN0aW9uIGV4dGVuZHMgUGVyc2lzdGVuY2VUcmFuc2FjdGlvbiB7XG4gICAgY29uc3RydWN0b3IoZSkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmN1cnJlbnRTZXF1ZW5jZU51bWJlciA9IGU7XG4gICAgfVxufVxuXG5jbGFzcyBfX1BSSVZBVEVfTWVtb3J5RWFnZXJEZWxlZ2F0ZSB7XG4gICAgY29uc3RydWN0b3IoZSkge1xuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gZSwgXG4gICAgICAgIC8qKiBUcmFja3MgYWxsIGRvY3VtZW50cyB0aGF0IGFyZSBhY3RpdmUgaW4gUXVlcnkgdmlld3MuICovXG4gICAgICAgIHRoaXMuUmkgPSBuZXcgX19QUklWQVRFX1JlZmVyZW5jZVNldCwgXG4gICAgICAgIC8qKiBUaGUgbGlzdCBvZiBkb2N1bWVudHMgdGhhdCBhcmUgcG90ZW50aWFsbHkgR0NlZCBhZnRlciBlYWNoIHRyYW5zYWN0aW9uLiAqL1xuICAgICAgICB0aGlzLlZpID0gbnVsbDtcbiAgICB9XG4gICAgc3RhdGljIG1pKGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfTWVtb3J5RWFnZXJEZWxlZ2F0ZShlKTtcbiAgICB9XG4gICAgZ2V0IGZpKCkge1xuICAgICAgICBpZiAodGhpcy5WaSkgcmV0dXJuIHRoaXMuVmk7XG4gICAgICAgIHRocm93IGZhaWwoNjA5OTYpO1xuICAgIH1cbiAgICBhZGRSZWZlcmVuY2UoZSwgdCwgbikge1xuICAgICAgICByZXR1cm4gdGhpcy5SaS5hZGRSZWZlcmVuY2UobiwgdCksIHRoaXMuZmkuZGVsZXRlKG4udG9TdHJpbmcoKSksIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJlbW92ZVJlZmVyZW5jZShlLCB0LCBuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlJpLnJlbW92ZVJlZmVyZW5jZShuLCB0KSwgdGhpcy5maS5hZGQobi50b1N0cmluZygpKSwgUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgbWFya1BvdGVudGlhbGx5T3JwaGFuZWQoZSwgdCkge1xuICAgICAgICByZXR1cm4gdGhpcy5maS5hZGQodC50b1N0cmluZygpKSwgUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgcmVtb3ZlVGFyZ2V0KGUsIHQpIHtcbiAgICAgICAgdGhpcy5SaS5qcih0LnRhcmdldElkKS5mb3JFYWNoKChlID0+IHRoaXMuZmkuYWRkKGUudG9TdHJpbmcoKSkpKTtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMucGVyc2lzdGVuY2UuZ2V0VGFyZ2V0Q2FjaGUoKTtcbiAgICAgICAgcmV0dXJuIG4uZ2V0TWF0Y2hpbmdLZXlzRm9yVGFyZ2V0SWQoZSwgdC50YXJnZXRJZCkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICBlLmZvckVhY2goKGUgPT4gdGhpcy5maS5hZGQoZS50b1N0cmluZygpKSkpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gbi5yZW1vdmVUYXJnZXREYXRhKGUsIHQpKSk7XG4gICAgfVxuICAgIEVpKCkge1xuICAgICAgICB0aGlzLlZpID0gbmV3IFNldDtcbiAgICB9XG4gICAgZGkoZSkge1xuICAgICAgICAvLyBSZW1vdmUgbmV3bHkgb3JwaGFuZWQgZG9jdW1lbnRzLlxuICAgICAgICBjb25zdCB0ID0gdGhpcy5wZXJzaXN0ZW5jZS5nZXRSZW1vdGVEb2N1bWVudENhY2hlKCkubmV3Q2hhbmdlQnVmZmVyKCk7XG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaCh0aGlzLmZpLCAobiA9PiB7XG4gICAgICAgICAgICBjb25zdCByID0gRG9jdW1lbnRLZXkuZnJvbVBhdGgobik7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5naShlLCByKS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgICAgICBlIHx8IHQucmVtb3ZlRW50cnkociwgU25hcHNob3RWZXJzaW9uLm1pbigpKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+ICh0aGlzLlZpID0gbnVsbCwgdC5hcHBseShlKSkpKTtcbiAgICB9XG4gICAgdXBkYXRlTGltYm9Eb2N1bWVudChlLCB0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdpKGUsIHQpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgZSA/IHRoaXMuZmkuZGVsZXRlKHQudG9TdHJpbmcoKSkgOiB0aGlzLmZpLmFkZCh0LnRvU3RyaW5nKCkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIFRpKGUpIHtcbiAgICAgICAgLy8gRm9yIGVhZ2VyIEdDLCB3ZSBkb24ndCBjYXJlIGFib3V0IHRoZSBkb2N1bWVudCBzaXplLCB0aGVyZSBhcmUgbm8gc2l6ZSB0aHJlc2hvbGRzLlxuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgZ2koZSwgdCkge1xuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLm9yKFsgKCkgPT4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy5SaS5jb250YWluc0tleSh0KSksICgpID0+IHRoaXMucGVyc2lzdGVuY2UuZ2V0VGFyZ2V0Q2FjaGUoKS5jb250YWluc0tleShlLCB0KSwgKCkgPT4gdGhpcy5wZXJzaXN0ZW5jZS5BaShlLCB0KSBdKTtcbiAgICB9XG59XG5cbmNsYXNzIF9fUFJJVkFURV9NZW1vcnlMcnVEZWxlZ2F0ZSB7XG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gZSwgdGhpcy5waSA9IG5ldyBPYmplY3RNYXAoKGUgPT4gX19QUklWQVRFX2VuY29kZVJlc291cmNlUGF0aChlLnBhdGgpKSwgKChlLCB0KSA9PiBlLmlzRXF1YWwodCkpKSwgXG4gICAgICAgIHRoaXMuZ2FyYmFnZUNvbGxlY3RvciA9IF9fUFJJVkFURV9uZXdMcnVHYXJiYWdlQ29sbGVjdG9yKHRoaXMsIHQpO1xuICAgIH1cbiAgICBzdGF0aWMgbWkoZSwgdCkge1xuICAgICAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9NZW1vcnlMcnVEZWxlZ2F0ZShlLCB0KTtcbiAgICB9XG4gICAgLy8gTm8tb3BzLCBwcmVzZW50IHNvIG1lbW9yeSBwZXJzaXN0ZW5jZSBkb2Vzbid0IGhhdmUgdG8gY2FyZSB3aGljaCBkZWxlZ2F0ZVxuICAgIC8vIGl0IGhhcy5cbiAgICBFaSgpIHt9XG4gICAgZGkoZSkge1xuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgZm9yRWFjaFRhcmdldChlLCB0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLmdldFRhcmdldENhY2hlKCkuZm9yRWFjaFRhcmdldChlLCB0KTtcbiAgICB9XG4gICAgZ3IoZSkge1xuICAgICAgICBjb25zdCB0ID0gdGhpcy53cihlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UuZ2V0VGFyZ2V0Q2FjaGUoKS5nZXRUYXJnZXRDb3VudChlKS5uZXh0KChlID0+IHQubmV4dCgodCA9PiBlICsgdCkpKSk7XG4gICAgfVxuICAgIHdyKGUpIHtcbiAgICAgICAgbGV0IHQgPSAwO1xuICAgICAgICByZXR1cm4gdGhpcy5wcihlLCAoZSA9PiB7XG4gICAgICAgICAgICB0Kys7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiB0KSk7XG4gICAgfVxuICAgIHByKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKHRoaXMucGksICgobiwgcikgPT4gdGhpcy5icihlLCBuLCByKS5uZXh0KChlID0+IGUgPyBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpIDogdChyKSkpKSk7XG4gICAgfVxuICAgIHJlbW92ZVRhcmdldHMoZSwgdCwgbikge1xuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5nZXRUYXJnZXRDYWNoZSgpLnJlbW92ZVRhcmdldHMoZSwgdCwgbik7XG4gICAgfVxuICAgIHJlbW92ZU9ycGhhbmVkRG9jdW1lbnRzKGUsIHQpIHtcbiAgICAgICAgbGV0IG4gPSAwO1xuICAgICAgICBjb25zdCByID0gdGhpcy5wZXJzaXN0ZW5jZS5nZXRSZW1vdGVEb2N1bWVudENhY2hlKCksIGkgPSByLm5ld0NoYW5nZUJ1ZmZlcigpO1xuICAgICAgICByZXR1cm4gci5paShlLCAociA9PiB0aGlzLmJyKGUsIHIsIHQpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgZSB8fCAobisrLCBpLnJlbW92ZUVudHJ5KHIsIFNuYXBzaG90VmVyc2lvbi5taW4oKSkpO1xuICAgICAgICB9KSkpKS5uZXh0KCgoKSA9PiBpLmFwcGx5KGUpKSkubmV4dCgoKCkgPT4gbikpO1xuICAgIH1cbiAgICBtYXJrUG90ZW50aWFsbHlPcnBoYW5lZChlLCB0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBpLnNldCh0LCBlLmN1cnJlbnRTZXF1ZW5jZU51bWJlciksIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJlbW92ZVRhcmdldChlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSB0LndpdGhTZXF1ZW5jZU51bWJlcihlLmN1cnJlbnRTZXF1ZW5jZU51bWJlcik7XG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLmdldFRhcmdldENhY2hlKCkudXBkYXRlVGFyZ2V0RGF0YShlLCBuKTtcbiAgICB9XG4gICAgYWRkUmVmZXJlbmNlKGUsIHQsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGkuc2V0KG4sIGUuY3VycmVudFNlcXVlbmNlTnVtYmVyKSwgUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgcmVtb3ZlUmVmZXJlbmNlKGUsIHQsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGkuc2V0KG4sIGUuY3VycmVudFNlcXVlbmNlTnVtYmVyKSwgUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgdXBkYXRlTGltYm9Eb2N1bWVudChlLCB0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBpLnNldCh0LCBlLmN1cnJlbnRTZXF1ZW5jZU51bWJlciksIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIFRpKGUpIHtcbiAgICAgICAgbGV0IHQgPSBlLmtleS50b1N0cmluZygpLmxlbmd0aDtcbiAgICAgICAgcmV0dXJuIGUuaXNGb3VuZERvY3VtZW50KCkgJiYgKHQgKz0gX19QUklWQVRFX2VzdGltYXRlQnl0ZVNpemUoZS5kYXRhLnZhbHVlKSksIHQ7XG4gICAgfVxuICAgIGJyKGUsIHQsIG4pIHtcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5vcihbICgpID0+IHRoaXMucGVyc2lzdGVuY2UuQWkoZSwgdCksICgpID0+IHRoaXMucGVyc2lzdGVuY2UuZ2V0VGFyZ2V0Q2FjaGUoKS5jb250YWluc0tleShlLCB0KSwgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMucGkuZ2V0KHQpO1xuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHZvaWQgMCAhPT0gZSAmJiBlID4gbik7XG4gICAgICAgIH0gXSk7XG4gICAgfVxuICAgIGdldENhY2hlU2l6ZShlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLmdldFJlbW90ZURvY3VtZW50Q2FjaGUoKS5nZXRTaXplKGUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBQZXJmb3JtcyBkYXRhYmFzZSBjcmVhdGlvbiBhbmQgc2NoZW1hIHVwZ3JhZGVzLiAqLyBjbGFzcyBfX1BSSVZBVEVfU2NoZW1hQ29udmVydGVyIHtcbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHRoaXMuc2VyaWFsaXplciA9IGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBlcmZvcm1zIGRhdGFiYXNlIGNyZWF0aW9uIGFuZCBzY2hlbWEgdXBncmFkZXMuXG4gICAgICpcbiAgICAgKiBOb3RlIHRoYXQgaW4gcHJvZHVjdGlvbiwgdGhpcyBtZXRob2QgaXMgb25seSBldmVyIHVzZWQgdG8gdXBncmFkZSB0aGUgc2NoZW1hXG4gICAgICogdG8gU0NIRU1BX1ZFUlNJT04uIERpZmZlcmVudCB2YWx1ZXMgb2YgdG9WZXJzaW9uIGFyZSBvbmx5IHVzZWQgZm9yIHRlc3RpbmdcbiAgICAgKiBhbmQgbG9jYWwgZmVhdHVyZSBkZXZlbG9wbWVudC5cbiAgICAgKi8gICAgayhlLCB0LCBuLCByKSB7XG4gICAgICAgIGNvbnN0IGkgPSBuZXcgX19QUklWQVRFX1NpbXBsZURiVHJhbnNhY3Rpb24oXCJjcmVhdGVPclVwZ3JhZGVcIiwgdCk7XG4gICAgICAgIG4gPCAxICYmIHIgPj0gMSAmJiAoIWZ1bmN0aW9uIF9fUFJJVkFURV9jcmVhdGVQcmltYXJ5Q2xpZW50U3RvcmUoZSkge1xuICAgICAgICAgICAgZS5jcmVhdGVPYmplY3RTdG9yZShZKTtcbiAgICAgICAgfShlKSwgZnVuY3Rpb24gX19QUklWQVRFX2NyZWF0ZU11dGF0aW9uUXVldWUoZSkge1xuICAgICAgICAgICAgZS5jcmVhdGVPYmplY3RTdG9yZShYLCB7XG4gICAgICAgICAgICAgICAga2V5UGF0aDogZWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3QgdCA9IGUuY3JlYXRlT2JqZWN0U3RvcmUodGUsIHtcbiAgICAgICAgICAgICAgICBrZXlQYXRoOiBuZSxcbiAgICAgICAgICAgICAgICBhdXRvSW5jcmVtZW50OiAhMFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0LmNyZWF0ZUluZGV4KHJlLCBpZSwge1xuICAgICAgICAgICAgICAgIHVuaXF1ZTogITBcbiAgICAgICAgICAgIH0pLCBlLmNyZWF0ZU9iamVjdFN0b3JlKG9lKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIFVwZ3JhZGUgZnVuY3Rpb24gdG8gbWlncmF0ZSB0aGUgJ211dGF0aW9ucycgc3RvcmUgZnJvbSBWMSB0byBWMy4gTG9hZHNcbiAqIGFuZCByZXdyaXRlcyBhbGwgZGF0YS5cbiAqLyAoZSksIF9fUFJJVkFURV9jcmVhdGVRdWVyeUNhY2hlKGUpLCBmdW5jdGlvbiBfX1BSSVZBVEVfY3JlYXRlTGVnYWN5UmVtb3RlRG9jdW1lbnRDYWNoZShlKSB7XG4gICAgICAgICAgICBlLmNyZWF0ZU9iamVjdFN0b3JlKEgpO1xuICAgICAgICB9KGUpKTtcbiAgICAgICAgLy8gTWlncmF0aW9uIDIgdG8gcG9wdWxhdGUgdGhlIHRhcmdldEdsb2JhbCBvYmplY3Qgbm8gbG9uZ2VyIG5lZWRlZCBzaW5jZVxuICAgICAgICAvLyBtaWdyYXRpb24gMyB1bmNvbmRpdGlvbmFsbHkgY2xlYXJzIGl0LlxuICAgICAgICAgICAgICAgIGxldCBzID0gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgcmV0dXJuIG4gPCAzICYmIHIgPj0gMyAmJiAoXG4gICAgICAgIC8vIEJyYW5kIG5ldyBjbGllbnRzIGRvbid0IG5lZWQgdG8gZHJvcCBhbmQgcmVjcmVhdGUtLW9ubHkgY2xpZW50cyB0aGF0XG4gICAgICAgIC8vIHBvdGVudGlhbGx5IGhhdmUgY29ycnVwdCBkYXRhLlxuICAgICAgICAwICE9PSBuICYmICghZnVuY3Rpb24gX19QUklWQVRFX2Ryb3BRdWVyeUNhY2hlKGUpIHtcbiAgICAgICAgICAgIGUuZGVsZXRlT2JqZWN0U3RvcmUoQWUpLCBlLmRlbGV0ZU9iamVjdFN0b3JlKEllKSwgZS5kZWxldGVPYmplY3RTdG9yZShnZSk7XG4gICAgICAgIH0oZSksIF9fUFJJVkFURV9jcmVhdGVRdWVyeUNhY2hlKGUpKSwgcyA9IHMubmV4dCgoKCkgPT4gXG4gICAgICAgIC8qKlxuICogQ3JlYXRlcyB0aGUgdGFyZ2V0IGdsb2JhbCBzaW5nbGV0b24gcm93LlxuICpcbiAqIEBwYXJhbSB0eG4gLSBUaGUgdmVyc2lvbiB1cGdyYWRlIHRyYW5zYWN0aW9uIGZvciBpbmRleGVkZGJcbiAqL1xuICAgICAgICBmdW5jdGlvbiBfX1BSSVZBVEVfd3JpdGVFbXB0eVRhcmdldEdsb2JhbEVudHJ5KGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBlLnN0b3JlKGdlKSwgbiA9IHtcbiAgICAgICAgICAgICAgICBoaWdoZXN0VGFyZ2V0SWQ6IDAsXG4gICAgICAgICAgICAgICAgaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyOiAwLFxuICAgICAgICAgICAgICAgIGxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb246IFNuYXBzaG90VmVyc2lvbi5taW4oKS50b1RpbWVzdGFtcCgpLFxuICAgICAgICAgICAgICAgIHRhcmdldENvdW50OiAwXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIHQucHV0KGZlLCBuKTtcbiAgICAgICAgfShpKSkpKSwgbiA8IDQgJiYgciA+PSA0ICYmICgwICE9PSBuICYmIChcbiAgICAgICAgLy8gU2NoZW1hIHZlcnNpb24gMyB1c2VzIGF1dG8tZ2VuZXJhdGVkIGtleXMgdG8gZ2VuZXJhdGUgZ2xvYmFsbHkgdW5pcXVlXG4gICAgICAgIC8vIG11dGF0aW9uIGJhdGNoIElEcyAodGhpcyB3YXMgcHJldmlvdXNseSBlbnN1cmVkIGludGVybmFsbHkgYnkgdGhlXG4gICAgICAgIC8vIGNsaWVudCkuIFRvIG1pZ3JhdGUgdG8gdGhlIG5ldyBzY2hlbWEsIHdlIGhhdmUgdG8gcmVhZCBhbGwgbXV0YXRpb25zXG4gICAgICAgIC8vIGFuZCB3cml0ZSB0aGVtIGJhY2sgb3V0LiBXZSBwcmVzZXJ2ZSB0aGUgZXhpc3RpbmcgYmF0Y2ggSURzIHRvIGd1YXJhbnRlZVxuICAgICAgICAvLyBjb25zaXN0ZW5jeSB3aXRoIG90aGVyIG9iamVjdCBzdG9yZXMuIEFueSBmdXJ0aGVyIG11dGF0aW9uIGJhdGNoIElEcyB3aWxsXG4gICAgICAgIC8vIGJlIGF1dG8tZ2VuZXJhdGVkLlxuICAgICAgICBzID0gcy5uZXh0KCgoKSA9PiBmdW5jdGlvbiBfX1BSSVZBVEVfdXBncmFkZU11dGF0aW9uQmF0Y2hTY2hlbWFBbmRNaWdyYXRlRGF0YShlLCB0KSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdC5zdG9yZSh0ZSk7XG4gICAgICAgICAgICByZXR1cm4gbi5KKCkubmV4dCgobiA9PiB7XG4gICAgICAgICAgICAgICAgZS5kZWxldGVPYmplY3RTdG9yZSh0ZSk7XG4gICAgICAgICAgICAgICAgZS5jcmVhdGVPYmplY3RTdG9yZSh0ZSwge1xuICAgICAgICAgICAgICAgICAgICBrZXlQYXRoOiBuZSxcbiAgICAgICAgICAgICAgICAgICAgYXV0b0luY3JlbWVudDogITBcbiAgICAgICAgICAgICAgICB9KS5jcmVhdGVJbmRleChyZSwgaWUsIHtcbiAgICAgICAgICAgICAgICAgICAgdW5pcXVlOiAhMFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSB0LnN0b3JlKHRlKSwgaSA9IG4ubWFwKChlID0+IHIucHV0KGUpKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKGkpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KGUsIGkpKSkpLCBzID0gcy5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICAhZnVuY3Rpb24gX19QUklWQVRFX2NyZWF0ZUNsaWVudE1ldGFkYXRhU3RvcmUoZSkge1xuICAgICAgICAgICAgICAgIGUuY3JlYXRlT2JqZWN0U3RvcmUod2UsIHtcbiAgICAgICAgICAgICAgICAgICAga2V5UGF0aDogU2VcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0oZSk7XG4gICAgICAgIH0pKSksIG4gPCA1ICYmIHIgPj0gNSAmJiAocyA9IHMubmV4dCgoKCkgPT4gdGhpcy55aShpKSkpKSwgbiA8IDYgJiYgciA+PSA2ICYmIChzID0gcy5uZXh0KCgoKSA9PiAoZnVuY3Rpb24gX19QUklWQVRFX2NyZWF0ZURvY3VtZW50R2xvYmFsU3RvcmUoZSkge1xuICAgICAgICAgICAgZS5jcmVhdGVPYmplY3RTdG9yZShQZSk7XG4gICAgICAgIH0oZSksIHRoaXMud2koaSkpKSkpLCBuIDwgNyAmJiByID49IDcgJiYgKHMgPSBzLm5leHQoKCgpID0+IHRoaXMuU2koaSkpKSksIG4gPCA4ICYmIHIgPj0gOCAmJiAocyA9IHMubmV4dCgoKCkgPT4gdGhpcy5iaShlLCBpKSkpKSwgXG4gICAgICAgIG4gPCA5ICYmIHIgPj0gOSAmJiAocyA9IHMubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgLy8gTXVsdGktVGFiIHVzZWQgdG8gbWFuYWdlIGl0cyBvd24gY2hhbmdlbG9nLCBidXQgdGhpcyBoYXMgYmVlbiBtb3ZlZFxuICAgICAgICAgICAgLy8gdG8gdGhlIERiUmVtb3RlRG9jdW1lbnQgb2JqZWN0IHN0b3JlIGl0c2VsZi4gU2luY2UgdGhlIHByZXZpb3VzIGNoYW5nZVxuICAgICAgICAgICAgLy8gbG9nIG9ubHkgY29udGFpbmVkIHRyYW5zaWVudCBkYXRhLCB3ZSBjYW4gZHJvcCBpdHMgb2JqZWN0IHN0b3JlLlxuICAgICAgICAgICAgIWZ1bmN0aW9uIF9fUFJJVkFURV9kcm9wUmVtb3RlRG9jdW1lbnRDaGFuZ2VzU3RvcmUoZSkge1xuICAgICAgICAgICAgICAgIGUub2JqZWN0U3RvcmVOYW1lcy5jb250YWlucyhcInJlbW90ZURvY3VtZW50Q2hhbmdlc1wiKSAmJiBlLmRlbGV0ZU9iamVjdFN0b3JlKFwicmVtb3RlRG9jdW1lbnRDaGFuZ2VzXCIpO1xuICAgICAgICAgICAgfShlKTtcbiAgICAgICAgICAgIC8vIE5vdGU6IFNjaGVtYSB2ZXJzaW9uIDkgdXNlZCB0byBjcmVhdGUgYSByZWFkIHRpbWUgaW5kZXggZm9yIHRoZVxuICAgICAgICAgICAgLy8gUmVtb3RlRG9jdW1lbnRDYWNoZS4gVGhpcyBpcyBub3cgZG9uZSB3aXRoIHNjaGVtYSB2ZXJzaW9uIDEzLlxuICAgICAgICAgICAgICAgIH0pKSksIG4gPCAxMCAmJiByID49IDEwICYmIChzID0gcy5uZXh0KCgoKSA9PiB0aGlzLkRpKGkpKSkpLCBuIDwgMTEgJiYgciA+PSAxMSAmJiAocyA9IHMubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgIWZ1bmN0aW9uIF9fUFJJVkFURV9jcmVhdGVCdW5kbGVzU3RvcmUoZSkge1xuICAgICAgICAgICAgICAgIGUuY3JlYXRlT2JqZWN0U3RvcmUoYmUsIHtcbiAgICAgICAgICAgICAgICAgICAga2V5UGF0aDogRGVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0oZSksIGZ1bmN0aW9uIF9fUFJJVkFURV9jcmVhdGVOYW1lZFF1ZXJpZXNTdG9yZShlKSB7XG4gICAgICAgICAgICAgICAgZS5jcmVhdGVPYmplY3RTdG9yZShDZSwge1xuICAgICAgICAgICAgICAgICAgICBrZXlQYXRoOiB2ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfShlKTtcbiAgICAgICAgfSkpKSwgbiA8IDEyICYmIHIgPj0gMTIgJiYgKHMgPSBzLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgICFmdW5jdGlvbiBfX1BSSVZBVEVfY3JlYXRlRG9jdW1lbnRPdmVybGF5U3RvcmUoZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlLmNyZWF0ZU9iamVjdFN0b3JlKEtlLCB7XG4gICAgICAgICAgICAgICAgICAgIGtleVBhdGg6IFdlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdC5jcmVhdGVJbmRleChHZSwgemUsIHtcbiAgICAgICAgICAgICAgICAgICAgdW5pcXVlOiAhMVxuICAgICAgICAgICAgICAgIH0pLCB0LmNyZWF0ZUluZGV4KGplLCBKZSwge1xuICAgICAgICAgICAgICAgICAgICB1bmlxdWU6ICExXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KGUpO1xuICAgICAgICB9KSkpLCBuIDwgMTMgJiYgciA+PSAxMyAmJiAocyA9IHMubmV4dCgoKCkgPT4gZnVuY3Rpb24gX19QUklWQVRFX2NyZWF0ZVJlbW90ZURvY3VtZW50Q2FjaGUoZSkge1xuICAgICAgICAgICAgY29uc3QgdCA9IGUuY3JlYXRlT2JqZWN0U3RvcmUoX2UsIHtcbiAgICAgICAgICAgICAgICBrZXlQYXRoOiBhZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0LmNyZWF0ZUluZGV4KHVlLCBjZSksIHQuY3JlYXRlSW5kZXgobGUsIGhlKTtcbiAgICAgICAgfShlKSkpLm5leHQoKCgpID0+IHRoaXMuQ2koZSwgaSkpKS5uZXh0KCgoKSA9PiBlLmRlbGV0ZU9iamVjdFN0b3JlKEgpKSkpLCBuIDwgMTQgJiYgciA+PSAxNCAmJiAocyA9IHMubmV4dCgoKCkgPT4gdGhpcy5GaShlLCBpKSkpKSwgXG4gICAgICAgIG4gPCAxNSAmJiByID49IDE1ICYmIChzID0gcy5uZXh0KCgoKSA9PiBmdW5jdGlvbiBfX1BSSVZBVEVfY3JlYXRlRmllbGRJbmRleChlKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gZS5jcmVhdGVPYmplY3RTdG9yZShGZSwge1xuICAgICAgICAgICAgICAgIGtleVBhdGg6IE1lLFxuICAgICAgICAgICAgICAgIGF1dG9JbmNyZW1lbnQ6ICEwXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHQuY3JlYXRlSW5kZXgoeGUsIE9lLCB7XG4gICAgICAgICAgICAgICAgdW5pcXVlOiAhMVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBuID0gZS5jcmVhdGVPYmplY3RTdG9yZShOZSwge1xuICAgICAgICAgICAgICAgIGtleVBhdGg6IEJlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG4uY3JlYXRlSW5kZXgoTGUsIGtlLCB7XG4gICAgICAgICAgICAgICAgdW5pcXVlOiAhMVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCByID0gZS5jcmVhdGVPYmplY3RTdG9yZShxZSwge1xuICAgICAgICAgICAgICAgIGtleVBhdGg6IFFlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHIuY3JlYXRlSW5kZXgoJGUsIFVlLCB7XG4gICAgICAgICAgICAgICAgdW5pcXVlOiAhMVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0oZSkpKSksIG4gPCAxNiAmJiByID49IDE2ICYmIChcbiAgICAgICAgLy8gQ2xlYXIgdGhlIG9iamVjdCBzdG9yZXMgdG8gcmVtb3ZlIHBvc3NpYmx5IGNvcnJ1cHRlZCBpbmRleCBlbnRyaWVzXG4gICAgICAgIHMgPSBzLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIHQub2JqZWN0U3RvcmUoTmUpLmNsZWFyKCk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICB0Lm9iamVjdFN0b3JlKHFlKS5jbGVhcigpO1xuICAgICAgICB9KSkpLCBuIDwgMTcgJiYgciA+PSAxNyAmJiAocyA9IHMubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgIWZ1bmN0aW9uIF9fUFJJVkFURV9jcmVhdGVHbG9iYWxzU3RvcmUoZSkge1xuICAgICAgICAgICAgICAgIGUuY3JlYXRlT2JqZWN0U3RvcmUoSGUsIHtcbiAgICAgICAgICAgICAgICAgICAga2V5UGF0aDogWWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0oZSk7XG4gICAgICAgIH0pKSksIG4gPCAxOCAmJiByID49IDE4ICYmIGlzU2FmYXJpT3JXZWJraXQoKSAmJiAocyA9IHMubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgdC5vYmplY3RTdG9yZShOZSkuY2xlYXIoKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIHQub2JqZWN0U3RvcmUocWUpLmNsZWFyKCk7XG4gICAgICAgIH0pKSksIHM7XG4gICAgfVxuICAgIHdpKGUpIHtcbiAgICAgICAgbGV0IHQgPSAwO1xuICAgICAgICByZXR1cm4gZS5zdG9yZShIKS5lZSgoKGUsIG4pID0+IHtcbiAgICAgICAgICAgIHQgKz0gX19QUklWQVRFX2RiRG9jdW1lbnRTaXplKG4pO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbiA9IHtcbiAgICAgICAgICAgICAgICBieXRlU2l6ZTogdFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBlLnN0b3JlKFBlKS5wdXQoVGUsIG4pO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHlpKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IGUuc3RvcmUoWCksIG4gPSBlLnN0b3JlKHRlKTtcbiAgICAgICAgcmV0dXJuIHQuSigpLm5leHQoKHQgPT4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2godCwgKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgciA9IElEQktleVJhbmdlLmJvdW5kKFsgdC51c2VySWQsIGogXSwgWyB0LnVzZXJJZCwgdC5sYXN0QWNrbm93bGVkZ2VkQmF0Y2hJZCBdKTtcbiAgICAgICAgICAgIHJldHVybiBuLkoocmUsIHIpLm5leHQoKG4gPT4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2gobiwgKG4gPT4ge1xuICAgICAgICAgICAgICAgIF9fUFJJVkFURV9oYXJkQXNzZXJ0KG4udXNlcklkID09PSB0LnVzZXJJZCwgMTg2NTAsIFwiQ2Fubm90IHByb2Nlc3MgYmF0Y2ggZnJvbSB1bmV4cGVjdGVkIHVzZXJcIiwge1xuICAgICAgICAgICAgICAgICAgICBiYXRjaElkOiBuLmJhdGNoSWRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCByID0gX19QUklWQVRFX2Zyb21EYk11dGF0aW9uQmF0Y2godGhpcy5zZXJpYWxpemVyLCBuKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVtb3ZlTXV0YXRpb25CYXRjaChlLCB0LnVzZXJJZCwgcikubmV4dCgoKCkgPT4ge30pKTtcbiAgICAgICAgICAgIH0pKSkpO1xuICAgICAgICB9KSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW5zdXJlcyB0aGF0IGV2ZXJ5IGRvY3VtZW50IGluIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGUgaGFzIGEgY29ycmVzcG9uZGluZyBzZW50aW5lbCByb3dcbiAgICAgKiB3aXRoIGEgc2VxdWVuY2UgbnVtYmVyLiBNaXNzaW5nIHJvd3MgYXJlIGdpdmVuIHRoZSBtb3N0IHJlY2VudGx5IHVzZWQgc2VxdWVuY2UgbnVtYmVyLlxuICAgICAqLyAgICBTaShlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBlLnN0b3JlKEFlKSwgbiA9IGUuc3RvcmUoSCk7XG4gICAgICAgIHJldHVybiBlLnN0b3JlKGdlKS5nZXQoZmUpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgciA9IFtdO1xuICAgICAgICAgICAgcmV0dXJuIG4uZWUoKChuLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IG5ldyBSZXNvdXJjZVBhdGgobiksIG8gPSBmdW5jdGlvbiBfX1BSSVZBVEVfc2VudGluZWxLZXkoZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWyAwLCBfX1BSSVZBVEVfZW5jb2RlUmVzb3VyY2VQYXRoKGUpIF07XG4gICAgICAgICAgICAgICAgfShzKTtcbiAgICAgICAgICAgICAgICByLnB1c2godC5nZXQobykubmV4dCgobiA9PiBuID8gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKSA6IChuID0+IHQucHV0KHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SWQ6IDAsXG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IF9fUFJJVkFURV9lbmNvZGVSZXNvdXJjZVBhdGgobiksXG4gICAgICAgICAgICAgICAgICAgIHNlcXVlbmNlTnVtYmVyOiBlLmhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlclxuICAgICAgICAgICAgICAgIH0pKShzKSkpKTtcbiAgICAgICAgICAgIH0pKS5uZXh0KCgoKSA9PiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihyKSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGJpKGUsIHQpIHtcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBpbmRleC5cbiAgICAgICAgZS5jcmVhdGVPYmplY3RTdG9yZShwZSwge1xuICAgICAgICAgICAga2V5UGF0aDogeWVcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IG4gPSB0LnN0b3JlKHBlKSwgciA9IG5ldyBfX1BSSVZBVEVfTWVtb3J5Q29sbGVjdGlvblBhcmVudEluZGV4LCBhZGRFbnRyeSA9IGUgPT4ge1xuICAgICAgICAgICAgaWYgKHIuYWRkKGUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IGUubGFzdFNlZ21lbnQoKSwgciA9IGUucG9wTGFzdCgpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuLnB1dCh7XG4gICAgICAgICAgICAgICAgICAgIGNvbGxlY3Rpb25JZDogdCxcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50OiBfX1BSSVZBVEVfZW5jb2RlUmVzb3VyY2VQYXRoKHIpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIC8vIEhlbHBlciB0byBhZGQgYW4gaW5kZXggZW50cnkgaWZmIHdlIGhhdmVuJ3QgYWxyZWFkeSB3cml0dGVuIGl0LlxuICAgICAgICAgICAgICAgIC8vIEluZGV4IGV4aXN0aW5nIHJlbW90ZSBkb2N1bWVudHMuXG4gICAgICAgIHJldHVybiB0LnN0b3JlKEgpLmVlKHtcbiAgICAgICAgICAgIFg6ICEwXG4gICAgICAgIH0sICgoZSwgdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbiA9IG5ldyBSZXNvdXJjZVBhdGgoZSk7XG4gICAgICAgICAgICByZXR1cm4gYWRkRW50cnkobi5wb3BMYXN0KCkpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gdC5zdG9yZShvZSkuZWUoe1xuICAgICAgICAgICAgWDogITBcbiAgICAgICAgfSwgKChbZSwgdCwgbl0sIHIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBfX1BSSVZBVEVfZGVjb2RlUmVzb3VyY2VQYXRoKHQpO1xuICAgICAgICAgICAgcmV0dXJuIGFkZEVudHJ5KGkucG9wTGFzdCgpKTtcbiAgICAgICAgfSkpKSk7XG4gICAgfVxuICAgIERpKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IGUuc3RvcmUoSWUpO1xuICAgICAgICByZXR1cm4gdC5lZSgoKGUsIG4pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfZnJvbURiVGFyZ2V0KG4pLCBpID0gX19QUklWQVRFX3RvRGJUYXJnZXQodGhpcy5zZXJpYWxpemVyLCByKTtcbiAgICAgICAgICAgIHJldHVybiB0LnB1dChpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBDaShlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSB0LnN0b3JlKEgpLCByID0gW107XG4gICAgICAgIHJldHVybiBuLmVlKCgoZSwgbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IHQuc3RvcmUoX2UpLCBzID0gZnVuY3Rpb24gX19QUklWQVRFX2V4dHJhY3RLZXkoZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlLmRvY3VtZW50ID8gbmV3IERvY3VtZW50S2V5KFJlc291cmNlUGF0aC5mcm9tU3RyaW5nKGUuZG9jdW1lbnQubmFtZSkucG9wRmlyc3QoNSkpIDogZS5ub0RvY3VtZW50ID8gRG9jdW1lbnRLZXkuZnJvbVNlZ21lbnRzKGUubm9Eb2N1bWVudC5wYXRoKSA6IGUudW5rbm93bkRvY3VtZW50ID8gRG9jdW1lbnRLZXkuZnJvbVNlZ21lbnRzKGUudW5rbm93bkRvY3VtZW50LnBhdGgpIDogZmFpbCgzNjc4Myk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyAobikucGF0aC50b0FycmF5KCksIG8gPSB7XG4gICAgICAgICAgICAgICAgcHJlZml4UGF0aDogcy5zbGljZSgwLCBzLmxlbmd0aCAtIDIpLFxuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb25Hcm91cDogc1tzLmxlbmd0aCAtIDJdLFxuICAgICAgICAgICAgICAgIGRvY3VtZW50SWQ6IHNbcy5sZW5ndGggLSAxXSxcbiAgICAgICAgICAgICAgICByZWFkVGltZTogbi5yZWFkVGltZSB8fCBbIDAsIDAgXSxcbiAgICAgICAgICAgICAgICB1bmtub3duRG9jdW1lbnQ6IG4udW5rbm93bkRvY3VtZW50LFxuICAgICAgICAgICAgICAgIG5vRG9jdW1lbnQ6IG4ubm9Eb2N1bWVudCxcbiAgICAgICAgICAgICAgICBkb2N1bWVudDogbi5kb2N1bWVudCxcbiAgICAgICAgICAgICAgICBoYXNDb21taXR0ZWRNdXRhdGlvbnM6ICEhbi5oYXNDb21taXR0ZWRNdXRhdGlvbnNcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByLnB1c2goaS5wdXQobykpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IocikpKTtcbiAgICB9XG4gICAgRmkoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gdC5zdG9yZSh0ZSksIHIgPSBfX1BSSVZBVEVfbmV3SW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZSh0aGlzLnNlcmlhbGl6ZXIpLCBpID0gbmV3IF9fUFJJVkFURV9NZW1vcnlQZXJzaXN0ZW5jZShfX1BSSVZBVEVfTWVtb3J5RWFnZXJEZWxlZ2F0ZS5taSwgdGhpcy5zZXJpYWxpemVyLnl0KTtcbiAgICAgICAgcmV0dXJuIG4uSigpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgbiA9IG5ldyBNYXA7XG4gICAgICAgICAgICByZXR1cm4gZS5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgdCA9IG4uZ2V0KGUudXNlcklkKSA/PyBfX1BSSVZBVEVfZG9jdW1lbnRLZXlTZXQoKTtcbiAgICAgICAgICAgICAgICBfX1BSSVZBVEVfZnJvbURiTXV0YXRpb25CYXRjaCh0aGlzLnNlcmlhbGl6ZXIsIGUpLmtleXMoKS5mb3JFYWNoKChlID0+IHQgPSB0LmFkZChlKSkpLCBcbiAgICAgICAgICAgICAgICBuLnNldChlLnVzZXJJZCwgdCk7XG4gICAgICAgICAgICB9KSksIFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKG4sICgoZSwgbikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuZXcgVXNlcihuKSwgbyA9IF9fUFJJVkFURV9JbmRleGVkRGJEb2N1bWVudE92ZXJsYXlDYWNoZS53dCh0aGlzLnNlcmlhbGl6ZXIsIHMpLCBfID0gaS5nZXRJbmRleE1hbmFnZXIocyksIGEgPSBfX1BSSVZBVEVfSW5kZXhlZERiTXV0YXRpb25RdWV1ZS53dChzLCB0aGlzLnNlcmlhbGl6ZXIsIF8sIGkucmVmZXJlbmNlRGVsZWdhdGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTG9jYWxEb2N1bWVudHNWaWV3KHIsIGEsIG8sIF8pLnJlY2FsY3VsYXRlQW5kU2F2ZU92ZXJsYXlzRm9yRG9jdW1lbnRLZXlzKG5ldyBfX1BSSVZBVEVfSW5kZXhlZERiVHJhbnNhY3Rpb24odCwgX19QUklWQVRFX0xpc3RlblNlcXVlbmNlLmNlKSwgZSkubmV4dCgpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfY3JlYXRlUXVlcnlDYWNoZShlKSB7XG4gICAgZS5jcmVhdGVPYmplY3RTdG9yZShBZSwge1xuICAgICAgICBrZXlQYXRoOiBSZVxuICAgIH0pLmNyZWF0ZUluZGV4KFZlLCBtZSwge1xuICAgICAgICB1bmlxdWU6ICEwXG4gICAgfSk7XG4gICAgLy8gTk9URTogVGhpcyBpcyB1bmlxdWUgb25seSBiZWNhdXNlIHRoZSBUYXJnZXRJZCBpcyB0aGUgc3VmZml4LlxuICAgIGUuY3JlYXRlT2JqZWN0U3RvcmUoSWUsIHtcbiAgICAgICAga2V5UGF0aDogXCJ0YXJnZXRJZFwiXG4gICAgfSkuY3JlYXRlSW5kZXgoRWUsIGRlLCB7XG4gICAgICAgIHVuaXF1ZTogITBcbiAgICB9KSwgZS5jcmVhdGVPYmplY3RTdG9yZShnZSk7XG59XG5cbmNvbnN0IEx0ID0gXCJJbmRleGVkRGJQZXJzaXN0ZW5jZVwiLCBrdCA9IDE4ZTUsIHF0ID0gNWUzLCBRdCA9IFwiRmFpbGVkIHRvIG9idGFpbiBleGNsdXNpdmUgYWNjZXNzIHRvIHRoZSBwZXJzaXN0ZW5jZSBsYXllci4gVG8gYWxsb3cgc2hhcmVkIGFjY2VzcywgbXVsdGktdGFiIHN5bmNocm9uaXphdGlvbiBoYXMgdG8gYmUgZW5hYmxlZCBpbiBhbGwgdGFicy4gSWYgeW91IGFyZSB1c2luZyBgZXhwZXJpbWVudGFsRm9yY2VPd25pbmdUYWI6dHJ1ZWAsIG1ha2Ugc3VyZSB0aGF0IG9ubHkgb25lIHRhYiBoYXMgcGVyc2lzdGVuY2UgZW5hYmxlZCBhdCBhbnkgZ2l2ZW4gdGltZS5cIiwgJHQgPSBcIm1haW5cIjtcblxuLyoqXG4gKiBPbGRlc3QgYWNjZXB0YWJsZSBhZ2UgaW4gbWlsbGlzZWNvbmRzIGZvciBjbGllbnQgbWV0YWRhdGEgYmVmb3JlIHRoZSBjbGllbnRcbiAqIGlzIGNvbnNpZGVyZWQgaW5hY3RpdmUgYW5kIGl0cyBhc3NvY2lhdGVkIGRhdGEgaXMgZ2FyYmFnZSBjb2xsZWN0ZWQuXG4gKi9cbi8qKlxuICogQW4gSW5kZXhlZERCLWJhY2tlZCBpbnN0YW5jZSBvZiBQZXJzaXN0ZW5jZS4gRGF0YSBpcyBzdG9yZWQgcGVyc2lzdGVudGx5XG4gKiBhY3Jvc3Mgc2Vzc2lvbnMuXG4gKlxuICogT24gV2ViIG9ubHksIHRoZSBGaXJlc3RvcmUgU0RLcyBzdXBwb3J0IHNoYXJlZCBhY2Nlc3MgdG8gaXRzIHBlcnNpc3RlbmNlXG4gKiBsYXllci4gVGhpcyBhbGxvd3MgbXVsdGlwbGUgYnJvd3NlciB0YWJzIHRvIHJlYWQgYW5kIHdyaXRlIHRvIEluZGV4ZWREYiBhbmRcbiAqIHRvIHN5bmNocm9uaXplIHN0YXRlIGV2ZW4gd2l0aG91dCBuZXR3b3JrIGNvbm5lY3Rpdml0eS4gU2hhcmVkIGFjY2VzcyBpc1xuICogY3VycmVudGx5IG9wdGlvbmFsIGFuZCBub3QgZW5hYmxlZCB1bmxlc3MgYWxsIGNsaWVudHMgaW52b2tlXG4gKiBgZW5hYmxlUGVyc2lzdGVuY2UoKWAgd2l0aCBge3N5bmNocm9uaXplVGFiczp0cnVlfWAuXG4gKlxuICogSW4gbXVsdGktdGFiIG1vZGUsIGlmIG11bHRpcGxlIGNsaWVudHMgYXJlIGFjdGl2ZSBhdCB0aGUgc2FtZSB0aW1lLCB0aGUgU0RLXG4gKiB3aWxsIGRlc2lnbmF0ZSBvbmUgY2xpZW50IGFzIHRoZSBcInByaW1hcnkgY2xpZW50XCIuIEFuIGVmZm9ydCBpcyBtYWRlIHRvIHBpY2tcbiAqIGEgdmlzaWJsZSwgbmV0d29yay1jb25uZWN0ZWQgYW5kIGFjdGl2ZSBjbGllbnQsIGFuZCB0aGlzIGNsaWVudCBpc1xuICogcmVzcG9uc2libGUgZm9yIGxldHRpbmcgb3RoZXIgY2xpZW50cyBrbm93IGFib3V0IGl0cyBwcmVzZW5jZS4gVGhlIHByaW1hcnlcbiAqIGNsaWVudCB3cml0ZXMgYSB1bmlxdWUgY2xpZW50LWdlbmVyYXRlZCBpZGVudGlmaWVyICh0aGUgY2xpZW50IElEKSB0b1xuICogSW5kZXhlZERi4oCZcyBcIm93bmVyXCIgc3RvcmUgZXZlcnkgNCBzZWNvbmRzLiBJZiB0aGUgcHJpbWFyeSBjbGllbnQgZmFpbHMgdG9cbiAqIHVwZGF0ZSB0aGlzIGVudHJ5LCBhbm90aGVyIGNsaWVudCBjYW4gYWNxdWlyZSB0aGUgbGVhc2UgYW5kIHRha2Ugb3ZlciBhc1xuICogcHJpbWFyeS5cbiAqXG4gKiBTb21lIHBlcnNpc3RlbmNlIG9wZXJhdGlvbnMgaW4gdGhlIFNESyBhcmUgZGVzaWduYXRlZCBhcyBwcmltYXJ5LWNsaWVudCBvbmx5XG4gKiBvcGVyYXRpb25zLiBUaGlzIGluY2x1ZGVzIHRoZSBhY2tub3dsZWRnbWVudCBvZiBtdXRhdGlvbnMgYW5kIGFsbCB1cGRhdGVzIG9mXG4gKiByZW1vdGUgZG9jdW1lbnRzLiBUaGUgZWZmZWN0cyBvZiB0aGVzZSBvcGVyYXRpb25zIGFyZSB3cml0dGVuIHRvIHBlcnNpc3RlbmNlXG4gKiBhbmQgdGhlbiBicm9hZGNhc3QgdG8gb3RoZXIgdGFicyB2aWEgTG9jYWxTdG9yYWdlIChzZWVcbiAqIGBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGVgKSwgd2hpY2ggdGhlbiByZWZyZXNoIHRoZWlyIHN0YXRlIGZyb21cbiAqIHBlcnNpc3RlbmNlLlxuICpcbiAqIFNpbWlsYXJseSwgdGhlIHByaW1hcnkgY2xpZW50IGxpc3RlbnMgdG8gbm90aWZpY2F0aW9ucyBzZW50IGJ5IHNlY29uZGFyeVxuICogY2xpZW50cyB0byBkaXNjb3ZlciBwZXJzaXN0ZW5jZSBjaGFuZ2VzIHdyaXR0ZW4gYnkgc2Vjb25kYXJ5IGNsaWVudHMsIHN1Y2ggYXNcbiAqIHRoZSBhZGRpdGlvbiBvZiBuZXcgbXV0YXRpb25zIGFuZCBxdWVyeSB0YXJnZXRzLlxuICpcbiAqIElmIG11bHRpLXRhYiBpcyBub3QgZW5hYmxlZCBhbmQgYW5vdGhlciB0YWIgYWxyZWFkeSBvYnRhaW5lZCB0aGUgcHJpbWFyeVxuICogbGVhc2UsIEluZGV4ZWREYlBlcnNpc3RlbmNlIGVudGVycyBhIGZhaWxlZCBzdGF0ZSBhbmQgYWxsIHN1YnNlcXVlbnRcbiAqIG9wZXJhdGlvbnMgd2lsbCBhdXRvbWF0aWNhbGx5IGZhaWwuXG4gKlxuICogQWRkaXRpb25hbGx5LCB0aGVyZSBpcyBhbiBvcHRpbWl6YXRpb24gc28gdGhhdCB3aGVuIGEgdGFiIGlzIGNsb3NlZCwgdGhlXG4gKiBwcmltYXJ5IGxlYXNlIGlzIHJlbGVhc2VkIGltbWVkaWF0ZWx5ICh0aGlzIGlzIGVzcGVjaWFsbHkgaW1wb3J0YW50IHRvIG1ha2VcbiAqIHN1cmUgdGhhdCBhIHJlZnJlc2hlZCB0YWIgaXMgYWJsZSB0byBpbW1lZGlhdGVseSByZS1hY3F1aXJlIHRoZSBwcmltYXJ5XG4gKiBsZWFzZSkuIFVuZm9ydHVuYXRlbHksIEluZGV4ZWREQiBjYW5ub3QgYmUgcmVsaWFibHkgdXNlZCBpbiB3aW5kb3cudW5sb2FkXG4gKiBzaW5jZSBpdCBpcyBhbiBhc3luY2hyb25vdXMgQVBJLiBTbyBpbiBhZGRpdGlvbiB0byBhdHRlbXB0aW5nIHRvIGdpdmUgdXAgdGhlXG4gKiBsZWFzZSwgdGhlIGxlYXNlaG9sZGVyIHdyaXRlcyBpdHMgY2xpZW50IElEIHRvIGEgXCJ6b21iaWVkQ2xpZW50XCIgZW50cnkgaW5cbiAqIExvY2FsU3RvcmFnZSB3aGljaCBhY3RzIGFzIGFuIGluZGljYXRvciB0aGF0IGFub3RoZXIgdGFiIHNob3VsZCBnbyBhaGVhZCBhbmRcbiAqIHRha2UgdGhlIHByaW1hcnkgbGVhc2UgaW1tZWRpYXRlbHkgcmVnYXJkbGVzcyBvZiB0aGUgY3VycmVudCBsZWFzZSB0aW1lc3RhbXAuXG4gKlxuICogVE9ETyhiLzExNDIyNjIzNCk6IFJlbW92ZSBgc3luY2hyb25pemVUYWJzYCBzZWN0aW9uIHdoZW4gbXVsdGktdGFiIGlzIG5vXG4gKiBsb25nZXIgb3B0aW9uYWwuXG4gKi9cbmNsYXNzIF9fUFJJVkFURV9JbmRleGVkRGJQZXJzaXN0ZW5jZSB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogV2hldGhlciB0byBzeW5jaHJvbml6ZSB0aGUgaW4tbWVtb3J5IHN0YXRlIG9mIG11bHRpcGxlIHRhYnMgYW5kIHNoYXJlXG4gICAgICogYWNjZXNzIHRvIGxvY2FsIHBlcnNpc3RlbmNlLlxuICAgICAqL1xuICAgIGUsIHQsIG4sIHIsIGksIHMsIG8sIF8sIGEsIFxuICAgIC8qKlxuICAgICAqIElmIHNldCB0byB0cnVlLCBmb3JjZWZ1bGx5IG9idGFpbnMgZGF0YWJhc2UgYWNjZXNzLiBFeGlzdGluZyB0YWJzIHdpbGxcbiAgICAgKiBubyBsb25nZXIgYmUgYWJsZSB0byBhY2Nlc3MgSW5kZXhlZERCLlxuICAgICAqL1xuICAgIHUsIGMgPSAxOCkge1xuICAgICAgICBpZiAodGhpcy5hbGxvd1RhYlN5bmNocm9uaXphdGlvbiA9IGUsIHRoaXMucGVyc2lzdGVuY2VLZXkgPSB0LCB0aGlzLmNsaWVudElkID0gbiwgXG4gICAgICAgIHRoaXMuTWkgPSBpLCB0aGlzLndpbmRvdyA9IHMsIHRoaXMuZG9jdW1lbnQgPSBvLCB0aGlzLnhpID0gYSwgdGhpcy5PaSA9IHUsIHRoaXMuTmkgPSBjLCBcbiAgICAgICAgdGhpcy5jaSA9IG51bGwsIHRoaXMubGkgPSAhMSwgdGhpcy5pc1ByaW1hcnkgPSAhMSwgdGhpcy5uZXR3b3JrRW5hYmxlZCA9ICEwLCBcbiAgICAgICAgLyoqIE91ciB3aW5kb3cudW5sb2FkIGhhbmRsZXIsIGlmIHJlZ2lzdGVyZWQuICovXG4gICAgICAgIHRoaXMuQmkgPSBudWxsLCB0aGlzLmluRm9yZWdyb3VuZCA9ICExLCBcbiAgICAgICAgLyoqIE91ciAndmlzaWJpbGl0eWNoYW5nZScgbGlzdGVuZXIgaWYgcmVnaXN0ZXJlZC4gKi9cbiAgICAgICAgdGhpcy5MaSA9IG51bGwsIFxuICAgICAgICAvKiogVGhlIGNsaWVudCBtZXRhZGF0YSByZWZyZXNoIHRhc2suICovXG4gICAgICAgIHRoaXMua2kgPSBudWxsLCBcbiAgICAgICAgLyoqIFRoZSBsYXN0IHRpbWUgd2UgZ2FyYmFnZSBjb2xsZWN0ZWQgdGhlIGNsaWVudCBtZXRhZGF0YSBvYmplY3Qgc3RvcmUuICovXG4gICAgICAgIHRoaXMucWkgPSBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFksIFxuICAgICAgICAvKiogQSBsaXN0ZW5lciB0byBub3RpZnkgb24gcHJpbWFyeSBzdGF0ZSBjaGFuZ2VzLiAqL1xuICAgICAgICB0aGlzLlFpID0gZSA9PiBQcm9taXNlLnJlc29sdmUoKSwgIV9fUFJJVkFURV9JbmRleGVkRGJQZXJzaXN0ZW5jZS52KCkpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLlVOSU1QTEVNRU5URUQsIFwiVGhpcyBwbGF0Zm9ybSBpcyBlaXRoZXIgbWlzc2luZyBJbmRleGVkREIgb3IgaXMga25vd24gdG8gaGF2ZSBhbiBpbmNvbXBsZXRlIGltcGxlbWVudGF0aW9uLiBPZmZsaW5lIHBlcnNpc3RlbmNlIGhhcyBiZWVuIGRpc2FibGVkLlwiKTtcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSA9IG5ldyBfX1BSSVZBVEVfSW5kZXhlZERiTHJ1RGVsZWdhdGVJbXBsKHRoaXMsIHIpLCB0aGlzLiRpID0gdCArICR0LCBcbiAgICAgICAgdGhpcy5zZXJpYWxpemVyID0gbmV3IF9fUFJJVkFURV9Mb2NhbFNlcmlhbGl6ZXIoXyksIHRoaXMuVWkgPSBuZXcgX19QUklWQVRFX1NpbXBsZURiKHRoaXMuJGksIHRoaXMuTmksIG5ldyBfX1BSSVZBVEVfU2NoZW1hQ29udmVydGVyKHRoaXMuc2VyaWFsaXplcikpLCBcbiAgICAgICAgdGhpcy5oaSA9IG5ldyBfX1BSSVZBVEVfSW5kZXhlZERiR2xvYmFsc0NhY2hlLCB0aGlzLlBpID0gbmV3IF9fUFJJVkFURV9JbmRleGVkRGJUYXJnZXRDYWNoZSh0aGlzLnJlZmVyZW5jZURlbGVnYXRlLCB0aGlzLnNlcmlhbGl6ZXIpLCBcbiAgICAgICAgdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlID0gX19QUklWQVRFX25ld0luZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUodGhpcy5zZXJpYWxpemVyKSwgXG4gICAgICAgIHRoaXMuSWkgPSBuZXcgX19QUklWQVRFX0luZGV4ZWREYkJ1bmRsZUNhY2hlLCB0aGlzLndpbmRvdyAmJiB0aGlzLndpbmRvdy5sb2NhbFN0b3JhZ2UgPyB0aGlzLktpID0gdGhpcy53aW5kb3cubG9jYWxTdG9yYWdlIDogKHRoaXMuS2kgPSBudWxsLCBcbiAgICAgICAgITEgPT09IHUgJiYgX19QUklWQVRFX2xvZ0Vycm9yKEx0LCBcIkxvY2FsU3RvcmFnZSBpcyB1bmF2YWlsYWJsZS4gQXMgYSByZXN1bHQsIHBlcnNpc3RlbmNlIG1heSBub3Qgd29yayByZWxpYWJseS4gSW4gcGFydGljdWxhciBlbmFibGVQZXJzaXN0ZW5jZSgpIGNvdWxkIGZhaWwgaW1tZWRpYXRlbHkgYWZ0ZXIgcmVmcmVzaGluZyB0aGUgcGFnZS5cIikpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBdHRlbXB0IHRvIHN0YXJ0IEluZGV4ZWREYiBwZXJzaXN0ZW5jZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIFdoZXRoZXIgcGVyc2lzdGVuY2Ugd2FzIGVuYWJsZWQuXG4gICAgICovICAgIHN0YXJ0KCkge1xuICAgICAgICAvLyBOT1RFOiBUaGlzIGlzIGV4cGVjdGVkIHRvIGZhaWwgc29tZXRpbWVzIChpbiB0aGUgY2FzZSBvZiBhbm90aGVyIHRhYlxuICAgICAgICAvLyBhbHJlYWR5IGhhdmluZyB0aGUgcGVyc2lzdGVuY2UgbG9jayksIHNvIGl0J3MgdGhlIGZpcnN0IHRoaW5nIHdlIHNob3VsZFxuICAgICAgICAvLyBkby5cbiAgICAgICAgcmV0dXJuIHRoaXMuV2koKS50aGVuKCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNQcmltYXJ5ICYmICF0aGlzLmFsbG93VGFiU3luY2hyb25pemF0aW9uKSBcbiAgICAgICAgICAgIC8vIEZhaWwgYHN0YXJ0KClgIGlmIGBzeW5jaHJvbml6ZVRhYnNgIGlzIGRpc2FibGVkIGFuZCB3ZSBjYW5ub3RcbiAgICAgICAgICAgIC8vIG9idGFpbiB0aGUgcHJpbWFyeSBsZWFzZS5cbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLkZBSUxFRF9QUkVDT05ESVRJT04sIFF0KTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLkdpKCksIHRoaXMuemkoKSwgdGhpcy5qaSgpLCB0aGlzLnJ1blRyYW5zYWN0aW9uKFwiZ2V0SGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyXCIsIFwicmVhZG9ubHlcIiwgKGUgPT4gdGhpcy5QaS5nZXRIaWdoZXN0U2VxdWVuY2VOdW1iZXIoZSkpKTtcbiAgICAgICAgfSkpLnRoZW4oKGUgPT4ge1xuICAgICAgICAgICAgdGhpcy5jaSA9IG5ldyBfX1BSSVZBVEVfTGlzdGVuU2VxdWVuY2UoZSwgdGhpcy54aSk7XG4gICAgICAgIH0pKS50aGVuKCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmxpID0gITA7XG4gICAgICAgIH0pKS5jYXRjaCgoZSA9PiAodGhpcy5VaSAmJiB0aGlzLlVpLmNsb3NlKCksIFByb21pc2UucmVqZWN0KGUpKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlcnMgYSBsaXN0ZW5lciB0aGF0IGdldHMgY2FsbGVkIHdoZW4gdGhlIHByaW1hcnkgc3RhdGUgb2YgdGhlXG4gICAgICogaW5zdGFuY2UgY2hhbmdlcy4gVXBvbiByZWdpc3RlcmluZywgdGhpcyBsaXN0ZW5lciBpcyBpbnZva2VkIGltbWVkaWF0ZWx5XG4gICAgICogd2l0aCB0aGUgY3VycmVudCBwcmltYXJ5IHN0YXRlLlxuICAgICAqXG4gICAgICogUE9SVElORyBOT1RFOiBUaGlzIGlzIG9ubHkgdXNlZCBmb3IgV2ViIG11bHRpLXRhYi5cbiAgICAgKi8gICAgSmkoZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5RaSA9IGFzeW5jIHQgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkgcmV0dXJuIGUodCk7XG4gICAgICAgIH0sIGUodGhpcy5pc1ByaW1hcnkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlcnMgYSBsaXN0ZW5lciB0aGF0IGdldHMgY2FsbGVkIHdoZW4gdGhlIGRhdGFiYXNlIHJlY2VpdmVzIGFcbiAgICAgKiB2ZXJzaW9uIGNoYW5nZSBldmVudCBpbmRpY2F0aW5nIHRoYXQgaXQgaGFzIGRlbGV0ZWQuXG4gICAgICpcbiAgICAgKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGZvciBXZWIgbXVsdGktdGFiLlxuICAgICAqLyAgICBzZXREYXRhYmFzZURlbGV0ZWRMaXN0ZW5lcihlKSB7XG4gICAgICAgIHRoaXMuVWkuJCgoYXN5bmMgdCA9PiB7XG4gICAgICAgICAgICAvLyBDaGVjayBpZiBhbiBhdHRlbXB0IGlzIG1hZGUgdG8gZGVsZXRlIEluZGV4ZWREQi5cbiAgICAgICAgICAgIG51bGwgPT09IHQubmV3VmVyc2lvbiAmJiBhd2FpdCBlKCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRqdXN0cyB0aGUgY3VycmVudCBuZXR3b3JrIHN0YXRlIGluIHRoZSBjbGllbnQncyBtZXRhZGF0YSwgcG90ZW50aWFsbHlcbiAgICAgKiBhZmZlY3RpbmcgdGhlIHByaW1hcnkgbGVhc2UuXG4gICAgICpcbiAgICAgKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGZvciBXZWIgbXVsdGktdGFiLlxuICAgICAqLyAgICBzZXROZXR3b3JrRW5hYmxlZChlKSB7XG4gICAgICAgIHRoaXMubmV0d29ya0VuYWJsZWQgIT09IGUgJiYgKHRoaXMubmV0d29ya0VuYWJsZWQgPSBlLCBcbiAgICAgICAgLy8gU2NoZWR1bGUgYSBwcmltYXJ5IGxlYXNlIHJlZnJlc2ggZm9yIGltbWVkaWF0ZSBleGVjdXRpb24uIFRoZSBldmVudHVhbFxuICAgICAgICAvLyBsZWFzZSB1cGRhdGUgd2lsbCBiZSBwcm9wYWdhdGVkIHZpYSBgcHJpbWFyeVN0YXRlTGlzdGVuZXJgLlxuICAgICAgICB0aGlzLk1pLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZCAmJiBhd2FpdCB0aGlzLldpKCk7XG4gICAgICAgIH0pKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIGNsaWVudCBtZXRhZGF0YSBpbiBJbmRleGVkRGIgYW5kIGF0dGVtcHRzIHRvIGVpdGhlciBvYnRhaW4gb3JcbiAgICAgKiBleHRlbmQgdGhlIHByaW1hcnkgbGVhc2UgZm9yIHRoZSBsb2NhbCBjbGllbnQuIEFzeW5jaHJvbm91c2x5IG5vdGlmaWVzIHRoZVxuICAgICAqIHByaW1hcnkgc3RhdGUgbGlzdGVuZXIgaWYgdGhlIGNsaWVudCBlaXRoZXIgbmV3bHkgb2J0YWluZWQgb3IgcmVsZWFzZWQgaXRzXG4gICAgICogcHJpbWFyeSBsZWFzZS5cbiAgICAgKi8gICAgV2koKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJ1blRyYW5zYWN0aW9uKFwidXBkYXRlQ2xpZW50TWV0YWRhdGFBbmRUcnlCZWNvbWVQcmltYXJ5XCIsIFwicmVhZHdyaXRlXCIsIChlID0+IF9fUFJJVkFURV9jbGllbnRNZXRhZGF0YVN0b3JlKGUpLnB1dCh7XG4gICAgICAgICAgICBjbGllbnRJZDogdGhpcy5jbGllbnRJZCxcbiAgICAgICAgICAgIHVwZGF0ZVRpbWVNczogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgIG5ldHdvcmtFbmFibGVkOiB0aGlzLm5ldHdvcmtFbmFibGVkLFxuICAgICAgICAgICAgaW5Gb3JlZ3JvdW5kOiB0aGlzLmluRm9yZWdyb3VuZFxuICAgICAgICB9KS5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc1ByaW1hcnkpIHJldHVybiB0aGlzLkhpKGUpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgICAgIGUgfHwgKHRoaXMuaXNQcmltYXJ5ID0gITEsIHRoaXMuTWkuZW5xdWV1ZVJldHJ5YWJsZSgoKCkgPT4gdGhpcy5RaSghMSkpKSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiB0aGlzLllpKGUpKSkubmV4dCgodCA9PiB0aGlzLmlzUHJpbWFyeSAmJiAhdCA/IHRoaXMuWmkoZSkubmV4dCgoKCkgPT4gITEpKSA6ICEhdCAmJiB0aGlzLlhpKGUpLm5leHQoKCgpID0+ICEwKSkpKSkpLmNhdGNoKChlID0+IHtcbiAgICAgICAgICAgIGlmIChfX1BSSVZBVEVfaXNJbmRleGVkRGJUcmFuc2FjdGlvbkVycm9yKGUpKSBcbiAgICAgICAgICAgIC8vIFByb2NlZWQgd2l0aCB0aGUgZXhpc3Rpbmcgc3RhdGUuIEFueSBzdWJzZXF1ZW50IGFjY2VzcyB0b1xuICAgICAgICAgICAgLy8gSW5kZXhlZERCIHdpbGwgdmVyaWZ5IHRoZSBsZWFzZS5cbiAgICAgICAgICAgIHJldHVybiBfX1BSSVZBVEVfbG9nRGVidWcoTHQsIFwiRmFpbGVkIHRvIGV4dGVuZCBvd25lciBsZWFzZTogXCIsIGUpLCB0aGlzLmlzUHJpbWFyeTtcbiAgICAgICAgICAgIGlmICghdGhpcy5hbGxvd1RhYlN5bmNocm9uaXphdGlvbikgdGhyb3cgZTtcbiAgICAgICAgICAgIHJldHVybiBfX1BSSVZBVEVfbG9nRGVidWcoTHQsIFwiUmVsZWFzaW5nIG93bmVyIGxlYXNlIGFmdGVyIGVycm9yIGR1cmluZyBsZWFzZSByZWZyZXNoXCIsIGUpLCBcbiAgICAgICAgICAgIC8qIGlzUHJpbWFyeT0gKi8gITE7XG4gICAgICAgIH0pKS50aGVuKChlID0+IHtcbiAgICAgICAgICAgIHRoaXMuaXNQcmltYXJ5ICE9PSBlICYmIHRoaXMuTWkuZW5xdWV1ZVJldHJ5YWJsZSgoKCkgPT4gdGhpcy5RaShlKSkpLCB0aGlzLmlzUHJpbWFyeSA9IGU7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgSGkoZSkge1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX3ByaW1hcnlDbGllbnRTdG9yZShlKS5nZXQoWikubmV4dCgoZSA9PiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0aGlzLmVzKGUpKSkpO1xuICAgIH1cbiAgICB0cyhlKSB7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfY2xpZW50TWV0YWRhdGFTdG9yZShlKS5kZWxldGUodGhpcy5jbGllbnRJZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIElmIHRoZSBnYXJiYWdlIGNvbGxlY3Rpb24gdGhyZXNob2xkIGhhcyBwYXNzZWQsIHBydW5lcyB0aGVcbiAgICAgKiBSZW1vdGVEb2N1bWVudENoYW5nZXMgYW5kIHRoZSBDbGllbnRNZXRhZGF0YSBzdG9yZSBiYXNlZCBvbiB0aGUgbGFzdCB1cGRhdGVcbiAgICAgKiB0aW1lIG9mIGFsbCBjbGllbnRzLlxuICAgICAqLyAgICBhc3luYyBucygpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNQcmltYXJ5ICYmICF0aGlzLnJzKHRoaXMucWksIGt0KSkge1xuICAgICAgICAgICAgdGhpcy5xaSA9IERhdGUubm93KCk7XG4gICAgICAgICAgICBjb25zdCBlID0gYXdhaXQgdGhpcy5ydW5UcmFuc2FjdGlvbihcIm1heWJlR2FyYmFnZUNvbGxlY3RNdWx0aUNsaWVudFN0YXRlXCIsIFwicmVhZHdyaXRlLXByaW1hcnlcIiwgKGUgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBfX1BSSVZBVEVfZ2V0U3RvcmUoZSwgd2UpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0LkooKS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuc3MoZSwga3QpLCByID0gZS5maWx0ZXIoKGUgPT4gLTEgPT09IG4uaW5kZXhPZihlKSkpO1xuICAgICAgICAgICAgICAgICAgICAvLyBEZWxldGUgbWV0YWRhdGEgZm9yIGNsaWVudHMgdGhhdCBhcmUgbm8gbG9uZ2VyIGNvbnNpZGVyZWQgYWN0aXZlLlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2gociwgKGUgPT4gdC5kZWxldGUoZS5jbGllbnRJZCkpKS5uZXh0KCgoKSA9PiByKSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSkpLmNhdGNoKCgoKSA9PiBbXSkpO1xuICAgICAgICAgICAgLy8gRGVsZXRlIHBvdGVudGlhbCBsZWZ0b3ZlciBlbnRyaWVzIHRoYXQgbWF5IGNvbnRpbnVlIHRvIG1hcmsgdGhlXG4gICAgICAgICAgICAvLyBpbmFjdGl2ZSBjbGllbnRzIGFzIHpvbWJpZWQgaW4gTG9jYWxTdG9yYWdlLlxuICAgICAgICAgICAgLy8gSWRlYWxseSB3ZSdkIGRlbGV0ZSB0aGUgSW5kZXhlZERiIGFuZCBMb2NhbFN0b3JhZ2Ugem9tYmllIGVudHJpZXMgZm9yXG4gICAgICAgICAgICAvLyB0aGUgY2xpZW50IGF0b21pY2FsbHksIGJ1dCB3ZSBjYW4ndC4gU28gd2Ugb3B0IHRvIGRlbGV0ZSB0aGUgSW5kZXhlZERiXG4gICAgICAgICAgICAvLyBlbnRyaWVzIGZpcnN0IHRvIGF2b2lkIHBvdGVudGlhbGx5IHJldml2aW5nIGEgem9tYmllZCBjbGllbnQuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5LaSkgZm9yIChjb25zdCB0IG9mIGUpIHRoaXMuS2kucmVtb3ZlSXRlbSh0aGlzLl9zKHQuY2xpZW50SWQpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTY2hlZHVsZXMgYSByZWN1cnJpbmcgdGltZXIgdG8gdXBkYXRlIHRoZSBjbGllbnQgbWV0YWRhdGEgYW5kIHRvIGVpdGhlclxuICAgICAqIGV4dGVuZCBvciBhY3F1aXJlIHRoZSBwcmltYXJ5IGxlYXNlIGlmIHRoZSBjbGllbnQgaXMgZWxpZ2libGUuXG4gICAgICovICAgIGppKCkge1xuICAgICAgICB0aGlzLmtpID0gdGhpcy5NaS5lbnF1ZXVlQWZ0ZXJEZWxheShcImNsaWVudF9tZXRhZGF0YV9yZWZyZXNoXCIgLyogVGltZXJJZC5DbGllbnRNZXRhZGF0YVJlZnJlc2ggKi8gLCA0ZTMsICgoKSA9PiB0aGlzLldpKCkudGhlbigoKCkgPT4gdGhpcy5ucygpKSkudGhlbigoKCkgPT4gdGhpcy5qaSgpKSkpKTtcbiAgICB9XG4gICAgLyoqIENoZWNrcyB3aGV0aGVyIGBjbGllbnRgIGlzIHRoZSBsb2NhbCBjbGllbnQuICovICAgIGVzKGUpIHtcbiAgICAgICAgcmV0dXJuICEhZSAmJiBlLm93bmVySWQgPT09IHRoaXMuY2xpZW50SWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEV2YWx1YXRlIHRoZSBzdGF0ZSBvZiBhbGwgYWN0aXZlIGNsaWVudHMgYW5kIGRldGVybWluZSB3aGV0aGVyIHRoZSBsb2NhbFxuICAgICAqIGNsaWVudCBpcyBvciBjYW4gYWN0IGFzIHRoZSBob2xkZXIgb2YgdGhlIHByaW1hcnkgbGVhc2UuIFJldHVybnMgd2hldGhlclxuICAgICAqIHRoZSBjbGllbnQgaXMgZWxpZ2libGUgZm9yIHRoZSBsZWFzZSwgYnV0IGRvZXMgbm90IGFjdHVhbGx5IGFjcXVpcmUgaXQuXG4gICAgICogTWF5IHJldHVybiAnZmFsc2UnIGV2ZW4gaWYgdGhlcmUgaXMgbm8gYWN0aXZlIGxlYXNlaG9sZGVyIGFuZCBhbm90aGVyXG4gICAgICogKGZvcmVncm91bmQpIGNsaWVudCBzaG91bGQgYmVjb21lIGxlYXNlaG9sZGVyIGluc3RlYWQuXG4gICAgICovICAgIFlpKGUpIHtcbiAgICAgICAgaWYgKHRoaXMuT2kpIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSghMCk7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfcHJpbWFyeUNsaWVudFN0b3JlKGUpLmdldChaKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIC8vIEEgY2xpZW50IGlzIGVsaWdpYmxlIGZvciB0aGUgcHJpbWFyeSBsZWFzZSBpZjpcbiAgICAgICAgICAgIC8vIC0gaXRzIG5ldHdvcmsgaXMgZW5hYmxlZCBhbmQgdGhlIGNsaWVudCdzIHRhYiBpcyBpbiB0aGUgZm9yZWdyb3VuZC5cbiAgICAgICAgICAgIC8vIC0gaXRzIG5ldHdvcmsgaXMgZW5hYmxlZCBhbmQgbm8gb3RoZXIgY2xpZW50J3MgdGFiIGlzIGluIHRoZVxuICAgICAgICAgICAgLy8gICBmb3JlZ3JvdW5kLlxuICAgICAgICAgICAgLy8gLSBldmVyeSBjbGllbnRzIG5ldHdvcmsgaXMgZGlzYWJsZWQgYW5kIHRoZSBjbGllbnQncyB0YWIgaXMgaW4gdGhlXG4gICAgICAgICAgICAvLyAgIGZvcmVncm91bmQuXG4gICAgICAgICAgICAvLyAtIGV2ZXJ5IGNsaWVudHMgbmV0d29yayBpcyBkaXNhYmxlZCBhbmQgbm8gb3RoZXIgY2xpZW50J3MgdGFiIGlzIGluXG4gICAgICAgICAgICAvLyAgIHRoZSBmb3JlZ3JvdW5kLlxuICAgICAgICAgICAgLy8gLSB0aGUgYGZvcmNlT3duaW5nVGFiYCBzZXR0aW5nIHdhcyBwYXNzZWQgaW4uXG4gICAgICAgICAgICBpZiAobnVsbCAhPT0gdCAmJiB0aGlzLnJzKHQubGVhc2VUaW1lc3RhbXBNcywgcXQpICYmICF0aGlzLnVzKHQub3duZXJJZCkpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5lcyh0KSAmJiB0aGlzLm5ldHdvcmtFbmFibGVkKSByZXR1cm4gITA7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmVzKHQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdC5hbGxvd1RhYlN5bmNocm9uaXphdGlvbikgXG4gICAgICAgICAgICAgICAgICAgIC8vIEZhaWwgdGhlIGBjYW5BY3RBc1ByaW1hcnlgIGNoZWNrIGlmIHRoZSBjdXJyZW50IGxlYXNlaG9sZGVyIGhhc1xuICAgICAgICAgICAgICAgICAgICAvLyBub3Qgb3B0ZWQgaW50byBtdWx0aS10YWIgc3luY2hyb25pemF0aW9uLiBJZiB0aGlzIGhhcHBlbnMgYXRcbiAgICAgICAgICAgICAgICAgICAgLy8gY2xpZW50IHN0YXJ0dXAsIHdlIHJlamVjdCB0aGUgUHJvbWlzZSByZXR1cm5lZCBieVxuICAgICAgICAgICAgICAgICAgICAvLyBgZW5hYmxlUGVyc2lzdGVuY2UoKWAgYW5kIHRoZSB1c2VyIGNhbiBjb250aW51ZSB0byB1c2UgRmlyZXN0b3JlXG4gICAgICAgICAgICAgICAgICAgIC8vIHdpdGggaW4tbWVtb3J5IHBlcnNpc3RlbmNlLlxuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGlzIGZhaWxzIGR1cmluZyBhIGxlYXNlIHJlZnJlc2gsIHdlIHdpbGwgaW5zdGVhZCBibG9jayB0aGVcbiAgICAgICAgICAgICAgICAgICAgLy8gQXN5bmNRdWV1ZSBmcm9tIGV4ZWN1dGluZyBmdXJ0aGVyIG9wZXJhdGlvbnMuIE5vdGUgdGhhdCB0aGlzIGlzXG4gICAgICAgICAgICAgICAgICAgIC8vIGFjY2VwdGFibGUgc2luY2UgbWl4aW5nICYgbWF0Y2hpbmcgZGlmZmVyZW50IGBzeW5jaHJvbml6ZVRhYnNgXG4gICAgICAgICAgICAgICAgICAgIC8vIHNldHRpbmdzIGlzIG5vdCBzdXBwb3J0ZWQuXG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE8oYi8xMTQyMjYyMzQpOiBSZW1vdmUgdGhpcyBjaGVjayB3aGVuIGBzeW5jaHJvbml6ZVRhYnNgIGNhblxuICAgICAgICAgICAgICAgICAgICAvLyBubyBsb25nZXIgYmUgdHVybmVkIG9mZi5cbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uRkFJTEVEX1BSRUNPTkRJVElPTiwgUXQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gITE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICEoIXRoaXMubmV0d29ya0VuYWJsZWQgfHwgIXRoaXMuaW5Gb3JlZ3JvdW5kKSB8fCBfX1BSSVZBVEVfY2xpZW50TWV0YWRhdGFTdG9yZShlKS5KKCkubmV4dCgoZSA9PiB2b2lkIDAgPT09IHRoaXMuc3MoZSwgcXQpLmZpbmQoKGUgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNsaWVudElkICE9PSBlLmNsaWVudElkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSAhdGhpcy5uZXR3b3JrRW5hYmxlZCAmJiBlLm5ldHdvcmtFbmFibGVkLCBuID0gIXRoaXMuaW5Gb3JlZ3JvdW5kICYmIGUuaW5Gb3JlZ3JvdW5kLCByID0gdGhpcy5uZXR3b3JrRW5hYmxlZCA9PT0gZS5uZXR3b3JrRW5hYmxlZDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgfHwgbiAmJiByKSByZXR1cm4gITA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAhMTtcbiAgICAgICAgICAgIH0pKSkpO1xuICAgICAgICB9KSkubmV4dCgoZSA9PiAodGhpcy5pc1ByaW1hcnkgIT09IGUgJiYgX19QUklWQVRFX2xvZ0RlYnVnKEx0LCBgQ2xpZW50ICR7ZSA/IFwiaXNcIiA6IFwiaXMgbm90XCJ9IGVsaWdpYmxlIGZvciBhIHByaW1hcnkgbGVhc2UuYCksIFxuICAgICAgICBlKSkpO1xuICAgIH1cbiAgICBhc3luYyBzaHV0ZG93bigpIHtcbiAgICAgICAgLy8gVGhlIHNodXRkb3duKCkgb3BlcmF0aW9ucyBhcmUgaWRlbXBvdGVudCBhbmQgY2FuIGJlIGNhbGxlZCBldmVuIHdoZW5cbiAgICAgICAgLy8gc3RhcnQoKSBhYm9ydGVkIChlLmcuIGJlY2F1c2UgaXQgY291bGRuJ3QgYWNxdWlyZSB0aGUgcGVyc2lzdGVuY2UgbGVhc2UpLlxuICAgICAgICB0aGlzLmxpID0gITEsIHRoaXMuY3MoKSwgdGhpcy5raSAmJiAodGhpcy5raS5jYW5jZWwoKSwgdGhpcy5raSA9IG51bGwpLCB0aGlzLmxzKCksIFxuICAgICAgICB0aGlzLmhzKCksIFxuICAgICAgICAvLyBVc2UgYFNpbXBsZURiLnJ1blRyYW5zYWN0aW9uYCBkaXJlY3RseSB0byBhdm9pZCBmYWlsaW5nIGlmIGFub3RoZXIgdGFiXG4gICAgICAgIC8vIGhhcyBvYnRhaW5lZCB0aGUgcHJpbWFyeSBsZWFzZS5cbiAgICAgICAgYXdhaXQgdGhpcy5VaS5ydW5UcmFuc2FjdGlvbihcInNodXRkb3duXCIsIFwicmVhZHdyaXRlXCIsIFsgWSwgd2UgXSwgKGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgdCA9IG5ldyBfX1BSSVZBVEVfSW5kZXhlZERiVHJhbnNhY3Rpb24oZSwgX19QUklWQVRFX0xpc3RlblNlcXVlbmNlLmNlKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLlppKHQpLm5leHQoKCgpID0+IHRoaXMudHModCkpKTtcbiAgICAgICAgfSkpLCB0aGlzLlVpLmNsb3NlKCksIFxuICAgICAgICAvLyBSZW1vdmUgdGhlIGVudHJ5IG1hcmtpbmcgdGhlIGNsaWVudCBhcyB6b21iaWVkIGZyb20gTG9jYWxTdG9yYWdlIHNpbmNlXG4gICAgICAgIC8vIHdlIHN1Y2Nlc3NmdWxseSBkZWxldGVkIGl0cyBtZXRhZGF0YSBmcm9tIEluZGV4ZWREYi5cbiAgICAgICAgdGhpcy5QcygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGNsaWVudHMgdGhhdCBhcmUgbm90IHpvbWJpZWQgYW5kIGhhdmUgYW4gdXBkYXRlVGltZSB3aXRoaW4gdGhlXG4gICAgICogcHJvdmlkZWQgdGhyZXNob2xkLlxuICAgICAqLyAgICBzcyhlLCB0KSB7XG4gICAgICAgIHJldHVybiBlLmZpbHRlcigoZSA9PiB0aGlzLnJzKGUudXBkYXRlVGltZU1zLCB0KSAmJiAhdGhpcy51cyhlLmNsaWVudElkKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBJRHMgb2YgdGhlIGNsaWVudHMgdGhhdCBhcmUgY3VycmVudGx5IGFjdGl2ZS4gSWYgbXVsdGktdGFiXG4gICAgICogaXMgbm90IHN1cHBvcnRlZCwgcmV0dXJucyBhbiBhcnJheSB0aGF0IG9ubHkgY29udGFpbnMgdGhlIGxvY2FsIGNsaWVudCdzXG4gICAgICogSUQuXG4gICAgICpcbiAgICAgKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGZvciBXZWIgbXVsdGktdGFiLlxuICAgICAqLyAgICBUcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucnVuVHJhbnNhY3Rpb24oXCJnZXRBY3RpdmVDbGllbnRzXCIsIFwicmVhZG9ubHlcIiwgKGUgPT4gX19QUklWQVRFX2NsaWVudE1ldGFkYXRhU3RvcmUoZSkuSigpLm5leHQoKGUgPT4gdGhpcy5zcyhlLCBrdCkubWFwKChlID0+IGUuY2xpZW50SWQpKSkpKSk7XG4gICAgfVxuICAgIGdldCBzdGFydGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5saTtcbiAgICB9XG4gICAgZ2V0R2xvYmFsc0NhY2hlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oaTtcbiAgICB9XG4gICAgZ2V0TXV0YXRpb25RdWV1ZShlLCB0KSB7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfSW5kZXhlZERiTXV0YXRpb25RdWV1ZS53dChlLCB0aGlzLnNlcmlhbGl6ZXIsIHQsIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUpO1xuICAgIH1cbiAgICBnZXRUYXJnZXRDYWNoZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuUGk7XG4gICAgfVxuICAgIGdldFJlbW90ZURvY3VtZW50Q2FjaGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlbW90ZURvY3VtZW50Q2FjaGU7XG4gICAgfVxuICAgIGdldEluZGV4TWFuYWdlcihlKSB7XG4gICAgICAgIHJldHVybiBuZXcgX19QUklWQVRFX0luZGV4ZWREYkluZGV4TWFuYWdlcihlLCB0aGlzLnNlcmlhbGl6ZXIueXQuZGF0YWJhc2VJZCk7XG4gICAgfVxuICAgIGdldERvY3VtZW50T3ZlcmxheUNhY2hlKGUpIHtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9JbmRleGVkRGJEb2N1bWVudE92ZXJsYXlDYWNoZS53dCh0aGlzLnNlcmlhbGl6ZXIsIGUpO1xuICAgIH1cbiAgICBnZXRCdW5kbGVDYWNoZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSWk7XG4gICAgfVxuICAgIHJ1blRyYW5zYWN0aW9uKGUsIHQsIG4pIHtcbiAgICAgICAgX19QUklWQVRFX2xvZ0RlYnVnKEx0LCBcIlN0YXJ0aW5nIHRyYW5zYWN0aW9uOlwiLCBlKTtcbiAgICAgICAgY29uc3QgciA9IFwicmVhZG9ubHlcIiA9PT0gdCA/IFwicmVhZG9ubHlcIiA6IFwicmVhZHdyaXRlXCIsIGkgPSBcbiAgICAgICAgLyoqIFJldHVybnMgdGhlIG9iamVjdCBzdG9yZXMgZm9yIHRoZSBwcm92aWRlZCBzY2hlbWEuICovXG4gICAgICAgIGZ1bmN0aW9uIF9fUFJJVkFURV9nZXRPYmplY3RTdG9yZXMoZSkge1xuICAgICAgICAgICAgcmV0dXJuIDE4ID09PSBlID8gc3QgOiAxNyA9PT0gZSA/IGl0IDogMTYgPT09IGUgPyBydCA6IDE1ID09PSBlID8gbnQgOiAxNCA9PT0gZSA/IHR0IDogMTMgPT09IGUgPyBldCA6IDEyID09PSBlID8gWGUgOiAxMSA9PT0gZSA/IFplIDogdm9pZCBmYWlsKDYwMjQ1KTtcbiAgICAgICAgfSh0aGlzLk5pKTtcbiAgICAgICAgbGV0IHM7XG4gICAgICAgIC8vIERvIGFsbCB0cmFuc2FjdGlvbnMgYXMgcmVhZHdyaXRlIGFnYWluc3QgYWxsIG9iamVjdCBzdG9yZXMsIHNpbmNlIHdlXG4gICAgICAgIC8vIGFyZSB0aGUgb25seSByZWFkZXIvd3JpdGVyLlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLlVpLnJ1blRyYW5zYWN0aW9uKGUsIHIsIGksIChyID0+IChzID0gbmV3IF9fUFJJVkFURV9JbmRleGVkRGJUcmFuc2FjdGlvbihyLCB0aGlzLmNpID8gdGhpcy5jaS5uZXh0KCkgOiBfX1BSSVZBVEVfTGlzdGVuU2VxdWVuY2UuY2UpLCBcbiAgICAgICAgXCJyZWFkd3JpdGUtcHJpbWFyeVwiID09PSB0ID8gdGhpcy5IaShzKS5uZXh0KChlID0+ICEhZSB8fCB0aGlzLllpKHMpKSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBpZiAoIXQpIHRocm93IF9fUFJJVkFURV9sb2dFcnJvcihgRmFpbGVkIHRvIG9idGFpbiBwcmltYXJ5IGxlYXNlIGZvciBhY3Rpb24gJyR7ZX0nLmApLCBcbiAgICAgICAgICAgIHRoaXMuaXNQcmltYXJ5ID0gITEsIHRoaXMuTWkuZW5xdWV1ZVJldHJ5YWJsZSgoKCkgPT4gdGhpcy5RaSghMSkpKSwgbmV3IEZpcmVzdG9yZUVycm9yKE4uRkFJTEVEX1BSRUNPTkRJVElPTiwgSyk7XG4gICAgICAgICAgICByZXR1cm4gbihzKTtcbiAgICAgICAgfSkpLm5leHQoKGUgPT4gdGhpcy5YaShzKS5uZXh0KCgoKSA9PiBlKSkpKSA6IHRoaXMuSXMocykubmV4dCgoKCkgPT4gbihzKSkpKSkpLnRoZW4oKGUgPT4gKHMucmFpc2VPbkNvbW1pdHRlZEV2ZW50KCksIFxuICAgICAgICBlKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBWZXJpZmllcyB0aGF0IHRoZSBjdXJyZW50IHRhYiBpcyB0aGUgcHJpbWFyeSBsZWFzZWhvbGRlciBvciBhbHRlcm5hdGl2ZWx5XG4gICAgICogdGhhdCB0aGUgbGVhc2Vob2xkZXIgaGFzIG9wdGVkIGludG8gbXVsdGktdGFiIHN5bmNocm9uaXphdGlvbi5cbiAgICAgKi9cbiAgICAvLyBUT0RPKGIvMTE0MjI2MjM0KTogUmVtb3ZlIHRoaXMgY2hlY2sgd2hlbiBgc3luY2hyb25pemVUYWJzYCBjYW4gbm8gbG9uZ2VyXG4gICAgLy8gYmUgdHVybmVkIG9mZi5cbiAgICBJcyhlKSB7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfcHJpbWFyeUNsaWVudFN0b3JlKGUpLmdldChaKS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgIGlmIChudWxsICE9PSBlICYmIHRoaXMucnMoZS5sZWFzZVRpbWVzdGFtcE1zLCBxdCkgJiYgIXRoaXMudXMoZS5vd25lcklkKSAmJiAhdGhpcy5lcyhlKSAmJiAhKHRoaXMuT2kgfHwgdGhpcy5hbGxvd1RhYlN5bmNocm9uaXphdGlvbiAmJiBlLmFsbG93VGFiU3luY2hyb25pemF0aW9uKSkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uRkFJTEVEX1BSRUNPTkRJVElPTiwgUXQpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE9idGFpbnMgb3IgZXh0ZW5kcyB0aGUgbmV3IHByaW1hcnkgbGVhc2UgZm9yIHRoZSBsb2NhbCBjbGllbnQuIFRoaXNcbiAgICAgKiBtZXRob2QgZG9lcyBub3QgdmVyaWZ5IHRoYXQgdGhlIGNsaWVudCBpcyBlbGlnaWJsZSBmb3IgdGhpcyBsZWFzZS5cbiAgICAgKi8gICAgWGkoZSkge1xuICAgICAgICBjb25zdCB0ID0ge1xuICAgICAgICAgICAgb3duZXJJZDogdGhpcy5jbGllbnRJZCxcbiAgICAgICAgICAgIGFsbG93VGFiU3luY2hyb25pemF0aW9uOiB0aGlzLmFsbG93VGFiU3luY2hyb25pemF0aW9uLFxuICAgICAgICAgICAgbGVhc2VUaW1lc3RhbXBNczogRGF0ZS5ub3coKVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX3ByaW1hcnlDbGllbnRTdG9yZShlKS5wdXQoWiwgdCk7XG4gICAgfVxuICAgIHN0YXRpYyB2KCkge1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX1NpbXBsZURiLnYoKTtcbiAgICB9XG4gICAgLyoqIENoZWNrcyB0aGUgcHJpbWFyeSBsZWFzZSBhbmQgcmVtb3ZlcyBpdCBpZiB3ZSBhcmUgdGhlIGN1cnJlbnQgcHJpbWFyeS4gKi8gICAgWmkoZSkge1xuICAgICAgICBjb25zdCB0ID0gX19QUklWQVRFX3ByaW1hcnlDbGllbnRTdG9yZShlKTtcbiAgICAgICAgcmV0dXJuIHQuZ2V0KFopLm5leHQoKGUgPT4gdGhpcy5lcyhlKSA/IChfX1BSSVZBVEVfbG9nRGVidWcoTHQsIFwiUmVsZWFzaW5nIHByaW1hcnkgbGVhc2UuXCIpLCBcbiAgICAgICAgdC5kZWxldGUoWikpIDogUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKSkpO1xuICAgIH1cbiAgICAvKiogVmVyaWZpZXMgdGhhdCBgdXBkYXRlVGltZU1zYCBpcyB3aXRoaW4gYG1heEFnZU1zYC4gKi8gICAgcnMoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gRGF0ZS5ub3coKTtcbiAgICAgICAgcmV0dXJuICEoZSA8IG4gLSB0KSAmJiAoIShlID4gbikgfHwgKF9fUFJJVkFURV9sb2dFcnJvcihgRGV0ZWN0ZWQgYW4gdXBkYXRlIHRpbWUgdGhhdCBpcyBpbiB0aGUgZnV0dXJlOiAke2V9ID4gJHtufWApLCBcbiAgICAgICAgITEpKTtcbiAgICB9XG4gICAgR2koKSB7XG4gICAgICAgIG51bGwgIT09IHRoaXMuZG9jdW1lbnQgJiYgXCJmdW5jdGlvblwiID09IHR5cGVvZiB0aGlzLmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIgJiYgKHRoaXMuTGkgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLk1pLmVucXVldWVBbmRGb3JnZXQoKCgpID0+ICh0aGlzLmluRm9yZWdyb3VuZCA9IFwidmlzaWJsZVwiID09PSB0aGlzLmRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSwgXG4gICAgICAgICAgICB0aGlzLldpKCkpKSk7XG4gICAgICAgIH0sIHRoaXMuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIiwgdGhpcy5MaSksIHRoaXMuaW5Gb3JlZ3JvdW5kID0gXCJ2aXNpYmxlXCIgPT09IHRoaXMuZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlKTtcbiAgICB9XG4gICAgbHMoKSB7XG4gICAgICAgIHRoaXMuTGkgJiYgKHRoaXMuZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIiwgdGhpcy5MaSksIHRoaXMuTGkgPSBudWxsKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXR0YWNoZXMgYSB3aW5kb3cudW5sb2FkIGhhbmRsZXIgdGhhdCB3aWxsIHN5bmNocm9ub3VzbHkgd3JpdGUgb3VyXG4gICAgICogY2xpZW50SWQgdG8gYSBcInpvbWJpZSBjbGllbnQgaWRcIiBsb2NhdGlvbiBpbiBMb2NhbFN0b3JhZ2UuIFRoaXMgY2FuIGJlIHVzZWRcbiAgICAgKiBieSB0YWJzIHRyeWluZyB0byBhY3F1aXJlIHRoZSBwcmltYXJ5IGxlYXNlIHRvIGRldGVybWluZSB0aGF0IHRoZSBsZWFzZVxuICAgICAqIGlzIG5vIGxvbmdlciB2YWxpZCBldmVuIGlmIHRoZSB0aW1lc3RhbXAgaXMgcmVjZW50LiBUaGlzIGlzIHBhcnRpY3VsYXJseVxuICAgICAqIGltcG9ydGFudCBmb3IgdGhlIHJlZnJlc2ggY2FzZSAoc28gdGhlIHRhYiBjb3JyZWN0bHkgcmUtYWNxdWlyZXMgdGhlXG4gICAgICogcHJpbWFyeSBsZWFzZSkuIExvY2FsU3RvcmFnZSBpcyB1c2VkIGZvciB0aGlzIHJhdGhlciB0aGFuIEluZGV4ZWREYiBiZWNhdXNlXG4gICAgICogaXQgaXMgYSBzeW5jaHJvbm91cyBBUEkgYW5kIHNvIGNhbiBiZSB1c2VkIHJlbGlhYmx5IGZyb20gIGFuIHVubG9hZFxuICAgICAqIGhhbmRsZXIuXG4gICAgICovICAgIHppKCkge1xuICAgICAgICBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIHRoaXMud2luZG93Py5hZGRFdmVudExpc3RlbmVyICYmICh0aGlzLkJpID0gKCkgPT4ge1xuICAgICAgICAgICAgLy8gTm90ZTogSW4gdGhlb3J5LCB0aGlzIHNob3VsZCBiZSBzY2hlZHVsZWQgb24gdGhlIEFzeW5jUXVldWUgc2luY2UgaXRcbiAgICAgICAgICAgIC8vIGFjY2Vzc2VzIGludGVybmFsIHN0YXRlLiBXZSBleGVjdXRlIHRoaXMgY29kZSBkaXJlY3RseSBkdXJpbmcgc2h1dGRvd25cbiAgICAgICAgICAgIC8vIHRvIG1ha2Ugc3VyZSBpdCBnZXRzIGEgY2hhbmNlIHRvIHJ1bi5cbiAgICAgICAgICAgIHRoaXMuY3MoKTtcbiAgICAgICAgICAgIGNvbnN0IGUgPSAvKD86VmVyc2lvbnxNb2JpbGUpXFwvMVs0NTZdLztcbiAgICAgICAgICAgIGlzU2FmYXJpKCkgJiYgKG5hdmlnYXRvci5hcHBWZXJzaW9uLm1hdGNoKGUpIHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goZSkpICYmIFxuICAgICAgICAgICAgLy8gT24gU2FmYXJpIDE0LCAxNSwgYW5kIDE2LCB3ZSBkbyBub3QgcnVuIGFueSBjbGVhbnVwIGFjdGlvbnMgYXMgaXQgbWlnaHRcbiAgICAgICAgICAgIC8vIHRyaWdnZXIgYSBidWcgdGhhdCBwcmV2ZW50cyBTYWZhcmkgZnJvbSByZS1vcGVuaW5nIEluZGV4ZWREQiBkdXJpbmdcbiAgICAgICAgICAgIC8vIHRoZSBuZXh0IHBhZ2UgbG9hZC5cbiAgICAgICAgICAgIC8vIFNlZSBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MjI2NTQ3XG4gICAgICAgICAgICB0aGlzLk1pLmVudGVyUmVzdHJpY3RlZE1vZGUoLyogcHVyZ2VFeGlzdGluZ1Rhc2tzPSAqLyAhMCksIHRoaXMuTWkuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gdGhpcy5zaHV0ZG93bigpKSk7XG4gICAgICAgIH0sIHRoaXMud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJwYWdlaGlkZVwiLCB0aGlzLkJpKSk7XG4gICAgfVxuICAgIGhzKCkge1xuICAgICAgICB0aGlzLkJpICYmICh0aGlzLndpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwicGFnZWhpZGVcIiwgdGhpcy5CaSksIHRoaXMuQmkgPSBudWxsKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB3aGV0aGVyIGEgY2xpZW50IGlzIFwiem9tYmllZFwiIGJhc2VkIG9uIGl0cyBMb2NhbFN0b3JhZ2UgZW50cnkuXG4gICAgICogQ2xpZW50cyBiZWNvbWUgem9tYmllZCB3aGVuIHRoZWlyIHRhYiBjbG9zZXMgd2l0aG91dCBydW5uaW5nIGFsbCBvZiB0aGVcbiAgICAgKiBjbGVhbnVwIGxvZ2ljIGluIGBzaHV0ZG93bigpYC5cbiAgICAgKi8gICAgdXMoZSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgdCA9IG51bGwgIT09IHRoaXMuS2k/LmdldEl0ZW0odGhpcy5fcyhlKSk7XG4gICAgICAgICAgICByZXR1cm4gX19QUklWQVRFX2xvZ0RlYnVnKEx0LCBgQ2xpZW50ICcke2V9JyAke3QgPyBcImlzXCIgOiBcImlzIG5vdFwifSB6b21iaWVkIGluIExvY2FsU3RvcmFnZWApLCBcbiAgICAgICAgICAgIHQ7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIC8vIEdyYWNlZnVsbHkgaGFuZGxlIGlmIExvY2FsU3RvcmFnZSBpc24ndCB3b3JraW5nLlxuICAgICAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9sb2dFcnJvcihMdCwgXCJGYWlsZWQgdG8gZ2V0IHpvbWJpZWQgY2xpZW50IGlkLlwiLCBlKSwgITE7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVjb3JkIGNsaWVudCBhcyB6b21iaWVkIChhIGNsaWVudCB0aGF0IGhhZCBpdHMgdGFiIGNsb3NlZCkuIFpvbWJpZWRcbiAgICAgKiBjbGllbnRzIGFyZSBpZ25vcmVkIGR1cmluZyBwcmltYXJ5IHRhYiBzZWxlY3Rpb24uXG4gICAgICovICAgIGNzKCkge1xuICAgICAgICBpZiAodGhpcy5LaSkgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuS2kuc2V0SXRlbSh0aGlzLl9zKHRoaXMuY2xpZW50SWQpLCBTdHJpbmcoRGF0ZS5ub3coKSkpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAvLyBHcmFjZWZ1bGx5IGhhbmRsZSBpZiBMb2NhbFN0b3JhZ2UgaXNuJ3QgYXZhaWxhYmxlIC8gd29ya2luZy5cbiAgICAgICAgICAgIF9fUFJJVkFURV9sb2dFcnJvcihcIkZhaWxlZCB0byBzZXQgem9tYmllIGNsaWVudCBpZC5cIiwgZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqIFJlbW92ZXMgdGhlIHpvbWJpZWQgY2xpZW50IGVudHJ5IGlmIGl0IGV4aXN0cy4gKi8gICAgUHMoKSB7XG4gICAgICAgIGlmICh0aGlzLktpKSB0cnkge1xuICAgICAgICAgICAgdGhpcy5LaS5yZW1vdmVJdGVtKHRoaXMuX3ModGhpcy5jbGllbnRJZCkpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAvLyBJZ25vcmVcbiAgICAgICAgfVxuICAgIH1cbiAgICBfcyhlKSB7XG4gICAgICAgIHJldHVybiBgZmlyZXN0b3JlX3pvbWJpZV8ke3RoaXMucGVyc2lzdGVuY2VLZXl9XyR7ZX1gO1xuICAgIH1cbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIHByaW1hcnkgY2xpZW50IG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfcHJpbWFyeUNsaWVudFN0b3JlKGUpIHtcbiAgICByZXR1cm4gX19QUklWQVRFX2dldFN0b3JlKGUsIFkpO1xufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgY2xpZW50IG1ldGFkYXRhIG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfY2xpZW50TWV0YWRhdGFTdG9yZShlKSB7XG4gICAgcmV0dXJuIF9fUFJJVkFURV9nZXRTdG9yZShlLCB3ZSk7XG59XG5cbi8qKlxuICogR2VuZXJhdGVzIGEgc3RyaW5nIHVzZWQgYXMgYSBwcmVmaXggd2hlbiBzdG9yaW5nIGRhdGEgaW4gSW5kZXhlZERCIGFuZFxuICogTG9jYWxTdG9yYWdlLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9pbmRleGVkRGJTdG9yYWdlUHJlZml4KGUsIHQpIHtcbiAgICAvLyBVc2UgdHdvIGRpZmZlcmVudCBwcmVmaXggZm9ybWF0czpcbiAgICAvLyAgICogZmlyZXN0b3JlIC8gcGVyc2lzdGVuY2VLZXkgLyBwcm9qZWN0SUQgLiBkYXRhYmFzZUlEIC8gLi4uXG4gICAgLy8gICAqIGZpcmVzdG9yZSAvIHBlcnNpc3RlbmNlS2V5IC8gcHJvamVjdElEIC8gLi4uXG4gICAgLy8gcHJvamVjdElEcyBhcmUgRE5TLWNvbXBhdGlibGUgbmFtZXMgYW5kIGNhbm5vdCBjb250YWluIGRvdHNcbiAgICAvLyBzbyB0aGVyZSdzIG5vIGRhbmdlciBvZiBjb2xsaXNpb25zLlxuICAgIGxldCBuID0gZS5wcm9qZWN0SWQ7XG4gICAgcmV0dXJuIGUuaXNEZWZhdWx0RGF0YWJhc2UgfHwgKG4gKz0gXCIuXCIgKyBlLmRhdGFiYXNlKSwgXCJmaXJlc3RvcmUvXCIgKyB0ICsgXCIvXCIgKyBuICsgXCIvXCI7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgc2V0IG9mIGNoYW5nZXMgdG8gd2hhdCBkb2N1bWVudHMgYXJlIGN1cnJlbnRseSBpbiB2aWV3IGFuZCBvdXQgb2YgdmlldyBmb3JcbiAqIGEgZ2l2ZW4gcXVlcnkuIFRoZXNlIGNoYW5nZXMgYXJlIHNlbnQgdG8gdGhlIExvY2FsU3RvcmUgYnkgdGhlIFZpZXcgKHZpYVxuICogdGhlIFN5bmNFbmdpbmUpIGFuZCBhcmUgdXNlZCB0byBwaW4gLyB1bnBpbiBkb2N1bWVudHMgYXMgYXBwcm9wcmlhdGUuXG4gKi9cbmNsYXNzIF9fUFJJVkFURV9Mb2NhbFZpZXdDaGFuZ2VzIHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0LCBuLCByKSB7XG4gICAgICAgIHRoaXMudGFyZ2V0SWQgPSBlLCB0aGlzLmZyb21DYWNoZSA9IHQsIHRoaXMuRXMgPSBuLCB0aGlzLmRzID0gcjtcbiAgICB9XG4gICAgc3RhdGljIEFzKGUsIHQpIHtcbiAgICAgICAgbGV0IG4gPSBfX1BSSVZBVEVfZG9jdW1lbnRLZXlTZXQoKSwgciA9IF9fUFJJVkFURV9kb2N1bWVudEtleVNldCgpO1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdC5kb2NDaGFuZ2VzKSBzd2l0Y2ggKGUudHlwZSkge1xuICAgICAgICAgIGNhc2UgMCAvKiBDaGFuZ2VUeXBlLkFkZGVkICovIDpcbiAgICAgICAgICAgIG4gPSBuLmFkZChlLmRvYy5rZXkpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIDEgLyogQ2hhbmdlVHlwZS5SZW1vdmVkICovIDpcbiAgICAgICAgICAgIHIgPSByLmFkZChlLmRvYy5rZXkpO1xuIC8vIGRvIG5vdGhpbmdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgX19QUklWQVRFX0xvY2FsVmlld0NoYW5nZXMoZSwgdC5mcm9tQ2FjaGUsIG4sIHIpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSB0cmFja2VyIHRvIGtlZXAgYSByZWNvcmQgb2YgaW1wb3J0YW50IGRldGFpbHMgZHVyaW5nIGRhdGFiYXNlIGxvY2FsIHF1ZXJ5XG4gKiBleGVjdXRpb24uXG4gKi8gY2xhc3MgUXVlcnlDb250ZXh0IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvdW50cyB0aGUgbnVtYmVyIG9mIGRvY3VtZW50cyBwYXNzZWQgdGhyb3VnaCBkdXJpbmcgbG9jYWwgcXVlcnkgZXhlY3V0aW9uLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fZG9jdW1lbnRSZWFkQ291bnQgPSAwO1xuICAgIH1cbiAgICBnZXQgZG9jdW1lbnRSZWFkQ291bnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kb2N1bWVudFJlYWRDb3VudDtcbiAgICB9XG4gICAgaW5jcmVtZW50RG9jdW1lbnRSZWFkQ291bnQoZSkge1xuICAgICAgICB0aGlzLl9kb2N1bWVudFJlYWRDb3VudCArPSBlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVGhlIEZpcmVzdG9yZSBxdWVyeSBlbmdpbmUuXG4gKlxuICogRmlyZXN0b3JlIHF1ZXJpZXMgY2FuIGJlIGV4ZWN1dGVkIGluIHRocmVlIG1vZGVzLiBUaGUgUXVlcnkgRW5naW5lIGRldGVybWluZXNcbiAqIHdoYXQgbW9kZSB0byB1c2UgYmFzZWQgb24gd2hhdCBkYXRhIGlzIHBlcnNpc3RlZC4gVGhlIG1vZGUgb25seSBkZXRlcm1pbmVzXG4gKiB0aGUgcnVudGltZSBjb21wbGV4aXR5IG9mIHRoZSBxdWVyeSAtIHRoZSByZXN1bHQgc2V0IGlzIGVxdWl2YWxlbnQgYWNyb3NzIGFsbFxuICogaW1wbGVtZW50YXRpb25zLlxuICpcbiAqIFRoZSBRdWVyeSBlbmdpbmUgd2lsbCB1c2UgaW5kZXhlZC1iYXNlZCBleGVjdXRpb24gaWYgYSB1c2VyIGhhcyBjb25maWd1cmVkXG4gKiBhbnkgaW5kZXggdGhhdCBjYW4gYmUgdXNlZCB0byBleGVjdXRlIHF1ZXJ5ICh2aWEgYHNldEluZGV4Q29uZmlndXJhdGlvbigpYCkuXG4gKiBPdGhlcndpc2UsIHRoZSBlbmdpbmUgd2lsbCB0cnkgdG8gb3B0aW1pemUgdGhlIHF1ZXJ5IGJ5IHJlLXVzaW5nIGEgcHJldmlvdXNseVxuICogcGVyc2lzdGVkIHF1ZXJ5IHJlc3VsdC4gSWYgdGhhdCBpcyBub3QgcG9zc2libGUsIHRoZSBxdWVyeSB3aWxsIGJlIGV4ZWN1dGVkXG4gKiB2aWEgYSBmdWxsIGNvbGxlY3Rpb24gc2Nhbi5cbiAqXG4gKiBJbmRleC1iYXNlZCBleGVjdXRpb24gaXMgdGhlIGRlZmF1bHQgd2hlbiBhdmFpbGFibGUuIFRoZSBxdWVyeSBlbmdpbmVcbiAqIHN1cHBvcnRzIHBhcnRpYWwgaW5kZXhlZCBleGVjdXRpb24gYW5kIG1lcmdlcyB0aGUgcmVzdWx0IGZyb20gdGhlIGluZGV4XG4gKiBsb29rdXAgd2l0aCBkb2N1bWVudHMgdGhhdCBoYXZlIG5vdCB5ZXQgYmVlbiBpbmRleGVkLiBUaGUgaW5kZXggZXZhbHVhdGlvblxuICogbWF0Y2hlcyB0aGUgYmFja2VuZCdzIGZvcm1hdCBhbmQgYXMgc3VjaCwgdGhlIFNESyBjYW4gdXNlIGluZGV4aW5nIGZvciBhbGxcbiAqIHF1ZXJpZXMgdGhhdCB0aGUgYmFja2VuZCBzdXBwb3J0cy5cbiAqXG4gKiBJZiBubyBpbmRleCBleGlzdHMsIHRoZSBxdWVyeSBlbmdpbmUgdHJpZXMgdG8gdGFrZSBhZHZhbnRhZ2Ugb2YgdGhlIHRhcmdldFxuICogZG9jdW1lbnQgbWFwcGluZyBpbiB0aGUgVGFyZ2V0Q2FjaGUuIFRoZXNlIG1hcHBpbmdzIGV4aXN0cyBmb3IgYWxsIHF1ZXJpZXNcbiAqIHRoYXQgaGF2ZSBiZWVuIHN5bmNlZCB3aXRoIHRoZSBiYWNrZW5kIGF0IGxlYXN0IG9uY2UgYW5kIGFsbG93IHRoZSBxdWVyeVxuICogZW5naW5lIHRvIG9ubHkgcmVhZCBkb2N1bWVudHMgdGhhdCBwcmV2aW91c2x5IG1hdGNoZWQgYSBxdWVyeSBwbHVzIGFueVxuICogZG9jdW1lbnRzIHRoYXQgd2VyZSBlZGl0ZWQgYWZ0ZXIgdGhlIHF1ZXJ5IHdhcyBsYXN0IGxpc3RlbmVkIHRvLlxuICpcbiAqIFRoZXJlIGFyZSBzb21lIGNhc2VzIHdoZW4gdGhpcyBvcHRpbWl6YXRpb24gaXMgbm90IGd1YXJhbnRlZWQgdG8gcHJvZHVjZVxuICogdGhlIHNhbWUgcmVzdWx0cyBhcyBmdWxsIGNvbGxlY3Rpb24gc2NhbnMuIEluIHRoZXNlIGNhc2VzLCBxdWVyeVxuICogcHJvY2Vzc2luZyBmYWxscyBiYWNrIHRvIGZ1bGwgc2NhbnMuIFRoZXNlIGNhc2VzIGFyZTpcbiAqXG4gKiAtIExpbWl0IHF1ZXJpZXMgd2hlcmUgYSBkb2N1bWVudCB0aGF0IG1hdGNoZWQgdGhlIHF1ZXJ5IHByZXZpb3VzbHkgbm8gbG9uZ2VyXG4gKiAgIG1hdGNoZXMgdGhlIHF1ZXJ5LlxuICpcbiAqIC0gTGltaXQgcXVlcmllcyB3aGVyZSBhIGRvY3VtZW50IGVkaXQgbWF5IGNhdXNlIHRoZSBkb2N1bWVudCB0byBzb3J0IGJlbG93XG4gKiAgIGFub3RoZXIgZG9jdW1lbnQgdGhhdCBpcyBpbiB0aGUgbG9jYWwgY2FjaGUuXG4gKlxuICogLSBRdWVyaWVzIHRoYXQgaGF2ZSBuZXZlciBiZWVuIENVUlJFTlQgb3IgZnJlZSBvZiBsaW1ibyBkb2N1bWVudHMuXG4gKi9cbmNsYXNzIF9fUFJJVkFURV9RdWVyeUVuZ2luZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuUnMgPSAhMSwgdGhpcy5WcyA9ICExLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNESyBvbmx5IGRlY2lkZXMgd2hldGhlciBpdCBzaG91bGQgY3JlYXRlIGluZGV4IHdoZW4gY29sbGVjdGlvbiBzaXplIGlzXG4gICAgICAgICAqIGxhcmdlciB0aGFuIHRoaXMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZzID0gMTAwLCB0aGlzLmdzID0gXG4gICAgICAgIC8qKlxuICogVGhpcyBjb3N0IHJlcHJlc2VudHMgdGhlIGV2YWx1YXRpb24gcmVzdWx0IG9mXG4gKiAoKFtpbmRleCwgZG9jS2V5XSArIFtkb2NLZXksIGRvY0NvbnRlbnRdKSBwZXIgZG9jdW1lbnQgaW4gdGhlIHJlc3VsdCBzZXQpXG4gKiAvIChbZG9jS2V5LCBkb2NDb250ZW50XSBwZXIgZG9jdW1lbnRzIGluIGZ1bGwgY29sbGVjdGlvbiBzY2FuKSBjb21pbmcgZnJvbVxuICogZXhwZXJpbWVudCBbZW50ZXIgUFIgZXhwZXJpbWVudCBVUkwgaGVyZV0uXG4gKi9cbiAgICAgICAgZnVuY3Rpb24gX19QUklWQVRFX2dldERlZmF1bHRSZWxhdGl2ZUluZGV4UmVhZENvc3RQZXJEb2N1bWVudCgpIHtcbiAgICAgICAgICAgIC8vIFRoZXNlIHZhbHVlcyB3ZXJlIGRlcml2ZWQgZnJvbSBhbiBleHBlcmltZW50IHdoZXJlIHNldmVyYWwgbWVtYmVycyBvZiB0aGVcbiAgICAgICAgICAgIC8vIEZpcmVzdG9yZSBTREsgdGVhbSByYW4gYSBwZXJmb3JtYW5jZSB0ZXN0IGluIHZhcmlvdXMgZW52aXJvbm1lbnRzLlxuICAgICAgICAgICAgLy8gR29vZ2xlcnMgY2FuIHNlZSBiLzI5OTI4NDI4NyBmb3IgZGV0YWlscy5cbiAgICAgICAgICAgIHJldHVybiBpc1NhZmFyaSgpID8gOCA6IF9fUFJJVkFURV9nZXRBbmRyb2lkVmVyc2lvbihnZXRVQSgpKSA+IDAgPyA2IDogNDtcbiAgICAgICAgfSgpO1xuICAgIH1cbiAgICAvKiogU2V0cyB0aGUgZG9jdW1lbnQgdmlldyB0byBxdWVyeSBhZ2FpbnN0LiAqLyAgICBpbml0aWFsaXplKGUsIHQpIHtcbiAgICAgICAgdGhpcy5wcyA9IGUsIHRoaXMuaW5kZXhNYW5hZ2VyID0gdCwgdGhpcy5ScyA9ICEwO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhbGwgbG9jYWwgZG9jdW1lbnRzIG1hdGNoaW5nIHRoZSBzcGVjaWZpZWQgcXVlcnkuICovICAgIGdldERvY3VtZW50c01hdGNoaW5nUXVlcnkoZSwgdCwgbiwgcikge1xuICAgICAgICAvLyBTdG9yZXMgdGhlIHJlc3VsdCBmcm9tIGV4ZWN1dGluZyB0aGUgcXVlcnk7IHVzaW5nIHRoaXMgb2JqZWN0IGlzIG1vcmVcbiAgICAgICAgLy8gY29udmVuaWVudCB0aGFuIHBhc3NpbmcgdGhlIHJlc3VsdCBiZXR3ZWVuIHN0ZXBzIG9mIHRoZSBwZXJzaXN0ZW5jZVxuICAgICAgICAvLyB0cmFuc2FjdGlvbiBhbmQgaW1wcm92ZXMgcmVhZGFiaWxpdHkgY29tcGFyYXRpdmVseS5cbiAgICAgICAgY29uc3QgaSA9IHtcbiAgICAgICAgICAgIHJlc3VsdDogbnVsbFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdGhpcy55cyhlLCB0KS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgIGkucmVzdWx0ID0gZTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIGlmICghaS5yZXN1bHQpIHJldHVybiB0aGlzLndzKGUsIHQsIHIsIG4pLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgICAgIGkucmVzdWx0ID0gZTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIGlmIChpLnJlc3VsdCkgcmV0dXJuO1xuICAgICAgICAgICAgY29uc3QgbiA9IG5ldyBRdWVyeUNvbnRleHQ7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5TcyhlLCB0LCBuKS5uZXh0KChyID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoaS5yZXN1bHQgPSByLCB0aGlzLlZzKSByZXR1cm4gdGhpcy5icyhlLCB0LCBuLCByLnNpemUpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gaS5yZXN1bHQpKTtcbiAgICB9XG4gICAgYnMoZSwgdCwgbiwgcikge1xuICAgICAgICByZXR1cm4gbi5kb2N1bWVudFJlYWRDb3VudCA8IHRoaXMuZnMgPyAoX19QUklWQVRFX2dldExvZ0xldmVsKCkgPD0gTG9nTGV2ZWwuREVCVUcgJiYgX19QUklWQVRFX2xvZ0RlYnVnKFwiUXVlcnlFbmdpbmVcIiwgXCJTREsgd2lsbCBub3QgY3JlYXRlIGNhY2hlIGluZGV4ZXMgZm9yIHF1ZXJ5OlwiLCBfX1BSSVZBVEVfc3RyaW5naWZ5UXVlcnkodCksIFwic2luY2UgaXQgb25seSBjcmVhdGVzIGNhY2hlIGluZGV4ZXMgZm9yIGNvbGxlY3Rpb24gY29udGFpbnNcIiwgXCJtb3JlIHRoYW4gb3IgZXF1YWwgdG9cIiwgdGhpcy5mcywgXCJkb2N1bWVudHNcIiksIFxuICAgICAgICBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpKSA6IChfX1BSSVZBVEVfZ2V0TG9nTGV2ZWwoKSA8PSBMb2dMZXZlbC5ERUJVRyAmJiBfX1BSSVZBVEVfbG9nRGVidWcoXCJRdWVyeUVuZ2luZVwiLCBcIlF1ZXJ5OlwiLCBfX1BSSVZBVEVfc3RyaW5naWZ5UXVlcnkodCksIFwic2NhbnNcIiwgbi5kb2N1bWVudFJlYWRDb3VudCwgXCJsb2NhbCBkb2N1bWVudHMgYW5kIHJldHVybnNcIiwgciwgXCJkb2N1bWVudHMgYXMgcmVzdWx0cy5cIiksIFxuICAgICAgICBuLmRvY3VtZW50UmVhZENvdW50ID4gdGhpcy5ncyAqIHIgPyAoX19QUklWQVRFX2dldExvZ0xldmVsKCkgPD0gTG9nTGV2ZWwuREVCVUcgJiYgX19QUklWQVRFX2xvZ0RlYnVnKFwiUXVlcnlFbmdpbmVcIiwgXCJUaGUgU0RLIGRlY2lkZXMgdG8gY3JlYXRlIGNhY2hlIGluZGV4ZXMgZm9yIHF1ZXJ5OlwiLCBfX1BSSVZBVEVfc3RyaW5naWZ5UXVlcnkodCksIFwiYXMgdXNpbmcgY2FjaGUgaW5kZXhlcyBtYXkgaGVscCBpbXByb3ZlIHBlcmZvcm1hbmNlLlwiKSwgXG4gICAgICAgIHRoaXMuaW5kZXhNYW5hZ2VyLmNyZWF0ZVRhcmdldEluZGV4ZXMoZSwgX19QUklWQVRFX3F1ZXJ5VG9UYXJnZXQodCkpKSA6IFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtcyBhbiBpbmRleGVkIHF1ZXJ5IHRoYXQgZXZhbHVhdGVzIHRoZSBxdWVyeSBiYXNlZCBvbiBhIGNvbGxlY3Rpb24nc1xuICAgICAqIHBlcnNpc3RlZCBpbmRleCB2YWx1ZXMuIFJldHVybnMgYG51bGxgIGlmIGFuIGluZGV4IGlzIG5vdCBhdmFpbGFibGUuXG4gICAgICovICAgIHlzKGUsIHQpIHtcbiAgICAgICAgaWYgKF9fUFJJVkFURV9xdWVyeU1hdGNoZXNBbGxEb2N1bWVudHModCkpIFxuICAgICAgICAvLyBRdWVyaWVzIHRoYXQgbWF0Y2ggYWxsIGRvY3VtZW50cyBkb24ndCBiZW5lZml0IGZyb20gdXNpbmdcbiAgICAgICAgLy8ga2V5LWJhc2VkIGxvb2t1cHMuIEl0IGlzIG1vcmUgZWZmaWNpZW50IHRvIHNjYW4gYWxsIGRvY3VtZW50cyBpbiBhXG4gICAgICAgIC8vIGNvbGxlY3Rpb24sIHJhdGhlciB0aGFuIHRvIHBlcmZvcm0gaW5kaXZpZHVhbCBsb29rdXBzLlxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUobnVsbCk7XG4gICAgICAgIGxldCBuID0gX19QUklWQVRFX3F1ZXJ5VG9UYXJnZXQodCk7XG4gICAgICAgIHJldHVybiB0aGlzLmluZGV4TWFuYWdlci5nZXRJbmRleFR5cGUoZSwgbikubmV4dCgociA9PiAwIC8qIEluZGV4VHlwZS5OT05FICovID09PSByID8gbnVsbCA6IChudWxsICE9PSB0LmxpbWl0ICYmIDEgLyogSW5kZXhUeXBlLlBBUlRJQUwgKi8gPT09IHIgJiYgKFxuICAgICAgICAvLyBXZSBjYW5ub3QgYXBwbHkgYSBsaW1pdCBmb3IgdGFyZ2V0cyB0aGF0IGFyZSBzZXJ2ZWQgdXNpbmcgYSBwYXJ0aWFsXG4gICAgICAgIC8vIGluZGV4LiBJZiBhIHBhcnRpYWwgaW5kZXggd2lsbCBiZSB1c2VkIHRvIHNlcnZlIHRoZSB0YXJnZXQsIHRoZVxuICAgICAgICAvLyBxdWVyeSBtYXkgcmV0dXJuIGEgc3VwZXJzZXQgb2YgZG9jdW1lbnRzIHRoYXQgbWF0Y2ggdGhlIHRhcmdldFxuICAgICAgICAvLyAoZS5nLiBpZiB0aGUgaW5kZXggZG9lc24ndCBpbmNsdWRlIGFsbCB0aGUgdGFyZ2V0J3MgZmlsdGVycyksIG9yXG4gICAgICAgIC8vIG1heSByZXR1cm4gdGhlIGNvcnJlY3Qgc2V0IG9mIGRvY3VtZW50cyBpbiB0aGUgd3Jvbmcgb3JkZXIgKGUuZy4gaWZcbiAgICAgICAgLy8gdGhlIGluZGV4IGRvZXNuJ3QgaW5jbHVkZSBhIHNlZ21lbnQgZm9yIG9uZSBvZiB0aGUgb3JkZXJCeXMpLlxuICAgICAgICAvLyBUaGVyZWZvcmUsIGEgbGltaXQgc2hvdWxkIG5vdCBiZSBhcHBsaWVkIGluIHN1Y2ggY2FzZXMuXG4gICAgICAgIHQgPSBfX1BSSVZBVEVfcXVlcnlXaXRoTGltaXQodCwgbnVsbCwgXCJGXCIgLyogTGltaXRUeXBlLkZpcnN0ICovKSwgbiA9IF9fUFJJVkFURV9xdWVyeVRvVGFyZ2V0KHQpKSwgXG4gICAgICAgIHRoaXMuaW5kZXhNYW5hZ2VyLmdldERvY3VtZW50c01hdGNoaW5nVGFyZ2V0KGUsIG4pLm5leHQoKHIgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IF9fUFJJVkFURV9kb2N1bWVudEtleVNldCguLi5yKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBzLmdldERvY3VtZW50cyhlLCBpKS5uZXh0KChyID0+IHRoaXMuaW5kZXhNYW5hZ2VyLmdldE1pbk9mZnNldChlLCBuKS5uZXh0KChuID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gdGhpcy5Ecyh0LCByKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5Dcyh0LCBzLCBpLCBuLnJlYWRUaW1lKSA/IHRoaXMueXMoZSwgX19QUklWQVRFX3F1ZXJ5V2l0aExpbWl0KHQsIG51bGwsIFwiRlwiIC8qIExpbWl0VHlwZS5GaXJzdCAqLykpIDogdGhpcy52cyhlLCBzLCB0LCBuKTtcbiAgICAgICAgICAgIH0pKSkpO1xuICAgICAgICB9KSkpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBlcmZvcm1zIGEgcXVlcnkgYmFzZWQgb24gdGhlIHRhcmdldCdzIHBlcnNpc3RlZCBxdWVyeSBtYXBwaW5nLiBSZXR1cm5zXG4gICAgICogYG51bGxgIGlmIHRoZSBtYXBwaW5nIGlzIG5vdCBhdmFpbGFibGUgb3IgY2Fubm90IGJlIHVzZWQuXG4gICAgICovICAgIHdzKGUsIHQsIG4sIHIpIHtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9xdWVyeU1hdGNoZXNBbGxEb2N1bWVudHModCkgfHwgci5pc0VxdWFsKFNuYXBzaG90VmVyc2lvbi5taW4oKSkgPyBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShudWxsKSA6IHRoaXMucHMuZ2V0RG9jdW1lbnRzKGUsIG4pLm5leHQoKGkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IHRoaXMuRHModCwgaSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5Dcyh0LCBzLCBuLCByKSA/IFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKG51bGwpIDogKF9fUFJJVkFURV9nZXRMb2dMZXZlbCgpIDw9IExvZ0xldmVsLkRFQlVHICYmIF9fUFJJVkFURV9sb2dEZWJ1ZyhcIlF1ZXJ5RW5naW5lXCIsIFwiUmUtdXNpbmcgcHJldmlvdXMgcmVzdWx0IGZyb20gJXMgdG8gZXhlY3V0ZSBxdWVyeTogJXNcIiwgci50b1N0cmluZygpLCBfX1BSSVZBVEVfc3RyaW5naWZ5UXVlcnkodCkpLCBcbiAgICAgICAgICAgIHRoaXMudnMoZSwgcywgdCwgX19QUklWQVRFX25ld0luZGV4T2Zmc2V0U3VjY2Vzc29yRnJvbVJlYWRUaW1lKHIsIFUpKS5uZXh0KChlID0+IGUpKSk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgLy8gUXVlcmllcyB0aGF0IGhhdmUgbmV2ZXIgc2VlbiBhIHNuYXBzaG90IHdpdGhvdXQgbGltYm8gZnJlZSBkb2N1bWVudHNcbiAgICAgICAgLy8gc2hvdWxkIGFsc28gYmUgcnVuIGFzIGEgZnVsbCBjb2xsZWN0aW9uIHNjYW4uXG4gICAgICAgIH1cbiAgICAvKiogQXBwbGllcyB0aGUgcXVlcnkgZmlsdGVyIGFuZCBzb3J0aW5nIHRvIHRoZSBwcm92aWRlZCBkb2N1bWVudHMuICAqLyAgICBEcyhlLCB0KSB7XG4gICAgICAgIC8vIFNvcnQgdGhlIGRvY3VtZW50cyBhbmQgcmUtYXBwbHkgdGhlIHF1ZXJ5IGZpbHRlciBzaW5jZSBwcmV2aW91c2x5XG4gICAgICAgIC8vIG1hdGNoaW5nIGRvY3VtZW50cyBkbyBub3QgbmVjZXNzYXJpbHkgc3RpbGwgbWF0Y2ggdGhlIHF1ZXJ5LlxuICAgICAgICBsZXQgbiA9IG5ldyBTb3J0ZWRTZXQoX19QUklWQVRFX25ld1F1ZXJ5Q29tcGFyYXRvcihlKSk7XG4gICAgICAgIHJldHVybiB0LmZvckVhY2goKCh0LCByKSA9PiB7XG4gICAgICAgICAgICBfX1BSSVZBVEVfcXVlcnlNYXRjaGVzKGUsIHIpICYmIChuID0gbi5hZGQocikpO1xuICAgICAgICB9KSksIG47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERldGVybWluZXMgaWYgYSBsaW1pdCBxdWVyeSBuZWVkcyB0byBiZSByZWZpbGxlZCBmcm9tIGNhY2hlLCBtYWtpbmcgaXRcbiAgICAgKiBpbmVsaWdpYmxlIGZvciBpbmRleC1mcmVlIGV4ZWN1dGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBxdWVyeSAtIFRoZSBxdWVyeS5cbiAgICAgKiBAcGFyYW0gc29ydGVkUHJldmlvdXNSZXN1bHRzIC0gVGhlIGRvY3VtZW50cyB0aGF0IG1hdGNoZWQgdGhlIHF1ZXJ5IHdoZW4gaXRcbiAgICAgKiB3YXMgbGFzdCBzeW5jaHJvbml6ZWQsIHNvcnRlZCBieSB0aGUgcXVlcnkncyBjb21wYXJhdG9yLlxuICAgICAqIEBwYXJhbSByZW1vdGVLZXlzIC0gVGhlIGRvY3VtZW50IGtleXMgdGhhdCBtYXRjaGVkIHRoZSBxdWVyeSBhdCB0aGUgbGFzdFxuICAgICAqIHNuYXBzaG90LlxuICAgICAqIEBwYXJhbSBsaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24gLSBUaGUgdmVyc2lvbiBvZiB0aGUgc25hcHNob3Qgd2hlbiB0aGVcbiAgICAgKiBxdWVyeSB3YXMgbGFzdCBzeW5jaHJvbml6ZWQuXG4gICAgICovICAgIENzKGUsIHQsIG4sIHIpIHtcbiAgICAgICAgaWYgKG51bGwgPT09IGUubGltaXQpIFxuICAgICAgICAvLyBRdWVyaWVzIHdpdGhvdXQgbGltaXRzIGRvIG5vdCBuZWVkIHRvIGJlIHJlZmlsbGVkLlxuICAgICAgICByZXR1cm4gITE7XG4gICAgICAgIGlmIChuLnNpemUgIT09IHQuc2l6ZSkgXG4gICAgICAgIC8vIFRoZSBxdWVyeSBuZWVkcyB0byBiZSByZWZpbGxlZCBpZiBhIHByZXZpb3VzbHkgbWF0Y2hpbmcgZG9jdW1lbnQgbm9cbiAgICAgICAgLy8gbG9uZ2VyIG1hdGNoZXMuXG4gICAgICAgIHJldHVybiAhMDtcbiAgICAgICAgLy8gTGltaXQgcXVlcmllcyBhcmUgbm90IGVsaWdpYmxlIGZvciBpbmRleC1mcmVlIHF1ZXJ5IGV4ZWN1dGlvbiBpZiB0aGVyZSBpc1xuICAgICAgICAvLyBhIHBvdGVudGlhbCB0aGF0IGFuIG9sZGVyIGRvY3VtZW50IGZyb20gY2FjaGUgbm93IHNvcnRzIGJlZm9yZSBhIGRvY3VtZW50XG4gICAgICAgIC8vIHRoYXQgd2FzIHByZXZpb3VzbHkgcGFydCBvZiB0aGUgbGltaXQuIFRoaXMsIGhvd2V2ZXIsIGNhbiBvbmx5IGhhcHBlbiBpZlxuICAgICAgICAvLyB0aGUgZG9jdW1lbnQgYXQgdGhlIGVkZ2Ugb2YgdGhlIGxpbWl0IGdvZXMgb3V0IG9mIGxpbWl0LlxuICAgICAgICAvLyBJZiBhIGRvY3VtZW50IHRoYXQgaXMgbm90IHRoZSBsaW1pdCBib3VuZGFyeSBzb3J0cyBkaWZmZXJlbnRseSxcbiAgICAgICAgLy8gdGhlIGJvdW5kYXJ5IG9mIHRoZSBsaW1pdCBpdHNlbGYgZGlkIG5vdCBjaGFuZ2UgYW5kIGRvY3VtZW50cyBmcm9tIGNhY2hlXG4gICAgICAgIC8vIHdpbGwgY29udGludWUgdG8gYmUgXCJyZWplY3RlZFwiIGJ5IHRoaXMgYm91bmRhcnkuIFRoZXJlZm9yZSwgd2UgY2FuIGlnbm9yZVxuICAgICAgICAvLyBhbnkgbW9kaWZpY2F0aW9ucyB0aGF0IGRvbid0IGFmZmVjdCB0aGUgbGFzdCBkb2N1bWVudC5cbiAgICAgICAgICAgICAgICBjb25zdCBpID0gXCJGXCIgLyogTGltaXRUeXBlLkZpcnN0ICovID09PSBlLmxpbWl0VHlwZSA/IHQubGFzdCgpIDogdC5maXJzdCgpO1xuICAgICAgICByZXR1cm4gISFpICYmIChpLmhhc1BlbmRpbmdXcml0ZXMgfHwgaS52ZXJzaW9uLmNvbXBhcmVUbyhyKSA+IDApO1xuICAgIH1cbiAgICBTcyhlLCB0LCBuKSB7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfZ2V0TG9nTGV2ZWwoKSA8PSBMb2dMZXZlbC5ERUJVRyAmJiBfX1BSSVZBVEVfbG9nRGVidWcoXCJRdWVyeUVuZ2luZVwiLCBcIlVzaW5nIGZ1bGwgY29sbGVjdGlvbiBzY2FuIHRvIGV4ZWN1dGUgcXVlcnk6XCIsIF9fUFJJVkFURV9zdHJpbmdpZnlRdWVyeSh0KSksIFxuICAgICAgICB0aGlzLnBzLmdldERvY3VtZW50c01hdGNoaW5nUXVlcnkoZSwgdCwgSW5kZXhPZmZzZXQubWluKCksIG4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb21iaW5lcyB0aGUgcmVzdWx0cyBmcm9tIGFuIGluZGV4ZWQgZXhlY3V0aW9uIHdpdGggdGhlIHJlbWFpbmluZyBkb2N1bWVudHNcbiAgICAgKiB0aGF0IGhhdmUgbm90IHlldCBiZWVuIGluZGV4ZWQuXG4gICAgICovICAgIHZzKGUsIHQsIG4sIHIpIHtcbiAgICAgICAgLy8gUmV0cmlldmUgYWxsIHJlc3VsdHMgZm9yIGRvY3VtZW50cyB0aGF0IHdlcmUgdXBkYXRlZCBzaW5jZSB0aGUgb2Zmc2V0LlxuICAgICAgICByZXR1cm4gdGhpcy5wcy5nZXREb2N1bWVudHNNYXRjaGluZ1F1ZXJ5KGUsIG4sIHIpLm5leHQoKGUgPT4gKFxuICAgICAgICAvLyBNZXJnZSB3aXRoIGV4aXN0aW5nIHJlc3VsdHNcbiAgICAgICAgdC5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIGUgPSBlLmluc2VydCh0LmtleSwgdCk7XG4gICAgICAgIH0pKSwgZSkpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IFV0ID0gXCJMb2NhbFN0b3JlXCIsIEt0ID0gM2U4O1xuXG4vKipcbiAqIFRoZSBtYXhpbXVtIHRpbWUgdG8gbGVhdmUgYSByZXN1bWUgdG9rZW4gYnVmZmVyZWQgd2l0aG91dCB3cml0aW5nIGl0IG91dC5cbiAqIFRoaXMgdmFsdWUgaXMgYXJiaXRyYXJ5OiBpdCdzIGxvbmcgZW5vdWdoIHRvIGF2b2lkIHNldmVyYWwgd3JpdGVzXG4gKiAocG9zc2libHkgaW5kZWZpbml0ZWx5IGlmIHVwZGF0ZXMgY29tZSBtb3JlIGZyZXF1ZW50bHkgdGhhbiB0aGlzKSBidXRcbiAqIHNob3J0IGVub3VnaCB0aGF0IHJlc3RhcnRpbmcgYWZ0ZXIgY3Jhc2hpbmcgd2lsbCBzdGlsbCBoYXZlIGEgcHJldHR5XG4gKiByZWNlbnQgcmVzdW1lIHRva2VuLlxuICovXG4vKipcbiAqIEltcGxlbWVudHMgYExvY2FsU3RvcmVgIGludGVyZmFjZS5cbiAqXG4gKiBOb3RlOiBzb21lIGZpZWxkIGRlZmluZWQgaW4gdGhpcyBjbGFzcyBtaWdodCBoYXZlIHB1YmxpYyBhY2Nlc3MgbGV2ZWwsIGJ1dFxuICogdGhlIGNsYXNzIGlzIG5vdCBleHBvcnRlZCBzbyB0aGV5IGFyZSBvbmx5IGFjY2Vzc2libGUgZnJvbSB0aGlzIG1vZHVsZS5cbiAqIFRoaXMgaXMgdXNlZnVsIHRvIGltcGxlbWVudCBvcHRpb25hbCBmZWF0dXJlcyAobGlrZSBidW5kbGVzKSBpbiBmcmVlXG4gKiBmdW5jdGlvbnMsIHN1Y2ggdGhhdCB0aGV5IGFyZSB0cmVlLXNoYWtlYWJsZS5cbiAqL1xuY2xhc3MgX19QUklWQVRFX0xvY2FsU3RvcmVJbXBsIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogTWFuYWdlcyBvdXIgaW4tbWVtb3J5IG9yIGR1cmFibGUgcGVyc2lzdGVuY2UuICovXG4gICAgZSwgdCwgbiwgcikge1xuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gZSwgdGhpcy5GcyA9IHQsIHRoaXMuc2VyaWFsaXplciA9IHIsIFxuICAgICAgICAvKipcbiAgICAgICAgICogTWFwcyBhIHRhcmdldElEIHRvIGRhdGEgYWJvdXQgaXRzIHRhcmdldC5cbiAgICAgICAgICpcbiAgICAgICAgICogUE9SVElORyBOT1RFOiBXZSBhcmUgdXNpbmcgYW4gaW1tdXRhYmxlIGRhdGEgc3RydWN0dXJlIG9uIFdlYiB0byBtYWtlIHJlLXJ1bnNcbiAgICAgICAgICogb2YgYGFwcGx5UmVtb3RlRXZlbnQoKWAgaWRlbXBvdGVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuTXMgPSBuZXcgU29ydGVkTWFwKF9fUFJJVkFURV9wcmltaXRpdmVDb21wYXJhdG9yKSwgXG4gICAgICAgIC8qKiBNYXBzIGEgdGFyZ2V0IHRvIGl0cyB0YXJnZXRJRC4gKi9cbiAgICAgICAgLy8gVE9ETyh3dWFuZHkpOiBFdmFsdWF0ZSBpZiBUYXJnZXRJZCBjYW4gYmUgcGFydCBvZiBUYXJnZXQuXG4gICAgICAgIHRoaXMueHMgPSBuZXcgT2JqZWN0TWFwKChlID0+IF9fUFJJVkFURV9jYW5vbmlmeVRhcmdldChlKSksIF9fUFJJVkFURV90YXJnZXRFcXVhbHMpLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgcGVyIGNvbGxlY3Rpb24gZ3JvdXAgaW5kZXggb2YgdGhlIGxhc3QgcmVhZCB0aW1lIHByb2Nlc3NlZCBieVxuICAgICAgICAgKiBgZ2V0TmV3RG9jdW1lbnRDaGFuZ2VzKClgLlxuICAgICAgICAgKlxuICAgICAgICAgKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGZvciBtdWx0aS10YWIgc3luY2hyb25pemF0aW9uLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5PcyA9IG5ldyBNYXAsIHRoaXMuTnMgPSBlLmdldFJlbW90ZURvY3VtZW50Q2FjaGUoKSwgdGhpcy5QaSA9IGUuZ2V0VGFyZ2V0Q2FjaGUoKSwgXG4gICAgICAgIHRoaXMuSWkgPSBlLmdldEJ1bmRsZUNhY2hlKCksIHRoaXMuQnMobik7XG4gICAgfVxuICAgIEJzKGUpIHtcbiAgICAgICAgLy8gVE9ETyhpbmRleGluZyk6IEFkZCBzcGVjIHRlc3RzIHRoYXQgdGVzdCB0aGVzZSBjb21wb25lbnRzIGNoYW5nZSBhZnRlciBhXG4gICAgICAgIC8vIHVzZXIgY2hhbmdlXG4gICAgICAgIHRoaXMuZG9jdW1lbnRPdmVybGF5Q2FjaGUgPSB0aGlzLnBlcnNpc3RlbmNlLmdldERvY3VtZW50T3ZlcmxheUNhY2hlKGUpLCB0aGlzLmluZGV4TWFuYWdlciA9IHRoaXMucGVyc2lzdGVuY2UuZ2V0SW5kZXhNYW5hZ2VyKGUpLCBcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlID0gdGhpcy5wZXJzaXN0ZW5jZS5nZXRNdXRhdGlvblF1ZXVlKGUsIHRoaXMuaW5kZXhNYW5hZ2VyKSwgdGhpcy5sb2NhbERvY3VtZW50cyA9IG5ldyBMb2NhbERvY3VtZW50c1ZpZXcodGhpcy5OcywgdGhpcy5tdXRhdGlvblF1ZXVlLCB0aGlzLmRvY3VtZW50T3ZlcmxheUNhY2hlLCB0aGlzLmluZGV4TWFuYWdlciksIFxuICAgICAgICB0aGlzLk5zLnNldEluZGV4TWFuYWdlcih0aGlzLmluZGV4TWFuYWdlciksIHRoaXMuRnMuaW5pdGlhbGl6ZSh0aGlzLmxvY2FsRG9jdW1lbnRzLCB0aGlzLmluZGV4TWFuYWdlcik7XG4gICAgfVxuICAgIGNvbGxlY3RHYXJiYWdlKGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJDb2xsZWN0IGdhcmJhZ2VcIiwgXCJyZWFkd3JpdGUtcHJpbWFyeVwiLCAodCA9PiBlLmNvbGxlY3QodCwgdGhpcy5NcykpKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9uZXdMb2NhbFN0b3JlKFxuLyoqIE1hbmFnZXMgb3VyIGluLW1lbW9yeSBvciBkdXJhYmxlIHBlcnNpc3RlbmNlLiAqL1xuZSwgdCwgbiwgcikge1xuICAgIHJldHVybiBuZXcgX19QUklWQVRFX0xvY2FsU3RvcmVJbXBsKGUsIHQsIG4sIHIpO1xufVxuXG4vKipcbiAqIFRlbGxzIHRoZSBMb2NhbFN0b3JlIHRoYXQgdGhlIGN1cnJlbnRseSBhdXRoZW50aWNhdGVkIHVzZXIgaGFzIGNoYW5nZWQuXG4gKlxuICogSW4gcmVzcG9uc2UgdGhlIGxvY2FsIHN0b3JlIHN3aXRjaGVzIHRoZSBtdXRhdGlvbiBxdWV1ZSB0byB0aGUgbmV3IHVzZXIgYW5kXG4gKiByZXR1cm5zIGFueSByZXN1bHRpbmcgZG9jdW1lbnQgY2hhbmdlcy5cbiAqL1xuLy8gUE9SVElORyBOT1RFOiBBbmRyb2lkIGFuZCBpT1Mgb25seSByZXR1cm4gdGhlIGRvY3VtZW50cyBhZmZlY3RlZCBieSB0aGVcbi8vIGNoYW5nZS5cbmFzeW5jIGZ1bmN0aW9uIF9fUFJJVkFURV9sb2NhbFN0b3JlSGFuZGxlVXNlckNoYW5nZShlLCB0KSB7XG4gICAgY29uc3QgbiA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgcmV0dXJuIGF3YWl0IG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJIYW5kbGUgdXNlciBjaGFuZ2VcIiwgXCJyZWFkb25seVwiLCAoZSA9PiB7XG4gICAgICAgIC8vIFN3YXAgb3V0IHRoZSBtdXRhdGlvbiBxdWV1ZSwgZ3JhYmJpbmcgdGhlIHBlbmRpbmcgbXV0YXRpb24gYmF0Y2hlc1xuICAgICAgICAvLyBiZWZvcmUgYW5kIGFmdGVyLlxuICAgICAgICBsZXQgcjtcbiAgICAgICAgcmV0dXJuIG4ubXV0YXRpb25RdWV1ZS5nZXRBbGxNdXRhdGlvbkJhdGNoZXMoZSkubmV4dCgoaSA9PiAociA9IGksIG4uQnModCksIG4ubXV0YXRpb25RdWV1ZS5nZXRBbGxNdXRhdGlvbkJhdGNoZXMoZSkpKSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gW10sIHMgPSBbXTtcbiAgICAgICAgICAgIC8vIFVuaW9uIHRoZSBvbGQvbmV3IGNoYW5nZWQga2V5cy5cbiAgICAgICAgICAgIGxldCBvID0gX19QUklWQVRFX2RvY3VtZW50S2V5U2V0KCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2Ygcikge1xuICAgICAgICAgICAgICAgIGkucHVzaChlLmJhdGNoSWQpO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBlLm11dGF0aW9ucykgbyA9IG8uYWRkKHQua2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XG4gICAgICAgICAgICAgICAgcy5wdXNoKGUuYmF0Y2hJZCk7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGUubXV0YXRpb25zKSBvID0gby5hZGQodC5rZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gUmV0dXJuIHRoZSBzZXQgb2YgYWxsIChwb3RlbnRpYWxseSkgY2hhbmdlZCBkb2N1bWVudHMgYW5kIHRoZSBsaXN0XG4gICAgICAgICAgICAvLyBvZiBtdXRhdGlvbiBiYXRjaCBJRHMgdGhhdCB3ZXJlIGFmZmVjdGVkIGJ5IGNoYW5nZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuLmxvY2FsRG9jdW1lbnRzLmdldERvY3VtZW50cyhlLCBvKS5uZXh0KChlID0+ICh7XG4gICAgICAgICAgICAgICAgTHM6IGUsXG4gICAgICAgICAgICAgICAgcmVtb3ZlZEJhdGNoSWRzOiBpLFxuICAgICAgICAgICAgICAgIGFkZGVkQmF0Y2hJZHM6IHNcbiAgICAgICAgICAgIH0pKSk7XG4gICAgICAgIH0pKTtcbiAgICB9KSk7XG59XG5cbi8qIEFjY2VwdHMgbG9jYWxseSBnZW5lcmF0ZWQgTXV0YXRpb25zIGFuZCBjb21taXQgdGhlbSB0byBzdG9yYWdlLiAqL1xuLyoqXG4gKiBBY2tub3dsZWRnZXMgdGhlIGdpdmVuIGJhdGNoLlxuICpcbiAqIE9uIHRoZSBoYXBweSBwYXRoIHdoZW4gYSBiYXRjaCBpcyBhY2tub3dsZWRnZWQsIHRoZSBsb2NhbCBzdG9yZSB3aWxsXG4gKlxuICogICsgcmVtb3ZlIHRoZSBiYXRjaCBmcm9tIHRoZSBtdXRhdGlvbiBxdWV1ZTtcbiAqICArIGFwcGx5IHRoZSBjaGFuZ2VzIHRvIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGU7XG4gKiAgKyByZWNhbGN1bGF0ZSB0aGUgbGF0ZW5jeSBjb21wZW5zYXRlZCB2aWV3IGltcGxpZWQgYnkgdGhvc2UgY2hhbmdlcyAodGhlcmVcbiAqICAgIG1heSBiZSBtdXRhdGlvbnMgaW4gdGhlIHF1ZXVlIHRoYXQgYWZmZWN0IHRoZSBkb2N1bWVudHMgYnV0IGhhdmVuJ3QgYmVlblxuICogICAgYWNrbm93bGVkZ2VkIHlldCk7IGFuZFxuICogICsgZ2l2ZSB0aGUgY2hhbmdlZCBkb2N1bWVudHMgYmFjayB0aGUgc3luYyBlbmdpbmVcbiAqXG4gKiBAcmV0dXJucyBUaGUgcmVzdWx0aW5nIChtb2RpZmllZCkgZG9jdW1lbnRzLlxuICovXG5mdW5jdGlvbiBfX1BSSVZBVEVfbG9jYWxTdG9yZUFja25vd2xlZGdlQmF0Y2goZSwgdCkge1xuICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpO1xuICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiQWNrbm93bGVkZ2UgYmF0Y2hcIiwgXCJyZWFkd3JpdGUtcHJpbWFyeVwiLCAoZSA9PiB7XG4gICAgICAgIGNvbnN0IHIgPSB0LmJhdGNoLmtleXMoKSwgaSA9IG4uTnMubmV3Q2hhbmdlQnVmZmVyKHtcbiAgICAgICAgICAgIHRyYWNrUmVtb3ZhbHM6ICEwXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX2FwcGx5V3JpdGVUb1JlbW90ZURvY3VtZW50cyhlLCB0LCBuLCByKSB7XG4gICAgICAgICAgICBjb25zdCBpID0gbi5iYXRjaCwgcyA9IGkua2V5cygpO1xuICAgICAgICAgICAgbGV0IG8gPSBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHMuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgbyA9IG8ubmV4dCgoKCkgPT4gci5nZXRFbnRyeSh0LCBlKSkpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gbi5kb2NWZXJzaW9ucy5nZXQoZSk7XG4gICAgICAgICAgICAgICAgICAgIF9fUFJJVkFURV9oYXJkQXNzZXJ0KG51bGwgIT09IHMsIDQ4NTQxKSwgdC52ZXJzaW9uLmNvbXBhcmVUbyhzKSA8IDAgJiYgKGkuYXBwbHlUb1JlbW90ZURvY3VtZW50KHQsIG4pLCBcbiAgICAgICAgICAgICAgICAgICAgdC5pc1ZhbGlkRG9jdW1lbnQoKSAmJiAoXG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIHVzZSB0aGUgY29tbWl0VmVyc2lvbiBhcyB0aGUgcmVhZFRpbWUgcmF0aGVyIHRoYW4gdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vIGRvY3VtZW50J3MgdXBkYXRlVGltZSBzaW5jZSB0aGUgdXBkYXRlVGltZSBpcyBub3QgYWR2YW5jZWRcbiAgICAgICAgICAgICAgICAgICAgLy8gZm9yIHVwZGF0ZXMgdGhhdCBkbyBub3QgbW9kaWZ5IHRoZSB1bmRlcmx5aW5nIGRvY3VtZW50LlxuICAgICAgICAgICAgICAgICAgICB0LnNldFJlYWRUaW1lKG4uY29tbWl0VmVyc2lvbiksIHIuYWRkRW50cnkodCkpKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9KSksIG8ubmV4dCgoKCkgPT4gZS5tdXRhdGlvblF1ZXVlLnJlbW92ZU11dGF0aW9uQmF0Y2godCwgaSkpKTtcbiAgICAgICAgfVxuICAgICAgICAvKiogUmV0dXJucyB0aGUgbG9jYWwgdmlldyBvZiB0aGUgZG9jdW1lbnRzIGFmZmVjdGVkIGJ5IGEgbXV0YXRpb24gYmF0Y2guICovXG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG4gICAgICAgIChuLCBlLCB0LCBpKS5uZXh0KCgoKSA9PiBpLmFwcGx5KGUpKSkubmV4dCgoKCkgPT4gbi5tdXRhdGlvblF1ZXVlLnBlcmZvcm1Db25zaXN0ZW5jeUNoZWNrKGUpKSkubmV4dCgoKCkgPT4gbi5kb2N1bWVudE92ZXJsYXlDYWNoZS5yZW1vdmVPdmVybGF5c0ZvckJhdGNoSWQoZSwgciwgdC5iYXRjaC5iYXRjaElkKSkpLm5leHQoKCgpID0+IG4ubG9jYWxEb2N1bWVudHMucmVjYWxjdWxhdGVBbmRTYXZlT3ZlcmxheXNGb3JEb2N1bWVudEtleXMoZSwgZnVuY3Rpb24gX19QUklWQVRFX2dldEtleXNXaXRoVHJhbnNmb3JtUmVzdWx0cyhlKSB7XG4gICAgICAgICAgICBsZXQgdCA9IF9fUFJJVkFURV9kb2N1bWVudEtleVNldCgpO1xuICAgICAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCBlLm11dGF0aW9uUmVzdWx0cy5sZW5ndGg7ICsrbikge1xuICAgICAgICAgICAgICAgIGUubXV0YXRpb25SZXN1bHRzW25dLnRyYW5zZm9ybVJlc3VsdHMubGVuZ3RoID4gMCAmJiAodCA9IHQuYWRkKGUuYmF0Y2gubXV0YXRpb25zW25dLmtleSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHQ7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBSZW1vdmVzIG11dGF0aW9ucyBmcm9tIHRoZSBNdXRhdGlvblF1ZXVlIGZvciB0aGUgc3BlY2lmaWVkIGJhdGNoO1xuICogTG9jYWxEb2N1bWVudHMgd2lsbCBiZSByZWNhbGN1bGF0ZWQuXG4gKlxuICogQHJldHVybnMgVGhlIHJlc3VsdGluZyBtb2RpZmllZCBkb2N1bWVudHMuXG4gKi8gKHQpKSkpLm5leHQoKCgpID0+IG4ubG9jYWxEb2N1bWVudHMuZ2V0RG9jdW1lbnRzKGUsIHIpKSk7XG4gICAgfSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGxhc3QgY29uc2lzdGVudCBzbmFwc2hvdCBwcm9jZXNzZWQgKHVzZWQgYnkgdGhlIFJlbW90ZVN0b3JlIHRvXG4gKiBkZXRlcm1pbmUgd2hldGhlciB0byBidWZmZXIgaW5jb21pbmcgc25hcHNob3RzIGZyb20gdGhlIGJhY2tlbmQpLlxuICovXG5mdW5jdGlvbiBfX1BSSVZBVEVfbG9jYWxTdG9yZUdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24oZSkge1xuICAgIGNvbnN0IHQgPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpO1xuICAgIHJldHVybiB0LnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiR2V0IGxhc3QgcmVtb3RlIHNuYXBzaG90IHZlcnNpb25cIiwgXCJyZWFkb25seVwiLCAoZSA9PiB0LlBpLmdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24oZSkpKTtcbn1cblxuLyoqXG4gKiBVcGRhdGVzIHRoZSBcImdyb3VuZC1zdGF0ZVwiIChyZW1vdGUpIGRvY3VtZW50cy4gV2UgYXNzdW1lIHRoYXQgdGhlIHJlbW90ZVxuICogZXZlbnQgcmVmbGVjdHMgYW55IHdyaXRlIGJhdGNoZXMgdGhhdCBoYXZlIGJlZW4gYWNrbm93bGVkZ2VkIG9yIHJlamVjdGVkXG4gKiAoaS5lLiB3ZSBkbyBub3QgcmUtYXBwbHkgbG9jYWwgbXV0YXRpb25zIHRvIHVwZGF0ZXMgZnJvbSB0aGlzIGV2ZW50KS5cbiAqXG4gKiBMb2NhbERvY3VtZW50cyBhcmUgcmUtY2FsY3VsYXRlZCBpZiB0aGVyZSBhcmUgcmVtYWluaW5nIG11dGF0aW9ucyBpbiB0aGVcbiAqIHF1ZXVlLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9sb2NhbFN0b3JlQXBwbHlSZW1vdGVFdmVudFRvTG9jYWxDYWNoZShlLCB0KSB7XG4gICAgY29uc3QgbiA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSksIHIgPSB0LnNuYXBzaG90VmVyc2lvbjtcbiAgICBsZXQgaSA9IG4uTXM7XG4gICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJBcHBseSByZW1vdGUgZXZlbnRcIiwgXCJyZWFkd3JpdGUtcHJpbWFyeVwiLCAoZSA9PiB7XG4gICAgICAgIGNvbnN0IHMgPSBuLk5zLm5ld0NoYW5nZUJ1ZmZlcih7XG4gICAgICAgICAgICB0cmFja1JlbW92YWxzOiAhMFxuICAgICAgICB9KTtcbiAgICAgICAgLy8gUmVzZXQgbmV3VGFyZ2V0RGF0YUJ5VGFyZ2V0TWFwIGluIGNhc2UgdGhpcyB0cmFuc2FjdGlvbiBnZXRzIHJlLXJ1bi5cbiAgICAgICAgICAgICAgICBpID0gbi5NcztcbiAgICAgICAgY29uc3QgbyA9IFtdO1xuICAgICAgICB0LnRhcmdldENoYW5nZXMuZm9yRWFjaCgoKHMsIF8pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGEgPSBpLmdldChfKTtcbiAgICAgICAgICAgIGlmICghYSkgcmV0dXJuO1xuICAgICAgICAgICAgLy8gT25seSB1cGRhdGUgdGhlIHJlbW90ZSBrZXlzIGlmIHRoZSB0YXJnZXQgaXMgc3RpbGwgYWN0aXZlLiBUaGlzXG4gICAgICAgICAgICAvLyBlbnN1cmVzIHRoYXQgd2UgY2FuIHBlcnNpc3QgdGhlIHVwZGF0ZWQgdGFyZ2V0IGRhdGEgYWxvbmcgd2l0aFxuICAgICAgICAgICAgLy8gdGhlIHVwZGF0ZWQgYXNzaWdubWVudC5cbiAgICAgICAgICAgICAgICAgICAgICAgIG8ucHVzaChuLlBpLnJlbW92ZU1hdGNoaW5nS2V5cyhlLCBzLnJlbW92ZWREb2N1bWVudHMsIF8pLm5leHQoKCgpID0+IG4uUGkuYWRkTWF0Y2hpbmdLZXlzKGUsIHMuYWRkZWREb2N1bWVudHMsIF8pKSkpO1xuICAgICAgICAgICAgbGV0IHUgPSBhLndpdGhTZXF1ZW5jZU51bWJlcihlLmN1cnJlbnRTZXF1ZW5jZU51bWJlcik7XG4gICAgICAgICAgICBudWxsICE9PSB0LnRhcmdldE1pc21hdGNoZXMuZ2V0KF8pID8gdSA9IHUud2l0aFJlc3VtZVRva2VuKEJ5dGVTdHJpbmcuRU1QVFlfQllURV9TVFJJTkcsIFNuYXBzaG90VmVyc2lvbi5taW4oKSkud2l0aExhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24oU25hcHNob3RWZXJzaW9uLm1pbigpKSA6IHMucmVzdW1lVG9rZW4uYXBwcm94aW1hdGVCeXRlU2l6ZSgpID4gMCAmJiAodSA9IHUud2l0aFJlc3VtZVRva2VuKHMucmVzdW1lVG9rZW4sIHIpKSwgXG4gICAgICAgICAgICBpID0gaS5pbnNlcnQoXywgdSksIFxuICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSB0YXJnZXQgZGF0YSBpZiB0aGVyZSBhcmUgdGFyZ2V0IGNoYW5nZXMgKG9yIGlmXG4gICAgICAgICAgICAvLyBzdWZmaWNpZW50IHRpbWUgaGFzIHBhc3NlZCBzaW5jZSB0aGUgbGFzdCB1cGRhdGUpLlxuICAgICAgICAgICAgLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIG5ld1RhcmdldERhdGEgc2hvdWxkIGJlIHBlcnNpc3RlZCBkdXJpbmcgYW4gdXBkYXRlIG9mXG4gKiBhbiBhY3RpdmUgdGFyZ2V0LiBUYXJnZXREYXRhIHNob3VsZCBhbHdheXMgYmUgcGVyc2lzdGVkIHdoZW4gYSB0YXJnZXQgaXNcbiAqIGJlaW5nIHJlbGVhc2VkIGFuZCBzaG91bGQgbm90IGNhbGwgdGhpcyBmdW5jdGlvbi5cbiAqXG4gKiBXaGlsZSB0aGUgdGFyZ2V0IGlzIGFjdGl2ZSwgVGFyZ2V0RGF0YSB1cGRhdGVzIGNhbiBiZSBvbWl0dGVkIHdoZW4gbm90aGluZ1xuICogYWJvdXQgdGhlIHRhcmdldCBoYXMgY2hhbmdlZCBleGNlcHQgbWV0YWRhdGEgbGlrZSB0aGUgcmVzdW1lIHRva2VuIG9yXG4gKiBzbmFwc2hvdCB2ZXJzaW9uLiBPY2Nhc2lvbmFsbHkgaXQncyB3b3J0aCB0aGUgZXh0cmEgd3JpdGUgdG8gcHJldmVudCB0aGVzZVxuICogdmFsdWVzIGZyb20gZ2V0dGluZyB0b28gc3RhbGUgYWZ0ZXIgYSBjcmFzaCwgYnV0IHRoaXMgZG9lc24ndCBoYXZlIHRvIGJlXG4gKiB0b28gZnJlcXVlbnQuXG4gKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uIF9fUFJJVkFURV9zaG91bGRQZXJzaXN0VGFyZ2V0RGF0YShlLCB0LCBuKSB7XG4gICAgICAgICAgICAgICAgLy8gQWx3YXlzIHBlcnNpc3QgdGFyZ2V0IGRhdGEgaWYgd2UgZG9uJ3QgYWxyZWFkeSBoYXZlIGEgcmVzdW1lIHRva2VuLlxuICAgICAgICAgICAgICAgIGlmICgwID09PSBlLnJlc3VtZVRva2VuLmFwcHJveGltYXRlQnl0ZVNpemUoKSkgcmV0dXJuICEwO1xuICAgICAgICAgICAgICAgIC8vIERvbid0IGFsbG93IHJlc3VtZSB0b2tlbiBjaGFuZ2VzIHRvIGJlIGJ1ZmZlcmVkIGluZGVmaW5pdGVseS4gVGhpc1xuICAgICAgICAgICAgICAgIC8vIGFsbG93cyB1cyB0byBiZSByZWFzb25hYmx5IHVwLXRvLWRhdGUgYWZ0ZXIgYSBjcmFzaCBhbmQgYXZvaWRzIG5lZWRpbmdcbiAgICAgICAgICAgICAgICAvLyB0byBsb29wIG92ZXIgYWxsIGFjdGl2ZSBxdWVyaWVzIG9uIHNodXRkb3duLiBFc3BlY2lhbGx5IGluIHRoZSBicm93c2VyXG4gICAgICAgICAgICAgICAgLy8gd2UgbWF5IG5vdCBnZXQgdGltZSB0byBkbyBhbnl0aGluZyBpbnRlcmVzdGluZyB3aGlsZSB0aGUgY3VycmVudCB0YWIgaXNcbiAgICAgICAgICAgICAgICAvLyBjbG9zaW5nLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gdC5zbmFwc2hvdFZlcnNpb24udG9NaWNyb3NlY29uZHMoKSAtIGUuc25hcHNob3RWZXJzaW9uLnRvTWljcm9zZWNvbmRzKCk7XG4gICAgICAgICAgICAgICAgaWYgKHIgPj0gS3QpIHJldHVybiAhMDtcbiAgICAgICAgICAgICAgICAvLyBPdGhlcndpc2UgaWYgdGhlIG9ubHkgdGhpbmcgdGhhdCBoYXMgY2hhbmdlZCBhYm91dCBhIHRhcmdldCBpcyBpdHMgcmVzdW1lXG4gICAgICAgICAgICAgICAgLy8gdG9rZW4gaXQncyBub3Qgd29ydGggcGVyc2lzdGluZy4gTm90ZSB0aGF0IHRoZSBSZW1vdGVTdG9yZSBrZWVwcyBhblxuICAgICAgICAgICAgICAgIC8vIGluLW1lbW9yeSB2aWV3IG9mIHRoZSBjdXJyZW50bHkgYWN0aXZlIHRhcmdldHMgd2hpY2ggaW5jbHVkZXMgdGhlIGN1cnJlbnRcbiAgICAgICAgICAgICAgICAvLyByZXN1bWUgdG9rZW4sIHNvIHN0cmVhbSBmYWlsdXJlIG9yIHVzZXIgY2hhbmdlcyB3aWxsIHN0aWxsIHVzZSBhblxuICAgICAgICAgICAgICAgIC8vIHVwLXRvLWRhdGUgcmVzdW1lIHRva2VuIHJlZ2FyZGxlc3Mgb2Ygd2hhdCB3ZSBkbyBoZXJlLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gbi5hZGRlZERvY3VtZW50cy5zaXplICsgbi5tb2RpZmllZERvY3VtZW50cy5zaXplICsgbi5yZW1vdmVkRG9jdW1lbnRzLnNpemU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGkgPiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gKiBOb3RpZmllcyBsb2NhbCBzdG9yZSBvZiB0aGUgY2hhbmdlZCB2aWV3cyB0byBsb2NhbGx5IHBpbiBkb2N1bWVudHMuXG4gKi8gKGEsIHUsIHMpICYmIG8ucHVzaChuLlBpLnVwZGF0ZVRhcmdldERhdGEoZSwgdSkpO1xuICAgICAgICB9KSk7XG4gICAgICAgIGxldCBfID0gX19QUklWQVRFX211dGFibGVEb2N1bWVudE1hcCgpLCBhID0gX19QUklWQVRFX2RvY3VtZW50S2V5U2V0KCk7XG4gICAgICAgIC8vIEhBQ0s6IFRoZSBvbmx5IHJlYXNvbiB3ZSBhbGxvdyBhIG51bGwgc25hcHNob3QgdmVyc2lvbiBpcyBzbyB0aGF0IHdlXG4gICAgICAgIC8vIGNhbiBzeW50aGVzaXplIHJlbW90ZSBldmVudHMgd2hlbiB3ZSBnZXQgcGVybWlzc2lvbiBkZW5pZWQgZXJyb3JzIHdoaWxlXG4gICAgICAgIC8vIHRyeWluZyB0byByZXNvbHZlIHRoZSBzdGF0ZSBvZiBhIGxvY2FsbHkgY2FjaGVkIGRvY3VtZW50IHRoYXQgaXMgaW5cbiAgICAgICAgLy8gbGltYm8uXG4gICAgICAgIGlmICh0LmRvY3VtZW50VXBkYXRlcy5mb3JFYWNoKChyID0+IHtcbiAgICAgICAgICAgIHQucmVzb2x2ZWRMaW1ib0RvY3VtZW50cy5oYXMocikgJiYgby5wdXNoKG4ucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUudXBkYXRlTGltYm9Eb2N1bWVudChlLCByKSk7XG4gICAgICAgIH0pKSwgXG4gICAgICAgIC8vIEVhY2ggbG9vcCBpdGVyYXRpb24gb25seSBhZmZlY3RzIGl0cyBcIm93blwiIGRvYywgc28gaXQncyBzYWZlIHRvIGdldCBhbGxcbiAgICAgICAgLy8gdGhlIHJlbW90ZSBkb2N1bWVudHMgaW4gYWR2YW5jZSBpbiBhIHNpbmdsZSBjYWxsLlxuICAgICAgICBvLnB1c2goX19QUklWQVRFX3BvcHVsYXRlRG9jdW1lbnRDaGFuZ2VCdWZmZXIoZSwgcywgdC5kb2N1bWVudFVwZGF0ZXMpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgXyA9IGUua3MsIGEgPSBlLnFzO1xuICAgICAgICB9KSkpLCAhci5pc0VxdWFsKFNuYXBzaG90VmVyc2lvbi5taW4oKSkpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBuLlBpLmdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24oZSkubmV4dCgodCA9PiBuLlBpLnNldFRhcmdldHNNZXRhZGF0YShlLCBlLmN1cnJlbnRTZXF1ZW5jZU51bWJlciwgcikpKTtcbiAgICAgICAgICAgIG8ucHVzaCh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IobykubmV4dCgoKCkgPT4gcy5hcHBseShlKSkpLm5leHQoKCgpID0+IG4ubG9jYWxEb2N1bWVudHMuZ2V0TG9jYWxWaWV3T2ZEb2N1bWVudHMoZSwgXywgYSkpKS5uZXh0KCgoKSA9PiBfKSk7XG4gICAgfSkpLnRoZW4oKGUgPT4gKG4uTXMgPSBpLCBlKSkpO1xufVxuXG4vKipcbiAqIFBvcHVsYXRlcyBkb2N1bWVudCBjaGFuZ2UgYnVmZmVyIHdpdGggZG9jdW1lbnRzIGZyb20gYmFja2VuZCBvciBhIGJ1bmRsZS5cbiAqIFJldHVybnMgdGhlIGRvY3VtZW50IGNoYW5nZXMgcmVzdWx0aW5nIGZyb20gYXBwbHlpbmcgdGhvc2UgZG9jdW1lbnRzLCBhbmRcbiAqIGFsc28gYSBzZXQgb2YgZG9jdW1lbnRzIHdob3NlIGV4aXN0ZW5jZSBzdGF0ZSBhcmUgY2hhbmdlZCBhcyBhIHJlc3VsdC5cbiAqXG4gKiBAcGFyYW0gdHhuIC0gVHJhbnNhY3Rpb24gdG8gdXNlIHRvIHJlYWQgZXhpc3RpbmcgZG9jdW1lbnRzIGZyb20gc3RvcmFnZS5cbiAqIEBwYXJhbSBkb2N1bWVudEJ1ZmZlciAtIERvY3VtZW50IGJ1ZmZlciB0byBjb2xsZWN0IHRoZSByZXN1bHRlZCBjaGFuZ2VzIHRvIGJlXG4gKiAgICAgICAgYXBwbGllZCB0byBzdG9yYWdlLlxuICogQHBhcmFtIGRvY3VtZW50cyAtIERvY3VtZW50cyB0byBiZSBhcHBsaWVkLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9wb3B1bGF0ZURvY3VtZW50Q2hhbmdlQnVmZmVyKGUsIHQsIG4pIHtcbiAgICBsZXQgciA9IF9fUFJJVkFURV9kb2N1bWVudEtleVNldCgpLCBpID0gX19QUklWQVRFX2RvY3VtZW50S2V5U2V0KCk7XG4gICAgcmV0dXJuIG4uZm9yRWFjaCgoZSA9PiByID0gci5hZGQoZSkpKSwgdC5nZXRFbnRyaWVzKGUsIHIpLm5leHQoKGUgPT4ge1xuICAgICAgICBsZXQgciA9IF9fUFJJVkFURV9tdXRhYmxlRG9jdW1lbnRNYXAoKTtcbiAgICAgICAgcmV0dXJuIG4uZm9yRWFjaCgoKG4sIHMpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG8gPSBlLmdldChuKTtcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHNlZSBpZiB0aGVyZSBpcyBhIGV4aXN0ZW5jZSBzdGF0ZSBjaGFuZ2UgZm9yIHRoaXMgZG9jdW1lbnQuXG4gICAgICAgICAgICAgICAgICAgICAgICBzLmlzRm91bmREb2N1bWVudCgpICE9PSBvLmlzRm91bmREb2N1bWVudCgpICYmIChpID0gaS5hZGQobikpLCBcbiAgICAgICAgICAgIC8vIE5vdGU6IFRoZSBvcmRlciBvZiB0aGUgc3RlcHMgYmVsb3cgaXMgaW1wb3J0YW50LCBzaW5jZSB3ZSB3YW50XG4gICAgICAgICAgICAvLyB0byBlbnN1cmUgdGhhdCByZWplY3RlZCBsaW1ibyByZXNvbHV0aW9ucyAod2hpY2ggZmFicmljYXRlXG4gICAgICAgICAgICAvLyBOb0RvY3VtZW50cyB3aXRoIFNuYXBzaG90VmVyc2lvbi5taW4oKSkgbmV2ZXIgYWRkIGRvY3VtZW50cyB0b1xuICAgICAgICAgICAgLy8gY2FjaGUuXG4gICAgICAgICAgICBzLmlzTm9Eb2N1bWVudCgpICYmIHMudmVyc2lvbi5pc0VxdWFsKFNuYXBzaG90VmVyc2lvbi5taW4oKSkgPyAoXG4gICAgICAgICAgICAvLyBOb0RvY3VtZW50cyB3aXRoIFNuYXBzaG90VmVyc2lvbi5taW4oKSBhcmUgdXNlZCBpbiBtYW51ZmFjdHVyZWRcbiAgICAgICAgICAgIC8vIGV2ZW50cy4gV2UgcmVtb3ZlIHRoZXNlIGRvY3VtZW50cyBmcm9tIGNhY2hlIHNpbmNlIHdlIGxvc3RcbiAgICAgICAgICAgIC8vIGFjY2Vzcy5cbiAgICAgICAgICAgIHQucmVtb3ZlRW50cnkobiwgcy5yZWFkVGltZSksIHIgPSByLmluc2VydChuLCBzKSkgOiAhby5pc1ZhbGlkRG9jdW1lbnQoKSB8fCBzLnZlcnNpb24uY29tcGFyZVRvKG8udmVyc2lvbikgPiAwIHx8IDAgPT09IHMudmVyc2lvbi5jb21wYXJlVG8oby52ZXJzaW9uKSAmJiBvLmhhc1BlbmRpbmdXcml0ZXMgPyAodC5hZGRFbnRyeShzKSwgXG4gICAgICAgICAgICByID0gci5pbnNlcnQobiwgcykpIDogX19QUklWQVRFX2xvZ0RlYnVnKFV0LCBcIklnbm9yaW5nIG91dGRhdGVkIHdhdGNoIHVwZGF0ZSBmb3IgXCIsIG4sIFwiLiBDdXJyZW50IHZlcnNpb246XCIsIG8udmVyc2lvbiwgXCIgV2F0Y2ggdmVyc2lvbjpcIiwgcy52ZXJzaW9uKTtcbiAgICAgICAgfSkpLCB7XG4gICAgICAgICAgICBrczogcixcbiAgICAgICAgICAgIHFzOiBpXG4gICAgICAgIH07XG4gICAgfSkpO1xufVxuXG4vKipcbiAqIEdldHMgdGhlIG11dGF0aW9uIGJhdGNoIGFmdGVyIHRoZSBwYXNzZWQgaW4gYmF0Y2hJZCBpbiB0aGUgbXV0YXRpb24gcXVldWVcbiAqIG9yIG51bGwgaWYgZW1wdHkuXG4gKiBAcGFyYW0gYWZ0ZXJCYXRjaElkIC0gSWYgcHJvdmlkZWQsIHRoZSBiYXRjaCB0byBzZWFyY2ggYWZ0ZXIuXG4gKiBAcmV0dXJucyBUaGUgbmV4dCBtdXRhdGlvbiBvciBudWxsIGlmIHRoZXJlIHdhc24ndCBvbmUuXG4gKi9cbmZ1bmN0aW9uIF9fUFJJVkFURV9sb2NhbFN0b3JlR2V0TmV4dE11dGF0aW9uQmF0Y2goZSwgdCkge1xuICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpO1xuICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiR2V0IG5leHQgbXV0YXRpb24gYmF0Y2hcIiwgXCJyZWFkb25seVwiLCAoZSA9PiAodm9pZCAwID09PSB0ICYmICh0ID0gaiksIFxuICAgIG4ubXV0YXRpb25RdWV1ZS5nZXROZXh0TXV0YXRpb25CYXRjaEFmdGVyQmF0Y2hJZChlLCB0KSkpKTtcbn1cblxuLyoqXG4gKiBSZWFkcyB0aGUgY3VycmVudCB2YWx1ZSBvZiBhIERvY3VtZW50IHdpdGggYSBnaXZlbiBrZXkgb3IgbnVsbCBpZiBub3RcbiAqIGZvdW5kIC0gdXNlZCBmb3IgdGVzdGluZy5cbiAqL1xuLyoqXG4gKiBBc3NpZ25zIHRoZSBnaXZlbiB0YXJnZXQgYW4gaW50ZXJuYWwgSUQgc28gdGhhdCBpdHMgcmVzdWx0cyBjYW4gYmUgcGlubmVkIHNvXG4gKiB0aGV5IGRvbid0IGdldCBHQydkLiBBIHRhcmdldCBtdXN0IGJlIGFsbG9jYXRlZCBpbiB0aGUgbG9jYWwgc3RvcmUgYmVmb3JlXG4gKiB0aGUgc3RvcmUgY2FuIGJlIHVzZWQgdG8gbWFuYWdlIGl0cyB2aWV3LlxuICpcbiAqIEFsbG9jYXRpbmcgYW4gYWxyZWFkeSBhbGxvY2F0ZWQgYFRhcmdldGAgd2lsbCByZXR1cm4gdGhlIGV4aXN0aW5nIGBUYXJnZXREYXRhYFxuICogZm9yIHRoYXQgYFRhcmdldGAuXG4gKi9cbmZ1bmN0aW9uIF9fUFJJVkFURV9sb2NhbFN0b3JlQWxsb2NhdGVUYXJnZXQoZSwgdCkge1xuICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpO1xuICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiQWxsb2NhdGUgdGFyZ2V0XCIsIFwicmVhZHdyaXRlXCIsIChlID0+IHtcbiAgICAgICAgbGV0IHI7XG4gICAgICAgIHJldHVybiBuLlBpLmdldFRhcmdldERhdGEoZSwgdCkubmV4dCgoaSA9PiBpID8gKFxuICAgICAgICAvLyBUaGlzIHRhcmdldCBoYXMgYmVlbiBsaXN0ZW5lZCB0byBwcmV2aW91c2x5LCBzbyByZXVzZSB0aGVcbiAgICAgICAgLy8gcHJldmlvdXMgdGFyZ2V0SUQuXG4gICAgICAgIC8vIFRPRE8obWNnKTogZnJlc2hlbiBsYXN0IGFjY2Vzc2VkIGRhdGU/XG4gICAgICAgIHIgPSBpLCBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShyKSkgOiBuLlBpLmFsbG9jYXRlVGFyZ2V0SWQoZSkubmV4dCgoaSA9PiAociA9IG5ldyBUYXJnZXREYXRhKHQsIGksIFwiVGFyZ2V0UHVycG9zZUxpc3RlblwiIC8qIFRhcmdldFB1cnBvc2UuTGlzdGVuICovICwgZS5jdXJyZW50U2VxdWVuY2VOdW1iZXIpLCBcbiAgICAgICAgbi5QaS5hZGRUYXJnZXREYXRhKGUsIHIpLm5leHQoKCgpID0+IHIpKSkpKSkpO1xuICAgIH0pKS50aGVuKChlID0+IHtcbiAgICAgICAgLy8gSWYgTXVsdGktVGFiIGlzIGVuYWJsZWQsIHRoZSBleGlzdGluZyB0YXJnZXQgZGF0YSBtYXkgYmUgbmV3ZXIgdGhhblxuICAgICAgICAvLyB0aGUgaW4tbWVtb3J5IGRhdGFcbiAgICAgICAgY29uc3QgciA9IG4uTXMuZ2V0KGUudGFyZ2V0SWQpO1xuICAgICAgICByZXR1cm4gKG51bGwgPT09IHIgfHwgZS5zbmFwc2hvdFZlcnNpb24uY29tcGFyZVRvKHIuc25hcHNob3RWZXJzaW9uKSA+IDApICYmIChuLk1zID0gbi5Ncy5pbnNlcnQoZS50YXJnZXRJZCwgZSksIFxuICAgICAgICBuLnhzLnNldCh0LCBlLnRhcmdldElkKSksIGU7XG4gICAgfSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIFRhcmdldERhdGEgYXMgc2VlbiBieSB0aGUgTG9jYWxTdG9yZSwgaW5jbHVkaW5nIHVwZGF0ZXMgdGhhdCBtYXlcbiAqIGhhdmUgbm90IHlldCBiZWVuIHBlcnNpc3RlZCB0byB0aGUgVGFyZ2V0Q2FjaGUuXG4gKi9cbi8vIFZpc2libGUgZm9yIHRlc3RpbmcuXG4vKipcbiAqIFVucGlucyBhbGwgdGhlIGRvY3VtZW50cyBhc3NvY2lhdGVkIHdpdGggdGhlIGdpdmVuIHRhcmdldC4gSWZcbiAqIGBrZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YWAgaXMgc2V0IHRvIGZhbHNlIGFuZCBFYWdlciBHQyBlbmFibGVkLCB0aGUgbWV0aG9kXG4gKiBkaXJlY3RseSByZW1vdmVzIHRoZSBhc3NvY2lhdGVkIHRhcmdldCBkYXRhIGZyb20gdGhlIHRhcmdldCBjYWNoZS5cbiAqXG4gKiBSZWxlYXNpbmcgYSBub24tZXhpc3RpbmcgYFRhcmdldGAgaXMgYSBuby1vcC5cbiAqL1xuLy8gUE9SVElORyBOT1RFOiBga2VlcFBlcnNpc3RlZFRhcmdldERhdGFgIGlzIG11bHRpLXRhYiBvbmx5LlxuYXN5bmMgZnVuY3Rpb24gX19QUklWQVRFX2xvY2FsU3RvcmVSZWxlYXNlVGFyZ2V0KGUsIHQsIG4pIHtcbiAgICBjb25zdCByID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKSwgaSA9IHIuTXMuZ2V0KHQpLCBzID0gbiA/IFwicmVhZHdyaXRlXCIgOiBcInJlYWR3cml0ZS1wcmltYXJ5XCI7XG4gICAgdHJ5IHtcbiAgICAgICAgbiB8fCBhd2FpdCByLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiUmVsZWFzZSB0YXJnZXRcIiwgcywgKGUgPT4gci5wZXJzaXN0ZW5jZS5yZWZlcmVuY2VEZWxlZ2F0ZS5yZW1vdmVUYXJnZXQoZSwgaSkpKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGlmICghX19QUklWQVRFX2lzSW5kZXhlZERiVHJhbnNhY3Rpb25FcnJvcihlKSkgdGhyb3cgZTtcbiAgICAgICAgLy8gQWxsIGByZWxlYXNlVGFyZ2V0YCBkb2VzIGlzIHJlY29yZCB0aGUgZmluYWwgbWV0YWRhdGEgc3RhdGUgZm9yIHRoZVxuICAgICAgICAvLyB0YXJnZXQsIGJ1dCB3ZSd2ZSBiZWVuIHJlY29yZGluZyB0aGlzIHBlcmlvZGljYWxseSBkdXJpbmcgdGFyZ2V0XG4gICAgICAgIC8vIGFjdGl2aXR5LiBJZiB3ZSBsb3NlIHRoaXMgd3JpdGUgdGhpcyBjb3VsZCBjYXVzZSBhIHZlcnkgc2xpZ2h0XG4gICAgICAgIC8vIGRpZmZlcmVuY2UgaW4gdGhlIG9yZGVyIG9mIHRhcmdldCBkZWxldGlvbiBkdXJpbmcgR0MsIGJ1dCB3ZVxuICAgICAgICAvLyBkb24ndCBkZWZpbmUgZXhhY3QgTFJVIHNlbWFudGljcyBzbyB0aGlzIGlzIGFjY2VwdGFibGUuXG4gICAgICAgIF9fUFJJVkFURV9sb2dEZWJ1ZyhVdCwgYEZhaWxlZCB0byB1cGRhdGUgc2VxdWVuY2UgbnVtYmVycyBmb3IgdGFyZ2V0ICR7dH06ICR7ZX1gKTtcbiAgICB9XG4gICAgci5NcyA9IHIuTXMucmVtb3ZlKHQpLCByLnhzLmRlbGV0ZShpLnRhcmdldCk7XG59XG5cbi8qKlxuICogUnVucyB0aGUgc3BlY2lmaWVkIHF1ZXJ5IGFnYWluc3QgdGhlIGxvY2FsIHN0b3JlIGFuZCByZXR1cm5zIHRoZSByZXN1bHRzLFxuICogcG90ZW50aWFsbHkgdGFraW5nIGFkdmFudGFnZSBvZiBxdWVyeSBkYXRhIGZyb20gcHJldmlvdXMgZXhlY3V0aW9ucyAoc3VjaFxuICogYXMgdGhlIHNldCBvZiByZW1vdGUga2V5cykuXG4gKlxuICogQHBhcmFtIHVzZVByZXZpb3VzUmVzdWx0cyAtIFdoZXRoZXIgcmVzdWx0cyBmcm9tIHByZXZpb3VzIGV4ZWN1dGlvbnMgY2FuXG4gKiBiZSB1c2VkIHRvIG9wdGltaXplIHRoaXMgcXVlcnkgZXhlY3V0aW9uLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9sb2NhbFN0b3JlRXhlY3V0ZVF1ZXJ5KGUsIHQsIG4pIHtcbiAgICBjb25zdCByID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKTtcbiAgICBsZXQgaSA9IFNuYXBzaG90VmVyc2lvbi5taW4oKSwgcyA9IF9fUFJJVkFURV9kb2N1bWVudEtleVNldCgpO1xuICAgIHJldHVybiByLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiRXhlY3V0ZSBxdWVyeVwiLCBcInJlYWR3cml0ZVwiLCAoLy8gVXNlIHJlYWR3cml0ZSBpbnN0ZWFkIG9mIHJlYWRvbmx5IHNvIGluZGV4ZXMgY2FuIGJlIGNyZWF0ZWRcbiAgICAvLyBVc2UgcmVhZHdyaXRlIGluc3RlYWQgb2YgcmVhZG9ubHkgc28gaW5kZXhlcyBjYW4gYmUgY3JlYXRlZFxuICAgIGUgPT4gZnVuY3Rpb24gX19QUklWQVRFX2xvY2FsU3RvcmVHZXRUYXJnZXREYXRhKGUsIHQsIG4pIHtcbiAgICAgICAgY29uc3QgciA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSksIGkgPSByLnhzLmdldChuKTtcbiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gaSA/IFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHIuTXMuZ2V0KGkpKSA6IHIuUGkuZ2V0VGFyZ2V0RGF0YSh0LCBuKTtcbiAgICB9KHIsIGUsIF9fUFJJVkFURV9xdWVyeVRvVGFyZ2V0KHQpKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgaWYgKHQpIHJldHVybiBpID0gdC5sYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uLCByLlBpLmdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkKGUsIHQudGFyZ2V0SWQpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgcyA9IGU7XG4gICAgICAgIH0pKTtcbiAgICB9KSkubmV4dCgoKCkgPT4gci5Gcy5nZXREb2N1bWVudHNNYXRjaGluZ1F1ZXJ5KGUsIHQsIG4gPyBpIDogU25hcHNob3RWZXJzaW9uLm1pbigpLCBuID8gcyA6IF9fUFJJVkFURV9kb2N1bWVudEtleVNldCgpKSkpLm5leHQoKGUgPT4gKF9fUFJJVkFURV9zZXRNYXhSZWFkVGltZShyLCBfX1BSSVZBVEVfcXVlcnlDb2xsZWN0aW9uR3JvdXAodCksIGUpLCBcbiAgICB7XG4gICAgICAgIGRvY3VtZW50czogZSxcbiAgICAgICAgUXM6IHNcbiAgICB9KSkpKSk7XG59XG5cbi8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG5mdW5jdGlvbiBfX1BSSVZBVEVfbG9jYWxTdG9yZUdldENhY2hlZFRhcmdldChlLCB0KSB7XG4gICAgY29uc3QgbiA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSksIHIgPSBfX1BSSVZBVEVfZGVidWdDYXN0KG4uUGkpLCBpID0gbi5Ncy5nZXQodCk7XG4gICAgcmV0dXJuIGkgPyBQcm9taXNlLnJlc29sdmUoaS50YXJnZXQpIDogbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkdldCB0YXJnZXQgZGF0YVwiLCBcInJlYWRvbmx5XCIsIChlID0+IHIuQXQoZSwgdCkubmV4dCgoZSA9PiBlID8gZS50YXJnZXQgOiBudWxsKSkpKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBzZXQgb2YgZG9jdW1lbnRzIHRoYXQgaGF2ZSBiZWVuIHVwZGF0ZWQgc2luY2UgdGhlIGxhc3QgY2FsbC5cbiAqIElmIHRoaXMgaXMgdGhlIGZpcnN0IGNhbGwsIHJldHVybnMgdGhlIHNldCBvZiBjaGFuZ2VzIHNpbmNlIGNsaWVudFxuICogaW5pdGlhbGl6YXRpb24uIEZ1cnRoZXIgaW52b2NhdGlvbnMgd2lsbCByZXR1cm4gZG9jdW1lbnQgdGhhdCBoYXZlIGNoYW5nZWRcbiAqIHNpbmNlIHRoZSBwcmlvciBjYWxsLlxuICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuZnVuY3Rpb24gX19QUklWQVRFX2xvY2FsU3RvcmVHZXROZXdEb2N1bWVudENoYW5nZXMoZSwgdCkge1xuICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpLCByID0gbi5Pcy5nZXQodCkgfHwgU25hcHNob3RWZXJzaW9uLm1pbigpO1xuICAgIC8vIEdldCB0aGUgY3VycmVudCBtYXhpbXVtIHJlYWQgdGltZSBmb3IgdGhlIGNvbGxlY3Rpb24uIFRoaXMgc2hvdWxkIGFsd2F5c1xuICAgIC8vIGV4aXN0LCBidXQgdG8gcmVkdWNlIHRoZSBjaGFuY2UgZm9yIHJlZ3Jlc3Npb25zIHdlIGRlZmF1bHQgdG9cbiAgICAvLyBTbmFwc2hvdFZlcnNpb24uTWluKClcbiAgICAvLyBUT0RPKGluZGV4aW5nKTogQ29uc2lkZXIgcmVtb3ZpbmcgdGhlIGRlZmF1bHQgdmFsdWUuXG4gICAgICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiR2V0IG5ldyBkb2N1bWVudCBjaGFuZ2VzXCIsIFwicmVhZG9ubHlcIiwgKGUgPT4gbi5Ocy5nZXRBbGxGcm9tQ29sbGVjdGlvbkdyb3VwKGUsIHQsIF9fUFJJVkFURV9uZXdJbmRleE9mZnNldFN1Y2Nlc3NvckZyb21SZWFkVGltZShyLCBVKSwgXG4gICAgLyogbGltaXQ9ICovIE51bWJlci5NQVhfU0FGRV9JTlRFR0VSKSkpLnRoZW4oKGUgPT4gKF9fUFJJVkFURV9zZXRNYXhSZWFkVGltZShuLCB0LCBlKSwgXG4gICAgZSkpKTtcbn1cblxuLyoqIFNldHMgdGhlIGNvbGxlY3Rpb24gZ3JvdXAncyBtYXhpbXVtIHJlYWQgdGltZSBmcm9tIHRoZSBnaXZlbiBkb2N1bWVudHMuICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuZnVuY3Rpb24gX19QUklWQVRFX3NldE1heFJlYWRUaW1lKGUsIHQsIG4pIHtcbiAgICBsZXQgciA9IGUuT3MuZ2V0KHQpIHx8IFNuYXBzaG90VmVyc2lvbi5taW4oKTtcbiAgICBuLmZvckVhY2goKChlLCB0KSA9PiB7XG4gICAgICAgIHQucmVhZFRpbWUuY29tcGFyZVRvKHIpID4gMCAmJiAociA9IHQucmVhZFRpbWUpO1xuICAgIH0pKSwgZS5Pcy5zZXQodCwgcik7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyB0YXJnZXQgdXNpbmcgdGhlIGdpdmVuIGJ1bmRsZSBuYW1lLCB3aGljaCB3aWxsIGJlIHVzZWQgdG9cbiAqIGhvbGQgdGhlIGtleXMgb2YgYWxsIGRvY3VtZW50cyBmcm9tIHRoZSBidW5kbGUgaW4gcXVlcnktZG9jdW1lbnQgbWFwcGluZ3MuXG4gKiBUaGlzIGVuc3VyZXMgdGhhdCB0aGUgbG9hZGVkIGRvY3VtZW50cyBkbyBub3QgZ2V0IGdhcmJhZ2UgY29sbGVjdGVkXG4gKiByaWdodCBhd2F5LlxuICovXG4vKipcbiAqIEFwcGxpZXMgdGhlIGRvY3VtZW50cyBmcm9tIGEgYnVuZGxlIHRvIHRoZSBcImdyb3VuZC1zdGF0ZVwiIChyZW1vdGUpXG4gKiBkb2N1bWVudHMuXG4gKlxuICogTG9jYWxEb2N1bWVudHMgYXJlIHJlLWNhbGN1bGF0ZWQgaWYgdGhlcmUgYXJlIHJlbWFpbmluZyBtdXRhdGlvbnMgaW4gdGhlXG4gKiBxdWV1ZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gX19QUklWQVRFX2xvY2FsU3RvcmVBcHBseUJ1bmRsZWREb2N1bWVudHMoZSwgdCwgbiwgcikge1xuICAgIGNvbnN0IGkgPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpO1xuICAgIGxldCBzID0gX19QUklWQVRFX2RvY3VtZW50S2V5U2V0KCksIG8gPSBfX1BSSVZBVEVfbXV0YWJsZURvY3VtZW50TWFwKCk7XG4gICAgZm9yIChjb25zdCBlIG9mIG4pIHtcbiAgICAgICAgY29uc3QgbiA9IHQuJHMoZS5tZXRhZGF0YS5uYW1lKTtcbiAgICAgICAgZS5kb2N1bWVudCAmJiAocyA9IHMuYWRkKG4pKTtcbiAgICAgICAgY29uc3QgciA9IHQuVXMoZSk7XG4gICAgICAgIHIuc2V0UmVhZFRpbWUodC5LcyhlLm1ldGFkYXRhLnJlYWRUaW1lKSksIG8gPSBvLmluc2VydChuLCByKTtcbiAgICB9XG4gICAgY29uc3QgXyA9IGkuTnMubmV3Q2hhbmdlQnVmZmVyKHtcbiAgICAgICAgdHJhY2tSZW1vdmFsczogITBcbiAgICB9KSwgYSA9IGF3YWl0IF9fUFJJVkFURV9sb2NhbFN0b3JlQWxsb2NhdGVUYXJnZXQoaSwgZnVuY3Rpb24gX19QUklWQVRFX3VtYnJlbGxhVGFyZ2V0KGUpIHtcbiAgICAgICAgLy8gSXQgaXMgT0sgdGhhdCB0aGUgcGF0aCB1c2VkIGZvciB0aGUgcXVlcnkgaXMgbm90IHZhbGlkLCBiZWNhdXNlIHRoaXMgd2lsbFxuICAgICAgICAvLyBub3QgYmUgcmVhZCBhbmQgcXVlcmllZC5cbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9xdWVyeVRvVGFyZ2V0KF9fUFJJVkFURV9uZXdRdWVyeUZvclBhdGgoUmVzb3VyY2VQYXRoLmZyb21TdHJpbmcoYF9fYnVuZGxlX18vZG9jcy8ke2V9YCkpKTtcbiAgICB9KHIpKTtcbiAgICAvLyBBbGxvY2F0ZXMgYSB0YXJnZXQgdG8gaG9sZCBhbGwgZG9jdW1lbnQga2V5cyBmcm9tIHRoZSBidW5kbGUsIHN1Y2ggdGhhdFxuICAgIC8vIHRoZXkgd2lsbCBub3QgZ2V0IGdhcmJhZ2UgY29sbGVjdGVkIHJpZ2h0IGF3YXkuXG4gICAgICAgIHJldHVybiBpLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiQXBwbHkgYnVuZGxlIGRvY3VtZW50c1wiLCBcInJlYWR3cml0ZVwiLCAoZSA9PiBfX1BSSVZBVEVfcG9wdWxhdGVEb2N1bWVudENoYW5nZUJ1ZmZlcihlLCBfLCBvKS5uZXh0KCh0ID0+IChfLmFwcGx5KGUpLCBcbiAgICB0KSkpLm5leHQoKHQgPT4gaS5QaS5yZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZChlLCBhLnRhcmdldElkKS5uZXh0KCgoKSA9PiBpLlBpLmFkZE1hdGNoaW5nS2V5cyhlLCBzLCBhLnRhcmdldElkKSkpLm5leHQoKCgpID0+IGkubG9jYWxEb2N1bWVudHMuZ2V0TG9jYWxWaWV3T2ZEb2N1bWVudHMoZSwgdC5rcywgdC5xcykpKS5uZXh0KCgoKSA9PiB0LmtzKSkpKSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIG9mIGEgYm9vbGVhbiB0byBpbmRpY2F0ZSBpZiB0aGUgZ2l2ZW4gYnVuZGxlIGhhcyBhbHJlYWR5XG4gKiBiZWVuIGxvYWRlZCBhbmQgdGhlIGNyZWF0ZSB0aW1lIGlzIG5ld2VyIHRoYW4gdGhlIGN1cnJlbnQgbG9hZGluZyBidW5kbGUuXG4gKi9cbi8qKlxuICogU2F2ZXMgdGhlIGdpdmVuIGBOYW1lZFF1ZXJ5YCB0byBsb2NhbCBwZXJzaXN0ZW5jZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gX19QUklWQVRFX2xvY2FsU3RvcmVTYXZlTmFtZWRRdWVyeShlLCB0LCBuID0gX19QUklWQVRFX2RvY3VtZW50S2V5U2V0KCkpIHtcbiAgICAvLyBBbGxvY2F0ZSBhIHRhcmdldCBmb3IgdGhlIG5hbWVkIHF1ZXJ5IHN1Y2ggdGhhdCBpdCBjYW4gYmUgcmVzdW1lZFxuICAgIC8vIGZyb20gYXNzb2NpYXRlZCByZWFkIHRpbWUgaWYgdXNlcnMgdXNlIGl0IHRvIGxpc3Rlbi5cbiAgICAvLyBOT1RFOiB0aGlzIGFsc28gbWVhbnMgaWYgbm8gY29ycmVzcG9uZGluZyB0YXJnZXQgZXhpc3RzLCB0aGUgbmV3IHRhcmdldFxuICAgIC8vIHdpbGwgcmVtYWluIGFjdGl2ZSBhbmQgd2lsbCBub3QgZ2V0IGNvbGxlY3RlZCwgdW5sZXNzIHVzZXJzIGhhcHBlbiB0b1xuICAgIC8vIHVubGlzdGVuIHRoZSBxdWVyeSBzb21laG93LlxuICAgIGNvbnN0IHIgPSBhd2FpdCBfX1BSSVZBVEVfbG9jYWxTdG9yZUFsbG9jYXRlVGFyZ2V0KGUsIF9fUFJJVkFURV9xdWVyeVRvVGFyZ2V0KF9fUFJJVkFURV9mcm9tQnVuZGxlZFF1ZXJ5KHQuYnVuZGxlZFF1ZXJ5KSkpLCBpID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKTtcbiAgICByZXR1cm4gaS5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIlNhdmUgbmFtZWQgcXVlcnlcIiwgXCJyZWFkd3JpdGVcIiwgKGUgPT4ge1xuICAgICAgICBjb25zdCBzID0gX19QUklWQVRFX2Zyb21WZXJzaW9uKHQucmVhZFRpbWUpO1xuICAgICAgICAvLyBTaW1wbHkgc2F2ZSB0aGUgcXVlcnkgaXRzZWxmIGlmIGl0IGlzIG9sZGVyIHRoYW4gd2hhdCB0aGUgU0RLIGFscmVhZHlcbiAgICAgICAgLy8gaGFzLlxuICAgICAgICAgICAgICAgIGlmIChyLnNuYXBzaG90VmVyc2lvbi5jb21wYXJlVG8ocykgPj0gMCkgcmV0dXJuIGkuSWkuc2F2ZU5hbWVkUXVlcnkoZSwgdCk7XG4gICAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyB0YXJnZXQgZGF0YSBiZWNhdXNlIHRoZSBxdWVyeSBmcm9tIHRoZSBidW5kbGUgaXMgbmV3ZXIuXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHIud2l0aFJlc3VtZVRva2VuKEJ5dGVTdHJpbmcuRU1QVFlfQllURV9TVFJJTkcsIHMpO1xuICAgICAgICByZXR1cm4gaS5NcyA9IGkuTXMuaW5zZXJ0KG8udGFyZ2V0SWQsIG8pLCBpLlBpLnVwZGF0ZVRhcmdldERhdGEoZSwgbykubmV4dCgoKCkgPT4gaS5QaS5yZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZChlLCByLnRhcmdldElkKSkpLm5leHQoKCgpID0+IGkuUGkuYWRkTWF0Y2hpbmdLZXlzKGUsIG4sIHIudGFyZ2V0SWQpKSkubmV4dCgoKCkgPT4gaS5JaS5zYXZlTmFtZWRRdWVyeShlLCB0KSkpO1xuICAgIH0pKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8vIFRoZSBmb3JtYXQgb2YgdGhlIExvY2FsU3RvcmFnZSBrZXkgdGhhdCBzdG9yZXMgdGhlIGNsaWVudCBzdGF0ZSBpczpcbi8vICAgICBmaXJlc3RvcmVfY2xpZW50c188cGVyc2lzdGVuY2VfcHJlZml4Pl88aW5zdGFuY2Vfa2V5PlxuY29uc3QgV3QgPSBcImZpcmVzdG9yZV9jbGllbnRzXCI7XG5cbi8qKiBBc3NlbWJsZXMgdGhlIGtleSBmb3IgYSBjbGllbnQgc3RhdGUgaW4gV2ViU3RvcmFnZSAqLyBmdW5jdGlvbiBjcmVhdGVXZWJTdG9yYWdlQ2xpZW50U3RhdGVLZXkoZSwgdCkge1xuICAgIHJldHVybiBgJHtXdH1fJHtlfV8ke3R9YDtcbn1cblxuLy8gVGhlIGZvcm1hdCBvZiB0aGUgV2ViU3RvcmFnZSBrZXkgdGhhdCBzdG9yZXMgdGhlIG11dGF0aW9uIHN0YXRlIGlzOlxuLy8gICAgIGZpcmVzdG9yZV9tdXRhdGlvbnNfPHBlcnNpc3RlbmNlX3ByZWZpeD5fPGJhdGNoX2lkPlxuLy8gICAgIChmb3IgdW5hdXRoZW50aWNhdGVkIHVzZXJzKVxuLy8gb3I6IGZpcmVzdG9yZV9tdXRhdGlvbnNfPHBlcnNpc3RlbmNlX3ByZWZpeD5fPGJhdGNoX2lkPl88dXNlcl91aWQ+XG5cbi8vICd1c2VyX3VpZCcgaXMgbGFzdCB0byBhdm9pZCBuZWVkaW5nIHRvIGVzY2FwZSAnXycgY2hhcmFjdGVycyB0aGF0IGl0IG1pZ2h0XG4vLyBjb250YWluLlxuY29uc3QgR3QgPSBcImZpcmVzdG9yZV9tdXRhdGlvbnNcIjtcblxuLyoqIEFzc2VtYmxlcyB0aGUga2V5IGZvciBhIG11dGF0aW9uIGJhdGNoIGluIFdlYlN0b3JhZ2UgKi8gZnVuY3Rpb24gY3JlYXRlV2ViU3RvcmFnZU11dGF0aW9uQmF0Y2hLZXkoZSwgdCwgbikge1xuICAgIGxldCByID0gYCR7R3R9XyR7ZX1fJHtufWA7XG4gICAgcmV0dXJuIHQuaXNBdXRoZW50aWNhdGVkKCkgJiYgKHIgKz0gYF8ke3QudWlkfWApLCByO1xufVxuXG4vLyBUaGUgZm9ybWF0IG9mIHRoZSBXZWJTdG9yYWdlIGtleSB0aGF0IHN0b3JlcyBhIHF1ZXJ5IHRhcmdldCdzIG1ldGFkYXRhIGlzOlxuLy8gICAgIGZpcmVzdG9yZV90YXJnZXRzXzxwZXJzaXN0ZW5jZV9wcmVmaXg+Xzx0YXJnZXRfaWQ+XG5jb25zdCB6dCA9IFwiZmlyZXN0b3JlX3RhcmdldHNcIjtcblxuLyoqIEFzc2VtYmxlcyB0aGUga2V5IGZvciBhIHF1ZXJ5IHN0YXRlIGluIFdlYlN0b3JhZ2UgKi8gZnVuY3Rpb24gY3JlYXRlV2ViU3RvcmFnZVF1ZXJ5VGFyZ2V0TWV0YWRhdGFLZXkoZSwgdCkge1xuICAgIHJldHVybiBgJHt6dH1fJHtlfV8ke3R9YDtcbn1cblxuLy8gVGhlIFdlYlN0b3JhZ2UgcHJlZml4IHRoYXQgc3RvcmVzIHRoZSBwcmltYXJ5IHRhYidzIG9ubGluZSBzdGF0ZS4gVGhlXG4vLyBmb3JtYXQgb2YgdGhlIGtleSBpczpcbi8vICAgICBmaXJlc3RvcmVfb25saW5lX3N0YXRlXzxwZXJzaXN0ZW5jZV9wcmVmaXg+XG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY29uc3QganQgPSBcIlNoYXJlZENsaWVudFN0YXRlXCI7XG5cbi8qKlxuICogSG9sZHMgdGhlIHN0YXRlIG9mIGEgbXV0YXRpb24gYmF0Y2gsIGluY2x1ZGluZyBpdHMgdXNlciBJRCwgYmF0Y2ggSUQgYW5kXG4gKiB3aGV0aGVyIHRoZSBiYXRjaCBpcyAncGVuZGluZycsICdhY2tub3dsZWRnZWQnIG9yICdyZWplY3RlZCcuXG4gKi9cbi8vIFZpc2libGUgZm9yIHRlc3RpbmdcbmNsYXNzIF9fUFJJVkFURV9NdXRhdGlvbk1ldGFkYXRhIHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0LCBuLCByKSB7XG4gICAgICAgIHRoaXMudXNlciA9IGUsIHRoaXMuYmF0Y2hJZCA9IHQsIHRoaXMuc3RhdGUgPSBuLCB0aGlzLmVycm9yID0gcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgTXV0YXRpb25NZXRhZGF0YSBmcm9tIGl0cyBKU09OIHJlcHJlc2VudGF0aW9uIGluIFdlYlN0b3JhZ2UuXG4gICAgICogTG9ncyBhIHdhcm5pbmcgYW5kIHJldHVybnMgbnVsbCBpZiB0aGUgZm9ybWF0IG9mIHRoZSBkYXRhIGlzIG5vdCB2YWxpZC5cbiAgICAgKi8gICAgc3RhdGljIFdzKGUsIHQsIG4pIHtcbiAgICAgICAgY29uc3QgciA9IEpTT04ucGFyc2Uobik7XG4gICAgICAgIGxldCBpLCBzID0gXCJvYmplY3RcIiA9PSB0eXBlb2YgciAmJiAtMSAhPT0gWyBcInBlbmRpbmdcIiwgXCJhY2tub3dsZWRnZWRcIiwgXCJyZWplY3RlZFwiIF0uaW5kZXhPZihyLnN0YXRlKSAmJiAodm9pZCAwID09PSByLmVycm9yIHx8IFwib2JqZWN0XCIgPT0gdHlwZW9mIHIuZXJyb3IpO1xuICAgICAgICByZXR1cm4gcyAmJiByLmVycm9yICYmIChzID0gXCJzdHJpbmdcIiA9PSB0eXBlb2Ygci5lcnJvci5tZXNzYWdlICYmIFwic3RyaW5nXCIgPT0gdHlwZW9mIHIuZXJyb3IuY29kZSwgXG4gICAgICAgIHMgJiYgKGkgPSBuZXcgRmlyZXN0b3JlRXJyb3Ioci5lcnJvci5jb2RlLCByLmVycm9yLm1lc3NhZ2UpKSksIHMgPyBuZXcgX19QUklWQVRFX011dGF0aW9uTWV0YWRhdGEoZSwgdCwgci5zdGF0ZSwgaSkgOiAoX19QUklWQVRFX2xvZ0Vycm9yKGp0LCBgRmFpbGVkIHRvIHBhcnNlIG11dGF0aW9uIHN0YXRlIGZvciBJRCAnJHt0fSc6ICR7bn1gKSwgXG4gICAgICAgIG51bGwpO1xuICAgIH1cbiAgICBHcygpIHtcbiAgICAgICAgY29uc3QgZSA9IHtcbiAgICAgICAgICAgIHN0YXRlOiB0aGlzLnN0YXRlLFxuICAgICAgICAgICAgdXBkYXRlVGltZU1zOiBEYXRlLm5vdygpXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB0aGlzLmVycm9yICYmIChlLmVycm9yID0ge1xuICAgICAgICAgICAgY29kZTogdGhpcy5lcnJvci5jb2RlLFxuICAgICAgICAgICAgbWVzc2FnZTogdGhpcy5lcnJvci5tZXNzYWdlXG4gICAgICAgIH0pLCBKU09OLnN0cmluZ2lmeShlKTtcbiAgICB9XG59XG5cbi8qKlxuICogSG9sZHMgdGhlIHN0YXRlIG9mIGEgcXVlcnkgdGFyZ2V0LCBpbmNsdWRpbmcgaXRzIHRhcmdldCBJRCBhbmQgd2hldGhlciB0aGVcbiAqIHRhcmdldCBpcyAnbm90LWN1cnJlbnQnLCAnY3VycmVudCcgb3IgJ3JlamVjdGVkJy5cbiAqL1xuLy8gVmlzaWJsZSBmb3IgdGVzdGluZ1xuY2xhc3MgX19QUklWQVRFX1F1ZXJ5VGFyZ2V0TWV0YWRhdGEge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4pIHtcbiAgICAgICAgdGhpcy50YXJnZXRJZCA9IGUsIHRoaXMuc3RhdGUgPSB0LCB0aGlzLmVycm9yID0gbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgUXVlcnlUYXJnZXRNZXRhZGF0YSBmcm9tIGl0cyBKU09OIHJlcHJlc2VudGF0aW9uIGluIFdlYlN0b3JhZ2UuXG4gICAgICogTG9ncyBhIHdhcm5pbmcgYW5kIHJldHVybnMgbnVsbCBpZiB0aGUgZm9ybWF0IG9mIHRoZSBkYXRhIGlzIG5vdCB2YWxpZC5cbiAgICAgKi8gICAgc3RhdGljIFdzKGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IEpTT04ucGFyc2UodCk7XG4gICAgICAgIGxldCByLCBpID0gXCJvYmplY3RcIiA9PSB0eXBlb2YgbiAmJiAtMSAhPT0gWyBcIm5vdC1jdXJyZW50XCIsIFwiY3VycmVudFwiLCBcInJlamVjdGVkXCIgXS5pbmRleE9mKG4uc3RhdGUpICYmICh2b2lkIDAgPT09IG4uZXJyb3IgfHwgXCJvYmplY3RcIiA9PSB0eXBlb2Ygbi5lcnJvcik7XG4gICAgICAgIHJldHVybiBpICYmIG4uZXJyb3IgJiYgKGkgPSBcInN0cmluZ1wiID09IHR5cGVvZiBuLmVycm9yLm1lc3NhZ2UgJiYgXCJzdHJpbmdcIiA9PSB0eXBlb2Ygbi5lcnJvci5jb2RlLCBcbiAgICAgICAgaSAmJiAociA9IG5ldyBGaXJlc3RvcmVFcnJvcihuLmVycm9yLmNvZGUsIG4uZXJyb3IubWVzc2FnZSkpKSwgaSA/IG5ldyBfX1BSSVZBVEVfUXVlcnlUYXJnZXRNZXRhZGF0YShlLCBuLnN0YXRlLCByKSA6IChfX1BSSVZBVEVfbG9nRXJyb3IoanQsIGBGYWlsZWQgdG8gcGFyc2UgdGFyZ2V0IHN0YXRlIGZvciBJRCAnJHtlfSc6ICR7dH1gKSwgXG4gICAgICAgIG51bGwpO1xuICAgIH1cbiAgICBHcygpIHtcbiAgICAgICAgY29uc3QgZSA9IHtcbiAgICAgICAgICAgIHN0YXRlOiB0aGlzLnN0YXRlLFxuICAgICAgICAgICAgdXBkYXRlVGltZU1zOiBEYXRlLm5vdygpXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB0aGlzLmVycm9yICYmIChlLmVycm9yID0ge1xuICAgICAgICAgICAgY29kZTogdGhpcy5lcnJvci5jb2RlLFxuICAgICAgICAgICAgbWVzc2FnZTogdGhpcy5lcnJvci5tZXNzYWdlXG4gICAgICAgIH0pLCBKU09OLnN0cmluZ2lmeShlKTtcbiAgICB9XG59XG5cbi8qKlxuICogVGhpcyBjbGFzcyByZXByZXNlbnRzIHRoZSBpbW11dGFibGUgQ2xpZW50U3RhdGUgZm9yIGEgY2xpZW50IHJlYWQgZnJvbVxuICogV2ViU3RvcmFnZSwgY29udGFpbmluZyB0aGUgbGlzdCBvZiBhY3RpdmUgcXVlcnkgdGFyZ2V0cy5cbiAqLyBjbGFzcyBfX1BSSVZBVEVfUmVtb3RlQ2xpZW50U3RhdGUge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQpIHtcbiAgICAgICAgdGhpcy5jbGllbnRJZCA9IGUsIHRoaXMuYWN0aXZlVGFyZ2V0SWRzID0gdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgUmVtb3RlQ2xpZW50U3RhdGUgZnJvbSB0aGUgSlNPTiByZXByZXNlbnRhdGlvbiBpbiBXZWJTdG9yYWdlLlxuICAgICAqIExvZ3MgYSB3YXJuaW5nIGFuZCByZXR1cm5zIG51bGwgaWYgdGhlIGZvcm1hdCBvZiB0aGUgZGF0YSBpcyBub3QgdmFsaWQuXG4gICAgICovICAgIHN0YXRpYyBXcyhlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSBKU09OLnBhcnNlKHQpO1xuICAgICAgICBsZXQgciA9IFwib2JqZWN0XCIgPT0gdHlwZW9mIG4gJiYgbi5hY3RpdmVUYXJnZXRJZHMgaW5zdGFuY2VvZiBBcnJheSwgaSA9IF9fUFJJVkFURV90YXJnZXRJZFNldCgpO1xuICAgICAgICBmb3IgKGxldCBlID0gMDsgciAmJiBlIDwgbi5hY3RpdmVUYXJnZXRJZHMubGVuZ3RoOyArK2UpIHIgPSBpc1NhZmVJbnRlZ2VyKG4uYWN0aXZlVGFyZ2V0SWRzW2VdKSwgXG4gICAgICAgIGkgPSBpLmFkZChuLmFjdGl2ZVRhcmdldElkc1tlXSk7XG4gICAgICAgIHJldHVybiByID8gbmV3IF9fUFJJVkFURV9SZW1vdGVDbGllbnRTdGF0ZShlLCBpKSA6IChfX1BSSVZBVEVfbG9nRXJyb3IoanQsIGBGYWlsZWQgdG8gcGFyc2UgY2xpZW50IGRhdGEgZm9yIGluc3RhbmNlICcke2V9JzogJHt0fWApLCBcbiAgICAgICAgbnVsbCk7XG4gICAgfVxufVxuXG4vKipcbiAqIFRoaXMgY2xhc3MgcmVwcmVzZW50cyB0aGUgb25saW5lIHN0YXRlIGZvciBhbGwgY2xpZW50cyBwYXJ0aWNpcGF0aW5nIGluXG4gKiBtdWx0aS10YWIuIFRoZSBvbmxpbmUgc3RhdGUgaXMgb25seSB3cml0dGVuIHRvIGJ5IHRoZSBwcmltYXJ5IGNsaWVudCwgYW5kXG4gKiB1c2VkIGluIHNlY29uZGFyeSBjbGllbnRzIHRvIHVwZGF0ZSB0aGVpciBxdWVyeSB2aWV3cy5cbiAqLyBjbGFzcyBfX1BSSVZBVEVfU2hhcmVkT25saW5lU3RhdGUge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQpIHtcbiAgICAgICAgdGhpcy5jbGllbnRJZCA9IGUsIHRoaXMub25saW5lU3RhdGUgPSB0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBTaGFyZWRPbmxpbmVTdGF0ZSBmcm9tIGl0cyBKU09OIHJlcHJlc2VudGF0aW9uIGluIFdlYlN0b3JhZ2UuXG4gICAgICogTG9ncyBhIHdhcm5pbmcgYW5kIHJldHVybnMgbnVsbCBpZiB0aGUgZm9ybWF0IG9mIHRoZSBkYXRhIGlzIG5vdCB2YWxpZC5cbiAgICAgKi8gICAgc3RhdGljIFdzKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IEpTT04ucGFyc2UoZSk7XG4gICAgICAgIHJldHVybiBcIm9iamVjdFwiID09IHR5cGVvZiB0ICYmIC0xICE9PSBbIFwiVW5rbm93blwiLCBcIk9ubGluZVwiLCBcIk9mZmxpbmVcIiBdLmluZGV4T2YodC5vbmxpbmVTdGF0ZSkgJiYgXCJzdHJpbmdcIiA9PSB0eXBlb2YgdC5jbGllbnRJZCA/IG5ldyBfX1BSSVZBVEVfU2hhcmVkT25saW5lU3RhdGUodC5jbGllbnRJZCwgdC5vbmxpbmVTdGF0ZSkgOiAoX19QUklWQVRFX2xvZ0Vycm9yKGp0LCBgRmFpbGVkIHRvIHBhcnNlIG9ubGluZSBzdGF0ZTogJHtlfWApLCBcbiAgICAgICAgbnVsbCk7XG4gICAgfVxufVxuXG4vKipcbiAqIE1ldGFkYXRhIHN0YXRlIG9mIHRoZSBsb2NhbCBjbGllbnQuIFVubGlrZSBgUmVtb3RlQ2xpZW50U3RhdGVgLCB0aGlzIGNsYXNzIGlzXG4gKiBtdXRhYmxlIGFuZCBrZWVwcyB0cmFjayBvZiBhbGwgcGVuZGluZyBtdXRhdGlvbnMsIHdoaWNoIGFsbG93cyB1cyB0b1xuICogdXBkYXRlIHRoZSByYW5nZSBvZiBwZW5kaW5nIG11dGF0aW9uIGJhdGNoIElEcyBhcyBuZXcgbXV0YXRpb25zIGFyZSBhZGRlZCBvclxuICogcmVtb3ZlZC5cbiAqXG4gKiBUaGUgZGF0YSBpbiBgTG9jYWxDbGllbnRTdGF0ZWAgaXMgbm90IHJlYWQgZnJvbSBXZWJTdG9yYWdlIGFuZCBpbnN0ZWFkXG4gKiB1cGRhdGVkIHZpYSBpdHMgaW5zdGFuY2UgbWV0aG9kcy4gVGhlIHVwZGF0ZWQgc3RhdGUgY2FuIGJlIHNlcmlhbGl6ZWQgdmlhXG4gKiBgdG9XZWJTdG9yYWdlSlNPTigpYC5cbiAqL1xuLy8gVmlzaWJsZSBmb3IgdGVzdGluZy5cbmNsYXNzIF9fUFJJVkFURV9Mb2NhbENsaWVudFN0YXRlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5hY3RpdmVUYXJnZXRJZHMgPSBfX1BSSVZBVEVfdGFyZ2V0SWRTZXQoKTtcbiAgICB9XG4gICAgenMoZSkge1xuICAgICAgICB0aGlzLmFjdGl2ZVRhcmdldElkcyA9IHRoaXMuYWN0aXZlVGFyZ2V0SWRzLmFkZChlKTtcbiAgICB9XG4gICAganMoZSkge1xuICAgICAgICB0aGlzLmFjdGl2ZVRhcmdldElkcyA9IHRoaXMuYWN0aXZlVGFyZ2V0SWRzLmRlbGV0ZShlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29udmVydHMgdGhpcyBlbnRyeSBpbnRvIGEgSlNPTi1lbmNvZGVkIGZvcm1hdCB3ZSBjYW4gdXNlIGZvciBXZWJTdG9yYWdlLlxuICAgICAqIERvZXMgbm90IGVuY29kZSBgY2xpZW50SWRgIGFzIGl0IGlzIHBhcnQgb2YgdGhlIGtleSBpbiBXZWJTdG9yYWdlLlxuICAgICAqLyAgICBHcygpIHtcbiAgICAgICAgY29uc3QgZSA9IHtcbiAgICAgICAgICAgIGFjdGl2ZVRhcmdldElkczogdGhpcy5hY3RpdmVUYXJnZXRJZHMudG9BcnJheSgpLFxuICAgICAgICAgICAgdXBkYXRlVGltZU1zOiBEYXRlLm5vdygpXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShlKTtcbiAgICB9XG59XG5cbi8qKlxuICogYFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZWAgdXNlcyBXZWJTdG9yYWdlICh3aW5kb3cubG9jYWxTdG9yYWdlKSBhcyB0aGVcbiAqIGJhY2tpbmcgc3RvcmUgZm9yIHRoZSBTaGFyZWRDbGllbnRTdGF0ZS4gSXQga2VlcHMgdHJhY2sgb2YgYWxsIGFjdGl2ZVxuICogY2xpZW50cyBhbmQgc3VwcG9ydHMgbW9kaWZpY2F0aW9ucyBvZiB0aGUgbG9jYWwgY2xpZW50J3MgZGF0YS5cbiAqLyBjbGFzcyBfX1BSSVZBVEVfV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlIHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0LCBuLCByLCBpKSB7XG4gICAgICAgIHRoaXMud2luZG93ID0gZSwgdGhpcy5NaSA9IHQsIHRoaXMucGVyc2lzdGVuY2VLZXkgPSBuLCB0aGlzLkpzID0gciwgdGhpcy5zeW5jRW5naW5lID0gbnVsbCwgXG4gICAgICAgIHRoaXMub25saW5lU3RhdGVIYW5kbGVyID0gbnVsbCwgdGhpcy5zZXF1ZW5jZU51bWJlckhhbmRsZXIgPSBudWxsLCB0aGlzLkhzID0gdGhpcy5Zcy5iaW5kKHRoaXMpLCBcbiAgICAgICAgdGhpcy5acyA9IG5ldyBTb3J0ZWRNYXAoX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IpLCB0aGlzLnN0YXJ0ZWQgPSAhMSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYXB0dXJlcyBXZWJTdG9yYWdlIGV2ZW50cyB0aGF0IG9jY3VyIGJlZm9yZSBgc3RhcnQoKWAgaXMgY2FsbGVkLiBUaGVzZVxuICAgICAgICAgKiBldmVudHMgYXJlIHJlcGxheWVkIG9uY2UgYFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZWAgaXMgc3RhcnRlZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuWHMgPSBbXTtcbiAgICAgICAgLy8gRXNjYXBlIHRoZSBzcGVjaWFsIGNoYXJhY3RlcnMgbWVudGlvbmVkIGhlcmU6XG4gICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvR3VpZGUvUmVndWxhcl9FeHByZXNzaW9uc1xuICAgICAgICBjb25zdCBzID0gbi5yZXBsYWNlKC9bLiorP14ke30oKXxbXFxdXFxcXF0vZywgXCJcXFxcJCZcIik7XG4gICAgICAgIHRoaXMuc3RvcmFnZSA9IHRoaXMud2luZG93LmxvY2FsU3RvcmFnZSwgdGhpcy5jdXJyZW50VXNlciA9IGksIHRoaXMuZW8gPSBjcmVhdGVXZWJTdG9yYWdlQ2xpZW50U3RhdGVLZXkodGhpcy5wZXJzaXN0ZW5jZUtleSwgdGhpcy5KcyksIFxuICAgICAgICB0aGlzLm5vID0gXG4gICAgICAgIC8qKiBBc3NlbWJsZXMgdGhlIGtleSBmb3IgdGhlIGN1cnJlbnQgc2VxdWVuY2UgbnVtYmVyLiAqL1xuICAgICAgICBmdW5jdGlvbiBjcmVhdGVXZWJTdG9yYWdlU2VxdWVuY2VOdW1iZXJLZXkoZSkge1xuICAgICAgICAgICAgcmV0dXJuIGBmaXJlc3RvcmVfc2VxdWVuY2VfbnVtYmVyXyR7ZX1gO1xuICAgICAgICB9KHRoaXMucGVyc2lzdGVuY2VLZXkpLCB0aGlzLlpzID0gdGhpcy5acy5pbnNlcnQodGhpcy5KcywgbmV3IF9fUFJJVkFURV9Mb2NhbENsaWVudFN0YXRlKSwgXG4gICAgICAgIHRoaXMucm8gPSBuZXcgUmVnRXhwKGBeJHtXdH1fJHtzfV8oW15fXSopJGApLCB0aGlzLmlvID0gbmV3IFJlZ0V4cChgXiR7R3R9XyR7c31fKFxcXFxkKykoPzpfKC4qKSk/JGApLCBcbiAgICAgICAgdGhpcy5zbyA9IG5ldyBSZWdFeHAoYF4ke3p0fV8ke3N9XyhcXFxcZCspJGApLCB0aGlzLm9vID0gXG4gICAgICAgIC8qKiBBc3NlbWJsZXMgdGhlIGtleSBmb3IgdGhlIG9ubGluZSBzdGF0ZSBvZiB0aGUgcHJpbWFyeSB0YWIuICovXG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVdlYlN0b3JhZ2VPbmxpbmVTdGF0ZUtleShlKSB7XG4gICAgICAgICAgICByZXR1cm4gYGZpcmVzdG9yZV9vbmxpbmVfc3RhdGVfJHtlfWA7XG4gICAgICAgIH1cbiAgICAgICAgLy8gVGhlIFdlYlN0b3JhZ2UgcHJlZml4IHRoYXQgcGxheXMgYXMgYSBldmVudCB0byBpbmRpY2F0ZSB0aGUgcmVtb3RlIGRvY3VtZW50c1xuICAgICAgICAvLyBtaWdodCBoYXZlIGNoYW5nZWQgZHVlIHRvIHNvbWUgc2Vjb25kYXJ5IHRhYnMgbG9hZGluZyBhIGJ1bmRsZS5cbiAgICAgICAgLy8gZm9ybWF0IG9mIHRoZSBrZXkgaXM6XG4gICAgICAgIC8vICAgICBmaXJlc3RvcmVfYnVuZGxlX2xvYWRlZF92Ml88cGVyc2lzdGVuY2VLZXk+XG4gICAgICAgIC8vIFRoZSB2ZXJzaW9uIGVuZGluZyB3aXRoIFwidjJcIiBzdG9yZXMgdGhlIGxpc3Qgb2YgbW9kaWZpZWQgY29sbGVjdGlvbiBncm91cHMuXG4gICAgICAgICh0aGlzLnBlcnNpc3RlbmNlS2V5KSwgdGhpcy5fbyA9IGZ1bmN0aW9uIGNyZWF0ZUJ1bmRsZUxvYWRlZEtleShlKSB7XG4gICAgICAgICAgICByZXR1cm4gYGZpcmVzdG9yZV9idW5kbGVfbG9hZGVkX3YyXyR7ZX1gO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRoZSBXZWJTdG9yYWdlIGtleSBwcmVmaXggZm9yIHRoZSBrZXkgdGhhdCBzdG9yZXMgdGhlIGxhc3Qgc2VxdWVuY2UgbnVtYmVyIGFsbG9jYXRlZC4gVGhlIGtleVxuICAgICAgICAvLyBsb29rcyBsaWtlICdmaXJlc3RvcmVfc2VxdWVuY2VfbnVtYmVyXzxwZXJzaXN0ZW5jZV9wcmVmaXg+Jy5cbiAgICAgICAgKHRoaXMucGVyc2lzdGVuY2VLZXkpLCBcbiAgICAgICAgLy8gUmF0aGVyIHRoYW4gYWRkaW5nIHRoZSBzdG9yYWdlIG9ic2VydmVyIGR1cmluZyBzdGFydCgpLCB3ZSBhZGQgdGhlXG4gICAgICAgIC8vIHN0b3JhZ2Ugb2JzZXJ2ZXIgZHVyaW5nIGluaXRpYWxpemF0aW9uLiBUaGlzIGVuc3VyZXMgdGhhdCB3ZSBjb2xsZWN0XG4gICAgICAgIC8vIGV2ZW50cyBiZWZvcmUgb3RoZXIgY29tcG9uZW50cyBwb3B1bGF0ZSB0aGVpciBpbml0aWFsIHN0YXRlIChkdXJpbmcgdGhlaXJcbiAgICAgICAgLy8gcmVzcGVjdGl2ZSBzdGFydCgpIGNhbGxzKS4gT3RoZXJ3aXNlLCB3ZSBtaWdodCBmb3IgZXhhbXBsZSBtaXNzIGFcbiAgICAgICAgLy8gbXV0YXRpb24gdGhhdCBpcyBhZGRlZCBhZnRlciBMb2NhbFN0b3JlJ3Mgc3RhcnQoKSBwcm9jZXNzZWQgdGhlIGV4aXN0aW5nXG4gICAgICAgIC8vIG11dGF0aW9ucyBidXQgYmVmb3JlIHdlIG9ic2VydmUgV2ViU3RvcmFnZSBldmVudHMuXG4gICAgICAgIHRoaXMud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzdG9yYWdlXCIsIHRoaXMuSHMpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyAndHJ1ZScgaWYgV2ViU3RvcmFnZSBpcyBhdmFpbGFibGUgaW4gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuICovICAgIHN0YXRpYyB2KGUpIHtcbiAgICAgICAgcmV0dXJuICEoIWUgfHwgIWUubG9jYWxTdG9yYWdlKTtcbiAgICB9XG4gICAgYXN5bmMgc3RhcnQoKSB7XG4gICAgICAgIC8vIFJldHJpZXZlIHRoZSBsaXN0IG9mIGV4aXN0aW5nIGNsaWVudHMgdG8gYmFja2ZpbGwgdGhlIGRhdGEgaW5cbiAgICAgICAgLy8gU2hhcmVkQ2xpZW50U3RhdGUuXG4gICAgICAgIGNvbnN0IGUgPSBhd2FpdCB0aGlzLnN5bmNFbmdpbmUuVHMoKTtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIHtcbiAgICAgICAgICAgIGlmICh0ID09PSB0aGlzLkpzKSBjb250aW51ZTtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmdldEl0ZW0oY3JlYXRlV2ViU3RvcmFnZUNsaWVudFN0YXRlS2V5KHRoaXMucGVyc2lzdGVuY2VLZXksIHQpKTtcbiAgICAgICAgICAgIGlmIChlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IF9fUFJJVkFURV9SZW1vdGVDbGllbnRTdGF0ZS5Xcyh0LCBlKTtcbiAgICAgICAgICAgICAgICBuICYmICh0aGlzLlpzID0gdGhpcy5acy5pbnNlcnQobi5jbGllbnRJZCwgbikpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuYW8oKTtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlcmUgaXMgYW4gZXhpc3Rpbmcgb25saW5lIHN0YXRlIGFuZCBjYWxsIHRoZSBjYWxsYmFjayBoYW5kbGVyXG4gICAgICAgIC8vIGlmIGFwcGxpY2FibGUuXG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLnN0b3JhZ2UuZ2V0SXRlbSh0aGlzLm9vKTtcbiAgICAgICAgaWYgKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnVvKHQpO1xuICAgICAgICAgICAgZSAmJiB0aGlzLmNvKGUpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiB0aGlzLlhzKSB0aGlzLllzKGUpO1xuICAgICAgICB0aGlzLlhzID0gW10sIFxuICAgICAgICAvLyBSZWdpc3RlciBhIHdpbmRvdyB1bmxvYWQgaG9vayB0byByZW1vdmUgdGhlIGNsaWVudCBtZXRhZGF0YSBlbnRyeSBmcm9tXG4gICAgICAgIC8vIFdlYlN0b3JhZ2UgZXZlbiBpZiBgc2h1dGRvd24oKWAgd2FzIG5vdCBjYWxsZWQuXG4gICAgICAgIHRoaXMud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJwYWdlaGlkZVwiLCAoKCkgPT4gdGhpcy5zaHV0ZG93bigpKSksIHRoaXMuc3RhcnRlZCA9ICEwO1xuICAgIH1cbiAgICB3cml0ZVNlcXVlbmNlTnVtYmVyKGUpIHtcbiAgICAgICAgdGhpcy5zZXRJdGVtKHRoaXMubm8sIEpTT04uc3RyaW5naWZ5KGUpKTtcbiAgICB9XG4gICAgZ2V0QWxsQWN0aXZlUXVlcnlUYXJnZXRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sbyh0aGlzLlpzKTtcbiAgICB9XG4gICAgaXNBY3RpdmVRdWVyeVRhcmdldChlKSB7XG4gICAgICAgIGxldCB0ID0gITE7XG4gICAgICAgIHJldHVybiB0aGlzLlpzLmZvckVhY2goKChuLCByKSA9PiB7XG4gICAgICAgICAgICByLmFjdGl2ZVRhcmdldElkcy5oYXMoZSkgJiYgKHQgPSAhMCk7XG4gICAgICAgIH0pKSwgdDtcbiAgICB9XG4gICAgYWRkUGVuZGluZ011dGF0aW9uKGUpIHtcbiAgICAgICAgdGhpcy5obyhlLCBcInBlbmRpbmdcIik7XG4gICAgfVxuICAgIHVwZGF0ZU11dGF0aW9uU3RhdGUoZSwgdCwgbikge1xuICAgICAgICB0aGlzLmhvKGUsIHQsIG4pLCBcbiAgICAgICAgLy8gT25jZSBhIGZpbmFsIG11dGF0aW9uIHJlc3VsdCBpcyBvYnNlcnZlZCBieSBvdGhlciBjbGllbnRzLCB0aGV5IG5vIGxvbmdlclxuICAgICAgICAvLyBhY2Nlc3MgdGhlIG11dGF0aW9uJ3MgbWV0YWRhdGEgZW50cnkuIFNpbmNlIFdlYlN0b3JhZ2UgcmVwbGF5cyBldmVudHNcbiAgICAgICAgLy8gaW4gb3JkZXIsIGl0IGlzIHNhZmUgdG8gZGVsZXRlIHRoZSBlbnRyeSByaWdodCBhZnRlciB1cGRhdGluZyBpdC5cbiAgICAgICAgdGhpcy5QbyhlKTtcbiAgICB9XG4gICAgYWRkTG9jYWxRdWVyeVRhcmdldChlLCB0ID0gITApIHtcbiAgICAgICAgbGV0IG4gPSBcIm5vdC1jdXJyZW50XCI7XG4gICAgICAgIC8vIExvb2t1cCBhbiBleGlzdGluZyBxdWVyeSBzdGF0ZSBpZiB0aGUgdGFyZ2V0IElEIHdhcyBhbHJlYWR5IHJlZ2lzdGVyZWRcbiAgICAgICAgLy8gYnkgYW5vdGhlciB0YWJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0FjdGl2ZVF1ZXJ5VGFyZ2V0KGUpKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5zdG9yYWdlLmdldEl0ZW0oY3JlYXRlV2ViU3RvcmFnZVF1ZXJ5VGFyZ2V0TWV0YWRhdGFLZXkodGhpcy5wZXJzaXN0ZW5jZUtleSwgZSkpO1xuICAgICAgICAgICAgaWYgKHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByID0gX19QUklWQVRFX1F1ZXJ5VGFyZ2V0TWV0YWRhdGEuV3MoZSwgdCk7XG4gICAgICAgICAgICAgICAgciAmJiAobiA9IHIuc3RhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIElmIHRoZSBxdWVyeSBpcyBsaXN0ZW5pbmcgdG8gY2FjaGUgb25seSwgdGhlIHRhcmdldCBJRCBzaG91bGQgbm90IGJlIHJlZ2lzdGVyZWQgd2l0aCB0aGVcbiAgICAgICAgLy8gbG9jYWwgRmlyZXN0b3JlIGNsaWVudCBhcyBhbiBhY3RpdmUgd2F0Y2ggdGFyZ2V0LlxuICAgICAgICAgICAgICAgIHJldHVybiB0ICYmIHRoaXMuVG8uenMoZSksIHRoaXMuYW8oKSwgbjtcbiAgICB9XG4gICAgcmVtb3ZlTG9jYWxRdWVyeVRhcmdldChlKSB7XG4gICAgICAgIHRoaXMuVG8uanMoZSksIHRoaXMuYW8oKTtcbiAgICB9XG4gICAgaXNMb2NhbFF1ZXJ5VGFyZ2V0KGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuVG8uYWN0aXZlVGFyZ2V0SWRzLmhhcyhlKTtcbiAgICB9XG4gICAgY2xlYXJRdWVyeVN0YXRlKGUpIHtcbiAgICAgICAgdGhpcy5yZW1vdmVJdGVtKGNyZWF0ZVdlYlN0b3JhZ2VRdWVyeVRhcmdldE1ldGFkYXRhS2V5KHRoaXMucGVyc2lzdGVuY2VLZXksIGUpKTtcbiAgICB9XG4gICAgdXBkYXRlUXVlcnlTdGF0ZShlLCB0LCBuKSB7XG4gICAgICAgIHRoaXMuSW8oZSwgdCwgbik7XG4gICAgfVxuICAgIGhhbmRsZVVzZXJDaGFuZ2UoZSwgdCwgbikge1xuICAgICAgICB0LmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgdGhpcy5QbyhlKTtcbiAgICAgICAgfSkpLCB0aGlzLmN1cnJlbnRVc2VyID0gZSwgbi5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIHRoaXMuYWRkUGVuZGluZ011dGF0aW9uKGUpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHNldE9ubGluZVN0YXRlKGUpIHtcbiAgICAgICAgdGhpcy5FbyhlKTtcbiAgICB9XG4gICAgbm90aWZ5QnVuZGxlTG9hZGVkKGUpIHtcbiAgICAgICAgdGhpcy5BbyhlKTtcbiAgICB9XG4gICAgc2h1dGRvd24oKSB7XG4gICAgICAgIHRoaXMuc3RhcnRlZCAmJiAodGhpcy53aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN0b3JhZ2VcIiwgdGhpcy5IcyksIHRoaXMucmVtb3ZlSXRlbSh0aGlzLmVvKSwgXG4gICAgICAgIHRoaXMuc3RhcnRlZCA9ICExKTtcbiAgICB9XG4gICAgZ2V0SXRlbShlKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLnN0b3JhZ2UuZ2V0SXRlbShlKTtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9sb2dEZWJ1ZyhqdCwgXCJSRUFEXCIsIGUsIHQpLCB0O1xuICAgIH1cbiAgICBzZXRJdGVtKGUsIHQpIHtcbiAgICAgICAgX19QUklWQVRFX2xvZ0RlYnVnKGp0LCBcIlNFVFwiLCBlLCB0KSwgdGhpcy5zdG9yYWdlLnNldEl0ZW0oZSwgdCk7XG4gICAgfVxuICAgIHJlbW92ZUl0ZW0oZSkge1xuICAgICAgICBfX1BSSVZBVEVfbG9nRGVidWcoanQsIFwiUkVNT1ZFXCIsIGUpLCB0aGlzLnN0b3JhZ2UucmVtb3ZlSXRlbShlKTtcbiAgICB9XG4gICAgWXMoZSkge1xuICAgICAgICAvLyBOb3RlOiBUaGUgZnVuY3Rpb24gaXMgdHlwZWQgdG8gdGFrZSBFdmVudCB0byBiZSBpbnRlcmZhY2UtY29tcGF0aWJsZSB3aXRoXG4gICAgICAgIC8vIGBXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcmAuXG4gICAgICAgIGNvbnN0IHQgPSBlO1xuICAgICAgICBpZiAodC5zdG9yYWdlQXJlYSA9PT0gdGhpcy5zdG9yYWdlKSB7XG4gICAgICAgICAgICBpZiAoX19QUklWQVRFX2xvZ0RlYnVnKGp0LCBcIkVWRU5UXCIsIHQua2V5LCB0Lm5ld1ZhbHVlKSwgdC5rZXkgPT09IHRoaXMuZW8pIHJldHVybiB2b2lkIF9fUFJJVkFURV9sb2dFcnJvcihcIlJlY2VpdmVkIFdlYlN0b3JhZ2Ugbm90aWZpY2F0aW9uIGZvciBsb2NhbCBjaGFuZ2UuIEFub3RoZXIgY2xpZW50IG1pZ2h0IGhhdmUgZ2FyYmFnZS1jb2xsZWN0ZWQgb3VyIHN0YXRlXCIpO1xuICAgICAgICAgICAgdGhpcy5NaS5lbnF1ZXVlUmV0cnlhYmxlKChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPT0gdC5rZXkpIGlmICh0aGlzLnJvLnRlc3QodC5rZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSB0Lm5ld1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuUm8odC5rZXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLlZvKGUsIG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLm1vKHQua2V5LCB0Lm5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZSkgcmV0dXJuIHRoaXMuVm8oZS5jbGllbnRJZCwgZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5pby50ZXN0KHQua2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT09IHQubmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5mbyh0LmtleSwgdC5uZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUpIHJldHVybiB0aGlzLnBvKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc28udGVzdCh0LmtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9PSB0Lm5ld1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMueW8odC5rZXksIHQubmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlKSByZXR1cm4gdGhpcy53byhlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0LmtleSA9PT0gdGhpcy5vbykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT09IHQubmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy51byh0Lm5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZSkgcmV0dXJuIHRoaXMuY28oZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodC5rZXkgPT09IHRoaXMubm8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBmdW5jdGlvbiBfX1BSSVZBVEVfZnJvbVdlYlN0b3JhZ2VTZXF1ZW5jZU51bWJlcihlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHQgPSBfX1BSSVZBVEVfTGlzdGVuU2VxdWVuY2UuY2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gZSkgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IEpTT04ucGFyc2UoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fUFJJVkFURV9oYXJkQXNzZXJ0KFwibnVtYmVyXCIgPT0gdHlwZW9mIG4sIDMwNjM2LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTbzogZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwgdCA9IG47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BSSVZBVEVfbG9nRXJyb3IoanQsIFwiRmFpbGVkIHRvIHJlYWQgc2VxdWVuY2UgbnVtYmVyIGZyb20gV2ViU3RvcmFnZVwiLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAqIGBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZWAgaXMgYSBzaW1wbGUgaW1wbGVtZW50YXRpb24gb2YgU2hhcmVkQ2xpZW50U3RhdGUgZm9yXG4gKiBjbGllbnRzIHVzaW5nIG1lbW9yeSBwZXJzaXN0ZW5jZS4gVGhlIHN0YXRlIGluIHRoaXMgY2xhc3MgcmVtYWlucyBmdWxseVxuICogaXNvbGF0ZWQgYW5kIG5vIHN5bmNocm9uaXphdGlvbiBpcyBwZXJmb3JtZWQuXG4gKi8gKHQubmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZSAhPT0gX19QUklWQVRFX0xpc3RlblNlcXVlbmNlLmNlICYmIHRoaXMuc2VxdWVuY2VOdW1iZXJIYW5kbGVyKGUpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQua2V5ID09PSB0aGlzLl9vKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5ibyh0Lm5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IFByb21pc2UuYWxsKGUubWFwKChlID0+IHRoaXMuc3luY0VuZ2luZS5EbyhlKSkpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB0aGlzLlhzLnB1c2godCk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IFRvKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5acy5nZXQodGhpcy5Kcyk7XG4gICAgfVxuICAgIGFvKCkge1xuICAgICAgICB0aGlzLnNldEl0ZW0odGhpcy5lbywgdGhpcy5Uby5HcygpKTtcbiAgICB9XG4gICAgaG8oZSwgdCwgbikge1xuICAgICAgICBjb25zdCByID0gbmV3IF9fUFJJVkFURV9NdXRhdGlvbk1ldGFkYXRhKHRoaXMuY3VycmVudFVzZXIsIGUsIHQsIG4pLCBpID0gY3JlYXRlV2ViU3RvcmFnZU11dGF0aW9uQmF0Y2hLZXkodGhpcy5wZXJzaXN0ZW5jZUtleSwgdGhpcy5jdXJyZW50VXNlciwgZSk7XG4gICAgICAgIHRoaXMuc2V0SXRlbShpLCByLkdzKCkpO1xuICAgIH1cbiAgICBQbyhlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBjcmVhdGVXZWJTdG9yYWdlTXV0YXRpb25CYXRjaEtleSh0aGlzLnBlcnNpc3RlbmNlS2V5LCB0aGlzLmN1cnJlbnRVc2VyLCBlKTtcbiAgICAgICAgdGhpcy5yZW1vdmVJdGVtKHQpO1xuICAgIH1cbiAgICBFbyhlKSB7XG4gICAgICAgIGNvbnN0IHQgPSB7XG4gICAgICAgICAgICBjbGllbnRJZDogdGhpcy5KcyxcbiAgICAgICAgICAgIG9ubGluZVN0YXRlOiBlXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc3RvcmFnZS5zZXRJdGVtKHRoaXMub28sIEpTT04uc3RyaW5naWZ5KHQpKTtcbiAgICB9XG4gICAgSW8oZSwgdCwgbikge1xuICAgICAgICBjb25zdCByID0gY3JlYXRlV2ViU3RvcmFnZVF1ZXJ5VGFyZ2V0TWV0YWRhdGFLZXkodGhpcy5wZXJzaXN0ZW5jZUtleSwgZSksIGkgPSBuZXcgX19QUklWQVRFX1F1ZXJ5VGFyZ2V0TWV0YWRhdGEoZSwgdCwgbik7XG4gICAgICAgIHRoaXMuc2V0SXRlbShyLCBpLkdzKCkpO1xuICAgIH1cbiAgICBBbyhlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBKU09OLnN0cmluZ2lmeShBcnJheS5mcm9tKGUpKTtcbiAgICAgICAgdGhpcy5zZXRJdGVtKHRoaXMuX28sIHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBjbGllbnQgc3RhdGUga2V5IGluIFdlYlN0b3JhZ2UuIFJldHVybnMgbnVsbCBpZiB0aGUga2V5IGRvZXMgbm90XG4gICAgICogbWF0Y2ggdGhlIGV4cGVjdGVkIGtleSBmb3JtYXQuXG4gICAgICovICAgIFJvKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMucm8uZXhlYyhlKTtcbiAgICAgICAgcmV0dXJuIHQgPyB0WzFdIDogbnVsbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgY2xpZW50IHN0YXRlIGluIFdlYlN0b3JhZ2UuIFJldHVybnMgJ251bGwnIGlmIHRoZSB2YWx1ZSBjb3VsZCBub3RcbiAgICAgKiBiZSBwYXJzZWQuXG4gICAgICovICAgIG1vKGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuUm8oZSk7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfUmVtb3RlQ2xpZW50U3RhdGUuV3MobiwgdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIG11dGF0aW9uIGJhdGNoIHN0YXRlIGluIFdlYlN0b3JhZ2UuIFJldHVybnMgJ251bGwnIGlmIHRoZSB2YWx1ZVxuICAgICAqIGNvdWxkIG5vdCBiZSBwYXJzZWQuXG4gICAgICovICAgIGZvKGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuaW8uZXhlYyhlKSwgciA9IE51bWJlcihuWzFdKSwgaSA9IHZvaWQgMCAhPT0gblsyXSA/IG5bMl0gOiBudWxsO1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX011dGF0aW9uTWV0YWRhdGEuV3MobmV3IFVzZXIoaSksIHIsIHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBxdWVyeSB0YXJnZXQgc3RhdGUgZnJvbSBXZWJTdG9yYWdlLiBSZXR1cm5zICdudWxsJyBpZiB0aGUgdmFsdWVcbiAgICAgKiBjb3VsZCBub3QgYmUgcGFyc2VkLlxuICAgICAqLyAgICB5byhlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLnNvLmV4ZWMoZSksIHIgPSBOdW1iZXIoblsxXSk7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfUXVlcnlUYXJnZXRNZXRhZGF0YS5XcyhyLCB0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGFuIG9ubGluZSBzdGF0ZSBmcm9tIFdlYlN0b3JhZ2UuIFJldHVybnMgJ251bGwnIGlmIHRoZSB2YWx1ZVxuICAgICAqIGNvdWxkIG5vdCBiZSBwYXJzZWQuXG4gICAgICovICAgIHVvKGUpIHtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9TaGFyZWRPbmxpbmVTdGF0ZS5XcyhlKTtcbiAgICB9XG4gICAgYm8oZSkge1xuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShlKTtcbiAgICB9XG4gICAgYXN5bmMgcG8oZSkge1xuICAgICAgICBpZiAoZS51c2VyLnVpZCA9PT0gdGhpcy5jdXJyZW50VXNlci51aWQpIHJldHVybiB0aGlzLnN5bmNFbmdpbmUuQ28oZS5iYXRjaElkLCBlLnN0YXRlLCBlLmVycm9yKTtcbiAgICAgICAgX19QUklWQVRFX2xvZ0RlYnVnKGp0LCBgSWdub3JpbmcgbXV0YXRpb24gZm9yIG5vbi1hY3RpdmUgdXNlciAke2UudXNlci51aWR9YCk7XG4gICAgfVxuICAgIHdvKGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3luY0VuZ2luZS52byhlLnRhcmdldElkLCBlLnN0YXRlLCBlLmVycm9yKTtcbiAgICB9XG4gICAgVm8oZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gdCA/IHRoaXMuWnMuaW5zZXJ0KGUsIHQpIDogdGhpcy5acy5yZW1vdmUoZSksIHIgPSB0aGlzLmxvKHRoaXMuWnMpLCBpID0gdGhpcy5sbyhuKSwgcyA9IFtdLCBvID0gW107XG4gICAgICAgIHJldHVybiBpLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgci5oYXMoZSkgfHwgcy5wdXNoKGUpO1xuICAgICAgICB9KSksIHIuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICBpLmhhcyhlKSB8fCBvLnB1c2goZSk7XG4gICAgICAgIH0pKSwgdGhpcy5zeW5jRW5naW5lLkZvKHMsIG8pLnRoZW4oKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuWnMgPSBuO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGNvKGUpIHtcbiAgICAgICAgLy8gV2UgY2hlY2sgd2hldGhlciB0aGUgY2xpZW50IHRoYXQgd3JvdGUgdGhpcyBvbmxpbmUgc3RhdGUgaXMgc3RpbGwgYWN0aXZlXG4gICAgICAgIC8vIGJ5IGNvbXBhcmluZyBpdHMgY2xpZW50IElEIHRvIHRoZSBsaXN0IG9mIGNsaWVudHMga2VwdCBhY3RpdmUgaW5cbiAgICAgICAgLy8gSW5kZXhlZERiLiBJZiBhIGNsaWVudCBkb2VzIG5vdCB1cGRhdGUgdGhlaXIgSW5kZXhlZERiIGNsaWVudCBzdGF0ZVxuICAgICAgICAvLyB3aXRoaW4gNSBzZWNvbmRzLCBpdCBpcyBjb25zaWRlcmVkIGluYWN0aXZlIGFuZCB3ZSBkb24ndCBlbWl0IGFuIG9ubGluZVxuICAgICAgICAvLyBzdGF0ZSBldmVudC5cbiAgICAgICAgdGhpcy5acy5nZXQoZS5jbGllbnRJZCkgJiYgdGhpcy5vbmxpbmVTdGF0ZUhhbmRsZXIoZS5vbmxpbmVTdGF0ZSk7XG4gICAgfVxuICAgIGxvKGUpIHtcbiAgICAgICAgbGV0IHQgPSBfX1BSSVZBVEVfdGFyZ2V0SWRTZXQoKTtcbiAgICAgICAgcmV0dXJuIGUuZm9yRWFjaCgoKGUsIG4pID0+IHtcbiAgICAgICAgICAgIHQgPSB0LnVuaW9uV2l0aChuLmFjdGl2ZVRhcmdldElkcyk7XG4gICAgICAgIH0pKSwgdDtcbiAgICB9XG59XG5cbmNsYXNzIF9fUFJJVkFURV9NZW1vcnlTaGFyZWRDbGllbnRTdGF0ZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuTW8gPSBuZXcgX19QUklWQVRFX0xvY2FsQ2xpZW50U3RhdGUsIHRoaXMueG8gPSB7fSwgdGhpcy5vbmxpbmVTdGF0ZUhhbmRsZXIgPSBudWxsLCBcbiAgICAgICAgdGhpcy5zZXF1ZW5jZU51bWJlckhhbmRsZXIgPSBudWxsO1xuICAgIH1cbiAgICBhZGRQZW5kaW5nTXV0YXRpb24oZSkge1xuICAgICAgICAvLyBObyBvcC5cbiAgICB9XG4gICAgdXBkYXRlTXV0YXRpb25TdGF0ZShlLCB0LCBuKSB7XG4gICAgICAgIC8vIE5vIG9wLlxuICAgIH1cbiAgICBhZGRMb2NhbFF1ZXJ5VGFyZ2V0KGUsIHQgPSAhMCkge1xuICAgICAgICByZXR1cm4gdCAmJiB0aGlzLk1vLnpzKGUpLCB0aGlzLnhvW2VdIHx8IFwibm90LWN1cnJlbnRcIjtcbiAgICB9XG4gICAgdXBkYXRlUXVlcnlTdGF0ZShlLCB0LCBuKSB7XG4gICAgICAgIHRoaXMueG9bZV0gPSB0O1xuICAgIH1cbiAgICByZW1vdmVMb2NhbFF1ZXJ5VGFyZ2V0KGUpIHtcbiAgICAgICAgdGhpcy5Nby5qcyhlKTtcbiAgICB9XG4gICAgaXNMb2NhbFF1ZXJ5VGFyZ2V0KGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuTW8uYWN0aXZlVGFyZ2V0SWRzLmhhcyhlKTtcbiAgICB9XG4gICAgY2xlYXJRdWVyeVN0YXRlKGUpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMueG9bZV07XG4gICAgfVxuICAgIGdldEFsbEFjdGl2ZVF1ZXJ5VGFyZ2V0cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuTW8uYWN0aXZlVGFyZ2V0SWRzO1xuICAgIH1cbiAgICBpc0FjdGl2ZVF1ZXJ5VGFyZ2V0KGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuTW8uYWN0aXZlVGFyZ2V0SWRzLmhhcyhlKTtcbiAgICB9XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLk1vID0gbmV3IF9fUFJJVkFURV9Mb2NhbENsaWVudFN0YXRlLCBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgaGFuZGxlVXNlckNoYW5nZShlLCB0LCBuKSB7XG4gICAgICAgIC8vIE5vIG9wLlxuICAgIH1cbiAgICBzZXRPbmxpbmVTdGF0ZShlKSB7XG4gICAgICAgIC8vIE5vIG9wLlxuICAgIH1cbiAgICBzaHV0ZG93bigpIHt9XG4gICAgd3JpdGVTZXF1ZW5jZU51bWJlcihlKSB7fVxuICAgIG5vdGlmeUJ1bmRsZUxvYWRlZChlKSB7XG4gICAgICAgIC8vIE5vIG9wLlxuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgX19QUklWQVRFX05vb3BDb25uZWN0aXZpdHlNb25pdG9yIHtcbiAgICBPbyhlKSB7XG4gICAgICAgIC8vIE5vLW9wLlxuICAgIH1cbiAgICBzaHV0ZG93bigpIHtcbiAgICAgICAgLy8gTm8tb3AuXG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gUmVmZXJlbmNlcyB0byBgd2luZG93YCBhcmUgZ3VhcmRlZCBieSBCcm93c2VyQ29ubmVjdGl2aXR5TW9uaXRvci5pc0F2YWlsYWJsZSgpXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1yZXN0cmljdGVkLWdsb2JhbHMgKi8gY29uc3QgSnQgPSBcIkNvbm5lY3Rpdml0eU1vbml0b3JcIjtcblxuLyoqXG4gKiBCcm93c2VyIGltcGxlbWVudGF0aW9uIG9mIENvbm5lY3Rpdml0eU1vbml0b3IuXG4gKi8gY2xhc3MgX19QUklWQVRFX0Jyb3dzZXJDb25uZWN0aXZpdHlNb25pdG9yIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5ObyA9ICgpID0+IHRoaXMuQm8oKSwgdGhpcy5MbyA9ICgpID0+IHRoaXMua28oKSwgdGhpcy5xbyA9IFtdLCB0aGlzLlFvKCk7XG4gICAgfVxuICAgIE9vKGUpIHtcbiAgICAgICAgdGhpcy5xby5wdXNoKGUpO1xuICAgIH1cbiAgICBzaHV0ZG93bigpIHtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJvbmxpbmVcIiwgdGhpcy5ObyksIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwib2ZmbGluZVwiLCB0aGlzLkxvKTtcbiAgICB9XG4gICAgUW8oKSB7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwib25saW5lXCIsIHRoaXMuTm8pLCB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm9mZmxpbmVcIiwgdGhpcy5Mbyk7XG4gICAgfVxuICAgIEJvKCkge1xuICAgICAgICBfX1BSSVZBVEVfbG9nRGVidWcoSnQsIFwiTmV0d29yayBjb25uZWN0aXZpdHkgY2hhbmdlZDogQVZBSUxBQkxFXCIpO1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5xbykgZSgwIC8qIE5ldHdvcmtTdGF0dXMuQVZBSUxBQkxFICovKTtcbiAgICB9XG4gICAga28oKSB7XG4gICAgICAgIF9fUFJJVkFURV9sb2dEZWJ1ZyhKdCwgXCJOZXR3b3JrIGNvbm5lY3Rpdml0eSBjaGFuZ2VkOiBVTkFWQUlMQUJMRVwiKTtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMucW8pIGUoMSAvKiBOZXR3b3JrU3RhdHVzLlVOQVZBSUxBQkxFICovKTtcbiAgICB9XG4gICAgLy8gVE9ETyhjaGVuYnJpYW4pOiBDb25zaWRlciBwYXNzaW5nIGluIHdpbmRvdyBlaXRoZXIgaW50byB0aGlzIGNvbXBvbmVudCBvclxuICAgIC8vIGhlcmUgZm9yIHRlc3RpbmcgdmlhIEZha2VXaW5kb3cuXG4gICAgLyoqIENoZWNrcyB0aGF0IGFsbCB1c2VkIGF0dHJpYnV0ZXMgb2Ygd2luZG93IGFyZSBhdmFpbGFibGUuICovXG4gICAgc3RhdGljIHYoKSB7XG4gICAgICAgIHJldHVybiBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiB3aW5kb3cgJiYgdm9pZCAwICE9PSB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciAmJiB2b2lkIDAgIT09IHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVGhlIHZhbHVlIHJldHVybmVkIGZyb20gdGhlIG1vc3QgcmVjZW50IGludm9jYXRpb24gb2ZcbiAqIGBnZW5lcmF0ZVVuaXF1ZURlYnVnSWQoKWAsIG9yIG51bGwgaWYgaXQgaGFzIG5ldmVyIGJlZW4gaW52b2tlZC5cbiAqLyBsZXQgSHQgPSBudWxsO1xuXG4vKipcbiAqIEdlbmVyYXRlcyBhbmQgcmV0dXJucyBhbiBpbml0aWFsIHZhbHVlIGZvciBgbGFzdFVuaXF1ZURlYnVnSWRgLlxuICpcbiAqIFRoZSByZXR1cm5lZCB2YWx1ZSBpcyByYW5kb21seSBzZWxlY3RlZCBmcm9tIGEgcmFuZ2Ugb2YgaW50ZWdlcnMgdGhhdCBhcmVcbiAqIHJlcHJlc2VudGVkIGFzIDggaGV4YWRlY2ltYWwgZGlnaXRzLiBUaGlzIG1lYW5zIHRoYXQgKHdpdGhpbiByZWFzb24pIGFueVxuICogbnVtYmVycyBnZW5lcmF0ZWQgYnkgaW5jcmVtZW50aW5nIHRoZSByZXR1cm5lZCBudW1iZXIgYnkgMSB3aWxsIGFsc28gYmVcbiAqIHJlcHJlc2VudGVkIGJ5IDggaGV4YWRlY2ltYWwgZGlnaXRzLiBUaGlzIGxlYWRzIHRvIGFsbCBcIklEc1wiIGhhdmluZyB0aGUgc2FtZVxuICogbGVuZ3RoIHdoZW4gY29udmVydGVkIHRvIGEgaGV4YWRlY2ltYWwgc3RyaW5nLCBtYWtpbmcgcmVhZGluZyBsb2dzIGNvbnRhaW5pbmdcbiAqIHRoZXNlIElEcyBlYXNpZXIgdG8gZm9sbG93LiBBbmQgc2luY2UgdGhlIHJldHVybiB2YWx1ZSBpcyByYW5kb21seSBzZWxlY3RlZFxuICogaXQgd2lsbCBoZWxwIHRvIGRpZmZlcmVudGlhdGUgYmV0d2VlbiBsb2dzIGZyb20gZGlmZmVyZW50IGV4ZWN1dGlvbnMuXG4gKi9cbi8qKlxuICogR2VuZXJhdGVzIGFuZCByZXR1cm5zIGEgdW5pcXVlIElEIGFzIGEgaGV4YWRlY2ltYWwgc3RyaW5nLlxuICpcbiAqIFRoZSByZXR1cm5lZCBJRCBpcyBpbnRlbmRlZCB0byBiZSB1c2VkIGluIGRlYnVnIGxvZ2dpbmcgbWVzc2FnZXMgdG8gaGVscFxuICogY29ycmVsYXRlIGxvZyBtZXNzYWdlcyB0aGF0IG1heSBiZSBzcGF0aWFsbHkgc2VwYXJhdGVkIGluIHRoZSBsb2dzLCBidXRcbiAqIGxvZ2ljYWxseSByZWxhdGVkLiBGb3IgZXhhbXBsZSwgYSBuZXR3b3JrIGNvbm5lY3Rpb24gY291bGQgaW5jbHVkZSB0aGUgc2FtZVxuICogXCJkZWJ1ZyBJRFwiIHN0cmluZyBpbiBhbGwgb2YgaXRzIGxvZyBtZXNzYWdlcyB0byBoZWxwIHRyYWNlIGEgc3BlY2lmaWNcbiAqIGNvbm5lY3Rpb24gb3ZlciB0aW1lLlxuICpcbiAqIEByZXR1cm4gdGhlIDEwLWNoYXJhY3RlciBnZW5lcmF0ZWQgSUQgKGUuZy4gXCIweGExYjJjM2Q0XCIpLlxuICovXG5mdW5jdGlvbiBfX1BSSVZBVEVfZ2VuZXJhdGVVbmlxdWVEZWJ1Z0lkKCkge1xuICAgIHJldHVybiBudWxsID09PSBIdCA/IEh0ID0gZnVuY3Rpb24gX19QUklWQVRFX2dlbmVyYXRlSW5pdGlhbFVuaXF1ZURlYnVnSWQoKSB7XG4gICAgICAgIHJldHVybiAyNjg0MzU0NTYgKyBNYXRoLnJvdW5kKDIxNDc0ODM2NDggKiBNYXRoLnJhbmRvbSgpKTtcbiAgICB9KCkgOiBIdCsrLCBcIjB4XCIgKyBIdC50b1N0cmluZygxNik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IFl0ID0gXCJSZXN0Q29ubmVjdGlvblwiLCBadCA9IHtcbiAgICBCYXRjaEdldERvY3VtZW50czogXCJiYXRjaEdldFwiLFxuICAgIENvbW1pdDogXCJjb21taXRcIixcbiAgICBSdW5RdWVyeTogXCJydW5RdWVyeVwiLFxuICAgIFJ1bkFnZ3JlZ2F0aW9uUXVlcnk6IFwicnVuQWdncmVnYXRpb25RdWVyeVwiXG59O1xuXG4vKipcbiAqIE1hcHMgUlBDIG5hbWVzIHRvIHRoZSBjb3JyZXNwb25kaW5nIFJFU1QgZW5kcG9pbnQgbmFtZS5cbiAqXG4gKiBXZSB1c2UgYXJyYXkgbm90YXRpb24gdG8gYXZvaWQgbWFuZ2xpbmcuXG4gKi9cbi8qKlxuICogQmFzZSBjbGFzcyBmb3IgYWxsIFJlc3QtYmFzZWQgY29ubmVjdGlvbnMgdG8gdGhlIGJhY2tlbmQgKFdlYkNoYW5uZWwgYW5kXG4gKiBIVFRQKS5cbiAqL1xuY2xhc3MgX19QUklWQVRFX1Jlc3RDb25uZWN0aW9uIHtcbiAgICBnZXQgJG8oKSB7XG4gICAgICAgIC8vIEJvdGggYGludm9rZVJQQygpYCBhbmQgYGludm9rZVN0cmVhbWluZ1JQQygpYCB1c2UgdGhlaXIgYHBhdGhgIGFyZ3VtZW50cyB0byBkZXRlcm1pbmVcbiAgICAgICAgLy8gd2hlcmUgdG8gcnVuIHRoZSBxdWVyeSwgYW5kIGV4cGVjdCB0aGUgYHJlcXVlc3RgIHRvIE5PVCBzcGVjaWZ5IHRoZSBcInBhdGhcIi5cbiAgICAgICAgcmV0dXJuICExO1xuICAgIH1cbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHRoaXMuZGF0YWJhc2VJbmZvID0gZSwgdGhpcy5kYXRhYmFzZUlkID0gZS5kYXRhYmFzZUlkO1xuICAgICAgICBjb25zdCB0ID0gZS5zc2wgPyBcImh0dHBzXCIgOiBcImh0dHBcIiwgbiA9IGVuY29kZVVSSUNvbXBvbmVudCh0aGlzLmRhdGFiYXNlSWQucHJvamVjdElkKSwgciA9IGVuY29kZVVSSUNvbXBvbmVudCh0aGlzLmRhdGFiYXNlSWQuZGF0YWJhc2UpO1xuICAgICAgICB0aGlzLlVvID0gdCArIFwiOi8vXCIgKyBlLmhvc3QsIHRoaXMuS28gPSBgcHJvamVjdHMvJHtufS9kYXRhYmFzZXMvJHtyfWAsIHRoaXMuV28gPSB0aGlzLmRhdGFiYXNlSWQuZGF0YWJhc2UgPT09IGx0ID8gYHByb2plY3RfaWQ9JHtufWAgOiBgcHJvamVjdF9pZD0ke259JmRhdGFiYXNlX2lkPSR7cn1gO1xuICAgIH1cbiAgICBHbyhlLCB0LCBuLCByLCBpKSB7XG4gICAgICAgIGNvbnN0IHMgPSBfX1BSSVZBVEVfZ2VuZXJhdGVVbmlxdWVEZWJ1Z0lkKCksIG8gPSB0aGlzLnpvKGUsIHQudG9VcmlFbmNvZGVkU3RyaW5nKCkpO1xuICAgICAgICBfX1BSSVZBVEVfbG9nRGVidWcoWXQsIGBTZW5kaW5nIFJQQyAnJHtlfScgJHtzfTpgLCBvLCBuKTtcbiAgICAgICAgY29uc3QgXyA9IHtcbiAgICAgICAgICAgIFwiZ29vZ2xlLWNsb3VkLXJlc291cmNlLXByZWZpeFwiOiB0aGlzLktvLFxuICAgICAgICAgICAgXCJ4LWdvb2ctcmVxdWVzdC1wYXJhbXNcIjogdGhpcy5Xb1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmpvKF8sIHIsIGkpO1xuICAgICAgICBjb25zdCB7aG9zdDogYX0gPSBuZXcgVVJMKG8pLCB1ID0gaXNDbG91ZFdvcmtzdGF0aW9uKGEpO1xuICAgICAgICByZXR1cm4gdGhpcy5KbyhlLCBvLCBfLCBuLCB1KS50aGVuKCh0ID0+IChfX1BSSVZBVEVfbG9nRGVidWcoWXQsIGBSZWNlaXZlZCBSUEMgJyR7ZX0nICR7c306IGAsIHQpLCBcbiAgICAgICAgdCkpLCAodCA9PiB7XG4gICAgICAgICAgICB0aHJvdyBfX1BSSVZBVEVfbG9nV2FybihZdCwgYFJQQyAnJHtlfScgJHtzfSBmYWlsZWQgd2l0aCBlcnJvcjogYCwgdCwgXCJ1cmw6IFwiLCBvLCBcInJlcXVlc3Q6XCIsIG4pLCBcbiAgICAgICAgICAgIHQ7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgSG8oZSwgdCwgbiwgciwgaSwgcykge1xuICAgICAgICAvLyBUaGUgUkVTVCBBUEkgYXV0b21hdGljYWxseSBhZ2dyZWdhdGVzIGFsbCBvZiB0aGUgc3RyZWFtZWQgcmVzdWx0cywgc28gd2VcbiAgICAgICAgLy8gY2FuIGp1c3QgdXNlIHRoZSBub3JtYWwgaW52b2tlKCkgbWV0aG9kLlxuICAgICAgICByZXR1cm4gdGhpcy5HbyhlLCB0LCBuLCByLCBpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTW9kaWZpZXMgdGhlIGhlYWRlcnMgZm9yIGEgcmVxdWVzdCwgYWRkaW5nIGFueSBhdXRob3JpemF0aW9uIHRva2VuIGlmXG4gICAgICogcHJlc2VudCBhbmQgYW55IGFkZGl0aW9uYWwgaGVhZGVycyBmb3IgdGhlIHJlcXVlc3QuXG4gICAgICovICAgIGpvKGUsIHQsIG4pIHtcbiAgICAgICAgZVtcIlgtR29vZy1BcGktQ2xpZW50XCJdID0gXG4gICAgICAgIC8vIFNES19WRVJTSU9OIGlzIHVwZGF0ZWQgdG8gZGlmZmVyZW50IHZhbHVlIGF0IHJ1bnRpbWUgZGVwZW5kaW5nIG9uIHRoZSBlbnRyeSBwb2ludCxcbiAgICAgICAgLy8gc28gd2UgbmVlZCB0byBnZXQgaXRzIHZhbHVlIHdoZW4gd2UgbmVlZCBpdCBpbiBhIGZ1bmN0aW9uLlxuICAgICAgICBmdW5jdGlvbiBfX1BSSVZBVEVfZ2V0R29vZ0FwaUNsaWVudFZhbHVlKCkge1xuICAgICAgICAgICAgcmV0dXJuIFwiZ2wtanMvIGZpcmUvXCIgKyB4O1xuICAgICAgICB9KCksIFxuICAgICAgICAvLyBDb250ZW50LVR5cGU6IHRleHQvcGxhaW4gd2lsbCBhdm9pZCBwcmVmbGlnaHQgcmVxdWVzdHMgd2hpY2ggbWlnaHRcbiAgICAgICAgLy8gbWVzcyB3aXRoIENPUlMgYW5kIHJlZGlyZWN0cyBieSBwcm94aWVzLiBJZiB3ZSBhZGQgY3VzdG9tIGhlYWRlcnNcbiAgICAgICAgLy8gd2Ugd2lsbCBuZWVkIHRvIGNoYW5nZSB0aGlzIGNvZGUgdG8gcG90ZW50aWFsbHkgdXNlIHRoZSAkaHR0cE92ZXJ3cml0ZVxuICAgICAgICAvLyBwYXJhbWV0ZXIgc3VwcG9ydGVkIGJ5IEVTRiB0byBhdm9pZCB0cmlnZ2VyaW5nIHByZWZsaWdodCByZXF1ZXN0cy5cbiAgICAgICAgZVtcIkNvbnRlbnQtVHlwZVwiXSA9IFwidGV4dC9wbGFpblwiLCB0aGlzLmRhdGFiYXNlSW5mby5hcHBJZCAmJiAoZVtcIlgtRmlyZWJhc2UtR01QSURcIl0gPSB0aGlzLmRhdGFiYXNlSW5mby5hcHBJZCksIFxuICAgICAgICB0ICYmIHQuaGVhZGVycy5mb3JFYWNoKCgodCwgbikgPT4gZVtuXSA9IHQpKSwgbiAmJiBuLmhlYWRlcnMuZm9yRWFjaCgoKHQsIG4pID0+IGVbbl0gPSB0KSk7XG4gICAgfVxuICAgIHpvKGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IFp0W2VdO1xuICAgICAgICByZXR1cm4gYCR7dGhpcy5Vb30vdjEvJHt0fToke259YDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xvc2VzIGFuZCBjbGVhbnMgdXAgYW55IHJlc291cmNlcyBhc3NvY2lhdGVkIHdpdGggdGhlIGNvbm5lY3Rpb24uIFRoaXNcbiAgICAgKiBpbXBsZW1lbnRhdGlvbiBpcyBhIG5vLW9wIGJlY2F1c2UgdGhlcmUgYXJlIG5vIHJlc291cmNlcyBhc3NvY2lhdGVkXG4gICAgICogd2l0aCB0aGUgUmVzdENvbm5lY3Rpb24gdGhhdCBuZWVkIHRvIGJlIGNsZWFuZWQgdXAuXG4gICAgICovICAgIHRlcm1pbmF0ZSgpIHtcbiAgICAgICAgLy8gTm8tb3BcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFByb3ZpZGVzIGEgc2ltcGxlIGhlbHBlciBjbGFzcyB0aGF0IGltcGxlbWVudHMgdGhlIFN0cmVhbSBpbnRlcmZhY2UgdG9cbiAqIGJyaWRnZSB0byBvdGhlciBpbXBsZW1lbnRhdGlvbnMgdGhhdCBhcmUgc3RyZWFtcyBidXQgZG8gbm90IGltcGxlbWVudCB0aGVcbiAqIGludGVyZmFjZS4gVGhlIHN0cmVhbSBjYWxsYmFja3MgYXJlIGludm9rZWQgd2l0aCB0aGUgY2FsbE9uLi4uIG1ldGhvZHMuXG4gKi8gY2xhc3MgX19QUklWQVRFX1N0cmVhbUJyaWRnZSB7XG4gICAgY29uc3RydWN0b3IoZSkge1xuICAgICAgICB0aGlzLllvID0gZS5ZbywgdGhpcy5abyA9IGUuWm87XG4gICAgfVxuICAgIFhvKGUpIHtcbiAgICAgICAgdGhpcy5lXyA9IGU7XG4gICAgfVxuICAgIHRfKGUpIHtcbiAgICAgICAgdGhpcy5uXyA9IGU7XG4gICAgfVxuICAgIHJfKGUpIHtcbiAgICAgICAgdGhpcy5pXyA9IGU7XG4gICAgfVxuICAgIG9uTWVzc2FnZShlKSB7XG4gICAgICAgIHRoaXMuc18gPSBlO1xuICAgIH1cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5abygpO1xuICAgIH1cbiAgICBzZW5kKGUpIHtcbiAgICAgICAgdGhpcy5ZbyhlKTtcbiAgICB9XG4gICAgb18oKSB7XG4gICAgICAgIHRoaXMuZV8oKTtcbiAgICB9XG4gICAgX18oKSB7XG4gICAgICAgIHRoaXMubl8oKTtcbiAgICB9XG4gICAgYV8oZSkge1xuICAgICAgICB0aGlzLmlfKGUpO1xuICAgIH1cbiAgICB1XyhlKSB7XG4gICAgICAgIHRoaXMuc18oZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCBYdCA9IFwiV2ViQ2hhbm5lbENvbm5lY3Rpb25cIjtcblxuY2xhc3MgX19QUklWQVRFX1dlYkNoYW5uZWxDb25uZWN0aW9uIGV4dGVuZHMgX19QUklWQVRFX1Jlc3RDb25uZWN0aW9uIHtcbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHN1cGVyKGUpLCBcbiAgICAgICAgLyoqIEEgY29sbGVjdGlvbiBvZiBvcGVuIFdlYkNoYW5uZWwgaW5zdGFuY2VzICovXG4gICAgICAgIHRoaXMuY18gPSBbXSwgdGhpcy5mb3JjZUxvbmdQb2xsaW5nID0gZS5mb3JjZUxvbmdQb2xsaW5nLCB0aGlzLmF1dG9EZXRlY3RMb25nUG9sbGluZyA9IGUuYXV0b0RldGVjdExvbmdQb2xsaW5nLCBcbiAgICAgICAgdGhpcy51c2VGZXRjaFN0cmVhbXMgPSBlLnVzZUZldGNoU3RyZWFtcywgdGhpcy5sb25nUG9sbGluZ09wdGlvbnMgPSBlLmxvbmdQb2xsaW5nT3B0aW9ucztcbiAgICB9XG4gICAgSm8oZSwgdCwgbiwgciwgaSkge1xuICAgICAgICBjb25zdCBzID0gX19QUklWQVRFX2dlbmVyYXRlVW5pcXVlRGVidWdJZCgpO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKChpLCBvKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBfID0gbmV3IFhocklvO1xuICAgICAgICAgICAgXy5zZXRXaXRoQ3JlZGVudGlhbHMoITApLCBfLmxpc3Rlbk9uY2UoRXZlbnRUeXBlLkNPTVBMRVRFLCAoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoXy5nZXRMYXN0RXJyb3JDb2RlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICBjYXNlIEVycm9yQ29kZS5OT19FUlJPUjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBfLmdldFJlc3BvbnNlSnNvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX19QUklWQVRFX2xvZ0RlYnVnKFh0LCBgWEhSIGZvciBSUEMgJyR7ZX0nICR7c30gcmVjZWl2ZWQ6YCwgSlNPTi5zdHJpbmdpZnkodCkpLCBcbiAgICAgICAgICAgICAgICAgICAgICAgIGkodCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgRXJyb3JDb2RlLlRJTUVPVVQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBfX1BSSVZBVEVfbG9nRGVidWcoWHQsIGBSUEMgJyR7ZX0nICR7c30gdGltZWQgb3V0YCksIG8obmV3IEZpcmVzdG9yZUVycm9yKE4uREVBRExJTkVfRVhDRUVERUQsIFwiUmVxdWVzdCB0aW1lIG91dFwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgRXJyb3JDb2RlLkhUVFBfRVJST1I6XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gXy5nZXRTdGF0dXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfX1BSSVZBVEVfbG9nRGVidWcoWHQsIGBSUEMgJyR7ZX0nICR7c30gZmFpbGVkIHdpdGggc3RhdHVzOmAsIG4sIFwicmVzcG9uc2UgdGV4dDpcIiwgXy5nZXRSZXNwb25zZVRleHQoKSksIFxuICAgICAgICAgICAgICAgICAgICAgICAgbiA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZSA9IF8uZ2V0UmVzcG9uc2VKc29uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQXJyYXkuaXNBcnJheShlKSAmJiAoZSA9IGVbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlPy5lcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiB0LnN0YXR1cyAmJiB0Lm1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IGZ1bmN0aW9uIF9fUFJJVkFURV9tYXBDb2RlRnJvbUh0dHBSZXNwb25zZUVycm9yU3RhdHVzKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXy9nLCBcIi1cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhOKS5pbmRleE9mKHQpID49IDAgPyB0IDogTi5VTktOT1dOO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KHQuc3RhdHVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbyhuZXcgRmlyZXN0b3JlRXJyb3IoZSwgdC5tZXNzYWdlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIG8obmV3IEZpcmVzdG9yZUVycm9yKE4uVU5LTk9XTiwgXCJTZXJ2ZXIgcmVzcG9uZGVkIHdpdGggc3RhdHVzIFwiICsgXy5nZXRTdGF0dXMoKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgd2UgcmVjZWl2ZWQgYW4gSFRUUF9FUlJPUiBidXQgdGhlcmUncyBubyBzdGF0dXMgY29kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGl0J3MgbW9zdCBwcm9iYWJseSBhIGNvbm5lY3Rpb24gaXNzdWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG8obmV3IEZpcmVzdG9yZUVycm9yKE4uVU5BVkFJTEFCTEUsIFwiQ29ubmVjdGlvbiBmYWlsZWQuXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhaWwoOTA1NSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxfOiBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmVhbUlkOiBzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhfOiBfLmdldExhc3RFcnJvckNvZGUoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQXzogXy5nZXRMYXN0RXJyb3IoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICBfX1BSSVZBVEVfbG9nRGVidWcoWHQsIGBSUEMgJyR7ZX0nICR7c30gY29tcGxldGVkLmApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIGNvbnN0IGEgPSBKU09OLnN0cmluZ2lmeShyKTtcbiAgICAgICAgICAgIF9fUFJJVkFURV9sb2dEZWJ1ZyhYdCwgYFJQQyAnJHtlfScgJHtzfSBzZW5kaW5nIHJlcXVlc3Q6YCwgciksIF8uc2VuZCh0LCBcIlBPU1RcIiwgYSwgbiwgMTUpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIFRfKGUsIHQsIG4pIHtcbiAgICAgICAgY29uc3QgciA9IF9fUFJJVkFURV9nZW5lcmF0ZVVuaXF1ZURlYnVnSWQoKSwgaSA9IFsgdGhpcy5VbywgXCIvXCIsIFwiZ29vZ2xlLmZpcmVzdG9yZS52MS5GaXJlc3RvcmVcIiwgXCIvXCIsIGUsIFwiL2NoYW5uZWxcIiBdLCBzID0gY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydCgpLCBvID0gZ2V0U3RhdEV2ZW50VGFyZ2V0KCksIF8gPSB7XG4gICAgICAgICAgICAvLyBSZXF1aXJlZCBmb3IgYmFja2VuZCBzdGlja2luZXNzLCByb3V0aW5nIGJlaGF2aW9yIGlzIGJhc2VkIG9uIHRoaXNcbiAgICAgICAgICAgIC8vIHBhcmFtZXRlci5cbiAgICAgICAgICAgIGh0dHBTZXNzaW9uSWRQYXJhbTogXCJnc2Vzc2lvbmlkXCIsXG4gICAgICAgICAgICBpbml0TWVzc2FnZUhlYWRlcnM6IHt9LFxuICAgICAgICAgICAgbWVzc2FnZVVybFBhcmFtczoge1xuICAgICAgICAgICAgICAgIC8vIFRoaXMgcGFyYW0gaXMgdXNlZCB0byBpbXByb3ZlIHJvdXRpbmcgYW5kIHByb2plY3QgaXNvbGF0aW9uIGJ5IHRoZVxuICAgICAgICAgICAgICAgIC8vIGJhY2tlbmQgYW5kIG11c3QgYmUgaW5jbHVkZWQgaW4gZXZlcnkgcmVxdWVzdC5cbiAgICAgICAgICAgICAgICBkYXRhYmFzZTogYHByb2plY3RzLyR7dGhpcy5kYXRhYmFzZUlkLnByb2plY3RJZH0vZGF0YWJhc2VzLyR7dGhpcy5kYXRhYmFzZUlkLmRhdGFiYXNlfWBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZW5kUmF3SnNvbjogITAsXG4gICAgICAgICAgICBzdXBwb3J0c0Nyb3NzRG9tYWluWGhyOiAhMCxcbiAgICAgICAgICAgIGludGVybmFsQ2hhbm5lbFBhcmFtczoge1xuICAgICAgICAgICAgICAgIC8vIE92ZXJyaWRlIHRoZSBkZWZhdWx0IHRpbWVvdXQgKHJhbmRvbWl6ZWQgYmV0d2VlbiAxMC0yMCBzZWNvbmRzKSBzaW5jZVxuICAgICAgICAgICAgICAgIC8vIGEgbGFyZ2Ugd3JpdGUgYmF0Y2ggb24gYSBzbG93IGludGVybmV0IGNvbm5lY3Rpb24gbWF5IHRha2UgYSBsb25nXG4gICAgICAgICAgICAgICAgLy8gdGltZSB0byBzZW5kIHRvIHRoZSBiYWNrZW5kLiBSYXRoZXIgdGhhbiBoYXZlIFdlYkNoYW5uZWwgaW1wb3NlIGFcbiAgICAgICAgICAgICAgICAvLyB0aWdodCB0aW1lb3V0IHdoaWNoIGNvdWxkIGxlYWQgdG8gaW5maW5pdGUgdGltZW91dHMgYW5kIHJldHJpZXMsIHdlXG4gICAgICAgICAgICAgICAgLy8gc2V0IGl0IHZlcnkgbGFyZ2UgKDUtMTAgbWludXRlcykgYW5kIHJlbHkgb24gdGhlIGJyb3dzZXIncyBidWlsdGluXG4gICAgICAgICAgICAgICAgLy8gdGltZW91dHMgdG8ga2ljayBpbiBpZiB0aGUgcmVxdWVzdCBpc24ndCB3b3JraW5nLlxuICAgICAgICAgICAgICAgIGZvcndhcmRDaGFubmVsUmVxdWVzdFRpbWVvdXRNczogNmU1XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZm9yY2VMb25nUG9sbGluZzogdGhpcy5mb3JjZUxvbmdQb2xsaW5nLFxuICAgICAgICAgICAgZGV0ZWN0QnVmZmVyaW5nUHJveHk6IHRoaXMuYXV0b0RldGVjdExvbmdQb2xsaW5nXG4gICAgICAgIH0sIGEgPSB0aGlzLmxvbmdQb2xsaW5nT3B0aW9ucy50aW1lb3V0U2Vjb25kcztcbiAgICAgICAgdm9pZCAwICE9PSBhICYmIChfLmxvbmdQb2xsaW5nVGltZW91dCA9IE1hdGgucm91bmQoMWUzICogYSkpLCB0aGlzLnVzZUZldGNoU3RyZWFtcyAmJiAoXy51c2VGZXRjaFN0cmVhbXMgPSAhMCksIFxuICAgICAgICB0aGlzLmpvKF8uaW5pdE1lc3NhZ2VIZWFkZXJzLCB0LCBuKSwgXG4gICAgICAgIC8vIFNlbmRpbmcgdGhlIGN1c3RvbSBoZWFkZXJzIHdlIGp1c3QgYWRkZWQgdG8gcmVxdWVzdC5pbml0TWVzc2FnZUhlYWRlcnNcbiAgICAgICAgLy8gKEF1dGhvcml6YXRpb24sIGV0Yy4pIHdpbGwgdHJpZ2dlciB0aGUgYnJvd3NlciB0byBtYWtlIGEgQ09SUyBwcmVmbGlnaHRcbiAgICAgICAgLy8gcmVxdWVzdCBiZWNhdXNlIHRoZSBYSFIgd2lsbCBubyBsb25nZXIgbWVldCB0aGUgY3JpdGVyaWEgZm9yIGEgXCJzaW1wbGVcIlxuICAgICAgICAvLyBDT1JTIHJlcXVlc3Q6XG4gICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0hUVFAvQ09SUyNTaW1wbGVfcmVxdWVzdHNcbiAgICAgICAgLy8gVGhlcmVmb3JlIHRvIGF2b2lkIHRoZSBDT1JTIHByZWZsaWdodCByZXF1ZXN0IChhbiBleHRyYSBuZXR3b3JrXG4gICAgICAgIC8vIHJvdW5kdHJpcCksIHdlIHVzZSB0aGUgZW5jb2RlSW5pdE1lc3NhZ2VIZWFkZXJzIG9wdGlvbiB0byBzcGVjaWZ5IHRoYXRcbiAgICAgICAgLy8gdGhlIGhlYWRlcnMgc2hvdWxkIGluc3RlYWQgYmUgZW5jb2RlZCBpbiB0aGUgcmVxdWVzdCdzIFBPU1QgcGF5bG9hZCxcbiAgICAgICAgLy8gd2hpY2ggaXMgcmVjb2duaXplZCBieSB0aGUgd2ViY2hhbm5lbCBiYWNrZW5kLlxuICAgICAgICBfLmVuY29kZUluaXRNZXNzYWdlSGVhZGVycyA9ICEwO1xuICAgICAgICBjb25zdCB1ID0gaS5qb2luKFwiXCIpO1xuICAgICAgICBfX1BSSVZBVEVfbG9nRGVidWcoWHQsIGBDcmVhdGluZyBSUEMgJyR7ZX0nIHN0cmVhbSAke3J9OiAke3V9YCwgXyk7XG4gICAgICAgIGNvbnN0IGMgPSBzLmNyZWF0ZVdlYkNoYW5uZWwodSwgXyk7XG4gICAgICAgIHRoaXMuSV8oYyk7XG4gICAgICAgIC8vIFdlYkNoYW5uZWwgc3VwcG9ydHMgc2VuZGluZyB0aGUgZmlyc3QgbWVzc2FnZSB3aXRoIHRoZSBoYW5kc2hha2UgLSBzYXZpbmdcbiAgICAgICAgLy8gYSBuZXR3b3JrIHJvdW5kIHRyaXAuIEhvd2V2ZXIsIGl0IHdpbGwgaGF2ZSB0byBjYWxsIHNlbmQgaW4gdGhlIHNhbWVcbiAgICAgICAgLy8gSlMgZXZlbnQgbG9vcCBhcyBvcGVuLiBJbiBvcmRlciB0byBlbmZvcmNlIHRoaXMsIHdlIGRlbGF5IGFjdHVhbGx5XG4gICAgICAgIC8vIG9wZW5pbmcgdGhlIFdlYkNoYW5uZWwgdW50aWwgc2VuZCBpcyBjYWxsZWQuIFdoZXRoZXIgd2UgaGF2ZSBjYWxsZWRcbiAgICAgICAgLy8gb3BlbiBpcyB0cmFja2VkIHdpdGggdGhpcyB2YXJpYWJsZS5cbiAgICAgICAgbGV0IGwgPSAhMSwgaCA9ICExO1xuICAgICAgICAvLyBBIGZsYWcgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIHN0cmVhbSB3YXMgY2xvc2VkIChieSB1cyBvciB0aHJvdWdoIGFuXG4gICAgICAgIC8vIGVycm9yL2Nsb3NlIGV2ZW50KSB0byBhdm9pZCBkZWxpdmVyaW5nIG11bHRpcGxlIGNsb3NlIGV2ZW50cyBvciBzZW5kaW5nXG4gICAgICAgIC8vIG9uIGEgY2xvc2VkIHN0cmVhbVxuICAgICAgICAgICAgICAgIGNvbnN0IFAgPSBuZXcgX19QUklWQVRFX1N0cmVhbUJyaWRnZSh7XG4gICAgICAgICAgICBZbzogdCA9PiB7XG4gICAgICAgICAgICAgICAgaCA/IF9fUFJJVkFURV9sb2dEZWJ1ZyhYdCwgYE5vdCBzZW5kaW5nIGJlY2F1c2UgUlBDICcke2V9JyBzdHJlYW0gJHtyfSBpcyBjbG9zZWQ6YCwgdCkgOiAobCB8fCAoX19QUklWQVRFX2xvZ0RlYnVnKFh0LCBgT3BlbmluZyBSUEMgJyR7ZX0nIHN0cmVhbSAke3J9IHRyYW5zcG9ydC5gKSwgXG4gICAgICAgICAgICAgICAgYy5vcGVuKCksIGwgPSAhMCksIF9fUFJJVkFURV9sb2dEZWJ1ZyhYdCwgYFJQQyAnJHtlfScgc3RyZWFtICR7cn0gc2VuZGluZzpgLCB0KSwgXG4gICAgICAgICAgICAgICAgYy5zZW5kKHQpKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBabzogKCkgPT4gYy5jbG9zZSgpXG4gICAgICAgIH0pLCBfX1BSSVZBVEVfdW5ndWFyZGVkRXZlbnRMaXN0ZW4gPSAoZSwgdCwgbikgPT4ge1xuICAgICAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiBjbG9zdXJlIHR5cGluZyBzZWVtcyBicm9rZW4gYmVjYXVzZSBXZWJDaGFubmVsIGRvZXNcbiAgICAgICAgICAgIC8vIG5vdCBpbXBsZW1lbnQgZ29vZy5ldmVudHMuTGlzdGVuYWJsZVxuICAgICAgICAgICAgZS5saXN0ZW4odCwgKGUgPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIG4oZSk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICAgICAgICAgICAgICB9KSwgMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9O1xuICAgICAgICAvLyBDbG9zdXJlIGV2ZW50cyBhcmUgZ3VhcmRlZCBhbmQgZXhjZXB0aW9ucyBhcmUgc3dhbGxvd2VkLCBzbyBjYXRjaCBhbnlcbiAgICAgICAgLy8gZXhjZXB0aW9uIGFuZCByZXRocm93IHVzaW5nIGEgc2V0VGltZW91dCBzbyB0aGV5IGJlY29tZSB2aXNpYmxlIGFnYWluLlxuICAgICAgICAvLyBOb3RlIHRoYXQgZXZlbnR1YWxseSB0aGlzIGZ1bmN0aW9uIGNvdWxkIGdvIGF3YXkgaWYgd2UgYXJlIGNvbmZpZGVudFxuICAgICAgICAvLyBlbm91Z2ggdGhlIGNvZGUgaXMgZXhjZXB0aW9uIGZyZWUuXG4gICAgICAgICAgICAgICAgcmV0dXJuIF9fUFJJVkFURV91bmd1YXJkZWRFdmVudExpc3RlbihjLCBXZWJDaGFubmVsLkV2ZW50VHlwZS5PUEVOLCAoKCkgPT4ge1xuICAgICAgICAgICAgaCB8fCAoX19QUklWQVRFX2xvZ0RlYnVnKFh0LCBgUlBDICcke2V9JyBzdHJlYW0gJHtyfSB0cmFuc3BvcnQgb3BlbmVkLmApLCBQLm9fKCkpO1xuICAgICAgICB9KSksIF9fUFJJVkFURV91bmd1YXJkZWRFdmVudExpc3RlbihjLCBXZWJDaGFubmVsLkV2ZW50VHlwZS5DTE9TRSwgKCgpID0+IHtcbiAgICAgICAgICAgIGggfHwgKGggPSAhMCwgX19QUklWQVRFX2xvZ0RlYnVnKFh0LCBgUlBDICcke2V9JyBzdHJlYW0gJHtyfSB0cmFuc3BvcnQgY2xvc2VkYCksIFxuICAgICAgICAgICAgUC5hXygpLCB0aGlzLkVfKGMpKTtcbiAgICAgICAgfSkpLCBfX1BSSVZBVEVfdW5ndWFyZGVkRXZlbnRMaXN0ZW4oYywgV2ViQ2hhbm5lbC5FdmVudFR5cGUuRVJST1IsICh0ID0+IHtcbiAgICAgICAgICAgIGggfHwgKGggPSAhMCwgX19QUklWQVRFX2xvZ1dhcm4oWHQsIGBSUEMgJyR7ZX0nIHN0cmVhbSAke3J9IHRyYW5zcG9ydCBlcnJvcmVkLiBOYW1lOmAsIHQubmFtZSwgXCJNZXNzYWdlOlwiLCB0Lm1lc3NhZ2UpLCBcbiAgICAgICAgICAgIFAuYV8obmV3IEZpcmVzdG9yZUVycm9yKE4uVU5BVkFJTEFCTEUsIFwiVGhlIG9wZXJhdGlvbiBjb3VsZCBub3QgYmUgY29tcGxldGVkXCIpKSk7XG4gICAgICAgIH0pKSwgX19QUklWQVRFX3VuZ3VhcmRlZEV2ZW50TGlzdGVuKGMsIFdlYkNoYW5uZWwuRXZlbnRUeXBlLk1FU1NBR0UsICh0ID0+IHtcbiAgICAgICAgICAgIGlmICghaCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmRhdGFbMF07XG4gICAgICAgICAgICAgICAgX19QUklWQVRFX2hhcmRBc3NlcnQoISFuLCAxNjM0OSk7XG4gICAgICAgICAgICAgICAgLy8gVE9ETyhiLzM1MTQzODkxKTogVGhlcmUgaXMgYSBidWcgaW4gT25lIFBsYXRmb3JtIHRoYXQgY2F1c2VkIGVycm9yc1xuICAgICAgICAgICAgICAgIC8vIChhbmQgb25seSBlcnJvcnMpIHRvIGJlIHdyYXBwZWQgaW4gYW4gZXh0cmEgYXJyYXkuIFRvIGJlIGZvcndhcmRcbiAgICAgICAgICAgICAgICAvLyBjb21wYXRpYmxlIHdpdGggdGhlIGJ1ZyB3ZSBuZWVkIHRvIGNoZWNrIGVpdGhlciBjb25kaXRpb24uIFRoZSBsYXR0ZXJcbiAgICAgICAgICAgICAgICAvLyBjYW4gYmUgcmVtb3ZlZCBvbmNlIHRoZSBmaXggaGFzIGJlZW4gcm9sbGVkIG91dC5cbiAgICAgICAgICAgICAgICAvLyBVc2UgYW55IGJlY2F1c2UgbXNnRGF0YS5lcnJvciBpcyBub3QgdHlwZWQuXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IG4sIHMgPSBpPy5lcnJvciB8fCBpWzBdPy5lcnJvcjtcbiAgICAgICAgICAgICAgICBpZiAocykge1xuICAgICAgICAgICAgICAgICAgICBfX1BSSVZBVEVfbG9nRGVidWcoWHQsIGBSUEMgJyR7ZX0nIHN0cmVhbSAke3J9IHJlY2VpdmVkIGVycm9yOmAsIHMpO1xuICAgICAgICAgICAgICAgICAgICAvLyBlcnJvci5zdGF0dXMgd2lsbCBiZSBhIHN0cmluZyBsaWtlICdPSycgb3IgJ05PVF9GT1VORCcuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBzLnN0YXR1cztcbiAgICAgICAgICAgICAgICAgICAgbGV0IG4gPSBcbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gKiBNYXBzIGFuIGVycm9yIENvZGUgZnJvbSBhIEdSUEMgc3RhdHVzIGlkZW50aWZpZXIgbGlrZSAnTk9UX0ZPVU5EJy5cbiAqXG4gKiBAcmV0dXJucyBUaGUgQ29kZSBlcXVpdmFsZW50IHRvIHRoZSBnaXZlbiBzdGF0dXMgc3RyaW5nIG9yIHVuZGVmaW5lZCBpZlxuICogICAgIHRoZXJlIGlzIG5vIG1hdGNoLlxuICovXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIF9fUFJJVkFURV9tYXBDb2RlRnJvbVJwY1N0YXR1cyhlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBsb29rdXAgYnkgc3RyaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHB0W2VdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZvaWQgMCAhPT0gdCkgcmV0dXJuIF9fUFJJVkFURV9tYXBDb2RlRnJvbVJwY0NvZGUodCk7XG4gICAgICAgICAgICAgICAgICAgIH0odCksIGkgPSBzLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgICAgIHZvaWQgMCA9PT0gbiAmJiAobiA9IE4uSU5URVJOQUwsIGkgPSBcIlVua25vd24gZXJyb3Igc3RhdHVzOiBcIiArIHQgKyBcIiB3aXRoIG1lc3NhZ2UgXCIgKyBzLm1lc3NhZ2UpLCBcbiAgICAgICAgICAgICAgICAgICAgLy8gTWFyayBjbG9zZWQgc28gbm8gZnVydGhlciBldmVudHMgYXJlIHByb3BhZ2F0ZWRcbiAgICAgICAgICAgICAgICAgICAgaCA9ICEwLCBQLmFfKG5ldyBGaXJlc3RvcmVFcnJvcihuLCBpKSksIGMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgX19QUklWQVRFX2xvZ0RlYnVnKFh0LCBgUlBDICcke2V9JyBzdHJlYW0gJHtyfSByZWNlaXZlZDpgLCBuKSwgUC51XyhuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpLCBfX1BSSVZBVEVfdW5ndWFyZGVkRXZlbnRMaXN0ZW4obywgRXZlbnQuU1RBVF9FVkVOVCwgKHQgPT4ge1xuICAgICAgICAgICAgdC5zdGF0ID09PSBTdGF0LlBST1hZID8gX19QUklWQVRFX2xvZ0RlYnVnKFh0LCBgUlBDICcke2V9JyBzdHJlYW0gJHtyfSBkZXRlY3RlZCBidWZmZXJpbmcgcHJveHlgKSA6IHQuc3RhdCA9PT0gU3RhdC5OT1BST1hZICYmIF9fUFJJVkFURV9sb2dEZWJ1ZyhYdCwgYFJQQyAnJHtlfScgc3RyZWFtICR7cn0gZGV0ZWN0ZWQgbm8gYnVmZmVyaW5nIHByb3h5YCk7XG4gICAgICAgIH0pKSwgc2V0VGltZW91dCgoKCkgPT4ge1xuICAgICAgICAgICAgLy8gVGVjaG5pY2FsbHkgd2UgY291bGQvc2hvdWxkIHdhaXQgZm9yIHRoZSBXZWJDaGFubmVsIG9wZW5lZCBldmVudCxcbiAgICAgICAgICAgIC8vIGJ1dCBiZWNhdXNlIHdlIHdhbnQgdG8gc2VuZCB0aGUgZmlyc3QgbWVzc2FnZSB3aXRoIHRoZSBXZWJDaGFubmVsXG4gICAgICAgICAgICAvLyBoYW5kc2hha2Ugd2UgcHJldGVuZCB0aGUgY2hhbm5lbCBvcGVuZWQgaGVyZSAoYXN5bmNocm9ub3VzbHkpLCBhbmRcbiAgICAgICAgICAgIC8vIHRoZW4gZGVsYXkgdGhlIGFjdHVhbCBvcGVuIHVudGlsIHRoZSBmaXJzdCBtZXNzYWdlIGlzIHNlbnQuXG4gICAgICAgICAgICBQLl9fKCk7XG4gICAgICAgIH0pLCAwKSwgUDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xvc2VzIGFuZCBjbGVhbnMgdXAgYW55IHJlc291cmNlcyBhc3NvY2lhdGVkIHdpdGggdGhlIGNvbm5lY3Rpb24uXG4gICAgICovICAgIHRlcm1pbmF0ZSgpIHtcbiAgICAgICAgLy8gSWYgdGhlIEZpcmVzdG9yZSBpbnN0YW5jZSBpcyB0ZXJtaW5hdGVkLCB3ZSB3aWxsIGV4cGxpY2l0bHlcbiAgICAgICAgLy8gY2xvc2UgYW55IHJlbWFpbmluZyBvcGVuIFdlYkNoYW5uZWwgaW5zdGFuY2VzLlxuICAgICAgICB0aGlzLmNfLmZvckVhY2goKGUgPT4gZS5jbG9zZSgpKSksIHRoaXMuY18gPSBbXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkIGEgV2ViQ2hhbm5lbCBpbnN0YW5jZSB0byB0aGUgY29sbGVjdGlvbiBvZiBvcGVuIGluc3RhbmNlcy5cbiAgICAgKiBAcGFyYW0gd2ViQ2hhbm5lbFxuICAgICAqLyAgICBJXyhlKSB7XG4gICAgICAgIHRoaXMuY18ucHVzaChlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGEgV2ViQ2hhbm5lbCBpbnN0YW5jZSBmcm9tIHRoZSBjb2xsZWN0aW9uIG9mIG9wZW4gaW5zdGFuY2VzLlxuICAgICAqIEBwYXJhbSB3ZWJDaGFubmVsXG4gICAgICovICAgIEVfKGUpIHtcbiAgICAgICAgdGhpcy5jXyA9IHRoaXMuY18uZmlsdGVyKCh0ID0+IHQgPT09IGUpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogSW5pdGlhbGl6ZXMgdGhlIFdlYkNoYW5uZWxDb25uZWN0aW9uIGZvciB0aGUgYnJvd3Nlci4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogVGhlIFBsYXRmb3JtJ3MgJ3dpbmRvdycgaW1wbGVtZW50YXRpb24gb3IgbnVsbCBpZiBub3QgYXZhaWxhYmxlLiAqL1xuZnVuY3Rpb24gX19QUklWQVRFX2dldFdpbmRvdygpIHtcbiAgICAvLyBgd2luZG93YCBpcyBub3QgYWx3YXlzIGF2YWlsYWJsZSwgZS5nLiBpbiBSZWFjdE5hdGl2ZSBhbmQgV2ViV29ya2Vycy5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzXG4gICAgcmV0dXJuIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIHdpbmRvdyA/IHdpbmRvdyA6IG51bGw7XG59XG5cbi8qKiBUaGUgUGxhdGZvcm0ncyAnZG9jdW1lbnQnIGltcGxlbWVudGF0aW9uIG9yIG51bGwgaWYgbm90IGF2YWlsYWJsZS4gKi8gZnVuY3Rpb24gZ2V0RG9jdW1lbnQoKSB7XG4gICAgLy8gYGRvY3VtZW50YCBpcyBub3QgYWx3YXlzIGF2YWlsYWJsZSwgZS5nLiBpbiBSZWFjdE5hdGl2ZSBhbmQgV2ViV29ya2Vycy5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzXG4gICAgcmV0dXJuIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGRvY3VtZW50ID8gZG9jdW1lbnQgOiBudWxsO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfbmV3U2VyaWFsaXplcihlKSB7XG4gICAgcmV0dXJuIG5ldyBKc29uUHJvdG9TZXJpYWxpemVyKGUsIC8qIHVzZVByb3RvM0pzb249ICovICEwKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBoZWxwZXIgZm9yIHJ1bm5pbmcgZGVsYXllZCB0YXNrcyBmb2xsb3dpbmcgYW4gZXhwb25lbnRpYWwgYmFja29mZiBjdXJ2ZVxuICogYmV0d2VlbiBhdHRlbXB0cy5cbiAqXG4gKiBFYWNoIGRlbGF5IGlzIG1hZGUgdXAgb2YgYSBcImJhc2VcIiBkZWxheSB3aGljaCBmb2xsb3dzIHRoZSBleHBvbmVudGlhbFxuICogYmFja29mZiBjdXJ2ZSwgYW5kIGEgKy8tIDUwJSBcImppdHRlclwiIHRoYXQgaXMgY2FsY3VsYXRlZCBhbmQgYWRkZWQgdG8gdGhlXG4gKiBiYXNlIGRlbGF5LiBUaGlzIHByZXZlbnRzIGNsaWVudHMgZnJvbSBhY2NpZGVudGFsbHkgc3luY2hyb25pemluZyB0aGVpclxuICogZGVsYXlzIGNhdXNpbmcgc3Bpa2VzIG9mIGxvYWQgdG8gdGhlIGJhY2tlbmQuXG4gKi9cbmNsYXNzIF9fUFJJVkFURV9FeHBvbmVudGlhbEJhY2tvZmYge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBBc3luY1F1ZXVlIHRvIHJ1biBiYWNrb2ZmIG9wZXJhdGlvbnMgb24uXG4gICAgICovXG4gICAgZSwgXG4gICAgLyoqXG4gICAgICogVGhlIElEIHRvIHVzZSB3aGVuIHNjaGVkdWxpbmcgYmFja29mZiBvcGVyYXRpb25zIG9uIHRoZSBBc3luY1F1ZXVlLlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSBpbml0aWFsIGRlbGF5ICh1c2VkIGFzIHRoZSBiYXNlIGRlbGF5IG9uIHRoZSBmaXJzdCByZXRyeSBhdHRlbXB0KS5cbiAgICAgKiBOb3RlIHRoYXQgaml0dGVyIHdpbGwgc3RpbGwgYmUgYXBwbGllZCwgc28gdGhlIGFjdHVhbCBkZWxheSBjb3VsZCBiZSBhc1xuICAgICAqIGxpdHRsZSBhcyAwLjUqaW5pdGlhbERlbGF5TXMuXG4gICAgICovXG4gICAgbiA9IDFlM1xuICAgIC8qKlxuICAgICAqIFRoZSBtdWx0aXBsaWVyIHRvIHVzZSB0byBkZXRlcm1pbmUgdGhlIGV4dGVuZGVkIGJhc2UgZGVsYXkgYWZ0ZXIgZWFjaFxuICAgICAqIGF0dGVtcHQuXG4gICAgICovICwgciA9IDEuNVxuICAgIC8qKlxuICAgICAqIFRoZSBtYXhpbXVtIGJhc2UgZGVsYXkgYWZ0ZXIgd2hpY2ggbm8gZnVydGhlciBiYWNrb2ZmIGlzIHBlcmZvcm1lZC5cbiAgICAgKiBOb3RlIHRoYXQgaml0dGVyIHdpbGwgc3RpbGwgYmUgYXBwbGllZCwgc28gdGhlIGFjdHVhbCBkZWxheSBjb3VsZCBiZSBhc1xuICAgICAqIG11Y2ggYXMgMS41Km1heERlbGF5TXMuXG4gICAgICovICwgaSA9IDZlNCkge1xuICAgICAgICB0aGlzLk1pID0gZSwgdGhpcy50aW1lcklkID0gdCwgdGhpcy5kXyA9IG4sIHRoaXMuQV8gPSByLCB0aGlzLlJfID0gaSwgdGhpcy5WXyA9IDAsIFxuICAgICAgICB0aGlzLm1fID0gbnVsbCwgXG4gICAgICAgIC8qKiBUaGUgbGFzdCBiYWNrb2ZmIGF0dGVtcHQsIGFzIGVwb2NoIG1pbGxpc2Vjb25kcy4gKi9cbiAgICAgICAgdGhpcy5mXyA9IERhdGUubm93KCksIHRoaXMucmVzZXQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSBiYWNrb2ZmIGRlbGF5LlxuICAgICAqXG4gICAgICogVGhlIHZlcnkgbmV4dCBiYWNrb2ZmQW5kV2FpdCgpIHdpbGwgaGF2ZSBubyBkZWxheS4gSWYgaXQgaXMgY2FsbGVkIGFnYWluXG4gICAgICogKGkuZS4gZHVlIHRvIGFuIGVycm9yKSwgaW5pdGlhbERlbGF5TXMgKHBsdXMgaml0dGVyKSB3aWxsIGJlIHVzZWQsIGFuZFxuICAgICAqIHN1YnNlcXVlbnQgb25lcyB3aWxsIGluY3JlYXNlIGFjY29yZGluZyB0byB0aGUgYmFja29mZkZhY3Rvci5cbiAgICAgKi8gICAgcmVzZXQoKSB7XG4gICAgICAgIHRoaXMuVl8gPSAwO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXNldHMgdGhlIGJhY2tvZmYgZGVsYXkgdG8gdGhlIG1heGltdW0gZGVsYXkgKGUuZy4gZm9yIHVzZSBhZnRlciBhXG4gICAgICogUkVTT1VSQ0VfRVhIQVVTVEVEIGVycm9yKS5cbiAgICAgKi8gICAgZ18oKSB7XG4gICAgICAgIHRoaXMuVl8gPSB0aGlzLlJfO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIGFmdGVyIGN1cnJlbnREZWxheU1zLCBhbmQgaW5jcmVhc2VzIHRoZVxuICAgICAqIGRlbGF5IGZvciBhbnkgc3Vic2VxdWVudCBhdHRlbXB0cy4gSWYgdGhlcmUgd2FzIGEgcGVuZGluZyBiYWNrb2ZmIG9wZXJhdGlvblxuICAgICAqIGFscmVhZHksIGl0IHdpbGwgYmUgY2FuY2VsZWQuXG4gICAgICovICAgIHBfKGUpIHtcbiAgICAgICAgLy8gQ2FuY2VsIGFueSBwZW5kaW5nIGJhY2tvZmYgb3BlcmF0aW9uLlxuICAgICAgICB0aGlzLmNhbmNlbCgpO1xuICAgICAgICAvLyBGaXJzdCBzY2hlZHVsZSB1c2luZyB0aGUgY3VycmVudCBiYXNlICh3aGljaCBtYXkgYmUgMCBhbmQgc2hvdWxkIGJlXG4gICAgICAgIC8vIGhvbm9yZWQgYXMgc3VjaCkuXG4gICAgICAgIGNvbnN0IHQgPSBNYXRoLmZsb29yKHRoaXMuVl8gKyB0aGlzLnlfKCkpLCBuID0gTWF0aC5tYXgoMCwgRGF0ZS5ub3coKSAtIHRoaXMuZl8pLCByID0gTWF0aC5tYXgoMCwgdCAtIG4pO1xuICAgICAgICAvLyBHdWFyZCBhZ2FpbnN0IGxhc3RBdHRlbXB0VGltZSBiZWluZyBpbiB0aGUgZnV0dXJlIGR1ZSB0byBhIGNsb2NrIGNoYW5nZS5cbiAgICAgICAgICAgICAgICByID4gMCAmJiBfX1BSSVZBVEVfbG9nRGVidWcoXCJFeHBvbmVudGlhbEJhY2tvZmZcIiwgYEJhY2tpbmcgb2ZmIGZvciAke3J9IG1zIChiYXNlIGRlbGF5OiAke3RoaXMuVl99IG1zLCBkZWxheSB3aXRoIGppdHRlcjogJHt0fSBtcywgbGFzdCBhdHRlbXB0OiAke259IG1zIGFnbylgKSwgXG4gICAgICAgIHRoaXMubV8gPSB0aGlzLk1pLmVucXVldWVBZnRlckRlbGF5KHRoaXMudGltZXJJZCwgciwgKCgpID0+ICh0aGlzLmZfID0gRGF0ZS5ub3coKSwgXG4gICAgICAgIGUoKSkpKSwgXG4gICAgICAgIC8vIEFwcGx5IGJhY2tvZmYgZmFjdG9yIHRvIGRldGVybWluZSBuZXh0IGRlbGF5IGFuZCBlbnN1cmUgaXQgaXMgd2l0aGluXG4gICAgICAgIC8vIGJvdW5kcy5cbiAgICAgICAgdGhpcy5WXyAqPSB0aGlzLkFfLCB0aGlzLlZfIDwgdGhpcy5kXyAmJiAodGhpcy5WXyA9IHRoaXMuZF8pLCB0aGlzLlZfID4gdGhpcy5SXyAmJiAodGhpcy5WXyA9IHRoaXMuUl8pO1xuICAgIH1cbiAgICB3XygpIHtcbiAgICAgICAgbnVsbCAhPT0gdGhpcy5tXyAmJiAodGhpcy5tXy5za2lwRGVsYXkoKSwgdGhpcy5tXyA9IG51bGwpO1xuICAgIH1cbiAgICBjYW5jZWwoKSB7XG4gICAgICAgIG51bGwgIT09IHRoaXMubV8gJiYgKHRoaXMubV8uY2FuY2VsKCksIHRoaXMubV8gPSBudWxsKTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgYSByYW5kb20gdmFsdWUgaW4gdGhlIHJhbmdlIFstY3VycmVudEJhc2VNcy8yLCBjdXJyZW50QmFzZU1zLzJdICovICAgIHlfKCkge1xuICAgICAgICByZXR1cm4gKE1hdGgucmFuZG9tKCkgLSAuNSkgKiB0aGlzLlZfO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY29uc3QgZW4gPSBcIlBlcnNpc3RlbnRTdHJlYW1cIjtcblxuLyoqIFRoZSB0aW1lIGEgc3RyZWFtIHN0YXlzIG9wZW4gYWZ0ZXIgaXQgaXMgbWFya2VkIGlkbGUuICovXG4vKipcbiAqIEEgUGVyc2lzdGVudFN0cmVhbSBpcyBhbiBhYnN0cmFjdCBiYXNlIGNsYXNzIHRoYXQgcmVwcmVzZW50cyBhIHN0cmVhbWluZyBSUENcbiAqIHRvIHRoZSBGaXJlc3RvcmUgYmFja2VuZC4gSXQncyBidWlsdCBvbiB0b3Agb2YgdGhlIGNvbm5lY3Rpb25zIG93biBzdXBwb3J0XG4gKiBmb3Igc3RyZWFtaW5nIFJQQ3MsIGFuZCBhZGRzIHNldmVyYWwgY3JpdGljYWwgZmVhdHVyZXMgZm9yIG91ciBjbGllbnRzOlxuICpcbiAqICAgLSBFeHBvbmVudGlhbCBiYWNrb2ZmIG9uIGZhaWx1cmVcbiAqICAgLSBBdXRoZW50aWNhdGlvbiB2aWEgQ3JlZGVudGlhbHNQcm92aWRlclxuICogICAtIERpc3BhdGNoaW5nIGFsbCBjYWxsYmFja3MgaW50byB0aGUgc2hhcmVkIHdvcmtlciBxdWV1ZVxuICogICAtIENsb3NpbmcgaWRsZSBzdHJlYW1zIGFmdGVyIDYwIHNlY29uZHMgb2YgaW5hY3Rpdml0eVxuICpcbiAqIFN1YmNsYXNzZXMgb2YgUGVyc2lzdGVudFN0cmVhbSBpbXBsZW1lbnQgc2VyaWFsaXphdGlvbiBvZiBtb2RlbHMgdG8gYW5kXG4gKiBmcm9tIHRoZSBKU09OIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBwcm90b2NvbCBidWZmZXJzIGZvciBhIHNwZWNpZmljXG4gKiBzdHJlYW1pbmcgUlBDLlxuICpcbiAqICMjIFN0YXJ0aW5nIGFuZCBTdG9wcGluZ1xuICpcbiAqIFN0cmVhbWluZyBSUENzIGFyZSBzdGF0ZWZ1bCBhbmQgbmVlZCB0byBiZSBzdGFydCgpZWQgYmVmb3JlIG1lc3NhZ2VzIGNhblxuICogYmUgc2VudCBhbmQgcmVjZWl2ZWQuIFRoZSBQZXJzaXN0ZW50U3RyZWFtIHdpbGwgY2FsbCB0aGUgb25PcGVuKCkgZnVuY3Rpb25cbiAqIG9mIHRoZSBsaXN0ZW5lciBvbmNlIHRoZSBzdHJlYW0gaXMgcmVhZHkgdG8gYWNjZXB0IHJlcXVlc3RzLlxuICpcbiAqIFNob3VsZCBhIHN0YXJ0KCkgZmFpbCwgUGVyc2lzdGVudFN0cmVhbSB3aWxsIGNhbGwgdGhlIHJlZ2lzdGVyZWQgb25DbG9zZSgpXG4gKiBsaXN0ZW5lciB3aXRoIGEgRmlyZXN0b3JlRXJyb3IgaW5kaWNhdGluZyB3aGF0IHdlbnQgd3JvbmcuXG4gKlxuICogQSBQZXJzaXN0ZW50U3RyZWFtIGNhbiBiZSBzdGFydGVkIGFuZCBzdG9wcGVkIHJlcGVhdGVkbHkuXG4gKlxuICogR2VuZXJpYyB0eXBlczpcbiAqICBTZW5kVHlwZTogVGhlIHR5cGUgb2YgdGhlIG91dGdvaW5nIG1lc3NhZ2Ugb2YgdGhlIHVuZGVybHlpbmdcbiAqICAgIGNvbm5lY3Rpb24gc3RyZWFtXG4gKiAgUmVjZWl2ZVR5cGU6IFRoZSB0eXBlIG9mIHRoZSBpbmNvbWluZyBtZXNzYWdlIG9mIHRoZSB1bmRlcmx5aW5nXG4gKiAgICBjb25uZWN0aW9uIHN0cmVhbVxuICogIExpc3RlbmVyVHlwZTogVGhlIHR5cGUgb2YgdGhlIGxpc3RlbmVyIHRoYXQgd2lsbCBiZSB1c2VkIGZvciBjYWxsYmFja3NcbiAqL1xuY2xhc3MgX19QUklWQVRFX1BlcnNpc3RlbnRTdHJlYW0ge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4sIHIsIGksIHMsIG8sIF8pIHtcbiAgICAgICAgdGhpcy5NaSA9IGUsIHRoaXMuU18gPSBuLCB0aGlzLmJfID0gciwgdGhpcy5jb25uZWN0aW9uID0gaSwgdGhpcy5hdXRoQ3JlZGVudGlhbHNQcm92aWRlciA9IHMsIFxuICAgICAgICB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHNQcm92aWRlciA9IG8sIHRoaXMubGlzdGVuZXIgPSBfLCB0aGlzLnN0YXRlID0gMCAvKiBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuSW5pdGlhbCAqLyAsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBjbG9zZSBjb3VudCB0aGF0J3MgaW5jcmVtZW50ZWQgZXZlcnkgdGltZSB0aGUgc3RyZWFtIGlzIGNsb3NlZDsgdXNlZCBieVxuICAgICAgICAgKiBnZXRDbG9zZUd1YXJkZWREaXNwYXRjaGVyKCkgdG8gaW52YWxpZGF0ZSBjYWxsYmFja3MgdGhhdCBoYXBwZW4gYWZ0ZXJcbiAgICAgICAgICogY2xvc2UuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLkRfID0gMCwgdGhpcy5DXyA9IG51bGwsIHRoaXMudl8gPSBudWxsLCB0aGlzLnN0cmVhbSA9IG51bGwsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQ291bnQgb2YgcmVzcG9uc2UgbWVzc2FnZXMgcmVjZWl2ZWQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLkZfID0gMCwgdGhpcy5NXyA9IG5ldyBfX1BSSVZBVEVfRXhwb25lbnRpYWxCYWNrb2ZmKGUsIHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgc3RhcnQoKSBoYXMgYmVlbiBjYWxsZWQgYW5kIG5vIGVycm9yIGhhcyBvY2N1cnJlZC4gVHJ1ZVxuICAgICAqIGluZGljYXRlcyB0aGUgc3RyZWFtIGlzIG9wZW4gb3IgaW4gdGhlIHByb2Nlc3Mgb2Ygb3BlbmluZyAod2hpY2hcbiAgICAgKiBlbmNvbXBhc3NlcyByZXNwZWN0aW5nIGJhY2tvZmYsIGdldHRpbmcgYXV0aCB0b2tlbnMsIGFuZCBzdGFydGluZyB0aGVcbiAgICAgKiBhY3R1YWwgUlBDKS4gVXNlIGlzT3BlbigpIHRvIGRldGVybWluZSBpZiB0aGUgc3RyZWFtIGlzIG9wZW4gYW5kIHJlYWR5IGZvclxuICAgICAqIG91dGJvdW5kIHJlcXVlc3RzLlxuICAgICAqLyAgICB4XygpIHtcbiAgICAgICAgcmV0dXJuIDEgLyogUGVyc2lzdGVudFN0cmVhbVN0YXRlLlN0YXJ0aW5nICovID09PSB0aGlzLnN0YXRlIHx8IDUgLyogUGVyc2lzdGVudFN0cmVhbVN0YXRlLkJhY2tvZmYgKi8gPT09IHRoaXMuc3RhdGUgfHwgdGhpcy5PXygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIHVuZGVybHlpbmcgUlBDIGlzIG9wZW4gKHRoZSBvbk9wZW4oKSBsaXN0ZW5lciBoYXMgYmVlblxuICAgICAqIGNhbGxlZCkgYW5kIHRoZSBzdHJlYW0gaXMgcmVhZHkgZm9yIG91dGJvdW5kIHJlcXVlc3RzLlxuICAgICAqLyAgICBPXygpIHtcbiAgICAgICAgcmV0dXJuIDIgLyogUGVyc2lzdGVudFN0cmVhbVN0YXRlLk9wZW4gKi8gPT09IHRoaXMuc3RhdGUgfHwgMyAvKiBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuSGVhbHRoeSAqLyA9PT0gdGhpcy5zdGF0ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RhcnRzIHRoZSBSUEMuIE9ubHkgYWxsb3dlZCBpZiBpc1N0YXJ0ZWQoKSByZXR1cm5zIGZhbHNlLiBUaGUgc3RyZWFtIGlzXG4gICAgICogbm90IGltbWVkaWF0ZWx5IHJlYWR5IGZvciB1c2U6IG9uT3BlbigpIHdpbGwgYmUgaW52b2tlZCB3aGVuIHRoZSBSUEMgaXNcbiAgICAgKiByZWFkeSBmb3Igb3V0Ym91bmQgcmVxdWVzdHMsIGF0IHdoaWNoIHBvaW50IGlzT3BlbigpIHdpbGwgcmV0dXJuIHRydWUuXG4gICAgICpcbiAgICAgKiBXaGVuIHN0YXJ0IHJldHVybnMsIGlzU3RhcnRlZCgpIHdpbGwgcmV0dXJuIHRydWUuXG4gICAgICovICAgIHN0YXJ0KCkge1xuICAgICAgICB0aGlzLkZfID0gMCwgNCAvKiBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuRXJyb3IgKi8gIT09IHRoaXMuc3RhdGUgPyB0aGlzLmF1dGgoKSA6IHRoaXMuTl8oKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RvcHMgdGhlIFJQQy4gVGhpcyBjYWxsIGlzIGlkZW1wb3RlbnQgYW5kIGFsbG93ZWQgcmVnYXJkbGVzcyBvZiB0aGVcbiAgICAgKiBjdXJyZW50IGlzU3RhcnRlZCgpIHN0YXRlLlxuICAgICAqXG4gICAgICogV2hlbiBzdG9wIHJldHVybnMsIGlzU3RhcnRlZCgpIGFuZCBpc09wZW4oKSB3aWxsIGJvdGggcmV0dXJuIGZhbHNlLlxuICAgICAqLyAgICBhc3luYyBzdG9wKCkge1xuICAgICAgICB0aGlzLnhfKCkgJiYgYXdhaXQgdGhpcy5jbG9zZSgwIC8qIFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5Jbml0aWFsICovKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWZ0ZXIgYW4gZXJyb3IgdGhlIHN0cmVhbSB3aWxsIHVzdWFsbHkgYmFjayBvZmYgb24gdGhlIG5leHQgYXR0ZW1wdCB0b1xuICAgICAqIHN0YXJ0IGl0LiBJZiB0aGUgZXJyb3Igd2FycmFudHMgYW4gaW1tZWRpYXRlIHJlc3RhcnQgb2YgdGhlIHN0cmVhbSwgdGhlXG4gICAgICogc2VuZGVyIGNhbiB1c2UgdGhpcyB0byBpbmRpY2F0ZSB0aGF0IHRoZSByZWNlaXZlciBzaG91bGQgbm90IGJhY2sgb2ZmLlxuICAgICAqXG4gICAgICogRWFjaCBlcnJvciB3aWxsIGNhbGwgdGhlIG9uQ2xvc2UoKSBsaXN0ZW5lci4gVGhhdCBmdW5jdGlvbiBjYW4gZGVjaWRlIHRvXG4gICAgICogaW5oaWJpdCBiYWNrb2ZmIGlmIHJlcXVpcmVkLlxuICAgICAqLyAgICBCXygpIHtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IDAgLyogUGVyc2lzdGVudFN0cmVhbVN0YXRlLkluaXRpYWwgKi8gLCB0aGlzLk1fLnJlc2V0KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE1hcmtzIHRoaXMgc3RyZWFtIGFzIGlkbGUuIElmIG5vIGZ1cnRoZXIgYWN0aW9ucyBhcmUgcGVyZm9ybWVkIG9uIHRoZVxuICAgICAqIHN0cmVhbSBmb3Igb25lIG1pbnV0ZSwgdGhlIHN0cmVhbSB3aWxsIGF1dG9tYXRpY2FsbHkgY2xvc2UgaXRzZWxmIGFuZFxuICAgICAqIG5vdGlmeSB0aGUgc3RyZWFtJ3Mgb25DbG9zZSgpIGhhbmRsZXIgd2l0aCBTdGF0dXMuT0suIFRoZSBzdHJlYW0gd2lsbCB0aGVuXG4gICAgICogYmUgaW4gYSAhaXNTdGFydGVkKCkgc3RhdGUsIHJlcXVpcmluZyB0aGUgY2FsbGVyIHRvIHN0YXJ0IHRoZSBzdHJlYW0gYWdhaW5cbiAgICAgKiBiZWZvcmUgZnVydGhlciB1c2UuXG4gICAgICpcbiAgICAgKiBPbmx5IHN0cmVhbXMgdGhhdCBhcmUgaW4gc3RhdGUgJ09wZW4nIGNhbiBiZSBtYXJrZWQgaWRsZSwgYXMgYWxsIG90aGVyXG4gICAgICogc3RhdGVzIGltcGx5IHBlbmRpbmcgbmV0d29yayBvcGVyYXRpb25zLlxuICAgICAqLyAgICBMXygpIHtcbiAgICAgICAgLy8gU3RhcnRzIHRoZSBpZGxlIHRpbWUgaWYgd2UgYXJlIGluIHN0YXRlICdPcGVuJyBhbmQgYXJlIG5vdCB5ZXQgYWxyZWFkeVxuICAgICAgICAvLyBydW5uaW5nIGEgdGltZXIgKGluIHdoaWNoIGNhc2UgdGhlIHByZXZpb3VzIGlkbGUgdGltZW91dCBzdGlsbCBhcHBsaWVzKS5cbiAgICAgICAgdGhpcy5PXygpICYmIG51bGwgPT09IHRoaXMuQ18gJiYgKHRoaXMuQ18gPSB0aGlzLk1pLmVucXVldWVBZnRlckRlbGF5KHRoaXMuU18sIDZlNCwgKCgpID0+IHRoaXMua18oKSkpKTtcbiAgICB9XG4gICAgLyoqIFNlbmRzIGEgbWVzc2FnZSB0byB0aGUgdW5kZXJseWluZyBzdHJlYW0uICovICAgIHFfKGUpIHtcbiAgICAgICAgdGhpcy5RXygpLCB0aGlzLnN0cmVhbS5zZW5kKGUpO1xuICAgIH1cbiAgICAvKiogQ2FsbGVkIGJ5IHRoZSBpZGxlIHRpbWVyIHdoZW4gdGhlIHN0cmVhbSBzaG91bGQgY2xvc2UgZHVlIHRvIGluYWN0aXZpdHkuICovICAgIGFzeW5jIGtfKCkge1xuICAgICAgICBpZiAodGhpcy5PXygpKSBcbiAgICAgICAgLy8gV2hlbiB0aW1pbmcgb3V0IGFuIGlkbGUgc3RyZWFtIHRoZXJlJ3Mgbm8gcmVhc29uIHRvIGZvcmNlIHRoZSBzdHJlYW0gaW50byBiYWNrb2ZmIHdoZW5cbiAgICAgICAgLy8gaXQgcmVzdGFydHMgc28gc2V0IHRoZSBzdHJlYW0gc3RhdGUgdG8gSW5pdGlhbCBpbnN0ZWFkIG9mIEVycm9yLlxuICAgICAgICByZXR1cm4gdGhpcy5jbG9zZSgwIC8qIFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5Jbml0aWFsICovKTtcbiAgICB9XG4gICAgLyoqIE1hcmtzIHRoZSBzdHJlYW0gYXMgYWN0aXZlIGFnYWluLiAqLyAgICBRXygpIHtcbiAgICAgICAgdGhpcy5DXyAmJiAodGhpcy5DXy5jYW5jZWwoKSwgdGhpcy5DXyA9IG51bGwpO1xuICAgIH1cbiAgICAvKiogQ2FuY2VscyB0aGUgaGVhbHRoIGNoZWNrIGRlbGF5ZWQgb3BlcmF0aW9uLiAqLyAgICBVXygpIHtcbiAgICAgICAgdGhpcy52XyAmJiAodGhpcy52Xy5jYW5jZWwoKSwgdGhpcy52XyA9IG51bGwpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbG9zZXMgdGhlIHN0cmVhbSBhbmQgY2xlYW5zIHVwIGFzIG5lY2Vzc2FyeTpcbiAgICAgKlxuICAgICAqICogY2xvc2VzIHRoZSB1bmRlcmx5aW5nIEdSUEMgc3RyZWFtO1xuICAgICAqICogY2FsbHMgdGhlIG9uQ2xvc2UgaGFuZGxlciB3aXRoIHRoZSBnaXZlbiAnZXJyb3InO1xuICAgICAqICogc2V0cyBpbnRlcm5hbCBzdHJlYW0gc3RhdGUgdG8gJ2ZpbmFsU3RhdGUnO1xuICAgICAqICogYWRqdXN0cyB0aGUgYmFja29mZiB0aW1lciBiYXNlZCBvbiB0aGUgZXJyb3JcbiAgICAgKlxuICAgICAqIEEgbmV3IHN0cmVhbSBjYW4gYmUgb3BlbmVkIGJ5IGNhbGxpbmcgc3RhcnQoKS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBmaW5hbFN0YXRlIC0gdGhlIGludGVuZGVkIHN0YXRlIG9mIHRoZSBzdHJlYW0gYWZ0ZXIgY2xvc2luZy5cbiAgICAgKiBAcGFyYW0gZXJyb3IgLSB0aGUgZXJyb3IgdGhlIGNvbm5lY3Rpb24gd2FzIGNsb3NlZCB3aXRoLlxuICAgICAqLyAgICBhc3luYyBjbG9zZShlLCB0KSB7XG4gICAgICAgIC8vIENhbmNlbCBhbnkgb3V0c3RhbmRpbmcgdGltZXJzICh0aGV5J3JlIGd1YXJhbnRlZWQgbm90IHRvIGV4ZWN1dGUpLlxuICAgICAgICB0aGlzLlFfKCksIHRoaXMuVV8oKSwgdGhpcy5NXy5jYW5jZWwoKSwgXG4gICAgICAgIC8vIEludmFsaWRhdGVzIGFueSBzdHJlYW0tcmVsYXRlZCBjYWxsYmFja3MgKGUuZy4gZnJvbSBhdXRoIG9yIHRoZVxuICAgICAgICAvLyB1bmRlcmx5aW5nIHN0cmVhbSksIGd1YXJhbnRlZWluZyB0aGV5IHdvbid0IGV4ZWN1dGUuXG4gICAgICAgIHRoaXMuRF8rKywgNCAvKiBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuRXJyb3IgKi8gIT09IGUgPyBcbiAgICAgICAgLy8gSWYgdGhpcyBpcyBhbiBpbnRlbnRpb25hbCBjbG9zZSBlbnN1cmUgd2UgZG9uJ3QgZGVsYXkgb3VyIG5leHQgY29ubmVjdGlvbiBhdHRlbXB0LlxuICAgICAgICB0aGlzLk1fLnJlc2V0KCkgOiB0ICYmIHQuY29kZSA9PT0gTi5SRVNPVVJDRV9FWEhBVVNURUQgPyAoXG4gICAgICAgIC8vIExvZyB0aGUgZXJyb3IuIChQcm9iYWJseSBlaXRoZXIgJ3F1b3RhIGV4Y2VlZGVkJyBvciAnbWF4IHF1ZXVlIGxlbmd0aCByZWFjaGVkJy4pXG4gICAgICAgIF9fUFJJVkFURV9sb2dFcnJvcih0LnRvU3RyaW5nKCkpLCBfX1BSSVZBVEVfbG9nRXJyb3IoXCJVc2luZyBtYXhpbXVtIGJhY2tvZmYgZGVsYXkgdG8gcHJldmVudCBvdmVybG9hZGluZyB0aGUgYmFja2VuZC5cIiksIFxuICAgICAgICB0aGlzLk1fLmdfKCkpIDogdCAmJiB0LmNvZGUgPT09IE4uVU5BVVRIRU5USUNBVEVEICYmIDMgLyogUGVyc2lzdGVudFN0cmVhbVN0YXRlLkhlYWx0aHkgKi8gIT09IHRoaXMuc3RhdGUgJiYgKFxuICAgICAgICAvLyBcInVuYXV0aGVudGljYXRlZFwiIGVycm9yIG1lYW5zIHRoZSB0b2tlbiB3YXMgcmVqZWN0ZWQuIFRoaXMgc2hvdWxkIHJhcmVseVxuICAgICAgICAvLyBoYXBwZW4gc2luY2UgYm90aCBBdXRoIGFuZCBBcHBDaGVjayBlbnN1cmUgYSBzdWZmaWNpZW50IFRUTCB3aGVuIHdlXG4gICAgICAgIC8vIHJlcXVlc3QgYSB0b2tlbi4gSWYgYSB1c2VyIG1hbnVhbGx5IHJlc2V0cyB0aGVpciBzeXN0ZW0gY2xvY2sgdGhpcyBjYW5cbiAgICAgICAgLy8gZmFpbCwgaG93ZXZlci4gSW4gdGhpcyBjYXNlLCB3ZSBzaG91bGQgZ2V0IGEgQ29kZS5VTkFVVEhFTlRJQ0FURUQgZXJyb3JcbiAgICAgICAgLy8gYmVmb3JlIHdlIHJlY2VpdmVkIHRoZSBmaXJzdCBtZXNzYWdlIGFuZCB3ZSBuZWVkIHRvIGludmFsaWRhdGUgdGhlIHRva2VuXG4gICAgICAgIC8vIHRvIGVuc3VyZSB0aGF0IHdlIGZldGNoIGEgbmV3IHRva2VuLlxuICAgICAgICB0aGlzLmF1dGhDcmVkZW50aWFsc1Byb3ZpZGVyLmludmFsaWRhdGVUb2tlbigpLCB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHNQcm92aWRlci5pbnZhbGlkYXRlVG9rZW4oKSksIFxuICAgICAgICAvLyBDbGVhbiB1cCB0aGUgdW5kZXJseWluZyBzdHJlYW0gYmVjYXVzZSB3ZSBhcmUgbm8gbG9uZ2VyIGludGVyZXN0ZWQgaW4gZXZlbnRzLlxuICAgICAgICBudWxsICE9PSB0aGlzLnN0cmVhbSAmJiAodGhpcy5LXygpLCB0aGlzLnN0cmVhbS5jbG9zZSgpLCB0aGlzLnN0cmVhbSA9IG51bGwpLCBcbiAgICAgICAgLy8gVGhpcyBzdGF0ZSBtdXN0IGJlIGFzc2lnbmVkIGJlZm9yZSBjYWxsaW5nIG9uQ2xvc2UoKSB0byBhbGxvdyB0aGUgY2FsbGJhY2sgdG9cbiAgICAgICAgLy8gaW5oaWJpdCBiYWNrb2ZmIG9yIG90aGVyd2lzZSBtYW5pcHVsYXRlIHRoZSBzdGF0ZSBpbiBpdHMgbm9uLXN0YXJ0ZWQgc3RhdGUuXG4gICAgICAgIHRoaXMuc3RhdGUgPSBlLCBcbiAgICAgICAgLy8gTm90aWZ5IHRoZSBsaXN0ZW5lciB0aGF0IHRoZSBzdHJlYW0gY2xvc2VkLlxuICAgICAgICBhd2FpdCB0aGlzLmxpc3RlbmVyLnJfKHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYW4gYmUgb3ZlcnJpZGRlbiB0byBwZXJmb3JtIGFkZGl0aW9uYWwgY2xlYW51cCBiZWZvcmUgdGhlIHN0cmVhbSBpcyBjbG9zZWQuXG4gICAgICogQ2FsbGluZyBzdXBlci50ZWFyRG93bigpIGlzIG5vdCByZXF1aXJlZC5cbiAgICAgKi8gICAgS18oKSB7fVxuICAgIGF1dGgoKSB7XG4gICAgICAgIHRoaXMuc3RhdGUgPSAxIC8qIFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5TdGFydGluZyAqLztcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuV18odGhpcy5EXyksIHQgPSB0aGlzLkRfO1xuICAgICAgICAvLyBUT0RPKG1pa2VsZWhlbik6IEp1c3QgdXNlIGRpc3BhdGNoSWZOb3RDbG9zZWQsIGJ1dCBzZWUgVE9ETyBiZWxvdy5cbiAgICAgICAgICAgICAgICBQcm9taXNlLmFsbChbIHRoaXMuYXV0aENyZWRlbnRpYWxzUHJvdmlkZXIuZ2V0VG9rZW4oKSwgdGhpcy5hcHBDaGVja0NyZWRlbnRpYWxzUHJvdmlkZXIuZ2V0VG9rZW4oKSBdKS50aGVuKCgoW2UsIG5dKSA9PiB7XG4gICAgICAgICAgICAvLyBTdHJlYW0gY2FuIGJlIHN0b3BwZWQgd2hpbGUgd2FpdGluZyBmb3IgYXV0aGVudGljYXRpb24uXG4gICAgICAgICAgICAvLyBUT0RPKG1pa2VsZWhlbik6IFdlIHJlYWxseSBzaG91bGQganVzdCB1c2UgZGlzcGF0Y2hJZk5vdENsb3NlZFxuICAgICAgICAgICAgLy8gYW5kIGxldCB0aGlzIGRpc3BhdGNoIG9udG8gdGhlIHF1ZXVlLCBidXQgdGhhdCBvcGVuZWQgYSBzcGVjIHRlc3QgY2FuXG4gICAgICAgICAgICAvLyBvZiB3b3JtcyB0aGF0IEkgZG9uJ3Qgd2FudCB0byBkZWFsIHdpdGggaW4gdGhpcyBQUi5cbiAgICAgICAgICAgIHRoaXMuRF8gPT09IHQgJiYgXG4gICAgICAgICAgICAvLyBOb3JtYWxseSB3ZSdkIGhhdmUgdG8gc2NoZWR1bGUgdGhlIGNhbGxiYWNrIG9uIHRoZSBBc3luY1F1ZXVlLlxuICAgICAgICAgICAgLy8gSG93ZXZlciwgdGhlIGZvbGxvd2luZyBjYWxscyBhcmUgc2FmZSB0byBiZSBjYWxsZWQgb3V0c2lkZSB0aGVcbiAgICAgICAgICAgIC8vIEFzeW5jUXVldWUgc2luY2UgdGhleSBkb24ndCBjaGFpbiBhc3luY2hyb25vdXMgY2FsbHNcbiAgICAgICAgICAgIHRoaXMuR18oZSwgbik7XG4gICAgICAgIH0pLCAodCA9PiB7XG4gICAgICAgICAgICBlKCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBGaXJlc3RvcmVFcnJvcihOLlVOS05PV04sIFwiRmV0Y2hpbmcgYXV0aCB0b2tlbiBmYWlsZWQ6IFwiICsgdC5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy56XyhlKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBHXyhlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLldfKHRoaXMuRF8pO1xuICAgICAgICB0aGlzLnN0cmVhbSA9IHRoaXMual8oZSwgdCksIHRoaXMuc3RyZWFtLlhvKCgoKSA9PiB7XG4gICAgICAgICAgICBuKCgoKSA9PiB0aGlzLmxpc3RlbmVyLlhvKCkpKTtcbiAgICAgICAgfSkpLCB0aGlzLnN0cmVhbS50XygoKCkgPT4ge1xuICAgICAgICAgICAgbigoKCkgPT4gKHRoaXMuc3RhdGUgPSAyIC8qIFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5PcGVuICovICwgdGhpcy52XyA9IHRoaXMuTWkuZW5xdWV1ZUFmdGVyRGVsYXkodGhpcy5iXywgMWU0LCAoKCkgPT4gKHRoaXMuT18oKSAmJiAodGhpcy5zdGF0ZSA9IDMgLyogUGVyc2lzdGVudFN0cmVhbVN0YXRlLkhlYWx0aHkgKi8pLCBcbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpKSkpLCB0aGlzLmxpc3RlbmVyLnRfKCkpKSk7XG4gICAgICAgIH0pKSwgdGhpcy5zdHJlYW0ucl8oKGUgPT4ge1xuICAgICAgICAgICAgbigoKCkgPT4gdGhpcy56XyhlKSkpO1xuICAgICAgICB9KSksIHRoaXMuc3RyZWFtLm9uTWVzc2FnZSgoZSA9PiB7XG4gICAgICAgICAgICBuKCgoKSA9PiAxID09ICsrdGhpcy5GXyA/IHRoaXMuSl8oZSkgOiB0aGlzLm9uTmV4dChlKSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIE5fKCkge1xuICAgICAgICB0aGlzLnN0YXRlID0gNSAvKiBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuQmFja29mZiAqLyAsIHRoaXMuTV8ucF8oKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSAwIC8qIFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5Jbml0aWFsICovICwgdGhpcy5zdGFydCgpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8vIFZpc2libGUgZm9yIHRlc3RzXG4gICAgel8oZSkge1xuICAgICAgICAvLyBJbiB0aGVvcnkgdGhlIHN0cmVhbSBjb3VsZCBjbG9zZSBjbGVhbmx5LCBob3dldmVyLCBpbiBvdXIgY3VycmVudCBtb2RlbFxuICAgICAgICAvLyB3ZSBuZXZlciBleHBlY3QgdGhpcyB0byBoYXBwZW4gYmVjYXVzZSBpZiB3ZSBzdG9wIGEgc3RyZWFtIG91cnNlbHZlcyxcbiAgICAgICAgLy8gdGhpcyBjYWxsYmFjayB3aWxsIG5ldmVyIGJlIGNhbGxlZC4gVG8gcHJldmVudCBjYXNlcyB3aGVyZSB3ZSByZXRyeVxuICAgICAgICAvLyB3aXRob3V0IGEgYmFja29mZiBhY2NpZGVudGFsbHksIHdlIHNldCB0aGUgc3RyZWFtIHRvIGVycm9yIGluIGFsbCBjYXNlcy5cbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9sb2dEZWJ1ZyhlbiwgYGNsb3NlIHdpdGggZXJyb3I6ICR7ZX1gKSwgdGhpcy5zdHJlYW0gPSBudWxsLCB0aGlzLmNsb3NlKDQgLyogUGVyc2lzdGVudFN0cmVhbVN0YXRlLkVycm9yICovICwgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBcImRpc3BhdGNoZXJcIiBmdW5jdGlvbiB0aGF0IGRpc3BhdGNoZXMgb3BlcmF0aW9ucyBvbnRvIHRoZVxuICAgICAqIEFzeW5jUXVldWUgYnV0IG9ubHkgcnVucyB0aGVtIGlmIGNsb3NlQ291bnQgcmVtYWlucyB1bmNoYW5nZWQuIFRoaXMgYWxsb3dzXG4gICAgICogdXMgdG8gdHVybiBhdXRoIC8gc3RyZWFtIGNhbGxiYWNrcyBpbnRvIG5vLW9wcyBpZiB0aGUgc3RyZWFtIGlzIGNsb3NlZCAvXG4gICAgICogcmUtb3BlbmVkLCBldGMuXG4gICAgICovICAgIFdfKGUpIHtcbiAgICAgICAgcmV0dXJuIHQgPT4ge1xuICAgICAgICAgICAgdGhpcy5NaS5lbnF1ZXVlQW5kRm9yZ2V0KCgoKSA9PiB0aGlzLkRfID09PSBlID8gdCgpIDogKF9fUFJJVkFURV9sb2dEZWJ1ZyhlbiwgXCJzdHJlYW0gY2FsbGJhY2sgc2tpcHBlZCBieSBnZXRDbG9zZUd1YXJkZWREaXNwYXRjaGVyLlwiKSwgXG4gICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKSkpKTtcbiAgICAgICAgfTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBQZXJzaXN0ZW50U3RyZWFtIHRoYXQgaW1wbGVtZW50cyB0aGUgTGlzdGVuIFJQQy5cbiAqXG4gKiBPbmNlIHRoZSBMaXN0ZW4gc3RyZWFtIGhhcyBjYWxsZWQgdGhlIG9uT3BlbigpIGxpc3RlbmVyLCBhbnkgbnVtYmVyIG9mXG4gKiBsaXN0ZW4oKSBhbmQgdW5saXN0ZW4oKSBjYWxscyBjYW4gYmUgbWFkZSB0byBjb250cm9sIHdoYXQgY2hhbmdlcyB3aWxsIGJlXG4gKiBzZW50IGZyb20gdGhlIHNlcnZlciBmb3IgTGlzdGVuUmVzcG9uc2VzLlxuICovIGNsYXNzIF9fUFJJVkFURV9QZXJzaXN0ZW50TGlzdGVuU3RyZWFtIGV4dGVuZHMgX19QUklWQVRFX1BlcnNpc3RlbnRTdHJlYW0ge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4sIHIsIGksIHMpIHtcbiAgICAgICAgc3VwZXIoZSwgXCJsaXN0ZW5fc3RyZWFtX2Nvbm5lY3Rpb25fYmFja29mZlwiIC8qIFRpbWVySWQuTGlzdGVuU3RyZWFtQ29ubmVjdGlvbkJhY2tvZmYgKi8gLCBcImxpc3Rlbl9zdHJlYW1faWRsZVwiIC8qIFRpbWVySWQuTGlzdGVuU3RyZWFtSWRsZSAqLyAsIFwiaGVhbHRoX2NoZWNrX3RpbWVvdXRcIiAvKiBUaW1lcklkLkhlYWx0aENoZWNrVGltZW91dCAqLyAsIHQsIG4sIHIsIHMpLCBcbiAgICAgICAgdGhpcy5zZXJpYWxpemVyID0gaTtcbiAgICB9XG4gICAgal8oZSwgdCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb25uZWN0aW9uLlRfKFwiTGlzdGVuXCIsIGUsIHQpO1xuICAgIH1cbiAgICBKXyhlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9uTmV4dChlKTtcbiAgICB9XG4gICAgb25OZXh0KGUpIHtcbiAgICAgICAgLy8gQSBzdWNjZXNzZnVsIHJlc3BvbnNlIG1lYW5zIHRoZSBzdHJlYW0gaXMgaGVhbHRoeVxuICAgICAgICB0aGlzLk1fLnJlc2V0KCk7XG4gICAgICAgIGNvbnN0IHQgPSBfX1BSSVZBVEVfZnJvbVdhdGNoQ2hhbmdlKHRoaXMuc2VyaWFsaXplciwgZSksIG4gPSBmdW5jdGlvbiBfX1BSSVZBVEVfdmVyc2lvbkZyb21MaXN0ZW5SZXNwb25zZShlKSB7XG4gICAgICAgICAgICAvLyBXZSBoYXZlIG9ubHkgcmVhY2hlZCBhIGNvbnNpc3RlbnQgc25hcHNob3QgZm9yIHRoZSBlbnRpcmUgc3RyZWFtIGlmIHRoZXJlXG4gICAgICAgICAgICAvLyBpcyBhIHJlYWRfdGltZSBzZXQgYW5kIGl0IGFwcGxpZXMgdG8gYWxsIHRhcmdldHMgKGkuZS4gdGhlIGxpc3Qgb2ZcbiAgICAgICAgICAgIC8vIHRhcmdldHMgaXMgZW1wdHkpLiBUaGUgYmFja2VuZCBpcyBndWFyYW50ZWVkIHRvIHNlbmQgc3VjaCByZXNwb25zZXMuXG4gICAgICAgICAgICBpZiAoIShcInRhcmdldENoYW5nZVwiIGluIGUpKSByZXR1cm4gU25hcHNob3RWZXJzaW9uLm1pbigpO1xuICAgICAgICAgICAgY29uc3QgdCA9IGUudGFyZ2V0Q2hhbmdlO1xuICAgICAgICAgICAgcmV0dXJuIHQudGFyZ2V0SWRzICYmIHQudGFyZ2V0SWRzLmxlbmd0aCA/IFNuYXBzaG90VmVyc2lvbi5taW4oKSA6IHQucmVhZFRpbWUgPyBfX1BSSVZBVEVfZnJvbVZlcnNpb24odC5yZWFkVGltZSkgOiBTbmFwc2hvdFZlcnNpb24ubWluKCk7XG4gICAgICAgIH0oZSk7XG4gICAgICAgIHJldHVybiB0aGlzLmxpc3RlbmVyLkhfKHQsIG4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlcnMgaW50ZXJlc3QgaW4gdGhlIHJlc3VsdHMgb2YgdGhlIGdpdmVuIHRhcmdldC4gSWYgdGhlIHRhcmdldFxuICAgICAqIGluY2x1ZGVzIGEgcmVzdW1lVG9rZW4gaXQgd2lsbCBiZSBpbmNsdWRlZCBpbiB0aGUgcmVxdWVzdC4gUmVzdWx0cyB0aGF0XG4gICAgICogYWZmZWN0IHRoZSB0YXJnZXQgd2lsbCBiZSBzdHJlYW1lZCBiYWNrIGFzIFdhdGNoQ2hhbmdlIG1lc3NhZ2VzIHRoYXRcbiAgICAgKiByZWZlcmVuY2UgdGhlIHRhcmdldElkLlxuICAgICAqLyAgICBZXyhlKSB7XG4gICAgICAgIGNvbnN0IHQgPSB7fTtcbiAgICAgICAgdC5kYXRhYmFzZSA9IF9fUFJJVkFURV9nZXRFbmNvZGVkRGF0YWJhc2VJZCh0aGlzLnNlcmlhbGl6ZXIpLCB0LmFkZFRhcmdldCA9IGZ1bmN0aW9uIF9fUFJJVkFURV90b1RhcmdldChlLCB0KSB7XG4gICAgICAgICAgICBsZXQgbjtcbiAgICAgICAgICAgIGNvbnN0IHIgPSB0LnRhcmdldDtcbiAgICAgICAgICAgIGlmIChuID0gX19QUklWQVRFX3RhcmdldElzRG9jdW1lbnRUYXJnZXQocikgPyB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnRzOiBfX1BSSVZBVEVfdG9Eb2N1bWVudHNUYXJnZXQoZSwgcilcbiAgICAgICAgICAgIH0gOiB7XG4gICAgICAgICAgICAgICAgcXVlcnk6IF9fUFJJVkFURV90b1F1ZXJ5VGFyZ2V0KGUsIHIpLmZ0XG4gICAgICAgICAgICB9LCBuLnRhcmdldElkID0gdC50YXJnZXRJZCwgdC5yZXN1bWVUb2tlbi5hcHByb3hpbWF0ZUJ5dGVTaXplKCkgPiAwKSB7XG4gICAgICAgICAgICAgICAgbi5yZXN1bWVUb2tlbiA9IF9fUFJJVkFURV90b0J5dGVzKGUsIHQucmVzdW1lVG9rZW4pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfdG9JbnQzMlByb3RvKGUsIHQuZXhwZWN0ZWRDb3VudCk7XG4gICAgICAgICAgICAgICAgbnVsbCAhPT0gciAmJiAobi5leHBlY3RlZENvdW50ID0gcik7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHQuc25hcHNob3RWZXJzaW9uLmNvbXBhcmVUbyhTbmFwc2hvdFZlcnNpb24ubWluKCkpID4gMCkge1xuICAgICAgICAgICAgICAgIC8vIFRPRE8od3VhbmR5KTogQ29uc2lkZXIgcmVtb3ZpbmcgYWJvdmUgY2hlY2sgYmVjYXVzZSBpdCBpcyBtb3N0IGxpa2VseSB0cnVlLlxuICAgICAgICAgICAgICAgIC8vIFJpZ2h0IG5vdywgbWFueSB0ZXN0cyBkZXBlbmQgb24gdGhpcyBiZWhhdmlvdXIgdGhvdWdoIChsZWF2aW5nIG1pbigpIG91dFxuICAgICAgICAgICAgICAgIC8vIG9mIHNlcmlhbGl6YXRpb24pLlxuICAgICAgICAgICAgICAgIG4ucmVhZFRpbWUgPSB0b1RpbWVzdGFtcChlLCB0LnNuYXBzaG90VmVyc2lvbi50b1RpbWVzdGFtcCgpKTtcbiAgICAgICAgICAgICAgICBjb25zdCByID0gX19QUklWQVRFX3RvSW50MzJQcm90byhlLCB0LmV4cGVjdGVkQ291bnQpO1xuICAgICAgICAgICAgICAgIG51bGwgIT09IHIgJiYgKG4uZXhwZWN0ZWRDb3VudCA9IHIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG47XG4gICAgICAgIH0odGhpcy5zZXJpYWxpemVyLCBlKTtcbiAgICAgICAgY29uc3QgbiA9IF9fUFJJVkFURV90b0xpc3RlblJlcXVlc3RMYWJlbHModGhpcy5zZXJpYWxpemVyLCBlKTtcbiAgICAgICAgbiAmJiAodC5sYWJlbHMgPSBuKSwgdGhpcy5xXyh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVW5yZWdpc3RlcnMgaW50ZXJlc3QgaW4gdGhlIHJlc3VsdHMgb2YgdGhlIHRhcmdldCBhc3NvY2lhdGVkIHdpdGggdGhlXG4gICAgICogZ2l2ZW4gdGFyZ2V0SWQuXG4gICAgICovICAgIFpfKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IHt9O1xuICAgICAgICB0LmRhdGFiYXNlID0gX19QUklWQVRFX2dldEVuY29kZWREYXRhYmFzZUlkKHRoaXMuc2VyaWFsaXplciksIHQucmVtb3ZlVGFyZ2V0ID0gZSwgXG4gICAgICAgIHRoaXMucV8odCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgU3RyZWFtIHRoYXQgaW1wbGVtZW50cyB0aGUgV3JpdGUgUlBDLlxuICpcbiAqIFRoZSBXcml0ZSBSUEMgcmVxdWlyZXMgdGhlIGNhbGxlciB0byBtYWludGFpbiBzcGVjaWFsIHN0cmVhbVRva2VuXG4gKiBzdGF0ZSBpbiBiZXR3ZWVuIGNhbGxzLCB0byBoZWxwIHRoZSBzZXJ2ZXIgdW5kZXJzdGFuZCB3aGljaCByZXNwb25zZXMgdGhlXG4gKiBjbGllbnQgaGFzIHByb2Nlc3NlZCBieSB0aGUgdGltZSB0aGUgbmV4dCByZXF1ZXN0IGlzIG1hZGUuIEV2ZXJ5IHJlc3BvbnNlXG4gKiB3aWxsIGNvbnRhaW4gYSBzdHJlYW1Ub2tlbjsgdGhpcyB2YWx1ZSBtdXN0IGJlIHBhc3NlZCB0byB0aGUgbmV4dFxuICogcmVxdWVzdC5cbiAqXG4gKiBBZnRlciBjYWxsaW5nIHN0YXJ0KCkgb24gdGhpcyBzdHJlYW0sIHRoZSBuZXh0IHJlcXVlc3QgbXVzdCBiZSBhIGhhbmRzaGFrZSxcbiAqIGNvbnRhaW5pbmcgd2hhdGV2ZXIgc3RyZWFtVG9rZW4gaXMgb24gaGFuZC4gT25jZSBhIHJlc3BvbnNlIHRvIHRoaXNcbiAqIHJlcXVlc3QgaXMgcmVjZWl2ZWQsIGFsbCBwZW5kaW5nIG11dGF0aW9ucyBtYXkgYmUgc3VibWl0dGVkLiBXaGVuXG4gKiBzdWJtaXR0aW5nIG11bHRpcGxlIGJhdGNoZXMgb2YgbXV0YXRpb25zIGF0IHRoZSBzYW1lIHRpbWUsIGl0J3NcbiAqIG9rYXkgdG8gdXNlIHRoZSBzYW1lIHN0cmVhbVRva2VuIGZvciB0aGUgY2FsbHMgdG8gd3JpdGVNdXRhdGlvbnMuXG4gKlxuICogVE9ETyhiLzMzMjcxMjM1KTogVXNlIHByb3RvIHR5cGVzXG4gKi8gY2xhc3MgX19QUklWQVRFX1BlcnNpc3RlbnRXcml0ZVN0cmVhbSBleHRlbmRzIF9fUFJJVkFURV9QZXJzaXN0ZW50U3RyZWFtIHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0LCBuLCByLCBpLCBzKSB7XG4gICAgICAgIHN1cGVyKGUsIFwid3JpdGVfc3RyZWFtX2Nvbm5lY3Rpb25fYmFja29mZlwiIC8qIFRpbWVySWQuV3JpdGVTdHJlYW1Db25uZWN0aW9uQmFja29mZiAqLyAsIFwid3JpdGVfc3RyZWFtX2lkbGVcIiAvKiBUaW1lcklkLldyaXRlU3RyZWFtSWRsZSAqLyAsIFwiaGVhbHRoX2NoZWNrX3RpbWVvdXRcIiAvKiBUaW1lcklkLkhlYWx0aENoZWNrVGltZW91dCAqLyAsIHQsIG4sIHIsIHMpLCBcbiAgICAgICAgdGhpcy5zZXJpYWxpemVyID0gaTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVHJhY2tzIHdoZXRoZXIgb3Igbm90IGEgaGFuZHNoYWtlIGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSBleGNoYW5nZWQgYW5kXG4gICAgICogdGhlIHN0cmVhbSBpcyByZWFkeSB0byBhY2NlcHQgbXV0YXRpb25zLlxuICAgICAqLyAgICBnZXQgWF8oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkZfID4gMDtcbiAgICB9XG4gICAgLy8gT3ZlcnJpZGUgb2YgUGVyc2lzdGVudFN0cmVhbS5zdGFydFxuICAgIHN0YXJ0KCkge1xuICAgICAgICB0aGlzLmxhc3RTdHJlYW1Ub2tlbiA9IHZvaWQgMCwgc3VwZXIuc3RhcnQoKTtcbiAgICB9XG4gICAgS18oKSB7XG4gICAgICAgIHRoaXMuWF8gJiYgdGhpcy5lYShbXSk7XG4gICAgfVxuICAgIGpfKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29ubmVjdGlvbi5UXyhcIldyaXRlXCIsIGUsIHQpO1xuICAgIH1cbiAgICBKXyhlKSB7XG4gICAgICAgIC8vIEFsd2F5cyBjYXB0dXJlIHRoZSBsYXN0IHN0cmVhbSB0b2tlbi5cbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9oYXJkQXNzZXJ0KCEhZS5zdHJlYW1Ub2tlbiwgMzEzMjIpLCB0aGlzLmxhc3RTdHJlYW1Ub2tlbiA9IGUuc3RyZWFtVG9rZW4sIFxuICAgICAgICAvLyBUaGUgZmlyc3QgcmVzcG9uc2UgaXMgYWx3YXlzIHRoZSBoYW5kc2hha2UgcmVzcG9uc2VcbiAgICAgICAgX19QUklWQVRFX2hhcmRBc3NlcnQoIWUud3JpdGVSZXN1bHRzIHx8IDAgPT09IGUud3JpdGVSZXN1bHRzLmxlbmd0aCwgNTU4MTYpLCB0aGlzLmxpc3RlbmVyLnRhKCk7XG4gICAgfVxuICAgIG9uTmV4dChlKSB7XG4gICAgICAgIC8vIEFsd2F5cyBjYXB0dXJlIHRoZSBsYXN0IHN0cmVhbSB0b2tlbi5cbiAgICAgICAgX19QUklWQVRFX2hhcmRBc3NlcnQoISFlLnN0cmVhbVRva2VuLCAxMjY3OCksIHRoaXMubGFzdFN0cmVhbVRva2VuID0gZS5zdHJlYW1Ub2tlbiwgXG4gICAgICAgIC8vIEEgc3VjY2Vzc2Z1bCBmaXJzdCB3cml0ZSByZXNwb25zZSBtZWFucyB0aGUgc3RyZWFtIGlzIGhlYWx0aHksXG4gICAgICAgIC8vIE5vdGUsIHRoYXQgd2UgY291bGQgY29uc2lkZXIgYSBzdWNjZXNzZnVsIGhhbmRzaGFrZSBoZWFsdGh5LCBob3dldmVyLFxuICAgICAgICAvLyB0aGUgd3JpdGUgaXRzZWxmIG1pZ2h0IGJlIGNhdXNpbmcgYW4gZXJyb3Igd2Ugd2FudCB0byBiYWNrIG9mZiBmcm9tLlxuICAgICAgICB0aGlzLk1fLnJlc2V0KCk7XG4gICAgICAgIGNvbnN0IHQgPSBfX1BSSVZBVEVfZnJvbVdyaXRlUmVzdWx0cyhlLndyaXRlUmVzdWx0cywgZS5jb21taXRUaW1lKSwgbiA9IF9fUFJJVkFURV9mcm9tVmVyc2lvbihlLmNvbW1pdFRpbWUpO1xuICAgICAgICByZXR1cm4gdGhpcy5saXN0ZW5lci5uYShuLCB0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgYW4gaW5pdGlhbCBzdHJlYW1Ub2tlbiB0byB0aGUgc2VydmVyLCBwZXJmb3JtaW5nIHRoZSBoYW5kc2hha2VcbiAgICAgKiByZXF1aXJlZCB0byBtYWtlIHRoZSBTdHJlYW1pbmdXcml0ZSBSUEMgd29yay4gU3Vic2VxdWVudFxuICAgICAqIGNhbGxzIHNob3VsZCB3YWl0IHVudGlsIG9uSGFuZHNoYWtlQ29tcGxldGUgd2FzIGNhbGxlZC5cbiAgICAgKi8gICAgcmEoKSB7XG4gICAgICAgIC8vIFRPRE8oZGltb25kKTogU3VwcG9ydCBzdHJlYW0gcmVzdW1wdGlvbi4gV2UgaW50ZW50aW9uYWxseSBkbyBub3Qgc2V0IHRoZVxuICAgICAgICAvLyBzdHJlYW0gdG9rZW4gb24gdGhlIGhhbmRzaGFrZSwgaWdub3JpbmcgYW55IHN0cmVhbSB0b2tlbiB3ZSBtaWdodCBoYXZlLlxuICAgICAgICBjb25zdCBlID0ge307XG4gICAgICAgIGUuZGF0YWJhc2UgPSBfX1BSSVZBVEVfZ2V0RW5jb2RlZERhdGFiYXNlSWQodGhpcy5zZXJpYWxpemVyKSwgdGhpcy5xXyhlKTtcbiAgICB9XG4gICAgLyoqIFNlbmRzIGEgZ3JvdXAgb2YgbXV0YXRpb25zIHRvIHRoZSBGaXJlc3RvcmUgYmFja2VuZCB0byBhcHBseS4gKi8gICAgZWEoZSkge1xuICAgICAgICBjb25zdCB0ID0ge1xuICAgICAgICAgICAgc3RyZWFtVG9rZW46IHRoaXMubGFzdFN0cmVhbVRva2VuLFxuICAgICAgICAgICAgd3JpdGVzOiBlLm1hcCgoZSA9PiB0b011dGF0aW9uKHRoaXMuc2VyaWFsaXplciwgZSkpKVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnFfKHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogRGF0YXN0b3JlIGFuZCBpdHMgcmVsYXRlZCBtZXRob2RzIGFyZSBhIHdyYXBwZXIgYXJvdW5kIHRoZSBleHRlcm5hbCBHb29nbGVcbiAqIENsb3VkIERhdGFzdG9yZSBncnBjIEFQSSwgd2hpY2ggcHJvdmlkZXMgYW4gaW50ZXJmYWNlIHRoYXQgaXMgbW9yZSBjb252ZW5pZW50XG4gKiBmb3IgdGhlIHJlc3Qgb2YgdGhlIGNsaWVudCBTREsgYXJjaGl0ZWN0dXJlIHRvIGNvbnN1bWUuXG4gKi8gY2xhc3MgRGF0YXN0b3JlIHt9XG5cbi8qKlxuICogQW4gaW1wbGVtZW50YXRpb24gb2YgRGF0YXN0b3JlIHRoYXQgZXhwb3NlcyBhZGRpdGlvbmFsIHN0YXRlIGZvciBpbnRlcm5hbFxuICogY29uc3VtcHRpb24uXG4gKi8gY2xhc3MgX19QUklWQVRFX0RhdGFzdG9yZUltcGwgZXh0ZW5kcyBEYXRhc3RvcmUge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4sIHIpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5hdXRoQ3JlZGVudGlhbHMgPSBlLCB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHMgPSB0LCB0aGlzLmNvbm5lY3Rpb24gPSBuLCBcbiAgICAgICAgdGhpcy5zZXJpYWxpemVyID0gciwgdGhpcy5pYSA9ICExO1xuICAgIH1cbiAgICBzYSgpIHtcbiAgICAgICAgaWYgKHRoaXMuaWEpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiVGhlIGNsaWVudCBoYXMgYWxyZWFkeSBiZWVuIHRlcm1pbmF0ZWQuXCIpO1xuICAgIH1cbiAgICAvKiogSW52b2tlcyB0aGUgcHJvdmlkZWQgUlBDIHdpdGggYXV0aCBhbmQgQXBwQ2hlY2sgdG9rZW5zLiAqLyAgICBHbyhlLCB0LCBuLCByKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNhKCksIFByb21pc2UuYWxsKFsgdGhpcy5hdXRoQ3JlZGVudGlhbHMuZ2V0VG9rZW4oKSwgdGhpcy5hcHBDaGVja0NyZWRlbnRpYWxzLmdldFRva2VuKCkgXSkudGhlbigoKFtpLCBzXSkgPT4gdGhpcy5jb25uZWN0aW9uLkdvKGUsIF9fUFJJVkFURV90b1Jlc291cmNlUGF0aCh0LCBuKSwgciwgaSwgcykpKS5jYXRjaCgoZSA9PiB7XG4gICAgICAgICAgICB0aHJvdyBcIkZpcmViYXNlRXJyb3JcIiA9PT0gZS5uYW1lID8gKGUuY29kZSA9PT0gTi5VTkFVVEhFTlRJQ0FURUQgJiYgKHRoaXMuYXV0aENyZWRlbnRpYWxzLmludmFsaWRhdGVUb2tlbigpLCBcbiAgICAgICAgICAgIHRoaXMuYXBwQ2hlY2tDcmVkZW50aWFscy5pbnZhbGlkYXRlVG9rZW4oKSksIGUpIDogbmV3IEZpcmVzdG9yZUVycm9yKE4uVU5LTk9XTiwgZS50b1N0cmluZygpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKiogSW52b2tlcyB0aGUgcHJvdmlkZWQgUlBDIHdpdGggc3RyZWFtZWQgcmVzdWx0cyB3aXRoIGF1dGggYW5kIEFwcENoZWNrIHRva2Vucy4gKi8gICAgSG8oZSwgdCwgbiwgciwgaSkge1xuICAgICAgICByZXR1cm4gdGhpcy5zYSgpLCBQcm9taXNlLmFsbChbIHRoaXMuYXV0aENyZWRlbnRpYWxzLmdldFRva2VuKCksIHRoaXMuYXBwQ2hlY2tDcmVkZW50aWFscy5nZXRUb2tlbigpIF0pLnRoZW4oKChbcywgb10pID0+IHRoaXMuY29ubmVjdGlvbi5IbyhlLCBfX1BSSVZBVEVfdG9SZXNvdXJjZVBhdGgodCwgbiksIHIsIHMsIG8sIGkpKSkuY2F0Y2goKGUgPT4ge1xuICAgICAgICAgICAgdGhyb3cgXCJGaXJlYmFzZUVycm9yXCIgPT09IGUubmFtZSA/IChlLmNvZGUgPT09IE4uVU5BVVRIRU5USUNBVEVEICYmICh0aGlzLmF1dGhDcmVkZW50aWFscy5pbnZhbGlkYXRlVG9rZW4oKSwgXG4gICAgICAgICAgICB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHMuaW52YWxpZGF0ZVRva2VuKCkpLCBlKSA6IG5ldyBGaXJlc3RvcmVFcnJvcihOLlVOS05PV04sIGUudG9TdHJpbmcoKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdGVybWluYXRlKCkge1xuICAgICAgICB0aGlzLmlhID0gITAsIHRoaXMuY29ubmVjdGlvbi50ZXJtaW5hdGUoKTtcbiAgICB9XG59XG5cbi8vIFRPRE8oZmlyZXN0b3JleHApOiBNYWtlIHN1cmUgdGhlcmUgaXMgb25seSBvbmUgRGF0YXN0b3JlIGluc3RhbmNlIHBlclxuLy8gZmlyZXN0b3JlLWV4cCBjbGllbnQuXG4vKipcbiAqIEEgY29tcG9uZW50IHVzZWQgYnkgdGhlIFJlbW90ZVN0b3JlIHRvIHRyYWNrIHRoZSBPbmxpbmVTdGF0ZSAodGhhdCBpcyxcbiAqIHdoZXRoZXIgb3Igbm90IHRoZSBjbGllbnQgYXMgYSB3aG9sZSBzaG91bGQgYmUgY29uc2lkZXJlZCB0byBiZSBvbmxpbmUgb3JcbiAqIG9mZmxpbmUpLCBpbXBsZW1lbnRpbmcgdGhlIGFwcHJvcHJpYXRlIGhldXJpc3RpY3MuXG4gKlxuICogSW4gcGFydGljdWxhciwgd2hlbiB0aGUgY2xpZW50IGlzIHRyeWluZyB0byBjb25uZWN0IHRvIHRoZSBiYWNrZW5kLCB3ZVxuICogYWxsb3cgdXAgdG8gTUFYX1dBVENIX1NUUkVBTV9GQUlMVVJFUyB3aXRoaW4gT05MSU5FX1NUQVRFX1RJTUVPVVRfTVMgZm9yXG4gKiBhIGNvbm5lY3Rpb24gdG8gc3VjY2VlZC4gSWYgd2UgaGF2ZSB0b28gbWFueSBmYWlsdXJlcyBvciB0aGUgdGltZW91dCBlbGFwc2VzLFxuICogdGhlbiB3ZSBzZXQgdGhlIE9ubGluZVN0YXRlIHRvIE9mZmxpbmUsIGFuZCB0aGUgY2xpZW50IHdpbGwgYmVoYXZlIGFzIGlmXG4gKiBpdCBpcyBvZmZsaW5lIChnZXQoKXMgd2lsbCByZXR1cm4gY2FjaGVkIGRhdGEsIGV0Yy4pLlxuICovXG5jbGFzcyBfX1BSSVZBVEVfT25saW5lU3RhdGVUcmFja2VyIHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0KSB7XG4gICAgICAgIHRoaXMuYXN5bmNRdWV1ZSA9IGUsIHRoaXMub25saW5lU3RhdGVIYW5kbGVyID0gdCwgXG4gICAgICAgIC8qKiBUaGUgY3VycmVudCBPbmxpbmVTdGF0ZS4gKi9cbiAgICAgICAgdGhpcy5zdGF0ZSA9IFwiVW5rbm93blwiIC8qIE9ubGluZVN0YXRlLlVua25vd24gKi8gLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgY291bnQgb2YgY29uc2VjdXRpdmUgZmFpbHVyZXMgdG8gb3BlbiB0aGUgc3RyZWFtLiBJZiBpdCByZWFjaGVzIHRoZVxuICAgICAgICAgKiBtYXhpbXVtIGRlZmluZWQgYnkgTUFYX1dBVENIX1NUUkVBTV9GQUlMVVJFUywgd2UnbGwgc2V0IHRoZSBPbmxpbmVTdGF0ZSB0b1xuICAgICAgICAgKiBPZmZsaW5lLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vYSA9IDAsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSB0aW1lciB0aGF0IGVsYXBzZXMgYWZ0ZXIgT05MSU5FX1NUQVRFX1RJTUVPVVRfTVMsIGF0IHdoaWNoIHBvaW50IHdlXG4gICAgICAgICAqIHRyYW5zaXRpb24gZnJvbSBPbmxpbmVTdGF0ZS5Vbmtub3duIHRvIE9ubGluZVN0YXRlLk9mZmxpbmUgd2l0aG91dCB3YWl0aW5nXG4gICAgICAgICAqIGZvciB0aGUgc3RyZWFtIHRvIGFjdHVhbGx5IGZhaWwgKE1BWF9XQVRDSF9TVFJFQU1fRkFJTFVSRVMgdGltZXMpLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fYSA9IG51bGwsIFxuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciB0aGUgY2xpZW50IHNob3VsZCBsb2cgYSB3YXJuaW5nIG1lc3NhZ2UgaWYgaXQgZmFpbHMgdG8gY29ubmVjdCB0b1xuICAgICAgICAgKiB0aGUgYmFja2VuZCAoaW5pdGlhbGx5IHRydWUsIGNsZWFyZWQgYWZ0ZXIgYSBzdWNjZXNzZnVsIHN0cmVhbSwgb3IgaWYgd2UndmVcbiAgICAgICAgICogbG9nZ2VkIHRoZSBtZXNzYWdlIGFscmVhZHkpLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5hYSA9ICEwO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgYnkgUmVtb3RlU3RvcmUgd2hlbiBhIHdhdGNoIHN0cmVhbSBpcyBzdGFydGVkIChpbmNsdWRpbmcgb24gZWFjaFxuICAgICAqIGJhY2tvZmYgYXR0ZW1wdCkuXG4gICAgICpcbiAgICAgKiBJZiB0aGlzIGlzIHRoZSBmaXJzdCBhdHRlbXB0LCBpdCBzZXRzIHRoZSBPbmxpbmVTdGF0ZSB0byBVbmtub3duIGFuZCBzdGFydHNcbiAgICAgKiB0aGUgb25saW5lU3RhdGVUaW1lci5cbiAgICAgKi8gICAgdWEoKSB7XG4gICAgICAgIDAgPT09IHRoaXMub2EgJiYgKHRoaXMuY2EoXCJVbmtub3duXCIgLyogT25saW5lU3RhdGUuVW5rbm93biAqLyksIHRoaXMuX2EgPSB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFmdGVyRGVsYXkoXCJvbmxpbmVfc3RhdGVfdGltZW91dFwiIC8qIFRpbWVySWQuT25saW5lU3RhdGVUaW1lb3V0ICovICwgMWU0LCAoKCkgPT4gKHRoaXMuX2EgPSBudWxsLCBcbiAgICAgICAgdGhpcy5sYShcIkJhY2tlbmQgZGlkbid0IHJlc3BvbmQgd2l0aGluIDEwIHNlY29uZHMuXCIpLCB0aGlzLmNhKFwiT2ZmbGluZVwiIC8qIE9ubGluZVN0YXRlLk9mZmxpbmUgKi8pLCBcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkpKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIG91ciBPbmxpbmVTdGF0ZSBhcyBhcHByb3ByaWF0ZSBhZnRlciB0aGUgd2F0Y2ggc3RyZWFtIHJlcG9ydHMgYVxuICAgICAqIGZhaWx1cmUuIFRoZSBmaXJzdCBmYWlsdXJlIG1vdmVzIHVzIHRvIHRoZSAnVW5rbm93bicgc3RhdGUuIFdlIHRoZW4gbWF5XG4gICAgICogYWxsb3cgbXVsdGlwbGUgZmFpbHVyZXMgKGJhc2VkIG9uIE1BWF9XQVRDSF9TVFJFQU1fRkFJTFVSRVMpIGJlZm9yZSB3ZVxuICAgICAqIGFjdHVhbGx5IHRyYW5zaXRpb24gdG8gdGhlICdPZmZsaW5lJyBzdGF0ZS5cbiAgICAgKi8gICAgaGEoZSkge1xuICAgICAgICBcIk9ubGluZVwiIC8qIE9ubGluZVN0YXRlLk9ubGluZSAqLyA9PT0gdGhpcy5zdGF0ZSA/IHRoaXMuY2EoXCJVbmtub3duXCIgLyogT25saW5lU3RhdGUuVW5rbm93biAqLykgOiAodGhpcy5vYSsrLCBcbiAgICAgICAgdGhpcy5vYSA+PSAxICYmICh0aGlzLlBhKCksIHRoaXMubGEoYENvbm5lY3Rpb24gZmFpbGVkIDEgdGltZXMuIE1vc3QgcmVjZW50IGVycm9yOiAke2UudG9TdHJpbmcoKX1gKSwgXG4gICAgICAgIHRoaXMuY2EoXCJPZmZsaW5lXCIgLyogT25saW5lU3RhdGUuT2ZmbGluZSAqLykpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRXhwbGljaXRseSBzZXRzIHRoZSBPbmxpbmVTdGF0ZSB0byB0aGUgc3BlY2lmaWVkIHN0YXRlLlxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IHRoaXMgcmVzZXRzIG91ciB0aW1lcnMgLyBmYWlsdXJlIGNvdW50ZXJzLCBldGMuIHVzZWQgYnkgb3VyXG4gICAgICogT2ZmbGluZSBoZXVyaXN0aWNzLCBzbyBtdXN0IG5vdCBiZSB1c2VkIGluIHBsYWNlIG9mXG4gICAgICogaGFuZGxlV2F0Y2hTdHJlYW1TdGFydCgpIGFuZCBoYW5kbGVXYXRjaFN0cmVhbUZhaWx1cmUoKS5cbiAgICAgKi8gICAgc2V0KGUpIHtcbiAgICAgICAgdGhpcy5QYSgpLCB0aGlzLm9hID0gMCwgXCJPbmxpbmVcIiAvKiBPbmxpbmVTdGF0ZS5PbmxpbmUgKi8gPT09IGUgJiYgKFxuICAgICAgICAvLyBXZSd2ZSBjb25uZWN0ZWQgdG8gd2F0Y2ggYXQgbGVhc3Qgb25jZS4gRG9uJ3Qgd2FybiB0aGUgZGV2ZWxvcGVyXG4gICAgICAgIC8vIGFib3V0IGJlaW5nIG9mZmxpbmUgZ29pbmcgZm9yd2FyZC5cbiAgICAgICAgdGhpcy5hYSA9ICExKSwgdGhpcy5jYShlKTtcbiAgICB9XG4gICAgY2EoZSkge1xuICAgICAgICBlICE9PSB0aGlzLnN0YXRlICYmICh0aGlzLnN0YXRlID0gZSwgdGhpcy5vbmxpbmVTdGF0ZUhhbmRsZXIoZSkpO1xuICAgIH1cbiAgICBsYShlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBgQ291bGQgbm90IHJlYWNoIENsb3VkIEZpcmVzdG9yZSBiYWNrZW5kLiAke2V9XFxuVGhpcyB0eXBpY2FsbHkgaW5kaWNhdGVzIHRoYXQgeW91ciBkZXZpY2UgZG9lcyBub3QgaGF2ZSBhIGhlYWx0aHkgSW50ZXJuZXQgY29ubmVjdGlvbiBhdCB0aGUgbW9tZW50LiBUaGUgY2xpZW50IHdpbGwgb3BlcmF0ZSBpbiBvZmZsaW5lIG1vZGUgdW50aWwgaXQgaXMgYWJsZSB0byBzdWNjZXNzZnVsbHkgY29ubmVjdCB0byB0aGUgYmFja2VuZC5gO1xuICAgICAgICB0aGlzLmFhID8gKF9fUFJJVkFURV9sb2dFcnJvcih0KSwgdGhpcy5hYSA9ICExKSA6IF9fUFJJVkFURV9sb2dEZWJ1ZyhcIk9ubGluZVN0YXRlVHJhY2tlclwiLCB0KTtcbiAgICB9XG4gICAgUGEoKSB7XG4gICAgICAgIG51bGwgIT09IHRoaXMuX2EgJiYgKHRoaXMuX2EuY2FuY2VsKCksIHRoaXMuX2EgPSBudWxsKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IHRuID0gXCJSZW1vdGVTdG9yZVwiO1xuXG4vLyBUT0RPKGIvMzU4NTM0MDIpOiBOZWdvdGlhdGUgdGhpcyB3aXRoIHRoZSBzdHJlYW0uXG5jbGFzcyBfX1BSSVZBVEVfUmVtb3RlU3RvcmVJbXBsIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgbG9jYWwgc3RvcmUsIHVzZWQgdG8gZmlsbCB0aGUgd3JpdGUgcGlwZWxpbmUgd2l0aCBvdXRib3VuZCBtdXRhdGlvbnMuXG4gICAgICovXG4gICAgZSwgXG4gICAgLyoqIFRoZSBjbGllbnQtc2lkZSBwcm94eSBmb3IgaW50ZXJhY3Rpbmcgd2l0aCB0aGUgYmFja2VuZC4gKi9cbiAgICB0LCBuLCByLCBpKSB7XG4gICAgICAgIHRoaXMubG9jYWxTdG9yZSA9IGUsIHRoaXMuZGF0YXN0b3JlID0gdCwgdGhpcy5hc3luY1F1ZXVlID0gbiwgdGhpcy5yZW1vdGVTeW5jZXIgPSB7fSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGxpc3Qgb2YgdXAgdG8gTUFYX1BFTkRJTkdfV1JJVEVTIHdyaXRlcyB0aGF0IHdlIGhhdmUgZmV0Y2hlZCBmcm9tIHRoZVxuICAgICAgICAgKiBMb2NhbFN0b3JlIHZpYSBmaWxsV3JpdGVQaXBlbGluZSgpIGFuZCBoYXZlIG9yIHdpbGwgc2VuZCB0byB0aGUgd3JpdGVcbiAgICAgICAgICogc3RyZWFtLlxuICAgICAgICAgKlxuICAgICAgICAgKiBXaGVuZXZlciB3cml0ZVBpcGVsaW5lLmxlbmd0aCA+IDAgdGhlIFJlbW90ZVN0b3JlIHdpbGwgYXR0ZW1wdCB0byBzdGFydCBvclxuICAgICAgICAgKiByZXN0YXJ0IHRoZSB3cml0ZSBzdHJlYW0uIFdoZW4gdGhlIHN0cmVhbSBpcyBlc3RhYmxpc2hlZCB0aGUgd3JpdGVzIGluIHRoZVxuICAgICAgICAgKiBwaXBlbGluZSB3aWxsIGJlIHNlbnQgaW4gb3JkZXIuXG4gICAgICAgICAqXG4gICAgICAgICAqIFdyaXRlcyByZW1haW4gaW4gd3JpdGVQaXBlbGluZSB1bnRpbCB0aGV5IGFyZSBhY2tub3dsZWRnZWQgYnkgdGhlIGJhY2tlbmRcbiAgICAgICAgICogYW5kIHRodXMgd2lsbCBhdXRvbWF0aWNhbGx5IGJlIHJlLXNlbnQgaWYgdGhlIHN0cmVhbSBpcyBpbnRlcnJ1cHRlZCAvXG4gICAgICAgICAqIHJlc3RhcnRlZCBiZWZvcmUgdGhleSdyZSBhY2tub3dsZWRnZWQuXG4gICAgICAgICAqXG4gICAgICAgICAqIFdyaXRlIHJlc3BvbnNlcyBmcm9tIHRoZSBiYWNrZW5kIGFyZSBsaW5rZWQgdG8gdGhlaXIgb3JpZ2luYXRpbmcgcmVxdWVzdFxuICAgICAgICAgKiBwdXJlbHkgYmFzZWQgb24gb3JkZXIsIGFuZCBzbyB3ZSBjYW4ganVzdCBzaGlmdCgpIHdyaXRlcyBmcm9tIHRoZSBmcm9udCBvZlxuICAgICAgICAgKiB0aGUgd3JpdGVQaXBlbGluZSBhcyB3ZSByZWNlaXZlIHJlc3BvbnNlcy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuVGEgPSBbXSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIG1hcHBpbmcgb2Ygd2F0Y2hlZCB0YXJnZXRzIHRoYXQgdGhlIGNsaWVudCBjYXJlcyBhYm91dCB0cmFja2luZyBhbmQgdGhlXG4gICAgICAgICAqIHVzZXIgaGFzIGV4cGxpY2l0bHkgY2FsbGVkIGEgJ2xpc3RlbicgZm9yIHRoaXMgdGFyZ2V0LlxuICAgICAgICAgKlxuICAgICAgICAgKiBUaGVzZSB0YXJnZXRzIG1heSBvciBtYXkgbm90IGhhdmUgYmVlbiBzZW50IHRvIG9yIGFja25vd2xlZGdlZCBieSB0aGVcbiAgICAgICAgICogc2VydmVyLiBPbiByZS1lc3RhYmxpc2hpbmcgdGhlIGxpc3RlbiBzdHJlYW0sIHRoZXNlIHRhcmdldHMgc2hvdWxkIGJlIHNlbnRcbiAgICAgICAgICogdG8gdGhlIHNlcnZlci4gVGhlIHRhcmdldHMgcmVtb3ZlZCB3aXRoIHVubGlzdGVucyBhcmUgcmVtb3ZlZCBlYWdlcmx5XG4gICAgICAgICAqIHdpdGhvdXQgd2FpdGluZyBmb3IgY29uZmlybWF0aW9uIGZyb20gdGhlIGxpc3RlbiBzdHJlYW0uXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLklhID0gbmV3IE1hcCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIHNldCBvZiByZWFzb25zIGZvciB3aHkgdGhlIFJlbW90ZVN0b3JlIG1heSBiZSBvZmZsaW5lLiBJZiBlbXB0eSwgdGhlXG4gICAgICAgICAqIFJlbW90ZVN0b3JlIG1heSBzdGFydCBpdHMgbmV0d29yayBjb25uZWN0aW9ucy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuRWEgPSBuZXcgU2V0LCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEV2ZW50IGhhbmRsZXJzIHRoYXQgZ2V0IGNhbGxlZCB3aGVuIHRoZSBuZXR3b3JrIGlzIGRpc2FibGVkIG9yIGVuYWJsZWQuXG4gICAgICAgICAqXG4gICAgICAgICAqIFBPUlRJTkcgTk9URTogVGhlc2UgZnVuY3Rpb25zIGFyZSB1c2VkIG9uIHRoZSBXZWIgY2xpZW50IHRvIGNyZWF0ZSB0aGVcbiAgICAgICAgICogdW5kZXJseWluZyBzdHJlYW1zICh0byBzdXBwb3J0IHRyZWUtc2hha2VhYmxlIHN0cmVhbXMpLiBPbiBBbmRyb2lkIGFuZCBpT1MsXG4gICAgICAgICAqIHRoZSBzdHJlYW1zIGFyZSBjcmVhdGVkIGR1cmluZyBjb25zdHJ1Y3Rpb24gb2YgUmVtb3RlU3RvcmUuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRhID0gW10sIHRoaXMuQWEgPSBpLCB0aGlzLkFhLk9vKChlID0+IHtcbiAgICAgICAgICAgIG4uZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIFBvcnRpbmcgTm90ZTogVW5saWtlIGlPUywgYHJlc3RhcnROZXR3b3JrKClgIGlzIGNhbGxlZCBldmVuIHdoZW4gdGhlXG4gICAgICAgICAgICAgICAgLy8gbmV0d29yayBiZWNvbWVzIHVucmVhY2hhYmxlIGFzIHdlIGRvbid0IGhhdmUgYW55IG90aGVyIHdheSB0byB0ZWFyXG4gICAgICAgICAgICAgICAgLy8gZG93biBvdXIgc3RyZWFtcy5cbiAgICAgICAgICAgICAgICBfX1BSSVZBVEVfY2FuVXNlTmV0d29yayh0aGlzKSAmJiAoX19QUklWQVRFX2xvZ0RlYnVnKHRuLCBcIlJlc3RhcnRpbmcgc3RyZWFtcyBmb3IgbmV0d29yayByZWFjaGFiaWxpdHkgY2hhbmdlLlwiKSwgXG4gICAgICAgICAgICAgICAgYXdhaXQgYXN5bmMgZnVuY3Rpb24gX19QUklWQVRFX3Jlc3RhcnROZXR3b3JrKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgICAgICAgICAgICAgICAgIHQuRWEuYWRkKDQgLyogT2ZmbGluZUNhdXNlLkNvbm5lY3Rpdml0eUNoYW5nZSAqLyksIGF3YWl0IF9fUFJJVkFURV9kaXNhYmxlTmV0d29ya0ludGVybmFsKHQpLCBcbiAgICAgICAgICAgICAgICAgICAgdC5SYS5zZXQoXCJVbmtub3duXCIgLyogT25saW5lU3RhdGUuVW5rbm93biAqLyksIHQuRWEuZGVsZXRlKDQgLyogT2ZmbGluZUNhdXNlLkNvbm5lY3Rpdml0eUNoYW5nZSAqLyksIFxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBfX1BSSVZBVEVfZW5hYmxlTmV0d29ya0ludGVybmFsKHQpO1xuICAgICAgICAgICAgICAgIH0odGhpcykpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSksIHRoaXMuUmEgPSBuZXcgX19QUklWQVRFX09ubGluZVN0YXRlVHJhY2tlcihuLCByKTtcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIF9fUFJJVkFURV9lbmFibGVOZXR3b3JrSW50ZXJuYWwoZSkge1xuICAgIGlmIChfX1BSSVZBVEVfY2FuVXNlTmV0d29yayhlKSkgZm9yIChjb25zdCB0IG9mIGUuZGEpIGF3YWl0IHQoLyogZW5hYmxlZD0gKi8gITApO1xufVxuXG4vKipcbiAqIFRlbXBvcmFyaWx5IGRpc2FibGVzIHRoZSBuZXR3b3JrLiBUaGUgbmV0d29yayBjYW4gYmUgcmUtZW5hYmxlZCB1c2luZ1xuICogZW5hYmxlTmV0d29yaygpLlxuICovIGFzeW5jIGZ1bmN0aW9uIF9fUFJJVkFURV9kaXNhYmxlTmV0d29ya0ludGVybmFsKGUpIHtcbiAgICBmb3IgKGNvbnN0IHQgb2YgZS5kYSkgYXdhaXQgdCgvKiBlbmFibGVkPSAqLyAhMSk7XG59XG5cbi8qKlxuICogU3RhcnRzIG5ldyBsaXN0ZW4gZm9yIHRoZSBnaXZlbiB0YXJnZXQuIFVzZXMgcmVzdW1lIHRva2VuIGlmIHByb3ZpZGVkLiBJdFxuICogaXMgYSBuby1vcCBpZiB0aGUgdGFyZ2V0IG9mIGdpdmVuIGBUYXJnZXREYXRhYCBpcyBhbHJlYWR5IGJlaW5nIGxpc3RlbmVkIHRvLlxuICovXG5mdW5jdGlvbiBfX1BSSVZBVEVfcmVtb3RlU3RvcmVMaXN0ZW4oZSwgdCkge1xuICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpO1xuICAgIG4uSWEuaGFzKHQudGFyZ2V0SWQpIHx8IChcbiAgICAvLyBNYXJrIHRoaXMgYXMgc29tZXRoaW5nIHRoZSBjbGllbnQgaXMgY3VycmVudGx5IGxpc3RlbmluZyBmb3IuXG4gICAgbi5JYS5zZXQodC50YXJnZXRJZCwgdCksIF9fUFJJVkFURV9zaG91bGRTdGFydFdhdGNoU3RyZWFtKG4pID8gXG4gICAgLy8gVGhlIGxpc3RlbiB3aWxsIGJlIHNlbnQgaW4gb25XYXRjaFN0cmVhbU9wZW5cbiAgICBfX1BSSVZBVEVfc3RhcnRXYXRjaFN0cmVhbShuKSA6IF9fUFJJVkFURV9lbnN1cmVXYXRjaFN0cmVhbShuKS5PXygpICYmIF9fUFJJVkFURV9zZW5kV2F0Y2hSZXF1ZXN0KG4sIHQpKTtcbn1cblxuLyoqXG4gKiBSZW1vdmVzIHRoZSBsaXN0ZW4gZnJvbSBzZXJ2ZXIuIEl0IGlzIGEgbm8tb3AgaWYgdGhlIGdpdmVuIHRhcmdldCBpZCBpc1xuICogbm90IGJlaW5nIGxpc3RlbmVkIHRvLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9yZW1vdGVTdG9yZVVubGlzdGVuKGUsIHQpIHtcbiAgICBjb25zdCBuID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKSwgciA9IF9fUFJJVkFURV9lbnN1cmVXYXRjaFN0cmVhbShuKTtcbiAgICBuLklhLmRlbGV0ZSh0KSwgci5PXygpICYmIF9fUFJJVkFURV9zZW5kVW53YXRjaFJlcXVlc3QobiwgdCksIDAgPT09IG4uSWEuc2l6ZSAmJiAoci5PXygpID8gci5MXygpIDogX19QUklWQVRFX2NhblVzZU5ldHdvcmsobikgJiYgXG4gICAgLy8gUmV2ZXJ0IHRvIE9ubGluZVN0YXRlLlVua25vd24gaWYgdGhlIHdhdGNoIHN0cmVhbSBpcyBub3Qgb3BlbiBhbmQgd2VcbiAgICAvLyBoYXZlIG5vIGxpc3RlbmVycywgc2luY2Ugd2l0aG91dCBhbnkgbGlzdGVucyB0byBzZW5kIHdlIGNhbm5vdFxuICAgIC8vIGNvbmZpcm0gaWYgdGhlIHN0cmVhbSBpcyBoZWFsdGh5IGFuZCB1cGdyYWRlIHRvIE9ubGluZVN0YXRlLk9ubGluZS5cbiAgICBuLlJhLnNldChcIlVua25vd25cIiAvKiBPbmxpbmVTdGF0ZS5Vbmtub3duICovKSk7XG59XG5cbi8qKlxuICogV2UgbmVlZCB0byBpbmNyZW1lbnQgdGhlIGV4cGVjdGVkIG51bWJlciBvZiBwZW5kaW5nIHJlc3BvbnNlcyB3ZSdyZSBkdWVcbiAqIGZyb20gd2F0Y2ggc28gd2Ugd2FpdCBmb3IgdGhlIGFjayB0byBwcm9jZXNzIGFueSBtZXNzYWdlcyBmcm9tIHRoaXMgdGFyZ2V0LlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9zZW5kV2F0Y2hSZXF1ZXN0KGUsIHQpIHtcbiAgICBpZiAoZS5WYS5VZSh0LnRhcmdldElkKSwgdC5yZXN1bWVUb2tlbi5hcHByb3hpbWF0ZUJ5dGVTaXplKCkgPiAwIHx8IHQuc25hcHNob3RWZXJzaW9uLmNvbXBhcmVUbyhTbmFwc2hvdFZlcnNpb24ubWluKCkpID4gMCkge1xuICAgICAgICBjb25zdCBuID0gZS5yZW1vdGVTeW5jZXIuZ2V0UmVtb3RlS2V5c0ZvclRhcmdldCh0LnRhcmdldElkKS5zaXplO1xuICAgICAgICB0ID0gdC53aXRoRXhwZWN0ZWRDb3VudChuKTtcbiAgICB9XG4gICAgX19QUklWQVRFX2Vuc3VyZVdhdGNoU3RyZWFtKGUpLllfKHQpO1xufVxuXG4vKipcbiAqIFdlIG5lZWQgdG8gaW5jcmVtZW50IHRoZSBleHBlY3RlZCBudW1iZXIgb2YgcGVuZGluZyByZXNwb25zZXMgd2UncmUgZHVlXG4gKiBmcm9tIHdhdGNoIHNvIHdlIHdhaXQgZm9yIHRoZSByZW1vdmFsIG9uIHRoZSBzZXJ2ZXIgYmVmb3JlIHdlIHByb2Nlc3MgYW55XG4gKiBtZXNzYWdlcyBmcm9tIHRoaXMgdGFyZ2V0LlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9zZW5kVW53YXRjaFJlcXVlc3QoZSwgdCkge1xuICAgIGUuVmEuVWUodCksIF9fUFJJVkFURV9lbnN1cmVXYXRjaFN0cmVhbShlKS5aXyh0KTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX3N0YXJ0V2F0Y2hTdHJlYW0oZSkge1xuICAgIGUuVmEgPSBuZXcgX19QUklWQVRFX1dhdGNoQ2hhbmdlQWdncmVnYXRvcih7XG4gICAgICAgIGdldFJlbW90ZUtleXNGb3JUYXJnZXQ6IHQgPT4gZS5yZW1vdGVTeW5jZXIuZ2V0UmVtb3RlS2V5c0ZvclRhcmdldCh0KSxcbiAgICAgICAgQXQ6IHQgPT4gZS5JYS5nZXQodCkgfHwgbnVsbCxcbiAgICAgICAgaHQ6ICgpID0+IGUuZGF0YXN0b3JlLnNlcmlhbGl6ZXIuZGF0YWJhc2VJZFxuICAgIH0pLCBfX1BSSVZBVEVfZW5zdXJlV2F0Y2hTdHJlYW0oZSkuc3RhcnQoKSwgZS5SYS51YSgpO1xufVxuXG4vKipcbiAqIFJldHVybnMgd2hldGhlciB0aGUgd2F0Y2ggc3RyZWFtIHNob3VsZCBiZSBzdGFydGVkIGJlY2F1c2UgaXQncyBuZWNlc3NhcnlcbiAqIGFuZCBoYXMgbm90IHlldCBiZWVuIHN0YXJ0ZWQuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX3Nob3VsZFN0YXJ0V2F0Y2hTdHJlYW0oZSkge1xuICAgIHJldHVybiBfX1BSSVZBVEVfY2FuVXNlTmV0d29yayhlKSAmJiAhX19QUklWQVRFX2Vuc3VyZVdhdGNoU3RyZWFtKGUpLnhfKCkgJiYgZS5JYS5zaXplID4gMDtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2NhblVzZU5ldHdvcmsoZSkge1xuICAgIHJldHVybiAwID09PSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpLkVhLnNpemU7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9jbGVhblVwV2F0Y2hTdHJlYW1TdGF0ZShlKSB7XG4gICAgZS5WYSA9IHZvaWQgMDtcbn1cblxuYXN5bmMgZnVuY3Rpb24gX19QUklWQVRFX29uV2F0Y2hTdHJlYW1Db25uZWN0ZWQoZSkge1xuICAgIC8vIE1hcmsgdGhlIGNsaWVudCBhcyBvbmxpbmUgc2luY2Ugd2UgZ290IGEgXCJjb25uZWN0ZWRcIiBub3RpZmljYXRpb24uXG4gICAgZS5SYS5zZXQoXCJPbmxpbmVcIiAvKiBPbmxpbmVTdGF0ZS5PbmxpbmUgKi8pO1xufVxuXG5hc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfb25XYXRjaFN0cmVhbU9wZW4oZSkge1xuICAgIGUuSWEuZm9yRWFjaCgoKHQsIG4pID0+IHtcbiAgICAgICAgX19QUklWQVRFX3NlbmRXYXRjaFJlcXVlc3QoZSwgdCk7XG4gICAgfSkpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfb25XYXRjaFN0cmVhbUNsb3NlKGUsIHQpIHtcbiAgICBfX1BSSVZBVEVfY2xlYW5VcFdhdGNoU3RyZWFtU3RhdGUoZSksIFxuICAgIC8vIElmIHdlIHN0aWxsIG5lZWQgdGhlIHdhdGNoIHN0cmVhbSwgcmV0cnkgdGhlIGNvbm5lY3Rpb24uXG4gICAgX19QUklWQVRFX3Nob3VsZFN0YXJ0V2F0Y2hTdHJlYW0oZSkgPyAoZS5SYS5oYSh0KSwgX19QUklWQVRFX3N0YXJ0V2F0Y2hTdHJlYW0oZSkpIDogXG4gICAgLy8gTm8gbmVlZCB0byByZXN0YXJ0IHdhdGNoIHN0cmVhbSBiZWNhdXNlIHRoZXJlIGFyZSBubyBhY3RpdmUgdGFyZ2V0cy5cbiAgICAvLyBUaGUgb25saW5lIHN0YXRlIGlzIHNldCB0byB1bmtub3duIGJlY2F1c2UgdGhlcmUgaXMgbm8gYWN0aXZlIGF0dGVtcHRcbiAgICAvLyBhdCBlc3RhYmxpc2hpbmcgYSBjb25uZWN0aW9uXG4gICAgZS5SYS5zZXQoXCJVbmtub3duXCIgLyogT25saW5lU3RhdGUuVW5rbm93biAqLyk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIF9fUFJJVkFURV9vbldhdGNoU3RyZWFtQ2hhbmdlKGUsIHQsIG4pIHtcbiAgICBpZiAoXG4gICAgLy8gTWFyayB0aGUgY2xpZW50IGFzIG9ubGluZSBzaW5jZSB3ZSBnb3QgYSBtZXNzYWdlIGZyb20gdGhlIHNlcnZlclxuICAgIGUuUmEuc2V0KFwiT25saW5lXCIgLyogT25saW5lU3RhdGUuT25saW5lICovKSwgdCBpbnN0YW5jZW9mIF9fUFJJVkFURV9XYXRjaFRhcmdldENoYW5nZSAmJiAyIC8qIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuUmVtb3ZlZCAqLyA9PT0gdC5zdGF0ZSAmJiB0LmNhdXNlKSBcbiAgICAvLyBUaGVyZSB3YXMgYW4gZXJyb3Igb24gYSB0YXJnZXQsIGRvbid0IHdhaXQgZm9yIGEgY29uc2lzdGVudCBzbmFwc2hvdFxuICAgIC8vIHRvIHJhaXNlIGV2ZW50c1xuICAgIHRyeSB7XG4gICAgICAgIC8qKiBIYW5kbGVzIGFuIGVycm9yIG9uIGEgdGFyZ2V0ICovXG4gICAgICAgIGF3YWl0IGFzeW5jIGZ1bmN0aW9uIF9fUFJJVkFURV9oYW5kbGVUYXJnZXRFcnJvcihlLCB0KSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdC5jYXVzZTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgciBvZiB0LnRhcmdldElkcykgXG4gICAgICAgICAgICAvLyBBIHdhdGNoZWQgdGFyZ2V0IG1pZ2h0IGhhdmUgYmVlbiByZW1vdmVkIGFscmVhZHkuXG4gICAgICAgICAgICBlLklhLmhhcyhyKSAmJiAoYXdhaXQgZS5yZW1vdGVTeW5jZXIucmVqZWN0TGlzdGVuKHIsIG4pLCBlLklhLmRlbGV0ZShyKSwgZS5WYS5yZW1vdmVUYXJnZXQocikpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogQXR0ZW1wdHMgdG8gZmlsbCBvdXIgd3JpdGUgcGlwZWxpbmUgd2l0aCB3cml0ZXMgZnJvbSB0aGUgTG9jYWxTdG9yZS5cbiAqXG4gKiBDYWxsZWQgaW50ZXJuYWxseSB0byBib290c3RyYXAgb3IgcmVmaWxsIHRoZSB3cml0ZSBwaXBlbGluZSBhbmQgYnlcbiAqIFN5bmNFbmdpbmUgd2hlbmV2ZXIgdGhlcmUgYXJlIG5ldyBtdXRhdGlvbnMgdG8gcHJvY2Vzcy5cbiAqXG4gKiBTdGFydHMgdGhlIHdyaXRlIHN0cmVhbSBpZiBuZWNlc3NhcnkuXG4gKi8gKGUsIHQpO1xuICAgIH0gY2F0Y2ggKG4pIHtcbiAgICAgICAgX19QUklWQVRFX2xvZ0RlYnVnKHRuLCBcIkZhaWxlZCB0byByZW1vdmUgdGFyZ2V0cyAlczogJXMgXCIsIHQudGFyZ2V0SWRzLmpvaW4oXCIsXCIpLCBuKSwgXG4gICAgICAgIGF3YWl0IF9fUFJJVkFURV9kaXNhYmxlTmV0d29ya1VudGlsUmVjb3ZlcnkoZSwgbik7XG4gICAgfSBlbHNlIGlmICh0IGluc3RhbmNlb2YgX19QUklWQVRFX0RvY3VtZW50V2F0Y2hDaGFuZ2UgPyBlLlZhLlplKHQpIDogdCBpbnN0YW5jZW9mIF9fUFJJVkFURV9FeGlzdGVuY2VGaWx0ZXJDaGFuZ2UgPyBlLlZhLnN0KHQpIDogZS5WYS50dCh0KSwgXG4gICAgIW4uaXNFcXVhbChTbmFwc2hvdFZlcnNpb24ubWluKCkpKSB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgX19QUklWQVRFX2xvY2FsU3RvcmVHZXRMYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKGUubG9jYWxTdG9yZSk7XG4gICAgICAgIG4uY29tcGFyZVRvKHQpID49IDAgJiYgXG4gICAgICAgIC8vIFdlIGhhdmUgcmVjZWl2ZWQgYSB0YXJnZXQgY2hhbmdlIHdpdGggYSBnbG9iYWwgc25hcHNob3QgaWYgdGhlIHNuYXBzaG90XG4gICAgICAgIC8vIHZlcnNpb24gaXMgbm90IGVxdWFsIHRvIFNuYXBzaG90VmVyc2lvbi5taW4oKS5cbiAgICAgICAgLyoqXG4gKiBUYWtlcyBhIGJhdGNoIG9mIGNoYW5nZXMgZnJvbSB0aGUgRGF0YXN0b3JlLCByZXBhY2thZ2VzIHRoZW0gYXMgYVxuICogUmVtb3RlRXZlbnQsIGFuZCBwYXNzZXMgdGhhdCBvbiB0byB0aGUgbGlzdGVuZXIsIHdoaWNoIGlzIHR5cGljYWxseSB0aGVcbiAqIFN5bmNFbmdpbmUuXG4gKi9cbiAgICAgICAgYXdhaXQgZnVuY3Rpb24gX19QUklWQVRFX3JhaXNlV2F0Y2hTbmFwc2hvdChlLCB0KSB7XG4gICAgICAgICAgICBjb25zdCBuID0gZS5WYS5UdCh0KTtcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBpbi1tZW1vcnkgcmVzdW1lIHRva2Vucy4gTG9jYWxTdG9yZSB3aWxsIHVwZGF0ZSB0aGVcbiAgICAgICAgICAgIC8vIHBlcnNpc3RlbnQgdmlldyBvZiB0aGVzZSB3aGVuIGFwcGx5aW5nIHRoZSBjb21wbGV0ZWQgUmVtb3RlRXZlbnQuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbi50YXJnZXRDaGFuZ2VzLmZvckVhY2goKChuLCByKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKG4ucmVzdW1lVG9rZW4uYXBwcm94aW1hdGVCeXRlU2l6ZSgpID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5JYS5nZXQocik7XG4gICAgICAgICAgICAgICAgICAgIC8vIEEgd2F0Y2hlZCB0YXJnZXQgbWlnaHQgaGF2ZSBiZWVuIHJlbW92ZWQgYWxyZWFkeS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpICYmIGUuSWEuc2V0KHIsIGkud2l0aFJlc3VtZVRva2VuKG4ucmVzdW1lVG9rZW4sIHQpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSksIFxuICAgICAgICAgICAgLy8gUmUtZXN0YWJsaXNoIGxpc3RlbnMgZm9yIHRoZSB0YXJnZXRzIHRoYXQgaGF2ZSBiZWVuIGludmFsaWRhdGVkIGJ5XG4gICAgICAgICAgICAvLyBleGlzdGVuY2UgZmlsdGVyIG1pc21hdGNoZXMuXG4gICAgICAgICAgICBuLnRhcmdldE1pc21hdGNoZXMuZm9yRWFjaCgoKHQsIG4pID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCByID0gZS5JYS5nZXQodCk7XG4gICAgICAgICAgICAgICAgaWYgKCFyKSBcbiAgICAgICAgICAgICAgICAvLyBBIHdhdGNoZWQgdGFyZ2V0IG1pZ2h0IGhhdmUgYmVlbiByZW1vdmVkIGFscmVhZHkuXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIC8vIENsZWFyIHRoZSByZXN1bWUgdG9rZW4gZm9yIHRoZSB0YXJnZXQsIHNpbmNlIHdlJ3JlIGluIGEga25vd24gbWlzbWF0Y2hcbiAgICAgICAgICAgICAgICAvLyBzdGF0ZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5JYS5zZXQodCwgci53aXRoUmVzdW1lVG9rZW4oQnl0ZVN0cmluZy5FTVBUWV9CWVRFX1NUUklORywgci5zbmFwc2hvdFZlcnNpb24pKSwgXG4gICAgICAgICAgICAgICAgLy8gQ2F1c2UgYSBoYXJkIHJlc2V0IGJ5IHVud2F0Y2hpbmcgYW5kIHJld2F0Y2hpbmcgaW1tZWRpYXRlbHksIGJ1dFxuICAgICAgICAgICAgICAgIC8vIGRlbGliZXJhdGVseSBkb24ndCBzZW5kIGEgcmVzdW1lIHRva2VuIHNvIHRoYXQgd2UgZ2V0IGEgZnVsbCB1cGRhdGUuXG4gICAgICAgICAgICAgICAgX19QUklWQVRFX3NlbmRVbndhdGNoUmVxdWVzdChlLCB0KTtcbiAgICAgICAgICAgICAgICAvLyBNYXJrIHRoZSB0YXJnZXQgd2Ugc2VuZCBhcyBiZWluZyBvbiBiZWhhbGYgb2YgYW4gZXhpc3RlbmNlIGZpbHRlclxuICAgICAgICAgICAgICAgIC8vIG1pc21hdGNoLCBidXQgZG9uJ3QgYWN0dWFsbHkgcmV0YWluIHRoYXQgaW4gbGlzdGVuVGFyZ2V0cy4gVGhpcyBlbnN1cmVzXG4gICAgICAgICAgICAgICAgLy8gdGhhdCB3ZSBmbGFnIHRoZSBmaXJzdCByZS1saXN0ZW4gdGhpcyB3YXkgd2l0aG91dCBpbXBhY3RpbmcgZnV0dXJlXG4gICAgICAgICAgICAgICAgLy8gbGlzdGVucyBvZiB0aGlzIHRhcmdldCAodGhhdCBtaWdodCBoYXBwZW4gZS5nLiBvbiByZWNvbm5lY3QpLlxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgVGFyZ2V0RGF0YShyLnRhcmdldCwgdCwgbiwgci5zZXF1ZW5jZU51bWJlcik7XG4gICAgICAgICAgICAgICAgX19QUklWQVRFX3NlbmRXYXRjaFJlcXVlc3QoZSwgaSk7XG4gICAgICAgICAgICB9KSksIGUucmVtb3RlU3luY2VyLmFwcGx5UmVtb3RlRXZlbnQobik7XG4gICAgICAgIH0oZSwgbik7XG4gICAgfSBjYXRjaCAodCkge1xuICAgICAgICBfX1BSSVZBVEVfbG9nRGVidWcodG4sIFwiRmFpbGVkIHRvIHJhaXNlIHNuYXBzaG90OlwiLCB0KSwgYXdhaXQgX19QUklWQVRFX2Rpc2FibGVOZXR3b3JrVW50aWxSZWNvdmVyeShlLCB0KTtcbiAgICB9XG59XG5cbi8qKlxuICogUmVjb3ZlcnkgbG9naWMgZm9yIEluZGV4ZWREQiBlcnJvcnMgdGhhdCB0YWtlcyB0aGUgbmV0d29yayBvZmZsaW5lIHVudGlsXG4gKiBgb3BgIHN1Y2NlZWRzLiBSZXRyaWVzIGFyZSBzY2hlZHVsZWQgd2l0aCBiYWNrb2ZmIHVzaW5nXG4gKiBgZW5xdWV1ZVJldHJ5YWJsZSgpYC4gSWYgYG9wKClgIGlzIG5vdCBwcm92aWRlZCwgSW5kZXhlZERCIGFjY2VzcyBpc1xuICogdmFsaWRhdGVkIHZpYSBhIGdlbmVyaWMgb3BlcmF0aW9uLlxuICpcbiAqIFRoZSByZXR1cm5lZCBQcm9taXNlIGlzIHJlc29sdmVkIG9uY2UgdGhlIG5ldHdvcmsgaXMgZGlzYWJsZWQgYW5kIGJlZm9yZVxuICogYW55IHJldHJ5IGF0dGVtcHQuXG4gKi8gYXN5bmMgZnVuY3Rpb24gX19QUklWQVRFX2Rpc2FibGVOZXR3b3JrVW50aWxSZWNvdmVyeShlLCB0LCBuKSB7XG4gICAgaWYgKCFfX1BSSVZBVEVfaXNJbmRleGVkRGJUcmFuc2FjdGlvbkVycm9yKHQpKSB0aHJvdyB0O1xuICAgIGUuRWEuYWRkKDEgLyogT2ZmbGluZUNhdXNlLkluZGV4ZWREYkZhaWxlZCAqLyksIFxuICAgIC8vIERpc2FibGUgbmV0d29yayBhbmQgcmFpc2Ugb2ZmbGluZSBzbmFwc2hvdHNcbiAgICBhd2FpdCBfX1BSSVZBVEVfZGlzYWJsZU5ldHdvcmtJbnRlcm5hbChlKSwgZS5SYS5zZXQoXCJPZmZsaW5lXCIgLyogT25saW5lU3RhdGUuT2ZmbGluZSAqLyksIFxuICAgIG4gfHwgKFxuICAgIC8vIFVzZSBhIHNpbXBsZSByZWFkIG9wZXJhdGlvbiB0byBkZXRlcm1pbmUgaWYgSW5kZXhlZERCIHJlY292ZXJlZC5cbiAgICAvLyBJZGVhbGx5LCB3ZSB3b3VsZCBleHBvc2UgYSBoZWFsdGggY2hlY2sgZGlyZWN0bHkgb24gU2ltcGxlRGIsIGJ1dFxuICAgIC8vIFJlbW90ZVN0b3JlIG9ubHkgaGFzIGFjY2VzcyB0byBwZXJzaXN0ZW5jZSB0aHJvdWdoIExvY2FsU3RvcmUuXG4gICAgbiA9ICgpID0+IF9fUFJJVkFURV9sb2NhbFN0b3JlR2V0TGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbihlLmxvY2FsU3RvcmUpKSwgXG4gICAgLy8gUHJvYmUgSW5kZXhlZERCIHBlcmlvZGljYWxseSBhbmQgcmUtZW5hYmxlIG5ldHdvcmtcbiAgICBlLmFzeW5jUXVldWUuZW5xdWV1ZVJldHJ5YWJsZSgoYXN5bmMgKCkgPT4ge1xuICAgICAgICBfX1BSSVZBVEVfbG9nRGVidWcodG4sIFwiUmV0cnlpbmcgSW5kZXhlZERCIGFjY2Vzc1wiKSwgYXdhaXQgbigpLCBlLkVhLmRlbGV0ZSgxIC8qIE9mZmxpbmVDYXVzZS5JbmRleGVkRGJGYWlsZWQgKi8pLCBcbiAgICAgICAgYXdhaXQgX19QUklWQVRFX2VuYWJsZU5ldHdvcmtJbnRlcm5hbChlKTtcbiAgICB9KSk7XG59XG5cbi8qKlxuICogRXhlY3V0ZXMgYG9wYC4gSWYgYG9wYCBmYWlscywgdGFrZXMgdGhlIG5ldHdvcmsgb2ZmbGluZSB1bnRpbCBgb3BgXG4gKiBzdWNjZWVkcy4gUmV0dXJucyBhZnRlciB0aGUgZmlyc3QgYXR0ZW1wdC5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfZXhlY3V0ZVdpdGhSZWNvdmVyeShlLCB0KSB7XG4gICAgcmV0dXJuIHQoKS5jYXRjaCgobiA9PiBfX1BSSVZBVEVfZGlzYWJsZU5ldHdvcmtVbnRpbFJlY292ZXJ5KGUsIG4sIHQpKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIF9fUFJJVkFURV9maWxsV3JpdGVQaXBlbGluZShlKSB7XG4gICAgY29uc3QgdCA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSksIG4gPSBfX1BSSVZBVEVfZW5zdXJlV3JpdGVTdHJlYW0odCk7XG4gICAgbGV0IHIgPSB0LlRhLmxlbmd0aCA+IDAgPyB0LlRhW3QuVGEubGVuZ3RoIC0gMV0uYmF0Y2hJZCA6IGo7XG4gICAgZm9yICg7X19QUklWQVRFX2NhbkFkZFRvV3JpdGVQaXBlbGluZSh0KTsgKSB0cnkge1xuICAgICAgICBjb25zdCBlID0gYXdhaXQgX19QUklWQVRFX2xvY2FsU3RvcmVHZXROZXh0TXV0YXRpb25CYXRjaCh0LmxvY2FsU3RvcmUsIHIpO1xuICAgICAgICBpZiAobnVsbCA9PT0gZSkge1xuICAgICAgICAgICAgMCA9PT0gdC5UYS5sZW5ndGggJiYgbi5MXygpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgciA9IGUuYmF0Y2hJZCwgX19QUklWQVRFX2FkZFRvV3JpdGVQaXBlbGluZSh0LCBlKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGF3YWl0IF9fUFJJVkFURV9kaXNhYmxlTmV0d29ya1VudGlsUmVjb3ZlcnkodCwgZSk7XG4gICAgfVxuICAgIF9fUFJJVkFURV9zaG91bGRTdGFydFdyaXRlU3RyZWFtKHQpICYmIF9fUFJJVkFURV9zdGFydFdyaXRlU3RyZWFtKHQpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB3ZSBjYW4gYWRkIHRvIHRoZSB3cml0ZSBwaXBlbGluZSAoaS5lLiB0aGUgbmV0d29yayBpc1xuICogZW5hYmxlZCBhbmQgdGhlIHdyaXRlIHBpcGVsaW5lIGlzIG5vdCBmdWxsKS5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfY2FuQWRkVG9Xcml0ZVBpcGVsaW5lKGUpIHtcbiAgICByZXR1cm4gX19QUklWQVRFX2NhblVzZU5ldHdvcmsoZSkgJiYgZS5UYS5sZW5ndGggPCAxMDtcbn1cblxuLyoqXG4gKiBRdWV1ZXMgYWRkaXRpb25hbCB3cml0ZXMgdG8gYmUgc2VudCB0byB0aGUgd3JpdGUgc3RyZWFtLCBzZW5kaW5nIHRoZW1cbiAqIGltbWVkaWF0ZWx5IGlmIHRoZSB3cml0ZSBzdHJlYW0gaXMgZXN0YWJsaXNoZWQuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX2FkZFRvV3JpdGVQaXBlbGluZShlLCB0KSB7XG4gICAgZS5UYS5wdXNoKHQpO1xuICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfZW5zdXJlV3JpdGVTdHJlYW0oZSk7XG4gICAgbi5PXygpICYmIG4uWF8gJiYgbi5lYSh0Lm11dGF0aW9ucyk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9zaG91bGRTdGFydFdyaXRlU3RyZWFtKGUpIHtcbiAgICByZXR1cm4gX19QUklWQVRFX2NhblVzZU5ldHdvcmsoZSkgJiYgIV9fUFJJVkFURV9lbnN1cmVXcml0ZVN0cmVhbShlKS54XygpICYmIGUuVGEubGVuZ3RoID4gMDtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX3N0YXJ0V3JpdGVTdHJlYW0oZSkge1xuICAgIF9fUFJJVkFURV9lbnN1cmVXcml0ZVN0cmVhbShlKS5zdGFydCgpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfb25Xcml0ZVN0cmVhbU9wZW4oZSkge1xuICAgIF9fUFJJVkFURV9lbnN1cmVXcml0ZVN0cmVhbShlKS5yYSgpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfb25Xcml0ZUhhbmRzaGFrZUNvbXBsZXRlKGUpIHtcbiAgICBjb25zdCB0ID0gX19QUklWQVRFX2Vuc3VyZVdyaXRlU3RyZWFtKGUpO1xuICAgIC8vIFNlbmQgdGhlIHdyaXRlIHBpcGVsaW5lIG5vdyB0aGF0IHRoZSBzdHJlYW0gaXMgZXN0YWJsaXNoZWQuXG4gICAgICAgIGZvciAoY29uc3QgbiBvZiBlLlRhKSB0LmVhKG4ubXV0YXRpb25zKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gX19QUklWQVRFX29uTXV0YXRpb25SZXN1bHQoZSwgdCwgbikge1xuICAgIGNvbnN0IHIgPSBlLlRhLnNoaWZ0KCksIGkgPSBNdXRhdGlvbkJhdGNoUmVzdWx0LmZyb20ociwgdCwgbik7XG4gICAgYXdhaXQgX19QUklWQVRFX2V4ZWN1dGVXaXRoUmVjb3ZlcnkoZSwgKCgpID0+IGUucmVtb3RlU3luY2VyLmFwcGx5U3VjY2Vzc2Z1bFdyaXRlKGkpKSksIFxuICAgIC8vIEl0J3MgcG9zc2libGUgdGhhdCB3aXRoIHRoZSBjb21wbGV0aW9uIG9mIHRoaXMgbXV0YXRpb24gYW5vdGhlclxuICAgIC8vIHNsb3QgaGFzIGZyZWVkIHVwLlxuICAgIGF3YWl0IF9fUFJJVkFURV9maWxsV3JpdGVQaXBlbGluZShlKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gX19QUklWQVRFX29uV3JpdGVTdHJlYW1DbG9zZShlLCB0KSB7XG4gICAgLy8gSWYgdGhlIHdyaXRlIHN0cmVhbSBjbG9zZWQgYWZ0ZXIgdGhlIHdyaXRlIGhhbmRzaGFrZSBjb21wbGV0ZXMsIGEgd3JpdGVcbiAgICAvLyBvcGVyYXRpb24gZmFpbGVkIGFuZCB3ZSBmYWlsIHRoZSBwZW5kaW5nIG9wZXJhdGlvbi5cbiAgICB0ICYmIF9fUFJJVkFURV9lbnN1cmVXcml0ZVN0cmVhbShlKS5YXyAmJiBcbiAgICAvLyBUaGlzIGVycm9yIGFmZmVjdHMgdGhlIGFjdHVhbCB3cml0ZS5cbiAgICBhd2FpdCBhc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfaGFuZGxlV3JpdGVFcnJvcihlLCB0KSB7XG4gICAgICAgIC8vIE9ubHkgaGFuZGxlIHBlcm1hbmVudCBlcnJvcnMgaGVyZS4gSWYgaXQncyB0cmFuc2llbnQsIGp1c3QgbGV0IHRoZSByZXRyeVxuICAgICAgICAvLyBsb2dpYyBraWNrIGluLlxuICAgICAgICBpZiAoZnVuY3Rpb24gX19QUklWQVRFX2lzUGVybWFuZW50V3JpdGVFcnJvcihlKSB7XG4gICAgICAgICAgICByZXR1cm4gX19QUklWQVRFX2lzUGVybWFuZW50RXJyb3IoZSkgJiYgZSAhPT0gTi5BQk9SVEVEO1xuICAgICAgICB9KHQuY29kZSkpIHtcbiAgICAgICAgICAgIC8vIFRoaXMgd2FzIGEgcGVybWFuZW50IGVycm9yLCB0aGUgcmVxdWVzdCBpdHNlbGYgd2FzIHRoZSBwcm9ibGVtXG4gICAgICAgICAgICAvLyBzbyBpdCdzIG5vdCBnb2luZyB0byBzdWNjZWVkIGlmIHdlIHJlc2VuZCBpdC5cbiAgICAgICAgICAgIGNvbnN0IG4gPSBlLlRhLnNoaWZ0KCk7XG4gICAgICAgICAgICAvLyBJbiB0aGlzIGNhc2UgaXQncyBhbHNvIHVubGlrZWx5IHRoYXQgdGhlIHNlcnZlciBpdHNlbGYgaXMgbWVsdGluZ1xuICAgICAgICAgICAgLy8gZG93biAtLSB0aGlzIHdhcyBqdXN0IGEgYmFkIHJlcXVlc3Qgc28gaW5oaWJpdCBiYWNrb2ZmIG9uIHRoZSBuZXh0XG4gICAgICAgICAgICAvLyByZXN0YXJ0LlxuICAgICAgICAgICAgICAgICAgICAgICAgX19QUklWQVRFX2Vuc3VyZVdyaXRlU3RyZWFtKGUpLkJfKCksIGF3YWl0IF9fUFJJVkFURV9leGVjdXRlV2l0aFJlY292ZXJ5KGUsICgoKSA9PiBlLnJlbW90ZVN5bmNlci5yZWplY3RGYWlsZWRXcml0ZShuLmJhdGNoSWQsIHQpKSksIFxuICAgICAgICAgICAgLy8gSXQncyBwb3NzaWJsZSB0aGF0IHdpdGggdGhlIGNvbXBsZXRpb24gb2YgdGhpcyBtdXRhdGlvblxuICAgICAgICAgICAgLy8gYW5vdGhlciBzbG90IGhhcyBmcmVlZCB1cC5cbiAgICAgICAgICAgIGF3YWl0IF9fUFJJVkFURV9maWxsV3JpdGVQaXBlbGluZShlKTtcbiAgICAgICAgfVxuICAgIH0oZSwgdCksIFxuICAgIC8vIFRoZSB3cml0ZSBzdHJlYW0gbWlnaHQgaGF2ZSBiZWVuIHN0YXJ0ZWQgYnkgcmVmaWxsaW5nIHRoZSB3cml0ZVxuICAgIC8vIHBpcGVsaW5lIGZvciBmYWlsZWQgd3JpdGVzXG4gICAgX19QUklWQVRFX3Nob3VsZFN0YXJ0V3JpdGVTdHJlYW0oZSkgJiYgX19QUklWQVRFX3N0YXJ0V3JpdGVTdHJlYW0oZSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIF9fUFJJVkFURV9yZW1vdGVTdG9yZUhhbmRsZUNyZWRlbnRpYWxDaGFuZ2UoZSwgdCkge1xuICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpO1xuICAgIG4uYXN5bmNRdWV1ZS52ZXJpZnlPcGVyYXRpb25JblByb2dyZXNzKCksIF9fUFJJVkFURV9sb2dEZWJ1Zyh0biwgXCJSZW1vdGVTdG9yZSByZWNlaXZlZCBuZXcgY3JlZGVudGlhbHNcIik7XG4gICAgY29uc3QgciA9IF9fUFJJVkFURV9jYW5Vc2VOZXR3b3JrKG4pO1xuICAgIC8vIFRlYXIgZG93biBhbmQgcmUtY3JlYXRlIG91ciBuZXR3b3JrIHN0cmVhbXMuIFRoaXMgd2lsbCBlbnN1cmUgd2UgZ2V0IGFcbiAgICAvLyBmcmVzaCBhdXRoIHRva2VuIGZvciB0aGUgbmV3IHVzZXIgYW5kIHJlLWZpbGwgdGhlIHdyaXRlIHBpcGVsaW5lIHdpdGhcbiAgICAvLyBuZXcgbXV0YXRpb25zIGZyb20gdGhlIExvY2FsU3RvcmUgKHNpbmNlIG11dGF0aW9ucyBhcmUgcGVyLXVzZXIpLlxuICAgICAgICBuLkVhLmFkZCgzIC8qIE9mZmxpbmVDYXVzZS5DcmVkZW50aWFsQ2hhbmdlICovKSwgYXdhaXQgX19QUklWQVRFX2Rpc2FibGVOZXR3b3JrSW50ZXJuYWwobiksIFxuICAgIHIgJiYgXG4gICAgLy8gRG9uJ3Qgc2V0IHRoZSBuZXR3b3JrIHN0YXR1cyB0byBVbmtub3duIGlmIHdlIGFyZSBvZmZsaW5lLlxuICAgIG4uUmEuc2V0KFwiVW5rbm93blwiIC8qIE9ubGluZVN0YXRlLlVua25vd24gKi8pLCBhd2FpdCBuLnJlbW90ZVN5bmNlci5oYW5kbGVDcmVkZW50aWFsQ2hhbmdlKHQpLCBcbiAgICBuLkVhLmRlbGV0ZSgzIC8qIE9mZmxpbmVDYXVzZS5DcmVkZW50aWFsQ2hhbmdlICovKSwgYXdhaXQgX19QUklWQVRFX2VuYWJsZU5ldHdvcmtJbnRlcm5hbChuKTtcbn1cblxuLyoqXG4gKiBUb2dnbGVzIHRoZSBuZXR3b3JrIHN0YXRlIHdoZW4gdGhlIGNsaWVudCBnYWlucyBvciBsb3NlcyBpdHMgcHJpbWFyeSBsZWFzZS5cbiAqLyBhc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfcmVtb3RlU3RvcmVBcHBseVByaW1hcnlTdGF0ZShlLCB0KSB7XG4gICAgY29uc3QgbiA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgdCA/IChuLkVhLmRlbGV0ZSgyIC8qIE9mZmxpbmVDYXVzZS5Jc1NlY29uZGFyeSAqLyksIGF3YWl0IF9fUFJJVkFURV9lbmFibGVOZXR3b3JrSW50ZXJuYWwobikpIDogdCB8fCAobi5FYS5hZGQoMiAvKiBPZmZsaW5lQ2F1c2UuSXNTZWNvbmRhcnkgKi8pLCBcbiAgICBhd2FpdCBfX1BSSVZBVEVfZGlzYWJsZU5ldHdvcmtJbnRlcm5hbChuKSwgbi5SYS5zZXQoXCJVbmtub3duXCIgLyogT25saW5lU3RhdGUuVW5rbm93biAqLykpO1xufVxuXG4vKipcbiAqIElmIG5vdCB5ZXQgaW5pdGlhbGl6ZWQsIHJlZ2lzdGVycyB0aGUgV2F0Y2hTdHJlYW0gYW5kIGl0cyBuZXR3b3JrIHN0YXRlXG4gKiBjYWxsYmFjayB3aXRoIGByZW1vdGVTdG9yZUltcGxgLiBSZXR1cm5zIHRoZSBleGlzdGluZyBzdHJlYW0gaWYgb25lIGlzXG4gKiBhbHJlYWR5IGF2YWlsYWJsZS5cbiAqXG4gKiBQT1JUSU5HIE5PVEU6IE9uIGlPUyBhbmQgQW5kcm9pZCwgdGhlIFdhdGNoU3RyZWFtIGdldHMgcmVnaXN0ZXJlZCBvbiBzdGFydHVwLlxuICogVGhpcyBpcyBub3QgZG9uZSBvbiBXZWIgdG8gYWxsb3cgaXQgdG8gYmUgdHJlZS1zaGFrZW4uXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX2Vuc3VyZVdhdGNoU3RyZWFtKGUpIHtcbiAgICByZXR1cm4gZS5tYSB8fCAoXG4gICAgLy8gQ3JlYXRlIHN0cmVhbSAoYnV0IG5vdGUgdGhhdCBpdCBpcyBub3Qgc3RhcnRlZCB5ZXQpLlxuICAgIGUubWEgPSBmdW5jdGlvbiBfX1BSSVZBVEVfbmV3UGVyc2lzdGVudFdhdGNoU3RyZWFtKGUsIHQsIG4pIHtcbiAgICAgICAgY29uc3QgciA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgICAgIHJldHVybiByLnNhKCksIG5ldyBfX1BSSVZBVEVfUGVyc2lzdGVudExpc3RlblN0cmVhbSh0LCByLmNvbm5lY3Rpb24sIHIuYXV0aENyZWRlbnRpYWxzLCByLmFwcENoZWNrQ3JlZGVudGlhbHMsIHIuc2VyaWFsaXplciwgbik7XG4gICAgfVxuICAgIC8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE4IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIChlLmRhdGFzdG9yZSwgZS5hc3luY1F1ZXVlLCB7XG4gICAgICAgIFhvOiBfX1BSSVZBVEVfb25XYXRjaFN0cmVhbUNvbm5lY3RlZC5iaW5kKG51bGwsIGUpLFxuICAgICAgICB0XzogX19QUklWQVRFX29uV2F0Y2hTdHJlYW1PcGVuLmJpbmQobnVsbCwgZSksXG4gICAgICAgIHJfOiBfX1BSSVZBVEVfb25XYXRjaFN0cmVhbUNsb3NlLmJpbmQobnVsbCwgZSksXG4gICAgICAgIEhfOiBfX1BSSVZBVEVfb25XYXRjaFN0cmVhbUNoYW5nZS5iaW5kKG51bGwsIGUpXG4gICAgfSksIGUuZGEucHVzaCgoYXN5bmMgdCA9PiB7XG4gICAgICAgIHQgPyAoZS5tYS5CXygpLCBfX1BSSVZBVEVfc2hvdWxkU3RhcnRXYXRjaFN0cmVhbShlKSA/IF9fUFJJVkFURV9zdGFydFdhdGNoU3RyZWFtKGUpIDogZS5SYS5zZXQoXCJVbmtub3duXCIgLyogT25saW5lU3RhdGUuVW5rbm93biAqLykpIDogKGF3YWl0IGUubWEuc3RvcCgpLCBcbiAgICAgICAgX19QUklWQVRFX2NsZWFuVXBXYXRjaFN0cmVhbVN0YXRlKGUpKTtcbiAgICB9KSkpLCBlLm1hO1xufVxuXG4vKipcbiAqIElmIG5vdCB5ZXQgaW5pdGlhbGl6ZWQsIHJlZ2lzdGVycyB0aGUgV3JpdGVTdHJlYW0gYW5kIGl0cyBuZXR3b3JrIHN0YXRlXG4gKiBjYWxsYmFjayB3aXRoIGByZW1vdGVTdG9yZUltcGxgLiBSZXR1cm5zIHRoZSBleGlzdGluZyBzdHJlYW0gaWYgb25lIGlzXG4gKiBhbHJlYWR5IGF2YWlsYWJsZS5cbiAqXG4gKiBQT1JUSU5HIE5PVEU6IE9uIGlPUyBhbmQgQW5kcm9pZCwgdGhlIFdyaXRlU3RyZWFtIGdldHMgcmVnaXN0ZXJlZCBvbiBzdGFydHVwLlxuICogVGhpcyBpcyBub3QgZG9uZSBvbiBXZWIgdG8gYWxsb3cgaXQgdG8gYmUgdHJlZS1zaGFrZW4uXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX2Vuc3VyZVdyaXRlU3RyZWFtKGUpIHtcbiAgICByZXR1cm4gZS5mYSB8fCAoXG4gICAgLy8gQ3JlYXRlIHN0cmVhbSAoYnV0IG5vdGUgdGhhdCBpdCBpcyBub3Qgc3RhcnRlZCB5ZXQpLlxuICAgIGUuZmEgPSBmdW5jdGlvbiBfX1BSSVZBVEVfbmV3UGVyc2lzdGVudFdyaXRlU3RyZWFtKGUsIHQsIG4pIHtcbiAgICAgICAgY29uc3QgciA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgICAgIHJldHVybiByLnNhKCksIG5ldyBfX1BSSVZBVEVfUGVyc2lzdGVudFdyaXRlU3RyZWFtKHQsIHIuY29ubmVjdGlvbiwgci5hdXRoQ3JlZGVudGlhbHMsIHIuYXBwQ2hlY2tDcmVkZW50aWFscywgci5zZXJpYWxpemVyLCBuKTtcbiAgICB9KGUuZGF0YXN0b3JlLCBlLmFzeW5jUXVldWUsIHtcbiAgICAgICAgWG86ICgpID0+IFByb21pc2UucmVzb2x2ZSgpLFxuICAgICAgICB0XzogX19QUklWQVRFX29uV3JpdGVTdHJlYW1PcGVuLmJpbmQobnVsbCwgZSksXG4gICAgICAgIHJfOiBfX1BSSVZBVEVfb25Xcml0ZVN0cmVhbUNsb3NlLmJpbmQobnVsbCwgZSksXG4gICAgICAgIHRhOiBfX1BSSVZBVEVfb25Xcml0ZUhhbmRzaGFrZUNvbXBsZXRlLmJpbmQobnVsbCwgZSksXG4gICAgICAgIG5hOiBfX1BSSVZBVEVfb25NdXRhdGlvblJlc3VsdC5iaW5kKG51bGwsIGUpXG4gICAgfSksIGUuZGEucHVzaCgoYXN5bmMgdCA9PiB7XG4gICAgICAgIHQgPyAoZS5mYS5CXygpLCBcbiAgICAgICAgLy8gVGhpcyB3aWxsIHN0YXJ0IHRoZSB3cml0ZSBzdHJlYW0gaWYgbmVjZXNzYXJ5LlxuICAgICAgICBhd2FpdCBfX1BSSVZBVEVfZmlsbFdyaXRlUGlwZWxpbmUoZSkpIDogKGF3YWl0IGUuZmEuc3RvcCgpLCBlLlRhLmxlbmd0aCA+IDAgJiYgKF9fUFJJVkFURV9sb2dEZWJ1Zyh0biwgYFN0b3BwaW5nIHdyaXRlIHN0cmVhbSB3aXRoICR7ZS5UYS5sZW5ndGh9IHBlbmRpbmcgd3JpdGVzYCksIFxuICAgICAgICBlLlRhID0gW10pKTtcbiAgICB9KSkpLCBlLmZhO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZXByZXNlbnRzIGFuIG9wZXJhdGlvbiBzY2hlZHVsZWQgdG8gYmUgcnVuIGluIHRoZSBmdXR1cmUgb24gYW4gQXN5bmNRdWV1ZS5cbiAqXG4gKiBJdCBpcyBjcmVhdGVkIHZpYSBEZWxheWVkT3BlcmF0aW9uLmNyZWF0ZUFuZFNjaGVkdWxlKCkuXG4gKlxuICogU3VwcG9ydHMgY2FuY2VsbGF0aW9uICh2aWEgY2FuY2VsKCkpIGFuZCBlYXJseSBleGVjdXRpb24gKHZpYSBza2lwRGVsYXkoKSkuXG4gKlxuICogTm90ZTogV2UgaW1wbGVtZW50IGBQcm9taXNlTGlrZWAgaW5zdGVhZCBvZiBgUHJvbWlzZWAsIGFzIHRoZSBgUHJvbWlzZWAgdHlwZVxuICogaW4gbmV3ZXIgdmVyc2lvbnMgb2YgVHlwZVNjcmlwdCBkZWZpbmVzIGBmaW5hbGx5YCwgd2hpY2ggaXMgbm90IGF2YWlsYWJsZSBpblxuICogSUUuXG4gKi9cbmNsYXNzIERlbGF5ZWRPcGVyYXRpb24ge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4sIHIsIGkpIHtcbiAgICAgICAgdGhpcy5hc3luY1F1ZXVlID0gZSwgdGhpcy50aW1lcklkID0gdCwgdGhpcy50YXJnZXRUaW1lTXMgPSBuLCB0aGlzLm9wID0gciwgdGhpcy5yZW1vdmFsQ2FsbGJhY2sgPSBpLCBcbiAgICAgICAgdGhpcy5kZWZlcnJlZCA9IG5ldyBfX1BSSVZBVEVfRGVmZXJyZWQsIHRoaXMudGhlbiA9IHRoaXMuZGVmZXJyZWQucHJvbWlzZS50aGVuLmJpbmQodGhpcy5kZWZlcnJlZC5wcm9taXNlKSwgXG4gICAgICAgIC8vIEl0J3Mgbm9ybWFsIGZvciB0aGUgZGVmZXJyZWQgcHJvbWlzZSB0byBiZSBjYW5jZWxlZCAoZHVlIHRvIGNhbmNlbGxhdGlvbilcbiAgICAgICAgLy8gYW5kIHNvIHdlIGF0dGFjaCBhIGR1bW15IGNhdGNoIGNhbGxiYWNrIHRvIGF2b2lkXG4gICAgICAgIC8vICdVbmhhbmRsZWRQcm9taXNlUmVqZWN0aW9uV2FybmluZycgbG9nIHNwYW0uXG4gICAgICAgIHRoaXMuZGVmZXJyZWQucHJvbWlzZS5jYXRjaCgoZSA9PiB7fSkpO1xuICAgIH1cbiAgICBnZXQgcHJvbWlzZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVmZXJyZWQucHJvbWlzZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIERlbGF5ZWRPcGVyYXRpb24gdGhhdCBoYXMgYmVlbiBzY2hlZHVsZWQgdG8gYmVcbiAgICAgKiBleGVjdXRlZCBvbiB0aGUgcHJvdmlkZWQgYXN5bmNRdWV1ZSBhZnRlciB0aGUgcHJvdmlkZWQgZGVsYXlNcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBhc3luY1F1ZXVlIC0gVGhlIHF1ZXVlIHRvIHNjaGVkdWxlIHRoZSBvcGVyYXRpb24gb24uXG4gICAgICogQHBhcmFtIGlkIC0gQSBUaW1lciBJRCBpZGVudGlmeWluZyB0aGUgdHlwZSBvZiBvcGVyYXRpb24gdGhpcyBpcy5cbiAgICAgKiBAcGFyYW0gZGVsYXlNcyAtIFRoZSBkZWxheSAobXMpIGJlZm9yZSB0aGUgb3BlcmF0aW9uIHNob3VsZCBiZSBzY2hlZHVsZWQuXG4gICAgICogQHBhcmFtIG9wIC0gVGhlIG9wZXJhdGlvbiB0byBydW4uXG4gICAgICogQHBhcmFtIHJlbW92YWxDYWxsYmFjayAtIEEgY2FsbGJhY2sgdG8gYmUgY2FsbGVkIHN5bmNocm9ub3VzbHkgb25jZSB0aGVcbiAgICAgKiAgIG9wZXJhdGlvbiBpcyBleGVjdXRlZCBvciBjYW5jZWxlZCwgbm90aWZ5aW5nIHRoZSBBc3luY1F1ZXVlIHRvIHJlbW92ZSBpdFxuICAgICAqICAgZnJvbSBpdHMgZGVsYXllZE9wZXJhdGlvbnMgbGlzdC5cbiAgICAgKiAgIFBPUlRJTkcgTk9URTogVGhpcyBleGlzdHMgdG8gcHJldmVudCBtYWtpbmcgcmVtb3ZlRGVsYXllZE9wZXJhdGlvbigpIGFuZFxuICAgICAqICAgdGhlIERlbGF5ZWRPcGVyYXRpb24gY2xhc3MgcHVibGljLlxuICAgICAqLyAgICBzdGF0aWMgY3JlYXRlQW5kU2NoZWR1bGUoZSwgdCwgbiwgciwgaSkge1xuICAgICAgICBjb25zdCBzID0gRGF0ZS5ub3coKSArIG4sIG8gPSBuZXcgRGVsYXllZE9wZXJhdGlvbihlLCB0LCBzLCByLCBpKTtcbiAgICAgICAgcmV0dXJuIG8uc3RhcnQobiksIG87XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyB0aGUgdGltZXIuIFRoaXMgaXMgY2FsbGVkIGltbWVkaWF0ZWx5IGFmdGVyIGNvbnN0cnVjdGlvbiBieVxuICAgICAqIGNyZWF0ZUFuZFNjaGVkdWxlKCkuXG4gICAgICovICAgIHN0YXJ0KGUpIHtcbiAgICAgICAgdGhpcy50aW1lckhhbmRsZSA9IHNldFRpbWVvdXQoKCgpID0+IHRoaXMuaGFuZGxlRGVsYXlFbGFwc2VkKCkpLCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUXVldWVzIHRoZSBvcGVyYXRpb24gdG8gcnVuIGltbWVkaWF0ZWx5IChpZiBpdCBoYXNuJ3QgYWxyZWFkeSBiZWVuIHJ1biBvclxuICAgICAqIGNhbmNlbGVkKS5cbiAgICAgKi8gICAgc2tpcERlbGF5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGVEZWxheUVsYXBzZWQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FuY2VscyB0aGUgb3BlcmF0aW9uIGlmIGl0IGhhc24ndCBhbHJlYWR5IGJlZW4gZXhlY3V0ZWQgb3IgY2FuY2VsZWQuIFRoZVxuICAgICAqIHByb21pc2Ugd2lsbCBiZSByZWplY3RlZC5cbiAgICAgKlxuICAgICAqIEFzIGxvbmcgYXMgdGhlIG9wZXJhdGlvbiBoYXMgbm90IHlldCBiZWVuIHJ1biwgY2FsbGluZyBjYW5jZWwoKSBwcm92aWRlcyBhXG4gICAgICogZ3VhcmFudGVlIHRoYXQgdGhlIG9wZXJhdGlvbiB3aWxsIG5vdCBiZSBydW4uXG4gICAgICovICAgIGNhbmNlbChlKSB7XG4gICAgICAgIG51bGwgIT09IHRoaXMudGltZXJIYW5kbGUgJiYgKHRoaXMuY2xlYXJUaW1lb3V0KCksIHRoaXMuZGVmZXJyZWQucmVqZWN0KG5ldyBGaXJlc3RvcmVFcnJvcihOLkNBTkNFTExFRCwgXCJPcGVyYXRpb24gY2FuY2VsbGVkXCIgKyAoZSA/IFwiOiBcIiArIGUgOiBcIlwiKSkpKTtcbiAgICB9XG4gICAgaGFuZGxlRGVsYXlFbGFwc2VkKCkge1xuICAgICAgICB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gbnVsbCAhPT0gdGhpcy50aW1lckhhbmRsZSA/ICh0aGlzLmNsZWFyVGltZW91dCgpLCBcbiAgICAgICAgdGhpcy5vcCgpLnRoZW4oKGUgPT4gdGhpcy5kZWZlcnJlZC5yZXNvbHZlKGUpKSkpIDogUHJvbWlzZS5yZXNvbHZlKCkpKTtcbiAgICB9XG4gICAgY2xlYXJUaW1lb3V0KCkge1xuICAgICAgICBudWxsICE9PSB0aGlzLnRpbWVySGFuZGxlICYmICh0aGlzLnJlbW92YWxDYWxsYmFjayh0aGlzKSwgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJIYW5kbGUpLCBcbiAgICAgICAgdGhpcy50aW1lckhhbmRsZSA9IG51bGwpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgRmlyZXN0b3JlRXJyb3IgdGhhdCBjYW4gYmUgc3VyZmFjZWQgdG8gdGhlIHVzZXIgaWYgdGhlIHByb3ZpZGVkXG4gKiBlcnJvciBpcyBhbiBJbmRleGVkRGJUcmFuc2FjdGlvbkVycm9yLiBSZS10aHJvd3MgdGhlIGVycm9yIG90aGVyd2lzZS5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfd3JhcEluVXNlckVycm9ySWZSZWNvdmVyYWJsZShlLCB0KSB7XG4gICAgaWYgKF9fUFJJVkFURV9sb2dFcnJvcihcIkFzeW5jUXVldWVcIiwgYCR7dH06ICR7ZX1gKSwgX19QUklWQVRFX2lzSW5kZXhlZERiVHJhbnNhY3Rpb25FcnJvcihlKSkgcmV0dXJuIG5ldyBGaXJlc3RvcmVFcnJvcihOLlVOQVZBSUxBQkxFLCBgJHt0fTogJHtlfWApO1xuICAgIHRocm93IGU7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIERvY3VtZW50U2V0IGlzIGFuIGltbXV0YWJsZSAoY29weS1vbi13cml0ZSkgY29sbGVjdGlvbiB0aGF0IGhvbGRzIGRvY3VtZW50c1xuICogaW4gb3JkZXIgc3BlY2lmaWVkIGJ5IHRoZSBwcm92aWRlZCBjb21wYXJhdG9yLiBXZSBhbHdheXMgYWRkIGEgZG9jdW1lbnQga2V5XG4gKiBjb21wYXJhdG9yIG9uIHRvcCBvZiB3aGF0IGlzIHByb3ZpZGVkIHRvIGd1YXJhbnRlZSBkb2N1bWVudCBlcXVhbGl0eSBiYXNlZCBvblxuICogdGhlIGtleS5cbiAqLyBjbGFzcyBEb2N1bWVudFNldCB7XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhbiBlbXB0eSBjb3B5IG9mIHRoZSBleGlzdGluZyBEb2N1bWVudFNldCwgdXNpbmcgdGhlIHNhbWVcbiAgICAgKiBjb21wYXJhdG9yLlxuICAgICAqL1xuICAgIHN0YXRpYyBlbXB0eVNldChlKSB7XG4gICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnRTZXQoZS5jb21wYXJhdG9yKTtcbiAgICB9XG4gICAgLyoqIFRoZSBkZWZhdWx0IG9yZGVyaW5nIGlzIGJ5IGtleSBpZiB0aGUgY29tcGFyYXRvciBpcyBvbWl0dGVkICovICAgIGNvbnN0cnVjdG9yKGUpIHtcbiAgICAgICAgLy8gV2UgYXJlIGFkZGluZyBkb2N1bWVudCBrZXkgY29tcGFyYXRvciB0byB0aGUgZW5kIGFzIGl0J3MgdGhlIG9ubHlcbiAgICAgICAgLy8gZ3VhcmFudGVlZCB1bmlxdWUgcHJvcGVydHkgb2YgYSBkb2N1bWVudC5cbiAgICAgICAgdGhpcy5jb21wYXJhdG9yID0gZSA/ICh0LCBuKSA9PiBlKHQsIG4pIHx8IERvY3VtZW50S2V5LmNvbXBhcmF0b3IodC5rZXksIG4ua2V5KSA6IChlLCB0KSA9PiBEb2N1bWVudEtleS5jb21wYXJhdG9yKGUua2V5LCB0LmtleSksIFxuICAgICAgICB0aGlzLmtleWVkTWFwID0gZG9jdW1lbnRNYXAoKSwgdGhpcy5zb3J0ZWRTZXQgPSBuZXcgU29ydGVkTWFwKHRoaXMuY29tcGFyYXRvcik7XG4gICAgfVxuICAgIGhhcyhlKSB7XG4gICAgICAgIHJldHVybiBudWxsICE9IHRoaXMua2V5ZWRNYXAuZ2V0KGUpO1xuICAgIH1cbiAgICBnZXQoZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5rZXllZE1hcC5nZXQoZSk7XG4gICAgfVxuICAgIGZpcnN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zb3J0ZWRTZXQubWluS2V5KCk7XG4gICAgfVxuICAgIGxhc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNvcnRlZFNldC5tYXhLZXkoKTtcbiAgICB9XG4gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc29ydGVkU2V0LmlzRW1wdHkoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIHByb3ZpZGVkIGtleSBpbiB0aGUgZG9jdW1lbnQgc2V0LCBvciAtMSBpZiB0aGVcbiAgICAgKiBkb2N1bWVudCBrZXkgaXMgbm90IHByZXNlbnQgaW4gdGhlIHNldDtcbiAgICAgKi8gICAgaW5kZXhPZihlKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmtleWVkTWFwLmdldChlKTtcbiAgICAgICAgcmV0dXJuIHQgPyB0aGlzLnNvcnRlZFNldC5pbmRleE9mKHQpIDogLTE7XG4gICAgfVxuICAgIGdldCBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zb3J0ZWRTZXQuc2l6ZTtcbiAgICB9XG4gICAgLyoqIEl0ZXJhdGVzIGRvY3VtZW50cyBpbiBvcmRlciBkZWZpbmVkIGJ5IFwiY29tcGFyYXRvclwiICovICAgIGZvckVhY2goZSkge1xuICAgICAgICB0aGlzLnNvcnRlZFNldC5pbm9yZGVyVHJhdmVyc2FsKCgodCwgbikgPT4gKGUodCksICExKSkpO1xuICAgIH1cbiAgICAvKiogSW5zZXJ0cyBvciB1cGRhdGVzIGEgZG9jdW1lbnQgd2l0aCB0aGUgc2FtZSBrZXkgKi8gICAgYWRkKGUpIHtcbiAgICAgICAgLy8gRmlyc3QgcmVtb3ZlIHRoZSBlbGVtZW50IGlmIHdlIGhhdmUgaXQuXG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmRlbGV0ZShlLmtleSk7XG4gICAgICAgIHJldHVybiB0LmNvcHkodC5rZXllZE1hcC5pbnNlcnQoZS5rZXksIGUpLCB0LnNvcnRlZFNldC5pbnNlcnQoZSwgbnVsbCkpO1xuICAgIH1cbiAgICAvKiogRGVsZXRlcyBhIGRvY3VtZW50IHdpdGggYSBnaXZlbiBrZXkgKi8gICAgZGVsZXRlKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuZ2V0KGUpO1xuICAgICAgICByZXR1cm4gdCA/IHRoaXMuY29weSh0aGlzLmtleWVkTWFwLnJlbW92ZShlKSwgdGhpcy5zb3J0ZWRTZXQucmVtb3ZlKHQpKSA6IHRoaXM7XG4gICAgfVxuICAgIGlzRXF1YWwoZSkge1xuICAgICAgICBpZiAoIShlIGluc3RhbmNlb2YgRG9jdW1lbnRTZXQpKSByZXR1cm4gITE7XG4gICAgICAgIGlmICh0aGlzLnNpemUgIT09IGUuc2l6ZSkgcmV0dXJuICExO1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5zb3J0ZWRTZXQuZ2V0SXRlcmF0b3IoKSwgbiA9IGUuc29ydGVkU2V0LmdldEl0ZXJhdG9yKCk7XG4gICAgICAgIGZvciAoO3QuaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LmdldE5leHQoKS5rZXksIHIgPSBuLmdldE5leHQoKS5rZXk7XG4gICAgICAgICAgICBpZiAoIWUuaXNFcXVhbChyKSkgcmV0dXJuICExO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIGNvbnN0IGUgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICBlLnB1c2godC50b1N0cmluZygpKTtcbiAgICAgICAgfSkpLCAwID09PSBlLmxlbmd0aCA/IFwiRG9jdW1lbnRTZXQgKClcIiA6IFwiRG9jdW1lbnRTZXQgKFxcbiAgXCIgKyBlLmpvaW4oXCIgIFxcblwiKSArIFwiXFxuKVwiO1xuICAgIH1cbiAgICBjb3B5KGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IG5ldyBEb2N1bWVudFNldDtcbiAgICAgICAgcmV0dXJuIG4uY29tcGFyYXRvciA9IHRoaXMuY29tcGFyYXRvciwgbi5rZXllZE1hcCA9IGUsIG4uc29ydGVkU2V0ID0gdCwgbjtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIERvY3VtZW50Q2hhbmdlU2V0IGtlZXBzIHRyYWNrIG9mIGEgc2V0IG9mIGNoYW5nZXMgdG8gZG9jcyBpbiBhIHF1ZXJ5LCBtZXJnaW5nXG4gKiBkdXBsaWNhdGUgZXZlbnRzIGZvciB0aGUgc2FtZSBkb2MuXG4gKi8gY2xhc3MgX19QUklWQVRFX0RvY3VtZW50Q2hhbmdlU2V0IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5nYSA9IG5ldyBTb3J0ZWRNYXAoRG9jdW1lbnRLZXkuY29tcGFyYXRvcik7XG4gICAgfVxuICAgIHRyYWNrKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IGUuZG9jLmtleSwgbiA9IHRoaXMuZ2EuZ2V0KHQpO1xuICAgICAgICBuID8gXG4gICAgICAgIC8vIE1lcmdlIHRoZSBuZXcgY2hhbmdlIHdpdGggdGhlIGV4aXN0aW5nIGNoYW5nZS5cbiAgICAgICAgMCAvKiBDaGFuZ2VUeXBlLkFkZGVkICovICE9PSBlLnR5cGUgJiYgMyAvKiBDaGFuZ2VUeXBlLk1ldGFkYXRhICovID09PSBuLnR5cGUgPyB0aGlzLmdhID0gdGhpcy5nYS5pbnNlcnQodCwgZSkgOiAzIC8qIENoYW5nZVR5cGUuTWV0YWRhdGEgKi8gPT09IGUudHlwZSAmJiAxIC8qIENoYW5nZVR5cGUuUmVtb3ZlZCAqLyAhPT0gbi50eXBlID8gdGhpcy5nYSA9IHRoaXMuZ2EuaW5zZXJ0KHQsIHtcbiAgICAgICAgICAgIHR5cGU6IG4udHlwZSxcbiAgICAgICAgICAgIGRvYzogZS5kb2NcbiAgICAgICAgfSkgOiAyIC8qIENoYW5nZVR5cGUuTW9kaWZpZWQgKi8gPT09IGUudHlwZSAmJiAyIC8qIENoYW5nZVR5cGUuTW9kaWZpZWQgKi8gPT09IG4udHlwZSA/IHRoaXMuZ2EgPSB0aGlzLmdhLmluc2VydCh0LCB7XG4gICAgICAgICAgICB0eXBlOiAyIC8qIENoYW5nZVR5cGUuTW9kaWZpZWQgKi8gLFxuICAgICAgICAgICAgZG9jOiBlLmRvY1xuICAgICAgICB9KSA6IDIgLyogQ2hhbmdlVHlwZS5Nb2RpZmllZCAqLyA9PT0gZS50eXBlICYmIDAgLyogQ2hhbmdlVHlwZS5BZGRlZCAqLyA9PT0gbi50eXBlID8gdGhpcy5nYSA9IHRoaXMuZ2EuaW5zZXJ0KHQsIHtcbiAgICAgICAgICAgIHR5cGU6IDAgLyogQ2hhbmdlVHlwZS5BZGRlZCAqLyAsXG4gICAgICAgICAgICBkb2M6IGUuZG9jXG4gICAgICAgIH0pIDogMSAvKiBDaGFuZ2VUeXBlLlJlbW92ZWQgKi8gPT09IGUudHlwZSAmJiAwIC8qIENoYW5nZVR5cGUuQWRkZWQgKi8gPT09IG4udHlwZSA/IHRoaXMuZ2EgPSB0aGlzLmdhLnJlbW92ZSh0KSA6IDEgLyogQ2hhbmdlVHlwZS5SZW1vdmVkICovID09PSBlLnR5cGUgJiYgMiAvKiBDaGFuZ2VUeXBlLk1vZGlmaWVkICovID09PSBuLnR5cGUgPyB0aGlzLmdhID0gdGhpcy5nYS5pbnNlcnQodCwge1xuICAgICAgICAgICAgdHlwZTogMSAvKiBDaGFuZ2VUeXBlLlJlbW92ZWQgKi8gLFxuICAgICAgICAgICAgZG9jOiBuLmRvY1xuICAgICAgICB9KSA6IDAgLyogQ2hhbmdlVHlwZS5BZGRlZCAqLyA9PT0gZS50eXBlICYmIDEgLyogQ2hhbmdlVHlwZS5SZW1vdmVkICovID09PSBuLnR5cGUgPyB0aGlzLmdhID0gdGhpcy5nYS5pbnNlcnQodCwge1xuICAgICAgICAgICAgdHlwZTogMiAvKiBDaGFuZ2VUeXBlLk1vZGlmaWVkICovICxcbiAgICAgICAgICAgIGRvYzogZS5kb2NcbiAgICAgICAgfSkgOiBcbiAgICAgICAgLy8gVGhpcyBpbmNsdWRlcyB0aGVzZSBjYXNlcywgd2hpY2ggZG9uJ3QgbWFrZSBzZW5zZTpcbiAgICAgICAgLy8gQWRkZWQtPkFkZGVkXG4gICAgICAgIC8vIFJlbW92ZWQtPlJlbW92ZWRcbiAgICAgICAgLy8gTW9kaWZpZWQtPkFkZGVkXG4gICAgICAgIC8vIFJlbW92ZWQtPk1vZGlmaWVkXG4gICAgICAgIC8vIE1ldGFkYXRhLT5BZGRlZFxuICAgICAgICAvLyBSZW1vdmVkLT5NZXRhZGF0YVxuICAgICAgICBmYWlsKDYzMzQxLCB7XG4gICAgICAgICAgICBSdDogZSxcbiAgICAgICAgICAgIHBhOiBuXG4gICAgICAgIH0pIDogdGhpcy5nYSA9IHRoaXMuZ2EuaW5zZXJ0KHQsIGUpO1xuICAgIH1cbiAgICB5YSgpIHtcbiAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICByZXR1cm4gdGhpcy5nYS5pbm9yZGVyVHJhdmVyc2FsKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgZS5wdXNoKG4pO1xuICAgICAgICB9KSksIGU7XG4gICAgfVxufVxuXG5jbGFzcyBWaWV3U25hcHNob3Qge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4sIHIsIGksIHMsIG8sIF8sIGEpIHtcbiAgICAgICAgdGhpcy5xdWVyeSA9IGUsIHRoaXMuZG9jcyA9IHQsIHRoaXMub2xkRG9jcyA9IG4sIHRoaXMuZG9jQ2hhbmdlcyA9IHIsIHRoaXMubXV0YXRlZEtleXMgPSBpLCBcbiAgICAgICAgdGhpcy5mcm9tQ2FjaGUgPSBzLCB0aGlzLnN5bmNTdGF0ZUNoYW5nZWQgPSBvLCB0aGlzLmV4Y2x1ZGVzTWV0YWRhdGFDaGFuZ2VzID0gXywgXG4gICAgICAgIHRoaXMuaGFzQ2FjaGVkUmVzdWx0cyA9IGE7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgdmlldyBzbmFwc2hvdCBhcyBpZiBhbGwgZG9jdW1lbnRzIGluIHRoZSBzbmFwc2hvdCB3ZXJlIGFkZGVkLiAqLyAgICBzdGF0aWMgZnJvbUluaXRpYWxEb2N1bWVudHMoZSwgdCwgbiwgciwgaSkge1xuICAgICAgICBjb25zdCBzID0gW107XG4gICAgICAgIHJldHVybiB0LmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgcy5wdXNoKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAwIC8qIENoYW5nZVR5cGUuQWRkZWQgKi8gLFxuICAgICAgICAgICAgICAgIGRvYzogZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pKSwgbmV3IFZpZXdTbmFwc2hvdChlLCB0LCBEb2N1bWVudFNldC5lbXB0eVNldCh0KSwgcywgbiwgciwgXG4gICAgICAgIC8qIHN5bmNTdGF0ZUNoYW5nZWQ9ICovICEwLCBcbiAgICAgICAgLyogZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXM9ICovICExLCBpKTtcbiAgICB9XG4gICAgZ2V0IGhhc1BlbmRpbmdXcml0ZXMoKSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5tdXRhdGVkS2V5cy5pc0VtcHR5KCk7XG4gICAgfVxuICAgIGlzRXF1YWwoZSkge1xuICAgICAgICBpZiAoISh0aGlzLmZyb21DYWNoZSA9PT0gZS5mcm9tQ2FjaGUgJiYgdGhpcy5oYXNDYWNoZWRSZXN1bHRzID09PSBlLmhhc0NhY2hlZFJlc3VsdHMgJiYgdGhpcy5zeW5jU3RhdGVDaGFuZ2VkID09PSBlLnN5bmNTdGF0ZUNoYW5nZWQgJiYgdGhpcy5tdXRhdGVkS2V5cy5pc0VxdWFsKGUubXV0YXRlZEtleXMpICYmIF9fUFJJVkFURV9xdWVyeUVxdWFscyh0aGlzLnF1ZXJ5LCBlLnF1ZXJ5KSAmJiB0aGlzLmRvY3MuaXNFcXVhbChlLmRvY3MpICYmIHRoaXMub2xkRG9jcy5pc0VxdWFsKGUub2xkRG9jcykpKSByZXR1cm4gITE7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmRvY0NoYW5nZXMsIG4gPSBlLmRvY0NoYW5nZXM7XG4gICAgICAgIGlmICh0Lmxlbmd0aCAhPT0gbi5sZW5ndGgpIHJldHVybiAhMTtcbiAgICAgICAgZm9yIChsZXQgZSA9IDA7IGUgPCB0Lmxlbmd0aDsgZSsrKSBpZiAodFtlXS50eXBlICE9PSBuW2VdLnR5cGUgfHwgIXRbZV0uZG9jLmlzRXF1YWwobltlXS5kb2MpKSByZXR1cm4gITE7XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEhvbGRzIHRoZSBsaXN0ZW5lcnMgYW5kIHRoZSBsYXN0IHJlY2VpdmVkIFZpZXdTbmFwc2hvdCBmb3IgYSBxdWVyeSBiZWluZ1xuICogdHJhY2tlZCBieSBFdmVudE1hbmFnZXIuXG4gKi8gY2xhc3MgX19QUklWQVRFX1F1ZXJ5TGlzdGVuZXJzSW5mbyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMud2EgPSB2b2lkIDAsIHRoaXMuU2EgPSBbXTtcbiAgICB9XG4gICAgLy8gSGVscGVyIG1ldGhvZHMgdGhhdCBjaGVja3MgaWYgdGhlIHF1ZXJ5IGhhcyBsaXN0ZW5lcnMgdGhhdCBsaXN0ZW5pbmcgdG8gcmVtb3RlIHN0b3JlXG4gICAgYmEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlNhLnNvbWUoKGUgPT4gZS5EYSgpKSk7XG4gICAgfVxufVxuXG5jbGFzcyBfX1BSSVZBVEVfRXZlbnRNYW5hZ2VySW1wbCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMucXVlcmllcyA9IF9fUFJJVkFURV9uZXdRdWVyaWVzT2JqZWN0TWFwKCksIHRoaXMub25saW5lU3RhdGUgPSBcIlVua25vd25cIiAvKiBPbmxpbmVTdGF0ZS5Vbmtub3duICovICwgXG4gICAgICAgIHRoaXMuQ2EgPSBuZXcgU2V0O1xuICAgIH1cbiAgICB0ZXJtaW5hdGUoKSB7XG4gICAgICAgICFmdW5jdGlvbiBfX1BSSVZBVEVfZXJyb3JBbGxUYXJnZXRzKGUsIHQpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpLCByID0gbi5xdWVyaWVzO1xuICAgICAgICAgICAgLy8gUHJldmVudCBmdXJ0aGVyIGFjY2VzcyBieSBjbGVhcmluZyBPYmplY3RNYXAuXG4gICAgICAgICAgICBuLnF1ZXJpZXMgPSBfX1BSSVZBVEVfbmV3UXVlcmllc09iamVjdE1hcCgpLCByLmZvckVhY2goKChlLCBuKSA9PiB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIG4uU2EpIGUub25FcnJvcih0KTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBDYWxsIGFsbCBnbG9iYWwgc25hcHNob3QgbGlzdGVuZXJzIHRoYXQgaGF2ZSBiZWVuIHNldC5cbiAgICAgICAgKHRoaXMsIG5ldyBGaXJlc3RvcmVFcnJvcihOLkFCT1JURUQsIFwiRmlyZXN0b3JlIHNodXR0aW5nIGRvd25cIikpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX25ld1F1ZXJpZXNPYmplY3RNYXAoKSB7XG4gICAgcmV0dXJuIG5ldyBPYmplY3RNYXAoKGUgPT4gX19QUklWQVRFX2Nhbm9uaWZ5UXVlcnkoZSkpLCBfX1BSSVZBVEVfcXVlcnlFcXVhbHMpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfZXZlbnRNYW5hZ2VyTGlzdGVuKGUsIHQpIHtcbiAgICBjb25zdCBuID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKTtcbiAgICBsZXQgciA9IDMgLyogTGlzdGVuZXJTZXR1cEFjdGlvbi5Ob0FjdGlvblJlcXVpcmVkICovO1xuICAgIGNvbnN0IGkgPSB0LnF1ZXJ5O1xuICAgIGxldCBzID0gbi5xdWVyaWVzLmdldChpKTtcbiAgICBzID8gIXMuYmEoKSAmJiB0LkRhKCkgJiYgKFxuICAgIC8vIFF1ZXJ5IGhhcyBiZWVuIGxpc3RlbmluZyB0byBsb2NhbCBjYWNoZSwgYW5kIHRyaWVzIHRvIGFkZCBhIG5ldyBsaXN0ZW5lciBzb3VyY2VkIGZyb20gd2F0Y2guXG4gICAgciA9IDIgLyogTGlzdGVuZXJTZXR1cEFjdGlvbi5SZXF1aXJlV2F0Y2hDb25uZWN0aW9uT25seSAqLykgOiAocyA9IG5ldyBfX1BSSVZBVEVfUXVlcnlMaXN0ZW5lcnNJbmZvLCBcbiAgICByID0gdC5EYSgpID8gMCAvKiBMaXN0ZW5lclNldHVwQWN0aW9uLkluaXRpYWxpemVMb2NhbExpc3RlbkFuZFJlcXVpcmVXYXRjaENvbm5lY3Rpb24gKi8gOiAxIC8qIExpc3RlbmVyU2V0dXBBY3Rpb24uSW5pdGlhbGl6ZUxvY2FsTGlzdGVuT25seSAqLyk7XG4gICAgdHJ5IHtcbiAgICAgICAgc3dpdGNoIChyKSB7XG4gICAgICAgICAgY2FzZSAwIC8qIExpc3RlbmVyU2V0dXBBY3Rpb24uSW5pdGlhbGl6ZUxvY2FsTGlzdGVuQW5kUmVxdWlyZVdhdGNoQ29ubmVjdGlvbiAqLyA6XG4gICAgICAgICAgICBzLndhID0gYXdhaXQgbi5vbkxpc3RlbihpLCBcbiAgICAgICAgICAgIC8qKiBlbmFibGVSZW1vdGVMaXN0ZW49ICovICEwKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAxIC8qIExpc3RlbmVyU2V0dXBBY3Rpb24uSW5pdGlhbGl6ZUxvY2FsTGlzdGVuT25seSAqLyA6XG4gICAgICAgICAgICBzLndhID0gYXdhaXQgbi5vbkxpc3RlbihpLCBcbiAgICAgICAgICAgIC8qKiBlbmFibGVSZW1vdGVMaXN0ZW49ICovICExKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAyIC8qIExpc3RlbmVyU2V0dXBBY3Rpb24uUmVxdWlyZVdhdGNoQ29ubmVjdGlvbk9ubHkgKi8gOlxuICAgICAgICAgICAgYXdhaXQgbi5vbkZpcnN0UmVtb3RlU3RvcmVMaXN0ZW4oaSk7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfd3JhcEluVXNlckVycm9ySWZSZWNvdmVyYWJsZShlLCBgSW5pdGlhbGl6YXRpb24gb2YgcXVlcnkgJyR7X19QUklWQVRFX3N0cmluZ2lmeVF1ZXJ5KHQucXVlcnkpfScgZmFpbGVkYCk7XG4gICAgICAgIHJldHVybiB2b2lkIHQub25FcnJvcihuKTtcbiAgICB9XG4gICAgaWYgKG4ucXVlcmllcy5zZXQoaSwgcyksIHMuU2EucHVzaCh0KSwgXG4gICAgLy8gUnVuIGdsb2JhbCBzbmFwc2hvdCBsaXN0ZW5lcnMgaWYgYSBjb25zaXN0ZW50IHNuYXBzaG90IGhhcyBiZWVuIGVtaXR0ZWQuXG4gICAgdC52YShuLm9ubGluZVN0YXRlKSwgcy53YSkge1xuICAgICAgICB0LkZhKHMud2EpICYmIF9fUFJJVkFURV9yYWlzZVNuYXBzaG90c0luU3luY0V2ZW50KG4pO1xuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gX19QUklWQVRFX2V2ZW50TWFuYWdlclVubGlzdGVuKGUsIHQpIHtcbiAgICBjb25zdCBuID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKSwgciA9IHQucXVlcnk7XG4gICAgbGV0IGkgPSAzIC8qIExpc3RlbmVyUmVtb3ZhbEFjdGlvbi5Ob0FjdGlvblJlcXVpcmVkICovO1xuICAgIGNvbnN0IHMgPSBuLnF1ZXJpZXMuZ2V0KHIpO1xuICAgIGlmIChzKSB7XG4gICAgICAgIGNvbnN0IGUgPSBzLlNhLmluZGV4T2YodCk7XG4gICAgICAgIGUgPj0gMCAmJiAocy5TYS5zcGxpY2UoZSwgMSksIDAgPT09IHMuU2EubGVuZ3RoID8gaSA9IHQuRGEoKSA/IDAgLyogTGlzdGVuZXJSZW1vdmFsQWN0aW9uLlRlcm1pbmF0ZUxvY2FsTGlzdGVuQW5kUmVxdWlyZVdhdGNoRGlzY29ubmVjdGlvbiAqLyA6IDEgLyogTGlzdGVuZXJSZW1vdmFsQWN0aW9uLlRlcm1pbmF0ZUxvY2FsTGlzdGVuT25seSAqLyA6ICFzLmJhKCkgJiYgdC5EYSgpICYmIChcbiAgICAgICAgLy8gVGhlIHJlbW92ZWQgbGlzdGVuZXIgaXMgdGhlIGxhc3Qgb25lIHRoYXQgc291cmNlZCBmcm9tIHdhdGNoLlxuICAgICAgICBpID0gMiAvKiBMaXN0ZW5lclJlbW92YWxBY3Rpb24uUmVxdWlyZVdhdGNoRGlzY29ubmVjdGlvbk9ubHkgKi8pKTtcbiAgICB9XG4gICAgc3dpdGNoIChpKSB7XG4gICAgICBjYXNlIDAgLyogTGlzdGVuZXJSZW1vdmFsQWN0aW9uLlRlcm1pbmF0ZUxvY2FsTGlzdGVuQW5kUmVxdWlyZVdhdGNoRGlzY29ubmVjdGlvbiAqLyA6XG4gICAgICAgIHJldHVybiBuLnF1ZXJpZXMuZGVsZXRlKHIpLCBuLm9uVW5saXN0ZW4ociwgXG4gICAgICAgIC8qKiBkaXNhYmxlUmVtb3RlTGlzdGVuPSAqLyAhMCk7XG5cbiAgICAgIGNhc2UgMSAvKiBMaXN0ZW5lclJlbW92YWxBY3Rpb24uVGVybWluYXRlTG9jYWxMaXN0ZW5Pbmx5ICovIDpcbiAgICAgICAgcmV0dXJuIG4ucXVlcmllcy5kZWxldGUociksIG4ub25Vbmxpc3RlbihyLCBcbiAgICAgICAgLyoqIGRpc2FibGVSZW1vdGVMaXN0ZW49ICovICExKTtcblxuICAgICAgY2FzZSAyIC8qIExpc3RlbmVyUmVtb3ZhbEFjdGlvbi5SZXF1aXJlV2F0Y2hEaXNjb25uZWN0aW9uT25seSAqLyA6XG4gICAgICAgIHJldHVybiBuLm9uTGFzdFJlbW90ZVN0b3JlVW5saXN0ZW4ocik7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybjtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9ldmVudE1hbmFnZXJPbldhdGNoQ2hhbmdlKGUsIHQpIHtcbiAgICBjb25zdCBuID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKTtcbiAgICBsZXQgciA9ICExO1xuICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XG4gICAgICAgIGNvbnN0IHQgPSBlLnF1ZXJ5LCBpID0gbi5xdWVyaWVzLmdldCh0KTtcbiAgICAgICAgaWYgKGkpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBpLlNhKSB0LkZhKGUpICYmIChyID0gITApO1xuICAgICAgICAgICAgaS53YSA9IGU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgciAmJiBfX1BSSVZBVEVfcmFpc2VTbmFwc2hvdHNJblN5bmNFdmVudChuKTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2V2ZW50TWFuYWdlck9uV2F0Y2hFcnJvcihlLCB0LCBuKSB7XG4gICAgY29uc3QgciA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSksIGkgPSByLnF1ZXJpZXMuZ2V0KHQpO1xuICAgIGlmIChpKSBmb3IgKGNvbnN0IGUgb2YgaS5TYSkgZS5vbkVycm9yKG4pO1xuICAgIC8vIFJlbW92ZSBhbGwgbGlzdGVuZXJzLiBOT1RFOiBXZSBkb24ndCBuZWVkIHRvIGNhbGwgc3luY0VuZ2luZS51bmxpc3RlbigpXG4gICAgLy8gYWZ0ZXIgYW4gZXJyb3IuXG4gICAgICAgIHIucXVlcmllcy5kZWxldGUodCk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9yYWlzZVNuYXBzaG90c0luU3luY0V2ZW50KGUpIHtcbiAgICBlLkNhLmZvckVhY2goKGUgPT4ge1xuICAgICAgICBlLm5leHQoKTtcbiAgICB9KSk7XG59XG5cbnZhciBubiwgcm47XG5cbi8qKiBMaXN0ZW4gdG8gYm90aCBjYWNoZSBhbmQgc2VydmVyIGNoYW5nZXMgKi9cbihybiA9IG5uIHx8IChubiA9IHt9KSkuTWEgPSBcImRlZmF1bHRcIiwgXG4vKiogTGlzdGVuIHRvIGNoYW5nZXMgaW4gY2FjaGUgb25seSAqL1xucm4uQ2FjaGUgPSBcImNhY2hlXCI7XG5cbi8qKlxuICogUXVlcnlMaXN0ZW5lciB0YWtlcyBhIHNlcmllcyBvZiBpbnRlcm5hbCB2aWV3IHNuYXBzaG90cyBhbmQgZGV0ZXJtaW5lc1xuICogd2hlbiB0byByYWlzZSB0aGUgZXZlbnQuXG4gKlxuICogSXQgdXNlcyBhbiBPYnNlcnZlciB0byBkaXNwYXRjaCBldmVudHMuXG4gKi9cbmNsYXNzIF9fUFJJVkFURV9RdWVyeUxpc3RlbmVyIHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0LCBuKSB7XG4gICAgICAgIHRoaXMucXVlcnkgPSBlLCB0aGlzLnhhID0gdCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbml0aWFsIHNuYXBzaG90cyAoZS5nLiBmcm9tIGNhY2hlKSBtYXkgbm90IGJlIHByb3BhZ2F0ZWQgdG8gdGhlIHdyYXBwZWRcbiAgICAgICAgICogb2JzZXJ2ZXIuIFRoaXMgZmxhZyBpcyBzZXQgdG8gdHJ1ZSBvbmNlIHdlJ3ZlIGFjdHVhbGx5IHJhaXNlZCBhbiBldmVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuT2EgPSAhMSwgdGhpcy5OYSA9IG51bGwsIHRoaXMub25saW5lU3RhdGUgPSBcIlVua25vd25cIiAvKiBPbmxpbmVTdGF0ZS5Vbmtub3duICovICwgXG4gICAgICAgIHRoaXMub3B0aW9ucyA9IG4gfHwge307XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgdGhlIG5ldyBWaWV3U25hcHNob3QgdG8gdGhpcyBsaXN0ZW5lciwgcmFpc2luZyBhIHVzZXItZmFjaW5nIGV2ZW50XG4gICAgICogaWYgYXBwbGljYWJsZSAoZGVwZW5kaW5nIG9uIHdoYXQgY2hhbmdlZCwgd2hldGhlciB0aGUgdXNlciBoYXMgb3B0ZWQgaW50b1xuICAgICAqIG1ldGFkYXRhLW9ubHkgY2hhbmdlcywgZXRjLikuIFJldHVybnMgdHJ1ZSBpZiBhIHVzZXItZmFjaW5nIGV2ZW50IHdhc1xuICAgICAqIGluZGVlZCByYWlzZWQuXG4gICAgICovICAgIEZhKGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcykge1xuICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBtZXRhZGF0YSBvbmx5IGNoYW5nZXMuXG4gICAgICAgICAgICBjb25zdCB0ID0gW107XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgZS5kb2NDaGFuZ2VzKSAzIC8qIENoYW5nZVR5cGUuTWV0YWRhdGEgKi8gIT09IG4udHlwZSAmJiB0LnB1c2gobik7XG4gICAgICAgICAgICBlID0gbmV3IFZpZXdTbmFwc2hvdChlLnF1ZXJ5LCBlLmRvY3MsIGUub2xkRG9jcywgdCwgZS5tdXRhdGVkS2V5cywgZS5mcm9tQ2FjaGUsIGUuc3luY1N0YXRlQ2hhbmdlZCwgXG4gICAgICAgICAgICAvKiBleGNsdWRlc01ldGFkYXRhQ2hhbmdlcz0gKi8gITAsIGUuaGFzQ2FjaGVkUmVzdWx0cyk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHQgPSAhMTtcbiAgICAgICAgcmV0dXJuIHRoaXMuT2EgPyB0aGlzLkJhKGUpICYmICh0aGlzLnhhLm5leHQoZSksIHQgPSAhMCkgOiB0aGlzLkxhKGUsIHRoaXMub25saW5lU3RhdGUpICYmICh0aGlzLmthKGUpLCBcbiAgICAgICAgdCA9ICEwKSwgdGhpcy5OYSA9IGUsIHQ7XG4gICAgfVxuICAgIG9uRXJyb3IoZSkge1xuICAgICAgICB0aGlzLnhhLmVycm9yKGUpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyB3aGV0aGVyIGEgc25hcHNob3Qgd2FzIHJhaXNlZC4gKi8gICAgdmEoZSkge1xuICAgICAgICB0aGlzLm9ubGluZVN0YXRlID0gZTtcbiAgICAgICAgbGV0IHQgPSAhMTtcbiAgICAgICAgcmV0dXJuIHRoaXMuTmEgJiYgIXRoaXMuT2EgJiYgdGhpcy5MYSh0aGlzLk5hLCBlKSAmJiAodGhpcy5rYSh0aGlzLk5hKSwgdCA9ICEwKSwgXG4gICAgICAgIHQ7XG4gICAgfVxuICAgIExhKGUsIHQpIHtcbiAgICAgICAgLy8gQWx3YXlzIHJhaXNlIHRoZSBmaXJzdCBldmVudCB3aGVuIHdlJ3JlIHN5bmNlZFxuICAgICAgICBpZiAoIWUuZnJvbUNhY2hlKSByZXR1cm4gITA7XG4gICAgICAgIC8vIEFsd2F5cyByYWlzZSBldmVudCBpZiBsaXN0ZW5pbmcgdG8gY2FjaGVcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuRGEoKSkgcmV0dXJuICEwO1xuICAgICAgICAvLyBOT1RFOiBXZSBjb25zaWRlciBPbmxpbmVTdGF0ZS5Vbmtub3duIGFzIG9ubGluZSAoaXQgc2hvdWxkIGJlY29tZSBPZmZsaW5lXG4gICAgICAgIC8vIG9yIE9ubGluZSBpZiB3ZSB3YWl0IGxvbmcgZW5vdWdoKS5cbiAgICAgICAgICAgICAgICBjb25zdCBuID0gXCJPZmZsaW5lXCIgLyogT25saW5lU3RhdGUuT2ZmbGluZSAqLyAhPT0gdDtcbiAgICAgICAgLy8gRG9uJ3QgcmFpc2UgdGhlIGV2ZW50IGlmIHdlJ3JlIG9ubGluZSwgYXJlbid0IHN5bmNlZCB5ZXQgKGNoZWNrZWRcbiAgICAgICAgLy8gYWJvdmUpIGFuZCBhcmUgd2FpdGluZyBmb3IgYSBzeW5jLlxuICAgICAgICAgICAgICAgIHJldHVybiAoIXRoaXMub3B0aW9ucy5xYSB8fCAhbikgJiYgKCFlLmRvY3MuaXNFbXB0eSgpIHx8IGUuaGFzQ2FjaGVkUmVzdWx0cyB8fCBcIk9mZmxpbmVcIiAvKiBPbmxpbmVTdGF0ZS5PZmZsaW5lICovID09PSB0KTtcbiAgICAgICAgLy8gUmFpc2UgZGF0YSBmcm9tIGNhY2hlIGlmIHdlIGhhdmUgYW55IGRvY3VtZW50cywgaGF2ZSBjYWNoZWQgcmVzdWx0cyBiZWZvcmUsXG4gICAgICAgIC8vIG9yIHdlIGFyZSBvZmZsaW5lLlxuICAgICAgICB9XG4gICAgQmEoZSkge1xuICAgICAgICAvLyBXZSBkb24ndCBuZWVkIHRvIGhhbmRsZSBpbmNsdWRlRG9jdW1lbnRNZXRhZGF0YUNoYW5nZXMgaGVyZSBiZWNhdXNlXG4gICAgICAgIC8vIHRoZSBNZXRhZGF0YSBvbmx5IGNoYW5nZXMgaGF2ZSBhbHJlYWR5IGJlZW4gc3RyaXBwZWQgb3V0IGlmIG5lZWRlZC5cbiAgICAgICAgLy8gQXQgdGhpcyBwb2ludCB0aGUgb25seSBjaGFuZ2VzIHdlIHdpbGwgc2VlIGFyZSB0aGUgb25lcyB3ZSBzaG91bGRcbiAgICAgICAgLy8gcHJvcGFnYXRlLlxuICAgICAgICBpZiAoZS5kb2NDaGFuZ2VzLmxlbmd0aCA+IDApIHJldHVybiAhMDtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuTmEgJiYgdGhpcy5OYS5oYXNQZW5kaW5nV3JpdGVzICE9PSBlLmhhc1BlbmRpbmdXcml0ZXM7XG4gICAgICAgIHJldHVybiAhKCFlLnN5bmNTdGF0ZUNoYW5nZWQgJiYgIXQpICYmICEwID09PSB0aGlzLm9wdGlvbnMuaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcztcbiAgICAgICAgLy8gR2VuZXJhbGx5IHdlIHNob3VsZCBoYXZlIGhpdCBvbmUgb2YgdGhlIGNhc2VzIGFib3ZlLCBidXQgaXQncyBwb3NzaWJsZVxuICAgICAgICAvLyB0byBnZXQgaGVyZSBpZiB0aGVyZSB3ZXJlIG9ubHkgbWV0YWRhdGEgZG9jQ2hhbmdlcyBhbmQgdGhleSBnb3RcbiAgICAgICAgLy8gc3RyaXBwZWQgb3V0LlxuICAgICAgICB9XG4gICAga2EoZSkge1xuICAgICAgICBlID0gVmlld1NuYXBzaG90LmZyb21Jbml0aWFsRG9jdW1lbnRzKGUucXVlcnksIGUuZG9jcywgZS5tdXRhdGVkS2V5cywgZS5mcm9tQ2FjaGUsIGUuaGFzQ2FjaGVkUmVzdWx0cyksIFxuICAgICAgICB0aGlzLk9hID0gITAsIHRoaXMueGEubmV4dChlKTtcbiAgICB9XG4gICAgRGEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuc291cmNlICE9PSBubi5DYWNoZTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgY29tcGxldGUgZWxlbWVudCBpbiB0aGUgYnVuZGxlIHN0cmVhbSwgdG9nZXRoZXIgd2l0aCB0aGUgYnl0ZSBsZW5ndGggaXRcbiAqIG9jY3VwaWVzIGluIHRoZSBzdHJlYW0uXG4gKi8gY2xhc3MgX19QUklWQVRFX1NpemVkQnVuZGxlRWxlbWVudCB7XG4gICAgY29uc3RydWN0b3IoZSwgXG4gICAgLy8gSG93IG1hbnkgYnl0ZXMgdGhpcyBlbGVtZW50IHRha2VzIHRvIHN0b3JlIGluIHRoZSBidW5kbGUuXG4gICAgdCkge1xuICAgICAgICB0aGlzLlFhID0gZSwgdGhpcy5ieXRlTGVuZ3RoID0gdDtcbiAgICB9XG4gICAgJGEoKSB7XG4gICAgICAgIHJldHVybiBcIm1ldGFkYXRhXCIgaW4gdGhpcy5RYTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEhlbHBlciB0byBjb252ZXJ0IG9iamVjdHMgZnJvbSBidW5kbGVzIHRvIG1vZGVsIG9iamVjdHMgaW4gdGhlIFNESy5cbiAqLyBjbGFzcyBfX1BSSVZBVEVfQnVuZGxlQ29udmVydGVySW1wbCB7XG4gICAgY29uc3RydWN0b3IoZSkge1xuICAgICAgICB0aGlzLnNlcmlhbGl6ZXIgPSBlO1xuICAgIH1cbiAgICAkcyhlKSB7XG4gICAgICAgIHJldHVybiBmcm9tTmFtZSh0aGlzLnNlcmlhbGl6ZXIsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBhIEJ1bmRsZURvY3VtZW50IHRvIGEgTXV0YWJsZURvY3VtZW50LlxuICAgICAqLyAgICBVcyhlKSB7XG4gICAgICAgIHJldHVybiBlLm1ldGFkYXRhLmV4aXN0cyA/IF9fUFJJVkFURV9mcm9tRG9jdW1lbnQodGhpcy5zZXJpYWxpemVyLCBlLmRvY3VtZW50LCAhMSkgOiBNdXRhYmxlRG9jdW1lbnQubmV3Tm9Eb2N1bWVudCh0aGlzLiRzKGUubWV0YWRhdGEubmFtZSksIHRoaXMuS3MoZS5tZXRhZGF0YS5yZWFkVGltZSkpO1xuICAgIH1cbiAgICBLcyhlKSB7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfZnJvbVZlcnNpb24oZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgY2xhc3MgdG8gcHJvY2VzcyB0aGUgZWxlbWVudHMgZnJvbSBhIGJ1bmRsZSwgYW5kIG9wdGlvbmFsbHkgbG9hZCB0aGVtIGludG8gbG9jYWxcbiAqIHN0b3JhZ2UgYW5kIHByb3ZpZGUgcHJvZ3Jlc3MgdXBkYXRlIHdoaWxlIGxvYWRpbmcuXG4gKi8gY2xhc3MgX19QUklWQVRFX0J1bmRsZUxvYWRlciB7XG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICB0aGlzLlVhID0gZSwgdGhpcy5zZXJpYWxpemVyID0gdCwgXG4gICAgICAgIC8qKiBCYXRjaGVkIHF1ZXJpZXMgdG8gYmUgc2F2ZWQgaW50byBzdG9yYWdlICovXG4gICAgICAgIHRoaXMuS2EgPSBbXSwgXG4gICAgICAgIC8qKiBCYXRjaGVkIGRvY3VtZW50cyB0byBiZSBzYXZlZCBpbnRvIHN0b3JhZ2UgKi9cbiAgICAgICAgdGhpcy5XYSA9IFtdLCBcbiAgICAgICAgLyoqIFRoZSBjb2xsZWN0aW9uIGdyb3VwcyBhZmZlY3RlZCBieSB0aGlzIGJ1bmRsZS4gKi9cbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uR3JvdXBzID0gbmV3IFNldCwgdGhpcy5wcm9ncmVzcyA9IF9fUFJJVkFURV9idW5kbGVJbml0aWFsUHJvZ3Jlc3MoZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIG5hbWVkIHF1ZXJpZXMgdGhhdCBoYXZlIGJlZW4gcGFyc2VkIGZyb20gdGhlIFNpemVCdW5kbGVFbGVtZW50cyBhZGRlZCBieVxuICAgICAqIGNhbGxpbmcge0BsaW5rIGFkU2l6ZWRFbGVtZW50fS5cbiAgICAgKi8gICAgZ2V0IHF1ZXJpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkthO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBCdW5kbGVkRG9jdW1lbnRzIHRoYXQgaGF2ZSBiZWVuIHBhcnNlZCBmcm9tIHRoZSBTaXplQnVuZGxlRWxlbWVudHMgYWRkZWQgYnlcbiAgICAgKiBjYWxsaW5nIHtAbGluayBhZGRTaXplZEVsZW1lbnR9LlxuICAgICAqLyAgICBnZXQgZG9jdW1lbnRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5XYTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhbiBlbGVtZW50IGZyb20gdGhlIGJ1bmRsZSB0byB0aGUgbG9hZGVyLlxuICAgICAqXG4gICAgICogUmV0dXJucyBhIG5ldyBwcm9ncmVzcyBpZiBhZGRpbmcgdGhlIGVsZW1lbnQgbGVhZHMgdG8gYSBuZXcgcHJvZ3Jlc3MsXG4gICAgICogb3RoZXJ3aXNlIHJldHVybnMgbnVsbC5cbiAgICAgKi8gICAgR2EoZSkge1xuICAgICAgICB0aGlzLnByb2dyZXNzLmJ5dGVzTG9hZGVkICs9IGUuYnl0ZUxlbmd0aDtcbiAgICAgICAgbGV0IHQgPSB0aGlzLnByb2dyZXNzLmRvY3VtZW50c0xvYWRlZDtcbiAgICAgICAgaWYgKGUuUWEubmFtZWRRdWVyeSkgdGhpcy5LYS5wdXNoKGUuUWEubmFtZWRRdWVyeSk7IGVsc2UgaWYgKGUuUWEuZG9jdW1lbnRNZXRhZGF0YSkge1xuICAgICAgICAgICAgdGhpcy5XYS5wdXNoKHtcbiAgICAgICAgICAgICAgICBtZXRhZGF0YTogZS5RYS5kb2N1bWVudE1ldGFkYXRhXG4gICAgICAgICAgICB9KSwgZS5RYS5kb2N1bWVudE1ldGFkYXRhLmV4aXN0cyB8fCArK3Q7XG4gICAgICAgICAgICBjb25zdCBuID0gUmVzb3VyY2VQYXRoLmZyb21TdHJpbmcoZS5RYS5kb2N1bWVudE1ldGFkYXRhLm5hbWUpO1xuICAgICAgICAgICAgdGhpcy5jb2xsZWN0aW9uR3JvdXBzLmFkZChuLmdldChuLmxlbmd0aCAtIDIpKTtcbiAgICAgICAgfSBlbHNlIGUuUWEuZG9jdW1lbnQgJiYgKHRoaXMuV2FbdGhpcy5XYS5sZW5ndGggLSAxXS5kb2N1bWVudCA9IGUuUWEuZG9jdW1lbnQsICsrdCk7XG4gICAgICAgIHJldHVybiB0ICE9PSB0aGlzLnByb2dyZXNzLmRvY3VtZW50c0xvYWRlZCA/ICh0aGlzLnByb2dyZXNzLmRvY3VtZW50c0xvYWRlZCA9IHQsIFxuICAgICAgICB7XG4gICAgICAgICAgICAuLi50aGlzLnByb2dyZXNzXG4gICAgICAgIH0pIDogbnVsbDtcbiAgICB9XG4gICAgemEoZSkge1xuICAgICAgICBjb25zdCB0ID0gbmV3IE1hcCwgbiA9IG5ldyBfX1BSSVZBVEVfQnVuZGxlQ29udmVydGVySW1wbCh0aGlzLnNlcmlhbGl6ZXIpO1xuICAgICAgICBmb3IgKGNvbnN0IHIgb2YgZSkgaWYgKHIubWV0YWRhdGEucXVlcmllcykge1xuICAgICAgICAgICAgY29uc3QgZSA9IG4uJHMoci5tZXRhZGF0YS5uYW1lKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbiBvZiByLm1ldGFkYXRhLnF1ZXJpZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByID0gKHQuZ2V0KG4pIHx8IF9fUFJJVkFURV9kb2N1bWVudEtleVNldCgpKS5hZGQoZSk7XG4gICAgICAgICAgICAgICAgdC5zZXQobiwgcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgcHJvZ3Jlc3MgdG8gJ1N1Y2Nlc3MnIGFuZCByZXR1cm4gdGhlIHVwZGF0ZWQgcHJvZ3Jlc3MuXG4gICAgICovICAgIGFzeW5jIGphKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IGF3YWl0IF9fUFJJVkFURV9sb2NhbFN0b3JlQXBwbHlCdW5kbGVkRG9jdW1lbnRzKGUsIG5ldyBfX1BSSVZBVEVfQnVuZGxlQ29udmVydGVySW1wbCh0aGlzLnNlcmlhbGl6ZXIpLCB0aGlzLldhLCB0aGlzLlVhLmlkKSwgbiA9IHRoaXMuemEodGhpcy5kb2N1bWVudHMpO1xuICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5LYSkgYXdhaXQgX19QUklWQVRFX2xvY2FsU3RvcmVTYXZlTmFtZWRRdWVyeShlLCB0LCBuLmdldCh0Lm5hbWUpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvZ3Jlc3MudGFza1N0YXRlID0gXCJTdWNjZXNzXCIsIHtcbiAgICAgICAgICAgIHByb2dyZXNzOiB0aGlzLnByb2dyZXNzLFxuICAgICAgICAgICAgSmE6IHRoaXMuY29sbGVjdGlvbkdyb3VwcyxcbiAgICAgICAgICAgIEhhOiB0XG4gICAgICAgIH07XG4gICAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgYSBgTG9hZEJ1bmRsZVRhc2tQcm9ncmVzc2AgcmVwcmVzZW50aW5nIHRoZSBpbml0aWFsIHByb2dyZXNzIG9mXG4gKiBsb2FkaW5nIGEgYnVuZGxlLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9idW5kbGVJbml0aWFsUHJvZ3Jlc3MoZSkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHRhc2tTdGF0ZTogXCJSdW5uaW5nXCIsXG4gICAgICAgIGRvY3VtZW50c0xvYWRlZDogMCxcbiAgICAgICAgYnl0ZXNMb2FkZWQ6IDAsXG4gICAgICAgIHRvdGFsRG9jdW1lbnRzOiBlLnRvdGFsRG9jdW1lbnRzLFxuICAgICAgICB0b3RhbEJ5dGVzOiBlLnRvdGFsQnl0ZXNcbiAgICB9O1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBgTG9hZEJ1bmRsZVRhc2tQcm9ncmVzc2AgcmVwcmVzZW50aW5nIHRoZSBwcm9ncmVzcyB0aGF0IHRoZSBsb2FkaW5nXG4gKiBoYXMgc3VjY2VlZGVkLlxuICovXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3MgX19QUklWQVRFX0FkZGVkTGltYm9Eb2N1bWVudCB7XG4gICAgY29uc3RydWN0b3IoZSkge1xuICAgICAgICB0aGlzLmtleSA9IGU7XG4gICAgfVxufVxuXG5jbGFzcyBfX1BSSVZBVEVfUmVtb3ZlZExpbWJvRG9jdW1lbnQge1xuICAgIGNvbnN0cnVjdG9yKGUpIHtcbiAgICAgICAgdGhpcy5rZXkgPSBlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBWaWV3IGlzIHJlc3BvbnNpYmxlIGZvciBjb21wdXRpbmcgdGhlIGZpbmFsIG1lcmdlZCB0cnV0aCBvZiB3aGF0IGRvY3MgYXJlIGluXG4gKiBhIHF1ZXJ5LiBJdCBnZXRzIG5vdGlmaWVkIG9mIGxvY2FsIGFuZCByZW1vdGUgY2hhbmdlcyB0byBkb2NzLCBhbmQgYXBwbGllc1xuICogdGhlIHF1ZXJ5IGZpbHRlcnMgYW5kIGxpbWl0cyB0byBkZXRlcm1pbmUgdGhlIG1vc3QgY29ycmVjdCBwb3NzaWJsZSByZXN1bHRzLlxuICovIGNsYXNzIF9fUFJJVkFURV9WaWV3IHtcbiAgICBjb25zdHJ1Y3RvcihlLCBcbiAgICAvKiogRG9jdW1lbnRzIGluY2x1ZGVkIGluIHRoZSByZW1vdGUgdGFyZ2V0ICovXG4gICAgdCkge1xuICAgICAgICB0aGlzLnF1ZXJ5ID0gZSwgdGhpcy5ZYSA9IHQsIHRoaXMuWmEgPSBudWxsLCB0aGlzLmhhc0NhY2hlZFJlc3VsdHMgPSAhMSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGZsYWcgd2hldGhlciB0aGUgdmlldyBpcyBjdXJyZW50IHdpdGggdGhlIGJhY2tlbmQuIEEgdmlldyBpcyBjb25zaWRlcmVkXG4gICAgICAgICAqIGN1cnJlbnQgYWZ0ZXIgaXQgaGFzIHNlZW4gdGhlIGN1cnJlbnQgZmxhZyBmcm9tIHRoZSBiYWNrZW5kIGFuZCBkaWQgbm90XG4gICAgICAgICAqIGxvc2UgY29uc2lzdGVuY3kgd2l0aGluIHRoZSB3YXRjaCBzdHJlYW0gKGUuZy4gYmVjYXVzZSBvZiBhbiBleGlzdGVuY2VcbiAgICAgICAgICogZmlsdGVyIG1pc21hdGNoKS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY3VycmVudCA9ICExLCBcbiAgICAgICAgLyoqIERvY3VtZW50cyBpbiB0aGUgdmlldyBidXQgbm90IGluIHRoZSByZW1vdGUgdGFyZ2V0ICovXG4gICAgICAgIHRoaXMuWGEgPSBfX1BSSVZBVEVfZG9jdW1lbnRLZXlTZXQoKSwgXG4gICAgICAgIC8qKiBEb2N1bWVudCBLZXlzIHRoYXQgaGF2ZSBsb2NhbCBjaGFuZ2VzICovXG4gICAgICAgIHRoaXMubXV0YXRlZEtleXMgPSBfX1BSSVZBVEVfZG9jdW1lbnRLZXlTZXQoKSwgdGhpcy5ldSA9IF9fUFJJVkFURV9uZXdRdWVyeUNvbXBhcmF0b3IoZSksIFxuICAgICAgICB0aGlzLnR1ID0gbmV3IERvY3VtZW50U2V0KHRoaXMuZXUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgc2V0IG9mIHJlbW90ZSBkb2N1bWVudHMgdGhhdCB0aGUgc2VydmVyIGhhcyB0b2xkIHVzIGJlbG9uZ3MgdG8gdGhlIHRhcmdldCBhc3NvY2lhdGVkIHdpdGhcbiAgICAgKiB0aGlzIHZpZXcuXG4gICAgICovICAgIGdldCBudSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuWWE7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEl0ZXJhdGVzIG92ZXIgYSBzZXQgb2YgZG9jIGNoYW5nZXMsIGFwcGxpZXMgdGhlIHF1ZXJ5IGxpbWl0LCBhbmQgY29tcHV0ZXNcbiAgICAgKiB3aGF0IHRoZSBuZXcgcmVzdWx0cyBzaG91bGQgYmUsIHdoYXQgdGhlIGNoYW5nZXMgd2VyZSwgYW5kIHdoZXRoZXIgd2UgbWF5XG4gICAgICogbmVlZCB0byBnbyBiYWNrIHRvIHRoZSBsb2NhbCBjYWNoZSBmb3IgbW9yZSByZXN1bHRzLiBEb2VzIG5vdCBtYWtlIGFueVxuICAgICAqIGNoYW5nZXMgdG8gdGhlIHZpZXcuXG4gICAgICogQHBhcmFtIGRvY0NoYW5nZXMgLSBUaGUgZG9jIGNoYW5nZXMgdG8gYXBwbHkgdG8gdGhpcyB2aWV3LlxuICAgICAqIEBwYXJhbSBwcmV2aW91c0NoYW5nZXMgLSBJZiB0aGlzIGlzIGJlaW5nIGNhbGxlZCB3aXRoIGEgcmVmaWxsLCB0aGVuIHN0YXJ0XG4gICAgICogICAgICAgIHdpdGggdGhpcyBzZXQgb2YgZG9jcyBhbmQgY2hhbmdlcyBpbnN0ZWFkIG9mIHRoZSBjdXJyZW50IHZpZXcuXG4gICAgICogQHJldHVybnMgYSBuZXcgc2V0IG9mIGRvY3MsIGNoYW5nZXMsIGFuZCByZWZpbGwgZmxhZy5cbiAgICAgKi8gICAgcnUoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gdCA/IHQuaXUgOiBuZXcgX19QUklWQVRFX0RvY3VtZW50Q2hhbmdlU2V0LCByID0gdCA/IHQudHUgOiB0aGlzLnR1O1xuICAgICAgICBsZXQgaSA9IHQgPyB0Lm11dGF0ZWRLZXlzIDogdGhpcy5tdXRhdGVkS2V5cywgcyA9IHIsIG8gPSAhMTtcbiAgICAgICAgLy8gVHJhY2sgdGhlIGxhc3QgZG9jIGluIGEgKGZ1bGwpIGxpbWl0LiBUaGlzIGlzIG5lY2Vzc2FyeSwgYmVjYXVzZSBzb21lXG4gICAgICAgIC8vIHVwZGF0ZSAoYSBkZWxldGUsIG9yIGFuIHVwZGF0ZSBtb3ZpbmcgYSBkb2MgcGFzdCB0aGUgb2xkIGxpbWl0KSBtaWdodFxuICAgICAgICAvLyBtZWFuIHRoZXJlIGlzIHNvbWUgb3RoZXIgZG9jdW1lbnQgaW4gdGhlIGxvY2FsIGNhY2hlIHRoYXQgZWl0aGVyIHNob3VsZFxuICAgICAgICAvLyBjb21lICgxKSBiZXR3ZWVuIHRoZSBvbGQgbGFzdCBsaW1pdCBkb2MgYW5kIHRoZSBuZXcgbGFzdCBkb2N1bWVudCwgaW4gdGhlXG4gICAgICAgIC8vIGNhc2Ugb2YgdXBkYXRlcywgb3IgKDIpIGFmdGVyIHRoZSBuZXcgbGFzdCBkb2N1bWVudCwgaW4gdGhlIGNhc2Ugb2ZcbiAgICAgICAgLy8gZGVsZXRlcy4gU28gd2Uga2VlcCB0aGlzIGRvYyBhdCB0aGUgb2xkIGxpbWl0IHRvIGNvbXBhcmUgdGhlIHVwZGF0ZXMgdG8uXG4gICAgICAgIC8vIE5vdGUgdGhhdCB0aGlzIHNob3VsZCBuZXZlciBnZXQgdXNlZCBpbiBhIHJlZmlsbCAod2hlbiBwcmV2aW91c0NoYW5nZXMgaXNcbiAgICAgICAgLy8gc2V0KSwgYmVjYXVzZSB0aGVyZSB3aWxsIG9ubHkgYmUgYWRkcyAtLSBubyBkZWxldGVzIG9yIHVwZGF0ZXMuXG4gICAgICAgIGNvbnN0IF8gPSBcIkZcIiAvKiBMaW1pdFR5cGUuRmlyc3QgKi8gPT09IHRoaXMucXVlcnkubGltaXRUeXBlICYmIHIuc2l6ZSA9PT0gdGhpcy5xdWVyeS5saW1pdCA/IHIubGFzdCgpIDogbnVsbCwgYSA9IFwiTFwiIC8qIExpbWl0VHlwZS5MYXN0ICovID09PSB0aGlzLnF1ZXJ5LmxpbWl0VHlwZSAmJiByLnNpemUgPT09IHRoaXMucXVlcnkubGltaXQgPyByLmZpcnN0KCkgOiBudWxsO1xuICAgICAgICAvLyBEcm9wIGRvY3VtZW50cyBvdXQgdG8gbWVldCBsaW1pdC9saW1pdFRvTGFzdCByZXF1aXJlbWVudC5cbiAgICAgICAgaWYgKGUuaW5vcmRlclRyYXZlcnNhbCgoKGUsIHQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHUgPSByLmdldChlKSwgYyA9IF9fUFJJVkFURV9xdWVyeU1hdGNoZXModGhpcy5xdWVyeSwgdCkgPyB0IDogbnVsbCwgbCA9ICEhdSAmJiB0aGlzLm11dGF0ZWRLZXlzLmhhcyh1LmtleSksIGggPSAhIWMgJiYgKGMuaGFzTG9jYWxNdXRhdGlvbnMgfHwgXG4gICAgICAgICAgICAvLyBXZSBvbmx5IGNvbnNpZGVyIGNvbW1pdHRlZCBtdXRhdGlvbnMgZm9yIGRvY3VtZW50cyB0aGF0IHdlcmVcbiAgICAgICAgICAgIC8vIG11dGF0ZWQgZHVyaW5nIHRoZSBsaWZldGltZSBvZiB0aGUgdmlldy5cbiAgICAgICAgICAgIHRoaXMubXV0YXRlZEtleXMuaGFzKGMua2V5KSAmJiBjLmhhc0NvbW1pdHRlZE11dGF0aW9ucyk7XG4gICAgICAgICAgICBsZXQgUCA9ICExO1xuICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGNoYW5nZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHUgJiYgYykge1xuICAgICAgICAgICAgICAgIHUuZGF0YS5pc0VxdWFsKGMuZGF0YSkgPyBsICE9PSBoICYmIChuLnRyYWNrKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogMyAvKiBDaGFuZ2VUeXBlLk1ldGFkYXRhICovICxcbiAgICAgICAgICAgICAgICAgICAgZG9jOiBjXG4gICAgICAgICAgICAgICAgfSksIFAgPSAhMCkgOiB0aGlzLnN1KHUsIGMpIHx8IChuLnRyYWNrKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogMiAvKiBDaGFuZ2VUeXBlLk1vZGlmaWVkICovICxcbiAgICAgICAgICAgICAgICAgICAgZG9jOiBjXG4gICAgICAgICAgICAgICAgfSksIFAgPSAhMCwgKF8gJiYgdGhpcy5ldShjLCBfKSA+IDAgfHwgYSAmJiB0aGlzLmV1KGMsIGEpIDwgMCkgJiYgKFxuICAgICAgICAgICAgICAgIC8vIFRoaXMgZG9jIG1vdmVkIGZyb20gaW5zaWRlIHRoZSBsaW1pdCB0byBvdXRzaWRlIHRoZSBsaW1pdC5cbiAgICAgICAgICAgICAgICAvLyBUaGF0IG1lYW5zIHRoZXJlIG1heSBiZSBzb21lIG90aGVyIGRvYyBpbiB0aGUgbG9jYWwgY2FjaGVcbiAgICAgICAgICAgICAgICAvLyB0aGF0IHNob3VsZCBiZSBpbmNsdWRlZCBpbnN0ZWFkLlxuICAgICAgICAgICAgICAgIG8gPSAhMCkpO1xuICAgICAgICAgICAgfSBlbHNlICF1ICYmIGMgPyAobi50cmFjayh7XG4gICAgICAgICAgICAgICAgdHlwZTogMCAvKiBDaGFuZ2VUeXBlLkFkZGVkICovICxcbiAgICAgICAgICAgICAgICBkb2M6IGNcbiAgICAgICAgICAgIH0pLCBQID0gITApIDogdSAmJiAhYyAmJiAobi50cmFjayh7XG4gICAgICAgICAgICAgICAgdHlwZTogMSAvKiBDaGFuZ2VUeXBlLlJlbW92ZWQgKi8gLFxuICAgICAgICAgICAgICAgIGRvYzogdVxuICAgICAgICAgICAgfSksIFAgPSAhMCwgKF8gfHwgYSkgJiYgKFxuICAgICAgICAgICAgLy8gQSBkb2Mgd2FzIHJlbW92ZWQgZnJvbSBhIGZ1bGwgbGltaXQgcXVlcnkuIFdlJ2xsIG5lZWQgdG9cbiAgICAgICAgICAgIC8vIHJlcXVlcnkgZnJvbSB0aGUgbG9jYWwgY2FjaGUgdG8gc2VlIGlmIHdlIGtub3cgYWJvdXQgc29tZSBvdGhlclxuICAgICAgICAgICAgLy8gZG9jIHRoYXQgc2hvdWxkIGJlIGluIHRoZSByZXN1bHRzLlxuICAgICAgICAgICAgbyA9ICEwKSk7XG4gICAgICAgICAgICBQICYmIChjID8gKHMgPSBzLmFkZChjKSwgaSA9IGggPyBpLmFkZChlKSA6IGkuZGVsZXRlKGUpKSA6IChzID0gcy5kZWxldGUoZSksIGkgPSBpLmRlbGV0ZShlKSkpO1xuICAgICAgICB9KSksIG51bGwgIT09IHRoaXMucXVlcnkubGltaXQpIGZvciAoO3Muc2l6ZSA+IHRoaXMucXVlcnkubGltaXQ7ICkge1xuICAgICAgICAgICAgY29uc3QgZSA9IFwiRlwiIC8qIExpbWl0VHlwZS5GaXJzdCAqLyA9PT0gdGhpcy5xdWVyeS5saW1pdFR5cGUgPyBzLmxhc3QoKSA6IHMuZmlyc3QoKTtcbiAgICAgICAgICAgIHMgPSBzLmRlbGV0ZShlLmtleSksIGkgPSBpLmRlbGV0ZShlLmtleSksIG4udHJhY2soe1xuICAgICAgICAgICAgICAgIHR5cGU6IDEgLyogQ2hhbmdlVHlwZS5SZW1vdmVkICovICxcbiAgICAgICAgICAgICAgICBkb2M6IGVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0dTogcyxcbiAgICAgICAgICAgIGl1OiBuLFxuICAgICAgICAgICAgQ3M6IG8sXG4gICAgICAgICAgICBtdXRhdGVkS2V5czogaVxuICAgICAgICB9O1xuICAgIH1cbiAgICBzdShlLCB0KSB7XG4gICAgICAgIC8vIFdlIHN1cHByZXNzIHRoZSBpbml0aWFsIGNoYW5nZSBldmVudCBmb3IgZG9jdW1lbnRzIHRoYXQgd2VyZSBtb2RpZmllZCBhc1xuICAgICAgICAvLyBwYXJ0IG9mIGEgd3JpdGUgYWNrbm93bGVkZ21lbnQgKGUuZy4gd2hlbiB0aGUgdmFsdWUgb2YgYSBzZXJ2ZXIgdHJhbnNmb3JtXG4gICAgICAgIC8vIGlzIGFwcGxpZWQpIGFzIFdhdGNoIHdpbGwgc2VuZCB1cyB0aGUgc2FtZSBkb2N1bWVudCBhZ2Fpbi5cbiAgICAgICAgLy8gQnkgc3VwcHJlc3NpbmcgdGhlIGV2ZW50LCB3ZSBvbmx5IHJhaXNlIHR3byB1c2VyIHZpc2libGUgZXZlbnRzIChvbmUgd2l0aFxuICAgICAgICAvLyBgaGFzUGVuZGluZ1dyaXRlc2AgYW5kIHRoZSBmaW5hbCBzdGF0ZSBvZiB0aGUgZG9jdW1lbnQpIGluc3RlYWQgb2YgdGhyZWVcbiAgICAgICAgLy8gKG9uZSB3aXRoIGBoYXNQZW5kaW5nV3JpdGVzYCwgdGhlIG1vZGlmaWVkIGRvY3VtZW50IHdpdGhcbiAgICAgICAgLy8gYGhhc1BlbmRpbmdXcml0ZXNgIGFuZCB0aGUgZmluYWwgc3RhdGUgb2YgdGhlIGRvY3VtZW50KS5cbiAgICAgICAgcmV0dXJuIGUuaGFzTG9jYWxNdXRhdGlvbnMgJiYgdC5oYXNDb21taXR0ZWRNdXRhdGlvbnMgJiYgIXQuaGFzTG9jYWxNdXRhdGlvbnM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIHZpZXcgd2l0aCB0aGUgZ2l2ZW4gVmlld0RvY3VtZW50Q2hhbmdlcyBhbmQgb3B0aW9uYWxseSB1cGRhdGVzXG4gICAgICogbGltYm8gZG9jcyBhbmQgc3luYyBzdGF0ZSBmcm9tIHRoZSBwcm92aWRlZCB0YXJnZXQgY2hhbmdlLlxuICAgICAqIEBwYXJhbSBkb2NDaGFuZ2VzIC0gVGhlIHNldCBvZiBjaGFuZ2VzIHRvIG1ha2UgdG8gdGhlIHZpZXcncyBkb2NzLlxuICAgICAqIEBwYXJhbSBsaW1ib1Jlc29sdXRpb25FbmFibGVkIC0gV2hldGhlciB0byB1cGRhdGUgbGltYm8gZG9jdW1lbnRzIGJhc2VkIG9uXG4gICAgICogICAgICAgIHRoaXMgY2hhbmdlLlxuICAgICAqIEBwYXJhbSB0YXJnZXRDaGFuZ2UgLSBBIHRhcmdldCBjaGFuZ2UgdG8gYXBwbHkgZm9yIGNvbXB1dGluZyBsaW1ibyBkb2NzIGFuZFxuICAgICAqICAgICAgICBzeW5jIHN0YXRlLlxuICAgICAqIEBwYXJhbSB0YXJnZXRJc1BlbmRpbmdSZXNldCAtIFdoZXRoZXIgdGhlIHRhcmdldCBpcyBwZW5kaW5nIHRvIHJlc2V0IGR1ZSB0b1xuICAgICAqICAgICAgICBleGlzdGVuY2UgZmlsdGVyIG1pc21hdGNoLiBJZiBub3QgZXhwbGljaXRseSBzcGVjaWZpZWQsIGl0IGlzIHRyZWF0ZWRcbiAgICAgKiAgICAgICAgZXF1aXZhbGVudGx5IHRvIGBmYWxzZWAuXG4gICAgICogQHJldHVybnMgQSBuZXcgVmlld0NoYW5nZSB3aXRoIHRoZSBnaXZlbiBkb2NzLCBjaGFuZ2VzLCBhbmQgc3luYyBzdGF0ZS5cbiAgICAgKi9cbiAgICAvLyBQT1JUSU5HIE5PVEU6IFRoZSBpT1MvQW5kcm9pZCBjbGllbnRzIGFsd2F5cyBjb21wdXRlIGxpbWJvIGRvY3VtZW50IGNoYW5nZXMuXG4gICAgYXBwbHlDaGFuZ2VzKGUsIHQsIG4sIHIpIHtcbiAgICAgICAgY29uc3QgaSA9IHRoaXMudHU7XG4gICAgICAgIHRoaXMudHUgPSBlLnR1LCB0aGlzLm11dGF0ZWRLZXlzID0gZS5tdXRhdGVkS2V5cztcbiAgICAgICAgLy8gU29ydCBjaGFuZ2VzIGJhc2VkIG9uIHR5cGUgYW5kIHF1ZXJ5IGNvbXBhcmF0b3JcbiAgICAgICAgY29uc3QgcyA9IGUuaXUueWEoKTtcbiAgICAgICAgcy5zb3J0KCgoZSwgdCkgPT4gZnVuY3Rpb24gX19QUklWQVRFX2NvbXBhcmVDaGFuZ2VUeXBlKGUsIHQpIHtcbiAgICAgICAgICAgIGNvbnN0IG9yZGVyID0gZSA9PiB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICBjYXNlIDAgLyogQ2hhbmdlVHlwZS5BZGRlZCAqLyA6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xuXG4gICAgICAgICAgICAgICAgICBjYXNlIDIgLyogQ2hhbmdlVHlwZS5Nb2RpZmllZCAqLyA6XG4gICAgICAgICAgICAgICAgICBjYXNlIDMgLyogQ2hhbmdlVHlwZS5NZXRhZGF0YSAqLyA6XG4gICAgICAgICAgICAgICAgICAgIC8vIEEgbWV0YWRhdGEgY2hhbmdlIGlzIGNvbnZlcnRlZCB0byBhIG1vZGlmaWVkIGNoYW5nZSBhdCB0aGUgcHVibGljXG4gICAgICAgICAgICAgICAgICAgIC8vIGFwaSBsYXllci4gIFNpbmNlIHdlIHNvcnQgYnkgZG9jdW1lbnQga2V5IGFuZCB0aGVuIGNoYW5nZSB0eXBlLFxuICAgICAgICAgICAgICAgICAgICAvLyBtZXRhZGF0YSBhbmQgbW9kaWZpZWQgY2hhbmdlcyBtdXN0IGJlIHNvcnRlZCBlcXVpdmFsZW50bHkuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAyO1xuXG4gICAgICAgICAgICAgICAgICBjYXNlIDEgLyogQ2hhbmdlVHlwZS5SZW1vdmVkICovIDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG5cbiAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWlsKDIwMjc3LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBSdDogZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIG9yZGVyKGUpIC0gb3JkZXIodCk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gKGUudHlwZSwgdC50eXBlKSB8fCB0aGlzLmV1KGUuZG9jLCB0LmRvYykpKSwgdGhpcy5vdShuKSwgciA9IHIgPz8gITE7XG4gICAgICAgIGNvbnN0IG8gPSB0ICYmICFyID8gdGhpcy5fdSgpIDogW10sIF8gPSAwID09PSB0aGlzLlhhLnNpemUgJiYgdGhpcy5jdXJyZW50ICYmICFyID8gMSAvKiBTeW5jU3RhdGUuU3luY2VkICovIDogMCAvKiBTeW5jU3RhdGUuTG9jYWwgKi8gLCBhID0gXyAhPT0gdGhpcy5aYTtcbiAgICAgICAgLy8gV2UgYXJlIGF0IHN5bmNlZCBzdGF0ZSBpZiB0aGVyZSBpcyBubyBsaW1ibyBkb2NzIGFyZSB3YWl0aW5nIHRvIGJlIHJlc29sdmVkLCB2aWV3IGlzIGN1cnJlbnRcbiAgICAgICAgLy8gd2l0aCB0aGUgYmFja2VuZCwgYW5kIHRoZSBxdWVyeSBpcyBub3QgcGVuZGluZyB0byByZXNldCBkdWUgdG8gZXhpc3RlbmNlIGZpbHRlciBtaXNtYXRjaC5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5aYSA9IF8sIDAgIT09IHMubGVuZ3RoIHx8IGEpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc25hcHNob3Q6IG5ldyBWaWV3U25hcHNob3QodGhpcy5xdWVyeSwgZS50dSwgaSwgcywgZS5tdXRhdGVkS2V5cywgMCAvKiBTeW5jU3RhdGUuTG9jYWwgKi8gPT09IF8sIGEsIFxuICAgICAgICAgICAgICAgIC8qIGV4Y2x1ZGVzTWV0YWRhdGFDaGFuZ2VzPSAqLyAhMSwgISFuICYmIG4ucmVzdW1lVG9rZW4uYXBwcm94aW1hdGVCeXRlU2l6ZSgpID4gMCksXG4gICAgICAgICAgICAgICAgYXU6IG9cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgLy8gbm8gY2hhbmdlc1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYXU6IG9cbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXBwbGllcyBhbiBPbmxpbmVTdGF0ZSBjaGFuZ2UgdG8gdGhlIHZpZXcsIHBvdGVudGlhbGx5IGdlbmVyYXRpbmcgYVxuICAgICAqIFZpZXdDaGFuZ2UgaWYgdGhlIHZpZXcncyBzeW5jU3RhdGUgY2hhbmdlcyBhcyBhIHJlc3VsdC5cbiAgICAgKi8gICAgdmEoZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50ICYmIFwiT2ZmbGluZVwiIC8qIE9ubGluZVN0YXRlLk9mZmxpbmUgKi8gPT09IGUgPyAoXG4gICAgICAgIC8vIElmIHdlJ3JlIG9mZmxpbmUsIHNldCBgY3VycmVudGAgdG8gZmFsc2UgYW5kIHRoZW4gY2FsbCBhcHBseUNoYW5nZXMoKVxuICAgICAgICAvLyB0byByZWZyZXNoIG91ciBzeW5jU3RhdGUgYW5kIGdlbmVyYXRlIGEgVmlld0NoYW5nZSBhcyBhcHByb3ByaWF0ZS4gV2VcbiAgICAgICAgLy8gYXJlIGd1YXJhbnRlZWQgdG8gZ2V0IGEgbmV3IFRhcmdldENoYW5nZSB0aGF0IHNldHMgYGN1cnJlbnRgIGJhY2sgdG9cbiAgICAgICAgLy8gdHJ1ZSBvbmNlIHRoZSBjbGllbnQgaXMgYmFjayBvbmxpbmUuXG4gICAgICAgIHRoaXMuY3VycmVudCA9ICExLCB0aGlzLmFwcGx5Q2hhbmdlcyh7XG4gICAgICAgICAgICB0dTogdGhpcy50dSxcbiAgICAgICAgICAgIGl1OiBuZXcgX19QUklWQVRFX0RvY3VtZW50Q2hhbmdlU2V0LFxuICAgICAgICAgICAgbXV0YXRlZEtleXM6IHRoaXMubXV0YXRlZEtleXMsXG4gICAgICAgICAgICBDczogITFcbiAgICAgICAgfSwgXG4gICAgICAgIC8qIGxpbWJvUmVzb2x1dGlvbkVuYWJsZWQ9ICovICExKSkgOiB7XG4gICAgICAgICAgICBhdTogW11cbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB3aGV0aGVyIHRoZSBkb2MgZm9yIHRoZSBnaXZlbiBrZXkgc2hvdWxkIGJlIGluIGxpbWJvLlxuICAgICAqLyAgICB1dShlKSB7XG4gICAgICAgIC8vIElmIHRoZSByZW1vdGUgZW5kIHNheXMgaXQncyBwYXJ0IG9mIHRoaXMgcXVlcnksIGl0J3Mgbm90IGluIGxpbWJvLlxuICAgICAgICByZXR1cm4gIXRoaXMuWWEuaGFzKGUpICYmIChcbiAgICAgICAgLy8gVGhlIGxvY2FsIHN0b3JlIGRvZXNuJ3QgdGhpbmsgaXQncyBhIHJlc3VsdCwgc28gaXQgc2hvdWxkbid0IGJlIGluIGxpbWJvLlxuICAgICAgICAhIXRoaXMudHUuaGFzKGUpICYmICF0aGlzLnR1LmdldChlKS5oYXNMb2NhbE11dGF0aW9ucyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgc3luY2VkRG9jdW1lbnRzLCBjdXJyZW50LCBhbmQgbGltYm8gZG9jcyBiYXNlZCBvbiB0aGUgZ2l2ZW4gY2hhbmdlLlxuICAgICAqIFJldHVybnMgdGhlIGxpc3Qgb2YgY2hhbmdlcyB0byB3aGljaCBkb2NzIGFyZSBpbiBsaW1iby5cbiAgICAgKi8gICAgb3UoZSkge1xuICAgICAgICBlICYmIChlLmFkZGVkRG9jdW1lbnRzLmZvckVhY2goKGUgPT4gdGhpcy5ZYSA9IHRoaXMuWWEuYWRkKGUpKSksIGUubW9kaWZpZWREb2N1bWVudHMuZm9yRWFjaCgoZSA9PiB7fSkpLCBcbiAgICAgICAgZS5yZW1vdmVkRG9jdW1lbnRzLmZvckVhY2goKGUgPT4gdGhpcy5ZYSA9IHRoaXMuWWEuZGVsZXRlKGUpKSksIHRoaXMuY3VycmVudCA9IGUuY3VycmVudCk7XG4gICAgfVxuICAgIF91KCkge1xuICAgICAgICAvLyBXZSBjYW4gb25seSBkZXRlcm1pbmUgbGltYm8gZG9jdW1lbnRzIHdoZW4gd2UncmUgaW4tc3luYyB3aXRoIHRoZSBzZXJ2ZXIuXG4gICAgICAgIGlmICghdGhpcy5jdXJyZW50KSByZXR1cm4gW107XG4gICAgICAgIC8vIFRPRE8oa2xpbXQpOiBEbyB0aGlzIGluY3JlbWVudGFsbHkgc28gdGhhdCBpdCdzIG5vdCBxdWFkcmF0aWMgd2hlblxuICAgICAgICAvLyB1cGRhdGluZyBtYW55IGRvY3VtZW50cy5cbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5YYTtcbiAgICAgICAgdGhpcy5YYSA9IF9fUFJJVkFURV9kb2N1bWVudEtleVNldCgpLCB0aGlzLnR1LmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgdGhpcy51dShlLmtleSkgJiYgKHRoaXMuWGEgPSB0aGlzLlhhLmFkZChlLmtleSkpO1xuICAgICAgICB9KSk7XG4gICAgICAgIC8vIERpZmYgdGhlIG5ldyBsaW1ibyBkb2NzIHdpdGggdGhlIG9sZCBsaW1ibyBkb2NzLlxuICAgICAgICBjb25zdCB0ID0gW107XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgdGhpcy5YYS5oYXMoZSkgfHwgdC5wdXNoKG5ldyBfX1BSSVZBVEVfUmVtb3ZlZExpbWJvRG9jdW1lbnQoZSkpO1xuICAgICAgICB9KSksIHRoaXMuWGEuZm9yRWFjaCgobiA9PiB7XG4gICAgICAgICAgICBlLmhhcyhuKSB8fCB0LnB1c2gobmV3IF9fUFJJVkFURV9BZGRlZExpbWJvRG9jdW1lbnQobikpO1xuICAgICAgICB9KSksIHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgaW4tbWVtb3J5IHN0YXRlIG9mIHRoZSBjdXJyZW50IHZpZXcgd2l0aCB0aGUgc3RhdGUgcmVhZCBmcm9tXG4gICAgICogcGVyc2lzdGVuY2UuXG4gICAgICpcbiAgICAgKiBXZSB1cGRhdGUgdGhlIHF1ZXJ5IHZpZXcgd2hlbmV2ZXIgYSBjbGllbnQncyBwcmltYXJ5IHN0YXR1cyBjaGFuZ2VzOlxuICAgICAqIC0gV2hlbiBhIGNsaWVudCB0cmFuc2l0aW9ucyBmcm9tIHByaW1hcnkgdG8gc2Vjb25kYXJ5LCBpdCBjYW4gbWlzc1xuICAgICAqICAgTG9jYWxTdG9yYWdlIHVwZGF0ZXMgYW5kIGl0cyBxdWVyeSB2aWV3cyBtYXkgdGVtcG9yYXJpbHkgbm90IGJlXG4gICAgICogICBzeW5jaHJvbml6ZWQgd2l0aCB0aGUgc3RhdGUgb24gZGlzay5cbiAgICAgKiAtIEZvciBzZWNvbmRhcnkgdG8gcHJpbWFyeSB0cmFuc2l0aW9ucywgdGhlIGNsaWVudCBuZWVkcyB0byB1cGRhdGUgdGhlIGxpc3RcbiAgICAgKiAgIG9mIGBzeW5jZWREb2N1bWVudHNgIHNpbmNlIHNlY29uZGFyeSBjbGllbnRzIHVwZGF0ZSB0aGVpciBxdWVyeSB2aWV3c1xuICAgICAqICAgYmFzZWQgcHVyZWx5IG9uIHN5bnRoZXNpemVkIFJlbW90ZUV2ZW50cy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBxdWVyeVJlc3VsdC5kb2N1bWVudHMgLSBUaGUgZG9jdW1lbnRzIHRoYXQgbWF0Y2ggdGhlIHF1ZXJ5IGFjY29yZGluZ1xuICAgICAqIHRvIHRoZSBMb2NhbFN0b3JlLlxuICAgICAqIEBwYXJhbSBxdWVyeVJlc3VsdC5yZW1vdGVLZXlzIC0gVGhlIGtleXMgb2YgdGhlIGRvY3VtZW50cyB0aGF0IG1hdGNoIHRoZVxuICAgICAqIHF1ZXJ5IGFjY29yZGluZyB0byB0aGUgYmFja2VuZC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIFRoZSBWaWV3Q2hhbmdlIHRoYXQgcmVzdWx0ZWQgZnJvbSB0aGlzIHN5bmNocm9uaXphdGlvbi5cbiAgICAgKi9cbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxuICAgIGN1KGUpIHtcbiAgICAgICAgdGhpcy5ZYSA9IGUuUXMsIHRoaXMuWGEgPSBfX1BSSVZBVEVfZG9jdW1lbnRLZXlTZXQoKTtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMucnUoZS5kb2N1bWVudHMpO1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseUNoYW5nZXModCwgLyogbGltYm9SZXNvbHV0aW9uRW5hYmxlZD0gKi8gITApO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgdmlldyBzbmFwc2hvdCBhcyBpZiB0aGlzIHF1ZXJ5IHdhcyBqdXN0IGxpc3RlbmVkIHRvLiBDb250YWluc1xuICAgICAqIGEgZG9jdW1lbnQgYWRkIGZvciBldmVyeSBleGlzdGluZyBkb2N1bWVudCBhbmQgdGhlIGBmcm9tQ2FjaGVgIGFuZFxuICAgICAqIGBoYXNQZW5kaW5nV3JpdGVzYCBzdGF0dXMgb2YgdGhlIGFscmVhZHkgZXN0YWJsaXNoZWQgdmlldy5cbiAgICAgKi9cbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxuICAgIGx1KCkge1xuICAgICAgICByZXR1cm4gVmlld1NuYXBzaG90LmZyb21Jbml0aWFsRG9jdW1lbnRzKHRoaXMucXVlcnksIHRoaXMudHUsIHRoaXMubXV0YXRlZEtleXMsIDAgLyogU3luY1N0YXRlLkxvY2FsICovID09PSB0aGlzLlphLCB0aGlzLmhhc0NhY2hlZFJlc3VsdHMpO1xuICAgIH1cbn1cblxuY29uc3Qgc24gPSBcIlN5bmNFbmdpbmVcIjtcblxuLyoqXG4gKiBRdWVyeVZpZXcgY29udGFpbnMgYWxsIG9mIHRoZSBkYXRhIHRoYXQgU3luY0VuZ2luZSBuZWVkcyB0byBrZWVwIHRyYWNrIG9mIGZvclxuICogYSBwYXJ0aWN1bGFyIHF1ZXJ5LlxuICovIGNsYXNzIF9fUFJJVkFURV9RdWVyeVZpZXcge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBxdWVyeSBpdHNlbGYuXG4gICAgICovXG4gICAgZSwgXG4gICAgLyoqXG4gICAgICogVGhlIHRhcmdldCBudW1iZXIgY3JlYXRlZCBieSB0aGUgY2xpZW50IHRoYXQgaXMgdXNlZCBpbiB0aGUgd2F0Y2hcbiAgICAgKiBzdHJlYW0gdG8gaWRlbnRpZnkgdGhpcyBxdWVyeS5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBUaGUgdmlldyBpcyByZXNwb25zaWJsZSBmb3IgY29tcHV0aW5nIHRoZSBmaW5hbCBtZXJnZWQgdHJ1dGggb2Ygd2hhdFxuICAgICAqIGRvY3MgYXJlIGluIHRoZSBxdWVyeS4gSXQgZ2V0cyBub3RpZmllZCBvZiBsb2NhbCBhbmQgcmVtb3RlIGNoYW5nZXMsXG4gICAgICogYW5kIGFwcGxpZXMgdGhlIHF1ZXJ5IGZpbHRlcnMgYW5kIGxpbWl0cyB0byBkZXRlcm1pbmUgdGhlIG1vc3QgY29ycmVjdFxuICAgICAqIHBvc3NpYmxlIHJlc3VsdHMuXG4gICAgICovXG4gICAgbikge1xuICAgICAgICB0aGlzLnF1ZXJ5ID0gZSwgdGhpcy50YXJnZXRJZCA9IHQsIHRoaXMudmlldyA9IG47XG4gICAgfVxufVxuXG4vKiogVHJhY2tzIGEgbGltYm8gcmVzb2x1dGlvbi4gKi8gY2xhc3MgTGltYm9SZXNvbHV0aW9uIHtcbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHRoaXMua2V5ID0gZSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXQgdG8gdHJ1ZSBvbmNlIHdlJ3ZlIHJlY2VpdmVkIGEgZG9jdW1lbnQuIFRoaXMgaXMgdXNlZCBpblxuICAgICAgICAgKiBnZXRSZW1vdGVLZXlzRm9yVGFyZ2V0KCkgYW5kIHVsdGltYXRlbHkgdXNlZCBieSBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IgdG9cbiAgICAgICAgICogZGVjaWRlIHdoZXRoZXIgaXQgbmVlZHMgdG8gbWFudWZhY3R1cmUgYSBkZWxldGUgZXZlbnQgZm9yIHRoZSB0YXJnZXQgb25jZVxuICAgICAgICAgKiB0aGUgdGFyZ2V0IGlzIENVUlJFTlQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmh1ID0gITE7XG4gICAgfVxufVxuXG4vKipcbiAqIEFuIGltcGxlbWVudGF0aW9uIG9mIGBTeW5jRW5naW5lYCBjb29yZGluYXRpbmcgd2l0aCBvdGhlciBwYXJ0cyBvZiBTREsuXG4gKlxuICogVGhlIHBhcnRzIG9mIFN5bmNFbmdpbmUgdGhhdCBhY3QgYXMgYSBjYWxsYmFjayB0byBSZW1vdGVTdG9yZSBuZWVkIHRvIGJlXG4gKiByZWdpc3RlcmVkIGluZGl2aWR1YWxseS4gVGhpcyBpcyBkb25lIGluIGBzeW5jRW5naW5lV3JpdGUoKWAgYW5kXG4gKiBgc3luY0VuZ2luZUxpc3RlbigpYCAoYXMgd2VsbCBhcyBgYXBwbHlQcmltYXJ5U3RhdGUoKWApIGFzIHRoZXNlIG1ldGhvZHNcbiAqIHNlcnZlIGFzIGVudHJ5IHBvaW50cyB0byBSZW1vdGVTdG9yZSdzIGZ1bmN0aW9uYWxpdHkuXG4gKlxuICogTm90ZTogc29tZSBmaWVsZCBkZWZpbmVkIGluIHRoaXMgY2xhc3MgbWlnaHQgaGF2ZSBwdWJsaWMgYWNjZXNzIGxldmVsLCBidXRcbiAqIHRoZSBjbGFzcyBpcyBub3QgZXhwb3J0ZWQgc28gdGhleSBhcmUgb25seSBhY2Nlc3NpYmxlIGZyb20gdGhpcyBtb2R1bGUuXG4gKiBUaGlzIGlzIHVzZWZ1bCB0byBpbXBsZW1lbnQgb3B0aW9uYWwgZmVhdHVyZXMgKGxpa2UgYnVuZGxlcykgaW4gZnJlZVxuICogZnVuY3Rpb25zLCBzdWNoIHRoYXQgdGhleSBhcmUgdHJlZS1zaGFrZWFibGUuXG4gKi8gY2xhc3MgX19QUklWQVRFX1N5bmNFbmdpbmVJbXBsIHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0LCBuLCBcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE1hbmFnZXMgc3RhdGUgc3luY2hyb25pemF0aW9uIGluIG11bHRpLXRhYiBlbnZpcm9ubWVudHMuXG4gICAgciwgaSwgcykge1xuICAgICAgICB0aGlzLmxvY2FsU3RvcmUgPSBlLCB0aGlzLnJlbW90ZVN0b3JlID0gdCwgdGhpcy5ldmVudE1hbmFnZXIgPSBuLCB0aGlzLnNoYXJlZENsaWVudFN0YXRlID0gciwgXG4gICAgICAgIHRoaXMuY3VycmVudFVzZXIgPSBpLCB0aGlzLm1heENvbmN1cnJlbnRMaW1ib1Jlc29sdXRpb25zID0gcywgdGhpcy5QdSA9IHt9LCB0aGlzLlR1ID0gbmV3IE9iamVjdE1hcCgoZSA9PiBfX1BSSVZBVEVfY2Fub25pZnlRdWVyeShlKSksIF9fUFJJVkFURV9xdWVyeUVxdWFscyksIFxuICAgICAgICB0aGlzLkl1ID0gbmV3IE1hcCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUga2V5cyBvZiBkb2N1bWVudHMgdGhhdCBhcmUgaW4gbGltYm8gZm9yIHdoaWNoIHdlIGhhdmVuJ3QgeWV0IHN0YXJ0ZWQgYVxuICAgICAgICAgKiBsaW1ibyByZXNvbHV0aW9uIHF1ZXJ5LiBUaGUgc3RyaW5ncyBpbiB0aGlzIHNldCBhcmUgdGhlIHJlc3VsdCBvZiBjYWxsaW5nXG4gICAgICAgICAqIGBrZXkucGF0aC5jYW5vbmljYWxTdHJpbmcoKWAgd2hlcmUgYGtleWAgaXMgYSBgRG9jdW1lbnRLZXlgIG9iamVjdC5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhlIGBTZXRgIHR5cGUgd2FzIGNob3NlbiBiZWNhdXNlIGl0IHByb3ZpZGVzIGVmZmljaWVudCBsb29rdXAgYW5kIHJlbW92YWxcbiAgICAgICAgICogb2YgYXJiaXRyYXJ5IGVsZW1lbnRzIGFuZCBpdCBhbHNvIG1haW50YWlucyBpbnNlcnRpb24gb3JkZXIsIHByb3ZpZGluZyB0aGVcbiAgICAgICAgICogZGVzaXJlZCBxdWV1ZS1saWtlIEZJRk8gc2VtYW50aWNzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5FdSA9IG5ldyBTZXQsIFxuICAgICAgICAvKipcbiAgICAgICAgICogS2VlcHMgdHJhY2sgb2YgdGhlIHRhcmdldCBJRCBmb3IgZWFjaCBkb2N1bWVudCB0aGF0IGlzIGluIGxpbWJvIHdpdGggYW5cbiAgICAgICAgICogYWN0aXZlIHRhcmdldC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZHUgPSBuZXcgU29ydGVkTWFwKERvY3VtZW50S2V5LmNvbXBhcmF0b3IpLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEtlZXBzIHRyYWNrIG9mIHRoZSBpbmZvcm1hdGlvbiBhYm91dCBhbiBhY3RpdmUgbGltYm8gcmVzb2x1dGlvbiBmb3IgZWFjaFxuICAgICAgICAgKiBhY3RpdmUgdGFyZ2V0IElEIHRoYXQgd2FzIHN0YXJ0ZWQgZm9yIHRoZSBwdXJwb3NlIG9mIGxpbWJvIHJlc29sdXRpb24uXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLkF1ID0gbmV3IE1hcCwgdGhpcy5SdSA9IG5ldyBfX1BSSVZBVEVfUmVmZXJlbmNlU2V0LCBcbiAgICAgICAgLyoqIFN0b3JlcyB1c2VyIGNvbXBsZXRpb24gaGFuZGxlcnMsIGluZGV4ZWQgYnkgVXNlciBhbmQgQmF0Y2hJZC4gKi9cbiAgICAgICAgdGhpcy5WdSA9IHt9LCBcbiAgICAgICAgLyoqIFN0b3JlcyB1c2VyIGNhbGxiYWNrcyB3YWl0aW5nIGZvciBhbGwgcGVuZGluZyB3cml0ZXMgdG8gYmUgYWNrbm93bGVkZ2VkLiAqL1xuICAgICAgICB0aGlzLm11ID0gbmV3IE1hcCwgdGhpcy5mdSA9IF9fUFJJVkFURV9UYXJnZXRJZEdlbmVyYXRvci5jcigpLCB0aGlzLm9ubGluZVN0YXRlID0gXCJVbmtub3duXCIgLyogT25saW5lU3RhdGUuVW5rbm93biAqLyAsIFxuICAgICAgICAvLyBUaGUgcHJpbWFyeSBzdGF0ZSBpcyBzZXQgdG8gYHRydWVgIG9yIGBmYWxzZWAgaW1tZWRpYXRlbHkgYWZ0ZXIgRmlyZXN0b3JlXG4gICAgICAgIC8vIHN0YXJ0dXAuIEluIHRoZSBpbnRlcmltLCBhIGNsaWVudCBzaG91bGQgb25seSBiZSBjb25zaWRlcmVkIHByaW1hcnkgaWZcbiAgICAgICAgLy8gYGlzUHJpbWFyeWAgaXMgdHJ1ZS5cbiAgICAgICAgdGhpcy5ndSA9IHZvaWQgMDtcbiAgICB9XG4gICAgZ2V0IGlzUHJpbWFyeUNsaWVudCgpIHtcbiAgICAgICAgcmV0dXJuICEwID09PSB0aGlzLmd1O1xuICAgIH1cbn1cblxuLyoqXG4gKiBJbml0aWF0ZXMgdGhlIG5ldyBsaXN0ZW4sIHJlc29sdmVzIHByb21pc2Ugd2hlbiBsaXN0ZW4gZW5xdWV1ZWQgdG8gdGhlXG4gKiBzZXJ2ZXIuIEFsbCB0aGUgc3Vic2VxdWVudCB2aWV3IHNuYXBzaG90cyBvciBlcnJvcnMgYXJlIHNlbnQgdG8gdGhlXG4gKiBzdWJzY3JpYmVkIGhhbmRsZXJzLiBSZXR1cm5zIHRoZSBpbml0aWFsIHNuYXBzaG90LlxuICovXG5hc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfc3luY0VuZ2luZUxpc3RlbihlLCB0LCBuID0gITApIHtcbiAgICBjb25zdCByID0gX19QUklWQVRFX2Vuc3VyZVdhdGNoQ2FsbGJhY2tzKGUpO1xuICAgIGxldCBpO1xuICAgIGNvbnN0IHMgPSByLlR1LmdldCh0KTtcbiAgICByZXR1cm4gcyA/IChcbiAgICAvLyBQT1JUSU5HIE5PVEU6IFdpdGggTXVsdGktVGFiIFdlYiwgaXQgaXMgcG9zc2libGUgdGhhdCBhIHF1ZXJ5IHZpZXdcbiAgICAvLyBhbHJlYWR5IGV4aXN0cyB3aGVuIEV2ZW50TWFuYWdlciBjYWxscyB1cyBmb3IgdGhlIGZpcnN0IHRpbWUuIFRoaXNcbiAgICAvLyBoYXBwZW5zIHdoZW4gdGhlIHByaW1hcnkgdGFiIGlzIGFscmVhZHkgbGlzdGVuaW5nIHRvIHRoaXMgcXVlcnkgb25cbiAgICAvLyBiZWhhbGYgb2YgYW5vdGhlciB0YWIgYW5kIHRoZSB1c2VyIG9mIHRoZSBwcmltYXJ5IGFsc28gc3RhcnRzIGxpc3RlbmluZ1xuICAgIC8vIHRvIHRoZSBxdWVyeS4gRXZlbnRNYW5hZ2VyIHdpbGwgbm90IGhhdmUgYW4gYXNzaWduZWQgdGFyZ2V0IElEIGluIHRoaXNcbiAgICAvLyBjYXNlIGFuZCBjYWxscyBgbGlzdGVuYCB0byBvYnRhaW4gdGhpcyBJRC5cbiAgICByLnNoYXJlZENsaWVudFN0YXRlLmFkZExvY2FsUXVlcnlUYXJnZXQocy50YXJnZXRJZCksIGkgPSBzLnZpZXcubHUoKSkgOiBpID0gYXdhaXQgX19QUklWQVRFX2FsbG9jYXRlVGFyZ2V0QW5kTWF5YmVMaXN0ZW4ociwgdCwgbiwgXG4gICAgLyoqIHNob3VsZEluaXRpYWxpemVWaWV3PSAqLyAhMCksIGk7XG59XG5cbi8qKiBRdWVyeSBoYXMgYmVlbiBsaXN0ZW5pbmcgdG8gdGhlIGNhY2hlLCBhbmQgdHJpZXMgdG8gaW5pdGlhdGUgdGhlIHJlbW90ZSBzdG9yZSBsaXN0ZW4gKi8gYXN5bmMgZnVuY3Rpb24gX19QUklWQVRFX3RyaWdnZXJSZW1vdGVTdG9yZUxpc3RlbihlLCB0KSB7XG4gICAgY29uc3QgbiA9IF9fUFJJVkFURV9lbnN1cmVXYXRjaENhbGxiYWNrcyhlKTtcbiAgICBhd2FpdCBfX1BSSVZBVEVfYWxsb2NhdGVUYXJnZXRBbmRNYXliZUxpc3RlbihuLCB0LCBcbiAgICAvKiogc2hvdWxkTGlzdGVuVG9SZW1vdGU9ICovICEwLCBcbiAgICAvKiogc2hvdWxkSW5pdGlhbGl6ZVZpZXc9ICovICExKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gX19QUklWQVRFX2FsbG9jYXRlVGFyZ2V0QW5kTWF5YmVMaXN0ZW4oZSwgdCwgbiwgcikge1xuICAgIGNvbnN0IGkgPSBhd2FpdCBfX1BSSVZBVEVfbG9jYWxTdG9yZUFsbG9jYXRlVGFyZ2V0KGUubG9jYWxTdG9yZSwgX19QUklWQVRFX3F1ZXJ5VG9UYXJnZXQodCkpLCBzID0gaS50YXJnZXRJZCwgbyA9IGUuc2hhcmVkQ2xpZW50U3RhdGUuYWRkTG9jYWxRdWVyeVRhcmdldChzLCBuKTtcbiAgICBsZXQgXztcbiAgICByZXR1cm4gciAmJiAoXyA9IGF3YWl0IF9fUFJJVkFURV9pbml0aWFsaXplVmlld0FuZENvbXB1dGVTbmFwc2hvdChlLCB0LCBzLCBcImN1cnJlbnRcIiA9PT0gbywgaS5yZXN1bWVUb2tlbikpLCBcbiAgICBlLmlzUHJpbWFyeUNsaWVudCAmJiBuICYmIF9fUFJJVkFURV9yZW1vdGVTdG9yZUxpc3RlbihlLnJlbW90ZVN0b3JlLCBpKSwgXztcbn1cblxuLyoqXG4gKiBSZWdpc3RlcnMgYSB2aWV3IGZvciBhIHByZXZpb3VzbHkgdW5rbm93biBxdWVyeSBhbmQgY29tcHV0ZXMgaXRzIGluaXRpYWxcbiAqIHNuYXBzaG90LlxuICovIGFzeW5jIGZ1bmN0aW9uIF9fUFJJVkFURV9pbml0aWFsaXplVmlld0FuZENvbXB1dGVTbmFwc2hvdChlLCB0LCBuLCByLCBpKSB7XG4gICAgLy8gUE9SVElORyBOT1RFOiBPbiBXZWIgb25seSwgd2UgaW5qZWN0IHRoZSBjb2RlIHRoYXQgcmVnaXN0ZXJzIG5ldyBMaW1ib1xuICAgIC8vIHRhcmdldHMgYmFzZWQgb24gdmlldyBjaGFuZ2VzLiBUaGlzIGFsbG93cyB1cyB0byBvbmx5IGRlcGVuZCBvbiBMaW1ib1xuICAgIC8vIGNoYW5nZXMgd2hlbiB1c2VyIGNvZGUgaW5jbHVkZXMgcXVlcmllcy5cbiAgICBlLnB1ID0gKHQsIG4sIHIpID0+IGFzeW5jIGZ1bmN0aW9uIF9fUFJJVkFURV9hcHBseURvY0NoYW5nZXMoZSwgdCwgbiwgcikge1xuICAgICAgICBsZXQgaSA9IHQudmlldy5ydShuKTtcbiAgICAgICAgaS5DcyAmJiAoXG4gICAgICAgIC8vIFRoZSBxdWVyeSBoYXMgYSBsaW1pdCBhbmQgc29tZSBkb2NzIHdlcmUgcmVtb3ZlZCwgc28gd2UgbmVlZFxuICAgICAgICAvLyB0byByZS1ydW4gdGhlIHF1ZXJ5IGFnYWluc3QgdGhlIGxvY2FsIHN0b3JlIHRvIG1ha2Ugc3VyZSB3ZVxuICAgICAgICAvLyBkaWRuJ3QgbG9zZSBhbnkgZ29vZCBkb2NzIHRoYXQgaGFkIGJlZW4gcGFzdCB0aGUgbGltaXQuXG4gICAgICAgIGkgPSBhd2FpdCBfX1BSSVZBVEVfbG9jYWxTdG9yZUV4ZWN1dGVRdWVyeShlLmxvY2FsU3RvcmUsIHQucXVlcnksIFxuICAgICAgICAvKiB1c2VQcmV2aW91c1Jlc3VsdHM9ICovICExKS50aGVuKCgoe2RvY3VtZW50czogZX0pID0+IHQudmlldy5ydShlLCBpKSkpKTtcbiAgICAgICAgY29uc3QgcyA9IHIgJiYgci50YXJnZXRDaGFuZ2VzLmdldCh0LnRhcmdldElkKSwgbyA9IHIgJiYgbnVsbCAhPSByLnRhcmdldE1pc21hdGNoZXMuZ2V0KHQudGFyZ2V0SWQpLCBfID0gdC52aWV3LmFwcGx5Q2hhbmdlcyhpLCBcbiAgICAgICAgLyogbGltYm9SZXNvbHV0aW9uRW5hYmxlZD0gKi8gZS5pc1ByaW1hcnlDbGllbnQsIHMsIG8pO1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX3VwZGF0ZVRyYWNrZWRMaW1ib3MoZSwgdC50YXJnZXRJZCwgXy5hdSksIF8uc25hcHNob3Q7XG4gICAgfShlLCB0LCBuLCByKTtcbiAgICBjb25zdCBzID0gYXdhaXQgX19QUklWQVRFX2xvY2FsU3RvcmVFeGVjdXRlUXVlcnkoZS5sb2NhbFN0b3JlLCB0LCBcbiAgICAvKiB1c2VQcmV2aW91c1Jlc3VsdHM9ICovICEwKSwgbyA9IG5ldyBfX1BSSVZBVEVfVmlldyh0LCBzLlFzKSwgXyA9IG8ucnUocy5kb2N1bWVudHMpLCBhID0gVGFyZ2V0Q2hhbmdlLmNyZWF0ZVN5bnRoZXNpemVkVGFyZ2V0Q2hhbmdlRm9yQ3VycmVudENoYW5nZShuLCByICYmIFwiT2ZmbGluZVwiIC8qIE9ubGluZVN0YXRlLk9mZmxpbmUgKi8gIT09IGUub25saW5lU3RhdGUsIGkpLCB1ID0gby5hcHBseUNoYW5nZXMoXywgXG4gICAgLyogbGltYm9SZXNvbHV0aW9uRW5hYmxlZD0gKi8gZS5pc1ByaW1hcnlDbGllbnQsIGEpO1xuICAgIF9fUFJJVkFURV91cGRhdGVUcmFja2VkTGltYm9zKGUsIG4sIHUuYXUpO1xuICAgIGNvbnN0IGMgPSBuZXcgX19QUklWQVRFX1F1ZXJ5Vmlldyh0LCBuLCBvKTtcbiAgICByZXR1cm4gZS5UdS5zZXQodCwgYyksIGUuSXUuaGFzKG4pID8gZS5JdS5nZXQobikucHVzaCh0KSA6IGUuSXUuc2V0KG4sIFsgdCBdKSwgdS5zbmFwc2hvdDtcbn1cblxuLyoqIFN0b3BzIGxpc3RlbmluZyB0byB0aGUgcXVlcnkuICovIGFzeW5jIGZ1bmN0aW9uIF9fUFJJVkFURV9zeW5jRW5naW5lVW5saXN0ZW4oZSwgdCwgbikge1xuICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpLCBpID0gci5UdS5nZXQodCksIHMgPSByLkl1LmdldChpLnRhcmdldElkKTtcbiAgICBpZiAocy5sZW5ndGggPiAxKSByZXR1cm4gci5JdS5zZXQoaS50YXJnZXRJZCwgcy5maWx0ZXIoKGUgPT4gIV9fUFJJVkFURV9xdWVyeUVxdWFscyhlLCB0KSkpKSwgXG4gICAgdm9pZCByLlR1LmRlbGV0ZSh0KTtcbiAgICAvLyBObyBvdGhlciBxdWVyaWVzIGFyZSBtYXBwZWQgdG8gdGhlIHRhcmdldCwgY2xlYW4gdXAgdGhlIHF1ZXJ5IGFuZCB0aGUgdGFyZ2V0LlxuICAgICAgICBpZiAoci5pc1ByaW1hcnlDbGllbnQpIHtcbiAgICAgICAgLy8gV2UgbmVlZCB0byByZW1vdmUgdGhlIGxvY2FsIHF1ZXJ5IHRhcmdldCBmaXJzdCB0byBhbGxvdyB1cyB0byB2ZXJpZnlcbiAgICAgICAgLy8gd2hldGhlciBhbnkgb3RoZXIgY2xpZW50IGlzIHN0aWxsIGludGVyZXN0ZWQgaW4gdGhpcyB0YXJnZXQuXG4gICAgICAgIHIuc2hhcmVkQ2xpZW50U3RhdGUucmVtb3ZlTG9jYWxRdWVyeVRhcmdldChpLnRhcmdldElkKTtcbiAgICAgICAgci5zaGFyZWRDbGllbnRTdGF0ZS5pc0FjdGl2ZVF1ZXJ5VGFyZ2V0KGkudGFyZ2V0SWQpIHx8IGF3YWl0IF9fUFJJVkFURV9sb2NhbFN0b3JlUmVsZWFzZVRhcmdldChyLmxvY2FsU3RvcmUsIGkudGFyZ2V0SWQsIFxuICAgICAgICAvKmtlZXBQZXJzaXN0ZWRUYXJnZXREYXRhPSovICExKS50aGVuKCgoKSA9PiB7XG4gICAgICAgICAgICByLnNoYXJlZENsaWVudFN0YXRlLmNsZWFyUXVlcnlTdGF0ZShpLnRhcmdldElkKSwgbiAmJiBfX1BSSVZBVEVfcmVtb3RlU3RvcmVVbmxpc3RlbihyLnJlbW90ZVN0b3JlLCBpLnRhcmdldElkKSwgXG4gICAgICAgICAgICBfX1BSSVZBVEVfcmVtb3ZlQW5kQ2xlYW51cFRhcmdldChyLCBpLnRhcmdldElkKTtcbiAgICAgICAgfSkpLmNhdGNoKF9fUFJJVkFURV9pZ25vcmVJZlByaW1hcnlMZWFzZUxvc3MpO1xuICAgIH0gZWxzZSBfX1BSSVZBVEVfcmVtb3ZlQW5kQ2xlYW51cFRhcmdldChyLCBpLnRhcmdldElkKSwgYXdhaXQgX19QUklWQVRFX2xvY2FsU3RvcmVSZWxlYXNlVGFyZ2V0KHIubG9jYWxTdG9yZSwgaS50YXJnZXRJZCwgXG4gICAgLyprZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YT0qLyAhMCk7XG59XG5cbi8qKiBVbmxpc3RlbnMgdG8gdGhlIHJlbW90ZSBzdG9yZSB3aGlsZSBzdGlsbCBsaXN0ZW5pbmcgdG8gdGhlIGNhY2hlLiAqLyBhc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfdHJpZ2dlclJlbW90ZVN0b3JlVW5saXN0ZW4oZSwgdCkge1xuICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpLCByID0gbi5UdS5nZXQodCksIGkgPSBuLkl1LmdldChyLnRhcmdldElkKTtcbiAgICBuLmlzUHJpbWFyeUNsaWVudCAmJiAxID09PSBpLmxlbmd0aCAmJiAoXG4gICAgLy8gUE9SVElORyBOT1RFOiBVbnJlZ2lzdGVyIHRoZSB0YXJnZXQgSUQgd2l0aCBsb2NhbCBGaXJlc3RvcmUgY2xpZW50IGFzXG4gICAgLy8gd2F0Y2ggdGFyZ2V0LlxuICAgIG4uc2hhcmVkQ2xpZW50U3RhdGUucmVtb3ZlTG9jYWxRdWVyeVRhcmdldChyLnRhcmdldElkKSwgX19QUklWQVRFX3JlbW90ZVN0b3JlVW5saXN0ZW4obi5yZW1vdGVTdG9yZSwgci50YXJnZXRJZCkpO1xufVxuXG4vKipcbiAqIEluaXRpYXRlcyB0aGUgd3JpdGUgb2YgbG9jYWwgbXV0YXRpb24gYmF0Y2ggd2hpY2ggaW52b2x2ZXMgYWRkaW5nIHRoZVxuICogd3JpdGVzIHRvIHRoZSBtdXRhdGlvbiBxdWV1ZSwgbm90aWZ5aW5nIHRoZSByZW1vdGUgc3RvcmUgYWJvdXQgbmV3XG4gKiBtdXRhdGlvbnMgYW5kIHJhaXNpbmcgZXZlbnRzIGZvciBhbnkgY2hhbmdlcyB0aGlzIHdyaXRlIGNhdXNlZC5cbiAqXG4gKiBUaGUgcHJvbWlzZSByZXR1cm5lZCBieSB0aGlzIGNhbGwgaXMgcmVzb2x2ZWQgd2hlbiB0aGUgYWJvdmUgc3RlcHNcbiAqIGhhdmUgY29tcGxldGVkLCAqbm90KiB3aGVuIHRoZSB3cml0ZSB3YXMgYWNrZWQgYnkgdGhlIGJhY2tlbmQuIFRoZVxuICogdXNlckNhbGxiYWNrIGlzIHJlc29sdmVkIG9uY2UgdGhlIHdyaXRlIHdhcyBhY2tlZC9yZWplY3RlZCBieSB0aGVcbiAqIGJhY2tlbmQgKG9yIGZhaWxlZCBsb2NhbGx5IGZvciBhbnkgb3RoZXIgcmVhc29uKS5cbiAqLyBhc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfc3luY0VuZ2luZVdyaXRlKGUsIHQsIG4pIHtcbiAgICBjb25zdCByID0gX19QUklWQVRFX3N5bmNFbmdpbmVFbnN1cmVXcml0ZUNhbGxiYWNrcyhlKTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBlID0gYXdhaXQgZnVuY3Rpb24gX19QUklWQVRFX2xvY2FsU3RvcmVXcml0ZUxvY2FsbHkoZSwgdCkge1xuICAgICAgICAgICAgY29uc3QgbiA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSksIHIgPSBUaW1lc3RhbXAubm93KCksIGkgPSB0LnJlZHVjZSgoKGUsIHQpID0+IGUuYWRkKHQua2V5KSksIF9fUFJJVkFURV9kb2N1bWVudEtleVNldCgpKTtcbiAgICAgICAgICAgIGxldCBzLCBvO1xuICAgICAgICAgICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJMb2NhbGx5IHdyaXRlIG11dGF0aW9uc1wiLCBcInJlYWR3cml0ZVwiLCAoZSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gRmlndXJlIG91dCB3aGljaCBrZXlzIGRvIG5vdCBoYXZlIGEgcmVtb3RlIHZlcnNpb24gaW4gdGhlIGNhY2hlLCB0aGlzXG4gICAgICAgICAgICAgICAgLy8gaXMgbmVlZGVkIHRvIGNyZWF0ZSB0aGUgcmlnaHQgb3ZlcmxheSBtdXRhdGlvbjogaWYgbm8gcmVtb3RlIHZlcnNpb25cbiAgICAgICAgICAgICAgICAvLyBwcmVzZW50cywgd2UgZG8gbm90IG5lZWQgdG8gY3JlYXRlIG92ZXJsYXlzIGFzIHBhdGNoIG11dGF0aW9ucy5cbiAgICAgICAgICAgICAgICAvLyBUT0RPKE92ZXJsYXkpOiBJcyB0aGVyZSBhIGJldHRlciB3YXkgdG8gZGV0ZXJtaW5lIHRoaXM/IFVzaW5nIHRoZVxuICAgICAgICAgICAgICAgIC8vICBkb2N1bWVudCB2ZXJzaW9uIGRvZXMgbm90IHdvcmsgYmVjYXVzZSBsb2NhbCBtdXRhdGlvbnMgc2V0IHRoZW0gYmFja1xuICAgICAgICAgICAgICAgIC8vICB0byAwLlxuICAgICAgICAgICAgICAgIGxldCBfID0gX19QUklWQVRFX211dGFibGVEb2N1bWVudE1hcCgpLCBhID0gX19QUklWQVRFX2RvY3VtZW50S2V5U2V0KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4uTnMuZ2V0RW50cmllcyhlLCBpKS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgXyA9IGUsIF8uZm9yRWFjaCgoKGUsIHQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuaXNWYWxpZERvY3VtZW50KCkgfHwgKGEgPSBhLmFkZChlKSk7XG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICB9KSkubmV4dCgoKCkgPT4gbi5sb2NhbERvY3VtZW50cy5nZXRPdmVybGF5ZWREb2N1bWVudHMoZSwgXykpKS5uZXh0KChpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcyA9IGk7XG4gICAgICAgICAgICAgICAgICAgIC8vIEZvciBub24taWRlbXBvdGVudCBtdXRhdGlvbnMgKHN1Y2ggYXMgYEZpZWxkVmFsdWUuaW5jcmVtZW50KClgKSxcbiAgICAgICAgICAgICAgICAgICAgLy8gd2UgcmVjb3JkIHRoZSBiYXNlIHN0YXRlIGluIGEgc2VwYXJhdGUgcGF0Y2ggbXV0YXRpb24uIFRoaXMgaXNcbiAgICAgICAgICAgICAgICAgICAgLy8gbGF0ZXIgdXNlZCB0byBndWFyYW50ZWUgY29uc2lzdGVudCB2YWx1ZXMgYW5kIHByZXZlbnRzIGZsaWNrZXJcbiAgICAgICAgICAgICAgICAgICAgLy8gZXZlbiBpZiB0aGUgYmFja2VuZCBzZW5kcyB1cyBhbiB1cGRhdGUgdGhhdCBhbHJlYWR5IGluY2x1ZGVzIG91clxuICAgICAgICAgICAgICAgICAgICAvLyB0cmFuc2Zvcm0uXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBfX1BSSVZBVEVfbXV0YXRpb25FeHRyYWN0QmFzZVZhbHVlKGUsIHMuZ2V0KGUua2V5KS5vdmVybGF5ZWREb2N1bWVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBudWxsICE9IHQgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOT1RFOiBUaGUgYmFzZSBzdGF0ZSBzaG91bGQgb25seSBiZSBhcHBsaWVkIGlmIHRoZXJlJ3Mgc29tZVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXhpc3RpbmcgZG9jdW1lbnQgdG8gb3ZlcnJpZGUsIHNvIHVzZSBhIFByZWNvbmRpdGlvbiBvZlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXhpc3RzPXRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG8ucHVzaChuZXcgX19QUklWQVRFX1BhdGNoTXV0YXRpb24oZS5rZXksIHQsIF9fUFJJVkFURV9leHRyYWN0RmllbGRNYXNrKHQudmFsdWUubWFwVmFsdWUpLCBQcmVjb25kaXRpb24uZXhpc3RzKCEwKSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuLm11dGF0aW9uUXVldWUuYWRkTXV0YXRpb25CYXRjaChlLCByLCBvLCB0KTtcbiAgICAgICAgICAgICAgICB9KSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIG8gPSB0O1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gdC5hcHBseVRvTG9jYWxEb2N1bWVudFNldChzLCBhKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4uZG9jdW1lbnRPdmVybGF5Q2FjaGUuc2F2ZU92ZXJsYXlzKGUsIHQuYmF0Y2hJZCwgcik7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSkpLnRoZW4oKCgpID0+ICh7XG4gICAgICAgICAgICAgICAgYmF0Y2hJZDogby5iYXRjaElkLFxuICAgICAgICAgICAgICAgIGNoYW5nZXM6IF9fUFJJVkFURV9jb252ZXJ0T3ZlcmxheWVkRG9jdW1lbnRNYXBUb0RvY3VtZW50TWFwKHMpXG4gICAgICAgICAgICB9KSkpO1xuICAgICAgICB9KHIubG9jYWxTdG9yZSwgdCk7XG4gICAgICAgIHIuc2hhcmVkQ2xpZW50U3RhdGUuYWRkUGVuZGluZ011dGF0aW9uKGUuYmF0Y2hJZCksIGZ1bmN0aW9uIF9fUFJJVkFURV9hZGRNdXRhdGlvbkNhbGxiYWNrKGUsIHQsIG4pIHtcbiAgICAgICAgICAgIGxldCByID0gZS5WdVtlLmN1cnJlbnRVc2VyLnRvS2V5KCldO1xuICAgICAgICAgICAgciB8fCAociA9IG5ldyBTb3J0ZWRNYXAoX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IpKTtcbiAgICAgICAgICAgIHIgPSByLmluc2VydCh0LCBuKSwgZS5WdVtlLmN1cnJlbnRVc2VyLnRvS2V5KCldID0gcjtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIFJlc29sdmVzIG9yIHJlamVjdHMgdGhlIHVzZXIgY2FsbGJhY2sgZm9yIHRoZSBnaXZlbiBiYXRjaCBhbmQgdGhlbiBkaXNjYXJkc1xuICogaXQuXG4gKi8gKHIsIGUuYmF0Y2hJZCwgbiksIGF3YWl0IF9fUFJJVkFURV9zeW5jRW5naW5lRW1pdE5ld1NuYXBzQW5kTm90aWZ5TG9jYWxTdG9yZShyLCBlLmNoYW5nZXMpLCBcbiAgICAgICAgYXdhaXQgX19QUklWQVRFX2ZpbGxXcml0ZVBpcGVsaW5lKHIucmVtb3RlU3RvcmUpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gSWYgd2UgY2FuJ3QgcGVyc2lzdCB0aGUgbXV0YXRpb24sIHdlIHJlamVjdCB0aGUgdXNlciBjYWxsYmFjayBhbmRcbiAgICAgICAgLy8gZG9uJ3Qgc2VuZCB0aGUgbXV0YXRpb24uIFRoZSB1c2VyIGNhbiB0aGVuIHJldHJ5IHRoZSB3cml0ZS5cbiAgICAgICAgY29uc3QgdCA9IF9fUFJJVkFURV93cmFwSW5Vc2VyRXJyb3JJZlJlY292ZXJhYmxlKGUsIFwiRmFpbGVkIHRvIHBlcnNpc3Qgd3JpdGVcIik7XG4gICAgICAgIG4ucmVqZWN0KHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBcHBsaWVzIG9uZSByZW1vdGUgZXZlbnQgdG8gdGhlIHN5bmMgZW5naW5lLCBub3RpZnlpbmcgYW55IHZpZXdzIG9mIHRoZVxuICogY2hhbmdlcywgYW5kIHJlbGVhc2luZyBhbnkgcGVuZGluZyBtdXRhdGlvbiBiYXRjaGVzIHRoYXQgd291bGQgYmVjb21lXG4gKiB2aXNpYmxlIGJlY2F1c2Ugb2YgdGhlIHNuYXBzaG90IHZlcnNpb24gdGhlIHJlbW90ZSBldmVudCBjb250YWlucy5cbiAqLyBhc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfc3luY0VuZ2luZUFwcGx5UmVtb3RlRXZlbnQoZSwgdCkge1xuICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGUgPSBhd2FpdCBfX1BSSVZBVEVfbG9jYWxTdG9yZUFwcGx5UmVtb3RlRXZlbnRUb0xvY2FsQ2FjaGUobi5sb2NhbFN0b3JlLCB0KTtcbiAgICAgICAgLy8gVXBkYXRlIGByZWNlaXZlZERvY3VtZW50YCBhcyBhcHByb3ByaWF0ZSBmb3IgYW55IGxpbWJvIHRhcmdldHMuXG4gICAgICAgICAgICAgICAgdC50YXJnZXRDaGFuZ2VzLmZvckVhY2goKChlLCB0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCByID0gbi5BdS5nZXQodCk7XG4gICAgICAgICAgICByICYmIChcbiAgICAgICAgICAgIC8vIFNpbmNlIHRoaXMgaXMgYSBsaW1ibyByZXNvbHV0aW9uIGxvb2t1cCwgaXQncyBmb3IgYSBzaW5nbGUgZG9jdW1lbnRcbiAgICAgICAgICAgIC8vIGFuZCBpdCBjb3VsZCBiZSBhZGRlZCwgbW9kaWZpZWQsIG9yIHJlbW92ZWQsIGJ1dCBub3QgYSBjb21iaW5hdGlvbi5cbiAgICAgICAgICAgIF9fUFJJVkFURV9oYXJkQXNzZXJ0KGUuYWRkZWREb2N1bWVudHMuc2l6ZSArIGUubW9kaWZpZWREb2N1bWVudHMuc2l6ZSArIGUucmVtb3ZlZERvY3VtZW50cy5zaXplIDw9IDEsIDIyNjE2KSwgXG4gICAgICAgICAgICBlLmFkZGVkRG9jdW1lbnRzLnNpemUgPiAwID8gci5odSA9ICEwIDogZS5tb2RpZmllZERvY3VtZW50cy5zaXplID4gMCA/IF9fUFJJVkFURV9oYXJkQXNzZXJ0KHIuaHUsIDE0NjA3KSA6IGUucmVtb3ZlZERvY3VtZW50cy5zaXplID4gMCAmJiAoX19QUklWQVRFX2hhcmRBc3NlcnQoci5odSwgNDIyMjcpLCBcbiAgICAgICAgICAgIHIuaHUgPSAhMSkpO1xuICAgICAgICB9KSksIGF3YWl0IF9fUFJJVkFURV9zeW5jRW5naW5lRW1pdE5ld1NuYXBzQW5kTm90aWZ5TG9jYWxTdG9yZShuLCBlLCB0KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGF3YWl0IF9fUFJJVkFURV9pZ25vcmVJZlByaW1hcnlMZWFzZUxvc3MoZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEFwcGxpZXMgYW4gT25saW5lU3RhdGUgY2hhbmdlIHRvIHRoZSBzeW5jIGVuZ2luZSBhbmQgbm90aWZpZXMgYW55IHZpZXdzIG9mXG4gKiB0aGUgY2hhbmdlLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9zeW5jRW5naW5lQXBwbHlPbmxpbmVTdGF0ZUNoYW5nZShlLCB0LCBuKSB7XG4gICAgY29uc3QgciA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgLy8gSWYgd2UgYXJlIHRoZSBzZWNvbmRhcnkgY2xpZW50LCB3ZSBleHBsaWNpdGx5IGlnbm9yZSB0aGUgcmVtb3RlIHN0b3JlJ3NcbiAgICAvLyBvbmxpbmUgc3RhdGUgKHRoZSBsb2NhbCBjbGllbnQgbWF5IGdvIG9mZmxpbmUsIGV2ZW4gdGhvdWdoIHRoZSBwcmltYXJ5XG4gICAgLy8gdGFiIHJlbWFpbnMgb25saW5lKSBhbmQgb25seSBhcHBseSB0aGUgcHJpbWFyeSB0YWIncyBvbmxpbmUgc3RhdGUgZnJvbVxuICAgIC8vIFNoYXJlZENsaWVudFN0YXRlLlxuICAgICAgICBpZiAoci5pc1ByaW1hcnlDbGllbnQgJiYgMCAvKiBPbmxpbmVTdGF0ZVNvdXJjZS5SZW1vdGVTdG9yZSAqLyA9PT0gbiB8fCAhci5pc1ByaW1hcnlDbGllbnQgJiYgMSAvKiBPbmxpbmVTdGF0ZVNvdXJjZS5TaGFyZWRDbGllbnRTdGF0ZSAqLyA9PT0gbikge1xuICAgICAgICBjb25zdCBlID0gW107XG4gICAgICAgIHIuVHUuZm9yRWFjaCgoKG4sIHIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSByLnZpZXcudmEodCk7XG4gICAgICAgICAgICBpLnNuYXBzaG90ICYmIGUucHVzaChpLnNuYXBzaG90KTtcbiAgICAgICAgfSkpLCBmdW5jdGlvbiBfX1BSSVZBVEVfZXZlbnRNYW5hZ2VyT25PbmxpbmVTdGF0ZUNoYW5nZShlLCB0KSB7XG4gICAgICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKTtcbiAgICAgICAgICAgIG4ub25saW5lU3RhdGUgPSB0O1xuICAgICAgICAgICAgbGV0IHIgPSAhMTtcbiAgICAgICAgICAgIG4ucXVlcmllcy5mb3JFYWNoKCgoZSwgbikgPT4ge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiBuLlNhKSBcbiAgICAgICAgICAgICAgICAvLyBSdW4gZ2xvYmFsIHNuYXBzaG90IGxpc3RlbmVycyBpZiBhIGNvbnNpc3RlbnQgc25hcHNob3QgaGFzIGJlZW4gZW1pdHRlZC5cbiAgICAgICAgICAgICAgICBlLnZhKHQpICYmIChyID0gITApO1xuICAgICAgICAgICAgfSkpLCByICYmIF9fUFJJVkFURV9yYWlzZVNuYXBzaG90c0luU3luY0V2ZW50KG4pO1xuICAgICAgICB9KHIuZXZlbnRNYW5hZ2VyLCB0KSwgZS5sZW5ndGggJiYgci5QdS5IXyhlKSwgci5vbmxpbmVTdGF0ZSA9IHQsIHIuaXNQcmltYXJ5Q2xpZW50ICYmIHIuc2hhcmVkQ2xpZW50U3RhdGUuc2V0T25saW5lU3RhdGUodCk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJlamVjdHMgdGhlIGxpc3RlbiBmb3IgdGhlIGdpdmVuIHRhcmdldElELiBUaGlzIGNhbiBiZSB0cmlnZ2VyZWQgYnkgdGhlXG4gKiBiYWNrZW5kIGZvciBhbnkgYWN0aXZlIHRhcmdldC5cbiAqXG4gKiBAcGFyYW0gc3luY0VuZ2luZSAtIFRoZSBzeW5jIGVuZ2luZSBpbXBsZW1lbnRhdGlvbi5cbiAqIEBwYXJhbSB0YXJnZXRJZCAtIFRoZSB0YXJnZXRJRCBjb3JyZXNwb25kcyB0byBvbmUgcHJldmlvdXNseSBpbml0aWF0ZWQgYnkgdGhlXG4gKiB1c2VyIGFzIHBhcnQgb2YgVGFyZ2V0RGF0YSBwYXNzZWQgdG8gbGlzdGVuKCkgb24gUmVtb3RlU3RvcmUuXG4gKiBAcGFyYW0gZXJyIC0gQSBkZXNjcmlwdGlvbiBvZiB0aGUgY29uZGl0aW9uIHRoYXQgaGFzIGZvcmNlZCB0aGUgcmVqZWN0aW9uLlxuICogTmVhcmx5IGFsd2F5cyB0aGlzIHdpbGwgYmUgYW4gaW5kaWNhdGlvbiB0aGF0IHRoZSB1c2VyIGlzIG5vIGxvbmdlclxuICogYXV0aG9yaXplZCB0byBzZWUgdGhlIGRhdGEgbWF0Y2hpbmcgdGhlIHRhcmdldC5cbiAqLyBhc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfc3luY0VuZ2luZVJlamVjdExpc3RlbihlLCB0LCBuKSB7XG4gICAgY29uc3QgciA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cbiAgICAgICAgci5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVRdWVyeVN0YXRlKHQsIFwicmVqZWN0ZWRcIiwgbik7XG4gICAgY29uc3QgaSA9IHIuQXUuZ2V0KHQpLCBzID0gaSAmJiBpLmtleTtcbiAgICBpZiAocykge1xuICAgICAgICAvLyBUT0RPKGtsaW10KTogV2UgcmVhbGx5IG9ubHkgc2hvdWxkIGRvIHRoZSBmb2xsb3dpbmcgb24gcGVybWlzc2lvblxuICAgICAgICAvLyBkZW5pZWQgZXJyb3JzLCBidXQgd2UgZG9uJ3QgaGF2ZSB0aGUgY2F1c2UgY29kZSBoZXJlLlxuICAgICAgICAvLyBJdCdzIGEgbGltYm8gZG9jLiBDcmVhdGUgYSBzeW50aGV0aWMgZXZlbnQgc2F5aW5nIGl0IHdhcyBkZWxldGVkLlxuICAgICAgICAvLyBUaGlzIGlzIGtpbmQgb2YgYSBoYWNrLiBJZGVhbGx5LCB3ZSB3b3VsZCBoYXZlIGEgbWV0aG9kIGluIHRoZSBsb2NhbFxuICAgICAgICAvLyBzdG9yZSB0byBwdXJnZSBhIGRvY3VtZW50LiBIb3dldmVyLCBpdCB3b3VsZCBiZSB0cmlja3kgdG8ga2VlcCBhbGwgb2ZcbiAgICAgICAgLy8gdGhlIGxvY2FsIHN0b3JlJ3MgaW52YXJpYW50cyB3aXRoIGFub3RoZXIgbWV0aG9kLlxuICAgICAgICBsZXQgZSA9IG5ldyBTb3J0ZWRNYXAoRG9jdW1lbnRLZXkuY29tcGFyYXRvcik7XG4gICAgICAgIC8vIFRPRE8oYi8yMTcxODkyMTYpOiBUaGlzIGxpbWJvIGRvY3VtZW50IHNob3VsZCBpZGVhbGx5IGhhdmUgYSByZWFkIHRpbWUsXG4gICAgICAgIC8vIHNvIHRoYXQgaXQgaXMgcGlja2VkIHVwIGJ5IGFueSByZWFkLXRpbWUgYmFzZWQgc2NhbnMuIFRoZSBiYWNrZW5kLFxuICAgICAgICAvLyBob3dldmVyLCBkb2VzIG5vdCBzZW5kIGEgcmVhZCB0aW1lIGZvciB0YXJnZXQgcmVtb3ZhbHMuXG4gICAgICAgICAgICAgICAgZSA9IGUuaW5zZXJ0KHMsIE11dGFibGVEb2N1bWVudC5uZXdOb0RvY3VtZW50KHMsIFNuYXBzaG90VmVyc2lvbi5taW4oKSkpO1xuICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX2RvY3VtZW50S2V5U2V0KCkuYWRkKHMpLCBpID0gbmV3IFJlbW90ZUV2ZW50KFNuYXBzaG90VmVyc2lvbi5taW4oKSwgXG4gICAgICAgIC8qIHRhcmdldENoYW5nZXM9ICovIG5ldyBNYXAsIFxuICAgICAgICAvKiB0YXJnZXRNaXNtYXRjaGVzPSAqLyBuZXcgU29ydGVkTWFwKF9fUFJJVkFURV9wcmltaXRpdmVDb21wYXJhdG9yKSwgZSwgbik7XG4gICAgICAgIGF3YWl0IF9fUFJJVkFURV9zeW5jRW5naW5lQXBwbHlSZW1vdGVFdmVudChyLCBpKSwgXG4gICAgICAgIC8vIFNpbmNlIHRoaXMgcXVlcnkgZmFpbGVkLCB3ZSB3b24ndCB3YW50IHRvIG1hbnVhbGx5IHVubGlzdGVuIHRvIGl0LlxuICAgICAgICAvLyBXZSBvbmx5IHJlbW92ZSBpdCBmcm9tIGJvb2trZWVwaW5nIGFmdGVyIHdlIHN1Y2Nlc3NmdWxseSBhcHBsaWVkIHRoZVxuICAgICAgICAvLyBSZW1vdGVFdmVudC4gSWYgYGFwcGx5UmVtb3RlRXZlbnQoKWAgdGhyb3dzLCB3ZSB3YW50IHRvIHJlLWxpc3RlbiB0b1xuICAgICAgICAvLyB0aGlzIHF1ZXJ5IHdoZW4gdGhlIFJlbW90ZVN0b3JlIHJlc3RhcnRzIHRoZSBXYXRjaCBzdHJlYW0sIHdoaWNoIHNob3VsZFxuICAgICAgICAvLyByZS10cmlnZ2VyIHRoZSB0YXJnZXQgZmFpbHVyZS5cbiAgICAgICAgci5kdSA9IHIuZHUucmVtb3ZlKHMpLCByLkF1LmRlbGV0ZSh0KSwgX19QUklWQVRFX3B1bXBFbnF1ZXVlZExpbWJvUmVzb2x1dGlvbnMocik7XG4gICAgfSBlbHNlIGF3YWl0IF9fUFJJVkFURV9sb2NhbFN0b3JlUmVsZWFzZVRhcmdldChyLmxvY2FsU3RvcmUsIHQsIFxuICAgIC8qIGtlZXBQZXJzaXN0ZWRUYXJnZXREYXRhICovICExKS50aGVuKCgoKSA9PiBfX1BSSVZBVEVfcmVtb3ZlQW5kQ2xlYW51cFRhcmdldChyLCB0LCBuKSkpLmNhdGNoKF9fUFJJVkFURV9pZ25vcmVJZlByaW1hcnlMZWFzZUxvc3MpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfc3luY0VuZ2luZUFwcGx5U3VjY2Vzc2Z1bFdyaXRlKGUsIHQpIHtcbiAgICBjb25zdCBuID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKSwgciA9IHQuYmF0Y2guYmF0Y2hJZDtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBlID0gYXdhaXQgX19QUklWQVRFX2xvY2FsU3RvcmVBY2tub3dsZWRnZUJhdGNoKG4ubG9jYWxTdG9yZSwgdCk7XG4gICAgICAgIC8vIFRoZSBsb2NhbCBzdG9yZSBtYXkgb3IgbWF5IG5vdCBiZSBhYmxlIHRvIGFwcGx5IHRoZSB3cml0ZSByZXN1bHQgYW5kXG4gICAgICAgIC8vIHJhaXNlIGV2ZW50cyBpbW1lZGlhdGVseSAoZGVwZW5kaW5nIG9uIHdoZXRoZXIgdGhlIHdhdGNoZXIgaXMgY2F1Z2h0XG4gICAgICAgIC8vIHVwKSwgc28gd2UgcmFpc2UgdXNlciBjYWxsYmFja3MgZmlyc3Qgc28gdGhhdCB0aGV5IGNvbnNpc3RlbnRseSBoYXBwZW5cbiAgICAgICAgLy8gYmVmb3JlIGxpc3RlbiBldmVudHMuXG4gICAgICAgICAgICAgICAgX19QUklWQVRFX3Byb2Nlc3NVc2VyQ2FsbGJhY2sobiwgciwgLyplcnJvcj0qLyBudWxsKSwgX19QUklWQVRFX3RyaWdnZXJQZW5kaW5nV3JpdGVzQ2FsbGJhY2tzKG4sIHIpLCBcbiAgICAgICAgbi5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVNdXRhdGlvblN0YXRlKHIsIFwiYWNrbm93bGVkZ2VkXCIpLCBhd2FpdCBfX1BSSVZBVEVfc3luY0VuZ2luZUVtaXROZXdTbmFwc0FuZE5vdGlmeUxvY2FsU3RvcmUobiwgZSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBhd2FpdCBfX1BSSVZBVEVfaWdub3JlSWZQcmltYXJ5TGVhc2VMb3NzKGUpO1xuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gX19QUklWQVRFX3N5bmNFbmdpbmVSZWplY3RGYWlsZWRXcml0ZShlLCB0LCBuKSB7XG4gICAgY29uc3QgciA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZSA9IGF3YWl0IGZ1bmN0aW9uIF9fUFJJVkFURV9sb2NhbFN0b3JlUmVqZWN0QmF0Y2goZSwgdCkge1xuICAgICAgICAgICAgY29uc3QgbiA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgICAgICAgICByZXR1cm4gbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIlJlamVjdCBiYXRjaFwiLCBcInJlYWR3cml0ZS1wcmltYXJ5XCIsIChlID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgcjtcbiAgICAgICAgICAgICAgICByZXR1cm4gbi5tdXRhdGlvblF1ZXVlLmxvb2t1cE11dGF0aW9uQmF0Y2goZSwgdCkubmV4dCgodCA9PiAoX19QUklWQVRFX2hhcmRBc3NlcnQobnVsbCAhPT0gdCwgMzcxMTMpLCBcbiAgICAgICAgICAgICAgICByID0gdC5rZXlzKCksIG4ubXV0YXRpb25RdWV1ZS5yZW1vdmVNdXRhdGlvbkJhdGNoKGUsIHQpKSkpLm5leHQoKCgpID0+IG4ubXV0YXRpb25RdWV1ZS5wZXJmb3JtQ29uc2lzdGVuY3lDaGVjayhlKSkpLm5leHQoKCgpID0+IG4uZG9jdW1lbnRPdmVybGF5Q2FjaGUucmVtb3ZlT3ZlcmxheXNGb3JCYXRjaElkKGUsIHIsIHQpKSkubmV4dCgoKCkgPT4gbi5sb2NhbERvY3VtZW50cy5yZWNhbGN1bGF0ZUFuZFNhdmVPdmVybGF5c0ZvckRvY3VtZW50S2V5cyhlLCByKSkpLm5leHQoKCgpID0+IG4ubG9jYWxEb2N1bWVudHMuZ2V0RG9jdW1lbnRzKGUsIHIpKSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBSZXR1cm5zIHRoZSBsYXJnZXN0IChsYXRlc3QpIGJhdGNoIGlkIGluIG11dGF0aW9uIHF1ZXVlIHRoYXQgaXMgcGVuZGluZ1xuICogc2VydmVyIHJlc3BvbnNlLlxuICpcbiAqIFJldHVybnMgYEJBVENISURfVU5LTk9XTmAgaWYgdGhlIHF1ZXVlIGlzIGVtcHR5LlxuICovIChyLmxvY2FsU3RvcmUsIHQpO1xuICAgICAgICAvLyBUaGUgbG9jYWwgc3RvcmUgbWF5IG9yIG1heSBub3QgYmUgYWJsZSB0byBhcHBseSB0aGUgd3JpdGUgcmVzdWx0IGFuZFxuICAgICAgICAvLyByYWlzZSBldmVudHMgaW1tZWRpYXRlbHkgKGRlcGVuZGluZyBvbiB3aGV0aGVyIHRoZSB3YXRjaGVyIGlzIGNhdWdodCB1cCksXG4gICAgICAgIC8vIHNvIHdlIHJhaXNlIHVzZXIgY2FsbGJhY2tzIGZpcnN0IHNvIHRoYXQgdGhleSBjb25zaXN0ZW50bHkgaGFwcGVuIGJlZm9yZVxuICAgICAgICAvLyBsaXN0ZW4gZXZlbnRzLlxuICAgICAgICAgICAgICAgIF9fUFJJVkFURV9wcm9jZXNzVXNlckNhbGxiYWNrKHIsIHQsIG4pLCBfX1BSSVZBVEVfdHJpZ2dlclBlbmRpbmdXcml0ZXNDYWxsYmFja3MociwgdCksIFxuICAgICAgICByLnNoYXJlZENsaWVudFN0YXRlLnVwZGF0ZU11dGF0aW9uU3RhdGUodCwgXCJyZWplY3RlZFwiLCBuKSwgYXdhaXQgX19QUklWQVRFX3N5bmNFbmdpbmVFbWl0TmV3U25hcHNBbmROb3RpZnlMb2NhbFN0b3JlKHIsIGUpO1xuICAgIH0gY2F0Y2ggKG4pIHtcbiAgICAgICAgYXdhaXQgX19QUklWQVRFX2lnbm9yZUlmUHJpbWFyeUxlYXNlTG9zcyhuKTtcbiAgICB9XG59XG5cbi8qKlxuICogUmVnaXN0ZXJzIGEgdXNlciBjYWxsYmFjayB0aGF0IHJlc29sdmVzIHdoZW4gYWxsIHBlbmRpbmcgbXV0YXRpb25zIGF0IHRoZSBtb21lbnQgb2YgY2FsbGluZ1xuICogYXJlIGFja25vd2xlZGdlZCAuXG4gKi8gYXN5bmMgZnVuY3Rpb24gX19QUklWQVRFX3N5bmNFbmdpbmVSZWdpc3RlclBlbmRpbmdXcml0ZXNDYWxsYmFjayhlLCB0KSB7XG4gICAgY29uc3QgbiA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgX19QUklWQVRFX2NhblVzZU5ldHdvcmsobi5yZW1vdGVTdG9yZSkgfHwgX19QUklWQVRFX2xvZ0RlYnVnKHNuLCBcIlRoZSBuZXR3b3JrIGlzIGRpc2FibGVkLiBUaGUgdGFzayByZXR1cm5lZCBieSAnYXdhaXRQZW5kaW5nV3JpdGVzKCknIHdpbGwgbm90IGNvbXBsZXRlIHVudGlsIHRoZSBuZXR3b3JrIGlzIGVuYWJsZWQuXCIpO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGUgPSBhd2FpdCBmdW5jdGlvbiBfX1BSSVZBVEVfbG9jYWxTdG9yZUdldEhpZ2hlc3RVbmFja25vd2xlZGdlZEJhdGNoSWQoZSkge1xuICAgICAgICAgICAgY29uc3QgdCA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgICAgICAgICByZXR1cm4gdC5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkdldCBoaWdoZXN0IHVuYWNrbm93bGVkZ2VkIGJhdGNoIGlkXCIsIFwicmVhZG9ubHlcIiwgKGUgPT4gdC5tdXRhdGlvblF1ZXVlLmdldEhpZ2hlc3RVbmFja25vd2xlZGdlZEJhdGNoSWQoZSkpKTtcbiAgICAgICAgfShuLmxvY2FsU3RvcmUpO1xuICAgICAgICBpZiAoZSA9PT0gaikgXG4gICAgICAgIC8vIFRyaWdnZXIgdGhlIGNhbGxiYWNrIHJpZ2h0IGF3YXkgaWYgdGhlcmUgaXMgbm8gcGVuZGluZyB3cml0ZXMgYXQgdGhlIG1vbWVudC5cbiAgICAgICAgcmV0dXJuIHZvaWQgdC5yZXNvbHZlKCk7XG4gICAgICAgIGNvbnN0IHIgPSBuLm11LmdldChlKSB8fCBbXTtcbiAgICAgICAgci5wdXNoKHQpLCBuLm11LnNldChlLCByKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfd3JhcEluVXNlckVycm9ySWZSZWNvdmVyYWJsZShlLCBcIkluaXRpYWxpemF0aW9uIG9mIHdhaXRGb3JQZW5kaW5nV3JpdGVzKCkgb3BlcmF0aW9uIGZhaWxlZFwiKTtcbiAgICAgICAgdC5yZWplY3Qobik7XG4gICAgfVxufVxuXG4vKipcbiAqIFRyaWdnZXJzIHRoZSBjYWxsYmFja3MgdGhhdCBhcmUgd2FpdGluZyBmb3IgdGhpcyBiYXRjaCBpZCB0byBnZXQgYWNrbm93bGVkZ2VkIGJ5IHNlcnZlcixcbiAqIGlmIHRoZXJlIGFyZSBhbnkuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX3RyaWdnZXJQZW5kaW5nV3JpdGVzQ2FsbGJhY2tzKGUsIHQpIHtcbiAgICAoZS5tdS5nZXQodCkgfHwgW10pLmZvckVhY2goKGUgPT4ge1xuICAgICAgICBlLnJlc29sdmUoKTtcbiAgICB9KSksIGUubXUuZGVsZXRlKHQpO1xufVxuXG4vKiogUmVqZWN0IGFsbCBvdXRzdGFuZGluZyBjYWxsYmFja3Mgd2FpdGluZyBmb3IgcGVuZGluZyB3cml0ZXMgdG8gY29tcGxldGUuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9wcm9jZXNzVXNlckNhbGxiYWNrKGUsIHQsIG4pIHtcbiAgICBjb25zdCByID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKTtcbiAgICBsZXQgaSA9IHIuVnVbci5jdXJyZW50VXNlci50b0tleSgpXTtcbiAgICAvLyBOT1RFOiBNdXRhdGlvbnMgcmVzdG9yZWQgZnJvbSBwZXJzaXN0ZW5jZSB3b24ndCBoYXZlIGNhbGxiYWNrcywgc28gaXQnc1xuICAgIC8vIG9rYXkgZm9yIHRoZXJlIHRvIGJlIG5vIGNhbGxiYWNrIGZvciB0aGlzIElELlxuICAgICAgICBpZiAoaSkge1xuICAgICAgICBjb25zdCBlID0gaS5nZXQodCk7XG4gICAgICAgIGUgJiYgKG4gPyBlLnJlamVjdChuKSA6IGUucmVzb2x2ZSgpLCBpID0gaS5yZW1vdmUodCkpLCByLlZ1W3IuY3VycmVudFVzZXIudG9LZXkoKV0gPSBpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX3JlbW92ZUFuZENsZWFudXBUYXJnZXQoZSwgdCwgbiA9IG51bGwpIHtcbiAgICBlLnNoYXJlZENsaWVudFN0YXRlLnJlbW92ZUxvY2FsUXVlcnlUYXJnZXQodCk7XG4gICAgZm9yIChjb25zdCByIG9mIGUuSXUuZ2V0KHQpKSBlLlR1LmRlbGV0ZShyKSwgbiAmJiBlLlB1Lnl1KHIsIG4pO1xuICAgIGlmIChlLkl1LmRlbGV0ZSh0KSwgZS5pc1ByaW1hcnlDbGllbnQpIHtcbiAgICAgICAgZS5SdS5qcih0KS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIGUuUnUuY29udGFpbnNLZXkodCkgfHwgXG4gICAgICAgICAgICAvLyBXZSByZW1vdmVkIHRoZSBsYXN0IHJlZmVyZW5jZSBmb3IgdGhpcyBrZXlcbiAgICAgICAgICAgIF9fUFJJVkFURV9yZW1vdmVMaW1ib1RhcmdldChlLCB0KTtcbiAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX3JlbW92ZUxpbWJvVGFyZ2V0KGUsIHQpIHtcbiAgICBlLkV1LmRlbGV0ZSh0LnBhdGguY2Fub25pY2FsU3RyaW5nKCkpO1xuICAgIC8vIEl0J3MgcG9zc2libGUgdGhhdCB0aGUgdGFyZ2V0IGFscmVhZHkgZ290IHJlbW92ZWQgYmVjYXVzZSB0aGUgcXVlcnkgZmFpbGVkLiBJbiB0aGF0IGNhc2UsXG4gICAgLy8gdGhlIGtleSB3b24ndCBleGlzdCBpbiBgbGltYm9UYXJnZXRzQnlLZXlgLiBPbmx5IGRvIHRoZSBjbGVhbnVwIGlmIHdlIHN0aWxsIGhhdmUgdGhlIHRhcmdldC5cbiAgICBjb25zdCBuID0gZS5kdS5nZXQodCk7XG4gICAgbnVsbCAhPT0gbiAmJiAoX19QUklWQVRFX3JlbW90ZVN0b3JlVW5saXN0ZW4oZS5yZW1vdGVTdG9yZSwgbiksIGUuZHUgPSBlLmR1LnJlbW92ZSh0KSwgXG4gICAgZS5BdS5kZWxldGUobiksIF9fUFJJVkFURV9wdW1wRW5xdWV1ZWRMaW1ib1Jlc29sdXRpb25zKGUpKTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX3VwZGF0ZVRyYWNrZWRMaW1ib3MoZSwgdCwgbikge1xuICAgIGZvciAoY29uc3QgciBvZiBuKSBpZiAociBpbnN0YW5jZW9mIF9fUFJJVkFURV9BZGRlZExpbWJvRG9jdW1lbnQpIGUuUnUuYWRkUmVmZXJlbmNlKHIua2V5LCB0KSwgXG4gICAgX19QUklWQVRFX3RyYWNrTGltYm9DaGFuZ2UoZSwgcik7IGVsc2UgaWYgKHIgaW5zdGFuY2VvZiBfX1BSSVZBVEVfUmVtb3ZlZExpbWJvRG9jdW1lbnQpIHtcbiAgICAgICAgX19QUklWQVRFX2xvZ0RlYnVnKHNuLCBcIkRvY3VtZW50IG5vIGxvbmdlciBpbiBsaW1ibzogXCIgKyByLmtleSksIGUuUnUucmVtb3ZlUmVmZXJlbmNlKHIua2V5LCB0KTtcbiAgICAgICAgZS5SdS5jb250YWluc0tleShyLmtleSkgfHwgXG4gICAgICAgIC8vIFdlIHJlbW92ZWQgdGhlIGxhc3QgcmVmZXJlbmNlIGZvciB0aGlzIGtleVxuICAgICAgICBfX1BSSVZBVEVfcmVtb3ZlTGltYm9UYXJnZXQoZSwgci5rZXkpO1xuICAgIH0gZWxzZSBmYWlsKDE5NzkxLCB7XG4gICAgICAgIHd1OiByXG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV90cmFja0xpbWJvQ2hhbmdlKGUsIHQpIHtcbiAgICBjb25zdCBuID0gdC5rZXksIHIgPSBuLnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgZS5kdS5nZXQobikgfHwgZS5FdS5oYXMocikgfHwgKF9fUFJJVkFURV9sb2dEZWJ1ZyhzbiwgXCJOZXcgZG9jdW1lbnQgaW4gbGltYm86IFwiICsgbiksIFxuICAgIGUuRXUuYWRkKHIpLCBfX1BSSVZBVEVfcHVtcEVucXVldWVkTGltYm9SZXNvbHV0aW9ucyhlKSk7XG59XG5cbi8qKlxuICogU3RhcnRzIGxpc3RlbnMgZm9yIGRvY3VtZW50cyBpbiBsaW1ibyB0aGF0IGFyZSBlbnF1ZXVlZCBmb3IgcmVzb2x1dGlvbixcbiAqIHN1YmplY3QgdG8gYSBtYXhpbXVtIG51bWJlciBvZiBjb25jdXJyZW50IHJlc29sdXRpb25zLlxuICpcbiAqIFdpdGhvdXQgYm91bmRpbmcgdGhlIG51bWJlciBvZiBjb25jdXJyZW50IHJlc29sdXRpb25zLCB0aGUgc2VydmVyIGNhbiBmYWlsXG4gKiB3aXRoIFwicmVzb3VyY2UgZXhoYXVzdGVkXCIgZXJyb3JzIHdoaWNoIGNhbiBsZWFkIHRvIHBhdGhvbG9naWNhbCBjbGllbnRcbiAqIGJlaGF2aW9yIGFzIHNlZW4gaW4gaHR0cHM6Ly9naXRodWIuY29tL2ZpcmViYXNlL2ZpcmViYXNlLWpzLXNkay9pc3N1ZXMvMjY4My5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfcHVtcEVucXVldWVkTGltYm9SZXNvbHV0aW9ucyhlKSB7XG4gICAgZm9yICg7ZS5FdS5zaXplID4gMCAmJiBlLmR1LnNpemUgPCBlLm1heENvbmN1cnJlbnRMaW1ib1Jlc29sdXRpb25zOyApIHtcbiAgICAgICAgY29uc3QgdCA9IGUuRXUudmFsdWVzKCkubmV4dCgpLnZhbHVlO1xuICAgICAgICBlLkV1LmRlbGV0ZSh0KTtcbiAgICAgICAgY29uc3QgbiA9IG5ldyBEb2N1bWVudEtleShSZXNvdXJjZVBhdGguZnJvbVN0cmluZyh0KSksIHIgPSBlLmZ1Lm5leHQoKTtcbiAgICAgICAgZS5BdS5zZXQociwgbmV3IExpbWJvUmVzb2x1dGlvbihuKSksIGUuZHUgPSBlLmR1Lmluc2VydChuLCByKSwgX19QUklWQVRFX3JlbW90ZVN0b3JlTGlzdGVuKGUucmVtb3RlU3RvcmUsIG5ldyBUYXJnZXREYXRhKF9fUFJJVkFURV9xdWVyeVRvVGFyZ2V0KF9fUFJJVkFURV9uZXdRdWVyeUZvclBhdGgobi5wYXRoKSksIHIsIFwiVGFyZ2V0UHVycG9zZUxpbWJvUmVzb2x1dGlvblwiIC8qIFRhcmdldFB1cnBvc2UuTGltYm9SZXNvbHV0aW9uICovICwgX19QUklWQVRFX0xpc3RlblNlcXVlbmNlLmNlKSk7XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfc3luY0VuZ2luZUVtaXROZXdTbmFwc0FuZE5vdGlmeUxvY2FsU3RvcmUoZSwgdCwgbikge1xuICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpLCBpID0gW10sIHMgPSBbXSwgbyA9IFtdO1xuICAgIHIuVHUuaXNFbXB0eSgpIHx8IChyLlR1LmZvckVhY2goKChlLCBfKSA9PiB7XG4gICAgICAgIG8ucHVzaChyLnB1KF8sIHQsIG4pLnRoZW4oKGUgPT4ge1xuICAgICAgICAgICAgLy8gSWYgdGhlcmUgYXJlIGNoYW5nZXMsIG9yIHdlIGFyZSBoYW5kbGluZyBhIGdsb2JhbCBzbmFwc2hvdCwgbm90aWZ5XG4gICAgICAgICAgICAvLyBzZWNvbmRhcnkgY2xpZW50cyB0byB1cGRhdGUgcXVlcnkgc3RhdGUuXG4gICAgICAgICAgICBpZiAoKGUgfHwgbikgJiYgci5pc1ByaW1hcnlDbGllbnQpIHtcbiAgICAgICAgICAgICAgICAvLyBRdWVyeSBzdGF0ZSBpcyBzZXQgdG8gYGN1cnJlbnRgIGlmOlxuICAgICAgICAgICAgICAgIC8vIC0gVGhlcmUgaXMgYSB2aWV3IGNoYW5nZSBhbmQgaXQgaXMgdXAtdG8tZGF0ZSwgb3IsXG4gICAgICAgICAgICAgICAgLy8gLSBUaGVyZSBpcyBhIGdsb2JhbCBzbmFwc2hvdCwgdGhlIFRhcmdldCBpcyBjdXJyZW50LCBhbmQgbm8gY2hhbmdlcyB0byBiZSByZXNvbHZlZFxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlID8gIWUuZnJvbUNhY2hlIDogbj8udGFyZ2V0Q2hhbmdlcy5nZXQoXy50YXJnZXRJZCk/LmN1cnJlbnQ7XG4gICAgICAgICAgICAgICAgci5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVRdWVyeVN0YXRlKF8udGFyZ2V0SWQsIHQgPyBcImN1cnJlbnRcIiA6IFwibm90LWN1cnJlbnRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBVcGRhdGUgdmlld3MgaWYgdGhlcmUgYXJlIGFjdHVhbCBjaGFuZ2VzLlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUpIHtcbiAgICAgICAgICAgICAgICBpLnB1c2goZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IF9fUFJJVkFURV9Mb2NhbFZpZXdDaGFuZ2VzLkFzKF8udGFyZ2V0SWQsIGUpO1xuICAgICAgICAgICAgICAgIHMucHVzaCh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpKTtcbiAgICB9KSksIGF3YWl0IFByb21pc2UuYWxsKG8pLCByLlB1LkhfKGkpLCBhd2FpdCBhc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfbG9jYWxTdG9yZU5vdGlmeUxvY2FsVmlld0NoYW5nZXMoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJub3RpZnlMb2NhbFZpZXdDaGFuZ2VzXCIsIFwicmVhZHdyaXRlXCIsIChlID0+IFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKHQsICh0ID0+IFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKHQuRXMsIChyID0+IG4ucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUuYWRkUmVmZXJlbmNlKGUsIHQudGFyZ2V0SWQsIHIpKSkubmV4dCgoKCkgPT4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2godC5kcywgKHIgPT4gbi5wZXJzaXN0ZW5jZS5yZWZlcmVuY2VEZWxlZ2F0ZS5yZW1vdmVSZWZlcmVuY2UoZSwgdC50YXJnZXRJZCwgcikpKSkpKSkpKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgaWYgKCFfX1BSSVZBVEVfaXNJbmRleGVkRGJUcmFuc2FjdGlvbkVycm9yKGUpKSB0aHJvdyBlO1xuICAgICAgICAgICAgLy8gSWYgYG5vdGlmeUxvY2FsVmlld0NoYW5nZXNgIGZhaWxzLCB3ZSBkaWQgbm90IGFkdmFuY2UgdGhlIHNlcXVlbmNlXG4gICAgICAgICAgICAvLyBudW1iZXIgZm9yIHRoZSBkb2N1bWVudHMgdGhhdCB3ZXJlIGluY2x1ZGVkIGluIHRoaXMgdHJhbnNhY3Rpb24uXG4gICAgICAgICAgICAvLyBUaGlzIG1pZ2h0IHRyaWdnZXIgdGhlbSB0byBiZSBkZWxldGVkIGVhcmxpZXIgdGhhbiB0aGV5IG90aGVyd2lzZVxuICAgICAgICAgICAgLy8gd291bGQgaGF2ZSwgYnV0IGl0IHNob3VsZCBub3QgaW52YWxpZGF0ZSB0aGUgaW50ZWdyaXR5IG9mIHRoZSBkYXRhLlxuICAgICAgICAgICAgX19QUklWQVRFX2xvZ0RlYnVnKFV0LCBcIkZhaWxlZCB0byB1cGRhdGUgc2VxdWVuY2UgbnVtYmVyczogXCIgKyBlKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdCkge1xuICAgICAgICAgICAgY29uc3QgdCA9IGUudGFyZ2V0SWQ7XG4gICAgICAgICAgICBpZiAoIWUuZnJvbUNhY2hlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG4uTXMuZ2V0KHQpLCByID0gZS5zbmFwc2hvdFZlcnNpb24sIGkgPSBlLndpdGhMYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uKHIpO1xuICAgICAgICAgICAgICAgIC8vIEFkdmFuY2UgdGhlIGxhc3QgbGltYm8gZnJlZSBzbmFwc2hvdCB2ZXJzaW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4uTXMgPSBuLk1zLmluc2VydCh0LCBpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0oci5sb2NhbFN0b3JlLCBzKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIF9fUFJJVkFURV9zeW5jRW5naW5lSGFuZGxlQ3JlZGVudGlhbENoYW5nZShlLCB0KSB7XG4gICAgY29uc3QgbiA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgaWYgKCFuLmN1cnJlbnRVc2VyLmlzRXF1YWwodCkpIHtcbiAgICAgICAgX19QUklWQVRFX2xvZ0RlYnVnKHNuLCBcIlVzZXIgY2hhbmdlLiBOZXcgdXNlcjpcIiwgdC50b0tleSgpKTtcbiAgICAgICAgY29uc3QgZSA9IGF3YWl0IF9fUFJJVkFURV9sb2NhbFN0b3JlSGFuZGxlVXNlckNoYW5nZShuLmxvY2FsU3RvcmUsIHQpO1xuICAgICAgICBuLmN1cnJlbnRVc2VyID0gdCwgXG4gICAgICAgIC8vIEZhaWxzIHRhc2tzIHdhaXRpbmcgZm9yIHBlbmRpbmcgd3JpdGVzIHJlcXVlc3RlZCBieSBwcmV2aW91cyB1c2VyLlxuICAgICAgICBmdW5jdGlvbiBfX1BSSVZBVEVfcmVqZWN0T3V0c3RhbmRpbmdQZW5kaW5nV3JpdGVzQ2FsbGJhY2tzKGUsIHQpIHtcbiAgICAgICAgICAgIGUubXUuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgZS5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZS5yZWplY3QobmV3IEZpcmVzdG9yZUVycm9yKE4uQ0FOQ0VMTEVELCB0KSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSkpLCBlLm11LmNsZWFyKCk7XG4gICAgICAgIH0obiwgXCInd2FpdEZvclBlbmRpbmdXcml0ZXMnIHByb21pc2UgaXMgcmVqZWN0ZWQgZHVlIHRvIGEgdXNlciBjaGFuZ2UuXCIpLCBcbiAgICAgICAgLy8gVE9ETyhiLzExNDIyNjQxNyk6IENvbnNpZGVyIGNhbGxpbmcgdGhpcyBvbmx5IGluIHRoZSBwcmltYXJ5IHRhYi5cbiAgICAgICAgbi5zaGFyZWRDbGllbnRTdGF0ZS5oYW5kbGVVc2VyQ2hhbmdlKHQsIGUucmVtb3ZlZEJhdGNoSWRzLCBlLmFkZGVkQmF0Y2hJZHMpLCBhd2FpdCBfX1BSSVZBVEVfc3luY0VuZ2luZUVtaXROZXdTbmFwc0FuZE5vdGlmeUxvY2FsU3RvcmUobiwgZS5Mcyk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfc3luY0VuZ2luZUdldFJlbW90ZUtleXNGb3JUYXJnZXQoZSwgdCkge1xuICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpLCByID0gbi5BdS5nZXQodCk7XG4gICAgaWYgKHIgJiYgci5odSkgcmV0dXJuIF9fUFJJVkFURV9kb2N1bWVudEtleVNldCgpLmFkZChyLmtleSk7XG4gICAge1xuICAgICAgICBsZXQgZSA9IF9fUFJJVkFURV9kb2N1bWVudEtleVNldCgpO1xuICAgICAgICBjb25zdCByID0gbi5JdS5nZXQodCk7XG4gICAgICAgIGlmICghcikgcmV0dXJuIGU7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiByKSB7XG4gICAgICAgICAgICBjb25zdCByID0gbi5UdS5nZXQodCk7XG4gICAgICAgICAgICBlID0gZS51bmlvbldpdGgoci52aWV3Lm51KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZTtcbiAgICB9XG59XG5cbi8qKlxuICogUmVjb25jaWxlIHRoZSBsaXN0IG9mIHN5bmNlZCBkb2N1bWVudHMgaW4gYW4gZXhpc3RpbmcgdmlldyB3aXRoIHRob3NlXG4gKiBmcm9tIHBlcnNpc3RlbmNlLlxuICovIGFzeW5jIGZ1bmN0aW9uIF9fUFJJVkFURV9zeW5jaHJvbml6ZVZpZXdBbmRDb21wdXRlU25hcHNob3QoZSwgdCkge1xuICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpLCByID0gYXdhaXQgX19QUklWQVRFX2xvY2FsU3RvcmVFeGVjdXRlUXVlcnkobi5sb2NhbFN0b3JlLCB0LnF1ZXJ5LCBcbiAgICAvKiB1c2VQcmV2aW91c1Jlc3VsdHM9ICovICEwKSwgaSA9IHQudmlldy5jdShyKTtcbiAgICByZXR1cm4gbi5pc1ByaW1hcnlDbGllbnQgJiYgX19QUklWQVRFX3VwZGF0ZVRyYWNrZWRMaW1ib3MobiwgdC50YXJnZXRJZCwgaS5hdSksIFxuICAgIGk7XG59XG5cbi8qKlxuICogUmV0cmlldmVzIG5ld2x5IGNoYW5nZWQgZG9jdW1lbnRzIGZyb20gcmVtb3RlIGRvY3VtZW50IGNhY2hlIGFuZCByYWlzZXNcbiAqIHNuYXBzaG90cyBpZiBuZWVkZWQuXG4gKi9cbi8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG5hc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfc3luY0VuZ2luZVN5bmNocm9uaXplV2l0aENoYW5nZWREb2N1bWVudHMoZSwgdCkge1xuICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpO1xuICAgIHJldHVybiBfX1BSSVZBVEVfbG9jYWxTdG9yZUdldE5ld0RvY3VtZW50Q2hhbmdlcyhuLmxvY2FsU3RvcmUsIHQpLnRoZW4oKGUgPT4gX19QUklWQVRFX3N5bmNFbmdpbmVFbWl0TmV3U25hcHNBbmROb3RpZnlMb2NhbFN0b3JlKG4sIGUpKSk7XG59XG5cbi8qKiBBcHBsaWVzIGEgbXV0YXRpb24gc3RhdGUgdG8gYW4gZXhpc3RpbmcgYmF0Y2guICAqL1xuLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbmFzeW5jIGZ1bmN0aW9uIF9fUFJJVkFURV9zeW5jRW5naW5lQXBwbHlCYXRjaFN0YXRlKGUsIHQsIG4sIHIpIHtcbiAgICBjb25zdCBpID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKSwgcyA9IGF3YWl0IGZ1bmN0aW9uIF9fUFJJVkFURV9sb2NhbFN0b3JlTG9va3VwTXV0YXRpb25Eb2N1bWVudHMoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKSwgciA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3Qobi5tdXRhdGlvblF1ZXVlKTtcbiAgICAgICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJMb29rdXAgbXV0YXRpb24gZG9jdW1lbnRzXCIsIFwicmVhZG9ubHlcIiwgKGUgPT4gci5lcihlLCB0KS5uZXh0KCh0ID0+IHQgPyBuLmxvY2FsRG9jdW1lbnRzLmdldERvY3VtZW50cyhlLCB0KSA6IFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKG51bGwpKSkpKTtcbiAgICB9XG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbiAgICAoaS5sb2NhbFN0b3JlLCB0KTtcbiAgICBudWxsICE9PSBzID8gKFwicGVuZGluZ1wiID09PSBuID8gXG4gICAgLy8gSWYgd2UgYXJlIHRoZSBwcmltYXJ5IGNsaWVudCwgd2UgbmVlZCB0byBzZW5kIHRoaXMgd3JpdGUgdG8gdGhlXG4gICAgLy8gYmFja2VuZC4gU2Vjb25kYXJ5IGNsaWVudHMgd2lsbCBpZ25vcmUgdGhlc2Ugd3JpdGVzIHNpbmNlIHRoZWlyIHJlbW90ZVxuICAgIC8vIGNvbm5lY3Rpb24gaXMgZGlzYWJsZWQuXG4gICAgYXdhaXQgX19QUklWQVRFX2ZpbGxXcml0ZVBpcGVsaW5lKGkucmVtb3RlU3RvcmUpIDogXCJhY2tub3dsZWRnZWRcIiA9PT0gbiB8fCBcInJlamVjdGVkXCIgPT09IG4gPyAoXG4gICAgLy8gTk9URTogQm90aCB0aGVzZSBtZXRob2RzIGFyZSBuby1vcHMgZm9yIGJhdGNoZXMgdGhhdCBvcmlnaW5hdGVkIGZyb21cbiAgICAvLyBvdGhlciBjbGllbnRzLlxuICAgIF9fUFJJVkFURV9wcm9jZXNzVXNlckNhbGxiYWNrKGksIHQsIHIgfHwgbnVsbCksIF9fUFJJVkFURV90cmlnZ2VyUGVuZGluZ1dyaXRlc0NhbGxiYWNrcyhpLCB0KSwgXG4gICAgZnVuY3Rpb24gX19QUklWQVRFX2xvY2FsU3RvcmVSZW1vdmVDYWNoZWRNdXRhdGlvbkJhdGNoTWV0YWRhdGEoZSwgdCkge1xuICAgICAgICBfX1BSSVZBVEVfZGVidWdDYXN0KF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSkubXV0YXRpb25RdWV1ZSkuaXIodCk7XG4gICAgfVxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG4gICAgKGkubG9jYWxTdG9yZSwgdCkpIDogZmFpbCg2NzIwLCBcIlVua25vd24gYmF0Y2hTdGF0ZVwiLCB7XG4gICAgICAgIFN1OiBuXG4gICAgfSksIGF3YWl0IF9fUFJJVkFURV9zeW5jRW5naW5lRW1pdE5ld1NuYXBzQW5kTm90aWZ5TG9jYWxTdG9yZShpLCBzKSkgOiBcbiAgICAvLyBBIHRocm90dGxlZCB0YWIgbWF5IG5vdCBoYXZlIHNlZW4gdGhlIG11dGF0aW9uIGJlZm9yZSBpdCB3YXMgY29tcGxldGVkXG4gICAgLy8gYW5kIHJlbW92ZWQgZnJvbSB0aGUgbXV0YXRpb24gcXVldWUsIGluIHdoaWNoIGNhc2Ugd2Ugd29uJ3QgaGF2ZSBjYWNoZWRcbiAgICAvLyB0aGUgYWZmZWN0ZWQgZG9jdW1lbnRzLiBJbiB0aGlzIGNhc2Ugd2UgY2FuIHNhZmVseSBpZ25vcmUgdGhlIHVwZGF0ZVxuICAgIC8vIHNpbmNlIHRoYXQgbWVhbnMgd2UgZGlkbid0IGFwcGx5IHRoZSBtdXRhdGlvbiBsb2NhbGx5IGF0IGFsbCAoaWYgd2VcbiAgICAvLyBoYWQsIHdlIHdvdWxkIGhhdmUgY2FjaGVkIHRoZSBhZmZlY3RlZCBkb2N1bWVudHMpLCBhbmQgc28gd2Ugd2lsbCBqdXN0XG4gICAgLy8gc2VlIGFueSByZXN1bHRpbmcgZG9jdW1lbnQgY2hhbmdlcyB2aWEgbm9ybWFsIHJlbW90ZSBkb2N1bWVudCB1cGRhdGVzXG4gICAgLy8gYXMgYXBwbGljYWJsZS5cbiAgICBfX1BSSVZBVEVfbG9nRGVidWcoc24sIFwiQ2Fubm90IGFwcGx5IG11dGF0aW9uIGJhdGNoIHdpdGggaWQ6IFwiICsgdCk7XG59XG5cbi8qKiBBcHBsaWVzIGEgcXVlcnkgdGFyZ2V0IGNoYW5nZSBmcm9tIGEgZGlmZmVyZW50IHRhYi4gKi9cbi8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG5hc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfc3luY0VuZ2luZUFwcGx5UHJpbWFyeVN0YXRlKGUsIHQpIHtcbiAgICBjb25zdCBuID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKTtcbiAgICBpZiAoX19QUklWQVRFX2Vuc3VyZVdhdGNoQ2FsbGJhY2tzKG4pLCBfX1BSSVZBVEVfc3luY0VuZ2luZUVuc3VyZVdyaXRlQ2FsbGJhY2tzKG4pLCBcbiAgICAhMCA9PT0gdCAmJiAhMCAhPT0gbi5ndSkge1xuICAgICAgICAvLyBTZWNvbmRhcnkgdGFicyBvbmx5IG1haW50YWluIFZpZXdzIGZvciB0aGVpciBsb2NhbCBsaXN0ZW5lcnMgYW5kIHRoZVxuICAgICAgICAvLyBWaWV3cyBpbnRlcm5hbCBzdGF0ZSBtYXkgbm90IGJlIDEwMCUgcG9wdWxhdGVkIChpbiBwYXJ0aWN1bGFyXG4gICAgICAgIC8vIHNlY29uZGFyeSB0YWJzIGRvbid0IHRyYWNrIHN5bmNlZERvY3VtZW50cywgdGhlIHNldCBvZiBkb2N1bWVudHMgdGhlXG4gICAgICAgIC8vIHNlcnZlciBjb25zaWRlcnMgdG8gYmUgaW4gdGhlIHRhcmdldCkuIFNvIHdoZW4gYSBzZWNvbmRhcnkgYmVjb21lc1xuICAgICAgICAvLyBwcmltYXJ5LCB3ZSBuZWVkIHRvIG5lZWQgdG8gbWFrZSBzdXJlIHRoYXQgYWxsIHZpZXdzIGZvciBhbGwgdGFyZ2V0c1xuICAgICAgICAvLyBtYXRjaCB0aGUgc3RhdGUgb24gZGlzay5cbiAgICAgICAgY29uc3QgZSA9IG4uc2hhcmVkQ2xpZW50U3RhdGUuZ2V0QWxsQWN0aXZlUXVlcnlUYXJnZXRzKCksIHQgPSBhd2FpdCBfX1BSSVZBVEVfc3luY2hyb25pemVRdWVyeVZpZXdzQW5kUmFpc2VTbmFwc2hvdHMobiwgZS50b0FycmF5KCkpO1xuICAgICAgICBuLmd1ID0gITAsIGF3YWl0IF9fUFJJVkFURV9yZW1vdGVTdG9yZUFwcGx5UHJpbWFyeVN0YXRlKG4ucmVtb3RlU3RvcmUsICEwKTtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIHQpIF9fUFJJVkFURV9yZW1vdGVTdG9yZUxpc3RlbihuLnJlbW90ZVN0b3JlLCBlKTtcbiAgICB9IGVsc2UgaWYgKCExID09PSB0ICYmICExICE9PSBuLmd1KSB7XG4gICAgICAgIGNvbnN0IGUgPSBbXTtcbiAgICAgICAgbGV0IHQgPSBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgbi5JdS5mb3JFYWNoKCgociwgaSkgPT4ge1xuICAgICAgICAgICAgbi5zaGFyZWRDbGllbnRTdGF0ZS5pc0xvY2FsUXVlcnlUYXJnZXQoaSkgPyBlLnB1c2goaSkgOiB0ID0gdC50aGVuKCgoKSA9PiAoX19QUklWQVRFX3JlbW92ZUFuZENsZWFudXBUYXJnZXQobiwgaSksIFxuICAgICAgICAgICAgX19QUklWQVRFX2xvY2FsU3RvcmVSZWxlYXNlVGFyZ2V0KG4ubG9jYWxTdG9yZSwgaSwgXG4gICAgICAgICAgICAvKmtlZXBQZXJzaXN0ZWRUYXJnZXREYXRhPSovICEwKSkpKSwgX19QUklWQVRFX3JlbW90ZVN0b3JlVW5saXN0ZW4obi5yZW1vdGVTdG9yZSwgaSk7XG4gICAgICAgIH0pKSwgYXdhaXQgdCwgYXdhaXQgX19QUklWQVRFX3N5bmNocm9uaXplUXVlcnlWaWV3c0FuZFJhaXNlU25hcHNob3RzKG4sIGUpLCBcbiAgICAgICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbiAgICAgICAgZnVuY3Rpb24gX19QUklWQVRFX3Jlc2V0TGltYm9Eb2N1bWVudHMoZSkge1xuICAgICAgICAgICAgY29uc3QgdCA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgICAgICAgICB0LkF1LmZvckVhY2goKChlLCBuKSA9PiB7XG4gICAgICAgICAgICAgICAgX19QUklWQVRFX3JlbW90ZVN0b3JlVW5saXN0ZW4odC5yZW1vdGVTdG9yZSwgbik7XG4gICAgICAgICAgICB9KSksIHQuUnUuSnIoKSwgdC5BdSA9IG5ldyBNYXAsIHQuZHUgPSBuZXcgU29ydGVkTWFwKERvY3VtZW50S2V5LmNvbXBhcmF0b3IpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogUmVjb25jaWxlIHRoZSBxdWVyeSB2aWV3cyBvZiB0aGUgcHJvdmlkZWQgcXVlcnkgdGFyZ2V0cyB3aXRoIHRoZSBzdGF0ZSBmcm9tXG4gKiBwZXJzaXN0ZW5jZS4gUmFpc2VzIHNuYXBzaG90cyBmb3IgYW55IGNoYW5nZXMgdGhhdCBhZmZlY3QgdGhlIGxvY2FsXG4gKiBjbGllbnQgYW5kIHJldHVybnMgdGhlIHVwZGF0ZWQgc3RhdGUgb2YgYWxsIHRhcmdldCdzIHF1ZXJ5IGRhdGEuXG4gKlxuICogQHBhcmFtIHN5bmNFbmdpbmUgLSBUaGUgc3luYyBlbmdpbmUgaW1wbGVtZW50YXRpb25cbiAqIEBwYXJhbSB0YXJnZXRzIC0gdGhlIGxpc3Qgb2YgdGFyZ2V0cyB3aXRoIHZpZXdzIHRoYXQgbmVlZCB0byBiZSByZWNvbXB1dGVkXG4gKiBAcGFyYW0gdHJhbnNpdGlvblRvUHJpbWFyeSAtIGB0cnVlYCBpZmYgdGhlIHRhYiB0cmFuc2l0aW9ucyBmcm9tIGEgc2Vjb25kYXJ5XG4gKiB0YWIgdG8gYSBwcmltYXJ5IHRhYlxuICovXG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG4gICAgICAgIChuKSwgbi5ndSA9ICExLCBhd2FpdCBfX1BSSVZBVEVfcmVtb3RlU3RvcmVBcHBseVByaW1hcnlTdGF0ZShuLnJlbW90ZVN0b3JlLCAhMSk7XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfc3luY2hyb25pemVRdWVyeVZpZXdzQW5kUmFpc2VTbmFwc2hvdHMoZSwgdCwgbikge1xuICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpLCBpID0gW10sIHMgPSBbXTtcbiAgICBmb3IgKGNvbnN0IGUgb2YgdCkge1xuICAgICAgICBsZXQgdDtcbiAgICAgICAgY29uc3QgbiA9IHIuSXUuZ2V0KGUpO1xuICAgICAgICBpZiAobiAmJiAwICE9PSBuLmxlbmd0aCkge1xuICAgICAgICAgICAgLy8gRm9yIHF1ZXJpZXMgdGhhdCBoYXZlIGEgbG9jYWwgVmlldywgd2UgZmV0Y2ggdGhlaXIgY3VycmVudCBzdGF0ZVxuICAgICAgICAgICAgLy8gZnJvbSBMb2NhbFN0b3JlIChhcyB0aGUgcmVzdW1lIHRva2VuIGFuZCB0aGUgc25hcHNob3QgdmVyc2lvblxuICAgICAgICAgICAgLy8gbWlnaHQgaGF2ZSBjaGFuZ2VkKSBhbmQgcmVjb25jaWxlIHRoZWlyIHZpZXdzIHdpdGggdGhlIHBlcnNpc3RlZFxuICAgICAgICAgICAgLy8gc3RhdGUgKHRoZSBsaXN0IG9mIHN5bmNlZERvY3VtZW50cyBtYXkgaGF2ZSBnb3R0ZW4gb3V0IG9mIHN5bmMpLlxuICAgICAgICAgICAgdCA9IGF3YWl0IF9fUFJJVkFURV9sb2NhbFN0b3JlQWxsb2NhdGVUYXJnZXQoci5sb2NhbFN0b3JlLCBfX1BSSVZBVEVfcXVlcnlUb1RhcmdldChuWzBdKSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2Ygbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSByLlR1LmdldChlKSwgbiA9IGF3YWl0IF9fUFJJVkFURV9zeW5jaHJvbml6ZVZpZXdBbmRDb21wdXRlU25hcHNob3QociwgdCk7XG4gICAgICAgICAgICAgICAgbi5zbmFwc2hvdCAmJiBzLnB1c2gobi5zbmFwc2hvdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBGb3IgcXVlcmllcyB0aGF0IG5ldmVyIGV4ZWN1dGVkIG9uIHRoaXMgY2xpZW50LCB3ZSBuZWVkIHRvXG4gICAgICAgICAgICAvLyBhbGxvY2F0ZSB0aGUgdGFyZ2V0IGluIExvY2FsU3RvcmUgYW5kIGluaXRpYWxpemUgYSBuZXcgVmlldy5cbiAgICAgICAgICAgIGNvbnN0IG4gPSBhd2FpdCBfX1BSSVZBVEVfbG9jYWxTdG9yZUdldENhY2hlZFRhcmdldChyLmxvY2FsU3RvcmUsIGUpO1xuICAgICAgICAgICAgdCA9IGF3YWl0IF9fUFJJVkFURV9sb2NhbFN0b3JlQWxsb2NhdGVUYXJnZXQoci5sb2NhbFN0b3JlLCBuKSwgYXdhaXQgX19QUklWQVRFX2luaXRpYWxpemVWaWV3QW5kQ29tcHV0ZVNuYXBzaG90KHIsIF9fUFJJVkFURV9zeW50aGVzaXplVGFyZ2V0VG9RdWVyeShuKSwgZSwgXG4gICAgICAgICAgICAvKmN1cnJlbnQ9Ki8gITEsIHQucmVzdW1lVG9rZW4pO1xuICAgICAgICB9XG4gICAgICAgIGkucHVzaCh0KTtcbiAgICB9XG4gICAgcmV0dXJuIHIuUHUuSF8ocyksIGk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIGBRdWVyeWAgb2JqZWN0IGZyb20gdGhlIHNwZWNpZmllZCBgVGFyZ2V0YC4gVGhlcmUgaXMgbm8gd2F5IHRvXG4gKiBvYnRhaW4gdGhlIG9yaWdpbmFsIGBRdWVyeWAsIHNvIHdlIHN5bnRoZXNpemUgYSBgUXVlcnlgIGZyb20gdGhlIGBUYXJnZXRgXG4gKiBvYmplY3QuXG4gKlxuICogVGhlIHN5bnRoZXNpemVkIHJlc3VsdCBtaWdodCBiZSBkaWZmZXJlbnQgZnJvbSB0aGUgb3JpZ2luYWwgYFF1ZXJ5YCwgYnV0XG4gKiBzaW5jZSB0aGUgc3ludGhlc2l6ZWQgYFF1ZXJ5YCBzaG91bGQgcmV0dXJuIHRoZSBzYW1lIHJlc3VsdHMgYXMgdGhlXG4gKiBvcmlnaW5hbCBvbmUgKG9ubHkgdGhlIHByZXNlbnRhdGlvbiBvZiByZXN1bHRzIG1pZ2h0IGRpZmZlciksIHRoZSBwb3RlbnRpYWxcbiAqIGRpZmZlcmVuY2Ugd2lsbCBub3QgY2F1c2UgaXNzdWVzLlxuICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuZnVuY3Rpb24gX19QUklWQVRFX3N5bnRoZXNpemVUYXJnZXRUb1F1ZXJ5KGUpIHtcbiAgICByZXR1cm4gX19QUklWQVRFX25ld1F1ZXJ5KGUucGF0aCwgZS5jb2xsZWN0aW9uR3JvdXAsIGUub3JkZXJCeSwgZS5maWx0ZXJzLCBlLmxpbWl0LCBcIkZcIiAvKiBMaW1pdFR5cGUuRmlyc3QgKi8gLCBlLnN0YXJ0QXQsIGUuZW5kQXQpO1xufVxuXG4vKiogUmV0dXJucyB0aGUgSURzIG9mIHRoZSBjbGllbnRzIHRoYXQgYXJlIGN1cnJlbnRseSBhY3RpdmUuICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuZnVuY3Rpb24gX19QUklWQVRFX3N5bmNFbmdpbmVHZXRBY3RpdmVDbGllbnRzKGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX2xvY2FsU3RvcmVHZXRBY3RpdmVDbGllbnRzKGUpIHtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9kZWJ1Z0Nhc3QoX19QUklWQVRFX2RlYnVnQ2FzdChlKS5wZXJzaXN0ZW5jZSkuVHMoKTtcbiAgICB9KF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSkubG9jYWxTdG9yZSk7XG59XG5cbi8qKiBBcHBsaWVzIGEgcXVlcnkgdGFyZ2V0IGNoYW5nZSBmcm9tIGEgZGlmZmVyZW50IHRhYi4gKi9cbi8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG5hc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfc3luY0VuZ2luZUFwcGx5VGFyZ2V0U3RhdGUoZSwgdCwgbiwgcikge1xuICAgIGNvbnN0IGkgPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpO1xuICAgIGlmIChpLmd1KSBcbiAgICAvLyBJZiB3ZSByZWNlaXZlIGEgdGFyZ2V0IHN0YXRlIG5vdGlmaWNhdGlvbiB2aWEgV2ViU3RvcmFnZSwgd2UgYXJlXG4gICAgLy8gZWl0aGVyIGFscmVhZHkgc2Vjb25kYXJ5IG9yIGFub3RoZXIgdGFiIGhhcyB0YWtlbiB0aGUgcHJpbWFyeSBsZWFzZS5cbiAgICByZXR1cm4gdm9pZCBfX1BSSVZBVEVfbG9nRGVidWcoc24sIFwiSWdub3JpbmcgdW5leHBlY3RlZCBxdWVyeSBzdGF0ZSBub3RpZmljYXRpb24uXCIpO1xuICAgIGNvbnN0IHMgPSBpLkl1LmdldCh0KTtcbiAgICBpZiAocyAmJiBzLmxlbmd0aCA+IDApIHN3aXRjaCAobikge1xuICAgICAgY2FzZSBcImN1cnJlbnRcIjpcbiAgICAgIGNhc2UgXCJub3QtY3VycmVudFwiOlxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBlID0gYXdhaXQgX19QUklWQVRFX2xvY2FsU3RvcmVHZXROZXdEb2N1bWVudENoYW5nZXMoaS5sb2NhbFN0b3JlLCBfX1BSSVZBVEVfcXVlcnlDb2xsZWN0aW9uR3JvdXAoc1swXSkpLCByID0gUmVtb3RlRXZlbnQuY3JlYXRlU3ludGhlc2l6ZWRSZW1vdGVFdmVudEZvckN1cnJlbnRDaGFuZ2UodCwgXCJjdXJyZW50XCIgPT09IG4sIEJ5dGVTdHJpbmcuRU1QVFlfQllURV9TVFJJTkcpO1xuICAgICAgICAgICAgYXdhaXQgX19QUklWQVRFX3N5bmNFbmdpbmVFbWl0TmV3U25hcHNBbmROb3RpZnlMb2NhbFN0b3JlKGksIGUsIHIpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgY2FzZSBcInJlamVjdGVkXCI6XG4gICAgICAgIGF3YWl0IF9fUFJJVkFURV9sb2NhbFN0b3JlUmVsZWFzZVRhcmdldChpLmxvY2FsU3RvcmUsIHQsIFxuICAgICAgICAvKiBrZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YSAqLyAhMCksIF9fUFJJVkFURV9yZW1vdmVBbmRDbGVhbnVwVGFyZ2V0KGksIHQsIHIpO1xuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgZmFpbCg2NDE1NSwgbik7XG4gICAgfVxufVxuXG4vKiogQWRkcyBvciByZW1vdmVzIFdhdGNoIHRhcmdldHMgZm9yIHF1ZXJpZXMgZnJvbSBkaWZmZXJlbnQgdGFicy4gKi8gYXN5bmMgZnVuY3Rpb24gX19QUklWQVRFX3N5bmNFbmdpbmVBcHBseUFjdGl2ZVRhcmdldHNDaGFuZ2UoZSwgdCwgbikge1xuICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfZW5zdXJlV2F0Y2hDYWxsYmFja3MoZSk7XG4gICAgaWYgKHIuZ3UpIHtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIHQpIHtcbiAgICAgICAgICAgIGlmIChyLkl1LmhhcyhlKSAmJiByLnNoYXJlZENsaWVudFN0YXRlLmlzQWN0aXZlUXVlcnlUYXJnZXQoZSkpIHtcbiAgICAgICAgICAgICAgICBfX1BSSVZBVEVfbG9nRGVidWcoc24sIFwiQWRkaW5nIGFuIGFscmVhZHkgYWN0aXZlIHRhcmdldCBcIiArIGUpO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgdCA9IGF3YWl0IF9fUFJJVkFURV9sb2NhbFN0b3JlR2V0Q2FjaGVkVGFyZ2V0KHIubG9jYWxTdG9yZSwgZSksIG4gPSBhd2FpdCBfX1BSSVZBVEVfbG9jYWxTdG9yZUFsbG9jYXRlVGFyZ2V0KHIubG9jYWxTdG9yZSwgdCk7XG4gICAgICAgICAgICBhd2FpdCBfX1BSSVZBVEVfaW5pdGlhbGl6ZVZpZXdBbmRDb21wdXRlU25hcHNob3QociwgX19QUklWQVRFX3N5bnRoZXNpemVUYXJnZXRUb1F1ZXJ5KHQpLCBuLnRhcmdldElkLCBcbiAgICAgICAgICAgIC8qY3VycmVudD0qLyAhMSwgbi5yZXN1bWVUb2tlbiksIF9fUFJJVkFURV9yZW1vdGVTdG9yZUxpc3RlbihyLnJlbW90ZVN0b3JlLCBuKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgbikgXG4gICAgICAgIC8vIENoZWNrIHRoYXQgdGhlIHRhcmdldCBpcyBzdGlsbCBhY3RpdmUgc2luY2UgdGhlIHRhcmdldCBtaWdodCBoYXZlIGJlZW5cbiAgICAgICAgLy8gcmVtb3ZlZCBpZiBpdCBoYXMgYmVlbiByZWplY3RlZCBieSB0aGUgYmFja2VuZC5cbiAgICAgICAgci5JdS5oYXMoZSkgJiYgXG4gICAgICAgIC8vIFJlbGVhc2UgcXVlcmllcyB0aGF0IGFyZSBzdGlsbCBhY3RpdmUuXG4gICAgICAgIGF3YWl0IF9fUFJJVkFURV9sb2NhbFN0b3JlUmVsZWFzZVRhcmdldChyLmxvY2FsU3RvcmUsIGUsIFxuICAgICAgICAvKiBrZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YSAqLyAhMSkudGhlbigoKCkgPT4ge1xuICAgICAgICAgICAgX19QUklWQVRFX3JlbW90ZVN0b3JlVW5saXN0ZW4oci5yZW1vdGVTdG9yZSwgZSksIF9fUFJJVkFURV9yZW1vdmVBbmRDbGVhbnVwVGFyZ2V0KHIsIGUpO1xuICAgICAgICB9KSkuY2F0Y2goX19QUklWQVRFX2lnbm9yZUlmUHJpbWFyeUxlYXNlTG9zcyk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfZW5zdXJlV2F0Y2hDYWxsYmFja3MoZSkge1xuICAgIGNvbnN0IHQgPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpO1xuICAgIHJldHVybiB0LnJlbW90ZVN0b3JlLnJlbW90ZVN5bmNlci5hcHBseVJlbW90ZUV2ZW50ID0gX19QUklWQVRFX3N5bmNFbmdpbmVBcHBseVJlbW90ZUV2ZW50LmJpbmQobnVsbCwgdCksIFxuICAgIHQucmVtb3RlU3RvcmUucmVtb3RlU3luY2VyLmdldFJlbW90ZUtleXNGb3JUYXJnZXQgPSBfX1BSSVZBVEVfc3luY0VuZ2luZUdldFJlbW90ZUtleXNGb3JUYXJnZXQuYmluZChudWxsLCB0KSwgXG4gICAgdC5yZW1vdGVTdG9yZS5yZW1vdGVTeW5jZXIucmVqZWN0TGlzdGVuID0gX19QUklWQVRFX3N5bmNFbmdpbmVSZWplY3RMaXN0ZW4uYmluZChudWxsLCB0KSwgXG4gICAgdC5QdS5IXyA9IF9fUFJJVkFURV9ldmVudE1hbmFnZXJPbldhdGNoQ2hhbmdlLmJpbmQobnVsbCwgdC5ldmVudE1hbmFnZXIpLCB0LlB1Lnl1ID0gX19QUklWQVRFX2V2ZW50TWFuYWdlck9uV2F0Y2hFcnJvci5iaW5kKG51bGwsIHQuZXZlbnRNYW5hZ2VyKSwgXG4gICAgdDtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX3N5bmNFbmdpbmVFbnN1cmVXcml0ZUNhbGxiYWNrcyhlKSB7XG4gICAgY29uc3QgdCA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgcmV0dXJuIHQucmVtb3RlU3RvcmUucmVtb3RlU3luY2VyLmFwcGx5U3VjY2Vzc2Z1bFdyaXRlID0gX19QUklWQVRFX3N5bmNFbmdpbmVBcHBseVN1Y2Nlc3NmdWxXcml0ZS5iaW5kKG51bGwsIHQpLCBcbiAgICB0LnJlbW90ZVN0b3JlLnJlbW90ZVN5bmNlci5yZWplY3RGYWlsZWRXcml0ZSA9IF9fUFJJVkFURV9zeW5jRW5naW5lUmVqZWN0RmFpbGVkV3JpdGUuYmluZChudWxsLCB0KSwgXG4gICAgdDtcbn1cblxuLyoqXG4gKiBMb2FkcyBhIEZpcmVzdG9yZSBidW5kbGUgaW50byB0aGUgU0RLLiBUaGUgcmV0dXJuZWQgcHJvbWlzZSByZXNvbHZlcyB3aGVuXG4gKiB0aGUgYnVuZGxlIGZpbmlzaGVkIGxvYWRpbmcuXG4gKlxuICogQHBhcmFtIHN5bmNFbmdpbmUgLSBTeW5jRW5naW5lIHRvIHVzZS5cbiAqIEBwYXJhbSBidW5kbGVSZWFkZXIgLSBCdW5kbGUgdG8gbG9hZCBpbnRvIHRoZSBTREsuXG4gKiBAcGFyYW0gdGFzayAtIExvYWRCdW5kbGVUYXNrIHVzZWQgdG8gdXBkYXRlIHRoZSBsb2FkaW5nIHByb2dyZXNzIHRvIHB1YmxpYyBBUEkuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX3N5bmNFbmdpbmVMb2FkQnVuZGxlKGUsIHQsIG4pIHtcbiAgICBjb25zdCByID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWZsb2F0aW5nLXByb21pc2VzXG4gICAgICAgIChcbiAgICAvKiogTG9hZHMgYSBidW5kbGUgYW5kIHJldHVybnMgdGhlIGxpc3Qgb2YgYWZmZWN0ZWQgY29sbGVjdGlvbiBncm91cHMuICovXG4gICAgYXN5bmMgZnVuY3Rpb24gX19QUklWQVRFX2xvYWRCdW5kbGVJbXBsKGUsIHQsIG4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBhd2FpdCB0LmdldE1ldGFkYXRhKCk7XG4gICAgICAgICAgICBpZiAoYXdhaXQgZnVuY3Rpb24gX19QUklWQVRFX2xvY2FsU3RvcmVIYXNOZXdlckJ1bmRsZShlLCB0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSksIHIgPSBfX1BSSVZBVEVfZnJvbVZlcnNpb24odC5jcmVhdGVUaW1lKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcImhhc05ld2VyQnVuZGxlXCIsIFwicmVhZG9ubHlcIiwgKGUgPT4gbi5JaS5nZXRCdW5kbGVNZXRhZGF0YShlLCB0LmlkKSkpLnRoZW4oKGUgPT4gISFlICYmIGUuY3JlYXRlVGltZS5jb21wYXJlVG8ocikgPj0gMCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gKiBTYXZlcyB0aGUgZ2l2ZW4gYEJ1bmRsZU1ldGFkYXRhYCB0byBsb2NhbCBwZXJzaXN0ZW5jZS5cbiAqLyAoZS5sb2NhbFN0b3JlLCByKSkgcmV0dXJuIGF3YWl0IHQuY2xvc2UoKSwgbi5fY29tcGxldGVXaXRoKGZ1bmN0aW9uIF9fUFJJVkFURV9idW5kbGVTdWNjZXNzUHJvZ3Jlc3MoZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tTdGF0ZTogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50c0xvYWRlZDogZS50b3RhbERvY3VtZW50cyxcbiAgICAgICAgICAgICAgICAgICAgYnl0ZXNMb2FkZWQ6IGUudG90YWxCeXRlcyxcbiAgICAgICAgICAgICAgICAgICAgdG90YWxEb2N1bWVudHM6IGUudG90YWxEb2N1bWVudHMsXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQnl0ZXM6IGUudG90YWxCeXRlc1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KHIpKSwgUHJvbWlzZS5yZXNvbHZlKG5ldyBTZXQpO1xuICAgICAgICAgICAgbi5fdXBkYXRlUHJvZ3Jlc3MoX19QUklWQVRFX2J1bmRsZUluaXRpYWxQcm9ncmVzcyhyKSk7XG4gICAgICAgICAgICBjb25zdCBpID0gbmV3IF9fUFJJVkFURV9CdW5kbGVMb2FkZXIociwgdC5zZXJpYWxpemVyKTtcbiAgICAgICAgICAgIGxldCBzID0gYXdhaXQgdC5idSgpO1xuICAgICAgICAgICAgZm9yICg7czsgKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IGF3YWl0IGkuR2Eocyk7XG4gICAgICAgICAgICAgICAgZSAmJiBuLl91cGRhdGVQcm9ncmVzcyhlKSwgcyA9IGF3YWl0IHQuYnUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IG8gPSBhd2FpdCBpLmphKGUubG9jYWxTdG9yZSk7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgX19QUklWQVRFX3N5bmNFbmdpbmVFbWl0TmV3U25hcHNBbmROb3RpZnlMb2NhbFN0b3JlKGUsIG8uSGEsIFxuICAgICAgICAgICAgLyogcmVtb3RlRXZlbnQgKi8gdm9pZCAwKSwgXG4gICAgICAgICAgICAvLyBTYXZlIG1ldGFkYXRhLCBzbyBsb2FkaW5nIHRoZSBzYW1lIGJ1bmRsZSB3aWxsIHNraXAuXG4gICAgICAgICAgICBhd2FpdCBmdW5jdGlvbiBfX1BSSVZBVEVfbG9jYWxTdG9yZVNhdmVCdW5kbGUoZSwgdCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiU2F2ZSBidW5kbGVcIiwgXCJyZWFkd3JpdGVcIiwgKGUgPT4gbi5JaS5zYXZlQnVuZGxlTWV0YWRhdGEoZSwgdCkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qKlxuICogUmV0dXJucyBhIHByb21pc2Ugb2YgYSBgTmFtZWRRdWVyeWAgYXNzb2NpYXRlZCB3aXRoIGdpdmVuIHF1ZXJ5IG5hbWUuIFByb21pc2VcbiAqIHJlc29sdmVzIHRvIHVuZGVmaW5lZCBpZiBubyBwZXJzaXN0ZWQgZGF0YSBjYW4gYmUgZm91bmQuXG4gKi8gKGUubG9jYWxTdG9yZSwgciksIG4uX2NvbXBsZXRlV2l0aChvLnByb2dyZXNzKSwgUHJvbWlzZS5yZXNvbHZlKG8uSmEpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gX19QUklWQVRFX2xvZ1dhcm4oc24sIGBMb2FkaW5nIGJ1bmRsZSBmYWlsZWQgd2l0aCAke2V9YCksIG4uX2ZhaWxXaXRoKGUpLCBcbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZShuZXcgU2V0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuICAgIC8qKlxuICogUHJvdmlkZXMgYWxsIGNvbXBvbmVudHMgbmVlZGVkIGZvciBGaXJlc3RvcmUgd2l0aCBpbi1tZW1vcnkgcGVyc2lzdGVuY2UuXG4gKiBVc2VzIEVhZ2VyR0MgZ2FyYmFnZSBjb2xsZWN0aW9uLlxuICovKShyLCB0LCBuKS50aGVuKChlID0+IHtcbiAgICAgICAgci5zaGFyZWRDbGllbnRTdGF0ZS5ub3RpZnlCdW5kbGVMb2FkZWQoZSk7XG4gICAgfSkpO1xufVxuXG5jbGFzcyBfX1BSSVZBVEVfTWVtb3J5T2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5raW5kID0gXCJtZW1vcnlcIiwgdGhpcy5zeW5jaHJvbml6ZVRhYnMgPSAhMTtcbiAgICB9XG4gICAgYXN5bmMgaW5pdGlhbGl6ZShlKSB7XG4gICAgICAgIHRoaXMuc2VyaWFsaXplciA9IF9fUFJJVkFURV9uZXdTZXJpYWxpemVyKGUuZGF0YWJhc2VJbmZvLmRhdGFiYXNlSWQpLCB0aGlzLnNoYXJlZENsaWVudFN0YXRlID0gdGhpcy5EdShlKSwgXG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UgPSB0aGlzLkN1KGUpLCBhd2FpdCB0aGlzLnBlcnNpc3RlbmNlLnN0YXJ0KCksIHRoaXMubG9jYWxTdG9yZSA9IHRoaXMudnUoZSksIFxuICAgICAgICB0aGlzLmdjU2NoZWR1bGVyID0gdGhpcy5GdShlLCB0aGlzLmxvY2FsU3RvcmUpLCB0aGlzLmluZGV4QmFja2ZpbGxlclNjaGVkdWxlciA9IHRoaXMuTXUoZSwgdGhpcy5sb2NhbFN0b3JlKTtcbiAgICB9XG4gICAgRnUoZSwgdCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgTXUoZSwgdCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdnUoZSkge1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX25ld0xvY2FsU3RvcmUodGhpcy5wZXJzaXN0ZW5jZSwgbmV3IF9fUFJJVkFURV9RdWVyeUVuZ2luZSwgZS5pbml0aWFsVXNlciwgdGhpcy5zZXJpYWxpemVyKTtcbiAgICB9XG4gICAgQ3UoZSkge1xuICAgICAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9NZW1vcnlQZXJzaXN0ZW5jZShfX1BSSVZBVEVfTWVtb3J5RWFnZXJEZWxlZ2F0ZS5taSwgdGhpcy5zZXJpYWxpemVyKTtcbiAgICB9XG4gICAgRHUoZSkge1xuICAgICAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9NZW1vcnlTaGFyZWRDbGllbnRTdGF0ZTtcbiAgICB9XG4gICAgYXN5bmMgdGVybWluYXRlKCkge1xuICAgICAgICB0aGlzLmdjU2NoZWR1bGVyPy5zdG9wKCksIHRoaXMuaW5kZXhCYWNrZmlsbGVyU2NoZWR1bGVyPy5zdG9wKCksIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUuc2h1dGRvd24oKSwgXG4gICAgICAgIGF3YWl0IHRoaXMucGVyc2lzdGVuY2Uuc2h1dGRvd24oKTtcbiAgICB9XG59XG5cbl9fUFJJVkFURV9NZW1vcnlPZmZsaW5lQ29tcG9uZW50UHJvdmlkZXIucHJvdmlkZXIgPSB7XG4gICAgYnVpbGQ6ICgpID0+IG5ldyBfX1BSSVZBVEVfTWVtb3J5T2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyXG59O1xuXG5jbGFzcyBfX1BSSVZBVEVfTHJ1R2NNZW1vcnlPZmZsaW5lQ29tcG9uZW50UHJvdmlkZXIgZXh0ZW5kcyBfX1BSSVZBVEVfTWVtb3J5T2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyIHtcbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuY2FjaGVTaXplQnl0ZXMgPSBlO1xuICAgIH1cbiAgICBGdShlLCB0KSB7XG4gICAgICAgIF9fUFJJVkFURV9oYXJkQXNzZXJ0KHRoaXMucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUgaW5zdGFuY2VvZiBfX1BSSVZBVEVfTWVtb3J5THJ1RGVsZWdhdGUsIDQ2OTE1KTtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUuZ2FyYmFnZUNvbGxlY3RvcjtcbiAgICAgICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfTHJ1U2NoZWR1bGVyKG4sIGUuYXN5bmNRdWV1ZSwgdCk7XG4gICAgfVxuICAgIEN1KGUpIHtcbiAgICAgICAgY29uc3QgdCA9IHZvaWQgMCAhPT0gdGhpcy5jYWNoZVNpemVCeXRlcyA/IExydVBhcmFtcy53aXRoQ2FjaGVTaXplKHRoaXMuY2FjaGVTaXplQnl0ZXMpIDogTHJ1UGFyYW1zLkRFRkFVTFQ7XG4gICAgICAgIHJldHVybiBuZXcgX19QUklWQVRFX01lbW9yeVBlcnNpc3RlbmNlKChlID0+IF9fUFJJVkFURV9NZW1vcnlMcnVEZWxlZ2F0ZS5taShlLCB0KSksIHRoaXMuc2VyaWFsaXplcik7XG4gICAgfVxufVxuXG4vKipcbiAqIFByb3ZpZGVzIGFsbCBjb21wb25lbnRzIG5lZWRlZCBmb3IgRmlyZXN0b3JlIHdpdGggSW5kZXhlZERCIHBlcnNpc3RlbmNlLlxuICovIGNsYXNzIF9fUFJJVkFURV9JbmRleGVkRGJPZmZsaW5lQ29tcG9uZW50UHJvdmlkZXIgZXh0ZW5kcyBfX1BSSVZBVEVfTWVtb3J5T2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyIHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0LCBuKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMueHUgPSBlLCB0aGlzLmNhY2hlU2l6ZUJ5dGVzID0gdCwgdGhpcy5mb3JjZU93bmVyc2hpcCA9IG4sIHRoaXMua2luZCA9IFwicGVyc2lzdGVudFwiLCBcbiAgICAgICAgdGhpcy5zeW5jaHJvbml6ZVRhYnMgPSAhMTtcbiAgICB9XG4gICAgYXN5bmMgaW5pdGlhbGl6ZShlKSB7XG4gICAgICAgIGF3YWl0IHN1cGVyLmluaXRpYWxpemUoZSksIGF3YWl0IHRoaXMueHUuaW5pdGlhbGl6ZSh0aGlzLCBlKSwgXG4gICAgICAgIC8vIEVucXVldWUgd3JpdGVzIGZyb20gYSBwcmV2aW91cyBzZXNzaW9uXG4gICAgICAgIGF3YWl0IF9fUFJJVkFURV9zeW5jRW5naW5lRW5zdXJlV3JpdGVDYWxsYmFja3ModGhpcy54dS5zeW5jRW5naW5lKSwgYXdhaXQgX19QUklWQVRFX2ZpbGxXcml0ZVBpcGVsaW5lKHRoaXMueHUucmVtb3RlU3RvcmUpLCBcbiAgICAgICAgLy8gTk9URTogVGhpcyB3aWxsIGltbWVkaWF0ZWx5IGNhbGwgdGhlIGxpc3RlbmVyLCBzbyB3ZSBtYWtlIHN1cmUgdG9cbiAgICAgICAgLy8gc2V0IGl0IGFmdGVyIGxvY2FsU3RvcmUgLyByZW1vdGVTdG9yZSBhcmUgc3RhcnRlZC5cbiAgICAgICAgYXdhaXQgdGhpcy5wZXJzaXN0ZW5jZS5KaSgoKCkgPT4gKHRoaXMuZ2NTY2hlZHVsZXIgJiYgIXRoaXMuZ2NTY2hlZHVsZXIuc3RhcnRlZCAmJiB0aGlzLmdjU2NoZWR1bGVyLnN0YXJ0KCksIFxuICAgICAgICB0aGlzLmluZGV4QmFja2ZpbGxlclNjaGVkdWxlciAmJiAhdGhpcy5pbmRleEJhY2tmaWxsZXJTY2hlZHVsZXIuc3RhcnRlZCAmJiB0aGlzLmluZGV4QmFja2ZpbGxlclNjaGVkdWxlci5zdGFydCgpLCBcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkpKSk7XG4gICAgfVxuICAgIHZ1KGUpIHtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9uZXdMb2NhbFN0b3JlKHRoaXMucGVyc2lzdGVuY2UsIG5ldyBfX1BSSVZBVEVfUXVlcnlFbmdpbmUsIGUuaW5pdGlhbFVzZXIsIHRoaXMuc2VyaWFsaXplcik7XG4gICAgfVxuICAgIEZ1KGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUuZ2FyYmFnZUNvbGxlY3RvcjtcbiAgICAgICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfTHJ1U2NoZWR1bGVyKG4sIGUuYXN5bmNRdWV1ZSwgdCk7XG4gICAgfVxuICAgIE11KGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IG5ldyBfX1BSSVZBVEVfSW5kZXhCYWNrZmlsbGVyKHQsIHRoaXMucGVyc2lzdGVuY2UpO1xuICAgICAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9JbmRleEJhY2tmaWxsZXJTY2hlZHVsZXIoZS5hc3luY1F1ZXVlLCBuKTtcbiAgICB9XG4gICAgQ3UoZSkge1xuICAgICAgICBjb25zdCB0ID0gX19QUklWQVRFX2luZGV4ZWREYlN0b3JhZ2VQcmVmaXgoZS5kYXRhYmFzZUluZm8uZGF0YWJhc2VJZCwgZS5kYXRhYmFzZUluZm8ucGVyc2lzdGVuY2VLZXkpLCBuID0gdm9pZCAwICE9PSB0aGlzLmNhY2hlU2l6ZUJ5dGVzID8gTHJ1UGFyYW1zLndpdGhDYWNoZVNpemUodGhpcy5jYWNoZVNpemVCeXRlcykgOiBMcnVQYXJhbXMuREVGQVVMVDtcbiAgICAgICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfSW5kZXhlZERiUGVyc2lzdGVuY2UodGhpcy5zeW5jaHJvbml6ZVRhYnMsIHQsIGUuY2xpZW50SWQsIG4sIGUuYXN5bmNRdWV1ZSwgX19QUklWQVRFX2dldFdpbmRvdygpLCBnZXREb2N1bWVudCgpLCB0aGlzLnNlcmlhbGl6ZXIsIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUsICEhdGhpcy5mb3JjZU93bmVyc2hpcCk7XG4gICAgfVxuICAgIER1KGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGU7XG4gICAgfVxufVxuXG4vKipcbiAqIFByb3ZpZGVzIGFsbCBjb21wb25lbnRzIG5lZWRlZCBmb3IgRmlyZXN0b3JlIHdpdGggbXVsdGktdGFiIEluZGV4ZWREQlxuICogcGVyc2lzdGVuY2UuXG4gKlxuICogSW4gdGhlIGxlZ2FjeSBjbGllbnQsIHRoaXMgcHJvdmlkZXIgaXMgdXNlZCB0byBwcm92aWRlIGJvdGggbXVsdGktdGFiIGFuZFxuICogbm9uLW11bHRpLXRhYiBwZXJzaXN0ZW5jZSBzaW5jZSB3ZSBjYW5ub3QgdGVsbCBhdCBidWlsZCB0aW1lIHdoZXRoZXJcbiAqIGBzeW5jaHJvbml6ZVRhYnNgIHdpbGwgYmUgZW5hYmxlZC5cbiAqLyBjbGFzcyBfX1BSSVZBVEVfTXVsdGlUYWJPZmZsaW5lQ29tcG9uZW50UHJvdmlkZXIgZXh0ZW5kcyBfX1BSSVZBVEVfSW5kZXhlZERiT2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyIHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0KSB7XG4gICAgICAgIHN1cGVyKGUsIHQsIC8qIGZvcmNlT3duZXJzaGlwPSAqLyAhMSksIHRoaXMueHUgPSBlLCB0aGlzLmNhY2hlU2l6ZUJ5dGVzID0gdCwgdGhpcy5zeW5jaHJvbml6ZVRhYnMgPSAhMDtcbiAgICB9XG4gICAgYXN5bmMgaW5pdGlhbGl6ZShlKSB7XG4gICAgICAgIGF3YWl0IHN1cGVyLmluaXRpYWxpemUoZSk7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLnh1LnN5bmNFbmdpbmU7XG4gICAgICAgIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUgaW5zdGFuY2VvZiBfX1BSSVZBVEVfV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlICYmICh0aGlzLnNoYXJlZENsaWVudFN0YXRlLnN5bmNFbmdpbmUgPSB7XG4gICAgICAgICAgICBDbzogX19QUklWQVRFX3N5bmNFbmdpbmVBcHBseUJhdGNoU3RhdGUuYmluZChudWxsLCB0KSxcbiAgICAgICAgICAgIHZvOiBfX1BSSVZBVEVfc3luY0VuZ2luZUFwcGx5VGFyZ2V0U3RhdGUuYmluZChudWxsLCB0KSxcbiAgICAgICAgICAgIEZvOiBfX1BSSVZBVEVfc3luY0VuZ2luZUFwcGx5QWN0aXZlVGFyZ2V0c0NoYW5nZS5iaW5kKG51bGwsIHQpLFxuICAgICAgICAgICAgVHM6IF9fUFJJVkFURV9zeW5jRW5naW5lR2V0QWN0aXZlQ2xpZW50cy5iaW5kKG51bGwsIHQpLFxuICAgICAgICAgICAgRG86IF9fUFJJVkFURV9zeW5jRW5naW5lU3luY2hyb25pemVXaXRoQ2hhbmdlZERvY3VtZW50cy5iaW5kKG51bGwsIHQpXG4gICAgICAgIH0sIGF3YWl0IHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUuc3RhcnQoKSksIFxuICAgICAgICAvLyBOT1RFOiBUaGlzIHdpbGwgaW1tZWRpYXRlbHkgY2FsbCB0aGUgbGlzdGVuZXIsIHNvIHdlIG1ha2Ugc3VyZSB0b1xuICAgICAgICAvLyBzZXQgaXQgYWZ0ZXIgbG9jYWxTdG9yZSAvIHJlbW90ZVN0b3JlIGFyZSBzdGFydGVkLlxuICAgICAgICBhd2FpdCB0aGlzLnBlcnNpc3RlbmNlLkppKChhc3luYyBlID0+IHtcbiAgICAgICAgICAgIGF3YWl0IF9fUFJJVkFURV9zeW5jRW5naW5lQXBwbHlQcmltYXJ5U3RhdGUodGhpcy54dS5zeW5jRW5naW5lLCBlKSwgdGhpcy5nY1NjaGVkdWxlciAmJiAoZSAmJiAhdGhpcy5nY1NjaGVkdWxlci5zdGFydGVkID8gdGhpcy5nY1NjaGVkdWxlci5zdGFydCgpIDogZSB8fCB0aGlzLmdjU2NoZWR1bGVyLnN0b3AoKSksIFxuICAgICAgICAgICAgdGhpcy5pbmRleEJhY2tmaWxsZXJTY2hlZHVsZXIgJiYgKGUgJiYgIXRoaXMuaW5kZXhCYWNrZmlsbGVyU2NoZWR1bGVyLnN0YXJ0ZWQgPyB0aGlzLmluZGV4QmFja2ZpbGxlclNjaGVkdWxlci5zdGFydCgpIDogZSB8fCB0aGlzLmluZGV4QmFja2ZpbGxlclNjaGVkdWxlci5zdG9wKCkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIER1KGUpIHtcbiAgICAgICAgY29uc3QgdCA9IF9fUFJJVkFURV9nZXRXaW5kb3coKTtcbiAgICAgICAgaWYgKCFfX1BSSVZBVEVfV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnYodCkpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLlVOSU1QTEVNRU5URUQsIFwiSW5kZXhlZERCIHBlcnNpc3RlbmNlIGlzIG9ubHkgYXZhaWxhYmxlIG9uIHBsYXRmb3JtcyB0aGF0IHN1cHBvcnQgTG9jYWxTdG9yYWdlLlwiKTtcbiAgICAgICAgY29uc3QgbiA9IF9fUFJJVkFURV9pbmRleGVkRGJTdG9yYWdlUHJlZml4KGUuZGF0YWJhc2VJbmZvLmRhdGFiYXNlSWQsIGUuZGF0YWJhc2VJbmZvLnBlcnNpc3RlbmNlS2V5KTtcbiAgICAgICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlKHQsIGUuYXN5bmNRdWV1ZSwgbiwgZS5jbGllbnRJZCwgZS5pbml0aWFsVXNlcik7XG4gICAgfVxufVxuXG4vKipcbiAqIEluaXRpYWxpemVzIGFuZCB3aXJlcyB0aGUgY29tcG9uZW50cyB0aGF0IGFyZSBuZWVkZWQgdG8gaW50ZXJmYWNlIHdpdGggdGhlXG4gKiBuZXR3b3JrLlxuICovIGNsYXNzIE9ubGluZUNvbXBvbmVudFByb3ZpZGVyIHtcbiAgICBhc3luYyBpbml0aWFsaXplKGUsIHQpIHtcbiAgICAgICAgdGhpcy5sb2NhbFN0b3JlIHx8ICh0aGlzLmxvY2FsU3RvcmUgPSBlLmxvY2FsU3RvcmUsIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUgPSBlLnNoYXJlZENsaWVudFN0YXRlLCBcbiAgICAgICAgdGhpcy5kYXRhc3RvcmUgPSB0aGlzLmNyZWF0ZURhdGFzdG9yZSh0KSwgdGhpcy5yZW1vdGVTdG9yZSA9IHRoaXMuY3JlYXRlUmVtb3RlU3RvcmUodCksIFxuICAgICAgICB0aGlzLmV2ZW50TWFuYWdlciA9IHRoaXMuY3JlYXRlRXZlbnRNYW5hZ2VyKHQpLCB0aGlzLnN5bmNFbmdpbmUgPSB0aGlzLmNyZWF0ZVN5bmNFbmdpbmUodCwgXG4gICAgICAgIC8qIHN0YXJ0QXNQcmltYXJ5PSovICFlLnN5bmNocm9uaXplVGFicyksIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUub25saW5lU3RhdGVIYW5kbGVyID0gZSA9PiBfX1BSSVZBVEVfc3luY0VuZ2luZUFwcGx5T25saW5lU3RhdGVDaGFuZ2UodGhpcy5zeW5jRW5naW5lLCBlLCAxIC8qIE9ubGluZVN0YXRlU291cmNlLlNoYXJlZENsaWVudFN0YXRlICovKSwgXG4gICAgICAgIHRoaXMucmVtb3RlU3RvcmUucmVtb3RlU3luY2VyLmhhbmRsZUNyZWRlbnRpYWxDaGFuZ2UgPSBfX1BSSVZBVEVfc3luY0VuZ2luZUhhbmRsZUNyZWRlbnRpYWxDaGFuZ2UuYmluZChudWxsLCB0aGlzLnN5bmNFbmdpbmUpLCBcbiAgICAgICAgYXdhaXQgX19QUklWQVRFX3JlbW90ZVN0b3JlQXBwbHlQcmltYXJ5U3RhdGUodGhpcy5yZW1vdGVTdG9yZSwgdGhpcy5zeW5jRW5naW5lLmlzUHJpbWFyeUNsaWVudCkpO1xuICAgIH1cbiAgICBjcmVhdGVFdmVudE1hbmFnZXIoZSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX25ld0V2ZW50TWFuYWdlcigpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgX19QUklWQVRFX0V2ZW50TWFuYWdlckltcGw7XG4gICAgICAgIH0oKTtcbiAgICB9XG4gICAgY3JlYXRlRGF0YXN0b3JlKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IF9fUFJJVkFURV9uZXdTZXJpYWxpemVyKGUuZGF0YWJhc2VJbmZvLmRhdGFiYXNlSWQpLCBuID0gZnVuY3Rpb24gX19QUklWQVRFX25ld0Nvbm5lY3Rpb24oZSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfV2ViQ2hhbm5lbENvbm5lY3Rpb24oZSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqIFJldHVybiB0aGUgUGxhdGZvcm0tc3BlY2lmaWMgY29ubmVjdGl2aXR5IG1vbml0b3IuICovIChlLmRhdGFiYXNlSW5mbyk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBfX1BSSVZBVEVfbmV3RGF0YXN0b3JlKGUsIHQsIG4sIHIpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgX19QUklWQVRFX0RhdGFzdG9yZUltcGwoZSwgdCwgbiwgcik7XG4gICAgICAgIH0oZS5hdXRoQ3JlZGVudGlhbHMsIGUuYXBwQ2hlY2tDcmVkZW50aWFscywgbiwgdCk7XG4gICAgfVxuICAgIGNyZWF0ZVJlbW90ZVN0b3JlKGUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIF9fUFJJVkFURV9uZXdSZW1vdGVTdG9yZShlLCB0LCBuLCByLCBpKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9SZW1vdGVTdG9yZUltcGwoZSwgdCwgbiwgciwgaSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqIFJlLWVuYWJsZXMgdGhlIG5ldHdvcmsuIElkZW1wb3RlbnQuICovICh0aGlzLmxvY2FsU3RvcmUsIHRoaXMuZGF0YXN0b3JlLCBlLmFzeW5jUXVldWUsIChlID0+IF9fUFJJVkFURV9zeW5jRW5naW5lQXBwbHlPbmxpbmVTdGF0ZUNoYW5nZSh0aGlzLnN5bmNFbmdpbmUsIGUsIDAgLyogT25saW5lU3RhdGVTb3VyY2UuUmVtb3RlU3RvcmUgKi8pKSwgZnVuY3Rpb24gX19QUklWQVRFX25ld0Nvbm5lY3Rpdml0eU1vbml0b3IoKSB7XG4gICAgICAgICAgICByZXR1cm4gX19QUklWQVRFX0Jyb3dzZXJDb25uZWN0aXZpdHlNb25pdG9yLnYoKSA/IG5ldyBfX1BSSVZBVEVfQnJvd3NlckNvbm5lY3Rpdml0eU1vbml0b3IgOiBuZXcgX19QUklWQVRFX05vb3BDb25uZWN0aXZpdHlNb25pdG9yO1xuICAgICAgICB9KCkpO1xuICAgIH1cbiAgICBjcmVhdGVTeW5jRW5naW5lKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIF9fUFJJVkFURV9uZXdTeW5jRW5naW5lKGUsIHQsIG4sIFxuICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IE1hbmFnZXMgc3RhdGUgc3luY2hyb25pemF0aW9uIGluIG11bHRpLXRhYiBlbnZpcm9ubWVudHMuXG4gICAgICAgIHIsIGksIHMsIG8pIHtcbiAgICAgICAgICAgIGNvbnN0IF8gPSBuZXcgX19QUklWQVRFX1N5bmNFbmdpbmVJbXBsKGUsIHQsIG4sIHIsIGksIHMpO1xuICAgICAgICAgICAgcmV0dXJuIG8gJiYgKF8uZ3UgPSAhMCksIF87XG4gICAgICAgIH0odGhpcy5sb2NhbFN0b3JlLCB0aGlzLnJlbW90ZVN0b3JlLCB0aGlzLmV2ZW50TWFuYWdlciwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSwgZS5pbml0aWFsVXNlciwgZS5tYXhDb25jdXJyZW50TGltYm9SZXNvbHV0aW9ucywgdCk7XG4gICAgfVxuICAgIGFzeW5jIHRlcm1pbmF0ZSgpIHtcbiAgICAgICAgYXdhaXQgYXN5bmMgZnVuY3Rpb24gX19QUklWQVRFX3JlbW90ZVN0b3JlU2h1dGRvd24oZSkge1xuICAgICAgICAgICAgY29uc3QgdCA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgICAgICAgICBfX1BSSVZBVEVfbG9nRGVidWcodG4sIFwiUmVtb3RlU3RvcmUgc2h1dHRpbmcgZG93bi5cIiksIHQuRWEuYWRkKDUgLyogT2ZmbGluZUNhdXNlLlNodXRkb3duICovKSwgXG4gICAgICAgICAgICBhd2FpdCBfX1BSSVZBVEVfZGlzYWJsZU5ldHdvcmtJbnRlcm5hbCh0KSwgdC5BYS5zaHV0ZG93bigpLCBcbiAgICAgICAgICAgIC8vIFNldCB0aGUgT25saW5lU3RhdGUgdG8gVW5rbm93biAocmF0aGVyIHRoYW4gT2ZmbGluZSkgdG8gYXZvaWQgcG90ZW50aWFsbHlcbiAgICAgICAgICAgIC8vIHRyaWdnZXJpbmcgc3B1cmlvdXMgbGlzdGVuZXIgZXZlbnRzIHdpdGggY2FjaGVkIGRhdGEsIGV0Yy5cbiAgICAgICAgICAgIHQuUmEuc2V0KFwiVW5rbm93blwiIC8qIE9ubGluZVN0YXRlLlVua25vd24gKi8pO1xuICAgICAgICB9KHRoaXMucmVtb3RlU3RvcmUpLCB0aGlzLmRhdGFzdG9yZT8udGVybWluYXRlKCksIHRoaXMuZXZlbnRNYW5hZ2VyPy50ZXJtaW5hdGUoKTtcbiAgICB9XG59XG5cbk9ubGluZUNvbXBvbmVudFByb3ZpZGVyLnByb3ZpZGVyID0ge1xuICAgIGJ1aWxkOiAoKSA9PiBuZXcgT25saW5lQ29tcG9uZW50UHJvdmlkZXJcbn07XG5cbi8qKlxuICogQnVpbGRzIGEgYEJ5dGVTdHJlYW1SZWFkZXJgIGZyb20gYSBVSW50OEFycmF5LlxuICogQHBhcmFtIHNvdXJjZSAtIFRoZSBkYXRhIHNvdXJjZSB0byB1c2UuXG4gKiBAcGFyYW0gYnl0ZXNQZXJSZWFkIC0gSG93IG1hbnkgYnl0ZXMgZWFjaCBgcmVhZCgpYCBmcm9tIHRoZSByZXR1cm5lZCByZWFkZXJcbiAqICAgICAgICB3aWxsIHJlYWQuXG4gKi9cbmZ1bmN0aW9uIF9fUFJJVkFURV90b0J5dGVTdHJlYW1SZWFkZXJIZWxwZXIoZSwgdCA9IDEwMjQwKSB7XG4gICAgbGV0IG4gPSAwO1xuICAgIC8vIFRoZSBUeXBlU2NyaXB0IGRlZmluaXRpb24gZm9yIFJlYWRhYmxlU3RyZWFtUmVhZGVyIGNoYW5nZWQuIFdlIHVzZVxuICAgIC8vIGBhbnlgIGhlcmUgdG8gYWxsb3cgdGhpcyBjb2RlIHRvIGNvbXBpbGUgd2l0aCBkaWZmZXJlbnQgdmVyc2lvbnMuXG4gICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9taWNyb3NvZnQvVHlwZVNjcmlwdC9pc3N1ZXMvNDI5NzBcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICBhc3luYyByZWFkKCkge1xuICAgICAgICAgICAgaWYgKG4gPCBlLmJ5dGVMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByID0ge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZS5zbGljZShuLCBuICsgdCksXG4gICAgICAgICAgICAgICAgICAgIGRvbmU6ICExXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbiArPSB0LCByO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBkb25lOiAhMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgY2FuY2VsKCkge30sXG4gICAgICAgIHJlbGVhc2VMb2NrKCkge30sXG4gICAgICAgIGNsb3NlZDogUHJvbWlzZS5yZXNvbHZlKClcbiAgICB9O1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBPbiB3ZWIsIGEgYFJlYWRhYmxlU3RyZWFtYCBpcyB3cmFwcGVkIGFyb3VuZCBieSBhIGBCeXRlU3RyZWFtUmVhZGVyYC5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qXG4gKiBBIHdyYXBwZXIgaW1wbGVtZW50YXRpb24gb2YgT2JzZXJ2ZXI8VD4gdGhhdCB3aWxsIGRpc3BhdGNoIGV2ZW50c1xuICogYXN5bmNocm9ub3VzbHkuIFRvIGFsbG93IGltbWVkaWF0ZSBzaWxlbmNpbmcsIGEgbXV0ZSBjYWxsIGlzIGFkZGVkIHdoaWNoXG4gKiBjYXVzZXMgZXZlbnRzIHNjaGVkdWxlZCB0byBubyBsb25nZXIgYmUgcmFpc2VkLlxuICovXG5jbGFzcyBfX1BSSVZBVEVfQXN5bmNPYnNlcnZlciB7XG4gICAgY29uc3RydWN0b3IoZSkge1xuICAgICAgICB0aGlzLm9ic2VydmVyID0gZSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGVuIHNldCB0byB0cnVlLCB3aWxsIG5vdCByYWlzZSBmdXR1cmUgZXZlbnRzLiBOZWNlc3NhcnkgdG8gZGVhbCB3aXRoXG4gICAgICAgICAqIGFzeW5jIGRldGFjaG1lbnQgb2YgbGlzdGVuZXIuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm11dGVkID0gITE7XG4gICAgfVxuICAgIG5leHQoZSkge1xuICAgICAgICB0aGlzLm11dGVkIHx8IHRoaXMub2JzZXJ2ZXIubmV4dCAmJiB0aGlzLk91KHRoaXMub2JzZXJ2ZXIubmV4dCwgZSk7XG4gICAgfVxuICAgIGVycm9yKGUpIHtcbiAgICAgICAgdGhpcy5tdXRlZCB8fCAodGhpcy5vYnNlcnZlci5lcnJvciA/IHRoaXMuT3UodGhpcy5vYnNlcnZlci5lcnJvciwgZSkgOiBfX1BSSVZBVEVfbG9nRXJyb3IoXCJVbmNhdWdodCBFcnJvciBpbiBzbmFwc2hvdCBsaXN0ZW5lcjpcIiwgZS50b1N0cmluZygpKSk7XG4gICAgfVxuICAgIE51KCkge1xuICAgICAgICB0aGlzLm11dGVkID0gITA7XG4gICAgfVxuICAgIE91KGUsIHQpIHtcbiAgICAgICAgc2V0VGltZW91dCgoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5tdXRlZCB8fCBlKHQpO1xuICAgICAgICB9KSwgMCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGNsYXNzIHJlcHJlc2VudGluZyBhIGJ1bmRsZS5cbiAqXG4gKiBUYWtlcyBhIGJ1bmRsZSBzdHJlYW0gb3IgYnVmZmVyLCBhbmQgcHJlc2VudHMgYWJzdHJhY3Rpb25zIHRvIHJlYWQgYnVuZGxlZFxuICogZWxlbWVudHMgb3V0IG9mIHRoZSB1bmRlcmx5aW5nIGNvbnRlbnQuXG4gKi8gY2xhc3MgX19QUklWQVRFX0J1bmRsZVJlYWRlckltcGwge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKiBUaGUgcmVhZGVyIHRvIHJlYWQgZnJvbSB1bmRlcmx5aW5nIGJpbmFyeSBidW5kbGUgZGF0YSBzb3VyY2UuICovXG4gICAgZSwgdCkge1xuICAgICAgICB0aGlzLkJ1ID0gZSwgdGhpcy5zZXJpYWxpemVyID0gdCwgXG4gICAgICAgIC8qKiBDYWNoZWQgYnVuZGxlIG1ldGFkYXRhLiAqL1xuICAgICAgICB0aGlzLm1ldGFkYXRhID0gbmV3IF9fUFJJVkFURV9EZWZlcnJlZCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbnRlcm5hbCBidWZmZXIgdG8gaG9sZCBidW5kbGUgY29udGVudCwgYWNjdW11bGF0aW5nIGluY29tcGxldGUgZWxlbWVudFxuICAgICAgICAgKiBjb250ZW50LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5idWZmZXIgPSBuZXcgVWludDhBcnJheSwgdGhpcy5MdSA9IGZ1bmN0aW9uIF9fUFJJVkFURV9uZXdUZXh0RGVjb2RlcigpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoXCJ1dGYtOFwiKTtcbiAgICAgICAgfSgpLCBcbiAgICAgICAgLy8gUmVhZCB0aGUgbWV0YWRhdGEgKHdoaWNoIGlzIHRoZSBmaXJzdCBlbGVtZW50KS5cbiAgICAgICAgdGhpcy5rdSgpLnRoZW4oKGUgPT4ge1xuICAgICAgICAgICAgZSAmJiBlLiRhKCkgPyB0aGlzLm1ldGFkYXRhLnJlc29sdmUoZS5RYS5tZXRhZGF0YSkgOiB0aGlzLm1ldGFkYXRhLnJlamVjdChuZXcgRXJyb3IoYFRoZSBmaXJzdCBlbGVtZW50IG9mIHRoZSBidW5kbGUgaXMgbm90IGEgbWV0YWRhdGEsIGl0IGlzXFxuICAgICAgICAgICAgICR7SlNPTi5zdHJpbmdpZnkoZT8uUWEpfWApKTtcbiAgICAgICAgfSksIChlID0+IHRoaXMubWV0YWRhdGEucmVqZWN0KGUpKSk7XG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5CdS5jYW5jZWwoKTtcbiAgICB9XG4gICAgYXN5bmMgZ2V0TWV0YWRhdGEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1ldGFkYXRhLnByb21pc2U7XG4gICAgfVxuICAgIGFzeW5jIGJ1KCkge1xuICAgICAgICAvLyBNYWtlcyBzdXJlIG1ldGFkYXRhIGlzIHJlYWQgYmVmb3JlIHByb2NlZWRpbmcuXG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmdldE1ldGFkYXRhKCksIHRoaXMua3UoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVhZHMgZnJvbSB0aGUgaGVhZCBvZiBpbnRlcm5hbCBidWZmZXIsIGFuZCBwdWxsaW5nIG1vcmUgZGF0YSBmcm9tXG4gICAgICogdW5kZXJseWluZyBzdHJlYW0gaWYgYSBjb21wbGV0ZSBlbGVtZW50IGNhbm5vdCBiZSBmb3VuZCwgdW50aWwgYW5cbiAgICAgKiBlbGVtZW50KGluY2x1ZGluZyB0aGUgcHJlZml4ZWQgbGVuZ3RoIGFuZCB0aGUgSlNPTiBzdHJpbmcpIGlzIGZvdW5kLlxuICAgICAqXG4gICAgICogT25jZSBhIGNvbXBsZXRlIGVsZW1lbnQgaXMgcmVhZCwgaXQgaXMgZHJvcHBlZCBmcm9tIGludGVybmFsIGJ1ZmZlci5cbiAgICAgKlxuICAgICAqIFJldHVybnMgZWl0aGVyIHRoZSBidW5kbGVkIGVsZW1lbnQsIG9yIG51bGwgaWYgd2UgaGF2ZSByZWFjaGVkIHRoZSBlbmQgb2ZcbiAgICAgKiB0aGUgc3RyZWFtLlxuICAgICAqLyAgICBhc3luYyBrdSgpIHtcbiAgICAgICAgY29uc3QgZSA9IGF3YWl0IHRoaXMucXUoKTtcbiAgICAgICAgaWYgKG51bGwgPT09IGUpIHJldHVybiBudWxsO1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5MdS5kZWNvZGUoZSksIG4gPSBOdW1iZXIodCk7XG4gICAgICAgIGlzTmFOKG4pICYmIHRoaXMuUXUoYGxlbmd0aCBzdHJpbmcgKCR7dH0pIGlzIG5vdCB2YWxpZCBudW1iZXJgKTtcbiAgICAgICAgY29uc3QgciA9IGF3YWl0IHRoaXMuJHUobik7XG4gICAgICAgIHJldHVybiBuZXcgX19QUklWQVRFX1NpemVkQnVuZGxlRWxlbWVudChKU09OLnBhcnNlKHIpLCBlLmxlbmd0aCArIG4pO1xuICAgIH1cbiAgICAvKiogRmlyc3QgaW5kZXggb2YgJ3snIGZyb20gdGhlIHVuZGVybHlpbmcgYnVmZmVyLiAqLyAgICBVdSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYnVmZmVyLmZpbmRJbmRleCgoZSA9PiBlID09PSBcIntcIi5jaGFyQ29kZUF0KDApKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlYWRzIGZyb20gdGhlIGJlZ2lubmluZyBvZiB0aGUgaW50ZXJuYWwgYnVmZmVyLCB1bnRpbCB0aGUgZmlyc3QgJ3snLCBhbmRcbiAgICAgKiByZXR1cm4gdGhlIGNvbnRlbnQuXG4gICAgICpcbiAgICAgKiBJZiByZWFjaGVkIGVuZCBvZiB0aGUgc3RyZWFtLCByZXR1cm5zIGEgbnVsbC5cbiAgICAgKi8gICAgYXN5bmMgcXUoKSB7XG4gICAgICAgIGZvciAoO3RoaXMuVXUoKSA8IDA7ICkge1xuICAgICAgICAgICAgaWYgKGF3YWl0IHRoaXMuS3UoKSkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQnJva2Ugb3V0IG9mIHRoZSBsb29wIGJlY2F1c2UgdW5kZXJseWluZyBzdHJlYW0gaXMgY2xvc2VkLCBhbmQgdGhlcmVcbiAgICAgICAgLy8gaGFwcGVucyB0byBiZSBubyBtb3JlIGRhdGEgdG8gcHJvY2Vzcy5cbiAgICAgICAgICAgICAgICBpZiAoMCA9PT0gdGhpcy5idWZmZXIubGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuVXUoKTtcbiAgICAgICAgLy8gQnJva2Ugb3V0IG9mIHRoZSBsb29wIGJlY2F1c2UgdW5kZXJseWluZyBzdHJlYW0gaXMgY2xvc2VkLCBidXQgc3RpbGxcbiAgICAgICAgLy8gY2Fubm90IGZpbmQgYW4gb3BlbiBicmFja2V0LlxuICAgICAgICAgICAgICAgIGUgPCAwICYmIHRoaXMuUXUoXCJSZWFjaGVkIHRoZSBlbmQgb2YgYnVuZGxlIHdoZW4gYSBsZW5ndGggc3RyaW5nIGlzIGV4cGVjdGVkLlwiKTtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuYnVmZmVyLnNsaWNlKDAsIGUpO1xuICAgICAgICAvLyBVcGRhdGUgdGhlIGludGVybmFsIGJ1ZmZlciB0byBkcm9wIHRoZSByZWFkIGxlbmd0aC5cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5idWZmZXIgPSB0aGlzLmJ1ZmZlci5zbGljZShlKSwgdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVhZHMgZnJvbSBhIHNwZWNpZmllZCBwb3NpdGlvbiBmcm9tIHRoZSBpbnRlcm5hbCBidWZmZXIsIGZvciBhIHNwZWNpZmllZFxuICAgICAqIG51bWJlciBvZiBieXRlcywgcHVsbGluZyBtb3JlIGRhdGEgZnJvbSB0aGUgdW5kZXJseWluZyBzdHJlYW0gaWYgbmVlZGVkLlxuICAgICAqXG4gICAgICogUmV0dXJucyBhIHN0cmluZyBkZWNvZGVkIGZyb20gdGhlIHJlYWQgYnl0ZXMuXG4gICAgICovICAgIGFzeW5jICR1KGUpIHtcbiAgICAgICAgZm9yICg7dGhpcy5idWZmZXIubGVuZ3RoIDwgZTsgKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLkt1KCkgJiYgdGhpcy5RdShcIlJlYWNoZWQgdGhlIGVuZCBvZiBidW5kbGUgd2hlbiBtb3JlIGlzIGV4cGVjdGVkLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB0ID0gdGhpcy5MdS5kZWNvZGUodGhpcy5idWZmZXIuc2xpY2UoMCwgZSkpO1xuICAgICAgICAvLyBVcGRhdGUgdGhlIGludGVybmFsIGJ1ZmZlciB0byBkcm9wIHRoZSByZWFkIGpzb24gc3RyaW5nLlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1ZmZlciA9IHRoaXMuYnVmZmVyLnNsaWNlKGUpLCB0O1xuICAgIH1cbiAgICBRdShlKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgICAgICAgdGhyb3cgdGhpcy5CdS5jYW5jZWwoKSwgbmV3IEVycm9yKGBJbnZhbGlkIGJ1bmRsZSBmb3JtYXQ6ICR7ZX1gKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUHVsbHMgbW9yZSBkYXRhIGZyb20gdW5kZXJseWluZyBzdHJlYW0gdG8gaW50ZXJuYWwgYnVmZmVyLlxuICAgICAqIFJldHVybnMgYSBib29sZWFuIGluZGljYXRpbmcgd2hldGhlciB0aGUgc3RyZWFtIGlzIGZpbmlzaGVkLlxuICAgICAqLyAgICBhc3luYyBLdSgpIHtcbiAgICAgICAgY29uc3QgZSA9IGF3YWl0IHRoaXMuQnUucmVhZCgpO1xuICAgICAgICBpZiAoIWUuZG9uZSkge1xuICAgICAgICAgICAgY29uc3QgdCA9IG5ldyBVaW50OEFycmF5KHRoaXMuYnVmZmVyLmxlbmd0aCArIGUudmFsdWUubGVuZ3RoKTtcbiAgICAgICAgICAgIHQuc2V0KHRoaXMuYnVmZmVyKSwgdC5zZXQoZS52YWx1ZSwgdGhpcy5idWZmZXIubGVuZ3RoKSwgdGhpcy5idWZmZXIgPSB0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlLmRvbmU7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyNSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGNsYXNzIHRoYXQgY2FuIHBhcnNlIGEgYnVuZGxlIGZvcm0gdGhlIHN0cmluZyBzZXJpYWxpemF0aW9uIG9mIGEgYnVuZGxlLlxuICovXG5jbGFzcyBfX1BSSVZBVEVfQnVuZGxlUmVhZGVyU3luY0ltcGwge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQpIHtcbiAgICAgICAgdGhpcy5idW5kbGVEYXRhID0gZSwgdGhpcy5zZXJpYWxpemVyID0gdCwgdGhpcy5jdXJzb3IgPSAwLCB0aGlzLmVsZW1lbnRzID0gW107XG4gICAgICAgIGxldCBuID0gdGhpcy5idSgpO1xuICAgICAgICBpZiAoIW4gfHwgIW4uJGEoKSkgdGhyb3cgbmV3IEVycm9yKGBUaGUgZmlyc3QgZWxlbWVudCBvZiB0aGUgYnVuZGxlIGlzIG5vdCBhIG1ldGFkYXRhIG9iamVjdCwgaXQgaXNcXG4gICAgICAgICAke0pTT04uc3RyaW5naWZ5KG4/LlFhKX1gKTtcbiAgICAgICAgdGhpcy5tZXRhZGF0YSA9IG47XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIG4gPSB0aGlzLmJ1KCksIG51bGwgIT09IG4gJiYgdGhpcy5lbGVtZW50cy5wdXNoKG4pO1xuICAgICAgICB9IHdoaWxlIChudWxsICE9PSBuKTtcbiAgICB9XG4gICAgLyogUmV0dXJucyB0aGUgcGFyc2VkIG1ldGFkYXRhIG9mIHRoZSBidW5kbGUuICovICAgIGdldE1ldGFkYXRhKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tZXRhZGF0YTtcbiAgICB9XG4gICAgLyogUmV0dXJucyB0aGUgRG9jdW1lbnRTbmFwc2hvdCBvciBOYW1lZFF1ZXJ5IGVsZW1lbnRzIG9mIHRoZSBidW5kbGUuICovICAgIFd1KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50cztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIHRoZSBuZXh0IGVsZW1lbnQgb2YgdGhlIGJ1bmRsZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIGEgU2l6ZWRCdW5kbGVFbGVtZW50IHJlcHJlc2VudGF0aW9uIG9mIHRoZSBuZXh0IGVsZW1lbnQgaW4gdGhlIGJ1bmRsZSwgb3IgbnVsbCBpZlxuICAgICAqIG5vIG1vcmUgZWxlbWVudHMgZXhpc3QuXG4gICAgICovICAgIGJ1KCkge1xuICAgICAgICBpZiAodGhpcy5jdXJzb3IgPT09IHRoaXMuYnVuZGxlRGF0YS5sZW5ndGgpIHJldHVybiBudWxsO1xuICAgICAgICBjb25zdCBlID0gdGhpcy5xdSgpLCB0ID0gdGhpcy4kdShlKTtcbiAgICAgICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfU2l6ZWRCdW5kbGVFbGVtZW50KEpTT04ucGFyc2UodCksIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWFkcyBmcm9tIGEgc3BlY2lmaWVkIHBvc2l0aW9uIGZyb20gdGhlIGJ1bmRsZURhdGEgc3RyaW5nLCBmb3IgYSBzcGVjaWZpZWRcbiAgICAgKiBudW1iZXIgb2YgYnl0ZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbGVuZ3RoIGhvdyBtYW55IGNoYXJhY3RlcnMgdG8gcmVhZC5cbiAgICAgKiBAcmV0dXJucyBhIHN0cmluZyBwYXJzZWQgZnJvbSB0aGUgYnVuZGxlLlxuICAgICAqLyAgICAkdShlKSB7XG4gICAgICAgIGlmICh0aGlzLmN1cnNvciArIGUgPiB0aGlzLmJ1bmRsZURhdGEubGVuZ3RoKSB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlRFUk5BTCwgXCJSZWFjaGVkIHRoZSBlbmQgb2YgYnVuZGxlIHdoZW4gbW9yZSBpcyBleHBlY3RlZC5cIik7XG4gICAgICAgIHJldHVybiB0aGlzLmJ1bmRsZURhdGEuc2xpY2UodGhpcy5jdXJzb3IsIHRoaXMuY3Vyc29yICs9IGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWFkcyBmcm9tIHRoZSBjdXJyZW50IGN1cnNvciB1bnRpbCB0aGUgZmlyc3QgJ3snLlxuICAgICAqXG4gICAgICogQHJldHVybnMgIEEgc3RyaW5nIHRvIGludGVnZXIgcmVwcmVzZW50aW9uIG9mIHRoZSBwYXJzZWQgdmFsdWUuXG4gICAgICogQHRocm93cyBBbiB7QGxpbmsgRXJyb3J9IGlmIHRoZSBjdXJzb3IgaGFzIHJlYWNoZWQgdGhlIGVuZCBvZiB0aGUgc3RyZWFtLCBzaW5jZSBsZW5ndGhzXG4gICAgICogcHJlZml4IGJ1bmRsZSBvYmplY3RzLlxuICAgICAqLyAgICBxdSgpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuY3Vyc29yO1xuICAgICAgICBsZXQgdCA9IHRoaXMuY3Vyc29yO1xuICAgICAgICBmb3IgKDt0IDwgdGhpcy5idW5kbGVEYXRhLmxlbmd0aDsgKSB7XG4gICAgICAgICAgICBpZiAoXCJ7XCIgPT09IHRoaXMuYnVuZGxlRGF0YVt0XSkge1xuICAgICAgICAgICAgICAgIGlmICh0ID09PSBlKSB0aHJvdyBuZXcgRXJyb3IoXCJGaXJzdCBjaGFyYWN0ZXIgaXMgYSBicmFja2V0IGFuZCBub3QgYSBudW1iZXJcIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3Vyc29yID0gdCwgTnVtYmVyKHRoaXMuYnVuZGxlRGF0YS5zbGljZShlLCB0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0Kys7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUmVhY2hlZCB0aGUgZW5kIG9mIGJ1bmRsZSB3aGVuIG1vcmUgaXMgZXhwZWN0ZWQuXCIpO1xuICAgIH1cbn1cblxuLyoqXG4gKiAgQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBCdW5kbGVSZWFkZXIgd2l0aG91dCBleHBvc2luZyB0aGUgQnVuZGxlUmVhZGVyU3luY0ltcGwgY2xhc3MgdHlwZS5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogSW50ZXJuYWwgdHJhbnNhY3Rpb24gb2JqZWN0IHJlc3BvbnNpYmxlIGZvciBhY2N1bXVsYXRpbmcgdGhlIG11dGF0aW9ucyB0b1xuICogcGVyZm9ybSBhbmQgdGhlIGJhc2UgdmVyc2lvbnMgZm9yIGFueSBkb2N1bWVudHMgcmVhZC5cbiAqL1xuY2xhc3MgVHJhbnNhY3Rpb24kMiB7XG4gICAgY29uc3RydWN0b3IoZSkge1xuICAgICAgICB0aGlzLmRhdGFzdG9yZSA9IGUsIFxuICAgICAgICAvLyBUaGUgdmVyc2lvbiBvZiBlYWNoIGRvY3VtZW50IHRoYXQgd2FzIHJlYWQgZHVyaW5nIHRoaXMgdHJhbnNhY3Rpb24uXG4gICAgICAgIHRoaXMucmVhZFZlcnNpb25zID0gbmV3IE1hcCwgdGhpcy5tdXRhdGlvbnMgPSBbXSwgdGhpcy5jb21taXR0ZWQgPSAhMSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGRlZmVycmVkIHVzYWdlIGVycm9yIHRoYXQgb2NjdXJyZWQgcHJldmlvdXNseSBpbiB0aGlzIHRyYW5zYWN0aW9uIHRoYXRcbiAgICAgICAgICogd2lsbCBjYXVzZSB0aGUgdHJhbnNhY3Rpb24gdG8gZmFpbCBvbmNlIGl0IGFjdHVhbGx5IGNvbW1pdHMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmxhc3RUcmFuc2FjdGlvbkVycm9yID0gbnVsbCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXQgb2YgZG9jdW1lbnRzIHRoYXQgaGF2ZSBiZWVuIHdyaXR0ZW4gaW4gdGhlIHRyYW5zYWN0aW9uLlxuICAgICAgICAgKlxuICAgICAgICAgKiBXaGVuIHRoZXJlJ3MgbW9yZSB0aGFuIG9uZSB3cml0ZSB0byB0aGUgc2FtZSBrZXkgaW4gYSB0cmFuc2FjdGlvbiwgYW55XG4gICAgICAgICAqIHdyaXRlcyBhZnRlciB0aGUgZmlyc3QgYXJlIGhhbmRsZWQgZGlmZmVyZW50bHkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLndyaXR0ZW5Eb2NzID0gbmV3IFNldDtcbiAgICB9XG4gICAgYXN5bmMgbG9va3VwKGUpIHtcbiAgICAgICAgaWYgKHRoaXMuZW5zdXJlQ29tbWl0Tm90Q2FsbGVkKCksIHRoaXMubXV0YXRpb25zLmxlbmd0aCA+IDApIHRocm93IHRoaXMubGFzdFRyYW5zYWN0aW9uRXJyb3IgPSBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBcIkZpcmVzdG9yZSB0cmFuc2FjdGlvbnMgcmVxdWlyZSBhbGwgcmVhZHMgdG8gYmUgZXhlY3V0ZWQgYmVmb3JlIGFsbCB3cml0ZXMuXCIpLCBcbiAgICAgICAgdGhpcy5sYXN0VHJhbnNhY3Rpb25FcnJvcjtcbiAgICAgICAgY29uc3QgdCA9IGF3YWl0IGFzeW5jIGZ1bmN0aW9uIF9fUFJJVkFURV9pbnZva2VCYXRjaEdldERvY3VtZW50c1JwYyhlLCB0KSB7XG4gICAgICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKSwgciA9IHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudHM6IHQubWFwKChlID0+IF9fUFJJVkFURV90b05hbWUobi5zZXJpYWxpemVyLCBlKSkpXG4gICAgICAgICAgICB9LCBpID0gYXdhaXQgbi5IbyhcIkJhdGNoR2V0RG9jdW1lbnRzXCIsIG4uc2VyaWFsaXplci5kYXRhYmFzZUlkLCBSZXNvdXJjZVBhdGguZW1wdHlQYXRoKCksIHIsIHQubGVuZ3RoKSwgcyA9IG5ldyBNYXA7XG4gICAgICAgICAgICBpLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBfX1BSSVZBVEVfZnJvbUJhdGNoR2V0RG9jdW1lbnRzUmVzcG9uc2Uobi5zZXJpYWxpemVyLCBlKTtcbiAgICAgICAgICAgICAgICBzLnNldCh0LmtleS50b1N0cmluZygpLCB0KTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIGNvbnN0IG8gPSBbXTtcbiAgICAgICAgICAgIHJldHVybiB0LmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBzLmdldChlLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgIF9fUFJJVkFURV9oYXJkQXNzZXJ0KCEhdCwgNTUyMzQsIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiBlXG4gICAgICAgICAgICAgICAgfSksIG8ucHVzaCh0KTtcbiAgICAgICAgICAgIH0pKSwgbztcbiAgICAgICAgfSh0aGlzLmRhdGFzdG9yZSwgZSk7XG4gICAgICAgIHJldHVybiB0LmZvckVhY2goKGUgPT4gdGhpcy5yZWNvcmRWZXJzaW9uKGUpKSksIHQ7XG4gICAgfVxuICAgIHNldChlLCB0KSB7XG4gICAgICAgIHRoaXMud3JpdGUodC50b011dGF0aW9uKGUsIHRoaXMucHJlY29uZGl0aW9uKGUpKSksIHRoaXMud3JpdHRlbkRvY3MuYWRkKGUudG9TdHJpbmcoKSk7XG4gICAgfVxuICAgIHVwZGF0ZShlLCB0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLndyaXRlKHQudG9NdXRhdGlvbihlLCB0aGlzLnByZWNvbmRpdGlvbkZvclVwZGF0ZShlKSkpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICB0aGlzLmxhc3RUcmFuc2FjdGlvbkVycm9yID0gZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLndyaXR0ZW5Eb2NzLmFkZChlLnRvU3RyaW5nKCkpO1xuICAgIH1cbiAgICBkZWxldGUoZSkge1xuICAgICAgICB0aGlzLndyaXRlKG5ldyBfX1BSSVZBVEVfRGVsZXRlTXV0YXRpb24oZSwgdGhpcy5wcmVjb25kaXRpb24oZSkpKSwgdGhpcy53cml0dGVuRG9jcy5hZGQoZS50b1N0cmluZygpKTtcbiAgICB9XG4gICAgYXN5bmMgY29tbWl0KCkge1xuICAgICAgICBpZiAodGhpcy5lbnN1cmVDb21taXROb3RDYWxsZWQoKSwgdGhpcy5sYXN0VHJhbnNhY3Rpb25FcnJvcikgdGhyb3cgdGhpcy5sYXN0VHJhbnNhY3Rpb25FcnJvcjtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMucmVhZFZlcnNpb25zO1xuICAgICAgICAvLyBGb3IgZWFjaCBtdXRhdGlvbiwgbm90ZSB0aGF0IHRoZSBkb2Mgd2FzIHdyaXR0ZW4uXG4gICAgICAgICAgICAgICAgdGhpcy5tdXRhdGlvbnMuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICBlLmRlbGV0ZSh0LmtleS50b1N0cmluZygpKTtcbiAgICAgICAgfSkpLCBcbiAgICAgICAgLy8gRm9yIGVhY2ggZG9jdW1lbnQgdGhhdCB3YXMgcmVhZCBidXQgbm90IHdyaXR0ZW4gdG8sIHdlIHdhbnQgdG8gcGVyZm9ybVxuICAgICAgICAvLyBhIGB2ZXJpZnlgIG9wZXJhdGlvbi5cbiAgICAgICAgZS5mb3JFYWNoKCgoZSwgdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbiA9IERvY3VtZW50S2V5LmZyb21QYXRoKHQpO1xuICAgICAgICAgICAgdGhpcy5tdXRhdGlvbnMucHVzaChuZXcgX19QUklWQVRFX1ZlcmlmeU11dGF0aW9uKG4sIHRoaXMucHJlY29uZGl0aW9uKG4pKSk7XG4gICAgICAgIH0pKSwgYXdhaXQgYXN5bmMgZnVuY3Rpb24gX19QUklWQVRFX2ludm9rZUNvbW1pdFJwYyhlLCB0KSB7XG4gICAgICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKSwgciA9IHtcbiAgICAgICAgICAgICAgICB3cml0ZXM6IHQubWFwKChlID0+IHRvTXV0YXRpb24obi5zZXJpYWxpemVyLCBlKSkpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYXdhaXQgbi5HbyhcIkNvbW1pdFwiLCBuLnNlcmlhbGl6ZXIuZGF0YWJhc2VJZCwgUmVzb3VyY2VQYXRoLmVtcHR5UGF0aCgpLCByKTtcbiAgICAgICAgfSh0aGlzLmRhdGFzdG9yZSwgdGhpcy5tdXRhdGlvbnMpLCB0aGlzLmNvbW1pdHRlZCA9ICEwO1xuICAgIH1cbiAgICByZWNvcmRWZXJzaW9uKGUpIHtcbiAgICAgICAgbGV0IHQ7XG4gICAgICAgIGlmIChlLmlzRm91bmREb2N1bWVudCgpKSB0ID0gZS52ZXJzaW9uOyBlbHNlIHtcbiAgICAgICAgICAgIGlmICghZS5pc05vRG9jdW1lbnQoKSkgdGhyb3cgZmFpbCg1MDQ5OCwge1xuICAgICAgICAgICAgICAgIEd1OiBlLmNvbnN0cnVjdG9yLm5hbWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gUmVwcmVzZW50IGEgZGVsZXRlZCBkb2MgdXNpbmcgU25hcHNob3RWZXJzaW9uLm1pbigpLlxuICAgICAgICAgICAgdCA9IFNuYXBzaG90VmVyc2lvbi5taW4oKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBuID0gdGhpcy5yZWFkVmVyc2lvbnMuZ2V0KGUua2V5LnRvU3RyaW5nKCkpO1xuICAgICAgICBpZiAobikge1xuICAgICAgICAgICAgaWYgKCF0LmlzRXF1YWwobikpIFxuICAgICAgICAgICAgLy8gVGhpcyB0cmFuc2FjdGlvbiB3aWxsIGZhaWwgbm8gbWF0dGVyIHdoYXQuXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5BQk9SVEVELCBcIkRvY3VtZW50IHZlcnNpb24gY2hhbmdlZCBiZXR3ZWVuIHR3byByZWFkcy5cIik7XG4gICAgICAgIH0gZWxzZSB0aGlzLnJlYWRWZXJzaW9ucy5zZXQoZS5rZXkudG9TdHJpbmcoKSwgdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHZlcnNpb24gb2YgdGhpcyBkb2N1bWVudCB3aGVuIGl0IHdhcyByZWFkIGluIHRoaXMgdHJhbnNhY3Rpb24sXG4gICAgICogYXMgYSBwcmVjb25kaXRpb24sIG9yIG5vIHByZWNvbmRpdGlvbiBpZiBpdCB3YXMgbm90IHJlYWQuXG4gICAgICovICAgIHByZWNvbmRpdGlvbihlKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLnJlYWRWZXJzaW9ucy5nZXQoZS50b1N0cmluZygpKTtcbiAgICAgICAgcmV0dXJuICF0aGlzLndyaXR0ZW5Eb2NzLmhhcyhlLnRvU3RyaW5nKCkpICYmIHQgPyB0LmlzRXF1YWwoU25hcHNob3RWZXJzaW9uLm1pbigpKSA/IFByZWNvbmRpdGlvbi5leGlzdHMoITEpIDogUHJlY29uZGl0aW9uLnVwZGF0ZVRpbWUodCkgOiBQcmVjb25kaXRpb24ubm9uZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBwcmVjb25kaXRpb24gZm9yIGEgZG9jdW1lbnQgaWYgdGhlIG9wZXJhdGlvbiBpcyBhbiB1cGRhdGUuXG4gICAgICovICAgIHByZWNvbmRpdGlvbkZvclVwZGF0ZShlKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLnJlYWRWZXJzaW9ucy5nZXQoZS50b1N0cmluZygpKTtcbiAgICAgICAgLy8gVGhlIGZpcnN0IHRpbWUgYSBkb2N1bWVudCBpcyB3cml0dGVuLCB3ZSB3YW50IHRvIHRha2UgaW50byBhY2NvdW50IHRoZVxuICAgICAgICAvLyByZWFkIHRpbWUgYW5kIGV4aXN0ZW5jZVxuICAgICAgICAgICAgICAgIGlmICghdGhpcy53cml0dGVuRG9jcy5oYXMoZS50b1N0cmluZygpKSAmJiB0KSB7XG4gICAgICAgICAgICBpZiAodC5pc0VxdWFsKFNuYXBzaG90VmVyc2lvbi5taW4oKSkpIFxuICAgICAgICAgICAgLy8gVGhlIGRvY3VtZW50IGRvZXNuJ3QgZXhpc3QsIHNvIGZhaWwgdGhlIHRyYW5zYWN0aW9uLlxuICAgICAgICAgICAgLy8gVGhpcyBoYXMgdG8gYmUgdmFsaWRhdGVkIGxvY2FsbHkgYmVjYXVzZSB5b3UgY2FuJ3Qgc2VuZCBhXG4gICAgICAgICAgICAvLyBwcmVjb25kaXRpb24gdGhhdCBhIGRvY3VtZW50IGRvZXMgbm90IGV4aXN0IHdpdGhvdXQgY2hhbmdpbmcgdGhlXG4gICAgICAgICAgICAvLyBzZW1hbnRpY3Mgb2YgdGhlIGJhY2tlbmQgd3JpdGUgdG8gYmUgYW4gaW5zZXJ0LiBUaGlzIGlzIHRoZSByZXZlcnNlXG4gICAgICAgICAgICAvLyBvZiB3aGF0IHdlIHdhbnQsIHNpbmNlIHdlIHdhbnQgdG8gYXNzZXJ0IHRoYXQgdGhlIGRvY3VtZW50IGRvZXNuJ3RcbiAgICAgICAgICAgIC8vIGV4aXN0IGJ1dCB0aGVuIHNlbmQgdGhlIHVwZGF0ZSBhbmQgaGF2ZSBpdCBmYWlsLiBTaW5jZSB3ZSBjYW4ndFxuICAgICAgICAgICAgLy8gZXhwcmVzcyB0aGF0IHRvIHRoZSBiYWNrZW5kLCB3ZSBoYXZlIHRvIHZhbGlkYXRlIGxvY2FsbHkuXG4gICAgICAgICAgICAvLyBOb3RlOiB0aGlzIGNhbiBjaGFuZ2Ugb25jZSB3ZSBjYW4gc2VuZCBzZXBhcmF0ZSB2ZXJpZnkgd3JpdGVzIGluIHRoZVxuICAgICAgICAgICAgLy8gdHJhbnNhY3Rpb24uXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBcIkNhbid0IHVwZGF0ZSBhIGRvY3VtZW50IHRoYXQgZG9lc24ndCBleGlzdC5cIik7XG4gICAgICAgICAgICAvLyBEb2N1bWVudCBleGlzdHMsIGJhc2UgcHJlY29uZGl0aW9uIG9uIGRvY3VtZW50IHVwZGF0ZSB0aW1lLlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByZWNvbmRpdGlvbi51cGRhdGVUaW1lKHQpO1xuICAgICAgICB9XG4gICAgICAgIC8vIERvY3VtZW50IHdhcyBub3QgcmVhZCwgc28gd2UganVzdCB1c2UgdGhlIHByZWNvbmRpdGlvbnMgZm9yIGEgYmxpbmRcbiAgICAgICAgLy8gdXBkYXRlLlxuICAgICAgICByZXR1cm4gUHJlY29uZGl0aW9uLmV4aXN0cyghMCk7XG4gICAgfVxuICAgIHdyaXRlKGUpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVDb21taXROb3RDYWxsZWQoKSwgdGhpcy5tdXRhdGlvbnMucHVzaChlKTtcbiAgICB9XG4gICAgZW5zdXJlQ29tbWl0Tm90Q2FsbGVkKCkge31cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVHJhbnNhY3Rpb25SdW5uZXIgZW5jYXBzdWxhdGVzIHRoZSBsb2dpYyBuZWVkZWQgdG8gcnVuIGFuZCByZXRyeSB0cmFuc2FjdGlvbnNcbiAqIHdpdGggYmFja29mZi5cbiAqLyBjbGFzcyBfX1BSSVZBVEVfVHJhbnNhY3Rpb25SdW5uZXIge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4sIHIsIGkpIHtcbiAgICAgICAgdGhpcy5hc3luY1F1ZXVlID0gZSwgdGhpcy5kYXRhc3RvcmUgPSB0LCB0aGlzLm9wdGlvbnMgPSBuLCB0aGlzLnVwZGF0ZUZ1bmN0aW9uID0gciwgXG4gICAgICAgIHRoaXMuZGVmZXJyZWQgPSBpLCB0aGlzLnp1ID0gbi5tYXhBdHRlbXB0cywgdGhpcy5NXyA9IG5ldyBfX1BSSVZBVEVfRXhwb25lbnRpYWxCYWNrb2ZmKHRoaXMuYXN5bmNRdWV1ZSwgXCJ0cmFuc2FjdGlvbl9yZXRyeVwiIC8qIFRpbWVySWQuVHJhbnNhY3Rpb25SZXRyeSAqLyk7XG4gICAgfVxuICAgIC8qKiBSdW5zIHRoZSB0cmFuc2FjdGlvbiBhbmQgc2V0cyB0aGUgcmVzdWx0IG9uIGRlZmVycmVkLiAqLyAgICBqdSgpIHtcbiAgICAgICAgdGhpcy56dSAtPSAxLCB0aGlzLkp1KCk7XG4gICAgfVxuICAgIEp1KCkge1xuICAgICAgICB0aGlzLk1fLnBfKChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlID0gbmV3IFRyYW5zYWN0aW9uJDIodGhpcy5kYXRhc3RvcmUpLCB0ID0gdGhpcy5IdShlKTtcbiAgICAgICAgICAgIHQgJiYgdC50aGVuKCh0ID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gZS5jb21taXQoKS50aGVuKCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGVmZXJyZWQucmVzb2x2ZSh0KTtcbiAgICAgICAgICAgICAgICB9KSkuY2F0Y2goKGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLll1KGUpO1xuICAgICAgICAgICAgICAgIH0pKSkpO1xuICAgICAgICAgICAgfSkpLmNhdGNoKChlID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLll1KGUpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIEh1KGUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLnVwZGF0ZUZ1bmN0aW9uKGUpO1xuICAgICAgICAgICAgcmV0dXJuICFfX1BSSVZBVEVfaXNOdWxsT3JVbmRlZmluZWQodCkgJiYgdC5jYXRjaCAmJiB0LnRoZW4gPyB0IDogKHRoaXMuZGVmZXJyZWQucmVqZWN0KEVycm9yKFwiVHJhbnNhY3Rpb24gY2FsbGJhY2sgbXVzdCByZXR1cm4gYSBQcm9taXNlXCIpKSwgXG4gICAgICAgICAgICBudWxsKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgLy8gRG8gbm90IHJldHJ5IGVycm9ycyB0aHJvd24gYnkgdXNlciBwcm92aWRlZCB1cGRhdGVGdW5jdGlvbi5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRlZmVycmVkLnJlamVjdChlKSwgbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBZdShlKSB7XG4gICAgICAgIHRoaXMuenUgPiAwICYmIHRoaXMuWnUoZSkgPyAodGhpcy56dSAtPSAxLCB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gKHRoaXMuSnUoKSwgXG4gICAgICAgIFByb21pc2UucmVzb2x2ZSgpKSkpKSA6IHRoaXMuZGVmZXJyZWQucmVqZWN0KGUpO1xuICAgIH1cbiAgICBadShlKSB7XG4gICAgICAgIGlmIChcIkZpcmViYXNlRXJyb3JcIiA9PT0gZT8ubmFtZSkge1xuICAgICAgICAgICAgLy8gSW4gdHJhbnNhY3Rpb25zLCB0aGUgYmFja2VuZCB3aWxsIGZhaWwgb3V0ZGF0ZWQgcmVhZHMgd2l0aCBGQUlMRURfUFJFQ09ORElUSU9OIGFuZFxuICAgICAgICAgICAgLy8gbm9uLW1hdGNoaW5nIGRvY3VtZW50IHZlcnNpb25zIHdpdGggQUJPUlRFRC4gVGhlc2UgZXJyb3JzIHNob3VsZCBiZSByZXRyaWVkLlxuICAgICAgICAgICAgY29uc3QgdCA9IGUuY29kZTtcbiAgICAgICAgICAgIHJldHVybiBcImFib3J0ZWRcIiA9PT0gdCB8fCBcImZhaWxlZC1wcmVjb25kaXRpb25cIiA9PT0gdCB8fCBcImFscmVhZHktZXhpc3RzXCIgPT09IHQgfHwgIV9fUFJJVkFURV9pc1Blcm1hbmVudEVycm9yKHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhMTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IG9uID0gXCJGaXJlc3RvcmVDbGllbnRcIjtcblxuLyoqXG4gKiBGaXJlc3RvcmVDbGllbnQgaXMgYSB0b3AtbGV2ZWwgY2xhc3MgdGhhdCBjb25zdHJ1Y3RzIGFuZCBvd25zIGFsbCBvZiB0aGUgLy9cbiAqIHBpZWNlcyBvZiB0aGUgY2xpZW50IFNESyBhcmNoaXRlY3R1cmUuIEl0IGlzIHJlc3BvbnNpYmxlIGZvciBjcmVhdGluZyB0aGUgLy9cbiAqIGFzeW5jIHF1ZXVlIHRoYXQgaXMgc2hhcmVkIGJ5IGFsbCBvZiB0aGUgb3RoZXIgY29tcG9uZW50cyBpbiB0aGUgc3lzdGVtLiAvL1xuICovXG5jbGFzcyBGaXJlc3RvcmVDbGllbnQge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIFxuICAgIC8qKlxuICAgICAqIEFzeW5jaHJvbm91cyBxdWV1ZSByZXNwb25zaWJsZSBmb3IgYWxsIG9mIG91ciBpbnRlcm5hbCBwcm9jZXNzaW5nLiBXaGVuXG4gICAgICogd2UgZ2V0IGluY29taW5nIHdvcmsgZnJvbSB0aGUgdXNlciAodmlhIHB1YmxpYyBBUEkpIG9yIHRoZSBuZXR3b3JrXG4gICAgICogKGluY29taW5nIEdSUEMgbWVzc2FnZXMpLCB3ZSBzaG91bGQgYWx3YXlzIHNjaGVkdWxlIG9udG8gdGhpcyBxdWV1ZS5cbiAgICAgKiBUaGlzIGVuc3VyZXMgYWxsIG9mIG91ciB3b3JrIGlzIHByb3Blcmx5IHNlcmlhbGl6ZWQgKGUuZy4gd2UgZG9uJ3RcbiAgICAgKiBzdGFydCBwcm9jZXNzaW5nIGEgbmV3IG9wZXJhdGlvbiB3aGlsZSB0aGUgcHJldmlvdXMgb25lIGlzIHdhaXRpbmcgZm9yXG4gICAgICogYW4gYXN5bmMgSS9PIHRvIGNvbXBsZXRlKS5cbiAgICAgKi9cbiAgICBuLCByLCBpKSB7XG4gICAgICAgIHRoaXMuYXV0aENyZWRlbnRpYWxzID0gZSwgdGhpcy5hcHBDaGVja0NyZWRlbnRpYWxzID0gdCwgdGhpcy5hc3luY1F1ZXVlID0gbiwgdGhpcy5kYXRhYmFzZUluZm8gPSByLCBcbiAgICAgICAgdGhpcy51c2VyID0gVXNlci5VTkFVVEhFTlRJQ0FURUQsIHRoaXMuY2xpZW50SWQgPSBfX1BSSVZBVEVfQXV0b0lkLm5ld0lkKCksIHRoaXMuYXV0aENyZWRlbnRpYWxMaXN0ZW5lciA9ICgpID0+IFByb21pc2UucmVzb2x2ZSgpLCBcbiAgICAgICAgdGhpcy5hcHBDaGVja0NyZWRlbnRpYWxMaXN0ZW5lciA9ICgpID0+IFByb21pc2UucmVzb2x2ZSgpLCB0aGlzLl91bmluaXRpYWxpemVkQ29tcG9uZW50c1Byb3ZpZGVyID0gaSwgXG4gICAgICAgIHRoaXMuYXV0aENyZWRlbnRpYWxzLnN0YXJ0KG4sIChhc3luYyBlID0+IHtcbiAgICAgICAgICAgIF9fUFJJVkFURV9sb2dEZWJ1ZyhvbiwgXCJSZWNlaXZlZCB1c2VyPVwiLCBlLnVpZCksIGF3YWl0IHRoaXMuYXV0aENyZWRlbnRpYWxMaXN0ZW5lcihlKSwgXG4gICAgICAgICAgICB0aGlzLnVzZXIgPSBlO1xuICAgICAgICB9KSksIHRoaXMuYXBwQ2hlY2tDcmVkZW50aWFscy5zdGFydChuLCAoZSA9PiAoX19QUklWQVRFX2xvZ0RlYnVnKG9uLCBcIlJlY2VpdmVkIG5ldyBhcHAgY2hlY2sgdG9rZW49XCIsIGUpLCBcbiAgICAgICAgdGhpcy5hcHBDaGVja0NyZWRlbnRpYWxMaXN0ZW5lcihlLCB0aGlzLnVzZXIpKSkpO1xuICAgIH1cbiAgICBnZXQgY29uZmlndXJhdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFzeW5jUXVldWU6IHRoaXMuYXN5bmNRdWV1ZSxcbiAgICAgICAgICAgIGRhdGFiYXNlSW5mbzogdGhpcy5kYXRhYmFzZUluZm8sXG4gICAgICAgICAgICBjbGllbnRJZDogdGhpcy5jbGllbnRJZCxcbiAgICAgICAgICAgIGF1dGhDcmVkZW50aWFsczogdGhpcy5hdXRoQ3JlZGVudGlhbHMsXG4gICAgICAgICAgICBhcHBDaGVja0NyZWRlbnRpYWxzOiB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHMsXG4gICAgICAgICAgICBpbml0aWFsVXNlcjogdGhpcy51c2VyLFxuICAgICAgICAgICAgbWF4Q29uY3VycmVudExpbWJvUmVzb2x1dGlvbnM6IDEwMFxuICAgICAgICB9O1xuICAgIH1cbiAgICBzZXRDcmVkZW50aWFsQ2hhbmdlTGlzdGVuZXIoZSkge1xuICAgICAgICB0aGlzLmF1dGhDcmVkZW50aWFsTGlzdGVuZXIgPSBlO1xuICAgIH1cbiAgICBzZXRBcHBDaGVja1Rva2VuQ2hhbmdlTGlzdGVuZXIoZSkge1xuICAgICAgICB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbExpc3RlbmVyID0gZTtcbiAgICB9XG4gICAgdGVybWluYXRlKCkge1xuICAgICAgICB0aGlzLmFzeW5jUXVldWUuZW50ZXJSZXN0cmljdGVkTW9kZSgpO1xuICAgICAgICBjb25zdCBlID0gbmV3IF9fUFJJVkFURV9EZWZlcnJlZDtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0RXZlbldoaWxlUmVzdHJpY3RlZCgoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbmxpbmVDb21wb25lbnRzICYmIGF3YWl0IHRoaXMuX29ubGluZUNvbXBvbmVudHMudGVybWluYXRlKCksIHRoaXMuX29mZmxpbmVDb21wb25lbnRzICYmIGF3YWl0IHRoaXMuX29mZmxpbmVDb21wb25lbnRzLnRlcm1pbmF0ZSgpLCBcbiAgICAgICAgICAgICAgICAvLyBUaGUgY3JlZGVudGlhbHMgcHJvdmlkZXIgbXVzdCBiZSB0ZXJtaW5hdGVkIGFmdGVyIHNodXR0aW5nIGRvd24gdGhlXG4gICAgICAgICAgICAgICAgLy8gUmVtb3RlU3RvcmUgYXMgaXQgd2lsbCBwcmV2ZW50IHRoZSBSZW1vdGVTdG9yZSBmcm9tIHJldHJpZXZpbmcgYXV0aFxuICAgICAgICAgICAgICAgIC8vIHRva2Vucy5cbiAgICAgICAgICAgICAgICB0aGlzLmF1dGhDcmVkZW50aWFscy5zaHV0ZG93bigpLCB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHMuc2h1dGRvd24oKSwgZS5yZXNvbHZlKCk7XG4gICAgICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IF9fUFJJVkFURV93cmFwSW5Vc2VyRXJyb3JJZlJlY292ZXJhYmxlKHQsIFwiRmFpbGVkIHRvIHNodXRkb3duIHBlcnNpc3RlbmNlXCIpO1xuICAgICAgICAgICAgICAgIGUucmVqZWN0KG4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSksIGUucHJvbWlzZTtcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIF9fUFJJVkFURV9zZXRPZmZsaW5lQ29tcG9uZW50UHJvdmlkZXIoZSwgdCkge1xuICAgIGUuYXN5bmNRdWV1ZS52ZXJpZnlPcGVyYXRpb25JblByb2dyZXNzKCksIF9fUFJJVkFURV9sb2dEZWJ1ZyhvbiwgXCJJbml0aWFsaXppbmcgT2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyXCIpO1xuICAgIGNvbnN0IG4gPSBlLmNvbmZpZ3VyYXRpb247XG4gICAgYXdhaXQgdC5pbml0aWFsaXplKG4pO1xuICAgIGxldCByID0gbi5pbml0aWFsVXNlcjtcbiAgICBlLnNldENyZWRlbnRpYWxDaGFuZ2VMaXN0ZW5lcigoYXN5bmMgZSA9PiB7XG4gICAgICAgIHIuaXNFcXVhbChlKSB8fCAoYXdhaXQgX19QUklWQVRFX2xvY2FsU3RvcmVIYW5kbGVVc2VyQ2hhbmdlKHQubG9jYWxTdG9yZSwgZSksIHIgPSBlKTtcbiAgICB9KSksIFxuICAgIC8vIFdoZW4gYSB1c2VyIGNhbGxzIGNsZWFyUGVyc2lzdGVuY2UoKSBpbiBvbmUgY2xpZW50LCBhbGwgb3RoZXIgY2xpZW50c1xuICAgIC8vIG5lZWQgdG8gYmUgdGVybWluYXRlZCB0byBhbGxvdyB0aGUgZGVsZXRlIHRvIHN1Y2NlZWQuXG4gICAgdC5wZXJzaXN0ZW5jZS5zZXREYXRhYmFzZURlbGV0ZWRMaXN0ZW5lcigoKCkgPT4gZS50ZXJtaW5hdGUoKSkpLCBlLl9vZmZsaW5lQ29tcG9uZW50cyA9IHQ7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIF9fUFJJVkFURV9zZXRPbmxpbmVDb21wb25lbnRQcm92aWRlcihlLCB0KSB7XG4gICAgZS5hc3luY1F1ZXVlLnZlcmlmeU9wZXJhdGlvbkluUHJvZ3Jlc3MoKTtcbiAgICBjb25zdCBuID0gYXdhaXQgX19QUklWQVRFX2Vuc3VyZU9mZmxpbmVDb21wb25lbnRzKGUpO1xuICAgIF9fUFJJVkFURV9sb2dEZWJ1ZyhvbiwgXCJJbml0aWFsaXppbmcgT25saW5lQ29tcG9uZW50UHJvdmlkZXJcIiksIGF3YWl0IHQuaW5pdGlhbGl6ZShuLCBlLmNvbmZpZ3VyYXRpb24pLCBcbiAgICAvLyBUaGUgQ3JlZGVudGlhbENoYW5nZUxpc3RlbmVyIG9mIHRoZSBvbmxpbmUgY29tcG9uZW50IHByb3ZpZGVyIHRha2VzXG4gICAgLy8gcHJlY2VkZW5jZSBvdmVyIHRoZSBvZmZsaW5lIGNvbXBvbmVudCBwcm92aWRlci5cbiAgICBlLnNldENyZWRlbnRpYWxDaGFuZ2VMaXN0ZW5lcigoZSA9PiBfX1BSSVZBVEVfcmVtb3RlU3RvcmVIYW5kbGVDcmVkZW50aWFsQ2hhbmdlKHQucmVtb3RlU3RvcmUsIGUpKSksIFxuICAgIGUuc2V0QXBwQ2hlY2tUb2tlbkNoYW5nZUxpc3RlbmVyKCgoZSwgbikgPT4gX19QUklWQVRFX3JlbW90ZVN0b3JlSGFuZGxlQ3JlZGVudGlhbENoYW5nZSh0LnJlbW90ZVN0b3JlLCBuKSkpLCBcbiAgICBlLl9vbmxpbmVDb21wb25lbnRzID0gdDtcbn1cblxuLyoqXG4gKiBEZWNpZGVzIHdoZXRoZXIgdGhlIHByb3ZpZGVkIGVycm9yIGFsbG93cyB1cyB0byBncmFjZWZ1bGx5IGRpc2FibGVcbiAqIHBlcnNpc3RlbmNlIChhcyBvcHBvc2VkIHRvIGNyYXNoaW5nIHRoZSBjbGllbnQpLlxuICovIGFzeW5jIGZ1bmN0aW9uIF9fUFJJVkFURV9lbnN1cmVPZmZsaW5lQ29tcG9uZW50cyhlKSB7XG4gICAgaWYgKCFlLl9vZmZsaW5lQ29tcG9uZW50cykgaWYgKGUuX3VuaW5pdGlhbGl6ZWRDb21wb25lbnRzUHJvdmlkZXIpIHtcbiAgICAgICAgX19QUklWQVRFX2xvZ0RlYnVnKG9uLCBcIlVzaW5nIHVzZXIgcHJvdmlkZWQgT2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyXCIpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgX19QUklWQVRFX3NldE9mZmxpbmVDb21wb25lbnRQcm92aWRlcihlLCBlLl91bmluaXRpYWxpemVkQ29tcG9uZW50c1Byb3ZpZGVyLl9vZmZsaW5lKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQ7XG4gICAgICAgICAgICBpZiAoIWZ1bmN0aW9uIF9fUFJJVkFURV9jYW5GYWxsYmFja0Zyb21JbmRleGVkRGJFcnJvcihlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiRmlyZWJhc2VFcnJvclwiID09PSBlLm5hbWUgPyBlLmNvZGUgPT09IE4uRkFJTEVEX1BSRUNPTkRJVElPTiB8fCBlLmNvZGUgPT09IE4uVU5JTVBMRU1FTlRFRCA6ICEoXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgRE9NRXhjZXB0aW9uICYmIGUgaW5zdGFuY2VvZiBET01FeGNlcHRpb24pIHx8IFxuICAgICAgICAgICAgICAgIC8vIFdoZW4gdGhlIGJyb3dzZXIgaXMgb3V0IG9mIHF1b3RhIHdlIGNvdWxkIGdldCBlaXRoZXIgcXVvdGEgZXhjZWVkZWRcbiAgICAgICAgICAgICAgICAvLyBvciBhbiBhYm9ydGVkIGVycm9yIGRlcGVuZGluZyBvbiB3aGV0aGVyIHRoZSBlcnJvciBoYXBwZW5lZCBkdXJpbmdcbiAgICAgICAgICAgICAgICAvLyBzY2hlbWEgbWlncmF0aW9uLlxuICAgICAgICAgICAgICAgIDIyID09PSBlLmNvZGUgfHwgMjAgPT09IGUuY29kZSB8fCBcbiAgICAgICAgICAgICAgICAvLyBGaXJlZm94IFByaXZhdGUgQnJvd3NpbmcgbW9kZSBkaXNhYmxlcyBJbmRleGVkRGIgYW5kIHJldHVybnNcbiAgICAgICAgICAgICAgICAvLyBJTlZBTElEX1NUQVRFIGZvciBhbnkgdXNhZ2UuXG4gICAgICAgICAgICAgICAgMTEgPT09IGUuY29kZTtcbiAgICAgICAgICAgIH0obikpIHRocm93IG47XG4gICAgICAgICAgICBfX1BSSVZBVEVfbG9nV2FybihcIkVycm9yIHVzaW5nIHVzZXIgcHJvdmlkZWQgY2FjaGUuIEZhbGxpbmcgYmFjayB0byBtZW1vcnkgY2FjaGU6IFwiICsgbiksIFxuICAgICAgICAgICAgYXdhaXQgX19QUklWQVRFX3NldE9mZmxpbmVDb21wb25lbnRQcm92aWRlcihlLCBuZXcgX19QUklWQVRFX01lbW9yeU9mZmxpbmVDb21wb25lbnRQcm92aWRlcik7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgX19QUklWQVRFX2xvZ0RlYnVnKG9uLCBcIlVzaW5nIGRlZmF1bHQgT2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyXCIpLCBhd2FpdCBfX1BSSVZBVEVfc2V0T2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyKGUsIG5ldyBfX1BSSVZBVEVfTHJ1R2NNZW1vcnlPZmZsaW5lQ29tcG9uZW50UHJvdmlkZXIodm9pZCAwKSk7XG4gICAgcmV0dXJuIGUuX29mZmxpbmVDb21wb25lbnRzO1xufVxuXG5hc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfZW5zdXJlT25saW5lQ29tcG9uZW50cyhlKSB7XG4gICAgcmV0dXJuIGUuX29ubGluZUNvbXBvbmVudHMgfHwgKGUuX3VuaW5pdGlhbGl6ZWRDb21wb25lbnRzUHJvdmlkZXIgPyAoX19QUklWQVRFX2xvZ0RlYnVnKG9uLCBcIlVzaW5nIHVzZXIgcHJvdmlkZWQgT25saW5lQ29tcG9uZW50UHJvdmlkZXJcIiksIFxuICAgIGF3YWl0IF9fUFJJVkFURV9zZXRPbmxpbmVDb21wb25lbnRQcm92aWRlcihlLCBlLl91bmluaXRpYWxpemVkQ29tcG9uZW50c1Byb3ZpZGVyLl9vbmxpbmUpKSA6IChfX1BSSVZBVEVfbG9nRGVidWcob24sIFwiVXNpbmcgZGVmYXVsdCBPbmxpbmVDb21wb25lbnRQcm92aWRlclwiKSwgXG4gICAgYXdhaXQgX19QUklWQVRFX3NldE9ubGluZUNvbXBvbmVudFByb3ZpZGVyKGUsIG5ldyBPbmxpbmVDb21wb25lbnRQcm92aWRlcikpKSwgZS5fb25saW5lQ29tcG9uZW50cztcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2dldFBlcnNpc3RlbmNlKGUpIHtcbiAgICByZXR1cm4gX19QUklWQVRFX2Vuc3VyZU9mZmxpbmVDb21wb25lbnRzKGUpLnRoZW4oKGUgPT4gZS5wZXJzaXN0ZW5jZSkpO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfZ2V0TG9jYWxTdG9yZShlKSB7XG4gICAgcmV0dXJuIF9fUFJJVkFURV9lbnN1cmVPZmZsaW5lQ29tcG9uZW50cyhlKS50aGVuKChlID0+IGUubG9jYWxTdG9yZSkpO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfZ2V0UmVtb3RlU3RvcmUoZSkge1xuICAgIHJldHVybiBfX1BSSVZBVEVfZW5zdXJlT25saW5lQ29tcG9uZW50cyhlKS50aGVuKChlID0+IGUucmVtb3RlU3RvcmUpKTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2dldFN5bmNFbmdpbmUoZSkge1xuICAgIHJldHVybiBfX1BSSVZBVEVfZW5zdXJlT25saW5lQ29tcG9uZW50cyhlKS50aGVuKChlID0+IGUuc3luY0VuZ2luZSkpO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfZ2V0RGF0YXN0b3JlKGUpIHtcbiAgICByZXR1cm4gX19QUklWQVRFX2Vuc3VyZU9ubGluZUNvbXBvbmVudHMoZSkudGhlbigoZSA9PiBlLmRhdGFzdG9yZSkpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfZ2V0RXZlbnRNYW5hZ2VyKGUpIHtcbiAgICBjb25zdCB0ID0gYXdhaXQgX19QUklWQVRFX2Vuc3VyZU9ubGluZUNvbXBvbmVudHMoZSksIG4gPSB0LmV2ZW50TWFuYWdlcjtcbiAgICByZXR1cm4gbi5vbkxpc3RlbiA9IF9fUFJJVkFURV9zeW5jRW5naW5lTGlzdGVuLmJpbmQobnVsbCwgdC5zeW5jRW5naW5lKSwgbi5vblVubGlzdGVuID0gX19QUklWQVRFX3N5bmNFbmdpbmVVbmxpc3Rlbi5iaW5kKG51bGwsIHQuc3luY0VuZ2luZSksIFxuICAgIG4ub25GaXJzdFJlbW90ZVN0b3JlTGlzdGVuID0gX19QUklWQVRFX3RyaWdnZXJSZW1vdGVTdG9yZUxpc3Rlbi5iaW5kKG51bGwsIHQuc3luY0VuZ2luZSksIFxuICAgIG4ub25MYXN0UmVtb3RlU3RvcmVVbmxpc3RlbiA9IF9fUFJJVkFURV90cmlnZ2VyUmVtb3RlU3RvcmVVbmxpc3Rlbi5iaW5kKG51bGwsIHQuc3luY0VuZ2luZSksIFxuICAgIG47XG59XG5cbi8qKiBFbmFibGVzIHRoZSBuZXR3b3JrIGNvbm5lY3Rpb24gYW5kIHJlLWVucXVldWVzIGFsbCBwZW5kaW5nIG9wZXJhdGlvbnMuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9maXJlc3RvcmVDbGllbnRFbmFibGVOZXR3b3JrKGUpIHtcbiAgICByZXR1cm4gZS5hc3luY1F1ZXVlLmVucXVldWUoKGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgdCA9IGF3YWl0IF9fUFJJVkFURV9nZXRQZXJzaXN0ZW5jZShlKSwgbiA9IGF3YWl0IF9fUFJJVkFURV9nZXRSZW1vdGVTdG9yZShlKTtcbiAgICAgICAgcmV0dXJuIHQuc2V0TmV0d29ya0VuYWJsZWQoITApLCBmdW5jdGlvbiBfX1BSSVZBVEVfcmVtb3RlU3RvcmVFbmFibGVOZXR3b3JrKGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpO1xuICAgICAgICAgICAgcmV0dXJuIHQuRWEuZGVsZXRlKDAgLyogT2ZmbGluZUNhdXNlLlVzZXJEaXNhYmxlZCAqLyksIF9fUFJJVkFURV9lbmFibGVOZXR3b3JrSW50ZXJuYWwodCk7XG4gICAgICAgIH0obik7XG4gICAgfSkpO1xufVxuXG4vKiogRGlzYWJsZXMgdGhlIG5ldHdvcmsgY29ubmVjdGlvbi4gUGVuZGluZyBvcGVyYXRpb25zIHdpbGwgbm90IGNvbXBsZXRlLiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfZmlyZXN0b3JlQ2xpZW50RGlzYWJsZU5ldHdvcmsoZSkge1xuICAgIHJldHVybiBlLmFzeW5jUXVldWUuZW5xdWV1ZSgoYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgX19QUklWQVRFX2dldFBlcnNpc3RlbmNlKGUpLCBuID0gYXdhaXQgX19QUklWQVRFX2dldFJlbW90ZVN0b3JlKGUpO1xuICAgICAgICByZXR1cm4gdC5zZXROZXR3b3JrRW5hYmxlZCghMSksIGFzeW5jIGZ1bmN0aW9uIF9fUFJJVkFURV9yZW1vdGVTdG9yZURpc2FibGVOZXR3b3JrKGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpO1xuICAgICAgICAgICAgdC5FYS5hZGQoMCAvKiBPZmZsaW5lQ2F1c2UuVXNlckRpc2FibGVkICovKSwgYXdhaXQgX19QUklWQVRFX2Rpc2FibGVOZXR3b3JrSW50ZXJuYWwodCksIFxuICAgICAgICAgICAgLy8gU2V0IHRoZSBPbmxpbmVTdGF0ZSB0byBPZmZsaW5lIHNvIGdldCgpcyByZXR1cm4gZnJvbSBjYWNoZSwgZXRjLlxuICAgICAgICAgICAgdC5SYS5zZXQoXCJPZmZsaW5lXCIgLyogT25saW5lU3RhdGUuT2ZmbGluZSAqLyk7XG4gICAgICAgIH0obik7XG4gICAgfSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2hlbiBhbGwgd3JpdGVzIHRoYXQgd2VyZSBwZW5kaW5nIGF0IHRoZSB0aW1lXG4gKiB0aGlzIG1ldGhvZCB3YXMgY2FsbGVkIHJlY2VpdmVkIHNlcnZlciBhY2tub3dsZWRnZW1lbnQuIEFuIGFja25vd2xlZGdlbWVudFxuICogY2FuIGJlIGVpdGhlciBhY2NlcHRhbmNlIG9yIHJlamVjdGlvbi5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfZmlyZXN0b3JlQ2xpZW50R2V0RG9jdW1lbnRGcm9tTG9jYWxDYWNoZShlLCB0KSB7XG4gICAgY29uc3QgbiA9IG5ldyBfX1BSSVZBVEVfRGVmZXJyZWQ7XG4gICAgcmV0dXJuIGUuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBhc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfcmVhZERvY3VtZW50RnJvbUNhY2hlKGUsIHQsIG4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBhd2FpdCBmdW5jdGlvbiBfX1BSSVZBVEVfbG9jYWxTdG9yZVJlYWREb2N1bWVudChlLCB0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJyZWFkIGRvY3VtZW50XCIsIFwicmVhZG9ubHlcIiwgKGUgPT4gbi5sb2NhbERvY3VtZW50cy5nZXREb2N1bWVudChlLCB0KSkpO1xuICAgICAgICAgICAgfShlLCB0KTtcbiAgICAgICAgICAgIHIuaXNGb3VuZERvY3VtZW50KCkgPyBuLnJlc29sdmUocikgOiByLmlzTm9Eb2N1bWVudCgpID8gbi5yZXNvbHZlKG51bGwpIDogbi5yZWplY3QobmV3IEZpcmVzdG9yZUVycm9yKE4uVU5BVkFJTEFCTEUsIFwiRmFpbGVkIHRvIGdldCBkb2N1bWVudCBmcm9tIGNhY2hlLiAoSG93ZXZlciwgdGhpcyBkb2N1bWVudCBtYXkgZXhpc3Qgb24gdGhlIHNlcnZlci4gUnVuIGFnYWluIHdpdGhvdXQgc2V0dGluZyAnc291cmNlJyBpbiB0aGUgR2V0T3B0aW9ucyB0byBhdHRlbXB0IHRvIHJldHJpZXZlIHRoZSBkb2N1bWVudCBmcm9tIHRoZSBzZXJ2ZXIuKVwiKSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfd3JhcEluVXNlckVycm9ySWZSZWNvdmVyYWJsZShlLCBgRmFpbGVkIHRvIGdldCBkb2N1bWVudCAnJHt0fSBmcm9tIGNhY2hlYCk7XG4gICAgICAgICAgICBuLnJlamVjdChyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAqIFJldHJpZXZlcyBhIGxhdGVuY3ktY29tcGVuc2F0ZWQgZG9jdW1lbnQgZnJvbSB0aGUgYmFja2VuZCB2aWEgYVxuICogU25hcHNob3RMaXN0ZW5lci5cbiAqLyAoYXdhaXQgX19QUklWQVRFX2dldExvY2FsU3RvcmUoZSksIHQsIG4pKSksIG4ucHJvbWlzZTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2ZpcmVzdG9yZUNsaWVudEdldERvY3VtZW50VmlhU25hcHNob3RMaXN0ZW5lcihlLCB0LCBuID0ge30pIHtcbiAgICBjb25zdCByID0gbmV3IF9fUFJJVkFURV9EZWZlcnJlZDtcbiAgICByZXR1cm4gZS5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGZ1bmN0aW9uIF9fUFJJVkFURV9yZWFkRG9jdW1lbnRWaWFTbmFwc2hvdExpc3RlbmVyKGUsIHQsIG4sIHIsIGkpIHtcbiAgICAgICAgY29uc3QgcyA9IG5ldyBfX1BSSVZBVEVfQXN5bmNPYnNlcnZlcih7XG4gICAgICAgICAgICBuZXh0OiBfID0+IHtcbiAgICAgICAgICAgICAgICAvLyBNdXRlIGFuZCByZW1vdmUgcXVlcnkgZmlyc3QgYmVmb3JlIHBhc3NpbmcgZXZlbnQgdG8gdXNlciB0byBhdm9pZFxuICAgICAgICAgICAgICAgIC8vIHVzZXIgYWN0aW9ucyBhZmZlY3RpbmcgdGhlIG5vdyBzdGFsZSBxdWVyeS5cbiAgICAgICAgICAgICAgICBzLk51KCksIHQuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gX19QUklWQVRFX2V2ZW50TWFuYWdlclVubGlzdGVuKGUsIG8pKSk7XG4gICAgICAgICAgICAgICAgY29uc3QgYSA9IF8uZG9jcy5oYXMobik7XG4gICAgICAgICAgICAgICAgIWEgJiYgXy5mcm9tQ2FjaGUgPyBcbiAgICAgICAgICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IElmIHdlJ3JlIG9ubGluZSBhbmQgdGhlIGRvY3VtZW50IGRvZXNuJ3RcbiAgICAgICAgICAgICAgICAvLyBleGlzdCB0aGVuIHdlIHJlc29sdmUgd2l0aCBhIGRvYy5leGlzdHMgc2V0IHRvIGZhbHNlLiBJZlxuICAgICAgICAgICAgICAgIC8vIHdlJ3JlIG9mZmxpbmUgaG93ZXZlciwgd2UgcmVqZWN0IHRoZSBQcm9taXNlIGluIHRoaXNcbiAgICAgICAgICAgICAgICAvLyBjYXNlLiBUd28gb3B0aW9uczogMSkgQ2FjaGUgdGhlIG5lZ2F0aXZlIHJlc3BvbnNlIGZyb21cbiAgICAgICAgICAgICAgICAvLyB0aGUgc2VydmVyIHNvIHdlIGNhbiBkZWxpdmVyIHRoYXQgZXZlbiB3aGVuIHlvdSdyZVxuICAgICAgICAgICAgICAgIC8vIG9mZmxpbmUgMikgQWN0dWFsbHkgcmVqZWN0IHRoZSBQcm9taXNlIGluIHRoZSBvbmxpbmUgY2FzZVxuICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBkb2N1bWVudCBkb2Vzbid0IGV4aXN0LlxuICAgICAgICAgICAgICAgIGkucmVqZWN0KG5ldyBGaXJlc3RvcmVFcnJvcihOLlVOQVZBSUxBQkxFLCBcIkZhaWxlZCB0byBnZXQgZG9jdW1lbnQgYmVjYXVzZSB0aGUgY2xpZW50IGlzIG9mZmxpbmUuXCIpKSA6IGEgJiYgXy5mcm9tQ2FjaGUgJiYgciAmJiBcInNlcnZlclwiID09PSByLnNvdXJjZSA/IGkucmVqZWN0KG5ldyBGaXJlc3RvcmVFcnJvcihOLlVOQVZBSUxBQkxFLCAnRmFpbGVkIHRvIGdldCBkb2N1bWVudCBmcm9tIHNlcnZlci4gKEhvd2V2ZXIsIHRoaXMgZG9jdW1lbnQgZG9lcyBleGlzdCBpbiB0aGUgbG9jYWwgY2FjaGUuIFJ1biBhZ2FpbiB3aXRob3V0IHNldHRpbmcgc291cmNlIHRvIFwic2VydmVyXCIgdG8gcmV0cmlldmUgdGhlIGNhY2hlZCBkb2N1bWVudC4pJykpIDogaS5yZXNvbHZlKF8pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBlID0+IGkucmVqZWN0KGUpXG4gICAgICAgIH0pLCBvID0gbmV3IF9fUFJJVkFURV9RdWVyeUxpc3RlbmVyKF9fUFJJVkFURV9uZXdRdWVyeUZvclBhdGgobi5wYXRoKSwgcywge1xuICAgICAgICAgICAgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlczogITAsXG4gICAgICAgICAgICBxYTogITBcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfZXZlbnRNYW5hZ2VyTGlzdGVuKGUsIG8pO1xuICAgIH0oYXdhaXQgX19QUklWQVRFX2dldEV2ZW50TWFuYWdlcihlKSwgZS5hc3luY1F1ZXVlLCB0LCBuLCByKSkpLCByLnByb21pc2U7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9maXJlc3RvcmVDbGllbnRHZXREb2N1bWVudHNGcm9tTG9jYWxDYWNoZShlLCB0KSB7XG4gICAgY29uc3QgbiA9IG5ldyBfX1BSSVZBVEVfRGVmZXJyZWQ7XG4gICAgcmV0dXJuIGUuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBhc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfZXhlY3V0ZVF1ZXJ5RnJvbUNhY2hlKGUsIHQsIG4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBhd2FpdCBfX1BSSVZBVEVfbG9jYWxTdG9yZUV4ZWN1dGVRdWVyeShlLCB0LCBcbiAgICAgICAgICAgIC8qIHVzZVByZXZpb3VzUmVzdWx0cz0gKi8gITApLCBpID0gbmV3IF9fUFJJVkFURV9WaWV3KHQsIHIuUXMpLCBzID0gaS5ydShyLmRvY3VtZW50cyksIG8gPSBpLmFwcGx5Q2hhbmdlcyhzLCBcbiAgICAgICAgICAgIC8qIGxpbWJvUmVzb2x1dGlvbkVuYWJsZWQ9ICovICExKTtcbiAgICAgICAgICAgIG4ucmVzb2x2ZShvLnNuYXBzaG90KTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc3QgciA9IF9fUFJJVkFURV93cmFwSW5Vc2VyRXJyb3JJZlJlY292ZXJhYmxlKGUsIGBGYWlsZWQgdG8gZXhlY3V0ZSBxdWVyeSAnJHt0fSBhZ2FpbnN0IGNhY2hlYCk7XG4gICAgICAgICAgICBuLnJlamVjdChyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAqIFJldHJpZXZlcyBhIGxhdGVuY3ktY29tcGVuc2F0ZWQgcXVlcnkgc25hcHNob3QgZnJvbSB0aGUgYmFja2VuZCB2aWEgYVxuICogU25hcHNob3RMaXN0ZW5lci5cbiAqLyAoYXdhaXQgX19QUklWQVRFX2dldExvY2FsU3RvcmUoZSksIHQsIG4pKSksIG4ucHJvbWlzZTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2ZpcmVzdG9yZUNsaWVudEdldERvY3VtZW50c1ZpYVNuYXBzaG90TGlzdGVuZXIoZSwgdCwgbiA9IHt9KSB7XG4gICAgY29uc3QgciA9IG5ldyBfX1BSSVZBVEVfRGVmZXJyZWQ7XG4gICAgcmV0dXJuIGUuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBmdW5jdGlvbiBfX1BSSVZBVEVfZXhlY3V0ZVF1ZXJ5VmlhU25hcHNob3RMaXN0ZW5lcihlLCB0LCBuLCByLCBpKSB7XG4gICAgICAgIGNvbnN0IHMgPSBuZXcgX19QUklWQVRFX0FzeW5jT2JzZXJ2ZXIoe1xuICAgICAgICAgICAgbmV4dDogbiA9PiB7XG4gICAgICAgICAgICAgICAgLy8gTXV0ZSBhbmQgcmVtb3ZlIHF1ZXJ5IGZpcnN0IGJlZm9yZSBwYXNzaW5nIGV2ZW50IHRvIHVzZXIgdG8gYXZvaWRcbiAgICAgICAgICAgICAgICAvLyB1c2VyIGFjdGlvbnMgYWZmZWN0aW5nIHRoZSBub3cgc3RhbGUgcXVlcnkuXG4gICAgICAgICAgICAgICAgcy5OdSgpLCB0LmVucXVldWVBbmRGb3JnZXQoKCgpID0+IF9fUFJJVkFURV9ldmVudE1hbmFnZXJVbmxpc3RlbihlLCBvKSkpLCBuLmZyb21DYWNoZSAmJiBcInNlcnZlclwiID09PSByLnNvdXJjZSA/IGkucmVqZWN0KG5ldyBGaXJlc3RvcmVFcnJvcihOLlVOQVZBSUxBQkxFLCAnRmFpbGVkIHRvIGdldCBkb2N1bWVudHMgZnJvbSBzZXJ2ZXIuIChIb3dldmVyLCB0aGVzZSBkb2N1bWVudHMgbWF5IGV4aXN0IGluIHRoZSBsb2NhbCBjYWNoZS4gUnVuIGFnYWluIHdpdGhvdXQgc2V0dGluZyBzb3VyY2UgdG8gXCJzZXJ2ZXJcIiB0byByZXRyaWV2ZSB0aGUgY2FjaGVkIGRvY3VtZW50cy4pJykpIDogaS5yZXNvbHZlKG4pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBlID0+IGkucmVqZWN0KGUpXG4gICAgICAgIH0pLCBvID0gbmV3IF9fUFJJVkFURV9RdWVyeUxpc3RlbmVyKG4sIHMsIHtcbiAgICAgICAgICAgIGluY2x1ZGVNZXRhZGF0YUNoYW5nZXM6ICEwLFxuICAgICAgICAgICAgcWE6ICEwXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX2V2ZW50TWFuYWdlckxpc3RlbihlLCBvKTtcbiAgICB9KGF3YWl0IF9fUFJJVkFURV9nZXRFdmVudE1hbmFnZXIoZSksIGUuYXN5bmNRdWV1ZSwgdCwgbiwgcikpKSwgci5wcm9taXNlO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfZmlyZXN0b3JlQ2xpZW50UnVuQWdncmVnYXRlUXVlcnkoZSwgdCwgbikge1xuICAgIGNvbnN0IHIgPSBuZXcgX19QUklWQVRFX0RlZmVycmVkO1xuICAgIHJldHVybiBlLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4ge1xuICAgICAgICAvLyBJbXBsZW1lbnQgYW5kIGNhbGwgZXhlY3V0ZUFnZ3JlZ2F0ZVF1ZXJ5VmlhU25hcHNob3RMaXN0ZW5lciwgc2ltaWxhclxuICAgICAgICAvLyB0byB0aGUgaW1wbGVtZW50YXRpb24gaW4gZmlyZXN0b3JlQ2xpZW50R2V0RG9jdW1lbnRzVmlhU25hcHNob3RMaXN0ZW5lclxuICAgICAgICAvLyBhYm92ZVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gVE9ETyhiLzI3NzYyODM4NCk6IGNoZWNrIGBjYW5Vc2VOZXR3b3JrKClgIGFuZCBoYW5kbGUgbXVsdGktdGFiLlxuICAgICAgICAgICAgY29uc3QgaSA9IGF3YWl0IF9fUFJJVkFURV9nZXREYXRhc3RvcmUoZSk7XG4gICAgICAgICAgICByLnJlc29sdmUoYXN5bmMgZnVuY3Rpb24gX19QUklWQVRFX2ludm9rZVJ1bkFnZ3JlZ2F0aW9uUXVlcnlScGMoZSwgdCwgbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfZGVidWdDYXN0KGUpLCB7cmVxdWVzdDogaSwgZ3Q6IHMsIHBhcmVudDogb30gPSBfX1BSSVZBVEVfdG9SdW5BZ2dyZWdhdGlvblF1ZXJ5UmVxdWVzdChyLnNlcmlhbGl6ZXIsIF9fUFJJVkFURV9xdWVyeVRvQWdncmVnYXRlVGFyZ2V0KHQpLCBuKTtcbiAgICAgICAgICAgICAgICByLmNvbm5lY3Rpb24uJG8gfHwgZGVsZXRlIGkucGFyZW50O1xuICAgICAgICAgICAgICAgIGNvbnN0IF8gPSAoYXdhaXQgci5IbyhcIlJ1bkFnZ3JlZ2F0aW9uUXVlcnlcIiwgci5zZXJpYWxpemVyLmRhdGFiYXNlSWQsIG8sIGksIFxuICAgICAgICAgICAgICAgIC8qZXhwZWN0ZWRSZXNwb25zZUNvdW50PSovIDEpKS5maWx0ZXIoKGUgPT4gISFlLnJlc3VsdCkpO1xuICAgICAgICAgICAgICAgIC8vIE9taXQgUnVuQWdncmVnYXRpb25RdWVyeVJlc3BvbnNlIHRoYXQgb25seSBjb250YWluIHJlYWRUaW1lcy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QUklWQVRFX2hhcmRBc3NlcnQoMSA9PT0gXy5sZW5ndGgsIDY0NzI3KTtcbiAgICAgICAgICAgICAgICAvLyBSZW1hcCB0aGUgc2hvcnQtZm9ybSBhbGlhc2VzIHRoYXQgd2VyZSBzZW50IHRvIHRoZSBzZXJ2ZXJcbiAgICAgICAgICAgICAgICAvLyB0byB0aGUgY2xpZW50LXNpZGUgYWxpYXNlcy4gVXNlcnMgd2lsbCBhY2Nlc3MgdGhlIHJlc3VsdHNcbiAgICAgICAgICAgICAgICAvLyB1c2luZyB0aGUgY2xpZW50LXNpZGUgYWxpYXMuXG4gICAgICAgICAgICAgICAgY29uc3QgYSA9IF9bMF0ucmVzdWx0Py5hZ2dyZWdhdGVGaWVsZHM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKGEpLnJlZHVjZSgoKGUsIHQpID0+IChlW3NbdF1dID0gYVt0XSwgZSkpLCB7fSk7XG4gICAgICAgICAgICB9KGksIHQsIG4pKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgci5yZWplY3QoZSk7XG4gICAgICAgIH1cbiAgICB9KSksIHIucHJvbWlzZTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2ZpcmVzdG9yZUNsaWVudEFkZFNuYXBzaG90c0luU3luY0xpc3RlbmVyKGUsIHQpIHtcbiAgICBjb25zdCBuID0gbmV3IF9fUFJJVkFURV9Bc3luY09ic2VydmVyKHQpO1xuICAgIHJldHVybiBlLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4gZnVuY3Rpb24gX19QUklWQVRFX2FkZFNuYXBzaG90c0luU3luY0xpc3RlbmVyKGUsIHQpIHtcbiAgICAgICAgX19QUklWQVRFX2RlYnVnQ2FzdChlKS5DYS5hZGQodCksIFxuICAgICAgICAvLyBJbW1lZGlhdGVseSBmaXJlIGFuIGluaXRpYWwgZXZlbnQsIGluZGljYXRpbmcgYWxsIGV4aXN0aW5nIGxpc3RlbmVyc1xuICAgICAgICAvLyBhcmUgaW4tc3luYy5cbiAgICAgICAgdC5uZXh0KCk7XG4gICAgfShhd2FpdCBfX1BSSVZBVEVfZ2V0RXZlbnRNYW5hZ2VyKGUpLCBuKSkpLCAoKSA9PiB7XG4gICAgICAgIG4uTnUoKSwgZS5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGZ1bmN0aW9uIF9fUFJJVkFURV9yZW1vdmVTbmFwc2hvdHNJblN5bmNMaXN0ZW5lcihlLCB0KSB7XG4gICAgICAgICAgICBfX1BSSVZBVEVfZGVidWdDYXN0KGUpLkNhLmRlbGV0ZSh0KTtcbiAgICAgICAgfShhd2FpdCBfX1BSSVZBVEVfZ2V0RXZlbnRNYW5hZ2VyKGUpLCBuKSkpO1xuICAgIH07XG59XG5cbi8qKlxuICogVGFrZXMgYW4gdXBkYXRlRnVuY3Rpb24gaW4gd2hpY2ggYSBzZXQgb2YgcmVhZHMgYW5kIHdyaXRlcyBjYW4gYmUgcGVyZm9ybWVkXG4gKiBhdG9taWNhbGx5LiBJbiB0aGUgdXBkYXRlRnVuY3Rpb24sIHRoZSBjbGllbnQgY2FuIHJlYWQgYW5kIHdyaXRlIHZhbHVlc1xuICogdXNpbmcgdGhlIHN1cHBsaWVkIHRyYW5zYWN0aW9uIG9iamVjdC4gQWZ0ZXIgdGhlIHVwZGF0ZUZ1bmN0aW9uLCBhbGxcbiAqIGNoYW5nZXMgd2lsbCBiZSBjb21taXR0ZWQuIElmIGEgcmV0cnlhYmxlIGVycm9yIG9jY3VycyAoZXg6IHNvbWUgb3RoZXJcbiAqIGNsaWVudCBoYXMgY2hhbmdlZCBhbnkgb2YgdGhlIGRhdGEgcmVmZXJlbmNlZCksIHRoZW4gdGhlIHVwZGF0ZUZ1bmN0aW9uXG4gKiB3aWxsIGJlIGNhbGxlZCBhZ2FpbiBhZnRlciBhIGJhY2tvZmYuIElmIHRoZSB1cGRhdGVGdW5jdGlvbiBzdGlsbCBmYWlsc1xuICogYWZ0ZXIgYWxsIHJldHJpZXMsIHRoZW4gdGhlIHRyYW5zYWN0aW9uIHdpbGwgYmUgcmVqZWN0ZWQuXG4gKlxuICogVGhlIHRyYW5zYWN0aW9uIG9iamVjdCBwYXNzZWQgdG8gdGhlIHVwZGF0ZUZ1bmN0aW9uIGNvbnRhaW5zIG1ldGhvZHMgZm9yXG4gKiBhY2Nlc3NpbmcgZG9jdW1lbnRzIGFuZCBjb2xsZWN0aW9ucy4gVW5saWtlIG90aGVyIGRhdGFzdG9yZSBhY2Nlc3MsIGRhdGFcbiAqIGFjY2Vzc2VkIHdpdGggdGhlIHRyYW5zYWN0aW9uIHdpbGwgbm90IHJlZmxlY3QgbG9jYWwgY2hhbmdlcyB0aGF0IGhhdmUgbm90XG4gKiBiZWVuIGNvbW1pdHRlZC4gRm9yIHRoaXMgcmVhc29uLCBpdCBpcyByZXF1aXJlZCB0aGF0IGFsbCByZWFkcyBhcmVcbiAqIHBlcmZvcm1lZCBiZWZvcmUgYW55IHdyaXRlcy4gVHJhbnNhY3Rpb25zIG11c3QgYmUgcGVyZm9ybWVkIHdoaWxlIG9ubGluZS5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfZmlyZXN0b3JlQ2xpZW50TG9hZEJ1bmRsZShlLCB0LCBuLCByKSB7XG4gICAgY29uc3QgaSA9IGZ1bmN0aW9uIF9fUFJJVkFURV9jcmVhdGVCdW5kbGVSZWFkZXIoZSwgdCkge1xuICAgICAgICBsZXQgbjtcbiAgICAgICAgbiA9IFwic3RyaW5nXCIgPT0gdHlwZW9mIGUgPyBfX1BSSVZBVEVfbmV3VGV4dEVuY29kZXIoKS5lbmNvZGUoZSkgOiBlO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX25ld0J1bmRsZVJlYWRlcihlLCB0KSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9CdW5kbGVSZWFkZXJJbXBsKGUsIHQpO1xuICAgICAgICB9KGZ1bmN0aW9uIF9fUFJJVkFURV90b0J5dGVTdHJlYW1SZWFkZXIoZSwgdCkge1xuICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBVaW50OEFycmF5KSByZXR1cm4gX19QUklWQVRFX3RvQnl0ZVN0cmVhbVJlYWRlckhlbHBlcihlLCB0KTtcbiAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHJldHVybiBfX1BSSVZBVEVfdG9CeXRlU3RyZWFtUmVhZGVySGVscGVyKG5ldyBVaW50OEFycmF5KGUpLCB0KTtcbiAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgUmVhZGFibGVTdHJlYW0pIHJldHVybiBlLmdldFJlYWRlcigpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU291cmNlIG9mIGB0b0J5dGVTdHJlYW1SZWFkZXJgIGhhcyB0byBiZSBhIEFycmF5QnVmZmVyIG9yIFJlYWRhYmxlU3RyZWFtXCIpO1xuICAgICAgICB9KG4pLCB0KTtcbiAgICB9KG4sIF9fUFJJVkFURV9uZXdTZXJpYWxpemVyKHQpKTtcbiAgICBlLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4ge1xuICAgICAgICBfX1BSSVZBVEVfc3luY0VuZ2luZUxvYWRCdW5kbGUoYXdhaXQgX19QUklWQVRFX2dldFN5bmNFbmdpbmUoZSksIGksIHIpO1xuICAgIH0pKTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2ZpcmVzdG9yZUNsaWVudEdldE5hbWVkUXVlcnkoZSwgdCkge1xuICAgIHJldHVybiBlLmFzeW5jUXVldWUuZW5xdWV1ZSgoYXN5bmMgKCkgPT4gZnVuY3Rpb24gX19QUklWQVRFX2xvY2FsU3RvcmVHZXROYW1lZFF1ZXJ5KGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSk7XG4gICAgICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiR2V0IG5hbWVkIHF1ZXJ5XCIsIFwicmVhZG9ubHlcIiwgKGUgPT4gbi5JaS5nZXROYW1lZFF1ZXJ5KGUsIHQpKSk7XG4gICAgfShhd2FpdCBfX1BSSVZBVEVfZ2V0TG9jYWxTdG9yZShlKSwgdCkpKTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2NyZWF0ZUJ1bmRsZVJlYWRlclN5bmMoZSwgdCkge1xuICAgIHJldHVybiBmdW5jdGlvbiBfX1BSSVZBVEVfbmV3QnVuZGxlUmVhZGVyU3luYyhlLCB0KSB7XG4gICAgICAgIHJldHVybiBuZXcgX19QUklWQVRFX0J1bmRsZVJlYWRlclN5bmNJbXBsKGUsIHQpO1xuICAgIH0oZSwgdCk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9maXJlc3RvcmVDbGllbnRTZXRJbmRleENvbmZpZ3VyYXRpb24oZSwgdCkge1xuICAgIHJldHVybiBlLmFzeW5jUXVldWUuZW5xdWV1ZSgoYXN5bmMgKCkgPT4gYXN5bmMgZnVuY3Rpb24gX19QUklWQVRFX2xvY2FsU3RvcmVDb25maWd1cmVGaWVsZEluZGV4ZXMoZSwgdCkge1xuICAgICAgICBjb25zdCBuID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKSwgciA9IG4uaW5kZXhNYW5hZ2VyLCBpID0gW107XG4gICAgICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiQ29uZmlndXJlIGluZGV4ZXNcIiwgXCJyZWFkd3JpdGVcIiwgKGUgPT4gci5nZXRGaWVsZEluZGV4ZXMoZSkubmV4dCgobiA9PiBcbiAgICAgICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbiAgICAgICAgLyoqXG4gKiBDb21wYXJlcyB0d28gYXJyYXkgZm9yIGVxdWFsaXR5IHVzaW5nIGNvbXBhcmF0b3IuIFRoZSBtZXRob2QgY29tcHV0ZXMgdGhlXG4gKiBpbnRlcnNlY3Rpb24gYW5kIGludm9rZXMgYG9uQWRkYCBmb3IgZXZlcnkgZWxlbWVudCB0aGF0IGlzIGluIGBhZnRlcmAgYnV0IG5vdFxuICogYGJlZm9yZWAuIGBvblJlbW92ZWAgaXMgaW52b2tlZCBmb3IgZXZlcnkgZWxlbWVudCBpbiBgYmVmb3JlYCBidXQgbWlzc2luZ1xuICogZnJvbSBgYWZ0ZXJgLlxuICpcbiAqIFRoZSBtZXRob2QgY3JlYXRlcyBhIGNvcHkgb2YgYm90aCBgYmVmb3JlYCBhbmQgYGFmdGVyYCBhbmQgcnVucyBpbiBPKG4gbG9nXG4gKiBuKSwgd2hlcmUgbiBpcyB0aGUgc2l6ZSBvZiB0aGUgdHdvIGxpc3RzLlxuICpcbiAqIEBwYXJhbSBiZWZvcmUgLSBUaGUgZWxlbWVudHMgdGhhdCBleGlzdCBpbiB0aGUgb3JpZ2luYWwgYXJyYXkuXG4gKiBAcGFyYW0gYWZ0ZXIgLSBUaGUgZWxlbWVudHMgdG8gZGlmZiBhZ2FpbnN0IHRoZSBvcmlnaW5hbCBhcnJheS5cbiAqIEBwYXJhbSBjb21wYXJhdG9yIC0gVGhlIGNvbXBhcmF0b3IgZm9yIHRoZSBlbGVtZW50cyBpbiBiZWZvcmUgYW5kIGFmdGVyLlxuICogQHBhcmFtIG9uQWRkIC0gQSBmdW5jdGlvbiB0byBpbnZva2UgZm9yIGV2ZXJ5IGVsZW1lbnQgdGhhdCBpcyBwYXJ0IG9mIGBcbiAqIGFmdGVyYCBidXQgbm90IGBiZWZvcmVgLlxuICogQHBhcmFtIG9uUmVtb3ZlIC0gQSBmdW5jdGlvbiB0byBpbnZva2UgZm9yIGV2ZXJ5IGVsZW1lbnQgdGhhdCBpcyBwYXJ0IG9mXG4gKiBgYmVmb3JlYCBidXQgbm90IGBhZnRlcmAuXG4gKi9cbiAgICAgICAgZnVuY3Rpb24gX19QUklWQVRFX2RpZmZBcnJheXMoZSwgdCwgbiwgciwgaSkge1xuICAgICAgICAgICAgZSA9IFsgLi4uZSBdLCB0ID0gWyAuLi50IF0sIGUuc29ydChuKSwgdC5zb3J0KG4pO1xuICAgICAgICAgICAgY29uc3QgcyA9IGUubGVuZ3RoLCBvID0gdC5sZW5ndGg7XG4gICAgICAgICAgICBsZXQgXyA9IDAsIGEgPSAwO1xuICAgICAgICAgICAgZm9yICg7XyA8IG8gJiYgYSA8IHM7ICkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuKGVbYV0sIHRbX10pO1xuICAgICAgICAgICAgICAgIHMgPCAwID8gXG4gICAgICAgICAgICAgICAgLy8gVGhlIGVsZW1lbnQgd2FzIHJlbW92ZWQgaWYgdGhlIG5leHQgZWxlbWVudCBpbiBvdXIgb3JkZXJlZFxuICAgICAgICAgICAgICAgIC8vIHdhbGt0aHJvdWdoIGlzIG9ubHkgaW4gYGJlZm9yZWAuXG4gICAgICAgICAgICAgICAgaShlW2ErK10pIDogcyA+IDAgPyBcbiAgICAgICAgICAgICAgICAvLyBUaGUgZWxlbWVudCB3YXMgYWRkZWQgaWYgdGhlIG5leHQgZWxlbWVudCBpbiBvdXIgb3JkZXJlZCB3YWxrdGhyb3VnaFxuICAgICAgICAgICAgICAgIC8vIGlzIG9ubHkgaW4gYGFmdGVyYC5cbiAgICAgICAgICAgICAgICByKHRbXysrXSkgOiAoXysrLCBhKyspO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICg7XyA8IG87ICkgcih0W18rK10pO1xuICAgICAgICAgICAgZm9yICg7YSA8IHM7ICkgaShlW2ErK10pO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogVmVyaWZpZXMgZXF1YWxpdHkgZm9yIGFuIGFycmF5IG9mIHByaW1pdGl2ZXMuXG4gKlxuICogQHByaXZhdGVcbiAqIEBpbnRlcm5hbFxuICogQHBhcmFtIGxlZnQgQXJyYXkgb2YgcHJpbWl0aXZlcy5cbiAqIEBwYXJhbSByaWdodCBBcnJheSBvZiBwcmltaXRpdmVzLlxuICogQHJldHVybiBUcnVlIGlmIGFycmF5cyBhcmUgZXF1YWwuXG4gKi8gKG4sIHQsIF9fUFJJVkFURV9maWVsZEluZGV4U2VtYW50aWNDb21wYXJhdG9yLCAodCA9PiB7XG4gICAgICAgICAgICBpLnB1c2goci5hZGRGaWVsZEluZGV4KGUsIHQpKTtcbiAgICAgICAgfSksICh0ID0+IHtcbiAgICAgICAgICAgIGkucHVzaChyLmRlbGV0ZUZpZWxkSW5kZXgoZSwgdCkpO1xuICAgICAgICB9KSkpKS5uZXh0KCgoKSA9PiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihpKSkpKSk7XG4gICAgfShhd2FpdCBfX1BSSVZBVEVfZ2V0TG9jYWxTdG9yZShlKSwgdCkpKTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2ZpcmVzdG9yZUNsaWVudFNldFBlcnNpc3RlbnRDYWNoZUluZGV4QXV0b0NyZWF0aW9uRW5hYmxlZChlLCB0KSB7XG4gICAgcmV0dXJuIGUuYXN5bmNRdWV1ZS5lbnF1ZXVlKChhc3luYyAoKSA9PiBmdW5jdGlvbiBfX1BSSVZBVEVfbG9jYWxTdG9yZVNldEluZGV4QXV0b0NyZWF0aW9uRW5hYmxlZChlLCB0KSB7XG4gICAgICAgIF9fUFJJVkFURV9kZWJ1Z0Nhc3QoZSkuRnMuVnMgPSB0O1xuICAgIH0oYXdhaXQgX19QUklWQVRFX2dldExvY2FsU3RvcmUoZSksIHQpKSk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9maXJlc3RvcmVDbGllbnREZWxldGVBbGxGaWVsZEluZGV4ZXMoZSkge1xuICAgIHJldHVybiBlLmFzeW5jUXVldWUuZW5xdWV1ZSgoYXN5bmMgKCkgPT4gZnVuY3Rpb24gX19QUklWQVRFX2xvY2FsU3RvcmVEZWxldGVBbGxGaWVsZEluZGV4ZXMoZSkge1xuICAgICAgICBjb25zdCB0ID0gX19QUklWQVRFX2RlYnVnQ2FzdChlKSwgbiA9IHQuaW5kZXhNYW5hZ2VyO1xuICAgICAgICByZXR1cm4gdC5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkRlbGV0ZSBBbGwgSW5kZXhlc1wiLCBcInJlYWR3cml0ZVwiLCAoZSA9PiBuLmRlbGV0ZUFsbEZpZWxkSW5kZXhlcyhlKSkpO1xuICAgIH0oYXdhaXQgX19QUklWQVRFX2dldExvY2FsU3RvcmUoZSkpKSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIzIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIENvbXBhcmVzIHR3byBgRXhwZXJpbWVudGFsTG9uZ1BvbGxpbmdPcHRpb25zYCBvYmplY3RzIGZvciBlcXVhbGl0eS5cbiAqL1xuLyoqXG4gKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgbmV3IGBFeHBlcmltZW50YWxMb25nUG9sbGluZ09wdGlvbnNgIHdpdGggdGhlIHNhbWVcbiAqIG9wdGlvbiB2YWx1ZXMgYXMgdGhlIGdpdmVuIGluc3RhbmNlLlxuICovXG5mdW5jdGlvbiBfX1BSSVZBVEVfY2xvbmVMb25nUG9sbGluZ09wdGlvbnMoZSkge1xuICAgIGNvbnN0IHQgPSB7fTtcbiAgICByZXR1cm4gdm9pZCAwICE9PSBlLnRpbWVvdXRTZWNvbmRzICYmICh0LnRpbWVvdXRTZWNvbmRzID0gZS50aW1lb3V0U2Vjb25kcyksIHQ7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IF9uID0gbmV3IE1hcDtcblxuLyoqXG4gKiBBbiBpbnN0YW5jZSBtYXAgdGhhdCBlbnN1cmVzIG9ubHkgb25lIERhdGFzdG9yZSBleGlzdHMgcGVyIEZpcmVzdG9yZVxuICogaW5zdGFuY2UuXG4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBzZXR0aW5ncygpIGRlZmF1bHRzOlxuY29uc3QgYW4gPSBcImZpcmVzdG9yZS5nb29nbGVhcGlzLmNvbVwiLCB1biA9ICEwO1xuXG4vKipcbiAqIEEgY29uY3JldGUgdHlwZSBkZXNjcmliaW5nIGFsbCB0aGUgdmFsdWVzIHRoYXQgY2FuIGJlIGFwcGxpZWQgdmlhIGFcbiAqIHVzZXItc3VwcGxpZWQgYEZpcmVzdG9yZVNldHRpbmdzYCBvYmplY3QuIFRoaXMgaXMgYSBzZXBhcmF0ZSB0eXBlIHNvIHRoYXRcbiAqIGRlZmF1bHRzIGNhbiBiZSBzdXBwbGllZCBhbmQgdGhlIHZhbHVlIGNhbiBiZSBjaGVja2VkIGZvciBlcXVhbGl0eS5cbiAqL1xuY2xhc3MgRmlyZXN0b3JlU2V0dGluZ3NJbXBsIHtcbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIGlmICh2b2lkIDAgPT09IGUuaG9zdCkge1xuICAgICAgICAgICAgaWYgKHZvaWQgMCAhPT0gZS5zc2wpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIFwiQ2FuJ3QgcHJvdmlkZSBzc2wgb3B0aW9uIGlmIGhvc3Qgb3B0aW9uIGlzIG5vdCBzZXRcIik7XG4gICAgICAgICAgICB0aGlzLmhvc3QgPSBhbiwgdGhpcy5zc2wgPSB1bjtcbiAgICAgICAgfSBlbHNlIHRoaXMuaG9zdCA9IGUuaG9zdCwgdGhpcy5zc2wgPSBlLnNzbCA/PyB1bjtcbiAgICAgICAgaWYgKHRoaXMuaXNVc2luZ0VtdWxhdG9yID0gdm9pZCAwICE9PSBlLmVtdWxhdG9yT3B0aW9ucywgdGhpcy5jcmVkZW50aWFscyA9IGUuY3JlZGVudGlhbHMsIFxuICAgICAgICB0aGlzLmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMgPSAhIWUuaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcywgdGhpcy5sb2NhbENhY2hlID0gZS5sb2NhbENhY2hlLCBcbiAgICAgICAgdm9pZCAwID09PSBlLmNhY2hlU2l6ZUJ5dGVzKSB0aGlzLmNhY2hlU2l6ZUJ5dGVzID0gT3Q7IGVsc2Uge1xuICAgICAgICAgICAgaWYgKC0xICE9PSBlLmNhY2hlU2l6ZUJ5dGVzICYmIGUuY2FjaGVTaXplQnl0ZXMgPCBCdCkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgXCJjYWNoZVNpemVCeXRlcyBtdXN0IGJlIGF0IGxlYXN0IDEwNDg1NzZcIik7XG4gICAgICAgICAgICB0aGlzLmNhY2hlU2l6ZUJ5dGVzID0gZS5jYWNoZVNpemVCeXRlcztcbiAgICAgICAgfVxuICAgICAgICBfX1BSSVZBVEVfdmFsaWRhdGVJc05vdFVzZWRUb2dldGhlcihcImV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmdcIiwgZS5leHBlcmltZW50YWxGb3JjZUxvbmdQb2xsaW5nLCBcImV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZ1wiLCBlLmV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZyksIFxuICAgICAgICB0aGlzLmV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmcgPSAhIWUuZXhwZXJpbWVudGFsRm9yY2VMb25nUG9sbGluZywgdGhpcy5leHBlcmltZW50YWxGb3JjZUxvbmdQb2xsaW5nID8gdGhpcy5leHBlcmltZW50YWxBdXRvRGV0ZWN0TG9uZ1BvbGxpbmcgPSAhMSA6IHZvaWQgMCA9PT0gZS5leHBlcmltZW50YWxBdXRvRGV0ZWN0TG9uZ1BvbGxpbmcgPyB0aGlzLmV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZyA9IHRydWUgOiBcbiAgICAgICAgLy8gRm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5LCBjb2VyY2UgdGhlIHZhbHVlIHRvIGJvb2xlYW4gZXZlbiB0aG91Z2hcbiAgICAgICAgLy8gdGhlIFR5cGVTY3JpcHQgY29tcGlsZXIgaGFzIG5hcnJvd2VkIHRoZSB0eXBlIHRvIGJvb2xlYW4gYWxyZWFkeS5cbiAgICAgICAgLy8gbm9pbnNwZWN0aW9uIFBvaW50bGVzc0Jvb2xlYW5FeHByZXNzaW9uSlNcbiAgICAgICAgdGhpcy5leHBlcmltZW50YWxBdXRvRGV0ZWN0TG9uZ1BvbGxpbmcgPSAhIWUuZXhwZXJpbWVudGFsQXV0b0RldGVjdExvbmdQb2xsaW5nLCBcbiAgICAgICAgdGhpcy5leHBlcmltZW50YWxMb25nUG9sbGluZ09wdGlvbnMgPSBfX1BSSVZBVEVfY2xvbmVMb25nUG9sbGluZ09wdGlvbnMoZS5leHBlcmltZW50YWxMb25nUG9sbGluZ09wdGlvbnMgPz8ge30pLCBcbiAgICAgICAgZnVuY3Rpb24gX19QUklWQVRFX3ZhbGlkYXRlTG9uZ1BvbGxpbmdPcHRpb25zKGUpIHtcbiAgICAgICAgICAgIGlmICh2b2lkIDAgIT09IGUudGltZW91dFNlY29uZHMpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4oZS50aW1lb3V0U2Vjb25kcykpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIGBpbnZhbGlkIGxvbmcgcG9sbGluZyB0aW1lb3V0OiAke2UudGltZW91dFNlY29uZHN9IChtdXN0IG5vdCBiZSBOYU4pYCk7XG4gICAgICAgICAgICAgICAgaWYgKGUudGltZW91dFNlY29uZHMgPCA1KSB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBgaW52YWxpZCBsb25nIHBvbGxpbmcgdGltZW91dDogJHtlLnRpbWVvdXRTZWNvbmRzfSAobWluaW11bSBhbGxvd2VkIHZhbHVlIGlzIDUpYCk7XG4gICAgICAgICAgICAgICAgaWYgKGUudGltZW91dFNlY29uZHMgPiAzMCkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgYGludmFsaWQgbG9uZyBwb2xsaW5nIHRpbWVvdXQ6ICR7ZS50aW1lb3V0U2Vjb25kc30gKG1heGltdW0gYWxsb3dlZCB2YWx1ZSBpcyAzMClgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuICAgICAgICAvKipcbiAqIFRoZSBDbG91ZCBGaXJlc3RvcmUgc2VydmljZSBpbnRlcmZhY2UuXG4gKlxuICogRG8gbm90IGNhbGwgdGhpcyBjb25zdHJ1Y3RvciBkaXJlY3RseS4gSW5zdGVhZCwgdXNlIHtAbGluayAoZ2V0RmlyZXN0b3JlOjEpfS5cbiAqLyAodGhpcy5leHBlcmltZW50YWxMb25nUG9sbGluZ09wdGlvbnMpLCB0aGlzLnVzZUZldGNoU3RyZWFtcyA9ICEhZS51c2VGZXRjaFN0cmVhbXM7XG4gICAgfVxuICAgIGlzRXF1YWwoZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5ob3N0ID09PSBlLmhvc3QgJiYgdGhpcy5zc2wgPT09IGUuc3NsICYmIHRoaXMuY3JlZGVudGlhbHMgPT09IGUuY3JlZGVudGlhbHMgJiYgdGhpcy5jYWNoZVNpemVCeXRlcyA9PT0gZS5jYWNoZVNpemVCeXRlcyAmJiB0aGlzLmV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmcgPT09IGUuZXhwZXJpbWVudGFsRm9yY2VMb25nUG9sbGluZyAmJiB0aGlzLmV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZyA9PT0gZS5leHBlcmltZW50YWxBdXRvRGV0ZWN0TG9uZ1BvbGxpbmcgJiYgZnVuY3Rpb24gX19QUklWQVRFX2xvbmdQb2xsaW5nT3B0aW9uc0VxdWFsKGUsIHQpIHtcbiAgICAgICAgICAgIHJldHVybiBlLnRpbWVvdXRTZWNvbmRzID09PSB0LnRpbWVvdXRTZWNvbmRzO1xuICAgICAgICB9KHRoaXMuZXhwZXJpbWVudGFsTG9uZ1BvbGxpbmdPcHRpb25zLCBlLmV4cGVyaW1lbnRhbExvbmdQb2xsaW5nT3B0aW9ucykgJiYgdGhpcy5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzID09PSBlLmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMgJiYgdGhpcy51c2VGZXRjaFN0cmVhbXMgPT09IGUudXNlRmV0Y2hTdHJlYW1zO1xuICAgIH1cbn1cblxuY2xhc3MgRmlyZXN0b3JlJDEge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IoZSwgdCwgbiwgcikge1xuICAgICAgICB0aGlzLl9hdXRoQ3JlZGVudGlhbHMgPSBlLCB0aGlzLl9hcHBDaGVja0NyZWRlbnRpYWxzID0gdCwgdGhpcy5fZGF0YWJhc2VJZCA9IG4sIFxuICAgICAgICB0aGlzLl9hcHAgPSByLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoZXRoZXIgaXQncyBhIEZpcmVzdG9yZSBvciBGaXJlc3RvcmUgTGl0ZSBpbnN0YW5jZS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudHlwZSA9IFwiZmlyZXN0b3JlLWxpdGVcIiwgdGhpcy5fcGVyc2lzdGVuY2VLZXkgPSBcIihsaXRlKVwiLCB0aGlzLl9zZXR0aW5ncyA9IG5ldyBGaXJlc3RvcmVTZXR0aW5nc0ltcGwoe30pLCBcbiAgICAgICAgdGhpcy5fc2V0dGluZ3NGcm96ZW4gPSAhMSwgdGhpcy5fZW11bGF0b3JPcHRpb25zID0ge30sIFxuICAgICAgICAvLyBBIHRhc2sgdGhhdCBpcyBhc3NpZ25lZCB3aGVuIHRoZSB0ZXJtaW5hdGUoKSBpcyBpbnZva2VkIGFuZCByZXNvbHZlZCB3aGVuXG4gICAgICAgIC8vIGFsbCBjb21wb25lbnRzIGhhdmUgc2h1dCBkb3duLiBPdGhlcndpc2UsIEZpcmVzdG9yZSBpcyBub3QgdGVybWluYXRlZCxcbiAgICAgICAgLy8gd2hpY2ggY2FuIG1lYW4gZWl0aGVyIHRoZSBGaXJlc3RvcmVDbGllbnQgaXMgaW4gdGhlIHByb2Nlc3Mgb2Ygc3RhcnRpbmcsXG4gICAgICAgIC8vIG9yIHJlc3RhcnRpbmcuXG4gICAgICAgIHRoaXMuX3Rlcm1pbmF0ZVRhc2sgPSBcIm5vdFRlcm1pbmF0ZWRcIjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlQXBwfSBhc3NvY2lhdGVkIHdpdGggdGhpcyBgRmlyZXN0b3JlYCBzZXJ2aWNlXG4gICAgICogaW5zdGFuY2UuXG4gICAgICovICAgIGdldCBhcHAoKSB7XG4gICAgICAgIGlmICghdGhpcy5fYXBwKSB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5GQUlMRURfUFJFQ09ORElUSU9OLCBcIkZpcmVzdG9yZSB3YXMgbm90IGluaXRpYWxpemVkIHVzaW5nIHRoZSBGaXJlYmFzZSBTREsuICdhcHAnIGlzIG5vdCBhdmFpbGFibGVcIik7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcHA7XG4gICAgfVxuICAgIGdldCBfaW5pdGlhbGl6ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZXR0aW5nc0Zyb3plbjtcbiAgICB9XG4gICAgZ2V0IF90ZXJtaW5hdGVkKCkge1xuICAgICAgICByZXR1cm4gXCJub3RUZXJtaW5hdGVkXCIgIT09IHRoaXMuX3Rlcm1pbmF0ZVRhc2s7XG4gICAgfVxuICAgIF9zZXRTZXR0aW5ncyhlKSB7XG4gICAgICAgIGlmICh0aGlzLl9zZXR0aW5nc0Zyb3plbikgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uRkFJTEVEX1BSRUNPTkRJVElPTiwgXCJGaXJlc3RvcmUgaGFzIGFscmVhZHkgYmVlbiBzdGFydGVkIGFuZCBpdHMgc2V0dGluZ3MgY2FuIG5vIGxvbmdlciBiZSBjaGFuZ2VkLiBZb3UgY2FuIG9ubHkgbW9kaWZ5IHNldHRpbmdzIGJlZm9yZSBjYWxsaW5nIGFueSBvdGhlciBtZXRob2RzIG9uIGEgRmlyZXN0b3JlIG9iamVjdC5cIik7XG4gICAgICAgIHRoaXMuX3NldHRpbmdzID0gbmV3IEZpcmVzdG9yZVNldHRpbmdzSW1wbChlKSwgdGhpcy5fZW11bGF0b3JPcHRpb25zID0gZS5lbXVsYXRvck9wdGlvbnMgfHwge30sIFxuICAgICAgICB2b2lkIDAgIT09IGUuY3JlZGVudGlhbHMgJiYgKHRoaXMuX2F1dGhDcmVkZW50aWFscyA9IGZ1bmN0aW9uIF9fUFJJVkFURV9tYWtlQXV0aENyZWRlbnRpYWxzUHJvdmlkZXIoZSkge1xuICAgICAgICAgICAgaWYgKCFlKSByZXR1cm4gbmV3IF9fUFJJVkFURV9FbXB0eUF1dGhDcmVkZW50aWFsc1Byb3ZpZGVyO1xuICAgICAgICAgICAgc3dpdGNoIChlLnR5cGUpIHtcbiAgICAgICAgICAgICAgY2FzZSBcImZpcnN0UGFydHlcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9GaXJzdFBhcnR5QXV0aENyZWRlbnRpYWxzUHJvdmlkZXIoZS5zZXNzaW9uSW5kZXggfHwgXCIwXCIsIGUuaWFtVG9rZW4gfHwgbnVsbCwgZS5hdXRoVG9rZW5GYWN0b3J5IHx8IG51bGwpO1xuXG4gICAgICAgICAgICAgIGNhc2UgXCJwcm92aWRlclwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBlLmNsaWVudDtcblxuICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIFwibWFrZUF1dGhDcmVkZW50aWFsc1Byb3ZpZGVyIGZhaWxlZCBkdWUgdG8gaW52YWxpZCBjcmVkZW50aWFsIHR5cGVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0oZS5jcmVkZW50aWFscykpO1xuICAgIH1cbiAgICBfZ2V0U2V0dGluZ3MoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZXR0aW5ncztcbiAgICB9XG4gICAgX2dldEVtdWxhdG9yT3B0aW9ucygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VtdWxhdG9yT3B0aW9ucztcbiAgICB9XG4gICAgX2ZyZWV6ZVNldHRpbmdzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2V0dGluZ3NGcm96ZW4gPSAhMCwgdGhpcy5fc2V0dGluZ3M7XG4gICAgfVxuICAgIF9kZWxldGUoKSB7XG4gICAgICAgIC8vIFRoZSBgX3Rlcm1pbmF0ZVRhc2tgIG11c3QgYmUgYXNzaWduZWQgZnV0dXJlIHRoYXQgY29tcGxldGVzIHdoZW5cbiAgICAgICAgLy8gdGVybWluYXRlIGlzIGNvbXBsZXRlLiBUaGUgZXhpc3RlbmNlIG9mIHRoaXMgZnV0dXJlIHB1dHMgU0RLIGluIHN0YXRlXG4gICAgICAgIC8vIHRoYXQgd2lsbCBub3QgYWNjZXB0IGZ1cnRoZXIgQVBJIGludGVyYWN0aW9uLlxuICAgICAgICByZXR1cm4gXCJub3RUZXJtaW5hdGVkXCIgPT09IHRoaXMuX3Rlcm1pbmF0ZVRhc2sgJiYgKHRoaXMuX3Rlcm1pbmF0ZVRhc2sgPSB0aGlzLl90ZXJtaW5hdGUoKSksIFxuICAgICAgICB0aGlzLl90ZXJtaW5hdGVUYXNrO1xuICAgIH1cbiAgICBhc3luYyBfcmVzdGFydCgpIHtcbiAgICAgICAgLy8gVGhlIGBfdGVybWluYXRlVGFza2AgbXVzdCBlcXVhbCAnbm90VGVybWluYXRlZCcgYWZ0ZXIgcmVzdGFydCB0b1xuICAgICAgICAvLyBzaWduYWwgdGhhdCBjbGllbnQgaXMgaW4gYSBzdGF0ZSB0aGF0IGFjY2VwdHMgQVBJIGNhbGxzLlxuICAgICAgICBcIm5vdFRlcm1pbmF0ZWRcIiA9PT0gdGhpcy5fdGVybWluYXRlVGFzayA/IGF3YWl0IHRoaXMuX3Rlcm1pbmF0ZSgpIDogdGhpcy5fdGVybWluYXRlVGFzayA9IFwibm90VGVybWluYXRlZFwiO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIEpTT04tc2VyaWFsaXphYmxlIHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgYEZpcmVzdG9yZWAgaW5zdGFuY2UuICovICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFwcDogdGhpcy5fYXBwLFxuICAgICAgICAgICAgZGF0YWJhc2VJZDogdGhpcy5fZGF0YWJhc2VJZCxcbiAgICAgICAgICAgIHNldHRpbmdzOiB0aGlzLl9zZXR0aW5nc1xuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUZXJtaW5hdGVzIGFsbCBjb21wb25lbnRzIHVzZWQgYnkgdGhpcyBjbGllbnQuIFN1YmNsYXNzZXMgY2FuIG92ZXJyaWRlXG4gICAgICogdGhpcyBtZXRob2QgdG8gY2xlYW4gdXAgdGhlaXIgb3duIGRlcGVuZGVuY2llcywgYnV0IG11c3QgYWxzbyBjYWxsIHRoaXNcbiAgICAgKiBtZXRob2QuXG4gICAgICpcbiAgICAgKiBPbmx5IGV2ZXIgY2FsbGVkIG9uY2UuXG4gICAgICovICAgIF90ZXJtaW5hdGUoKSB7XG4gICAgICAgIC8qKlxuICogUmVtb3ZlcyBhbGwgY29tcG9uZW50cyBhc3NvY2lhdGVkIHdpdGggdGhlIHByb3ZpZGVkIGluc3RhbmNlLiBNdXN0IGJlIGNhbGxlZFxuICogd2hlbiB0aGUgYEZpcmVzdG9yZWAgaW5zdGFuY2UgaXMgdGVybWluYXRlZC5cbiAqL1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX3JlbW92ZUNvbXBvbmVudHMoZSkge1xuICAgICAgICAgICAgY29uc3QgdCA9IF9uLmdldChlKTtcbiAgICAgICAgICAgIHQgJiYgKF9fUFJJVkFURV9sb2dEZWJ1ZyhcIkNvbXBvbmVudFByb3ZpZGVyXCIsIFwiUmVtb3ZpbmcgRGF0YXN0b3JlXCIpLCBfbi5kZWxldGUoZSksIFxuICAgICAgICAgICAgdC50ZXJtaW5hdGUoKSk7XG4gICAgICAgIH0odGhpcyksIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBNb2RpZnkgdGhpcyBpbnN0YW5jZSB0byBjb21tdW5pY2F0ZSB3aXRoIHRoZSBDbG91ZCBGaXJlc3RvcmUgZW11bGF0b3IuXG4gKlxuICogTm90ZTogVGhpcyBtdXN0IGJlIGNhbGxlZCBiZWZvcmUgdGhpcyBpbnN0YW5jZSBoYXMgYmVlbiB1c2VkIHRvIGRvIGFueVxuICogb3BlcmF0aW9ucy5cbiAqXG4gKiBAcGFyYW0gZmlyZXN0b3JlIC0gVGhlIGBGaXJlc3RvcmVgIGluc3RhbmNlIHRvIGNvbmZpZ3VyZSB0byBjb25uZWN0IHRvIHRoZVxuICogZW11bGF0b3IuXG4gKiBAcGFyYW0gaG9zdCAtIHRoZSBlbXVsYXRvciBob3N0IChleDogbG9jYWxob3N0KS5cbiAqIEBwYXJhbSBwb3J0IC0gdGhlIGVtdWxhdG9yIHBvcnQgKGV4OiA5MDAwKS5cbiAqIEBwYXJhbSBvcHRpb25zLm1vY2tVc2VyVG9rZW4gLSB0aGUgbW9jayBhdXRoIHRva2VuIHRvIHVzZSBmb3IgdW5pdCB0ZXN0aW5nXG4gKiBTZWN1cml0eSBSdWxlcy5cbiAqLyBmdW5jdGlvbiBjb25uZWN0RmlyZXN0b3JlRW11bGF0b3IoZSwgdCwgbiwgciA9IHt9KSB7XG4gICAgZSA9IF9fUFJJVkFURV9jYXN0KGUsIEZpcmVzdG9yZSQxKTtcbiAgICBjb25zdCBpID0gaXNDbG91ZFdvcmtzdGF0aW9uKHQpLCBzID0gZS5fZ2V0U2V0dGluZ3MoKSwgbyA9IHtcbiAgICAgICAgLi4ucyxcbiAgICAgICAgZW11bGF0b3JPcHRpb25zOiBlLl9nZXRFbXVsYXRvck9wdGlvbnMoKVxuICAgIH0sIF8gPSBgJHt0fToke259YDtcbiAgICBpICYmIChwaW5nU2VydmVyKGBodHRwczovLyR7X31gKSwgdXBkYXRlRW11bGF0b3JCYW5uZXIoXCJGaXJlc3RvcmVcIiwgITApKSwgcy5ob3N0ICE9PSBhbiAmJiBzLmhvc3QgIT09IF8gJiYgX19QUklWQVRFX2xvZ1dhcm4oXCJIb3N0IGhhcyBiZWVuIHNldCBpbiBib3RoIHNldHRpbmdzKCkgYW5kIGNvbm5lY3RGaXJlc3RvcmVFbXVsYXRvcigpLCBlbXVsYXRvciBob3N0IHdpbGwgYmUgdXNlZC5cIik7XG4gICAgY29uc3QgYSA9IHtcbiAgICAgICAgLi4ucyxcbiAgICAgICAgaG9zdDogXyxcbiAgICAgICAgc3NsOiBpLFxuICAgICAgICBlbXVsYXRvck9wdGlvbnM6IHJcbiAgICB9O1xuICAgIC8vIE5vLW9wIGlmIHRoZSBuZXcgY29uZmlndXJhdGlvbiBtYXRjaGVzIHRoZSBjdXJyZW50IGNvbmZpZ3VyYXRpb24uIFRoaXMgc3VwcG9ydHMgU1NSXG4gICAgLy8gZW52aW9ybm1lbnRzIHdoaWNoIG1pZ2h0IGNhbGwgYGNvbm5lY3RGaXJlc3RvcmVFbXVsYXRvcmAgbXVsdGlwbGUgdGltZXMgYXMgYSBzdGFuZGFyZCBwcmFjdGljZS5cbiAgICAgICAgaWYgKCFkZWVwRXF1YWwoYSwgbykgJiYgKGUuX3NldFNldHRpbmdzKGEpLCByLm1vY2tVc2VyVG9rZW4pKSB7XG4gICAgICAgIGxldCB0LCBuO1xuICAgICAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2Ygci5tb2NrVXNlclRva2VuKSB0ID0gci5tb2NrVXNlclRva2VuLCBuID0gVXNlci5NT0NLX1VTRVI7IGVsc2Uge1xuICAgICAgICAgICAgLy8gTGV0IGNyZWF0ZU1vY2tVc2VyVG9rZW4gdmFsaWRhdGUgZmlyc3QgKGNhdGNoZXMgY29tbW9uIG1pc3Rha2VzIGxpa2VcbiAgICAgICAgICAgIC8vIGludmFsaWQgZmllbGQgXCJ1aWRcIiBhbmQgbWlzc2luZyBmaWVsZCBcInN1YlwiIC8gXCJ1c2VyX2lkXCIuKVxuICAgICAgICAgICAgdCA9IGNyZWF0ZU1vY2tVc2VyVG9rZW4oci5tb2NrVXNlclRva2VuLCBlLl9hcHA/Lm9wdGlvbnMucHJvamVjdElkKTtcbiAgICAgICAgICAgIGNvbnN0IGkgPSByLm1vY2tVc2VyVG9rZW4uc3ViIHx8IHIubW9ja1VzZXJUb2tlbi51c2VyX2lkO1xuICAgICAgICAgICAgaWYgKCFpKSB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBcIm1vY2tVc2VyVG9rZW4gbXVzdCBjb250YWluICdzdWInIG9yICd1c2VyX2lkJyBmaWVsZCFcIik7XG4gICAgICAgICAgICBuID0gbmV3IFVzZXIoaSk7XG4gICAgICAgIH1cbiAgICAgICAgZS5fYXV0aENyZWRlbnRpYWxzID0gbmV3IF9fUFJJVkFURV9FbXVsYXRvckF1dGhDcmVkZW50aWFsc1Byb3ZpZGVyKG5ldyBfX1BSSVZBVEVfT0F1dGhUb2tlbih0LCBuKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGBRdWVyeWAgcmVmZXJzIHRvIGEgcXVlcnkgd2hpY2ggeW91IGNhbiByZWFkIG9yIGxpc3RlbiB0by4gWW91IGNhbiBhbHNvXG4gKiBjb25zdHJ1Y3QgcmVmaW5lZCBgUXVlcnlgIG9iamVjdHMgYnkgYWRkaW5nIGZpbHRlcnMgYW5kIG9yZGVyaW5nLlxuICovIGNsYXNzIFF1ZXJ5IHtcbiAgICAvLyBUaGlzIGlzIHRoZSBsaXRlIHZlcnNpb24gb2YgdGhlIFF1ZXJ5IGNsYXNzIGluIHRoZSBtYWluIFNESy5cbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciBwcm90ZWN0ZWQgKi9cbiAgICBjb25zdHJ1Y3RvcihlLCBcbiAgICAvKipcbiAgICAgKiBJZiBwcm92aWRlZCwgdGhlIGBGaXJlc3RvcmVEYXRhQ29udmVydGVyYCBhc3NvY2lhdGVkIHdpdGggdGhpcyBpbnN0YW5jZS5cbiAgICAgKi9cbiAgICB0LCBuKSB7XG4gICAgICAgIHRoaXMuY29udmVydGVyID0gdCwgdGhpcy5fcXVlcnkgPSBuLCBcbiAgICAgICAgLyoqIFRoZSB0eXBlIG9mIHRoaXMgRmlyZXN0b3JlIHJlZmVyZW5jZS4gKi9cbiAgICAgICAgdGhpcy50eXBlID0gXCJxdWVyeVwiLCB0aGlzLmZpcmVzdG9yZSA9IGU7XG4gICAgfVxuICAgIHdpdGhDb252ZXJ0ZXIoZSkge1xuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5KHRoaXMuZmlyZXN0b3JlLCBlLCB0aGlzLl9xdWVyeSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgYERvY3VtZW50UmVmZXJlbmNlYCByZWZlcnMgdG8gYSBkb2N1bWVudCBsb2NhdGlvbiBpbiBhIEZpcmVzdG9yZSBkYXRhYmFzZVxuICogYW5kIGNhbiBiZSB1c2VkIHRvIHdyaXRlLCByZWFkLCBvciBsaXN0ZW4gdG8gdGhlIGxvY2F0aW9uLiBUaGUgZG9jdW1lbnQgYXRcbiAqIHRoZSByZWZlcmVuY2VkIGxvY2F0aW9uIG1heSBvciBtYXkgbm90IGV4aXN0LlxuICovIGNsYXNzIERvY3VtZW50UmVmZXJlbmNlIHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciAqL1xuICAgIGNvbnN0cnVjdG9yKGUsIFxuICAgIC8qKlxuICAgICAqIElmIHByb3ZpZGVkLCB0aGUgYEZpcmVzdG9yZURhdGFDb252ZXJ0ZXJgIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGluc3RhbmNlLlxuICAgICAqL1xuICAgIHQsIG4pIHtcbiAgICAgICAgdGhpcy5jb252ZXJ0ZXIgPSB0LCB0aGlzLl9rZXkgPSBuLCBcbiAgICAgICAgLyoqIFRoZSB0eXBlIG9mIHRoaXMgRmlyZXN0b3JlIHJlZmVyZW5jZS4gKi9cbiAgICAgICAgdGhpcy50eXBlID0gXCJkb2N1bWVudFwiLCB0aGlzLmZpcmVzdG9yZSA9IGU7XG4gICAgfVxuICAgIGdldCBfcGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2tleS5wYXRoO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgZG9jdW1lbnQncyBpZGVudGlmaWVyIHdpdGhpbiBpdHMgY29sbGVjdGlvbi5cbiAgICAgKi8gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fa2V5LnBhdGgubGFzdFNlZ21lbnQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBwYXRoIG9mIHRoZSByZWZlcmVuY2VkIGRvY3VtZW50IChyZWxhdGl2ZVxuICAgICAqIHRvIHRoZSByb290IG9mIHRoZSBkYXRhYmFzZSkuXG4gICAgICovICAgIGdldCBwYXRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fa2V5LnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBjb2xsZWN0aW9uIHRoaXMgYERvY3VtZW50UmVmZXJlbmNlYCBiZWxvbmdzIHRvLlxuICAgICAqLyAgICBnZXQgcGFyZW50KCkge1xuICAgICAgICByZXR1cm4gbmV3IENvbGxlY3Rpb25SZWZlcmVuY2UodGhpcy5maXJlc3RvcmUsIHRoaXMuY29udmVydGVyLCB0aGlzLl9rZXkucGF0aC5wb3BMYXN0KCkpO1xuICAgIH1cbiAgICB3aXRoQ29udmVydGVyKGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudFJlZmVyZW5jZSh0aGlzLmZpcmVzdG9yZSwgZSwgdGhpcy5fa2V5KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIEpTT04tc2VyaWFsaXphYmxlIHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgYERvY3VtZW50UmVmZXJlbmNlYCBpbnN0YW5jZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIGEgSlNPTiByZXByZXNlbnRhdGlvbiBvZiB0aGlzIG9iamVjdC5cbiAgICAgKi8gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogRG9jdW1lbnRSZWZlcmVuY2UuX2pzb25TY2hlbWFWZXJzaW9uLFxuICAgICAgICAgICAgcmVmZXJlbmNlUGF0aDogdGhpcy5fa2V5LnRvU3RyaW5nKClcbiAgICAgICAgfTtcbiAgICB9XG4gICAgc3RhdGljIGZyb21KU09OKGUsIHQsIG4pIHtcbiAgICAgICAgaWYgKF9fUFJJVkFURV92YWxpZGF0ZUpTT04odCwgRG9jdW1lbnRSZWZlcmVuY2UuX2pzb25TY2hlbWEpKSByZXR1cm4gbmV3IERvY3VtZW50UmVmZXJlbmNlKGUsIG4gfHwgbnVsbCwgbmV3IERvY3VtZW50S2V5KFJlc291cmNlUGF0aC5mcm9tU3RyaW5nKHQucmVmZXJlbmNlUGF0aCkpKTtcbiAgICB9XG59XG5cbkRvY3VtZW50UmVmZXJlbmNlLl9qc29uU2NoZW1hVmVyc2lvbiA9IFwiZmlyZXN0b3JlL2RvY3VtZW50UmVmZXJlbmNlLzEuMFwiLCBEb2N1bWVudFJlZmVyZW5jZS5fanNvblNjaGVtYSA9IHtcbiAgICB0eXBlOiBwcm9wZXJ0eShcInN0cmluZ1wiLCBEb2N1bWVudFJlZmVyZW5jZS5fanNvblNjaGVtYVZlcnNpb24pLFxuICAgIHJlZmVyZW5jZVBhdGg6IHByb3BlcnR5KFwic3RyaW5nXCIpXG59O1xuXG4vKipcbiAqIEEgYENvbGxlY3Rpb25SZWZlcmVuY2VgIG9iamVjdCBjYW4gYmUgdXNlZCBmb3IgYWRkaW5nIGRvY3VtZW50cywgZ2V0dGluZ1xuICogZG9jdW1lbnQgcmVmZXJlbmNlcywgYW5kIHF1ZXJ5aW5nIGZvciBkb2N1bWVudHMgKHVzaW5nIHtAbGluayAocXVlcnk6MSl9KS5cbiAqL1xuY2xhc3MgQ29sbGVjdGlvblJlZmVyZW5jZSBleHRlbmRzIFF1ZXJ5IHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciAqL1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4pIHtcbiAgICAgICAgc3VwZXIoZSwgdCwgX19QUklWQVRFX25ld1F1ZXJ5Rm9yUGF0aChuKSksIHRoaXMuX3BhdGggPSBuLCBcbiAgICAgICAgLyoqIFRoZSB0eXBlIG9mIHRoaXMgRmlyZXN0b3JlIHJlZmVyZW5jZS4gKi9cbiAgICAgICAgdGhpcy50eXBlID0gXCJjb2xsZWN0aW9uXCI7XG4gICAgfVxuICAgIC8qKiBUaGUgY29sbGVjdGlvbidzIGlkZW50aWZpZXIuICovICAgIGdldCBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3F1ZXJ5LnBhdGgubGFzdFNlZ21lbnQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBwYXRoIG9mIHRoZSByZWZlcmVuY2VkIGNvbGxlY3Rpb24gKHJlbGF0aXZlXG4gICAgICogdG8gdGhlIHJvb3Qgb2YgdGhlIGRhdGFiYXNlKS5cbiAgICAgKi8gICAgZ2V0IHBhdGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9xdWVyeS5wYXRoLmNhbm9uaWNhbFN0cmluZygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBIHJlZmVyZW5jZSB0byB0aGUgY29udGFpbmluZyBgRG9jdW1lbnRSZWZlcmVuY2VgIGlmIHRoaXMgaXMgYVxuICAgICAqIHN1YmNvbGxlY3Rpb24uIElmIHRoaXMgaXNuJ3QgYSBzdWJjb2xsZWN0aW9uLCB0aGUgcmVmZXJlbmNlIGlzIG51bGwuXG4gICAgICovICAgIGdldCBwYXJlbnQoKSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLl9wYXRoLnBvcExhc3QoKTtcbiAgICAgICAgcmV0dXJuIGUuaXNFbXB0eSgpID8gbnVsbCA6IG5ldyBEb2N1bWVudFJlZmVyZW5jZSh0aGlzLmZpcmVzdG9yZSwgXG4gICAgICAgIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCwgbmV3IERvY3VtZW50S2V5KGUpKTtcbiAgICB9XG4gICAgd2l0aENvbnZlcnRlcihlKSB7XG4gICAgICAgIHJldHVybiBuZXcgQ29sbGVjdGlvblJlZmVyZW5jZSh0aGlzLmZpcmVzdG9yZSwgZSwgdGhpcy5fcGF0aCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBjb2xsZWN0aW9uKGUsIHQsIC4uLm4pIHtcbiAgICBpZiAoZSA9IGdldE1vZHVsYXJJbnN0YW5jZShlKSwgX19QUklWQVRFX3ZhbGlkYXRlTm9uRW1wdHlBcmd1bWVudChcImNvbGxlY3Rpb25cIiwgXCJwYXRoXCIsIHQpLCBlIGluc3RhbmNlb2YgRmlyZXN0b3JlJDEpIHtcbiAgICAgICAgY29uc3QgciA9IFJlc291cmNlUGF0aC5mcm9tU3RyaW5nKHQsIC4uLm4pO1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX3ZhbGlkYXRlQ29sbGVjdGlvblBhdGgociksIG5ldyBDb2xsZWN0aW9uUmVmZXJlbmNlKGUsIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCwgcik7XG4gICAgfVxuICAgIHtcbiAgICAgICAgaWYgKCEoZSBpbnN0YW5jZW9mIERvY3VtZW50UmVmZXJlbmNlIHx8IGUgaW5zdGFuY2VvZiBDb2xsZWN0aW9uUmVmZXJlbmNlKSkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgXCJFeHBlY3RlZCBmaXJzdCBhcmd1bWVudCB0byBjb2xsZWN0aW9uKCkgdG8gYmUgYSBDb2xsZWN0aW9uUmVmZXJlbmNlLCBhIERvY3VtZW50UmVmZXJlbmNlIG9yIEZpcmViYXNlRmlyZXN0b3JlXCIpO1xuICAgICAgICBjb25zdCByID0gZS5fcGF0aC5jaGlsZChSZXNvdXJjZVBhdGguZnJvbVN0cmluZyh0LCAuLi5uKSk7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfdmFsaWRhdGVDb2xsZWN0aW9uUGF0aChyKSwgbmV3IENvbGxlY3Rpb25SZWZlcmVuY2UoZS5maXJlc3RvcmUsIFxuICAgICAgICAvKiBjb252ZXJ0ZXI9ICovIG51bGwsIHIpO1xuICAgIH1cbn1cblxuLy8gVE9ETyhmaXJlc3RvcmVsaXRlKTogQ29uc2lkZXIgdXNpbmcgRXJyb3JGYWN0b3J5IC1cbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9maXJlYmFzZS9maXJlYmFzZS1qcy1zZGsvYmxvYi8wMTMxZTFmL3BhY2thZ2VzL3V0aWwvc3JjL2Vycm9ycy50cyNMMTA2XG4vKipcbiAqIENyZWF0ZXMgYW5kIHJldHVybnMgYSBuZXcgYFF1ZXJ5YCBpbnN0YW5jZSB0aGF0IGluY2x1ZGVzIGFsbCBkb2N1bWVudHMgaW4gdGhlXG4gKiBkYXRhYmFzZSB0aGF0IGFyZSBjb250YWluZWQgaW4gYSBjb2xsZWN0aW9uIG9yIHN1YmNvbGxlY3Rpb24gd2l0aCB0aGVcbiAqIGdpdmVuIGBjb2xsZWN0aW9uSWRgLlxuICpcbiAqIEBwYXJhbSBmaXJlc3RvcmUgLSBBIHJlZmVyZW5jZSB0byB0aGUgcm9vdCBgRmlyZXN0b3JlYCBpbnN0YW5jZS5cbiAqIEBwYXJhbSBjb2xsZWN0aW9uSWQgLSBJZGVudGlmaWVzIHRoZSBjb2xsZWN0aW9ucyB0byBxdWVyeSBvdmVyLiBFdmVyeVxuICogY29sbGVjdGlvbiBvciBzdWJjb2xsZWN0aW9uIHdpdGggdGhpcyBJRCBhcyB0aGUgbGFzdCBzZWdtZW50IG9mIGl0cyBwYXRoXG4gKiB3aWxsIGJlIGluY2x1ZGVkLiBDYW5ub3QgY29udGFpbiBhIHNsYXNoLlxuICogQHJldHVybnMgVGhlIGNyZWF0ZWQgYFF1ZXJ5YC5cbiAqLyBmdW5jdGlvbiBjb2xsZWN0aW9uR3JvdXAoZSwgdCkge1xuICAgIGlmIChlID0gX19QUklWQVRFX2Nhc3QoZSwgRmlyZXN0b3JlJDEpLCBfX1BSSVZBVEVfdmFsaWRhdGVOb25FbXB0eUFyZ3VtZW50KFwiY29sbGVjdGlvbkdyb3VwXCIsIFwiY29sbGVjdGlvbiBpZFwiLCB0KSwgXG4gICAgdC5pbmRleE9mKFwiL1wiKSA+PSAwKSB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBjb2xsZWN0aW9uIElEICcke3R9JyBwYXNzZWQgdG8gZnVuY3Rpb24gY29sbGVjdGlvbkdyb3VwKCkuIENvbGxlY3Rpb24gSURzIG11c3Qgbm90IGNvbnRhaW4gJy8nLmApO1xuICAgIHJldHVybiBuZXcgUXVlcnkoZSwgXG4gICAgLyogY29udmVydGVyPSAqLyBudWxsLCBmdW5jdGlvbiBfX1BSSVZBVEVfbmV3UXVlcnlGb3JDb2xsZWN0aW9uR3JvdXAoZSkge1xuICAgICAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9RdWVyeUltcGwoUmVzb3VyY2VQYXRoLmVtcHR5UGF0aCgpLCBlKTtcbiAgICB9KHQpKTtcbn1cblxuZnVuY3Rpb24gZG9jKGUsIHQsIC4uLm4pIHtcbiAgICBpZiAoZSA9IGdldE1vZHVsYXJJbnN0YW5jZShlKSwgXG4gICAgLy8gV2UgYWxsb3cgb21pc3Npb24gb2YgJ3BhdGhTdHJpbmcnIGJ1dCBleHBsaWNpdGx5IHByb2hpYml0IHBhc3NpbmcgaW4gYm90aFxuICAgIC8vICd1bmRlZmluZWQnIGFuZCAnbnVsbCcuXG4gICAgMSA9PT0gYXJndW1lbnRzLmxlbmd0aCAmJiAodCA9IF9fUFJJVkFURV9BdXRvSWQubmV3SWQoKSksIF9fUFJJVkFURV92YWxpZGF0ZU5vbkVtcHR5QXJndW1lbnQoXCJkb2NcIiwgXCJwYXRoXCIsIHQpLCBcbiAgICBlIGluc3RhbmNlb2YgRmlyZXN0b3JlJDEpIHtcbiAgICAgICAgY29uc3QgciA9IFJlc291cmNlUGF0aC5mcm9tU3RyaW5nKHQsIC4uLm4pO1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX3ZhbGlkYXRlRG9jdW1lbnRQYXRoKHIpLCBuZXcgRG9jdW1lbnRSZWZlcmVuY2UoZSwgXG4gICAgICAgIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCwgbmV3IERvY3VtZW50S2V5KHIpKTtcbiAgICB9XG4gICAge1xuICAgICAgICBpZiAoIShlIGluc3RhbmNlb2YgRG9jdW1lbnRSZWZlcmVuY2UgfHwgZSBpbnN0YW5jZW9mIENvbGxlY3Rpb25SZWZlcmVuY2UpKSB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBcIkV4cGVjdGVkIGZpcnN0IGFyZ3VtZW50IHRvIGNvbGxlY3Rpb24oKSB0byBiZSBhIENvbGxlY3Rpb25SZWZlcmVuY2UsIGEgRG9jdW1lbnRSZWZlcmVuY2Ugb3IgRmlyZWJhc2VGaXJlc3RvcmVcIik7XG4gICAgICAgIGNvbnN0IHIgPSBlLl9wYXRoLmNoaWxkKFJlc291cmNlUGF0aC5mcm9tU3RyaW5nKHQsIC4uLm4pKTtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV92YWxpZGF0ZURvY3VtZW50UGF0aChyKSwgbmV3IERvY3VtZW50UmVmZXJlbmNlKGUuZmlyZXN0b3JlLCBlIGluc3RhbmNlb2YgQ29sbGVjdGlvblJlZmVyZW5jZSA/IGUuY29udmVydGVyIDogbnVsbCwgbmV3IERvY3VtZW50S2V5KHIpKTtcbiAgICB9XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBwcm92aWRlZCByZWZlcmVuY2VzIGFyZSBlcXVhbC5cbiAqXG4gKiBAcGFyYW0gbGVmdCAtIEEgcmVmZXJlbmNlIHRvIGNvbXBhcmUuXG4gKiBAcGFyYW0gcmlnaHQgLSBBIHJlZmVyZW5jZSB0byBjb21wYXJlLlxuICogQHJldHVybnMgdHJ1ZSBpZiB0aGUgcmVmZXJlbmNlcyBwb2ludCB0byB0aGUgc2FtZSBsb2NhdGlvbiBpbiB0aGUgc2FtZVxuICogRmlyZXN0b3JlIGRhdGFiYXNlLlxuICovIGZ1bmN0aW9uIHJlZkVxdWFsKGUsIHQpIHtcbiAgICByZXR1cm4gZSA9IGdldE1vZHVsYXJJbnN0YW5jZShlKSwgdCA9IGdldE1vZHVsYXJJbnN0YW5jZSh0KSwgKGUgaW5zdGFuY2VvZiBEb2N1bWVudFJlZmVyZW5jZSB8fCBlIGluc3RhbmNlb2YgQ29sbGVjdGlvblJlZmVyZW5jZSkgJiYgKHQgaW5zdGFuY2VvZiBEb2N1bWVudFJlZmVyZW5jZSB8fCB0IGluc3RhbmNlb2YgQ29sbGVjdGlvblJlZmVyZW5jZSkgJiYgKGUuZmlyZXN0b3JlID09PSB0LmZpcmVzdG9yZSAmJiBlLnBhdGggPT09IHQucGF0aCAmJiBlLmNvbnZlcnRlciA9PT0gdC5jb252ZXJ0ZXIpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgcHJvdmlkZWQgcXVlcmllcyBwb2ludCB0byB0aGUgc2FtZSBjb2xsZWN0aW9uIGFuZCBhcHBseVxuICogdGhlIHNhbWUgY29uc3RyYWludHMuXG4gKlxuICogQHBhcmFtIGxlZnQgLSBBIGBRdWVyeWAgdG8gY29tcGFyZS5cbiAqIEBwYXJhbSByaWdodCAtIEEgYFF1ZXJ5YCB0byBjb21wYXJlLlxuICogQHJldHVybnMgdHJ1ZSBpZiB0aGUgcmVmZXJlbmNlcyBwb2ludCB0byB0aGUgc2FtZSBsb2NhdGlvbiBpbiB0aGUgc2FtZVxuICogRmlyZXN0b3JlIGRhdGFiYXNlLlxuICovIGZ1bmN0aW9uIHF1ZXJ5RXF1YWwoZSwgdCkge1xuICAgIHJldHVybiBlID0gZ2V0TW9kdWxhckluc3RhbmNlKGUpLCB0ID0gZ2V0TW9kdWxhckluc3RhbmNlKHQpLCBlIGluc3RhbmNlb2YgUXVlcnkgJiYgdCBpbnN0YW5jZW9mIFF1ZXJ5ICYmIChlLmZpcmVzdG9yZSA9PT0gdC5maXJlc3RvcmUgJiYgX19QUklWQVRFX3F1ZXJ5RXF1YWxzKGUuX3F1ZXJ5LCB0Ll9xdWVyeSkgJiYgZS5jb252ZXJ0ZXIgPT09IHQuY29udmVydGVyKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY29uc3QgY24gPSBcIkFzeW5jUXVldWVcIjtcblxuY2xhc3MgX19QUklWQVRFX0FzeW5jUXVldWVJbXBsIHtcbiAgICBjb25zdHJ1Y3RvcihlID0gUHJvbWlzZS5yZXNvbHZlKCkpIHtcbiAgICAgICAgLy8gQSBsaXN0IG9mIHJldHJ5YWJsZSBvcGVyYXRpb25zLiBSZXRyeWFibGUgb3BlcmF0aW9ucyBhcmUgcnVuIGluIG9yZGVyIGFuZFxuICAgICAgICAvLyByZXRyaWVkIHdpdGggYmFja29mZi5cbiAgICAgICAgdGhpcy5YdSA9IFtdLCBcbiAgICAgICAgLy8gSXMgdGhpcyBBc3luY1F1ZXVlIGJlaW5nIHNodXQgZG93bj8gT25jZSBpdCBpcyBzZXQgdG8gdHJ1ZSwgaXQgd2lsbCBub3RcbiAgICAgICAgLy8gYmUgY2hhbmdlZCBhZ2Fpbi5cbiAgICAgICAgdGhpcy5lYyA9ICExLCBcbiAgICAgICAgLy8gT3BlcmF0aW9ucyBzY2hlZHVsZWQgdG8gYmUgcXVldWVkIGluIHRoZSBmdXR1cmUuIE9wZXJhdGlvbnMgYXJlXG4gICAgICAgIC8vIGF1dG9tYXRpY2FsbHkgcmVtb3ZlZCBhZnRlciB0aGV5IGFyZSBydW4gb3IgY2FuY2VsZWQuXG4gICAgICAgIHRoaXMudGMgPSBbXSwgXG4gICAgICAgIC8vIHZpc2libGUgZm9yIHRlc3RpbmdcbiAgICAgICAgdGhpcy5uYyA9IG51bGwsIFxuICAgICAgICAvLyBGbGFnIHNldCB3aGlsZSB0aGVyZSdzIGFuIG91dHN0YW5kaW5nIEFzeW5jUXVldWUgb3BlcmF0aW9uLCB1c2VkIGZvclxuICAgICAgICAvLyBhc3NlcnRpb24gc2FuaXR5LWNoZWNrcy5cbiAgICAgICAgdGhpcy5yYyA9ICExLCBcbiAgICAgICAgLy8gRW5hYmxlZCBkdXJpbmcgc2h1dGRvd24gb24gU2FmYXJpIHRvIHByZXZlbnQgZnV0dXJlIGFjY2VzcyB0byBJbmRleGVkREIuXG4gICAgICAgIHRoaXMuc2MgPSAhMSwgXG4gICAgICAgIC8vIExpc3Qgb2YgVGltZXJJZHMgdG8gZmFzdC1mb3J3YXJkIGRlbGF5cyBmb3IuXG4gICAgICAgIHRoaXMub2MgPSBbXSwgXG4gICAgICAgIC8vIEJhY2tvZmYgdGltZXIgdXNlZCB0byBzY2hlZHVsZSByZXRyaWVzIGZvciByZXRyeWFibGUgb3BlcmF0aW9uc1xuICAgICAgICB0aGlzLk1fID0gbmV3IF9fUFJJVkFURV9FeHBvbmVudGlhbEJhY2tvZmYodGhpcywgXCJhc3luY19xdWV1ZV9yZXRyeVwiIC8qIFRpbWVySWQuQXN5bmNRdWV1ZVJldHJ5ICovKSwgXG4gICAgICAgIC8vIFZpc2liaWxpdHkgaGFuZGxlciB0aGF0IHRyaWdnZXJzIGFuIGltbWVkaWF0ZSByZXRyeSBvZiBhbGwgcmV0cnlhYmxlXG4gICAgICAgIC8vIG9wZXJhdGlvbnMuIE1lYW50IHRvIHNwZWVkIHVwIHJlY292ZXJ5IHdoZW4gd2UgcmVnYWluIGZpbGUgc3lzdGVtIGFjY2Vzc1xuICAgICAgICAvLyBhZnRlciBwYWdlIGNvbWVzIGludG8gZm9yZWdyb3VuZC5cbiAgICAgICAgdGhpcy5fYyA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBnZXREb2N1bWVudCgpO1xuICAgICAgICAgICAgZSAmJiBfX1BSSVZBVEVfbG9nRGVidWcoY24sIFwiVmlzaWJpbGl0eSBzdGF0ZSBjaGFuZ2VkIHRvIFwiICsgZS52aXNpYmlsaXR5U3RhdGUpLCBcbiAgICAgICAgICAgIHRoaXMuTV8ud18oKTtcbiAgICAgICAgfSwgdGhpcy5hYyA9IGU7XG4gICAgICAgIGNvbnN0IHQgPSBnZXREb2N1bWVudCgpO1xuICAgICAgICB0ICYmIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgdC5hZGRFdmVudExpc3RlbmVyICYmIHQuYWRkRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIiwgdGhpcy5fYyk7XG4gICAgfVxuICAgIGdldCBpc1NodXR0aW5nRG93bigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBuZXcgb3BlcmF0aW9uIHRvIHRoZSBxdWV1ZSB3aXRob3V0IHdhaXRpbmcgZm9yIGl0IHRvIGNvbXBsZXRlIChpLmUuXG4gICAgICogd2UgaWdub3JlIHRoZSBQcm9taXNlIHJlc3VsdCkuXG4gICAgICovICAgIGVucXVldWVBbmRGb3JnZXQoZSkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWZsb2F0aW5nLXByb21pc2VzXG4gICAgICAgIHRoaXMuZW5xdWV1ZShlKTtcbiAgICB9XG4gICAgZW5xdWV1ZUFuZEZvcmdldEV2ZW5XaGlsZVJlc3RyaWN0ZWQoZSkge1xuICAgICAgICB0aGlzLnVjKCksIFxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWZsb2F0aW5nLXByb21pc2VzXG4gICAgICAgIHRoaXMuY2MoZSk7XG4gICAgfVxuICAgIGVudGVyUmVzdHJpY3RlZE1vZGUoZSkge1xuICAgICAgICBpZiAoIXRoaXMuZWMpIHtcbiAgICAgICAgICAgIHRoaXMuZWMgPSAhMCwgdGhpcy5zYyA9IGUgfHwgITE7XG4gICAgICAgICAgICBjb25zdCB0ID0gZ2V0RG9jdW1lbnQoKTtcbiAgICAgICAgICAgIHQgJiYgXCJmdW5jdGlvblwiID09IHR5cGVvZiB0LnJlbW92ZUV2ZW50TGlzdGVuZXIgJiYgdC5yZW1vdmVFdmVudExpc3RlbmVyKFwidmlzaWJpbGl0eWNoYW5nZVwiLCB0aGlzLl9jKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbnF1ZXVlKGUpIHtcbiAgICAgICAgaWYgKHRoaXMudWMoKSwgdGhpcy5lYykgXG4gICAgICAgIC8vIFJldHVybiBhIFByb21pc2Ugd2hpY2ggbmV2ZXIgcmVzb2x2ZXMuXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgoKCkgPT4ge30pKTtcbiAgICAgICAgLy8gQ3JlYXRlIGEgZGVmZXJyZWQgUHJvbWlzZSB0aGF0IHdlIGNhbiByZXR1cm4gdG8gdGhlIGNhbGxlZS4gVGhpc1xuICAgICAgICAvLyBhbGxvd3MgdXMgdG8gcmV0dXJuIGEgXCJoYW5naW5nIFByb21pc2VcIiBvbmx5IHRvIHRoZSBjYWxsZWUgYW5kIHN0aWxsXG4gICAgICAgIC8vIGFkdmFuY2UgdGhlIHF1ZXVlIGV2ZW4gd2hlbiB0aGUgb3BlcmF0aW9uIGlzIG5vdCBydW4uXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IG5ldyBfX1BSSVZBVEVfRGVmZXJyZWQ7XG4gICAgICAgIHJldHVybiB0aGlzLmNjKCgoKSA9PiB0aGlzLmVjICYmIHRoaXMuc2MgPyBQcm9taXNlLnJlc29sdmUoKSA6IChlKCkudGhlbih0LnJlc29sdmUsIHQucmVqZWN0KSwgXG4gICAgICAgIHQucHJvbWlzZSkpKS50aGVuKCgoKSA9PiB0LnByb21pc2UpKTtcbiAgICB9XG4gICAgZW5xdWV1ZVJldHJ5YWJsZShlKSB7XG4gICAgICAgIHRoaXMuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gKHRoaXMuWHUucHVzaChlKSwgdGhpcy5sYygpKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSdW5zIHRoZSBuZXh0IG9wZXJhdGlvbiBmcm9tIHRoZSByZXRyeWFibGUgcXVldWUuIElmIHRoZSBvcGVyYXRpb24gZmFpbHMsXG4gICAgICogcmVzY2hlZHVsZXMgd2l0aCBiYWNrb2ZmLlxuICAgICAqLyAgICBhc3luYyBsYygpIHtcbiAgICAgICAgaWYgKDAgIT09IHRoaXMuWHUubGVuZ3RoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuWHVbMF0oKSwgdGhpcy5YdS5zaGlmdCgpLCB0aGlzLk1fLnJlc2V0KCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFfX1BSSVZBVEVfaXNJbmRleGVkRGJUcmFuc2FjdGlvbkVycm9yKGUpKSB0aHJvdyBlO1xuIC8vIEZhaWx1cmUgd2lsbCBiZSBoYW5kbGVkIGJ5IEFzeW5jUXVldWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19QUklWQVRFX2xvZ0RlYnVnKGNuLCBcIk9wZXJhdGlvbiBmYWlsZWQgd2l0aCByZXRyeWFibGUgZXJyb3I6IFwiICsgZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLlh1Lmxlbmd0aCA+IDAgJiYgXG4gICAgICAgICAgICAvLyBJZiB0aGVyZSBhcmUgYWRkaXRpb25hbCBvcGVyYXRpb25zLCB3ZSByZS1zY2hlZHVsZSBgcmV0cnlOZXh0T3AoKWAuXG4gICAgICAgICAgICAvLyBUaGlzIGlzIG5lY2Vzc2FyeSB0byBydW4gcmV0cnlhYmxlIG9wZXJhdGlvbnMgdGhhdCBmYWlsZWQgZHVyaW5nXG4gICAgICAgICAgICAvLyB0aGVpciBpbml0aWFsIGF0dGVtcHQgc2luY2Ugd2UgZG9uJ3Qga25vdyB3aGV0aGVyIHRoZXkgYXJlIGFscmVhZHlcbiAgICAgICAgICAgIC8vIGVucXVldWVkLiBJZiwgZm9yIGV4YW1wbGUsIGBvcDFgLCBgb3AyYCwgYG9wM2AgYXJlIGVucXVldWVkIGFuZCBgb3AxYFxuICAgICAgICAgICAgLy8gbmVlZHMgdG8gIGJlIHJlLXJ1biwgd2Ugd2lsbCBydW4gYG9wMWAsIGBvcDFgLCBgb3AyYCB1c2luZyB0aGVcbiAgICAgICAgICAgIC8vIGFscmVhZHkgZW5xdWV1ZWQgY2FsbHMgdG8gYHJldHJ5TmV4dE9wKClgLiBgb3AzKClgIHdpbGwgdGhlbiBydW4gaW4gdGhlXG4gICAgICAgICAgICAvLyBjYWxsIHNjaGVkdWxlZCBoZXJlLlxuICAgICAgICAgICAgLy8gU2luY2UgYGJhY2tvZmZBbmRSdW4oKWAgY2FuY2VscyBhbiBleGlzdGluZyBiYWNrb2ZmIGFuZCBzY2hlZHVsZXMgYVxuICAgICAgICAgICAgLy8gbmV3IGJhY2tvZmYgb24gZXZlcnkgY2FsbCwgdGhlcmUgaXMgb25seSBldmVyIGEgc2luZ2xlIGFkZGl0aW9uYWxcbiAgICAgICAgICAgIC8vIG9wZXJhdGlvbiBpbiB0aGUgcXVldWUuXG4gICAgICAgICAgICB0aGlzLk1fLnBfKCgoKSA9PiB0aGlzLmxjKCkpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjYyhlKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmFjLnRoZW4oKCgpID0+ICh0aGlzLnJjID0gITAsIGUoKS5jYXRjaCgoZSA9PiB7XG4gICAgICAgICAgICB0aGlzLm5jID0gZSwgdGhpcy5yYyA9ICExO1xuICAgICAgICAgICAgLy8gUmUtdGhyb3cgdGhlIGVycm9yIHNvIHRoYXQgdGhpcy50YWlsIGJlY29tZXMgYSByZWplY3RlZCBQcm9taXNlIGFuZFxuICAgICAgICAgICAgLy8gYWxsIGZ1cnRoZXIgYXR0ZW1wdHMgdG8gY2hhaW4gKHZpYSAudGhlbikgd2lsbCBqdXN0IHNob3J0LWNpcmN1aXRcbiAgICAgICAgICAgIC8vIGFuZCByZXR1cm4gdGhlIHJlamVjdGVkIFByb21pc2UuXG4gICAgICAgICAgICB0aHJvdyBfX1BSSVZBVEVfbG9nRXJyb3IoXCJJTlRFUk5BTCBVTkhBTkRMRUQgRVJST1I6IFwiLCBfX1BSSVZBVEVfZ2V0TWVzc2FnZU9yU3RhY2soZSkpLCBcbiAgICAgICAgICAgIGU7XG4gICAgICAgIH0pKS50aGVuKChlID0+ICh0aGlzLnJjID0gITEsIGUpKSkpKSk7XG4gICAgICAgIHJldHVybiB0aGlzLmFjID0gdCwgdDtcbiAgICB9XG4gICAgZW5xdWV1ZUFmdGVyRGVsYXkoZSwgdCwgbikge1xuICAgICAgICB0aGlzLnVjKCksIFxuICAgICAgICAvLyBGYXN0LWZvcndhcmQgZGVsYXlzIGZvciB0aW1lcklkcyB0aGF0IGhhdmUgYmVlbiBvdmVycmlkZGVuLlxuICAgICAgICB0aGlzLm9jLmluZGV4T2YoZSkgPiAtMSAmJiAodCA9IDApO1xuICAgICAgICBjb25zdCByID0gRGVsYXllZE9wZXJhdGlvbi5jcmVhdGVBbmRTY2hlZHVsZSh0aGlzLCBlLCB0LCBuLCAoZSA9PiB0aGlzLmhjKGUpKSk7XG4gICAgICAgIHJldHVybiB0aGlzLnRjLnB1c2gociksIHI7XG4gICAgfVxuICAgIHVjKCkge1xuICAgICAgICB0aGlzLm5jICYmIGZhaWwoNDcxMjUsIHtcbiAgICAgICAgICAgIFBjOiBfX1BSSVZBVEVfZ2V0TWVzc2FnZU9yU3RhY2sodGhpcy5uYylcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHZlcmlmeU9wZXJhdGlvbkluUHJvZ3Jlc3MoKSB7fVxuICAgIC8qKlxuICAgICAqIFdhaXRzIHVudGlsIGFsbCBjdXJyZW50bHkgcXVldWVkIHRhc2tzIGFyZSBmaW5pc2hlZCBleGVjdXRpbmcuIERlbGF5ZWRcbiAgICAgKiBvcGVyYXRpb25zIGFyZSBub3QgcnVuLlxuICAgICAqLyAgICBhc3luYyBUYygpIHtcbiAgICAgICAgLy8gT3BlcmF0aW9ucyBpbiB0aGUgcXVldWUgcHJpb3IgdG8gZHJhaW5pbmcgbWF5IGhhdmUgZW5xdWV1ZWQgYWRkaXRpb25hbFxuICAgICAgICAvLyBvcGVyYXRpb25zLiBLZWVwIGRyYWluaW5nIHRoZSBxdWV1ZSB1bnRpbCB0aGUgdGFpbCBpcyBubyBsb25nZXIgYWR2YW5jZWQsXG4gICAgICAgIC8vIHdoaWNoIGluZGljYXRlcyB0aGF0IG5vIG1vcmUgbmV3IG9wZXJhdGlvbnMgd2VyZSBlbnF1ZXVlZCBhbmQgdGhhdCBhbGxcbiAgICAgICAgLy8gb3BlcmF0aW9ucyB3ZXJlIGV4ZWN1dGVkLlxuICAgICAgICBsZXQgZTtcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgZSA9IHRoaXMuYWMsIGF3YWl0IGU7XG4gICAgICAgIH0gd2hpbGUgKGUgIT09IHRoaXMuYWMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGb3IgVGVzdHM6IERldGVybWluZSBpZiBhIGRlbGF5ZWQgb3BlcmF0aW9uIHdpdGggYSBwYXJ0aWN1bGFyIFRpbWVySWRcbiAgICAgKiBleGlzdHMuXG4gICAgICovICAgIEljKGUpIHtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMudGMpIGlmICh0LnRpbWVySWQgPT09IGUpIHJldHVybiAhMDtcbiAgICAgICAgcmV0dXJuICExO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGb3IgVGVzdHM6IFJ1bnMgc29tZSBvciBhbGwgZGVsYXllZCBvcGVyYXRpb25zIGVhcmx5LlxuICAgICAqXG4gICAgICogQHBhcmFtIGxhc3RUaW1lcklkIC0gRGVsYXllZCBvcGVyYXRpb25zIHVwIHRvIGFuZCBpbmNsdWRpbmcgdGhpcyBUaW1lcklkXG4gICAgICogd2lsbCBiZSBkcmFpbmVkLiBQYXNzIFRpbWVySWQuQWxsIHRvIHJ1biBhbGwgZGVsYXllZCBvcGVyYXRpb25zLlxuICAgICAqIEByZXR1cm5zIGEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIG9uY2UgYWxsIG9wZXJhdGlvbnMgaGF2ZSBiZWVuIHJ1bi5cbiAgICAgKi8gICAgRWMoZSkge1xuICAgICAgICAvLyBOb3RlIHRoYXQgZHJhaW5pbmcgbWF5IGdlbmVyYXRlIG1vcmUgZGVsYXllZCBvcHMsIHNvIHdlIGRvIHRoYXQgZmlyc3QuXG4gICAgICAgIHJldHVybiB0aGlzLlRjKCkudGhlbigoKCkgPT4ge1xuICAgICAgICAgICAgLy8gUnVuIG9wcyBpbiB0aGUgc2FtZSBvcmRlciB0aGV5J2QgcnVuIGlmIHRoZXkgcmFuIG5hdHVyYWxseS5cbiAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXMgKi9cbiAgICAgICAgICAgIHRoaXMudGMuc29ydCgoKGUsIHQpID0+IGUudGFyZ2V0VGltZU1zIC0gdC50YXJnZXRUaW1lTXMpKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLnRjKSBpZiAodC5za2lwRGVsYXkoKSwgXCJhbGxcIiAvKiBUaW1lcklkLkFsbCAqLyAhPT0gZSAmJiB0LnRpbWVySWQgPT09IGUpIGJyZWFrO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuVGMoKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGb3IgVGVzdHM6IFNraXAgYWxsIHN1YnNlcXVlbnQgZGVsYXlzIGZvciBhIHRpbWVyIGlkLlxuICAgICAqLyAgICBkYyhlKSB7XG4gICAgICAgIHRoaXMub2MucHVzaChlKTtcbiAgICB9XG4gICAgLyoqIENhbGxlZCBvbmNlIGEgRGVsYXllZE9wZXJhdGlvbiBpcyBydW4gb3IgY2FuY2VsZWQuICovICAgIGhjKGUpIHtcbiAgICAgICAgLy8gTk9URTogaW5kZXhPZiAvIHNsaWNlIGFyZSBPKG4pLCBidXQgZGVsYXllZE9wZXJhdGlvbnMgaXMgZXhwZWN0ZWQgdG8gYmUgc21hbGwuXG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLnRjLmluZGV4T2YoZSk7XG4gICAgICAgIC8qIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXMgKi8gICAgICAgIHRoaXMudGMuc3BsaWNlKHQsIDEpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDaHJvbWUgaW5jbHVkZXMgRXJyb3IubWVzc2FnZSBpbiBFcnJvci5zdGFjay4gT3RoZXIgYnJvd3NlcnMgZG8gbm90LlxuICogVGhpcyByZXR1cm5zIGV4cGVjdGVkIG91dHB1dCBvZiBtZXNzYWdlICsgc3RhY2sgd2hlbiBhdmFpbGFibGUuXG4gKiBAcGFyYW0gZXJyb3IgLSBFcnJvciBvciBGaXJlc3RvcmVFcnJvclxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9nZXRNZXNzYWdlT3JTdGFjayhlKSB7XG4gICAgbGV0IHQgPSBlLm1lc3NhZ2UgfHwgXCJcIjtcbiAgICByZXR1cm4gZS5zdGFjayAmJiAodCA9IGUuc3RhY2suaW5jbHVkZXMoZS5tZXNzYWdlKSA/IGUuc3RhY2sgOiBlLm1lc3NhZ2UgKyBcIlxcblwiICsgZS5zdGFjayksIFxuICAgIHQ7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9pc1BhcnRpYWxPYnNlcnZlcihlKSB7XG4gICAgLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgb2JqIGlzIGFuIG9iamVjdCBhbmQgY29udGFpbnMgYXQgbGVhc3Qgb25lIG9mIHRoZSBzcGVjaWZpZWRcbiAqIG1ldGhvZHMuXG4gKi9cbiAgICByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX2ltcGxlbWVudHNBbnlNZXRob2RzKGUsIHQpIHtcbiAgICAgICAgaWYgKFwib2JqZWN0XCIgIT0gdHlwZW9mIGUgfHwgbnVsbCA9PT0gZSkgcmV0dXJuICExO1xuICAgICAgICBjb25zdCBuID0gZTtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIHQpIGlmIChlIGluIG4gJiYgXCJmdW5jdGlvblwiID09IHR5cGVvZiBuW2VdKSByZXR1cm4gITA7XG4gICAgICAgIHJldHVybiAhMTtcbiAgICB9XG4gICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbiAgICAvKipcbiAqIFJlcHJlc2VudHMgdGhlIHRhc2sgb2YgbG9hZGluZyBhIEZpcmVzdG9yZSBidW5kbGUuIEl0IHByb3ZpZGVzIHByb2dyZXNzIG9mIGJ1bmRsZVxuICogbG9hZGluZywgYXMgd2VsbCBhcyB0YXNrIGNvbXBsZXRpb24gYW5kIGVycm9yIGV2ZW50cy5cbiAqXG4gKiBUaGUgQVBJIGlzIGNvbXBhdGlibGUgd2l0aCBgUHJvbWlzZTxMb2FkQnVuZGxlVGFza1Byb2dyZXNzPmAuXG4gKi8gKGUsIFsgXCJuZXh0XCIsIFwiZXJyb3JcIiwgXCJjb21wbGV0ZVwiIF0pO1xufVxuXG5jbGFzcyBMb2FkQnVuZGxlVGFzayB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuX3Byb2dyZXNzT2JzZXJ2ZXIgPSB7fSwgdGhpcy5fdGFza0NvbXBsZXRpb25SZXNvbHZlciA9IG5ldyBfX1BSSVZBVEVfRGVmZXJyZWQsIFxuICAgICAgICB0aGlzLl9sYXN0UHJvZ3Jlc3MgPSB7XG4gICAgICAgICAgICB0YXNrU3RhdGU6IFwiUnVubmluZ1wiLFxuICAgICAgICAgICAgdG90YWxCeXRlczogMCxcbiAgICAgICAgICAgIHRvdGFsRG9jdW1lbnRzOiAwLFxuICAgICAgICAgICAgYnl0ZXNMb2FkZWQ6IDAsXG4gICAgICAgICAgICBkb2N1bWVudHNMb2FkZWQ6IDBcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVnaXN0ZXJzIGZ1bmN0aW9ucyB0byBsaXN0ZW4gdG8gYnVuZGxlIGxvYWRpbmcgcHJvZ3Jlc3MgZXZlbnRzLlxuICAgICAqIEBwYXJhbSBuZXh0IC0gQ2FsbGVkIHdoZW4gdGhlcmUgaXMgYSBwcm9ncmVzcyB1cGRhdGUgZnJvbSBidW5kbGUgbG9hZGluZy4gVHlwaWNhbGx5IGBuZXh0YCBjYWxscyBvY2N1clxuICAgICAqICAgZWFjaCB0aW1lIGEgRmlyZXN0b3JlIGRvY3VtZW50IGlzIGxvYWRlZCBmcm9tIHRoZSBidW5kbGUuXG4gICAgICogQHBhcmFtIGVycm9yIC0gQ2FsbGVkIHdoZW4gYW4gZXJyb3Igb2NjdXJzIGR1cmluZyBidW5kbGUgbG9hZGluZy4gVGhlIHRhc2sgYWJvcnRzIGFmdGVyIHJlcG9ydGluZyB0aGVcbiAgICAgKiAgIGVycm9yLCBhbmQgdGhlcmUgc2hvdWxkIGJlIG5vIG1vcmUgdXBkYXRlcyBhZnRlciB0aGlzLlxuICAgICAqIEBwYXJhbSBjb21wbGV0ZSAtIENhbGxlZCB3aGVuIHRoZSBsb2FkaW5nIHRhc2sgaXMgY29tcGxldGUuXG4gICAgICovICAgIG9uUHJvZ3Jlc3MoZSwgdCwgbikge1xuICAgICAgICB0aGlzLl9wcm9ncmVzc09ic2VydmVyID0ge1xuICAgICAgICAgICAgbmV4dDogZSxcbiAgICAgICAgICAgIGVycm9yOiB0LFxuICAgICAgICAgICAgY29tcGxldGU6IG5cbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW1wbGVtZW50cyB0aGUgYFByb21pc2U8TG9hZEJ1bmRsZVRhc2tQcm9ncmVzcz4uY2F0Y2hgIGludGVyZmFjZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvblJlamVjdGVkIC0gQ2FsbGVkIHdoZW4gYW4gZXJyb3Igb2NjdXJzIGR1cmluZyBidW5kbGUgbG9hZGluZy5cbiAgICAgKi8gICAgY2F0Y2goZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdGFza0NvbXBsZXRpb25SZXNvbHZlci5wcm9taXNlLmNhdGNoKGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbXBsZW1lbnRzIHRoZSBgUHJvbWlzZTxMb2FkQnVuZGxlVGFza1Byb2dyZXNzPi50aGVuYCBpbnRlcmZhY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb25GdWxmaWxsZWQgLSBDYWxsZWQgb24gdGhlIGNvbXBsZXRpb24gb2YgdGhlIGxvYWRpbmcgdGFzayB3aXRoIGEgZmluYWwgYExvYWRCdW5kbGVUYXNrUHJvZ3Jlc3NgIHVwZGF0ZS5cbiAgICAgKiAgIFRoZSB1cGRhdGUgd2lsbCBhbHdheXMgaGF2ZSBpdHMgYHRhc2tTdGF0ZWAgc2V0IHRvIGBcIlN1Y2Nlc3NcImAuXG4gICAgICogQHBhcmFtIG9uUmVqZWN0ZWQgLSBDYWxsZWQgd2hlbiBhbiBlcnJvciBvY2N1cnMgZHVyaW5nIGJ1bmRsZSBsb2FkaW5nLlxuICAgICAqLyAgICB0aGVuKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Rhc2tDb21wbGV0aW9uUmVzb2x2ZXIucHJvbWlzZS50aGVuKGUsIHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBOb3RpZmllcyBhbGwgb2JzZXJ2ZXJzIHRoYXQgYnVuZGxlIGxvYWRpbmcgaGFzIGNvbXBsZXRlZCwgd2l0aCBhIHByb3ZpZGVkXG4gICAgICogYExvYWRCdW5kbGVUYXNrUHJvZ3Jlc3NgIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovICAgIF9jb21wbGV0ZVdpdGgoZSkge1xuICAgICAgICB0aGlzLl91cGRhdGVQcm9ncmVzcyhlKSwgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlci5jb21wbGV0ZSAmJiB0aGlzLl9wcm9ncmVzc09ic2VydmVyLmNvbXBsZXRlKCksIFxuICAgICAgICB0aGlzLl90YXNrQ29tcGxldGlvblJlc29sdmVyLnJlc29sdmUoZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE5vdGlmaWVzIGFsbCBvYnNlcnZlcnMgdGhhdCBidW5kbGUgbG9hZGluZyBoYXMgZmFpbGVkLCB3aXRoIGEgcHJvdmlkZWRcbiAgICAgKiBgRXJyb3JgIGFzIHRoZSByZWFzb24uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqLyAgICBfZmFpbFdpdGgoZSkge1xuICAgICAgICB0aGlzLl9sYXN0UHJvZ3Jlc3MudGFza1N0YXRlID0gXCJFcnJvclwiLCB0aGlzLl9wcm9ncmVzc09ic2VydmVyLm5leHQgJiYgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlci5uZXh0KHRoaXMuX2xhc3RQcm9ncmVzcyksIFxuICAgICAgICB0aGlzLl9wcm9ncmVzc09ic2VydmVyLmVycm9yICYmIHRoaXMuX3Byb2dyZXNzT2JzZXJ2ZXIuZXJyb3IoZSksIHRoaXMuX3Rhc2tDb21wbGV0aW9uUmVzb2x2ZXIucmVqZWN0KGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBOb3RpZmllcyBhIHByb2dyZXNzIHVwZGF0ZSBvZiBsb2FkaW5nIGEgYnVuZGxlLlxuICAgICAqIEBwYXJhbSBwcm9ncmVzcyAtIFRoZSBuZXcgcHJvZ3Jlc3MuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqLyAgICBfdXBkYXRlUHJvZ3Jlc3MoZSkge1xuICAgICAgICB0aGlzLl9sYXN0UHJvZ3Jlc3MgPSBlLCB0aGlzLl9wcm9ncmVzc09ic2VydmVyLm5leHQgJiYgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlci5uZXh0KGUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQ29uc3RhbnQgdXNlZCB0byBpbmRpY2F0ZSB0aGUgTFJVIGdhcmJhZ2UgY29sbGVjdGlvbiBzaG91bGQgYmUgZGlzYWJsZWQuXG4gKiBTZXQgdGhpcyB2YWx1ZSBhcyB0aGUgYGNhY2hlU2l6ZUJ5dGVzYCBvbiB0aGUgc2V0dGluZ3MgcGFzc2VkIHRvIHRoZVxuICoge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UuXG4gKi8gY29uc3QgbG4gPSAtMTtcblxuLyoqXG4gKiBUaGUgQ2xvdWQgRmlyZXN0b3JlIHNlcnZpY2UgaW50ZXJmYWNlLlxuICpcbiAqIERvIG5vdCBjYWxsIHRoaXMgY29uc3RydWN0b3IgZGlyZWN0bHkuIEluc3RlYWQsIHVzZSB7QGxpbmsgKGdldEZpcmVzdG9yZToxKX0uXG4gKi8gY2xhc3MgRmlyZXN0b3JlIGV4dGVuZHMgRmlyZXN0b3JlJDEge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IoZSwgdCwgbiwgcikge1xuICAgICAgICBzdXBlcihlLCB0LCBuLCByKSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGV0aGVyIGl0J3MgYSB7QGxpbmsgRmlyZXN0b3JlfSBvciBGaXJlc3RvcmUgTGl0ZSBpbnN0YW5jZS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudHlwZSA9IFwiZmlyZXN0b3JlXCIsIHRoaXMuX3F1ZXVlID0gbmV3IF9fUFJJVkFURV9Bc3luY1F1ZXVlSW1wbCwgdGhpcy5fcGVyc2lzdGVuY2VLZXkgPSByPy5uYW1lIHx8IFwiW0RFRkFVTFRdXCI7XG4gICAgfVxuICAgIGFzeW5jIF90ZXJtaW5hdGUoKSB7XG4gICAgICAgIGlmICh0aGlzLl9maXJlc3RvcmVDbGllbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLl9maXJlc3RvcmVDbGllbnQudGVybWluYXRlKCk7XG4gICAgICAgICAgICB0aGlzLl9xdWV1ZSA9IG5ldyBfX1BSSVZBVEVfQXN5bmNRdWV1ZUltcGwoZSksIHRoaXMuX2ZpcmVzdG9yZUNsaWVudCA9IHZvaWQgMCwgYXdhaXQgZTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLyoqXG4gKiBJbml0aWFsaXplcyBhIG5ldyBpbnN0YW5jZSBvZiB7QGxpbmsgRmlyZXN0b3JlfSB3aXRoIHRoZSBwcm92aWRlZCBzZXR0aW5ncy5cbiAqIENhbiBvbmx5IGJlIGNhbGxlZCBiZWZvcmUgYW55IG90aGVyIGZ1bmN0aW9uLCBpbmNsdWRpbmdcbiAqIHtAbGluayAoZ2V0RmlyZXN0b3JlOjEpfS4gSWYgdGhlIGN1c3RvbSBzZXR0aW5ncyBhcmUgZW1wdHksIHRoaXMgZnVuY3Rpb24gaXNcbiAqIGVxdWl2YWxlbnQgdG8gY2FsbGluZyB7QGxpbmsgKGdldEZpcmVzdG9yZToxKX0uXG4gKlxuICogQHBhcmFtIGFwcCAtIFRoZSB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZUFwcH0gd2l0aCB3aGljaCB0aGUge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2Ugd2lsbFxuICogYmUgYXNzb2NpYXRlZC5cbiAqIEBwYXJhbSBzZXR0aW5ncyAtIEEgc2V0dGluZ3Mgb2JqZWN0IHRvIGNvbmZpZ3VyZSB0aGUge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gZGF0YWJhc2VJZCAtIFRoZSBuYW1lIG9mIHRoZSBkYXRhYmFzZS5cbiAqIEByZXR1cm5zIEEgbmV3bHkgaW5pdGlhbGl6ZWQge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UuXG4gKi8gZnVuY3Rpb24gaW5pdGlhbGl6ZUZpcmVzdG9yZShlLCB0LCBuKSB7XG4gICAgbiB8fCAobiA9IGx0KTtcbiAgICBjb25zdCByID0gX2dldFByb3ZpZGVyKGUsIFwiZmlyZXN0b3JlXCIpO1xuICAgIGlmIChyLmlzSW5pdGlhbGl6ZWQobikpIHtcbiAgICAgICAgY29uc3QgZSA9IHIuZ2V0SW1tZWRpYXRlKHtcbiAgICAgICAgICAgIGlkZW50aWZpZXI6IG5cbiAgICAgICAgfSksIGkgPSByLmdldE9wdGlvbnMobik7XG4gICAgICAgIGlmIChkZWVwRXF1YWwoaSwgdCkpIHJldHVybiBlO1xuICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5GQUlMRURfUFJFQ09ORElUSU9OLCBcImluaXRpYWxpemVGaXJlc3RvcmUoKSBoYXMgYWxyZWFkeSBiZWVuIGNhbGxlZCB3aXRoIGRpZmZlcmVudCBvcHRpb25zLiBUbyBhdm9pZCB0aGlzIGVycm9yLCBjYWxsIGluaXRpYWxpemVGaXJlc3RvcmUoKSB3aXRoIHRoZSBzYW1lIG9wdGlvbnMgYXMgd2hlbiBpdCB3YXMgb3JpZ2luYWxseSBjYWxsZWQsIG9yIGNhbGwgZ2V0RmlyZXN0b3JlKCkgdG8gcmV0dXJuIHRoZSBhbHJlYWR5IGluaXRpYWxpemVkIGluc3RhbmNlLlwiKTtcbiAgICB9XG4gICAgaWYgKHZvaWQgMCAhPT0gdC5jYWNoZVNpemVCeXRlcyAmJiB2b2lkIDAgIT09IHQubG9jYWxDYWNoZSkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgXCJjYWNoZSBhbmQgY2FjaGVTaXplQnl0ZXMgY2Fubm90IGJlIHNwZWNpZmllZCBhdCB0aGUgc2FtZSB0aW1lIGFzIGNhY2hlU2l6ZUJ5dGVzIHdpbGxiZSBkZXByZWNhdGVkLiBJbnN0ZWFkLCBzcGVjaWZ5IHRoZSBjYWNoZSBzaXplIGluIHRoZSBjYWNoZSBvYmplY3RcIik7XG4gICAgaWYgKHZvaWQgMCAhPT0gdC5jYWNoZVNpemVCeXRlcyAmJiAtMSAhPT0gdC5jYWNoZVNpemVCeXRlcyAmJiB0LmNhY2hlU2l6ZUJ5dGVzIDwgQnQpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIFwiY2FjaGVTaXplQnl0ZXMgbXVzdCBiZSBhdCBsZWFzdCAxMDQ4NTc2XCIpO1xuICAgIC8vIFdvcmthcm91bmQgdG8gZ2V0IGNvb2tpZXMgaW4gRmlyZWJhc2UgU3R1ZGlvXG4gICAgICAgIHJldHVybiB0Lmhvc3QgJiYgaXNDbG91ZFdvcmtzdGF0aW9uKHQuaG9zdCkgJiYgcGluZ1NlcnZlcih0Lmhvc3QpLCByLmluaXRpYWxpemUoe1xuICAgICAgICBvcHRpb25zOiB0LFxuICAgICAgICBpbnN0YW5jZUlkZW50aWZpZXI6IG5cbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gZ2V0RmlyZXN0b3JlKGUsIG4pIHtcbiAgICBjb25zdCByID0gXCJvYmplY3RcIiA9PSB0eXBlb2YgZSA/IGUgOiBnZXRBcHAoKSwgaSA9IFwic3RyaW5nXCIgPT0gdHlwZW9mIGUgPyBlIDogbiB8fCBsdCwgcyA9IF9nZXRQcm92aWRlcihyLCBcImZpcmVzdG9yZVwiKS5nZXRJbW1lZGlhdGUoe1xuICAgICAgICBpZGVudGlmaWVyOiBpXG4gICAgfSk7XG4gICAgaWYgKCFzLl9pbml0aWFsaXplZCkge1xuICAgICAgICBjb25zdCBlID0gZ2V0RGVmYXVsdEVtdWxhdG9ySG9zdG5hbWVBbmRQb3J0KFwiZmlyZXN0b3JlXCIpO1xuICAgICAgICBlICYmIGNvbm5lY3RGaXJlc3RvcmVFbXVsYXRvcihzLCAuLi5lKTtcbiAgICB9XG4gICAgcmV0dXJuIHM7XG59XG5cbi8qKlxuICogQGludGVybmFsXG4gKi8gZnVuY3Rpb24gZW5zdXJlRmlyZXN0b3JlQ29uZmlndXJlZChlKSB7XG4gICAgaWYgKGUuX3Rlcm1pbmF0ZWQpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiVGhlIGNsaWVudCBoYXMgYWxyZWFkeSBiZWVuIHRlcm1pbmF0ZWQuXCIpO1xuICAgIHJldHVybiBlLl9maXJlc3RvcmVDbGllbnQgfHwgX19QUklWQVRFX2NvbmZpZ3VyZUZpcmVzdG9yZShlKSwgZS5fZmlyZXN0b3JlQ2xpZW50O1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfY29uZmlndXJlRmlyZXN0b3JlKGUpIHtcbiAgICBjb25zdCB0ID0gZS5fZnJlZXplU2V0dGluZ3MoKSwgbiA9IGZ1bmN0aW9uIF9fUFJJVkFURV9tYWtlRGF0YWJhc2VJbmZvKGUsIHQsIG4sIHIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRhYmFzZUluZm8oZSwgdCwgbiwgci5ob3N0LCByLnNzbCwgci5leHBlcmltZW50YWxGb3JjZUxvbmdQb2xsaW5nLCByLmV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZywgX19QUklWQVRFX2Nsb25lTG9uZ1BvbGxpbmdPcHRpb25zKHIuZXhwZXJpbWVudGFsTG9uZ1BvbGxpbmdPcHRpb25zKSwgci51c2VGZXRjaFN0cmVhbXMsIHIuaXNVc2luZ0VtdWxhdG9yKTtcbiAgICB9KGUuX2RhdGFiYXNlSWQsIGUuX2FwcD8ub3B0aW9ucy5hcHBJZCB8fCBcIlwiLCBlLl9wZXJzaXN0ZW5jZUtleSwgdCk7XG4gICAgZS5fY29tcG9uZW50c1Byb3ZpZGVyIHx8IHQubG9jYWxDYWNoZT8uX29mZmxpbmVDb21wb25lbnRQcm92aWRlciAmJiB0LmxvY2FsQ2FjaGU/Ll9vbmxpbmVDb21wb25lbnRQcm92aWRlciAmJiAoZS5fY29tcG9uZW50c1Byb3ZpZGVyID0ge1xuICAgICAgICBfb2ZmbGluZTogdC5sb2NhbENhY2hlLl9vZmZsaW5lQ29tcG9uZW50UHJvdmlkZXIsXG4gICAgICAgIF9vbmxpbmU6IHQubG9jYWxDYWNoZS5fb25saW5lQ29tcG9uZW50UHJvdmlkZXJcbiAgICB9KSwgZS5fZmlyZXN0b3JlQ2xpZW50ID0gbmV3IEZpcmVzdG9yZUNsaWVudChlLl9hdXRoQ3JlZGVudGlhbHMsIGUuX2FwcENoZWNrQ3JlZGVudGlhbHMsIGUuX3F1ZXVlLCBuLCBlLl9jb21wb25lbnRzUHJvdmlkZXIgJiYgZnVuY3Rpb24gX19QUklWQVRFX2J1aWxkQ29tcG9uZW50UHJvdmlkZXIoZSkge1xuICAgICAgICBjb25zdCB0ID0gZT8uX29ubGluZS5idWlsZCgpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgX29mZmxpbmU6IGU/Ll9vZmZsaW5lLmJ1aWxkKHQpLFxuICAgICAgICAgICAgX29ubGluZTogdFxuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAqIEF0dGVtcHRzIHRvIGVuYWJsZSBwZXJzaXN0ZW50IHN0b3JhZ2UsIGlmIHBvc3NpYmxlLlxuICpcbiAqIE9uIGZhaWx1cmUsIGBlbmFibGVJbmRleGVkRGJQZXJzaXN0ZW5jZSgpYCB3aWxsIHJlamVjdCB0aGUgcHJvbWlzZSBvclxuICogdGhyb3cgYW4gZXhjZXB0aW9uLiBUaGVyZSBhcmUgc2V2ZXJhbCByZWFzb25zIHdoeSB0aGlzIGNhbiBmYWlsLCB3aGljaCBjYW4gYmVcbiAqIGlkZW50aWZpZWQgYnkgdGhlIGBjb2RlYCBvbiB0aGUgZXJyb3IuXG4gKlxuICogICAqIGZhaWxlZC1wcmVjb25kaXRpb246IFRoZSBhcHAgaXMgYWxyZWFkeSBvcGVuIGluIGFub3RoZXIgYnJvd3NlciB0YWIuXG4gKiAgICogdW5pbXBsZW1lbnRlZDogVGhlIGJyb3dzZXIgaXMgaW5jb21wYXRpYmxlIHdpdGggdGhlIG9mZmxpbmUgcGVyc2lzdGVuY2VcbiAqICAgICBpbXBsZW1lbnRhdGlvbi5cbiAqXG4gKiBOb3RlIHRoYXQgZXZlbiBhZnRlciBhIGZhaWx1cmUsIHRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB3aWxsIHJlbWFpblxuICogdXNhYmxlLCBob3dldmVyIG9mZmxpbmUgcGVyc2lzdGVuY2Ugd2lsbCBiZSBkaXNhYmxlZC5cbiAqXG4gKiBOb3RlOiBgZW5hYmxlSW5kZXhlZERiUGVyc2lzdGVuY2UoKWAgbXVzdCBiZSBjYWxsZWQgYmVmb3JlIGFueSBvdGhlciBmdW5jdGlvbnNcbiAqIChvdGhlciB0aGFuIHtAbGluayBpbml0aWFsaXplRmlyZXN0b3JlfSwge0BsaW5rIChnZXRGaXJlc3RvcmU6MSl9IG9yXG4gKiB7QGxpbmsgY2xlYXJJbmRleGVkRGJQZXJzaXN0ZW5jZX0uXG4gKlxuICogUGVyc2lzdGVuY2UgY2Fubm90IGJlIHVzZWQgaW4gYSBOb2RlLmpzIGVudmlyb25tZW50LlxuICpcbiAqIEBwYXJhbSBmaXJlc3RvcmUgLSBUaGUge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UgdG8gZW5hYmxlIHBlcnNpc3RlbmNlIGZvci5cbiAqIEBwYXJhbSBwZXJzaXN0ZW5jZVNldHRpbmdzIC0gT3B0aW9uYWwgc2V0dGluZ3Mgb2JqZWN0IHRvIGNvbmZpZ3VyZVxuICogcGVyc2lzdGVuY2UuXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IHJlcHJlc2VudHMgc3VjY2Vzc2Z1bGx5IGVuYWJsaW5nIHBlcnNpc3RlbnQgc3RvcmFnZS5cbiAqIEBkZXByZWNhdGVkIFRoaXMgZnVuY3Rpb24gd2lsbCBiZSByZW1vdmVkIGluIGEgZnV0dXJlIG1ham9yIHJlbGVhc2UuIEluc3RlYWQsIHNldFxuICogYEZpcmVzdG9yZVNldHRpbmdzLmxvY2FsQ2FjaGVgIHRvIGFuIGluc3RhbmNlIG9mIGBQZXJzaXN0ZW50TG9jYWxDYWNoZWAgdG9cbiAqIHR1cm4gb24gSW5kZXhlZERiIGNhY2hlLiBDYWxsaW5nIHRoaXMgZnVuY3Rpb24gd2hlbiBgRmlyZXN0b3JlU2V0dGluZ3MubG9jYWxDYWNoZWBcbiAqIGlzIGFscmVhZHkgc3BlY2lmaWVkIHdpbGwgdGhyb3cgYW4gZXhjZXB0aW9uLlxuICovIChlLl9jb21wb25lbnRzUHJvdmlkZXIpKTtcbn1cblxuZnVuY3Rpb24gZW5hYmxlSW5kZXhlZERiUGVyc2lzdGVuY2UoZSwgdCkge1xuICAgIF9fUFJJVkFURV9sb2dXYXJuKFwiZW5hYmxlSW5kZXhlZERiUGVyc2lzdGVuY2UoKSB3aWxsIGJlIGRlcHJlY2F0ZWQgaW4gdGhlIGZ1dHVyZSwgeW91IGNhbiB1c2UgYEZpcmVzdG9yZVNldHRpbmdzLmNhY2hlYCBpbnN0ZWFkLlwiKTtcbiAgICBjb25zdCBuID0gZS5fZnJlZXplU2V0dGluZ3MoKTtcbiAgICByZXR1cm4gX19QUklWQVRFX3NldFBlcnNpc3RlbmNlUHJvdmlkZXJzKGUsIE9ubGluZUNvbXBvbmVudFByb3ZpZGVyLnByb3ZpZGVyLCB7XG4gICAgICAgIGJ1aWxkOiBlID0+IG5ldyBfX1BSSVZBVEVfSW5kZXhlZERiT2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyKGUsIG4uY2FjaGVTaXplQnl0ZXMsIHQ/LmZvcmNlT3duZXJzaGlwKVxuICAgIH0pLCBQcm9taXNlLnJlc29sdmUoKTtcbn1cblxuLyoqXG4gKiBBdHRlbXB0cyB0byBlbmFibGUgbXVsdGktdGFiIHBlcnNpc3RlbnQgc3RvcmFnZSwgaWYgcG9zc2libGUuIElmIGVuYWJsZWRcbiAqIGFjcm9zcyBhbGwgdGFicywgYWxsIG9wZXJhdGlvbnMgc2hhcmUgYWNjZXNzIHRvIGxvY2FsIHBlcnNpc3RlbmNlLCBpbmNsdWRpbmdcbiAqIHNoYXJlZCBleGVjdXRpb24gb2YgcXVlcmllcyBhbmQgbGF0ZW5jeS1jb21wZW5zYXRlZCBsb2NhbCBkb2N1bWVudCB1cGRhdGVzXG4gKiBhY3Jvc3MgYWxsIGNvbm5lY3RlZCBpbnN0YW5jZXMuXG4gKlxuICogT24gZmFpbHVyZSwgYGVuYWJsZU11bHRpVGFiSW5kZXhlZERiUGVyc2lzdGVuY2UoKWAgd2lsbCByZWplY3QgdGhlIHByb21pc2Ugb3JcbiAqIHRocm93IGFuIGV4Y2VwdGlvbi4gVGhlcmUgYXJlIHNldmVyYWwgcmVhc29ucyB3aHkgdGhpcyBjYW4gZmFpbCwgd2hpY2ggY2FuIGJlXG4gKiBpZGVudGlmaWVkIGJ5IHRoZSBgY29kZWAgb24gdGhlIGVycm9yLlxuICpcbiAqICAgKiBmYWlsZWQtcHJlY29uZGl0aW9uOiBUaGUgYXBwIGlzIGFscmVhZHkgb3BlbiBpbiBhbm90aGVyIGJyb3dzZXIgdGFiIGFuZFxuICogICAgIG11bHRpLXRhYiBpcyBub3QgZW5hYmxlZC5cbiAqICAgKiB1bmltcGxlbWVudGVkOiBUaGUgYnJvd3NlciBpcyBpbmNvbXBhdGlibGUgd2l0aCB0aGUgb2ZmbGluZSBwZXJzaXN0ZW5jZVxuICogICAgIGltcGxlbWVudGF0aW9uLlxuICpcbiAqIE5vdGUgdGhhdCBldmVuIGFmdGVyIGEgZmFpbHVyZSwgdGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIHdpbGwgcmVtYWluXG4gKiB1c2FibGUsIGhvd2V2ZXIgb2ZmbGluZSBwZXJzaXN0ZW5jZSB3aWxsIGJlIGRpc2FibGVkLlxuICpcbiAqIEBwYXJhbSBmaXJlc3RvcmUgLSBUaGUge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UgdG8gZW5hYmxlIHBlcnNpc3RlbmNlIGZvci5cbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgcmVwcmVzZW50cyBzdWNjZXNzZnVsbHkgZW5hYmxpbmcgcGVyc2lzdGVudFxuICogc3RvcmFnZS5cbiAqIEBkZXByZWNhdGVkIFRoaXMgZnVuY3Rpb24gd2lsbCBiZSByZW1vdmVkIGluIGEgZnV0dXJlIG1ham9yIHJlbGVhc2UuIEluc3RlYWQsIHNldFxuICogYEZpcmVzdG9yZVNldHRpbmdzLmxvY2FsQ2FjaGVgIHRvIGFuIGluc3RhbmNlIG9mIGBQZXJzaXN0ZW50TG9jYWxDYWNoZWAgdG9cbiAqIHR1cm4gb24gaW5kZXhlZGRiIGNhY2hlLiBDYWxsaW5nIHRoaXMgZnVuY3Rpb24gd2hlbiBgRmlyZXN0b3JlU2V0dGluZ3MubG9jYWxDYWNoZWBcbiAqIGlzIGFscmVhZHkgc3BlY2lmaWVkIHdpbGwgdGhyb3cgYW4gZXhjZXB0aW9uLlxuICovIGFzeW5jIGZ1bmN0aW9uIGVuYWJsZU11bHRpVGFiSW5kZXhlZERiUGVyc2lzdGVuY2UoZSkge1xuICAgIF9fUFJJVkFURV9sb2dXYXJuKFwiZW5hYmxlTXVsdGlUYWJJbmRleGVkRGJQZXJzaXN0ZW5jZSgpIHdpbGwgYmUgZGVwcmVjYXRlZCBpbiB0aGUgZnV0dXJlLCB5b3UgY2FuIHVzZSBgRmlyZXN0b3JlU2V0dGluZ3MuY2FjaGVgIGluc3RlYWQuXCIpO1xuICAgIGNvbnN0IHQgPSBlLl9mcmVlemVTZXR0aW5ncygpO1xuICAgIF9fUFJJVkFURV9zZXRQZXJzaXN0ZW5jZVByb3ZpZGVycyhlLCBPbmxpbmVDb21wb25lbnRQcm92aWRlci5wcm92aWRlciwge1xuICAgICAgICBidWlsZDogZSA9PiBuZXcgX19QUklWQVRFX011bHRpVGFiT2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyKGUsIHQuY2FjaGVTaXplQnl0ZXMpXG4gICAgfSk7XG59XG5cbi8qKlxuICogUmVnaXN0ZXJzIGJvdGggdGhlIGBPZmZsaW5lQ29tcG9uZW50UHJvdmlkZXJgIGFuZCBgT25saW5lQ29tcG9uZW50UHJvdmlkZXJgLlxuICogSWYgdGhlIG9wZXJhdGlvbiBmYWlscyB3aXRoIGEgcmVjb3ZlcmFibGUgZXJyb3IgKHNlZVxuICogYGNhblJlY292ZXJGcm9tSW5kZXhlZERiRXJyb3IoKWAgYmVsb3cpLCB0aGUgcmV0dXJuZWQgUHJvbWlzZSBpcyByZWplY3RlZFxuICogYnV0IHRoZSBjbGllbnQgcmVtYWlucyB1c2FibGUuXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX3NldFBlcnNpc3RlbmNlUHJvdmlkZXJzKGUsIHQsIG4pIHtcbiAgICBpZiAoKGUgPSBfX1BSSVZBVEVfY2FzdChlLCBGaXJlc3RvcmUpKS5fZmlyZXN0b3JlQ2xpZW50IHx8IGUuX3Rlcm1pbmF0ZWQpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiRmlyZXN0b3JlIGhhcyBhbHJlYWR5IGJlZW4gc3RhcnRlZCBhbmQgcGVyc2lzdGVuY2UgY2FuIG5vIGxvbmdlciBiZSBlbmFibGVkLiBZb3UgY2FuIG9ubHkgZW5hYmxlIHBlcnNpc3RlbmNlIGJlZm9yZSBjYWxsaW5nIGFueSBvdGhlciBtZXRob2RzIG9uIGEgRmlyZXN0b3JlIG9iamVjdC5cIik7XG4gICAgaWYgKGUuX2NvbXBvbmVudHNQcm92aWRlciB8fCBlLl9nZXRTZXR0aW5ncygpLmxvY2FsQ2FjaGUpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiU0RLIGNhY2hlIGlzIGFscmVhZHkgc3BlY2lmaWVkLlwiKTtcbiAgICBlLl9jb21wb25lbnRzUHJvdmlkZXIgPSB7XG4gICAgICAgIF9vbmxpbmU6IHQsXG4gICAgICAgIF9vZmZsaW5lOiBuXG4gICAgfSwgX19QUklWQVRFX2NvbmZpZ3VyZUZpcmVzdG9yZShlKTtcbn1cblxuLyoqXG4gKiBDbGVhcnMgdGhlIHBlcnNpc3RlbnQgc3RvcmFnZS4gVGhpcyBpbmNsdWRlcyBwZW5kaW5nIHdyaXRlcyBhbmQgY2FjaGVkXG4gKiBkb2N1bWVudHMuXG4gKlxuICogTXVzdCBiZSBjYWxsZWQgd2hpbGUgdGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIGlzIG5vdCBzdGFydGVkIChhZnRlciB0aGUgYXBwIGlzXG4gKiB0ZXJtaW5hdGVkIG9yIHdoZW4gdGhlIGFwcCBpcyBmaXJzdCBpbml0aWFsaXplZCkuIE9uIHN0YXJ0dXAsIHRoaXMgZnVuY3Rpb25cbiAqIG11c3QgYmUgY2FsbGVkIGJlZm9yZSBvdGhlciBmdW5jdGlvbnMgKG90aGVyIHRoYW4ge0BsaW5rXG4gKiBpbml0aWFsaXplRmlyZXN0b3JlfSBvciB7QGxpbmsgKGdldEZpcmVzdG9yZToxKX0pKS4gSWYgdGhlIHtAbGluayBGaXJlc3RvcmV9XG4gKiBpbnN0YW5jZSBpcyBzdGlsbCBydW5uaW5nLCB0aGUgcHJvbWlzZSB3aWxsIGJlIHJlamVjdGVkIHdpdGggdGhlIGVycm9yIGNvZGVcbiAqIG9mIGBmYWlsZWQtcHJlY29uZGl0aW9uYC5cbiAqXG4gKiBOb3RlOiBgY2xlYXJJbmRleGVkRGJQZXJzaXN0ZW5jZSgpYCBpcyBwcmltYXJpbHkgaW50ZW5kZWQgdG8gaGVscCB3cml0ZVxuICogcmVsaWFibGUgdGVzdHMgdGhhdCB1c2UgQ2xvdWQgRmlyZXN0b3JlLiBJdCB1c2VzIGFuIGVmZmljaWVudCBtZWNoYW5pc20gZm9yXG4gKiBkcm9wcGluZyBleGlzdGluZyBkYXRhIGJ1dCBkb2VzIG5vdCBhdHRlbXB0IHRvIHNlY3VyZWx5IG92ZXJ3cml0ZSBvclxuICogb3RoZXJ3aXNlIG1ha2UgY2FjaGVkIGRhdGEgdW5yZWNvdmVyYWJsZS4gRm9yIGFwcGxpY2F0aW9ucyB0aGF0IGFyZSBzZW5zaXRpdmVcbiAqIHRvIHRoZSBkaXNjbG9zdXJlIG9mIGNhY2hlZCBkYXRhIGluIGJldHdlZW4gdXNlciBzZXNzaW9ucywgd2Ugc3Ryb25nbHlcbiAqIHJlY29tbWVuZCBub3QgZW5hYmxpbmcgcGVyc2lzdGVuY2UgYXQgYWxsLlxuICpcbiAqIEBwYXJhbSBmaXJlc3RvcmUgLSBUaGUge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UgdG8gY2xlYXIgcGVyc2lzdGVuY2UgZm9yLlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCBpcyByZXNvbHZlZCB3aGVuIHRoZSBwZXJzaXN0ZW50IHN0b3JhZ2UgaXNcbiAqIGNsZWFyZWQuIE90aGVyd2lzZSwgdGhlIHByb21pc2UgaXMgcmVqZWN0ZWQgd2l0aCBhbiBlcnJvci5cbiAqLyBmdW5jdGlvbiBjbGVhckluZGV4ZWREYlBlcnNpc3RlbmNlKGUpIHtcbiAgICBpZiAoZS5faW5pdGlhbGl6ZWQgJiYgIWUuX3Rlcm1pbmF0ZWQpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiUGVyc2lzdGVuY2UgY2FuIG9ubHkgYmUgY2xlYXJlZCBiZWZvcmUgYSBGaXJlc3RvcmUgaW5zdGFuY2UgaXMgaW5pdGlhbGl6ZWQgb3IgYWZ0ZXIgaXQgaXMgdGVybWluYXRlZC5cIik7XG4gICAgY29uc3QgdCA9IG5ldyBfX1BSSVZBVEVfRGVmZXJyZWQ7XG4gICAgcmV0dXJuIGUuX3F1ZXVlLmVucXVldWVBbmRGb3JnZXRFdmVuV2hpbGVSZXN0cmljdGVkKChhc3luYyAoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBhc3luYyBmdW5jdGlvbiBfX1BSSVZBVEVfaW5kZXhlZERiQ2xlYXJQZXJzaXN0ZW5jZShlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFfX1BSSVZBVEVfU2ltcGxlRGIudigpKSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IGUgKyAkdDtcbiAgICAgICAgICAgICAgICBhd2FpdCBfX1BSSVZBVEVfU2ltcGxlRGIuZGVsZXRlKHQpO1xuICAgICAgICAgICAgfShfX1BSSVZBVEVfaW5kZXhlZERiU3RvcmFnZVByZWZpeChlLl9kYXRhYmFzZUlkLCBlLl9wZXJzaXN0ZW5jZUtleSkpLCB0LnJlc29sdmUoKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgdC5yZWplY3QoZSk7XG4gICAgICAgIH1cbiAgICB9KSksIHQucHJvbWlzZTtcbn1cblxuLyoqXG4gKiBXYWl0cyB1bnRpbCBhbGwgY3VycmVudGx5IHBlbmRpbmcgd3JpdGVzIGZvciB0aGUgYWN0aXZlIHVzZXIgaGF2ZSBiZWVuXG4gKiBhY2tub3dsZWRnZWQgYnkgdGhlIGJhY2tlbmQuXG4gKlxuICogVGhlIHJldHVybmVkIHByb21pc2UgcmVzb2x2ZXMgaW1tZWRpYXRlbHkgaWYgdGhlcmUgYXJlIG5vIG91dHN0YW5kaW5nIHdyaXRlcy5cbiAqIE90aGVyd2lzZSwgdGhlIHByb21pc2Ugd2FpdHMgZm9yIGFsbCBwcmV2aW91c2x5IGlzc3VlZCB3cml0ZXMgKGluY2x1ZGluZ1xuICogdGhvc2Ugd3JpdHRlbiBpbiBhIHByZXZpb3VzIGFwcCBzZXNzaW9uKSwgYnV0IGl0IGRvZXMgbm90IHdhaXQgZm9yIHdyaXRlc1xuICogdGhhdCB3ZXJlIGFkZGVkIGFmdGVyIHRoZSBmdW5jdGlvbiBpcyBjYWxsZWQuIElmIHlvdSB3YW50IHRvIHdhaXQgZm9yXG4gKiBhZGRpdGlvbmFsIHdyaXRlcywgY2FsbCBgd2FpdEZvclBlbmRpbmdXcml0ZXMoKWAgYWdhaW4uXG4gKlxuICogQW55IG91dHN0YW5kaW5nIGB3YWl0Rm9yUGVuZGluZ1dyaXRlcygpYCBwcm9taXNlcyBhcmUgcmVqZWN0ZWQgZHVyaW5nIHVzZXJcbiAqIGNoYW5nZXMuXG4gKlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgd2hpY2ggcmVzb2x2ZXMgd2hlbiBhbGwgY3VycmVudGx5IHBlbmRpbmcgd3JpdGVzIGhhdmUgYmVlblxuICogYWNrbm93bGVkZ2VkIGJ5IHRoZSBiYWNrZW5kLlxuICovIGZ1bmN0aW9uIHdhaXRGb3JQZW5kaW5nV3JpdGVzKGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX2ZpcmVzdG9yZUNsaWVudFdhaXRGb3JQZW5kaW5nV3JpdGVzKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IG5ldyBfX1BSSVZBVEVfRGVmZXJyZWQ7XG4gICAgICAgIHJldHVybiBlLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4gX19QUklWQVRFX3N5bmNFbmdpbmVSZWdpc3RlclBlbmRpbmdXcml0ZXNDYWxsYmFjayhhd2FpdCBfX1BSSVZBVEVfZ2V0U3luY0VuZ2luZShlKSwgdCkpKSwgXG4gICAgICAgIHQucHJvbWlzZTtcbiAgICB9KGVuc3VyZUZpcmVzdG9yZUNvbmZpZ3VyZWQoZSA9IF9fUFJJVkFURV9jYXN0KGUsIEZpcmVzdG9yZSkpKTtcbn1cblxuLyoqXG4gKiBSZS1lbmFibGVzIHVzZSBvZiB0aGUgbmV0d29yayBmb3IgdGhpcyB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSBhZnRlciBhIHByaW9yXG4gKiBjYWxsIHRvIHtAbGluayBkaXNhYmxlTmV0d29ya30uXG4gKlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCBpcyByZXNvbHZlZCBvbmNlIHRoZSBuZXR3b3JrIGhhcyBiZWVuIGVuYWJsZWQuXG4gKi8gZnVuY3Rpb24gZW5hYmxlTmV0d29yayhlKSB7XG4gICAgcmV0dXJuIF9fUFJJVkFURV9maXJlc3RvcmVDbGllbnRFbmFibGVOZXR3b3JrKGVuc3VyZUZpcmVzdG9yZUNvbmZpZ3VyZWQoZSA9IF9fUFJJVkFURV9jYXN0KGUsIEZpcmVzdG9yZSkpKTtcbn1cblxuLyoqXG4gKiBEaXNhYmxlcyBuZXR3b3JrIHVzYWdlIGZvciB0aGlzIGluc3RhbmNlLiBJdCBjYW4gYmUgcmUtZW5hYmxlZCB2aWEge0BsaW5rXG4gKiBlbmFibGVOZXR3b3JrfS4gV2hpbGUgdGhlIG5ldHdvcmsgaXMgZGlzYWJsZWQsIGFueSBzbmFwc2hvdCBsaXN0ZW5lcnMsXG4gKiBgZ2V0RG9jKClgIG9yIGBnZXREb2NzKClgIGNhbGxzIHdpbGwgcmV0dXJuIHJlc3VsdHMgZnJvbSBjYWNoZSwgYW5kIGFueSB3cml0ZVxuICogb3BlcmF0aW9ucyB3aWxsIGJlIHF1ZXVlZCB1bnRpbCB0aGUgbmV0d29yayBpcyByZXN0b3JlZC5cbiAqXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IGlzIHJlc29sdmVkIG9uY2UgdGhlIG5ldHdvcmsgaGFzIGJlZW4gZGlzYWJsZWQuXG4gKi8gZnVuY3Rpb24gZGlzYWJsZU5ldHdvcmsoZSkge1xuICAgIHJldHVybiBfX1BSSVZBVEVfZmlyZXN0b3JlQ2xpZW50RGlzYWJsZU5ldHdvcmsoZW5zdXJlRmlyZXN0b3JlQ29uZmlndXJlZChlID0gX19QUklWQVRFX2Nhc3QoZSwgRmlyZXN0b3JlKSkpO1xufVxuXG4vKipcbiAqIFRlcm1pbmF0ZXMgdGhlIHByb3ZpZGVkIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlLlxuICpcbiAqIEFmdGVyIGNhbGxpbmcgYHRlcm1pbmF0ZSgpYCBvbmx5IHRoZSBgY2xlYXJJbmRleGVkRGJQZXJzaXN0ZW5jZSgpYCBmdW5jdGlvblxuICogbWF5IGJlIHVzZWQuIEFueSBvdGhlciBmdW5jdGlvbiB3aWxsIHRocm93IGEgYEZpcmVzdG9yZUVycm9yYC5cbiAqXG4gKiBUbyByZXN0YXJ0IGFmdGVyIHRlcm1pbmF0aW9uLCBjcmVhdGUgYSBuZXcgaW5zdGFuY2Ugb2YgRmlyZWJhc2VGaXJlc3RvcmUgd2l0aFxuICoge0BsaW5rIChnZXRGaXJlc3RvcmU6MSl9LlxuICpcbiAqIFRlcm1pbmF0aW9uIGRvZXMgbm90IGNhbmNlbCBhbnkgcGVuZGluZyB3cml0ZXMsIGFuZCBhbnkgcHJvbWlzZXMgdGhhdCBhcmVcbiAqIGF3YWl0aW5nIGEgcmVzcG9uc2UgZnJvbSB0aGUgc2VydmVyIHdpbGwgbm90IGJlIHJlc29sdmVkLiBJZiB5b3UgaGF2ZVxuICogcGVyc2lzdGVuY2UgZW5hYmxlZCwgdGhlIG5leHQgdGltZSB5b3Ugc3RhcnQgdGhpcyBpbnN0YW5jZSwgaXQgd2lsbCByZXN1bWVcbiAqIHNlbmRpbmcgdGhlc2Ugd3JpdGVzIHRvIHRoZSBzZXJ2ZXIuXG4gKlxuICogTm90ZTogVW5kZXIgbm9ybWFsIGNpcmN1bXN0YW5jZXMsIGNhbGxpbmcgYHRlcm1pbmF0ZSgpYCBpcyBub3QgcmVxdWlyZWQuIFRoaXNcbiAqIGZ1bmN0aW9uIGlzIHVzZWZ1bCBvbmx5IHdoZW4geW91IHdhbnQgdG8gZm9yY2UgdGhpcyBpbnN0YW5jZSB0byByZWxlYXNlIGFsbFxuICogb2YgaXRzIHJlc291cmNlcyBvciBpbiBjb21iaW5hdGlvbiB3aXRoIGBjbGVhckluZGV4ZWREYlBlcnNpc3RlbmNlKClgIHRvXG4gKiBlbnN1cmUgdGhhdCBhbGwgbG9jYWwgc3RhdGUgaXMgZGVzdHJveWVkIGJldHdlZW4gdGVzdCBydW5zLlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgaXMgcmVzb2x2ZWQgd2hlbiB0aGUgaW5zdGFuY2UgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5XG4gKiB0ZXJtaW5hdGVkLlxuICovIGZ1bmN0aW9uIHRlcm1pbmF0ZShlKSB7XG4gICAgcmV0dXJuIF9yZW1vdmVTZXJ2aWNlSW5zdGFuY2UoZS5hcHAsIFwiZmlyZXN0b3JlXCIsIGUuX2RhdGFiYXNlSWQuZGF0YWJhc2UpLCBlLl9kZWxldGUoKTtcbn1cblxuLyoqXG4gKiBMb2FkcyBhIEZpcmVzdG9yZSBidW5kbGUgaW50byB0aGUgbG9jYWwgY2FjaGUuXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIFRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB0byBsb2FkIGJ1bmRsZXMgZm9yLlxuICogQHBhcmFtIGJ1bmRsZURhdGEgLSBBbiBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBidW5kbGUgdG8gYmUgbG9hZGVkLiBWYWxpZFxuICogb2JqZWN0cyBhcmUgYEFycmF5QnVmZmVyYCwgYFJlYWRhYmxlU3RyZWFtPFVpbnQ4QXJyYXk+YCBvciBgc3RyaW5nYC5cbiAqXG4gKiBAcmV0dXJucyBBIGBMb2FkQnVuZGxlVGFza2Agb2JqZWN0LCB3aGljaCBub3RpZmllcyBjYWxsZXJzIHdpdGggcHJvZ3Jlc3NcbiAqIHVwZGF0ZXMsIGFuZCBjb21wbGV0aW9uIG9yIGVycm9yIGV2ZW50cy4gSXQgY2FuIGJlIHVzZWQgYXMgYVxuICogYFByb21pc2U8TG9hZEJ1bmRsZVRhc2tQcm9ncmVzcz5gLlxuICovIGZ1bmN0aW9uIGxvYWRCdW5kbGUoZSwgdCkge1xuICAgIGNvbnN0IG4gPSBlbnN1cmVGaXJlc3RvcmVDb25maWd1cmVkKGUgPSBfX1BSSVZBVEVfY2FzdChlLCBGaXJlc3RvcmUpKSwgciA9IG5ldyBMb2FkQnVuZGxlVGFzaztcbiAgICByZXR1cm4gX19QUklWQVRFX2ZpcmVzdG9yZUNsaWVudExvYWRCdW5kbGUobiwgZS5fZGF0YWJhc2VJZCwgdCwgciksIHI7XG59XG5cbi8qKlxuICogUmVhZHMgYSBGaXJlc3RvcmUge0BsaW5rIFF1ZXJ5fSBmcm9tIGxvY2FsIGNhY2hlLCBpZGVudGlmaWVkIGJ5IHRoZSBnaXZlblxuICogbmFtZS5cbiAqXG4gKiBUaGUgbmFtZWQgcXVlcmllcyBhcmUgcGFja2FnZWQgIGludG8gYnVuZGxlcyBvbiB0aGUgc2VydmVyIHNpZGUgKGFsb25nXG4gKiB3aXRoIHJlc3VsdGluZyBkb2N1bWVudHMpLCBhbmQgbG9hZGVkIHRvIGxvY2FsIGNhY2hlIHVzaW5nIGBsb2FkQnVuZGxlYC4gT25jZVxuICogaW4gbG9jYWwgY2FjaGUsIHVzZSB0aGlzIG1ldGhvZCB0byBleHRyYWN0IGEge0BsaW5rIFF1ZXJ5fSBieSBuYW1lLlxuICpcbiAqIEBwYXJhbSBmaXJlc3RvcmUgLSBUaGUge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UgdG8gcmVhZCB0aGUgcXVlcnkgZnJvbS5cbiAqIEBwYXJhbSBuYW1lIC0gVGhlIG5hbWUgb2YgdGhlIHF1ZXJ5LlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCBpcyByZXNvbHZlZCB3aXRoIHRoZSBRdWVyeSBvciBgbnVsbGAuXG4gKi8gZnVuY3Rpb24gbmFtZWRRdWVyeShlLCB0KSB7XG4gICAgcmV0dXJuIF9fUFJJVkFURV9maXJlc3RvcmVDbGllbnRHZXROYW1lZFF1ZXJ5KGVuc3VyZUZpcmVzdG9yZUNvbmZpZ3VyZWQoZSA9IF9fUFJJVkFURV9jYXN0KGUsIEZpcmVzdG9yZSkpLCB0KS50aGVuKCh0ID0+IHQgPyBuZXcgUXVlcnkoZSwgbnVsbCwgdC5xdWVyeSkgOiBudWxsKSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZXByZXNlbnRzIGFuIGFnZ3JlZ2F0aW9uIHRoYXQgY2FuIGJlIHBlcmZvcm1lZCBieSBGaXJlc3RvcmUuXG4gKi9cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbmNsYXNzIEFnZ3JlZ2F0ZUZpZWxkIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBuZXcgQWdncmVnYXRlRmllbGQ8VD5cbiAgICAgKiBAcGFyYW0gYWdncmVnYXRlVHlwZSBTcGVjaWZpZXMgdGhlIHR5cGUgb2YgYWdncmVnYXRpb24gb3BlcmF0aW9uIHRvIHBlcmZvcm0uXG4gICAgICogQHBhcmFtIF9pbnRlcm5hbEZpZWxkUGF0aCBPcHRpb25hbGx5IHNwZWNpZmllcyB0aGUgZmllbGQgdGhhdCBpcyBhZ2dyZWdhdGVkLlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGUgPSBcImNvdW50XCIsIHQpIHtcbiAgICAgICAgdGhpcy5faW50ZXJuYWxGaWVsZFBhdGggPSB0LCBcbiAgICAgICAgLyoqIEEgdHlwZSBzdHJpbmcgdG8gdW5pcXVlbHkgaWRlbnRpZnkgaW5zdGFuY2VzIG9mIHRoaXMgY2xhc3MuICovXG4gICAgICAgIHRoaXMudHlwZSA9IFwiQWdncmVnYXRlRmllbGRcIiwgdGhpcy5hZ2dyZWdhdGVUeXBlID0gZTtcbiAgICB9XG59XG5cbi8qKlxuICogVGhlIHJlc3VsdHMgb2YgZXhlY3V0aW5nIGFuIGFnZ3JlZ2F0aW9uIHF1ZXJ5LlxuICovIGNsYXNzIEFnZ3JlZ2F0ZVF1ZXJ5U25hcHNob3Qge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IoZSwgdCwgbikge1xuICAgICAgICB0aGlzLl91c2VyRGF0YVdyaXRlciA9IHQsIHRoaXMuX2RhdGEgPSBuLCBcbiAgICAgICAgLyoqIEEgdHlwZSBzdHJpbmcgdG8gdW5pcXVlbHkgaWRlbnRpZnkgaW5zdGFuY2VzIG9mIHRoaXMgY2xhc3MuICovXG4gICAgICAgIHRoaXMudHlwZSA9IFwiQWdncmVnYXRlUXVlcnlTbmFwc2hvdFwiLCB0aGlzLnF1ZXJ5ID0gZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgcmVzdWx0cyBvZiB0aGUgYWdncmVnYXRpb25zIHBlcmZvcm1lZCBvdmVyIHRoZSB1bmRlcmx5aW5nXG4gICAgICogcXVlcnkuXG4gICAgICpcbiAgICAgKiBUaGUga2V5cyBvZiB0aGUgcmV0dXJuZWQgb2JqZWN0IHdpbGwgYmUgdGhlIHNhbWUgYXMgdGhvc2Ugb2YgdGhlXG4gICAgICogYEFnZ3JlZ2F0ZVNwZWNgIG9iamVjdCBzcGVjaWZpZWQgdG8gdGhlIGFnZ3JlZ2F0aW9uIG1ldGhvZCwgYW5kIHRoZSB2YWx1ZXNcbiAgICAgKiB3aWxsIGJlIHRoZSBjb3JyZXNwb25kaW5nIGFnZ3JlZ2F0aW9uIHJlc3VsdC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIFRoZSByZXN1bHRzIG9mIHRoZSBhZ2dyZWdhdGlvbnMgcGVyZm9ybWVkIG92ZXIgdGhlIHVuZGVybHlpbmdcbiAgICAgKiBxdWVyeS5cbiAgICAgKi8gICAgZGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VzZXJEYXRhV3JpdGVyLmNvbnZlcnRPYmplY3RNYXAodGhpcy5fZGF0YSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBbiBpbW11dGFibGUgb2JqZWN0IHJlcHJlc2VudGluZyBhbiBhcnJheSBvZiBieXRlcy5cbiAqLyBjbGFzcyBCeXRlcyB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHRoaXMuX2J5dGVTdHJpbmcgPSBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IGBCeXRlc2Agb2JqZWN0IGZyb20gdGhlIGdpdmVuIEJhc2U2NCBzdHJpbmcsIGNvbnZlcnRpbmcgaXQgdG9cbiAgICAgKiBieXRlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBiYXNlNjQgLSBUaGUgQmFzZTY0IHN0cmluZyB1c2VkIHRvIGNyZWF0ZSB0aGUgYEJ5dGVzYCBvYmplY3QuXG4gICAgICovICAgIHN0YXRpYyBmcm9tQmFzZTY0U3RyaW5nKGUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQnl0ZXMoQnl0ZVN0cmluZy5mcm9tQmFzZTY0U3RyaW5nKGUpKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgXCJGYWlsZWQgdG8gY29uc3RydWN0IGRhdGEgZnJvbSBCYXNlNjQgc3RyaW5nOiBcIiArIGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgYEJ5dGVzYCBvYmplY3QgZnJvbSB0aGUgZ2l2ZW4gVWludDhBcnJheS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBhcnJheSAtIFRoZSBVaW50OEFycmF5IHVzZWQgdG8gY3JlYXRlIHRoZSBgQnl0ZXNgIG9iamVjdC5cbiAgICAgKi8gICAgc3RhdGljIGZyb21VaW50OEFycmF5KGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBCeXRlcyhCeXRlU3RyaW5nLmZyb21VaW50OEFycmF5KGUpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgdW5kZXJseWluZyBieXRlcyBhcyBhIEJhc2U2NC1lbmNvZGVkIHN0cmluZy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIFRoZSBCYXNlNjQtZW5jb2RlZCBzdHJpbmcgY3JlYXRlZCBmcm9tIHRoZSBgQnl0ZXNgIG9iamVjdC5cbiAgICAgKi8gICAgdG9CYXNlNjQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ieXRlU3RyaW5nLnRvQmFzZTY0KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHVuZGVybHlpbmcgYnl0ZXMgaW4gYSBuZXcgYFVpbnQ4QXJyYXlgLlxuICAgICAqXG4gICAgICogQHJldHVybnMgVGhlIFVpbnQ4QXJyYXkgY3JlYXRlZCBmcm9tIHRoZSBgQnl0ZXNgIG9iamVjdC5cbiAgICAgKi8gICAgdG9VaW50OEFycmF5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYnl0ZVN0cmluZy50b1VpbnQ4QXJyYXkoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgYEJ5dGVzYCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBBIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgYEJ5dGVzYCBvYmplY3QuXG4gICAgICovICAgIHRvU3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gXCJCeXRlcyhiYXNlNjQ6IFwiICsgdGhpcy50b0Jhc2U2NCgpICsgXCIpXCI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGBCeXRlc2Agb2JqZWN0IGlzIGVxdWFsIHRvIHRoZSBwcm92aWRlZCBvbmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb3RoZXIgLSBUaGUgYEJ5dGVzYCBvYmplY3QgdG8gY29tcGFyZSBhZ2FpbnN0LlxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhpcyBgQnl0ZXNgIG9iamVjdCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqLyAgICBpc0VxdWFsKGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2J5dGVTdHJpbmcuaXNFcXVhbChlLl9ieXRlU3RyaW5nKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIEpTT04tc2VyaWFsaXphYmxlIHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgYEJ5dGVzYCBpbnN0YW5jZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIGEgSlNPTiByZXByZXNlbnRhdGlvbiBvZiB0aGlzIG9iamVjdC5cbiAgICAgKi8gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogQnl0ZXMuX2pzb25TY2hlbWFWZXJzaW9uLFxuICAgICAgICAgICAgYnl0ZXM6IHRoaXMudG9CYXNlNjQoKVxuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBCdWlsZHMgYSBgQnl0ZXNgIGluc3RhbmNlIGZyb20gYSBKU09OIG9iamVjdCBjcmVhdGVkIGJ5IHtAbGluayBCeXRlcy50b0pTT059LlxuICAgICAqXG4gICAgICogQHBhcmFtIGpzb24gYSBKU09OIG9iamVjdCByZXByZXNlbnRpb24gb2YgYSBgQnl0ZXNgIGluc3RhbmNlXG4gICAgICogQHJldHVybnMgYW4gaW5zdGFuY2Ugb2Yge0BsaW5rIEJ5dGVzfSBpZiB0aGUgSlNPTiBvYmplY3QgY291bGQgYmUgcGFyc2VkLiBUaHJvd3MgYVxuICAgICAqIHtAbGluayBGaXJlc3RvcmVFcnJvcn0gaWYgYW4gZXJyb3Igb2NjdXJzLlxuICAgICAqLyAgICBzdGF0aWMgZnJvbUpTT04oZSkge1xuICAgICAgICBpZiAoX19QUklWQVRFX3ZhbGlkYXRlSlNPTihlLCBCeXRlcy5fanNvblNjaGVtYSkpIHJldHVybiBCeXRlcy5mcm9tQmFzZTY0U3RyaW5nKGUuYnl0ZXMpO1xuICAgIH1cbn1cblxuQnl0ZXMuX2pzb25TY2hlbWFWZXJzaW9uID0gXCJmaXJlc3RvcmUvYnl0ZXMvMS4wXCIsIEJ5dGVzLl9qc29uU2NoZW1hID0ge1xuICAgIHR5cGU6IHByb3BlcnR5KFwic3RyaW5nXCIsIEJ5dGVzLl9qc29uU2NoZW1hVmVyc2lvbiksXG4gICAgYnl0ZXM6IHByb3BlcnR5KFwic3RyaW5nXCIpXG59O1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGBGaWVsZFBhdGhgIHJlZmVycyB0byBhIGZpZWxkIGluIGEgZG9jdW1lbnQuIFRoZSBwYXRoIG1heSBjb25zaXN0IG9mIGFcbiAqIHNpbmdsZSBmaWVsZCBuYW1lIChyZWZlcnJpbmcgdG8gYSB0b3AtbGV2ZWwgZmllbGQgaW4gdGhlIGRvY3VtZW50KSwgb3IgYVxuICogbGlzdCBvZiBmaWVsZCBuYW1lcyAocmVmZXJyaW5nIHRvIGEgbmVzdGVkIGZpZWxkIGluIHRoZSBkb2N1bWVudCkuXG4gKlxuICogQ3JlYXRlIGEgYEZpZWxkUGF0aGAgYnkgcHJvdmlkaW5nIGZpZWxkIG5hbWVzLiBJZiBtb3JlIHRoYW4gb25lIGZpZWxkXG4gKiBuYW1lIGlzIHByb3ZpZGVkLCB0aGUgcGF0aCB3aWxsIHBvaW50IHRvIGEgbmVzdGVkIGZpZWxkIGluIGEgZG9jdW1lbnQuXG4gKi9cbmNsYXNzIEZpZWxkUGF0aCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGBGaWVsZFBhdGhgIGZyb20gdGhlIHByb3ZpZGVkIGZpZWxkIG5hbWVzLiBJZiBtb3JlIHRoYW4gb25lIGZpZWxkXG4gICAgICogbmFtZSBpcyBwcm92aWRlZCwgdGhlIHBhdGggd2lsbCBwb2ludCB0byBhIG5lc3RlZCBmaWVsZCBpbiBhIGRvY3VtZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIGZpZWxkTmFtZXMgLSBBIGxpc3Qgb2YgZmllbGQgbmFtZXMuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoLi4uZSkge1xuICAgICAgICBmb3IgKGxldCB0ID0gMDsgdCA8IGUubGVuZ3RoOyArK3QpIGlmICgwID09PSBlW3RdLmxlbmd0aCkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkIGZpZWxkIG5hbWUgYXQgYXJndW1lbnQgJChpICsgMSkuIEZpZWxkIG5hbWVzIG11c3Qgbm90IGJlIGVtcHR5LlwiKTtcbiAgICAgICAgdGhpcy5faW50ZXJuYWxQYXRoID0gbmV3IEZpZWxkUGF0aCQxKGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBgRmllbGRQYXRoYCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqXG4gICAgICogQHBhcmFtIG90aGVyIC0gVGhlIGBGaWVsZFBhdGhgIHRvIGNvbXBhcmUgYWdhaW5zdC5cbiAgICAgKiBAcmV0dXJucyB0cnVlIGlmIHRoaXMgYEZpZWxkUGF0aGAgaXMgZXF1YWwgdG8gdGhlIHByb3ZpZGVkIG9uZS5cbiAgICAgKi8gICAgaXNFcXVhbChlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pbnRlcm5hbFBhdGguaXNFcXVhbChlLl9pbnRlcm5hbFBhdGgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgc3BlY2lhbCBzZW50aW5lbCBgRmllbGRQYXRoYCB0byByZWZlciB0byB0aGUgSUQgb2YgYSBkb2N1bWVudC5cbiAqIEl0IGNhbiBiZSB1c2VkIGluIHF1ZXJpZXMgdG8gc29ydCBvciBmaWx0ZXIgYnkgdGhlIGRvY3VtZW50IElELlxuICovIGZ1bmN0aW9uIGRvY3VtZW50SWQoKSB7XG4gICAgcmV0dXJuIG5ldyBGaWVsZFBhdGgoayk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFNlbnRpbmVsIHZhbHVlcyB0aGF0IGNhbiBiZSB1c2VkIHdoZW4gd3JpdGluZyBkb2N1bWVudCBmaWVsZHMgd2l0aCBgc2V0KClgXG4gKiBvciBgdXBkYXRlKClgLlxuICovIGNsYXNzIEZpZWxkVmFsdWUge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSBfbWV0aG9kTmFtZSAtIFRoZSBwdWJsaWMgQVBJIGVuZHBvaW50IHRoYXQgcmV0dXJucyB0aGlzIGNsYXNzLlxuICAgICAqIEBoaWRlY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHRoaXMuX21ldGhvZE5hbWUgPSBlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gaW1tdXRhYmxlIG9iamVjdCByZXByZXNlbnRpbmcgYSBnZW9ncmFwaGljIGxvY2F0aW9uIGluIEZpcmVzdG9yZS4gVGhlXG4gKiBsb2NhdGlvbiBpcyByZXByZXNlbnRlZCBhcyBsYXRpdHVkZS9sb25naXR1ZGUgcGFpci5cbiAqXG4gKiBMYXRpdHVkZSB2YWx1ZXMgYXJlIGluIHRoZSByYW5nZSBvZiBbLTkwLCA5MF0uXG4gKiBMb25naXR1ZGUgdmFsdWVzIGFyZSBpbiB0aGUgcmFuZ2Ugb2YgWy0xODAsIDE4MF0uXG4gKi8gY2xhc3MgR2VvUG9pbnQge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgaW1tdXRhYmxlIGBHZW9Qb2ludGAgb2JqZWN0IHdpdGggdGhlIHByb3ZpZGVkIGxhdGl0dWRlIGFuZFxuICAgICAqIGxvbmdpdHVkZSB2YWx1ZXMuXG4gICAgICogQHBhcmFtIGxhdGl0dWRlIC0gVGhlIGxhdGl0dWRlIGFzIG51bWJlciBiZXR3ZWVuIC05MCBhbmQgOTAuXG4gICAgICogQHBhcmFtIGxvbmdpdHVkZSAtIFRoZSBsb25naXR1ZGUgYXMgbnVtYmVyIGJldHdlZW4gLTE4MCBhbmQgMTgwLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGUsIHQpIHtcbiAgICAgICAgaWYgKCFpc0Zpbml0ZShlKSB8fCBlIDwgLTkwIHx8IGUgPiA5MCkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgXCJMYXRpdHVkZSBtdXN0IGJlIGEgbnVtYmVyIGJldHdlZW4gLTkwIGFuZCA5MCwgYnV0IHdhczogXCIgKyBlKTtcbiAgICAgICAgaWYgKCFpc0Zpbml0ZSh0KSB8fCB0IDwgLTE4MCB8fCB0ID4gMTgwKSB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBcIkxvbmdpdHVkZSBtdXN0IGJlIGEgbnVtYmVyIGJldHdlZW4gLTE4MCBhbmQgMTgwLCBidXQgd2FzOiBcIiArIHQpO1xuICAgICAgICB0aGlzLl9sYXQgPSBlLCB0aGlzLl9sb25nID0gdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGxhdGl0dWRlIG9mIHRoaXMgYEdlb1BvaW50YCBpbnN0YW5jZS5cbiAgICAgKi8gICAgZ2V0IGxhdGl0dWRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbGF0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgbG9uZ2l0dWRlIG9mIHRoaXMgYEdlb1BvaW50YCBpbnN0YW5jZS5cbiAgICAgKi8gICAgZ2V0IGxvbmdpdHVkZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xvbmc7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGBHZW9Qb2ludGAgaXMgZXF1YWwgdG8gdGhlIHByb3ZpZGVkIG9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvdGhlciAtIFRoZSBgR2VvUG9pbnRgIHRvIGNvbXBhcmUgYWdhaW5zdC5cbiAgICAgKiBAcmV0dXJucyB0cnVlIGlmIHRoaXMgYEdlb1BvaW50YCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqLyAgICBpc0VxdWFsKGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xhdCA9PT0gZS5fbGF0ICYmIHRoaXMuX2xvbmcgPT09IGUuX2xvbmc7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFjdHVhbGx5IHByaXZhdGUgdG8gSlMgY29uc3VtZXJzIG9mIG91ciBBUEksIHNvIHRoaXMgZnVuY3Rpb24gaXMgcHJlZml4ZWRcbiAgICAgKiB3aXRoIGFuIHVuZGVyc2NvcmUuXG4gICAgICovICAgIF9jb21wYXJlVG8oZSkge1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IodGhpcy5fbGF0LCBlLl9sYXQpIHx8IF9fUFJJVkFURV9wcmltaXRpdmVDb21wYXJhdG9yKHRoaXMuX2xvbmcsIGUuX2xvbmcpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgSlNPTi1zZXJpYWxpemFibGUgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBgR2VvUG9pbnRgIGluc3RhbmNlLlxuICAgICAqXG4gICAgICogQHJldHVybnMgYSBKU09OIHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgb2JqZWN0LlxuICAgICAqLyAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBsYXRpdHVkZTogdGhpcy5fbGF0LFxuICAgICAgICAgICAgbG9uZ2l0dWRlOiB0aGlzLl9sb25nLFxuICAgICAgICAgICAgdHlwZTogR2VvUG9pbnQuX2pzb25TY2hlbWFWZXJzaW9uXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEJ1aWxkcyBhIGBHZW9Qb2ludGAgaW5zdGFuY2UgZnJvbSBhIEpTT04gb2JqZWN0IGNyZWF0ZWQgYnkge0BsaW5rIEdlb1BvaW50LnRvSlNPTn0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ganNvbiBhIEpTT04gb2JqZWN0IHJlcHJlc2VudGlvbiBvZiBhIGBHZW9Qb2ludGAgaW5zdGFuY2VcbiAgICAgKiBAcmV0dXJucyBhbiBpbnN0YW5jZSBvZiB7QGxpbmsgR2VvUG9pbnR9IGlmIHRoZSBKU09OIG9iamVjdCBjb3VsZCBiZSBwYXJzZWQuIFRocm93cyBhXG4gICAgICoge0BsaW5rIEZpcmVzdG9yZUVycm9yfSBpZiBhbiBlcnJvciBvY2N1cnMuXG4gICAgICovICAgIHN0YXRpYyBmcm9tSlNPTihlKSB7XG4gICAgICAgIGlmIChfX1BSSVZBVEVfdmFsaWRhdGVKU09OKGUsIEdlb1BvaW50Ll9qc29uU2NoZW1hKSkgcmV0dXJuIG5ldyBHZW9Qb2ludChlLmxhdGl0dWRlLCBlLmxvbmdpdHVkZSk7XG4gICAgfVxufVxuXG5HZW9Qb2ludC5fanNvblNjaGVtYVZlcnNpb24gPSBcImZpcmVzdG9yZS9nZW9Qb2ludC8xLjBcIiwgR2VvUG9pbnQuX2pzb25TY2hlbWEgPSB7XG4gICAgdHlwZTogcHJvcGVydHkoXCJzdHJpbmdcIiwgR2VvUG9pbnQuX2pzb25TY2hlbWFWZXJzaW9uKSxcbiAgICBsYXRpdHVkZTogcHJvcGVydHkoXCJudW1iZXJcIiksXG4gICAgbG9uZ2l0dWRlOiBwcm9wZXJ0eShcIm51bWJlclwiKVxufTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjQgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmVwcmVzZW50cyBhIHZlY3RvciB0eXBlIGluIEZpcmVzdG9yZSBkb2N1bWVudHMuXG4gKiBDcmVhdGUgYW4gaW5zdGFuY2Ugd2l0aCA8Y29kZT57QGxpbmsgdmVjdG9yfTwvY29kZT4uXG4gKlxuICogQGNsYXNzIFZlY3RvclZhbHVlXG4gKi9cbmNsYXNzIFZlY3RvclZhbHVlIHtcbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGUpIHtcbiAgICAgICAgLy8gTWFraW5nIGEgY29weSBvZiB0aGUgcGFyYW1ldGVyLlxuICAgICAgICB0aGlzLl92YWx1ZXMgPSAoZSB8fCBbXSkubWFwKChlID0+IGUpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGNvcHkgb2YgdGhlIHJhdyBudW1iZXIgYXJyYXkgZm9ybSBvZiB0aGUgdmVjdG9yLlxuICAgICAqLyAgICB0b0FycmF5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWVzLm1hcCgoZSA9PiBlKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIHRoZSB0d28gYFZlY3RvclZhbHVlYCB2YWx1ZXMgaGF2ZSB0aGUgc2FtZSByYXcgbnVtYmVyIGFycmF5cywgcmV0dXJucyBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICAgKi8gICAgaXNFcXVhbChlKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBfX1BSSVZBVEVfaXNQcmltaXRpdmVBcnJheUVxdWFsKGUsIHQpIHtcbiAgICAgICAgICAgIGlmIChlLmxlbmd0aCAhPT0gdC5sZW5ndGgpIHJldHVybiAhMTtcbiAgICAgICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgZS5sZW5ndGg7ICsrbikgaWYgKGVbbl0gIT09IHRbbl0pIHJldHVybiAhMTtcbiAgICAgICAgICAgIHJldHVybiAhMDtcbiAgICAgICAgfSh0aGlzLl92YWx1ZXMsIGUuX3ZhbHVlcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBKU09OLXNlcmlhbGl6YWJsZSByZXByZXNlbnRhdGlvbiBvZiB0aGlzIGBWZWN0b3JWYWx1ZWAgaW5zdGFuY2UuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBhIEpTT04gcmVwcmVzZW50YXRpb24gb2YgdGhpcyBvYmplY3QuXG4gICAgICovICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6IFZlY3RvclZhbHVlLl9qc29uU2NoZW1hVmVyc2lvbixcbiAgICAgICAgICAgIHZlY3RvclZhbHVlczogdGhpcy5fdmFsdWVzXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEJ1aWxkcyBhIGBWZWN0b3JWYWx1ZWAgaW5zdGFuY2UgZnJvbSBhIEpTT04gb2JqZWN0IGNyZWF0ZWQgYnkge0BsaW5rIFZlY3RvclZhbHVlLnRvSlNPTn0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ganNvbiBhIEpTT04gb2JqZWN0IHJlcHJlc2VudGlvbiBvZiBhIGBWZWN0b3JWYWx1ZWAgaW5zdGFuY2UuXG4gICAgICogQHJldHVybnMgYW4gaW5zdGFuY2Ugb2Yge0BsaW5rIFZlY3RvclZhbHVlfSBpZiB0aGUgSlNPTiBvYmplY3QgY291bGQgYmUgcGFyc2VkLiBUaHJvd3MgYVxuICAgICAqIHtAbGluayBGaXJlc3RvcmVFcnJvcn0gaWYgYW4gZXJyb3Igb2NjdXJzLlxuICAgICAqLyAgICBzdGF0aWMgZnJvbUpTT04oZSkge1xuICAgICAgICBpZiAoX19QUklWQVRFX3ZhbGlkYXRlSlNPTihlLCBWZWN0b3JWYWx1ZS5fanNvblNjaGVtYSkpIHtcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGUudmVjdG9yVmFsdWVzKSAmJiBlLnZlY3RvclZhbHVlcy5ldmVyeSgoZSA9PiBcIm51bWJlclwiID09IHR5cGVvZiBlKSkpIHJldHVybiBuZXcgVmVjdG9yVmFsdWUoZS52ZWN0b3JWYWx1ZXMpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgXCJFeHBlY3RlZCAndmVjdG9yVmFsdWVzJyBmaWVsZCB0byBiZSBhIG51bWJlciBhcnJheVwiKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuVmVjdG9yVmFsdWUuX2pzb25TY2hlbWFWZXJzaW9uID0gXCJmaXJlc3RvcmUvdmVjdG9yVmFsdWUvMS4wXCIsIFZlY3RvclZhbHVlLl9qc29uU2NoZW1hID0ge1xuICAgIHR5cGU6IHByb3BlcnR5KFwic3RyaW5nXCIsIFZlY3RvclZhbHVlLl9qc29uU2NoZW1hVmVyc2lvbiksXG4gICAgdmVjdG9yVmFsdWVzOiBwcm9wZXJ0eShcIm9iamVjdFwiKVxufTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IGhuID0gL15fXy4qX18kLztcblxuLyoqIFRoZSByZXN1bHQgb2YgcGFyc2luZyBkb2N1bWVudCBkYXRhIChlLmcuIGZvciBhIHNldERhdGEgY2FsbCkuICovIGNsYXNzIFBhcnNlZFNldERhdGEge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4pIHtcbiAgICAgICAgdGhpcy5kYXRhID0gZSwgdGhpcy5maWVsZE1hc2sgPSB0LCB0aGlzLmZpZWxkVHJhbnNmb3JtcyA9IG47XG4gICAgfVxuICAgIHRvTXV0YXRpb24oZSwgdCkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gdGhpcy5maWVsZE1hc2sgPyBuZXcgX19QUklWQVRFX1BhdGNoTXV0YXRpb24oZSwgdGhpcy5kYXRhLCB0aGlzLmZpZWxkTWFzaywgdCwgdGhpcy5maWVsZFRyYW5zZm9ybXMpIDogbmV3IF9fUFJJVkFURV9TZXRNdXRhdGlvbihlLCB0aGlzLmRhdGEsIHQsIHRoaXMuZmllbGRUcmFuc2Zvcm1zKTtcbiAgICB9XG59XG5cbi8qKiBUaGUgcmVzdWx0IG9mIHBhcnNpbmcgXCJ1cGRhdGVcIiBkYXRhIChpLmUuIGZvciBhbiB1cGRhdGVEYXRhIGNhbGwpLiAqLyBjbGFzcyBQYXJzZWRVcGRhdGVEYXRhIHtcbiAgICBjb25zdHJ1Y3RvcihlLCBcbiAgICAvLyBUaGUgZmllbGRNYXNrIGRvZXMgbm90IGluY2x1ZGUgZG9jdW1lbnQgdHJhbnNmb3Jtcy5cbiAgICB0LCBuKSB7XG4gICAgICAgIHRoaXMuZGF0YSA9IGUsIHRoaXMuZmllbGRNYXNrID0gdCwgdGhpcy5maWVsZFRyYW5zZm9ybXMgPSBuO1xuICAgIH1cbiAgICB0b011dGF0aW9uKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfUGF0Y2hNdXRhdGlvbihlLCB0aGlzLmRhdGEsIHRoaXMuZmllbGRNYXNrLCB0LCB0aGlzLmZpZWxkVHJhbnNmb3Jtcyk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfaXNXcml0ZShlKSB7XG4gICAgc3dpdGNoIChlKSB7XG4gICAgICBjYXNlIDAgLyogVXNlckRhdGFTb3VyY2UuU2V0ICovIDpcbiAvLyBmYWxsIHRocm91Z2hcbiAgICAgICAgICAgICAgY2FzZSAyIC8qIFVzZXJEYXRhU291cmNlLk1lcmdlU2V0ICovIDpcbiAvLyBmYWxsIHRocm91Z2hcbiAgICAgICAgICAgICAgY2FzZSAxIC8qIFVzZXJEYXRhU291cmNlLlVwZGF0ZSAqLyA6XG4gICAgICAgIHJldHVybiAhMDtcblxuICAgICAgY2FzZSAzIC8qIFVzZXJEYXRhU291cmNlLkFyZ3VtZW50ICovIDpcbiAgICAgIGNhc2UgNCAvKiBVc2VyRGF0YVNvdXJjZS5BcnJheUFyZ3VtZW50ICovIDpcbiAgICAgICAgcmV0dXJuICExO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBmYWlsKDQwMDExLCB7XG4gICAgICAgICAgICBBYzogZVxuICAgICAgICB9KTtcbiAgICB9XG59XG5cbi8qKiBBIFwiY29udGV4dFwiIG9iamVjdCBwYXNzZWQgYXJvdW5kIHdoaWxlIHBhcnNpbmcgdXNlciBkYXRhLiAqLyBjbGFzcyBfX1BSSVZBVEVfUGFyc2VDb250ZXh0SW1wbCB7XG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZXMgYSBQYXJzZUNvbnRleHQgd2l0aCB0aGUgZ2l2ZW4gc291cmNlIGFuZCBwYXRoLlxuICAgICAqXG4gICAgICogQHBhcmFtIHNldHRpbmdzIC0gVGhlIHNldHRpbmdzIGZvciB0aGUgcGFyc2VyLlxuICAgICAqIEBwYXJhbSBkYXRhYmFzZUlkIC0gVGhlIGRhdGFiYXNlIElEIG9mIHRoZSBGaXJlc3RvcmUgaW5zdGFuY2UuXG4gICAgICogQHBhcmFtIHNlcmlhbGl6ZXIgLSBUaGUgc2VyaWFsaXplciB0byB1c2UgdG8gZ2VuZXJhdGUgdGhlIFZhbHVlIHByb3RvLlxuICAgICAqIEBwYXJhbSBpZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzIC0gV2hldGhlciB0byBpZ25vcmUgdW5kZWZpbmVkIHByb3BlcnRpZXNcbiAgICAgKiByYXRoZXIgdGhhbiB0aHJvdy5cbiAgICAgKiBAcGFyYW0gZmllbGRUcmFuc2Zvcm1zIC0gQSBtdXRhYmxlIGxpc3Qgb2YgZmllbGQgdHJhbnNmb3JtcyBlbmNvdW50ZXJlZFxuICAgICAqIHdoaWxlIHBhcnNpbmcgdGhlIGRhdGEuXG4gICAgICogQHBhcmFtIGZpZWxkTWFzayAtIEEgbXV0YWJsZSBsaXN0IG9mIGZpZWxkIHBhdGhzIGVuY291bnRlcmVkIHdoaWxlIHBhcnNpbmdcbiAgICAgKiB0aGUgZGF0YS5cbiAgICAgKlxuICAgICAqIFRPRE8oYi8zNDg3MTEzMSk6IFdlIGRvbid0IHN1cHBvcnQgYXJyYXkgcGF0aHMgcmlnaHQgbm93LCBzbyBwYXRoIGNhbiBiZVxuICAgICAqIG51bGwgdG8gaW5kaWNhdGUgdGhlIGNvbnRleHQgcmVwcmVzZW50cyBhbnkgbG9jYXRpb24gd2l0aGluIGFuIGFycmF5IChpblxuICAgICAqIHdoaWNoIGNhc2UgY2VydGFpbiBmZWF0dXJlcyB3aWxsIG5vdCB3b3JrIGFuZCBlcnJvcnMgd2lsbCBiZSBzb21ld2hhdFxuICAgICAqIGNvbXByb21pc2VkKS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihlLCB0LCBuLCByLCBpLCBzKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBlLCB0aGlzLmRhdGFiYXNlSWQgPSB0LCB0aGlzLnNlcmlhbGl6ZXIgPSBuLCB0aGlzLmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMgPSByLCBcbiAgICAgICAgLy8gTWlub3IgaGFjazogSWYgZmllbGRUcmFuc2Zvcm1zIGlzIHVuZGVmaW5lZCwgd2UgYXNzdW1lIHRoaXMgaXMgYW5cbiAgICAgICAgLy8gZXh0ZXJuYWwgY2FsbCBhbmQgd2UgbmVlZCB0byB2YWxpZGF0ZSB0aGUgZW50aXJlIHBhdGguXG4gICAgICAgIHZvaWQgMCA9PT0gaSAmJiB0aGlzLlJjKCksIHRoaXMuZmllbGRUcmFuc2Zvcm1zID0gaSB8fCBbXSwgdGhpcy5maWVsZE1hc2sgPSBzIHx8IFtdO1xuICAgIH1cbiAgICBnZXQgcGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3MucGF0aDtcbiAgICB9XG4gICAgZ2V0IEFjKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5BYztcbiAgICB9XG4gICAgLyoqIFJldHVybnMgYSBuZXcgY29udGV4dCB3aXRoIHRoZSBzcGVjaWZpZWQgc2V0dGluZ3Mgb3ZlcndyaXR0ZW4uICovICAgIFZjKGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfUGFyc2VDb250ZXh0SW1wbCh7XG4gICAgICAgICAgICAuLi50aGlzLnNldHRpbmdzLFxuICAgICAgICAgICAgLi4uZVxuICAgICAgICB9LCB0aGlzLmRhdGFiYXNlSWQsIHRoaXMuc2VyaWFsaXplciwgdGhpcy5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzLCB0aGlzLmZpZWxkVHJhbnNmb3JtcywgdGhpcy5maWVsZE1hc2spO1xuICAgIH1cbiAgICBtYyhlKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLnBhdGg/LmNoaWxkKGUpLCBuID0gdGhpcy5WYyh7XG4gICAgICAgICAgICBwYXRoOiB0LFxuICAgICAgICAgICAgZmM6ICExXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbi5nYyhlKSwgbjtcbiAgICB9XG4gICAgeWMoZSkge1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5wYXRoPy5jaGlsZChlKSwgbiA9IHRoaXMuVmMoe1xuICAgICAgICAgICAgcGF0aDogdCxcbiAgICAgICAgICAgIGZjOiAhMVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG4uUmMoKSwgbjtcbiAgICB9XG4gICAgd2MoZSkge1xuICAgICAgICAvLyBUT0RPKGIvMzQ4NzExMzEpOiBXZSBkb24ndCBzdXBwb3J0IGFycmF5IHBhdGhzIHJpZ2h0IG5vdzsgc28gbWFrZSBwYXRoXG4gICAgICAgIC8vIHVuZGVmaW5lZC5cbiAgICAgICAgcmV0dXJuIHRoaXMuVmMoe1xuICAgICAgICAgICAgcGF0aDogdm9pZCAwLFxuICAgICAgICAgICAgZmM6ICEwXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBTYyhlKSB7XG4gICAgICAgIHJldHVybiBfX1BSSVZBVEVfY3JlYXRlRXJyb3IoZSwgdGhpcy5zZXR0aW5ncy5tZXRob2ROYW1lLCB0aGlzLnNldHRpbmdzLmJjIHx8ICExLCB0aGlzLnBhdGgsIHRoaXMuc2V0dGluZ3MuRGMpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyAndHJ1ZScgaWYgJ2ZpZWxkUGF0aCcgd2FzIHRyYXZlcnNlZCB3aGVuIGNyZWF0aW5nIHRoaXMgY29udGV4dC4gKi8gICAgY29udGFpbnMoZSkge1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSB0aGlzLmZpZWxkTWFzay5maW5kKCh0ID0+IGUuaXNQcmVmaXhPZih0KSkpIHx8IHZvaWQgMCAhPT0gdGhpcy5maWVsZFRyYW5zZm9ybXMuZmluZCgodCA9PiBlLmlzUHJlZml4T2YodC5maWVsZCkpKTtcbiAgICB9XG4gICAgUmMoKSB7XG4gICAgICAgIC8vIFRPRE8oYi8zNDg3MTEzMSk6IFJlbW92ZSBudWxsIGNoZWNrIG9uY2Ugd2UgaGF2ZSBwcm9wZXIgcGF0aHMgZm9yIGZpZWxkc1xuICAgICAgICAvLyB3aXRoaW4gYXJyYXlzLlxuICAgICAgICBpZiAodGhpcy5wYXRoKSBmb3IgKGxldCBlID0gMDsgZSA8IHRoaXMucGF0aC5sZW5ndGg7IGUrKykgdGhpcy5nYyh0aGlzLnBhdGguZ2V0KGUpKTtcbiAgICB9XG4gICAgZ2MoZSkge1xuICAgICAgICBpZiAoMCA9PT0gZS5sZW5ndGgpIHRocm93IHRoaXMuU2MoXCJEb2N1bWVudCBmaWVsZHMgbXVzdCBub3QgYmUgZW1wdHlcIik7XG4gICAgICAgIGlmIChfX1BSSVZBVEVfaXNXcml0ZSh0aGlzLkFjKSAmJiBobi50ZXN0KGUpKSB0aHJvdyB0aGlzLlNjKCdEb2N1bWVudCBmaWVsZHMgY2Fubm90IGJlZ2luIGFuZCBlbmQgd2l0aCBcIl9fXCInKTtcbiAgICB9XG59XG5cbi8qKlxuICogSGVscGVyIGZvciBwYXJzaW5nIHJhdyB1c2VyIGlucHV0IChwcm92aWRlZCB2aWEgdGhlIEFQSSkgaW50byBpbnRlcm5hbCBtb2RlbFxuICogY2xhc3Nlcy5cbiAqLyBjbGFzcyBfX1BSSVZBVEVfVXNlckRhdGFSZWFkZXIge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4pIHtcbiAgICAgICAgdGhpcy5kYXRhYmFzZUlkID0gZSwgdGhpcy5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzID0gdCwgdGhpcy5zZXJpYWxpemVyID0gbiB8fCBfX1BSSVZBVEVfbmV3U2VyaWFsaXplcihlKTtcbiAgICB9XG4gICAgLyoqIENyZWF0ZXMgYSBuZXcgdG9wLWxldmVsIHBhcnNlIGNvbnRleHQuICovICAgIENjKGUsIHQsIG4sIHIgPSAhMSkge1xuICAgICAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9QYXJzZUNvbnRleHRJbXBsKHtcbiAgICAgICAgICAgIEFjOiBlLFxuICAgICAgICAgICAgbWV0aG9kTmFtZTogdCxcbiAgICAgICAgICAgIERjOiBuLFxuICAgICAgICAgICAgcGF0aDogRmllbGRQYXRoJDEuZW1wdHlQYXRoKCksXG4gICAgICAgICAgICBmYzogITEsXG4gICAgICAgICAgICBiYzogclxuICAgICAgICB9LCB0aGlzLmRhdGFiYXNlSWQsIHRoaXMuc2VyaWFsaXplciwgdGhpcy5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9uZXdVc2VyRGF0YVJlYWRlcihlKSB7XG4gICAgY29uc3QgdCA9IGUuX2ZyZWV6ZVNldHRpbmdzKCksIG4gPSBfX1BSSVZBVEVfbmV3U2VyaWFsaXplcihlLl9kYXRhYmFzZUlkKTtcbiAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9Vc2VyRGF0YVJlYWRlcihlLl9kYXRhYmFzZUlkLCAhIXQuaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcywgbik7XG59XG5cbi8qKiBQYXJzZSBkb2N1bWVudCBkYXRhIGZyb20gYSBzZXQoKSBjYWxsLiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfcGFyc2VTZXREYXRhKGUsIHQsIG4sIHIsIGksIHMgPSB7fSkge1xuICAgIGNvbnN0IG8gPSBlLkNjKHMubWVyZ2UgfHwgcy5tZXJnZUZpZWxkcyA/IDIgLyogVXNlckRhdGFTb3VyY2UuTWVyZ2VTZXQgKi8gOiAwIC8qIFVzZXJEYXRhU291cmNlLlNldCAqLyAsIHQsIG4sIGkpO1xuICAgIF9fUFJJVkFURV92YWxpZGF0ZVBsYWluT2JqZWN0KFwiRGF0YSBtdXN0IGJlIGFuIG9iamVjdCwgYnV0IGl0IHdhczpcIiwgbywgcik7XG4gICAgY29uc3QgXyA9IF9fUFJJVkFURV9wYXJzZU9iamVjdChyLCBvKTtcbiAgICBsZXQgYSwgdTtcbiAgICBpZiAocy5tZXJnZSkgYSA9IG5ldyBGaWVsZE1hc2soby5maWVsZE1hc2spLCB1ID0gby5maWVsZFRyYW5zZm9ybXM7IGVsc2UgaWYgKHMubWVyZ2VGaWVsZHMpIHtcbiAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IHIgb2Ygcy5tZXJnZUZpZWxkcykge1xuICAgICAgICAgICAgY29uc3QgaSA9IF9fUFJJVkFURV9maWVsZFBhdGhGcm9tQXJndW1lbnQkMSh0LCByLCBuKTtcbiAgICAgICAgICAgIGlmICghby5jb250YWlucyhpKSkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgYEZpZWxkICcke2l9JyBpcyBzcGVjaWZpZWQgaW4geW91ciBmaWVsZCBtYXNrIGJ1dCBtaXNzaW5nIGZyb20geW91ciBpbnB1dCBkYXRhLmApO1xuICAgICAgICAgICAgX19QUklWQVRFX2ZpZWxkTWFza0NvbnRhaW5zKGUsIGkpIHx8IGUucHVzaChpKTtcbiAgICAgICAgfVxuICAgICAgICBhID0gbmV3IEZpZWxkTWFzayhlKSwgdSA9IG8uZmllbGRUcmFuc2Zvcm1zLmZpbHRlcigoZSA9PiBhLmNvdmVycyhlLmZpZWxkKSkpO1xuICAgIH0gZWxzZSBhID0gbnVsbCwgdSA9IG8uZmllbGRUcmFuc2Zvcm1zO1xuICAgIHJldHVybiBuZXcgUGFyc2VkU2V0RGF0YShuZXcgT2JqZWN0VmFsdWUoXyksIGEsIHUpO1xufVxuXG5jbGFzcyBfX1BSSVZBVEVfRGVsZXRlRmllbGRWYWx1ZUltcGwgZXh0ZW5kcyBGaWVsZFZhbHVlIHtcbiAgICBfdG9GaWVsZFRyYW5zZm9ybShlKSB7XG4gICAgICAgIGlmICgyIC8qIFVzZXJEYXRhU291cmNlLk1lcmdlU2V0ICovICE9PSBlLkFjKSB0aHJvdyAxIC8qIFVzZXJEYXRhU291cmNlLlVwZGF0ZSAqLyA9PT0gZS5BYyA/IGUuU2MoYCR7dGhpcy5fbWV0aG9kTmFtZX0oKSBjYW4gb25seSBhcHBlYXIgYXQgdGhlIHRvcCBsZXZlbCBvZiB5b3VyIHVwZGF0ZSBkYXRhYCkgOiBlLlNjKGAke3RoaXMuX21ldGhvZE5hbWV9KCkgY2Fubm90IGJlIHVzZWQgd2l0aCBzZXQoKSB1bmxlc3MgeW91IHBhc3Mge21lcmdlOnRydWV9YCk7XG4gICAgICAgIC8vIE5vIHRyYW5zZm9ybSB0byBhZGQgZm9yIGEgZGVsZXRlLCBidXQgd2UgbmVlZCB0byBhZGQgaXQgdG8gb3VyXG4gICAgICAgIC8vIGZpZWxkTWFzayBzbyBpdCBnZXRzIGRlbGV0ZWQuXG4gICAgICAgIHJldHVybiBlLmZpZWxkTWFzay5wdXNoKGUucGF0aCksIG51bGw7XG4gICAgfVxuICAgIGlzRXF1YWwoZSkge1xuICAgICAgICByZXR1cm4gZSBpbnN0YW5jZW9mIF9fUFJJVkFURV9EZWxldGVGaWVsZFZhbHVlSW1wbDtcbiAgICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIGNoaWxkIGNvbnRleHQgZm9yIHBhcnNpbmcgU2VyaWFsaXphYmxlRmllbGRWYWx1ZXMuXG4gKlxuICogVGhpcyBpcyBkaWZmZXJlbnQgdGhhbiBjYWxsaW5nIGBQYXJzZUNvbnRleHQuY29udGV4dFdpdGhgIGJlY2F1c2UgaXQga2VlcHNcbiAqIHRoZSBmaWVsZFRyYW5zZm9ybXMgYW5kIGZpZWxkTWFzayBzZXBhcmF0ZS5cbiAqXG4gKiBUaGUgY3JlYXRlZCBjb250ZXh0IGhhcyBpdHMgYGRhdGFTb3VyY2VgIHNldCB0byBgVXNlckRhdGFTb3VyY2UuQXJndW1lbnRgLlxuICogQWx0aG91Z2ggdGhlc2UgdmFsdWVzIGFyZSB1c2VkIHdpdGggd3JpdGVzLCBhbnkgZWxlbWVudHMgaW4gdGhlc2UgRmllbGRWYWx1ZXNcbiAqIGFyZSBub3QgY29uc2lkZXJlZCB3cml0ZXMgc2luY2UgdGhleSBjYW5ub3QgY29udGFpbiBhbnkgRmllbGRWYWx1ZSBzZW50aW5lbHMsXG4gKiBldGMuXG4gKlxuICogQHBhcmFtIGZpZWxkVmFsdWUgLSBUaGUgc2VudGluZWwgRmllbGRWYWx1ZSBmb3Igd2hpY2ggdG8gY3JlYXRlIGEgY2hpbGRcbiAqICAgICBjb250ZXh0LlxuICogQHBhcmFtIGNvbnRleHQgLSBUaGUgcGFyZW50IGNvbnRleHQuXG4gKiBAcGFyYW0gYXJyYXlFbGVtZW50IC0gV2hldGhlciBvciBub3QgdGhlIEZpZWxkVmFsdWUgaGFzIGFuIGFycmF5LlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9jcmVhdGVTZW50aW5lbENoaWxkQ29udGV4dChlLCB0LCBuKSB7XG4gICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfUGFyc2VDb250ZXh0SW1wbCh7XG4gICAgICAgIEFjOiAzIC8qIFVzZXJEYXRhU291cmNlLkFyZ3VtZW50ICovICxcbiAgICAgICAgRGM6IHQuc2V0dGluZ3MuRGMsXG4gICAgICAgIG1ldGhvZE5hbWU6IGUuX21ldGhvZE5hbWUsXG4gICAgICAgIGZjOiBuXG4gICAgfSwgdC5kYXRhYmFzZUlkLCB0LnNlcmlhbGl6ZXIsIHQuaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcyk7XG59XG5cbmNsYXNzIF9fUFJJVkFURV9TZXJ2ZXJUaW1lc3RhbXBGaWVsZFZhbHVlSW1wbCBleHRlbmRzIEZpZWxkVmFsdWUge1xuICAgIF90b0ZpZWxkVHJhbnNmb3JtKGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBGaWVsZFRyYW5zZm9ybShlLnBhdGgsIG5ldyBfX1BSSVZBVEVfU2VydmVyVGltZXN0YW1wVHJhbnNmb3JtKTtcbiAgICB9XG4gICAgaXNFcXVhbChlKSB7XG4gICAgICAgIHJldHVybiBlIGluc3RhbmNlb2YgX19QUklWQVRFX1NlcnZlclRpbWVzdGFtcEZpZWxkVmFsdWVJbXBsO1xuICAgIH1cbn1cblxuY2xhc3MgX19QUklWQVRFX0FycmF5VW5pb25GaWVsZFZhbHVlSW1wbCBleHRlbmRzIEZpZWxkVmFsdWUge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQpIHtcbiAgICAgICAgc3VwZXIoZSksIHRoaXMudmMgPSB0O1xuICAgIH1cbiAgICBfdG9GaWVsZFRyYW5zZm9ybShlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBfX1BSSVZBVEVfY3JlYXRlU2VudGluZWxDaGlsZENvbnRleHQodGhpcywgZSwgXG4gICAgICAgIC8qYXJyYXk9Ki8gITApLCBuID0gdGhpcy52Yy5tYXAoKGUgPT4gX19QUklWQVRFX3BhcnNlRGF0YShlLCB0KSkpLCByID0gbmV3IF9fUFJJVkFURV9BcnJheVVuaW9uVHJhbnNmb3JtT3BlcmF0aW9uKG4pO1xuICAgICAgICByZXR1cm4gbmV3IEZpZWxkVHJhbnNmb3JtKGUucGF0aCwgcik7XG4gICAgfVxuICAgIGlzRXF1YWwoZSkge1xuICAgICAgICByZXR1cm4gZSBpbnN0YW5jZW9mIF9fUFJJVkFURV9BcnJheVVuaW9uRmllbGRWYWx1ZUltcGwgJiYgZGVlcEVxdWFsKHRoaXMudmMsIGUudmMpO1xuICAgIH1cbn1cblxuY2xhc3MgX19QUklWQVRFX0FycmF5UmVtb3ZlRmllbGRWYWx1ZUltcGwgZXh0ZW5kcyBGaWVsZFZhbHVlIHtcbiAgICBjb25zdHJ1Y3RvcihlLCB0KSB7XG4gICAgICAgIHN1cGVyKGUpLCB0aGlzLnZjID0gdDtcbiAgICB9XG4gICAgX3RvRmllbGRUcmFuc2Zvcm0oZSkge1xuICAgICAgICBjb25zdCB0ID0gX19QUklWQVRFX2NyZWF0ZVNlbnRpbmVsQ2hpbGRDb250ZXh0KHRoaXMsIGUsIFxuICAgICAgICAvKmFycmF5PSovICEwKSwgbiA9IHRoaXMudmMubWFwKChlID0+IF9fUFJJVkFURV9wYXJzZURhdGEoZSwgdCkpKSwgciA9IG5ldyBfX1BSSVZBVEVfQXJyYXlSZW1vdmVUcmFuc2Zvcm1PcGVyYXRpb24obik7XG4gICAgICAgIHJldHVybiBuZXcgRmllbGRUcmFuc2Zvcm0oZS5wYXRoLCByKTtcbiAgICB9XG4gICAgaXNFcXVhbChlKSB7XG4gICAgICAgIHJldHVybiBlIGluc3RhbmNlb2YgX19QUklWQVRFX0FycmF5UmVtb3ZlRmllbGRWYWx1ZUltcGwgJiYgZGVlcEVxdWFsKHRoaXMudmMsIGUudmMpO1xuICAgIH1cbn1cblxuY2xhc3MgX19QUklWQVRFX051bWVyaWNJbmNyZW1lbnRGaWVsZFZhbHVlSW1wbCBleHRlbmRzIEZpZWxkVmFsdWUge1xuICAgIGNvbnN0cnVjdG9yKGUsIHQpIHtcbiAgICAgICAgc3VwZXIoZSksIHRoaXMuRmMgPSB0O1xuICAgIH1cbiAgICBfdG9GaWVsZFRyYW5zZm9ybShlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBuZXcgX19QUklWQVRFX051bWVyaWNJbmNyZW1lbnRUcmFuc2Zvcm1PcGVyYXRpb24oZS5zZXJpYWxpemVyLCB0b051bWJlcihlLnNlcmlhbGl6ZXIsIHRoaXMuRmMpKTtcbiAgICAgICAgcmV0dXJuIG5ldyBGaWVsZFRyYW5zZm9ybShlLnBhdGgsIHQpO1xuICAgIH1cbiAgICBpc0VxdWFsKGUpIHtcbiAgICAgICAgcmV0dXJuIGUgaW5zdGFuY2VvZiBfX1BSSVZBVEVfTnVtZXJpY0luY3JlbWVudEZpZWxkVmFsdWVJbXBsICYmIHRoaXMuRmMgPT09IGUuRmM7XG4gICAgfVxufVxuXG4vKiogUGFyc2UgdXBkYXRlIGRhdGEgZnJvbSBhbiB1cGRhdGUoKSBjYWxsLiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfcGFyc2VVcGRhdGVEYXRhKGUsIHQsIG4sIHIpIHtcbiAgICBjb25zdCBpID0gZS5DYygxIC8qIFVzZXJEYXRhU291cmNlLlVwZGF0ZSAqLyAsIHQsIG4pO1xuICAgIF9fUFJJVkFURV92YWxpZGF0ZVBsYWluT2JqZWN0KFwiRGF0YSBtdXN0IGJlIGFuIG9iamVjdCwgYnV0IGl0IHdhczpcIiwgaSwgcik7XG4gICAgY29uc3QgcyA9IFtdLCBvID0gT2JqZWN0VmFsdWUuZW1wdHkoKTtcbiAgICBmb3JFYWNoKHIsICgoZSwgcikgPT4ge1xuICAgICAgICBjb25zdCBfID0gX19QUklWQVRFX2ZpZWxkUGF0aEZyb21Eb3RTZXBhcmF0ZWRTdHJpbmcodCwgZSwgbik7XG4gICAgICAgIC8vIEZvciBDb21wYXQgdHlwZXMsIHdlIGhhdmUgdG8gXCJleHRyYWN0XCIgdGhlIHVuZGVybHlpbmcgdHlwZXMgYmVmb3JlXG4gICAgICAgIC8vIHBlcmZvcm1pbmcgdmFsaWRhdGlvbi5cbiAgICAgICAgICAgICAgICByID0gZ2V0TW9kdWxhckluc3RhbmNlKHIpO1xuICAgICAgICBjb25zdCBhID0gaS55YyhfKTtcbiAgICAgICAgaWYgKHIgaW5zdGFuY2VvZiBfX1BSSVZBVEVfRGVsZXRlRmllbGRWYWx1ZUltcGwpIFxuICAgICAgICAvLyBBZGQgaXQgdG8gdGhlIGZpZWxkIG1hc2ssIGJ1dCBkb24ndCBhZGQgYW55dGhpbmcgdG8gdXBkYXRlRGF0YS5cbiAgICAgICAgcy5wdXNoKF8pOyBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBfX1BSSVZBVEVfcGFyc2VEYXRhKHIsIGEpO1xuICAgICAgICAgICAgbnVsbCAhPSBlICYmIChzLnB1c2goXyksIG8uc2V0KF8sIGUpKTtcbiAgICAgICAgfVxuICAgIH0pKTtcbiAgICBjb25zdCBfID0gbmV3IEZpZWxkTWFzayhzKTtcbiAgICByZXR1cm4gbmV3IFBhcnNlZFVwZGF0ZURhdGEobywgXywgaS5maWVsZFRyYW5zZm9ybXMpO1xufVxuXG4vKiogUGFyc2UgdXBkYXRlIGRhdGEgZnJvbSBhIGxpc3Qgb2YgZmllbGQvdmFsdWUgYXJndW1lbnRzLiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfcGFyc2VVcGRhdGVWYXJhcmdzKGUsIHQsIG4sIHIsIGksIHMpIHtcbiAgICBjb25zdCBvID0gZS5DYygxIC8qIFVzZXJEYXRhU291cmNlLlVwZGF0ZSAqLyAsIHQsIG4pLCBfID0gWyBfX1BSSVZBVEVfZmllbGRQYXRoRnJvbUFyZ3VtZW50JDEodCwgciwgbikgXSwgYSA9IFsgaSBdO1xuICAgIGlmIChzLmxlbmd0aCAlIDIgIT0gMCkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgYEZ1bmN0aW9uICR7dH0oKSBuZWVkcyB0byBiZSBjYWxsZWQgd2l0aCBhbiBldmVuIG51bWJlciBvZiBhcmd1bWVudHMgdGhhdCBhbHRlcm5hdGUgYmV0d2VlbiBmaWVsZCBuYW1lcyBhbmQgdmFsdWVzLmApO1xuICAgIGZvciAobGV0IGUgPSAwOyBlIDwgcy5sZW5ndGg7IGUgKz0gMikgXy5wdXNoKF9fUFJJVkFURV9maWVsZFBhdGhGcm9tQXJndW1lbnQkMSh0LCBzW2VdKSksIFxuICAgIGEucHVzaChzW2UgKyAxXSk7XG4gICAgY29uc3QgdSA9IFtdLCBjID0gT2JqZWN0VmFsdWUuZW1wdHkoKTtcbiAgICAvLyBXZSBpdGVyYXRlIGluIHJldmVyc2Ugb3JkZXIgdG8gcGljayB0aGUgbGFzdCB2YWx1ZSBmb3IgYSBmaWVsZCBpZiB0aGVcbiAgICAvLyB1c2VyIHNwZWNpZmllZCB0aGUgZmllbGQgbXVsdGlwbGUgdGltZXMuXG4gICAgZm9yIChsZXQgZSA9IF8ubGVuZ3RoIC0gMTsgZSA+PSAwOyAtLWUpIGlmICghX19QUklWQVRFX2ZpZWxkTWFza0NvbnRhaW5zKHUsIF9bZV0pKSB7XG4gICAgICAgIGNvbnN0IHQgPSBfW2VdO1xuICAgICAgICBsZXQgbiA9IGFbZV07XG4gICAgICAgIC8vIEZvciBDb21wYXQgdHlwZXMsIHdlIGhhdmUgdG8gXCJleHRyYWN0XCIgdGhlIHVuZGVybHlpbmcgdHlwZXMgYmVmb3JlXG4gICAgICAgIC8vIHBlcmZvcm1pbmcgdmFsaWRhdGlvbi5cbiAgICAgICAgICAgICAgICBuID0gZ2V0TW9kdWxhckluc3RhbmNlKG4pO1xuICAgICAgICBjb25zdCByID0gby55Yyh0KTtcbiAgICAgICAgaWYgKG4gaW5zdGFuY2VvZiBfX1BSSVZBVEVfRGVsZXRlRmllbGRWYWx1ZUltcGwpIFxuICAgICAgICAvLyBBZGQgaXQgdG8gdGhlIGZpZWxkIG1hc2ssIGJ1dCBkb24ndCBhZGQgYW55dGhpbmcgdG8gdXBkYXRlRGF0YS5cbiAgICAgICAgdS5wdXNoKHQpOyBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBfX1BSSVZBVEVfcGFyc2VEYXRhKG4sIHIpO1xuICAgICAgICAgICAgbnVsbCAhPSBlICYmICh1LnB1c2godCksIGMuc2V0KHQsIGUpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBsID0gbmV3IEZpZWxkTWFzayh1KTtcbiAgICByZXR1cm4gbmV3IFBhcnNlZFVwZGF0ZURhdGEoYywgbCwgby5maWVsZFRyYW5zZm9ybXMpO1xufVxuXG4vKipcbiAqIFBhcnNlIGEgXCJxdWVyeSB2YWx1ZVwiIChlLmcuIHZhbHVlIGluIGEgd2hlcmUgZmlsdGVyIG9yIGEgdmFsdWUgaW4gYSBjdXJzb3JcbiAqIGJvdW5kKS5cbiAqXG4gKiBAcGFyYW0gYWxsb3dBcnJheXMgLSBXaGV0aGVyIHRoZSBxdWVyeSB2YWx1ZSBpcyBhbiBhcnJheSB0aGF0IG1heSBkaXJlY3RseVxuICogY29udGFpbiBhZGRpdGlvbmFsIGFycmF5cyAoZS5nLiB0aGUgb3BlcmFuZCBvZiBhbiBgaW5gIHF1ZXJ5KS5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfcGFyc2VRdWVyeVZhbHVlKGUsIHQsIG4sIHIgPSAhMSkge1xuICAgIHJldHVybiBfX1BSSVZBVEVfcGFyc2VEYXRhKG4sIGUuQ2MociA/IDQgLyogVXNlckRhdGFTb3VyY2UuQXJyYXlBcmd1bWVudCAqLyA6IDMgLyogVXNlckRhdGFTb3VyY2UuQXJndW1lbnQgKi8gLCB0KSk7XG59XG5cbi8qKlxuICogUGFyc2VzIHVzZXIgZGF0YSB0byBQcm90b2J1ZiBWYWx1ZXMuXG4gKlxuICogQHBhcmFtIGlucHV0IC0gRGF0YSB0byBiZSBwYXJzZWQuXG4gKiBAcGFyYW0gY29udGV4dCAtIEEgY29udGV4dCBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBjdXJyZW50IHBhdGggYmVpbmcgcGFyc2VkLFxuICogdGhlIHNvdXJjZSBvZiB0aGUgZGF0YSBiZWluZyBwYXJzZWQsIGV0Yy5cbiAqIEByZXR1cm5zIFRoZSBwYXJzZWQgdmFsdWUsIG9yIG51bGwgaWYgdGhlIHZhbHVlIHdhcyBhIEZpZWxkVmFsdWUgc2VudGluZWxcbiAqIHRoYXQgc2hvdWxkIG5vdCBiZSBpbmNsdWRlZCBpbiB0aGUgcmVzdWx0aW5nIHBhcnNlZCBkYXRhLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9wYXJzZURhdGEoZSwgdCkge1xuICAgIGlmIChfX1BSSVZBVEVfbG9va3NMaWtlSnNvbk9iamVjdChcbiAgICAvLyBVbndyYXAgdGhlIEFQSSB0eXBlIGZyb20gdGhlIENvbXBhdCBTREsuIFRoaXMgd2lsbCByZXR1cm4gdGhlIEFQSSB0eXBlXG4gICAgLy8gZnJvbSBmaXJlc3RvcmUtZXhwLlxuICAgIGUgPSBnZXRNb2R1bGFySW5zdGFuY2UoZSkpKSByZXR1cm4gX19QUklWQVRFX3ZhbGlkYXRlUGxhaW5PYmplY3QoXCJVbnN1cHBvcnRlZCBmaWVsZCB2YWx1ZTpcIiwgdCwgZSksIFxuICAgIF9fUFJJVkFURV9wYXJzZU9iamVjdChlLCB0KTtcbiAgICBpZiAoZSBpbnN0YW5jZW9mIEZpZWxkVmFsdWUpIFxuICAgIC8vIEZpZWxkVmFsdWVzIHVzdWFsbHkgcGFyc2UgaW50byB0cmFuc2Zvcm1zIChleGNlcHQgZGVsZXRlRmllbGQoKSlcbiAgICAvLyBpbiB3aGljaCBjYXNlIHdlIGRvIG5vdCB3YW50IHRvIGluY2x1ZGUgdGhpcyBmaWVsZCBpbiBvdXIgcGFyc2VkIGRhdGFcbiAgICAvLyAoYXMgZG9pbmcgc28gd2lsbCBvdmVyd3JpdGUgdGhlIGZpZWxkIGRpcmVjdGx5IHByaW9yIHRvIHRoZSB0cmFuc2Zvcm1cbiAgICAvLyB0cnlpbmcgdG8gdHJhbnNmb3JtIGl0KS4gU28gd2UgZG9uJ3QgYWRkIHRoaXMgbG9jYXRpb24gdG9cbiAgICAvLyBjb250ZXh0LmZpZWxkTWFzayBhbmQgd2UgcmV0dXJuIG51bGwgYXMgb3VyIHBhcnNpbmcgcmVzdWx0LlxuICAgIC8qKlxuICogXCJQYXJzZXNcIiB0aGUgcHJvdmlkZWQgRmllbGRWYWx1ZUltcGwsIGFkZGluZyBhbnkgbmVjZXNzYXJ5IHRyYW5zZm9ybXMgdG9cbiAqIGNvbnRleHQuZmllbGRUcmFuc2Zvcm1zLlxuICovXG4gICAgcmV0dXJuIGZ1bmN0aW9uIF9fUFJJVkFURV9wYXJzZVNlbnRpbmVsRmllbGRWYWx1ZShlLCB0KSB7XG4gICAgICAgIC8vIFNlbnRpbmVscyBhcmUgb25seSBzdXBwb3J0ZWQgd2l0aCB3cml0ZXMsIGFuZCBub3Qgd2l0aGluIGFycmF5cy5cbiAgICAgICAgaWYgKCFfX1BSSVZBVEVfaXNXcml0ZSh0LkFjKSkgdGhyb3cgdC5TYyhgJHtlLl9tZXRob2ROYW1lfSgpIGNhbiBvbmx5IGJlIHVzZWQgd2l0aCB1cGRhdGUoKSBhbmQgc2V0KClgKTtcbiAgICAgICAgaWYgKCF0LnBhdGgpIHRocm93IHQuU2MoYCR7ZS5fbWV0aG9kTmFtZX0oKSBpcyBub3QgY3VycmVudGx5IHN1cHBvcnRlZCBpbnNpZGUgYXJyYXlzYCk7XG4gICAgICAgIGNvbnN0IG4gPSBlLl90b0ZpZWxkVHJhbnNmb3JtKHQpO1xuICAgICAgICBuICYmIHQuZmllbGRUcmFuc2Zvcm1zLnB1c2gobik7XG4gICAgfVxuICAgIC8qKlxuICogSGVscGVyIHRvIHBhcnNlIGEgc2NhbGFyIHZhbHVlIChpLmUuIG5vdCBhbiBPYmplY3QsIEFycmF5LCBvciBGaWVsZFZhbHVlKVxuICpcbiAqIEByZXR1cm5zIFRoZSBwYXJzZWQgdmFsdWVcbiAqLyAoZSwgdCksIG51bGw7XG4gICAgaWYgKHZvaWQgMCA9PT0gZSAmJiB0Lmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMpIFxuICAgIC8vIElmIHRoZSBpbnB1dCBpcyB1bmRlZmluZWQgaXQgY2FuIG5ldmVyIHBhcnRpY2lwYXRlIGluIHRoZSBmaWVsZE1hc2ssIHNvXG4gICAgLy8gZG9uJ3QgaGFuZGxlIHRoaXMgYmVsb3cuIElmIGBpZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzYCBpcyBmYWxzZSxcbiAgICAvLyBgcGFyc2VTY2FsYXJWYWx1ZWAgd2lsbCByZWplY3QgYW4gdW5kZWZpbmVkIHZhbHVlLlxuICAgIHJldHVybiBudWxsO1xuICAgIGlmIChcbiAgICAvLyBJZiBjb250ZXh0LnBhdGggaXMgbnVsbCB3ZSBhcmUgaW5zaWRlIGFuIGFycmF5IGFuZCB3ZSBkb24ndCBzdXBwb3J0XG4gICAgLy8gZmllbGQgbWFzayBwYXRocyBtb3JlIGdyYW51bGFyIHRoYW4gdGhlIHRvcC1sZXZlbCBhcnJheS5cbiAgICB0LnBhdGggJiYgdC5maWVsZE1hc2sucHVzaCh0LnBhdGgpLCBlIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgLy8gVE9ETyhiLzM0ODcxMTMxKTogSW5jbHVkZSB0aGUgcGF0aCBjb250YWluaW5nIHRoZSBhcnJheSBpbiB0aGUgZXJyb3JcbiAgICAgICAgLy8gbWVzc2FnZS5cbiAgICAgICAgLy8gSW4gdGhlIGNhc2Ugb2YgSU4gcXVlcmllcywgdGhlIHBhcnNlZCBkYXRhIGlzIGFuIGFycmF5IChyZXByZXNlbnRpbmdcbiAgICAgICAgLy8gdGhlIHNldCBvZiB2YWx1ZXMgdG8gYmUgaW5jbHVkZWQgZm9yIHRoZSBJTiBxdWVyeSkgdGhhdCBtYXkgZGlyZWN0bHlcbiAgICAgICAgLy8gY29udGFpbiBhZGRpdGlvbmFsIGFycmF5cyAoZWFjaCByZXByZXNlbnRpbmcgYW4gaW5kaXZpZHVhbCBmaWVsZFxuICAgICAgICAvLyB2YWx1ZSksIHNvIHdlIGRpc2FibGUgdGhpcyB2YWxpZGF0aW9uLlxuICAgICAgICBpZiAodC5zZXR0aW5ncy5mYyAmJiA0IC8qIFVzZXJEYXRhU291cmNlLkFycmF5QXJndW1lbnQgKi8gIT09IHQuQWMpIHRocm93IHQuU2MoXCJOZXN0ZWQgYXJyYXlzIGFyZSBub3Qgc3VwcG9ydGVkXCIpO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX3BhcnNlQXJyYXkoZSwgdCkge1xuICAgICAgICAgICAgY29uc3QgbiA9IFtdO1xuICAgICAgICAgICAgbGV0IHIgPSAwO1xuICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIGUpIHtcbiAgICAgICAgICAgICAgICBsZXQgZSA9IF9fUFJJVkFURV9wYXJzZURhdGEoaSwgdC53YyhyKSk7XG4gICAgICAgICAgICAgICAgbnVsbCA9PSBlICYmIChcbiAgICAgICAgICAgICAgICAvLyBKdXN0IGluY2x1ZGUgbnVsbHMgaW4gdGhlIGFycmF5IGZvciBmaWVsZHMgYmVpbmcgcmVwbGFjZWQgd2l0aCBhXG4gICAgICAgICAgICAgICAgLy8gc2VudGluZWwuXG4gICAgICAgICAgICAgICAgZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgbnVsbFZhbHVlOiBcIk5VTExfVkFMVUVcIlxuICAgICAgICAgICAgICAgIH0pLCBuLnB1c2goZSksIHIrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgYXJyYXlWYWx1ZToge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KGUsIHQpO1xuICAgIH1cbiAgICByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX3BhcnNlU2NhbGFyVmFsdWUoZSwgdCkge1xuICAgICAgICBpZiAobnVsbCA9PT0gKGUgPSBnZXRNb2R1bGFySW5zdGFuY2UoZSkpKSByZXR1cm4ge1xuICAgICAgICAgICAgbnVsbFZhbHVlOiBcIk5VTExfVkFMVUVcIlxuICAgICAgICB9O1xuICAgICAgICBpZiAoXCJudW1iZXJcIiA9PSB0eXBlb2YgZSkgcmV0dXJuIHRvTnVtYmVyKHQuc2VyaWFsaXplciwgZSk7XG4gICAgICAgIGlmIChcImJvb2xlYW5cIiA9PSB0eXBlb2YgZSkgcmV0dXJuIHtcbiAgICAgICAgICAgIGJvb2xlYW5WYWx1ZTogZVxuICAgICAgICB9O1xuICAgICAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgZSkgcmV0dXJuIHtcbiAgICAgICAgICAgIHN0cmluZ1ZhbHVlOiBlXG4gICAgICAgIH07XG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IFRpbWVzdGFtcC5mcm9tRGF0ZShlKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdGltZXN0YW1wVmFsdWU6IHRvVGltZXN0YW1wKHQuc2VyaWFsaXplciwgbilcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBUaW1lc3RhbXApIHtcbiAgICAgICAgICAgIC8vIEZpcmVzdG9yZSBiYWNrZW5kIHRydW5jYXRlcyBwcmVjaXNpb24gZG93biB0byBtaWNyb3NlY29uZHMuIFRvIGVuc3VyZVxuICAgICAgICAgICAgLy8gb2ZmbGluZSBtb2RlIHdvcmtzIHRoZSBzYW1lIHdpdGggcmVnYXJkcyB0byB0cnVuY2F0aW9uLCBwZXJmb3JtIHRoZVxuICAgICAgICAgICAgLy8gdHJ1bmNhdGlvbiBpbW1lZGlhdGVseSB3aXRob3V0IHdhaXRpbmcgZm9yIHRoZSBiYWNrZW5kIHRvIGRvIHRoYXQuXG4gICAgICAgICAgICBjb25zdCBuID0gbmV3IFRpbWVzdGFtcChlLnNlY29uZHMsIDFlMyAqIE1hdGguZmxvb3IoZS5uYW5vc2Vjb25kcyAvIDFlMykpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXBWYWx1ZTogdG9UaW1lc3RhbXAodC5zZXJpYWxpemVyLCBuKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEdlb1BvaW50KSByZXR1cm4ge1xuICAgICAgICAgICAgZ2VvUG9pbnRWYWx1ZToge1xuICAgICAgICAgICAgICAgIGxhdGl0dWRlOiBlLmxhdGl0dWRlLFxuICAgICAgICAgICAgICAgIGxvbmdpdHVkZTogZS5sb25naXR1ZGVcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBCeXRlcykgcmV0dXJuIHtcbiAgICAgICAgICAgIGJ5dGVzVmFsdWU6IF9fUFJJVkFURV90b0J5dGVzKHQuc2VyaWFsaXplciwgZS5fYnl0ZVN0cmluZylcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBEb2N1bWVudFJlZmVyZW5jZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQuZGF0YWJhc2VJZCwgciA9IGUuZmlyZXN0b3JlLl9kYXRhYmFzZUlkO1xuICAgICAgICAgICAgaWYgKCFyLmlzRXF1YWwobikpIHRocm93IHQuU2MoYERvY3VtZW50IHJlZmVyZW5jZSBpcyBmb3IgZGF0YWJhc2UgJHtyLnByb2plY3RJZH0vJHtyLmRhdGFiYXNlfSBidXQgc2hvdWxkIGJlIGZvciBkYXRhYmFzZSAke24ucHJvamVjdElkfS8ke24uZGF0YWJhc2V9YCk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHJlZmVyZW5jZVZhbHVlOiBfX1BSSVZBVEVfdG9SZXNvdXJjZU5hbWUoZS5maXJlc3RvcmUuX2RhdGFiYXNlSWQgfHwgdC5kYXRhYmFzZUlkLCBlLl9rZXkucGF0aClcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBWZWN0b3JWYWx1ZSkgXG4gICAgICAgIC8qKlxuICogQ3JlYXRlcyBhIG5ldyBWZWN0b3JWYWx1ZSBwcm90byB2YWx1ZSAodXNpbmcgdGhlIGludGVybmFsIGZvcm1hdCkuXG4gKi9cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIF9fUFJJVkFURV9wYXJzZVZlY3RvclZhbHVlKGUsIHQpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB7XG4gICAgICAgICAgICAgICAgZmllbGRzOiB7XG4gICAgICAgICAgICAgICAgICAgIFtodF06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZ1ZhbHVlOiBJdFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBbRXRdOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcnJheVZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBlLnRvQXJyYXkoKS5tYXAoKGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXCJudW1iZXJcIiAhPSB0eXBlb2YgZSkgdGhyb3cgdC5TYyhcIlZlY3RvclZhbHVlcyBtdXN0IG9ubHkgY29udGFpbiBudW1lcmljIHZhbHVlcy5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfX1BSSVZBVEVfdG9Eb3VibGUodC5zZXJpYWxpemVyLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG1hcFZhbHVlOiBuXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogQ2hlY2tzIHdoZXRoZXIgYW4gb2JqZWN0IGxvb2tzIGxpa2UgYSBKU09OIG9iamVjdCB0aGF0IHNob3VsZCBiZSBjb252ZXJ0ZWRcbiAqIGludG8gYSBzdHJ1Y3QuIE5vcm1hbCBjbGFzcy9wcm90b3R5cGUgaW5zdGFuY2VzIGFyZSBjb25zaWRlcmVkIHRvIGxvb2sgbGlrZVxuICogSlNPTiBvYmplY3RzIHNpbmNlIHRoZXkgc2hvdWxkIGJlIGNvbnZlcnRlZCB0byBhIHN0cnVjdCB2YWx1ZS4gQXJyYXlzLCBEYXRlcyxcbiAqIEdlb1BvaW50cywgZXRjLiBhcmUgbm90IGNvbnNpZGVyZWQgdG8gbG9vayBsaWtlIEpTT04gb2JqZWN0cyBzaW5jZSB0aGV5IG1hcFxuICogdG8gc3BlY2lmaWMgRmllbGRWYWx1ZSB0eXBlcyBvdGhlciB0aGFuIE9iamVjdFZhbHVlLlxuICovIChlLCB0KTtcbiAgICAgICAgdGhyb3cgdC5TYyhgVW5zdXBwb3J0ZWQgZmllbGQgdmFsdWU6ICR7X19QUklWQVRFX3ZhbHVlRGVzY3JpcHRpb24oZSl9YCk7XG4gICAgfShlLCB0KTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX3BhcnNlT2JqZWN0KGUsIHQpIHtcbiAgICBjb25zdCBuID0ge307XG4gICAgcmV0dXJuIGlzRW1wdHkoZSkgPyBcbiAgICAvLyBJZiB3ZSBlbmNvdW50ZXIgYW4gZW1wdHkgb2JqZWN0LCB3ZSBleHBsaWNpdGx5IGFkZCBpdCB0byB0aGUgdXBkYXRlXG4gICAgLy8gbWFzayB0byBlbnN1cmUgdGhhdCB0aGUgc2VydmVyIGNyZWF0ZXMgYSBtYXAgZW50cnkuXG4gICAgdC5wYXRoICYmIHQucGF0aC5sZW5ndGggPiAwICYmIHQuZmllbGRNYXNrLnB1c2godC5wYXRoKSA6IGZvckVhY2goZSwgKChlLCByKSA9PiB7XG4gICAgICAgIGNvbnN0IGkgPSBfX1BSSVZBVEVfcGFyc2VEYXRhKHIsIHQubWMoZSkpO1xuICAgICAgICBudWxsICE9IGkgJiYgKG5bZV0gPSBpKTtcbiAgICB9KSksIHtcbiAgICAgICAgbWFwVmFsdWU6IHtcbiAgICAgICAgICAgIGZpZWxkczogblxuICAgICAgICB9XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2xvb2tzTGlrZUpzb25PYmplY3QoZSkge1xuICAgIHJldHVybiAhKFwib2JqZWN0XCIgIT0gdHlwZW9mIGUgfHwgbnVsbCA9PT0gZSB8fCBlIGluc3RhbmNlb2YgQXJyYXkgfHwgZSBpbnN0YW5jZW9mIERhdGUgfHwgZSBpbnN0YW5jZW9mIFRpbWVzdGFtcCB8fCBlIGluc3RhbmNlb2YgR2VvUG9pbnQgfHwgZSBpbnN0YW5jZW9mIEJ5dGVzIHx8IGUgaW5zdGFuY2VvZiBEb2N1bWVudFJlZmVyZW5jZSB8fCBlIGluc3RhbmNlb2YgRmllbGRWYWx1ZSB8fCBlIGluc3RhbmNlb2YgVmVjdG9yVmFsdWUpO1xufVxuXG5mdW5jdGlvbiBfX1BSSVZBVEVfdmFsaWRhdGVQbGFpbk9iamVjdChlLCB0LCBuKSB7XG4gICAgaWYgKCFfX1BSSVZBVEVfbG9va3NMaWtlSnNvbk9iamVjdChuKSB8fCAhX19QUklWQVRFX2lzUGxhaW5PYmplY3QobikpIHtcbiAgICAgICAgY29uc3QgciA9IF9fUFJJVkFURV92YWx1ZURlc2NyaXB0aW9uKG4pO1xuICAgICAgICB0aHJvdyBcImFuIG9iamVjdFwiID09PSByID8gdC5TYyhlICsgXCIgYSBjdXN0b20gb2JqZWN0XCIpIDogdC5TYyhlICsgXCIgXCIgKyByKTtcbiAgICB9XG59XG5cbi8qKlxuICogSGVscGVyIHRoYXQgY2FsbHMgZnJvbURvdFNlcGFyYXRlZFN0cmluZygpIGJ1dCB3cmFwcyBhbnkgZXJyb3IgdGhyb3duLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9maWVsZFBhdGhGcm9tQXJndW1lbnQkMShlLCB0LCBuKSB7XG4gICAgaWYgKChcbiAgICAvLyBJZiByZXF1aXJlZCwgcmVwbGFjZSB0aGUgRmllbGRQYXRoIENvbXBhdCBjbGFzcyB3aXRoIHRoZSBmaXJlc3RvcmUtZXhwXG4gICAgLy8gRmllbGRQYXRoLlxuICAgIHQgPSBnZXRNb2R1bGFySW5zdGFuY2UodCkpIGluc3RhbmNlb2YgRmllbGRQYXRoKSByZXR1cm4gdC5faW50ZXJuYWxQYXRoO1xuICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiB0KSByZXR1cm4gX19QUklWQVRFX2ZpZWxkUGF0aEZyb21Eb3RTZXBhcmF0ZWRTdHJpbmcoZSwgdCk7XG4gICAgdGhyb3cgX19QUklWQVRFX2NyZWF0ZUVycm9yKFwiRmllbGQgcGF0aCBhcmd1bWVudHMgbXVzdCBiZSBvZiB0eXBlIHN0cmluZyBvciBcIiwgZSwgXG4gICAgLyogaGFzQ29udmVydGVyPSAqLyAhMSwgXG4gICAgLyogcGF0aD0gKi8gdm9pZCAwLCBuKTtcbn1cblxuLyoqXG4gKiBNYXRjaGVzIGFueSBjaGFyYWN0ZXJzIGluIGEgZmllbGQgcGF0aCBzdHJpbmcgdGhhdCBhcmUgcmVzZXJ2ZWQuXG4gKi8gY29uc3QgUG4gPSBuZXcgUmVnRXhwKFwiW35cXFxcKi9cXFxcW1xcXFxdXVwiKTtcblxuLyoqXG4gKiBXcmFwcyBmcm9tRG90U2VwYXJhdGVkU3RyaW5nIHdpdGggYW4gZXJyb3IgbWVzc2FnZSBhYm91dCB0aGUgbWV0aG9kIHRoYXRcbiAqIHdhcyB0aHJvd24uXG4gKiBAcGFyYW0gbWV0aG9kTmFtZSAtIFRoZSBwdWJsaWNseSB2aXNpYmxlIG1ldGhvZCBuYW1lXG4gKiBAcGFyYW0gcGF0aCAtIFRoZSBkb3Qtc2VwYXJhdGVkIHN0cmluZyBmb3JtIG9mIGEgZmllbGQgcGF0aCB3aGljaCB3aWxsIGJlXG4gKiBzcGxpdCBvbiBkb3RzLlxuICogQHBhcmFtIHRhcmdldERvYyAtIFRoZSBkb2N1bWVudCBhZ2FpbnN0IHdoaWNoIHRoZSBmaWVsZCBwYXRoIHdpbGwgYmVcbiAqIGV2YWx1YXRlZC5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfZmllbGRQYXRoRnJvbURvdFNlcGFyYXRlZFN0cmluZyhlLCB0LCBuKSB7XG4gICAgaWYgKHQuc2VhcmNoKFBuKSA+PSAwKSB0aHJvdyBfX1BSSVZBVEVfY3JlYXRlRXJyb3IoYEludmFsaWQgZmllbGQgcGF0aCAoJHt0fSkuIFBhdGhzIG11c3Qgbm90IGNvbnRhaW4gJ34nLCAnKicsICcvJywgJ1snLCBvciAnXSdgLCBlLCBcbiAgICAvKiBoYXNDb252ZXJ0ZXI9ICovICExLCBcbiAgICAvKiBwYXRoPSAqLyB2b2lkIDAsIG4pO1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBuZXcgRmllbGRQYXRoKC4uLnQuc3BsaXQoXCIuXCIpKS5faW50ZXJuYWxQYXRoO1xuICAgIH0gY2F0Y2ggKHIpIHtcbiAgICAgICAgdGhyb3cgX19QUklWQVRFX2NyZWF0ZUVycm9yKGBJbnZhbGlkIGZpZWxkIHBhdGggKCR7dH0pLiBQYXRocyBtdXN0IG5vdCBiZSBlbXB0eSwgYmVnaW4gd2l0aCAnLicsIGVuZCB3aXRoICcuJywgb3IgY29udGFpbiAnLi4nYCwgZSwgXG4gICAgICAgIC8qIGhhc0NvbnZlcnRlcj0gKi8gITEsIFxuICAgICAgICAvKiBwYXRoPSAqLyB2b2lkIDAsIG4pO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX2NyZWF0ZUVycm9yKGUsIHQsIG4sIHIsIGkpIHtcbiAgICBjb25zdCBzID0gciAmJiAhci5pc0VtcHR5KCksIG8gPSB2b2lkIDAgIT09IGk7XG4gICAgbGV0IF8gPSBgRnVuY3Rpb24gJHt0fSgpIGNhbGxlZCB3aXRoIGludmFsaWQgZGF0YWA7XG4gICAgbiAmJiAoXyArPSBcIiAodmlhIGB0b0ZpcmVzdG9yZSgpYClcIiksIF8gKz0gXCIuIFwiO1xuICAgIGxldCBhID0gXCJcIjtcbiAgICByZXR1cm4gKHMgfHwgbykgJiYgKGEgKz0gXCIgKGZvdW5kXCIsIHMgJiYgKGEgKz0gYCBpbiBmaWVsZCAke3J9YCksIG8gJiYgKGEgKz0gYCBpbiBkb2N1bWVudCAke2l9YCksIFxuICAgIGEgKz0gXCIpXCIpLCBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBfICsgZSArIGEpO1xufVxuXG4vKiogQ2hlY2tzIGBoYXlzdGFja2AgaWYgRmllbGRQYXRoIGBuZWVkbGVgIGlzIHByZXNlbnQuIFJ1bnMgaW4gTyhuKS4gKi8gZnVuY3Rpb24gX19QUklWQVRFX2ZpZWxkTWFza0NvbnRhaW5zKGUsIHQpIHtcbiAgICByZXR1cm4gZS5zb21lKChlID0+IGUuaXNFcXVhbCh0KSkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGBEb2N1bWVudFNuYXBzaG90YCBjb250YWlucyBkYXRhIHJlYWQgZnJvbSBhIGRvY3VtZW50IGluIHlvdXIgRmlyZXN0b3JlXG4gKiBkYXRhYmFzZS4gVGhlIGRhdGEgY2FuIGJlIGV4dHJhY3RlZCB3aXRoIGAuZGF0YSgpYCBvciBgLmdldCg8ZmllbGQ+KWAgdG9cbiAqIGdldCBhIHNwZWNpZmljIGZpZWxkLlxuICpcbiAqIEZvciBhIGBEb2N1bWVudFNuYXBzaG90YCB0aGF0IHBvaW50cyB0byBhIG5vbi1leGlzdGluZyBkb2N1bWVudCwgYW55IGRhdGFcbiAqIGFjY2VzcyB3aWxsIHJldHVybiAndW5kZWZpbmVkJy4gWW91IGNhbiB1c2UgdGhlIGBleGlzdHMoKWAgbWV0aG9kIHRvXG4gKiBleHBsaWNpdGx5IHZlcmlmeSBhIGRvY3VtZW50J3MgZXhpc3RlbmNlLlxuICovIGNsYXNzIERvY3VtZW50U25hcHNob3QkMSB7XG4gICAgLy8gTm90ZTogVGhpcyBjbGFzcyBpcyBzdHJpcHBlZCBkb3duIHZlcnNpb24gb2YgdGhlIERvY3VtZW50U25hcHNob3QgaW5cbiAgICAvLyB0aGUgbGVnYWN5IFNESy4gVGhlIGNoYW5nZXMgYXJlOlxuICAgIC8vIC0gTm8gc3VwcG9ydCBmb3IgU25hcHNob3RNZXRhZGF0YS5cbiAgICAvLyAtIE5vIHN1cHBvcnQgZm9yIFNuYXBzaG90T3B0aW9ucy5cbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciBwcm90ZWN0ZWQgKi9cbiAgICBjb25zdHJ1Y3RvcihlLCB0LCBuLCByLCBpKSB7XG4gICAgICAgIHRoaXMuX2ZpcmVzdG9yZSA9IGUsIHRoaXMuX3VzZXJEYXRhV3JpdGVyID0gdCwgdGhpcy5fa2V5ID0gbiwgdGhpcy5fZG9jdW1lbnQgPSByLCBcbiAgICAgICAgdGhpcy5fY29udmVydGVyID0gaTtcbiAgICB9XG4gICAgLyoqIFByb3BlcnR5IG9mIHRoZSBgRG9jdW1lbnRTbmFwc2hvdGAgdGhhdCBwcm92aWRlcyB0aGUgZG9jdW1lbnQncyBJRC4gKi8gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fa2V5LnBhdGgubGFzdFNlZ21lbnQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGBEb2N1bWVudFJlZmVyZW5jZWAgZm9yIHRoZSBkb2N1bWVudCBpbmNsdWRlZCBpbiB0aGUgYERvY3VtZW50U25hcHNob3RgLlxuICAgICAqLyAgICBnZXQgcmVmKCkge1xuICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50UmVmZXJlbmNlKHRoaXMuX2ZpcmVzdG9yZSwgdGhpcy5fY29udmVydGVyLCB0aGlzLl9rZXkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTaWduYWxzIHdoZXRoZXIgb3Igbm90IHRoZSBkb2N1bWVudCBhdCB0aGUgc25hcHNob3QncyBsb2NhdGlvbiBleGlzdHMuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB0cnVlIGlmIHRoZSBkb2N1bWVudCBleGlzdHMuXG4gICAgICovICAgIGV4aXN0cygpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgIT09IHRoaXMuX2RvY3VtZW50O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZXMgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQgYXMgYW4gYE9iamVjdGAuIFJldHVybnMgYHVuZGVmaW5lZGAgaWZcbiAgICAgKiB0aGUgZG9jdW1lbnQgZG9lc24ndCBleGlzdC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIEFuIGBPYmplY3RgIGNvbnRhaW5pbmcgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQgb3IgYHVuZGVmaW5lZGBcbiAgICAgKiBpZiB0aGUgZG9jdW1lbnQgZG9lc24ndCBleGlzdC5cbiAgICAgKi8gICAgZGF0YSgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2RvY3VtZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29udmVydGVyKSB7XG4gICAgICAgICAgICAgICAgLy8gV2Ugb25seSB3YW50IHRvIHVzZSB0aGUgY29udmVydGVyIGFuZCBjcmVhdGUgYSBuZXcgRG9jdW1lbnRTbmFwc2hvdFxuICAgICAgICAgICAgICAgIC8vIGlmIGEgY29udmVydGVyIGhhcyBiZWVuIHByb3ZpZGVkLlxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgUXVlcnlEb2N1bWVudFNuYXBzaG90JDEodGhpcy5fZmlyZXN0b3JlLCB0aGlzLl91c2VyRGF0YVdyaXRlciwgdGhpcy5fa2V5LCB0aGlzLl9kb2N1bWVudCwgXG4gICAgICAgICAgICAgICAgLyogY29udmVydGVyPSAqLyBudWxsKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udmVydGVyLmZyb21GaXJlc3RvcmUoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdXNlckRhdGFXcml0ZXIuY29udmVydFZhbHVlKHRoaXMuX2RvY3VtZW50LmRhdGEudmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlcyB0aGUgZmllbGQgc3BlY2lmaWVkIGJ5IGBmaWVsZFBhdGhgLiBSZXR1cm5zIGB1bmRlZmluZWRgIGlmIHRoZVxuICAgICAqIGRvY3VtZW50IG9yIGZpZWxkIGRvZXNuJ3QgZXhpc3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZmllbGRQYXRoIC0gVGhlIHBhdGggKGZvciBleGFtcGxlICdmb28nIG9yICdmb28uYmFyJykgdG8gYSBzcGVjaWZpY1xuICAgICAqIGZpZWxkLlxuICAgICAqIEByZXR1cm5zIFRoZSBkYXRhIGF0IHRoZSBzcGVjaWZpZWQgZmllbGQgbG9jYXRpb24gb3IgdW5kZWZpbmVkIGlmIG5vIHN1Y2hcbiAgICAgKiBmaWVsZCBleGlzdHMgaW4gdGhlIGRvY3VtZW50LlxuICAgICAqL1xuICAgIC8vIFdlIGFyZSB1c2luZyBgYW55YCBoZXJlIHRvIGF2b2lkIGFuIGV4cGxpY2l0IGNhc3QgYnkgb3VyIHVzZXJzLlxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgZ2V0KGUpIHtcbiAgICAgICAgaWYgKHRoaXMuX2RvY3VtZW50KSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5fZG9jdW1lbnQuZGF0YS5maWVsZChfX1BSSVZBVEVfZmllbGRQYXRoRnJvbUFyZ3VtZW50KFwiRG9jdW1lbnRTbmFwc2hvdC5nZXRcIiwgZSkpO1xuICAgICAgICAgICAgaWYgKG51bGwgIT09IHQpIHJldHVybiB0aGlzLl91c2VyRGF0YVdyaXRlci5jb252ZXJ0VmFsdWUodCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8qKlxuICogQSBgUXVlcnlEb2N1bWVudFNuYXBzaG90YCBjb250YWlucyBkYXRhIHJlYWQgZnJvbSBhIGRvY3VtZW50IGluIHlvdXJcbiAqIEZpcmVzdG9yZSBkYXRhYmFzZSBhcyBwYXJ0IG9mIGEgcXVlcnkuIFRoZSBkb2N1bWVudCBpcyBndWFyYW50ZWVkIHRvIGV4aXN0XG4gKiBhbmQgaXRzIGRhdGEgY2FuIGJlIGV4dHJhY3RlZCB3aXRoIGAuZGF0YSgpYCBvciBgLmdldCg8ZmllbGQ+KWAgdG8gZ2V0IGFcbiAqIHNwZWNpZmljIGZpZWxkLlxuICpcbiAqIEEgYFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdGAgb2ZmZXJzIHRoZSBzYW1lIEFQSSBzdXJmYWNlIGFzIGFcbiAqIGBEb2N1bWVudFNuYXBzaG90YC4gU2luY2UgcXVlcnkgcmVzdWx0cyBjb250YWluIG9ubHkgZXhpc3RpbmcgZG9jdW1lbnRzLCB0aGVcbiAqIGBleGlzdHNgIHByb3BlcnR5IHdpbGwgYWx3YXlzIGJlIHRydWUgYW5kIGBkYXRhKClgIHdpbGwgbmV2ZXIgcmV0dXJuXG4gKiAndW5kZWZpbmVkJy5cbiAqLyBjbGFzcyBRdWVyeURvY3VtZW50U25hcHNob3QkMSBleHRlbmRzIERvY3VtZW50U25hcHNob3QkMSB7XG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIGFsbCBmaWVsZHMgaW4gdGhlIGRvY3VtZW50IGFzIGFuIGBPYmplY3RgLlxuICAgICAqXG4gICAgICogQG92ZXJyaWRlXG4gICAgICogQHJldHVybnMgQW4gYE9iamVjdGAgY29udGFpbmluZyBhbGwgZmllbGRzIGluIHRoZSBkb2N1bWVudC5cbiAgICAgKi9cbiAgICBkYXRhKCkge1xuICAgICAgICByZXR1cm4gc3VwZXIuZGF0YSgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBIZWxwZXIgdGhhdCBjYWxscyBgZnJvbURvdFNlcGFyYXRlZFN0cmluZygpYCBidXQgd3JhcHMgYW55IGVycm9yIHRocm93bi5cbiAqLyBmdW5jdGlvbiBfX1BSSVZBVEVfZmllbGRQYXRoRnJvbUFyZ3VtZW50KGUsIHQpIHtcbiAgICByZXR1cm4gXCJzdHJpbmdcIiA9PSB0eXBlb2YgdCA/IF9fUFJJVkFURV9maWVsZFBhdGhGcm9tRG90U2VwYXJhdGVkU3RyaW5nKGUsIHQpIDogdCBpbnN0YW5jZW9mIEZpZWxkUGF0aCA/IHQuX2ludGVybmFsUGF0aCA6IHQuX2RlbGVnYXRlLl9pbnRlcm5hbFBhdGg7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV92YWxpZGF0ZUhhc0V4cGxpY2l0T3JkZXJCeUZvckxpbWl0VG9MYXN0KGUpIHtcbiAgICBpZiAoXCJMXCIgLyogTGltaXRUeXBlLkxhc3QgKi8gPT09IGUubGltaXRUeXBlICYmIDAgPT09IGUuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uVU5JTVBMRU1FTlRFRCwgXCJsaW1pdFRvTGFzdCgpIHF1ZXJpZXMgcmVxdWlyZSBzcGVjaWZ5aW5nIGF0IGxlYXN0IG9uZSBvcmRlckJ5KCkgY2xhdXNlXCIpO1xufVxuXG4vKipcbiAqIEFuIGBBcHBsaWFibGVDb25zdHJhaW50YCBpcyBhbiBhYnN0cmFjdGlvbiBvZiBhIGNvbnN0cmFpbnQgdGhhdCBjYW4gYmUgYXBwbGllZFxuICogdG8gYSBGaXJlc3RvcmUgcXVlcnkuXG4gKi8gY2xhc3MgQXBwbGlhYmxlQ29uc3RyYWludCB7fVxuXG4vKipcbiAqIEEgYFF1ZXJ5Q29uc3RyYWludGAgaXMgdXNlZCB0byBuYXJyb3cgdGhlIHNldCBvZiBkb2N1bWVudHMgcmV0dXJuZWQgYnkgYVxuICogRmlyZXN0b3JlIHF1ZXJ5LiBgUXVlcnlDb25zdHJhaW50YHMgYXJlIGNyZWF0ZWQgYnkgaW52b2tpbmcge0BsaW5rIHdoZXJlfSxcbiAqIHtAbGluayBvcmRlckJ5fSwge0BsaW5rIChzdGFydEF0OjEpfSwge0BsaW5rIChzdGFydEFmdGVyOjEpfSwge0BsaW5rXG4gKiAoZW5kQmVmb3JlOjEpfSwge0BsaW5rIChlbmRBdDoxKX0sIHtAbGluayBsaW1pdH0sIHtAbGluayBsaW1pdFRvTGFzdH0gYW5kXG4gKiBjYW4gdGhlbiBiZSBwYXNzZWQgdG8ge0BsaW5rIChxdWVyeToxKX0gdG8gY3JlYXRlIGEgbmV3IHF1ZXJ5IGluc3RhbmNlIHRoYXRcbiAqIGFsc28gY29udGFpbnMgdGhpcyBgUXVlcnlDb25zdHJhaW50YC5cbiAqLyBjbGFzcyBRdWVyeUNvbnN0cmFpbnQgZXh0ZW5kcyBBcHBsaWFibGVDb25zdHJhaW50IHt9XG5cbmZ1bmN0aW9uIHF1ZXJ5KGUsIHQsIC4uLm4pIHtcbiAgICBsZXQgciA9IFtdO1xuICAgIHQgaW5zdGFuY2VvZiBBcHBsaWFibGVDb25zdHJhaW50ICYmIHIucHVzaCh0KSwgciA9IHIuY29uY2F0KG4pLCBmdW5jdGlvbiBfX1BSSVZBVEVfdmFsaWRhdGVRdWVyeUNvbnN0cmFpbnRBcnJheShlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBlLmZpbHRlcigoZSA9PiBlIGluc3RhbmNlb2YgUXVlcnlDb21wb3NpdGVGaWx0ZXJDb25zdHJhaW50KSkubGVuZ3RoLCBuID0gZS5maWx0ZXIoKGUgPT4gZSBpbnN0YW5jZW9mIFF1ZXJ5RmllbGRGaWx0ZXJDb25zdHJhaW50KSkubGVuZ3RoO1xuICAgICAgICBpZiAodCA+IDEgfHwgdCA+IDAgJiYgbiA+IDApIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZFF1ZXJ5LiBXaGVuIHVzaW5nIGNvbXBvc2l0ZSBmaWx0ZXJzLCB5b3UgY2Fubm90IHVzZSBtb3JlIHRoYW4gb25lIGZpbHRlciBhdCB0aGUgdG9wIGxldmVsLiBDb25zaWRlciBuZXN0aW5nIHRoZSBtdWx0aXBsZSBmaWx0ZXJzIHdpdGhpbiBhbiBgYW5kKC4uLilgIHN0YXRlbWVudC4gRm9yIGV4YW1wbGU6IGNoYW5nZSBgcXVlcnkocXVlcnksIHdoZXJlKC4uLiksIG9yKC4uLikpYCB0byBgcXVlcnkocXVlcnksIGFuZCh3aGVyZSguLi4pLCBvciguLi4pKSlgLlwiKTtcbiAgICB9XG4gICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbiAgICAvKipcbiAqIENvbnZlcnRzIEZpcmVzdG9yZSdzIGludGVybmFsIHR5cGVzIHRvIHRoZSBKYXZhU2NyaXB0IHR5cGVzIHRoYXQgd2UgZXhwb3NlXG4gKiB0byB0aGUgdXNlci5cbiAqXG4gKiBAaW50ZXJuYWxcbiAqLyAocik7XG4gICAgZm9yIChjb25zdCB0IG9mIHIpIGUgPSB0Ll9hcHBseShlKTtcbiAgICByZXR1cm4gZTtcbn1cblxuLyoqXG4gKiBBIGBRdWVyeUZpZWxkRmlsdGVyQ29uc3RyYWludGAgaXMgdXNlZCB0byBuYXJyb3cgdGhlIHNldCBvZiBkb2N1bWVudHMgcmV0dXJuZWQgYnlcbiAqIGEgRmlyZXN0b3JlIHF1ZXJ5IGJ5IGZpbHRlcmluZyBvbiBvbmUgb3IgbW9yZSBkb2N1bWVudCBmaWVsZHMuXG4gKiBgUXVlcnlGaWVsZEZpbHRlckNvbnN0cmFpbnRgcyBhcmUgY3JlYXRlZCBieSBpbnZva2luZyB7QGxpbmsgd2hlcmV9IGFuZCBjYW4gdGhlblxuICogYmUgcGFzc2VkIHRvIHtAbGluayAocXVlcnk6MSl9IHRvIGNyZWF0ZSBhIG5ldyBxdWVyeSBpbnN0YW5jZSB0aGF0IGFsc28gY29udGFpbnNcbiAqIHRoaXMgYFF1ZXJ5RmllbGRGaWx0ZXJDb25zdHJhaW50YC5cbiAqLyBjbGFzcyBRdWVyeUZpZWxkRmlsdGVyQ29uc3RyYWludCBleHRlbmRzIFF1ZXJ5Q29uc3RyYWludCB7XG4gICAgLyoqXG4gICAgICogQGludGVybmFsXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoZSwgdCwgbikge1xuICAgICAgICBzdXBlcigpLCB0aGlzLl9maWVsZCA9IGUsIHRoaXMuX29wID0gdCwgdGhpcy5fdmFsdWUgPSBuLCBcbiAgICAgICAgLyoqIFRoZSB0eXBlIG9mIHRoaXMgcXVlcnkgY29uc3RyYWludCAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBcIndoZXJlXCI7XG4gICAgfVxuICAgIHN0YXRpYyBfY3JlYXRlKGUsIHQsIG4pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeUZpZWxkRmlsdGVyQ29uc3RyYWludChlLCB0LCBuKTtcbiAgICB9XG4gICAgX2FwcGx5KGUpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuX3BhcnNlKGUpO1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX3ZhbGlkYXRlTmV3RmllbGRGaWx0ZXIoZS5fcXVlcnksIHQpLCBuZXcgUXVlcnkoZS5maXJlc3RvcmUsIGUuY29udmVydGVyLCBfX1BSSVZBVEVfcXVlcnlXaXRoQWRkZWRGaWx0ZXIoZS5fcXVlcnksIHQpKTtcbiAgICB9XG4gICAgX3BhcnNlKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IF9fUFJJVkFURV9uZXdVc2VyRGF0YVJlYWRlcihlLmZpcmVzdG9yZSksIG4gPSBmdW5jdGlvbiBfX1BSSVZBVEVfbmV3UXVlcnlGaWx0ZXIoZSwgdCwgbiwgciwgaSwgcywgbykge1xuICAgICAgICAgICAgbGV0IF87XG4gICAgICAgICAgICBpZiAoaS5pc0tleUZpZWxkKCkpIHtcbiAgICAgICAgICAgICAgICBpZiAoXCJhcnJheS1jb250YWluc1wiIC8qIE9wZXJhdG9yLkFSUkFZX0NPTlRBSU5TICovID09PSBzIHx8IFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogT3BlcmF0b3IuQVJSQVlfQ09OVEFJTlNfQU5ZICovID09PSBzKSB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBRdWVyeS4gWW91IGNhbid0IHBlcmZvcm0gJyR7c30nIHF1ZXJpZXMgb24gZG9jdW1lbnRJZCgpLmApO1xuICAgICAgICAgICAgICAgIGlmIChcImluXCIgLyogT3BlcmF0b3IuSU4gKi8gPT09IHMgfHwgXCJub3QtaW5cIiAvKiBPcGVyYXRvci5OT1RfSU4gKi8gPT09IHMpIHtcbiAgICAgICAgICAgICAgICAgICAgX19QUklWQVRFX3ZhbGlkYXRlRGlzanVuY3RpdmVGaWx0ZXJFbGVtZW50cyhvLCBzKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgbykgdC5wdXNoKF9fUFJJVkFURV9wYXJzZURvY3VtZW50SWRWYWx1ZShyLCBlLCBuKSk7XG4gICAgICAgICAgICAgICAgICAgIF8gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcnJheVZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiB0XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIF8gPSBfX1BSSVZBVEVfcGFyc2VEb2N1bWVudElkVmFsdWUociwgZSwgbyk7XG4gICAgICAgICAgICB9IGVsc2UgXCJpblwiIC8qIE9wZXJhdG9yLklOICovICE9PSBzICYmIFwibm90LWluXCIgLyogT3BlcmF0b3IuTk9UX0lOICovICE9PSBzICYmIFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogT3BlcmF0b3IuQVJSQVlfQ09OVEFJTlNfQU5ZICovICE9PSBzIHx8IF9fUFJJVkFURV92YWxpZGF0ZURpc2p1bmN0aXZlRmlsdGVyRWxlbWVudHMobywgcyksIFxuICAgICAgICAgICAgXyA9IF9fUFJJVkFURV9wYXJzZVF1ZXJ5VmFsdWUobiwgdCwgbywgXG4gICAgICAgICAgICAvKiBhbGxvd0FycmF5cz0gKi8gXCJpblwiIC8qIE9wZXJhdG9yLklOICovID09PSBzIHx8IFwibm90LWluXCIgLyogT3BlcmF0b3IuTk9UX0lOICovID09PSBzKTtcbiAgICAgICAgICAgIGNvbnN0IGEgPSBGaWVsZEZpbHRlci5jcmVhdGUoaSwgcywgXyk7XG4gICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgfShlLl9xdWVyeSwgXCJ3aGVyZVwiLCB0LCBlLmZpcmVzdG9yZS5fZGF0YWJhc2VJZCwgdGhpcy5fZmllbGQsIHRoaXMuX29wLCB0aGlzLl92YWx1ZSk7XG4gICAgICAgIHJldHVybiBuO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEge0BsaW5rIFF1ZXJ5RmllbGRGaWx0ZXJDb25zdHJhaW50fSB0aGF0IGVuZm9yY2VzIHRoYXQgZG9jdW1lbnRzXG4gKiBtdXN0IGNvbnRhaW4gdGhlIHNwZWNpZmllZCBmaWVsZCBhbmQgdGhhdCB0aGUgdmFsdWUgc2hvdWxkIHNhdGlzZnkgdGhlXG4gKiByZWxhdGlvbiBjb25zdHJhaW50IHByb3ZpZGVkLlxuICpcbiAqIEBwYXJhbSBmaWVsZFBhdGggLSBUaGUgcGF0aCB0byBjb21wYXJlXG4gKiBAcGFyYW0gb3BTdHIgLSBUaGUgb3BlcmF0aW9uIHN0cmluZyAoZS5nIFwiJmx0O1wiLCBcIiZsdDs9XCIsIFwiPT1cIiwgXCImbHQ7XCIsXG4gKiAgIFwiJmx0Oz1cIiwgXCIhPVwiKS5cbiAqIEBwYXJhbSB2YWx1ZSAtIFRoZSB2YWx1ZSBmb3IgY29tcGFyaXNvblxuICogQHJldHVybnMgVGhlIGNyZWF0ZWQge0BsaW5rIFF1ZXJ5RmllbGRGaWx0ZXJDb25zdHJhaW50fS5cbiAqLyBmdW5jdGlvbiB3aGVyZShlLCB0LCBuKSB7XG4gICAgY29uc3QgciA9IHQsIGkgPSBfX1BSSVZBVEVfZmllbGRQYXRoRnJvbUFyZ3VtZW50KFwid2hlcmVcIiwgZSk7XG4gICAgcmV0dXJuIFF1ZXJ5RmllbGRGaWx0ZXJDb25zdHJhaW50Ll9jcmVhdGUoaSwgciwgbik7XG59XG5cbi8qKlxuICogQSBgUXVlcnlDb21wb3NpdGVGaWx0ZXJDb25zdHJhaW50YCBpcyB1c2VkIHRvIG5hcnJvdyB0aGUgc2V0IG9mIGRvY3VtZW50c1xuICogcmV0dXJuZWQgYnkgYSBGaXJlc3RvcmUgcXVlcnkgYnkgcGVyZm9ybWluZyB0aGUgbG9naWNhbCBPUiBvciBBTkQgb2YgbXVsdGlwbGVcbiAqIHtAbGluayBRdWVyeUZpZWxkRmlsdGVyQ29uc3RyYWludH1zIG9yIHtAbGluayBRdWVyeUNvbXBvc2l0ZUZpbHRlckNvbnN0cmFpbnR9cy5cbiAqIGBRdWVyeUNvbXBvc2l0ZUZpbHRlckNvbnN0cmFpbnRgcyBhcmUgY3JlYXRlZCBieSBpbnZva2luZyB7QGxpbmsgb3J9IG9yXG4gKiB7QGxpbmsgYW5kfSBhbmQgY2FuIHRoZW4gYmUgcGFzc2VkIHRvIHtAbGluayAocXVlcnk6MSl9IHRvIGNyZWF0ZSBhIG5ldyBxdWVyeVxuICogaW5zdGFuY2UgdGhhdCBhbHNvIGNvbnRhaW5zIHRoZSBgUXVlcnlDb21wb3NpdGVGaWx0ZXJDb25zdHJhaW50YC5cbiAqLyBjbGFzcyBRdWVyeUNvbXBvc2l0ZUZpbHRlckNvbnN0cmFpbnQgZXh0ZW5kcyBBcHBsaWFibGVDb25zdHJhaW50IHtcbiAgICAvKipcbiAgICAgKiBAaW50ZXJuYWxcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogVGhlIHR5cGUgb2YgdGhpcyBxdWVyeSBjb25zdHJhaW50ICovXG4gICAgZSwgdCkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLnR5cGUgPSBlLCB0aGlzLl9xdWVyeUNvbnN0cmFpbnRzID0gdDtcbiAgICB9XG4gICAgc3RhdGljIF9jcmVhdGUoZSwgdCkge1xuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5Q29tcG9zaXRlRmlsdGVyQ29uc3RyYWludChlLCB0KTtcbiAgICB9XG4gICAgX3BhcnNlKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuX3F1ZXJ5Q29uc3RyYWludHMubWFwKCh0ID0+IHQuX3BhcnNlKGUpKSkuZmlsdGVyKChlID0+IGUuZ2V0RmlsdGVycygpLmxlbmd0aCA+IDApKTtcbiAgICAgICAgcmV0dXJuIDEgPT09IHQubGVuZ3RoID8gdFswXSA6IENvbXBvc2l0ZUZpbHRlci5jcmVhdGUodCwgdGhpcy5fZ2V0T3BlcmF0b3IoKSk7XG4gICAgfVxuICAgIF9hcHBseShlKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLl9wYXJzZShlKTtcbiAgICAgICAgcmV0dXJuIDAgPT09IHQuZ2V0RmlsdGVycygpLmxlbmd0aCA/IGUgOiAoZnVuY3Rpb24gX19QUklWQVRFX3ZhbGlkYXRlTmV3RmlsdGVyKGUsIHQpIHtcbiAgICAgICAgICAgIGxldCBuID0gZTtcbiAgICAgICAgICAgIGNvbnN0IHIgPSB0LmdldEZsYXR0ZW5lZEZpbHRlcnMoKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiByKSBfX1BSSVZBVEVfdmFsaWRhdGVOZXdGaWVsZEZpbHRlcihuLCBlKSwgbiA9IF9fUFJJVkFURV9xdWVyeVdpdGhBZGRlZEZpbHRlcihuLCBlKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBDaGVja3MgaWYgYW55IG9mIHRoZSBwcm92aWRlZCBmaWx0ZXIgb3BlcmF0b3JzIGFyZSBpbmNsdWRlZCBpbiB0aGUgZ2l2ZW4gbGlzdCBvZiBmaWx0ZXJzIGFuZFxuICAgICAgICAvLyByZXR1cm5zIHRoZSBmaXJzdCBvbmUgdGhhdCBpcywgb3IgbnVsbCBpZiBub25lIGFyZS5cbiAgICAgICAgKGUuX3F1ZXJ5LCB0KSwgbmV3IFF1ZXJ5KGUuZmlyZXN0b3JlLCBlLmNvbnZlcnRlciwgX19QUklWQVRFX3F1ZXJ5V2l0aEFkZGVkRmlsdGVyKGUuX3F1ZXJ5LCB0KSkpO1xuICAgIH1cbiAgICBfZ2V0UXVlcnlDb25zdHJhaW50cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3F1ZXJ5Q29uc3RyYWludHM7XG4gICAgfVxuICAgIF9nZXRPcGVyYXRvcigpIHtcbiAgICAgICAgcmV0dXJuIFwiYW5kXCIgPT09IHRoaXMudHlwZSA/IFwiYW5kXCIgLyogQ29tcG9zaXRlT3BlcmF0b3IuQU5EICovIDogXCJvclwiIC8qIENvbXBvc2l0ZU9wZXJhdG9yLk9SICovO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IHtAbGluayBRdWVyeUNvbXBvc2l0ZUZpbHRlckNvbnN0cmFpbnR9IHRoYXQgaXMgYSBkaXNqdW5jdGlvbiBvZlxuICogdGhlIGdpdmVuIGZpbHRlciBjb25zdHJhaW50cy4gQSBkaXNqdW5jdGlvbiBmaWx0ZXIgaW5jbHVkZXMgYSBkb2N1bWVudCBpZiBpdFxuICogc2F0aXNmaWVzIGFueSBvZiB0aGUgZ2l2ZW4gZmlsdGVycy5cbiAqXG4gKiBAcGFyYW0gcXVlcnlDb25zdHJhaW50cyAtIE9wdGlvbmFsLiBUaGUgbGlzdCBvZlxuICoge0BsaW5rIFF1ZXJ5RmlsdGVyQ29uc3RyYWludH1zIHRvIHBlcmZvcm0gYSBkaXNqdW5jdGlvbiBmb3IuIFRoZXNlIG11c3QgYmVcbiAqIGNyZWF0ZWQgd2l0aCBjYWxscyB0byB7QGxpbmsgd2hlcmV9LCB7QGxpbmsgb3J9LCBvciB7QGxpbmsgYW5kfS5cbiAqIEByZXR1cm5zIFRoZSBuZXdseSBjcmVhdGVkIHtAbGluayBRdWVyeUNvbXBvc2l0ZUZpbHRlckNvbnN0cmFpbnR9LlxuICovIGZ1bmN0aW9uIG9yKC4uLmUpIHtcbiAgICAvLyBPbmx5IHN1cHBvcnQgUXVlcnlGaWx0ZXJDb25zdHJhaW50c1xuICAgIHJldHVybiBlLmZvckVhY2goKGUgPT4gX19QUklWQVRFX3ZhbGlkYXRlUXVlcnlGaWx0ZXJDb25zdHJhaW50KFwib3JcIiwgZSkpKSwgUXVlcnlDb21wb3NpdGVGaWx0ZXJDb25zdHJhaW50Ll9jcmVhdGUoXCJvclwiIC8qIENvbXBvc2l0ZU9wZXJhdG9yLk9SICovICwgZSk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyB7QGxpbmsgUXVlcnlDb21wb3NpdGVGaWx0ZXJDb25zdHJhaW50fSB0aGF0IGlzIGEgY29uanVuY3Rpb24gb2ZcbiAqIHRoZSBnaXZlbiBmaWx0ZXIgY29uc3RyYWludHMuIEEgY29uanVuY3Rpb24gZmlsdGVyIGluY2x1ZGVzIGEgZG9jdW1lbnQgaWYgaXRcbiAqIHNhdGlzZmllcyBhbGwgb2YgdGhlIGdpdmVuIGZpbHRlcnMuXG4gKlxuICogQHBhcmFtIHF1ZXJ5Q29uc3RyYWludHMgLSBPcHRpb25hbC4gVGhlIGxpc3Qgb2ZcbiAqIHtAbGluayBRdWVyeUZpbHRlckNvbnN0cmFpbnR9cyB0byBwZXJmb3JtIGEgY29uanVuY3Rpb24gZm9yLiBUaGVzZSBtdXN0IGJlXG4gKiBjcmVhdGVkIHdpdGggY2FsbHMgdG8ge0BsaW5rIHdoZXJlfSwge0BsaW5rIG9yfSwgb3Ige0BsaW5rIGFuZH0uXG4gKiBAcmV0dXJucyBUaGUgbmV3bHkgY3JlYXRlZCB7QGxpbmsgUXVlcnlDb21wb3NpdGVGaWx0ZXJDb25zdHJhaW50fS5cbiAqLyBmdW5jdGlvbiBhbmQoLi4uZSkge1xuICAgIC8vIE9ubHkgc3VwcG9ydCBRdWVyeUZpbHRlckNvbnN0cmFpbnRzXG4gICAgcmV0dXJuIGUuZm9yRWFjaCgoZSA9PiBfX1BSSVZBVEVfdmFsaWRhdGVRdWVyeUZpbHRlckNvbnN0cmFpbnQoXCJhbmRcIiwgZSkpKSwgUXVlcnlDb21wb3NpdGVGaWx0ZXJDb25zdHJhaW50Ll9jcmVhdGUoXCJhbmRcIiAvKiBDb21wb3NpdGVPcGVyYXRvci5BTkQgKi8gLCBlKTtcbn1cblxuLyoqXG4gKiBBIGBRdWVyeU9yZGVyQnlDb25zdHJhaW50YCBpcyB1c2VkIHRvIHNvcnQgdGhlIHNldCBvZiBkb2N1bWVudHMgcmV0dXJuZWQgYnkgYVxuICogRmlyZXN0b3JlIHF1ZXJ5LiBgUXVlcnlPcmRlckJ5Q29uc3RyYWludGBzIGFyZSBjcmVhdGVkIGJ5IGludm9raW5nXG4gKiB7QGxpbmsgb3JkZXJCeX0gYW5kIGNhbiB0aGVuIGJlIHBhc3NlZCB0byB7QGxpbmsgKHF1ZXJ5OjEpfSB0byBjcmVhdGUgYSBuZXcgcXVlcnlcbiAqIGluc3RhbmNlIHRoYXQgYWxzbyBjb250YWlucyB0aGlzIGBRdWVyeU9yZGVyQnlDb25zdHJhaW50YC5cbiAqXG4gKiBOb3RlOiBEb2N1bWVudHMgdGhhdCBkbyBub3QgY29udGFpbiB0aGUgb3JkZXJCeSBmaWVsZCB3aWxsIG5vdCBiZSBwcmVzZW50IGluXG4gKiB0aGUgcXVlcnkgcmVzdWx0LlxuICovIGNsYXNzIFF1ZXJ5T3JkZXJCeUNvbnN0cmFpbnQgZXh0ZW5kcyBRdWVyeUNvbnN0cmFpbnQge1xuICAgIC8qKlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGUsIHQpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5fZmllbGQgPSBlLCB0aGlzLl9kaXJlY3Rpb24gPSB0LCBcbiAgICAgICAgLyoqIFRoZSB0eXBlIG9mIHRoaXMgcXVlcnkgY29uc3RyYWludCAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBcIm9yZGVyQnlcIjtcbiAgICB9XG4gICAgc3RhdGljIF9jcmVhdGUoZSwgdCkge1xuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5T3JkZXJCeUNvbnN0cmFpbnQoZSwgdCk7XG4gICAgfVxuICAgIF9hcHBseShlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBmdW5jdGlvbiBfX1BSSVZBVEVfbmV3UXVlcnlPcmRlckJ5KGUsIHQsIG4pIHtcbiAgICAgICAgICAgIGlmIChudWxsICE9PSBlLnN0YXJ0QXQpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBxdWVyeS4gWW91IG11c3Qgbm90IGNhbGwgc3RhcnRBdCgpIG9yIHN0YXJ0QWZ0ZXIoKSBiZWZvcmUgY2FsbGluZyBvcmRlckJ5KCkuXCIpO1xuICAgICAgICAgICAgaWYgKG51bGwgIT09IGUuZW5kQXQpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBxdWVyeS4gWW91IG11c3Qgbm90IGNhbGwgZW5kQXQoKSBvciBlbmRCZWZvcmUoKSBiZWZvcmUgY2FsbGluZyBvcmRlckJ5KCkuXCIpO1xuICAgICAgICAgICAgY29uc3QgciA9IG5ldyBPcmRlckJ5KHQsIG4pO1xuICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBDcmVhdGUgYSBgQm91bmRgIGZyb20gYSBxdWVyeSBhbmQgYSBkb2N1bWVudC5cbiAqXG4gKiBOb3RlIHRoYXQgdGhlIGBCb3VuZGAgd2lsbCBhbHdheXMgaW5jbHVkZSB0aGUga2V5IG9mIHRoZSBkb2N1bWVudFxuICogYW5kIHNvIG9ubHkgdGhlIHByb3ZpZGVkIGRvY3VtZW50IHdpbGwgY29tcGFyZSBlcXVhbCB0byB0aGUgcmV0dXJuZWRcbiAqIHBvc2l0aW9uLlxuICpcbiAqIFdpbGwgdGhyb3cgaWYgdGhlIGRvY3VtZW50IGRvZXMgbm90IGNvbnRhaW4gYWxsIGZpZWxkcyBvZiB0aGUgb3JkZXIgYnlcbiAqIG9mIHRoZSBxdWVyeSBvciBpZiBhbnkgb2YgdGhlIGZpZWxkcyBpbiB0aGUgb3JkZXIgYnkgYXJlIGFuIHVuY29tbWl0dGVkXG4gKiBzZXJ2ZXIgdGltZXN0YW1wLlxuICovIChlLl9xdWVyeSwgdGhpcy5fZmllbGQsIHRoaXMuX2RpcmVjdGlvbik7XG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkoZS5maXJlc3RvcmUsIGUuY29udmVydGVyLCBmdW5jdGlvbiBfX1BSSVZBVEVfcXVlcnlXaXRoQWRkZWRPcmRlckJ5KGUsIHQpIHtcbiAgICAgICAgICAgIC8vIFRPRE8oZGltb25kKTogdmFsaWRhdGUgdGhhdCBvcmRlckJ5IGRvZXMgbm90IGxpc3QgdGhlIHNhbWUga2V5IHR3aWNlLlxuICAgICAgICAgICAgY29uc3QgbiA9IGUuZXhwbGljaXRPcmRlckJ5LmNvbmNhdChbIHQgXSk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9RdWVyeUltcGwoZS5wYXRoLCBlLmNvbGxlY3Rpb25Hcm91cCwgbiwgZS5maWx0ZXJzLnNsaWNlKCksIGUubGltaXQsIGUubGltaXRUeXBlLCBlLnN0YXJ0QXQsIGUuZW5kQXQpO1xuICAgICAgICB9KGUuX3F1ZXJ5LCB0KSk7XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSB7QGxpbmsgUXVlcnlPcmRlckJ5Q29uc3RyYWludH0gdGhhdCBzb3J0cyB0aGUgcXVlcnkgcmVzdWx0IGJ5IHRoZVxuICogc3BlY2lmaWVkIGZpZWxkLCBvcHRpb25hbGx5IGluIGRlc2NlbmRpbmcgb3JkZXIgaW5zdGVhZCBvZiBhc2NlbmRpbmcuXG4gKlxuICogTm90ZTogRG9jdW1lbnRzIHRoYXQgZG8gbm90IGNvbnRhaW4gdGhlIHNwZWNpZmllZCBmaWVsZCB3aWxsIG5vdCBiZSBwcmVzZW50XG4gKiBpbiB0aGUgcXVlcnkgcmVzdWx0LlxuICpcbiAqIEBwYXJhbSBmaWVsZFBhdGggLSBUaGUgZmllbGQgdG8gc29ydCBieS5cbiAqIEBwYXJhbSBkaXJlY3Rpb25TdHIgLSBPcHRpb25hbCBkaXJlY3Rpb24gdG8gc29ydCBieSAoJ2FzYycgb3IgJ2Rlc2MnKS4gSWZcbiAqIG5vdCBzcGVjaWZpZWQsIG9yZGVyIHdpbGwgYmUgYXNjZW5kaW5nLlxuICogQHJldHVybnMgVGhlIGNyZWF0ZWQge0BsaW5rIFF1ZXJ5T3JkZXJCeUNvbnN0cmFpbnR9LlxuICovIGZ1bmN0aW9uIG9yZGVyQnkoZSwgdCA9IFwiYXNjXCIpIHtcbiAgICBjb25zdCBuID0gdCwgciA9IF9fUFJJVkFURV9maWVsZFBhdGhGcm9tQXJndW1lbnQoXCJvcmRlckJ5XCIsIGUpO1xuICAgIHJldHVybiBRdWVyeU9yZGVyQnlDb25zdHJhaW50Ll9jcmVhdGUociwgbik7XG59XG5cbi8qKlxuICogQSBgUXVlcnlMaW1pdENvbnN0cmFpbnRgIGlzIHVzZWQgdG8gbGltaXQgdGhlIG51bWJlciBvZiBkb2N1bWVudHMgcmV0dXJuZWQgYnlcbiAqIGEgRmlyZXN0b3JlIHF1ZXJ5LlxuICogYFF1ZXJ5TGltaXRDb25zdHJhaW50YHMgYXJlIGNyZWF0ZWQgYnkgaW52b2tpbmcge0BsaW5rIGxpbWl0fSBvclxuICoge0BsaW5rIGxpbWl0VG9MYXN0fSBhbmQgY2FuIHRoZW4gYmUgcGFzc2VkIHRvIHtAbGluayAocXVlcnk6MSl9IHRvIGNyZWF0ZSBhIG5ld1xuICogcXVlcnkgaW5zdGFuY2UgdGhhdCBhbHNvIGNvbnRhaW5zIHRoaXMgYFF1ZXJ5TGltaXRDb25zdHJhaW50YC5cbiAqLyBjbGFzcyBRdWVyeUxpbWl0Q29uc3RyYWludCBleHRlbmRzIFF1ZXJ5Q29uc3RyYWludCB7XG4gICAgLyoqXG4gICAgICogQGludGVybmFsXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqIFRoZSB0eXBlIG9mIHRoaXMgcXVlcnkgY29uc3RyYWludCAqL1xuICAgIGUsIHQsIG4pIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy50eXBlID0gZSwgdGhpcy5fbGltaXQgPSB0LCB0aGlzLl9saW1pdFR5cGUgPSBuO1xuICAgIH1cbiAgICBzdGF0aWMgX2NyZWF0ZShlLCB0LCBuKSB7XG4gICAgICAgIHJldHVybiBuZXcgUXVlcnlMaW1pdENvbnN0cmFpbnQoZSwgdCwgbik7XG4gICAgfVxuICAgIF9hcHBseShlKSB7XG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkoZS5maXJlc3RvcmUsIGUuY29udmVydGVyLCBfX1BSSVZBVEVfcXVlcnlXaXRoTGltaXQoZS5fcXVlcnksIHRoaXMuX2xpbWl0LCB0aGlzLl9saW1pdFR5cGUpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIHtAbGluayBRdWVyeUxpbWl0Q29uc3RyYWludH0gdGhhdCBvbmx5IHJldHVybnMgdGhlIGZpcnN0IG1hdGNoaW5nXG4gKiBkb2N1bWVudHMuXG4gKlxuICogQHBhcmFtIGxpbWl0IC0gVGhlIG1heGltdW0gbnVtYmVyIG9mIGl0ZW1zIHRvIHJldHVybi5cbiAqIEByZXR1cm5zIFRoZSBjcmVhdGVkIHtAbGluayBRdWVyeUxpbWl0Q29uc3RyYWludH0uXG4gKi8gZnVuY3Rpb24gbGltaXQoZSkge1xuICAgIHJldHVybiBfX1BSSVZBVEVfdmFsaWRhdGVQb3NpdGl2ZU51bWJlcihcImxpbWl0XCIsIGUpLCBRdWVyeUxpbWl0Q29uc3RyYWludC5fY3JlYXRlKFwibGltaXRcIiwgZSwgXCJGXCIgLyogTGltaXRUeXBlLkZpcnN0ICovKTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEge0BsaW5rIFF1ZXJ5TGltaXRDb25zdHJhaW50fSB0aGF0IG9ubHkgcmV0dXJucyB0aGUgbGFzdCBtYXRjaGluZ1xuICogZG9jdW1lbnRzLlxuICpcbiAqIFlvdSBtdXN0IHNwZWNpZnkgYXQgbGVhc3Qgb25lIGBvcmRlckJ5YCBjbGF1c2UgZm9yIGBsaW1pdFRvTGFzdGAgcXVlcmllcyxcbiAqIG90aGVyd2lzZSBhbiBleGNlcHRpb24gd2lsbCBiZSB0aHJvd24gZHVyaW5nIGV4ZWN1dGlvbi5cbiAqXG4gKiBAcGFyYW0gbGltaXQgLSBUaGUgbWF4aW11bSBudW1iZXIgb2YgaXRlbXMgdG8gcmV0dXJuLlxuICogQHJldHVybnMgVGhlIGNyZWF0ZWQge0BsaW5rIFF1ZXJ5TGltaXRDb25zdHJhaW50fS5cbiAqLyBmdW5jdGlvbiBsaW1pdFRvTGFzdChlKSB7XG4gICAgcmV0dXJuIF9fUFJJVkFURV92YWxpZGF0ZVBvc2l0aXZlTnVtYmVyKFwibGltaXRUb0xhc3RcIiwgZSksIFF1ZXJ5TGltaXRDb25zdHJhaW50Ll9jcmVhdGUoXCJsaW1pdFRvTGFzdFwiLCBlLCBcIkxcIiAvKiBMaW1pdFR5cGUuTGFzdCAqLyk7XG59XG5cbi8qKlxuICogQSBgUXVlcnlTdGFydEF0Q29uc3RyYWludGAgaXMgdXNlZCB0byBleGNsdWRlIGRvY3VtZW50cyBmcm9tIHRoZSBzdGFydCBvZiBhXG4gKiByZXN1bHQgc2V0IHJldHVybmVkIGJ5IGEgRmlyZXN0b3JlIHF1ZXJ5LlxuICogYFF1ZXJ5U3RhcnRBdENvbnN0cmFpbnRgcyBhcmUgY3JlYXRlZCBieSBpbnZva2luZyB7QGxpbmsgKHN0YXJ0QXQ6MSl9IG9yXG4gKiB7QGxpbmsgKHN0YXJ0QWZ0ZXI6MSl9IGFuZCBjYW4gdGhlbiBiZSBwYXNzZWQgdG8ge0BsaW5rIChxdWVyeToxKX0gdG8gY3JlYXRlIGFcbiAqIG5ldyBxdWVyeSBpbnN0YW5jZSB0aGF0IGFsc28gY29udGFpbnMgdGhpcyBgUXVlcnlTdGFydEF0Q29uc3RyYWludGAuXG4gKi8gY2xhc3MgUXVlcnlTdGFydEF0Q29uc3RyYWludCBleHRlbmRzIFF1ZXJ5Q29uc3RyYWludCB7XG4gICAgLyoqXG4gICAgICogQGludGVybmFsXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqIFRoZSB0eXBlIG9mIHRoaXMgcXVlcnkgY29uc3RyYWludCAqL1xuICAgIGUsIHQsIG4pIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy50eXBlID0gZSwgdGhpcy5fZG9jT3JGaWVsZHMgPSB0LCB0aGlzLl9pbmNsdXNpdmUgPSBuO1xuICAgIH1cbiAgICBzdGF0aWMgX2NyZWF0ZShlLCB0LCBuKSB7XG4gICAgICAgIHJldHVybiBuZXcgUXVlcnlTdGFydEF0Q29uc3RyYWludChlLCB0LCBuKTtcbiAgICB9XG4gICAgX2FwcGx5KGUpIHtcbiAgICAgICAgY29uc3QgdCA9IF9fUFJJVkFURV9uZXdRdWVyeUJvdW5kRnJvbURvY09yRmllbGRzKGUsIHRoaXMudHlwZSwgdGhpcy5fZG9jT3JGaWVsZHMsIHRoaXMuX2luY2x1c2l2ZSk7XG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkoZS5maXJlc3RvcmUsIGUuY29udmVydGVyLCBmdW5jdGlvbiBfX1BSSVZBVEVfcXVlcnlXaXRoU3RhcnRBdChlLCB0KSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IF9fUFJJVkFURV9RdWVyeUltcGwoZS5wYXRoLCBlLmNvbGxlY3Rpb25Hcm91cCwgZS5leHBsaWNpdE9yZGVyQnkuc2xpY2UoKSwgZS5maWx0ZXJzLnNsaWNlKCksIGUubGltaXQsIGUubGltaXRUeXBlLCB0LCBlLmVuZEF0KTtcbiAgICAgICAgfShlLl9xdWVyeSwgdCkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gc3RhcnRBdCguLi5lKSB7XG4gICAgcmV0dXJuIFF1ZXJ5U3RhcnRBdENvbnN0cmFpbnQuX2NyZWF0ZShcInN0YXJ0QXRcIiwgZSwgXG4gICAgLyppbmNsdXNpdmU9Ki8gITApO1xufVxuXG5mdW5jdGlvbiBzdGFydEFmdGVyKC4uLmUpIHtcbiAgICByZXR1cm4gUXVlcnlTdGFydEF0Q29uc3RyYWludC5fY3JlYXRlKFwic3RhcnRBZnRlclwiLCBlLCBcbiAgICAvKmluY2x1c2l2ZT0qLyAhMSk7XG59XG5cbi8qKlxuICogQSBgUXVlcnlFbmRBdENvbnN0cmFpbnRgIGlzIHVzZWQgdG8gZXhjbHVkZSBkb2N1bWVudHMgZnJvbSB0aGUgZW5kIG9mIGFcbiAqIHJlc3VsdCBzZXQgcmV0dXJuZWQgYnkgYSBGaXJlc3RvcmUgcXVlcnkuXG4gKiBgUXVlcnlFbmRBdENvbnN0cmFpbnRgcyBhcmUgY3JlYXRlZCBieSBpbnZva2luZyB7QGxpbmsgKGVuZEF0OjEpfSBvclxuICoge0BsaW5rIChlbmRCZWZvcmU6MSl9IGFuZCBjYW4gdGhlbiBiZSBwYXNzZWQgdG8ge0BsaW5rIChxdWVyeToxKX0gdG8gY3JlYXRlIGEgbmV3XG4gKiBxdWVyeSBpbnN0YW5jZSB0aGF0IGFsc28gY29udGFpbnMgdGhpcyBgUXVlcnlFbmRBdENvbnN0cmFpbnRgLlxuICovIGNsYXNzIFF1ZXJ5RW5kQXRDb25zdHJhaW50IGV4dGVuZHMgUXVlcnlDb25zdHJhaW50IHtcbiAgICAvKipcbiAgICAgKiBAaW50ZXJuYWxcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogVGhlIHR5cGUgb2YgdGhpcyBxdWVyeSBjb25zdHJhaW50ICovXG4gICAgZSwgdCwgbikge1xuICAgICAgICBzdXBlcigpLCB0aGlzLnR5cGUgPSBlLCB0aGlzLl9kb2NPckZpZWxkcyA9IHQsIHRoaXMuX2luY2x1c2l2ZSA9IG47XG4gICAgfVxuICAgIHN0YXRpYyBfY3JlYXRlKGUsIHQsIG4pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeUVuZEF0Q29uc3RyYWludChlLCB0LCBuKTtcbiAgICB9XG4gICAgX2FwcGx5KGUpIHtcbiAgICAgICAgY29uc3QgdCA9IF9fUFJJVkFURV9uZXdRdWVyeUJvdW5kRnJvbURvY09yRmllbGRzKGUsIHRoaXMudHlwZSwgdGhpcy5fZG9jT3JGaWVsZHMsIHRoaXMuX2luY2x1c2l2ZSk7XG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkoZS5maXJlc3RvcmUsIGUuY29udmVydGVyLCBmdW5jdGlvbiBfX1BSSVZBVEVfcXVlcnlXaXRoRW5kQXQoZSwgdCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfUXVlcnlJbXBsKGUucGF0aCwgZS5jb2xsZWN0aW9uR3JvdXAsIGUuZXhwbGljaXRPcmRlckJ5LnNsaWNlKCksIGUuZmlsdGVycy5zbGljZSgpLCBlLmxpbWl0LCBlLmxpbWl0VHlwZSwgZS5zdGFydEF0LCB0KTtcbiAgICAgICAgfShlLl9xdWVyeSwgdCkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZW5kQmVmb3JlKC4uLmUpIHtcbiAgICByZXR1cm4gUXVlcnlFbmRBdENvbnN0cmFpbnQuX2NyZWF0ZShcImVuZEJlZm9yZVwiLCBlLCBcbiAgICAvKmluY2x1c2l2ZT0qLyAhMSk7XG59XG5cbmZ1bmN0aW9uIGVuZEF0KC4uLmUpIHtcbiAgICByZXR1cm4gUXVlcnlFbmRBdENvbnN0cmFpbnQuX2NyZWF0ZShcImVuZEF0XCIsIGUsIFxuICAgIC8qaW5jbHVzaXZlPSovICEwKTtcbn1cblxuLyoqIEhlbHBlciBmdW5jdGlvbiB0byBjcmVhdGUgYSBib3VuZCBmcm9tIGEgZG9jdW1lbnQgb3IgZmllbGRzICovIGZ1bmN0aW9uIF9fUFJJVkFURV9uZXdRdWVyeUJvdW5kRnJvbURvY09yRmllbGRzKGUsIHQsIG4sIHIpIHtcbiAgICBpZiAoblswXSA9IGdldE1vZHVsYXJJbnN0YW5jZShuWzBdKSwgblswXSBpbnN0YW5jZW9mIERvY3VtZW50U25hcHNob3QkMSkgcmV0dXJuIGZ1bmN0aW9uIF9fUFJJVkFURV9uZXdRdWVyeUJvdW5kRnJvbURvY3VtZW50KGUsIHQsIG4sIHIsIGkpIHtcbiAgICAgICAgaWYgKCFyKSB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5OT1RfRk9VTkQsIGBDYW4ndCB1c2UgYSBEb2N1bWVudFNuYXBzaG90IHRoYXQgZG9lc24ndCBleGlzdCBmb3IgJHtufSgpLmApO1xuICAgICAgICBjb25zdCBzID0gW107XG4gICAgICAgIC8vIEJlY2F1c2UgcGVvcGxlIGV4cGVjdCB0byBjb250aW51ZS9lbmQgYSBxdWVyeSBhdCB0aGUgZXhhY3QgZG9jdW1lbnRcbiAgICAgICAgLy8gcHJvdmlkZWQsIHdlIG5lZWQgdG8gdXNlIHRoZSBpbXBsaWNpdCBzb3J0IG9yZGVyIHJhdGhlciB0aGFuIHRoZSBleHBsaWNpdFxuICAgICAgICAvLyBzb3J0IG9yZGVyLCBiZWNhdXNlIGl0J3MgZ3VhcmFudGVlZCB0byBjb250YWluIHRoZSBkb2N1bWVudCBrZXkuIFRoYXQgd2F5XG4gICAgICAgIC8vIHRoZSBwb3NpdGlvbiBiZWNvbWVzIHVuYW1iaWd1b3VzIGFuZCB0aGUgcXVlcnkgY29udGludWVzL2VuZHMgZXhhY3RseSBhdFxuICAgICAgICAvLyB0aGUgcHJvdmlkZWQgZG9jdW1lbnQuIFdpdGhvdXQgdGhlIGtleSAoYnkgdXNpbmcgdGhlIGV4cGxpY2l0IHNvcnRcbiAgICAgICAgLy8gb3JkZXJzKSwgbXVsdGlwbGUgZG9jdW1lbnRzIGNvdWxkIG1hdGNoIHRoZSBwb3NpdGlvbiwgeWllbGRpbmcgZHVwbGljYXRlXG4gICAgICAgIC8vIHJlc3VsdHMuXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIF9fUFJJVkFURV9xdWVyeU5vcm1hbGl6ZWRPcmRlckJ5KGUpKSBpZiAobi5maWVsZC5pc0tleUZpZWxkKCkpIHMucHVzaChfX1BSSVZBVEVfcmVmVmFsdWUodCwgci5rZXkpKTsgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBlID0gci5kYXRhLmZpZWxkKG4uZmllbGQpO1xuICAgICAgICAgICAgaWYgKF9fUFJJVkFURV9pc1NlcnZlclRpbWVzdGFtcChlKSkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgJ0ludmFsaWQgcXVlcnkuIFlvdSBhcmUgdHJ5aW5nIHRvIHN0YXJ0IG9yIGVuZCBhIHF1ZXJ5IHVzaW5nIGEgZG9jdW1lbnQgZm9yIHdoaWNoIHRoZSBmaWVsZCBcIicgKyBuLmZpZWxkICsgJ1wiIGlzIGFuIHVuY29tbWl0dGVkIHNlcnZlciB0aW1lc3RhbXAuIChTaW5jZSB0aGUgdmFsdWUgb2YgdGhpcyBmaWVsZCBpcyB1bmtub3duLCB5b3UgY2Fubm90IHN0YXJ0L2VuZCBhIHF1ZXJ5IHdpdGggaXQuKScpO1xuICAgICAgICAgICAgaWYgKG51bGwgPT09IGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gbi5maWVsZC5jYW5vbmljYWxTdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gWW91IGFyZSB0cnlpbmcgdG8gc3RhcnQgb3IgZW5kIGEgcXVlcnkgdXNpbmcgYSBkb2N1bWVudCBmb3Igd2hpY2ggdGhlIGZpZWxkICcke2V9JyAodXNlZCBhcyB0aGUgb3JkZXJCeSkgZG9lcyBub3QgZXhpc3QuYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzLnB1c2goZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBCb3VuZChzLCBpKTtcbiAgICB9XG4gICAgLyoqXG4gKiBDb252ZXJ0cyBhIGxpc3Qgb2YgZmllbGQgdmFsdWVzIHRvIGEgYEJvdW5kYCBmb3IgdGhlIGdpdmVuIHF1ZXJ5LlxuICovIChlLl9xdWVyeSwgZS5maXJlc3RvcmUuX2RhdGFiYXNlSWQsIHQsIG5bMF0uX2RvY3VtZW50LCByKTtcbiAgICB7XG4gICAgICAgIGNvbnN0IGkgPSBfX1BSSVZBVEVfbmV3VXNlckRhdGFSZWFkZXIoZS5maXJlc3RvcmUpO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX25ld1F1ZXJ5Qm91bmRGcm9tRmllbGRzKGUsIHQsIG4sIHIsIGksIHMpIHtcbiAgICAgICAgICAgIC8vIFVzZSBleHBsaWNpdCBvcmRlciBieSdzIGJlY2F1c2UgaXQgaGFzIHRvIG1hdGNoIHRoZSBxdWVyeSB0aGUgdXNlciBtYWRlXG4gICAgICAgICAgICBjb25zdCBvID0gZS5leHBsaWNpdE9yZGVyQnk7XG4gICAgICAgICAgICBpZiAoaS5sZW5ndGggPiBvLmxlbmd0aCkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgYFRvbyBtYW55IGFyZ3VtZW50cyBwcm92aWRlZCB0byAke3J9KCkuIFRoZSBudW1iZXIgb2YgYXJndW1lbnRzIG11c3QgYmUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHRoZSBudW1iZXIgb2Ygb3JkZXJCeSgpIGNsYXVzZXNgKTtcbiAgICAgICAgICAgIGNvbnN0IF8gPSBbXTtcbiAgICAgICAgICAgIGZvciAobGV0IHMgPSAwOyBzIDwgaS5sZW5ndGg7IHMrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBpW3NdO1xuICAgICAgICAgICAgICAgIGlmIChvW3NdLmZpZWxkLmlzS2V5RmllbGQoKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoXCJzdHJpbmdcIiAhPSB0eXBlb2YgYSkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgcXVlcnkuIEV4cGVjdGVkIGEgc3RyaW5nIGZvciBkb2N1bWVudCBJRCBpbiAke3J9KCksIGJ1dCBnb3QgYSAke3R5cGVvZiBhfWApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIV9fUFJJVkFURV9pc0NvbGxlY3Rpb25Hcm91cFF1ZXJ5KGUpICYmIC0xICE9PSBhLmluZGV4T2YoXCIvXCIpKSB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gV2hlbiBxdWVyeWluZyBhIGNvbGxlY3Rpb24gYW5kIG9yZGVyaW5nIGJ5IGRvY3VtZW50SWQoKSwgdGhlIHZhbHVlIHBhc3NlZCB0byAke3J9KCkgbXVzdCBiZSBhIHBsYWluIGRvY3VtZW50IElELCBidXQgJyR7YX0nIGNvbnRhaW5zIGEgc2xhc2guYCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLnBhdGguY2hpbGQoUmVzb3VyY2VQYXRoLmZyb21TdHJpbmcoYSkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIURvY3VtZW50S2V5LmlzRG9jdW1lbnRLZXkobikpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBXaGVuIHF1ZXJ5aW5nIGEgY29sbGVjdGlvbiBncm91cCBhbmQgb3JkZXJpbmcgYnkgZG9jdW1lbnRJZCgpLCB0aGUgdmFsdWUgcGFzc2VkIHRvICR7cn0oKSBtdXN0IHJlc3VsdCBpbiBhIHZhbGlkIGRvY3VtZW50IHBhdGgsIGJ1dCAnJHtufScgaXMgbm90IGJlY2F1c2UgaXQgY29udGFpbnMgYW4gb2RkIG51bWJlciBvZiBzZWdtZW50cy5gKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyBEb2N1bWVudEtleShuKTtcbiAgICAgICAgICAgICAgICAgICAgXy5wdXNoKF9fUFJJVkFURV9yZWZWYWx1ZSh0LCBpKSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IF9fUFJJVkFURV9wYXJzZVF1ZXJ5VmFsdWUobiwgciwgYSk7XG4gICAgICAgICAgICAgICAgICAgIF8ucHVzaChlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IEJvdW5kKF8sIHMpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogUGFyc2VzIHRoZSBnaXZlbiBgZG9jdW1lbnRJZFZhbHVlYCBpbnRvIGEgYFJlZmVyZW5jZVZhbHVlYCwgdGhyb3dpbmdcbiAqIGFwcHJvcHJpYXRlIGVycm9ycyBpZiB0aGUgdmFsdWUgaXMgYW55dGhpbmcgb3RoZXIgdGhhbiBhIGBEb2N1bWVudFJlZmVyZW5jZWBcbiAqIG9yIGBzdHJpbmdgLCBvciBpZiB0aGUgc3RyaW5nIGlzIG1hbGZvcm1lZC5cbiAqLyAoZS5fcXVlcnksIGUuZmlyZXN0b3JlLl9kYXRhYmFzZUlkLCBpLCB0LCBuLCByKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9wYXJzZURvY3VtZW50SWRWYWx1ZShlLCB0LCBuKSB7XG4gICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIChuID0gZ2V0TW9kdWxhckluc3RhbmNlKG4pKSkge1xuICAgICAgICBpZiAoXCJcIiA9PT0gbikgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkIHF1ZXJ5LiBXaGVuIHF1ZXJ5aW5nIHdpdGggZG9jdW1lbnRJZCgpLCB5b3UgbXVzdCBwcm92aWRlIGEgdmFsaWQgZG9jdW1lbnQgSUQsIGJ1dCBpdCB3YXMgYW4gZW1wdHkgc3RyaW5nLlwiKTtcbiAgICAgICAgaWYgKCFfX1BSSVZBVEVfaXNDb2xsZWN0aW9uR3JvdXBRdWVyeSh0KSAmJiAtMSAhPT0gbi5pbmRleE9mKFwiL1wiKSkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgcXVlcnkuIFdoZW4gcXVlcnlpbmcgYSBjb2xsZWN0aW9uIGJ5IGRvY3VtZW50SWQoKSwgeW91IG11c3QgcHJvdmlkZSBhIHBsYWluIGRvY3VtZW50IElELCBidXQgJyR7bn0nIGNvbnRhaW5zIGEgJy8nIGNoYXJhY3Rlci5gKTtcbiAgICAgICAgY29uc3QgciA9IHQucGF0aC5jaGlsZChSZXNvdXJjZVBhdGguZnJvbVN0cmluZyhuKSk7XG4gICAgICAgIGlmICghRG9jdW1lbnRLZXkuaXNEb2N1bWVudEtleShyKSkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgcXVlcnkuIFdoZW4gcXVlcnlpbmcgYSBjb2xsZWN0aW9uIGdyb3VwIGJ5IGRvY3VtZW50SWQoKSwgdGhlIHZhbHVlIHByb3ZpZGVkIG11c3QgcmVzdWx0IGluIGEgdmFsaWQgZG9jdW1lbnQgcGF0aCwgYnV0ICcke3J9JyBpcyBub3QgYmVjYXVzZSBpdCBoYXMgYW4gb2RkIG51bWJlciBvZiBzZWdtZW50cyAoJHtyLmxlbmd0aH0pLmApO1xuICAgICAgICByZXR1cm4gX19QUklWQVRFX3JlZlZhbHVlKGUsIG5ldyBEb2N1bWVudEtleShyKSk7XG4gICAgfVxuICAgIGlmIChuIGluc3RhbmNlb2YgRG9jdW1lbnRSZWZlcmVuY2UpIHJldHVybiBfX1BSSVZBVEVfcmVmVmFsdWUoZSwgbi5fa2V5KTtcbiAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gV2hlbiBxdWVyeWluZyB3aXRoIGRvY3VtZW50SWQoKSwgeW91IG11c3QgcHJvdmlkZSBhIHZhbGlkIHN0cmluZyBvciBhIERvY3VtZW50UmVmZXJlbmNlLCBidXQgaXQgd2FzOiAke19fUFJJVkFURV92YWx1ZURlc2NyaXB0aW9uKG4pfS5gKTtcbn1cblxuLyoqXG4gKiBWYWxpZGF0ZXMgdGhhdCB0aGUgdmFsdWUgcGFzc2VkIGludG8gYSBkaXNqdW5jdGl2ZSBmaWx0ZXIgc2F0aXNmaWVzIGFsbFxuICogYXJyYXkgcmVxdWlyZW1lbnRzLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV92YWxpZGF0ZURpc2p1bmN0aXZlRmlsdGVyRWxlbWVudHMoZSwgdCkge1xuICAgIGlmICghQXJyYXkuaXNBcnJheShlKSB8fCAwID09PSBlLmxlbmd0aCkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgUXVlcnkuIEEgbm9uLWVtcHR5IGFycmF5IGlzIHJlcXVpcmVkIGZvciAnJHt0LnRvU3RyaW5nKCl9JyBmaWx0ZXJzLmApO1xufVxuXG4vKipcbiAqIEdpdmVuIGFuIG9wZXJhdG9yLCByZXR1cm5zIHRoZSBzZXQgb2Ygb3BlcmF0b3JzIHRoYXQgY2Fubm90IGJlIHVzZWQgd2l0aCBpdC5cbiAqXG4gKiBUaGlzIGlzIG5vdCBhIGNvbXByZWhlbnNpdmUgY2hlY2ssIGFuZCB0aGlzIGZ1bmN0aW9uIHNob3VsZCBiZSByZW1vdmVkIGluIHRoZVxuICogbG9uZyB0ZXJtLiBWYWxpZGF0aW9ucyBzaG91bGQgb2NjdXIgaW4gdGhlIEZpcmVzdG9yZSBiYWNrZW5kLlxuICpcbiAqIE9wZXJhdG9ycyBpbiBhIHF1ZXJ5IG11c3QgYWRoZXJlIHRvIHRoZSBmb2xsb3dpbmcgc2V0IG9mIHJ1bGVzOlxuICogMS4gT25seSBvbmUgaW5lcXVhbGl0eSBwZXIgcXVlcnkuXG4gKiAyLiBgTk9UX0lOYCBjYW5ub3QgYmUgdXNlZCB3aXRoIGFycmF5LCBkaXNqdW5jdGl2ZSwgb3IgYE5PVF9FUVVBTGAgb3BlcmF0b3JzLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV92YWxpZGF0ZU5ld0ZpZWxkRmlsdGVyKGUsIHQpIHtcbiAgICBjb25zdCBuID0gZnVuY3Rpb24gX19QUklWQVRFX2ZpbmRPcEluc2lkZUZpbHRlcnMoZSwgdCkge1xuICAgICAgICBmb3IgKGNvbnN0IG4gb2YgZSkgZm9yIChjb25zdCBlIG9mIG4uZ2V0RmxhdHRlbmVkRmlsdGVycygpKSBpZiAodC5pbmRleE9mKGUub3ApID49IDApIHJldHVybiBlLm9wO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9KGUuZmlsdGVycywgZnVuY3Rpb24gX19QUklWQVRFX2NvbmZsaWN0aW5nT3BzKGUpIHtcbiAgICAgICAgc3dpdGNoIChlKSB7XG4gICAgICAgICAgY2FzZSBcIiE9XCIgLyogT3BlcmF0b3IuTk9UX0VRVUFMICovIDpcbiAgICAgICAgICAgIHJldHVybiBbIFwiIT1cIiAvKiBPcGVyYXRvci5OT1RfRVFVQUwgKi8gLCBcIm5vdC1pblwiIC8qIE9wZXJhdG9yLk5PVF9JTiAqLyBdO1xuXG4gICAgICAgICAgY2FzZSBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIE9wZXJhdG9yLkFSUkFZX0NPTlRBSU5TX0FOWSAqLyA6XG4gICAgICAgICAgY2FzZSBcImluXCIgLyogT3BlcmF0b3IuSU4gKi8gOlxuICAgICAgICAgICAgcmV0dXJuIFsgXCJub3QtaW5cIiAvKiBPcGVyYXRvci5OT1RfSU4gKi8gXTtcblxuICAgICAgICAgIGNhc2UgXCJub3QtaW5cIiAvKiBPcGVyYXRvci5OT1RfSU4gKi8gOlxuICAgICAgICAgICAgcmV0dXJuIFsgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBPcGVyYXRvci5BUlJBWV9DT05UQUlOU19BTlkgKi8gLCBcImluXCIgLyogT3BlcmF0b3IuSU4gKi8gLCBcIm5vdC1pblwiIC8qIE9wZXJhdG9yLk5PVF9JTiAqLyAsIFwiIT1cIiAvKiBPcGVyYXRvci5OT1RfRVFVQUwgKi8gXTtcblxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICB9KHQub3ApKTtcbiAgICBpZiAobnVsbCAhPT0gbikgXG4gICAgLy8gU3BlY2lhbCBjYXNlIHdoZW4gaXQncyBhIGR1cGxpY2F0ZSBvcCB0byBnaXZlIGEgc2xpZ2h0bHkgY2xlYXJlciBlcnJvciBtZXNzYWdlLlxuICAgIHRocm93IG4gPT09IHQub3AgPyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gWW91IGNhbm5vdCB1c2UgbW9yZSB0aGFuIG9uZSAnJHt0Lm9wLnRvU3RyaW5nKCl9JyBmaWx0ZXIuYCkgOiBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gWW91IGNhbm5vdCB1c2UgJyR7dC5vcC50b1N0cmluZygpfScgZmlsdGVycyB3aXRoICcke24udG9TdHJpbmcoKX0nIGZpbHRlcnMuYCk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV92YWxpZGF0ZVF1ZXJ5RmlsdGVyQ29uc3RyYWludChlLCB0KSB7XG4gICAgaWYgKCEodCBpbnN0YW5jZW9mIFF1ZXJ5RmllbGRGaWx0ZXJDb25zdHJhaW50IHx8IHQgaW5zdGFuY2VvZiBRdWVyeUNvbXBvc2l0ZUZpbHRlckNvbnN0cmFpbnQpKSB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBgRnVuY3Rpb24gJHtlfSgpIHJlcXVpcmVzIEFwcGxpYWJsZUNvbnN0cmFpbnRzIGNyZWF0ZWQgd2l0aCBhIGNhbGwgdG8gJ3doZXJlKC4uLiknLCAnb3IoLi4uKScsIG9yICdhbmQoLi4uKScuYCk7XG59XG5cbmNsYXNzIEFic3RyYWN0VXNlckRhdGFXcml0ZXIge1xuICAgIGNvbnZlcnRWYWx1ZShlLCB0ID0gXCJub25lXCIpIHtcbiAgICAgICAgc3dpdGNoIChfX1BSSVZBVEVfdHlwZU9yZGVyKGUpKSB7XG4gICAgICAgICAgY2FzZSAwIC8qIFR5cGVPcmRlci5OdWxsVmFsdWUgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICBjYXNlIDEgLyogVHlwZU9yZGVyLkJvb2xlYW5WYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gZS5ib29sZWFuVmFsdWU7XG5cbiAgICAgICAgICBjYXNlIDIgLyogVHlwZU9yZGVyLk51bWJlclZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiBfX1BSSVZBVEVfbm9ybWFsaXplTnVtYmVyKGUuaW50ZWdlclZhbHVlIHx8IGUuZG91YmxlVmFsdWUpO1xuXG4gICAgICAgICAgY2FzZSAzIC8qIFR5cGVPcmRlci5UaW1lc3RhbXBWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0VGltZXN0YW1wKGUudGltZXN0YW1wVmFsdWUpO1xuXG4gICAgICAgICAgY2FzZSA0IC8qIFR5cGVPcmRlci5TZXJ2ZXJUaW1lc3RhbXBWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0U2VydmVyVGltZXN0YW1wKGUsIHQpO1xuXG4gICAgICAgICAgY2FzZSA1IC8qIFR5cGVPcmRlci5TdHJpbmdWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gZS5zdHJpbmdWYWx1ZTtcblxuICAgICAgICAgIGNhc2UgNiAvKiBUeXBlT3JkZXIuQmxvYlZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRCeXRlcyhfX1BSSVZBVEVfbm9ybWFsaXplQnl0ZVN0cmluZyhlLmJ5dGVzVmFsdWUpKTtcblxuICAgICAgICAgIGNhc2UgNyAvKiBUeXBlT3JkZXIuUmVmVmFsdWUgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydFJlZmVyZW5jZShlLnJlZmVyZW5jZVZhbHVlKTtcblxuICAgICAgICAgIGNhc2UgOCAvKiBUeXBlT3JkZXIuR2VvUG9pbnRWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0R2VvUG9pbnQoZS5nZW9Qb2ludFZhbHVlKTtcblxuICAgICAgICAgIGNhc2UgOSAvKiBUeXBlT3JkZXIuQXJyYXlWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0QXJyYXkoZS5hcnJheVZhbHVlLCB0KTtcblxuICAgICAgICAgIGNhc2UgMTEgLyogVHlwZU9yZGVyLk9iamVjdFZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRPYmplY3QoZS5tYXBWYWx1ZSwgdCk7XG5cbiAgICAgICAgICBjYXNlIDEwIC8qIFR5cGVPcmRlci5WZWN0b3JWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0VmVjdG9yVmFsdWUoZS5tYXBWYWx1ZSk7XG5cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgdGhyb3cgZmFpbCg2MjExNCwge1xuICAgICAgICAgICAgICAgIHZhbHVlOiBlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb252ZXJ0T2JqZWN0KGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydE9iamVjdE1hcChlLmZpZWxkcywgdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqLyAgICBjb252ZXJ0T2JqZWN0TWFwKGUsIHQgPSBcIm5vbmVcIikge1xuICAgICAgICBjb25zdCBuID0ge307XG4gICAgICAgIHJldHVybiBmb3JFYWNoKGUsICgoZSwgcikgPT4ge1xuICAgICAgICAgICAgbltlXSA9IHRoaXMuY29udmVydFZhbHVlKHIsIHQpO1xuICAgICAgICB9KSksIG47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqLyAgICBjb252ZXJ0VmVjdG9yVmFsdWUoZSkge1xuICAgICAgICBjb25zdCB0ID0gZS5maWVsZHM/LltFdF0uYXJyYXlWYWx1ZT8udmFsdWVzPy5tYXAoKGUgPT4gX19QUklWQVRFX25vcm1hbGl6ZU51bWJlcihlLmRvdWJsZVZhbHVlKSkpO1xuICAgICAgICByZXR1cm4gbmV3IFZlY3RvclZhbHVlKHQpO1xuICAgIH1cbiAgICBjb252ZXJ0R2VvUG9pbnQoZSkge1xuICAgICAgICByZXR1cm4gbmV3IEdlb1BvaW50KF9fUFJJVkFURV9ub3JtYWxpemVOdW1iZXIoZS5sYXRpdHVkZSksIF9fUFJJVkFURV9ub3JtYWxpemVOdW1iZXIoZS5sb25naXR1ZGUpKTtcbiAgICB9XG4gICAgY29udmVydEFycmF5KGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIChlLnZhbHVlcyB8fCBbXSkubWFwKChlID0+IHRoaXMuY29udmVydFZhbHVlKGUsIHQpKSk7XG4gICAgfVxuICAgIGNvbnZlcnRTZXJ2ZXJUaW1lc3RhbXAoZSwgdCkge1xuICAgICAgICBzd2l0Y2ggKHQpIHtcbiAgICAgICAgICBjYXNlIFwicHJldmlvdXNcIjpcbiAgICAgICAgICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfZ2V0UHJldmlvdXNWYWx1ZShlKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsID09IG4gPyBudWxsIDogdGhpcy5jb252ZXJ0VmFsdWUobiwgdCk7XG5cbiAgICAgICAgICBjYXNlIFwiZXN0aW1hdGVcIjpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRUaW1lc3RhbXAoX19QUklWQVRFX2dldExvY2FsV3JpdGVUaW1lKGUpKTtcblxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb252ZXJ0VGltZXN0YW1wKGUpIHtcbiAgICAgICAgY29uc3QgdCA9IF9fUFJJVkFURV9ub3JtYWxpemVUaW1lc3RhbXAoZSk7XG4gICAgICAgIHJldHVybiBuZXcgVGltZXN0YW1wKHQuc2Vjb25kcywgdC5uYW5vcyk7XG4gICAgfVxuICAgIGNvbnZlcnREb2N1bWVudEtleShlLCB0KSB7XG4gICAgICAgIGNvbnN0IG4gPSBSZXNvdXJjZVBhdGguZnJvbVN0cmluZyhlKTtcbiAgICAgICAgX19QUklWQVRFX2hhcmRBc3NlcnQoX19QUklWQVRFX2lzVmFsaWRSZXNvdXJjZU5hbWUobiksIDk2ODgsIHtcbiAgICAgICAgICAgIG5hbWU6IGVcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHIgPSBuZXcgRGF0YWJhc2VJZChuLmdldCgxKSwgbi5nZXQoMykpLCBpID0gbmV3IERvY3VtZW50S2V5KG4ucG9wRmlyc3QoNSkpO1xuICAgICAgICByZXR1cm4gci5pc0VxdWFsKHQpIHx8IFxuICAgICAgICAvLyBUT0RPKGIvNjQxMzAyMDIpOiBTb21laG93IHN1cHBvcnQgZm9yZWlnbiByZWZlcmVuY2VzLlxuICAgICAgICBfX1BSSVZBVEVfbG9nRXJyb3IoYERvY3VtZW50ICR7aX0gY29udGFpbnMgYSBkb2N1bWVudCByZWZlcmVuY2Ugd2l0aGluIGEgZGlmZmVyZW50IGRhdGFiYXNlICgke3IucHJvamVjdElkfS8ke3IuZGF0YWJhc2V9KSB3aGljaCBpcyBub3Qgc3VwcG9ydGVkLiBJdCB3aWxsIGJlIHRyZWF0ZWQgYXMgYSByZWZlcmVuY2UgaW4gdGhlIGN1cnJlbnQgZGF0YWJhc2UgKCR7dC5wcm9qZWN0SWR9LyR7dC5kYXRhYmFzZX0pIGluc3RlYWQuYCksIFxuICAgICAgICBpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQ29udmVydHMgY3VzdG9tIG1vZGVsIG9iamVjdCBvZiB0eXBlIFQgaW50byBgRG9jdW1lbnREYXRhYCBieSBhcHBseWluZyB0aGVcbiAqIGNvbnZlcnRlciBpZiBpdCBleGlzdHMuXG4gKlxuICogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHdoZW4gY29udmVydGluZyB1c2VyIG9iamVjdHMgdG8gYERvY3VtZW50RGF0YWBcbiAqIGJlY2F1c2Ugd2Ugd2FudCB0byBwcm92aWRlIHRoZSB1c2VyIHdpdGggYSBtb3JlIHNwZWNpZmljIGVycm9yIG1lc3NhZ2UgaWZcbiAqIHRoZWlyIGBzZXQoKWAgb3IgZmFpbHMgZHVlIHRvIGludmFsaWQgZGF0YSBvcmlnaW5hdGluZyBmcm9tIGEgYHRvRmlyZXN0b3JlKClgXG4gKiBjYWxsLlxuICovIGZ1bmN0aW9uIF9fUFJJVkFURV9hcHBseUZpcmVzdG9yZURhdGFDb252ZXJ0ZXIoZSwgdCwgbikge1xuICAgIGxldCByO1xuICAgIC8vIENhc3QgdG8gYGFueWAgaW4gb3JkZXIgdG8gc2F0aXNmeSB0aGUgdW5pb24gdHlwZSBjb25zdHJhaW50IG9uXG4gICAgLy8gdG9GaXJlc3RvcmUoKS5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgIHJldHVybiByID0gZSA/IG4gJiYgKG4ubWVyZ2UgfHwgbi5tZXJnZUZpZWxkcykgPyBlLnRvRmlyZXN0b3JlKHQsIG4pIDogZS50b0ZpcmVzdG9yZSh0KSA6IHQsIFxuICAgIHI7XG59XG5cbmNsYXNzIF9fUFJJVkFURV9MaXRlVXNlckRhdGFXcml0ZXIgZXh0ZW5kcyBBYnN0cmFjdFVzZXJEYXRhV3JpdGVyIHtcbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuZmlyZXN0b3JlID0gZTtcbiAgICB9XG4gICAgY29udmVydEJ5dGVzKGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBCeXRlcyhlKTtcbiAgICB9XG4gICAgY29udmVydFJlZmVyZW5jZShlKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmNvbnZlcnREb2N1bWVudEtleShlLCB0aGlzLmZpcmVzdG9yZS5fZGF0YWJhc2VJZCk7XG4gICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnRSZWZlcmVuY2UodGhpcy5maXJlc3RvcmUsIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCwgdCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBDcmVhdGUgYW4gQWdncmVnYXRlRmllbGQgb2JqZWN0IHRoYXQgY2FuIGJlIHVzZWQgdG8gY29tcHV0ZSB0aGUgc3VtIG9mXG4gKiBhIHNwZWNpZmllZCBmaWVsZCBvdmVyIGEgcmFuZ2Ugb2YgZG9jdW1lbnRzIGluIHRoZSByZXN1bHQgc2V0IG9mIGEgcXVlcnkuXG4gKiBAcGFyYW0gZmllbGQgU3BlY2lmaWVzIHRoZSBmaWVsZCB0byBzdW0gYWNyb3NzIHRoZSByZXN1bHQgc2V0LlxuICovIGZ1bmN0aW9uIHN1bShlKSB7XG4gICAgcmV0dXJuIG5ldyBBZ2dyZWdhdGVGaWVsZChcInN1bVwiLCBfX1BSSVZBVEVfZmllbGRQYXRoRnJvbUFyZ3VtZW50JDEoXCJzdW1cIiwgZSkpO1xufVxuXG4vKipcbiAqIENyZWF0ZSBhbiBBZ2dyZWdhdGVGaWVsZCBvYmplY3QgdGhhdCBjYW4gYmUgdXNlZCB0byBjb21wdXRlIHRoZSBhdmVyYWdlIG9mXG4gKiBhIHNwZWNpZmllZCBmaWVsZCBvdmVyIGEgcmFuZ2Ugb2YgZG9jdW1lbnRzIGluIHRoZSByZXN1bHQgc2V0IG9mIGEgcXVlcnkuXG4gKiBAcGFyYW0gZmllbGQgU3BlY2lmaWVzIHRoZSBmaWVsZCB0byBhdmVyYWdlIGFjcm9zcyB0aGUgcmVzdWx0IHNldC5cbiAqLyBmdW5jdGlvbiBhdmVyYWdlKGUpIHtcbiAgICByZXR1cm4gbmV3IEFnZ3JlZ2F0ZUZpZWxkKFwiYXZnXCIsIF9fUFJJVkFURV9maWVsZFBhdGhGcm9tQXJndW1lbnQkMShcImF2ZXJhZ2VcIiwgZSkpO1xufVxuXG4vKipcbiAqIENyZWF0ZSBhbiBBZ2dyZWdhdGVGaWVsZCBvYmplY3QgdGhhdCBjYW4gYmUgdXNlZCB0byBjb21wdXRlIHRoZSBjb3VudCBvZlxuICogZG9jdW1lbnRzIGluIHRoZSByZXN1bHQgc2V0IG9mIGEgcXVlcnkuXG4gKi8gZnVuY3Rpb24gY291bnQoKSB7XG4gICAgcmV0dXJuIG5ldyBBZ2dyZWdhdGVGaWVsZChcImNvdW50XCIpO1xufVxuXG4vKipcbiAqIENvbXBhcmVzIHR3byAnQWdncmVnYXRlRmllbGRgIGluc3RhbmNlcyBmb3IgZXF1YWxpdHkuXG4gKlxuICogQHBhcmFtIGxlZnQgQ29tcGFyZSB0aGlzIEFnZ3JlZ2F0ZUZpZWxkIHRvIHRoZSBgcmlnaHRgLlxuICogQHBhcmFtIHJpZ2h0IENvbXBhcmUgdGhpcyBBZ2dyZWdhdGVGaWVsZCB0byB0aGUgYGxlZnRgLlxuICovIGZ1bmN0aW9uIGFnZ3JlZ2F0ZUZpZWxkRXF1YWwoZSwgdCkge1xuICAgIHJldHVybiBlIGluc3RhbmNlb2YgQWdncmVnYXRlRmllbGQgJiYgdCBpbnN0YW5jZW9mIEFnZ3JlZ2F0ZUZpZWxkICYmIGUuYWdncmVnYXRlVHlwZSA9PT0gdC5hZ2dyZWdhdGVUeXBlICYmIGUuX2ludGVybmFsRmllbGRQYXRoPy5jYW5vbmljYWxTdHJpbmcoKSA9PT0gdC5faW50ZXJuYWxGaWVsZFBhdGg/LmNhbm9uaWNhbFN0cmluZygpO1xufVxuXG4vKipcbiAqIENvbXBhcmVzIHR3byBgQWdncmVnYXRlUXVlcnlTbmFwc2hvdGAgaW5zdGFuY2VzIGZvciBlcXVhbGl0eS5cbiAqXG4gKiBUd28gYEFnZ3JlZ2F0ZVF1ZXJ5U25hcHNob3RgIGluc3RhbmNlcyBhcmUgY29uc2lkZXJlZCBcImVxdWFsXCIgaWYgdGhleSBoYXZlXG4gKiB1bmRlcmx5aW5nIHF1ZXJpZXMgdGhhdCBjb21wYXJlIGVxdWFsLCBhbmQgdGhlIHNhbWUgZGF0YS5cbiAqXG4gKiBAcGFyYW0gbGVmdCAtIFRoZSBmaXJzdCBgQWdncmVnYXRlUXVlcnlTbmFwc2hvdGAgdG8gY29tcGFyZS5cbiAqIEBwYXJhbSByaWdodCAtIFRoZSBzZWNvbmQgYEFnZ3JlZ2F0ZVF1ZXJ5U25hcHNob3RgIHRvIGNvbXBhcmUuXG4gKlxuICogQHJldHVybnMgYHRydWVgIGlmIHRoZSBvYmplY3RzIGFyZSBcImVxdWFsXCIsIGFzIGRlZmluZWQgYWJvdmUsIG9yIGBmYWxzZWBcbiAqIG90aGVyd2lzZS5cbiAqLyBmdW5jdGlvbiBhZ2dyZWdhdGVRdWVyeVNuYXBzaG90RXF1YWwoZSwgdCkge1xuICAgIHJldHVybiBxdWVyeUVxdWFsKGUucXVlcnksIHQucXVlcnkpICYmIGRlZXBFcXVhbChlLmRhdGEoKSwgdC5kYXRhKCkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyNSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IFRuID0gXCJOT1QgU1VQUE9SVEVEXCI7XG5cbi8qKlxuICogTWV0YWRhdGEgYWJvdXQgYSBzbmFwc2hvdCwgZGVzY3JpYmluZyB0aGUgc3RhdGUgb2YgdGhlIHNuYXBzaG90LlxuICovIGNsYXNzIFNuYXBzaG90TWV0YWRhdGEge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICB0aGlzLmhhc1BlbmRpbmdXcml0ZXMgPSBlLCB0aGlzLmZyb21DYWNoZSA9IHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGBTbmFwc2hvdE1ldGFkYXRhYCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqXG4gICAgICogQHBhcmFtIG90aGVyIC0gVGhlIGBTbmFwc2hvdE1ldGFkYXRhYCB0byBjb21wYXJlIGFnYWluc3QuXG4gICAgICogQHJldHVybnMgdHJ1ZSBpZiB0aGlzIGBTbmFwc2hvdE1ldGFkYXRhYCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqLyAgICBpc0VxdWFsKGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGFzUGVuZGluZ1dyaXRlcyA9PT0gZS5oYXNQZW5kaW5nV3JpdGVzICYmIHRoaXMuZnJvbUNhY2hlID09PSBlLmZyb21DYWNoZTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBgRG9jdW1lbnRTbmFwc2hvdGAgY29udGFpbnMgZGF0YSByZWFkIGZyb20gYSBkb2N1bWVudCBpbiB5b3VyIEZpcmVzdG9yZVxuICogZGF0YWJhc2UuIFRoZSBkYXRhIGNhbiBiZSBleHRyYWN0ZWQgd2l0aCBgLmRhdGEoKWAgb3IgYC5nZXQoPGZpZWxkPilgIHRvXG4gKiBnZXQgYSBzcGVjaWZpYyBmaWVsZC5cbiAqXG4gKiBGb3IgYSBgRG9jdW1lbnRTbmFwc2hvdGAgdGhhdCBwb2ludHMgdG8gYSBub24tZXhpc3RpbmcgZG9jdW1lbnQsIGFueSBkYXRhXG4gKiBhY2Nlc3Mgd2lsbCByZXR1cm4gJ3VuZGVmaW5lZCcuIFlvdSBjYW4gdXNlIHRoZSBgZXhpc3RzKClgIG1ldGhvZCB0b1xuICogZXhwbGljaXRseSB2ZXJpZnkgYSBkb2N1bWVudCdzIGV4aXN0ZW5jZS5cbiAqLyBjbGFzcyBEb2N1bWVudFNuYXBzaG90IGV4dGVuZHMgRG9jdW1lbnRTbmFwc2hvdCQxIHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciBwcm90ZWN0ZWQgKi9cbiAgICBjb25zdHJ1Y3RvcihlLCB0LCBuLCByLCBpLCBzKSB7XG4gICAgICAgIHN1cGVyKGUsIHQsIG4sIHIsIHMpLCB0aGlzLl9maXJlc3RvcmUgPSBlLCB0aGlzLl9maXJlc3RvcmVJbXBsID0gZSwgdGhpcy5tZXRhZGF0YSA9IGk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgd2hldGhlciBvciBub3QgdGhlIGRhdGEgZXhpc3RzLiBUcnVlIGlmIHRoZSBkb2N1bWVudCBleGlzdHMuXG4gICAgICovICAgIGV4aXN0cygpIHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmV4aXN0cygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZXMgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQgYXMgYW4gYE9iamVjdGAuIFJldHVybnMgYHVuZGVmaW5lZGAgaWZcbiAgICAgKiB0aGUgZG9jdW1lbnQgZG9lc24ndCBleGlzdC5cbiAgICAgKlxuICAgICAqIEJ5IGRlZmF1bHQsIGBzZXJ2ZXJUaW1lc3RhbXAoKWAgdmFsdWVzIHRoYXQgaGF2ZSBub3QgeWV0IGJlZW5cbiAgICAgKiBzZXQgdG8gdGhlaXIgZmluYWwgdmFsdWUgd2lsbCBiZSByZXR1cm5lZCBhcyBgbnVsbGAuIFlvdSBjYW4gb3ZlcnJpZGVcbiAgICAgKiB0aGlzIGJ5IHBhc3NpbmcgYW4gb3B0aW9ucyBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb3B0aW9ucyAtIEFuIG9wdGlvbnMgb2JqZWN0IHRvIGNvbmZpZ3VyZSBob3cgZGF0YSBpcyByZXRyaWV2ZWQgZnJvbVxuICAgICAqIHRoZSBzbmFwc2hvdCAoZm9yIGV4YW1wbGUgdGhlIGRlc2lyZWQgYmVoYXZpb3IgZm9yIHNlcnZlciB0aW1lc3RhbXBzIHRoYXRcbiAgICAgKiBoYXZlIG5vdCB5ZXQgYmVlbiBzZXQgdG8gdGhlaXIgZmluYWwgdmFsdWUpLlxuICAgICAqIEByZXR1cm5zIEFuIGBPYmplY3RgIGNvbnRhaW5pbmcgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQgb3IgYHVuZGVmaW5lZGAgaWZcbiAgICAgKiB0aGUgZG9jdW1lbnQgZG9lc24ndCBleGlzdC5cbiAgICAgKi8gICAgZGF0YShlID0ge30pIHtcbiAgICAgICAgaWYgKHRoaXMuX2RvY3VtZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29udmVydGVyKSB7XG4gICAgICAgICAgICAgICAgLy8gV2Ugb25seSB3YW50IHRvIHVzZSB0aGUgY29udmVydGVyIGFuZCBjcmVhdGUgYSBuZXcgRG9jdW1lbnRTbmFwc2hvdFxuICAgICAgICAgICAgICAgIC8vIGlmIGEgY29udmVydGVyIGhhcyBiZWVuIHByb3ZpZGVkLlxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBuZXcgUXVlcnlEb2N1bWVudFNuYXBzaG90KHRoaXMuX2ZpcmVzdG9yZSwgdGhpcy5fdXNlckRhdGFXcml0ZXIsIHRoaXMuX2tleSwgdGhpcy5fZG9jdW1lbnQsIHRoaXMubWV0YWRhdGEsIFxuICAgICAgICAgICAgICAgIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnZlcnRlci5mcm9tRmlyZXN0b3JlKHQsIGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VzZXJEYXRhV3JpdGVyLmNvbnZlcnRWYWx1ZSh0aGlzLl9kb2N1bWVudC5kYXRhLnZhbHVlLCBlLnNlcnZlclRpbWVzdGFtcHMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlcyB0aGUgZmllbGQgc3BlY2lmaWVkIGJ5IGBmaWVsZFBhdGhgLiBSZXR1cm5zIGB1bmRlZmluZWRgIGlmIHRoZVxuICAgICAqIGRvY3VtZW50IG9yIGZpZWxkIGRvZXNuJ3QgZXhpc3QuXG4gICAgICpcbiAgICAgKiBCeSBkZWZhdWx0LCBhIGBzZXJ2ZXJUaW1lc3RhbXAoKWAgdGhhdCBoYXMgbm90IHlldCBiZWVuIHNldCB0b1xuICAgICAqIGl0cyBmaW5hbCB2YWx1ZSB3aWxsIGJlIHJldHVybmVkIGFzIGBudWxsYC4gWW91IGNhbiBvdmVycmlkZSB0aGlzIGJ5XG4gICAgICogcGFzc2luZyBhbiBvcHRpb25zIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBmaWVsZFBhdGggLSBUaGUgcGF0aCAoZm9yIGV4YW1wbGUgJ2Zvbycgb3IgJ2Zvby5iYXInKSB0byBhIHNwZWNpZmljXG4gICAgICogZmllbGQuXG4gICAgICogQHBhcmFtIG9wdGlvbnMgLSBBbiBvcHRpb25zIG9iamVjdCB0byBjb25maWd1cmUgaG93IHRoZSBmaWVsZCBpcyByZXRyaWV2ZWRcbiAgICAgKiBmcm9tIHRoZSBzbmFwc2hvdCAoZm9yIGV4YW1wbGUgdGhlIGRlc2lyZWQgYmVoYXZpb3IgZm9yIHNlcnZlciB0aW1lc3RhbXBzXG4gICAgICogdGhhdCBoYXZlIG5vdCB5ZXQgYmVlbiBzZXQgdG8gdGhlaXIgZmluYWwgdmFsdWUpLlxuICAgICAqIEByZXR1cm5zIFRoZSBkYXRhIGF0IHRoZSBzcGVjaWZpZWQgZmllbGQgbG9jYXRpb24gb3IgdW5kZWZpbmVkIGlmIG5vIHN1Y2hcbiAgICAgKiBmaWVsZCBleGlzdHMgaW4gdGhlIGRvY3VtZW50LlxuICAgICAqL1xuICAgIC8vIFdlIGFyZSB1c2luZyBgYW55YCBoZXJlIHRvIGF2b2lkIGFuIGV4cGxpY2l0IGNhc3QgYnkgb3VyIHVzZXJzLlxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgZ2V0KGUsIHQgPSB7fSkge1xuICAgICAgICBpZiAodGhpcy5fZG9jdW1lbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLl9kb2N1bWVudC5kYXRhLmZpZWxkKF9fUFJJVkFURV9maWVsZFBhdGhGcm9tQXJndW1lbnQoXCJEb2N1bWVudFNuYXBzaG90LmdldFwiLCBlKSk7XG4gICAgICAgICAgICBpZiAobnVsbCAhPT0gbikgcmV0dXJuIHRoaXMuX3VzZXJEYXRhV3JpdGVyLmNvbnZlcnRWYWx1ZShuLCB0LnNlcnZlclRpbWVzdGFtcHMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBKU09OLXNlcmlhbGl6YWJsZSByZXByZXNlbnRhdGlvbiBvZiB0aGlzIGBEb2N1bWVudFNuYXBzaG90YCBpbnN0YW5jZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIGEgSlNPTiByZXByZXNlbnRhdGlvbiBvZiB0aGlzIG9iamVjdC4gIFRocm93cyBhIHtAbGluayBGaXJlc3RvcmVFcnJvcn0gaWYgdGhpc1xuICAgICAqIGBEb2N1bWVudFNuYXBzaG90YCBoYXMgcGVuZGluZyB3cml0ZXMuXG4gICAgICovICAgIHRvSlNPTigpIHtcbiAgICAgICAgaWYgKHRoaXMubWV0YWRhdGEuaGFzUGVuZGluZ1dyaXRlcykgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uRkFJTEVEX1BSRUNPTkRJVElPTiwgXCJEb2N1bWVudFNuYXBzaG90LnRvSlNPTigpIGF0dGVtcHRlZCB0byBzZXJpYWxpemUgYSBkb2N1bWVudCB3aXRoIHBlbmRpbmcgd3JpdGVzLiBBd2FpdCB3YWl0Rm9yUGVuZGluZ1dyaXRlcygpIGJlZm9yZSBpbnZva2luZyB0b0pTT04oKS5cIik7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLl9kb2N1bWVudCwgdCA9IHt9O1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICAgIGlmICh0LnR5cGUgPSBEb2N1bWVudFNuYXBzaG90Ll9qc29uU2NoZW1hVmVyc2lvbiwgdC5idW5kbGUgPSBcIlwiLCB0LmJ1bmRsZVNvdXJjZSA9IFwiRG9jdW1lbnRTbmFwc2hvdFwiLCBcbiAgICAgICAgdC5idW5kbGVOYW1lID0gdGhpcy5fa2V5LnRvU3RyaW5nKCksICFlIHx8ICFlLmlzVmFsaWREb2N1bWVudCgpIHx8ICFlLmlzRm91bmREb2N1bWVudCgpKSByZXR1cm4gdDtcbiAgICAgICAgdGhpcy5fdXNlckRhdGFXcml0ZXIuY29udmVydE9iamVjdE1hcChlLmRhdGEudmFsdWUubWFwVmFsdWUuZmllbGRzLCBcInByZXZpb3VzXCIpO1xuICAgICAgICByZXR1cm4gdC5idW5kbGUgPSAodGhpcy5fZmlyZXN0b3JlLCB0aGlzLnJlZi5wYXRoLCBcIk5PVCBTVVBQT1JURURcIiksIHQ7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkb2N1bWVudFNuYXBzaG90RnJvbUpTT04oZSwgdCwgbikge1xuICAgIGlmIChfX1BSSVZBVEVfdmFsaWRhdGVKU09OKHQsIERvY3VtZW50U25hcHNob3QuX2pzb25TY2hlbWEpKSB7XG4gICAgICAgIGlmICh0LmJ1bmRsZSA9PT0gVG4pIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIFwiVGhlIHByb3ZpZGVkIEpTT04gb2JqZWN0IHdhcyBjcmVhdGVkIGluIGEgY2xpZW50IGVudmlyb25tZW50LCB3aGljaCBpcyBub3Qgc3VwcG9ydGVkLlwiKTtcbiAgICAgICAgLy8gUGFyc2UgdGhlIGJ1bmRsZSBkYXRhLlxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfbmV3U2VyaWFsaXplcihlLl9kYXRhYmFzZUlkKSwgaSA9IF9fUFJJVkFURV9jcmVhdGVCdW5kbGVSZWFkZXJTeW5jKHQuYnVuZGxlLCByKSwgcyA9IGkuV3UoKSwgbyA9IG5ldyBfX1BSSVZBVEVfQnVuZGxlTG9hZGVyKGkuZ2V0TWV0YWRhdGEoKSwgcik7XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiBzKSBvLkdhKGUpO1xuICAgICAgICAvLyBFbnN1cmUgdGhhdCB3ZSBoYXZlIHRoZSBjb3JyZWN0IG51bWJlciBvZiBkb2N1bWVudHMgaW4gdGhlIGJ1bmRsZS5cbiAgICAgICAgICAgICAgICBjb25zdCBfID0gby5kb2N1bWVudHM7XG4gICAgICAgIGlmICgxICE9PSBfLmxlbmd0aCkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgYEV4cGVjdGVkIGJ1bmRsZSBkYXRhIHRvIGNvbnRhaW4gMSBkb2N1bWVudCwgYnV0IGl0IGNvbnRhaW5zICR7Xy5sZW5ndGh9IGRvY3VtZW50cy5gKTtcbiAgICAgICAgLy8gQnVpbGQgb3V0IHRoZSBpbnRlcm5hbCBkb2N1bWVudCBkYXRhLlxuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBfX1BSSVZBVEVfZnJvbURvY3VtZW50KHIsIF9bMF0uZG9jdW1lbnQpLCB1ID0gbmV3IERvY3VtZW50S2V5KFJlc291cmNlUGF0aC5mcm9tU3RyaW5nKHQuYnVuZGxlTmFtZSkpO1xuICAgICAgICAvLyBSZXR1cm4gdGhlIGV4dGVybmFsIGZhY2luZyBEb2N1bWVudFNuYXBzaG90LlxuICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50U25hcHNob3QoZSwgbmV3IF9fUFJJVkFURV9MaXRlVXNlckRhdGFXcml0ZXIoZSksIHUsIGEsIG5ldyBTbmFwc2hvdE1ldGFkYXRhKFxuICAgICAgICAvKiBoYXNQZW5kaW5nV3JpdGVzPSAqLyAhMSwgXG4gICAgICAgIC8qIGZyb21DYWNoZT0gKi8gITEpLCBuIHx8IG51bGwpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBIGBRdWVyeURvY3VtZW50U25hcHNob3RgIGNvbnRhaW5zIGRhdGEgcmVhZCBmcm9tIGEgZG9jdW1lbnQgaW4geW91clxuICogRmlyZXN0b3JlIGRhdGFiYXNlIGFzIHBhcnQgb2YgYSBxdWVyeS4gVGhlIGRvY3VtZW50IGlzIGd1YXJhbnRlZWQgdG8gZXhpc3RcbiAqIGFuZCBpdHMgZGF0YSBjYW4gYmUgZXh0cmFjdGVkIHdpdGggYC5kYXRhKClgIG9yIGAuZ2V0KDxmaWVsZD4pYCB0byBnZXQgYVxuICogc3BlY2lmaWMgZmllbGQuXG4gKlxuICogQSBgUXVlcnlEb2N1bWVudFNuYXBzaG90YCBvZmZlcnMgdGhlIHNhbWUgQVBJIHN1cmZhY2UgYXMgYVxuICogYERvY3VtZW50U25hcHNob3RgLiBTaW5jZSBxdWVyeSByZXN1bHRzIGNvbnRhaW4gb25seSBleGlzdGluZyBkb2N1bWVudHMsIHRoZVxuICogYGV4aXN0c2AgcHJvcGVydHkgd2lsbCBhbHdheXMgYmUgdHJ1ZSBhbmQgYGRhdGEoKWAgd2lsbCBuZXZlciByZXR1cm5cbiAqICd1bmRlZmluZWQnLlxuICovIERvY3VtZW50U25hcHNob3QuX2pzb25TY2hlbWFWZXJzaW9uID0gXCJmaXJlc3RvcmUvZG9jdW1lbnRTbmFwc2hvdC8xLjBcIiwgRG9jdW1lbnRTbmFwc2hvdC5fanNvblNjaGVtYSA9IHtcbiAgICB0eXBlOiBwcm9wZXJ0eShcInN0cmluZ1wiLCBEb2N1bWVudFNuYXBzaG90Ll9qc29uU2NoZW1hVmVyc2lvbiksXG4gICAgYnVuZGxlU291cmNlOiBwcm9wZXJ0eShcInN0cmluZ1wiLCBcIkRvY3VtZW50U25hcHNob3RcIiksXG4gICAgYnVuZGxlTmFtZTogcHJvcGVydHkoXCJzdHJpbmdcIiksXG4gICAgYnVuZGxlOiBwcm9wZXJ0eShcInN0cmluZ1wiKVxufTtcblxuY2xhc3MgUXVlcnlEb2N1bWVudFNuYXBzaG90IGV4dGVuZHMgRG9jdW1lbnRTbmFwc2hvdCB7XG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIGFsbCBmaWVsZHMgaW4gdGhlIGRvY3VtZW50IGFzIGFuIGBPYmplY3RgLlxuICAgICAqXG4gICAgICogQnkgZGVmYXVsdCwgYHNlcnZlclRpbWVzdGFtcCgpYCB2YWx1ZXMgdGhhdCBoYXZlIG5vdCB5ZXQgYmVlblxuICAgICAqIHNldCB0byB0aGVpciBmaW5hbCB2YWx1ZSB3aWxsIGJlIHJldHVybmVkIGFzIGBudWxsYC4gWW91IGNhbiBvdmVycmlkZVxuICAgICAqIHRoaXMgYnkgcGFzc2luZyBhbiBvcHRpb25zIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBvdmVycmlkZVxuICAgICAqIEBwYXJhbSBvcHRpb25zIC0gQW4gb3B0aW9ucyBvYmplY3QgdG8gY29uZmlndXJlIGhvdyBkYXRhIGlzIHJldHJpZXZlZCBmcm9tXG4gICAgICogdGhlIHNuYXBzaG90IChmb3IgZXhhbXBsZSB0aGUgZGVzaXJlZCBiZWhhdmlvciBmb3Igc2VydmVyIHRpbWVzdGFtcHMgdGhhdFxuICAgICAqIGhhdmUgbm90IHlldCBiZWVuIHNldCB0byB0aGVpciBmaW5hbCB2YWx1ZSkuXG4gICAgICogQHJldHVybnMgQW4gYE9iamVjdGAgY29udGFpbmluZyBhbGwgZmllbGRzIGluIHRoZSBkb2N1bWVudC5cbiAgICAgKi9cbiAgICBkYXRhKGUgPSB7fSkge1xuICAgICAgICByZXR1cm4gc3VwZXIuZGF0YShlKTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBgUXVlcnlTbmFwc2hvdGAgY29udGFpbnMgemVybyBvciBtb3JlIGBEb2N1bWVudFNuYXBzaG90YCBvYmplY3RzXG4gKiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdHMgb2YgYSBxdWVyeS4gVGhlIGRvY3VtZW50cyBjYW4gYmUgYWNjZXNzZWQgYXMgYW5cbiAqIGFycmF5IHZpYSB0aGUgYGRvY3NgIHByb3BlcnR5IG9yIGVudW1lcmF0ZWQgdXNpbmcgdGhlIGBmb3JFYWNoYCBtZXRob2QuIFRoZVxuICogbnVtYmVyIG9mIGRvY3VtZW50cyBjYW4gYmUgZGV0ZXJtaW5lZCB2aWEgdGhlIGBlbXB0eWAgYW5kIGBzaXplYFxuICogcHJvcGVydGllcy5cbiAqLyBjbGFzcyBRdWVyeVNuYXBzaG90IHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciAqL1xuICAgIGNvbnN0cnVjdG9yKGUsIHQsIG4sIHIpIHtcbiAgICAgICAgdGhpcy5fZmlyZXN0b3JlID0gZSwgdGhpcy5fdXNlckRhdGFXcml0ZXIgPSB0LCB0aGlzLl9zbmFwc2hvdCA9IHIsIHRoaXMubWV0YWRhdGEgPSBuZXcgU25hcHNob3RNZXRhZGF0YShyLmhhc1BlbmRpbmdXcml0ZXMsIHIuZnJvbUNhY2hlKSwgXG4gICAgICAgIHRoaXMucXVlcnkgPSBuO1xuICAgIH1cbiAgICAvKiogQW4gYXJyYXkgb2YgYWxsIHRoZSBkb2N1bWVudHMgaW4gdGhlIGBRdWVyeVNuYXBzaG90YC4gKi8gICAgZ2V0IGRvY3MoKSB7XG4gICAgICAgIGNvbnN0IGUgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9yRWFjaCgodCA9PiBlLnB1c2godCkpKSwgZTtcbiAgICB9XG4gICAgLyoqIFRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIGluIHRoZSBgUXVlcnlTbmFwc2hvdGAuICovICAgIGdldCBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc25hcHNob3QuZG9jcy5zaXplO1xuICAgIH1cbiAgICAvKiogVHJ1ZSBpZiB0aGVyZSBhcmUgbm8gZG9jdW1lbnRzIGluIHRoZSBgUXVlcnlTbmFwc2hvdGAuICovICAgIGdldCBlbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIDAgPT09IHRoaXMuc2l6ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW51bWVyYXRlcyBhbGwgb2YgdGhlIGRvY3VtZW50cyBpbiB0aGUgYFF1ZXJ5U25hcHNob3RgLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIC0gQSBjYWxsYmFjayB0byBiZSBjYWxsZWQgd2l0aCBhIGBRdWVyeURvY3VtZW50U25hcHNob3RgIGZvclxuICAgICAqIGVhY2ggZG9jdW1lbnQgaW4gdGhlIHNuYXBzaG90LlxuICAgICAqIEBwYXJhbSB0aGlzQXJnIC0gVGhlIGB0aGlzYCBiaW5kaW5nIGZvciB0aGUgY2FsbGJhY2suXG4gICAgICovICAgIGZvckVhY2goZSwgdCkge1xuICAgICAgICB0aGlzLl9zbmFwc2hvdC5kb2NzLmZvckVhY2goKG4gPT4ge1xuICAgICAgICAgICAgZS5jYWxsKHQsIG5ldyBRdWVyeURvY3VtZW50U25hcHNob3QodGhpcy5fZmlyZXN0b3JlLCB0aGlzLl91c2VyRGF0YVdyaXRlciwgbi5rZXksIG4sIG5ldyBTbmFwc2hvdE1ldGFkYXRhKHRoaXMuX3NuYXBzaG90Lm11dGF0ZWRLZXlzLmhhcyhuLmtleSksIHRoaXMuX3NuYXBzaG90LmZyb21DYWNoZSksIHRoaXMucXVlcnkuY29udmVydGVyKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhbiBhcnJheSBvZiB0aGUgZG9jdW1lbnRzIGNoYW5nZXMgc2luY2UgdGhlIGxhc3Qgc25hcHNob3QuIElmIHRoaXNcbiAgICAgKiBpcyB0aGUgZmlyc3Qgc25hcHNob3QsIGFsbCBkb2N1bWVudHMgd2lsbCBiZSBpbiB0aGUgbGlzdCBhcyAnYWRkZWQnXG4gICAgICogY2hhbmdlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvcHRpb25zIC0gYFNuYXBzaG90TGlzdGVuT3B0aW9uc2AgdGhhdCBjb250cm9sIHdoZXRoZXIgbWV0YWRhdGEtb25seVxuICAgICAqIGNoYW5nZXMgKGkuZS4gb25seSBgRG9jdW1lbnRTbmFwc2hvdC5tZXRhZGF0YWAgY2hhbmdlZCkgc2hvdWxkIHRyaWdnZXJcbiAgICAgKiBzbmFwc2hvdCBldmVudHMuXG4gICAgICovICAgIGRvY0NoYW5nZXMoZSA9IHt9KSB7XG4gICAgICAgIGNvbnN0IHQgPSAhIWUuaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcztcbiAgICAgICAgaWYgKHQgJiYgdGhpcy5fc25hcHNob3QuZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXMpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIFwiVG8gaW5jbHVkZSBtZXRhZGF0YSBjaGFuZ2VzIHdpdGggeW91ciBkb2N1bWVudCBjaGFuZ2VzLCB5b3UgbXVzdCBhbHNvIHBhc3MgeyBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzOnRydWUgfSB0byBvblNuYXBzaG90KCkuXCIpO1xuICAgICAgICByZXR1cm4gdGhpcy5fY2FjaGVkQ2hhbmdlcyAmJiB0aGlzLl9jYWNoZWRDaGFuZ2VzSW5jbHVkZU1ldGFkYXRhQ2hhbmdlcyA9PT0gdCB8fCAodGhpcy5fY2FjaGVkQ2hhbmdlcyA9IFxuICAgICAgICAvKiogQ2FsY3VsYXRlcyB0aGUgYXJyYXkgb2YgYERvY3VtZW50Q2hhbmdlYHMgZm9yIGEgZ2l2ZW4gYFZpZXdTbmFwc2hvdGAuICovXG4gICAgICAgIGZ1bmN0aW9uIF9fUFJJVkFURV9jaGFuZ2VzRnJvbVNuYXBzaG90KGUsIHQpIHtcbiAgICAgICAgICAgIGlmIChlLl9zbmFwc2hvdC5vbGREb2NzLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgIGxldCB0ID0gMDtcbiAgICAgICAgICAgICAgICByZXR1cm4gZS5fc25hcHNob3QuZG9jQ2hhbmdlcy5tYXAoKG4gPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gbmV3IFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdChlLl9maXJlc3RvcmUsIGUuX3VzZXJEYXRhV3JpdGVyLCBuLmRvYy5rZXksIG4uZG9jLCBuZXcgU25hcHNob3RNZXRhZGF0YShlLl9zbmFwc2hvdC5tdXRhdGVkS2V5cy5oYXMobi5kb2Mua2V5KSwgZS5fc25hcHNob3QuZnJvbUNhY2hlKSwgZS5xdWVyeS5jb252ZXJ0ZXIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbi5kb2MsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYWRkZWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvYzogcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG9sZEluZGV4OiAtMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0luZGV4OiB0KytcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gQSBgRG9jdW1lbnRTZXRgIHRoYXQgaXMgdXBkYXRlZCBpbmNyZW1lbnRhbGx5IGFzIGNoYW5nZXMgYXJlIGFwcGxpZWQgdG8gdXNlXG4gICAgICAgICAgICAgICAgLy8gdG8gbG9va3VwIHRoZSBpbmRleCBvZiBhIGRvY3VtZW50LlxuICAgICAgICAgICAgICAgIGxldCBuID0gZS5fc25hcHNob3Qub2xkRG9jcztcbiAgICAgICAgICAgICAgICByZXR1cm4gZS5fc25hcHNob3QuZG9jQ2hhbmdlcy5maWx0ZXIoKGUgPT4gdCB8fCAzIC8qIENoYW5nZVR5cGUuTWV0YWRhdGEgKi8gIT09IGUudHlwZSkpLm1hcCgodCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuZXcgUXVlcnlEb2N1bWVudFNuYXBzaG90KGUuX2ZpcmVzdG9yZSwgZS5fdXNlckRhdGFXcml0ZXIsIHQuZG9jLmtleSwgdC5kb2MsIG5ldyBTbmFwc2hvdE1ldGFkYXRhKGUuX3NuYXBzaG90Lm11dGF0ZWRLZXlzLmhhcyh0LmRvYy5rZXkpLCBlLl9zbmFwc2hvdC5mcm9tQ2FjaGUpLCBlLnF1ZXJ5LmNvbnZlcnRlcik7XG4gICAgICAgICAgICAgICAgICAgIGxldCBpID0gLTEsIHMgPSAtMTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDAgLyogQ2hhbmdlVHlwZS5BZGRlZCAqLyAhPT0gdC50eXBlICYmIChpID0gbi5pbmRleE9mKHQuZG9jLmtleSksIG4gPSBuLmRlbGV0ZSh0LmRvYy5rZXkpKSwgXG4gICAgICAgICAgICAgICAgICAgIDEgLyogQ2hhbmdlVHlwZS5SZW1vdmVkICovICE9PSB0LnR5cGUgJiYgKG4gPSBuLmFkZCh0LmRvYyksIHMgPSBuLmluZGV4T2YodC5kb2Mua2V5KSksIFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBfX1BSSVZBVEVfcmVzdWx0Q2hhbmdlVHlwZSh0LnR5cGUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jOiByLFxuICAgICAgICAgICAgICAgICAgICAgICAgb2xkSW5kZXg6IGksXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdJbmRleDogc1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSh0aGlzLCB0KSwgdGhpcy5fY2FjaGVkQ2hhbmdlc0luY2x1ZGVNZXRhZGF0YUNoYW5nZXMgPSB0KSwgdGhpcy5fY2FjaGVkQ2hhbmdlcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIEpTT04tc2VyaWFsaXphYmxlIHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgYFF1ZXJ5U25hcHNob3RgIGluc3RhbmNlLlxuICAgICAqXG4gICAgICogQHJldHVybnMgYSBKU09OIHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgb2JqZWN0LiBUaHJvd3MgYSB7QGxpbmsgRmlyZXN0b3JlRXJyb3J9IGlmIHRoaXNcbiAgICAgKiBgUXVlcnlTbmFwc2hvdGAgaGFzIHBlbmRpbmcgd3JpdGVzLlxuICAgICAqLyAgICB0b0pTT04oKSB7XG4gICAgICAgIGlmICh0aGlzLm1ldGFkYXRhLmhhc1BlbmRpbmdXcml0ZXMpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiUXVlcnlTbmFwc2hvdC50b0pTT04oKSBhdHRlbXB0ZWQgdG8gc2VyaWFsaXplIGEgZG9jdW1lbnQgd2l0aCBwZW5kaW5nIHdyaXRlcy4gQXdhaXQgd2FpdEZvclBlbmRpbmdXcml0ZXMoKSBiZWZvcmUgaW52b2tpbmcgdG9KU09OKCkuXCIpO1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB7fTtcbiAgICAgICAgZS50eXBlID0gUXVlcnlTbmFwc2hvdC5fanNvblNjaGVtYVZlcnNpb24sIGUuYnVuZGxlU291cmNlID0gXCJRdWVyeVNuYXBzaG90XCIsIGUuYnVuZGxlTmFtZSA9IF9fUFJJVkFURV9BdXRvSWQubmV3SWQoKSwgXG4gICAgICAgIHRoaXMuX2ZpcmVzdG9yZS5fZGF0YWJhc2VJZC5kYXRhYmFzZSwgdGhpcy5fZmlyZXN0b3JlLl9kYXRhYmFzZUlkLnByb2plY3RJZDtcbiAgICAgICAgY29uc3QgdCA9IFtdLCBuID0gW10sIHIgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG9jcy5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIG51bGwgIT09IGUuX2RvY3VtZW50ICYmICh0LnB1c2goZS5fZG9jdW1lbnQpLCBuLnB1c2godGhpcy5fdXNlckRhdGFXcml0ZXIuY29udmVydE9iamVjdE1hcChlLl9kb2N1bWVudC5kYXRhLnZhbHVlLm1hcFZhbHVlLmZpZWxkcywgXCJwcmV2aW91c1wiKSksIFxuICAgICAgICAgICAgci5wdXNoKGUucmVmLnBhdGgpKTtcbiAgICAgICAgfSkpLCBlLmJ1bmRsZSA9ICh0aGlzLl9maXJlc3RvcmUsIHRoaXMucXVlcnkuX3F1ZXJ5LCBlLmJ1bmRsZU5hbWUsIFwiTk9UIFNVUFBPUlRFRFwiKSwgXG4gICAgICAgIGU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBxdWVyeVNuYXBzaG90RnJvbUpTT04oZSwgdCwgbikge1xuICAgIGlmIChfX1BSSVZBVEVfdmFsaWRhdGVKU09OKHQsIFF1ZXJ5U25hcHNob3QuX2pzb25TY2hlbWEpKSB7XG4gICAgICAgIGlmICh0LmJ1bmRsZSA9PT0gVG4pIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsIFwiVGhlIHByb3ZpZGVkIEpTT04gb2JqZWN0IHdhcyBjcmVhdGVkIGluIGEgY2xpZW50IGVudmlyb25tZW50LCB3aGljaCBpcyBub3Qgc3VwcG9ydGVkLlwiKTtcbiAgICAgICAgLy8gUGFyc2UgdGhlIGJ1bmRsZSBkYXRhLlxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfbmV3U2VyaWFsaXplcihlLl9kYXRhYmFzZUlkKSwgaSA9IF9fUFJJVkFURV9jcmVhdGVCdW5kbGVSZWFkZXJTeW5jKHQuYnVuZGxlLCByKSwgcyA9IGkuV3UoKSwgbyA9IG5ldyBfX1BSSVZBVEVfQnVuZGxlTG9hZGVyKGkuZ2V0TWV0YWRhdGEoKSwgcik7XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiBzKSBvLkdhKGUpO1xuICAgICAgICBpZiAoMSAhPT0gby5xdWVyaWVzLmxlbmd0aCkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgYFNuYXBzaG90IGRhdGEgZXhwZWN0ZWQgMSBxdWVyeSBidXQgZm91bmQgJHtvLnF1ZXJpZXMubGVuZ3RofSBxdWVyaWVzLmApO1xuICAgICAgICAvLyBDcmVhdGUgYW4gaW50ZXJuYWwgUXVlcnkgb2JqZWN0IGZyb20gdGhlIG5hbWVkIHF1ZXJ5IGluIHRoZSBidW5kbGUuXG4gICAgICAgICAgICAgICAgY29uc3QgXyA9IF9fUFJJVkFURV9mcm9tQnVuZGxlZFF1ZXJ5KG8ucXVlcmllc1swXS5idW5kbGVkUXVlcnkpLCBhID0gby5kb2N1bWVudHM7XG4gICAgICAgIC8vIENvbnN0cnVjdCB0aGUgYXJyYXlzIG9mIGRvY3VtZW50IGRhdGEgZm9yIHRoZSBxdWVyeS5cbiAgICAgICAgICAgICAgICBsZXQgdSA9IG5ldyBEb2N1bWVudFNldDtcbiAgICAgICAgYS5tYXAoKGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgdCA9IF9fUFJJVkFURV9mcm9tRG9jdW1lbnQociwgZS5kb2N1bWVudCk7XG4gICAgICAgICAgICB1ID0gdS5hZGQodCk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgLy8gQ3JlYXRlIGEgdmlldyBzbmFwc2hvdCBvZiB0aGUgcXVlcnkgYW5kIGRvY3VtZW50cy5cbiAgICAgICAgY29uc3QgYyA9IFZpZXdTbmFwc2hvdC5mcm9tSW5pdGlhbERvY3VtZW50cyhfLCB1LCBfX1BSSVZBVEVfZG9jdW1lbnRLZXlTZXQoKSAvKiBaZXJvIG11dGF0ZWQga2V5cyBzaWduaWZpZXMgbm8gcGVuZGluZyB3cml0ZXMuICovICwgXG4gICAgICAgIC8qIGZyb21DYWNoZT0gKi8gITEsIFxuICAgICAgICAvKiBoYXNDYWNoZWRSZXN1bHRzPSAqLyAhMSksIGwgPSBuZXcgUXVlcnkoZSwgbiB8fCBudWxsLCBfKTtcbiAgICAgICAgLy8gQ3JlYXRlIGFuIGV4dGVybmFsIFF1ZXJ5IG9iamVjdCwgcmVxdWlyZWQgdG8gY29uc3RydWN0IHRoZSBRdWVyeVNuYXBzaG90LlxuICAgICAgICAgICAgICAgIC8vIFJldHVybiBhIG5ldyBRdWVyeVNuYXBzaG90IHdpdGggYWxsIG9mIHRoZSBjb2xsZWN0ZWQgZGF0YS5cbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeVNuYXBzaG90KGUsIG5ldyBfX1BSSVZBVEVfTGl0ZVVzZXJEYXRhV3JpdGVyKGUpLCBsLCBjKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9yZXN1bHRDaGFuZ2VUeXBlKGUpIHtcbiAgICBzd2l0Y2ggKGUpIHtcbiAgICAgIGNhc2UgMCAvKiBDaGFuZ2VUeXBlLkFkZGVkICovIDpcbiAgICAgICAgcmV0dXJuIFwiYWRkZWRcIjtcblxuICAgICAgY2FzZSAyIC8qIENoYW5nZVR5cGUuTW9kaWZpZWQgKi8gOlxuICAgICAgY2FzZSAzIC8qIENoYW5nZVR5cGUuTWV0YWRhdGEgKi8gOlxuICAgICAgICByZXR1cm4gXCJtb2RpZmllZFwiO1xuXG4gICAgICBjYXNlIDEgLyogQ2hhbmdlVHlwZS5SZW1vdmVkICovIDpcbiAgICAgICAgcmV0dXJuIFwicmVtb3ZlZFwiO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gZmFpbCg2MTUwMSwge1xuICAgICAgICAgICAgdHlwZTogZVxuICAgICAgICB9KTtcbiAgICB9XG59XG5cbi8vIFRPRE8oZmlyZXN0b3JlZXhwKTogQWRkIHRlc3RzIGZvciBzbmFwc2hvdEVxdWFsIHdpdGggZGlmZmVyZW50IHNuYXBzaG90XG4vLyBtZXRhZGF0YVxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIHByb3ZpZGVkIHNuYXBzaG90cyBhcmUgZXF1YWwuXG4gKlxuICogQHBhcmFtIGxlZnQgLSBBIHNuYXBzaG90IHRvIGNvbXBhcmUuXG4gKiBAcGFyYW0gcmlnaHQgLSBBIHNuYXBzaG90IHRvIGNvbXBhcmUuXG4gKiBAcmV0dXJucyB0cnVlIGlmIHRoZSBzbmFwc2hvdHMgYXJlIGVxdWFsLlxuICovIGZ1bmN0aW9uIHNuYXBzaG90RXF1YWwoZSwgdCkge1xuICAgIHJldHVybiBlIGluc3RhbmNlb2YgRG9jdW1lbnRTbmFwc2hvdCAmJiB0IGluc3RhbmNlb2YgRG9jdW1lbnRTbmFwc2hvdCA/IGUuX2ZpcmVzdG9yZSA9PT0gdC5fZmlyZXN0b3JlICYmIGUuX2tleS5pc0VxdWFsKHQuX2tleSkgJiYgKG51bGwgPT09IGUuX2RvY3VtZW50ID8gbnVsbCA9PT0gdC5fZG9jdW1lbnQgOiBlLl9kb2N1bWVudC5pc0VxdWFsKHQuX2RvY3VtZW50KSkgJiYgZS5fY29udmVydGVyID09PSB0Ll9jb252ZXJ0ZXIgOiBlIGluc3RhbmNlb2YgUXVlcnlTbmFwc2hvdCAmJiB0IGluc3RhbmNlb2YgUXVlcnlTbmFwc2hvdCAmJiAoZS5fZmlyZXN0b3JlID09PSB0Ll9maXJlc3RvcmUgJiYgcXVlcnlFcXVhbChlLnF1ZXJ5LCB0LnF1ZXJ5KSAmJiBlLm1ldGFkYXRhLmlzRXF1YWwodC5tZXRhZGF0YSkgJiYgZS5fc25hcHNob3QuaXNFcXVhbCh0Ll9zbmFwc2hvdCkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZWFkcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhpcyBgRG9jdW1lbnRSZWZlcmVuY2VgLlxuICpcbiAqIE5vdGU6IGBnZXREb2MoKWAgYXR0ZW1wdHMgdG8gcHJvdmlkZSB1cC10by1kYXRlIGRhdGEgd2hlbiBwb3NzaWJsZSBieSB3YWl0aW5nXG4gKiBmb3IgZGF0YSBmcm9tIHRoZSBzZXJ2ZXIsIGJ1dCBpdCBtYXkgcmV0dXJuIGNhY2hlZCBkYXRhIG9yIGZhaWwgaWYgeW91IGFyZVxuICogb2ZmbGluZSBhbmQgdGhlIHNlcnZlciBjYW5ub3QgYmUgcmVhY2hlZC4gVG8gc3BlY2lmeSB0aGlzIGJlaGF2aW9yLCBpbnZva2VcbiAqIHtAbGluayBnZXREb2NGcm9tQ2FjaGV9IG9yIHtAbGluayBnZXREb2NGcm9tU2VydmVyfS5cbiAqXG4gKiBAcGFyYW0gcmVmZXJlbmNlIC0gVGhlIHJlZmVyZW5jZSBvZiB0aGUgZG9jdW1lbnQgdG8gZmV0Y2guXG4gKiBAcmV0dXJucyBBIFByb21pc2UgcmVzb2x2ZWQgd2l0aCBhIGBEb2N1bWVudFNuYXBzaG90YCBjb250YWluaW5nIHRoZVxuICogY3VycmVudCBkb2N1bWVudCBjb250ZW50cy5cbiAqLyBmdW5jdGlvbiBnZXREb2MoZSkge1xuICAgIGUgPSBfX1BSSVZBVEVfY2FzdChlLCBEb2N1bWVudFJlZmVyZW5jZSk7XG4gICAgY29uc3QgdCA9IF9fUFJJVkFURV9jYXN0KGUuZmlyZXN0b3JlLCBGaXJlc3RvcmUpO1xuICAgIHJldHVybiBfX1BSSVZBVEVfZmlyZXN0b3JlQ2xpZW50R2V0RG9jdW1lbnRWaWFTbmFwc2hvdExpc3RlbmVyKGVuc3VyZUZpcmVzdG9yZUNvbmZpZ3VyZWQodCksIGUuX2tleSkudGhlbigobiA9PiBfX1BSSVZBVEVfY29udmVydFRvRG9jU25hcHNob3QodCwgZSwgbikpKTtcbn1cblxuUXVlcnlTbmFwc2hvdC5fanNvblNjaGVtYVZlcnNpb24gPSBcImZpcmVzdG9yZS9xdWVyeVNuYXBzaG90LzEuMFwiLCBRdWVyeVNuYXBzaG90Ll9qc29uU2NoZW1hID0ge1xuICAgIHR5cGU6IHByb3BlcnR5KFwic3RyaW5nXCIsIFF1ZXJ5U25hcHNob3QuX2pzb25TY2hlbWFWZXJzaW9uKSxcbiAgICBidW5kbGVTb3VyY2U6IHByb3BlcnR5KFwic3RyaW5nXCIsIFwiUXVlcnlTbmFwc2hvdFwiKSxcbiAgICBidW5kbGVOYW1lOiBwcm9wZXJ0eShcInN0cmluZ1wiKSxcbiAgICBidW5kbGU6IHByb3BlcnR5KFwic3RyaW5nXCIpXG59O1xuXG5jbGFzcyBfX1BSSVZBVEVfRXhwVXNlckRhdGFXcml0ZXIgZXh0ZW5kcyBBYnN0cmFjdFVzZXJEYXRhV3JpdGVyIHtcbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuZmlyZXN0b3JlID0gZTtcbiAgICB9XG4gICAgY29udmVydEJ5dGVzKGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBCeXRlcyhlKTtcbiAgICB9XG4gICAgY29udmVydFJlZmVyZW5jZShlKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmNvbnZlcnREb2N1bWVudEtleShlLCB0aGlzLmZpcmVzdG9yZS5fZGF0YWJhc2VJZCk7XG4gICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnRSZWZlcmVuY2UodGhpcy5maXJlc3RvcmUsIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCwgdCk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJlYWRzIHRoZSBkb2N1bWVudCByZWZlcnJlZCB0byBieSB0aGlzIGBEb2N1bWVudFJlZmVyZW5jZWAgZnJvbSBjYWNoZS5cbiAqIFJldHVybnMgYW4gZXJyb3IgaWYgdGhlIGRvY3VtZW50IGlzIG5vdCBjdXJyZW50bHkgY2FjaGVkLlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHJlc29sdmVkIHdpdGggYSBgRG9jdW1lbnRTbmFwc2hvdGAgY29udGFpbmluZyB0aGVcbiAqIGN1cnJlbnQgZG9jdW1lbnQgY29udGVudHMuXG4gKi8gZnVuY3Rpb24gZ2V0RG9jRnJvbUNhY2hlKGUpIHtcbiAgICBlID0gX19QUklWQVRFX2Nhc3QoZSwgRG9jdW1lbnRSZWZlcmVuY2UpO1xuICAgIGNvbnN0IHQgPSBfX1BSSVZBVEVfY2FzdChlLmZpcmVzdG9yZSwgRmlyZXN0b3JlKSwgbiA9IGVuc3VyZUZpcmVzdG9yZUNvbmZpZ3VyZWQodCksIHIgPSBuZXcgX19QUklWQVRFX0V4cFVzZXJEYXRhV3JpdGVyKHQpO1xuICAgIHJldHVybiBfX1BSSVZBVEVfZmlyZXN0b3JlQ2xpZW50R2V0RG9jdW1lbnRGcm9tTG9jYWxDYWNoZShuLCBlLl9rZXkpLnRoZW4oKG4gPT4gbmV3IERvY3VtZW50U25hcHNob3QodCwgciwgZS5fa2V5LCBuLCBuZXcgU25hcHNob3RNZXRhZGF0YShudWxsICE9PSBuICYmIG4uaGFzTG9jYWxNdXRhdGlvbnMsIFxuICAgIC8qIGZyb21DYWNoZT0gKi8gITApLCBlLmNvbnZlcnRlcikpKTtcbn1cblxuLyoqXG4gKiBSZWFkcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhpcyBgRG9jdW1lbnRSZWZlcmVuY2VgIGZyb20gdGhlIHNlcnZlci5cbiAqIFJldHVybnMgYW4gZXJyb3IgaWYgdGhlIG5ldHdvcmsgaXMgbm90IGF2YWlsYWJsZS5cbiAqXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCByZXNvbHZlZCB3aXRoIGEgYERvY3VtZW50U25hcHNob3RgIGNvbnRhaW5pbmcgdGhlXG4gKiBjdXJyZW50IGRvY3VtZW50IGNvbnRlbnRzLlxuICovIGZ1bmN0aW9uIGdldERvY0Zyb21TZXJ2ZXIoZSkge1xuICAgIGUgPSBfX1BSSVZBVEVfY2FzdChlLCBEb2N1bWVudFJlZmVyZW5jZSk7XG4gICAgY29uc3QgdCA9IF9fUFJJVkFURV9jYXN0KGUuZmlyZXN0b3JlLCBGaXJlc3RvcmUpO1xuICAgIHJldHVybiBfX1BSSVZBVEVfZmlyZXN0b3JlQ2xpZW50R2V0RG9jdW1lbnRWaWFTbmFwc2hvdExpc3RlbmVyKGVuc3VyZUZpcmVzdG9yZUNvbmZpZ3VyZWQodCksIGUuX2tleSwge1xuICAgICAgICBzb3VyY2U6IFwic2VydmVyXCJcbiAgICB9KS50aGVuKChuID0+IF9fUFJJVkFURV9jb252ZXJ0VG9Eb2NTbmFwc2hvdCh0LCBlLCBuKSkpO1xufVxuXG4vKipcbiAqIEV4ZWN1dGVzIHRoZSBxdWVyeSBhbmQgcmV0dXJucyB0aGUgcmVzdWx0cyBhcyBhIGBRdWVyeVNuYXBzaG90YC5cbiAqXG4gKiBOb3RlOiBgZ2V0RG9jcygpYCBhdHRlbXB0cyB0byBwcm92aWRlIHVwLXRvLWRhdGUgZGF0YSB3aGVuIHBvc3NpYmxlIGJ5XG4gKiB3YWl0aW5nIGZvciBkYXRhIGZyb20gdGhlIHNlcnZlciwgYnV0IGl0IG1heSByZXR1cm4gY2FjaGVkIGRhdGEgb3IgZmFpbCBpZlxuICogeW91IGFyZSBvZmZsaW5lIGFuZCB0aGUgc2VydmVyIGNhbm5vdCBiZSByZWFjaGVkLiBUbyBzcGVjaWZ5IHRoaXMgYmVoYXZpb3IsXG4gKiBpbnZva2Uge0BsaW5rIGdldERvY3NGcm9tQ2FjaGV9IG9yIHtAbGluayBnZXREb2NzRnJvbVNlcnZlcn0uXG4gKlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCB3aWxsIGJlIHJlc29sdmVkIHdpdGggdGhlIHJlc3VsdHMgb2YgdGhlIHF1ZXJ5LlxuICovIGZ1bmN0aW9uIGdldERvY3MoZSkge1xuICAgIGUgPSBfX1BSSVZBVEVfY2FzdChlLCBRdWVyeSk7XG4gICAgY29uc3QgdCA9IF9fUFJJVkFURV9jYXN0KGUuZmlyZXN0b3JlLCBGaXJlc3RvcmUpLCBuID0gZW5zdXJlRmlyZXN0b3JlQ29uZmlndXJlZCh0KSwgciA9IG5ldyBfX1BSSVZBVEVfRXhwVXNlckRhdGFXcml0ZXIodCk7XG4gICAgcmV0dXJuIF9fUFJJVkFURV92YWxpZGF0ZUhhc0V4cGxpY2l0T3JkZXJCeUZvckxpbWl0VG9MYXN0KGUuX3F1ZXJ5KSwgX19QUklWQVRFX2ZpcmVzdG9yZUNsaWVudEdldERvY3VtZW50c1ZpYVNuYXBzaG90TGlzdGVuZXIobiwgZS5fcXVlcnkpLnRoZW4oKG4gPT4gbmV3IFF1ZXJ5U25hcHNob3QodCwgciwgZSwgbikpKTtcbn1cblxuLyoqXG4gKiBFeGVjdXRlcyB0aGUgcXVlcnkgYW5kIHJldHVybnMgdGhlIHJlc3VsdHMgYXMgYSBgUXVlcnlTbmFwc2hvdGAgZnJvbSBjYWNoZS5cbiAqIFJldHVybnMgYW4gZW1wdHkgcmVzdWx0IHNldCBpZiBubyBkb2N1bWVudHMgbWF0Y2hpbmcgdGhlIHF1ZXJ5IGFyZSBjdXJyZW50bHlcbiAqIGNhY2hlZC5cbiAqXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgd2l0aCB0aGUgcmVzdWx0cyBvZiB0aGUgcXVlcnkuXG4gKi8gZnVuY3Rpb24gZ2V0RG9jc0Zyb21DYWNoZShlKSB7XG4gICAgZSA9IF9fUFJJVkFURV9jYXN0KGUsIFF1ZXJ5KTtcbiAgICBjb25zdCB0ID0gX19QUklWQVRFX2Nhc3QoZS5maXJlc3RvcmUsIEZpcmVzdG9yZSksIG4gPSBlbnN1cmVGaXJlc3RvcmVDb25maWd1cmVkKHQpLCByID0gbmV3IF9fUFJJVkFURV9FeHBVc2VyRGF0YVdyaXRlcih0KTtcbiAgICByZXR1cm4gX19QUklWQVRFX2ZpcmVzdG9yZUNsaWVudEdldERvY3VtZW50c0Zyb21Mb2NhbENhY2hlKG4sIGUuX3F1ZXJ5KS50aGVuKChuID0+IG5ldyBRdWVyeVNuYXBzaG90KHQsIHIsIGUsIG4pKSk7XG59XG5cbi8qKlxuICogRXhlY3V0ZXMgdGhlIHF1ZXJ5IGFuZCByZXR1cm5zIHRoZSByZXN1bHRzIGFzIGEgYFF1ZXJ5U25hcHNob3RgIGZyb20gdGhlXG4gKiBzZXJ2ZXIuIFJldHVybnMgYW4gZXJyb3IgaWYgdGhlIG5ldHdvcmsgaXMgbm90IGF2YWlsYWJsZS5cbiAqXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgd2l0aCB0aGUgcmVzdWx0cyBvZiB0aGUgcXVlcnkuXG4gKi8gZnVuY3Rpb24gZ2V0RG9jc0Zyb21TZXJ2ZXIoZSkge1xuICAgIGUgPSBfX1BSSVZBVEVfY2FzdChlLCBRdWVyeSk7XG4gICAgY29uc3QgdCA9IF9fUFJJVkFURV9jYXN0KGUuZmlyZXN0b3JlLCBGaXJlc3RvcmUpLCBuID0gZW5zdXJlRmlyZXN0b3JlQ29uZmlndXJlZCh0KSwgciA9IG5ldyBfX1BSSVZBVEVfRXhwVXNlckRhdGFXcml0ZXIodCk7XG4gICAgcmV0dXJuIF9fUFJJVkFURV9maXJlc3RvcmVDbGllbnRHZXREb2N1bWVudHNWaWFTbmFwc2hvdExpc3RlbmVyKG4sIGUuX3F1ZXJ5LCB7XG4gICAgICAgIHNvdXJjZTogXCJzZXJ2ZXJcIlxuICAgIH0pLnRoZW4oKG4gPT4gbmV3IFF1ZXJ5U25hcHNob3QodCwgciwgZSwgbikpKTtcbn1cblxuZnVuY3Rpb24gc2V0RG9jKGUsIHQsIG4pIHtcbiAgICBlID0gX19QUklWQVRFX2Nhc3QoZSwgRG9jdW1lbnRSZWZlcmVuY2UpO1xuICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfY2FzdChlLmZpcmVzdG9yZSwgRmlyZXN0b3JlKSwgaSA9IF9fUFJJVkFURV9hcHBseUZpcmVzdG9yZURhdGFDb252ZXJ0ZXIoZS5jb252ZXJ0ZXIsIHQsIG4pO1xuICAgIHJldHVybiBleGVjdXRlV3JpdGUociwgWyBfX1BSSVZBVEVfcGFyc2VTZXREYXRhKF9fUFJJVkFURV9uZXdVc2VyRGF0YVJlYWRlcihyKSwgXCJzZXREb2NcIiwgZS5fa2V5LCBpLCBudWxsICE9PSBlLmNvbnZlcnRlciwgbikudG9NdXRhdGlvbihlLl9rZXksIFByZWNvbmRpdGlvbi5ub25lKCkpIF0pO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVEb2MoZSwgdCwgbiwgLi4ucikge1xuICAgIGUgPSBfX1BSSVZBVEVfY2FzdChlLCBEb2N1bWVudFJlZmVyZW5jZSk7XG4gICAgY29uc3QgaSA9IF9fUFJJVkFURV9jYXN0KGUuZmlyZXN0b3JlLCBGaXJlc3RvcmUpLCBzID0gX19QUklWQVRFX25ld1VzZXJEYXRhUmVhZGVyKGkpO1xuICAgIGxldCBvO1xuICAgIG8gPSBcInN0cmluZ1wiID09IHR5cGVvZiAoXG4gICAgLy8gRm9yIENvbXBhdCB0eXBlcywgd2UgaGF2ZSB0byBcImV4dHJhY3RcIiB0aGUgdW5kZXJseWluZyB0eXBlcyBiZWZvcmVcbiAgICAvLyBwZXJmb3JtaW5nIHZhbGlkYXRpb24uXG4gICAgdCA9IGdldE1vZHVsYXJJbnN0YW5jZSh0KSkgfHwgdCBpbnN0YW5jZW9mIEZpZWxkUGF0aCA/IF9fUFJJVkFURV9wYXJzZVVwZGF0ZVZhcmFyZ3MocywgXCJ1cGRhdGVEb2NcIiwgZS5fa2V5LCB0LCBuLCByKSA6IF9fUFJJVkFURV9wYXJzZVVwZGF0ZURhdGEocywgXCJ1cGRhdGVEb2NcIiwgZS5fa2V5LCB0KTtcbiAgICByZXR1cm4gZXhlY3V0ZVdyaXRlKGksIFsgby50b011dGF0aW9uKGUuX2tleSwgUHJlY29uZGl0aW9uLmV4aXN0cyghMCkpIF0pO1xufVxuXG4vKipcbiAqIERlbGV0ZXMgdGhlIGRvY3VtZW50IHJlZmVycmVkIHRvIGJ5IHRoZSBzcGVjaWZpZWQgYERvY3VtZW50UmVmZXJlbmNlYC5cbiAqXG4gKiBAcGFyYW0gcmVmZXJlbmNlIC0gQSByZWZlcmVuY2UgdG8gdGhlIGRvY3VtZW50IHRvIGRlbGV0ZS5cbiAqIEByZXR1cm5zIEEgUHJvbWlzZSByZXNvbHZlZCBvbmNlIHRoZSBkb2N1bWVudCBoYXMgYmVlbiBzdWNjZXNzZnVsbHlcbiAqIGRlbGV0ZWQgZnJvbSB0aGUgYmFja2VuZCAobm90ZSB0aGF0IGl0IHdvbid0IHJlc29sdmUgd2hpbGUgeW91J3JlIG9mZmxpbmUpLlxuICovIGZ1bmN0aW9uIGRlbGV0ZURvYyhlKSB7XG4gICAgcmV0dXJuIGV4ZWN1dGVXcml0ZShfX1BSSVZBVEVfY2FzdChlLmZpcmVzdG9yZSwgRmlyZXN0b3JlKSwgWyBuZXcgX19QUklWQVRFX0RlbGV0ZU11dGF0aW9uKGUuX2tleSwgUHJlY29uZGl0aW9uLm5vbmUoKSkgXSk7XG59XG5cbi8qKlxuICogQWRkIGEgbmV3IGRvY3VtZW50IHRvIHNwZWNpZmllZCBgQ29sbGVjdGlvblJlZmVyZW5jZWAgd2l0aCB0aGUgZ2l2ZW4gZGF0YSxcbiAqIGFzc2lnbmluZyBpdCBhIGRvY3VtZW50IElEIGF1dG9tYXRpY2FsbHkuXG4gKlxuICogQHBhcmFtIHJlZmVyZW5jZSAtIEEgcmVmZXJlbmNlIHRvIHRoZSBjb2xsZWN0aW9uIHRvIGFkZCB0aGlzIGRvY3VtZW50IHRvLlxuICogQHBhcmFtIGRhdGEgLSBBbiBPYmplY3QgY29udGFpbmluZyB0aGUgZGF0YSBmb3IgdGhlIG5ldyBkb2N1bWVudC5cbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHJlc29sdmVkIHdpdGggYSBgRG9jdW1lbnRSZWZlcmVuY2VgIHBvaW50aW5nIHRvIHRoZVxuICogbmV3bHkgY3JlYXRlZCBkb2N1bWVudCBhZnRlciBpdCBoYXMgYmVlbiB3cml0dGVuIHRvIHRoZSBiYWNrZW5kIChOb3RlIHRoYXQgaXRcbiAqIHdvbid0IHJlc29sdmUgd2hpbGUgeW91J3JlIG9mZmxpbmUpLlxuICovIGZ1bmN0aW9uIGFkZERvYyhlLCB0KSB7XG4gICAgY29uc3QgbiA9IF9fUFJJVkFURV9jYXN0KGUuZmlyZXN0b3JlLCBGaXJlc3RvcmUpLCByID0gZG9jKGUpLCBpID0gX19QUklWQVRFX2FwcGx5RmlyZXN0b3JlRGF0YUNvbnZlcnRlcihlLmNvbnZlcnRlciwgdCk7XG4gICAgcmV0dXJuIGV4ZWN1dGVXcml0ZShuLCBbIF9fUFJJVkFURV9wYXJzZVNldERhdGEoX19QUklWQVRFX25ld1VzZXJEYXRhUmVhZGVyKGUuZmlyZXN0b3JlKSwgXCJhZGREb2NcIiwgci5fa2V5LCBpLCBudWxsICE9PSBlLmNvbnZlcnRlciwge30pLnRvTXV0YXRpb24oci5fa2V5LCBQcmVjb25kaXRpb24uZXhpc3RzKCExKSkgXSkudGhlbigoKCkgPT4gcikpO1xufVxuXG5mdW5jdGlvbiBvblNuYXBzaG90KGUsIC4uLnQpIHtcbiAgICAvLyBvblNuYXBzaG90IGZvciBRdWVyeSBvciBEb2N1bWVudC5cbiAgICBlID0gZ2V0TW9kdWxhckluc3RhbmNlKGUpO1xuICAgIGxldCBuID0ge1xuICAgICAgICBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzOiAhMSxcbiAgICAgICAgc291cmNlOiBcImRlZmF1bHRcIlxuICAgIH0sIHIgPSAwO1xuICAgIFwib2JqZWN0XCIgIT0gdHlwZW9mIHRbcl0gfHwgX19QUklWQVRFX2lzUGFydGlhbE9ic2VydmVyKHRbcl0pIHx8IChuID0gdFtyKytdKTtcbiAgICBjb25zdCBpID0ge1xuICAgICAgICBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzOiBuLmluY2x1ZGVNZXRhZGF0YUNoYW5nZXMsXG4gICAgICAgIHNvdXJjZTogbi5zb3VyY2VcbiAgICB9O1xuICAgIGlmIChfX1BSSVZBVEVfaXNQYXJ0aWFsT2JzZXJ2ZXIodFtyXSkpIHtcbiAgICAgICAgY29uc3QgZSA9IHRbcl07XG4gICAgICAgIHRbcl0gPSBlLm5leHQ/LmJpbmQoZSksIHRbciArIDFdID0gZS5lcnJvcj8uYmluZChlKSwgdFtyICsgMl0gPSBlLmNvbXBsZXRlPy5iaW5kKGUpO1xuICAgIH1cbiAgICBsZXQgcywgbywgXztcbiAgICBpZiAoZSBpbnN0YW5jZW9mIERvY3VtZW50UmVmZXJlbmNlKSBvID0gX19QUklWQVRFX2Nhc3QoZS5maXJlc3RvcmUsIEZpcmVzdG9yZSksIFxuICAgIF8gPSBfX1BSSVZBVEVfbmV3UXVlcnlGb3JQYXRoKGUuX2tleS5wYXRoKSwgcyA9IHtcbiAgICAgICAgbmV4dDogbiA9PiB7XG4gICAgICAgICAgICB0W3JdICYmIHRbcl0oX19QUklWQVRFX2NvbnZlcnRUb0RvY1NuYXBzaG90KG8sIGUsIG4pKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IHRbciArIDFdLFxuICAgICAgICBjb21wbGV0ZTogdFtyICsgMl1cbiAgICB9OyBlbHNlIHtcbiAgICAgICAgY29uc3QgbiA9IF9fUFJJVkFURV9jYXN0KGUsIFF1ZXJ5KTtcbiAgICAgICAgbyA9IF9fUFJJVkFURV9jYXN0KG4uZmlyZXN0b3JlLCBGaXJlc3RvcmUpLCBfID0gbi5fcXVlcnk7XG4gICAgICAgIGNvbnN0IGkgPSBuZXcgX19QUklWQVRFX0V4cFVzZXJEYXRhV3JpdGVyKG8pO1xuICAgICAgICBzID0ge1xuICAgICAgICAgICAgbmV4dDogZSA9PiB7XG4gICAgICAgICAgICAgICAgdFtyXSAmJiB0W3JdKG5ldyBRdWVyeVNuYXBzaG90KG8sIGksIG4sIGUpKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogdFtyICsgMV0sXG4gICAgICAgICAgICBjb21wbGV0ZTogdFtyICsgMl1cbiAgICAgICAgfSwgX19QUklWQVRFX3ZhbGlkYXRlSGFzRXhwbGljaXRPcmRlckJ5Rm9yTGltaXRUb0xhc3QoZS5fcXVlcnkpO1xuICAgIH1cbiAgICByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX2ZpcmVzdG9yZUNsaWVudExpc3RlbihlLCB0LCBuLCByKSB7XG4gICAgICAgIGNvbnN0IGkgPSBuZXcgX19QUklWQVRFX0FzeW5jT2JzZXJ2ZXIociksIHMgPSBuZXcgX19QUklWQVRFX1F1ZXJ5TGlzdGVuZXIodCwgaSwgbik7XG4gICAgICAgIHJldHVybiBlLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4gX19QUklWQVRFX2V2ZW50TWFuYWdlckxpc3Rlbihhd2FpdCBfX1BSSVZBVEVfZ2V0RXZlbnRNYW5hZ2VyKGUpLCBzKSkpLCBcbiAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgaS5OdSgpLCBlLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4gX19QUklWQVRFX2V2ZW50TWFuYWdlclVubGlzdGVuKGF3YWl0IF9fUFJJVkFURV9nZXRFdmVudE1hbmFnZXIoZSksIHMpKSk7XG4gICAgICAgIH07XG4gICAgfShlbnN1cmVGaXJlc3RvcmVDb25maWd1cmVkKG8pLCBfLCBpLCBzKTtcbn1cblxuZnVuY3Rpb24gb25TbmFwc2hvdFJlc3VtZShlLCB0LCAuLi5uKSB7XG4gICAgY29uc3QgciA9IGdldE1vZHVsYXJJbnN0YW5jZShlKSwgaSA9IFxuICAgIC8qKlxuICogRW5zdXJlcyB0aGUgZGF0YSByZXF1aXJlZCB0byBjb25zdHJ1Y3QgYW4ge0BsaW5rIG9uU25hcHNob3R9IGxpc3RlbmVyIGV4aXN0IGluIGEgYHNuYXBzaG90SnNvbmBcbiAqIG9iamVjdCB0aGF0IG9yaWdpbmF0ZXMgZnJvbSB7QGxpbmsgRG9jdW1lbnRTbmFwc2hvdC50b0pTT059IG9yIHtAbGluayBRdWVyeXNuYXBzaG90LnRvSlNPTn0uIFRoZVxuICogZGF0YSBpcyBub3JtYWxpemVkIGludG8gYSB0eXBlZCBvYmplY3QuXG4gKlxuICogQHBhcmFtIHNuYXBzaG90SnNvbiAtIFRoZSBKU09OIG9iamVjdCB0aGF0IHRoZSBhcHAgcHJvdmlkZWQgdG8ge0BsaW5rIG9uU25hcHNob3R9LlxuICogQHJldHVybnMgQSBub3JtYWxpemVkIG9iamVjdCB0aGF0IGNvbnRhaW5zIGFsbCBvZiB0aGUgcmVxdWlyZWQgYnVuZGxlIEpTT04gZmllbGRzLiBJZlxuICoge0BsaW5rIHNuYXBzaG90SnNvbn0gZG9lc24ndCBjb250YWluIHRoZSByZXF1aXJlZCBmaWVsZHMsIG9yIGlmIHRoZSBmaWVsZHMgZXhpc3QgYXMgZW1wdHlcbiAqIHN0cmluZ3MsIHRoZW4gdGhlIHtAbGluayBzbmFwc2hvdEpzb24uZXJyb3J9IGZpZWxkIHdpbGwgYmUgYSBub24gZW1wdHkgc3RyaW5nLlxuICpcbiAqIEBpbnRlcm5hbFxuICovXG4gICAgZnVuY3Rpb24gX19QUklWQVRFX25vcm1hbGl6ZVNuYXBzaG90SnNvbkZpZWxkcyhlKSB7XG4gICAgICAgIGNvbnN0IHQgPSB7XG4gICAgICAgICAgICBidW5kbGU6IFwiXCIsXG4gICAgICAgICAgICBidW5kbGVOYW1lOiBcIlwiLFxuICAgICAgICAgICAgYnVuZGxlU291cmNlOiBcIlwiXG4gICAgICAgIH0sIG4gPSBbIFwiYnVuZGxlXCIsIFwiYnVuZGxlTmFtZVwiLCBcImJ1bmRsZVNvdXJjZVwiIF07XG4gICAgICAgIGZvciAoY29uc3QgciBvZiBuKSB7XG4gICAgICAgICAgICBpZiAoIShyIGluIGUpKSB7XG4gICAgICAgICAgICAgICAgdC5lcnJvciA9IGBzbmFwc2hvdEpzb24gbWlzc2luZyByZXF1aXJlZCBmaWVsZDogJHtyfWA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IGVbcl07XG4gICAgICAgICAgICBpZiAoXCJzdHJpbmdcIiAhPSB0eXBlb2Ygbikge1xuICAgICAgICAgICAgICAgIHQuZXJyb3IgPSBgc25hcHNob3RKc29uIGZpZWxkICcke3J9JyBtdXN0IGJlIGEgc3RyaW5nLmA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoMCA9PT0gbi5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0LmVycm9yID0gYHNuYXBzaG90SnNvbiBmaWVsZCAnJHtyfScgY2Fubm90IGJlIGFuIGVtcHR5IHN0cmluZy5gO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXCJidW5kbGVcIiA9PT0gciA/IHQuYnVuZGxlID0gbiA6IFwiYnVuZGxlTmFtZVwiID09PSByID8gdC5idW5kbGVOYW1lID0gbiA6IFwiYnVuZGxlU291cmNlXCIgPT09IHIgJiYgKHQuYnVuZGxlU291cmNlID0gbik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgfVxuICAgIC8qKlxuICogTG9hZHMgdGhlIGJ1bmRsZSBpbiBhIHNlcGFyYXRlIHRhc2sgYW5kIHRoZW4gaW52b2tlcyB7QGxpbmsgb25TbmFwc2hvdH0gd2l0aCBhXG4gKiB7QGxpbmsgRG9jdW1lbnRSZWZlcmVuY2V9IGZvciB0aGUgZG9jdW1lbnQgaW4gdGhlIGJ1bmRsZS5cbiAqXG4gKiBAcGFyYW0gZmlyZXN0b3JlIC0gVGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIGZvciB0aGUge0BsaW5rIG9uU25hcHNob3R9IG9wZXJhdGlvbiByZXF1ZXN0LlxuICogQHBhcmFtIGpzb24gLSBUaGUgSlNPTiBidW5kbGUgdG8gbG9hZCwgcHJvZHVjZWQgYnkge0BsaW5rIERvY3VtZW50U25hcHNob3QudG9KU09OfS5cbiAqIEBwYXJhbSBvcHRpb25zIC0gT3B0aW9ucyBjb250cm9sbGluZyB0aGUgbGlzdGVuIGJlaGF2aW9yLlxuICogQHBhcmFtIG9ic2VydmVyIC0gQSBzaW5nbGUgb2JqZWN0IGNvbnRhaW5pbmcgYG5leHRgIGFuZCBgZXJyb3JgIGNhbGxiYWNrcy5cbiAqIEBwYXJhbSBjb252ZXJ0ZXIgLSBBbiBvcHRpb25hbCBvYmplY3QgdGhhdCBjb252ZXJ0cyBvYmplY3RzIGZyb20gRmlyZXN0b3JlIGJlZm9yZSB0aGUgb25OZXh0XG4gKiBsaXN0ZW5lciBpcyBpbnZva2VkLlxuICogQHJldHVybnMgQW4gdW5zdWJzY3JpYmUgZnVuY3Rpb24gdGhhdCBjYW4gYmUgY2FsbGVkIHRvIGNhbmNlbCB0aGUgc25hcHNob3RcbiAqIGxpc3RlbmVyLlxuICpcbiAqIEBpbnRlcm5hbFxuICovICh0KTtcbiAgICBpZiAoaS5lcnJvcikgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgaS5lcnJvcik7XG4gICAgbGV0IHMsIG8gPSAwO1xuICAgIGlmIChcIm9iamVjdFwiICE9IHR5cGVvZiBuW29dIHx8IF9fUFJJVkFURV9pc1BhcnRpYWxPYnNlcnZlcihuW29dKSB8fCAocyA9IG5bbysrXSksIFxuICAgIFwiUXVlcnlTbmFwc2hvdFwiID09PSBpLmJ1bmRsZVNvdXJjZSkge1xuICAgICAgICBsZXQgZSA9IG51bGw7XG4gICAgICAgIGlmIChcIm9iamVjdFwiID09IHR5cGVvZiBuW29dICYmIF9fUFJJVkFURV9pc1BhcnRpYWxPYnNlcnZlcihuW29dKSkge1xuICAgICAgICAgICAgY29uc3QgdCA9IG5bbysrXTtcbiAgICAgICAgICAgIGUgPSB7XG4gICAgICAgICAgICAgICAgbmV4dDogdC5uZXh0LFxuICAgICAgICAgICAgICAgIGVycm9yOiB0LmVycm9yLFxuICAgICAgICAgICAgICAgIGNvbXBsZXRlOiB0LmNvbXBsZXRlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2UgZSA9IHtcbiAgICAgICAgICAgIG5leHQ6IG5bbysrXSxcbiAgICAgICAgICAgIGVycm9yOiBuW28rK10sXG4gICAgICAgICAgICBjb21wbGV0ZTogbltvKytdXG4gICAgICAgIH07XG4gICAgICAgIC8qKlxuICogTG9hZHMgdGhlIGJ1bmRsZSBpbiBhIHNlcGFyYXRlIHRhc2sgYW5kIHRoZW4gaW52b2tlcyB7QGxpbmsgb25TbmFwc2hvdH0gd2l0aCBhXG4gKiB7QGxpbmsgUXVlcnl9IHRoYXQgcmVwcmVzZW50cyB0aGUgUXVlcnkgaW4gdGhlIGJ1bmRsZS5cbiAqXG4gKiBAcGFyYW0gZmlyZXN0b3JlIC0gVGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIGZvciB0aGUge0BsaW5rIG9uU25hcHNob3R9IG9wZXJhdGlvbiByZXF1ZXN0LlxuICogQHBhcmFtIGpzb24gLSBUaGUgSlNPTiBidW5kbGUgdG8gbG9hZCwgcHJvZHVjZWQgYnkge0BsaW5rIFF1ZXJ5U25hcHNob3QudG9KU09OfS5cbiAqIEBwYXJhbSBvcHRpb25zIC0gT3B0aW9ucyBjb250cm9sbGluZyB0aGUgbGlzdGVuIGJlaGF2aW9yLlxuICogQHBhcmFtIG9ic2VydmVyIC0gQSBzaW5nbGUgb2JqZWN0IGNvbnRhaW5pbmcgYG5leHRgIGFuZCBgZXJyb3JgIGNhbGxiYWNrcy5cbiAqIEBwYXJhbSBjb252ZXJ0ZXIgLSBBbiBvcHRpb25hbCBvYmplY3QgdGhhdCBjb252ZXJ0cyBvYmplY3RzIGZyb20gRmlyZXN0b3JlIGJlZm9yZSB0aGUgb25OZXh0XG4gKiBsaXN0ZW5lciBpcyBpbnZva2VkLlxuICogQHJldHVybnMgQW4gdW5zdWJzY3JpYmUgZnVuY3Rpb24gdGhhdCBjYW4gYmUgY2FsbGVkIHRvIGNhbmNlbCB0aGUgc25hcHNob3RcbiAqIGxpc3RlbmVyLlxuICpcbiAqIEBpbnRlcm5hbFxuICovXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBfX1BSSVZBVEVfb25TbmFwc2hvdFF1ZXJ5U25hcHNob3RCdW5kbGUoZSwgdCwgbiwgciwgaSkge1xuICAgICAgICAgICAgbGV0IHMsIG8gPSAhMTtcbiAgICAgICAgICAgIGNvbnN0IF8gPSBsb2FkQnVuZGxlKGUsIHQuYnVuZGxlKTtcbiAgICAgICAgICAgIHJldHVybiBfLnRoZW4oKCgpID0+IG5hbWVkUXVlcnkoZSwgdC5idW5kbGVOYW1lKSkpLnRoZW4oKGUgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChlICYmICFvKSB7XG4gICAgICAgICAgICAgICAgICAgIGkgJiYgZS53aXRoQ29udmVydGVyKGkpLCBzID0gb25TbmFwc2hvdChlLCBuIHx8IHt9LCByKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSkuY2F0Y2goKGUgPT4gKHIuZXJyb3IgJiYgci5lcnJvcihlKSwgKCkgPT4ge30pKSksICgpID0+IHtcbiAgICAgICAgICAgICAgICBvIHx8IChvID0gITAsIHMgJiYgcygpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbiAgICAgICAgLyoqXG4gKiBDYWxjdWxhdGVzIHRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIGluIHRoZSByZXN1bHQgc2V0IG9mIHRoZSBnaXZlbiBxdWVyeVxuICogd2l0aG91dCBhY3R1YWxseSBkb3dubG9hZGluZyB0aGUgZG9jdW1lbnRzLlxuICpcbiAqIFVzaW5nIHRoaXMgZnVuY3Rpb24gdG8gY291bnQgdGhlIGRvY3VtZW50cyBpcyBlZmZpY2llbnQgYmVjYXVzZSBvbmx5IHRoZVxuICogZmluYWwgY291bnQsIG5vdCB0aGUgZG9jdW1lbnRzJyBkYXRhLCBpcyBkb3dubG9hZGVkLiBUaGlzIGZ1bmN0aW9uIGNhblxuICogY291bnQgdGhlIGRvY3VtZW50cyBpbiBjYXNlcyB3aGVyZSB0aGUgcmVzdWx0IHNldCBpcyBwcm9oaWJpdGl2ZWx5IGxhcmdlIHRvXG4gKiBkb3dubG9hZCBlbnRpcmVseSAodGhvdXNhbmRzIG9mIGRvY3VtZW50cykuXG4gKlxuICogVGhlIHJlc3VsdCByZWNlaXZlZCBmcm9tIHRoZSBzZXJ2ZXIgaXMgcHJlc2VudGVkLCB1bmFsdGVyZWQsIHdpdGhvdXRcbiAqIGNvbnNpZGVyaW5nIGFueSBsb2NhbCBzdGF0ZS4gVGhhdCBpcywgZG9jdW1lbnRzIGluIHRoZSBsb2NhbCBjYWNoZSBhcmUgbm90XG4gKiB0YWtlbiBpbnRvIGNvbnNpZGVyYXRpb24sIG5laXRoZXIgYXJlIGxvY2FsIG1vZGlmaWNhdGlvbnMgbm90IHlldFxuICogc3luY2hyb25pemVkIHdpdGggdGhlIHNlcnZlci4gUHJldmlvdXNseS1kb3dubG9hZGVkIHJlc3VsdHMsIGlmIGFueSwgYXJlIG5vdFxuICogdXNlZC4gRXZlcnkgaW52b2NhdGlvbiBvZiB0aGlzIGZ1bmN0aW9uIG5lY2Vzc2FyaWx5IGludm9sdmVzIGEgcm91bmQgdHJpcCB0b1xuICogdGhlIHNlcnZlci5cbiAqXG4gKiBAcGFyYW0gcXVlcnkgVGhlIHF1ZXJ5IHdob3NlIHJlc3VsdCBzZXQgc2l6ZSBpcyBjYWxjdWxhdGVkLlxuICogQHJldHVybnMgQSBQcm9taXNlIHRoYXQgd2lsbCBiZSByZXNvbHZlZCB3aXRoIHRoZSBjb3VudDsgdGhlIGNvdW50IGNhbiBiZVxuICogcmV0cmlldmVkIGZyb20gYHNuYXBzaG90LmRhdGEoKS5jb3VudGAsIHdoZXJlIGBzbmFwc2hvdGAgaXMgdGhlXG4gKiBgQWdncmVnYXRlUXVlcnlTbmFwc2hvdGAgdG8gd2hpY2ggdGhlIHJldHVybmVkIFByb21pc2UgcmVzb2x2ZXMuXG4gKi8gKHIsIGksIHMsIGUsIG5bb10pO1xuICAgIH1cbiAgICBpZiAoXCJEb2N1bWVudFNuYXBzaG90XCIgPT09IGkuYnVuZGxlU291cmNlKSB7XG4gICAgICAgIGxldCBlID0gbnVsbDtcbiAgICAgICAgaWYgKFwib2JqZWN0XCIgPT0gdHlwZW9mIG5bb10gJiYgX19QUklWQVRFX2lzUGFydGlhbE9ic2VydmVyKG5bb10pKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gbltvKytdO1xuICAgICAgICAgICAgZSA9IHtcbiAgICAgICAgICAgICAgICBuZXh0OiB0Lm5leHQsXG4gICAgICAgICAgICAgICAgZXJyb3I6IHQuZXJyb3IsXG4gICAgICAgICAgICAgICAgY29tcGxldGU6IHQuY29tcGxldGVcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSBlID0ge1xuICAgICAgICAgICAgbmV4dDogbltvKytdLFxuICAgICAgICAgICAgZXJyb3I6IG5bbysrXSxcbiAgICAgICAgICAgIGNvbXBsZXRlOiBuW28rK11cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIF9fUFJJVkFURV9vblNuYXBzaG90RG9jdW1lbnRTbmFwc2hvdEJ1bmRsZShlLCB0LCBuLCByLCBpKSB7XG4gICAgICAgICAgICBsZXQgcywgbyA9ICExO1xuICAgICAgICAgICAgY29uc3QgXyA9IGxvYWRCdW5kbGUoZSwgdC5idW5kbGUpO1xuICAgICAgICAgICAgcmV0dXJuIF8udGhlbigoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghbykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gbmV3IERvY3VtZW50UmVmZXJlbmNlKGUsIGkgfHwgbnVsbCwgRG9jdW1lbnRLZXkuZnJvbVBhdGgodC5idW5kbGVOYW1lKSk7XG4gICAgICAgICAgICAgICAgICAgIHMgPSBvblNuYXBzaG90KG8sIG4gfHwge30sIHIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKS5jYXRjaCgoZSA9PiAoci5lcnJvciAmJiByLmVycm9yKGUpLCAoKSA9PiB7fSkpKSwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIG8gfHwgKG8gPSAhMCwgcyAmJiBzKCkpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfShyLCBpLCBzLCBlLCBuW29dKTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgYHVuc3VwcG9ydGVkIGJ1bmRsZSBzb3VyY2U6ICR7aS5idW5kbGVTb3VyY2V9YCk7XG59XG5cbmZ1bmN0aW9uIG9uU25hcHNob3RzSW5TeW5jKGUsIHQpIHtcbiAgICByZXR1cm4gX19QUklWQVRFX2ZpcmVzdG9yZUNsaWVudEFkZFNuYXBzaG90c0luU3luY0xpc3RlbmVyKGVuc3VyZUZpcmVzdG9yZUNvbmZpZ3VyZWQoZSA9IF9fUFJJVkFURV9jYXN0KGUsIEZpcmVzdG9yZSkpLCBfX1BSSVZBVEVfaXNQYXJ0aWFsT2JzZXJ2ZXIodCkgPyB0IDoge1xuICAgICAgICBuZXh0OiB0XG4gICAgfSk7XG59XG5cbi8qKlxuICogTG9jYWxseSB3cml0ZXMgYG11dGF0aW9uc2Agb24gdGhlIGFzeW5jIHF1ZXVlLlxuICogQGludGVybmFsXG4gKi8gZnVuY3Rpb24gZXhlY3V0ZVdyaXRlKGUsIHQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX2ZpcmVzdG9yZUNsaWVudFdyaXRlKGUsIHQpIHtcbiAgICAgICAgY29uc3QgbiA9IG5ldyBfX1BSSVZBVEVfRGVmZXJyZWQ7XG4gICAgICAgIHJldHVybiBlLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4gX19QUklWQVRFX3N5bmNFbmdpbmVXcml0ZShhd2FpdCBfX1BSSVZBVEVfZ2V0U3luY0VuZ2luZShlKSwgdCwgbikpKSwgXG4gICAgICAgIG4ucHJvbWlzZTtcbiAgICB9KGVuc3VyZUZpcmVzdG9yZUNvbmZpZ3VyZWQoZSksIHQpO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGEge0BsaW5rIFZpZXdTbmFwc2hvdH0gdGhhdCBjb250YWlucyB0aGUgc2luZ2xlIGRvY3VtZW50IHNwZWNpZmllZCBieSBgcmVmYFxuICogdG8gYSB7QGxpbmsgRG9jdW1lbnRTbmFwc2hvdH0uXG4gKi8gZnVuY3Rpb24gX19QUklWQVRFX2NvbnZlcnRUb0RvY1NuYXBzaG90KGUsIHQsIG4pIHtcbiAgICBjb25zdCByID0gbi5kb2NzLmdldCh0Ll9rZXkpLCBpID0gbmV3IF9fUFJJVkFURV9FeHBVc2VyRGF0YVdyaXRlcihlKTtcbiAgICByZXR1cm4gbmV3IERvY3VtZW50U25hcHNob3QoZSwgaSwgdC5fa2V5LCByLCBuZXcgU25hcHNob3RNZXRhZGF0YShuLmhhc1BlbmRpbmdXcml0ZXMsIG4uZnJvbUNhY2hlKSwgdC5jb252ZXJ0ZXIpO1xufVxuXG5mdW5jdGlvbiBnZXRDb3VudEZyb21TZXJ2ZXIoZSkge1xuICAgIHJldHVybiBnZXRBZ2dyZWdhdGVGcm9tU2VydmVyKGUsIHtcbiAgICAgICAgY291bnQ6IGNvdW50KClcbiAgICB9KTtcbn1cblxuLyoqXG4gKiBDYWxjdWxhdGVzIHRoZSBzcGVjaWZpZWQgYWdncmVnYXRpb25zIG92ZXIgdGhlIGRvY3VtZW50cyBpbiB0aGUgcmVzdWx0XG4gKiBzZXQgb2YgdGhlIGdpdmVuIHF1ZXJ5IHdpdGhvdXQgYWN0dWFsbHkgZG93bmxvYWRpbmcgdGhlIGRvY3VtZW50cy5cbiAqXG4gKiBVc2luZyB0aGlzIGZ1bmN0aW9uIHRvIHBlcmZvcm0gYWdncmVnYXRpb25zIGlzIGVmZmljaWVudCBiZWNhdXNlIG9ubHkgdGhlXG4gKiBmaW5hbCBhZ2dyZWdhdGlvbiB2YWx1ZXMsIG5vdCB0aGUgZG9jdW1lbnRzJyBkYXRhLCBhcmUgZG93bmxvYWRlZC4gVGhpc1xuICogZnVuY3Rpb24gY2FuIHBlcmZvcm0gYWdncmVnYXRpb25zIG9mIHRoZSBkb2N1bWVudHMgaW4gY2FzZXMgd2hlcmUgdGhlIHJlc3VsdFxuICogc2V0IGlzIHByb2hpYml0aXZlbHkgbGFyZ2UgdG8gZG93bmxvYWQgZW50aXJlbHkgKHRob3VzYW5kcyBvZiBkb2N1bWVudHMpLlxuICpcbiAqIFRoZSByZXN1bHQgcmVjZWl2ZWQgZnJvbSB0aGUgc2VydmVyIGlzIHByZXNlbnRlZCwgdW5hbHRlcmVkLCB3aXRob3V0XG4gKiBjb25zaWRlcmluZyBhbnkgbG9jYWwgc3RhdGUuIFRoYXQgaXMsIGRvY3VtZW50cyBpbiB0aGUgbG9jYWwgY2FjaGUgYXJlIG5vdFxuICogdGFrZW4gaW50byBjb25zaWRlcmF0aW9uLCBuZWl0aGVyIGFyZSBsb2NhbCBtb2RpZmljYXRpb25zIG5vdCB5ZXRcbiAqIHN5bmNocm9uaXplZCB3aXRoIHRoZSBzZXJ2ZXIuIFByZXZpb3VzbHktZG93bmxvYWRlZCByZXN1bHRzLCBpZiBhbnksIGFyZSBub3RcbiAqIHVzZWQuIEV2ZXJ5IGludm9jYXRpb24gb2YgdGhpcyBmdW5jdGlvbiBuZWNlc3NhcmlseSBpbnZvbHZlcyBhIHJvdW5kIHRyaXAgdG9cbiAqIHRoZSBzZXJ2ZXIuXG4gKlxuICogQHBhcmFtIHF1ZXJ5IFRoZSBxdWVyeSB3aG9zZSByZXN1bHQgc2V0IGlzIGFnZ3JlZ2F0ZWQgb3Zlci5cbiAqIEBwYXJhbSBhZ2dyZWdhdGVTcGVjIEFuIGBBZ2dyZWdhdGVTcGVjYCBvYmplY3QgdGhhdCBzcGVjaWZpZXMgdGhlIGFnZ3JlZ2F0ZXNcbiAqIHRvIHBlcmZvcm0gb3ZlciB0aGUgcmVzdWx0IHNldC4gVGhlIEFnZ3JlZ2F0ZVNwZWMgc3BlY2lmaWVzIGFsaWFzZXMgZm9yIGVhY2hcbiAqIGFnZ3JlZ2F0ZSwgd2hpY2ggY2FuIGJlIHVzZWQgdG8gcmV0cmlldmUgdGhlIGFnZ3JlZ2F0ZSByZXN1bHQuXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgYWdncmVnYXRlU25hcHNob3QgPSBhd2FpdCBnZXRBZ2dyZWdhdGVGcm9tU2VydmVyKHF1ZXJ5LCB7XG4gKiAgIGNvdW50T2ZEb2NzOiBjb3VudCgpLFxuICogICB0b3RhbEhvdXJzOiBzdW0oJ2hvdXJzJyksXG4gKiAgIGF2ZXJhZ2VTY29yZTogYXZlcmFnZSgnc2NvcmUnKVxuICogfSk7XG4gKlxuICogY29uc3QgY291bnRPZkRvY3M6IG51bWJlciA9IGFnZ3JlZ2F0ZVNuYXBzaG90LmRhdGEoKS5jb3VudE9mRG9jcztcbiAqIGNvbnN0IHRvdGFsSG91cnM6IG51bWJlciA9IGFnZ3JlZ2F0ZVNuYXBzaG90LmRhdGEoKS50b3RhbEhvdXJzO1xuICogY29uc3QgYXZlcmFnZVNjb3JlOiBudW1iZXIgfCBudWxsID0gYWdncmVnYXRlU25hcHNob3QuZGF0YSgpLmF2ZXJhZ2VTY29yZTtcbiAqIGBgYFxuICovIGZ1bmN0aW9uIGdldEFnZ3JlZ2F0ZUZyb21TZXJ2ZXIoZSwgdCkge1xuICAgIGNvbnN0IG4gPSBfX1BSSVZBVEVfY2FzdChlLmZpcmVzdG9yZSwgRmlyZXN0b3JlKSwgciA9IGVuc3VyZUZpcmVzdG9yZUNvbmZpZ3VyZWQobiksIGkgPSBfX1BSSVZBVEVfbWFwVG9BcnJheSh0LCAoKGUsIHQpID0+IG5ldyBfX1BSSVZBVEVfQWdncmVnYXRlSW1wbCh0LCBlLmFnZ3JlZ2F0ZVR5cGUsIGUuX2ludGVybmFsRmllbGRQYXRoKSkpO1xuICAgIC8vIFJ1biB0aGUgYWdncmVnYXRpb24gYW5kIGNvbnZlcnQgdGhlIHJlc3VsdHNcbiAgICByZXR1cm4gX19QUklWQVRFX2ZpcmVzdG9yZUNsaWVudFJ1bkFnZ3JlZ2F0ZVF1ZXJ5KHIsIGUuX3F1ZXJ5LCBpKS50aGVuKCh0ID0+IFxuICAgIC8qKlxuICogQ29udmVydHMgdGhlIGNvcmUgYWdncmVnYXRpb24gcmVzdWx0IHRvIGFuIGBBZ2dyZWdhdGVRdWVyeVNuYXBzaG90YFxuICogdGhhdCBjYW4gYmUgcmV0dXJuZWQgdG8gdGhlIGNvbnN1bWVyLlxuICogQHBhcmFtIHF1ZXJ5XG4gKiBAcGFyYW0gYWdncmVnYXRlUmVzdWx0IENvcmUgYWdncmVnYXRpb24gcmVzdWx0XG4gKiBAaW50ZXJuYWxcbiAqL1xuICAgIGZ1bmN0aW9uIF9fUFJJVkFURV9jb252ZXJ0VG9BZ2dyZWdhdGVRdWVyeVNuYXBzaG90KGUsIHQsIG4pIHtcbiAgICAgICAgY29uc3QgciA9IG5ldyBfX1BSSVZBVEVfRXhwVXNlckRhdGFXcml0ZXIoZSksIGkgPSBuZXcgQWdncmVnYXRlUXVlcnlTbmFwc2hvdCh0LCByLCBuKTtcbiAgICAgICAgcmV0dXJuIGk7XG4gICAgfVxuICAgIC8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIzIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIChuLCBlLCB0KSkpO1xufVxuXG5jbGFzcyBfX1BSSVZBVEVfTWVtb3J5TG9jYWxDYWNoZUltcGwge1xuICAgIGNvbnN0cnVjdG9yKGUpIHtcbiAgICAgICAgdGhpcy5raW5kID0gXCJtZW1vcnlcIiwgdGhpcy5fb25saW5lQ29tcG9uZW50UHJvdmlkZXIgPSBPbmxpbmVDb21wb25lbnRQcm92aWRlci5wcm92aWRlciwgXG4gICAgICAgIHRoaXMuX29mZmxpbmVDb21wb25lbnRQcm92aWRlciA9IGU/LmdhcmJhZ2VDb2xsZWN0b3IgPyBlLmdhcmJhZ2VDb2xsZWN0b3IuX29mZmxpbmVDb21wb25lbnRQcm92aWRlciA6IHtcbiAgICAgICAgICAgIGJ1aWxkOiAoKSA9PiBuZXcgX19QUklWQVRFX0xydUdjTWVtb3J5T2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyKHZvaWQgMClcbiAgICAgICAgfTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAga2luZDogdGhpcy5raW5kXG4gICAgICAgIH07XG4gICAgfVxufVxuXG5jbGFzcyBfX1BSSVZBVEVfUGVyc2lzdGVudExvY2FsQ2FjaGVJbXBsIHtcbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIGxldCB0O1xuICAgICAgICB0aGlzLmtpbmQgPSBcInBlcnNpc3RlbnRcIiwgZT8udGFiTWFuYWdlciA/IChlLnRhYk1hbmFnZXIuX2luaXRpYWxpemUoZSksIHQgPSBlLnRhYk1hbmFnZXIpIDogKHQgPSBwZXJzaXN0ZW50U2luZ2xlVGFiTWFuYWdlcih2b2lkIDApLCBcbiAgICAgICAgdC5faW5pdGlhbGl6ZShlKSksIHRoaXMuX29ubGluZUNvbXBvbmVudFByb3ZpZGVyID0gdC5fb25saW5lQ29tcG9uZW50UHJvdmlkZXIsIHRoaXMuX29mZmxpbmVDb21wb25lbnRQcm92aWRlciA9IHQuX29mZmxpbmVDb21wb25lbnRQcm92aWRlcjtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAga2luZDogdGhpcy5raW5kXG4gICAgICAgIH07XG4gICAgfVxufVxuXG5jbGFzcyBfX1BSSVZBVEVfTWVtb3J5RWFnZXJHYXJiYWdlQ29sbGVjdG9ySW1wbCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMua2luZCA9IFwibWVtb3J5RWFnZXJcIiwgdGhpcy5fb2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyID0gX19QUklWQVRFX01lbW9yeU9mZmxpbmVDb21wb25lbnRQcm92aWRlci5wcm92aWRlcjtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAga2luZDogdGhpcy5raW5kXG4gICAgICAgIH07XG4gICAgfVxufVxuXG5jbGFzcyBfX1BSSVZBVEVfTWVtb3J5THJ1R2FyYmFnZUNvbGxlY3RvckltcGwge1xuICAgIGNvbnN0cnVjdG9yKGUpIHtcbiAgICAgICAgdGhpcy5raW5kID0gXCJtZW1vcnlMcnVcIiwgdGhpcy5fb2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyID0ge1xuICAgICAgICAgICAgYnVpbGQ6ICgpID0+IG5ldyBfX1BSSVZBVEVfTHJ1R2NNZW1vcnlPZmZsaW5lQ29tcG9uZW50UHJvdmlkZXIoZSlcbiAgICAgICAgfTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAga2luZDogdGhpcy5raW5kXG4gICAgICAgIH07XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgYE1lbW9yeUVhZ2VyR2FyYmFnZUNvbGxlY3RvcmAuIFRoaXMgaXMgYWxzbyB0aGVcbiAqIGRlZmF1bHQgZ2FyYmFnZSBjb2xsZWN0b3IgdW5sZXNzIGl0IGlzIGV4cGxpY2l0bHkgc3BlY2lmaWVkIG90aGVyd2lzZS5cbiAqLyBmdW5jdGlvbiBtZW1vcnlFYWdlckdhcmJhZ2VDb2xsZWN0b3IoKSB7XG4gICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfTWVtb3J5RWFnZXJHYXJiYWdlQ29sbGVjdG9ySW1wbDtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIGBNZW1vcnlMcnVHYXJiYWdlQ29sbGVjdG9yYC5cbiAqXG4gKiBBIHRhcmdldCBzaXplIGNhbiBiZSBzcGVjaWZpZWQgYXMgcGFydCBvZiB0aGUgc2V0dGluZyBwYXJhbWV0ZXIuIFRoZVxuICogY29sbGVjdG9yIHdpbGwgc3RhcnQgZGVsZXRpbmcgZG9jdW1lbnRzIG9uY2UgdGhlIGNhY2hlIHNpemUgZXhjZWVkc1xuICogdGhlIGdpdmVuIHNpemUuIFRoZSBkZWZhdWx0IGNhY2hlIHNpemUgaXMgNDBNQiAoNDAgKiAxMDI0ICogMTAyNCBieXRlcykuXG4gKi8gZnVuY3Rpb24gbWVtb3J5THJ1R2FyYmFnZUNvbGxlY3RvcihlKSB7XG4gICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfTWVtb3J5THJ1R2FyYmFnZUNvbGxlY3RvckltcGwoZT8uY2FjaGVTaXplQnl0ZXMpO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgYE1lbW9yeUxvY2FsQ2FjaGVgLiBUaGUgaW5zdGFuY2UgY2FuIGJlIHNldCB0b1xuICogYEZpcmVzdG9yZVNldHRpbmdzLmNhY2hlYCB0byB0ZWxsIHRoZSBTREsgd2hpY2ggY2FjaGUgbGF5ZXIgdG8gdXNlLlxuICovIGZ1bmN0aW9uIG1lbW9yeUxvY2FsQ2FjaGUoZSkge1xuICAgIHJldHVybiBuZXcgX19QUklWQVRFX01lbW9yeUxvY2FsQ2FjaGVJbXBsKGUpO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgYFBlcnNpc3RlbnRMb2NhbENhY2hlYC4gVGhlIGluc3RhbmNlIGNhbiBiZSBzZXQgdG9cbiAqIGBGaXJlc3RvcmVTZXR0aW5ncy5jYWNoZWAgdG8gdGVsbCB0aGUgU0RLIHdoaWNoIGNhY2hlIGxheWVyIHRvIHVzZS5cbiAqXG4gKiBQZXJzaXN0ZW50IGNhY2hlIGNhbm5vdCBiZSB1c2VkIGluIGEgTm9kZS5qcyBlbnZpcm9ubWVudC5cbiAqLyBmdW5jdGlvbiBwZXJzaXN0ZW50TG9jYWxDYWNoZShlKSB7XG4gICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfUGVyc2lzdGVudExvY2FsQ2FjaGVJbXBsKGUpO1xufVxuXG5jbGFzcyBfX1BSSVZBVEVfU2luZ2xlVGFiTWFuYWdlckltcGwge1xuICAgIGNvbnN0cnVjdG9yKGUpIHtcbiAgICAgICAgdGhpcy5mb3JjZU93bmVyc2hpcCA9IGUsIHRoaXMua2luZCA9IFwicGVyc2lzdGVudFNpbmdsZVRhYlwiO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBraW5kOiB0aGlzLmtpbmRcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGludGVybmFsXG4gICAgICovICAgIF9pbml0aWFsaXplKGUpIHtcbiAgICAgICAgdGhpcy5fb25saW5lQ29tcG9uZW50UHJvdmlkZXIgPSBPbmxpbmVDb21wb25lbnRQcm92aWRlci5wcm92aWRlciwgdGhpcy5fb2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyID0ge1xuICAgICAgICAgICAgYnVpbGQ6IHQgPT4gbmV3IF9fUFJJVkFURV9JbmRleGVkRGJPZmZsaW5lQ29tcG9uZW50UHJvdmlkZXIodCwgZT8uY2FjaGVTaXplQnl0ZXMsIHRoaXMuZm9yY2VPd25lcnNoaXApXG4gICAgICAgIH07XG4gICAgfVxufVxuXG5jbGFzcyBfX1BSSVZBVEVfTXVsdGlUYWJNYW5hZ2VySW1wbCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMua2luZCA9IFwiUGVyc2lzdGVudE11bHRpcGxlVGFiXCI7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGtpbmQ6IHRoaXMua2luZFxuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaW50ZXJuYWxcbiAgICAgKi8gICAgX2luaXRpYWxpemUoZSkge1xuICAgICAgICB0aGlzLl9vbmxpbmVDb21wb25lbnRQcm92aWRlciA9IE9ubGluZUNvbXBvbmVudFByb3ZpZGVyLnByb3ZpZGVyLCB0aGlzLl9vZmZsaW5lQ29tcG9uZW50UHJvdmlkZXIgPSB7XG4gICAgICAgICAgICBidWlsZDogdCA9PiBuZXcgX19QUklWQVRFX011bHRpVGFiT2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyKHQsIGU/LmNhY2hlU2l6ZUJ5dGVzKVxuICAgICAgICB9O1xuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIGBQZXJzaXN0ZW50U2luZ2xlVGFiTWFuYWdlcmAuXG4gKlxuICogQHBhcmFtIHNldHRpbmdzIENvbmZpZ3VyZXMgdGhlIGNyZWF0ZWQgdGFiIG1hbmFnZXIuXG4gKi8gZnVuY3Rpb24gcGVyc2lzdGVudFNpbmdsZVRhYk1hbmFnZXIoZSkge1xuICAgIHJldHVybiBuZXcgX19QUklWQVRFX1NpbmdsZVRhYk1hbmFnZXJJbXBsKGU/LmZvcmNlT3duZXJzaGlwKTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIGBQZXJzaXN0ZW50TXVsdGlwbGVUYWJNYW5hZ2VyYC5cbiAqLyBmdW5jdGlvbiBwZXJzaXN0ZW50TXVsdGlwbGVUYWJNYW5hZ2VyKCkge1xuICAgIHJldHVybiBuZXcgX19QUklWQVRFX011bHRpVGFiTWFuYWdlckltcGw7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IEluID0ge1xuICAgIG1heEF0dGVtcHRzOiA1XG59O1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIHdyaXRlIGJhdGNoLCB1c2VkIHRvIHBlcmZvcm0gbXVsdGlwbGUgd3JpdGVzIGFzIGEgc2luZ2xlIGF0b21pYyB1bml0LlxuICpcbiAqIEEgYFdyaXRlQmF0Y2hgIG9iamVjdCBjYW4gYmUgYWNxdWlyZWQgYnkgY2FsbGluZyB7QGxpbmsgd3JpdGVCYXRjaH0uIEl0XG4gKiBwcm92aWRlcyBtZXRob2RzIGZvciBhZGRpbmcgd3JpdGVzIHRvIHRoZSB3cml0ZSBiYXRjaC4gTm9uZSBvZiB0aGUgd3JpdGVzXG4gKiB3aWxsIGJlIGNvbW1pdHRlZCAob3IgdmlzaWJsZSBsb2NhbGx5KSB1bnRpbCB7QGxpbmsgV3JpdGVCYXRjaC5jb21taXR9IGlzXG4gKiBjYWxsZWQuXG4gKi9cbmNsYXNzIFdyaXRlQmF0Y2gge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICB0aGlzLl9maXJlc3RvcmUgPSBlLCB0aGlzLl9jb21taXRIYW5kbGVyID0gdCwgdGhpcy5fbXV0YXRpb25zID0gW10sIHRoaXMuX2NvbW1pdHRlZCA9ICExLCBcbiAgICAgICAgdGhpcy5fZGF0YVJlYWRlciA9IF9fUFJJVkFURV9uZXdVc2VyRGF0YVJlYWRlcihlKTtcbiAgICB9XG4gICAgc2V0KGUsIHQsIG4pIHtcbiAgICAgICAgdGhpcy5fdmVyaWZ5Tm90Q29tbWl0dGVkKCk7XG4gICAgICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfdmFsaWRhdGVSZWZlcmVuY2UoZSwgdGhpcy5fZmlyZXN0b3JlKSwgaSA9IF9fUFJJVkFURV9hcHBseUZpcmVzdG9yZURhdGFDb252ZXJ0ZXIoci5jb252ZXJ0ZXIsIHQsIG4pLCBzID0gX19QUklWQVRFX3BhcnNlU2V0RGF0YSh0aGlzLl9kYXRhUmVhZGVyLCBcIldyaXRlQmF0Y2guc2V0XCIsIHIuX2tleSwgaSwgbnVsbCAhPT0gci5jb252ZXJ0ZXIsIG4pO1xuICAgICAgICByZXR1cm4gdGhpcy5fbXV0YXRpb25zLnB1c2gocy50b011dGF0aW9uKHIuX2tleSwgUHJlY29uZGl0aW9uLm5vbmUoKSkpLCB0aGlzO1xuICAgIH1cbiAgICB1cGRhdGUoZSwgdCwgbiwgLi4ucikge1xuICAgICAgICB0aGlzLl92ZXJpZnlOb3RDb21taXR0ZWQoKTtcbiAgICAgICAgY29uc3QgaSA9IF9fUFJJVkFURV92YWxpZGF0ZVJlZmVyZW5jZShlLCB0aGlzLl9maXJlc3RvcmUpO1xuICAgICAgICAvLyBGb3IgQ29tcGF0IHR5cGVzLCB3ZSBoYXZlIHRvIFwiZXh0cmFjdFwiIHRoZSB1bmRlcmx5aW5nIHR5cGVzIGJlZm9yZVxuICAgICAgICAvLyBwZXJmb3JtaW5nIHZhbGlkYXRpb24uXG4gICAgICAgICAgICAgICAgbGV0IHM7XG4gICAgICAgIHJldHVybiBzID0gXCJzdHJpbmdcIiA9PSB0eXBlb2YgKHQgPSBnZXRNb2R1bGFySW5zdGFuY2UodCkpIHx8IHQgaW5zdGFuY2VvZiBGaWVsZFBhdGggPyBfX1BSSVZBVEVfcGFyc2VVcGRhdGVWYXJhcmdzKHRoaXMuX2RhdGFSZWFkZXIsIFwiV3JpdGVCYXRjaC51cGRhdGVcIiwgaS5fa2V5LCB0LCBuLCByKSA6IF9fUFJJVkFURV9wYXJzZVVwZGF0ZURhdGEodGhpcy5fZGF0YVJlYWRlciwgXCJXcml0ZUJhdGNoLnVwZGF0ZVwiLCBpLl9rZXksIHQpLCBcbiAgICAgICAgdGhpcy5fbXV0YXRpb25zLnB1c2gocy50b011dGF0aW9uKGkuX2tleSwgUHJlY29uZGl0aW9uLmV4aXN0cyghMCkpKSwgdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVsZXRlcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhlIHByb3ZpZGVkIHtAbGluayBEb2N1bWVudFJlZmVyZW5jZX0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRSZWYgLSBBIHJlZmVyZW5jZSB0byB0aGUgZG9jdW1lbnQgdG8gYmUgZGVsZXRlZC5cbiAgICAgKiBAcmV0dXJucyBUaGlzIGBXcml0ZUJhdGNoYCBpbnN0YW5jZS4gVXNlZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzLlxuICAgICAqLyAgICBkZWxldGUoZSkge1xuICAgICAgICB0aGlzLl92ZXJpZnlOb3RDb21taXR0ZWQoKTtcbiAgICAgICAgY29uc3QgdCA9IF9fUFJJVkFURV92YWxpZGF0ZVJlZmVyZW5jZShlLCB0aGlzLl9maXJlc3RvcmUpO1xuICAgICAgICByZXR1cm4gdGhpcy5fbXV0YXRpb25zID0gdGhpcy5fbXV0YXRpb25zLmNvbmNhdChuZXcgX19QUklWQVRFX0RlbGV0ZU11dGF0aW9uKHQuX2tleSwgUHJlY29uZGl0aW9uLm5vbmUoKSkpLCBcbiAgICAgICAgdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29tbWl0cyBhbGwgb2YgdGhlIHdyaXRlcyBpbiB0aGlzIHdyaXRlIGJhdGNoIGFzIGEgc2luZ2xlIGF0b21pYyB1bml0LlxuICAgICAqXG4gICAgICogVGhlIHJlc3VsdCBvZiB0aGVzZSB3cml0ZXMgd2lsbCBvbmx5IGJlIHJlZmxlY3RlZCBpbiBkb2N1bWVudCByZWFkcyB0aGF0XG4gICAgICogb2NjdXIgYWZ0ZXIgdGhlIHJldHVybmVkIHByb21pc2UgcmVzb2x2ZXMuIElmIHRoZSBjbGllbnQgaXMgb2ZmbGluZSwgdGhlXG4gICAgICogd3JpdGUgZmFpbHMuIElmIHlvdSB3b3VsZCBsaWtlIHRvIHNlZSBsb2NhbCBtb2RpZmljYXRpb25zIG9yIGJ1ZmZlciB3cml0ZXNcbiAgICAgKiB1bnRpbCB0aGUgY2xpZW50IGlzIG9ubGluZSwgdXNlIHRoZSBmdWxsIEZpcmVzdG9yZSBTREsuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBBIGBQcm9taXNlYCByZXNvbHZlZCBvbmNlIGFsbCBvZiB0aGUgd3JpdGVzIGluIHRoZSBiYXRjaCBoYXZlIGJlZW5cbiAgICAgKiBzdWNjZXNzZnVsbHkgd3JpdHRlbiB0byB0aGUgYmFja2VuZCBhcyBhbiBhdG9taWMgdW5pdCAobm90ZSB0aGF0IGl0IHdvbid0XG4gICAgICogcmVzb2x2ZSB3aGlsZSB5b3UncmUgb2ZmbGluZSkuXG4gICAgICovICAgIGNvbW1pdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZlcmlmeU5vdENvbW1pdHRlZCgpLCB0aGlzLl9jb21taXR0ZWQgPSAhMCwgdGhpcy5fbXV0YXRpb25zLmxlbmd0aCA+IDAgPyB0aGlzLl9jb21taXRIYW5kbGVyKHRoaXMuX211dGF0aW9ucykgOiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgX3ZlcmlmeU5vdENvbW1pdHRlZCgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2NvbW1pdHRlZCkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uRkFJTEVEX1BSRUNPTkRJVElPTiwgXCJBIHdyaXRlIGJhdGNoIGNhbiBubyBsb25nZXIgYmUgdXNlZCBhZnRlciBjb21taXQoKSBoYXMgYmVlbiBjYWxsZWQuXCIpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gX19QUklWQVRFX3ZhbGlkYXRlUmVmZXJlbmNlKGUsIHQpIHtcbiAgICBpZiAoKGUgPSBnZXRNb2R1bGFySW5zdGFuY2UoZSkpLmZpcmVzdG9yZSAhPT0gdCkgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKE4uSU5WQUxJRF9BUkdVTUVOVCwgXCJQcm92aWRlZCBkb2N1bWVudCByZWZlcmVuY2UgaXMgZnJvbSBhIGRpZmZlcmVudCBGaXJlc3RvcmUgaW5zdGFuY2UuXCIpO1xuICAgIHJldHVybiBlO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gVE9ETyhtcnNjaG1pZHQpIENvbnNpZGVyIHVzaW5nIGBCYXNlVHJhbnNhY3Rpb25gIGFzIHRoZSBiYXNlIGNsYXNzIGluIHRoZVxuLy8gbGVnYWN5IFNESy5cbi8qKlxuICogQSByZWZlcmVuY2UgdG8gYSB0cmFuc2FjdGlvbi5cbiAqXG4gKiBUaGUgYFRyYW5zYWN0aW9uYCBvYmplY3QgcGFzc2VkIHRvIGEgdHJhbnNhY3Rpb24ncyBgdXBkYXRlRnVuY3Rpb25gIHByb3ZpZGVzXG4gKiB0aGUgbWV0aG9kcyB0byByZWFkIGFuZCB3cml0ZSBkYXRhIHdpdGhpbiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dC4gU2VlXG4gKiB7QGxpbmsgcnVuVHJhbnNhY3Rpb259LlxuICovIGNsYXNzIFRyYW5zYWN0aW9uJDEge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IoZSwgdCkge1xuICAgICAgICB0aGlzLl9maXJlc3RvcmUgPSBlLCB0aGlzLl90cmFuc2FjdGlvbiA9IHQsIHRoaXMuX2RhdGFSZWFkZXIgPSBfX1BSSVZBVEVfbmV3VXNlckRhdGFSZWFkZXIoZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlYWRzIHRoZSBkb2N1bWVudCByZWZlcmVuY2VkIGJ5IHRoZSBwcm92aWRlZCB7QGxpbmsgRG9jdW1lbnRSZWZlcmVuY2V9LlxuICAgICAqXG4gICAgICogQHBhcmFtIGRvY3VtZW50UmVmIC0gQSByZWZlcmVuY2UgdG8gdGhlIGRvY3VtZW50IHRvIGJlIHJlYWQuXG4gICAgICogQHJldHVybnMgQSBgRG9jdW1lbnRTbmFwc2hvdGAgd2l0aCB0aGUgcmVhZCBkYXRhLlxuICAgICAqLyAgICBnZXQoZSkge1xuICAgICAgICBjb25zdCB0ID0gX19QUklWQVRFX3ZhbGlkYXRlUmVmZXJlbmNlKGUsIHRoaXMuX2ZpcmVzdG9yZSksIG4gPSBuZXcgX19QUklWQVRFX0xpdGVVc2VyRGF0YVdyaXRlcih0aGlzLl9maXJlc3RvcmUpO1xuICAgICAgICByZXR1cm4gdGhpcy5fdHJhbnNhY3Rpb24ubG9va3VwKFsgdC5fa2V5IF0pLnRoZW4oKGUgPT4ge1xuICAgICAgICAgICAgaWYgKCFlIHx8IDEgIT09IGUubGVuZ3RoKSByZXR1cm4gZmFpbCgyNDA0MSk7XG4gICAgICAgICAgICBjb25zdCByID0gZVswXTtcbiAgICAgICAgICAgIGlmIChyLmlzRm91bmREb2N1bWVudCgpKSByZXR1cm4gbmV3IERvY3VtZW50U25hcHNob3QkMSh0aGlzLl9maXJlc3RvcmUsIG4sIHIua2V5LCByLCB0LmNvbnZlcnRlcik7XG4gICAgICAgICAgICBpZiAoci5pc05vRG9jdW1lbnQoKSkgcmV0dXJuIG5ldyBEb2N1bWVudFNuYXBzaG90JDEodGhpcy5fZmlyZXN0b3JlLCBuLCB0Ll9rZXksIG51bGwsIHQuY29udmVydGVyKTtcbiAgICAgICAgICAgIHRocm93IGZhaWwoMTg0MzMsIHtcbiAgICAgICAgICAgICAgICBkb2M6IHJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHNldChlLCB0LCBuKSB7XG4gICAgICAgIGNvbnN0IHIgPSBfX1BSSVZBVEVfdmFsaWRhdGVSZWZlcmVuY2UoZSwgdGhpcy5fZmlyZXN0b3JlKSwgaSA9IF9fUFJJVkFURV9hcHBseUZpcmVzdG9yZURhdGFDb252ZXJ0ZXIoci5jb252ZXJ0ZXIsIHQsIG4pLCBzID0gX19QUklWQVRFX3BhcnNlU2V0RGF0YSh0aGlzLl9kYXRhUmVhZGVyLCBcIlRyYW5zYWN0aW9uLnNldFwiLCByLl9rZXksIGksIG51bGwgIT09IHIuY29udmVydGVyLCBuKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RyYW5zYWN0aW9uLnNldChyLl9rZXksIHMpLCB0aGlzO1xuICAgIH1cbiAgICB1cGRhdGUoZSwgdCwgbiwgLi4ucikge1xuICAgICAgICBjb25zdCBpID0gX19QUklWQVRFX3ZhbGlkYXRlUmVmZXJlbmNlKGUsIHRoaXMuX2ZpcmVzdG9yZSk7XG4gICAgICAgIC8vIEZvciBDb21wYXQgdHlwZXMsIHdlIGhhdmUgdG8gXCJleHRyYWN0XCIgdGhlIHVuZGVybHlpbmcgdHlwZXMgYmVmb3JlXG4gICAgICAgIC8vIHBlcmZvcm1pbmcgdmFsaWRhdGlvbi5cbiAgICAgICAgICAgICAgICBsZXQgcztcbiAgICAgICAgcmV0dXJuIHMgPSBcInN0cmluZ1wiID09IHR5cGVvZiAodCA9IGdldE1vZHVsYXJJbnN0YW5jZSh0KSkgfHwgdCBpbnN0YW5jZW9mIEZpZWxkUGF0aCA/IF9fUFJJVkFURV9wYXJzZVVwZGF0ZVZhcmFyZ3ModGhpcy5fZGF0YVJlYWRlciwgXCJUcmFuc2FjdGlvbi51cGRhdGVcIiwgaS5fa2V5LCB0LCBuLCByKSA6IF9fUFJJVkFURV9wYXJzZVVwZGF0ZURhdGEodGhpcy5fZGF0YVJlYWRlciwgXCJUcmFuc2FjdGlvbi51cGRhdGVcIiwgaS5fa2V5LCB0KSwgXG4gICAgICAgIHRoaXMuX3RyYW5zYWN0aW9uLnVwZGF0ZShpLl9rZXksIHMpLCB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWxldGVzIHRoZSBkb2N1bWVudCByZWZlcnJlZCB0byBieSB0aGUgcHJvdmlkZWQge0BsaW5rIERvY3VtZW50UmVmZXJlbmNlfS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudFJlZiAtIEEgcmVmZXJlbmNlIHRvIHRoZSBkb2N1bWVudCB0byBiZSBkZWxldGVkLlxuICAgICAqIEByZXR1cm5zIFRoaXMgYFRyYW5zYWN0aW9uYCBpbnN0YW5jZS4gVXNlZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzLlxuICAgICAqLyAgICBkZWxldGUoZSkge1xuICAgICAgICBjb25zdCB0ID0gX19QUklWQVRFX3ZhbGlkYXRlUmVmZXJlbmNlKGUsIHRoaXMuX2ZpcmVzdG9yZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl90cmFuc2FjdGlvbi5kZWxldGUodC5fa2V5KSwgdGhpcztcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgcmVmZXJlbmNlIHRvIGEgdHJhbnNhY3Rpb24uXG4gKlxuICogVGhlIGBUcmFuc2FjdGlvbmAgb2JqZWN0IHBhc3NlZCB0byBhIHRyYW5zYWN0aW9uJ3MgYHVwZGF0ZUZ1bmN0aW9uYCBwcm92aWRlc1xuICogdGhlIG1ldGhvZHMgdG8gcmVhZCBhbmQgd3JpdGUgZGF0YSB3aXRoaW4gdGhlIHRyYW5zYWN0aW9uIGNvbnRleHQuIFNlZVxuICoge0BsaW5rIHJ1blRyYW5zYWN0aW9ufS5cbiAqLyBjbGFzcyBUcmFuc2FjdGlvbiBleHRlbmRzIFRyYW5zYWN0aW9uJDEge1xuICAgIC8vIFRoaXMgY2xhc3MgaW1wbGVtZW50cyB0aGUgc2FtZSBsb2dpYyBhcyB0aGUgVHJhbnNhY3Rpb24gQVBJIGluIHRoZSBMaXRlIFNES1xuICAgIC8vIGJ1dCBpcyBzdWJjbGFzc2VkIGluIG9yZGVyIHRvIHJldHVybiBpdHMgb3duIERvY3VtZW50U25hcHNob3QgdHlwZXMuXG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3RvcihlLCB0KSB7XG4gICAgICAgIHN1cGVyKGUsIHQpLCB0aGlzLl9maXJlc3RvcmUgPSBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWFkcyB0aGUgZG9jdW1lbnQgcmVmZXJlbmNlZCBieSB0aGUgcHJvdmlkZWQge0BsaW5rIERvY3VtZW50UmVmZXJlbmNlfS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudFJlZiAtIEEgcmVmZXJlbmNlIHRvIHRoZSBkb2N1bWVudCB0byBiZSByZWFkLlxuICAgICAqIEByZXR1cm5zIEEgYERvY3VtZW50U25hcHNob3RgIHdpdGggdGhlIHJlYWQgZGF0YS5cbiAgICAgKi8gICAgZ2V0KGUpIHtcbiAgICAgICAgY29uc3QgdCA9IF9fUFJJVkFURV92YWxpZGF0ZVJlZmVyZW5jZShlLCB0aGlzLl9maXJlc3RvcmUpLCBuID0gbmV3IF9fUFJJVkFURV9FeHBVc2VyRGF0YVdyaXRlcih0aGlzLl9maXJlc3RvcmUpO1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0KGUpLnRoZW4oKGUgPT4gbmV3IERvY3VtZW50U25hcHNob3QodGhpcy5fZmlyZXN0b3JlLCBuLCB0Ll9rZXksIGUuX2RvY3VtZW50LCBuZXcgU25hcHNob3RNZXRhZGF0YShcbiAgICAgICAgLyogaGFzUGVuZGluZ1dyaXRlcz0gKi8gITEsIFxuICAgICAgICAvKiBmcm9tQ2FjaGU9ICovICExKSwgdC5jb252ZXJ0ZXIpKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEV4ZWN1dGVzIHRoZSBnaXZlbiBgdXBkYXRlRnVuY3Rpb25gIGFuZCB0aGVuIGF0dGVtcHRzIHRvIGNvbW1pdCB0aGUgY2hhbmdlc1xuICogYXBwbGllZCB3aXRoaW4gdGhlIHRyYW5zYWN0aW9uLiBJZiBhbnkgZG9jdW1lbnQgcmVhZCB3aXRoaW4gdGhlIHRyYW5zYWN0aW9uXG4gKiBoYXMgY2hhbmdlZCwgQ2xvdWQgRmlyZXN0b3JlIHJldHJpZXMgdGhlIGB1cGRhdGVGdW5jdGlvbmAuIElmIGl0IGZhaWxzIHRvXG4gKiBjb21taXQgYWZ0ZXIgNSBhdHRlbXB0cywgdGhlIHRyYW5zYWN0aW9uIGZhaWxzLlxuICpcbiAqIFRoZSBtYXhpbXVtIG51bWJlciBvZiB3cml0ZXMgYWxsb3dlZCBpbiBhIHNpbmdsZSB0cmFuc2FjdGlvbiBpcyA1MDAuXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIEEgcmVmZXJlbmNlIHRvIHRoZSBGaXJlc3RvcmUgZGF0YWJhc2UgdG8gcnVuIHRoaXNcbiAqIHRyYW5zYWN0aW9uIGFnYWluc3QuXG4gKiBAcGFyYW0gdXBkYXRlRnVuY3Rpb24gLSBUaGUgZnVuY3Rpb24gdG8gZXhlY3V0ZSB3aXRoaW4gdGhlIHRyYW5zYWN0aW9uXG4gKiBjb250ZXh0LlxuICogQHBhcmFtIG9wdGlvbnMgLSBBbiBvcHRpb25zIG9iamVjdCB0byBjb25maWd1cmUgbWF4aW11bSBudW1iZXIgb2YgYXR0ZW1wdHMgdG9cbiAqIGNvbW1pdC5cbiAqIEByZXR1cm5zIElmIHRoZSB0cmFuc2FjdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5IG9yIHdhcyBleHBsaWNpdGx5IGFib3J0ZWRcbiAqICh0aGUgYHVwZGF0ZUZ1bmN0aW9uYCByZXR1cm5lZCBhIGZhaWxlZCBwcm9taXNlKSwgdGhlIHByb21pc2UgcmV0dXJuZWQgYnkgdGhlXG4gKiBgdXBkYXRlRnVuY3Rpb24gYGlzIHJldHVybmVkIGhlcmUuIE90aGVyd2lzZSwgaWYgdGhlIHRyYW5zYWN0aW9uIGZhaWxlZCwgYVxuICogcmVqZWN0ZWQgcHJvbWlzZSB3aXRoIHRoZSBjb3JyZXNwb25kaW5nIGZhaWx1cmUgZXJyb3IgaXMgcmV0dXJuZWQuXG4gKi8gZnVuY3Rpb24gcnVuVHJhbnNhY3Rpb24oZSwgdCwgbikge1xuICAgIGUgPSBfX1BSSVZBVEVfY2FzdChlLCBGaXJlc3RvcmUpO1xuICAgIGNvbnN0IHIgPSB7XG4gICAgICAgIC4uLkluLFxuICAgICAgICAuLi5uXG4gICAgfTtcbiAgICAhZnVuY3Rpb24gX19QUklWQVRFX3ZhbGlkYXRlVHJhbnNhY3Rpb25PcHRpb25zKGUpIHtcbiAgICAgICAgaWYgKGUubWF4QXR0ZW1wdHMgPCAxKSB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBcIk1heCBhdHRlbXB0cyBtdXN0IGJlIGF0IGxlYXN0IDFcIik7XG4gICAgfShyKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gX19QUklWQVRFX2ZpcmVzdG9yZUNsaWVudFRyYW5zYWN0aW9uKGUsIHQsIG4pIHtcbiAgICAgICAgY29uc3QgciA9IG5ldyBfX1BSSVZBVEVfRGVmZXJyZWQ7XG4gICAgICAgIHJldHVybiBlLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IGF3YWl0IF9fUFJJVkFURV9nZXREYXRhc3RvcmUoZSk7XG4gICAgICAgICAgICBuZXcgX19QUklWQVRFX1RyYW5zYWN0aW9uUnVubmVyKGUuYXN5bmNRdWV1ZSwgaSwgbiwgdCwgcikuanUoKTtcbiAgICAgICAgfSkpLCByLnByb21pc2U7XG4gICAgfShlbnN1cmVGaXJlc3RvcmVDb25maWd1cmVkKGUpLCAobiA9PiB0KG5ldyBUcmFuc2FjdGlvbihlLCBuKSkpLCByKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmV0dXJucyBhIHNlbnRpbmVsIGZvciB1c2Ugd2l0aCB7QGxpbmsgQGZpcmViYXNlL2ZpcmVzdG9yZS9saXRlIyh1cGRhdGVEb2M6MSl9IG9yXG4gKiB7QGxpbmsgQGZpcmViYXNlL2ZpcmVzdG9yZS9saXRlIyhzZXREb2M6MSl9IHdpdGggYHttZXJnZTogdHJ1ZX1gIHRvIG1hcmsgYSBmaWVsZCBmb3IgZGVsZXRpb24uXG4gKi8gZnVuY3Rpb24gZGVsZXRlRmllbGQoKSB7XG4gICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfRGVsZXRlRmllbGRWYWx1ZUltcGwoXCJkZWxldGVGaWVsZFwiKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgc2VudGluZWwgdXNlZCB3aXRoIHtAbGluayBAZmlyZWJhc2UvZmlyZXN0b3JlL2xpdGUjKHNldERvYzoxKX0gb3Ige0BsaW5rIEBmaXJlYmFzZS9maXJlc3RvcmUvbGl0ZSModXBkYXRlRG9jOjEpfSB0b1xuICogaW5jbHVkZSBhIHNlcnZlci1nZW5lcmF0ZWQgdGltZXN0YW1wIGluIHRoZSB3cml0dGVuIGRhdGEuXG4gKi8gZnVuY3Rpb24gc2VydmVyVGltZXN0YW1wKCkge1xuICAgIHJldHVybiBuZXcgX19QUklWQVRFX1NlcnZlclRpbWVzdGFtcEZpZWxkVmFsdWVJbXBsKFwic2VydmVyVGltZXN0YW1wXCIpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBzcGVjaWFsIHZhbHVlIHRoYXQgY2FuIGJlIHVzZWQgd2l0aCB7QGxpbmsgQGZpcmViYXNlL2ZpcmVzdG9yZS9saXRlIyhzZXREb2M6MSl9IG9yIHtAbGlua1xuICogQGZpcmViYXNlL2ZpcmVzdG9yZS9saXRlIyh1cGRhdGVEb2M6MSl9IHRoYXQgdGVsbHMgdGhlIHNlcnZlciB0byB1bmlvbiB0aGUgZ2l2ZW4gZWxlbWVudHMgd2l0aCBhbnkgYXJyYXlcbiAqIHZhbHVlIHRoYXQgYWxyZWFkeSBleGlzdHMgb24gdGhlIHNlcnZlci4gRWFjaCBzcGVjaWZpZWQgZWxlbWVudCB0aGF0IGRvZXNuJ3RcbiAqIGFscmVhZHkgZXhpc3QgaW4gdGhlIGFycmF5IHdpbGwgYmUgYWRkZWQgdG8gdGhlIGVuZC4gSWYgdGhlIGZpZWxkIGJlaW5nXG4gKiBtb2RpZmllZCBpcyBub3QgYWxyZWFkeSBhbiBhcnJheSBpdCB3aWxsIGJlIG92ZXJ3cml0dGVuIHdpdGggYW4gYXJyYXlcbiAqIGNvbnRhaW5pbmcgZXhhY3RseSB0aGUgc3BlY2lmaWVkIGVsZW1lbnRzLlxuICpcbiAqIEBwYXJhbSBlbGVtZW50cyAtIFRoZSBlbGVtZW50cyB0byB1bmlvbiBpbnRvIHRoZSBhcnJheS5cbiAqIEByZXR1cm5zIFRoZSBgRmllbGRWYWx1ZWAgc2VudGluZWwgZm9yIHVzZSBpbiBhIGNhbGwgdG8gYHNldERvYygpYCBvclxuICogYHVwZGF0ZURvYygpYC5cbiAqLyBmdW5jdGlvbiBhcnJheVVuaW9uKC4uLmUpIHtcbiAgICAvLyBOT1RFOiBXZSBkb24ndCBhY3R1YWxseSBwYXJzZSB0aGUgZGF0YSB1bnRpbCBpdCdzIHVzZWQgaW4gc2V0KCkgb3JcbiAgICAvLyB1cGRhdGUoKSBzaW5jZSB3ZSdkIG5lZWQgdGhlIEZpcmVzdG9yZSBpbnN0YW5jZSB0byBkbyB0aGlzLlxuICAgIHJldHVybiBuZXcgX19QUklWQVRFX0FycmF5VW5pb25GaWVsZFZhbHVlSW1wbChcImFycmF5VW5pb25cIiwgZSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHNwZWNpYWwgdmFsdWUgdGhhdCBjYW4gYmUgdXNlZCB3aXRoIHtAbGluayAoc2V0RG9jOjEpfSBvciB7QGxpbmtcbiAqIHVwZGF0ZURvYzoxfSB0aGF0IHRlbGxzIHRoZSBzZXJ2ZXIgdG8gcmVtb3ZlIHRoZSBnaXZlbiBlbGVtZW50cyBmcm9tIGFueVxuICogYXJyYXkgdmFsdWUgdGhhdCBhbHJlYWR5IGV4aXN0cyBvbiB0aGUgc2VydmVyLiBBbGwgaW5zdGFuY2VzIG9mIGVhY2ggZWxlbWVudFxuICogc3BlY2lmaWVkIHdpbGwgYmUgcmVtb3ZlZCBmcm9tIHRoZSBhcnJheS4gSWYgdGhlIGZpZWxkIGJlaW5nIG1vZGlmaWVkIGlzIG5vdFxuICogYWxyZWFkeSBhbiBhcnJheSBpdCB3aWxsIGJlIG92ZXJ3cml0dGVuIHdpdGggYW4gZW1wdHkgYXJyYXkuXG4gKlxuICogQHBhcmFtIGVsZW1lbnRzIC0gVGhlIGVsZW1lbnRzIHRvIHJlbW92ZSBmcm9tIHRoZSBhcnJheS5cbiAqIEByZXR1cm5zIFRoZSBgRmllbGRWYWx1ZWAgc2VudGluZWwgZm9yIHVzZSBpbiBhIGNhbGwgdG8gYHNldERvYygpYCBvclxuICogYHVwZGF0ZURvYygpYFxuICovIGZ1bmN0aW9uIGFycmF5UmVtb3ZlKC4uLmUpIHtcbiAgICAvLyBOT1RFOiBXZSBkb24ndCBhY3R1YWxseSBwYXJzZSB0aGUgZGF0YSB1bnRpbCBpdCdzIHVzZWQgaW4gc2V0KCkgb3JcbiAgICAvLyB1cGRhdGUoKSBzaW5jZSB3ZSdkIG5lZWQgdGhlIEZpcmVzdG9yZSBpbnN0YW5jZSB0byBkbyB0aGlzLlxuICAgIHJldHVybiBuZXcgX19QUklWQVRFX0FycmF5UmVtb3ZlRmllbGRWYWx1ZUltcGwoXCJhcnJheVJlbW92ZVwiLCBlKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgc3BlY2lhbCB2YWx1ZSB0aGF0IGNhbiBiZSB1c2VkIHdpdGgge0BsaW5rIEBmaXJlYmFzZS9maXJlc3RvcmUvbGl0ZSMoc2V0RG9jOjEpfSBvciB7QGxpbmtcbiAqIEBmaXJlYmFzZS9maXJlc3RvcmUvbGl0ZSModXBkYXRlRG9jOjEpfSB0aGF0IHRlbGxzIHRoZSBzZXJ2ZXIgdG8gaW5jcmVtZW50IHRoZSBmaWVsZCdzIGN1cnJlbnQgdmFsdWUgYnlcbiAqIHRoZSBnaXZlbiB2YWx1ZS5cbiAqXG4gKiBJZiBlaXRoZXIgdGhlIG9wZXJhbmQgb3IgdGhlIGN1cnJlbnQgZmllbGQgdmFsdWUgdXNlcyBmbG9hdGluZyBwb2ludFxuICogcHJlY2lzaW9uLCBhbGwgYXJpdGhtZXRpYyBmb2xsb3dzIElFRUUgNzU0IHNlbWFudGljcy4gSWYgYm90aCB2YWx1ZXMgYXJlXG4gKiBpbnRlZ2VycywgdmFsdWVzIG91dHNpZGUgb2YgSmF2YVNjcmlwdCdzIHNhZmUgbnVtYmVyIHJhbmdlXG4gKiAoYE51bWJlci5NSU5fU0FGRV9JTlRFR0VSYCB0byBgTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVJgKSBhcmUgYWxzbyBzdWJqZWN0IHRvXG4gKiBwcmVjaXNpb24gbG9zcy4gRnVydGhlcm1vcmUsIG9uY2UgcHJvY2Vzc2VkIGJ5IHRoZSBGaXJlc3RvcmUgYmFja2VuZCwgYWxsXG4gKiBpbnRlZ2VyIG9wZXJhdGlvbnMgYXJlIGNhcHBlZCBiZXR3ZWVuIC0yXjYzIGFuZCAyXjYzLTEuXG4gKlxuICogSWYgdGhlIGN1cnJlbnQgZmllbGQgdmFsdWUgaXMgbm90IG9mIHR5cGUgYG51bWJlcmAsIG9yIGlmIHRoZSBmaWVsZCBkb2VzIG5vdFxuICogeWV0IGV4aXN0LCB0aGUgdHJhbnNmb3JtYXRpb24gc2V0cyB0aGUgZmllbGQgdG8gdGhlIGdpdmVuIHZhbHVlLlxuICpcbiAqIEBwYXJhbSBuIC0gVGhlIHZhbHVlIHRvIGluY3JlbWVudCBieS5cbiAqIEByZXR1cm5zIFRoZSBgRmllbGRWYWx1ZWAgc2VudGluZWwgZm9yIHVzZSBpbiBhIGNhbGwgdG8gYHNldERvYygpYCBvclxuICogYHVwZGF0ZURvYygpYFxuICovIGZ1bmN0aW9uIGluY3JlbWVudChlKSB7XG4gICAgcmV0dXJuIG5ldyBfX1BSSVZBVEVfTnVtZXJpY0luY3JlbWVudEZpZWxkVmFsdWVJbXBsKFwiaW5jcmVtZW50XCIsIGUpO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgYFZlY3RvclZhbHVlYCBjb25zdHJ1Y3RlZCB3aXRoIGEgY29weSBvZiB0aGUgZ2l2ZW4gYXJyYXkgb2YgbnVtYmVycy5cbiAqXG4gKiBAcGFyYW0gdmFsdWVzIC0gQ3JlYXRlIGEgYFZlY3RvclZhbHVlYCBpbnN0YW5jZSB3aXRoIGEgY29weSBvZiB0aGlzIGFycmF5IG9mIG51bWJlcnMuXG4gKlxuICogQHJldHVybnMgQSBuZXcgYFZlY3RvclZhbHVlYCBjb25zdHJ1Y3RlZCB3aXRoIGEgY29weSBvZiB0aGUgZ2l2ZW4gYXJyYXkgb2YgbnVtYmVycy5cbiAqLyBmdW5jdGlvbiB2ZWN0b3IoZSkge1xuICAgIHJldHVybiBuZXcgVmVjdG9yVmFsdWUoZSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIENyZWF0ZXMgYSB3cml0ZSBiYXRjaCwgdXNlZCBmb3IgcGVyZm9ybWluZyBtdWx0aXBsZSB3cml0ZXMgYXMgYSBzaW5nbGVcbiAqIGF0b21pYyBvcGVyYXRpb24uIFRoZSBtYXhpbXVtIG51bWJlciBvZiB3cml0ZXMgYWxsb3dlZCBpbiBhIHNpbmdsZSB7QGxpbmsgV3JpdGVCYXRjaH1cbiAqIGlzIDUwMC5cbiAqXG4gKiBVbmxpa2UgdHJhbnNhY3Rpb25zLCB3cml0ZSBiYXRjaGVzIGFyZSBwZXJzaXN0ZWQgb2ZmbGluZSBhbmQgdGhlcmVmb3JlIGFyZVxuICogcHJlZmVyYWJsZSB3aGVuIHlvdSBkb24ndCBuZWVkIHRvIGNvbmRpdGlvbiB5b3VyIHdyaXRlcyBvbiByZWFkIGRhdGEuXG4gKlxuICogQHJldHVybnMgQSB7QGxpbmsgV3JpdGVCYXRjaH0gdGhhdCBjYW4gYmUgdXNlZCB0byBhdG9taWNhbGx5IGV4ZWN1dGUgbXVsdGlwbGVcbiAqIHdyaXRlcy5cbiAqLyBmdW5jdGlvbiB3cml0ZUJhdGNoKGUpIHtcbiAgICByZXR1cm4gZW5zdXJlRmlyZXN0b3JlQ29uZmlndXJlZChlID0gX19QUklWQVRFX2Nhc3QoZSwgRmlyZXN0b3JlKSksIG5ldyBXcml0ZUJhdGNoKGUsICh0ID0+IGV4ZWN1dGVXcml0ZShlLCB0KSkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBmdW5jdGlvbiBzZXRJbmRleENvbmZpZ3VyYXRpb24oZSwgdCkge1xuICAgIGNvbnN0IG4gPSBlbnN1cmVGaXJlc3RvcmVDb25maWd1cmVkKGUgPSBfX1BSSVZBVEVfY2FzdChlLCBGaXJlc3RvcmUpKTtcbiAgICBpZiAoIW4uX3VuaW5pdGlhbGl6ZWRDb21wb25lbnRzUHJvdmlkZXIgfHwgXCJtZW1vcnlcIiA9PT0gbi5fdW5pbml0aWFsaXplZENvbXBvbmVudHNQcm92aWRlci5fb2ZmbGluZS5raW5kKSBcbiAgICAvLyBQT1JUSU5HIE5PVEU6IFdlIGRvbid0IHJldHVybiBhbiBlcnJvciBpZiB0aGUgdXNlciBoYXMgbm90IGVuYWJsZWRcbiAgICAvLyBwZXJzaXN0ZW5jZSBzaW5jZSBgZW5hYmxlSW5kZXhlZGRiUGVyc2lzdGVuY2UoKWAgY2FuIGZhaWwgb24gdGhlIFdlYi5cbiAgICByZXR1cm4gX19QUklWQVRFX2xvZ1dhcm4oXCJDYW5ub3QgZW5hYmxlIGluZGV4ZXMgd2hlbiBwZXJzaXN0ZW5jZSBpcyBkaXNhYmxlZFwiKSwgXG4gICAgUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgY29uc3QgciA9IGZ1bmN0aW9uIF9fUFJJVkFURV9wYXJzZUluZGV4ZXMoZSkge1xuICAgICAgICBjb25zdCB0ID0gXCJzdHJpbmdcIiA9PSB0eXBlb2YgZSA/IGZ1bmN0aW9uIF9fUFJJVkFURV90cnlQYXJzZUpzb24oZSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShlKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBcIkZhaWxlZCB0byBwYXJzZSBKU09OOiBcIiArIGU/Lm1lc3NhZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KGUpIDogZSwgbiA9IFtdO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0LmluZGV4ZXMpKSBmb3IgKGNvbnN0IGUgb2YgdC5pbmRleGVzKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gX19QUklWQVRFX3RyeUdldFN0cmluZyhlLCBcImNvbGxlY3Rpb25Hcm91cFwiKSwgciA9IFtdO1xuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZS5maWVsZHMpKSBmb3IgKGNvbnN0IHQgb2YgZS5maWVsZHMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gX19QUklWQVRFX2ZpZWxkUGF0aEZyb21Eb3RTZXBhcmF0ZWRTdHJpbmcoXCJzZXRJbmRleENvbmZpZ3VyYXRpb25cIiwgX19QUklWQVRFX3RyeUdldFN0cmluZyh0LCBcImZpZWxkUGF0aFwiKSk7XG4gICAgICAgICAgICAgICAgXCJDT05UQUlOU1wiID09PSB0LmFycmF5Q29uZmlnID8gci5wdXNoKG5ldyBJbmRleFNlZ21lbnQoZSwgMiAvKiBJbmRleEtpbmQuQ09OVEFJTlMgKi8pKSA6IFwiQVNDRU5ESU5HXCIgPT09IHQub3JkZXIgPyByLnB1c2gobmV3IEluZGV4U2VnbWVudChlLCAwIC8qIEluZGV4S2luZC5BU0NFTkRJTkcgKi8pKSA6IFwiREVTQ0VORElOR1wiID09PSB0Lm9yZGVyICYmIHIucHVzaChuZXcgSW5kZXhTZWdtZW50KGUsIDEgLyogSW5kZXhLaW5kLkRFU0NFTkRJTkcgKi8pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG4ucHVzaChuZXcgRmllbGRJbmRleChGaWVsZEluZGV4LlVOS05PV05fSUQsIHQsIHIsIEluZGV4U3RhdGUuZW1wdHkoKSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuO1xuICAgIH0odCk7XG4gICAgcmV0dXJuIF9fUFJJVkFURV9maXJlc3RvcmVDbGllbnRTZXRJbmRleENvbmZpZ3VyYXRpb24obiwgcik7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV90cnlHZXRTdHJpbmcoZSwgdCkge1xuICAgIGlmIChcInN0cmluZ1wiICE9IHR5cGVvZiBlW3RdKSB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoTi5JTlZBTElEX0FSR1VNRU5ULCBcIk1pc3Npbmcgc3RyaW5nIHZhbHVlIGZvcjogXCIgKyB0KTtcbiAgICByZXR1cm4gZVt0XTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBgUGVyc2lzdGVudENhY2hlSW5kZXhNYW5hZ2VyYCBmb3IgY29uZmlndXJpbmcgcGVyc2lzdGVudCBjYWNoZSBpbmRleGVzIHVzZWRcbiAqIGZvciBsb2NhbCBxdWVyeSBleGVjdXRpb24uXG4gKlxuICogVG8gdXNlLCBjYWxsIGBnZXRQZXJzaXN0ZW50Q2FjaGVJbmRleE1hbmFnZXIoKWAgdG8gZ2V0IGFuIGluc3RhbmNlLlxuICovIGNsYXNzIFBlcnNpc3RlbnRDYWNoZUluZGV4TWFuYWdlciB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3RvcihlKSB7XG4gICAgICAgIHRoaXMuX2ZpcmVzdG9yZSA9IGUsIFxuICAgICAgICAvKiogQSB0eXBlIHN0cmluZyB0byB1bmlxdWVseSBpZGVudGlmeSBpbnN0YW5jZXMgb2YgdGhpcyBjbGFzcy4gKi9cbiAgICAgICAgdGhpcy50eXBlID0gXCJQZXJzaXN0ZW50Q2FjaGVJbmRleE1hbmFnZXJcIjtcbiAgICB9XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgUGVyc2lzdGVudENhY2hlIEluZGV4IE1hbmFnZXIgdXNlZCBieSB0aGUgZ2l2ZW4gYEZpcmVzdG9yZWBcbiAqIG9iamVjdC5cbiAqXG4gKiBAcmV0dXJuIFRoZSBgUGVyc2lzdGVudENhY2hlSW5kZXhNYW5hZ2VyYCBpbnN0YW5jZSwgb3IgYG51bGxgIGlmIGxvY2FsXG4gKiBwZXJzaXN0ZW50IHN0b3JhZ2UgaXMgbm90IGluIHVzZS5cbiAqLyBmdW5jdGlvbiBnZXRQZXJzaXN0ZW50Q2FjaGVJbmRleE1hbmFnZXIoZSkge1xuICAgIGUgPSBfX1BSSVZBVEVfY2FzdChlLCBGaXJlc3RvcmUpO1xuICAgIGNvbnN0IHQgPSBFbi5nZXQoZSk7XG4gICAgaWYgKHQpIHJldHVybiB0O1xuICAgIGNvbnN0IG4gPSBlbnN1cmVGaXJlc3RvcmVDb25maWd1cmVkKGUpO1xuICAgIGlmIChcInBlcnNpc3RlbnRcIiAhPT0gbi5fdW5pbml0aWFsaXplZENvbXBvbmVudHNQcm92aWRlcj8uX29mZmxpbmUua2luZCkgcmV0dXJuIG51bGw7XG4gICAgY29uc3QgciA9IG5ldyBQZXJzaXN0ZW50Q2FjaGVJbmRleE1hbmFnZXIoZSk7XG4gICAgcmV0dXJuIEVuLnNldChlLCByKSwgcjtcbn1cblxuLyoqXG4gKiBFbmFibGVzIHRoZSBTREsgdG8gY3JlYXRlIHBlcnNpc3RlbnQgY2FjaGUgaW5kZXhlcyBhdXRvbWF0aWNhbGx5IGZvciBsb2NhbFxuICogcXVlcnkgZXhlY3V0aW9uIHdoZW4gdGhlIFNESyBiZWxpZXZlcyBjYWNoZSBpbmRleGVzIGNhbiBoZWxwIGltcHJvdmVcbiAqIHBlcmZvcm1hbmNlLlxuICpcbiAqIFRoaXMgZmVhdHVyZSBpcyBkaXNhYmxlZCBieSBkZWZhdWx0LlxuICovIGZ1bmN0aW9uIGVuYWJsZVBlcnNpc3RlbnRDYWNoZUluZGV4QXV0b0NyZWF0aW9uKGUpIHtcbiAgICBfX1BSSVZBVEVfc2V0UGVyc2lzdGVudENhY2hlSW5kZXhBdXRvQ3JlYXRpb25FbmFibGVkKGUsICEwKTtcbn1cblxuLyoqXG4gKiBTdG9wcyBjcmVhdGluZyBwZXJzaXN0ZW50IGNhY2hlIGluZGV4ZXMgYXV0b21hdGljYWxseSBmb3IgbG9jYWwgcXVlcnlcbiAqIGV4ZWN1dGlvbi4gVGhlIGluZGV4ZXMgd2hpY2ggaGF2ZSBiZWVuIGNyZWF0ZWQgYnkgY2FsbGluZ1xuICogYGVuYWJsZVBlcnNpc3RlbnRDYWNoZUluZGV4QXV0b0NyZWF0aW9uKClgIHN0aWxsIHRha2UgZWZmZWN0LlxuICovIGZ1bmN0aW9uIGRpc2FibGVQZXJzaXN0ZW50Q2FjaGVJbmRleEF1dG9DcmVhdGlvbihlKSB7XG4gICAgX19QUklWQVRFX3NldFBlcnNpc3RlbnRDYWNoZUluZGV4QXV0b0NyZWF0aW9uRW5hYmxlZChlLCAhMSk7XG59XG5cbi8qKlxuICogUmVtb3ZlcyBhbGwgcGVyc2lzdGVudCBjYWNoZSBpbmRleGVzLlxuICpcbiAqIFBsZWFzZSBub3RlIHRoaXMgZnVuY3Rpb24gd2lsbCBhbHNvIGRlbGV0ZXMgaW5kZXhlcyBnZW5lcmF0ZWQgYnlcbiAqIGBzZXRJbmRleENvbmZpZ3VyYXRpb24oKWAsIHdoaWNoIGlzIGRlcHJlY2F0ZWQuXG4gKi8gZnVuY3Rpb24gZGVsZXRlQWxsUGVyc2lzdGVudENhY2hlSW5kZXhlcyhlKSB7XG4gICAgX19QUklWQVRFX2ZpcmVzdG9yZUNsaWVudERlbGV0ZUFsbEZpZWxkSW5kZXhlcyhlbnN1cmVGaXJlc3RvcmVDb25maWd1cmVkKGUuX2ZpcmVzdG9yZSkpLnRoZW4oKGUgPT4gX19QUklWQVRFX2xvZ0RlYnVnKFwiZGVsZXRpbmcgYWxsIHBlcnNpc3RlbnQgY2FjaGUgaW5kZXhlcyBzdWNjZWVkZWRcIikpKS5jYXRjaCgoZSA9PiBfX1BSSVZBVEVfbG9nV2FybihcImRlbGV0aW5nIGFsbCBwZXJzaXN0ZW50IGNhY2hlIGluZGV4ZXMgZmFpbGVkXCIsIGUpKSk7XG59XG5cbmZ1bmN0aW9uIF9fUFJJVkFURV9zZXRQZXJzaXN0ZW50Q2FjaGVJbmRleEF1dG9DcmVhdGlvbkVuYWJsZWQoZSwgdCkge1xuICAgIF9fUFJJVkFURV9maXJlc3RvcmVDbGllbnRTZXRQZXJzaXN0ZW50Q2FjaGVJbmRleEF1dG9DcmVhdGlvbkVuYWJsZWQoZW5zdXJlRmlyZXN0b3JlQ29uZmlndXJlZChlLl9maXJlc3RvcmUpLCB0KS50aGVuKChlID0+IF9fUFJJVkFURV9sb2dEZWJ1Zyhgc2V0dGluZyBwZXJzaXN0ZW50IGNhY2hlIGluZGV4IGF1dG8gY3JlYXRpb24gaXNFbmFibGVkPSR7dH0gc3VjY2VlZGVkYCkpKS5jYXRjaCgoZSA9PiBfX1BSSVZBVEVfbG9nV2Fybihgc2V0dGluZyBwZXJzaXN0ZW50IGNhY2hlIGluZGV4IGF1dG8gY3JlYXRpb24gaXNFbmFibGVkPSR7dH0gZmFpbGVkYCwgZSkpKTtcbn1cblxuLyoqXG4gKiBNYXBzIGBGaXJlc3RvcmVgIGluc3RhbmNlcyB0byB0aGVpciBjb3JyZXNwb25kaW5nXG4gKiBgUGVyc2lzdGVudENhY2hlSW5kZXhNYW5hZ2VyYCBpbnN0YW5jZXMuXG4gKlxuICogVXNlIGEgYFdlYWtNYXBgIHNvIHRoYXQgdGhlIG1hcHBpbmcgd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGRyb3BwZWQgd2hlbiB0aGVcbiAqIGBGaXJlc3RvcmVgIGluc3RhbmNlIGlzIGdhcmJhZ2UgY29sbGVjdGVkLiBUaGlzIGVtdWxhdGVzIGEgcHJpdmF0ZSBtZW1iZXJcbiAqIGFzIGRlc2NyaWJlZCBpbiBodHRwczovL2dvby5nbGUvNDU0eXZ1Zy5cbiAqLyBjb25zdCBFbiA9IG5ldyBXZWFrTWFwO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqIEBwcml2YXRlXG4gKlxuICogVGhpcyBmdW5jdGlvbiBpcyBmb3IgaW50ZXJuYWwgdXNlIG9ubHkuXG4gKlxuICogUmV0dXJucyB0aGUgYFF1ZXJ5VGFyZ2V0YCByZXByZXNlbnRhdGlvbiBvZiB0aGUgZ2l2ZW4gcXVlcnkuIFJldHVybnMgYG51bGxgXG4gKiBpZiB0aGUgRmlyZXN0b3JlIGNsaWVudCBhc3NvY2lhdGVkIHdpdGggdGhlIGdpdmVuIHF1ZXJ5IGhhcyBub3QgYmVlblxuICogaW5pdGlhbGl6ZWQgb3IgaGFzIGJlZW4gdGVybWluYXRlZC5cbiAqXG4gKiBAcGFyYW0gcXVlcnkgLSBUaGUgUXVlcnkgdG8gY29udmVydCB0byBwcm90byByZXByZXNlbnRhdGlvbi5cbiAqL1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbmZ1bmN0aW9uIF9pbnRlcm5hbFF1ZXJ5VG9Qcm90b1F1ZXJ5VGFyZ2V0KGUpIHtcbiAgICBjb25zdCB0ID0gZW5zdXJlRmlyZXN0b3JlQ29uZmlndXJlZChfX1BSSVZBVEVfY2FzdChlLmZpcmVzdG9yZSwgRmlyZXN0b3JlKSksIG4gPSB0Ll9vbmxpbmVDb21wb25lbnRzPy5kYXRhc3RvcmUuc2VyaWFsaXplcjtcbiAgICByZXR1cm4gdm9pZCAwID09PSBuID8gbnVsbCA6IF9fUFJJVkFURV90b1F1ZXJ5VGFyZ2V0KG4sIF9fUFJJVkFURV9xdWVyeVRvVGFyZ2V0KGUuX3F1ZXJ5KSkuZnQ7XG59XG5cbi8qKlxuICogQGludGVybmFsXG4gKiBAcHJpdmF0ZVxuICpcbiAqIFRoaXMgZnVuY3Rpb24gaXMgZm9yIGludGVybmFsIHVzZSBvbmx5LlxuICpcbiAqIFJldHVybnMgYFJ1bkFnZ3JlZ2F0aW9uUXVlcnlSZXF1ZXN0YCB3aGljaCBjb250YWlucyB0aGUgcHJvdG8gcmVwcmVzZW50YXRpb25cbiAqIG9mIHRoZSBnaXZlbiBhZ2dyZWdhdGlvbiBxdWVyeSByZXF1ZXN0LiBSZXR1cm5zIG51bGwgaWYgdGhlIEZpcmVzdG9yZSBjbGllbnRcbiAqIGFzc29jaWF0ZWQgd2l0aCB0aGUgZ2l2ZW4gcXVlcnkgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkIG9yIGhhcyBiZWVuXG4gKiB0ZXJtaW5hdGVkLlxuICpcbiAqIEBwYXJhbSBxdWVyeSAtIFRoZSBRdWVyeSB0byBjb252ZXJ0IHRvIHByb3RvIHJlcHJlc2VudGF0aW9uLlxuICogQHBhcmFtIGFnZ3JlZ2F0ZVNwZWMgLSBUaGUgc2V0IG9mIGFnZ3JlZ2F0aW9ucyBhbmQgdGhlaXIgYWxpYXNlcy5cbiAqLyBmdW5jdGlvbiBfaW50ZXJuYWxBZ2dyZWdhdGlvblF1ZXJ5VG9Qcm90b1J1bkFnZ3JlZ2F0aW9uUXVlcnlSZXF1ZXN0KGUsIHQpIHtcbiAgICBjb25zdCBuID0gX19QUklWQVRFX21hcFRvQXJyYXkodCwgKChlLCB0KSA9PiBuZXcgX19QUklWQVRFX0FnZ3JlZ2F0ZUltcGwodCwgZS5hZ2dyZWdhdGVUeXBlLCBlLl9pbnRlcm5hbEZpZWxkUGF0aCkpKSwgciA9IGVuc3VyZUZpcmVzdG9yZUNvbmZpZ3VyZWQoX19QUklWQVRFX2Nhc3QoZS5maXJlc3RvcmUsIEZpcmVzdG9yZSkpLCBpID0gci5fb25saW5lQ29tcG9uZW50cz8uZGF0YXN0b3JlLnNlcmlhbGl6ZXI7XG4gICAgcmV0dXJuIHZvaWQgMCA9PT0gaSA/IG51bGwgOiBfX1BSSVZBVEVfdG9SdW5BZ2dyZWdhdGlvblF1ZXJ5UmVxdWVzdChpLCBfX1BSSVZBVEVfcXVlcnlUb0FnZ3JlZ2F0ZVRhcmdldChlLl9xdWVyeSksIG4sIFxuICAgIC8qIHNraXBBbGlhc2luZz0gKi8gITApLnJlcXVlc3Q7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIzIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFRlc3RpbmcgaG9va3MgZm9yIHVzZSBieSBGaXJlc3RvcmUncyBpbnRlZ3JhdGlvbiB0ZXN0IHN1aXRlIHRvIHJlYWNoIGludG8gdGhlXG4gKiBTREsgaW50ZXJuYWxzIHRvIHZhbGlkYXRlIGxvZ2ljIGFuZCBiZWhhdmlvciB0aGF0IGlzIG5vdCB2aXNpYmxlIGZyb20gdGhlXG4gKiBwdWJsaWMgQVBJIHN1cmZhY2UuXG4gKlxuICogQGludGVybmFsXG4gKi8gY2xhc3MgVGVzdGluZ0hvb2tzIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiaW5zdGFuY2VzIG9mIHRoaXMgY2xhc3Mgc2hvdWxkIG5vdCBiZSBjcmVhdGVkXCIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlcnMgYSBjYWxsYmFjayB0byBiZSBub3RpZmllZCB3aGVuIGFuIGV4aXN0ZW5jZSBmaWx0ZXIgbWlzbWF0Y2hcbiAgICAgKiBvY2N1cnMgaW4gdGhlIFdhdGNoIGxpc3RlbiBzdHJlYW0uXG4gICAgICpcbiAgICAgKiBUaGUgcmVsYXRpdmUgb3JkZXIgaW4gd2hpY2ggY2FsbGJhY2tzIGFyZSBub3RpZmllZCBpcyB1bnNwZWNpZmllZDsgZG8gbm90XG4gICAgICogcmVseSBvbiBhbnkgcGFydGljdWxhciBvcmRlcmluZy4gSWYgYSBnaXZlbiBjYWxsYmFjayBpcyByZWdpc3RlcmVkIG11bHRpcGxlXG4gICAgICogdGltZXMgdGhlbiBpdCB3aWxsIGJlIG5vdGlmaWVkIG11bHRpcGxlIHRpbWVzLCBvbmNlIHBlciByZWdpc3RyYXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sgdGhlIGNhbGxiYWNrIHRvIGludm9rZSB1cG9uIGV4aXN0ZW5jZSBmaWx0ZXIgbWlzbWF0Y2guXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIGEgZnVuY3Rpb24gdGhhdCwgd2hlbiBjYWxsZWQsIHVucmVnaXN0ZXJzIHRoZSBnaXZlbiBjYWxsYmFjazsgb25seVxuICAgICAqIHRoZSBmaXJzdCBpbnZvY2F0aW9uIG9mIHRoZSByZXR1cm5lZCBmdW5jdGlvbiBkb2VzIGFueXRoaW5nOyBhbGwgc3Vic2VxdWVudFxuICAgICAqIGludm9jYXRpb25zIGRvIG5vdGhpbmcuXG4gICAgICovICAgIHN0YXRpYyBvbkV4aXN0ZW5jZUZpbHRlck1pc21hdGNoKGUpIHtcbiAgICAgICAgcmV0dXJuIF9fUFJJVkFURV9UZXN0aW5nSG9va3NTcGlJbXBsLmluc3RhbmNlLm9uRXhpc3RlbmNlRmlsdGVyTWlzbWF0Y2goZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFRoZSBpbXBsZW1lbnRhdGlvbiBvZiBgVGVzdGluZ0hvb2tzU3BpYC5cbiAqLyBjbGFzcyBfX1BSSVZBVEVfVGVzdGluZ0hvb2tzU3BpSW1wbCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuTWMgPSBuZXcgTWFwO1xuICAgIH1cbiAgICBzdGF0aWMgZ2V0IGluc3RhbmNlKCkge1xuICAgICAgICByZXR1cm4gZG4gfHwgKGRuID0gbmV3IF9fUFJJVkFURV9UZXN0aW5nSG9va3NTcGlJbXBsLCBmdW5jdGlvbiBfX1BSSVZBVEVfc2V0VGVzdGluZ0hvb2tzU3BpKGUpIHtcbiAgICAgICAgICAgIGlmICh3dCkgdGhyb3cgbmV3IEVycm9yKFwiYSBUZXN0aW5nSG9va3NTcGkgaW5zdGFuY2UgaXMgYWxyZWFkeSBzZXRcIik7XG4gICAgICAgICAgICB3dCA9IGU7XG4gICAgICAgIH0oZG4pKSwgZG47XG4gICAgfVxuICAgIGx0KGUpIHtcbiAgICAgICAgdGhpcy5NYy5mb3JFYWNoKCh0ID0+IHQoZSkpKTtcbiAgICB9XG4gICAgb25FeGlzdGVuY2VGaWx0ZXJNaXNtYXRjaChlKSB7XG4gICAgICAgIGNvbnN0IHQgPSBTeW1ib2woKSwgbiA9IHRoaXMuTWM7XG4gICAgICAgIHJldHVybiBuLnNldCh0LCBlKSwgKCkgPT4gbi5kZWxldGUodCk7XG4gICAgfVxufVxuXG5sZXQgZG4gPSBudWxsO1xuXG4vKipcbiAqIENsb3VkIEZpcmVzdG9yZVxuICpcbiAqIEBwYWNrYWdlRG9jdW1lbnRhdGlvblxuICovICFmdW5jdGlvbiBfX1BSSVZBVEVfcmVnaXN0ZXJGaXJlc3RvcmUoZSwgdCA9ICEwKSB7XG4gICAgIWZ1bmN0aW9uIF9fUFJJVkFURV9zZXRTREtWZXJzaW9uKGUpIHtcbiAgICAgICAgeCA9IGU7XG4gICAgfShTREtfVkVSU0lPTiksIF9yZWdpc3RlckNvbXBvbmVudChuZXcgQ29tcG9uZW50KFwiZmlyZXN0b3JlXCIsICgoZSwge2luc3RhbmNlSWRlbnRpZmllcjogbiwgb3B0aW9uczogcn0pID0+IHtcbiAgICAgICAgY29uc3QgaSA9IGUuZ2V0UHJvdmlkZXIoXCJhcHBcIikuZ2V0SW1tZWRpYXRlKCksIHMgPSBuZXcgRmlyZXN0b3JlKG5ldyBfX1BSSVZBVEVfRmlyZWJhc2VBdXRoQ3JlZGVudGlhbHNQcm92aWRlcihlLmdldFByb3ZpZGVyKFwiYXV0aC1pbnRlcm5hbFwiKSksIG5ldyBfX1BSSVZBVEVfRmlyZWJhc2VBcHBDaGVja1Rva2VuUHJvdmlkZXIoaSwgZS5nZXRQcm92aWRlcihcImFwcC1jaGVjay1pbnRlcm5hbFwiKSksIGZ1bmN0aW9uIF9fUFJJVkFURV9kYXRhYmFzZUlkRnJvbUFwcChlLCB0KSB7XG4gICAgICAgICAgICBpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuYXBwbHkoZS5vcHRpb25zLCBbIFwicHJvamVjdElkXCIgXSkpIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihOLklOVkFMSURfQVJHVU1FTlQsICdcInByb2plY3RJZFwiIG5vdCBwcm92aWRlZCBpbiBmaXJlYmFzZS5pbml0aWFsaXplQXBwLicpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRhYmFzZUlkKGUub3B0aW9ucy5wcm9qZWN0SWQsIHQpO1xuICAgICAgICB9KGksIG4pLCBpKTtcbiAgICAgICAgcmV0dXJuIHIgPSB7XG4gICAgICAgICAgICB1c2VGZXRjaFN0cmVhbXM6IHQsXG4gICAgICAgICAgICAuLi5yXG4gICAgICAgIH0sIHMuX3NldFNldHRpbmdzKHIpLCBzO1xuICAgIH0pLCBcIlBVQkxJQ1wiKS5zZXRNdWx0aXBsZUluc3RhbmNlcyghMCkpLCByZWdpc3RlclZlcnNpb24oRiwgTSwgZSksIFxuICAgIC8vIEJVSUxEX1RBUkdFVCB3aWxsIGJlIHJlcGxhY2VkIGJ5IHZhbHVlcyBsaWtlIGVzbSwgY2pzLCBldGMgZHVyaW5nIHRoZSBjb21waWxhdGlvblxuICAgIHJlZ2lzdGVyVmVyc2lvbihGLCBNLCBcImVzbTIwMjBcIik7XG59KCk7XG5cbmV4cG9ydCB7IEFic3RyYWN0VXNlckRhdGFXcml0ZXIsIEFnZ3JlZ2F0ZUZpZWxkLCBBZ2dyZWdhdGVRdWVyeVNuYXBzaG90LCBCeXRlcywgbG4gYXMgQ0FDSEVfU0laRV9VTkxJTUlURUQsIENvbGxlY3Rpb25SZWZlcmVuY2UsIERvY3VtZW50UmVmZXJlbmNlLCBEb2N1bWVudFNuYXBzaG90LCBGaWVsZFBhdGgsIEZpZWxkVmFsdWUsIEZpcmVzdG9yZSwgRmlyZXN0b3JlRXJyb3IsIEdlb1BvaW50LCBMb2FkQnVuZGxlVGFzaywgUGVyc2lzdGVudENhY2hlSW5kZXhNYW5hZ2VyLCBRdWVyeSwgUXVlcnlDb21wb3NpdGVGaWx0ZXJDb25zdHJhaW50LCBRdWVyeUNvbnN0cmFpbnQsIFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdCwgUXVlcnlFbmRBdENvbnN0cmFpbnQsIFF1ZXJ5RmllbGRGaWx0ZXJDb25zdHJhaW50LCBRdWVyeUxpbWl0Q29uc3RyYWludCwgUXVlcnlPcmRlckJ5Q29uc3RyYWludCwgUXVlcnlTbmFwc2hvdCwgUXVlcnlTdGFydEF0Q29uc3RyYWludCwgU25hcHNob3RNZXRhZGF0YSwgVGltZXN0YW1wLCBUcmFuc2FjdGlvbiwgVmVjdG9yVmFsdWUsIFdyaXRlQmF0Y2gsIF9fUFJJVkFURV9BdXRvSWQgYXMgX0F1dG9JZCwgQnl0ZVN0cmluZyBhcyBfQnl0ZVN0cmluZywgRGF0YWJhc2VJZCBhcyBfRGF0YWJhc2VJZCwgRG9jdW1lbnRLZXkgYXMgX0RvY3VtZW50S2V5LCBfX1BSSVZBVEVfRW1wdHlBcHBDaGVja1Rva2VuUHJvdmlkZXIgYXMgX0VtcHR5QXBwQ2hlY2tUb2tlblByb3ZpZGVyLCBfX1BSSVZBVEVfRW1wdHlBdXRoQ3JlZGVudGlhbHNQcm92aWRlciBhcyBfRW1wdHlBdXRoQ3JlZGVudGlhbHNQcm92aWRlciwgRmllbGRQYXRoJDEgYXMgX0ZpZWxkUGF0aCwgVGVzdGluZ0hvb2tzIGFzIF9UZXN0aW5nSG9va3MsIF9fUFJJVkFURV9jYXN0IGFzIF9jYXN0LCBfX1BSSVZBVEVfZGVidWdBc3NlcnQgYXMgX2RlYnVnQXNzZXJ0LCBfaW50ZXJuYWxBZ2dyZWdhdGlvblF1ZXJ5VG9Qcm90b1J1bkFnZ3JlZ2F0aW9uUXVlcnlSZXF1ZXN0LCBfaW50ZXJuYWxRdWVyeVRvUHJvdG9RdWVyeVRhcmdldCwgX19QUklWQVRFX2lzQmFzZTY0QXZhaWxhYmxlIGFzIF9pc0Jhc2U2NEF2YWlsYWJsZSwgX19QUklWQVRFX2xvZ1dhcm4gYXMgX2xvZ1dhcm4sIF9fUFJJVkFURV92YWxpZGF0ZUlzTm90VXNlZFRvZ2V0aGVyIGFzIF92YWxpZGF0ZUlzTm90VXNlZFRvZ2V0aGVyLCBhZGREb2MsIGFnZ3JlZ2F0ZUZpZWxkRXF1YWwsIGFnZ3JlZ2F0ZVF1ZXJ5U25hcHNob3RFcXVhbCwgYW5kLCBhcnJheVJlbW92ZSwgYXJyYXlVbmlvbiwgYXZlcmFnZSwgY2xlYXJJbmRleGVkRGJQZXJzaXN0ZW5jZSwgY29sbGVjdGlvbiwgY29sbGVjdGlvbkdyb3VwLCBjb25uZWN0RmlyZXN0b3JlRW11bGF0b3IsIGNvdW50LCBkZWxldGVBbGxQZXJzaXN0ZW50Q2FjaGVJbmRleGVzLCBkZWxldGVEb2MsIGRlbGV0ZUZpZWxkLCBkaXNhYmxlTmV0d29yaywgZGlzYWJsZVBlcnNpc3RlbnRDYWNoZUluZGV4QXV0b0NyZWF0aW9uLCBkb2MsIGRvY3VtZW50SWQsIGRvY3VtZW50U25hcHNob3RGcm9tSlNPTiwgZW5hYmxlSW5kZXhlZERiUGVyc2lzdGVuY2UsIGVuYWJsZU11bHRpVGFiSW5kZXhlZERiUGVyc2lzdGVuY2UsIGVuYWJsZU5ldHdvcmssIGVuYWJsZVBlcnNpc3RlbnRDYWNoZUluZGV4QXV0b0NyZWF0aW9uLCBlbmRBdCwgZW5kQmVmb3JlLCBlbnN1cmVGaXJlc3RvcmVDb25maWd1cmVkLCBleGVjdXRlV3JpdGUsIGdldEFnZ3JlZ2F0ZUZyb21TZXJ2ZXIsIGdldENvdW50RnJvbVNlcnZlciwgZ2V0RG9jLCBnZXREb2NGcm9tQ2FjaGUsIGdldERvY0Zyb21TZXJ2ZXIsIGdldERvY3MsIGdldERvY3NGcm9tQ2FjaGUsIGdldERvY3NGcm9tU2VydmVyLCBnZXRGaXJlc3RvcmUsIGdldFBlcnNpc3RlbnRDYWNoZUluZGV4TWFuYWdlciwgaW5jcmVtZW50LCBpbml0aWFsaXplRmlyZXN0b3JlLCBsaW1pdCwgbGltaXRUb0xhc3QsIGxvYWRCdW5kbGUsIG1lbW9yeUVhZ2VyR2FyYmFnZUNvbGxlY3RvciwgbWVtb3J5TG9jYWxDYWNoZSwgbWVtb3J5THJ1R2FyYmFnZUNvbGxlY3RvciwgbmFtZWRRdWVyeSwgb25TbmFwc2hvdCwgb25TbmFwc2hvdFJlc3VtZSwgb25TbmFwc2hvdHNJblN5bmMsIG9yLCBvcmRlckJ5LCBwZXJzaXN0ZW50TG9jYWxDYWNoZSwgcGVyc2lzdGVudE11bHRpcGxlVGFiTWFuYWdlciwgcGVyc2lzdGVudFNpbmdsZVRhYk1hbmFnZXIsIHF1ZXJ5LCBxdWVyeUVxdWFsLCBxdWVyeVNuYXBzaG90RnJvbUpTT04sIHJlZkVxdWFsLCBydW5UcmFuc2FjdGlvbiwgc2VydmVyVGltZXN0YW1wLCBzZXREb2MsIHNldEluZGV4Q29uZmlndXJhdGlvbiwgc2V0TG9nTGV2ZWwsIHNuYXBzaG90RXF1YWwsIHN0YXJ0QWZ0ZXIsIHN0YXJ0QXQsIHN1bSwgdGVybWluYXRlLCB1cGRhdGVEb2MsIHZlY3Rvciwgd2FpdEZvclBlbmRpbmdXcml0ZXMsIHdoZXJlLCB3cml0ZUJhdGNoIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5lc20uanMubWFwXG4iLCJjb25zdCBpbnN0YW5jZU9mQW55ID0gKG9iamVjdCwgY29uc3RydWN0b3JzKSA9PiBjb25zdHJ1Y3RvcnMuc29tZSgoYykgPT4gb2JqZWN0IGluc3RhbmNlb2YgYyk7XG5cbmxldCBpZGJQcm94eWFibGVUeXBlcztcbmxldCBjdXJzb3JBZHZhbmNlTWV0aG9kcztcbi8vIFRoaXMgaXMgYSBmdW5jdGlvbiB0byBwcmV2ZW50IGl0IHRocm93aW5nIHVwIGluIG5vZGUgZW52aXJvbm1lbnRzLlxuZnVuY3Rpb24gZ2V0SWRiUHJveHlhYmxlVHlwZXMoKSB7XG4gICAgcmV0dXJuIChpZGJQcm94eWFibGVUeXBlcyB8fFxuICAgICAgICAoaWRiUHJveHlhYmxlVHlwZXMgPSBbXG4gICAgICAgICAgICBJREJEYXRhYmFzZSxcbiAgICAgICAgICAgIElEQk9iamVjdFN0b3JlLFxuICAgICAgICAgICAgSURCSW5kZXgsXG4gICAgICAgICAgICBJREJDdXJzb3IsXG4gICAgICAgICAgICBJREJUcmFuc2FjdGlvbixcbiAgICAgICAgXSkpO1xufVxuLy8gVGhpcyBpcyBhIGZ1bmN0aW9uIHRvIHByZXZlbnQgaXQgdGhyb3dpbmcgdXAgaW4gbm9kZSBlbnZpcm9ubWVudHMuXG5mdW5jdGlvbiBnZXRDdXJzb3JBZHZhbmNlTWV0aG9kcygpIHtcbiAgICByZXR1cm4gKGN1cnNvckFkdmFuY2VNZXRob2RzIHx8XG4gICAgICAgIChjdXJzb3JBZHZhbmNlTWV0aG9kcyA9IFtcbiAgICAgICAgICAgIElEQkN1cnNvci5wcm90b3R5cGUuYWR2YW5jZSxcbiAgICAgICAgICAgIElEQkN1cnNvci5wcm90b3R5cGUuY29udGludWUsXG4gICAgICAgICAgICBJREJDdXJzb3IucHJvdG90eXBlLmNvbnRpbnVlUHJpbWFyeUtleSxcbiAgICAgICAgXSkpO1xufVxuY29uc3QgY3Vyc29yUmVxdWVzdE1hcCA9IG5ldyBXZWFrTWFwKCk7XG5jb25zdCB0cmFuc2FjdGlvbkRvbmVNYXAgPSBuZXcgV2Vha01hcCgpO1xuY29uc3QgdHJhbnNhY3Rpb25TdG9yZU5hbWVzTWFwID0gbmV3IFdlYWtNYXAoKTtcbmNvbnN0IHRyYW5zZm9ybUNhY2hlID0gbmV3IFdlYWtNYXAoKTtcbmNvbnN0IHJldmVyc2VUcmFuc2Zvcm1DYWNoZSA9IG5ldyBXZWFrTWFwKCk7XG5mdW5jdGlvbiBwcm9taXNpZnlSZXF1ZXN0KHJlcXVlc3QpIHtcbiAgICBjb25zdCBwcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBjb25zdCB1bmxpc3RlbiA9ICgpID0+IHtcbiAgICAgICAgICAgIHJlcXVlc3QucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3VjY2VzcycsIHN1Y2Nlc3MpO1xuICAgICAgICAgICAgcmVxdWVzdC5yZW1vdmVFdmVudExpc3RlbmVyKCdlcnJvcicsIGVycm9yKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgc3VjY2VzcyA9ICgpID0+IHtcbiAgICAgICAgICAgIHJlc29sdmUod3JhcChyZXF1ZXN0LnJlc3VsdCkpO1xuICAgICAgICAgICAgdW5saXN0ZW4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZXJyb3IgPSAoKSA9PiB7XG4gICAgICAgICAgICByZWplY3QocmVxdWVzdC5lcnJvcik7XG4gICAgICAgICAgICB1bmxpc3RlbigpO1xuICAgICAgICB9O1xuICAgICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Y2Nlc3MnLCBzdWNjZXNzKTtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGVycm9yKTtcbiAgICB9KTtcbiAgICBwcm9taXNlXG4gICAgICAgIC50aGVuKCh2YWx1ZSkgPT4ge1xuICAgICAgICAvLyBTaW5jZSBjdXJzb3JpbmcgcmV1c2VzIHRoZSBJREJSZXF1ZXN0ICgqc2lnaCopLCB3ZSBjYWNoZSBpdCBmb3IgbGF0ZXIgcmV0cmlldmFsXG4gICAgICAgIC8vIChzZWUgd3JhcEZ1bmN0aW9uKS5cbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURCQ3Vyc29yKSB7XG4gICAgICAgICAgICBjdXJzb3JSZXF1ZXN0TWFwLnNldCh2YWx1ZSwgcmVxdWVzdCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQ2F0Y2hpbmcgdG8gYXZvaWQgXCJVbmNhdWdodCBQcm9taXNlIGV4Y2VwdGlvbnNcIlxuICAgIH0pXG4gICAgICAgIC5jYXRjaCgoKSA9PiB7IH0pO1xuICAgIC8vIFRoaXMgbWFwcGluZyBleGlzdHMgaW4gcmV2ZXJzZVRyYW5zZm9ybUNhY2hlIGJ1dCBkb2Vzbid0IGRvZXNuJ3QgZXhpc3QgaW4gdHJhbnNmb3JtQ2FjaGUuIFRoaXNcbiAgICAvLyBpcyBiZWNhdXNlIHdlIGNyZWF0ZSBtYW55IHByb21pc2VzIGZyb20gYSBzaW5nbGUgSURCUmVxdWVzdC5cbiAgICByZXZlcnNlVHJhbnNmb3JtQ2FjaGUuc2V0KHByb21pc2UsIHJlcXVlc3QpO1xuICAgIHJldHVybiBwcm9taXNlO1xufVxuZnVuY3Rpb24gY2FjaGVEb25lUHJvbWlzZUZvclRyYW5zYWN0aW9uKHR4KSB7XG4gICAgLy8gRWFybHkgYmFpbCBpZiB3ZSd2ZSBhbHJlYWR5IGNyZWF0ZWQgYSBkb25lIHByb21pc2UgZm9yIHRoaXMgdHJhbnNhY3Rpb24uXG4gICAgaWYgKHRyYW5zYWN0aW9uRG9uZU1hcC5oYXModHgpKVxuICAgICAgICByZXR1cm47XG4gICAgY29uc3QgZG9uZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgY29uc3QgdW5saXN0ZW4gPSAoKSA9PiB7XG4gICAgICAgICAgICB0eC5yZW1vdmVFdmVudExpc3RlbmVyKCdjb21wbGV0ZScsIGNvbXBsZXRlKTtcbiAgICAgICAgICAgIHR4LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZXJyb3IpO1xuICAgICAgICAgICAgdHgucmVtb3ZlRXZlbnRMaXN0ZW5lcignYWJvcnQnLCBlcnJvcik7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGNvbXBsZXRlID0gKCkgPT4ge1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgdW5saXN0ZW4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZXJyb3IgPSAoKSA9PiB7XG4gICAgICAgICAgICByZWplY3QodHguZXJyb3IgfHwgbmV3IERPTUV4Y2VwdGlvbignQWJvcnRFcnJvcicsICdBYm9ydEVycm9yJykpO1xuICAgICAgICAgICAgdW5saXN0ZW4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgdHguYWRkRXZlbnRMaXN0ZW5lcignY29tcGxldGUnLCBjb21wbGV0ZSk7XG4gICAgICAgIHR4LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZXJyb3IpO1xuICAgICAgICB0eC5hZGRFdmVudExpc3RlbmVyKCdhYm9ydCcsIGVycm9yKTtcbiAgICB9KTtcbiAgICAvLyBDYWNoZSBpdCBmb3IgbGF0ZXIgcmV0cmlldmFsLlxuICAgIHRyYW5zYWN0aW9uRG9uZU1hcC5zZXQodHgsIGRvbmUpO1xufVxubGV0IGlkYlByb3h5VHJhcHMgPSB7XG4gICAgZ2V0KHRhcmdldCwgcHJvcCwgcmVjZWl2ZXIpIHtcbiAgICAgICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIElEQlRyYW5zYWN0aW9uKSB7XG4gICAgICAgICAgICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciB0cmFuc2FjdGlvbi5kb25lLlxuICAgICAgICAgICAgaWYgKHByb3AgPT09ICdkb25lJylcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb25Eb25lTWFwLmdldCh0YXJnZXQpO1xuICAgICAgICAgICAgLy8gUG9seWZpbGwgZm9yIG9iamVjdFN0b3JlTmFtZXMgYmVjYXVzZSBvZiBFZGdlLlxuICAgICAgICAgICAgaWYgKHByb3AgPT09ICdvYmplY3RTdG9yZU5hbWVzJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXQub2JqZWN0U3RvcmVOYW1lcyB8fCB0cmFuc2FjdGlvblN0b3JlTmFtZXNNYXAuZ2V0KHRhcmdldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBNYWtlIHR4LnN0b3JlIHJldHVybiB0aGUgb25seSBzdG9yZSBpbiB0aGUgdHJhbnNhY3Rpb24sIG9yIHVuZGVmaW5lZCBpZiB0aGVyZSBhcmUgbWFueS5cbiAgICAgICAgICAgIGlmIChwcm9wID09PSAnc3RvcmUnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlY2VpdmVyLm9iamVjdFN0b3JlTmFtZXNbMV1cbiAgICAgICAgICAgICAgICAgICAgPyB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgOiByZWNlaXZlci5vYmplY3RTdG9yZShyZWNlaXZlci5vYmplY3RTdG9yZU5hbWVzWzBdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBFbHNlIHRyYW5zZm9ybSB3aGF0ZXZlciB3ZSBnZXQgYmFjay5cbiAgICAgICAgcmV0dXJuIHdyYXAodGFyZ2V0W3Byb3BdKTtcbiAgICB9LFxuICAgIHNldCh0YXJnZXQsIHByb3AsIHZhbHVlKSB7XG4gICAgICAgIHRhcmdldFtwcm9wXSA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIGhhcyh0YXJnZXQsIHByb3ApIHtcbiAgICAgICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIElEQlRyYW5zYWN0aW9uICYmXG4gICAgICAgICAgICAocHJvcCA9PT0gJ2RvbmUnIHx8IHByb3AgPT09ICdzdG9yZScpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJvcCBpbiB0YXJnZXQ7XG4gICAgfSxcbn07XG5mdW5jdGlvbiByZXBsYWNlVHJhcHMoY2FsbGJhY2spIHtcbiAgICBpZGJQcm94eVRyYXBzID0gY2FsbGJhY2soaWRiUHJveHlUcmFwcyk7XG59XG5mdW5jdGlvbiB3cmFwRnVuY3Rpb24oZnVuYykge1xuICAgIC8vIER1ZSB0byBleHBlY3RlZCBvYmplY3QgZXF1YWxpdHkgKHdoaWNoIGlzIGVuZm9yY2VkIGJ5IHRoZSBjYWNoaW5nIGluIGB3cmFwYCksIHdlXG4gICAgLy8gb25seSBjcmVhdGUgb25lIG5ldyBmdW5jIHBlciBmdW5jLlxuICAgIC8vIEVkZ2UgZG9lc24ndCBzdXBwb3J0IG9iamVjdFN0b3JlTmFtZXMgKGJvb28pLCBzbyB3ZSBwb2x5ZmlsbCBpdCBoZXJlLlxuICAgIGlmIChmdW5jID09PSBJREJEYXRhYmFzZS5wcm90b3R5cGUudHJhbnNhY3Rpb24gJiZcbiAgICAgICAgISgnb2JqZWN0U3RvcmVOYW1lcycgaW4gSURCVHJhbnNhY3Rpb24ucHJvdG90eXBlKSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHN0b3JlTmFtZXMsIC4uLmFyZ3MpIHtcbiAgICAgICAgICAgIGNvbnN0IHR4ID0gZnVuYy5jYWxsKHVud3JhcCh0aGlzKSwgc3RvcmVOYW1lcywgLi4uYXJncyk7XG4gICAgICAgICAgICB0cmFuc2FjdGlvblN0b3JlTmFtZXNNYXAuc2V0KHR4LCBzdG9yZU5hbWVzLnNvcnQgPyBzdG9yZU5hbWVzLnNvcnQoKSA6IFtzdG9yZU5hbWVzXSk7XG4gICAgICAgICAgICByZXR1cm4gd3JhcCh0eCk7XG4gICAgICAgIH07XG4gICAgfVxuICAgIC8vIEN1cnNvciBtZXRob2RzIGFyZSBzcGVjaWFsLCBhcyB0aGUgYmVoYXZpb3VyIGlzIGEgbGl0dGxlIG1vcmUgZGlmZmVyZW50IHRvIHN0YW5kYXJkIElEQi4gSW5cbiAgICAvLyBJREIsIHlvdSBhZHZhbmNlIHRoZSBjdXJzb3IgYW5kIHdhaXQgZm9yIGEgbmV3ICdzdWNjZXNzJyBvbiB0aGUgSURCUmVxdWVzdCB0aGF0IGdhdmUgeW91IHRoZVxuICAgIC8vIGN1cnNvci4gSXQncyBraW5kYSBsaWtlIGEgcHJvbWlzZSB0aGF0IGNhbiByZXNvbHZlIHdpdGggbWFueSB2YWx1ZXMuIFRoYXQgZG9lc24ndCBtYWtlIHNlbnNlXG4gICAgLy8gd2l0aCByZWFsIHByb21pc2VzLCBzbyBlYWNoIGFkdmFuY2UgbWV0aG9kcyByZXR1cm5zIGEgbmV3IHByb21pc2UgZm9yIHRoZSBjdXJzb3Igb2JqZWN0LCBvclxuICAgIC8vIHVuZGVmaW5lZCBpZiB0aGUgZW5kIG9mIHRoZSBjdXJzb3IgaGFzIGJlZW4gcmVhY2hlZC5cbiAgICBpZiAoZ2V0Q3Vyc29yQWR2YW5jZU1ldGhvZHMoKS5pbmNsdWRlcyhmdW5jKSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKC4uLmFyZ3MpIHtcbiAgICAgICAgICAgIC8vIENhbGxpbmcgdGhlIG9yaWdpbmFsIGZ1bmN0aW9uIHdpdGggdGhlIHByb3h5IGFzICd0aGlzJyBjYXVzZXMgSUxMRUdBTCBJTlZPQ0FUSU9OLCBzbyB3ZSB1c2VcbiAgICAgICAgICAgIC8vIHRoZSBvcmlnaW5hbCBvYmplY3QuXG4gICAgICAgICAgICBmdW5jLmFwcGx5KHVud3JhcCh0aGlzKSwgYXJncyk7XG4gICAgICAgICAgICByZXR1cm4gd3JhcChjdXJzb3JSZXF1ZXN0TWFwLmdldCh0aGlzKSk7XG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBmdW5jdGlvbiAoLi4uYXJncykge1xuICAgICAgICAvLyBDYWxsaW5nIHRoZSBvcmlnaW5hbCBmdW5jdGlvbiB3aXRoIHRoZSBwcm94eSBhcyAndGhpcycgY2F1c2VzIElMTEVHQUwgSU5WT0NBVElPTiwgc28gd2UgdXNlXG4gICAgICAgIC8vIHRoZSBvcmlnaW5hbCBvYmplY3QuXG4gICAgICAgIHJldHVybiB3cmFwKGZ1bmMuYXBwbHkodW53cmFwKHRoaXMpLCBhcmdzKSk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHRyYW5zZm9ybUNhY2hhYmxlVmFsdWUodmFsdWUpIHtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKVxuICAgICAgICByZXR1cm4gd3JhcEZ1bmN0aW9uKHZhbHVlKTtcbiAgICAvLyBUaGlzIGRvZXNuJ3QgcmV0dXJuLCBpdCBqdXN0IGNyZWF0ZXMgYSAnZG9uZScgcHJvbWlzZSBmb3IgdGhlIHRyYW5zYWN0aW9uLFxuICAgIC8vIHdoaWNoIGlzIGxhdGVyIHJldHVybmVkIGZvciB0cmFuc2FjdGlvbi5kb25lIChzZWUgaWRiT2JqZWN0SGFuZGxlcikuXG4gICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURCVHJhbnNhY3Rpb24pXG4gICAgICAgIGNhY2hlRG9uZVByb21pc2VGb3JUcmFuc2FjdGlvbih2YWx1ZSk7XG4gICAgaWYgKGluc3RhbmNlT2ZBbnkodmFsdWUsIGdldElkYlByb3h5YWJsZVR5cGVzKCkpKVxuICAgICAgICByZXR1cm4gbmV3IFByb3h5KHZhbHVlLCBpZGJQcm94eVRyYXBzKTtcbiAgICAvLyBSZXR1cm4gdGhlIHNhbWUgdmFsdWUgYmFjayBpZiB3ZSdyZSBub3QgZ29pbmcgdG8gdHJhbnNmb3JtIGl0LlxuICAgIHJldHVybiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIHdyYXAodmFsdWUpIHtcbiAgICAvLyBXZSBzb21ldGltZXMgZ2VuZXJhdGUgbXVsdGlwbGUgcHJvbWlzZXMgZnJvbSBhIHNpbmdsZSBJREJSZXF1ZXN0IChlZyB3aGVuIGN1cnNvcmluZyksIGJlY2F1c2VcbiAgICAvLyBJREIgaXMgd2VpcmQgYW5kIGEgc2luZ2xlIElEQlJlcXVlc3QgY2FuIHlpZWxkIG1hbnkgcmVzcG9uc2VzLCBzbyB0aGVzZSBjYW4ndCBiZSBjYWNoZWQuXG4gICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURCUmVxdWVzdClcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3QodmFsdWUpO1xuICAgIC8vIElmIHdlJ3ZlIGFscmVhZHkgdHJhbnNmb3JtZWQgdGhpcyB2YWx1ZSBiZWZvcmUsIHJldXNlIHRoZSB0cmFuc2Zvcm1lZCB2YWx1ZS5cbiAgICAvLyBUaGlzIGlzIGZhc3RlciwgYnV0IGl0IGFsc28gcHJvdmlkZXMgb2JqZWN0IGVxdWFsaXR5LlxuICAgIGlmICh0cmFuc2Zvcm1DYWNoZS5oYXModmFsdWUpKVxuICAgICAgICByZXR1cm4gdHJhbnNmb3JtQ2FjaGUuZ2V0KHZhbHVlKTtcbiAgICBjb25zdCBuZXdWYWx1ZSA9IHRyYW5zZm9ybUNhY2hhYmxlVmFsdWUodmFsdWUpO1xuICAgIC8vIE5vdCBhbGwgdHlwZXMgYXJlIHRyYW5zZm9ybWVkLlxuICAgIC8vIFRoZXNlIG1heSBiZSBwcmltaXRpdmUgdHlwZXMsIHNvIHRoZXkgY2FuJ3QgYmUgV2Vha01hcCBrZXlzLlxuICAgIGlmIChuZXdWYWx1ZSAhPT0gdmFsdWUpIHtcbiAgICAgICAgdHJhbnNmb3JtQ2FjaGUuc2V0KHZhbHVlLCBuZXdWYWx1ZSk7XG4gICAgICAgIHJldmVyc2VUcmFuc2Zvcm1DYWNoZS5zZXQobmV3VmFsdWUsIHZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ld1ZhbHVlO1xufVxuY29uc3QgdW53cmFwID0gKHZhbHVlKSA9PiByZXZlcnNlVHJhbnNmb3JtQ2FjaGUuZ2V0KHZhbHVlKTtcblxuZXhwb3J0IHsgcmV2ZXJzZVRyYW5zZm9ybUNhY2hlIGFzIGEsIGluc3RhbmNlT2ZBbnkgYXMgaSwgcmVwbGFjZVRyYXBzIGFzIHIsIHVud3JhcCBhcyB1LCB3cmFwIGFzIHcgfTtcbiIsImltcG9ydCB7IFNES19WRVJTSU9OLCBfaXNGaXJlYmFzZVNlcnZlckFwcCwgX2dldFByb3ZpZGVyLCBfcmVnaXN0ZXJDb21wb25lbnQsIHJlZ2lzdGVyVmVyc2lvbiwgZ2V0QXBwIH0gZnJvbSAnQGZpcmViYXNlL2FwcCc7XG5pbXBvcnQgeyBFcnJvckZhY3RvcnksIGlzQnJvd3NlckV4dGVuc2lvbiwgaXNNb2JpbGVDb3Jkb3ZhLCBpc1JlYWN0TmF0aXZlLCBGaXJlYmFzZUVycm9yLCBxdWVyeXN0cmluZywgaXNDbG91ZGZsYXJlV29ya2VyLCBpc0Nsb3VkV29ya3N0YXRpb24sIGdldE1vZHVsYXJJbnN0YW5jZSwgYmFzZTY0RGVjb2RlLCBnZXRVQSwgaXNJRSwgY3JlYXRlU3Vic2NyaWJlLCBkZWVwRXF1YWwsIHBpbmdTZXJ2ZXIsIHVwZGF0ZUVtdWxhdG9yQmFubmVyLCBxdWVyeXN0cmluZ0RlY29kZSwgZXh0cmFjdFF1ZXJ5c3RyaW5nLCBpc0VtcHR5LCBnZXRFeHBlcmltZW50YWxTZXR0aW5nLCBnZXREZWZhdWx0RW11bGF0b3JIb3N0IH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuaW1wb3J0IHsgTG9nZ2VyLCBMb2dMZXZlbCB9IGZyb20gJ0BmaXJlYmFzZS9sb2dnZXInO1xuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnQGZpcmViYXNlL2NvbXBvbmVudCc7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIxIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEFuIGVudW0gb2YgZmFjdG9ycyB0aGF0IG1heSBiZSB1c2VkIGZvciBtdWx0aWZhY3RvciBhdXRoZW50aWNhdGlvbi5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmNvbnN0IEZhY3RvcklkID0ge1xuICAgIC8qKiBQaG9uZSBhcyBzZWNvbmQgZmFjdG9yICovXG4gICAgUEhPTkU6ICdwaG9uZScsXG4gICAgVE9UUDogJ3RvdHAnXG59O1xuLyoqXG4gKiBFbnVtZXJhdGlvbiBvZiBzdXBwb3J0ZWQgcHJvdmlkZXJzLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuY29uc3QgUHJvdmlkZXJJZCA9IHtcbiAgICAvKiogRmFjZWJvb2sgcHJvdmlkZXIgSUQgKi9cbiAgICBGQUNFQk9PSzogJ2ZhY2Vib29rLmNvbScsXG4gICAgLyoqIEdpdEh1YiBwcm92aWRlciBJRCAqL1xuICAgIEdJVEhVQjogJ2dpdGh1Yi5jb20nLFxuICAgIC8qKiBHb29nbGUgcHJvdmlkZXIgSUQgKi9cbiAgICBHT09HTEU6ICdnb29nbGUuY29tJyxcbiAgICAvKiogUGFzc3dvcmQgcHJvdmlkZXIgKi9cbiAgICBQQVNTV09SRDogJ3Bhc3N3b3JkJyxcbiAgICAvKiogUGhvbmUgcHJvdmlkZXIgKi9cbiAgICBQSE9ORTogJ3Bob25lJyxcbiAgICAvKiogVHdpdHRlciBwcm92aWRlciBJRCAqL1xuICAgIFRXSVRURVI6ICd0d2l0dGVyLmNvbSdcbn07XG4vKipcbiAqIEVudW1lcmF0aW9uIG9mIHN1cHBvcnRlZCBzaWduLWluIG1ldGhvZHMuXG4gKlxuICogQHB1YmxpY1xuICovXG5jb25zdCBTaWduSW5NZXRob2QgPSB7XG4gICAgLyoqIEVtYWlsIGxpbmsgc2lnbiBpbiBtZXRob2QgKi9cbiAgICBFTUFJTF9MSU5LOiAnZW1haWxMaW5rJyxcbiAgICAvKiogRW1haWwvcGFzc3dvcmQgc2lnbiBpbiBtZXRob2QgKi9cbiAgICBFTUFJTF9QQVNTV09SRDogJ3Bhc3N3b3JkJyxcbiAgICAvKiogRmFjZWJvb2sgc2lnbiBpbiBtZXRob2QgKi9cbiAgICBGQUNFQk9PSzogJ2ZhY2Vib29rLmNvbScsXG4gICAgLyoqIEdpdEh1YiBzaWduIGluIG1ldGhvZCAqL1xuICAgIEdJVEhVQjogJ2dpdGh1Yi5jb20nLFxuICAgIC8qKiBHb29nbGUgc2lnbiBpbiBtZXRob2QgKi9cbiAgICBHT09HTEU6ICdnb29nbGUuY29tJyxcbiAgICAvKiogUGhvbmUgc2lnbiBpbiBtZXRob2QgKi9cbiAgICBQSE9ORTogJ3Bob25lJyxcbiAgICAvKiogVHdpdHRlciBzaWduIGluIG1ldGhvZCAqL1xuICAgIFRXSVRURVI6ICd0d2l0dGVyLmNvbSdcbn07XG4vKipcbiAqIEVudW1lcmF0aW9uIG9mIHN1cHBvcnRlZCBvcGVyYXRpb24gdHlwZXMuXG4gKlxuICogQHB1YmxpY1xuICovXG5jb25zdCBPcGVyYXRpb25UeXBlID0ge1xuICAgIC8qKiBPcGVyYXRpb24gaW52b2x2aW5nIGxpbmtpbmcgYW4gYWRkaXRpb25hbCBwcm92aWRlciB0byBhbiBhbHJlYWR5IHNpZ25lZC1pbiB1c2VyLiAqL1xuICAgIExJTks6ICdsaW5rJyxcbiAgICAvKiogT3BlcmF0aW9uIGludm9sdmluZyB1c2luZyBhIHByb3ZpZGVyIHRvIHJlYXV0aGVudGljYXRlIGFuIGFscmVhZHkgc2lnbmVkLWluIHVzZXIuICovXG4gICAgUkVBVVRIRU5USUNBVEU6ICdyZWF1dGhlbnRpY2F0ZScsXG4gICAgLyoqIE9wZXJhdGlvbiBpbnZvbHZpbmcgc2lnbmluZyBpbiBhIHVzZXIuICovXG4gICAgU0lHTl9JTjogJ3NpZ25Jbidcbn07XG4vKipcbiAqIEFuIGVudW1lcmF0aW9uIG9mIHRoZSBwb3NzaWJsZSBlbWFpbCBhY3Rpb24gdHlwZXMuXG4gKlxuICogQHB1YmxpY1xuICovXG5jb25zdCBBY3Rpb25Db2RlT3BlcmF0aW9uID0ge1xuICAgIC8qKiBUaGUgZW1haWwgbGluayBzaWduLWluIGFjdGlvbi4gKi9cbiAgICBFTUFJTF9TSUdOSU46ICdFTUFJTF9TSUdOSU4nLFxuICAgIC8qKiBUaGUgcGFzc3dvcmQgcmVzZXQgYWN0aW9uLiAqL1xuICAgIFBBU1NXT1JEX1JFU0VUOiAnUEFTU1dPUkRfUkVTRVQnLFxuICAgIC8qKiBUaGUgZW1haWwgcmV2b2NhdGlvbiBhY3Rpb24uICovXG4gICAgUkVDT1ZFUl9FTUFJTDogJ1JFQ09WRVJfRU1BSUwnLFxuICAgIC8qKiBUaGUgcmV2ZXJ0IHNlY29uZCBmYWN0b3IgYWRkaXRpb24gZW1haWwgYWN0aW9uLiAqL1xuICAgIFJFVkVSVF9TRUNPTkRfRkFDVE9SX0FERElUSU9OOiAnUkVWRVJUX1NFQ09ORF9GQUNUT1JfQURESVRJT04nLFxuICAgIC8qKiBUaGUgcmV2ZXJ0IHNlY29uZCBmYWN0b3IgYWRkaXRpb24gZW1haWwgYWN0aW9uLiAqL1xuICAgIFZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMOiAnVkVSSUZZX0FORF9DSEFOR0VfRU1BSUwnLFxuICAgIC8qKiBUaGUgZW1haWwgdmVyaWZpY2F0aW9uIGFjdGlvbi4gKi9cbiAgICBWRVJJRllfRU1BSUw6ICdWRVJJRllfRU1BSUwnXG59O1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuZnVuY3Rpb24gX2RlYnVnRXJyb3JNYXAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgW1wiYWRtaW4tcmVzdHJpY3RlZC1vcGVyYXRpb25cIiAvKiBBdXRoRXJyb3JDb2RlLkFETUlOX09OTFlfT1BFUkFUSU9OICovXTogJ1RoaXMgb3BlcmF0aW9uIGlzIHJlc3RyaWN0ZWQgdG8gYWRtaW5pc3RyYXRvcnMgb25seS4nLFxuICAgICAgICBbXCJhcmd1bWVudC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IgKi9dOiAnJyxcbiAgICAgICAgW1wiYXBwLW5vdC1hdXRob3JpemVkXCIgLyogQXV0aEVycm9yQ29kZS5BUFBfTk9UX0FVVEhPUklaRUQgKi9dOiBcIlRoaXMgYXBwLCBpZGVudGlmaWVkIGJ5IHRoZSBkb21haW4gd2hlcmUgaXQncyBob3N0ZWQsIGlzIG5vdCBcIiArXG4gICAgICAgICAgICAnYXV0aG9yaXplZCB0byB1c2UgRmlyZWJhc2UgQXV0aGVudGljYXRpb24gd2l0aCB0aGUgcHJvdmlkZWQgQVBJIGtleS4gJyArXG4gICAgICAgICAgICAnUmV2aWV3IHlvdXIga2V5IGNvbmZpZ3VyYXRpb24gaW4gdGhlIEdvb2dsZSBBUEkgY29uc29sZS4nLFxuICAgICAgICBbXCJhcHAtbm90LWluc3RhbGxlZFwiIC8qIEF1dGhFcnJvckNvZGUuQVBQX05PVF9JTlNUQUxMRUQgKi9dOiAnVGhlIHJlcXVlc3RlZCBtb2JpbGUgYXBwbGljYXRpb24gY29ycmVzcG9uZGluZyB0byB0aGUgaWRlbnRpZmllciAoJyArXG4gICAgICAgICAgICAnQW5kcm9pZCBwYWNrYWdlIG5hbWUgb3IgaU9TIGJ1bmRsZSBJRCkgcHJvdmlkZWQgaXMgbm90IGluc3RhbGxlZCBvbiAnICtcbiAgICAgICAgICAgICd0aGlzIGRldmljZS4nLFxuICAgICAgICBbXCJjYXB0Y2hhLWNoZWNrLWZhaWxlZFwiIC8qIEF1dGhFcnJvckNvZGUuQ0FQVENIQV9DSEVDS19GQUlMRUQgKi9dOiAnVGhlIHJlQ0FQVENIQSByZXNwb25zZSB0b2tlbiBwcm92aWRlZCBpcyBlaXRoZXIgaW52YWxpZCwgZXhwaXJlZCwgJyArXG4gICAgICAgICAgICAnYWxyZWFkeSB1c2VkIG9yIHRoZSBkb21haW4gYXNzb2NpYXRlZCB3aXRoIGl0IGRvZXMgbm90IG1hdGNoIHRoZSBsaXN0ICcgK1xuICAgICAgICAgICAgJ29mIHdoaXRlbGlzdGVkIGRvbWFpbnMuJyxcbiAgICAgICAgW1wiY29kZS1leHBpcmVkXCIgLyogQXV0aEVycm9yQ29kZS5DT0RFX0VYUElSRUQgKi9dOiAnVGhlIFNNUyBjb2RlIGhhcyBleHBpcmVkLiBQbGVhc2UgcmUtc2VuZCB0aGUgdmVyaWZpY2F0aW9uIGNvZGUgdG8gdHJ5ICcgK1xuICAgICAgICAgICAgJ2FnYWluLicsXG4gICAgICAgIFtcImNvcmRvdmEtbm90LXJlYWR5XCIgLyogQXV0aEVycm9yQ29kZS5DT1JET1ZBX05PVF9SRUFEWSAqL106ICdDb3Jkb3ZhIGZyYW1ld29yayBpcyBub3QgcmVhZHkuJyxcbiAgICAgICAgW1wiY29ycy11bnN1cHBvcnRlZFwiIC8qIEF1dGhFcnJvckNvZGUuQ09SU19VTlNVUFBPUlRFRCAqL106ICdUaGlzIGJyb3dzZXIgaXMgbm90IHN1cHBvcnRlZC4nLFxuICAgICAgICBbXCJjcmVkZW50aWFsLWFscmVhZHktaW4tdXNlXCIgLyogQXV0aEVycm9yQ29kZS5DUkVERU5USUFMX0FMUkVBRFlfSU5fVVNFICovXTogJ1RoaXMgY3JlZGVudGlhbCBpcyBhbHJlYWR5IGFzc29jaWF0ZWQgd2l0aCBhIGRpZmZlcmVudCB1c2VyIGFjY291bnQuJyxcbiAgICAgICAgW1wiY3VzdG9tLXRva2VuLW1pc21hdGNoXCIgLyogQXV0aEVycm9yQ29kZS5DUkVERU5USUFMX01JU01BVENIICovXTogJ1RoZSBjdXN0b20gdG9rZW4gY29ycmVzcG9uZHMgdG8gYSBkaWZmZXJlbnQgYXVkaWVuY2UuJyxcbiAgICAgICAgW1wicmVxdWlyZXMtcmVjZW50LWxvZ2luXCIgLyogQXV0aEVycm9yQ29kZS5DUkVERU5USUFMX1RPT19PTERfTE9HSU5fQUdBSU4gKi9dOiAnVGhpcyBvcGVyYXRpb24gaXMgc2Vuc2l0aXZlIGFuZCByZXF1aXJlcyByZWNlbnQgYXV0aGVudGljYXRpb24uIExvZyBpbiAnICtcbiAgICAgICAgICAgICdhZ2FpbiBiZWZvcmUgcmV0cnlpbmcgdGhpcyByZXF1ZXN0LicsXG4gICAgICAgIFtcImRlcGVuZGVudC1zZGstaW5pdGlhbGl6ZWQtYmVmb3JlLWF1dGhcIiAvKiBBdXRoRXJyb3JDb2RlLkRFUEVOREVOVF9TREtfSU5JVF9CRUZPUkVfQVVUSCAqL106ICdBbm90aGVyIEZpcmViYXNlIFNESyB3YXMgaW5pdGlhbGl6ZWQgYW5kIGlzIHRyeWluZyB0byB1c2UgQXV0aCBiZWZvcmUgQXV0aCBpcyAnICtcbiAgICAgICAgICAgICdpbml0aWFsaXplZC4gUGxlYXNlIGJlIHN1cmUgdG8gY2FsbCBgaW5pdGlhbGl6ZUF1dGhgIG9yIGBnZXRBdXRoYCBiZWZvcmUgJyArXG4gICAgICAgICAgICAnc3RhcnRpbmcgYW55IG90aGVyIEZpcmViYXNlIFNESy4nLFxuICAgICAgICBbXCJkeW5hbWljLWxpbmstbm90LWFjdGl2YXRlZFwiIC8qIEF1dGhFcnJvckNvZGUuRFlOQU1JQ19MSU5LX05PVF9BQ1RJVkFURUQgKi9dOiAnUGxlYXNlIGFjdGl2YXRlIER5bmFtaWMgTGlua3MgaW4gdGhlIEZpcmViYXNlIENvbnNvbGUgYW5kIGFncmVlIHRvIHRoZSB0ZXJtcyBhbmQgJyArXG4gICAgICAgICAgICAnY29uZGl0aW9ucy4nLFxuICAgICAgICBbXCJlbWFpbC1jaGFuZ2UtbmVlZHMtdmVyaWZpY2F0aW9uXCIgLyogQXV0aEVycm9yQ29kZS5FTUFJTF9DSEFOR0VfTkVFRFNfVkVSSUZJQ0FUSU9OICovXTogJ011bHRpLWZhY3RvciB1c2VycyBtdXN0IGFsd2F5cyBoYXZlIGEgdmVyaWZpZWQgZW1haWwuJyxcbiAgICAgICAgW1wiZW1haWwtYWxyZWFkeS1pbi11c2VcIiAvKiBBdXRoRXJyb3JDb2RlLkVNQUlMX0VYSVNUUyAqL106ICdUaGUgZW1haWwgYWRkcmVzcyBpcyBhbHJlYWR5IGluIHVzZSBieSBhbm90aGVyIGFjY291bnQuJyxcbiAgICAgICAgW1wiZW11bGF0b3ItY29uZmlnLWZhaWxlZFwiIC8qIEF1dGhFcnJvckNvZGUuRU1VTEFUT1JfQ09ORklHX0ZBSUxFRCAqL106ICdBdXRoIGluc3RhbmNlIGhhcyBhbHJlYWR5IGJlZW4gdXNlZCB0byBtYWtlIGEgbmV0d29yayBjYWxsLiBBdXRoIGNhbiAnICtcbiAgICAgICAgICAgICdubyBsb25nZXIgYmUgY29uZmlndXJlZCB0byB1c2UgdGhlIGVtdWxhdG9yLiBUcnkgY2FsbGluZyAnICtcbiAgICAgICAgICAgICdcImNvbm5lY3RBdXRoRW11bGF0b3IoKVwiIHNvb25lci4nLFxuICAgICAgICBbXCJleHBpcmVkLWFjdGlvbi1jb2RlXCIgLyogQXV0aEVycm9yQ29kZS5FWFBJUkVEX09PQl9DT0RFICovXTogJ1RoZSBhY3Rpb24gY29kZSBoYXMgZXhwaXJlZC4nLFxuICAgICAgICBbXCJjYW5jZWxsZWQtcG9wdXAtcmVxdWVzdFwiIC8qIEF1dGhFcnJvckNvZGUuRVhQSVJFRF9QT1BVUF9SRVFVRVNUICovXTogJ1RoaXMgb3BlcmF0aW9uIGhhcyBiZWVuIGNhbmNlbGxlZCBkdWUgdG8gYW5vdGhlciBjb25mbGljdGluZyBwb3B1cCBiZWluZyBvcGVuZWQuJyxcbiAgICAgICAgW1wiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovXTogJ0FuIGludGVybmFsIEF1dGhFcnJvciBoYXMgb2NjdXJyZWQuJyxcbiAgICAgICAgW1wiaW52YWxpZC1hcHAtY3JlZGVudGlhbFwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9BUFBfQ1JFREVOVElBTCAqL106ICdUaGUgcGhvbmUgdmVyaWZpY2F0aW9uIHJlcXVlc3QgY29udGFpbnMgYW4gaW52YWxpZCBhcHBsaWNhdGlvbiB2ZXJpZmllci4nICtcbiAgICAgICAgICAgICcgVGhlIHJlQ0FQVENIQSB0b2tlbiByZXNwb25zZSBpcyBlaXRoZXIgaW52YWxpZCBvciBleHBpcmVkLicsXG4gICAgICAgIFtcImludmFsaWQtYXBwLWlkXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0FQUF9JRCAqL106ICdUaGUgbW9iaWxlIGFwcCBpZGVudGlmaWVyIGlzIG5vdCByZWdpc3RlcmVkIGZvciB0aGUgY3VycmVudCBwcm9qZWN0LicsXG4gICAgICAgIFtcImludmFsaWQtdXNlci10b2tlblwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9BVVRIICovXTogXCJUaGlzIHVzZXIncyBjcmVkZW50aWFsIGlzbid0IHZhbGlkIGZvciB0aGlzIHByb2plY3QuIFRoaXMgY2FuIGhhcHBlbiBcIiArXG4gICAgICAgICAgICBcImlmIHRoZSB1c2VyJ3MgdG9rZW4gaGFzIGJlZW4gdGFtcGVyZWQgd2l0aCwgb3IgaWYgdGhlIHVzZXIgaXNuJ3QgZm9yIFwiICtcbiAgICAgICAgICAgICd0aGUgcHJvamVjdCBhc3NvY2lhdGVkIHdpdGggdGhpcyBBUEkga2V5LicsXG4gICAgICAgIFtcImludmFsaWQtYXV0aC1ldmVudFwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9BVVRIX0VWRU5UICovXTogJ0FuIGludGVybmFsIEF1dGhFcnJvciBoYXMgb2NjdXJyZWQuJyxcbiAgICAgICAgW1wiaW52YWxpZC12ZXJpZmljYXRpb24tY29kZVwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9DT0RFICovXTogJ1RoZSBTTVMgdmVyaWZpY2F0aW9uIGNvZGUgdXNlZCB0byBjcmVhdGUgdGhlIHBob25lIGF1dGggY3JlZGVudGlhbCBpcyAnICtcbiAgICAgICAgICAgICdpbnZhbGlkLiBQbGVhc2UgcmVzZW5kIHRoZSB2ZXJpZmljYXRpb24gY29kZSBzbXMgYW5kIGJlIHN1cmUgdG8gdXNlIHRoZSAnICtcbiAgICAgICAgICAgICd2ZXJpZmljYXRpb24gY29kZSBwcm92aWRlZCBieSB0aGUgdXNlci4nLFxuICAgICAgICBbXCJpbnZhbGlkLWNvbnRpbnVlLXVyaVwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9DT05USU5VRV9VUkkgKi9dOiAnVGhlIGNvbnRpbnVlIFVSTCBwcm92aWRlZCBpbiB0aGUgcmVxdWVzdCBpcyBpbnZhbGlkLicsXG4gICAgICAgIFtcImludmFsaWQtY29yZG92YS1jb25maWd1cmF0aW9uXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0NPUkRPVkFfQ09ORklHVVJBVElPTiAqL106ICdUaGUgZm9sbG93aW5nIENvcmRvdmEgcGx1Z2lucyBtdXN0IGJlIGluc3RhbGxlZCB0byBlbmFibGUgT0F1dGggc2lnbi1pbjogJyArXG4gICAgICAgICAgICAnY29yZG92YS1wbHVnaW4tYnVpbGRpbmZvLCBjb3Jkb3ZhLXVuaXZlcnNhbC1saW5rcy1wbHVnaW4sICcgK1xuICAgICAgICAgICAgJ2NvcmRvdmEtcGx1Z2luLWJyb3dzZXJ0YWIsIGNvcmRvdmEtcGx1Z2luLWluYXBwYnJvd3NlciBhbmQgJyArXG4gICAgICAgICAgICAnY29yZG92YS1wbHVnaW4tY3VzdG9tdXJsc2NoZW1lLicsXG4gICAgICAgIFtcImludmFsaWQtY3VzdG9tLXRva2VuXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0NVU1RPTV9UT0tFTiAqL106ICdUaGUgY3VzdG9tIHRva2VuIGZvcm1hdCBpcyBpbmNvcnJlY3QuIFBsZWFzZSBjaGVjayB0aGUgZG9jdW1lbnRhdGlvbi4nLFxuICAgICAgICBbXCJpbnZhbGlkLWR5bmFtaWMtbGluay1kb21haW5cIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfRFlOQU1JQ19MSU5LX0RPTUFJTiAqL106ICdUaGUgcHJvdmlkZWQgZHluYW1pYyBsaW5rIGRvbWFpbiBpcyBub3QgY29uZmlndXJlZCBvciBhdXRob3JpemVkIGZvciB0aGUgY3VycmVudCBwcm9qZWN0LicsXG4gICAgICAgIFtcImludmFsaWQtZW1haWxcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfRU1BSUwgKi9dOiAnVGhlIGVtYWlsIGFkZHJlc3MgaXMgYmFkbHkgZm9ybWF0dGVkLicsXG4gICAgICAgIFtcImludmFsaWQtZW11bGF0b3Itc2NoZW1lXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0VNVUxBVE9SX1NDSEVNRSAqL106ICdFbXVsYXRvciBVUkwgbXVzdCBzdGFydCB3aXRoIGEgdmFsaWQgc2NoZW1lIChodHRwOi8vIG9yIGh0dHBzOi8vKS4nLFxuICAgICAgICBbXCJpbnZhbGlkLWFwaS1rZXlcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfQVBJX0tFWSAqL106ICdZb3VyIEFQSSBrZXkgaXMgaW52YWxpZCwgcGxlYXNlIGNoZWNrIHlvdSBoYXZlIGNvcGllZCBpdCBjb3JyZWN0bHkuJyxcbiAgICAgICAgW1wiaW52YWxpZC1jZXJ0LWhhc2hcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfQ0VSVF9IQVNIICovXTogJ1RoZSBTSEEtMSBjZXJ0aWZpY2F0ZSBoYXNoIHByb3ZpZGVkIGlzIGludmFsaWQuJyxcbiAgICAgICAgW1wiaW52YWxpZC1jcmVkZW50aWFsXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0NSRURFTlRJQUwgKi9dOiAnVGhlIHN1cHBsaWVkIGF1dGggY3JlZGVudGlhbCBpcyBpbmNvcnJlY3QsIG1hbGZvcm1lZCBvciBoYXMgZXhwaXJlZC4nLFxuICAgICAgICBbXCJpbnZhbGlkLW1lc3NhZ2UtcGF5bG9hZFwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9NRVNTQUdFX1BBWUxPQUQgKi9dOiAnVGhlIGVtYWlsIHRlbXBsYXRlIGNvcnJlc3BvbmRpbmcgdG8gdGhpcyBhY3Rpb24gY29udGFpbnMgaW52YWxpZCBjaGFyYWN0ZXJzIGluIGl0cyBtZXNzYWdlLiAnICtcbiAgICAgICAgICAgICdQbGVhc2UgZml4IGJ5IGdvaW5nIHRvIHRoZSBBdXRoIGVtYWlsIHRlbXBsYXRlcyBzZWN0aW9uIGluIHRoZSBGaXJlYmFzZSBDb25zb2xlLicsXG4gICAgICAgIFtcImludmFsaWQtbXVsdGktZmFjdG9yLXNlc3Npb25cIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfTUZBX1NFU1NJT04gKi9dOiAnVGhlIHJlcXVlc3QgZG9lcyBub3QgY29udGFpbiBhIHZhbGlkIHByb29mIG9mIGZpcnN0IGZhY3RvciBzdWNjZXNzZnVsIHNpZ24taW4uJyxcbiAgICAgICAgW1wiaW52YWxpZC1vYXV0aC1wcm92aWRlclwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9PQVVUSF9QUk9WSURFUiAqL106ICdFbWFpbEF1dGhQcm92aWRlciBpcyBub3Qgc3VwcG9ydGVkIGZvciB0aGlzIG9wZXJhdGlvbi4gVGhpcyBvcGVyYXRpb24gJyArXG4gICAgICAgICAgICAnb25seSBzdXBwb3J0cyBPQXV0aCBwcm92aWRlcnMuJyxcbiAgICAgICAgW1wiaW52YWxpZC1vYXV0aC1jbGllbnQtaWRcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfT0FVVEhfQ0xJRU5UX0lEICovXTogJ1RoZSBPQXV0aCBjbGllbnQgSUQgcHJvdmlkZWQgaXMgZWl0aGVyIGludmFsaWQgb3IgZG9lcyBub3QgbWF0Y2ggdGhlICcgK1xuICAgICAgICAgICAgJ3NwZWNpZmllZCBBUEkga2V5LicsXG4gICAgICAgIFtcInVuYXV0aG9yaXplZC1kb21haW5cIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfT1JJR0lOICovXTogJ1RoaXMgZG9tYWluIGlzIG5vdCBhdXRob3JpemVkIGZvciBPQXV0aCBvcGVyYXRpb25zIGZvciB5b3VyIEZpcmViYXNlICcgK1xuICAgICAgICAgICAgJ3Byb2plY3QuIEVkaXQgdGhlIGxpc3Qgb2YgYXV0aG9yaXplZCBkb21haW5zIGZyb20gdGhlIEZpcmViYXNlIGNvbnNvbGUuJyxcbiAgICAgICAgW1wiaW52YWxpZC1hY3Rpb24tY29kZVwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9PT0JfQ09ERSAqL106ICdUaGUgYWN0aW9uIGNvZGUgaXMgaW52YWxpZC4gVGhpcyBjYW4gaGFwcGVuIGlmIHRoZSBjb2RlIGlzIG1hbGZvcm1lZCwgJyArXG4gICAgICAgICAgICAnZXhwaXJlZCwgb3IgaGFzIGFscmVhZHkgYmVlbiB1c2VkLicsXG4gICAgICAgIFtcIndyb25nLXBhc3N3b3JkXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX1BBU1NXT1JEICovXTogJ1RoZSBwYXNzd29yZCBpcyBpbnZhbGlkIG9yIHRoZSB1c2VyIGRvZXMgbm90IGhhdmUgYSBwYXNzd29yZC4nLFxuICAgICAgICBbXCJpbnZhbGlkLXBlcnNpc3RlbmNlLXR5cGVcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfUEVSU0lTVEVOQ0UgKi9dOiAnVGhlIHNwZWNpZmllZCBwZXJzaXN0ZW5jZSB0eXBlIGlzIGludmFsaWQuIEl0IGNhbiBvbmx5IGJlIGxvY2FsLCBzZXNzaW9uIG9yIG5vbmUuJyxcbiAgICAgICAgW1wiaW52YWxpZC1waG9uZS1udW1iZXJcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfUEhPTkVfTlVNQkVSICovXTogJ1RoZSBmb3JtYXQgb2YgdGhlIHBob25lIG51bWJlciBwcm92aWRlZCBpcyBpbmNvcnJlY3QuIFBsZWFzZSBlbnRlciB0aGUgJyArXG4gICAgICAgICAgICAncGhvbmUgbnVtYmVyIGluIGEgZm9ybWF0IHRoYXQgY2FuIGJlIHBhcnNlZCBpbnRvIEUuMTY0IGZvcm1hdC4gRS4xNjQgJyArXG4gICAgICAgICAgICAncGhvbmUgbnVtYmVycyBhcmUgd3JpdHRlbiBpbiB0aGUgZm9ybWF0IFsrXVtjb3VudHJ5IGNvZGVdW3N1YnNjcmliZXIgJyArXG4gICAgICAgICAgICAnbnVtYmVyIGluY2x1ZGluZyBhcmVhIGNvZGVdLicsXG4gICAgICAgIFtcImludmFsaWQtcHJvdmlkZXItaWRcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfUFJPVklERVJfSUQgKi9dOiAnVGhlIHNwZWNpZmllZCBwcm92aWRlciBJRCBpcyBpbnZhbGlkLicsXG4gICAgICAgIFtcImludmFsaWQtcmVjaXBpZW50LWVtYWlsXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX1JFQ0lQSUVOVF9FTUFJTCAqL106ICdUaGUgZW1haWwgY29ycmVzcG9uZGluZyB0byB0aGlzIGFjdGlvbiBmYWlsZWQgdG8gc2VuZCBhcyB0aGUgcHJvdmlkZWQgJyArXG4gICAgICAgICAgICAncmVjaXBpZW50IGVtYWlsIGFkZHJlc3MgaXMgaW52YWxpZC4nLFxuICAgICAgICBbXCJpbnZhbGlkLXNlbmRlclwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9TRU5ERVIgKi9dOiAnVGhlIGVtYWlsIHRlbXBsYXRlIGNvcnJlc3BvbmRpbmcgdG8gdGhpcyBhY3Rpb24gY29udGFpbnMgYW4gaW52YWxpZCBzZW5kZXIgZW1haWwgb3IgbmFtZS4gJyArXG4gICAgICAgICAgICAnUGxlYXNlIGZpeCBieSBnb2luZyB0byB0aGUgQXV0aCBlbWFpbCB0ZW1wbGF0ZXMgc2VjdGlvbiBpbiB0aGUgRmlyZWJhc2UgQ29uc29sZS4nLFxuICAgICAgICBbXCJpbnZhbGlkLXZlcmlmaWNhdGlvbi1pZFwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9TRVNTSU9OX0lORk8gKi9dOiAnVGhlIHZlcmlmaWNhdGlvbiBJRCB1c2VkIHRvIGNyZWF0ZSB0aGUgcGhvbmUgYXV0aCBjcmVkZW50aWFsIGlzIGludmFsaWQuJyxcbiAgICAgICAgW1wiaW52YWxpZC10ZW5hbnQtaWRcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfVEVOQU5UX0lEICovXTogXCJUaGUgQXV0aCBpbnN0YW5jZSdzIHRlbmFudCBJRCBpcyBpbnZhbGlkLlwiLFxuICAgICAgICBbXCJsb2dpbi1ibG9ja2VkXCIgLyogQXV0aEVycm9yQ29kZS5MT0dJTl9CTE9DS0VEICovXTogJ0xvZ2luIGJsb2NrZWQgYnkgdXNlci1wcm92aWRlZCBtZXRob2Q6IHskb3JpZ2luYWxNZXNzYWdlfScsXG4gICAgICAgIFtcIm1pc3NpbmctYW5kcm9pZC1wa2ctbmFtZVwiIC8qIEF1dGhFcnJvckNvZGUuTUlTU0lOR19BTkRST0lEX1BBQ0tBR0VfTkFNRSAqL106ICdBbiBBbmRyb2lkIFBhY2thZ2UgTmFtZSBtdXN0IGJlIHByb3ZpZGVkIGlmIHRoZSBBbmRyb2lkIEFwcCBpcyByZXF1aXJlZCB0byBiZSBpbnN0YWxsZWQuJyxcbiAgICAgICAgW1wiYXV0aC1kb21haW4tY29uZmlnLXJlcXVpcmVkXCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX0FVVEhfRE9NQUlOICovXTogJ0JlIHN1cmUgdG8gaW5jbHVkZSBhdXRoRG9tYWluIHdoZW4gY2FsbGluZyBmaXJlYmFzZS5pbml0aWFsaXplQXBwKCksICcgK1xuICAgICAgICAgICAgJ2J5IGZvbGxvd2luZyB0aGUgaW5zdHJ1Y3Rpb25zIGluIHRoZSBGaXJlYmFzZSBjb25zb2xlLicsXG4gICAgICAgIFtcIm1pc3NpbmctYXBwLWNyZWRlbnRpYWxcIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfQVBQX0NSRURFTlRJQUwgKi9dOiAnVGhlIHBob25lIHZlcmlmaWNhdGlvbiByZXF1ZXN0IGlzIG1pc3NpbmcgYW4gYXBwbGljYXRpb24gdmVyaWZpZXIgJyArXG4gICAgICAgICAgICAnYXNzZXJ0aW9uLiBBIHJlQ0FQVENIQSByZXNwb25zZSB0b2tlbiBuZWVkcyB0byBiZSBwcm92aWRlZC4nLFxuICAgICAgICBbXCJtaXNzaW5nLXZlcmlmaWNhdGlvbi1jb2RlXCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX0NPREUgKi9dOiAnVGhlIHBob25lIGF1dGggY3JlZGVudGlhbCB3YXMgY3JlYXRlZCB3aXRoIGFuIGVtcHR5IFNNUyB2ZXJpZmljYXRpb24gY29kZS4nLFxuICAgICAgICBbXCJtaXNzaW5nLWNvbnRpbnVlLXVyaVwiIC8qIEF1dGhFcnJvckNvZGUuTUlTU0lOR19DT05USU5VRV9VUkkgKi9dOiAnQSBjb250aW51ZSBVUkwgbXVzdCBiZSBwcm92aWRlZCBpbiB0aGUgcmVxdWVzdC4nLFxuICAgICAgICBbXCJtaXNzaW5nLWlmcmFtZS1zdGFydFwiIC8qIEF1dGhFcnJvckNvZGUuTUlTU0lOR19JRlJBTUVfU1RBUlQgKi9dOiAnQW4gaW50ZXJuYWwgQXV0aEVycm9yIGhhcyBvY2N1cnJlZC4nLFxuICAgICAgICBbXCJtaXNzaW5nLWlvcy1idW5kbGUtaWRcIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfSU9TX0JVTkRMRV9JRCAqL106ICdBbiBpT1MgQnVuZGxlIElEIG11c3QgYmUgcHJvdmlkZWQgaWYgYW4gQXBwIFN0b3JlIElEIGlzIHByb3ZpZGVkLicsXG4gICAgICAgIFtcIm1pc3Npbmctb3ItaW52YWxpZC1ub25jZVwiIC8qIEF1dGhFcnJvckNvZGUuTUlTU0lOR19PUl9JTlZBTElEX05PTkNFICovXTogJ1RoZSByZXF1ZXN0IGRvZXMgbm90IGNvbnRhaW4gYSB2YWxpZCBub25jZS4gVGhpcyBjYW4gb2NjdXIgaWYgdGhlICcgK1xuICAgICAgICAgICAgJ1NIQS0yNTYgaGFzaCBvZiB0aGUgcHJvdmlkZWQgcmF3IG5vbmNlIGRvZXMgbm90IG1hdGNoIHRoZSBoYXNoZWQgbm9uY2UgJyArXG4gICAgICAgICAgICAnaW4gdGhlIElEIHRva2VuIHBheWxvYWQuJyxcbiAgICAgICAgW1wibWlzc2luZy1wYXNzd29yZFwiIC8qIEF1dGhFcnJvckNvZGUuTUlTU0lOR19QQVNTV09SRCAqL106ICdBIG5vbi1lbXB0eSBwYXNzd29yZCBtdXN0IGJlIHByb3ZpZGVkJyxcbiAgICAgICAgW1wibWlzc2luZy1tdWx0aS1mYWN0b3ItaW5mb1wiIC8qIEF1dGhFcnJvckNvZGUuTUlTU0lOR19NRkFfSU5GTyAqL106ICdObyBzZWNvbmQgZmFjdG9yIGlkZW50aWZpZXIgaXMgcHJvdmlkZWQuJyxcbiAgICAgICAgW1wibWlzc2luZy1tdWx0aS1mYWN0b3Itc2Vzc2lvblwiIC8qIEF1dGhFcnJvckNvZGUuTUlTU0lOR19NRkFfU0VTU0lPTiAqL106ICdUaGUgcmVxdWVzdCBpcyBtaXNzaW5nIHByb29mIG9mIGZpcnN0IGZhY3RvciBzdWNjZXNzZnVsIHNpZ24taW4uJyxcbiAgICAgICAgW1wibWlzc2luZy1waG9uZS1udW1iZXJcIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfUEhPTkVfTlVNQkVSICovXTogJ1RvIHNlbmQgdmVyaWZpY2F0aW9uIGNvZGVzLCBwcm92aWRlIGEgcGhvbmUgbnVtYmVyIGZvciB0aGUgcmVjaXBpZW50LicsXG4gICAgICAgIFtcIm1pc3NpbmctdmVyaWZpY2F0aW9uLWlkXCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX1NFU1NJT05fSU5GTyAqL106ICdUaGUgcGhvbmUgYXV0aCBjcmVkZW50aWFsIHdhcyBjcmVhdGVkIHdpdGggYW4gZW1wdHkgdmVyaWZpY2F0aW9uIElELicsXG4gICAgICAgIFtcImFwcC1kZWxldGVkXCIgLyogQXV0aEVycm9yQ29kZS5NT0RVTEVfREVTVFJPWUVEICovXTogJ1RoaXMgaW5zdGFuY2Ugb2YgRmlyZWJhc2VBcHAgaGFzIGJlZW4gZGVsZXRlZC4nLFxuICAgICAgICBbXCJtdWx0aS1mYWN0b3ItaW5mby1ub3QtZm91bmRcIiAvKiBBdXRoRXJyb3JDb2RlLk1GQV9JTkZPX05PVF9GT1VORCAqL106ICdUaGUgdXNlciBkb2VzIG5vdCBoYXZlIGEgc2Vjb25kIGZhY3RvciBtYXRjaGluZyB0aGUgaWRlbnRpZmllciBwcm92aWRlZC4nLFxuICAgICAgICBbXCJtdWx0aS1mYWN0b3ItYXV0aC1yZXF1aXJlZFwiIC8qIEF1dGhFcnJvckNvZGUuTUZBX1JFUVVJUkVEICovXTogJ1Byb29mIG9mIG93bmVyc2hpcCBvZiBhIHNlY29uZCBmYWN0b3IgaXMgcmVxdWlyZWQgdG8gY29tcGxldGUgc2lnbi1pbi4nLFxuICAgICAgICBbXCJhY2NvdW50LWV4aXN0cy13aXRoLWRpZmZlcmVudC1jcmVkZW50aWFsXCIgLyogQXV0aEVycm9yQ29kZS5ORUVEX0NPTkZJUk1BVElPTiAqL106ICdBbiBhY2NvdW50IGFscmVhZHkgZXhpc3RzIHdpdGggdGhlIHNhbWUgZW1haWwgYWRkcmVzcyBidXQgZGlmZmVyZW50ICcgK1xuICAgICAgICAgICAgJ3NpZ24taW4gY3JlZGVudGlhbHMuIFNpZ24gaW4gdXNpbmcgYSBwcm92aWRlciBhc3NvY2lhdGVkIHdpdGggdGhpcyAnICtcbiAgICAgICAgICAgICdlbWFpbCBhZGRyZXNzLicsXG4gICAgICAgIFtcIm5ldHdvcmstcmVxdWVzdC1mYWlsZWRcIiAvKiBBdXRoRXJyb3JDb2RlLk5FVFdPUktfUkVRVUVTVF9GQUlMRUQgKi9dOiAnQSBuZXR3b3JrIEF1dGhFcnJvciAoc3VjaCBhcyB0aW1lb3V0LCBpbnRlcnJ1cHRlZCBjb25uZWN0aW9uIG9yIHVucmVhY2hhYmxlIGhvc3QpIGhhcyBvY2N1cnJlZC4nLFxuICAgICAgICBbXCJuby1hdXRoLWV2ZW50XCIgLyogQXV0aEVycm9yQ29kZS5OT19BVVRIX0VWRU5UICovXTogJ0FuIGludGVybmFsIEF1dGhFcnJvciBoYXMgb2NjdXJyZWQuJyxcbiAgICAgICAgW1wibm8tc3VjaC1wcm92aWRlclwiIC8qIEF1dGhFcnJvckNvZGUuTk9fU1VDSF9QUk9WSURFUiAqL106ICdVc2VyIHdhcyBub3QgbGlua2VkIHRvIGFuIGFjY291bnQgd2l0aCB0aGUgZ2l2ZW4gcHJvdmlkZXIuJyxcbiAgICAgICAgW1wibnVsbC11c2VyXCIgLyogQXV0aEVycm9yQ29kZS5OVUxMX1VTRVIgKi9dOiAnQSBudWxsIHVzZXIgb2JqZWN0IHdhcyBwcm92aWRlZCBhcyB0aGUgYXJndW1lbnQgZm9yIGFuIG9wZXJhdGlvbiB3aGljaCAnICtcbiAgICAgICAgICAgICdyZXF1aXJlcyBhIG5vbi1udWxsIHVzZXIgb2JqZWN0LicsXG4gICAgICAgIFtcIm9wZXJhdGlvbi1ub3QtYWxsb3dlZFwiIC8qIEF1dGhFcnJvckNvZGUuT1BFUkFUSU9OX05PVF9BTExPV0VEICovXTogJ1RoZSBnaXZlbiBzaWduLWluIHByb3ZpZGVyIGlzIGRpc2FibGVkIGZvciB0aGlzIEZpcmViYXNlIHByb2plY3QuICcgK1xuICAgICAgICAgICAgJ0VuYWJsZSBpdCBpbiB0aGUgRmlyZWJhc2UgY29uc29sZSwgdW5kZXIgdGhlIHNpZ24taW4gbWV0aG9kIHRhYiBvZiB0aGUgJyArXG4gICAgICAgICAgICAnQXV0aCBzZWN0aW9uLicsXG4gICAgICAgIFtcIm9wZXJhdGlvbi1ub3Qtc3VwcG9ydGVkLWluLXRoaXMtZW52aXJvbm1lbnRcIiAvKiBBdXRoRXJyb3JDb2RlLk9QRVJBVElPTl9OT1RfU1VQUE9SVEVEICovXTogJ1RoaXMgb3BlcmF0aW9uIGlzIG5vdCBzdXBwb3J0ZWQgaW4gdGhlIGVudmlyb25tZW50IHRoaXMgYXBwbGljYXRpb24gaXMgJyArXG4gICAgICAgICAgICAncnVubmluZyBvbi4gXCJsb2NhdGlvbi5wcm90b2NvbFwiIG11c3QgYmUgaHR0cCwgaHR0cHMgb3IgY2hyb21lLWV4dGVuc2lvbicgK1xuICAgICAgICAgICAgJyBhbmQgd2ViIHN0b3JhZ2UgbXVzdCBiZSBlbmFibGVkLicsXG4gICAgICAgIFtcInBvcHVwLWJsb2NrZWRcIiAvKiBBdXRoRXJyb3JDb2RlLlBPUFVQX0JMT0NLRUQgKi9dOiAnVW5hYmxlIHRvIGVzdGFibGlzaCBhIGNvbm5lY3Rpb24gd2l0aCB0aGUgcG9wdXAuIEl0IG1heSBoYXZlIGJlZW4gYmxvY2tlZCBieSB0aGUgYnJvd3Nlci4nLFxuICAgICAgICBbXCJwb3B1cC1jbG9zZWQtYnktdXNlclwiIC8qIEF1dGhFcnJvckNvZGUuUE9QVVBfQ0xPU0VEX0JZX1VTRVIgKi9dOiAnVGhlIHBvcHVwIGhhcyBiZWVuIGNsb3NlZCBieSB0aGUgdXNlciBiZWZvcmUgZmluYWxpemluZyB0aGUgb3BlcmF0aW9uLicsXG4gICAgICAgIFtcInByb3ZpZGVyLWFscmVhZHktbGlua2VkXCIgLyogQXV0aEVycm9yQ29kZS5QUk9WSURFUl9BTFJFQURZX0xJTktFRCAqL106ICdVc2VyIGNhbiBvbmx5IGJlIGxpbmtlZCB0byBvbmUgaWRlbnRpdHkgZm9yIHRoZSBnaXZlbiBwcm92aWRlci4nLFxuICAgICAgICBbXCJxdW90YS1leGNlZWRlZFwiIC8qIEF1dGhFcnJvckNvZGUuUVVPVEFfRVhDRUVERUQgKi9dOiBcIlRoZSBwcm9qZWN0J3MgcXVvdGEgZm9yIHRoaXMgb3BlcmF0aW9uIGhhcyBiZWVuIGV4Y2VlZGVkLlwiLFxuICAgICAgICBbXCJyZWRpcmVjdC1jYW5jZWxsZWQtYnktdXNlclwiIC8qIEF1dGhFcnJvckNvZGUuUkVESVJFQ1RfQ0FOQ0VMTEVEX0JZX1VTRVIgKi9dOiAnVGhlIHJlZGlyZWN0IG9wZXJhdGlvbiBoYXMgYmVlbiBjYW5jZWxsZWQgYnkgdGhlIHVzZXIgYmVmb3JlIGZpbmFsaXppbmcuJyxcbiAgICAgICAgW1wicmVkaXJlY3Qtb3BlcmF0aW9uLXBlbmRpbmdcIiAvKiBBdXRoRXJyb3JDb2RlLlJFRElSRUNUX09QRVJBVElPTl9QRU5ESU5HICovXTogJ0EgcmVkaXJlY3Qgc2lnbi1pbiBvcGVyYXRpb24gaXMgYWxyZWFkeSBwZW5kaW5nLicsXG4gICAgICAgIFtcInJlamVjdGVkLWNyZWRlbnRpYWxcIiAvKiBBdXRoRXJyb3JDb2RlLlJFSkVDVEVEX0NSRURFTlRJQUwgKi9dOiAnVGhlIHJlcXVlc3QgY29udGFpbnMgbWFsZm9ybWVkIG9yIG1pc21hdGNoaW5nIGNyZWRlbnRpYWxzLicsXG4gICAgICAgIFtcInNlY29uZC1mYWN0b3ItYWxyZWFkeS1pbi11c2VcIiAvKiBBdXRoRXJyb3JDb2RlLlNFQ09ORF9GQUNUT1JfQUxSRUFEWV9FTlJPTExFRCAqL106ICdUaGUgc2Vjb25kIGZhY3RvciBpcyBhbHJlYWR5IGVucm9sbGVkIG9uIHRoaXMgYWNjb3VudC4nLFxuICAgICAgICBbXCJtYXhpbXVtLXNlY29uZC1mYWN0b3ItY291bnQtZXhjZWVkZWRcIiAvKiBBdXRoRXJyb3JDb2RlLlNFQ09ORF9GQUNUT1JfTElNSVRfRVhDRUVERUQgKi9dOiAnVGhlIG1heGltdW0gYWxsb3dlZCBudW1iZXIgb2Ygc2Vjb25kIGZhY3RvcnMgb24gYSB1c2VyIGhhcyBiZWVuIGV4Y2VlZGVkLicsXG4gICAgICAgIFtcInRlbmFudC1pZC1taXNtYXRjaFwiIC8qIEF1dGhFcnJvckNvZGUuVEVOQU5UX0lEX01JU01BVENIICovXTogXCJUaGUgcHJvdmlkZWQgdGVuYW50IElEIGRvZXMgbm90IG1hdGNoIHRoZSBBdXRoIGluc3RhbmNlJ3MgdGVuYW50IElEXCIsXG4gICAgICAgIFtcInRpbWVvdXRcIiAvKiBBdXRoRXJyb3JDb2RlLlRJTUVPVVQgKi9dOiAnVGhlIG9wZXJhdGlvbiBoYXMgdGltZWQgb3V0LicsXG4gICAgICAgIFtcInVzZXItdG9rZW4tZXhwaXJlZFwiIC8qIEF1dGhFcnJvckNvZGUuVE9LRU5fRVhQSVJFRCAqL106IFwiVGhlIHVzZXIncyBjcmVkZW50aWFsIGlzIG5vIGxvbmdlciB2YWxpZC4gVGhlIHVzZXIgbXVzdCBzaWduIGluIGFnYWluLlwiLFxuICAgICAgICBbXCJ0b28tbWFueS1yZXF1ZXN0c1wiIC8qIEF1dGhFcnJvckNvZGUuVE9PX01BTllfQVRURU1QVFNfVFJZX0xBVEVSICovXTogJ1dlIGhhdmUgYmxvY2tlZCBhbGwgcmVxdWVzdHMgZnJvbSB0aGlzIGRldmljZSBkdWUgdG8gdW51c3VhbCBhY3Rpdml0eS4gJyArXG4gICAgICAgICAgICAnVHJ5IGFnYWluIGxhdGVyLicsXG4gICAgICAgIFtcInVuYXV0aG9yaXplZC1jb250aW51ZS11cmlcIiAvKiBBdXRoRXJyb3JDb2RlLlVOQVVUSE9SSVpFRF9ET01BSU4gKi9dOiAnVGhlIGRvbWFpbiBvZiB0aGUgY29udGludWUgVVJMIGlzIG5vdCB3aGl0ZWxpc3RlZC4gIFBsZWFzZSB3aGl0ZWxpc3QgJyArXG4gICAgICAgICAgICAndGhlIGRvbWFpbiBpbiB0aGUgRmlyZWJhc2UgY29uc29sZS4nLFxuICAgICAgICBbXCJ1bnN1cHBvcnRlZC1maXJzdC1mYWN0b3JcIiAvKiBBdXRoRXJyb3JDb2RlLlVOU1VQUE9SVEVEX0ZJUlNUX0ZBQ1RPUiAqL106ICdFbnJvbGxpbmcgYSBzZWNvbmQgZmFjdG9yIG9yIHNpZ25pbmcgaW4gd2l0aCBhIG11bHRpLWZhY3RvciBhY2NvdW50IHJlcXVpcmVzIHNpZ24taW4gd2l0aCBhIHN1cHBvcnRlZCBmaXJzdCBmYWN0b3IuJyxcbiAgICAgICAgW1widW5zdXBwb3J0ZWQtcGVyc2lzdGVuY2UtdHlwZVwiIC8qIEF1dGhFcnJvckNvZGUuVU5TVVBQT1JURURfUEVSU0lTVEVOQ0UgKi9dOiAnVGhlIGN1cnJlbnQgZW52aXJvbm1lbnQgZG9lcyBub3Qgc3VwcG9ydCB0aGUgc3BlY2lmaWVkIHBlcnNpc3RlbmNlIHR5cGUuJyxcbiAgICAgICAgW1widW5zdXBwb3J0ZWQtdGVuYW50LW9wZXJhdGlvblwiIC8qIEF1dGhFcnJvckNvZGUuVU5TVVBQT1JURURfVEVOQU5UX09QRVJBVElPTiAqL106ICdUaGlzIG9wZXJhdGlvbiBpcyBub3Qgc3VwcG9ydGVkIGluIGEgbXVsdGktdGVuYW50IGNvbnRleHQuJyxcbiAgICAgICAgW1widW52ZXJpZmllZC1lbWFpbFwiIC8qIEF1dGhFcnJvckNvZGUuVU5WRVJJRklFRF9FTUFJTCAqL106ICdUaGUgb3BlcmF0aW9uIHJlcXVpcmVzIGEgdmVyaWZpZWQgZW1haWwuJyxcbiAgICAgICAgW1widXNlci1jYW5jZWxsZWRcIiAvKiBBdXRoRXJyb3JDb2RlLlVTRVJfQ0FOQ0VMTEVEICovXTogJ1RoZSB1c2VyIGRpZCBub3QgZ3JhbnQgeW91ciBhcHBsaWNhdGlvbiB0aGUgcGVybWlzc2lvbnMgaXQgcmVxdWVzdGVkLicsXG4gICAgICAgIFtcInVzZXItbm90LWZvdW5kXCIgLyogQXV0aEVycm9yQ29kZS5VU0VSX0RFTEVURUQgKi9dOiAnVGhlcmUgaXMgbm8gdXNlciByZWNvcmQgY29ycmVzcG9uZGluZyB0byB0aGlzIGlkZW50aWZpZXIuIFRoZSB1c2VyIG1heSAnICtcbiAgICAgICAgICAgICdoYXZlIGJlZW4gZGVsZXRlZC4nLFxuICAgICAgICBbXCJ1c2VyLWRpc2FibGVkXCIgLyogQXV0aEVycm9yQ29kZS5VU0VSX0RJU0FCTEVEICovXTogJ1RoZSB1c2VyIGFjY291bnQgaGFzIGJlZW4gZGlzYWJsZWQgYnkgYW4gYWRtaW5pc3RyYXRvci4nLFxuICAgICAgICBbXCJ1c2VyLW1pc21hdGNoXCIgLyogQXV0aEVycm9yQ29kZS5VU0VSX01JU01BVENIICovXTogJ1RoZSBzdXBwbGllZCBjcmVkZW50aWFscyBkbyBub3QgY29ycmVzcG9uZCB0byB0aGUgcHJldmlvdXNseSBzaWduZWQgaW4gdXNlci4nLFxuICAgICAgICBbXCJ1c2VyLXNpZ25lZC1vdXRcIiAvKiBBdXRoRXJyb3JDb2RlLlVTRVJfU0lHTkVEX09VVCAqL106ICcnLFxuICAgICAgICBbXCJ3ZWFrLXBhc3N3b3JkXCIgLyogQXV0aEVycm9yQ29kZS5XRUFLX1BBU1NXT1JEICovXTogJ1RoZSBwYXNzd29yZCBtdXN0IGJlIDYgY2hhcmFjdGVycyBsb25nIG9yIG1vcmUuJyxcbiAgICAgICAgW1wid2ViLXN0b3JhZ2UtdW5zdXBwb3J0ZWRcIiAvKiBBdXRoRXJyb3JDb2RlLldFQl9TVE9SQUdFX1VOU1VQUE9SVEVEICovXTogJ1RoaXMgYnJvd3NlciBpcyBub3Qgc3VwcG9ydGVkIG9yIDNyZCBwYXJ0eSBjb29raWVzIGFuZCBkYXRhIG1heSBiZSBkaXNhYmxlZC4nLFxuICAgICAgICBbXCJhbHJlYWR5LWluaXRpYWxpemVkXCIgLyogQXV0aEVycm9yQ29kZS5BTFJFQURZX0lOSVRJQUxJWkVEICovXTogJ2luaXRpYWxpemVBdXRoKCkgaGFzIGFscmVhZHkgYmVlbiBjYWxsZWQgd2l0aCAnICtcbiAgICAgICAgICAgICdkaWZmZXJlbnQgb3B0aW9ucy4gVG8gYXZvaWQgdGhpcyBlcnJvciwgY2FsbCBpbml0aWFsaXplQXV0aCgpIHdpdGggdGhlICcgK1xuICAgICAgICAgICAgJ3NhbWUgb3B0aW9ucyBhcyB3aGVuIGl0IHdhcyBvcmlnaW5hbGx5IGNhbGxlZCwgb3IgY2FsbCBnZXRBdXRoKCkgdG8gcmV0dXJuIHRoZScgK1xuICAgICAgICAgICAgJyBhbHJlYWR5IGluaXRpYWxpemVkIGluc3RhbmNlLicsXG4gICAgICAgIFtcIm1pc3NpbmctcmVjYXB0Y2hhLXRva2VuXCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX1JFQ0FQVENIQV9UT0tFTiAqL106ICdUaGUgcmVDQVBUQ0hBIHRva2VuIGlzIG1pc3Npbmcgd2hlbiBzZW5kaW5nIHJlcXVlc3QgdG8gdGhlIGJhY2tlbmQuJyxcbiAgICAgICAgW1wiaW52YWxpZC1yZWNhcHRjaGEtdG9rZW5cIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfUkVDQVBUQ0hBX1RPS0VOICovXTogJ1RoZSByZUNBUFRDSEEgdG9rZW4gaXMgaW52YWxpZCB3aGVuIHNlbmRpbmcgcmVxdWVzdCB0byB0aGUgYmFja2VuZC4nLFxuICAgICAgICBbXCJpbnZhbGlkLXJlY2FwdGNoYS1hY3Rpb25cIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfUkVDQVBUQ0hBX0FDVElPTiAqL106ICdUaGUgcmVDQVBUQ0hBIGFjdGlvbiBpcyBpbnZhbGlkIHdoZW4gc2VuZGluZyByZXF1ZXN0IHRvIHRoZSBiYWNrZW5kLicsXG4gICAgICAgIFtcInJlY2FwdGNoYS1ub3QtZW5hYmxlZFwiIC8qIEF1dGhFcnJvckNvZGUuUkVDQVBUQ0hBX05PVF9FTkFCTEVEICovXTogJ3JlQ0FQVENIQSBFbnRlcnByaXNlIGludGVncmF0aW9uIGlzIG5vdCBlbmFibGVkIGZvciB0aGlzIHByb2plY3QuJyxcbiAgICAgICAgW1wibWlzc2luZy1jbGllbnQtdHlwZVwiIC8qIEF1dGhFcnJvckNvZGUuTUlTU0lOR19DTElFTlRfVFlQRSAqL106ICdUaGUgcmVDQVBUQ0hBIGNsaWVudCB0eXBlIGlzIG1pc3Npbmcgd2hlbiBzZW5kaW5nIHJlcXVlc3QgdG8gdGhlIGJhY2tlbmQuJyxcbiAgICAgICAgW1wibWlzc2luZy1yZWNhcHRjaGEtdmVyc2lvblwiIC8qIEF1dGhFcnJvckNvZGUuTUlTU0lOR19SRUNBUFRDSEFfVkVSU0lPTiAqL106ICdUaGUgcmVDQVBUQ0hBIHZlcnNpb24gaXMgbWlzc2luZyB3aGVuIHNlbmRpbmcgcmVxdWVzdCB0byB0aGUgYmFja2VuZC4nLFxuICAgICAgICBbXCJpbnZhbGlkLXJlcS10eXBlXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX1JFUV9UWVBFICovXTogJ0ludmFsaWQgcmVxdWVzdCBwYXJhbWV0ZXJzLicsXG4gICAgICAgIFtcImludmFsaWQtcmVjYXB0Y2hhLXZlcnNpb25cIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfUkVDQVBUQ0hBX1ZFUlNJT04gKi9dOiAnVGhlIHJlQ0FQVENIQSB2ZXJzaW9uIGlzIGludmFsaWQgd2hlbiBzZW5kaW5nIHJlcXVlc3QgdG8gdGhlIGJhY2tlbmQuJyxcbiAgICAgICAgW1widW5zdXBwb3J0ZWQtcGFzc3dvcmQtcG9saWN5LXNjaGVtYS12ZXJzaW9uXCIgLyogQXV0aEVycm9yQ29kZS5VTlNVUFBPUlRFRF9QQVNTV09SRF9QT0xJQ1lfU0NIRU1BX1ZFUlNJT04gKi9dOiAnVGhlIHBhc3N3b3JkIHBvbGljeSByZWNlaXZlZCBmcm9tIHRoZSBiYWNrZW5kIHVzZXMgYSBzY2hlbWEgdmVyc2lvbiB0aGF0IGlzIG5vdCBzdXBwb3J0ZWQgYnkgdGhpcyB2ZXJzaW9uIG9mIHRoZSBGaXJlYmFzZSBTREsuJyxcbiAgICAgICAgW1wicGFzc3dvcmQtZG9lcy1ub3QtbWVldC1yZXF1aXJlbWVudHNcIiAvKiBBdXRoRXJyb3JDb2RlLlBBU1NXT1JEX0RPRVNfTk9UX01FRVRfUkVRVUlSRU1FTlRTICovXTogJ1RoZSBwYXNzd29yZCBkb2VzIG5vdCBtZWV0IHRoZSByZXF1aXJlbWVudHMuJyxcbiAgICAgICAgW1wiaW52YWxpZC1ob3N0aW5nLWxpbmstZG9tYWluXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0hPU1RJTkdfTElOS19ET01BSU4gKi9dOiAnVGhlIHByb3ZpZGVkIEhvc3RpbmcgbGluayBkb21haW4gaXMgbm90IGNvbmZpZ3VyZWQgaW4gRmlyZWJhc2UgSG9zdGluZyBvciBpcyBub3Qgb3duZWQgYnkgJyArXG4gICAgICAgICAgICAndGhlIGN1cnJlbnQgcHJvamVjdC4gVGhpcyBjYW5ub3QgYmUgYSBkZWZhdWx0IEhvc3RpbmcgZG9tYWluIChgd2ViLmFwcGAgb3IgYGZpcmViYXNlYXBwLmNvbWApLidcbiAgICB9O1xufVxuZnVuY3Rpb24gX3Byb2RFcnJvck1hcCgpIHtcbiAgICAvLyBXZSB3aWxsIGluY2x1ZGUgdGhpcyBvbmUgbWVzc2FnZSBpbiB0aGUgcHJvZCBlcnJvciBtYXAgc2luY2UgYnkgdGhlIHZlcnlcbiAgICAvLyBuYXR1cmUgb2YgdGhpcyBlcnJvciwgZGV2ZWxvcGVycyB3aWxsIG5ldmVyIGJlIGFibGUgdG8gc2VlIHRoZSBtZXNzYWdlXG4gICAgLy8gdXNpbmcgdGhlIGRlYnVnRXJyb3JNYXAgKHdoaWNoIGlzIGluc3RhbGxlZCBkdXJpbmcgYXV0aCBpbml0aWFsaXphdGlvbikuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgW1wiZGVwZW5kZW50LXNkay1pbml0aWFsaXplZC1iZWZvcmUtYXV0aFwiIC8qIEF1dGhFcnJvckNvZGUuREVQRU5ERU5UX1NES19JTklUX0JFRk9SRV9BVVRIICovXTogJ0Fub3RoZXIgRmlyZWJhc2UgU0RLIHdhcyBpbml0aWFsaXplZCBhbmQgaXMgdHJ5aW5nIHRvIHVzZSBBdXRoIGJlZm9yZSBBdXRoIGlzICcgK1xuICAgICAgICAgICAgJ2luaXRpYWxpemVkLiBQbGVhc2UgYmUgc3VyZSB0byBjYWxsIGBpbml0aWFsaXplQXV0aGAgb3IgYGdldEF1dGhgIGJlZm9yZSAnICtcbiAgICAgICAgICAgICdzdGFydGluZyBhbnkgb3RoZXIgRmlyZWJhc2UgU0RLLidcbiAgICB9O1xufVxuLyoqXG4gKiBBIHZlcmJvc2UgZXJyb3IgbWFwIHdpdGggZGV0YWlsZWQgZGVzY3JpcHRpb25zIGZvciBtb3N0IGVycm9yIGNvZGVzLlxuICpcbiAqIFNlZSBkaXNjdXNzaW9uIGF0IHtAbGluayBBdXRoRXJyb3JNYXB9XG4gKlxuICogQHB1YmxpY1xuICovXG5jb25zdCBkZWJ1Z0Vycm9yTWFwID0gX2RlYnVnRXJyb3JNYXA7XG4vKipcbiAqIEEgbWluaW1hbCBlcnJvciBtYXAgd2l0aCBhbGwgdmVyYm9zZSBlcnJvciBtZXNzYWdlcyBzdHJpcHBlZC5cbiAqXG4gKiBTZWUgZGlzY3Vzc2lvbiBhdCB7QGxpbmsgQXV0aEVycm9yTWFwfVxuICpcbiAqIEBwdWJsaWNcbiAqL1xuY29uc3QgcHJvZEVycm9yTWFwID0gX3Byb2RFcnJvck1hcDtcbmNvbnN0IF9ERUZBVUxUX0FVVEhfRVJST1JfRkFDVE9SWSA9IG5ldyBFcnJvckZhY3RvcnkoJ2F1dGgnLCAnRmlyZWJhc2UnLCBfcHJvZEVycm9yTWFwKCkpO1xuLyoqXG4gKiBBIG1hcCBvZiBwb3RlbnRpYWwgYEF1dGhgIGVycm9yIGNvZGVzLCBmb3IgZWFzaWVyIGNvbXBhcmlzb24gd2l0aCBlcnJvcnNcbiAqIHRocm93biBieSB0aGUgU0RLLlxuICpcbiAqIEByZW1hcmtzXG4gKiBOb3RlIHRoYXQgeW91IGNhbid0IHRyZWUtc2hha2UgaW5kaXZpZHVhbCBrZXlzXG4gKiBpbiB0aGUgbWFwLCBzbyBieSB1c2luZyB0aGUgbWFwIHlvdSBtaWdodCBzdWJzdGFudGlhbGx5IGluY3JlYXNlIHlvdXJcbiAqIGJ1bmRsZSBzaXplLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuY29uc3QgQVVUSF9FUlJPUl9DT0RFU19NQVBfRE9fTk9UX1VTRV9JTlRFUk5BTExZID0ge1xuICAgIEFETUlOX09OTFlfT1BFUkFUSU9OOiAnYXV0aC9hZG1pbi1yZXN0cmljdGVkLW9wZXJhdGlvbicsXG4gICAgQVJHVU1FTlRfRVJST1I6ICdhdXRoL2FyZ3VtZW50LWVycm9yJyxcbiAgICBBUFBfTk9UX0FVVEhPUklaRUQ6ICdhdXRoL2FwcC1ub3QtYXV0aG9yaXplZCcsXG4gICAgQVBQX05PVF9JTlNUQUxMRUQ6ICdhdXRoL2FwcC1ub3QtaW5zdGFsbGVkJyxcbiAgICBDQVBUQ0hBX0NIRUNLX0ZBSUxFRDogJ2F1dGgvY2FwdGNoYS1jaGVjay1mYWlsZWQnLFxuICAgIENPREVfRVhQSVJFRDogJ2F1dGgvY29kZS1leHBpcmVkJyxcbiAgICBDT1JET1ZBX05PVF9SRUFEWTogJ2F1dGgvY29yZG92YS1ub3QtcmVhZHknLFxuICAgIENPUlNfVU5TVVBQT1JURUQ6ICdhdXRoL2NvcnMtdW5zdXBwb3J0ZWQnLFxuICAgIENSRURFTlRJQUxfQUxSRUFEWV9JTl9VU0U6ICdhdXRoL2NyZWRlbnRpYWwtYWxyZWFkeS1pbi11c2UnLFxuICAgIENSRURFTlRJQUxfTUlTTUFUQ0g6ICdhdXRoL2N1c3RvbS10b2tlbi1taXNtYXRjaCcsXG4gICAgQ1JFREVOVElBTF9UT09fT0xEX0xPR0lOX0FHQUlOOiAnYXV0aC9yZXF1aXJlcy1yZWNlbnQtbG9naW4nLFxuICAgIERFUEVOREVOVF9TREtfSU5JVF9CRUZPUkVfQVVUSDogJ2F1dGgvZGVwZW5kZW50LXNkay1pbml0aWFsaXplZC1iZWZvcmUtYXV0aCcsXG4gICAgRFlOQU1JQ19MSU5LX05PVF9BQ1RJVkFURUQ6ICdhdXRoL2R5bmFtaWMtbGluay1ub3QtYWN0aXZhdGVkJyxcbiAgICBFTUFJTF9DSEFOR0VfTkVFRFNfVkVSSUZJQ0FUSU9OOiAnYXV0aC9lbWFpbC1jaGFuZ2UtbmVlZHMtdmVyaWZpY2F0aW9uJyxcbiAgICBFTUFJTF9FWElTVFM6ICdhdXRoL2VtYWlsLWFscmVhZHktaW4tdXNlJyxcbiAgICBFTVVMQVRPUl9DT05GSUdfRkFJTEVEOiAnYXV0aC9lbXVsYXRvci1jb25maWctZmFpbGVkJyxcbiAgICBFWFBJUkVEX09PQl9DT0RFOiAnYXV0aC9leHBpcmVkLWFjdGlvbi1jb2RlJyxcbiAgICBFWFBJUkVEX1BPUFVQX1JFUVVFU1Q6ICdhdXRoL2NhbmNlbGxlZC1wb3B1cC1yZXF1ZXN0JyxcbiAgICBJTlRFUk5BTF9FUlJPUjogJ2F1dGgvaW50ZXJuYWwtZXJyb3InLFxuICAgIElOVkFMSURfQVBJX0tFWTogJ2F1dGgvaW52YWxpZC1hcGkta2V5JyxcbiAgICBJTlZBTElEX0FQUF9DUkVERU5USUFMOiAnYXV0aC9pbnZhbGlkLWFwcC1jcmVkZW50aWFsJyxcbiAgICBJTlZBTElEX0FQUF9JRDogJ2F1dGgvaW52YWxpZC1hcHAtaWQnLFxuICAgIElOVkFMSURfQVVUSDogJ2F1dGgvaW52YWxpZC11c2VyLXRva2VuJyxcbiAgICBJTlZBTElEX0FVVEhfRVZFTlQ6ICdhdXRoL2ludmFsaWQtYXV0aC1ldmVudCcsXG4gICAgSU5WQUxJRF9DRVJUX0hBU0g6ICdhdXRoL2ludmFsaWQtY2VydC1oYXNoJyxcbiAgICBJTlZBTElEX0NPREU6ICdhdXRoL2ludmFsaWQtdmVyaWZpY2F0aW9uLWNvZGUnLFxuICAgIElOVkFMSURfQ09OVElOVUVfVVJJOiAnYXV0aC9pbnZhbGlkLWNvbnRpbnVlLXVyaScsXG4gICAgSU5WQUxJRF9DT1JET1ZBX0NPTkZJR1VSQVRJT046ICdhdXRoL2ludmFsaWQtY29yZG92YS1jb25maWd1cmF0aW9uJyxcbiAgICBJTlZBTElEX0NVU1RPTV9UT0tFTjogJ2F1dGgvaW52YWxpZC1jdXN0b20tdG9rZW4nLFxuICAgIElOVkFMSURfRFlOQU1JQ19MSU5LX0RPTUFJTjogJ2F1dGgvaW52YWxpZC1keW5hbWljLWxpbmstZG9tYWluJyxcbiAgICBJTlZBTElEX0VNQUlMOiAnYXV0aC9pbnZhbGlkLWVtYWlsJyxcbiAgICBJTlZBTElEX0VNVUxBVE9SX1NDSEVNRTogJ2F1dGgvaW52YWxpZC1lbXVsYXRvci1zY2hlbWUnLFxuICAgIElOVkFMSURfSURQX1JFU1BPTlNFOiAnYXV0aC9pbnZhbGlkLWNyZWRlbnRpYWwnLFxuICAgIElOVkFMSURfTE9HSU5fQ1JFREVOVElBTFM6ICdhdXRoL2ludmFsaWQtY3JlZGVudGlhbCcsXG4gICAgSU5WQUxJRF9NRVNTQUdFX1BBWUxPQUQ6ICdhdXRoL2ludmFsaWQtbWVzc2FnZS1wYXlsb2FkJyxcbiAgICBJTlZBTElEX01GQV9TRVNTSU9OOiAnYXV0aC9pbnZhbGlkLW11bHRpLWZhY3Rvci1zZXNzaW9uJyxcbiAgICBJTlZBTElEX09BVVRIX0NMSUVOVF9JRDogJ2F1dGgvaW52YWxpZC1vYXV0aC1jbGllbnQtaWQnLFxuICAgIElOVkFMSURfT0FVVEhfUFJPVklERVI6ICdhdXRoL2ludmFsaWQtb2F1dGgtcHJvdmlkZXInLFxuICAgIElOVkFMSURfT09CX0NPREU6ICdhdXRoL2ludmFsaWQtYWN0aW9uLWNvZGUnLFxuICAgIElOVkFMSURfT1JJR0lOOiAnYXV0aC91bmF1dGhvcml6ZWQtZG9tYWluJyxcbiAgICBJTlZBTElEX1BBU1NXT1JEOiAnYXV0aC93cm9uZy1wYXNzd29yZCcsXG4gICAgSU5WQUxJRF9QRVJTSVNURU5DRTogJ2F1dGgvaW52YWxpZC1wZXJzaXN0ZW5jZS10eXBlJyxcbiAgICBJTlZBTElEX1BIT05FX05VTUJFUjogJ2F1dGgvaW52YWxpZC1waG9uZS1udW1iZXInLFxuICAgIElOVkFMSURfUFJPVklERVJfSUQ6ICdhdXRoL2ludmFsaWQtcHJvdmlkZXItaWQnLFxuICAgIElOVkFMSURfUkVDSVBJRU5UX0VNQUlMOiAnYXV0aC9pbnZhbGlkLXJlY2lwaWVudC1lbWFpbCcsXG4gICAgSU5WQUxJRF9TRU5ERVI6ICdhdXRoL2ludmFsaWQtc2VuZGVyJyxcbiAgICBJTlZBTElEX1NFU1NJT05fSU5GTzogJ2F1dGgvaW52YWxpZC12ZXJpZmljYXRpb24taWQnLFxuICAgIElOVkFMSURfVEVOQU5UX0lEOiAnYXV0aC9pbnZhbGlkLXRlbmFudC1pZCcsXG4gICAgTUZBX0lORk9fTk9UX0ZPVU5EOiAnYXV0aC9tdWx0aS1mYWN0b3ItaW5mby1ub3QtZm91bmQnLFxuICAgIE1GQV9SRVFVSVJFRDogJ2F1dGgvbXVsdGktZmFjdG9yLWF1dGgtcmVxdWlyZWQnLFxuICAgIE1JU1NJTkdfQU5EUk9JRF9QQUNLQUdFX05BTUU6ICdhdXRoL21pc3NpbmctYW5kcm9pZC1wa2ctbmFtZScsXG4gICAgTUlTU0lOR19BUFBfQ1JFREVOVElBTDogJ2F1dGgvbWlzc2luZy1hcHAtY3JlZGVudGlhbCcsXG4gICAgTUlTU0lOR19BVVRIX0RPTUFJTjogJ2F1dGgvYXV0aC1kb21haW4tY29uZmlnLXJlcXVpcmVkJyxcbiAgICBNSVNTSU5HX0NPREU6ICdhdXRoL21pc3NpbmctdmVyaWZpY2F0aW9uLWNvZGUnLFxuICAgIE1JU1NJTkdfQ09OVElOVUVfVVJJOiAnYXV0aC9taXNzaW5nLWNvbnRpbnVlLXVyaScsXG4gICAgTUlTU0lOR19JRlJBTUVfU1RBUlQ6ICdhdXRoL21pc3NpbmctaWZyYW1lLXN0YXJ0JyxcbiAgICBNSVNTSU5HX0lPU19CVU5ETEVfSUQ6ICdhdXRoL21pc3NpbmctaW9zLWJ1bmRsZS1pZCcsXG4gICAgTUlTU0lOR19PUl9JTlZBTElEX05PTkNFOiAnYXV0aC9taXNzaW5nLW9yLWludmFsaWQtbm9uY2UnLFxuICAgIE1JU1NJTkdfTUZBX0lORk86ICdhdXRoL21pc3NpbmctbXVsdGktZmFjdG9yLWluZm8nLFxuICAgIE1JU1NJTkdfTUZBX1NFU1NJT046ICdhdXRoL21pc3NpbmctbXVsdGktZmFjdG9yLXNlc3Npb24nLFxuICAgIE1JU1NJTkdfUEhPTkVfTlVNQkVSOiAnYXV0aC9taXNzaW5nLXBob25lLW51bWJlcicsXG4gICAgTUlTU0lOR19QQVNTV09SRDogJ2F1dGgvbWlzc2luZy1wYXNzd29yZCcsXG4gICAgTUlTU0lOR19TRVNTSU9OX0lORk86ICdhdXRoL21pc3NpbmctdmVyaWZpY2F0aW9uLWlkJyxcbiAgICBNT0RVTEVfREVTVFJPWUVEOiAnYXV0aC9hcHAtZGVsZXRlZCcsXG4gICAgTkVFRF9DT05GSVJNQVRJT046ICdhdXRoL2FjY291bnQtZXhpc3RzLXdpdGgtZGlmZmVyZW50LWNyZWRlbnRpYWwnLFxuICAgIE5FVFdPUktfUkVRVUVTVF9GQUlMRUQ6ICdhdXRoL25ldHdvcmstcmVxdWVzdC1mYWlsZWQnLFxuICAgIE5VTExfVVNFUjogJ2F1dGgvbnVsbC11c2VyJyxcbiAgICBOT19BVVRIX0VWRU5UOiAnYXV0aC9uby1hdXRoLWV2ZW50JyxcbiAgICBOT19TVUNIX1BST1ZJREVSOiAnYXV0aC9uby1zdWNoLXByb3ZpZGVyJyxcbiAgICBPUEVSQVRJT05fTk9UX0FMTE9XRUQ6ICdhdXRoL29wZXJhdGlvbi1ub3QtYWxsb3dlZCcsXG4gICAgT1BFUkFUSU9OX05PVF9TVVBQT1JURUQ6ICdhdXRoL29wZXJhdGlvbi1ub3Qtc3VwcG9ydGVkLWluLXRoaXMtZW52aXJvbm1lbnQnLFxuICAgIFBPUFVQX0JMT0NLRUQ6ICdhdXRoL3BvcHVwLWJsb2NrZWQnLFxuICAgIFBPUFVQX0NMT1NFRF9CWV9VU0VSOiAnYXV0aC9wb3B1cC1jbG9zZWQtYnktdXNlcicsXG4gICAgUFJPVklERVJfQUxSRUFEWV9MSU5LRUQ6ICdhdXRoL3Byb3ZpZGVyLWFscmVhZHktbGlua2VkJyxcbiAgICBRVU9UQV9FWENFRURFRDogJ2F1dGgvcXVvdGEtZXhjZWVkZWQnLFxuICAgIFJFRElSRUNUX0NBTkNFTExFRF9CWV9VU0VSOiAnYXV0aC9yZWRpcmVjdC1jYW5jZWxsZWQtYnktdXNlcicsXG4gICAgUkVESVJFQ1RfT1BFUkFUSU9OX1BFTkRJTkc6ICdhdXRoL3JlZGlyZWN0LW9wZXJhdGlvbi1wZW5kaW5nJyxcbiAgICBSRUpFQ1RFRF9DUkVERU5USUFMOiAnYXV0aC9yZWplY3RlZC1jcmVkZW50aWFsJyxcbiAgICBTRUNPTkRfRkFDVE9SX0FMUkVBRFlfRU5ST0xMRUQ6ICdhdXRoL3NlY29uZC1mYWN0b3ItYWxyZWFkeS1pbi11c2UnLFxuICAgIFNFQ09ORF9GQUNUT1JfTElNSVRfRVhDRUVERUQ6ICdhdXRoL21heGltdW0tc2Vjb25kLWZhY3Rvci1jb3VudC1leGNlZWRlZCcsXG4gICAgVEVOQU5UX0lEX01JU01BVENIOiAnYXV0aC90ZW5hbnQtaWQtbWlzbWF0Y2gnLFxuICAgIFRJTUVPVVQ6ICdhdXRoL3RpbWVvdXQnLFxuICAgIFRPS0VOX0VYUElSRUQ6ICdhdXRoL3VzZXItdG9rZW4tZXhwaXJlZCcsXG4gICAgVE9PX01BTllfQVRURU1QVFNfVFJZX0xBVEVSOiAnYXV0aC90b28tbWFueS1yZXF1ZXN0cycsXG4gICAgVU5BVVRIT1JJWkVEX0RPTUFJTjogJ2F1dGgvdW5hdXRob3JpemVkLWNvbnRpbnVlLXVyaScsXG4gICAgVU5TVVBQT1JURURfRklSU1RfRkFDVE9SOiAnYXV0aC91bnN1cHBvcnRlZC1maXJzdC1mYWN0b3InLFxuICAgIFVOU1VQUE9SVEVEX1BFUlNJU1RFTkNFOiAnYXV0aC91bnN1cHBvcnRlZC1wZXJzaXN0ZW5jZS10eXBlJyxcbiAgICBVTlNVUFBPUlRFRF9URU5BTlRfT1BFUkFUSU9OOiAnYXV0aC91bnN1cHBvcnRlZC10ZW5hbnQtb3BlcmF0aW9uJyxcbiAgICBVTlZFUklGSUVEX0VNQUlMOiAnYXV0aC91bnZlcmlmaWVkLWVtYWlsJyxcbiAgICBVU0VSX0NBTkNFTExFRDogJ2F1dGgvdXNlci1jYW5jZWxsZWQnLFxuICAgIFVTRVJfREVMRVRFRDogJ2F1dGgvdXNlci1ub3QtZm91bmQnLFxuICAgIFVTRVJfRElTQUJMRUQ6ICdhdXRoL3VzZXItZGlzYWJsZWQnLFxuICAgIFVTRVJfTUlTTUFUQ0g6ICdhdXRoL3VzZXItbWlzbWF0Y2gnLFxuICAgIFVTRVJfU0lHTkVEX09VVDogJ2F1dGgvdXNlci1zaWduZWQtb3V0JyxcbiAgICBXRUFLX1BBU1NXT1JEOiAnYXV0aC93ZWFrLXBhc3N3b3JkJyxcbiAgICBXRUJfU1RPUkFHRV9VTlNVUFBPUlRFRDogJ2F1dGgvd2ViLXN0b3JhZ2UtdW5zdXBwb3J0ZWQnLFxuICAgIEFMUkVBRFlfSU5JVElBTElaRUQ6ICdhdXRoL2FscmVhZHktaW5pdGlhbGl6ZWQnLFxuICAgIFJFQ0FQVENIQV9OT1RfRU5BQkxFRDogJ2F1dGgvcmVjYXB0Y2hhLW5vdC1lbmFibGVkJyxcbiAgICBNSVNTSU5HX1JFQ0FQVENIQV9UT0tFTjogJ2F1dGgvbWlzc2luZy1yZWNhcHRjaGEtdG9rZW4nLFxuICAgIElOVkFMSURfUkVDQVBUQ0hBX1RPS0VOOiAnYXV0aC9pbnZhbGlkLXJlY2FwdGNoYS10b2tlbicsXG4gICAgSU5WQUxJRF9SRUNBUFRDSEFfQUNUSU9OOiAnYXV0aC9pbnZhbGlkLXJlY2FwdGNoYS1hY3Rpb24nLFxuICAgIE1JU1NJTkdfQ0xJRU5UX1RZUEU6ICdhdXRoL21pc3NpbmctY2xpZW50LXR5cGUnLFxuICAgIE1JU1NJTkdfUkVDQVBUQ0hBX1ZFUlNJT046ICdhdXRoL21pc3NpbmctcmVjYXB0Y2hhLXZlcnNpb24nLFxuICAgIElOVkFMSURfUkVDQVBUQ0hBX1ZFUlNJT046ICdhdXRoL2ludmFsaWQtcmVjYXB0Y2hhLXZlcnNpb24nLFxuICAgIElOVkFMSURfUkVRX1RZUEU6ICdhdXRoL2ludmFsaWQtcmVxLXR5cGUnLFxuICAgIElOVkFMSURfSE9TVElOR19MSU5LX0RPTUFJTjogJ2F1dGgvaW52YWxpZC1ob3N0aW5nLWxpbmstZG9tYWluJ1xufTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IGxvZ0NsaWVudCA9IG5ldyBMb2dnZXIoJ0BmaXJlYmFzZS9hdXRoJyk7XG5mdW5jdGlvbiBfbG9nV2Fybihtc2csIC4uLmFyZ3MpIHtcbiAgICBpZiAobG9nQ2xpZW50LmxvZ0xldmVsIDw9IExvZ0xldmVsLldBUk4pIHtcbiAgICAgICAgbG9nQ2xpZW50Lndhcm4oYEF1dGggKCR7U0RLX1ZFUlNJT059KTogJHttc2d9YCwgLi4uYXJncyk7XG4gICAgfVxufVxuZnVuY3Rpb24gX2xvZ0Vycm9yKG1zZywgLi4uYXJncykge1xuICAgIGlmIChsb2dDbGllbnQubG9nTGV2ZWwgPD0gTG9nTGV2ZWwuRVJST1IpIHtcbiAgICAgICAgbG9nQ2xpZW50LmVycm9yKGBBdXRoICgke1NES19WRVJTSU9OfSk6ICR7bXNnfWAsIC4uLmFyZ3MpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmZ1bmN0aW9uIF9mYWlsKGF1dGhPckNvZGUsIC4uLnJlc3QpIHtcbiAgICB0aHJvdyBjcmVhdGVFcnJvckludGVybmFsKGF1dGhPckNvZGUsIC4uLnJlc3QpO1xufVxuZnVuY3Rpb24gX2NyZWF0ZUVycm9yKGF1dGhPckNvZGUsIC4uLnJlc3QpIHtcbiAgICByZXR1cm4gY3JlYXRlRXJyb3JJbnRlcm5hbChhdXRoT3JDb2RlLCAuLi5yZXN0KTtcbn1cbmZ1bmN0aW9uIF9lcnJvcldpdGhDdXN0b21NZXNzYWdlKGF1dGgsIGNvZGUsIG1lc3NhZ2UpIHtcbiAgICBjb25zdCBlcnJvck1hcCA9IHtcbiAgICAgICAgLi4ucHJvZEVycm9yTWFwKCksXG4gICAgICAgIFtjb2RlXTogbWVzc2FnZVxuICAgIH07XG4gICAgY29uc3QgZmFjdG9yeSA9IG5ldyBFcnJvckZhY3RvcnkoJ2F1dGgnLCAnRmlyZWJhc2UnLCBlcnJvck1hcCk7XG4gICAgcmV0dXJuIGZhY3RvcnkuY3JlYXRlKGNvZGUsIHtcbiAgICAgICAgYXBwTmFtZTogYXV0aC5uYW1lXG4gICAgfSk7XG59XG5mdW5jdGlvbiBfc2VydmVyQXBwQ3VycmVudFVzZXJPcGVyYXRpb25Ob3RTdXBwb3J0ZWRFcnJvcihhdXRoKSB7XG4gICAgcmV0dXJuIF9lcnJvcldpdGhDdXN0b21NZXNzYWdlKGF1dGgsIFwib3BlcmF0aW9uLW5vdC1zdXBwb3J0ZWQtaW4tdGhpcy1lbnZpcm9ubWVudFwiIC8qIEF1dGhFcnJvckNvZGUuT1BFUkFUSU9OX05PVF9TVVBQT1JURUQgKi8sICdPcGVyYXRpb25zIHRoYXQgYWx0ZXIgdGhlIGN1cnJlbnQgdXNlciBhcmUgbm90IHN1cHBvcnRlZCBpbiBjb25qdW5jdGlvbiB3aXRoIEZpcmViYXNlU2VydmVyQXBwJyk7XG59XG5mdW5jdGlvbiBfYXNzZXJ0SW5zdGFuY2VPZihhdXRoLCBvYmplY3QsIGluc3RhbmNlKSB7XG4gICAgY29uc3QgY29uc3RydWN0b3JJbnN0YW5jZSA9IGluc3RhbmNlO1xuICAgIGlmICghKG9iamVjdCBpbnN0YW5jZW9mIGNvbnN0cnVjdG9ySW5zdGFuY2UpKSB7XG4gICAgICAgIGlmIChjb25zdHJ1Y3Rvckluc3RhbmNlLm5hbWUgIT09IG9iamVjdC5jb25zdHJ1Y3Rvci5uYW1lKSB7XG4gICAgICAgICAgICBfZmFpbChhdXRoLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUiAqLyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgX2Vycm9yV2l0aEN1c3RvbU1lc3NhZ2UoYXV0aCwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IgKi8sIGBUeXBlIG9mICR7b2JqZWN0LmNvbnN0cnVjdG9yLm5hbWV9IGRvZXMgbm90IG1hdGNoIGV4cGVjdGVkIGluc3RhbmNlLmAgK1xuICAgICAgICAgICAgYERpZCB5b3UgcGFzcyBhIHJlZmVyZW5jZSBmcm9tIGEgZGlmZmVyZW50IEF1dGggU0RLP2ApO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNyZWF0ZUVycm9ySW50ZXJuYWwoYXV0aE9yQ29kZSwgLi4ucmVzdCkge1xuICAgIGlmICh0eXBlb2YgYXV0aE9yQ29kZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgY29uc3QgY29kZSA9IHJlc3RbMF07XG4gICAgICAgIGNvbnN0IGZ1bGxQYXJhbXMgPSBbLi4ucmVzdC5zbGljZSgxKV07XG4gICAgICAgIGlmIChmdWxsUGFyYW1zWzBdKSB7XG4gICAgICAgICAgICBmdWxsUGFyYW1zWzBdLmFwcE5hbWUgPSBhdXRoT3JDb2RlLm5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGF1dGhPckNvZGUuX2Vycm9yRmFjdG9yeS5jcmVhdGUoY29kZSwgLi4uZnVsbFBhcmFtcyk7XG4gICAgfVxuICAgIHJldHVybiBfREVGQVVMVF9BVVRIX0VSUk9SX0ZBQ1RPUlkuY3JlYXRlKGF1dGhPckNvZGUsIC4uLnJlc3QpO1xufVxuZnVuY3Rpb24gX2Fzc2VydChhc3NlcnRpb24sIGF1dGhPckNvZGUsIC4uLnJlc3QpIHtcbiAgICBpZiAoIWFzc2VydGlvbikge1xuICAgICAgICB0aHJvdyBjcmVhdGVFcnJvckludGVybmFsKGF1dGhPckNvZGUsIC4uLnJlc3QpO1xuICAgIH1cbn1cbi8qKlxuICogVW5jb25kaXRpb25hbGx5IGZhaWxzLCB0aHJvd2luZyBhbiBpbnRlcm5hbCBlcnJvciB3aXRoIHRoZSBnaXZlbiBtZXNzYWdlLlxuICpcbiAqIEBwYXJhbSBmYWlsdXJlIHR5cGUgb2YgZmFpbHVyZSBlbmNvdW50ZXJlZFxuICogQHRocm93cyBFcnJvclxuICovXG5mdW5jdGlvbiBkZWJ1Z0ZhaWwoZmFpbHVyZSkge1xuICAgIC8vIExvZyB0aGUgZmFpbHVyZSBpbiBhZGRpdGlvbiB0byB0aHJvdyBhbiBleGNlcHRpb24sIGp1c3QgaW4gY2FzZSB0aGVcbiAgICAvLyBleGNlcHRpb24gaXMgc3dhbGxvd2VkLlxuICAgIGNvbnN0IG1lc3NhZ2UgPSBgSU5URVJOQUwgQVNTRVJUSU9OIEZBSUxFRDogYCArIGZhaWx1cmU7XG4gICAgX2xvZ0Vycm9yKG1lc3NhZ2UpO1xuICAgIC8vIE5PVEU6IFdlIGRvbid0IHVzZSBGaXJlYmFzZUVycm9yIGhlcmUgYmVjYXVzZSB0aGVzZSBhcmUgaW50ZXJuYWwgZmFpbHVyZXNcbiAgICAvLyB0aGF0IGNhbm5vdCBiZSBoYW5kbGVkIGJ5IHRoZSB1c2VyLiAoQWxzbyBpdCB3b3VsZCBjcmVhdGUgYSBjaXJjdWxhclxuICAgIC8vIGRlcGVuZGVuY3kgYmV0d2VlbiB0aGUgZXJyb3IgYW5kIGFzc2VydCBtb2R1bGVzIHdoaWNoIGRvZXNuJ3Qgd29yay4pXG4gICAgdGhyb3cgbmV3IEVycm9yKG1lc3NhZ2UpO1xufVxuLyoqXG4gKiBGYWlscyBpZiB0aGUgZ2l2ZW4gYXNzZXJ0aW9uIGNvbmRpdGlvbiBpcyBmYWxzZSwgdGhyb3dpbmcgYW4gRXJyb3Igd2l0aCB0aGVcbiAqIGdpdmVuIG1lc3NhZ2UgaWYgaXQgZGlkLlxuICpcbiAqIEBwYXJhbSBhc3NlcnRpb25cbiAqIEBwYXJhbSBtZXNzYWdlXG4gKi9cbmZ1bmN0aW9uIGRlYnVnQXNzZXJ0KGFzc2VydGlvbiwgbWVzc2FnZSkge1xuICAgIGlmICghYXNzZXJ0aW9uKSB7XG4gICAgICAgIGRlYnVnRmFpbChtZXNzYWdlKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5mdW5jdGlvbiBfZ2V0Q3VycmVudFVybCgpIHtcbiAgICByZXR1cm4gKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyAmJiBzZWxmLmxvY2F0aW9uPy5ocmVmKSB8fCAnJztcbn1cbmZ1bmN0aW9uIF9pc0h0dHBPckh0dHBzKCkge1xuICAgIHJldHVybiBfZ2V0Q3VycmVudFNjaGVtZSgpID09PSAnaHR0cDonIHx8IF9nZXRDdXJyZW50U2NoZW1lKCkgPT09ICdodHRwczonO1xufVxuZnVuY3Rpb24gX2dldEN1cnJlbnRTY2hlbWUoKSB7XG4gICAgcmV0dXJuICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgJiYgc2VsZi5sb2NhdGlvbj8ucHJvdG9jb2wpIHx8IG51bGw7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIERldGVybWluZSB3aGV0aGVyIHRoZSBicm93c2VyIGlzIHdvcmtpbmcgb25saW5lXG4gKi9cbmZ1bmN0aW9uIF9pc09ubGluZSgpIHtcbiAgICBpZiAodHlwZW9mIG5hdmlnYXRvciAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgICAgbmF2aWdhdG9yICYmXG4gICAgICAgICdvbkxpbmUnIGluIG5hdmlnYXRvciAmJlxuICAgICAgICB0eXBlb2YgbmF2aWdhdG9yLm9uTGluZSA9PT0gJ2Jvb2xlYW4nICYmXG4gICAgICAgIC8vIEFwcGx5IG9ubHkgZm9yIHRyYWRpdGlvbmFsIHdlYiBhcHBzIGFuZCBDaHJvbWUgZXh0ZW5zaW9ucy5cbiAgICAgICAgLy8gVGhpcyBpcyBlc3BlY2lhbGx5IHRydWUgZm9yIENvcmRvdmEgYXBwcyB3aGljaCBoYXZlIHVucmVsaWFibGVcbiAgICAgICAgLy8gbmF2aWdhdG9yLm9uTGluZSBiZWhhdmlvciB1bmxlc3MgY29yZG92YS1wbHVnaW4tbmV0d29yay1pbmZvcm1hdGlvbiBpc1xuICAgICAgICAvLyBpbnN0YWxsZWQgd2hpY2ggb3ZlcndyaXRlcyB0aGUgbmF0aXZlIG5hdmlnYXRvci5vbkxpbmUgdmFsdWUgYW5kXG4gICAgICAgIC8vIGRlZmluZXMgbmF2aWdhdG9yLmNvbm5lY3Rpb24uXG4gICAgICAgIChfaXNIdHRwT3JIdHRwcygpIHx8IGlzQnJvd3NlckV4dGVuc2lvbigpIHx8ICdjb25uZWN0aW9uJyBpbiBuYXZpZ2F0b3IpKSB7XG4gICAgICAgIHJldHVybiBuYXZpZ2F0b3Iub25MaW5lO1xuICAgIH1cbiAgICAvLyBJZiB3ZSBjYW4ndCBkZXRlcm1pbmUgdGhlIHN0YXRlLCBhc3N1bWUgaXQgaXMgb25saW5lLlxuICAgIHJldHVybiB0cnVlO1xufVxuZnVuY3Rpb24gX2dldFVzZXJMYW5ndWFnZSgpIHtcbiAgICBpZiAodHlwZW9mIG5hdmlnYXRvciA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IG5hdmlnYXRvckxhbmd1YWdlID0gbmF2aWdhdG9yO1xuICAgIHJldHVybiAoXG4gICAgLy8gTW9zdCByZWxpYWJsZSwgYnV0IG9ubHkgc3VwcG9ydGVkIGluIENocm9tZS9GaXJlZm94LlxuICAgIChuYXZpZ2F0b3JMYW5ndWFnZS5sYW5ndWFnZXMgJiYgbmF2aWdhdG9yTGFuZ3VhZ2UubGFuZ3VhZ2VzWzBdKSB8fFxuICAgICAgICAvLyBTdXBwb3J0ZWQgaW4gbW9zdCBicm93c2VycywgYnV0IHJldHVybnMgdGhlIGxhbmd1YWdlIG9mIHRoZSBicm93c2VyXG4gICAgICAgIC8vIFVJLCBub3QgdGhlIGxhbmd1YWdlIHNldCBpbiBicm93c2VyIHNldHRpbmdzLlxuICAgICAgICBuYXZpZ2F0b3JMYW5ndWFnZS5sYW5ndWFnZSB8fFxuICAgICAgICAvLyBDb3VsZG4ndCBkZXRlcm1pbmUgbGFuZ3VhZ2UuXG4gICAgICAgIG51bGwpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIHN0cnVjdHVyZSB0byBoZWxwIHBpY2sgYmV0d2VlbiBhIHJhbmdlIG9mIGxvbmcgYW5kIHNob3J0IGRlbGF5IGR1cmF0aW9uc1xuICogZGVwZW5kaW5nIG9uIHRoZSBjdXJyZW50IGVudmlyb25tZW50LiBJbiBnZW5lcmFsLCB0aGUgbG9uZyBkZWxheSBpcyB1c2VkIGZvclxuICogbW9iaWxlIGVudmlyb25tZW50cyB3aGVyZWFzIHNob3J0IGRlbGF5cyBhcmUgdXNlZCBmb3IgZGVza3RvcCBlbnZpcm9ubWVudHMuXG4gKi9cbmNsYXNzIERlbGF5IHtcbiAgICBjb25zdHJ1Y3RvcihzaG9ydERlbGF5LCBsb25nRGVsYXkpIHtcbiAgICAgICAgdGhpcy5zaG9ydERlbGF5ID0gc2hvcnREZWxheTtcbiAgICAgICAgdGhpcy5sb25nRGVsYXkgPSBsb25nRGVsYXk7XG4gICAgICAgIC8vIEludGVybmFsIGVycm9yIHdoZW4gaW1wcm9wZXJseSBpbml0aWFsaXplZC5cbiAgICAgICAgZGVidWdBc3NlcnQobG9uZ0RlbGF5ID4gc2hvcnREZWxheSwgJ1Nob3J0IGRlbGF5IHNob3VsZCBiZSBsZXNzIHRoYW4gbG9uZyBkZWxheSEnKTtcbiAgICAgICAgdGhpcy5pc01vYmlsZSA9IGlzTW9iaWxlQ29yZG92YSgpIHx8IGlzUmVhY3ROYXRpdmUoKTtcbiAgICB9XG4gICAgZ2V0KCkge1xuICAgICAgICBpZiAoIV9pc09ubGluZSgpKSB7XG4gICAgICAgICAgICAvLyBQaWNrIHRoZSBzaG9ydGVyIHRpbWVvdXQuXG4gICAgICAgICAgICByZXR1cm4gTWF0aC5taW4oNTAwMCAvKiBEZWxheU1pbi5PRkZMSU5FICovLCB0aGlzLnNob3J0RGVsYXkpO1xuICAgICAgICB9XG4gICAgICAgIC8vIElmIHJ1bm5pbmcgaW4gYSBtb2JpbGUgZW52aXJvbm1lbnQsIHJldHVybiB0aGUgbG9uZyBkZWxheSwgb3RoZXJ3aXNlXG4gICAgICAgIC8vIHJldHVybiB0aGUgc2hvcnQgZGVsYXkuXG4gICAgICAgIC8vIFRoaXMgY291bGQgYmUgaW1wcm92ZWQgaW4gdGhlIGZ1dHVyZSB0byBkeW5hbWljYWxseSBjaGFuZ2UgYmFzZWQgb24gb3RoZXJcbiAgICAgICAgLy8gdmFyaWFibGVzIGluc3RlYWQgb2YganVzdCByZWFkaW5nIHRoZSBjdXJyZW50IGVudmlyb25tZW50LlxuICAgICAgICByZXR1cm4gdGhpcy5pc01vYmlsZSA/IHRoaXMubG9uZ0RlbGF5IDogdGhpcy5zaG9ydERlbGF5O1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmZ1bmN0aW9uIF9lbXVsYXRvclVybChjb25maWcsIHBhdGgpIHtcbiAgICBkZWJ1Z0Fzc2VydChjb25maWcuZW11bGF0b3IsICdFbXVsYXRvciBzaG91bGQgYWx3YXlzIGJlIHNldCBoZXJlJyk7XG4gICAgY29uc3QgeyB1cmwgfSA9IGNvbmZpZy5lbXVsYXRvcjtcbiAgICBpZiAoIXBhdGgpIHtcbiAgICAgICAgcmV0dXJuIHVybDtcbiAgICB9XG4gICAgcmV0dXJuIGAke3VybH0ke3BhdGguc3RhcnRzV2l0aCgnLycpID8gcGF0aC5zbGljZSgxKSA6IHBhdGh9YDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNsYXNzIEZldGNoUHJvdmlkZXIge1xuICAgIHN0YXRpYyBpbml0aWFsaXplKGZldGNoSW1wbCwgaGVhZGVyc0ltcGwsIHJlc3BvbnNlSW1wbCkge1xuICAgICAgICB0aGlzLmZldGNoSW1wbCA9IGZldGNoSW1wbDtcbiAgICAgICAgaWYgKGhlYWRlcnNJbXBsKSB7XG4gICAgICAgICAgICB0aGlzLmhlYWRlcnNJbXBsID0gaGVhZGVyc0ltcGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlc3BvbnNlSW1wbCkge1xuICAgICAgICAgICAgdGhpcy5yZXNwb25zZUltcGwgPSByZXNwb25zZUltcGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGZldGNoKCkge1xuICAgICAgICBpZiAodGhpcy5mZXRjaEltcGwpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZldGNoSW1wbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnICYmICdmZXRjaCcgaW4gc2VsZikge1xuICAgICAgICAgICAgcmV0dXJuIHNlbGYuZmV0Y2g7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyAmJiBnbG9iYWxUaGlzLmZldGNoKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsVGhpcy5mZXRjaDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGZldGNoICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgcmV0dXJuIGZldGNoO1xuICAgICAgICB9XG4gICAgICAgIGRlYnVnRmFpbCgnQ291bGQgbm90IGZpbmQgZmV0Y2ggaW1wbGVtZW50YXRpb24sIG1ha2Ugc3VyZSB5b3UgY2FsbCBGZXRjaFByb3ZpZGVyLmluaXRpYWxpemUoKSB3aXRoIGFuIGFwcHJvcHJpYXRlIHBvbHlmaWxsJyk7XG4gICAgfVxuICAgIHN0YXRpYyBoZWFkZXJzKCkge1xuICAgICAgICBpZiAodGhpcy5oZWFkZXJzSW1wbCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGVhZGVyc0ltcGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyAmJiAnSGVhZGVycycgaW4gc2VsZikge1xuICAgICAgICAgICAgcmV0dXJuIHNlbGYuSGVhZGVycztcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGdsb2JhbFRoaXMgIT09ICd1bmRlZmluZWQnICYmIGdsb2JhbFRoaXMuSGVhZGVycykge1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbFRoaXMuSGVhZGVycztcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIEhlYWRlcnMgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICByZXR1cm4gSGVhZGVycztcbiAgICAgICAgfVxuICAgICAgICBkZWJ1Z0ZhaWwoJ0NvdWxkIG5vdCBmaW5kIEhlYWRlcnMgaW1wbGVtZW50YXRpb24sIG1ha2Ugc3VyZSB5b3UgY2FsbCBGZXRjaFByb3ZpZGVyLmluaXRpYWxpemUoKSB3aXRoIGFuIGFwcHJvcHJpYXRlIHBvbHlmaWxsJyk7XG4gICAgfVxuICAgIHN0YXRpYyByZXNwb25zZSgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVzcG9uc2VJbXBsKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZXNwb25zZUltcGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyAmJiAnUmVzcG9uc2UnIGluIHNlbGYpIHtcbiAgICAgICAgICAgIHJldHVybiBzZWxmLlJlc3BvbnNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZ2xvYmFsVGhpcyAhPT0gJ3VuZGVmaW5lZCcgJiYgZ2xvYmFsVGhpcy5SZXNwb25zZSkge1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbFRoaXMuUmVzcG9uc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBSZXNwb25zZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHJldHVybiBSZXNwb25zZTtcbiAgICAgICAgfVxuICAgICAgICBkZWJ1Z0ZhaWwoJ0NvdWxkIG5vdCBmaW5kIFJlc3BvbnNlIGltcGxlbWVudGF0aW9uLCBtYWtlIHN1cmUgeW91IGNhbGwgRmV0Y2hQcm92aWRlci5pbml0aWFsaXplKCkgd2l0aCBhbiBhcHByb3ByaWF0ZSBwb2x5ZmlsbCcpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogTWFwIGZyb20gZXJyb3JzIHJldHVybmVkIGJ5IHRoZSBzZXJ2ZXIgdG8gZXJyb3JzIHRvIGRldmVsb3BlciB2aXNpYmxlIGVycm9yc1xuICovXG5jb25zdCBTRVJWRVJfRVJST1JfTUFQID0ge1xuICAgIC8vIEN1c3RvbSB0b2tlbiBlcnJvcnMuXG4gICAgW1wiQ1JFREVOVElBTF9NSVNNQVRDSFwiIC8qIFNlcnZlckVycm9yLkNSRURFTlRJQUxfTUlTTUFUQ0ggKi9dOiBcImN1c3RvbS10b2tlbi1taXNtYXRjaFwiIC8qIEF1dGhFcnJvckNvZGUuQ1JFREVOVElBTF9NSVNNQVRDSCAqLyxcbiAgICAvLyBUaGlzIGNhbiBvbmx5IGhhcHBlbiBpZiB0aGUgU0RLIHNlbmRzIGEgYmFkIHJlcXVlc3QuXG4gICAgW1wiTUlTU0lOR19DVVNUT01fVE9LRU5cIiAvKiBTZXJ2ZXJFcnJvci5NSVNTSU5HX0NVU1RPTV9UT0tFTiAqL106IFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovLFxuICAgIC8vIENyZWF0ZSBBdXRoIFVSSSBlcnJvcnMuXG4gICAgW1wiSU5WQUxJRF9JREVOVElGSUVSXCIgLyogU2VydmVyRXJyb3IuSU5WQUxJRF9JREVOVElGSUVSICovXTogXCJpbnZhbGlkLWVtYWlsXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0VNQUlMICovLFxuICAgIC8vIFRoaXMgY2FuIG9ubHkgaGFwcGVuIGlmIHRoZSBTREsgc2VuZHMgYSBiYWQgcmVxdWVzdC5cbiAgICBbXCJNSVNTSU5HX0NPTlRJTlVFX1VSSVwiIC8qIFNlcnZlckVycm9yLk1JU1NJTkdfQ09OVElOVUVfVVJJICovXTogXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8sXG4gICAgLy8gU2lnbiBpbiB3aXRoIGVtYWlsIGFuZCBwYXNzd29yZCBlcnJvcnMgKHNvbWUgYXBwbHkgdG8gc2lnbiB1cCB0b28pLlxuICAgIFtcIklOVkFMSURfUEFTU1dPUkRcIiAvKiBTZXJ2ZXJFcnJvci5JTlZBTElEX1BBU1NXT1JEICovXTogXCJ3cm9uZy1wYXNzd29yZFwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9QQVNTV09SRCAqLyxcbiAgICAvLyBUaGlzIGNhbiBvbmx5IGhhcHBlbiBpZiB0aGUgU0RLIHNlbmRzIGEgYmFkIHJlcXVlc3QuXG4gICAgW1wiTUlTU0lOR19QQVNTV09SRFwiIC8qIFNlcnZlckVycm9yLk1JU1NJTkdfUEFTU1dPUkQgKi9dOiBcIm1pc3NpbmctcGFzc3dvcmRcIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfUEFTU1dPUkQgKi8sXG4gICAgLy8gVGhyb3duIGlmIEVtYWlsIEVudW1lcmF0aW9uIFByb3RlY3Rpb24gaXMgZW5hYmxlZCBpbiB0aGUgcHJvamVjdCBhbmQgdGhlIGVtYWlsIG9yIHBhc3N3b3JkIGlzXG4gICAgLy8gaW52YWxpZC5cbiAgICBbXCJJTlZBTElEX0xPR0lOX0NSRURFTlRJQUxTXCIgLyogU2VydmVyRXJyb3IuSU5WQUxJRF9MT0dJTl9DUkVERU5USUFMUyAqL106IFwiaW52YWxpZC1jcmVkZW50aWFsXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0NSRURFTlRJQUwgKi8sXG4gICAgLy8gU2lnbiB1cCB3aXRoIGVtYWlsIGFuZCBwYXNzd29yZCBlcnJvcnMuXG4gICAgW1wiRU1BSUxfRVhJU1RTXCIgLyogU2VydmVyRXJyb3IuRU1BSUxfRVhJU1RTICovXTogXCJlbWFpbC1hbHJlYWR5LWluLXVzZVwiIC8qIEF1dGhFcnJvckNvZGUuRU1BSUxfRVhJU1RTICovLFxuICAgIFtcIlBBU1NXT1JEX0xPR0lOX0RJU0FCTEVEXCIgLyogU2VydmVyRXJyb3IuUEFTU1dPUkRfTE9HSU5fRElTQUJMRUQgKi9dOiBcIm9wZXJhdGlvbi1ub3QtYWxsb3dlZFwiIC8qIEF1dGhFcnJvckNvZGUuT1BFUkFUSU9OX05PVF9BTExPV0VEICovLFxuICAgIC8vIFZlcmlmeSBhc3NlcnRpb24gZm9yIHNpZ24gaW4gd2l0aCBjcmVkZW50aWFsIGVycm9yczpcbiAgICBbXCJJTlZBTElEX0lEUF9SRVNQT05TRVwiIC8qIFNlcnZlckVycm9yLklOVkFMSURfSURQX1JFU1BPTlNFICovXTogXCJpbnZhbGlkLWNyZWRlbnRpYWxcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfQ1JFREVOVElBTCAqLyxcbiAgICBbXCJJTlZBTElEX1BFTkRJTkdfVE9LRU5cIiAvKiBTZXJ2ZXJFcnJvci5JTlZBTElEX1BFTkRJTkdfVE9LRU4gKi9dOiBcImludmFsaWQtY3JlZGVudGlhbFwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9DUkVERU5USUFMICovLFxuICAgIFtcIkZFREVSQVRFRF9VU0VSX0lEX0FMUkVBRFlfTElOS0VEXCIgLyogU2VydmVyRXJyb3IuRkVERVJBVEVEX1VTRVJfSURfQUxSRUFEWV9MSU5LRUQgKi9dOiBcImNyZWRlbnRpYWwtYWxyZWFkeS1pbi11c2VcIiAvKiBBdXRoRXJyb3JDb2RlLkNSRURFTlRJQUxfQUxSRUFEWV9JTl9VU0UgKi8sXG4gICAgLy8gVGhpcyBjYW4gb25seSBoYXBwZW4gaWYgdGhlIFNESyBzZW5kcyBhIGJhZCByZXF1ZXN0LlxuICAgIFtcIk1JU1NJTkdfUkVRX1RZUEVcIiAvKiBTZXJ2ZXJFcnJvci5NSVNTSU5HX1JFUV9UWVBFICovXTogXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8sXG4gICAgLy8gU2VuZCBQYXNzd29yZCByZXNldCBlbWFpbCBlcnJvcnM6XG4gICAgW1wiRU1BSUxfTk9UX0ZPVU5EXCIgLyogU2VydmVyRXJyb3IuRU1BSUxfTk9UX0ZPVU5EICovXTogXCJ1c2VyLW5vdC1mb3VuZFwiIC8qIEF1dGhFcnJvckNvZGUuVVNFUl9ERUxFVEVEICovLFxuICAgIFtcIlJFU0VUX1BBU1NXT1JEX0VYQ0VFRF9MSU1JVFwiIC8qIFNlcnZlckVycm9yLlJFU0VUX1BBU1NXT1JEX0VYQ0VFRF9MSU1JVCAqL106IFwidG9vLW1hbnktcmVxdWVzdHNcIiAvKiBBdXRoRXJyb3JDb2RlLlRPT19NQU5ZX0FUVEVNUFRTX1RSWV9MQVRFUiAqLyxcbiAgICBbXCJFWFBJUkVEX09PQl9DT0RFXCIgLyogU2VydmVyRXJyb3IuRVhQSVJFRF9PT0JfQ09ERSAqL106IFwiZXhwaXJlZC1hY3Rpb24tY29kZVwiIC8qIEF1dGhFcnJvckNvZGUuRVhQSVJFRF9PT0JfQ09ERSAqLyxcbiAgICBbXCJJTlZBTElEX09PQl9DT0RFXCIgLyogU2VydmVyRXJyb3IuSU5WQUxJRF9PT0JfQ09ERSAqL106IFwiaW52YWxpZC1hY3Rpb24tY29kZVwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9PT0JfQ09ERSAqLyxcbiAgICAvLyBUaGlzIGNhbiBvbmx5IGhhcHBlbiBpZiB0aGUgU0RLIHNlbmRzIGEgYmFkIHJlcXVlc3QuXG4gICAgW1wiTUlTU0lOR19PT0JfQ09ERVwiIC8qIFNlcnZlckVycm9yLk1JU1NJTkdfT09CX0NPREUgKi9dOiBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyxcbiAgICAvLyBPcGVyYXRpb25zIHRoYXQgcmVxdWlyZSBJRCB0b2tlbiBpbiByZXF1ZXN0OlxuICAgIFtcIkNSRURFTlRJQUxfVE9PX09MRF9MT0dJTl9BR0FJTlwiIC8qIFNlcnZlckVycm9yLkNSRURFTlRJQUxfVE9PX09MRF9MT0dJTl9BR0FJTiAqL106IFwicmVxdWlyZXMtcmVjZW50LWxvZ2luXCIgLyogQXV0aEVycm9yQ29kZS5DUkVERU5USUFMX1RPT19PTERfTE9HSU5fQUdBSU4gKi8sXG4gICAgW1wiSU5WQUxJRF9JRF9UT0tFTlwiIC8qIFNlcnZlckVycm9yLklOVkFMSURfSURfVE9LRU4gKi9dOiBcImludmFsaWQtdXNlci10b2tlblwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9BVVRIICovLFxuICAgIFtcIlRPS0VOX0VYUElSRURcIiAvKiBTZXJ2ZXJFcnJvci5UT0tFTl9FWFBJUkVEICovXTogXCJ1c2VyLXRva2VuLWV4cGlyZWRcIiAvKiBBdXRoRXJyb3JDb2RlLlRPS0VOX0VYUElSRUQgKi8sXG4gICAgW1wiVVNFUl9OT1RfRk9VTkRcIiAvKiBTZXJ2ZXJFcnJvci5VU0VSX05PVF9GT1VORCAqL106IFwidXNlci10b2tlbi1leHBpcmVkXCIgLyogQXV0aEVycm9yQ29kZS5UT0tFTl9FWFBJUkVEICovLFxuICAgIC8vIE90aGVyIGVycm9ycy5cbiAgICBbXCJUT09fTUFOWV9BVFRFTVBUU19UUllfTEFURVJcIiAvKiBTZXJ2ZXJFcnJvci5UT09fTUFOWV9BVFRFTVBUU19UUllfTEFURVIgKi9dOiBcInRvby1tYW55LXJlcXVlc3RzXCIgLyogQXV0aEVycm9yQ29kZS5UT09fTUFOWV9BVFRFTVBUU19UUllfTEFURVIgKi8sXG4gICAgW1wiUEFTU1dPUkRfRE9FU19OT1RfTUVFVF9SRVFVSVJFTUVOVFNcIiAvKiBTZXJ2ZXJFcnJvci5QQVNTV09SRF9ET0VTX05PVF9NRUVUX1JFUVVJUkVNRU5UUyAqL106IFwicGFzc3dvcmQtZG9lcy1ub3QtbWVldC1yZXF1aXJlbWVudHNcIiAvKiBBdXRoRXJyb3JDb2RlLlBBU1NXT1JEX0RPRVNfTk9UX01FRVRfUkVRVUlSRU1FTlRTICovLFxuICAgIC8vIFBob25lIEF1dGggcmVsYXRlZCBlcnJvcnMuXG4gICAgW1wiSU5WQUxJRF9DT0RFXCIgLyogU2VydmVyRXJyb3IuSU5WQUxJRF9DT0RFICovXTogXCJpbnZhbGlkLXZlcmlmaWNhdGlvbi1jb2RlXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0NPREUgKi8sXG4gICAgW1wiSU5WQUxJRF9TRVNTSU9OX0lORk9cIiAvKiBTZXJ2ZXJFcnJvci5JTlZBTElEX1NFU1NJT05fSU5GTyAqL106IFwiaW52YWxpZC12ZXJpZmljYXRpb24taWRcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfU0VTU0lPTl9JTkZPICovLFxuICAgIFtcIklOVkFMSURfVEVNUE9SQVJZX1BST09GXCIgLyogU2VydmVyRXJyb3IuSU5WQUxJRF9URU1QT1JBUllfUFJPT0YgKi9dOiBcImludmFsaWQtY3JlZGVudGlhbFwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9DUkVERU5USUFMICovLFxuICAgIFtcIk1JU1NJTkdfU0VTU0lPTl9JTkZPXCIgLyogU2VydmVyRXJyb3IuTUlTU0lOR19TRVNTSU9OX0lORk8gKi9dOiBcIm1pc3NpbmctdmVyaWZpY2F0aW9uLWlkXCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX1NFU1NJT05fSU5GTyAqLyxcbiAgICBbXCJTRVNTSU9OX0VYUElSRURcIiAvKiBTZXJ2ZXJFcnJvci5TRVNTSU9OX0VYUElSRUQgKi9dOiBcImNvZGUtZXhwaXJlZFwiIC8qIEF1dGhFcnJvckNvZGUuQ09ERV9FWFBJUkVEICovLFxuICAgIC8vIE90aGVyIGFjdGlvbiBjb2RlIGVycm9ycyB3aGVuIGFkZGl0aW9uYWwgc2V0dGluZ3MgcGFzc2VkLlxuICAgIC8vIE1JU1NJTkdfQ09OVElOVUVfVVJJIGlzIGdldHRpbmcgbWFwcGVkIHRvIElOVEVSTkFMX0VSUk9SIGFib3ZlLlxuICAgIC8vIFRoaXMgaXMgT0sgYXMgdGhpcyBlcnJvciB3aWxsIGJlIGNhdWdodCBieSBjbGllbnQgc2lkZSB2YWxpZGF0aW9uLlxuICAgIFtcIk1JU1NJTkdfQU5EUk9JRF9QQUNLQUdFX05BTUVcIiAvKiBTZXJ2ZXJFcnJvci5NSVNTSU5HX0FORFJPSURfUEFDS0FHRV9OQU1FICovXTogXCJtaXNzaW5nLWFuZHJvaWQtcGtnLW5hbWVcIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfQU5EUk9JRF9QQUNLQUdFX05BTUUgKi8sXG4gICAgW1wiVU5BVVRIT1JJWkVEX0RPTUFJTlwiIC8qIFNlcnZlckVycm9yLlVOQVVUSE9SSVpFRF9ET01BSU4gKi9dOiBcInVuYXV0aG9yaXplZC1jb250aW51ZS11cmlcIiAvKiBBdXRoRXJyb3JDb2RlLlVOQVVUSE9SSVpFRF9ET01BSU4gKi8sXG4gICAgLy8gZ2V0UHJvamVjdENvbmZpZyBlcnJvcnMgd2hlbiBjbGllbnRJZCBpcyBwYXNzZWQuXG4gICAgW1wiSU5WQUxJRF9PQVVUSF9DTElFTlRfSURcIiAvKiBTZXJ2ZXJFcnJvci5JTlZBTElEX09BVVRIX0NMSUVOVF9JRCAqL106IFwiaW52YWxpZC1vYXV0aC1jbGllbnQtaWRcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfT0FVVEhfQ0xJRU5UX0lEICovLFxuICAgIC8vIFVzZXIgYWN0aW9ucyAoc2lnbi11cCBvciBkZWxldGlvbikgZGlzYWJsZWQgZXJyb3JzLlxuICAgIFtcIkFETUlOX09OTFlfT1BFUkFUSU9OXCIgLyogU2VydmVyRXJyb3IuQURNSU5fT05MWV9PUEVSQVRJT04gKi9dOiBcImFkbWluLXJlc3RyaWN0ZWQtb3BlcmF0aW9uXCIgLyogQXV0aEVycm9yQ29kZS5BRE1JTl9PTkxZX09QRVJBVElPTiAqLyxcbiAgICAvLyBNdWx0aSBmYWN0b3IgcmVsYXRlZCBlcnJvcnMuXG4gICAgW1wiSU5WQUxJRF9NRkFfUEVORElOR19DUkVERU5USUFMXCIgLyogU2VydmVyRXJyb3IuSU5WQUxJRF9NRkFfUEVORElOR19DUkVERU5USUFMICovXTogXCJpbnZhbGlkLW11bHRpLWZhY3Rvci1zZXNzaW9uXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX01GQV9TRVNTSU9OICovLFxuICAgIFtcIk1GQV9FTlJPTExNRU5UX05PVF9GT1VORFwiIC8qIFNlcnZlckVycm9yLk1GQV9FTlJPTExNRU5UX05PVF9GT1VORCAqL106IFwibXVsdGktZmFjdG9yLWluZm8tbm90LWZvdW5kXCIgLyogQXV0aEVycm9yQ29kZS5NRkFfSU5GT19OT1RfRk9VTkQgKi8sXG4gICAgW1wiTUlTU0lOR19NRkFfRU5ST0xMTUVOVF9JRFwiIC8qIFNlcnZlckVycm9yLk1JU1NJTkdfTUZBX0VOUk9MTE1FTlRfSUQgKi9dOiBcIm1pc3NpbmctbXVsdGktZmFjdG9yLWluZm9cIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfTUZBX0lORk8gKi8sXG4gICAgW1wiTUlTU0lOR19NRkFfUEVORElOR19DUkVERU5USUFMXCIgLyogU2VydmVyRXJyb3IuTUlTU0lOR19NRkFfUEVORElOR19DUkVERU5USUFMICovXTogXCJtaXNzaW5nLW11bHRpLWZhY3Rvci1zZXNzaW9uXCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX01GQV9TRVNTSU9OICovLFxuICAgIFtcIlNFQ09ORF9GQUNUT1JfRVhJU1RTXCIgLyogU2VydmVyRXJyb3IuU0VDT05EX0ZBQ1RPUl9FWElTVFMgKi9dOiBcInNlY29uZC1mYWN0b3ItYWxyZWFkeS1pbi11c2VcIiAvKiBBdXRoRXJyb3JDb2RlLlNFQ09ORF9GQUNUT1JfQUxSRUFEWV9FTlJPTExFRCAqLyxcbiAgICBbXCJTRUNPTkRfRkFDVE9SX0xJTUlUX0VYQ0VFREVEXCIgLyogU2VydmVyRXJyb3IuU0VDT05EX0ZBQ1RPUl9MSU1JVF9FWENFRURFRCAqL106IFwibWF4aW11bS1zZWNvbmQtZmFjdG9yLWNvdW50LWV4Y2VlZGVkXCIgLyogQXV0aEVycm9yQ29kZS5TRUNPTkRfRkFDVE9SX0xJTUlUX0VYQ0VFREVEICovLFxuICAgIC8vIEJsb2NraW5nIGZ1bmN0aW9ucyByZWxhdGVkIGVycm9ycy5cbiAgICBbXCJCTE9DS0lOR19GVU5DVElPTl9FUlJPUl9SRVNQT05TRVwiIC8qIFNlcnZlckVycm9yLkJMT0NLSU5HX0ZVTkNUSU9OX0VSUk9SX1JFU1BPTlNFICovXTogXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8sXG4gICAgLy8gUmVjYXB0Y2hhIHJlbGF0ZWQgZXJyb3JzLlxuICAgIFtcIlJFQ0FQVENIQV9OT1RfRU5BQkxFRFwiIC8qIFNlcnZlckVycm9yLlJFQ0FQVENIQV9OT1RfRU5BQkxFRCAqL106IFwicmVjYXB0Y2hhLW5vdC1lbmFibGVkXCIgLyogQXV0aEVycm9yQ29kZS5SRUNBUFRDSEFfTk9UX0VOQUJMRUQgKi8sXG4gICAgW1wiTUlTU0lOR19SRUNBUFRDSEFfVE9LRU5cIiAvKiBTZXJ2ZXJFcnJvci5NSVNTSU5HX1JFQ0FQVENIQV9UT0tFTiAqL106IFwibWlzc2luZy1yZWNhcHRjaGEtdG9rZW5cIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfUkVDQVBUQ0hBX1RPS0VOICovLFxuICAgIFtcIklOVkFMSURfUkVDQVBUQ0hBX1RPS0VOXCIgLyogU2VydmVyRXJyb3IuSU5WQUxJRF9SRUNBUFRDSEFfVE9LRU4gKi9dOiBcImludmFsaWQtcmVjYXB0Y2hhLXRva2VuXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX1JFQ0FQVENIQV9UT0tFTiAqLyxcbiAgICBbXCJJTlZBTElEX1JFQ0FQVENIQV9BQ1RJT05cIiAvKiBTZXJ2ZXJFcnJvci5JTlZBTElEX1JFQ0FQVENIQV9BQ1RJT04gKi9dOiBcImludmFsaWQtcmVjYXB0Y2hhLWFjdGlvblwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9SRUNBUFRDSEFfQUNUSU9OICovLFxuICAgIFtcIk1JU1NJTkdfQ0xJRU5UX1RZUEVcIiAvKiBTZXJ2ZXJFcnJvci5NSVNTSU5HX0NMSUVOVF9UWVBFICovXTogXCJtaXNzaW5nLWNsaWVudC10eXBlXCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX0NMSUVOVF9UWVBFICovLFxuICAgIFtcIk1JU1NJTkdfUkVDQVBUQ0hBX1ZFUlNJT05cIiAvKiBTZXJ2ZXJFcnJvci5NSVNTSU5HX1JFQ0FQVENIQV9WRVJTSU9OICovXTogXCJtaXNzaW5nLXJlY2FwdGNoYS12ZXJzaW9uXCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX1JFQ0FQVENIQV9WRVJTSU9OICovLFxuICAgIFtcIklOVkFMSURfUkVDQVBUQ0hBX1ZFUlNJT05cIiAvKiBTZXJ2ZXJFcnJvci5JTlZBTElEX1JFQ0FQVENIQV9WRVJTSU9OICovXTogXCJpbnZhbGlkLXJlY2FwdGNoYS12ZXJzaW9uXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX1JFQ0FQVENIQV9WRVJTSU9OICovLFxuICAgIFtcIklOVkFMSURfUkVRX1RZUEVcIiAvKiBTZXJ2ZXJFcnJvci5JTlZBTElEX1JFUV9UWVBFICovXTogXCJpbnZhbGlkLXJlcS10eXBlXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX1JFUV9UWVBFICovXG59O1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY29uc3QgQ29va2llQXV0aFByb3hpZWRFbmRwb2ludHMgPSBbXG4gICAgXCIvdjEvYWNjb3VudHM6c2lnbkluV2l0aEN1c3RvbVRva2VuXCIgLyogRW5kcG9pbnQuU0lHTl9JTl9XSVRIX0NVU1RPTV9UT0tFTiAqLyxcbiAgICBcIi92MS9hY2NvdW50czpzaWduSW5XaXRoRW1haWxMaW5rXCIgLyogRW5kcG9pbnQuU0lHTl9JTl9XSVRIX0VNQUlMX0xJTksgKi8sXG4gICAgXCIvdjEvYWNjb3VudHM6c2lnbkluV2l0aElkcFwiIC8qIEVuZHBvaW50LlNJR05fSU5fV0lUSF9JRFAgKi8sXG4gICAgXCIvdjEvYWNjb3VudHM6c2lnbkluV2l0aFBhc3N3b3JkXCIgLyogRW5kcG9pbnQuU0lHTl9JTl9XSVRIX1BBU1NXT1JEICovLFxuICAgIFwiL3YxL2FjY291bnRzOnNpZ25JbldpdGhQaG9uZU51bWJlclwiIC8qIEVuZHBvaW50LlNJR05fSU5fV0lUSF9QSE9ORV9OVU1CRVIgKi8sXG4gICAgXCIvdjEvdG9rZW5cIiAvKiBFbmRwb2ludC5UT0tFTiAqL1xuXTtcbmNvbnN0IERFRkFVTFRfQVBJX1RJTUVPVVRfTVMgPSBuZXcgRGVsYXkoMzAwMDAsIDYwMDAwKTtcbmZ1bmN0aW9uIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSB7XG4gICAgaWYgKGF1dGgudGVuYW50SWQgJiYgIXJlcXVlc3QudGVuYW50SWQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC4uLnJlcXVlc3QsXG4gICAgICAgICAgICB0ZW5hbnRJZDogYXV0aC50ZW5hbnRJZFxuICAgICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gcmVxdWVzdDtcbn1cbmFzeW5jIGZ1bmN0aW9uIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBtZXRob2QsIHBhdGgsIHJlcXVlc3QsIGN1c3RvbUVycm9yTWFwID0ge30pIHtcbiAgICByZXR1cm4gX3BlcmZvcm1GZXRjaFdpdGhFcnJvckhhbmRsaW5nKGF1dGgsIGN1c3RvbUVycm9yTWFwLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGxldCBib2R5ID0ge307XG4gICAgICAgIGxldCBwYXJhbXMgPSB7fTtcbiAgICAgICAgaWYgKHJlcXVlc3QpIHtcbiAgICAgICAgICAgIGlmIChtZXRob2QgPT09IFwiR0VUXCIgLyogSHR0cE1ldGhvZC5HRVQgKi8pIHtcbiAgICAgICAgICAgICAgICBwYXJhbXMgPSByZXF1ZXN0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYm9keSA9IHtcbiAgICAgICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdClcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gcXVlcnlzdHJpbmcoe1xuICAgICAgICAgICAga2V5OiBhdXRoLmNvbmZpZy5hcGlLZXksXG4gICAgICAgICAgICAuLi5wYXJhbXNcbiAgICAgICAgfSkuc2xpY2UoMSk7XG4gICAgICAgIGNvbnN0IGhlYWRlcnMgPSBhd2FpdCBhdXRoLl9nZXRBZGRpdGlvbmFsSGVhZGVycygpO1xuICAgICAgICBoZWFkZXJzW1wiQ29udGVudC1UeXBlXCIgLyogSHR0cEhlYWRlci5DT05URU5UX1RZUEUgKi9dID0gJ2FwcGxpY2F0aW9uL2pzb24nO1xuICAgICAgICBpZiAoYXV0aC5sYW5ndWFnZUNvZGUpIHtcbiAgICAgICAgICAgIGhlYWRlcnNbXCJYLUZpcmViYXNlLUxvY2FsZVwiIC8qIEh0dHBIZWFkZXIuWF9GSVJFQkFTRV9MT0NBTEUgKi9dID0gYXV0aC5sYW5ndWFnZUNvZGU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZmV0Y2hBcmdzID0ge1xuICAgICAgICAgICAgbWV0aG9kLFxuICAgICAgICAgICAgaGVhZGVycyxcbiAgICAgICAgICAgIC4uLmJvZHlcbiAgICAgICAgfTtcbiAgICAgICAgLyogU2VjdXJpdHktY29uc2Npb3VzIHNlcnZlci1zaWRlIGZyYW1ld29ya3MgdGVuZCB0byBoYXZlIGJ1aWx0IGluIG1pdGlnYXRpb25zIGZvciByZWZlcnJlclxuICAgICAgICAgICBwcm9ibGVtc1wiLiBTZWUgdGhlIENsb3VkZmxhcmUgR2l0SHViIGlzc3VlICM0ODc6IEVycm9yOiBUaGUgJ3JlZmVycmVyUG9saWN5JyBmaWVsZCBvblxuICAgICAgICAgICAnUmVxdWVzdEluaXRpYWxpemVyRGljdCcgaXMgbm90IGltcGxlbWVudGVkLlwiXG4gICAgICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9jbG91ZGZsYXJlL25leHQtb24tcGFnZXMvaXNzdWVzLzQ4NyAqL1xuICAgICAgICBpZiAoIWlzQ2xvdWRmbGFyZVdvcmtlcigpKSB7XG4gICAgICAgICAgICBmZXRjaEFyZ3MucmVmZXJyZXJQb2xpY3kgPSAnbm8tcmVmZXJyZXInO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhdXRoLmVtdWxhdG9yQ29uZmlnICYmIGlzQ2xvdWRXb3Jrc3RhdGlvbihhdXRoLmVtdWxhdG9yQ29uZmlnLmhvc3QpKSB7XG4gICAgICAgICAgICBmZXRjaEFyZ3MuY3JlZGVudGlhbHMgPSAnaW5jbHVkZSc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEZldGNoUHJvdmlkZXIuZmV0Y2goKShhd2FpdCBfZ2V0RmluYWxUYXJnZXQoYXV0aCwgYXV0aC5jb25maWcuYXBpSG9zdCwgcGF0aCwgcXVlcnkpLCBmZXRjaEFyZ3MpO1xuICAgIH0pO1xufVxuYXN5bmMgZnVuY3Rpb24gX3BlcmZvcm1GZXRjaFdpdGhFcnJvckhhbmRsaW5nKGF1dGgsIGN1c3RvbUVycm9yTWFwLCBmZXRjaEZuKSB7XG4gICAgYXV0aC5fY2FuSW5pdEVtdWxhdG9yID0gZmFsc2U7XG4gICAgY29uc3QgZXJyb3JNYXAgPSB7IC4uLlNFUlZFUl9FUlJPUl9NQVAsIC4uLmN1c3RvbUVycm9yTWFwIH07XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgbmV0d29ya1RpbWVvdXQgPSBuZXcgTmV0d29ya1RpbWVvdXQoYXV0aCk7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgUHJvbWlzZS5yYWNlKFtcbiAgICAgICAgICAgIGZldGNoRm4oKSxcbiAgICAgICAgICAgIG5ldHdvcmtUaW1lb3V0LnByb21pc2VcbiAgICAgICAgXSk7XG4gICAgICAgIC8vIElmIHdlJ3ZlIHJlYWNoZWQgdGhpcyBwb2ludCwgdGhlIGZldGNoIHN1Y2NlZWRlZCBhbmQgdGhlIG5ldHdvcmtUaW1lb3V0XG4gICAgICAgIC8vIGRpZG4ndCB0aHJvdzsgY2xlYXIgdGhlIG5ldHdvcmsgdGltZW91dCBkZWxheSBzbyB0aGF0IE5vZGUgd29uJ3QgaGFuZ1xuICAgICAgICBuZXR3b3JrVGltZW91dC5jbGVhck5ldHdvcmtUaW1lb3V0KCk7XG4gICAgICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIGlmICgnbmVlZENvbmZpcm1hdGlvbicgaW4ganNvbikge1xuICAgICAgICAgICAgdGhyb3cgX21ha2VUYWdnZWRFcnJvcihhdXRoLCBcImFjY291bnQtZXhpc3RzLXdpdGgtZGlmZmVyZW50LWNyZWRlbnRpYWxcIiAvKiBBdXRoRXJyb3JDb2RlLk5FRURfQ09ORklSTUFUSU9OICovLCBqc29uKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzcG9uc2Uub2sgJiYgISgnZXJyb3JNZXNzYWdlJyBpbiBqc29uKSkge1xuICAgICAgICAgICAgcmV0dXJuIGpzb247XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSByZXNwb25zZS5vayA/IGpzb24uZXJyb3JNZXNzYWdlIDoganNvbi5lcnJvci5tZXNzYWdlO1xuICAgICAgICAgICAgY29uc3QgW3NlcnZlckVycm9yQ29kZSwgc2VydmVyRXJyb3JNZXNzYWdlXSA9IGVycm9yTWVzc2FnZS5zcGxpdCgnIDogJyk7XG4gICAgICAgICAgICBpZiAoc2VydmVyRXJyb3JDb2RlID09PSBcIkZFREVSQVRFRF9VU0VSX0lEX0FMUkVBRFlfTElOS0VEXCIgLyogU2VydmVyRXJyb3IuRkVERVJBVEVEX1VTRVJfSURfQUxSRUFEWV9MSU5LRUQgKi8pIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBfbWFrZVRhZ2dlZEVycm9yKGF1dGgsIFwiY3JlZGVudGlhbC1hbHJlYWR5LWluLXVzZVwiIC8qIEF1dGhFcnJvckNvZGUuQ1JFREVOVElBTF9BTFJFQURZX0lOX1VTRSAqLywganNvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzZXJ2ZXJFcnJvckNvZGUgPT09IFwiRU1BSUxfRVhJU1RTXCIgLyogU2VydmVyRXJyb3IuRU1BSUxfRVhJU1RTICovKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgX21ha2VUYWdnZWRFcnJvcihhdXRoLCBcImVtYWlsLWFscmVhZHktaW4tdXNlXCIgLyogQXV0aEVycm9yQ29kZS5FTUFJTF9FWElTVFMgKi8sIGpzb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2VydmVyRXJyb3JDb2RlID09PSBcIlVTRVJfRElTQUJMRURcIiAvKiBTZXJ2ZXJFcnJvci5VU0VSX0RJU0FCTEVEICovKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgX21ha2VUYWdnZWRFcnJvcihhdXRoLCBcInVzZXItZGlzYWJsZWRcIiAvKiBBdXRoRXJyb3JDb2RlLlVTRVJfRElTQUJMRUQgKi8sIGpzb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgYXV0aEVycm9yID0gZXJyb3JNYXBbc2VydmVyRXJyb3JDb2RlXSB8fFxuICAgICAgICAgICAgICAgIHNlcnZlckVycm9yQ29kZVxuICAgICAgICAgICAgICAgICAgICAudG9Mb3dlckNhc2UoKVxuICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvW19cXHNdKy9nLCAnLScpO1xuICAgICAgICAgICAgaWYgKHNlcnZlckVycm9yTWVzc2FnZSkge1xuICAgICAgICAgICAgICAgIHRocm93IF9lcnJvcldpdGhDdXN0b21NZXNzYWdlKGF1dGgsIGF1dGhFcnJvciwgc2VydmVyRXJyb3JNZXNzYWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIF9mYWlsKGF1dGgsIGF1dGhFcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBGaXJlYmFzZUVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICB9XG4gICAgICAgIC8vIENoYW5naW5nIHRoaXMgdG8gYSBkaWZmZXJlbnQgZXJyb3IgY29kZSB3aWxsIGxvZyB1c2VyIG91dCB3aGVuIHRoZXJlIGlzIGEgbmV0d29yayBlcnJvclxuICAgICAgICAvLyBiZWNhdXNlIHdlIHRyZWF0IGFueSBlcnJvciBvdGhlciB0aGFuIE5FVFdPUktfUkVRVUVTVF9GQUlMRUQgYXMgdG9rZW4gaXMgaW52YWxpZC5cbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZpcmViYXNlL2ZpcmViYXNlLWpzLXNkay9ibG9iLzRmYmM3MzYxMGQ3MGJlNGUwODUyZTdkZTYzYTM5Y2I3ODk3ZTg1NDYvcGFja2FnZXMvYXV0aC9zcmMvY29yZS9hdXRoL2F1dGhfaW1wbC50cyNMMzA5LUwzMTZcbiAgICAgICAgX2ZhaWwoYXV0aCwgXCJuZXR3b3JrLXJlcXVlc3QtZmFpbGVkXCIgLyogQXV0aEVycm9yQ29kZS5ORVRXT1JLX1JFUVVFU1RfRkFJTEVEICovLCB7ICdtZXNzYWdlJzogU3RyaW5nKGUpIH0pO1xuICAgIH1cbn1cbmFzeW5jIGZ1bmN0aW9uIF9wZXJmb3JtU2lnbkluUmVxdWVzdChhdXRoLCBtZXRob2QsIHBhdGgsIHJlcXVlc3QsIGN1c3RvbUVycm9yTWFwID0ge30pIHtcbiAgICBjb25zdCBzZXJ2ZXJSZXNwb25zZSA9IGF3YWl0IF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBtZXRob2QsIHBhdGgsIHJlcXVlc3QsIGN1c3RvbUVycm9yTWFwKTtcbiAgICBpZiAoJ21mYVBlbmRpbmdDcmVkZW50aWFsJyBpbiBzZXJ2ZXJSZXNwb25zZSkge1xuICAgICAgICBfZmFpbChhdXRoLCBcIm11bHRpLWZhY3Rvci1hdXRoLXJlcXVpcmVkXCIgLyogQXV0aEVycm9yQ29kZS5NRkFfUkVRVUlSRUQgKi8sIHtcbiAgICAgICAgICAgIF9zZXJ2ZXJSZXNwb25zZTogc2VydmVyUmVzcG9uc2VcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBzZXJ2ZXJSZXNwb25zZTtcbn1cbmFzeW5jIGZ1bmN0aW9uIF9nZXRGaW5hbFRhcmdldChhdXRoLCBob3N0LCBwYXRoLCBxdWVyeSkge1xuICAgIGNvbnN0IGJhc2UgPSBgJHtob3N0fSR7cGF0aH0/JHtxdWVyeX1gO1xuICAgIGNvbnN0IGF1dGhJbnRlcm5hbCA9IGF1dGg7XG4gICAgY29uc3QgZmluYWxUYXJnZXQgPSBhdXRoSW50ZXJuYWwuY29uZmlnLmVtdWxhdG9yXG4gICAgICAgID8gX2VtdWxhdG9yVXJsKGF1dGguY29uZmlnLCBiYXNlKVxuICAgICAgICA6IGAke2F1dGguY29uZmlnLmFwaVNjaGVtZX06Ly8ke2Jhc2V9YDtcbiAgICAvLyBDb29raWUgYXV0aCB3b3JrcyBieSBNaVRNaW5nIHRoZSBzaWduSW4gYW5kIHRva2VuIGVuZHBvaW50cyBmcm9tIHRoZSBkZXZlbG9wZXIncyBiYWNrZW5kLFxuICAgIC8vIHNhdmluZyB0aGUgaWRUb2tlbiBhbmQgcmVmcmVzaFRva2VuIGludG8gY29va2llcywgYW5kIHRoZW4gcmVkYWN0aW5nIHRoZSByZWZyZXNoVG9rZW5cbiAgICAvLyBmcm9tIHRoZSByZXNwb25zZVxuICAgIGlmIChDb29raWVBdXRoUHJveGllZEVuZHBvaW50cy5pbmNsdWRlcyhwYXRoKSkge1xuICAgICAgICAvLyBQZXJzaXN0ZW5jZSBtYW5hZ2VyIGlzIGFzeW5jLCB3ZSBuZWVkIHRvIGF3YWl0IGl0LiBXZSBjYW4ndCBqdXN0IHdhaXQgZm9yIGF1dGggaW5pdGlhbGl6ZWRcbiAgICAgICAgLy8gaGVyZSBzaW5jZSBhdXRoIGluaXRpYWxpemF0aW9uIGNhbGxzIHRoaXMgZnVuY3Rpb24uXG4gICAgICAgIGF3YWl0IGF1dGhJbnRlcm5hbC5fcGVyc2lzdGVuY2VNYW5hZ2VyQXZhaWxhYmxlO1xuICAgICAgICBpZiAoYXV0aEludGVybmFsLl9nZXRQZXJzaXN0ZW5jZVR5cGUoKSA9PT0gXCJDT09LSUVcIiAvKiBQZXJzaXN0ZW5jZVR5cGUuQ09PS0lFICovKSB7XG4gICAgICAgICAgICBjb25zdCBjb29raWVQZXJzaXN0ZW5jZSA9IGF1dGhJbnRlcm5hbC5fZ2V0UGVyc2lzdGVuY2UoKTtcbiAgICAgICAgICAgIHJldHVybiBjb29raWVQZXJzaXN0ZW5jZS5fZ2V0RmluYWxUYXJnZXQoZmluYWxUYXJnZXQpLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZpbmFsVGFyZ2V0O1xufVxuZnVuY3Rpb24gX3BhcnNlRW5mb3JjZW1lbnRTdGF0ZShlbmZvcmNlbWVudFN0YXRlU3RyKSB7XG4gICAgc3dpdGNoIChlbmZvcmNlbWVudFN0YXRlU3RyKSB7XG4gICAgICAgIGNhc2UgJ0VORk9SQ0UnOlxuICAgICAgICAgICAgcmV0dXJuIFwiRU5GT1JDRVwiIC8qIEVuZm9yY2VtZW50U3RhdGUuRU5GT1JDRSAqLztcbiAgICAgICAgY2FzZSAnQVVESVQnOlxuICAgICAgICAgICAgcmV0dXJuIFwiQVVESVRcIiAvKiBFbmZvcmNlbWVudFN0YXRlLkFVRElUICovO1xuICAgICAgICBjYXNlICdPRkYnOlxuICAgICAgICAgICAgcmV0dXJuIFwiT0ZGXCIgLyogRW5mb3JjZW1lbnRTdGF0ZS5PRkYgKi87XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gXCJFTkZPUkNFTUVOVF9TVEFURV9VTlNQRUNJRklFRFwiIC8qIEVuZm9yY2VtZW50U3RhdGUuRU5GT1JDRU1FTlRfU1RBVEVfVU5TUEVDSUZJRUQgKi87XG4gICAgfVxufVxuY2xhc3MgTmV0d29ya1RpbWVvdXQge1xuICAgIGNsZWFyTmV0d29ya1RpbWVvdXQoKSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtcbiAgICB9XG4gICAgY29uc3RydWN0b3IoYXV0aCkge1xuICAgICAgICB0aGlzLmF1dGggPSBhdXRoO1xuICAgICAgICAvLyBOb2RlIHRpbWVycyBhbmQgYnJvd3NlciB0aW1lcnMgYXJlIGZ1bmRhbWVudGFsbHkgaW5jb21wYXRpYmxlLCBidXQgd2VcbiAgICAgICAgLy8gZG9uJ3QgY2FyZSBhYm91dCB0aGUgdmFsdWUgaGVyZVxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICB0aGlzLnRpbWVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoKF8sIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy50aW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QoX2NyZWF0ZUVycm9yKHRoaXMuYXV0aCwgXCJuZXR3b3JrLXJlcXVlc3QtZmFpbGVkXCIgLyogQXV0aEVycm9yQ29kZS5ORVRXT1JLX1JFUVVFU1RfRkFJTEVEICovKSk7XG4gICAgICAgICAgICB9LCBERUZBVUxUX0FQSV9USU1FT1VUX01TLmdldCgpKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuZnVuY3Rpb24gX21ha2VUYWdnZWRFcnJvcihhdXRoLCBjb2RlLCByZXNwb25zZSkge1xuICAgIGNvbnN0IGVycm9yUGFyYW1zID0ge1xuICAgICAgICBhcHBOYW1lOiBhdXRoLm5hbWVcbiAgICB9O1xuICAgIGlmIChyZXNwb25zZS5lbWFpbCkge1xuICAgICAgICBlcnJvclBhcmFtcy5lbWFpbCA9IHJlc3BvbnNlLmVtYWlsO1xuICAgIH1cbiAgICBpZiAocmVzcG9uc2UucGhvbmVOdW1iZXIpIHtcbiAgICAgICAgZXJyb3JQYXJhbXMucGhvbmVOdW1iZXIgPSByZXNwb25zZS5waG9uZU51bWJlcjtcbiAgICB9XG4gICAgY29uc3QgZXJyb3IgPSBfY3JlYXRlRXJyb3IoYXV0aCwgY29kZSwgZXJyb3JQYXJhbXMpO1xuICAgIC8vIFdlIGtub3cgY3VzdG9tRGF0YSBpcyBkZWZpbmVkIG9uIGVycm9yIGJlY2F1c2UgZXJyb3JQYXJhbXMgaXMgZGVmaW5lZFxuICAgIGVycm9yLmN1c3RvbURhdGEuX3Rva2VuUmVzcG9uc2UgPSByZXNwb25zZTtcbiAgICByZXR1cm4gZXJyb3I7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5mdW5jdGlvbiBpc1YyKGdyZWNhcHRjaGEpIHtcbiAgICByZXR1cm4gKGdyZWNhcHRjaGEgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICBncmVjYXB0Y2hhLmdldFJlc3BvbnNlICE9PSB1bmRlZmluZWQpO1xufVxuZnVuY3Rpb24gaXNFbnRlcnByaXNlKGdyZWNhcHRjaGEpIHtcbiAgICByZXR1cm4gKGdyZWNhcHRjaGEgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICBncmVjYXB0Y2hhLmVudGVycHJpc2UgIT09IHVuZGVmaW5lZCk7XG59XG5jbGFzcyBSZWNhcHRjaGFDb25maWcge1xuICAgIGNvbnN0cnVjdG9yKHJlc3BvbnNlKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgcmVDQVBUQ0hBIHNpdGUga2V5LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zaXRlS2V5ID0gJyc7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbGlzdCBvZiBwcm92aWRlcnMgYW5kIHRoZWlyIGVuYWJsZW1lbnQgc3RhdHVzIGZvciByZUNBUFRDSEEgRW50ZXJwcmlzZS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucmVjYXB0Y2hhRW5mb3JjZW1lbnRTdGF0ZSA9IFtdO1xuICAgICAgICBpZiAocmVzcG9uc2UucmVjYXB0Y2hhS2V5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigncmVjYXB0Y2hhS2V5IHVuZGVmaW5lZCcpO1xuICAgICAgICB9XG4gICAgICAgIC8vIEV4YW1wbGUgcmVzcG9uc2UucmVjYXB0Y2hhS2V5OiBcInByb2plY3RzL3Byb2oxMjMva2V5cy9zaXRla2V5MTIzXCJcbiAgICAgICAgdGhpcy5zaXRlS2V5ID0gcmVzcG9uc2UucmVjYXB0Y2hhS2V5LnNwbGl0KCcvJylbM107XG4gICAgICAgIHRoaXMucmVjYXB0Y2hhRW5mb3JjZW1lbnRTdGF0ZSA9IHJlc3BvbnNlLnJlY2FwdGNoYUVuZm9yY2VtZW50U3RhdGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHJlQ0FQVENIQSBFbnRlcnByaXNlIGVuZm9yY2VtZW50IHN0YXRlIGZvciB0aGUgZ2l2ZW4gcHJvdmlkZXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcHJvdmlkZXJTdHIgLSBUaGUgcHJvdmlkZXIgd2hvc2UgZW5mb3JjZW1lbnQgc3RhdGUgaXMgdG8gYmUgcmV0dXJuZWQuXG4gICAgICogQHJldHVybnMgVGhlIHJlQ0FQVENIQSBFbnRlcnByaXNlIGVuZm9yY2VtZW50IHN0YXRlIGZvciB0aGUgZ2l2ZW4gcHJvdmlkZXIuXG4gICAgICovXG4gICAgZ2V0UHJvdmlkZXJFbmZvcmNlbWVudFN0YXRlKHByb3ZpZGVyU3RyKSB7XG4gICAgICAgIGlmICghdGhpcy5yZWNhcHRjaGFFbmZvcmNlbWVudFN0YXRlIHx8XG4gICAgICAgICAgICB0aGlzLnJlY2FwdGNoYUVuZm9yY2VtZW50U3RhdGUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IHJlY2FwdGNoYUVuZm9yY2VtZW50U3RhdGUgb2YgdGhpcy5yZWNhcHRjaGFFbmZvcmNlbWVudFN0YXRlKSB7XG4gICAgICAgICAgICBpZiAocmVjYXB0Y2hhRW5mb3JjZW1lbnRTdGF0ZS5wcm92aWRlciAmJlxuICAgICAgICAgICAgICAgIHJlY2FwdGNoYUVuZm9yY2VtZW50U3RhdGUucHJvdmlkZXIgPT09IHByb3ZpZGVyU3RyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9wYXJzZUVuZm9yY2VtZW50U3RhdGUocmVjYXB0Y2hhRW5mb3JjZW1lbnRTdGF0ZS5lbmZvcmNlbWVudFN0YXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSByZUNBUFRDSEEgRW50ZXJwcmlzZSBlbmZvcmNlbWVudCBzdGF0ZSBmb3IgdGhlIHByb3ZpZGVyIGlzIHNldCB0byBFTkZPUkNFIG9yIEFVRElULlxuICAgICAqXG4gICAgICogQHBhcmFtIHByb3ZpZGVyU3RyIC0gVGhlIHByb3ZpZGVyIHdob3NlIGVuYWJsZW1lbnQgc3RhdGUgaXMgdG8gYmUgcmV0dXJuZWQuXG4gICAgICogQHJldHVybnMgV2hldGhlciBvciBub3QgcmVDQVBUQ0hBIEVudGVycHJpc2UgcHJvdGVjdGlvbiBpcyBlbmFibGVkIGZvciB0aGUgZ2l2ZW4gcHJvdmlkZXIuXG4gICAgICovXG4gICAgaXNQcm92aWRlckVuYWJsZWQocHJvdmlkZXJTdHIpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLmdldFByb3ZpZGVyRW5mb3JjZW1lbnRTdGF0ZShwcm92aWRlclN0cikgPT09XG4gICAgICAgICAgICBcIkVORk9SQ0VcIiAvKiBFbmZvcmNlbWVudFN0YXRlLkVORk9SQ0UgKi8gfHxcbiAgICAgICAgICAgIHRoaXMuZ2V0UHJvdmlkZXJFbmZvcmNlbWVudFN0YXRlKHByb3ZpZGVyU3RyKSA9PT0gXCJBVURJVFwiIC8qIEVuZm9yY2VtZW50U3RhdGUuQVVESVQgKi8pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgcmVDQVBUQ0hBIEVudGVycHJpc2UgcHJvdGVjdGlvbiBpcyBlbmFibGVkIGluIGF0IGxlYXN0IG9uZSBwcm92aWRlciwgb3RoZXJ3aXNlXG4gICAgICogcmV0dXJucyBmYWxzZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIFdoZXRoZXIgb3Igbm90IHJlQ0FQVENIQSBFbnRlcnByaXNlIHByb3RlY3Rpb24gaXMgZW5hYmxlZCBmb3IgYXQgbGVhc3Qgb25lIHByb3ZpZGVyLlxuICAgICAqL1xuICAgIGlzQW55UHJvdmlkZXJFbmFibGVkKCkge1xuICAgICAgICByZXR1cm4gKHRoaXMuaXNQcm92aWRlckVuYWJsZWQoXCJFTUFJTF9QQVNTV09SRF9QUk9WSURFUlwiIC8qIFJlY2FwdGNoYUF1dGhQcm92aWRlci5FTUFJTF9QQVNTV09SRF9QUk9WSURFUiAqLykgfHxcbiAgICAgICAgICAgIHRoaXMuaXNQcm92aWRlckVuYWJsZWQoXCJQSE9ORV9QUk9WSURFUlwiIC8qIFJlY2FwdGNoYUF1dGhQcm92aWRlci5QSE9ORV9QUk9WSURFUiAqLykpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldFJlY2FwdGNoYVBhcmFtcyhhdXRoKSB7XG4gICAgcmV0dXJuICgoYXdhaXQgX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiR0VUXCIgLyogSHR0cE1ldGhvZC5HRVQgKi8sIFwiL3YxL3JlY2FwdGNoYVBhcmFtc1wiIC8qIEVuZHBvaW50LkdFVF9SRUNBUFRDSEFfUEFSQU0gKi8pKS5yZWNhcHRjaGFTaXRlS2V5IHx8ICcnKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGdldFJlY2FwdGNoYUNvbmZpZyhhdXRoLCByZXF1ZXN0KSB7XG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIkdFVFwiIC8qIEh0dHBNZXRob2QuR0VUICovLCBcIi92Mi9yZWNhcHRjaGFDb25maWdcIiAvKiBFbmRwb2ludC5HRVRfUkVDQVBUQ0hBX0NPTkZJRyAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUFjY291bnQoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92MS9hY2NvdW50czpkZWxldGVcIiAvKiBFbmRwb2ludC5ERUxFVEVfQUNDT1VOVCAqLywgcmVxdWVzdCk7XG59XG5hc3luYyBmdW5jdGlvbiBkZWxldGVMaW5rZWRBY2NvdW50cyhhdXRoLCByZXF1ZXN0KSB7XG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBIdHRwTWV0aG9kLlBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnVwZGF0ZVwiIC8qIEVuZHBvaW50LlNFVF9BQ0NPVU5UX0lORk8gKi8sIHJlcXVlc3QpO1xufVxuYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudEluZm8oYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92MS9hY2NvdW50czpsb29rdXBcIiAvKiBFbmRwb2ludC5HRVRfQUNDT1VOVF9JTkZPICovLCByZXF1ZXN0KTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmZ1bmN0aW9uIHV0Y1RpbWVzdGFtcFRvRGF0ZVN0cmluZyh1dGNUaW1lc3RhbXApIHtcbiAgICBpZiAoIXV0Y1RpbWVzdGFtcCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyBDb252ZXJ0IHRvIGRhdGUgb2JqZWN0LlxuICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoTnVtYmVyKHV0Y1RpbWVzdGFtcCkpO1xuICAgICAgICAvLyBUZXN0IGRhdGUgaXMgdmFsaWQuXG4gICAgICAgIGlmICghaXNOYU4oZGF0ZS5nZXRUaW1lKCkpKSB7XG4gICAgICAgICAgICAvLyBDb252ZXJ0IHRvIFVUQyBkYXRlIHN0cmluZy5cbiAgICAgICAgICAgIHJldHVybiBkYXRlLnRvVVRDU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gRG8gbm90aGluZy4gdW5kZWZpbmVkIHdpbGwgYmUgcmV0dXJuZWQuXG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFJldHVybnMgYSBKU09OIFdlYiBUb2tlbiAoSldUKSB1c2VkIHRvIGlkZW50aWZ5IHRoZSB1c2VyIHRvIGEgRmlyZWJhc2Ugc2VydmljZS5cbiAqXG4gKiBAcmVtYXJrc1xuICogUmV0dXJucyB0aGUgY3VycmVudCB0b2tlbiBpZiBpdCBoYXMgbm90IGV4cGlyZWQgb3IgaWYgaXQgd2lsbCBub3QgZXhwaXJlIGluIHRoZSBuZXh0IGZpdmVcbiAqIG1pbnV0ZXMuIE90aGVyd2lzZSwgdGhpcyB3aWxsIHJlZnJlc2ggdGhlIHRva2VuIGFuZCByZXR1cm4gYSBuZXcgb25lLlxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gZm9yY2VSZWZyZXNoIC0gRm9yY2UgcmVmcmVzaCByZWdhcmRsZXNzIG9mIHRva2VuIGV4cGlyYXRpb24uXG4gKlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiBnZXRJZFRva2VuKHVzZXIsIGZvcmNlUmVmcmVzaCA9IGZhbHNlKSB7XG4gICAgcmV0dXJuIGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKS5nZXRJZFRva2VuKGZvcmNlUmVmcmVzaCk7XG59XG4vKipcbiAqIFJldHVybnMgYSBkZXNlcmlhbGl6ZWQgSlNPTiBXZWIgVG9rZW4gKEpXVCkgdXNlZCB0byBpZGVudGlmeSB0aGUgdXNlciB0byBhIEZpcmViYXNlIHNlcnZpY2UuXG4gKlxuICogQHJlbWFya3NcbiAqIFJldHVybnMgdGhlIGN1cnJlbnQgdG9rZW4gaWYgaXQgaGFzIG5vdCBleHBpcmVkIG9yIGlmIGl0IHdpbGwgbm90IGV4cGlyZSBpbiB0aGUgbmV4dCBmaXZlXG4gKiBtaW51dGVzLiBPdGhlcndpc2UsIHRoaXMgd2lsbCByZWZyZXNoIHRoZSB0b2tlbiBhbmQgcmV0dXJuIGEgbmV3IG9uZS5cbiAqXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxuICogQHBhcmFtIGZvcmNlUmVmcmVzaCAtIEZvcmNlIHJlZnJlc2ggcmVnYXJkbGVzcyBvZiB0b2tlbiBleHBpcmF0aW9uLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0SWRUb2tlblJlc3VsdCh1c2VyLCBmb3JjZVJlZnJlc2ggPSBmYWxzZSkge1xuICAgIGNvbnN0IHVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKTtcbiAgICBjb25zdCB0b2tlbiA9IGF3YWl0IHVzZXJJbnRlcm5hbC5nZXRJZFRva2VuKGZvcmNlUmVmcmVzaCk7XG4gICAgY29uc3QgY2xhaW1zID0gX3BhcnNlVG9rZW4odG9rZW4pO1xuICAgIF9hc3NlcnQoY2xhaW1zICYmIGNsYWltcy5leHAgJiYgY2xhaW1zLmF1dGhfdGltZSAmJiBjbGFpbXMuaWF0LCB1c2VySW50ZXJuYWwuYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgIGNvbnN0IGZpcmViYXNlID0gdHlwZW9mIGNsYWltcy5maXJlYmFzZSA9PT0gJ29iamVjdCcgPyBjbGFpbXMuZmlyZWJhc2UgOiB1bmRlZmluZWQ7XG4gICAgY29uc3Qgc2lnbkluUHJvdmlkZXIgPSBmaXJlYmFzZT8uWydzaWduX2luX3Byb3ZpZGVyJ107XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY2xhaW1zLFxuICAgICAgICB0b2tlbixcbiAgICAgICAgYXV0aFRpbWU6IHV0Y1RpbWVzdGFtcFRvRGF0ZVN0cmluZyhzZWNvbmRzU3RyaW5nVG9NaWxsaXNlY29uZHMoY2xhaW1zLmF1dGhfdGltZSkpLFxuICAgICAgICBpc3N1ZWRBdFRpbWU6IHV0Y1RpbWVzdGFtcFRvRGF0ZVN0cmluZyhzZWNvbmRzU3RyaW5nVG9NaWxsaXNlY29uZHMoY2xhaW1zLmlhdCkpLFxuICAgICAgICBleHBpcmF0aW9uVGltZTogdXRjVGltZXN0YW1wVG9EYXRlU3RyaW5nKHNlY29uZHNTdHJpbmdUb01pbGxpc2Vjb25kcyhjbGFpbXMuZXhwKSksXG4gICAgICAgIHNpZ25JblByb3ZpZGVyOiBzaWduSW5Qcm92aWRlciB8fCBudWxsLFxuICAgICAgICBzaWduSW5TZWNvbmRGYWN0b3I6IGZpcmViYXNlPy5bJ3NpZ25faW5fc2Vjb25kX2ZhY3RvciddIHx8IG51bGxcbiAgICB9O1xufVxuZnVuY3Rpb24gc2Vjb25kc1N0cmluZ1RvTWlsbGlzZWNvbmRzKHNlY29uZHMpIHtcbiAgICByZXR1cm4gTnVtYmVyKHNlY29uZHMpICogMTAwMDtcbn1cbmZ1bmN0aW9uIF9wYXJzZVRva2VuKHRva2VuKSB7XG4gICAgY29uc3QgW2FsZ29yaXRobSwgcGF5bG9hZCwgc2lnbmF0dXJlXSA9IHRva2VuLnNwbGl0KCcuJyk7XG4gICAgaWYgKGFsZ29yaXRobSA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgIHBheWxvYWQgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICBzaWduYXR1cmUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBfbG9nRXJyb3IoJ0pXVCBtYWxmb3JtZWQsIGNvbnRhaW5lZCBmZXdlciB0aGFuIDMgc2VjdGlvbnMnKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGRlY29kZWQgPSBiYXNlNjREZWNvZGUocGF5bG9hZCk7XG4gICAgICAgIGlmICghZGVjb2RlZCkge1xuICAgICAgICAgICAgX2xvZ0Vycm9yKCdGYWlsZWQgdG8gZGVjb2RlIGJhc2U2NCBKV1QgcGF5bG9hZCcpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoZGVjb2RlZCk7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIF9sb2dFcnJvcignQ2F1Z2h0IGVycm9yIHBhcnNpbmcgSldUIHBheWxvYWQgYXMgSlNPTicsIGU/LnRvU3RyaW5nKCkpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59XG4vKipcbiAqIEV4dHJhY3QgZXhwaXJlc0luIFRUTCBmcm9tIGEgdG9rZW4gYnkgc3VidHJhY3RpbmcgdGhlIGV4cGlyYXRpb24gZnJvbSB0aGUgaXNzdWFuY2UuXG4gKi9cbmZ1bmN0aW9uIF90b2tlbkV4cGlyZXNJbih0b2tlbikge1xuICAgIGNvbnN0IHBhcnNlZFRva2VuID0gX3BhcnNlVG9rZW4odG9rZW4pO1xuICAgIF9hc3NlcnQocGFyc2VkVG9rZW4sIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICBfYXNzZXJ0KHR5cGVvZiBwYXJzZWRUb2tlbi5leHAgIT09ICd1bmRlZmluZWQnLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgX2Fzc2VydCh0eXBlb2YgcGFyc2VkVG9rZW4uaWF0ICE9PSAndW5kZWZpbmVkJywgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgIHJldHVybiBOdW1iZXIocGFyc2VkVG9rZW4uZXhwKSAtIE51bWJlcihwYXJzZWRUb2tlbi5pYXQpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gX2xvZ291dElmSW52YWxpZGF0ZWQodXNlciwgcHJvbWlzZSwgYnlwYXNzQXV0aFN0YXRlID0gZmFsc2UpIHtcbiAgICBpZiAoYnlwYXNzQXV0aFN0YXRlKSB7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gYXdhaXQgcHJvbWlzZTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBGaXJlYmFzZUVycm9yICYmIGlzVXNlckludmFsaWRhdGVkKGUpKSB7XG4gICAgICAgICAgICBpZiAodXNlci5hdXRoLmN1cnJlbnRVc2VyID09PSB1c2VyKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdXNlci5hdXRoLnNpZ25PdXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBlO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGlzVXNlckludmFsaWRhdGVkKHsgY29kZSB9KSB7XG4gICAgcmV0dXJuIChjb2RlID09PSBgYXV0aC8ke1widXNlci1kaXNhYmxlZFwiIC8qIEF1dGhFcnJvckNvZGUuVVNFUl9ESVNBQkxFRCAqL31gIHx8XG4gICAgICAgIGNvZGUgPT09IGBhdXRoLyR7XCJ1c2VyLXRva2VuLWV4cGlyZWRcIiAvKiBBdXRoRXJyb3JDb2RlLlRPS0VOX0VYUElSRUQgKi99YCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jbGFzcyBQcm9hY3RpdmVSZWZyZXNoIHtcbiAgICBjb25zdHJ1Y3Rvcih1c2VyKSB7XG4gICAgICAgIHRoaXMudXNlciA9IHVzZXI7XG4gICAgICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7XG4gICAgICAgIC8vIE5vZGUgdGltZXJzIGFuZCBicm93c2VyIHRpbWVycyByZXR1cm4gZnVuZGFtZW50YWxseSBkaWZmZXJlbnQgdHlwZXMuXG4gICAgICAgIC8vIFdlIGRvbid0IGFjdHVhbGx5IGNhcmUgd2hhdCB0aGUgdmFsdWUgaXMgYnV0IFRTIHdvbid0IGFjY2VwdCB1bmtub3duIGFuZFxuICAgICAgICAvLyB3ZSBjYW4ndCBjYXN0IHByb3Blcmx5IGluIGJvdGggZW52aXJvbm1lbnRzLlxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICB0aGlzLnRpbWVySWQgPSBudWxsO1xuICAgICAgICB0aGlzLmVycm9yQmFja29mZiA9IDMwMDAwIC8qIER1cmF0aW9uLlJFVFJZX0JBQ0tPRkZfTUlOICovO1xuICAgIH1cbiAgICBfc3RhcnQoKSB7XG4gICAgICAgIGlmICh0aGlzLmlzUnVubmluZykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNSdW5uaW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZSgpO1xuICAgIH1cbiAgICBfc3RvcCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzUnVubmluZykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLnRpbWVySWQgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVySWQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldEludGVydmFsKHdhc0Vycm9yKSB7XG4gICAgICAgIGlmICh3YXNFcnJvcikge1xuICAgICAgICAgICAgY29uc3QgaW50ZXJ2YWwgPSB0aGlzLmVycm9yQmFja29mZjtcbiAgICAgICAgICAgIHRoaXMuZXJyb3JCYWNrb2ZmID0gTWF0aC5taW4odGhpcy5lcnJvckJhY2tvZmYgKiAyLCA5NjAwMDAgLyogRHVyYXRpb24uUkVUUllfQkFDS09GRl9NQVggKi8pO1xuICAgICAgICAgICAgcmV0dXJuIGludGVydmFsO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gUmVzZXQgdGhlIGVycm9yIGJhY2tvZmZcbiAgICAgICAgICAgIHRoaXMuZXJyb3JCYWNrb2ZmID0gMzAwMDAgLyogRHVyYXRpb24uUkVUUllfQkFDS09GRl9NSU4gKi87XG4gICAgICAgICAgICBjb25zdCBleHBUaW1lID0gdGhpcy51c2VyLnN0c1Rva2VuTWFuYWdlci5leHBpcmF0aW9uVGltZSA/PyAwO1xuICAgICAgICAgICAgY29uc3QgaW50ZXJ2YWwgPSBleHBUaW1lIC0gRGF0ZS5ub3coKSAtIDMwMDAwMCAvKiBEdXJhdGlvbi5PRkZTRVQgKi87XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5tYXgoMCwgaW50ZXJ2YWwpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNjaGVkdWxlKHdhc0Vycm9yID0gZmFsc2UpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzUnVubmluZykge1xuICAgICAgICAgICAgLy8gSnVzdCBpbiBjYXNlLi4uXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaW50ZXJ2YWwgPSB0aGlzLmdldEludGVydmFsKHdhc0Vycm9yKTtcbiAgICAgICAgdGhpcy50aW1lcklkID0gc2V0VGltZW91dChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLml0ZXJhdGlvbigpO1xuICAgICAgICB9LCBpbnRlcnZhbCk7XG4gICAgfVxuICAgIGFzeW5jIGl0ZXJhdGlvbigpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMudXNlci5nZXRJZFRva2VuKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAvLyBPbmx5IHJldHJ5IG9uIG5ldHdvcmsgZXJyb3JzXG4gICAgICAgICAgICBpZiAoZT8uY29kZSA9PT1cbiAgICAgICAgICAgICAgICBgYXV0aC8ke1wibmV0d29yay1yZXF1ZXN0LWZhaWxlZFwiIC8qIEF1dGhFcnJvckNvZGUuTkVUV09SS19SRVFVRVNUX0ZBSUxFRCAqL31gKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZSgvKiB3YXNFcnJvciAqLyB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNjaGVkdWxlKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3MgVXNlck1ldGFkYXRhIHtcbiAgICBjb25zdHJ1Y3RvcihjcmVhdGVkQXQsIGxhc3RMb2dpbkF0KSB7XG4gICAgICAgIHRoaXMuY3JlYXRlZEF0ID0gY3JlYXRlZEF0O1xuICAgICAgICB0aGlzLmxhc3RMb2dpbkF0ID0gbGFzdExvZ2luQXQ7XG4gICAgICAgIHRoaXMuX2luaXRpYWxpemVUaW1lKCk7XG4gICAgfVxuICAgIF9pbml0aWFsaXplVGltZSgpIHtcbiAgICAgICAgdGhpcy5sYXN0U2lnbkluVGltZSA9IHV0Y1RpbWVzdGFtcFRvRGF0ZVN0cmluZyh0aGlzLmxhc3RMb2dpbkF0KTtcbiAgICAgICAgdGhpcy5jcmVhdGlvblRpbWUgPSB1dGNUaW1lc3RhbXBUb0RhdGVTdHJpbmcodGhpcy5jcmVhdGVkQXQpO1xuICAgIH1cbiAgICBfY29weShtZXRhZGF0YSkge1xuICAgICAgICB0aGlzLmNyZWF0ZWRBdCA9IG1ldGFkYXRhLmNyZWF0ZWRBdDtcbiAgICAgICAgdGhpcy5sYXN0TG9naW5BdCA9IG1ldGFkYXRhLmxhc3RMb2dpbkF0O1xuICAgICAgICB0aGlzLl9pbml0aWFsaXplVGltZSgpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjcmVhdGVkQXQ6IHRoaXMuY3JlYXRlZEF0LFxuICAgICAgICAgICAgbGFzdExvZ2luQXQ6IHRoaXMubGFzdExvZ2luQXRcbiAgICAgICAgfTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5hc3luYyBmdW5jdGlvbiBfcmVsb2FkV2l0aG91dFNhdmluZyh1c2VyKSB7XG4gICAgY29uc3QgYXV0aCA9IHVzZXIuYXV0aDtcbiAgICBjb25zdCBpZFRva2VuID0gYXdhaXQgdXNlci5nZXRJZFRva2VuKCk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBfbG9nb3V0SWZJbnZhbGlkYXRlZCh1c2VyLCBnZXRBY2NvdW50SW5mbyhhdXRoLCB7IGlkVG9rZW4gfSkpO1xuICAgIF9hc3NlcnQocmVzcG9uc2U/LnVzZXJzLmxlbmd0aCwgYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgIGNvbnN0IGNvcmVBY2NvdW50ID0gcmVzcG9uc2UudXNlcnNbMF07XG4gICAgdXNlci5fbm90aWZ5UmVsb2FkTGlzdGVuZXIoY29yZUFjY291bnQpO1xuICAgIGNvbnN0IG5ld1Byb3ZpZGVyRGF0YSA9IGNvcmVBY2NvdW50LnByb3ZpZGVyVXNlckluZm8/Lmxlbmd0aFxuICAgICAgICA/IGV4dHJhY3RQcm92aWRlckRhdGEoY29yZUFjY291bnQucHJvdmlkZXJVc2VySW5mbylcbiAgICAgICAgOiBbXTtcbiAgICBjb25zdCBwcm92aWRlckRhdGEgPSBtZXJnZVByb3ZpZGVyRGF0YSh1c2VyLnByb3ZpZGVyRGF0YSwgbmV3UHJvdmlkZXJEYXRhKTtcbiAgICAvLyBQcmVzZXJ2ZXMgdGhlIG5vbi1ub255bW91cyBzdGF0dXMgb2YgdGhlIHN0b3JlZCB1c2VyLCBldmVuIGlmIG5vIG1vcmVcbiAgICAvLyBjcmVkZW50aWFscyAoZmVkZXJhdGVkIG9yIGVtYWlsL3Bhc3N3b3JkKSBhcmUgbGlua2VkIHRvIHRoZSB1c2VyLiBJZlxuICAgIC8vIHRoZSB1c2VyIHdhcyBwcmV2aW91c2x5IGFub255bW91cywgdGhlbiB1c2UgcHJvdmlkZXIgZGF0YSB0byB1cGRhdGUuXG4gICAgLy8gT24gdGhlIG90aGVyIGhhbmQsIGlmIGl0IHdhcyBub3QgYW5vbnltb3VzIGJlZm9yZSwgaXQgc2hvdWxkIG5ldmVyIGJlXG4gICAgLy8gY29uc2lkZXJlZCBhbm9ueW1vdXMgbm93LlxuICAgIGNvbnN0IG9sZElzQW5vbnltb3VzID0gdXNlci5pc0Fub255bW91cztcbiAgICBjb25zdCBuZXdJc0Fub255bW91cyA9ICEodXNlci5lbWFpbCAmJiBjb3JlQWNjb3VudC5wYXNzd29yZEhhc2gpICYmICFwcm92aWRlckRhdGE/Lmxlbmd0aDtcbiAgICBjb25zdCBpc0Fub255bW91cyA9ICFvbGRJc0Fub255bW91cyA/IGZhbHNlIDogbmV3SXNBbm9ueW1vdXM7XG4gICAgY29uc3QgdXBkYXRlcyA9IHtcbiAgICAgICAgdWlkOiBjb3JlQWNjb3VudC5sb2NhbElkLFxuICAgICAgICBkaXNwbGF5TmFtZTogY29yZUFjY291bnQuZGlzcGxheU5hbWUgfHwgbnVsbCxcbiAgICAgICAgcGhvdG9VUkw6IGNvcmVBY2NvdW50LnBob3RvVXJsIHx8IG51bGwsXG4gICAgICAgIGVtYWlsOiBjb3JlQWNjb3VudC5lbWFpbCB8fCBudWxsLFxuICAgICAgICBlbWFpbFZlcmlmaWVkOiBjb3JlQWNjb3VudC5lbWFpbFZlcmlmaWVkIHx8IGZhbHNlLFxuICAgICAgICBwaG9uZU51bWJlcjogY29yZUFjY291bnQucGhvbmVOdW1iZXIgfHwgbnVsbCxcbiAgICAgICAgdGVuYW50SWQ6IGNvcmVBY2NvdW50LnRlbmFudElkIHx8IG51bGwsXG4gICAgICAgIHByb3ZpZGVyRGF0YSxcbiAgICAgICAgbWV0YWRhdGE6IG5ldyBVc2VyTWV0YWRhdGEoY29yZUFjY291bnQuY3JlYXRlZEF0LCBjb3JlQWNjb3VudC5sYXN0TG9naW5BdCksXG4gICAgICAgIGlzQW5vbnltb3VzXG4gICAgfTtcbiAgICBPYmplY3QuYXNzaWduKHVzZXIsIHVwZGF0ZXMpO1xufVxuLyoqXG4gKiBSZWxvYWRzIHVzZXIgYWNjb3VudCBkYXRhLCBpZiBzaWduZWQgaW4uXG4gKlxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHJlbG9hZCh1c2VyKSB7XG4gICAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpO1xuICAgIGF3YWl0IF9yZWxvYWRXaXRob3V0U2F2aW5nKHVzZXJJbnRlcm5hbCk7XG4gICAgLy8gRXZlbiB0aG91Z2ggdGhlIGN1cnJlbnQgdXNlciBoYXNuJ3QgY2hhbmdlZCwgdXBkYXRlXG4gICAgLy8gY3VycmVudCB1c2VyIHdpbGwgdHJpZ2dlciBhIHBlcnNpc3RlbmNlIHVwZGF0ZSB3LyB0aGVcbiAgICAvLyBuZXcgaW5mby5cbiAgICBhd2FpdCB1c2VySW50ZXJuYWwuYXV0aC5fcGVyc2lzdFVzZXJJZkN1cnJlbnQodXNlckludGVybmFsKTtcbiAgICB1c2VySW50ZXJuYWwuYXV0aC5fbm90aWZ5TGlzdGVuZXJzSWZDdXJyZW50KHVzZXJJbnRlcm5hbCk7XG59XG5mdW5jdGlvbiBtZXJnZVByb3ZpZGVyRGF0YShvcmlnaW5hbCwgbmV3RGF0YSkge1xuICAgIGNvbnN0IGRlZHVwZWQgPSBvcmlnaW5hbC5maWx0ZXIobyA9PiAhbmV3RGF0YS5zb21lKG4gPT4gbi5wcm92aWRlcklkID09PSBvLnByb3ZpZGVySWQpKTtcbiAgICByZXR1cm4gWy4uLmRlZHVwZWQsIC4uLm5ld0RhdGFdO1xufVxuZnVuY3Rpb24gZXh0cmFjdFByb3ZpZGVyRGF0YShwcm92aWRlcnMpIHtcbiAgICByZXR1cm4gcHJvdmlkZXJzLm1hcCgoeyBwcm92aWRlcklkLCAuLi5wcm92aWRlciB9KSA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBwcm92aWRlcklkLFxuICAgICAgICAgICAgdWlkOiBwcm92aWRlci5yYXdJZCB8fCAnJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBwcm92aWRlci5kaXNwbGF5TmFtZSB8fCBudWxsLFxuICAgICAgICAgICAgZW1haWw6IHByb3ZpZGVyLmVtYWlsIHx8IG51bGwsXG4gICAgICAgICAgICBwaG9uZU51bWJlcjogcHJvdmlkZXIucGhvbmVOdW1iZXIgfHwgbnVsbCxcbiAgICAgICAgICAgIHBob3RvVVJMOiBwcm92aWRlci5waG90b1VybCB8fCBudWxsXG4gICAgICAgIH07XG4gICAgfSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5hc3luYyBmdW5jdGlvbiByZXF1ZXN0U3RzVG9rZW4oYXV0aCwgcmVmcmVzaFRva2VuKSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBfcGVyZm9ybUZldGNoV2l0aEVycm9ySGFuZGxpbmcoYXV0aCwge30sIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgYm9keSA9IHF1ZXJ5c3RyaW5nKHtcbiAgICAgICAgICAgICdncmFudF90eXBlJzogJ3JlZnJlc2hfdG9rZW4nLFxuICAgICAgICAgICAgJ3JlZnJlc2hfdG9rZW4nOiByZWZyZXNoVG9rZW5cbiAgICAgICAgfSkuc2xpY2UoMSk7XG4gICAgICAgIGNvbnN0IHsgdG9rZW5BcGlIb3N0LCBhcGlLZXkgfSA9IGF1dGguY29uZmlnO1xuICAgICAgICBjb25zdCB1cmwgPSBhd2FpdCBfZ2V0RmluYWxUYXJnZXQoYXV0aCwgdG9rZW5BcGlIb3N0LCBcIi92MS90b2tlblwiIC8qIEVuZHBvaW50LlRPS0VOICovLCBga2V5PSR7YXBpS2V5fWApO1xuICAgICAgICBjb25zdCBoZWFkZXJzID0gYXdhaXQgYXV0aC5fZ2V0QWRkaXRpb25hbEhlYWRlcnMoKTtcbiAgICAgICAgaGVhZGVyc1tcIkNvbnRlbnQtVHlwZVwiIC8qIEh0dHBIZWFkZXIuQ09OVEVOVF9UWVBFICovXSA9ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnO1xuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIiAvKiBIdHRwTWV0aG9kLlBPU1QgKi8sXG4gICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgYm9keVxuICAgICAgICB9O1xuICAgICAgICBpZiAoYXV0aC5lbXVsYXRvckNvbmZpZyAmJlxuICAgICAgICAgICAgaXNDbG91ZFdvcmtzdGF0aW9uKGF1dGguZW11bGF0b3JDb25maWcuaG9zdCkpIHtcbiAgICAgICAgICAgIG9wdGlvbnMuY3JlZGVudGlhbHMgPSAnaW5jbHVkZSc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEZldGNoUHJvdmlkZXIuZmV0Y2goKSh1cmwsIG9wdGlvbnMpO1xuICAgIH0pO1xuICAgIC8vIFRoZSByZXNwb25zZSBjb21lcyBiYWNrIGluIHNuYWtlX2Nhc2UuIENvbnZlcnQgdG8gY2FtZWw6XG4gICAgcmV0dXJuIHtcbiAgICAgICAgYWNjZXNzVG9rZW46IHJlc3BvbnNlLmFjY2Vzc190b2tlbixcbiAgICAgICAgZXhwaXJlc0luOiByZXNwb25zZS5leHBpcmVzX2luLFxuICAgICAgICByZWZyZXNoVG9rZW46IHJlc3BvbnNlLnJlZnJlc2hfdG9rZW5cbiAgICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gcmV2b2tlVG9rZW4oYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92Mi9hY2NvdW50czpyZXZva2VUb2tlblwiIC8qIEVuZHBvaW50LlJFVk9LRV9UT0tFTiAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogV2UgbmVlZCB0byBtYXJrIHRoaXMgY2xhc3MgYXMgaW50ZXJuYWwgZXhwbGljaXRseSB0byBleGNsdWRlIGl0IGluIHRoZSBwdWJsaWMgdHlwaW5ncywgYmVjYXVzZVxuICogaXQgcmVmZXJlbmNlcyBBdXRoSW50ZXJuYWwgd2hpY2ggaGFzIGEgY2lyY3VsYXIgZGVwZW5kZW5jeSB3aXRoIFVzZXJJbnRlcm5hbC5cbiAqXG4gKiBAaW50ZXJuYWxcbiAqL1xuY2xhc3MgU3RzVG9rZW5NYW5hZ2VyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5yZWZyZXNoVG9rZW4gPSBudWxsO1xuICAgICAgICB0aGlzLmFjY2Vzc1Rva2VuID0gbnVsbDtcbiAgICAgICAgdGhpcy5leHBpcmF0aW9uVGltZSA9IG51bGw7XG4gICAgfVxuICAgIGdldCBpc0V4cGlyZWQoKSB7XG4gICAgICAgIHJldHVybiAoIXRoaXMuZXhwaXJhdGlvblRpbWUgfHxcbiAgICAgICAgICAgIERhdGUubm93KCkgPiB0aGlzLmV4cGlyYXRpb25UaW1lIC0gMzAwMDAgLyogQnVmZmVyLlRPS0VOX1JFRlJFU0ggKi8pO1xuICAgIH1cbiAgICB1cGRhdGVGcm9tU2VydmVyUmVzcG9uc2UocmVzcG9uc2UpIHtcbiAgICAgICAgX2Fzc2VydChyZXNwb25zZS5pZFRva2VuLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgIF9hc3NlcnQodHlwZW9mIHJlc3BvbnNlLmlkVG9rZW4gIT09ICd1bmRlZmluZWQnLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgIF9hc3NlcnQodHlwZW9mIHJlc3BvbnNlLnJlZnJlc2hUb2tlbiAhPT0gJ3VuZGVmaW5lZCcsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgY29uc3QgZXhwaXJlc0luID0gJ2V4cGlyZXNJbicgaW4gcmVzcG9uc2UgJiYgdHlwZW9mIHJlc3BvbnNlLmV4cGlyZXNJbiAhPT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgICAgID8gTnVtYmVyKHJlc3BvbnNlLmV4cGlyZXNJbilcbiAgICAgICAgICAgIDogX3Rva2VuRXhwaXJlc0luKHJlc3BvbnNlLmlkVG9rZW4pO1xuICAgICAgICB0aGlzLnVwZGF0ZVRva2Vuc0FuZEV4cGlyYXRpb24ocmVzcG9uc2UuaWRUb2tlbiwgcmVzcG9uc2UucmVmcmVzaFRva2VuLCBleHBpcmVzSW4pO1xuICAgIH1cbiAgICB1cGRhdGVGcm9tSWRUb2tlbihpZFRva2VuKSB7XG4gICAgICAgIF9hc3NlcnQoaWRUb2tlbi5sZW5ndGggIT09IDAsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgY29uc3QgZXhwaXJlc0luID0gX3Rva2VuRXhwaXJlc0luKGlkVG9rZW4pO1xuICAgICAgICB0aGlzLnVwZGF0ZVRva2Vuc0FuZEV4cGlyYXRpb24oaWRUb2tlbiwgbnVsbCwgZXhwaXJlc0luKTtcbiAgICB9XG4gICAgYXN5bmMgZ2V0VG9rZW4oYXV0aCwgZm9yY2VSZWZyZXNoID0gZmFsc2UpIHtcbiAgICAgICAgaWYgKCFmb3JjZVJlZnJlc2ggJiYgdGhpcy5hY2Nlc3NUb2tlbiAmJiAhdGhpcy5pc0V4cGlyZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFjY2Vzc1Rva2VuO1xuICAgICAgICB9XG4gICAgICAgIF9hc3NlcnQodGhpcy5yZWZyZXNoVG9rZW4sIGF1dGgsIFwidXNlci10b2tlbi1leHBpcmVkXCIgLyogQXV0aEVycm9yQ29kZS5UT0tFTl9FWFBJUkVEICovKTtcbiAgICAgICAgaWYgKHRoaXMucmVmcmVzaFRva2VuKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnJlZnJlc2goYXV0aCwgdGhpcy5yZWZyZXNoVG9rZW4pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWNjZXNzVG9rZW47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNsZWFyUmVmcmVzaFRva2VuKCkge1xuICAgICAgICB0aGlzLnJlZnJlc2hUb2tlbiA9IG51bGw7XG4gICAgfVxuICAgIGFzeW5jIHJlZnJlc2goYXV0aCwgb2xkVG9rZW4pIHtcbiAgICAgICAgY29uc3QgeyBhY2Nlc3NUb2tlbiwgcmVmcmVzaFRva2VuLCBleHBpcmVzSW4gfSA9IGF3YWl0IHJlcXVlc3RTdHNUb2tlbihhdXRoLCBvbGRUb2tlbik7XG4gICAgICAgIHRoaXMudXBkYXRlVG9rZW5zQW5kRXhwaXJhdGlvbihhY2Nlc3NUb2tlbiwgcmVmcmVzaFRva2VuLCBOdW1iZXIoZXhwaXJlc0luKSk7XG4gICAgfVxuICAgIHVwZGF0ZVRva2Vuc0FuZEV4cGlyYXRpb24oYWNjZXNzVG9rZW4sIHJlZnJlc2hUb2tlbiwgZXhwaXJlc0luU2VjKSB7XG4gICAgICAgIHRoaXMucmVmcmVzaFRva2VuID0gcmVmcmVzaFRva2VuIHx8IG51bGw7XG4gICAgICAgIHRoaXMuYWNjZXNzVG9rZW4gPSBhY2Nlc3NUb2tlbiB8fCBudWxsO1xuICAgICAgICB0aGlzLmV4cGlyYXRpb25UaW1lID0gRGF0ZS5ub3coKSArIGV4cGlyZXNJblNlYyAqIDEwMDA7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tSlNPTihhcHBOYW1lLCBvYmplY3QpIHtcbiAgICAgICAgY29uc3QgeyByZWZyZXNoVG9rZW4sIGFjY2Vzc1Rva2VuLCBleHBpcmF0aW9uVGltZSB9ID0gb2JqZWN0O1xuICAgICAgICBjb25zdCBtYW5hZ2VyID0gbmV3IFN0c1Rva2VuTWFuYWdlcigpO1xuICAgICAgICBpZiAocmVmcmVzaFRva2VuKSB7XG4gICAgICAgICAgICBfYXNzZXJ0KHR5cGVvZiByZWZyZXNoVG9rZW4gPT09ICdzdHJpbmcnLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLywge1xuICAgICAgICAgICAgICAgIGFwcE5hbWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbWFuYWdlci5yZWZyZXNoVG9rZW4gPSByZWZyZXNoVG9rZW47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFjY2Vzc1Rva2VuKSB7XG4gICAgICAgICAgICBfYXNzZXJ0KHR5cGVvZiBhY2Nlc3NUb2tlbiA9PT0gJ3N0cmluZycsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovLCB7XG4gICAgICAgICAgICAgICAgYXBwTmFtZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBtYW5hZ2VyLmFjY2Vzc1Rva2VuID0gYWNjZXNzVG9rZW47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV4cGlyYXRpb25UaW1lKSB7XG4gICAgICAgICAgICBfYXNzZXJ0KHR5cGVvZiBleHBpcmF0aW9uVGltZSA9PT0gJ251bWJlcicsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovLCB7XG4gICAgICAgICAgICAgICAgYXBwTmFtZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBtYW5hZ2VyLmV4cGlyYXRpb25UaW1lID0gZXhwaXJhdGlvblRpbWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1hbmFnZXI7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlZnJlc2hUb2tlbjogdGhpcy5yZWZyZXNoVG9rZW4sXG4gICAgICAgICAgICBhY2Nlc3NUb2tlbjogdGhpcy5hY2Nlc3NUb2tlbixcbiAgICAgICAgICAgIGV4cGlyYXRpb25UaW1lOiB0aGlzLmV4cGlyYXRpb25UaW1lXG4gICAgICAgIH07XG4gICAgfVxuICAgIF9hc3NpZ24oc3RzVG9rZW5NYW5hZ2VyKSB7XG4gICAgICAgIHRoaXMuYWNjZXNzVG9rZW4gPSBzdHNUb2tlbk1hbmFnZXIuYWNjZXNzVG9rZW47XG4gICAgICAgIHRoaXMucmVmcmVzaFRva2VuID0gc3RzVG9rZW5NYW5hZ2VyLnJlZnJlc2hUb2tlbjtcbiAgICAgICAgdGhpcy5leHBpcmF0aW9uVGltZSA9IHN0c1Rva2VuTWFuYWdlci5leHBpcmF0aW9uVGltZTtcbiAgICB9XG4gICAgX2Nsb25lKCkge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihuZXcgU3RzVG9rZW5NYW5hZ2VyKCksIHRoaXMudG9KU09OKCkpO1xuICAgIH1cbiAgICBfcGVyZm9ybVJlZnJlc2goKSB7XG4gICAgICAgIHJldHVybiBkZWJ1Z0ZhaWwoJ25vdCBpbXBsZW1lbnRlZCcpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmZ1bmN0aW9uIGFzc2VydFN0cmluZ09yVW5kZWZpbmVkKGFzc2VydGlvbiwgYXBwTmFtZSkge1xuICAgIF9hc3NlcnQodHlwZW9mIGFzc2VydGlvbiA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIGFzc2VydGlvbiA9PT0gJ3VuZGVmaW5lZCcsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovLCB7IGFwcE5hbWUgfSk7XG59XG5jbGFzcyBVc2VySW1wbCB7XG4gICAgY29uc3RydWN0b3IoeyB1aWQsIGF1dGgsIHN0c1Rva2VuTWFuYWdlciwgLi4ub3B0IH0pIHtcbiAgICAgICAgLy8gRm9yIHRoZSB1c2VyIG9iamVjdCwgcHJvdmlkZXIgaXMgYWx3YXlzIEZpcmViYXNlLlxuICAgICAgICB0aGlzLnByb3ZpZGVySWQgPSBcImZpcmViYXNlXCIgLyogUHJvdmlkZXJJZC5GSVJFQkFTRSAqLztcbiAgICAgICAgdGhpcy5wcm9hY3RpdmVSZWZyZXNoID0gbmV3IFByb2FjdGl2ZVJlZnJlc2godGhpcyk7XG4gICAgICAgIHRoaXMucmVsb2FkVXNlckluZm8gPSBudWxsO1xuICAgICAgICB0aGlzLnJlbG9hZExpc3RlbmVyID0gbnVsbDtcbiAgICAgICAgdGhpcy51aWQgPSB1aWQ7XG4gICAgICAgIHRoaXMuYXV0aCA9IGF1dGg7XG4gICAgICAgIHRoaXMuc3RzVG9rZW5NYW5hZ2VyID0gc3RzVG9rZW5NYW5hZ2VyO1xuICAgICAgICB0aGlzLmFjY2Vzc1Rva2VuID0gc3RzVG9rZW5NYW5hZ2VyLmFjY2Vzc1Rva2VuO1xuICAgICAgICB0aGlzLmRpc3BsYXlOYW1lID0gb3B0LmRpc3BsYXlOYW1lIHx8IG51bGw7XG4gICAgICAgIHRoaXMuZW1haWwgPSBvcHQuZW1haWwgfHwgbnVsbDtcbiAgICAgICAgdGhpcy5lbWFpbFZlcmlmaWVkID0gb3B0LmVtYWlsVmVyaWZpZWQgfHwgZmFsc2U7XG4gICAgICAgIHRoaXMucGhvbmVOdW1iZXIgPSBvcHQucGhvbmVOdW1iZXIgfHwgbnVsbDtcbiAgICAgICAgdGhpcy5waG90b1VSTCA9IG9wdC5waG90b1VSTCB8fCBudWxsO1xuICAgICAgICB0aGlzLmlzQW5vbnltb3VzID0gb3B0LmlzQW5vbnltb3VzIHx8IGZhbHNlO1xuICAgICAgICB0aGlzLnRlbmFudElkID0gb3B0LnRlbmFudElkIHx8IG51bGw7XG4gICAgICAgIHRoaXMucHJvdmlkZXJEYXRhID0gb3B0LnByb3ZpZGVyRGF0YSA/IFsuLi5vcHQucHJvdmlkZXJEYXRhXSA6IFtdO1xuICAgICAgICB0aGlzLm1ldGFkYXRhID0gbmV3IFVzZXJNZXRhZGF0YShvcHQuY3JlYXRlZEF0IHx8IHVuZGVmaW5lZCwgb3B0Lmxhc3RMb2dpbkF0IHx8IHVuZGVmaW5lZCk7XG4gICAgfVxuICAgIGFzeW5jIGdldElkVG9rZW4oZm9yY2VSZWZyZXNoKSB7XG4gICAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXdhaXQgX2xvZ291dElmSW52YWxpZGF0ZWQodGhpcywgdGhpcy5zdHNUb2tlbk1hbmFnZXIuZ2V0VG9rZW4odGhpcy5hdXRoLCBmb3JjZVJlZnJlc2gpKTtcbiAgICAgICAgX2Fzc2VydChhY2Nlc3NUb2tlbiwgdGhpcy5hdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgIGlmICh0aGlzLmFjY2Vzc1Rva2VuICE9PSBhY2Nlc3NUb2tlbikge1xuICAgICAgICAgICAgdGhpcy5hY2Nlc3NUb2tlbiA9IGFjY2Vzc1Rva2VuO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5hdXRoLl9wZXJzaXN0VXNlcklmQ3VycmVudCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuYXV0aC5fbm90aWZ5TGlzdGVuZXJzSWZDdXJyZW50KHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhY2Nlc3NUb2tlbjtcbiAgICB9XG4gICAgZ2V0SWRUb2tlblJlc3VsdChmb3JjZVJlZnJlc2gpIHtcbiAgICAgICAgcmV0dXJuIGdldElkVG9rZW5SZXN1bHQodGhpcywgZm9yY2VSZWZyZXNoKTtcbiAgICB9XG4gICAgcmVsb2FkKCkge1xuICAgICAgICByZXR1cm4gcmVsb2FkKHRoaXMpO1xuICAgIH1cbiAgICBfYXNzaWduKHVzZXIpIHtcbiAgICAgICAgaWYgKHRoaXMgPT09IHVzZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBfYXNzZXJ0KHRoaXMudWlkID09PSB1c2VyLnVpZCwgdGhpcy5hdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgIHRoaXMuZGlzcGxheU5hbWUgPSB1c2VyLmRpc3BsYXlOYW1lO1xuICAgICAgICB0aGlzLnBob3RvVVJMID0gdXNlci5waG90b1VSTDtcbiAgICAgICAgdGhpcy5lbWFpbCA9IHVzZXIuZW1haWw7XG4gICAgICAgIHRoaXMuZW1haWxWZXJpZmllZCA9IHVzZXIuZW1haWxWZXJpZmllZDtcbiAgICAgICAgdGhpcy5waG9uZU51bWJlciA9IHVzZXIucGhvbmVOdW1iZXI7XG4gICAgICAgIHRoaXMuaXNBbm9ueW1vdXMgPSB1c2VyLmlzQW5vbnltb3VzO1xuICAgICAgICB0aGlzLnRlbmFudElkID0gdXNlci50ZW5hbnRJZDtcbiAgICAgICAgdGhpcy5wcm92aWRlckRhdGEgPSB1c2VyLnByb3ZpZGVyRGF0YS5tYXAodXNlckluZm8gPT4gKHsgLi4udXNlckluZm8gfSkpO1xuICAgICAgICB0aGlzLm1ldGFkYXRhLl9jb3B5KHVzZXIubWV0YWRhdGEpO1xuICAgICAgICB0aGlzLnN0c1Rva2VuTWFuYWdlci5fYXNzaWduKHVzZXIuc3RzVG9rZW5NYW5hZ2VyKTtcbiAgICB9XG4gICAgX2Nsb25lKGF1dGgpIHtcbiAgICAgICAgY29uc3QgbmV3VXNlciA9IG5ldyBVc2VySW1wbCh7XG4gICAgICAgICAgICAuLi50aGlzLFxuICAgICAgICAgICAgYXV0aCxcbiAgICAgICAgICAgIHN0c1Rva2VuTWFuYWdlcjogdGhpcy5zdHNUb2tlbk1hbmFnZXIuX2Nsb25lKClcbiAgICAgICAgfSk7XG4gICAgICAgIG5ld1VzZXIubWV0YWRhdGEuX2NvcHkodGhpcy5tZXRhZGF0YSk7XG4gICAgICAgIHJldHVybiBuZXdVc2VyO1xuICAgIH1cbiAgICBfb25SZWxvYWQoY2FsbGJhY2spIHtcbiAgICAgICAgLy8gVGhlcmUgc2hvdWxkIG9ubHkgZXZlciBiZSBvbmUgbGlzdGVuZXIsIGFuZCB0aGF0IGlzIGEgc2luZ2xlIGluc3RhbmNlIG9mIE11bHRpRmFjdG9yVXNlclxuICAgICAgICBfYXNzZXJ0KCF0aGlzLnJlbG9hZExpc3RlbmVyLCB0aGlzLmF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgdGhpcy5yZWxvYWRMaXN0ZW5lciA9IGNhbGxiYWNrO1xuICAgICAgICBpZiAodGhpcy5yZWxvYWRVc2VySW5mbykge1xuICAgICAgICAgICAgdGhpcy5fbm90aWZ5UmVsb2FkTGlzdGVuZXIodGhpcy5yZWxvYWRVc2VySW5mbyk7XG4gICAgICAgICAgICB0aGlzLnJlbG9hZFVzZXJJbmZvID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfbm90aWZ5UmVsb2FkTGlzdGVuZXIodXNlckluZm8pIHtcbiAgICAgICAgaWYgKHRoaXMucmVsb2FkTGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHRoaXMucmVsb2FkTGlzdGVuZXIodXNlckluZm8pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gSWYgbm8gbGlzdGVuZXIgaXMgc3Vic2NyaWJlZCB5ZXQsIHNhdmUgdGhlIHJlc3VsdCBzbyBpdCdzIGF2YWlsYWJsZSB3aGVuIHRoZXkgZG8gc3Vic2NyaWJlXG4gICAgICAgICAgICB0aGlzLnJlbG9hZFVzZXJJbmZvID0gdXNlckluZm87XG4gICAgICAgIH1cbiAgICB9XG4gICAgX3N0YXJ0UHJvYWN0aXZlUmVmcmVzaCgpIHtcbiAgICAgICAgdGhpcy5wcm9hY3RpdmVSZWZyZXNoLl9zdGFydCgpO1xuICAgIH1cbiAgICBfc3RvcFByb2FjdGl2ZVJlZnJlc2goKSB7XG4gICAgICAgIHRoaXMucHJvYWN0aXZlUmVmcmVzaC5fc3RvcCgpO1xuICAgIH1cbiAgICBhc3luYyBfdXBkYXRlVG9rZW5zSWZOZWNlc3NhcnkocmVzcG9uc2UsIHJlbG9hZCA9IGZhbHNlKSB7XG4gICAgICAgIGxldCB0b2tlbnNSZWZyZXNoZWQgPSBmYWxzZTtcbiAgICAgICAgaWYgKHJlc3BvbnNlLmlkVG9rZW4gJiZcbiAgICAgICAgICAgIHJlc3BvbnNlLmlkVG9rZW4gIT09IHRoaXMuc3RzVG9rZW5NYW5hZ2VyLmFjY2Vzc1Rva2VuKSB7XG4gICAgICAgICAgICB0aGlzLnN0c1Rva2VuTWFuYWdlci51cGRhdGVGcm9tU2VydmVyUmVzcG9uc2UocmVzcG9uc2UpO1xuICAgICAgICAgICAgdG9rZW5zUmVmcmVzaGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVsb2FkKSB7XG4gICAgICAgICAgICBhd2FpdCBfcmVsb2FkV2l0aG91dFNhdmluZyh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBhd2FpdCB0aGlzLmF1dGguX3BlcnNpc3RVc2VySWZDdXJyZW50KHRoaXMpO1xuICAgICAgICBpZiAodG9rZW5zUmVmcmVzaGVkKSB7XG4gICAgICAgICAgICB0aGlzLmF1dGguX25vdGlmeUxpc3RlbmVyc0lmQ3VycmVudCh0aGlzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBkZWxldGUoKSB7XG4gICAgICAgIGlmIChfaXNGaXJlYmFzZVNlcnZlckFwcCh0aGlzLmF1dGguYXBwKSkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KF9zZXJ2ZXJBcHBDdXJyZW50VXNlck9wZXJhdGlvbk5vdFN1cHBvcnRlZEVycm9yKHRoaXMuYXV0aCkpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGlkVG9rZW4gPSBhd2FpdCB0aGlzLmdldElkVG9rZW4oKTtcbiAgICAgICAgYXdhaXQgX2xvZ291dElmSW52YWxpZGF0ZWQodGhpcywgZGVsZXRlQWNjb3VudCh0aGlzLmF1dGgsIHsgaWRUb2tlbiB9KSk7XG4gICAgICAgIHRoaXMuc3RzVG9rZW5NYW5hZ2VyLmNsZWFyUmVmcmVzaFRva2VuKCk7XG4gICAgICAgIC8vIFRPRE86IERldGVybWluZSBpZiBjYW5jZWxsYWJsZS1wcm9taXNlcyBhcmUgbmVjZXNzYXJ5IHRvIHVzZSBpbiB0aGlzIGNsYXNzIHNvIHRoYXQgZGVsZXRlKClcbiAgICAgICAgLy8gICAgICAgY2FuY2VscyBwZW5kaW5nIGFjdGlvbnMuLi5cbiAgICAgICAgcmV0dXJuIHRoaXMuYXV0aC5zaWduT3V0KCk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHVpZDogdGhpcy51aWQsXG4gICAgICAgICAgICBlbWFpbDogdGhpcy5lbWFpbCB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0aGlzLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogdGhpcy5kaXNwbGF5TmFtZSB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICBpc0Fub255bW91czogdGhpcy5pc0Fub255bW91cyxcbiAgICAgICAgICAgIHBob3RvVVJMOiB0aGlzLnBob3RvVVJMIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHBob25lTnVtYmVyOiB0aGlzLnBob25lTnVtYmVyIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHRlbmFudElkOiB0aGlzLnRlbmFudElkIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHByb3ZpZGVyRGF0YTogdGhpcy5wcm92aWRlckRhdGEubWFwKHVzZXJJbmZvID0+ICh7IC4uLnVzZXJJbmZvIH0pKSxcbiAgICAgICAgICAgIHN0c1Rva2VuTWFuYWdlcjogdGhpcy5zdHNUb2tlbk1hbmFnZXIudG9KU09OKCksXG4gICAgICAgICAgICAvLyBSZWRpcmVjdCBldmVudCBJRCBtdXN0IGJlIG1haW50YWluZWQgaW4gY2FzZSB0aGVyZSBpcyBhIHBlbmRpbmdcbiAgICAgICAgICAgIC8vIHJlZGlyZWN0IGV2ZW50LlxuICAgICAgICAgICAgX3JlZGlyZWN0RXZlbnRJZDogdGhpcy5fcmVkaXJlY3RFdmVudElkLFxuICAgICAgICAgICAgLi4udGhpcy5tZXRhZGF0YS50b0pTT04oKSxcbiAgICAgICAgICAgIC8vIFJlcXVpcmVkIGZvciBjb21wYXRpYmlsaXR5IHdpdGggdGhlIGxlZ2FjeSBTREsgKGdvL2ZpcmViYXNlLWF1dGgtc2RrLXBlcnNpc3RlbmNlLXBhcnNpbmcpOlxuICAgICAgICAgICAgYXBpS2V5OiB0aGlzLmF1dGguY29uZmlnLmFwaUtleSxcbiAgICAgICAgICAgIGFwcE5hbWU6IHRoaXMuYXV0aC5uYW1lXG4gICAgICAgICAgICAvLyBNaXNzaW5nIGF1dGhEb21haW4gd2lsbCBiZSB0b2xlcmF0ZWQgYnkgdGhlIGxlZ2FjeSBTREsuXG4gICAgICAgICAgICAvLyBzdHNUb2tlbk1hbmFnZXIuYXBpS2V5IGlzbid0IGFjdHVhbGx5IHJlcXVpcmVkIChkZXNwaXRlIHRoZSBsZWdhY3kgU0RLIHBlcnNpc3RpbmcgaXQpLlxuICAgICAgICB9O1xuICAgIH1cbiAgICBnZXQgcmVmcmVzaFRva2VuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdHNUb2tlbk1hbmFnZXIucmVmcmVzaFRva2VuIHx8ICcnO1xuICAgIH1cbiAgICBzdGF0aWMgX2Zyb21KU09OKGF1dGgsIG9iamVjdCkge1xuICAgICAgICBjb25zdCBkaXNwbGF5TmFtZSA9IG9iamVjdC5kaXNwbGF5TmFtZSA/PyB1bmRlZmluZWQ7XG4gICAgICAgIGNvbnN0IGVtYWlsID0gb2JqZWN0LmVtYWlsID8/IHVuZGVmaW5lZDtcbiAgICAgICAgY29uc3QgcGhvbmVOdW1iZXIgPSBvYmplY3QucGhvbmVOdW1iZXIgPz8gdW5kZWZpbmVkO1xuICAgICAgICBjb25zdCBwaG90b1VSTCA9IG9iamVjdC5waG90b1VSTCA/PyB1bmRlZmluZWQ7XG4gICAgICAgIGNvbnN0IHRlbmFudElkID0gb2JqZWN0LnRlbmFudElkID8/IHVuZGVmaW5lZDtcbiAgICAgICAgY29uc3QgX3JlZGlyZWN0RXZlbnRJZCA9IG9iamVjdC5fcmVkaXJlY3RFdmVudElkID8/IHVuZGVmaW5lZDtcbiAgICAgICAgY29uc3QgY3JlYXRlZEF0ID0gb2JqZWN0LmNyZWF0ZWRBdCA/PyB1bmRlZmluZWQ7XG4gICAgICAgIGNvbnN0IGxhc3RMb2dpbkF0ID0gb2JqZWN0Lmxhc3RMb2dpbkF0ID8/IHVuZGVmaW5lZDtcbiAgICAgICAgY29uc3QgeyB1aWQsIGVtYWlsVmVyaWZpZWQsIGlzQW5vbnltb3VzLCBwcm92aWRlckRhdGEsIHN0c1Rva2VuTWFuYWdlcjogcGxhaW5PYmplY3RUb2tlbk1hbmFnZXIgfSA9IG9iamVjdDtcbiAgICAgICAgX2Fzc2VydCh1aWQgJiYgcGxhaW5PYmplY3RUb2tlbk1hbmFnZXIsIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgY29uc3Qgc3RzVG9rZW5NYW5hZ2VyID0gU3RzVG9rZW5NYW5hZ2VyLmZyb21KU09OKHRoaXMubmFtZSwgcGxhaW5PYmplY3RUb2tlbk1hbmFnZXIpO1xuICAgICAgICBfYXNzZXJ0KHR5cGVvZiB1aWQgPT09ICdzdHJpbmcnLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgIGFzc2VydFN0cmluZ09yVW5kZWZpbmVkKGRpc3BsYXlOYW1lLCBhdXRoLm5hbWUpO1xuICAgICAgICBhc3NlcnRTdHJpbmdPclVuZGVmaW5lZChlbWFpbCwgYXV0aC5uYW1lKTtcbiAgICAgICAgX2Fzc2VydCh0eXBlb2YgZW1haWxWZXJpZmllZCA9PT0gJ2Jvb2xlYW4nLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgIF9hc3NlcnQodHlwZW9mIGlzQW5vbnltb3VzID09PSAnYm9vbGVhbicsIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgYXNzZXJ0U3RyaW5nT3JVbmRlZmluZWQocGhvbmVOdW1iZXIsIGF1dGgubmFtZSk7XG4gICAgICAgIGFzc2VydFN0cmluZ09yVW5kZWZpbmVkKHBob3RvVVJMLCBhdXRoLm5hbWUpO1xuICAgICAgICBhc3NlcnRTdHJpbmdPclVuZGVmaW5lZCh0ZW5hbnRJZCwgYXV0aC5uYW1lKTtcbiAgICAgICAgYXNzZXJ0U3RyaW5nT3JVbmRlZmluZWQoX3JlZGlyZWN0RXZlbnRJZCwgYXV0aC5uYW1lKTtcbiAgICAgICAgYXNzZXJ0U3RyaW5nT3JVbmRlZmluZWQoY3JlYXRlZEF0LCBhdXRoLm5hbWUpO1xuICAgICAgICBhc3NlcnRTdHJpbmdPclVuZGVmaW5lZChsYXN0TG9naW5BdCwgYXV0aC5uYW1lKTtcbiAgICAgICAgY29uc3QgdXNlciA9IG5ldyBVc2VySW1wbCh7XG4gICAgICAgICAgICB1aWQsXG4gICAgICAgICAgICBhdXRoLFxuICAgICAgICAgICAgZW1haWwsXG4gICAgICAgICAgICBlbWFpbFZlcmlmaWVkLFxuICAgICAgICAgICAgZGlzcGxheU5hbWUsXG4gICAgICAgICAgICBpc0Fub255bW91cyxcbiAgICAgICAgICAgIHBob3RvVVJMLFxuICAgICAgICAgICAgcGhvbmVOdW1iZXIsXG4gICAgICAgICAgICB0ZW5hbnRJZCxcbiAgICAgICAgICAgIHN0c1Rva2VuTWFuYWdlcixcbiAgICAgICAgICAgIGNyZWF0ZWRBdCxcbiAgICAgICAgICAgIGxhc3RMb2dpbkF0XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAocHJvdmlkZXJEYXRhICYmIEFycmF5LmlzQXJyYXkocHJvdmlkZXJEYXRhKSkge1xuICAgICAgICAgICAgdXNlci5wcm92aWRlckRhdGEgPSBwcm92aWRlckRhdGEubWFwKHVzZXJJbmZvID0+ICh7IC4uLnVzZXJJbmZvIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoX3JlZGlyZWN0RXZlbnRJZCkge1xuICAgICAgICAgICAgdXNlci5fcmVkaXJlY3RFdmVudElkID0gX3JlZGlyZWN0RXZlbnRJZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdXNlcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZSBhIFVzZXIgZnJvbSBhbiBpZFRva2VuIHNlcnZlciByZXNwb25zZVxuICAgICAqIEBwYXJhbSBhdXRoXG4gICAgICogQHBhcmFtIGlkVG9rZW5SZXNwb25zZVxuICAgICAqL1xuICAgIHN0YXRpYyBhc3luYyBfZnJvbUlkVG9rZW5SZXNwb25zZShhdXRoLCBpZFRva2VuUmVzcG9uc2UsIGlzQW5vbnltb3VzID0gZmFsc2UpIHtcbiAgICAgICAgY29uc3Qgc3RzVG9rZW5NYW5hZ2VyID0gbmV3IFN0c1Rva2VuTWFuYWdlcigpO1xuICAgICAgICBzdHNUb2tlbk1hbmFnZXIudXBkYXRlRnJvbVNlcnZlclJlc3BvbnNlKGlkVG9rZW5SZXNwb25zZSk7XG4gICAgICAgIC8vIEluaXRpYWxpemUgdGhlIEZpcmViYXNlIEF1dGggdXNlci5cbiAgICAgICAgY29uc3QgdXNlciA9IG5ldyBVc2VySW1wbCh7XG4gICAgICAgICAgICB1aWQ6IGlkVG9rZW5SZXNwb25zZS5sb2NhbElkLFxuICAgICAgICAgICAgYXV0aCxcbiAgICAgICAgICAgIHN0c1Rva2VuTWFuYWdlcixcbiAgICAgICAgICAgIGlzQW5vbnltb3VzXG4gICAgICAgIH0pO1xuICAgICAgICAvLyBVcGRhdGVzIHRoZSB1c2VyIGluZm8gYW5kIGRhdGEgYW5kIHJlc29sdmVzIHdpdGggYSB1c2VyIGluc3RhbmNlLlxuICAgICAgICBhd2FpdCBfcmVsb2FkV2l0aG91dFNhdmluZyh1c2VyKTtcbiAgICAgICAgcmV0dXJuIHVzZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemUgYSBVc2VyIGZyb20gYW4gaWRUb2tlbiBzZXJ2ZXIgcmVzcG9uc2VcbiAgICAgKiBAcGFyYW0gYXV0aFxuICAgICAqIEBwYXJhbSBpZFRva2VuUmVzcG9uc2VcbiAgICAgKi9cbiAgICBzdGF0aWMgYXN5bmMgX2Zyb21HZXRBY2NvdW50SW5mb1Jlc3BvbnNlKGF1dGgsIHJlc3BvbnNlLCBpZFRva2VuKSB7XG4gICAgICAgIGNvbnN0IGNvcmVBY2NvdW50ID0gcmVzcG9uc2UudXNlcnNbMF07XG4gICAgICAgIF9hc3NlcnQoY29yZUFjY291bnQubG9jYWxJZCAhPT0gdW5kZWZpbmVkLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgIGNvbnN0IHByb3ZpZGVyRGF0YSA9IGNvcmVBY2NvdW50LnByb3ZpZGVyVXNlckluZm8gIT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgPyBleHRyYWN0UHJvdmlkZXJEYXRhKGNvcmVBY2NvdW50LnByb3ZpZGVyVXNlckluZm8pXG4gICAgICAgICAgICA6IFtdO1xuICAgICAgICBjb25zdCBpc0Fub255bW91cyA9ICEoY29yZUFjY291bnQuZW1haWwgJiYgY29yZUFjY291bnQucGFzc3dvcmRIYXNoKSAmJiAhcHJvdmlkZXJEYXRhPy5sZW5ndGg7XG4gICAgICAgIGNvbnN0IHN0c1Rva2VuTWFuYWdlciA9IG5ldyBTdHNUb2tlbk1hbmFnZXIoKTtcbiAgICAgICAgc3RzVG9rZW5NYW5hZ2VyLnVwZGF0ZUZyb21JZFRva2VuKGlkVG9rZW4pO1xuICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBGaXJlYmFzZSBBdXRoIHVzZXIuXG4gICAgICAgIGNvbnN0IHVzZXIgPSBuZXcgVXNlckltcGwoe1xuICAgICAgICAgICAgdWlkOiBjb3JlQWNjb3VudC5sb2NhbElkLFxuICAgICAgICAgICAgYXV0aCxcbiAgICAgICAgICAgIHN0c1Rva2VuTWFuYWdlcixcbiAgICAgICAgICAgIGlzQW5vbnltb3VzXG4gICAgICAgIH0pO1xuICAgICAgICAvLyB1cGRhdGUgdGhlIHVzZXIgd2l0aCBkYXRhIGZyb20gdGhlIEdldEFjY291bnRJbmZvIHJlc3BvbnNlLlxuICAgICAgICBjb25zdCB1cGRhdGVzID0ge1xuICAgICAgICAgICAgdWlkOiBjb3JlQWNjb3VudC5sb2NhbElkLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6IGNvcmVBY2NvdW50LmRpc3BsYXlOYW1lIHx8IG51bGwsXG4gICAgICAgICAgICBwaG90b1VSTDogY29yZUFjY291bnQucGhvdG9VcmwgfHwgbnVsbCxcbiAgICAgICAgICAgIGVtYWlsOiBjb3JlQWNjb3VudC5lbWFpbCB8fCBudWxsLFxuICAgICAgICAgICAgZW1haWxWZXJpZmllZDogY29yZUFjY291bnQuZW1haWxWZXJpZmllZCB8fCBmYWxzZSxcbiAgICAgICAgICAgIHBob25lTnVtYmVyOiBjb3JlQWNjb3VudC5waG9uZU51bWJlciB8fCBudWxsLFxuICAgICAgICAgICAgdGVuYW50SWQ6IGNvcmVBY2NvdW50LnRlbmFudElkIHx8IG51bGwsXG4gICAgICAgICAgICBwcm92aWRlckRhdGEsXG4gICAgICAgICAgICBtZXRhZGF0YTogbmV3IFVzZXJNZXRhZGF0YShjb3JlQWNjb3VudC5jcmVhdGVkQXQsIGNvcmVBY2NvdW50Lmxhc3RMb2dpbkF0KSxcbiAgICAgICAgICAgIGlzQW5vbnltb3VzOiAhKGNvcmVBY2NvdW50LmVtYWlsICYmIGNvcmVBY2NvdW50LnBhc3N3b3JkSGFzaCkgJiZcbiAgICAgICAgICAgICAgICAhcHJvdmlkZXJEYXRhPy5sZW5ndGhcbiAgICAgICAgfTtcbiAgICAgICAgT2JqZWN0LmFzc2lnbih1c2VyLCB1cGRhdGVzKTtcbiAgICAgICAgcmV0dXJuIHVzZXI7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY29uc3QgaW5zdGFuY2VDYWNoZSA9IG5ldyBNYXAoKTtcbmZ1bmN0aW9uIF9nZXRJbnN0YW5jZShjbHMpIHtcbiAgICBkZWJ1Z0Fzc2VydChjbHMgaW5zdGFuY2VvZiBGdW5jdGlvbiwgJ0V4cGVjdGVkIGEgY2xhc3MgZGVmaW5pdGlvbicpO1xuICAgIGxldCBpbnN0YW5jZSA9IGluc3RhbmNlQ2FjaGUuZ2V0KGNscyk7XG4gICAgaWYgKGluc3RhbmNlKSB7XG4gICAgICAgIGRlYnVnQXNzZXJ0KGluc3RhbmNlIGluc3RhbmNlb2YgY2xzLCAnSW5zdGFuY2Ugc3RvcmVkIGluIGNhY2hlIG1pc21hdGNoZWQgd2l0aCBjbGFzcycpO1xuICAgICAgICByZXR1cm4gaW5zdGFuY2U7XG4gICAgfVxuICAgIGluc3RhbmNlID0gbmV3IGNscygpO1xuICAgIGluc3RhbmNlQ2FjaGUuc2V0KGNscywgaW5zdGFuY2UpO1xuICAgIHJldHVybiBpbnN0YW5jZTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNsYXNzIEluTWVtb3J5UGVyc2lzdGVuY2Uge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnR5cGUgPSBcIk5PTkVcIiAvKiBQZXJzaXN0ZW5jZVR5cGUuTk9ORSAqLztcbiAgICAgICAgdGhpcy5zdG9yYWdlID0ge307XG4gICAgfVxuICAgIGFzeW5jIF9pc0F2YWlsYWJsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGFzeW5jIF9zZXQoa2V5LCB2YWx1ZSkge1xuICAgICAgICB0aGlzLnN0b3JhZ2Vba2V5XSA9IHZhbHVlO1xuICAgIH1cbiAgICBhc3luYyBfZ2V0KGtleSkge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuc3RvcmFnZVtrZXldO1xuICAgICAgICByZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCA/IG51bGwgOiB2YWx1ZTtcbiAgICB9XG4gICAgYXN5bmMgX3JlbW92ZShrZXkpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMuc3RvcmFnZVtrZXldO1xuICAgIH1cbiAgICBfYWRkTGlzdGVuZXIoX2tleSwgX2xpc3RlbmVyKSB7XG4gICAgICAgIC8vIExpc3RlbmVycyBhcmUgbm90IHN1cHBvcnRlZCBmb3IgaW4tbWVtb3J5IHN0b3JhZ2Ugc2luY2UgaXQgY2Fubm90IGJlIHNoYXJlZCBhY3Jvc3Mgd2luZG93cy93b3JrZXJzXG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgX3JlbW92ZUxpc3RlbmVyKF9rZXksIF9saXN0ZW5lcikge1xuICAgICAgICAvLyBMaXN0ZW5lcnMgYXJlIG5vdCBzdXBwb3J0ZWQgZm9yIGluLW1lbW9yeSBzdG9yYWdlIHNpbmNlIGl0IGNhbm5vdCBiZSBzaGFyZWQgYWNyb3NzIHdpbmRvd3Mvd29ya2Vyc1xuICAgICAgICByZXR1cm47XG4gICAgfVxufVxuSW5NZW1vcnlQZXJzaXN0ZW5jZS50eXBlID0gJ05PTkUnO1xuLyoqXG4gKiBBbiBpbXBsZW1lbnRhdGlvbiBvZiB7QGxpbmsgUGVyc2lzdGVuY2V9IG9mIHR5cGUgJ05PTkUnLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuY29uc3QgaW5NZW1vcnlQZXJzaXN0ZW5jZSA9IEluTWVtb3J5UGVyc2lzdGVuY2U7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5mdW5jdGlvbiBfcGVyc2lzdGVuY2VLZXlOYW1lKGtleSwgYXBpS2V5LCBhcHBOYW1lKSB7XG4gICAgcmV0dXJuIGAke1wiZmlyZWJhc2VcIiAvKiBOYW1lc3BhY2UuUEVSU0lTVEVOQ0UgKi99OiR7a2V5fToke2FwaUtleX06JHthcHBOYW1lfWA7XG59XG5jbGFzcyBQZXJzaXN0ZW5jZVVzZXJNYW5hZ2VyIHtcbiAgICBjb25zdHJ1Y3RvcihwZXJzaXN0ZW5jZSwgYXV0aCwgdXNlcktleSkge1xuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gcGVyc2lzdGVuY2U7XG4gICAgICAgIHRoaXMuYXV0aCA9IGF1dGg7XG4gICAgICAgIHRoaXMudXNlcktleSA9IHVzZXJLZXk7XG4gICAgICAgIGNvbnN0IHsgY29uZmlnLCBuYW1lIH0gPSB0aGlzLmF1dGg7XG4gICAgICAgIHRoaXMuZnVsbFVzZXJLZXkgPSBfcGVyc2lzdGVuY2VLZXlOYW1lKHRoaXMudXNlcktleSwgY29uZmlnLmFwaUtleSwgbmFtZSk7XG4gICAgICAgIHRoaXMuZnVsbFBlcnNpc3RlbmNlS2V5ID0gX3BlcnNpc3RlbmNlS2V5TmFtZShcInBlcnNpc3RlbmNlXCIgLyogS2V5TmFtZS5QRVJTSVNURU5DRV9VU0VSICovLCBjb25maWcuYXBpS2V5LCBuYW1lKTtcbiAgICAgICAgdGhpcy5ib3VuZEV2ZW50SGFuZGxlciA9IGF1dGguX29uU3RvcmFnZUV2ZW50LmJpbmQoYXV0aCk7XG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UuX2FkZExpc3RlbmVyKHRoaXMuZnVsbFVzZXJLZXksIHRoaXMuYm91bmRFdmVudEhhbmRsZXIpO1xuICAgIH1cbiAgICBzZXRDdXJyZW50VXNlcih1c2VyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLl9zZXQodGhpcy5mdWxsVXNlcktleSwgdXNlci50b0pTT04oKSk7XG4gICAgfVxuICAgIGFzeW5jIGdldEN1cnJlbnRVc2VyKCkge1xuICAgICAgICBjb25zdCBibG9iID0gYXdhaXQgdGhpcy5wZXJzaXN0ZW5jZS5fZ2V0KHRoaXMuZnVsbFVzZXJLZXkpO1xuICAgICAgICBpZiAoIWJsb2IpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgYmxvYiA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2V0QWNjb3VudEluZm8odGhpcy5hdXRoLCB7IGlkVG9rZW46IGJsb2IgfSkuY2F0Y2goKCkgPT4gdW5kZWZpbmVkKTtcbiAgICAgICAgICAgIGlmICghcmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBVc2VySW1wbC5fZnJvbUdldEFjY291bnRJbmZvUmVzcG9uc2UodGhpcy5hdXRoLCByZXNwb25zZSwgYmxvYik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFVzZXJJbXBsLl9mcm9tSlNPTih0aGlzLmF1dGgsIGJsb2IpO1xuICAgIH1cbiAgICByZW1vdmVDdXJyZW50VXNlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UuX3JlbW92ZSh0aGlzLmZ1bGxVc2VyS2V5KTtcbiAgICB9XG4gICAgc2F2ZVBlcnNpc3RlbmNlRm9yUmVkaXJlY3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLl9zZXQodGhpcy5mdWxsUGVyc2lzdGVuY2VLZXksIHRoaXMucGVyc2lzdGVuY2UudHlwZSk7XG4gICAgfVxuICAgIGFzeW5jIHNldFBlcnNpc3RlbmNlKG5ld1BlcnNpc3RlbmNlKSB7XG4gICAgICAgIGlmICh0aGlzLnBlcnNpc3RlbmNlID09PSBuZXdQZXJzaXN0ZW5jZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGN1cnJlbnRVc2VyID0gYXdhaXQgdGhpcy5nZXRDdXJyZW50VXNlcigpO1xuICAgICAgICBhd2FpdCB0aGlzLnJlbW92ZUN1cnJlbnRVc2VyKCk7XG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UgPSBuZXdQZXJzaXN0ZW5jZTtcbiAgICAgICAgaWYgKGN1cnJlbnRVc2VyKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRDdXJyZW50VXNlcihjdXJyZW50VXNlcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGVsZXRlKCkge1xuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlLl9yZW1vdmVMaXN0ZW5lcih0aGlzLmZ1bGxVc2VyS2V5LCB0aGlzLmJvdW5kRXZlbnRIYW5kbGVyKTtcbiAgICB9XG4gICAgc3RhdGljIGFzeW5jIGNyZWF0ZShhdXRoLCBwZXJzaXN0ZW5jZUhpZXJhcmNoeSwgdXNlcktleSA9IFwiYXV0aFVzZXJcIiAvKiBLZXlOYW1lLkFVVEhfVVNFUiAqLykge1xuICAgICAgICBpZiAoIXBlcnNpc3RlbmNlSGllcmFyY2h5Lmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW5jZVVzZXJNYW5hZ2VyKF9nZXRJbnN0YW5jZShpbk1lbW9yeVBlcnNpc3RlbmNlKSwgYXV0aCwgdXNlcktleSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gRWxpbWluYXRlIGFueSBwZXJzaXN0ZW5jZXMgdGhhdCBhcmUgbm90IGF2YWlsYWJsZVxuICAgICAgICBjb25zdCBhdmFpbGFibGVQZXJzaXN0ZW5jZXMgPSAoYXdhaXQgUHJvbWlzZS5hbGwocGVyc2lzdGVuY2VIaWVyYXJjaHkubWFwKGFzeW5jIChwZXJzaXN0ZW5jZSkgPT4ge1xuICAgICAgICAgICAgaWYgKGF3YWl0IHBlcnNpc3RlbmNlLl9pc0F2YWlsYWJsZSgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBlcnNpc3RlbmNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfSkpKS5maWx0ZXIocGVyc2lzdGVuY2UgPT4gcGVyc2lzdGVuY2UpO1xuICAgICAgICAvLyBGYWxsIGJhY2sgdG8gdGhlIGZpcnN0IHBlcnNpc3RlbmNlIGxpc3RlZCwgb3IgaW4gbWVtb3J5IGlmIG5vbmUgYXZhaWxhYmxlXG4gICAgICAgIGxldCBzZWxlY3RlZFBlcnNpc3RlbmNlID0gYXZhaWxhYmxlUGVyc2lzdGVuY2VzWzBdIHx8XG4gICAgICAgICAgICBfZ2V0SW5zdGFuY2UoaW5NZW1vcnlQZXJzaXN0ZW5jZSk7XG4gICAgICAgIGNvbnN0IGtleSA9IF9wZXJzaXN0ZW5jZUtleU5hbWUodXNlcktleSwgYXV0aC5jb25maWcuYXBpS2V5LCBhdXRoLm5hbWUpO1xuICAgICAgICAvLyBQdWxsIG91dCB0aGUgZXhpc3RpbmcgdXNlciwgc2V0dGluZyB0aGUgY2hvc2VuIHBlcnNpc3RlbmNlIHRvIHRoYXRcbiAgICAgICAgLy8gcGVyc2lzdGVuY2UgaWYgdGhlIHVzZXIgZXhpc3RzLlxuICAgICAgICBsZXQgdXNlclRvTWlncmF0ZSA9IG51bGw7XG4gICAgICAgIC8vIE5vdGUsIGhlcmUgd2UgY2hlY2sgZm9yIGEgdXNlciBpbiBfYWxsXyBwZXJzaXN0ZW5jZXMsIG5vdCBqdXN0IHRoZVxuICAgICAgICAvLyBvbmVzIGRlZW1lZCBhdmFpbGFibGUuIElmIHdlIGNhbiBtaWdyYXRlIGEgdXNlciBvdXQgb2YgYSBicm9rZW5cbiAgICAgICAgLy8gcGVyc2lzdGVuY2UsIHdlIHdpbGwgKGJ1dCBvbmx5IGlmIHRoYXQgcGVyc2lzdGVuY2Ugc3VwcG9ydHMgbWlncmF0aW9uKS5cbiAgICAgICAgZm9yIChjb25zdCBwZXJzaXN0ZW5jZSBvZiBwZXJzaXN0ZW5jZUhpZXJhcmNoeSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0gYXdhaXQgcGVyc2lzdGVuY2UuX2dldChrZXkpO1xuICAgICAgICAgICAgICAgIGlmIChibG9iKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCB1c2VyO1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGJsb2IgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldEFjY291bnRJbmZvKGF1dGgsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZFRva2VuOiBibG9iXG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB1bmRlZmluZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlciA9IGF3YWl0IFVzZXJJbXBsLl9mcm9tR2V0QWNjb3VudEluZm9SZXNwb25zZShhdXRoLCByZXNwb25zZSwgYmxvYik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyID0gVXNlckltcGwuX2Zyb21KU09OKGF1dGgsIGJsb2IpOyAvLyB0aHJvd3MgZm9yIHVucGFyc2FibGUgYmxvYiAod3JvbmcgZm9ybWF0KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChwZXJzaXN0ZW5jZSAhPT0gc2VsZWN0ZWRQZXJzaXN0ZW5jZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlclRvTWlncmF0ZSA9IHVzZXI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRQZXJzaXN0ZW5jZSA9IHBlcnNpc3RlbmNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCB7IH1cbiAgICAgICAgfVxuICAgICAgICAvLyBJZiB3ZSBmaW5kIHRoZSB1c2VyIGluIGEgcGVyc2lzdGVuY2UgdGhhdCBkb2VzIHN1cHBvcnQgbWlncmF0aW9uLCB1c2VcbiAgICAgICAgLy8gdGhhdCBtaWdyYXRpb24gcGF0aCAob2Ygb25seSBwZXJzaXN0ZW5jZXMgdGhhdCBzdXBwb3J0IG1pZ3JhdGlvbilcbiAgICAgICAgY29uc3QgbWlncmF0aW9uSGllcmFyY2h5ID0gYXZhaWxhYmxlUGVyc2lzdGVuY2VzLmZpbHRlcihwID0+IHAuX3Nob3VsZEFsbG93TWlncmF0aW9uKTtcbiAgICAgICAgLy8gSWYgdGhlIHBlcnNpc3RlbmNlIGRvZXMgX25vdF8gYWxsb3cgbWlncmF0aW9uLCBqdXN0IGZpbmlzaCBvZmYgaGVyZVxuICAgICAgICBpZiAoIXNlbGVjdGVkUGVyc2lzdGVuY2UuX3Nob3VsZEFsbG93TWlncmF0aW9uIHx8XG4gICAgICAgICAgICAhbWlncmF0aW9uSGllcmFyY2h5Lmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW5jZVVzZXJNYW5hZ2VyKHNlbGVjdGVkUGVyc2lzdGVuY2UsIGF1dGgsIHVzZXJLZXkpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGVjdGVkUGVyc2lzdGVuY2UgPSBtaWdyYXRpb25IaWVyYXJjaHlbMF07XG4gICAgICAgIGlmICh1c2VyVG9NaWdyYXRlKSB7XG4gICAgICAgICAgICAvLyBUaGlzIG5vcm1hbGx5IHNob3VsZG4ndCB0aHJvdyBzaW5jZSBjaG9zZW5QZXJzaXN0ZW5jZS5pc0F2YWlsYWJsZSgpIGlzIHRydWUsIGJ1dCBpZiBpdCBkb2VzXG4gICAgICAgICAgICAvLyB3ZSdsbCBqdXN0IGxldCBpdCBidWJibGUgdG8gc3VyZmFjZSB0aGUgZXJyb3IuXG4gICAgICAgICAgICBhd2FpdCBzZWxlY3RlZFBlcnNpc3RlbmNlLl9zZXQoa2V5LCB1c2VyVG9NaWdyYXRlLnRvSlNPTigpKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBBdHRlbXB0IHRvIGNsZWFyIHRoZSBrZXkgaW4gb3RoZXIgcGVyc2lzdGVuY2VzIGJ1dCBpZ25vcmUgZXJyb3JzLiBUaGlzIGhlbHBzIHByZXZlbnQgaXNzdWVzXG4gICAgICAgIC8vIHN1Y2ggYXMgdXNlcnMgZ2V0dGluZyBzdHVjayB3aXRoIGEgcHJldmlvdXMgYWNjb3VudCBhZnRlciBzaWduaW5nIG91dCBhbmQgcmVmcmVzaGluZyB0aGUgdGFiLlxuICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChwZXJzaXN0ZW5jZUhpZXJhcmNoeS5tYXAoYXN5bmMgKHBlcnNpc3RlbmNlKSA9PiB7XG4gICAgICAgICAgICBpZiAocGVyc2lzdGVuY2UgIT09IHNlbGVjdGVkUGVyc2lzdGVuY2UpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBwZXJzaXN0ZW5jZS5fcmVtb3ZlKGtleSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIHsgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiBuZXcgUGVyc2lzdGVuY2VVc2VyTWFuYWdlcihzZWxlY3RlZFBlcnNpc3RlbmNlLCBhdXRoLCB1c2VyS2V5KTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIERldGVybWluZSB0aGUgYnJvd3NlciBmb3IgdGhlIHB1cnBvc2VzIG9mIHJlcG9ydGluZyB1c2FnZSB0byB0aGUgQVBJXG4gKi9cbmZ1bmN0aW9uIF9nZXRCcm93c2VyTmFtZSh1c2VyQWdlbnQpIHtcbiAgICBjb25zdCB1YSA9IHVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpO1xuICAgIGlmICh1YS5pbmNsdWRlcygnb3BlcmEvJykgfHwgdWEuaW5jbHVkZXMoJ29wci8nKSB8fCB1YS5pbmNsdWRlcygnb3Bpb3MvJykpIHtcbiAgICAgICAgcmV0dXJuIFwiT3BlcmFcIiAvKiBCcm93c2VyTmFtZS5PUEVSQSAqLztcbiAgICB9XG4gICAgZWxzZSBpZiAoX2lzSUVNb2JpbGUodWEpKSB7XG4gICAgICAgIC8vIFdpbmRvd3MgcGhvbmUgSUVNb2JpbGUgYnJvd3Nlci5cbiAgICAgICAgcmV0dXJuIFwiSUVNb2JpbGVcIiAvKiBCcm93c2VyTmFtZS5JRU1PQklMRSAqLztcbiAgICB9XG4gICAgZWxzZSBpZiAodWEuaW5jbHVkZXMoJ21zaWUnKSB8fCB1YS5pbmNsdWRlcygndHJpZGVudC8nKSkge1xuICAgICAgICByZXR1cm4gXCJJRVwiIC8qIEJyb3dzZXJOYW1lLklFICovO1xuICAgIH1cbiAgICBlbHNlIGlmICh1YS5pbmNsdWRlcygnZWRnZS8nKSkge1xuICAgICAgICByZXR1cm4gXCJFZGdlXCIgLyogQnJvd3Nlck5hbWUuRURHRSAqLztcbiAgICB9XG4gICAgZWxzZSBpZiAoX2lzRmlyZWZveCh1YSkpIHtcbiAgICAgICAgcmV0dXJuIFwiRmlyZWZveFwiIC8qIEJyb3dzZXJOYW1lLkZJUkVGT1ggKi87XG4gICAgfVxuICAgIGVsc2UgaWYgKHVhLmluY2x1ZGVzKCdzaWxrLycpKSB7XG4gICAgICAgIHJldHVybiBcIlNpbGtcIiAvKiBCcm93c2VyTmFtZS5TSUxLICovO1xuICAgIH1cbiAgICBlbHNlIGlmIChfaXNCbGFja0JlcnJ5KHVhKSkge1xuICAgICAgICAvLyBCbGFja2JlcnJ5IGJyb3dzZXIuXG4gICAgICAgIHJldHVybiBcIkJsYWNrYmVycnlcIiAvKiBCcm93c2VyTmFtZS5CTEFDS0JFUlJZICovO1xuICAgIH1cbiAgICBlbHNlIGlmIChfaXNXZWJPUyh1YSkpIHtcbiAgICAgICAgLy8gV2ViT1MgZGVmYXVsdCBicm93c2VyLlxuICAgICAgICByZXR1cm4gXCJXZWJvc1wiIC8qIEJyb3dzZXJOYW1lLldFQk9TICovO1xuICAgIH1cbiAgICBlbHNlIGlmIChfaXNTYWZhcmkodWEpKSB7XG4gICAgICAgIHJldHVybiBcIlNhZmFyaVwiIC8qIEJyb3dzZXJOYW1lLlNBRkFSSSAqLztcbiAgICB9XG4gICAgZWxzZSBpZiAoKHVhLmluY2x1ZGVzKCdjaHJvbWUvJykgfHwgX2lzQ2hyb21lSU9TKHVhKSkgJiZcbiAgICAgICAgIXVhLmluY2x1ZGVzKCdlZGdlLycpKSB7XG4gICAgICAgIHJldHVybiBcIkNocm9tZVwiIC8qIEJyb3dzZXJOYW1lLkNIUk9NRSAqLztcbiAgICB9XG4gICAgZWxzZSBpZiAoX2lzQW5kcm9pZCh1YSkpIHtcbiAgICAgICAgLy8gQW5kcm9pZCBzdG9jayBicm93c2VyLlxuICAgICAgICByZXR1cm4gXCJBbmRyb2lkXCIgLyogQnJvd3Nlck5hbWUuQU5EUk9JRCAqLztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIC8vIE1vc3QgbW9kZXJuIGJyb3dzZXJzIGhhdmUgbmFtZS92ZXJzaW9uIGF0IGVuZCBvZiB1c2VyIGFnZW50IHN0cmluZy5cbiAgICAgICAgY29uc3QgcmUgPSAvKFthLXpBLVpcXGRcXC5dKylcXC9bYS16QS1aXFxkXFwuXSokLztcbiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IHVzZXJBZ2VudC5tYXRjaChyZSk7XG4gICAgICAgIGlmIChtYXRjaGVzPy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgIHJldHVybiBtYXRjaGVzWzFdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBcIk90aGVyXCIgLyogQnJvd3Nlck5hbWUuT1RIRVIgKi87XG59XG5mdW5jdGlvbiBfaXNGaXJlZm94KHVhID0gZ2V0VUEoKSkge1xuICAgIHJldHVybiAvZmlyZWZveFxcLy9pLnRlc3QodWEpO1xufVxuZnVuY3Rpb24gX2lzU2FmYXJpKHVzZXJBZ2VudCA9IGdldFVBKCkpIHtcbiAgICBjb25zdCB1YSA9IHVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpO1xuICAgIHJldHVybiAodWEuaW5jbHVkZXMoJ3NhZmFyaS8nKSAmJlxuICAgICAgICAhdWEuaW5jbHVkZXMoJ2Nocm9tZS8nKSAmJlxuICAgICAgICAhdWEuaW5jbHVkZXMoJ2NyaW9zLycpICYmXG4gICAgICAgICF1YS5pbmNsdWRlcygnYW5kcm9pZCcpKTtcbn1cbmZ1bmN0aW9uIF9pc0Nocm9tZUlPUyh1YSA9IGdldFVBKCkpIHtcbiAgICByZXR1cm4gL2NyaW9zXFwvL2kudGVzdCh1YSk7XG59XG5mdW5jdGlvbiBfaXNJRU1vYmlsZSh1YSA9IGdldFVBKCkpIHtcbiAgICByZXR1cm4gL2llbW9iaWxlL2kudGVzdCh1YSk7XG59XG5mdW5jdGlvbiBfaXNBbmRyb2lkKHVhID0gZ2V0VUEoKSkge1xuICAgIHJldHVybiAvYW5kcm9pZC9pLnRlc3QodWEpO1xufVxuZnVuY3Rpb24gX2lzQmxhY2tCZXJyeSh1YSA9IGdldFVBKCkpIHtcbiAgICByZXR1cm4gL2JsYWNrYmVycnkvaS50ZXN0KHVhKTtcbn1cbmZ1bmN0aW9uIF9pc1dlYk9TKHVhID0gZ2V0VUEoKSkge1xuICAgIHJldHVybiAvd2Vib3MvaS50ZXN0KHVhKTtcbn1cbmZ1bmN0aW9uIF9pc0lPUyh1YSA9IGdldFVBKCkpIHtcbiAgICByZXR1cm4gKC9pcGhvbmV8aXBhZHxpcG9kL2kudGVzdCh1YSkgfHxcbiAgICAgICAgKC9tYWNpbnRvc2gvaS50ZXN0KHVhKSAmJiAvbW9iaWxlL2kudGVzdCh1YSkpKTtcbn1cbmZ1bmN0aW9uIF9pc0lPUzdPcjgodWEgPSBnZXRVQSgpKSB7XG4gICAgcmV0dXJuICgvKGlQYWR8aVBob25lfGlQb2QpLipPUyA3X1xcZC9pLnRlc3QodWEpIHx8XG4gICAgICAgIC8oaVBhZHxpUGhvbmV8aVBvZCkuKk9TIDhfXFxkL2kudGVzdCh1YSkpO1xufVxuZnVuY3Rpb24gX2lzSU9TU3RhbmRhbG9uZSh1YSA9IGdldFVBKCkpIHtcbiAgICByZXR1cm4gX2lzSU9TKHVhKSAmJiAhIXdpbmRvdy5uYXZpZ2F0b3I/LnN0YW5kYWxvbmU7XG59XG5mdW5jdGlvbiBfaXNJRTEwKCkge1xuICAgIHJldHVybiBpc0lFKCkgJiYgZG9jdW1lbnQuZG9jdW1lbnRNb2RlID09PSAxMDtcbn1cbmZ1bmN0aW9uIF9pc01vYmlsZUJyb3dzZXIodWEgPSBnZXRVQSgpKSB7XG4gICAgLy8gVE9ETzogaW1wbGVtZW50IGdldEJyb3dzZXJOYW1lIGVxdWl2YWxlbnQgZm9yIE9TLlxuICAgIHJldHVybiAoX2lzSU9TKHVhKSB8fFxuICAgICAgICBfaXNBbmRyb2lkKHVhKSB8fFxuICAgICAgICBfaXNXZWJPUyh1YSkgfHxcbiAgICAgICAgX2lzQmxhY2tCZXJyeSh1YSkgfHxcbiAgICAgICAgL3dpbmRvd3MgcGhvbmUvaS50ZXN0KHVhKSB8fFxuICAgICAgICBfaXNJRU1vYmlsZSh1YSkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLypcbiAqIERldGVybWluZSB0aGUgU0RLIHZlcnNpb24gc3RyaW5nXG4gKi9cbmZ1bmN0aW9uIF9nZXRDbGllbnRWZXJzaW9uKGNsaWVudFBsYXRmb3JtLCBmcmFtZXdvcmtzID0gW10pIHtcbiAgICBsZXQgcmVwb3J0ZWRQbGF0Zm9ybTtcbiAgICBzd2l0Y2ggKGNsaWVudFBsYXRmb3JtKSB7XG4gICAgICAgIGNhc2UgXCJCcm93c2VyXCIgLyogQ2xpZW50UGxhdGZvcm0uQlJPV1NFUiAqLzpcbiAgICAgICAgICAgIC8vIEluIGEgYnJvd3NlciBlbnZpcm9ubWVudCwgcmVwb3J0IHRoZSBicm93c2VyIG5hbWUuXG4gICAgICAgICAgICByZXBvcnRlZFBsYXRmb3JtID0gX2dldEJyb3dzZXJOYW1lKGdldFVBKCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJXb3JrZXJcIiAvKiBDbGllbnRQbGF0Zm9ybS5XT1JLRVIgKi86XG4gICAgICAgICAgICAvLyBUZWNobmljYWxseSBhIHdvcmtlciBydW5zIGZyb20gYSBicm93c2VyIGJ1dCB3ZSBuZWVkIHRvIGRpZmZlcmVudGlhdGUgYVxuICAgICAgICAgICAgLy8gd29ya2VyIGZyb20gYSBicm93c2VyLlxuICAgICAgICAgICAgLy8gRm9yIGV4YW1wbGU6IENocm9tZS1Xb3JrZXIvSnNDb3JlLzQuOS4xL0ZpcmViYXNlQ29yZS13ZWIuXG4gICAgICAgICAgICByZXBvcnRlZFBsYXRmb3JtID0gYCR7X2dldEJyb3dzZXJOYW1lKGdldFVBKCkpfS0ke2NsaWVudFBsYXRmb3JtfWA7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJlcG9ydGVkUGxhdGZvcm0gPSBjbGllbnRQbGF0Zm9ybTtcbiAgICB9XG4gICAgY29uc3QgcmVwb3J0ZWRGcmFtZXdvcmtzID0gZnJhbWV3b3Jrcy5sZW5ndGhcbiAgICAgICAgPyBmcmFtZXdvcmtzLmpvaW4oJywnKVxuICAgICAgICA6ICdGaXJlYmFzZUNvcmUtd2ViJzsgLyogZGVmYXVsdCB2YWx1ZSBpZiBubyBvdGhlciBmcmFtZXdvcmsgaXMgdXNlZCAqL1xuICAgIHJldHVybiBgJHtyZXBvcnRlZFBsYXRmb3JtfS8ke1wiSnNDb3JlXCIgLyogQ2xpZW50SW1wbGVtZW50YXRpb24uQ09SRSAqL30vJHtTREtfVkVSU0lPTn0vJHtyZXBvcnRlZEZyYW1ld29ya3N9YDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNsYXNzIEF1dGhNaWRkbGV3YXJlUXVldWUge1xuICAgIGNvbnN0cnVjdG9yKGF1dGgpIHtcbiAgICAgICAgdGhpcy5hdXRoID0gYXV0aDtcbiAgICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xuICAgIH1cbiAgICBwdXNoQ2FsbGJhY2soY2FsbGJhY2ssIG9uQWJvcnQpIHtcbiAgICAgICAgLy8gVGhlIGNhbGxiYWNrIGNvdWxkIGJlIHN5bmMgb3IgYXN5bmMuIFdyYXAgaXQgaW50byBhXG4gICAgICAgIC8vIGZ1bmN0aW9uIHRoYXQgaXMgYWx3YXlzIGFzeW5jLlxuICAgICAgICBjb25zdCB3cmFwcGVkQ2FsbGJhY2sgPSAodXNlcikgPT4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBjYWxsYmFjayh1c2VyKTtcbiAgICAgICAgICAgICAgICAvLyBFaXRoZXIgcmVzb2x2ZSB3aXRoIGV4aXN0aW5nIHByb21pc2Ugb3Igd3JhcCBhIG5vbi1wcm9taXNlXG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIHZhbHVlIGludG8gYSBwcm9taXNlLlxuICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy8gU3luYyBjYWxsYmFjayB0aHJvd3MuXG4gICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gQXR0YWNoIHRoZSBvbkFib3J0IGlmIHByZXNlbnRcbiAgICAgICAgd3JhcHBlZENhbGxiYWNrLm9uQWJvcnQgPSBvbkFib3J0O1xuICAgICAgICB0aGlzLnF1ZXVlLnB1c2god3JhcHBlZENhbGxiYWNrKTtcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnF1ZXVlLmxlbmd0aCAtIDE7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICAvLyBVbnN1YnNjcmliZS4gUmVwbGFjZSB3aXRoIG5vLW9wLiBEbyBub3QgcmVtb3ZlIGZyb20gYXJyYXksIG9yIGl0IHdpbGwgZGlzdHVyYlxuICAgICAgICAgICAgLy8gaW5kZXhpbmcgb2Ygb3RoZXIgZWxlbWVudHMuXG4gICAgICAgICAgICB0aGlzLnF1ZXVlW2luZGV4XSA9ICgpID0+IFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICBhc3luYyBydW5NaWRkbGV3YXJlKG5leHRVc2VyKSB7XG4gICAgICAgIGlmICh0aGlzLmF1dGguY3VycmVudFVzZXIgPT09IG5leHRVc2VyKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gV2hpbGUgcnVubmluZyB0aGUgbWlkZGxld2FyZSwgYnVpbGQgYSB0ZW1wb3Jhcnkgc3RhY2sgb2Ygb25BYm9ydFxuICAgICAgICAvLyBjYWxsYmFja3MgdG8gY2FsbCBpZiBvbmUgbWlkZGxld2FyZSBjYWxsYmFjayByZWplY3RzLlxuICAgICAgICBjb25zdCBvbkFib3J0U3RhY2sgPSBbXTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgYmVmb3JlU3RhdGVDYWxsYmFjayBvZiB0aGlzLnF1ZXVlKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgYmVmb3JlU3RhdGVDYWxsYmFjayhuZXh0VXNlcik7XG4gICAgICAgICAgICAgICAgLy8gT25seSBwdXNoIHRoZSBvbkFib3J0IGlmIHRoZSBjYWxsYmFjayBzdWNjZWVkc1xuICAgICAgICAgICAgICAgIGlmIChiZWZvcmVTdGF0ZUNhbGxiYWNrLm9uQWJvcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgb25BYm9ydFN0YWNrLnB1c2goYmVmb3JlU3RhdGVDYWxsYmFjay5vbkFib3J0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIC8vIFJ1biBhbGwgb25BYm9ydCwgd2l0aCBzZXBhcmF0ZSB0cnkvY2F0Y2ggdG8gaWdub3JlIGFueSBlcnJvcnMgYW5kXG4gICAgICAgICAgICAvLyBjb250aW51ZVxuICAgICAgICAgICAgb25BYm9ydFN0YWNrLnJldmVyc2UoKTtcbiAgICAgICAgICAgIGZvciAoY29uc3Qgb25BYm9ydCBvZiBvbkFib3J0U3RhY2spIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBvbkFib3J0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChfKSB7XG4gICAgICAgICAgICAgICAgICAgIC8qIHN3YWxsb3cgZXJyb3IgKi9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyB0aGlzLmF1dGguX2Vycm9yRmFjdG9yeS5jcmVhdGUoXCJsb2dpbi1ibG9ja2VkXCIgLyogQXV0aEVycm9yQ29kZS5MT0dJTl9CTE9DS0VEICovLCB7XG4gICAgICAgICAgICAgICAgb3JpZ2luYWxNZXNzYWdlOiBlPy5tZXNzYWdlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogRmV0Y2hlcyB0aGUgcGFzc3dvcmQgcG9saWN5IGZvciB0aGUgY3VycmVudGx5IHNldCB0ZW5hbnQgb3IgdGhlIHByb2plY3QgaWYgbm8gdGVuYW50IGlzIHNldC5cbiAqXG4gKiBAcGFyYW0gYXV0aCBBdXRoIG9iamVjdC5cbiAqIEBwYXJhbSByZXF1ZXN0IFBhc3N3b3JkIHBvbGljeSByZXF1ZXN0LlxuICogQHJldHVybnMgUGFzc3dvcmQgcG9saWN5IHJlc3BvbnNlLlxuICovXG5hc3luYyBmdW5jdGlvbiBfZ2V0UGFzc3dvcmRQb2xpY3koYXV0aCwgcmVxdWVzdCA9IHt9KSB7XG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIkdFVFwiIC8qIEh0dHBNZXRob2QuR0VUICovLCBcIi92Mi9wYXNzd29yZFBvbGljeVwiIC8qIEVuZHBvaW50LkdFVF9QQVNTV09SRF9QT0xJQ1kgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIzIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBNaW5pbXVtIG1pbiBwYXNzd29yZCBsZW5ndGggZW5mb3JjZWQgYnkgdGhlIGJhY2tlbmQsIGV2ZW4gaWYgbm8gbWluaW11bSBsZW5ndGggaXMgc2V0LlxuY29uc3QgTUlOSU1VTV9NSU5fUEFTU1dPUkRfTEVOR1RIID0gNjtcbi8qKlxuICogU3RvcmVzIHBhc3N3b3JkIHBvbGljeSByZXF1aXJlbWVudHMgYW5kIHByb3ZpZGVzIHBhc3N3b3JkIHZhbGlkYXRpb24gYWdhaW5zdCB0aGUgcG9saWN5LlxuICpcbiAqIEBpbnRlcm5hbFxuICovXG5jbGFzcyBQYXNzd29yZFBvbGljeUltcGwge1xuICAgIGNvbnN0cnVjdG9yKHJlc3BvbnNlKSB7XG4gICAgICAgIC8vIE9ubHkgaW5jbHVkZSBjdXN0b20gc3RyZW5ndGggb3B0aW9ucyBkZWZpbmVkIGluIHRoZSByZXNwb25zZS5cbiAgICAgICAgY29uc3QgcmVzcG9uc2VPcHRpb25zID0gcmVzcG9uc2UuY3VzdG9tU3RyZW5ndGhPcHRpb25zO1xuICAgICAgICB0aGlzLmN1c3RvbVN0cmVuZ3RoT3B0aW9ucyA9IHt9O1xuICAgICAgICAvLyBUT0RPOiBSZW1vdmUgb25jZSB0aGUgYmFja2VuZCBpcyB1cGRhdGVkIHRvIGluY2x1ZGUgdGhlIG1pbmltdW0gbWluIHBhc3N3b3JkIGxlbmd0aCBpbnN0ZWFkIG9mIHVuZGVmaW5lZCB3aGVuIHRoZXJlIGlzIG5vIG1pbmltdW0gbGVuZ3RoIHNldC5cbiAgICAgICAgdGhpcy5jdXN0b21TdHJlbmd0aE9wdGlvbnMubWluUGFzc3dvcmRMZW5ndGggPVxuICAgICAgICAgICAgcmVzcG9uc2VPcHRpb25zLm1pblBhc3N3b3JkTGVuZ3RoID8/IE1JTklNVU1fTUlOX1BBU1NXT1JEX0xFTkdUSDtcbiAgICAgICAgaWYgKHJlc3BvbnNlT3B0aW9ucy5tYXhQYXNzd29yZExlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5jdXN0b21TdHJlbmd0aE9wdGlvbnMubWF4UGFzc3dvcmRMZW5ndGggPVxuICAgICAgICAgICAgICAgIHJlc3BvbnNlT3B0aW9ucy5tYXhQYXNzd29yZExlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzcG9uc2VPcHRpb25zLmNvbnRhaW5zTG93ZXJjYXNlQ2hhcmFjdGVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuY3VzdG9tU3RyZW5ndGhPcHRpb25zLmNvbnRhaW5zTG93ZXJjYXNlTGV0dGVyID1cbiAgICAgICAgICAgICAgICByZXNwb25zZU9wdGlvbnMuY29udGFpbnNMb3dlcmNhc2VDaGFyYWN0ZXI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlc3BvbnNlT3B0aW9ucy5jb250YWluc1VwcGVyY2FzZUNoYXJhY3RlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLmN1c3RvbVN0cmVuZ3RoT3B0aW9ucy5jb250YWluc1VwcGVyY2FzZUxldHRlciA9XG4gICAgICAgICAgICAgICAgcmVzcG9uc2VPcHRpb25zLmNvbnRhaW5zVXBwZXJjYXNlQ2hhcmFjdGVyO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZXNwb25zZU9wdGlvbnMuY29udGFpbnNOdW1lcmljQ2hhcmFjdGVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuY3VzdG9tU3RyZW5ndGhPcHRpb25zLmNvbnRhaW5zTnVtZXJpY0NoYXJhY3RlciA9XG4gICAgICAgICAgICAgICAgcmVzcG9uc2VPcHRpb25zLmNvbnRhaW5zTnVtZXJpY0NoYXJhY3RlcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzcG9uc2VPcHRpb25zLmNvbnRhaW5zTm9uQWxwaGFudW1lcmljQ2hhcmFjdGVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuY3VzdG9tU3RyZW5ndGhPcHRpb25zLmNvbnRhaW5zTm9uQWxwaGFudW1lcmljQ2hhcmFjdGVyID1cbiAgICAgICAgICAgICAgICByZXNwb25zZU9wdGlvbnMuY29udGFpbnNOb25BbHBoYW51bWVyaWNDaGFyYWN0ZXI7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5lbmZvcmNlbWVudFN0YXRlID0gcmVzcG9uc2UuZW5mb3JjZW1lbnRTdGF0ZTtcbiAgICAgICAgaWYgKHRoaXMuZW5mb3JjZW1lbnRTdGF0ZSA9PT0gJ0VORk9SQ0VNRU5UX1NUQVRFX1VOU1BFQ0lGSUVEJykge1xuICAgICAgICAgICAgdGhpcy5lbmZvcmNlbWVudFN0YXRlID0gJ09GRic7XG4gICAgICAgIH1cbiAgICAgICAgLy8gVXNlIGFuIGVtcHR5IHN0cmluZyBpZiBubyBub24tYWxwaGFudW1lcmljIGNoYXJhY3RlcnMgYXJlIHNwZWNpZmllZCBpbiB0aGUgcmVzcG9uc2UuXG4gICAgICAgIHRoaXMuYWxsb3dlZE5vbkFscGhhbnVtZXJpY0NoYXJhY3RlcnMgPVxuICAgICAgICAgICAgcmVzcG9uc2UuYWxsb3dlZE5vbkFscGhhbnVtZXJpY0NoYXJhY3RlcnM/LmpvaW4oJycpID8/ICcnO1xuICAgICAgICB0aGlzLmZvcmNlVXBncmFkZU9uU2lnbmluID0gcmVzcG9uc2UuZm9yY2VVcGdyYWRlT25TaWduaW4gPz8gZmFsc2U7XG4gICAgICAgIHRoaXMuc2NoZW1hVmVyc2lvbiA9IHJlc3BvbnNlLnNjaGVtYVZlcnNpb247XG4gICAgfVxuICAgIHZhbGlkYXRlUGFzc3dvcmQocGFzc3dvcmQpIHtcbiAgICAgICAgY29uc3Qgc3RhdHVzID0ge1xuICAgICAgICAgICAgaXNWYWxpZDogdHJ1ZSxcbiAgICAgICAgICAgIHBhc3N3b3JkUG9saWN5OiB0aGlzXG4gICAgICAgIH07XG4gICAgICAgIC8vIENoZWNrIHRoZSBwYXNzd29yZCBsZW5ndGggYW5kIGNoYXJhY3RlciBvcHRpb25zLlxuICAgICAgICB0aGlzLnZhbGlkYXRlUGFzc3dvcmRMZW5ndGhPcHRpb25zKHBhc3N3b3JkLCBzdGF0dXMpO1xuICAgICAgICB0aGlzLnZhbGlkYXRlUGFzc3dvcmRDaGFyYWN0ZXJPcHRpb25zKHBhc3N3b3JkLCBzdGF0dXMpO1xuICAgICAgICAvLyBDb21iaW5lIHRoZSBzdGF0dXMgaW50byBzaW5nbGUgaXNWYWxpZCBwcm9wZXJ0eS5cbiAgICAgICAgc3RhdHVzLmlzVmFsaWQgJiYgKHN0YXR1cy5pc1ZhbGlkID0gc3RhdHVzLm1lZXRzTWluUGFzc3dvcmRMZW5ndGggPz8gdHJ1ZSk7XG4gICAgICAgIHN0YXR1cy5pc1ZhbGlkICYmIChzdGF0dXMuaXNWYWxpZCA9IHN0YXR1cy5tZWV0c01heFBhc3N3b3JkTGVuZ3RoID8/IHRydWUpO1xuICAgICAgICBzdGF0dXMuaXNWYWxpZCAmJiAoc3RhdHVzLmlzVmFsaWQgPSBzdGF0dXMuY29udGFpbnNMb3dlcmNhc2VMZXR0ZXIgPz8gdHJ1ZSk7XG4gICAgICAgIHN0YXR1cy5pc1ZhbGlkICYmIChzdGF0dXMuaXNWYWxpZCA9IHN0YXR1cy5jb250YWluc1VwcGVyY2FzZUxldHRlciA/PyB0cnVlKTtcbiAgICAgICAgc3RhdHVzLmlzVmFsaWQgJiYgKHN0YXR1cy5pc1ZhbGlkID0gc3RhdHVzLmNvbnRhaW5zTnVtZXJpY0NoYXJhY3RlciA/PyB0cnVlKTtcbiAgICAgICAgc3RhdHVzLmlzVmFsaWQgJiYgKHN0YXR1cy5pc1ZhbGlkID0gc3RhdHVzLmNvbnRhaW5zTm9uQWxwaGFudW1lcmljQ2hhcmFjdGVyID8/IHRydWUpO1xuICAgICAgICByZXR1cm4gc3RhdHVzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZXMgdGhhdCB0aGUgcGFzc3dvcmQgbWVldHMgdGhlIGxlbmd0aCBvcHRpb25zIGZvciB0aGUgcG9saWN5LlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhc3N3b3JkIFBhc3N3b3JkIHRvIHZhbGlkYXRlLlxuICAgICAqIEBwYXJhbSBzdGF0dXMgVmFsaWRhdGlvbiBzdGF0dXMuXG4gICAgICovXG4gICAgdmFsaWRhdGVQYXNzd29yZExlbmd0aE9wdGlvbnMocGFzc3dvcmQsIHN0YXR1cykge1xuICAgICAgICBjb25zdCBtaW5QYXNzd29yZExlbmd0aCA9IHRoaXMuY3VzdG9tU3RyZW5ndGhPcHRpb25zLm1pblBhc3N3b3JkTGVuZ3RoO1xuICAgICAgICBjb25zdCBtYXhQYXNzd29yZExlbmd0aCA9IHRoaXMuY3VzdG9tU3RyZW5ndGhPcHRpb25zLm1heFBhc3N3b3JkTGVuZ3RoO1xuICAgICAgICBpZiAobWluUGFzc3dvcmRMZW5ndGgpIHtcbiAgICAgICAgICAgIHN0YXR1cy5tZWV0c01pblBhc3N3b3JkTGVuZ3RoID0gcGFzc3dvcmQubGVuZ3RoID49IG1pblBhc3N3b3JkTGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtYXhQYXNzd29yZExlbmd0aCkge1xuICAgICAgICAgICAgc3RhdHVzLm1lZXRzTWF4UGFzc3dvcmRMZW5ndGggPSBwYXNzd29yZC5sZW5ndGggPD0gbWF4UGFzc3dvcmRMZW5ndGg7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogVmFsaWRhdGVzIHRoYXQgdGhlIHBhc3N3b3JkIG1lZXRzIHRoZSBjaGFyYWN0ZXIgb3B0aW9ucyBmb3IgdGhlIHBvbGljeS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXNzd29yZCBQYXNzd29yZCB0byB2YWxpZGF0ZS5cbiAgICAgKiBAcGFyYW0gc3RhdHVzIFZhbGlkYXRpb24gc3RhdHVzLlxuICAgICAqL1xuICAgIHZhbGlkYXRlUGFzc3dvcmRDaGFyYWN0ZXJPcHRpb25zKHBhc3N3b3JkLCBzdGF0dXMpIHtcbiAgICAgICAgLy8gQXNzaWduIHN0YXR1c2VzIGZvciByZXF1aXJlbWVudHMgZXZlbiBpZiB0aGUgcGFzc3dvcmQgaXMgYW4gZW1wdHkgc3RyaW5nLlxuICAgICAgICB0aGlzLnVwZGF0ZVBhc3N3b3JkQ2hhcmFjdGVyT3B0aW9uc1N0YXR1c2VzKHN0YXR1cywgXG4gICAgICAgIC8qIGNvbnRhaW5zTG93ZXJjYXNlQ2hhcmFjdGVyPSAqLyBmYWxzZSwgXG4gICAgICAgIC8qIGNvbnRhaW5zVXBwZXJjYXNlQ2hhcmFjdGVyPSAqLyBmYWxzZSwgXG4gICAgICAgIC8qIGNvbnRhaW5zTnVtZXJpY0NoYXJhY3Rlcj0gKi8gZmFsc2UsIFxuICAgICAgICAvKiBjb250YWluc05vbkFscGhhbnVtZXJpY0NoYXJhY3Rlcj0gKi8gZmFsc2UpO1xuICAgICAgICBsZXQgcGFzc3dvcmRDaGFyO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhc3N3b3JkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBwYXNzd29yZENoYXIgPSBwYXNzd29yZC5jaGFyQXQoaSk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVBhc3N3b3JkQ2hhcmFjdGVyT3B0aW9uc1N0YXR1c2VzKHN0YXR1cywgXG4gICAgICAgICAgICAvKiBjb250YWluc0xvd2VyY2FzZUNoYXJhY3Rlcj0gKi8gcGFzc3dvcmRDaGFyID49ICdhJyAmJlxuICAgICAgICAgICAgICAgIHBhc3N3b3JkQ2hhciA8PSAneicsIFxuICAgICAgICAgICAgLyogY29udGFpbnNVcHBlcmNhc2VDaGFyYWN0ZXI9ICovIHBhc3N3b3JkQ2hhciA+PSAnQScgJiZcbiAgICAgICAgICAgICAgICBwYXNzd29yZENoYXIgPD0gJ1onLCBcbiAgICAgICAgICAgIC8qIGNvbnRhaW5zTnVtZXJpY0NoYXJhY3Rlcj0gKi8gcGFzc3dvcmRDaGFyID49ICcwJyAmJlxuICAgICAgICAgICAgICAgIHBhc3N3b3JkQ2hhciA8PSAnOScsIFxuICAgICAgICAgICAgLyogY29udGFpbnNOb25BbHBoYW51bWVyaWNDaGFyYWN0ZXI9ICovIHRoaXMuYWxsb3dlZE5vbkFscGhhbnVtZXJpY0NoYXJhY3RlcnMuaW5jbHVkZXMocGFzc3dvcmRDaGFyKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB0aGUgcnVubmluZyB2YWxpZGF0aW9uIHN0YXR1cyB3aXRoIHRoZSBzdGF0dXNlcyBmb3IgdGhlIGNoYXJhY3RlciBvcHRpb25zLlxuICAgICAqIEV4cGVjdGVkIHRvIGJlIGNhbGxlZCBlYWNoIHRpbWUgYSBjaGFyYWN0ZXIgaXMgcHJvY2Vzc2VkIHRvIHVwZGF0ZSBlYWNoIG9wdGlvbiBzdGF0dXNcbiAgICAgKiBiYXNlZCBvbiB0aGUgY3VycmVudCBjaGFyYWN0ZXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc3RhdHVzIFZhbGlkYXRpb24gc3RhdHVzLlxuICAgICAqIEBwYXJhbSBjb250YWluc0xvd2VyY2FzZUNoYXJhY3RlciBXaGV0aGVyIHRoZSBjaGFyYWN0ZXIgaXMgYSBsb3dlcmNhc2UgbGV0dGVyLlxuICAgICAqIEBwYXJhbSBjb250YWluc1VwcGVyY2FzZUNoYXJhY3RlciBXaGV0aGVyIHRoZSBjaGFyYWN0ZXIgaXMgYW4gdXBwZXJjYXNlIGxldHRlci5cbiAgICAgKiBAcGFyYW0gY29udGFpbnNOdW1lcmljQ2hhcmFjdGVyIFdoZXRoZXIgdGhlIGNoYXJhY3RlciBpcyBhIG51bWVyaWMgY2hhcmFjdGVyLlxuICAgICAqIEBwYXJhbSBjb250YWluc05vbkFscGhhbnVtZXJpY0NoYXJhY3RlciBXaGV0aGVyIHRoZSBjaGFyYWN0ZXIgaXMgYSBub24tYWxwaGFudW1lcmljIGNoYXJhY3Rlci5cbiAgICAgKi9cbiAgICB1cGRhdGVQYXNzd29yZENoYXJhY3Rlck9wdGlvbnNTdGF0dXNlcyhzdGF0dXMsIGNvbnRhaW5zTG93ZXJjYXNlQ2hhcmFjdGVyLCBjb250YWluc1VwcGVyY2FzZUNoYXJhY3RlciwgY29udGFpbnNOdW1lcmljQ2hhcmFjdGVyLCBjb250YWluc05vbkFscGhhbnVtZXJpY0NoYXJhY3Rlcikge1xuICAgICAgICBpZiAodGhpcy5jdXN0b21TdHJlbmd0aE9wdGlvbnMuY29udGFpbnNMb3dlcmNhc2VMZXR0ZXIpIHtcbiAgICAgICAgICAgIHN0YXR1cy5jb250YWluc0xvd2VyY2FzZUxldHRlciB8fCAoc3RhdHVzLmNvbnRhaW5zTG93ZXJjYXNlTGV0dGVyID0gY29udGFpbnNMb3dlcmNhc2VDaGFyYWN0ZXIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmN1c3RvbVN0cmVuZ3RoT3B0aW9ucy5jb250YWluc1VwcGVyY2FzZUxldHRlcikge1xuICAgICAgICAgICAgc3RhdHVzLmNvbnRhaW5zVXBwZXJjYXNlTGV0dGVyIHx8IChzdGF0dXMuY29udGFpbnNVcHBlcmNhc2VMZXR0ZXIgPSBjb250YWluc1VwcGVyY2FzZUNoYXJhY3Rlcik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY3VzdG9tU3RyZW5ndGhPcHRpb25zLmNvbnRhaW5zTnVtZXJpY0NoYXJhY3Rlcikge1xuICAgICAgICAgICAgc3RhdHVzLmNvbnRhaW5zTnVtZXJpY0NoYXJhY3RlciB8fCAoc3RhdHVzLmNvbnRhaW5zTnVtZXJpY0NoYXJhY3RlciA9IGNvbnRhaW5zTnVtZXJpY0NoYXJhY3Rlcik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY3VzdG9tU3RyZW5ndGhPcHRpb25zLmNvbnRhaW5zTm9uQWxwaGFudW1lcmljQ2hhcmFjdGVyKSB7XG4gICAgICAgICAgICBzdGF0dXMuY29udGFpbnNOb25BbHBoYW51bWVyaWNDaGFyYWN0ZXIgfHwgKHN0YXR1cy5jb250YWluc05vbkFscGhhbnVtZXJpY0NoYXJhY3RlciA9IGNvbnRhaW5zTm9uQWxwaGFudW1lcmljQ2hhcmFjdGVyKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNsYXNzIEF1dGhJbXBsIHtcbiAgICBjb25zdHJ1Y3RvcihhcHAsIGhlYXJ0YmVhdFNlcnZpY2VQcm92aWRlciwgYXBwQ2hlY2tTZXJ2aWNlUHJvdmlkZXIsIGNvbmZpZykge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy5oZWFydGJlYXRTZXJ2aWNlUHJvdmlkZXIgPSBoZWFydGJlYXRTZXJ2aWNlUHJvdmlkZXI7XG4gICAgICAgIHRoaXMuYXBwQ2hlY2tTZXJ2aWNlUHJvdmlkZXIgPSBhcHBDaGVja1NlcnZpY2VQcm92aWRlcjtcbiAgICAgICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgICAgIHRoaXMuY3VycmVudFVzZXIgPSBudWxsO1xuICAgICAgICB0aGlzLmVtdWxhdG9yQ29uZmlnID0gbnVsbDtcbiAgICAgICAgdGhpcy5vcGVyYXRpb25zID0gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIHRoaXMuYXV0aFN0YXRlU3Vic2NyaXB0aW9uID0gbmV3IFN1YnNjcmlwdGlvbih0aGlzKTtcbiAgICAgICAgdGhpcy5pZFRva2VuU3Vic2NyaXB0aW9uID0gbmV3IFN1YnNjcmlwdGlvbih0aGlzKTtcbiAgICAgICAgdGhpcy5iZWZvcmVTdGF0ZVF1ZXVlID0gbmV3IEF1dGhNaWRkbGV3YXJlUXVldWUodGhpcyk7XG4gICAgICAgIHRoaXMucmVkaXJlY3RVc2VyID0gbnVsbDtcbiAgICAgICAgdGhpcy5pc1Byb2FjdGl2ZVJlZnJlc2hFbmFibGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuRVhQRUNURURfUEFTU1dPUkRfUE9MSUNZX1NDSEVNQV9WRVJTSU9OID0gMTtcbiAgICAgICAgLy8gQW55IG5ldHdvcmsgY2FsbHMgd2lsbCBzZXQgdGhpcyB0byB0cnVlIGFuZCBwcmV2ZW50IHN1YnNlcXVlbnQgZW11bGF0b3JcbiAgICAgICAgLy8gaW5pdGlhbGl6YXRpb25cbiAgICAgICAgdGhpcy5fY2FuSW5pdEVtdWxhdG9yID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5faXNJbml0aWFsaXplZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9kZWxldGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2luaXRpYWxpemF0aW9uUHJvbWlzZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX3BvcHVwUmVkaXJlY3RSZXNvbHZlciA9IG51bGw7XG4gICAgICAgIHRoaXMuX2Vycm9yRmFjdG9yeSA9IF9ERUZBVUxUX0FVVEhfRVJST1JfRkFDVE9SWTtcbiAgICAgICAgdGhpcy5fYWdlbnRSZWNhcHRjaGFDb25maWcgPSBudWxsO1xuICAgICAgICB0aGlzLl90ZW5hbnRSZWNhcHRjaGFDb25maWdzID0ge307XG4gICAgICAgIHRoaXMuX3Byb2plY3RQYXNzd29yZFBvbGljeSA9IG51bGw7XG4gICAgICAgIHRoaXMuX3RlbmFudFBhc3N3b3JkUG9saWNpZXMgPSB7fTtcbiAgICAgICAgdGhpcy5fcmVzb2x2ZVBlcnNpc3RlbmNlTWFuYWdlckF2YWlsYWJsZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgLy8gVHJhY2tzIHRoZSBsYXN0IG5vdGlmaWVkIFVJRCBmb3Igc3RhdGUgY2hhbmdlIGxpc3RlbmVycyB0byBwcmV2ZW50XG4gICAgICAgIC8vIHJlcGVhdGVkIGNhbGxzIHRvIHRoZSBjYWxsYmFja3MuIFVuZGVmaW5lZCBtZWFucyBpdCdzIG5ldmVyIGJlZW5cbiAgICAgICAgLy8gY2FsbGVkLCB3aGVyZWFzIG51bGwgbWVhbnMgaXQncyBiZWVuIGNhbGxlZCB3aXRoIGEgc2lnbmVkIG91dCB1c2VyXG4gICAgICAgIHRoaXMubGFzdE5vdGlmaWVkVWlkID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmxhbmd1YWdlQ29kZSA9IG51bGw7XG4gICAgICAgIHRoaXMudGVuYW50SWQgPSBudWxsO1xuICAgICAgICB0aGlzLnNldHRpbmdzID0geyBhcHBWZXJpZmljYXRpb25EaXNhYmxlZEZvclRlc3Rpbmc6IGZhbHNlIH07XG4gICAgICAgIHRoaXMuZnJhbWV3b3JrcyA9IFtdO1xuICAgICAgICB0aGlzLm5hbWUgPSBhcHAubmFtZTtcbiAgICAgICAgdGhpcy5jbGllbnRWZXJzaW9uID0gY29uZmlnLnNka0NsaWVudFZlcnNpb247XG4gICAgICAgIC8vIFRPRE8oamFtZXNkYW5pZWxzKSBleHBsb3JlIGxlc3MgaGFja3kgd2F5IHRvIGRvIHRoaXMsIGNvb2tpZSBhdXRoZW50aWNhdGlvbiBuZWVkc1xuICAgICAgICAvLyBwZXJzaXN0ZW5jZU1hbmFuZ2VyIHRvIGJlIGF2YWlsYWJsZS4gc2VlIF9nZXRGaW5hbFRhcmdldCBmb3IgbW9yZSBjb250ZXh0XG4gICAgICAgIHRoaXMuX3BlcnNpc3RlbmNlTWFuYWdlckF2YWlsYWJsZSA9IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gKHRoaXMuX3Jlc29sdmVQZXJzaXN0ZW5jZU1hbmFnZXJBdmFpbGFibGUgPSByZXNvbHZlKSk7XG4gICAgfVxuICAgIF9pbml0aWFsaXplV2l0aFBlcnNpc3RlbmNlKHBlcnNpc3RlbmNlSGllcmFyY2h5LCBwb3B1cFJlZGlyZWN0UmVzb2x2ZXIpIHtcbiAgICAgICAgaWYgKHBvcHVwUmVkaXJlY3RSZXNvbHZlcikge1xuICAgICAgICAgICAgdGhpcy5fcG9wdXBSZWRpcmVjdFJlc29sdmVyID0gX2dldEluc3RhbmNlKHBvcHVwUmVkaXJlY3RSZXNvbHZlcik7XG4gICAgICAgIH1cbiAgICAgICAgLy8gSGF2ZSB0byBjaGVjayBmb3IgYXBwIGRlbGV0aW9uIHRocm91Z2hvdXQgaW5pdGlhbGl6YXRpb24gKGFmdGVyIGVhY2hcbiAgICAgICAgLy8gcHJvbWlzZSByZXNvbHV0aW9uKVxuICAgICAgICB0aGlzLl9pbml0aWFsaXphdGlvblByb21pc2UgPSB0aGlzLnF1ZXVlKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9kZWxldGVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZU1hbmFnZXIgPSBhd2FpdCBQZXJzaXN0ZW5jZVVzZXJNYW5hZ2VyLmNyZWF0ZSh0aGlzLCBwZXJzaXN0ZW5jZUhpZXJhcmNoeSk7XG4gICAgICAgICAgICB0aGlzLl9yZXNvbHZlUGVyc2lzdGVuY2VNYW5hZ2VyQXZhaWxhYmxlPy4oKTtcbiAgICAgICAgICAgIGlmICh0aGlzLl9kZWxldGVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgcmVzb2x2ZXIgZWFybHkgaWYgbmVjZXNzYXJ5IChvbmx5IGFwcGxpY2FibGUgdG8gd2ViOlxuICAgICAgICAgICAgLy8gdGhpcyB3aWxsIGNhdXNlIHRoZSBpZnJhbWUgdG8gbG9hZCBpbW1lZGlhdGVseSBpbiBjZXJ0YWluIGNhc2VzKVxuICAgICAgICAgICAgaWYgKHRoaXMuX3BvcHVwUmVkaXJlY3RSZXNvbHZlcj8uX3Nob3VsZEluaXRQcm9hY3RpdmVseSkge1xuICAgICAgICAgICAgICAgIC8vIElmIHRoaXMgZmFpbHMsIGRvbid0IGhhbHQgYXV0aCBsb2FkaW5nXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5fcG9wdXBSZWRpcmVjdFJlc29sdmVyLl9pbml0aWFsaXplKHRoaXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAvKiBJZ25vcmUgdGhlIGVycm9yICovXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5pbml0aWFsaXplQ3VycmVudFVzZXIocG9wdXBSZWRpcmVjdFJlc29sdmVyKTtcbiAgICAgICAgICAgIHRoaXMubGFzdE5vdGlmaWVkVWlkID0gdGhpcy5jdXJyZW50VXNlcj8udWlkIHx8IG51bGw7XG4gICAgICAgICAgICBpZiAodGhpcy5fZGVsZXRlZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2lzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2luaXRpYWxpemF0aW9uUHJvbWlzZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSWYgdGhlIHBlcnNpc3RlbmNlIGlzIGNoYW5nZWQgaW4gYW5vdGhlciB3aW5kb3csIHRoZSB1c2VyIG1hbmFnZXIgd2lsbCBsZXQgdXMga25vd1xuICAgICAqL1xuICAgIGFzeW5jIF9vblN0b3JhZ2VFdmVudCgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2RlbGV0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgdGhpcy5hc3NlcnRlZFBlcnNpc3RlbmNlLmdldEN1cnJlbnRVc2VyKCk7XG4gICAgICAgIGlmICghdGhpcy5jdXJyZW50VXNlciAmJiAhdXNlcikge1xuICAgICAgICAgICAgLy8gTm8gY2hhbmdlLCBkbyBub3RoaW5nICh3YXMgc2lnbmVkIG91dCBhbmQgcmVtYWluZWQgc2lnbmVkIG91dCkuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgdGhlIHNhbWUgdXNlciBpcyB0byBiZSBzeW5jaHJvbml6ZWQuXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRVc2VyICYmIHVzZXIgJiYgdGhpcy5jdXJyZW50VXNlci51aWQgPT09IHVzZXIudWlkKSB7XG4gICAgICAgICAgICAvLyBEYXRhIHVwZGF0ZSwgc2ltcGx5IGNvcHkgZGF0YSBjaGFuZ2VzLlxuICAgICAgICAgICAgdGhpcy5fY3VycmVudFVzZXIuX2Fzc2lnbih1c2VyKTtcbiAgICAgICAgICAgIC8vIElmIHRva2VucyBjaGFuZ2VkIGZyb20gcHJldmlvdXMgdXNlciB0b2tlbnMsIHRoaXMgd2lsbCB0cmlnZ2VyXG4gICAgICAgICAgICAvLyBub3RpZnlBdXRoTGlzdGVuZXJzXy5cbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY3VycmVudFVzZXIuZ2V0SWRUb2tlbigpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIFVwZGF0ZSBjdXJyZW50IEF1dGggc3RhdGUuIEVpdGhlciBhIG5ldyBsb2dpbiBvciBsb2dvdXQuXG4gICAgICAgIC8vIFNraXAgYmxvY2tpbmcgY2FsbGJhY2tzLCB0aGV5IHNob3VsZCBub3QgYXBwbHkgdG8gYSBjaGFuZ2UgaW4gYW5vdGhlciB0YWIuXG4gICAgICAgIGF3YWl0IHRoaXMuX3VwZGF0ZUN1cnJlbnRVc2VyKHVzZXIsIC8qIHNraXBCZWZvcmVTdGF0ZUNhbGxiYWNrcyAqLyB0cnVlKTtcbiAgICB9XG4gICAgYXN5bmMgaW5pdGlhbGl6ZUN1cnJlbnRVc2VyRnJvbUlkVG9rZW4oaWRUb2tlbikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXRBY2NvdW50SW5mbyh0aGlzLCB7IGlkVG9rZW4gfSk7XG4gICAgICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlckltcGwuX2Zyb21HZXRBY2NvdW50SW5mb1Jlc3BvbnNlKHRoaXMsIHJlc3BvbnNlLCBpZFRva2VuKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZGlyZWN0bHlTZXRDdXJyZW50VXNlcih1c2VyKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZpcmViYXNlU2VydmVyQXBwIGNvdWxkIG5vdCBsb2dpbiB1c2VyIHdpdGggcHJvdmlkZWQgYXV0aElkVG9rZW46ICcsIGVycik7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmRpcmVjdGx5U2V0Q3VycmVudFVzZXIobnVsbCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXN5bmMgaW5pdGlhbGl6ZUN1cnJlbnRVc2VyKHBvcHVwUmVkaXJlY3RSZXNvbHZlcikge1xuICAgICAgICBpZiAoX2lzRmlyZWJhc2VTZXJ2ZXJBcHAodGhpcy5hcHApKSB7XG4gICAgICAgICAgICBjb25zdCBpZFRva2VuID0gdGhpcy5hcHAuc2V0dGluZ3MuYXV0aElkVG9rZW47XG4gICAgICAgICAgICBpZiAoaWRUb2tlbikge1xuICAgICAgICAgICAgICAgIC8vIFN0YXJ0IHRoZSBhdXRoIG9wZXJhdGlvbiBpbiB0aGUgbmV4dCB0aWNrIHRvIGFsbG93IGEgbW9tZW50IGZvciB0aGUgY3VzdG9tZXIncyBhcHAgdG9cbiAgICAgICAgICAgICAgICAvLyBhdHRhY2ggYW4gZW11bGF0b3IsIGlmIGRlc2lyZWQuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuaW5pdGlhbGl6ZUN1cnJlbnRVc2VyRnJvbUlkVG9rZW4oaWRUb2tlbikudGhlbihyZXNvbHZlLCByZXNvbHZlKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kaXJlY3RseVNldEN1cnJlbnRVc2VyKG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIEZpcnN0IGNoZWNrIHRvIHNlZSBpZiB3ZSBoYXZlIGEgcGVuZGluZyByZWRpcmVjdCBldmVudC5cbiAgICAgICAgY29uc3QgcHJldmlvdXNseVN0b3JlZFVzZXIgPSAoYXdhaXQgdGhpcy5hc3NlcnRlZFBlcnNpc3RlbmNlLmdldEN1cnJlbnRVc2VyKCkpO1xuICAgICAgICBsZXQgZnV0dXJlQ3VycmVudFVzZXIgPSBwcmV2aW91c2x5U3RvcmVkVXNlcjtcbiAgICAgICAgbGV0IG5lZWRzVG9jaGVja01pZGRsZXdhcmUgPSBmYWxzZTtcbiAgICAgICAgaWYgKHBvcHVwUmVkaXJlY3RSZXNvbHZlciAmJiB0aGlzLmNvbmZpZy5hdXRoRG9tYWluKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmdldE9ySW5pdFJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyKCk7XG4gICAgICAgICAgICBjb25zdCByZWRpcmVjdFVzZXJFdmVudElkID0gdGhpcy5yZWRpcmVjdFVzZXI/Ll9yZWRpcmVjdEV2ZW50SWQ7XG4gICAgICAgICAgICBjb25zdCBzdG9yZWRVc2VyRXZlbnRJZCA9IGZ1dHVyZUN1cnJlbnRVc2VyPy5fcmVkaXJlY3RFdmVudElkO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy50cnlSZWRpcmVjdFNpZ25Jbihwb3B1cFJlZGlyZWN0UmVzb2x2ZXIpO1xuICAgICAgICAgICAgLy8gSWYgdGhlIHN0b3JlZCB1c2VyIChpLmUuIHRoZSBvbGQgXCJjdXJyZW50VXNlclwiKSBoYXMgYSByZWRpcmVjdElkIHRoYXRcbiAgICAgICAgICAgIC8vIG1hdGNoZXMgdGhlIHJlZGlyZWN0IHVzZXIsIHRoZW4gd2Ugd2FudCB0byBpbml0aWFsbHkgc2lnbiBpbiB3aXRoIHRoZVxuICAgICAgICAgICAgLy8gbmV3IHVzZXIgb2JqZWN0IGZyb20gcmVzdWx0LlxuICAgICAgICAgICAgLy8gVE9ETyhzYW1naG8pOiBNb3JlIHRob3JvdWdobHkgdGVzdCBhbGwgb2YgdGhpc1xuICAgICAgICAgICAgaWYgKCghcmVkaXJlY3RVc2VyRXZlbnRJZCB8fCByZWRpcmVjdFVzZXJFdmVudElkID09PSBzdG9yZWRVc2VyRXZlbnRJZCkgJiZcbiAgICAgICAgICAgICAgICByZXN1bHQ/LnVzZXIpIHtcbiAgICAgICAgICAgICAgICBmdXR1cmVDdXJyZW50VXNlciA9IHJlc3VsdC51c2VyO1xuICAgICAgICAgICAgICAgIG5lZWRzVG9jaGVja01pZGRsZXdhcmUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIElmIG5vIHVzZXIgaW4gcGVyc2lzdGVuY2UsIHRoZXJlIGlzIG5vIGN1cnJlbnQgdXNlci4gU2V0IHRvIG51bGwuXG4gICAgICAgIGlmICghZnV0dXJlQ3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRpcmVjdGx5U2V0Q3VycmVudFVzZXIobnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFmdXR1cmVDdXJyZW50VXNlci5fcmVkaXJlY3RFdmVudElkKSB7XG4gICAgICAgICAgICAvLyBUaGlzIGlzbid0IGEgcmVkaXJlY3QgbGluayBvcGVyYXRpb24sIHdlIGNhbiByZWxvYWQgYW5kIGJhaWwuXG4gICAgICAgICAgICAvLyBGaXJzdCB0aG91Z2gsIGVuc3VyZSB0aGF0IHdlIGNoZWNrIHRoZSBtaWRkbGV3YXJlIGlzIGhhcHB5LlxuICAgICAgICAgICAgaWYgKG5lZWRzVG9jaGVja01pZGRsZXdhcmUpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmJlZm9yZVN0YXRlUXVldWUucnVuTWlkZGxld2FyZShmdXR1cmVDdXJyZW50VXNlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGZ1dHVyZUN1cnJlbnRVc2VyID0gcHJldmlvdXNseVN0b3JlZFVzZXI7XG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIGtub3cgdGhpcyBpcyBhdmFpbGFibGUgc2luY2UgdGhlIGJpdCBpcyBvbmx5IHNldCB3aGVuIHRoZVxuICAgICAgICAgICAgICAgICAgICAvLyByZXNvbHZlciBpcyBhdmFpbGFibGVcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcG9wdXBSZWRpcmVjdFJlc29sdmVyLl9vdmVycmlkZVJlZGlyZWN0UmVzdWx0KHRoaXMsICgpID0+IFByb21pc2UucmVqZWN0KGUpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZnV0dXJlQ3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZWxvYWRBbmRTZXRDdXJyZW50VXNlck9yQ2xlYXIoZnV0dXJlQ3VycmVudFVzZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGlyZWN0bHlTZXRDdXJyZW50VXNlcihudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBfYXNzZXJ0KHRoaXMuX3BvcHVwUmVkaXJlY3RSZXNvbHZlciwgdGhpcywgXCJhcmd1bWVudC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IgKi8pO1xuICAgICAgICBhd2FpdCB0aGlzLmdldE9ySW5pdFJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyKCk7XG4gICAgICAgIC8vIElmIHRoZSByZWRpcmVjdCB1c2VyJ3MgZXZlbnQgSUQgbWF0Y2hlcyB0aGUgY3VycmVudCB1c2VyJ3MgZXZlbnQgSUQsXG4gICAgICAgIC8vIERPIE5PVCByZWxvYWQgdGhlIGN1cnJlbnQgdXNlciwgb3RoZXJ3aXNlIHRoZXknbGwgYmUgY2xlYXJlZCBmcm9tIHN0b3JhZ2UuXG4gICAgICAgIC8vIFRoaXMgaXMgaW1wb3J0YW50IGZvciB0aGUgcmVhdXRoZW50aWNhdGVXaXRoUmVkaXJlY3QoKSBmbG93LlxuICAgICAgICBpZiAodGhpcy5yZWRpcmVjdFVzZXIgJiZcbiAgICAgICAgICAgIHRoaXMucmVkaXJlY3RVc2VyLl9yZWRpcmVjdEV2ZW50SWQgPT09IGZ1dHVyZUN1cnJlbnRVc2VyLl9yZWRpcmVjdEV2ZW50SWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRpcmVjdGx5U2V0Q3VycmVudFVzZXIoZnV0dXJlQ3VycmVudFVzZXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlbG9hZEFuZFNldEN1cnJlbnRVc2VyT3JDbGVhcihmdXR1cmVDdXJyZW50VXNlcik7XG4gICAgfVxuICAgIGFzeW5jIHRyeVJlZGlyZWN0U2lnbkluKHJlZGlyZWN0UmVzb2x2ZXIpIHtcbiAgICAgICAgLy8gVGhlIHJlZGlyZWN0IHVzZXIgbmVlZHMgdG8gYmUgY2hlY2tlZCAoYW5kIHNpZ25lZCBpbiBpZiBhdmFpbGFibGUpXG4gICAgICAgIC8vIGR1cmluZyBhdXRoIGluaXRpYWxpemF0aW9uLiBBbGwgb2YgdGhlIG5vcm1hbCBzaWduIGluIGFuZCBsaW5rL3JlYXV0aFxuICAgICAgICAvLyBmbG93cyBjYWxsIGJhY2sgaW50byBhdXRoIGFuZCBwdXNoIHRoaW5ncyBvbnRvIHRoZSBwcm9taXNlIHF1ZXVlLiBXZVxuICAgICAgICAvLyBuZWVkIHRvIGF3YWl0IHRoZSByZXN1bHQgb2YgdGhlIHJlZGlyZWN0IHNpZ24gaW4gKmluc2lkZSB0aGUgcHJvbWlzZVxuICAgICAgICAvLyBxdWV1ZSouIFRoaXMgcHJlc2VudHMgYSBwcm9ibGVtOiB3ZSBydW4gaW50byBkZWFkbG9jay4gU2VlOlxuICAgICAgICAvLyAgICDilIw+IFtJbml0aWFsaXphdGlvbl0g4pSA4pSA4pSA4pSA4pSA4pSQXG4gICAgICAgIC8vICAgIOKUjD4gWzxvdGhlciBxdWV1ZSB0YXNrcz5dIOKUglxuICAgICAgICAvLyAgICDilJTilIAgW2dldFJlZGlyZWN0UmVzdWx0XSA84pSA4pSYXG4gICAgICAgIC8vICAgIHdoZXJlIFtdIGFyZSB0YXNrcyBvbiB0aGUgcXVldWUgYW5kIGFycm93cyBkZW5vdGUgYXdhaXRzXG4gICAgICAgIC8vIEluaXRpYWxpemF0aW9uIHdpbGwgbmV2ZXIgY29tcGxldGUgYmVjYXVzZSBpdCdzIHdhaXRpbmcgb24gc29tZXRoaW5nXG4gICAgICAgIC8vIHRoYXQncyB3YWl0aW5nIGZvciBpbml0aWFsaXphdGlvbiB0byBjb21wbGV0ZSFcbiAgICAgICAgLy9cbiAgICAgICAgLy8gSW5zdGVhZCwgdGhpcyBtZXRob2QgY2FsbHMgZ2V0UmVkaXJlY3RSZXN1bHQoKSAoc3RvcmVkIGluXG4gICAgICAgIC8vIF9jb21wbGV0ZVJlZGlyZWN0Rm4pIHdpdGggYW4gb3B0aW9uYWwgcGFyYW1ldGVyIHRoYXQgaW5zdHJ1Y3RzIGFsbCBvZlxuICAgICAgICAvLyB0aGUgdW5kZXJseWluZyBhdXRoIG9wZXJhdGlvbnMgdG8gc2tpcCBhbnl0aGluZyB0aGF0IG11dGF0ZXMgYXV0aCBzdGF0ZS5cbiAgICAgICAgbGV0IHJlc3VsdCA9IG51bGw7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXZSBrbm93IHRoaXMuX3BvcHVwUmVkaXJlY3RSZXNvbHZlciBpcyBzZXQgc2luY2UgcmVkaXJlY3RSZXNvbHZlclxuICAgICAgICAgICAgLy8gaXMgcGFzc2VkIGluLiBUaGUgX2NvbXBsZXRlUmVkaXJlY3RGbiBleHBlY3RzIHRoZSB1bndyYXBwZWQgZXh0ZXJuLlxuICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5fcG9wdXBSZWRpcmVjdFJlc29sdmVyLl9jb21wbGV0ZVJlZGlyZWN0Rm4odGhpcywgcmVkaXJlY3RSZXNvbHZlciwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIC8vIFN3YWxsb3cgYW55IGVycm9ycyBoZXJlOyB0aGUgY29kZSBjYW4gcmV0cmlldmUgdGhlbSBpblxuICAgICAgICAgICAgLy8gZ2V0UmVkaXJlY3RSZXN1bHQoKS5cbiAgICAgICAgICAgIGF3YWl0IHRoaXMuX3NldFJlZGlyZWN0VXNlcihudWxsKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBhc3luYyByZWxvYWRBbmRTZXRDdXJyZW50VXNlck9yQ2xlYXIodXNlcikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgX3JlbG9hZFdpdGhvdXRTYXZpbmcodXNlcik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGlmIChlPy5jb2RlICE9PVxuICAgICAgICAgICAgICAgIGBhdXRoLyR7XCJuZXR3b3JrLXJlcXVlc3QtZmFpbGVkXCIgLyogQXV0aEVycm9yQ29kZS5ORVRXT1JLX1JFUVVFU1RfRkFJTEVEICovfWApIHtcbiAgICAgICAgICAgICAgICAvLyBTb21ldGhpbmcncyB3cm9uZyB3aXRoIHRoZSB1c2VyJ3MgdG9rZW4uIExvZyB0aGVtIG91dCBhbmQgcmVtb3ZlXG4gICAgICAgICAgICAgICAgLy8gdGhlbSBmcm9tIHN0b3JhZ2VcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kaXJlY3RseVNldEN1cnJlbnRVc2VyKG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmRpcmVjdGx5U2V0Q3VycmVudFVzZXIodXNlcik7XG4gICAgfVxuICAgIHVzZURldmljZUxhbmd1YWdlKCkge1xuICAgICAgICB0aGlzLmxhbmd1YWdlQ29kZSA9IF9nZXRVc2VyTGFuZ3VhZ2UoKTtcbiAgICB9XG4gICAgYXN5bmMgX2RlbGV0ZSgpIHtcbiAgICAgICAgdGhpcy5fZGVsZXRlZCA9IHRydWU7XG4gICAgfVxuICAgIGFzeW5jIHVwZGF0ZUN1cnJlbnRVc2VyKHVzZXJFeHRlcm4pIHtcbiAgICAgICAgaWYgKF9pc0ZpcmViYXNlU2VydmVyQXBwKHRoaXMuYXBwKSkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KF9zZXJ2ZXJBcHBDdXJyZW50VXNlck9wZXJhdGlvbk5vdFN1cHBvcnRlZEVycm9yKHRoaXMpKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBUaGUgcHVibGljIHVwZGF0ZUN1cnJlbnRVc2VyIG1ldGhvZCBuZWVkcyB0byBtYWtlIGEgY29weSBvZiB0aGUgdXNlcixcbiAgICAgICAgLy8gYW5kIGFsc28gY2hlY2sgdGhhdCB0aGUgcHJvamVjdCBtYXRjaGVzXG4gICAgICAgIGNvbnN0IHVzZXIgPSB1c2VyRXh0ZXJuXG4gICAgICAgICAgICA/IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyRXh0ZXJuKVxuICAgICAgICAgICAgOiBudWxsO1xuICAgICAgICBpZiAodXNlcikge1xuICAgICAgICAgICAgX2Fzc2VydCh1c2VyLmF1dGguY29uZmlnLmFwaUtleSA9PT0gdGhpcy5jb25maWcuYXBpS2V5LCB0aGlzLCBcImludmFsaWQtdXNlci10b2tlblwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9BVVRIICovKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fdXBkYXRlQ3VycmVudFVzZXIodXNlciAmJiB1c2VyLl9jbG9uZSh0aGlzKSk7XG4gICAgfVxuICAgIGFzeW5jIF91cGRhdGVDdXJyZW50VXNlcih1c2VyLCBza2lwQmVmb3JlU3RhdGVDYWxsYmFja3MgPSBmYWxzZSkge1xuICAgICAgICBpZiAodGhpcy5fZGVsZXRlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgICAgICBfYXNzZXJ0KHRoaXMudGVuYW50SWQgPT09IHVzZXIudGVuYW50SWQsIHRoaXMsIFwidGVuYW50LWlkLW1pc21hdGNoXCIgLyogQXV0aEVycm9yQ29kZS5URU5BTlRfSURfTUlTTUFUQ0ggKi8pO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc2tpcEJlZm9yZVN0YXRlQ2FsbGJhY2tzKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmJlZm9yZVN0YXRlUXVldWUucnVuTWlkZGxld2FyZSh1c2VyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5xdWV1ZShhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmRpcmVjdGx5U2V0Q3VycmVudFVzZXIodXNlcik7XG4gICAgICAgICAgICB0aGlzLm5vdGlmeUF1dGhMaXN0ZW5lcnMoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGFzeW5jIHNpZ25PdXQoKSB7XG4gICAgICAgIGlmIChfaXNGaXJlYmFzZVNlcnZlckFwcCh0aGlzLmFwcCkpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChfc2VydmVyQXBwQ3VycmVudFVzZXJPcGVyYXRpb25Ob3RTdXBwb3J0ZWRFcnJvcih0aGlzKSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gUnVuIGZpcnN0LCB0byBibG9jayBfc2V0UmVkaXJlY3RVc2VyKCkgaWYgYW55IGNhbGxiYWNrcyBmYWlsLlxuICAgICAgICBhd2FpdCB0aGlzLmJlZm9yZVN0YXRlUXVldWUucnVuTWlkZGxld2FyZShudWxsKTtcbiAgICAgICAgLy8gQ2xlYXIgdGhlIHJlZGlyZWN0IHVzZXIgd2hlbiBzaWduT3V0IGlzIGNhbGxlZFxuICAgICAgICBpZiAodGhpcy5yZWRpcmVjdFBlcnNpc3RlbmNlTWFuYWdlciB8fCB0aGlzLl9wb3B1cFJlZGlyZWN0UmVzb2x2ZXIpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuX3NldFJlZGlyZWN0VXNlcihudWxsKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBQcmV2ZW50IGNhbGxiYWNrcyBmcm9tIGJlaW5nIGNhbGxlZCBhZ2FpbiBpbiBfdXBkYXRlQ3VycmVudFVzZXIsIGFzXG4gICAgICAgIC8vIHRoZXkgd2VyZSBhbHJlYWR5IGNhbGxlZCBpbiB0aGUgZmlyc3QgbGluZS5cbiAgICAgICAgcmV0dXJuIHRoaXMuX3VwZGF0ZUN1cnJlbnRVc2VyKG51bGwsIC8qIHNraXBCZWZvcmVTdGF0ZUNhbGxiYWNrcyAqLyB0cnVlKTtcbiAgICB9XG4gICAgc2V0UGVyc2lzdGVuY2UocGVyc2lzdGVuY2UpIHtcbiAgICAgICAgaWYgKF9pc0ZpcmViYXNlU2VydmVyQXBwKHRoaXMuYXBwKSkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KF9zZXJ2ZXJBcHBDdXJyZW50VXNlck9wZXJhdGlvbk5vdFN1cHBvcnRlZEVycm9yKHRoaXMpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5xdWV1ZShhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFzc2VydGVkUGVyc2lzdGVuY2Uuc2V0UGVyc2lzdGVuY2UoX2dldEluc3RhbmNlKHBlcnNpc3RlbmNlKSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBfZ2V0UmVjYXB0Y2hhQ29uZmlnKCkge1xuICAgICAgICBpZiAodGhpcy50ZW5hbnRJZCA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYWdlbnRSZWNhcHRjaGFDb25maWc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdGVuYW50UmVjYXB0Y2hhQ29uZmlnc1t0aGlzLnRlbmFudElkXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyB2YWxpZGF0ZVBhc3N3b3JkKHBhc3N3b3JkKSB7XG4gICAgICAgIGlmICghdGhpcy5fZ2V0UGFzc3dvcmRQb2xpY3lJbnRlcm5hbCgpKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLl91cGRhdGVQYXNzd29yZFBvbGljeSgpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFBhc3N3b3JkIHBvbGljeSB3aWxsIGJlIGRlZmluZWQgYWZ0ZXIgZmV0Y2hpbmcuXG4gICAgICAgIGNvbnN0IHBhc3N3b3JkUG9saWN5ID0gdGhpcy5fZ2V0UGFzc3dvcmRQb2xpY3lJbnRlcm5hbCgpO1xuICAgICAgICAvLyBDaGVjayB0aGF0IHRoZSBwb2xpY3kgc2NoZW1hIHZlcnNpb24gaXMgc3VwcG9ydGVkIGJ5IHRoZSBTREsuXG4gICAgICAgIC8vIFRPRE86IFVwZGF0ZSB0aGlzIGxvZ2ljIHRvIHVzZSBhIG1heCBzdXBwb3J0ZWQgcG9saWN5IHNjaGVtYSB2ZXJzaW9uIG9uY2Ugd2UgaGF2ZSBtdWx0aXBsZSBzY2hlbWEgdmVyc2lvbnMuXG4gICAgICAgIGlmIChwYXNzd29yZFBvbGljeS5zY2hlbWFWZXJzaW9uICE9PVxuICAgICAgICAgICAgdGhpcy5FWFBFQ1RFRF9QQVNTV09SRF9QT0xJQ1lfU0NIRU1BX1ZFUlNJT04pIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCh0aGlzLl9lcnJvckZhY3RvcnkuY3JlYXRlKFwidW5zdXBwb3J0ZWQtcGFzc3dvcmQtcG9saWN5LXNjaGVtYS12ZXJzaW9uXCIgLyogQXV0aEVycm9yQ29kZS5VTlNVUFBPUlRFRF9QQVNTV09SRF9QT0xJQ1lfU0NIRU1BX1ZFUlNJT04gKi8sIHt9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhc3N3b3JkUG9saWN5LnZhbGlkYXRlUGFzc3dvcmQocGFzc3dvcmQpO1xuICAgIH1cbiAgICBfZ2V0UGFzc3dvcmRQb2xpY3lJbnRlcm5hbCgpIHtcbiAgICAgICAgaWYgKHRoaXMudGVuYW50SWQgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9wcm9qZWN0UGFzc3dvcmRQb2xpY3k7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdGVuYW50UGFzc3dvcmRQb2xpY2llc1t0aGlzLnRlbmFudElkXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBfdXBkYXRlUGFzc3dvcmRQb2xpY3koKSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgX2dldFBhc3N3b3JkUG9saWN5KHRoaXMpO1xuICAgICAgICBjb25zdCBwYXNzd29yZFBvbGljeSA9IG5ldyBQYXNzd29yZFBvbGljeUltcGwocmVzcG9uc2UpO1xuICAgICAgICBpZiAodGhpcy50ZW5hbnRJZCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5fcHJvamVjdFBhc3N3b3JkUG9saWN5ID0gcGFzc3dvcmRQb2xpY3k7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl90ZW5hbnRQYXNzd29yZFBvbGljaWVzW3RoaXMudGVuYW50SWRdID0gcGFzc3dvcmRQb2xpY3k7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2dldFBlcnNpc3RlbmNlVHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXNzZXJ0ZWRQZXJzaXN0ZW5jZS5wZXJzaXN0ZW5jZS50eXBlO1xuICAgIH1cbiAgICBfZ2V0UGVyc2lzdGVuY2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFzc2VydGVkUGVyc2lzdGVuY2UucGVyc2lzdGVuY2U7XG4gICAgfVxuICAgIF91cGRhdGVFcnJvck1hcChlcnJvck1hcCkge1xuICAgICAgICB0aGlzLl9lcnJvckZhY3RvcnkgPSBuZXcgRXJyb3JGYWN0b3J5KCdhdXRoJywgJ0ZpcmViYXNlJywgZXJyb3JNYXAoKSk7XG4gICAgfVxuICAgIG9uQXV0aFN0YXRlQ2hhbmdlZChuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZWdpc3RlclN0YXRlTGlzdGVuZXIodGhpcy5hdXRoU3RhdGVTdWJzY3JpcHRpb24sIG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGVkKTtcbiAgICB9XG4gICAgYmVmb3JlQXV0aFN0YXRlQ2hhbmdlZChjYWxsYmFjaywgb25BYm9ydCkge1xuICAgICAgICByZXR1cm4gdGhpcy5iZWZvcmVTdGF0ZVF1ZXVlLnB1c2hDYWxsYmFjayhjYWxsYmFjaywgb25BYm9ydCk7XG4gICAgfVxuICAgIG9uSWRUb2tlbkNoYW5nZWQobmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVnaXN0ZXJTdGF0ZUxpc3RlbmVyKHRoaXMuaWRUb2tlblN1YnNjcmlwdGlvbiwgbmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZWQpO1xuICAgIH1cbiAgICBhdXRoU3RhdGVSZWFkeSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRVc2VyKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdW5zdWJzY3JpYmUgPSB0aGlzLm9uQXV0aFN0YXRlQ2hhbmdlZCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9LCByZWplY3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV2b2tlcyB0aGUgZ2l2ZW4gYWNjZXNzIHRva2VuLiBDdXJyZW50bHkgb25seSBzdXBwb3J0cyBBcHBsZSBPQXV0aCBhY2Nlc3MgdG9rZW5zLlxuICAgICAqL1xuICAgIGFzeW5jIHJldm9rZUFjY2Vzc1Rva2VuKHRva2VuKSB7XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRVc2VyKSB7XG4gICAgICAgICAgICBjb25zdCBpZFRva2VuID0gYXdhaXQgdGhpcy5jdXJyZW50VXNlci5nZXRJZFRva2VuKCk7XG4gICAgICAgICAgICAvLyBHZW5lcmFsaXplIHRoaXMgdG8gYWNjZXB0IG90aGVyIHByb3ZpZGVycyBvbmNlIHN1cHBvcnRlZC5cbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgICAgcHJvdmlkZXJJZDogJ2FwcGxlLmNvbScsXG4gICAgICAgICAgICAgICAgdG9rZW5UeXBlOiBcIkFDQ0VTU19UT0tFTlwiIC8qIFRva2VuVHlwZS5BQ0NFU1NfVE9LRU4gKi8sXG4gICAgICAgICAgICAgICAgdG9rZW4sXG4gICAgICAgICAgICAgICAgaWRUb2tlblxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmICh0aGlzLnRlbmFudElkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0LnRlbmFudElkID0gdGhpcy50ZW5hbnRJZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF3YWl0IHJldm9rZVRva2VuKHRoaXMsIHJlcXVlc3QpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFwaUtleTogdGhpcy5jb25maWcuYXBpS2V5LFxuICAgICAgICAgICAgYXV0aERvbWFpbjogdGhpcy5jb25maWcuYXV0aERvbWFpbixcbiAgICAgICAgICAgIGFwcE5hbWU6IHRoaXMubmFtZSxcbiAgICAgICAgICAgIGN1cnJlbnRVc2VyOiB0aGlzLl9jdXJyZW50VXNlcj8udG9KU09OKClcbiAgICAgICAgfTtcbiAgICB9XG4gICAgYXN5bmMgX3NldFJlZGlyZWN0VXNlcih1c2VyLCBwb3B1cFJlZGlyZWN0UmVzb2x2ZXIpIHtcbiAgICAgICAgY29uc3QgcmVkaXJlY3RNYW5hZ2VyID0gYXdhaXQgdGhpcy5nZXRPckluaXRSZWRpcmVjdFBlcnNpc3RlbmNlTWFuYWdlcihwb3B1cFJlZGlyZWN0UmVzb2x2ZXIpO1xuICAgICAgICByZXR1cm4gdXNlciA9PT0gbnVsbFxuICAgICAgICAgICAgPyByZWRpcmVjdE1hbmFnZXIucmVtb3ZlQ3VycmVudFVzZXIoKVxuICAgICAgICAgICAgOiByZWRpcmVjdE1hbmFnZXIuc2V0Q3VycmVudFVzZXIodXNlcik7XG4gICAgfVxuICAgIGFzeW5jIGdldE9ySW5pdFJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyKHBvcHVwUmVkaXJlY3RSZXNvbHZlcikge1xuICAgICAgICBpZiAoIXRoaXMucmVkaXJlY3RQZXJzaXN0ZW5jZU1hbmFnZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc29sdmVyID0gKHBvcHVwUmVkaXJlY3RSZXNvbHZlciAmJiBfZ2V0SW5zdGFuY2UocG9wdXBSZWRpcmVjdFJlc29sdmVyKSkgfHxcbiAgICAgICAgICAgICAgICB0aGlzLl9wb3B1cFJlZGlyZWN0UmVzb2x2ZXI7XG4gICAgICAgICAgICBfYXNzZXJ0KHJlc29sdmVyLCB0aGlzLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUiAqLyk7XG4gICAgICAgICAgICB0aGlzLnJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyID0gYXdhaXQgUGVyc2lzdGVuY2VVc2VyTWFuYWdlci5jcmVhdGUodGhpcywgW19nZXRJbnN0YW5jZShyZXNvbHZlci5fcmVkaXJlY3RQZXJzaXN0ZW5jZSldLCBcInJlZGlyZWN0VXNlclwiIC8qIEtleU5hbWUuUkVESVJFQ1RfVVNFUiAqLyk7XG4gICAgICAgICAgICB0aGlzLnJlZGlyZWN0VXNlciA9XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5yZWRpcmVjdFBlcnNpc3RlbmNlTWFuYWdlci5nZXRDdXJyZW50VXNlcigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyO1xuICAgIH1cbiAgICBhc3luYyBfcmVkaXJlY3RVc2VyRm9ySWQoaWQpIHtcbiAgICAgICAgLy8gTWFrZSBzdXJlIHdlJ3ZlIGNsZWFyZWQgYW55IHBlbmRpbmcgcGVyc2lzdGVuY2UgYWN0aW9ucyBpZiB3ZSdyZSBub3QgaW5cbiAgICAgICAgLy8gdGhlIGluaXRpYWxpemVyXG4gICAgICAgIGlmICh0aGlzLl9pc0luaXRpYWxpemVkKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnF1ZXVlKGFzeW5jICgpID0+IHsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX2N1cnJlbnRVc2VyPy5fcmVkaXJlY3RFdmVudElkID09PSBpZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRVc2VyO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnJlZGlyZWN0VXNlcj8uX3JlZGlyZWN0RXZlbnRJZCA9PT0gaWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlZGlyZWN0VXNlcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgYXN5bmMgX3BlcnNpc3RVc2VySWZDdXJyZW50KHVzZXIpIHtcbiAgICAgICAgaWYgKHVzZXIgPT09IHRoaXMuY3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnF1ZXVlKGFzeW5jICgpID0+IHRoaXMuZGlyZWN0bHlTZXRDdXJyZW50VXNlcih1c2VyKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqIE5vdGlmaWVzIGxpc3RlbmVycyBvbmx5IGlmIHRoZSB1c2VyIGlzIGN1cnJlbnQgKi9cbiAgICBfbm90aWZ5TGlzdGVuZXJzSWZDdXJyZW50KHVzZXIpIHtcbiAgICAgICAgaWYgKHVzZXIgPT09IHRoaXMuY3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgIHRoaXMubm90aWZ5QXV0aExpc3RlbmVycygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9rZXkoKSB7XG4gICAgICAgIHJldHVybiBgJHt0aGlzLmNvbmZpZy5hdXRoRG9tYWlufToke3RoaXMuY29uZmlnLmFwaUtleX06JHt0aGlzLm5hbWV9YDtcbiAgICB9XG4gICAgX3N0YXJ0UHJvYWN0aXZlUmVmcmVzaCgpIHtcbiAgICAgICAgdGhpcy5pc1Byb2FjdGl2ZVJlZnJlc2hFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRVc2VyLl9zdGFydFByb2FjdGl2ZVJlZnJlc2goKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfc3RvcFByb2FjdGl2ZVJlZnJlc2goKSB7XG4gICAgICAgIHRoaXMuaXNQcm9hY3RpdmVSZWZyZXNoRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5jdXJyZW50VXNlcikge1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudFVzZXIuX3N0b3BQcm9hY3RpdmVSZWZyZXNoKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqIFJldHVybnMgdGhlIGN1cnJlbnQgdXNlciBjYXN0IGFzIHRoZSBpbnRlcm5hbCB0eXBlICovXG4gICAgZ2V0IF9jdXJyZW50VXNlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFVzZXI7XG4gICAgfVxuICAgIG5vdGlmeUF1dGhMaXN0ZW5lcnMoKSB7XG4gICAgICAgIGlmICghdGhpcy5faXNJbml0aWFsaXplZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaWRUb2tlblN1YnNjcmlwdGlvbi5uZXh0KHRoaXMuY3VycmVudFVzZXIpO1xuICAgICAgICBjb25zdCBjdXJyZW50VWlkID0gdGhpcy5jdXJyZW50VXNlcj8udWlkID8/IG51bGw7XG4gICAgICAgIGlmICh0aGlzLmxhc3ROb3RpZmllZFVpZCAhPT0gY3VycmVudFVpZCkge1xuICAgICAgICAgICAgdGhpcy5sYXN0Tm90aWZpZWRVaWQgPSBjdXJyZW50VWlkO1xuICAgICAgICAgICAgdGhpcy5hdXRoU3RhdGVTdWJzY3JpcHRpb24ubmV4dCh0aGlzLmN1cnJlbnRVc2VyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZWdpc3RlclN0YXRlTGlzdGVuZXIoc3Vic2NyaXB0aW9uLCBuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlZCkge1xuICAgICAgICBpZiAodGhpcy5fZGVsZXRlZCkge1xuICAgICAgICAgICAgcmV0dXJuICgpID0+IHsgfTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjYiA9IHR5cGVvZiBuZXh0T3JPYnNlcnZlciA9PT0gJ2Z1bmN0aW9uJ1xuICAgICAgICAgICAgPyBuZXh0T3JPYnNlcnZlclxuICAgICAgICAgICAgOiBuZXh0T3JPYnNlcnZlci5uZXh0LmJpbmQobmV4dE9yT2JzZXJ2ZXIpO1xuICAgICAgICBsZXQgaXNVbnN1YnNjcmliZWQgPSBmYWxzZTtcbiAgICAgICAgY29uc3QgcHJvbWlzZSA9IHRoaXMuX2lzSW5pdGlhbGl6ZWRcbiAgICAgICAgICAgID8gUHJvbWlzZS5yZXNvbHZlKClcbiAgICAgICAgICAgIDogdGhpcy5faW5pdGlhbGl6YXRpb25Qcm9taXNlO1xuICAgICAgICBfYXNzZXJ0KHByb21pc2UsIHRoaXMsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgLy8gVGhlIGNhbGxiYWNrIG5lZWRzIHRvIGJlIGNhbGxlZCBhc3luY2hyb25vdXNseSBwZXIgdGhlIHNwZWMuXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgICAgICAgcHJvbWlzZS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGlmIChpc1Vuc3Vic2NyaWJlZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNiKHRoaXMuY3VycmVudFVzZXIpO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHR5cGVvZiBuZXh0T3JPYnNlcnZlciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY29uc3QgdW5zdWJzY3JpYmUgPSBzdWJzY3JpcHRpb24uYWRkT2JzZXJ2ZXIobmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZWQpO1xuICAgICAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgICAgICBpc1Vuc3Vic2NyaWJlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCB1bnN1YnNjcmliZSA9IHN1YnNjcmlwdGlvbi5hZGRPYnNlcnZlcihuZXh0T3JPYnNlcnZlcik7XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlzVW5zdWJzY3JpYmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB1bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBVbnByb3RlY3RlZCAoZnJvbSByYWNlIGNvbmRpdGlvbnMpIG1ldGhvZCB0byBzZXQgdGhlIGN1cnJlbnQgdXNlci4gVGhpc1xuICAgICAqIHNob3VsZCBvbmx5IGJlIGNhbGxlZCBmcm9tIHdpdGhpbiBhIHF1ZXVlZCBjYWxsYmFjay4gVGhpcyBpcyBuZWNlc3NhcnlcbiAgICAgKiBiZWNhdXNlIHRoZSBxdWV1ZSBzaG91bGRuJ3QgcmVseSBvbiBhbm90aGVyIHF1ZXVlZCBjYWxsYmFjay5cbiAgICAgKi9cbiAgICBhc3luYyBkaXJlY3RseVNldEN1cnJlbnRVc2VyKHVzZXIpIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFVzZXIgJiYgdGhpcy5jdXJyZW50VXNlciAhPT0gdXNlcikge1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudFVzZXIuX3N0b3BQcm9hY3RpdmVSZWZyZXNoKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVzZXIgJiYgdGhpcy5pc1Byb2FjdGl2ZVJlZnJlc2hFbmFibGVkKSB7XG4gICAgICAgICAgICB1c2VyLl9zdGFydFByb2FjdGl2ZVJlZnJlc2goKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gdXNlcjtcbiAgICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXNzZXJ0ZWRQZXJzaXN0ZW5jZS5zZXRDdXJyZW50VXNlcih1c2VyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXNzZXJ0ZWRQZXJzaXN0ZW5jZS5yZW1vdmVDdXJyZW50VXNlcigpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHF1ZXVlKGFjdGlvbikge1xuICAgICAgICAvLyBJbiBjYXNlIHNvbWV0aGluZyBlcnJvcnMsIHRoZSBjYWxsYmFjayBzdGlsbCBzaG91bGQgYmUgY2FsbGVkIGluIG9yZGVyXG4gICAgICAgIC8vIHRvIGtlZXAgdGhlIHByb21pc2UgY2hhaW4gYWxpdmVcbiAgICAgICAgdGhpcy5vcGVyYXRpb25zID0gdGhpcy5vcGVyYXRpb25zLnRoZW4oYWN0aW9uLCBhY3Rpb24pO1xuICAgICAgICByZXR1cm4gdGhpcy5vcGVyYXRpb25zO1xuICAgIH1cbiAgICBnZXQgYXNzZXJ0ZWRQZXJzaXN0ZW5jZSgpIHtcbiAgICAgICAgX2Fzc2VydCh0aGlzLnBlcnNpc3RlbmNlTWFuYWdlciwgdGhpcywgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZU1hbmFnZXI7XG4gICAgfVxuICAgIF9sb2dGcmFtZXdvcmsoZnJhbWV3b3JrKSB7XG4gICAgICAgIGlmICghZnJhbWV3b3JrIHx8IHRoaXMuZnJhbWV3b3Jrcy5pbmNsdWRlcyhmcmFtZXdvcmspKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5mcmFtZXdvcmtzLnB1c2goZnJhbWV3b3JrKTtcbiAgICAgICAgLy8gU29ydCBhbHBoYWJldGljYWxseSBzbyB0aGF0IFwiRmlyZWJhc2VDb3JlLXdlYixGaXJlYmFzZVVJLXdlYlwiIGFuZFxuICAgICAgICAvLyBcIkZpcmViYXNlVUktd2ViLEZpcmViYXNlQ29yZS13ZWJcIiBhcmVuJ3Qgdmlld2VkIGFzIGRpZmZlcmVudC5cbiAgICAgICAgdGhpcy5mcmFtZXdvcmtzLnNvcnQoKTtcbiAgICAgICAgdGhpcy5jbGllbnRWZXJzaW9uID0gX2dldENsaWVudFZlcnNpb24odGhpcy5jb25maWcuY2xpZW50UGxhdGZvcm0sIHRoaXMuX2dldEZyYW1ld29ya3MoKSk7XG4gICAgfVxuICAgIF9nZXRGcmFtZXdvcmtzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mcmFtZXdvcmtzO1xuICAgIH1cbiAgICBhc3luYyBfZ2V0QWRkaXRpb25hbEhlYWRlcnMoKSB7XG4gICAgICAgIC8vIEFkZGl0aW9uYWwgaGVhZGVycyBvbiBldmVyeSByZXF1ZXN0XG4gICAgICAgIGNvbnN0IGhlYWRlcnMgPSB7XG4gICAgICAgICAgICBbXCJYLUNsaWVudC1WZXJzaW9uXCIgLyogSHR0cEhlYWRlci5YX0NMSUVOVF9WRVJTSU9OICovXTogdGhpcy5jbGllbnRWZXJzaW9uXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmFwcC5vcHRpb25zLmFwcElkKSB7XG4gICAgICAgICAgICBoZWFkZXJzW1wiWC1GaXJlYmFzZS1nbXBpZFwiIC8qIEh0dHBIZWFkZXIuWF9GSVJFQkFTRV9HTVBJRCAqL10gPSB0aGlzLmFwcC5vcHRpb25zLmFwcElkO1xuICAgICAgICB9XG4gICAgICAgIC8vIElmIHRoZSBoZWFydGJlYXQgc2VydmljZSBleGlzdHMsIGFkZCB0aGUgaGVhcnRiZWF0IHN0cmluZ1xuICAgICAgICBjb25zdCBoZWFydGJlYXRzSGVhZGVyID0gYXdhaXQgdGhpcy5oZWFydGJlYXRTZXJ2aWNlUHJvdmlkZXJcbiAgICAgICAgICAgIC5nZXRJbW1lZGlhdGUoe1xuICAgICAgICAgICAgb3B0aW9uYWw6IHRydWVcbiAgICAgICAgfSlcbiAgICAgICAgICAgID8uZ2V0SGVhcnRiZWF0c0hlYWRlcigpO1xuICAgICAgICBpZiAoaGVhcnRiZWF0c0hlYWRlcikge1xuICAgICAgICAgICAgaGVhZGVyc1tcIlgtRmlyZWJhc2UtQ2xpZW50XCIgLyogSHR0cEhlYWRlci5YX0ZJUkVCQVNFX0NMSUVOVCAqL10gPSBoZWFydGJlYXRzSGVhZGVyO1xuICAgICAgICB9XG4gICAgICAgIC8vIElmIHRoZSBBcHAgQ2hlY2sgc2VydmljZSBleGlzdHMsIGFkZCB0aGUgQXBwIENoZWNrIHRva2VuIGluIHRoZSBoZWFkZXJzXG4gICAgICAgIGNvbnN0IGFwcENoZWNrVG9rZW4gPSBhd2FpdCB0aGlzLl9nZXRBcHBDaGVja1Rva2VuKCk7XG4gICAgICAgIGlmIChhcHBDaGVja1Rva2VuKSB7XG4gICAgICAgICAgICBoZWFkZXJzW1wiWC1GaXJlYmFzZS1BcHBDaGVja1wiIC8qIEh0dHBIZWFkZXIuWF9GSVJFQkFTRV9BUFBfQ0hFQ0sgKi9dID0gYXBwQ2hlY2tUb2tlbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaGVhZGVycztcbiAgICB9XG4gICAgYXN5bmMgX2dldEFwcENoZWNrVG9rZW4oKSB7XG4gICAgICAgIGlmIChfaXNGaXJlYmFzZVNlcnZlckFwcCh0aGlzLmFwcCkgJiYgdGhpcy5hcHAuc2V0dGluZ3MuYXBwQ2hlY2tUb2tlbikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXBwLnNldHRpbmdzLmFwcENoZWNrVG9rZW47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYXBwQ2hlY2tUb2tlblJlc3VsdCA9IGF3YWl0IHRoaXMuYXBwQ2hlY2tTZXJ2aWNlUHJvdmlkZXJcbiAgICAgICAgICAgIC5nZXRJbW1lZGlhdGUoeyBvcHRpb25hbDogdHJ1ZSB9KVxuICAgICAgICAgICAgPy5nZXRUb2tlbigpO1xuICAgICAgICBpZiAoYXBwQ2hlY2tUb2tlblJlc3VsdD8uZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIENvbnRleHQ6IGFwcENoZWNrLmdldFRva2VuKCkgd2lsbCBuZXZlciB0aHJvdyBldmVuIGlmIGFuIGVycm9yIGhhcHBlbmVkLlxuICAgICAgICAgICAgLy8gSW4gdGhlIGVycm9yIGNhc2UsIGEgZHVtbXkgdG9rZW4gd2lsbCBiZSByZXR1cm5lZCBhbG9uZyB3aXRoIGFuIGVycm9yIGZpZWxkIGRlc2NyaWJpbmdcbiAgICAgICAgICAgIC8vIHRoZSBlcnJvci4gSW4gZ2VuZXJhbCwgd2Ugc2hvdWxkbid0IGNhcmUgYWJvdXQgdGhlIGVycm9yIGNvbmRpdGlvbiBhbmQganVzdCB1c2VcbiAgICAgICAgICAgIC8vIHRoZSB0b2tlbiAoYWN0dWFsIG9yIGR1bW15KSB0byBzZW5kIHJlcXVlc3RzLlxuICAgICAgICAgICAgX2xvZ1dhcm4oYEVycm9yIHdoaWxlIHJldHJpZXZpbmcgQXBwIENoZWNrIHRva2VuOiAke2FwcENoZWNrVG9rZW5SZXN1bHQuZXJyb3J9YCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFwcENoZWNrVG9rZW5SZXN1bHQ/LnRva2VuO1xuICAgIH1cbn1cbi8qKlxuICogTWV0aG9kIHRvIGJlIHVzZWQgdG8gY2FzdCBkb3duIHRvIG91ciBwcml2YXRlIGltcGxlbWVudGF0aW9uIG9mIEF1dGguXG4gKiBJdCB3aWxsIGFsc28gaGFuZGxlIHVud3JhcHBpbmcgZnJvbSB0aGUgY29tcGF0IHR5cGUgaWYgbmVjZXNzYXJ5XG4gKlxuICogQHBhcmFtIGF1dGggQXV0aCBvYmplY3QgcGFzc2VkIGluIGZyb20gZGV2ZWxvcGVyXG4gKi9cbmZ1bmN0aW9uIF9jYXN0QXV0aChhdXRoKSB7XG4gICAgcmV0dXJuIGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKTtcbn1cbi8qKiBIZWxwZXIgY2xhc3MgdG8gd3JhcCBzdWJzY3JpYmVyIGxvZ2ljICovXG5jbGFzcyBTdWJzY3JpcHRpb24ge1xuICAgIGNvbnN0cnVjdG9yKGF1dGgpIHtcbiAgICAgICAgdGhpcy5hdXRoID0gYXV0aDtcbiAgICAgICAgdGhpcy5vYnNlcnZlciA9IG51bGw7XG4gICAgICAgIHRoaXMuYWRkT2JzZXJ2ZXIgPSBjcmVhdGVTdWJzY3JpYmUob2JzZXJ2ZXIgPT4gKHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcikpO1xuICAgIH1cbiAgICBnZXQgbmV4dCgpIHtcbiAgICAgICAgX2Fzc2VydCh0aGlzLm9ic2VydmVyLCB0aGlzLmF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgcmV0dXJuIHRoaXMub2JzZXJ2ZXIubmV4dC5iaW5kKHRoaXMub2JzZXJ2ZXIpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmxldCBleHRlcm5hbEpTUHJvdmlkZXIgPSB7XG4gICAgYXN5bmMgbG9hZEpTKCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byBsb2FkIGV4dGVybmFsIHNjcmlwdHMnKTtcbiAgICB9LFxuICAgIHJlY2FwdGNoYVYyU2NyaXB0OiAnJyxcbiAgICByZWNhcHRjaGFFbnRlcnByaXNlU2NyaXB0OiAnJyxcbiAgICBnYXBpU2NyaXB0OiAnJ1xufTtcbmZ1bmN0aW9uIF9zZXRFeHRlcm5hbEpTUHJvdmlkZXIocCkge1xuICAgIGV4dGVybmFsSlNQcm92aWRlciA9IHA7XG59XG5mdW5jdGlvbiBfbG9hZEpTKHVybCkge1xuICAgIHJldHVybiBleHRlcm5hbEpTUHJvdmlkZXIubG9hZEpTKHVybCk7XG59XG5mdW5jdGlvbiBfcmVjYXB0Y2hhVjJTY3JpcHRVcmwoKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsSlNQcm92aWRlci5yZWNhcHRjaGFWMlNjcmlwdDtcbn1cbmZ1bmN0aW9uIF9yZWNhcHRjaGFFbnRlcnByaXNlU2NyaXB0VXJsKCkge1xuICAgIHJldHVybiBleHRlcm5hbEpTUHJvdmlkZXIucmVjYXB0Y2hhRW50ZXJwcmlzZVNjcmlwdDtcbn1cbmZ1bmN0aW9uIF9nYXBpU2NyaXB0VXJsKCkge1xuICAgIHJldHVybiBleHRlcm5hbEpTUHJvdmlkZXIuZ2FwaVNjcmlwdDtcbn1cbmZ1bmN0aW9uIF9nZW5lcmF0ZUNhbGxiYWNrTmFtZShwcmVmaXgpIHtcbiAgICByZXR1cm4gYF9fJHtwcmVmaXh9JHtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwKX1gO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY29uc3QgX1NPTFZFX1RJTUVfTVMgPSA1MDA7XG5jb25zdCBfRVhQSVJBVElPTl9USU1FX01TID0gNjAwMDA7XG5jb25zdCBfV0lER0VUX0lEX1NUQVJUID0gMTAwMDAwMDAwMDAwMDtcbmNsYXNzIE1vY2tSZUNhcHRjaGEge1xuICAgIGNvbnN0cnVjdG9yKGF1dGgpIHtcbiAgICAgICAgdGhpcy5hdXRoID0gYXV0aDtcbiAgICAgICAgdGhpcy5jb3VudGVyID0gX1dJREdFVF9JRF9TVEFSVDtcbiAgICAgICAgdGhpcy5fd2lkZ2V0cyA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgcmVuZGVyKGNvbnRhaW5lciwgcGFyYW1ldGVycykge1xuICAgICAgICBjb25zdCBpZCA9IHRoaXMuY291bnRlcjtcbiAgICAgICAgdGhpcy5fd2lkZ2V0cy5zZXQoaWQsIG5ldyBNb2NrV2lkZ2V0KGNvbnRhaW5lciwgdGhpcy5hdXRoLm5hbWUsIHBhcmFtZXRlcnMgfHwge30pKTtcbiAgICAgICAgdGhpcy5jb3VudGVyKys7XG4gICAgICAgIHJldHVybiBpZDtcbiAgICB9XG4gICAgcmVzZXQob3B0V2lkZ2V0SWQpIHtcbiAgICAgICAgY29uc3QgaWQgPSBvcHRXaWRnZXRJZCB8fCBfV0lER0VUX0lEX1NUQVJUO1xuICAgICAgICB2b2lkIHRoaXMuX3dpZGdldHMuZ2V0KGlkKT8uZGVsZXRlKCk7XG4gICAgICAgIHRoaXMuX3dpZGdldHMuZGVsZXRlKGlkKTtcbiAgICB9XG4gICAgZ2V0UmVzcG9uc2Uob3B0V2lkZ2V0SWQpIHtcbiAgICAgICAgY29uc3QgaWQgPSBvcHRXaWRnZXRJZCB8fCBfV0lER0VUX0lEX1NUQVJUO1xuICAgICAgICByZXR1cm4gdGhpcy5fd2lkZ2V0cy5nZXQoaWQpPy5nZXRSZXNwb25zZSgpIHx8ICcnO1xuICAgIH1cbiAgICBhc3luYyBleGVjdXRlKG9wdFdpZGdldElkKSB7XG4gICAgICAgIGNvbnN0IGlkID0gb3B0V2lkZ2V0SWQgfHwgX1dJREdFVF9JRF9TVEFSVDtcbiAgICAgICAgdm9pZCB0aGlzLl93aWRnZXRzLmdldChpZCk/LmV4ZWN1dGUoKTtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbn1cbmNsYXNzIE1vY2tHcmVDQVBUQ0hBVG9wTGV2ZWwge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmVudGVycHJpc2UgPSBuZXcgTW9ja0dyZUNBUFRDSEEoKTtcbiAgICB9XG4gICAgcmVhZHkoY2FsbGJhY2spIHtcbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICB9XG4gICAgZXhlY3V0ZShcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gICAgX3NpdGVLZXksIF9vcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoJ3Rva2VuJyk7XG4gICAgfVxuICAgIHJlbmRlcihcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gICAgX2NvbnRhaW5lciwgX3BhcmFtZXRlcnMpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbn1cbmNsYXNzIE1vY2tHcmVDQVBUQ0hBIHtcbiAgICByZWFkeShjYWxsYmFjaykge1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgIH1cbiAgICBleGVjdXRlKFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICBfc2l0ZUtleSwgX29wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgndG9rZW4nKTtcbiAgICB9XG4gICAgcmVuZGVyKFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICBfY29udGFpbmVyLCBfcGFyYW1ldGVycykge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxufVxuY2xhc3MgTW9ja1dpZGdldCB7XG4gICAgY29uc3RydWN0b3IoY29udGFpbmVyT3JJZCwgYXBwTmFtZSwgcGFyYW1zKSB7XG4gICAgICAgIHRoaXMucGFyYW1zID0gcGFyYW1zO1xuICAgICAgICB0aGlzLnRpbWVySWQgPSBudWxsO1xuICAgICAgICB0aGlzLmRlbGV0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5yZXNwb25zZVRva2VuID0gbnVsbDtcbiAgICAgICAgdGhpcy5jbGlja0hhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmV4ZWN1dGUoKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gdHlwZW9mIGNvbnRhaW5lck9ySWQgPT09ICdzdHJpbmcnXG4gICAgICAgICAgICA/IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbnRhaW5lck9ySWQpXG4gICAgICAgICAgICA6IGNvbnRhaW5lck9ySWQ7XG4gICAgICAgIF9hc3NlcnQoY29udGFpbmVyLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUiAqLywgeyBhcHBOYW1lIH0pO1xuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICAgICAgdGhpcy5pc1Zpc2libGUgPSB0aGlzLnBhcmFtcy5zaXplICE9PSAnaW52aXNpYmxlJztcbiAgICAgICAgaWYgKHRoaXMuaXNWaXNpYmxlKSB7XG4gICAgICAgICAgICB0aGlzLmV4ZWN1dGUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbGlja0hhbmRsZXIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldFJlc3BvbnNlKCkge1xuICAgICAgICB0aGlzLmNoZWNrSWZEZWxldGVkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3BvbnNlVG9rZW47XG4gICAgfVxuICAgIGRlbGV0ZSgpIHtcbiAgICAgICAgdGhpcy5jaGVja0lmRGVsZXRlZCgpO1xuICAgICAgICB0aGlzLmRlbGV0ZWQgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy50aW1lcklkKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lcklkKTtcbiAgICAgICAgICAgIHRoaXMudGltZXJJZCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb250YWluZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNsaWNrSGFuZGxlcik7XG4gICAgfVxuICAgIGV4ZWN1dGUoKSB7XG4gICAgICAgIHRoaXMuY2hlY2tJZkRlbGV0ZWQoKTtcbiAgICAgICAgaWYgKHRoaXMudGltZXJJZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudGltZXJJZCA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMucmVzcG9uc2VUb2tlbiA9IGdlbmVyYXRlUmFuZG9tQWxwaGFOdW1lcmljU3RyaW5nKDUwKTtcbiAgICAgICAgICAgIGNvbnN0IHsgY2FsbGJhY2ssICdleHBpcmVkLWNhbGxiYWNrJzogZXhwaXJlZENhbGxiYWNrIH0gPSB0aGlzLnBhcmFtcztcbiAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKHRoaXMucmVzcG9uc2VUb2tlbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7IH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudGltZXJJZCA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnRpbWVySWQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMucmVzcG9uc2VUb2tlbiA9IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKGV4cGlyZWRDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJlZENhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHsgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1Zpc2libGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5leGVjdXRlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgX0VYUElSQVRJT05fVElNRV9NUyk7XG4gICAgICAgIH0sIF9TT0xWRV9USU1FX01TKTtcbiAgICB9XG4gICAgY2hlY2tJZkRlbGV0ZWQoKSB7XG4gICAgICAgIGlmICh0aGlzLmRlbGV0ZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigncmVDQVBUQ0hBIG1vY2sgd2FzIGFscmVhZHkgZGVsZXRlZCEnKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGdlbmVyYXRlUmFuZG9tQWxwaGFOdW1lcmljU3RyaW5nKGxlbikge1xuICAgIGNvbnN0IGNoYXJzID0gW107XG4gICAgY29uc3QgYWxsb3dlZENoYXJzID0gJzEyMzQ1Njc4OTBhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ekFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaJztcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGNoYXJzLnB1c2goYWxsb3dlZENoYXJzLmNoYXJBdChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBhbGxvd2VkQ2hhcnMubGVuZ3RoKSkpO1xuICAgIH1cbiAgICByZXR1cm4gY2hhcnMuam9pbignJyk7XG59XG5cbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby1yZXF1aXJlLWltcG9ydHMgKi9cbmNvbnN0IFJFQ0FQVENIQV9FTlRFUlBSSVNFX1ZFUklGSUVSX1RZUEUgPSAncmVjYXB0Y2hhLWVudGVycHJpc2UnO1xuY29uc3QgRkFLRV9UT0tFTiA9ICdOT19SRUNBUFRDSEEnO1xuY2xhc3MgUmVjYXB0Y2hhRW50ZXJwcmlzZVZlcmlmaWVyIHtcbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSBhdXRoRXh0ZXJuIC0gVGhlIGNvcnJlc3BvbmRpbmcgRmlyZWJhc2Uge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICAgICAqXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoYXV0aEV4dGVybikge1xuICAgICAgICAvKipcbiAgICAgICAgICogSWRlbnRpZmllcyB0aGUgdHlwZSBvZiBhcHBsaWNhdGlvbiB2ZXJpZmllciAoZS5nLiBcInJlY2FwdGNoYS1lbnRlcnByaXNlXCIpLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50eXBlID0gUkVDQVBUQ0hBX0VOVEVSUFJJU0VfVkVSSUZJRVJfVFlQRTtcbiAgICAgICAgdGhpcy5hdXRoID0gX2Nhc3RBdXRoKGF1dGhFeHRlcm4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlcyB0aGUgdmVyaWZpY2F0aW9uIHByb2Nlc3MuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBBIFByb21pc2UgZm9yIGEgdG9rZW4gdGhhdCBjYW4gYmUgdXNlZCB0byBhc3NlcnQgdGhlIHZhbGlkaXR5IG9mIGEgcmVxdWVzdC5cbiAgICAgKi9cbiAgICBhc3luYyB2ZXJpZnkoYWN0aW9uID0gJ3ZlcmlmeScsIGZvcmNlUmVmcmVzaCA9IGZhbHNlKSB7XG4gICAgICAgIGFzeW5jIGZ1bmN0aW9uIHJldHJpZXZlU2l0ZUtleShhdXRoKSB7XG4gICAgICAgICAgICBpZiAoIWZvcmNlUmVmcmVzaCkge1xuICAgICAgICAgICAgICAgIGlmIChhdXRoLnRlbmFudElkID09IG51bGwgJiYgYXV0aC5fYWdlbnRSZWNhcHRjaGFDb25maWcgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXV0aC5fYWdlbnRSZWNhcHRjaGFDb25maWcuc2l0ZUtleTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGF1dGgudGVuYW50SWQgIT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgICAgICBhdXRoLl90ZW5hbnRSZWNhcHRjaGFDb25maWdzW2F1dGgudGVuYW50SWRdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF1dGguX3RlbmFudFJlY2FwdGNoYUNvbmZpZ3NbYXV0aC50ZW5hbnRJZF0uc2l0ZUtleTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICAgIGdldFJlY2FwdGNoYUNvbmZpZyhhdXRoLCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWVudFR5cGU6IFwiQ0xJRU5UX1RZUEVfV0VCXCIgLyogUmVjYXB0Y2hhQ2xpZW50VHlwZS5XRUIgKi8sXG4gICAgICAgICAgICAgICAgICAgIHZlcnNpb246IFwiUkVDQVBUQ0hBX0VOVEVSUFJJU0VcIiAvKiBSZWNhcHRjaGFWZXJzaW9uLkVOVEVSUFJJU0UgKi9cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5yZWNhcHRjaGFLZXkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcigncmVjYXB0Y2hhIEVudGVycHJpc2Ugc2l0ZSBrZXkgdW5kZWZpbmVkJykpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29uZmlnID0gbmV3IFJlY2FwdGNoYUNvbmZpZyhyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXV0aC50ZW5hbnRJZCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aC5fYWdlbnRSZWNhcHRjaGFDb25maWcgPSBjb25maWc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRoLl90ZW5hbnRSZWNhcHRjaGFDb25maWdzW2F1dGgudGVuYW50SWRdID0gY29uZmlnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoY29uZmlnLnNpdGVLZXkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJldHJpZXZlUmVjYXB0Y2hhVG9rZW4oc2l0ZUtleSwgcmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICBjb25zdCBncmVjYXB0Y2hhID0gd2luZG93LmdyZWNhcHRjaGE7XG4gICAgICAgICAgICBpZiAoaXNFbnRlcnByaXNlKGdyZWNhcHRjaGEpKSB7XG4gICAgICAgICAgICAgICAgZ3JlY2FwdGNoYS5lbnRlcnByaXNlLnJlYWR5KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZ3JlY2FwdGNoYS5lbnRlcnByaXNlXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXhlY3V0ZShzaXRlS2V5LCB7IGFjdGlvbiB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4odG9rZW4gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0b2tlbik7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShGQUtFX1RPS0VOKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWplY3QoRXJyb3IoJ05vIHJlQ0FQVENIQSBlbnRlcnByaXNlIHNjcmlwdCBsb2FkZWQuJykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIFJldHVybnMgUHJvbWlzZSBmb3IgYSBtb2NrIHRva2VuIHdoZW4gYXBwVmVyaWZpY2F0aW9uRGlzYWJsZWRGb3JUZXN0aW5nIGlzIHRydWUuXG4gICAgICAgIGlmICh0aGlzLmF1dGguc2V0dGluZ3MuYXBwVmVyaWZpY2F0aW9uRGlzYWJsZWRGb3JUZXN0aW5nKSB7XG4gICAgICAgICAgICBjb25zdCBtb2NrUmVjYXB0Y2hhID0gbmV3IE1vY2tHcmVDQVBUQ0hBVG9wTGV2ZWwoKTtcbiAgICAgICAgICAgIHJldHVybiBtb2NrUmVjYXB0Y2hhLmV4ZWN1dGUoJ3NpdGVLZXknLCB7IGFjdGlvbjogJ3ZlcmlmeScgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHJldHJpZXZlU2l0ZUtleSh0aGlzLmF1dGgpXG4gICAgICAgICAgICAgICAgLnRoZW4oc2l0ZUtleSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFmb3JjZVJlZnJlc2ggJiYgaXNFbnRlcnByaXNlKHdpbmRvdy5ncmVjYXB0Y2hhKSkge1xuICAgICAgICAgICAgICAgICAgICByZXRyaWV2ZVJlY2FwdGNoYVRva2VuKHNpdGVLZXksIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ1JlY2FwdGNoYVZlcmlmaWVyIGlzIG9ubHkgc3VwcG9ydGVkIGluIGJyb3dzZXInKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGV0IHVybCA9IF9yZWNhcHRjaGFFbnRlcnByaXNlU2NyaXB0VXJsKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1cmwubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwgKz0gc2l0ZUtleTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBfbG9hZEpTKHVybClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHJpZXZlUmVjYXB0Y2hhVG9rZW4oc2l0ZUtleSwgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5hc3luYyBmdW5jdGlvbiBpbmplY3RSZWNhcHRjaGFGaWVsZHMoYXV0aCwgcmVxdWVzdCwgYWN0aW9uLCBpc0NhcHRjaGFSZXNwID0gZmFsc2UsIGlzRmFrZVRva2VuID0gZmFsc2UpIHtcbiAgICBjb25zdCB2ZXJpZmllciA9IG5ldyBSZWNhcHRjaGFFbnRlcnByaXNlVmVyaWZpZXIoYXV0aCk7XG4gICAgbGV0IGNhcHRjaGFSZXNwb25zZTtcbiAgICBpZiAoaXNGYWtlVG9rZW4pIHtcbiAgICAgICAgY2FwdGNoYVJlc3BvbnNlID0gRkFLRV9UT0tFTjtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjYXB0Y2hhUmVzcG9uc2UgPSBhd2FpdCB2ZXJpZmllci52ZXJpZnkoYWN0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNhcHRjaGFSZXNwb25zZSA9IGF3YWl0IHZlcmlmaWVyLnZlcmlmeShhY3Rpb24sIHRydWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IG5ld1JlcXVlc3QgPSB7IC4uLnJlcXVlc3QgfTtcbiAgICBpZiAoYWN0aW9uID09PSBcIm1mYVNtc0Vucm9sbG1lbnRcIiAvKiBSZWNhcHRjaGFBY3Rpb25OYW1lLk1GQV9TTVNfRU5ST0xMTUVOVCAqLyB8fFxuICAgICAgICBhY3Rpb24gPT09IFwibWZhU21zU2lnbkluXCIgLyogUmVjYXB0Y2hhQWN0aW9uTmFtZS5NRkFfU01TX1NJR05JTiAqLykge1xuICAgICAgICBpZiAoJ3Bob25lRW5yb2xsbWVudEluZm8nIGluIG5ld1JlcXVlc3QpIHtcbiAgICAgICAgICAgIGNvbnN0IHBob25lTnVtYmVyID0gbmV3UmVxdWVzdC5waG9uZUVucm9sbG1lbnRJbmZvLnBob25lTnVtYmVyO1xuICAgICAgICAgICAgY29uc3QgcmVjYXB0Y2hhVG9rZW4gPSBuZXdSZXF1ZXN0LnBob25lRW5yb2xsbWVudEluZm8ucmVjYXB0Y2hhVG9rZW47XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKG5ld1JlcXVlc3QsIHtcbiAgICAgICAgICAgICAgICAncGhvbmVFbnJvbGxtZW50SW5mbyc6IHtcbiAgICAgICAgICAgICAgICAgICAgcGhvbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgIHJlY2FwdGNoYVRva2VuLFxuICAgICAgICAgICAgICAgICAgICBjYXB0Y2hhUmVzcG9uc2UsXG4gICAgICAgICAgICAgICAgICAgICdjbGllbnRUeXBlJzogXCJDTElFTlRfVFlQRV9XRUJcIiAvKiBSZWNhcHRjaGFDbGllbnRUeXBlLldFQiAqLyxcbiAgICAgICAgICAgICAgICAgICAgJ3JlY2FwdGNoYVZlcnNpb24nOiBcIlJFQ0FQVENIQV9FTlRFUlBSSVNFXCIgLyogUmVjYXB0Y2hhVmVyc2lvbi5FTlRFUlBSSVNFICovXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoJ3Bob25lU2lnbkluSW5mbycgaW4gbmV3UmVxdWVzdCkge1xuICAgICAgICAgICAgY29uc3QgcmVjYXB0Y2hhVG9rZW4gPSBuZXdSZXF1ZXN0LnBob25lU2lnbkluSW5mby5yZWNhcHRjaGFUb2tlbjtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24obmV3UmVxdWVzdCwge1xuICAgICAgICAgICAgICAgICdwaG9uZVNpZ25JbkluZm8nOiB7XG4gICAgICAgICAgICAgICAgICAgIHJlY2FwdGNoYVRva2VuLFxuICAgICAgICAgICAgICAgICAgICBjYXB0Y2hhUmVzcG9uc2UsXG4gICAgICAgICAgICAgICAgICAgICdjbGllbnRUeXBlJzogXCJDTElFTlRfVFlQRV9XRUJcIiAvKiBSZWNhcHRjaGFDbGllbnRUeXBlLldFQiAqLyxcbiAgICAgICAgICAgICAgICAgICAgJ3JlY2FwdGNoYVZlcnNpb24nOiBcIlJFQ0FQVENIQV9FTlRFUlBSSVNFXCIgLyogUmVjYXB0Y2hhVmVyc2lvbi5FTlRFUlBSSVNFICovXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ld1JlcXVlc3Q7XG4gICAgfVxuICAgIGlmICghaXNDYXB0Y2hhUmVzcCkge1xuICAgICAgICBPYmplY3QuYXNzaWduKG5ld1JlcXVlc3QsIHsgY2FwdGNoYVJlc3BvbnNlIH0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgT2JqZWN0LmFzc2lnbihuZXdSZXF1ZXN0LCB7ICdjYXB0Y2hhUmVzcCc6IGNhcHRjaGFSZXNwb25zZSB9KTtcbiAgICB9XG4gICAgT2JqZWN0LmFzc2lnbihuZXdSZXF1ZXN0LCB7ICdjbGllbnRUeXBlJzogXCJDTElFTlRfVFlQRV9XRUJcIiAvKiBSZWNhcHRjaGFDbGllbnRUeXBlLldFQiAqLyB9KTtcbiAgICBPYmplY3QuYXNzaWduKG5ld1JlcXVlc3QsIHtcbiAgICAgICAgJ3JlY2FwdGNoYVZlcnNpb24nOiBcIlJFQ0FQVENIQV9FTlRFUlBSSVNFXCIgLyogUmVjYXB0Y2hhVmVyc2lvbi5FTlRFUlBSSVNFICovXG4gICAgfSk7XG4gICAgcmV0dXJuIG5ld1JlcXVlc3Q7XG59XG5hc3luYyBmdW5jdGlvbiBoYW5kbGVSZWNhcHRjaGFGbG93KGF1dGhJbnN0YW5jZSwgcmVxdWVzdCwgYWN0aW9uTmFtZSwgYWN0aW9uTWV0aG9kLCByZWNhcHRjaGFBdXRoUHJvdmlkZXIpIHtcbiAgICBpZiAocmVjYXB0Y2hhQXV0aFByb3ZpZGVyID09PSBcIkVNQUlMX1BBU1NXT1JEX1BST1ZJREVSXCIgLyogUmVjYXB0Y2hhQXV0aFByb3ZpZGVyLkVNQUlMX1BBU1NXT1JEX1BST1ZJREVSICovKSB7XG4gICAgICAgIGlmIChhdXRoSW5zdGFuY2VcbiAgICAgICAgICAgIC5fZ2V0UmVjYXB0Y2hhQ29uZmlnKClcbiAgICAgICAgICAgID8uaXNQcm92aWRlckVuYWJsZWQoXCJFTUFJTF9QQVNTV09SRF9QUk9WSURFUlwiIC8qIFJlY2FwdGNoYUF1dGhQcm92aWRlci5FTUFJTF9QQVNTV09SRF9QUk9WSURFUiAqLykpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RXaXRoUmVjYXB0Y2hhID0gYXdhaXQgaW5qZWN0UmVjYXB0Y2hhRmllbGRzKGF1dGhJbnN0YW5jZSwgcmVxdWVzdCwgYWN0aW9uTmFtZSwgYWN0aW9uTmFtZSA9PT0gXCJnZXRPb2JDb2RlXCIgLyogUmVjYXB0Y2hhQWN0aW9uTmFtZS5HRVRfT09CX0NPREUgKi8pO1xuICAgICAgICAgICAgcmV0dXJuIGFjdGlvbk1ldGhvZChhdXRoSW5zdGFuY2UsIHJlcXVlc3RXaXRoUmVjYXB0Y2hhKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBhY3Rpb25NZXRob2QoYXV0aEluc3RhbmNlLCByZXF1ZXN0KS5jYXRjaChhc3luYyAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IuY29kZSA9PT0gYGF1dGgvJHtcIm1pc3NpbmctcmVjYXB0Y2hhLXRva2VuXCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX1JFQ0FQVENIQV9UT0tFTiAqL31gKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAke2FjdGlvbk5hbWV9IGlzIHByb3RlY3RlZCBieSByZUNBUFRDSEEgRW50ZXJwcmlzZSBmb3IgdGhpcyBwcm9qZWN0LiBBdXRvbWF0aWNhbGx5IHRyaWdnZXJpbmcgdGhlIHJlQ0FQVENIQSBmbG93IGFuZCByZXN0YXJ0aW5nIHRoZSBmbG93LmApO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXF1ZXN0V2l0aFJlY2FwdGNoYSA9IGF3YWl0IGluamVjdFJlY2FwdGNoYUZpZWxkcyhhdXRoSW5zdGFuY2UsIHJlcXVlc3QsIGFjdGlvbk5hbWUsIGFjdGlvbk5hbWUgPT09IFwiZ2V0T29iQ29kZVwiIC8qIFJlY2FwdGNoYUFjdGlvbk5hbWUuR0VUX09PQl9DT0RFICovKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbk1ldGhvZChhdXRoSW5zdGFuY2UsIHJlcXVlc3RXaXRoUmVjYXB0Y2hhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAocmVjYXB0Y2hhQXV0aFByb3ZpZGVyID09PSBcIlBIT05FX1BST1ZJREVSXCIgLyogUmVjYXB0Y2hhQXV0aFByb3ZpZGVyLlBIT05FX1BST1ZJREVSICovKSB7XG4gICAgICAgIGlmIChhdXRoSW5zdGFuY2VcbiAgICAgICAgICAgIC5fZ2V0UmVjYXB0Y2hhQ29uZmlnKClcbiAgICAgICAgICAgID8uaXNQcm92aWRlckVuYWJsZWQoXCJQSE9ORV9QUk9WSURFUlwiIC8qIFJlY2FwdGNoYUF1dGhQcm92aWRlci5QSE9ORV9QUk9WSURFUiAqLykpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RXaXRoUmVjYXB0Y2hhID0gYXdhaXQgaW5qZWN0UmVjYXB0Y2hhRmllbGRzKGF1dGhJbnN0YW5jZSwgcmVxdWVzdCwgYWN0aW9uTmFtZSk7XG4gICAgICAgICAgICByZXR1cm4gYWN0aW9uTWV0aG9kKGF1dGhJbnN0YW5jZSwgcmVxdWVzdFdpdGhSZWNhcHRjaGEpLmNhdGNoKGFzeW5jIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChhdXRoSW5zdGFuY2VcbiAgICAgICAgICAgICAgICAgICAgLl9nZXRSZWNhcHRjaGFDb25maWcoKVxuICAgICAgICAgICAgICAgICAgICA/LmdldFByb3ZpZGVyRW5mb3JjZW1lbnRTdGF0ZShcIlBIT05FX1BST1ZJREVSXCIgLyogUmVjYXB0Y2hhQXV0aFByb3ZpZGVyLlBIT05FX1BST1ZJREVSICovKSA9PT0gXCJBVURJVFwiIC8qIEVuZm9yY2VtZW50U3RhdGUuQVVESVQgKi8pIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQVVESVQgbW9kZVxuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3IuY29kZSA9PT0gYGF1dGgvJHtcIm1pc3NpbmctcmVjYXB0Y2hhLXRva2VuXCIgLyogQXV0aEVycm9yQ29kZS5NSVNTSU5HX1JFQ0FQVENIQV9UT0tFTiAqL31gIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvci5jb2RlID09PSBgYXV0aC8ke1wiaW52YWxpZC1hcHAtY3JlZGVudGlhbFwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9BUFBfQ1JFREVOVElBTCAqL31gKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgRmFpbGVkIHRvIHZlcmlmeSB3aXRoIHJlQ0FQVENIQSBFbnRlcnByaXNlLiBBdXRvbWF0aWNhbGx5IHRyaWdnZXJpbmcgdGhlIHJlQ0FQVENIQSB2MiBmbG93IHRvIGNvbXBsZXRlIHRoZSAke2FjdGlvbk5hbWV9IGZsb3cuYCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyByZUNBUFRDSEEgRW50ZXJwcmlzZSB0b2tlbiBpcyBtaXNzaW5nIG9yIHJlQ0FQVENIQSBFbnRlcnByaXNlIHRva2VuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBmYWlscy5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZhbGxiYWNrIHRvIHJlQ0FQVENIQSB2MiBmbG93LlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVxdWVzdFdpdGhSZWNhcHRjaGFGaWVsZHMgPSBhd2FpdCBpbmplY3RSZWNhcHRjaGFGaWVsZHMoYXV0aEluc3RhbmNlLCByZXF1ZXN0LCBhY3Rpb25OYW1lLCBmYWxzZSwgLy8gaXNDYXB0Y2hhUmVzcFxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSAvLyBpc0Zha2VUb2tlblxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgd2lsbCBjYWxsIHRoZSBQaG9uZUFwaUNhbGxlciB0byBmZXRjaCBhbmQgaW5qZWN0IHJlQ0FQVENIQSB2MiB0b2tlbi5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25NZXRob2QoYXV0aEluc3RhbmNlLCByZXF1ZXN0V2l0aFJlY2FwdGNoYUZpZWxkcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gRU5GT1JDRSBtb2RlIG9yIEFVRElUIG1vZGUgd2l0aCBhbnkgb3RoZXIgZXJyb3IuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gRG8gcmVDQVBUQ0hBIHYyIGZsb3cuXG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0V2l0aFJlY2FwdGNoYUZpZWxkcyA9IGF3YWl0IGluamVjdFJlY2FwdGNoYUZpZWxkcyhhdXRoSW5zdGFuY2UsIHJlcXVlc3QsIGFjdGlvbk5hbWUsIGZhbHNlLCAvLyBpc0NhcHRjaGFSZXNwXG4gICAgICAgICAgICB0cnVlIC8vIGlzRmFrZVRva2VuXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgLy8gVGhpcyB3aWxsIGNhbGwgdGhlIFBob25lQXBpQ2FsbGVyIHRvIGZldGNoIGFuZCBpbmplY3QgdjIgdG9rZW4uXG4gICAgICAgICAgICByZXR1cm4gYWN0aW9uTWV0aG9kKGF1dGhJbnN0YW5jZSwgcmVxdWVzdFdpdGhSZWNhcHRjaGFGaWVsZHMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVjYXB0Y2hhQXV0aFByb3ZpZGVyICsgJyBwcm92aWRlciBpcyBub3Qgc3VwcG9ydGVkLicpO1xuICAgIH1cbn1cbmFzeW5jIGZ1bmN0aW9uIF9pbml0aWFsaXplUmVjYXB0Y2hhQ29uZmlnKGF1dGgpIHtcbiAgICBjb25zdCBhdXRoSW50ZXJuYWwgPSBfY2FzdEF1dGgoYXV0aCk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXRSZWNhcHRjaGFDb25maWcoYXV0aEludGVybmFsLCB7XG4gICAgICAgIGNsaWVudFR5cGU6IFwiQ0xJRU5UX1RZUEVfV0VCXCIgLyogUmVjYXB0Y2hhQ2xpZW50VHlwZS5XRUIgKi8sXG4gICAgICAgIHZlcnNpb246IFwiUkVDQVBUQ0hBX0VOVEVSUFJJU0VcIiAvKiBSZWNhcHRjaGFWZXJzaW9uLkVOVEVSUFJJU0UgKi9cbiAgICB9KTtcbiAgICBjb25zdCBjb25maWcgPSBuZXcgUmVjYXB0Y2hhQ29uZmlnKHJlc3BvbnNlKTtcbiAgICBpZiAoYXV0aEludGVybmFsLnRlbmFudElkID09IG51bGwpIHtcbiAgICAgICAgYXV0aEludGVybmFsLl9hZ2VudFJlY2FwdGNoYUNvbmZpZyA9IGNvbmZpZztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGF1dGhJbnRlcm5hbC5fdGVuYW50UmVjYXB0Y2hhQ29uZmlnc1thdXRoSW50ZXJuYWwudGVuYW50SWRdID0gY29uZmlnO1xuICAgIH1cbiAgICBpZiAoY29uZmlnLmlzQW55UHJvdmlkZXJFbmFibGVkKCkpIHtcbiAgICAgICAgY29uc3QgdmVyaWZpZXIgPSBuZXcgUmVjYXB0Y2hhRW50ZXJwcmlzZVZlcmlmaWVyKGF1dGhJbnRlcm5hbCk7XG4gICAgICAgIHZvaWQgdmVyaWZpZXIudmVyaWZ5KCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBJbml0aWFsaXplcyBhbiB7QGxpbmsgQXV0aH0gaW5zdGFuY2Ugd2l0aCBmaW5lLWdyYWluZWQgY29udHJvbCBvdmVyXG4gKiB7QGxpbmsgRGVwZW5kZW5jaWVzfS5cbiAqXG4gKiBAcmVtYXJrc1xuICpcbiAqIFRoaXMgZnVuY3Rpb24gYWxsb3dzIG1vcmUgY29udHJvbCBvdmVyIHRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UgdGhhblxuICoge0BsaW5rIGdldEF1dGh9LiBgZ2V0QXV0aGAgdXNlcyBwbGF0Zm9ybS1zcGVjaWZpYyBkZWZhdWx0cyB0byBzdXBwbHlcbiAqIHRoZSB7QGxpbmsgRGVwZW5kZW5jaWVzfS4gSW4gZ2VuZXJhbCwgYGdldEF1dGhgIGlzIHRoZSBlYXNpZXN0IHdheSB0b1xuICogaW5pdGlhbGl6ZSBBdXRoIGFuZCB3b3JrcyBmb3IgbW9zdCB1c2UgY2FzZXMuIFVzZSBgaW5pdGlhbGl6ZUF1dGhgIGlmIHlvdVxuICogbmVlZCBjb250cm9sIG92ZXIgd2hpY2ggcGVyc2lzdGVuY2UgbGF5ZXIgaXMgdXNlZCwgb3IgdG8gbWluaW1pemUgYnVuZGxlXG4gKiBzaXplIGlmIHlvdSdyZSBub3QgdXNpbmcgZWl0aGVyIGBzaWduSW5XaXRoUG9wdXBgIG9yIGBzaWduSW5XaXRoUmVkaXJlY3RgLlxuICpcbiAqIEZvciBleGFtcGxlLCBpZiB5b3VyIGFwcCBvbmx5IHVzZXMgYW5vbnltb3VzIGFjY291bnRzIGFuZCB5b3Ugb25seSB3YW50XG4gKiBhY2NvdW50cyBzYXZlZCBmb3IgdGhlIGN1cnJlbnQgc2Vzc2lvbiwgaW5pdGlhbGl6ZSBgQXV0aGAgd2l0aDpcbiAqXG4gKiBgYGBqc1xuICogY29uc3QgYXV0aCA9IGluaXRpYWxpemVBdXRoKGFwcCwge1xuICogICBwZXJzaXN0ZW5jZTogYnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZSxcbiAqICAgcG9wdXBSZWRpcmVjdFJlc29sdmVyOiB1bmRlZmluZWQsXG4gKiB9KTtcbiAqIGBgYFxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZnVuY3Rpb24gaW5pdGlhbGl6ZUF1dGgoYXBwLCBkZXBzKSB7XG4gICAgY29uc3QgcHJvdmlkZXIgPSBfZ2V0UHJvdmlkZXIoYXBwLCAnYXV0aCcpO1xuICAgIGlmIChwcm92aWRlci5pc0luaXRpYWxpemVkKCkpIHtcbiAgICAgICAgY29uc3QgYXV0aCA9IHByb3ZpZGVyLmdldEltbWVkaWF0ZSgpO1xuICAgICAgICBjb25zdCBpbml0aWFsT3B0aW9ucyA9IHByb3ZpZGVyLmdldE9wdGlvbnMoKTtcbiAgICAgICAgaWYgKGRlZXBFcXVhbChpbml0aWFsT3B0aW9ucywgZGVwcyA/PyB7fSkpIHtcbiAgICAgICAgICAgIHJldHVybiBhdXRoO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgX2ZhaWwoYXV0aCwgXCJhbHJlYWR5LWluaXRpYWxpemVkXCIgLyogQXV0aEVycm9yQ29kZS5BTFJFQURZX0lOSVRJQUxJWkVEICovKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBhdXRoID0gcHJvdmlkZXIuaW5pdGlhbGl6ZSh7IG9wdGlvbnM6IGRlcHMgfSk7XG4gICAgcmV0dXJuIGF1dGg7XG59XG5mdW5jdGlvbiBfaW5pdGlhbGl6ZUF1dGhJbnN0YW5jZShhdXRoLCBkZXBzKSB7XG4gICAgY29uc3QgcGVyc2lzdGVuY2UgPSBkZXBzPy5wZXJzaXN0ZW5jZSB8fCBbXTtcbiAgICBjb25zdCBoaWVyYXJjaHkgPSAoQXJyYXkuaXNBcnJheShwZXJzaXN0ZW5jZSkgPyBwZXJzaXN0ZW5jZSA6IFtwZXJzaXN0ZW5jZV0pLm1hcChfZ2V0SW5zdGFuY2UpO1xuICAgIGlmIChkZXBzPy5lcnJvck1hcCkge1xuICAgICAgICBhdXRoLl91cGRhdGVFcnJvck1hcChkZXBzLmVycm9yTWFwKTtcbiAgICB9XG4gICAgLy8gVGhpcyBwcm9taXNlIGlzIGludGVuZGVkIHRvIGZsb2F0OyBhdXRoIGluaXRpYWxpemF0aW9uIGhhcHBlbnMgaW4gdGhlXG4gICAgLy8gYmFja2dyb3VuZCwgbWVhbndoaWxlIHRoZSBhdXRoIG9iamVjdCBtYXkgYmUgdXNlZCBieSB0aGUgYXBwLlxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgICBhdXRoLl9pbml0aWFsaXplV2l0aFBlcnNpc3RlbmNlKGhpZXJhcmNoeSwgZGVwcz8ucG9wdXBSZWRpcmVjdFJlc29sdmVyKTtcbn1cblxuLyoqXG4gKiBDaGFuZ2VzIHRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UgdG8gY29tbXVuaWNhdGUgd2l0aCB0aGUgRmlyZWJhc2UgQXV0aCBFbXVsYXRvciwgaW5zdGVhZCBvZiBwcm9kdWN0aW9uXG4gKiBGaXJlYmFzZSBBdXRoIHNlcnZpY2VzLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUaGlzIG11c3QgYmUgY2FsbGVkIHN5bmNocm9ub3VzbHkgaW1tZWRpYXRlbHkgZm9sbG93aW5nIHRoZSBmaXJzdCBjYWxsIHRvXG4gKiB7QGxpbmsgaW5pdGlhbGl6ZUF1dGh9LiAgRG8gbm90IHVzZSB3aXRoIHByb2R1Y3Rpb24gY3JlZGVudGlhbHMgYXMgZW11bGF0b3JcbiAqIHRyYWZmaWMgaXMgbm90IGVuY3J5cHRlZC5cbiAqXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIGNvbm5lY3RBdXRoRW11bGF0b3IoYXV0aCwgJ2h0dHA6Ly8xMjcuMC4wLjE6OTA5OScsIHsgZGlzYWJsZVdhcm5pbmdzOiB0cnVlIH0pO1xuICogYGBgXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIHVybCAtIFRoZSBVUkwgYXQgd2hpY2ggdGhlIGVtdWxhdG9yIGlzIHJ1bm5pbmcgKGVnLCAnaHR0cDovL2xvY2FsaG9zdDo5MDk5JykuXG4gKiBAcGFyYW0gb3B0aW9ucyAtIE9wdGlvbmFsLiBgb3B0aW9ucy5kaXNhYmxlV2FybmluZ3NgIGRlZmF1bHRzIHRvIGBmYWxzZWAuIFNldCBpdCB0b1xuICogYHRydWVgIHRvIGRpc2FibGUgdGhlIHdhcm5pbmcgYmFubmVyIGF0dGFjaGVkIHRvIHRoZSBET00uXG4gKlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiBjb25uZWN0QXV0aEVtdWxhdG9yKGF1dGgsIHVybCwgb3B0aW9ucykge1xuICAgIGNvbnN0IGF1dGhJbnRlcm5hbCA9IF9jYXN0QXV0aChhdXRoKTtcbiAgICBfYXNzZXJ0KC9eaHR0cHM/OlxcL1xcLy8udGVzdCh1cmwpLCBhdXRoSW50ZXJuYWwsIFwiaW52YWxpZC1lbXVsYXRvci1zY2hlbWVcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfRU1VTEFUT1JfU0NIRU1FICovKTtcbiAgICBjb25zdCBkaXNhYmxlV2FybmluZ3MgPSAhIW9wdGlvbnM/LmRpc2FibGVXYXJuaW5ncztcbiAgICBjb25zdCBwcm90b2NvbCA9IGV4dHJhY3RQcm90b2NvbCh1cmwpO1xuICAgIGNvbnN0IHsgaG9zdCwgcG9ydCB9ID0gZXh0cmFjdEhvc3RBbmRQb3J0KHVybCk7XG4gICAgY29uc3QgcG9ydFN0ciA9IHBvcnQgPT09IG51bGwgPyAnJyA6IGA6JHtwb3J0fWA7XG4gICAgLy8gQWx3YXlzIHJlcGxhY2UgcGF0aCB3aXRoIFwiL1wiIChldmVuIGlmIGlucHV0IHVybCBoYWQgbm8gcGF0aCBhdCBhbGwsIG9yIGhhZCBhIGRpZmZlcmVudCBvbmUpLlxuICAgIGNvbnN0IGVtdWxhdG9yID0geyB1cmw6IGAke3Byb3RvY29sfS8vJHtob3N0fSR7cG9ydFN0cn0vYCB9O1xuICAgIGNvbnN0IGVtdWxhdG9yQ29uZmlnID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgICAgIGhvc3QsXG4gICAgICAgIHBvcnQsXG4gICAgICAgIHByb3RvY29sOiBwcm90b2NvbC5yZXBsYWNlKCc6JywgJycpLFxuICAgICAgICBvcHRpb25zOiBPYmplY3QuZnJlZXplKHsgZGlzYWJsZVdhcm5pbmdzIH0pXG4gICAgfSk7XG4gICAgLy8gVGhlcmUgYXJlIGEgZmV3IHNjZW5hcmlvcyB0byBndWFyZCBhZ2FpbnN0IGlmIHRoZSBBdXRoIGluc3RhbmNlIGhhcyBhbHJlYWR5IHN0YXJ0ZWQ6XG4gICAgaWYgKCFhdXRoSW50ZXJuYWwuX2NhbkluaXRFbXVsYXRvcikge1xuICAgICAgICAvLyBBcHBsaWNhdGlvbnMgbWF5IG5vdCBpbml0aWFsaXplIHRoZSBlbXVsYXRvciBmb3IgdGhlIGZpcnN0IHRpbWUgaWYgQXV0aCBoYXMgYWxyZWFkeSBzdGFydGVkXG4gICAgICAgIC8vIHRvIG1ha2UgbmV0d29yayByZXF1ZXN0cy5cbiAgICAgICAgX2Fzc2VydChhdXRoSW50ZXJuYWwuY29uZmlnLmVtdWxhdG9yICYmIGF1dGhJbnRlcm5hbC5lbXVsYXRvckNvbmZpZywgYXV0aEludGVybmFsLCBcImVtdWxhdG9yLWNvbmZpZy1mYWlsZWRcIiAvKiBBdXRoRXJyb3JDb2RlLkVNVUxBVE9SX0NPTkZJR19GQUlMRUQgKi8pO1xuICAgICAgICAvLyBBcHBsaWNhdGlvbnMgbWF5IG5vdCBhbHRlciB0aGUgY29uZmlndXJhdGlvbiBvZiB0aGUgZW11bGF0b3IgKGFrYSBwYXNzIGEgZGlmZmVyZW50IGNvbmZpZylcbiAgICAgICAgLy8gb25jZSBBdXRoIGhhcyBzdGFydGVkIHRvIG1ha2UgbmV0d29yayByZXF1ZXN0cy5cbiAgICAgICAgX2Fzc2VydChkZWVwRXF1YWwoZW11bGF0b3IsIGF1dGhJbnRlcm5hbC5jb25maWcuZW11bGF0b3IpICYmXG4gICAgICAgICAgICBkZWVwRXF1YWwoZW11bGF0b3JDb25maWcsIGF1dGhJbnRlcm5hbC5lbXVsYXRvckNvbmZpZyksIGF1dGhJbnRlcm5hbCwgXCJlbXVsYXRvci1jb25maWctZmFpbGVkXCIgLyogQXV0aEVycm9yQ29kZS5FTVVMQVRPUl9DT05GSUdfRkFJTEVEICovKTtcbiAgICAgICAgLy8gSXQncyB2YWxpZCwgaG93ZXZlciwgdG8gaW52b2tlIGNvbm5lY3RBdXRoRW11bGF0b3IoKSBhZnRlciBBdXRoIGhhcyBzdGFydGVkIG1ha2luZ1xuICAgICAgICAvLyBjb25uZWN0aW9ucywgc28gbG9uZyBhcyB0aGUgY29uZmlnIG1hdGNoZXMgdGhlIGV4aXN0aW5nIGNvbmZpZy4gVGhpcyByZXN1bHRzIGluIGEgbm8tb3AuXG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgYXV0aEludGVybmFsLmNvbmZpZy5lbXVsYXRvciA9IGVtdWxhdG9yO1xuICAgIGF1dGhJbnRlcm5hbC5lbXVsYXRvckNvbmZpZyA9IGVtdWxhdG9yQ29uZmlnO1xuICAgIGF1dGhJbnRlcm5hbC5zZXR0aW5ncy5hcHBWZXJpZmljYXRpb25EaXNhYmxlZEZvclRlc3RpbmcgPSB0cnVlO1xuICAgIC8vIFdvcmthcm91bmQgdG8gZ2V0IGNvb2tpZXMgaW4gRmlyZWJhc2UgU3R1ZGlvXG4gICAgaWYgKGlzQ2xvdWRXb3Jrc3RhdGlvbihob3N0KSkge1xuICAgICAgICB2b2lkIHBpbmdTZXJ2ZXIoYCR7cHJvdG9jb2x9Ly8ke2hvc3R9JHtwb3J0U3RyfWApO1xuICAgICAgICB1cGRhdGVFbXVsYXRvckJhbm5lcignQXV0aCcsIHRydWUpO1xuICAgIH1cbiAgICBlbHNlIGlmICghZGlzYWJsZVdhcm5pbmdzKSB7XG4gICAgICAgIGVtaXRFbXVsYXRvcldhcm5pbmcoKTtcbiAgICB9XG59XG5mdW5jdGlvbiBleHRyYWN0UHJvdG9jb2wodXJsKSB7XG4gICAgY29uc3QgcHJvdG9jb2xFbmQgPSB1cmwuaW5kZXhPZignOicpO1xuICAgIHJldHVybiBwcm90b2NvbEVuZCA8IDAgPyAnJyA6IHVybC5zdWJzdHIoMCwgcHJvdG9jb2xFbmQgKyAxKTtcbn1cbmZ1bmN0aW9uIGV4dHJhY3RIb3N0QW5kUG9ydCh1cmwpIHtcbiAgICBjb25zdCBwcm90b2NvbCA9IGV4dHJhY3RQcm90b2NvbCh1cmwpO1xuICAgIGNvbnN0IGF1dGhvcml0eSA9IC8oXFwvXFwvKT8oW14/Iy9dKykvLmV4ZWModXJsLnN1YnN0cihwcm90b2NvbC5sZW5ndGgpKTsgLy8gQmV0d2VlbiAvLyBhbmQgLywgPyBvciAjLlxuICAgIGlmICghYXV0aG9yaXR5KSB7XG4gICAgICAgIHJldHVybiB7IGhvc3Q6ICcnLCBwb3J0OiBudWxsIH07XG4gICAgfVxuICAgIGNvbnN0IGhvc3RBbmRQb3J0ID0gYXV0aG9yaXR5WzJdLnNwbGl0KCdAJykucG9wKCkgfHwgJyc7IC8vIFN0cmlwIG91dCBcInVzZXJuYW1lOnBhc3N3b3JkQFwiLlxuICAgIGNvbnN0IGJyYWNrZXRlZElQdjYgPSAvXihcXFtbXlxcXV0rXFxdKSg6fCQpLy5leGVjKGhvc3RBbmRQb3J0KTtcbiAgICBpZiAoYnJhY2tldGVkSVB2Nikge1xuICAgICAgICBjb25zdCBob3N0ID0gYnJhY2tldGVkSVB2NlsxXTtcbiAgICAgICAgcmV0dXJuIHsgaG9zdCwgcG9ydDogcGFyc2VQb3J0KGhvc3RBbmRQb3J0LnN1YnN0cihob3N0Lmxlbmd0aCArIDEpKSB9O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29uc3QgW2hvc3QsIHBvcnRdID0gaG9zdEFuZFBvcnQuc3BsaXQoJzonKTtcbiAgICAgICAgcmV0dXJuIHsgaG9zdCwgcG9ydDogcGFyc2VQb3J0KHBvcnQpIH07XG4gICAgfVxufVxuZnVuY3Rpb24gcGFyc2VQb3J0KHBvcnRTdHIpIHtcbiAgICBpZiAoIXBvcnRTdHIpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IHBvcnQgPSBOdW1iZXIocG9ydFN0cik7XG4gICAgaWYgKGlzTmFOKHBvcnQpKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gcG9ydDtcbn1cbmZ1bmN0aW9uIGVtaXRFbXVsYXRvcldhcm5pbmcoKSB7XG4gICAgZnVuY3Rpb24gYXR0YWNoQmFubmVyKCkge1xuICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICAgICAgY29uc3Qgc3R5ID0gZWwuc3R5bGU7XG4gICAgICAgIGVsLmlubmVyVGV4dCA9XG4gICAgICAgICAgICAnUnVubmluZyBpbiBlbXVsYXRvciBtb2RlLiBEbyBub3QgdXNlIHdpdGggcHJvZHVjdGlvbiBjcmVkZW50aWFscy4nO1xuICAgICAgICBzdHkucG9zaXRpb24gPSAnZml4ZWQnO1xuICAgICAgICBzdHkud2lkdGggPSAnMTAwJSc7XG4gICAgICAgIHN0eS5iYWNrZ3JvdW5kQ29sb3IgPSAnI2ZmZmZmZic7XG4gICAgICAgIHN0eS5ib3JkZXIgPSAnLjFlbSBzb2xpZCAjMDAwMDAwJztcbiAgICAgICAgc3R5LmNvbG9yID0gJyNiNTAwMDAnO1xuICAgICAgICBzdHkuYm90dG9tID0gJzBweCc7XG4gICAgICAgIHN0eS5sZWZ0ID0gJzBweCc7XG4gICAgICAgIHN0eS5tYXJnaW4gPSAnMHB4JztcbiAgICAgICAgc3R5LnpJbmRleCA9ICcxMDAwMCc7XG4gICAgICAgIHN0eS50ZXh0QWxpZ24gPSAnY2VudGVyJztcbiAgICAgICAgZWwuY2xhc3NMaXN0LmFkZCgnZmlyZWJhc2UtZW11bGF0b3Itd2FybmluZycpO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgY29uc29sZS5pbmZvID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGNvbnNvbGUuaW5mbygnV0FSTklORzogWW91IGFyZSB1c2luZyB0aGUgQXV0aCBFbXVsYXRvciwnICtcbiAgICAgICAgICAgICcgd2hpY2ggaXMgaW50ZW5kZWQgZm9yIGxvY2FsIHRlc3Rpbmcgb25seS4gIERvIG5vdCB1c2Ugd2l0aCcgK1xuICAgICAgICAgICAgJyBwcm9kdWN0aW9uIGNyZWRlbnRpYWxzLicpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2xvYWRpbmcnKSB7XG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGF0dGFjaEJhbm5lcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBhdHRhY2hCYW5uZXIoKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogSW50ZXJmYWNlIHRoYXQgcmVwcmVzZW50cyB0aGUgY3JlZGVudGlhbHMgcmV0dXJuZWQgYnkgYW4ge0BsaW5rIEF1dGhQcm92aWRlcn0uXG4gKlxuICogQHJlbWFya3NcbiAqIEltcGxlbWVudGF0aW9ucyBzcGVjaWZ5IHRoZSBkZXRhaWxzIGFib3V0IGVhY2ggYXV0aCBwcm92aWRlcidzIGNyZWRlbnRpYWwgcmVxdWlyZW1lbnRzLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuY2xhc3MgQXV0aENyZWRlbnRpYWwge1xuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgYXV0aGVudGljYXRpb24gcHJvdmlkZXIgSUQgZm9yIHRoZSBjcmVkZW50aWFsLlxuICAgICAqXG4gICAgICogQHJlbWFya3NcbiAgICAgKiBGb3IgZXhhbXBsZSwgJ2ZhY2Vib29rLmNvbScsIG9yICdnb29nbGUuY29tJy5cbiAgICAgKi9cbiAgICBwcm92aWRlcklkLCBcbiAgICAvKipcbiAgICAgKiBUaGUgYXV0aGVudGljYXRpb24gc2lnbiBpbiBtZXRob2QgZm9yIHRoZSBjcmVkZW50aWFsLlxuICAgICAqXG4gICAgICogQHJlbWFya3NcbiAgICAgKiBGb3IgZXhhbXBsZSwge0BsaW5rIFNpZ25Jbk1ldGhvZH0uRU1BSUxfUEFTU1dPUkQsIG9yXG4gICAgICoge0BsaW5rIFNpZ25Jbk1ldGhvZH0uRU1BSUxfTElOSy4gVGhpcyBjb3JyZXNwb25kcyB0byB0aGUgc2lnbi1pbiBtZXRob2RcbiAgICAgKiBpZGVudGlmaWVyIGFzIHJldHVybmVkIGluIHtAbGluayBmZXRjaFNpZ25Jbk1ldGhvZHNGb3JFbWFpbH0uXG4gICAgICovXG4gICAgc2lnbkluTWV0aG9kKSB7XG4gICAgICAgIHRoaXMucHJvdmlkZXJJZCA9IHByb3ZpZGVySWQ7XG4gICAgICAgIHRoaXMuc2lnbkluTWV0aG9kID0gc2lnbkluTWV0aG9kO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgSlNPTi1zZXJpYWxpemFibGUgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBhIEpTT04tc2VyaWFsaXphYmxlIHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgb2JqZWN0LlxuICAgICAqL1xuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIGRlYnVnRmFpbCgnbm90IGltcGxlbWVudGVkJyk7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBfZ2V0SWRUb2tlblJlc3BvbnNlKF9hdXRoKSB7XG4gICAgICAgIHJldHVybiBkZWJ1Z0ZhaWwoJ25vdCBpbXBsZW1lbnRlZCcpO1xuICAgIH1cbiAgICAvKiogQGludGVybmFsICovXG4gICAgX2xpbmtUb0lkVG9rZW4oX2F1dGgsIF9pZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBkZWJ1Z0ZhaWwoJ25vdCBpbXBsZW1lbnRlZCcpO1xuICAgIH1cbiAgICAvKiogQGludGVybmFsICovXG4gICAgX2dldFJlYXV0aGVudGljYXRpb25SZXNvbHZlcihfYXV0aCkge1xuICAgICAgICByZXR1cm4gZGVidWdGYWlsKCdub3QgaW1wbGVtZW50ZWQnKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5hc3luYyBmdW5jdGlvbiByZXNldFBhc3N3b3JkKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6cmVzZXRQYXNzd29yZFwiIC8qIEVuZHBvaW50LlJFU0VUX1BBU1NXT1JEICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xufVxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlRW1haWxQYXNzd29yZChhdXRoLCByZXF1ZXN0KSB7XG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBIdHRwTWV0aG9kLlBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnVwZGF0ZVwiIC8qIEVuZHBvaW50LlNFVF9BQ0NPVU5UX0lORk8gKi8sIHJlcXVlc3QpO1xufVxuLy8gVXNlZCBmb3IgbGlua2luZyBhbiBlbWFpbC9wYXNzd29yZCBhY2NvdW50IHRvIGFuIGV4aXN0aW5nIGlkVG9rZW4uIFVzZXMgdGhlIHNhbWUgcmVxdWVzdC9yZXNwb25zZVxuLy8gZm9ybWF0IGFzIHVwZGF0ZUVtYWlsUGFzc3dvcmQuXG5hc3luYyBmdW5jdGlvbiBsaW5rRW1haWxQYXNzd29yZChhdXRoLCByZXF1ZXN0KSB7XG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBIdHRwTWV0aG9kLlBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnNpZ25VcFwiIC8qIEVuZHBvaW50LlNJR05fVVAgKi8sIHJlcXVlc3QpO1xufVxuYXN5bmMgZnVuY3Rpb24gYXBwbHlBY3Rpb25Db2RlJDEoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92MS9hY2NvdW50czp1cGRhdGVcIiAvKiBFbmRwb2ludC5TRVRfQUNDT1VOVF9JTkZPICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aFBhc3N3b3JkKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1TaWduSW5SZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6c2lnbkluV2l0aFBhc3N3b3JkXCIgLyogRW5kcG9pbnQuU0lHTl9JTl9XSVRIX1BBU1NXT1JEICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xufVxuYXN5bmMgZnVuY3Rpb24gc2VuZE9vYkNvZGUoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92MS9hY2NvdW50czpzZW5kT29iQ29kZVwiIC8qIEVuZHBvaW50LlNFTkRfT09CX0NPREUgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XG59XG5hc3luYyBmdW5jdGlvbiBzZW5kRW1haWxWZXJpZmljYXRpb24kMShhdXRoLCByZXF1ZXN0KSB7XG4gICAgcmV0dXJuIHNlbmRPb2JDb2RlKGF1dGgsIHJlcXVlc3QpO1xufVxuYXN5bmMgZnVuY3Rpb24gc2VuZFBhc3N3b3JkUmVzZXRFbWFpbCQxKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gc2VuZE9vYkNvZGUoYXV0aCwgcmVxdWVzdCk7XG59XG5hc3luYyBmdW5jdGlvbiBzZW5kU2lnbkluTGlua1RvRW1haWwkMShhdXRoLCByZXF1ZXN0KSB7XG4gICAgcmV0dXJuIHNlbmRPb2JDb2RlKGF1dGgsIHJlcXVlc3QpO1xufVxuYXN5bmMgZnVuY3Rpb24gdmVyaWZ5QW5kQ2hhbmdlRW1haWwoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBzZW5kT29iQ29kZShhdXRoLCByZXF1ZXN0KTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHNpZ25JbldpdGhFbWFpbExpbmskMShhdXRoLCByZXF1ZXN0KSB7XG4gICAgcmV0dXJuIF9wZXJmb3JtU2lnbkluUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBIdHRwTWV0aG9kLlBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnNpZ25JbldpdGhFbWFpbExpbmtcIiAvKiBFbmRwb2ludC5TSUdOX0lOX1dJVEhfRU1BSUxfTElOSyAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHNpZ25JbldpdGhFbWFpbExpbmtGb3JMaW5raW5nKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1TaWduSW5SZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6c2lnbkluV2l0aEVtYWlsTGlua1wiIC8qIEVuZHBvaW50LlNJR05fSU5fV0lUSF9FTUFJTF9MSU5LICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBJbnRlcmZhY2UgdGhhdCByZXByZXNlbnRzIHRoZSBjcmVkZW50aWFscyByZXR1cm5lZCBieSB7QGxpbmsgRW1haWxBdXRoUHJvdmlkZXJ9IGZvclxuICoge0BsaW5rIFByb3ZpZGVySWR9LlBBU1NXT1JEXG4gKlxuICogQHJlbWFya3NcbiAqIENvdmVycyBib3RoIHtAbGluayBTaWduSW5NZXRob2R9LkVNQUlMX1BBU1NXT1JEIGFuZFxuICoge0BsaW5rIFNpZ25Jbk1ldGhvZH0uRU1BSUxfTElOSy5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmNsYXNzIEVtYWlsQXV0aENyZWRlbnRpYWwgZXh0ZW5kcyBBdXRoQ3JlZGVudGlhbCB7XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBfZW1haWwsIFxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBfcGFzc3dvcmQsIHNpZ25Jbk1ldGhvZCwgXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIF90ZW5hbnRJZCA9IG51bGwpIHtcbiAgICAgICAgc3VwZXIoXCJwYXNzd29yZFwiIC8qIFByb3ZpZGVySWQuUEFTU1dPUkQgKi8sIHNpZ25Jbk1ldGhvZCk7XG4gICAgICAgIHRoaXMuX2VtYWlsID0gX2VtYWlsO1xuICAgICAgICB0aGlzLl9wYXNzd29yZCA9IF9wYXNzd29yZDtcbiAgICAgICAgdGhpcy5fdGVuYW50SWQgPSBfdGVuYW50SWQ7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBzdGF0aWMgX2Zyb21FbWFpbEFuZFBhc3N3b3JkKGVtYWlsLCBwYXNzd29yZCkge1xuICAgICAgICByZXR1cm4gbmV3IEVtYWlsQXV0aENyZWRlbnRpYWwoZW1haWwsIHBhc3N3b3JkLCBcInBhc3N3b3JkXCIgLyogU2lnbkluTWV0aG9kLkVNQUlMX1BBU1NXT1JEICovKTtcbiAgICB9XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIHN0YXRpYyBfZnJvbUVtYWlsQW5kQ29kZShlbWFpbCwgb29iQ29kZSwgdGVuYW50SWQgPSBudWxsKSB7XG4gICAgICAgIHJldHVybiBuZXcgRW1haWxBdXRoQ3JlZGVudGlhbChlbWFpbCwgb29iQ29kZSwgXCJlbWFpbExpbmtcIiAvKiBTaWduSW5NZXRob2QuRU1BSUxfTElOSyAqLywgdGVuYW50SWQpO1xuICAgIH1cbiAgICAvKioge0Bpbmhlcml0ZG9jIEF1dGhDcmVkZW50aWFsLnRvSlNPTn0gKi9cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBlbWFpbDogdGhpcy5fZW1haWwsXG4gICAgICAgICAgICBwYXNzd29yZDogdGhpcy5fcGFzc3dvcmQsXG4gICAgICAgICAgICBzaWduSW5NZXRob2Q6IHRoaXMuc2lnbkluTWV0aG9kLFxuICAgICAgICAgICAgdGVuYW50SWQ6IHRoaXMuX3RlbmFudElkXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXRpYyBtZXRob2QgdG8gZGVzZXJpYWxpemUgYSBKU09OIHJlcHJlc2VudGF0aW9uIG9mIGFuIG9iamVjdCBpbnRvIGFuIHtAbGluayAgQXV0aENyZWRlbnRpYWx9LlxuICAgICAqXG4gICAgICogQHBhcmFtIGpzb24gLSBFaXRoZXIgYG9iamVjdGAgb3IgdGhlIHN0cmluZ2lmaWVkIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBvYmplY3QuIFdoZW4gc3RyaW5nIGlzXG4gICAgICogcHJvdmlkZWQsIGBKU09OLnBhcnNlYCB3b3VsZCBiZSBjYWxsZWQgZmlyc3QuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBJZiB0aGUgSlNPTiBpbnB1dCBkb2VzIG5vdCByZXByZXNlbnQgYW4ge0BsaW5rIEF1dGhDcmVkZW50aWFsfSwgbnVsbCBpcyByZXR1cm5lZC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbUpTT04oanNvbikge1xuICAgICAgICBjb25zdCBvYmogPSB0eXBlb2YganNvbiA9PT0gJ3N0cmluZycgPyBKU09OLnBhcnNlKGpzb24pIDoganNvbjtcbiAgICAgICAgaWYgKG9iaj8uZW1haWwgJiYgb2JqPy5wYXNzd29yZCkge1xuICAgICAgICAgICAgaWYgKG9iai5zaWduSW5NZXRob2QgPT09IFwicGFzc3dvcmRcIiAvKiBTaWduSW5NZXRob2QuRU1BSUxfUEFTU1dPUkQgKi8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZnJvbUVtYWlsQW5kUGFzc3dvcmQob2JqLmVtYWlsLCBvYmoucGFzc3dvcmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAob2JqLnNpZ25Jbk1ldGhvZCA9PT0gXCJlbWFpbExpbmtcIiAvKiBTaWduSW5NZXRob2QuRU1BSUxfTElOSyAqLykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9mcm9tRW1haWxBbmRDb2RlKG9iai5lbWFpbCwgb2JqLnBhc3N3b3JkLCBvYmoudGVuYW50SWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICAvKiogQGludGVybmFsICovXG4gICAgYXN5bmMgX2dldElkVG9rZW5SZXNwb25zZShhdXRoKSB7XG4gICAgICAgIHN3aXRjaCAodGhpcy5zaWduSW5NZXRob2QpIHtcbiAgICAgICAgICAgIGNhc2UgXCJwYXNzd29yZFwiIC8qIFNpZ25Jbk1ldGhvZC5FTUFJTF9QQVNTV09SRCAqLzpcbiAgICAgICAgICAgICAgICBjb25zdCByZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5TZWN1cmVUb2tlbjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuX2VtYWlsLFxuICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogdGhpcy5fcGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgICAgIGNsaWVudFR5cGU6IFwiQ0xJRU5UX1RZUEVfV0VCXCIgLyogUmVjYXB0Y2hhQ2xpZW50VHlwZS5XRUIgKi9cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHJldHVybiBoYW5kbGVSZWNhcHRjaGFGbG93KGF1dGgsIHJlcXVlc3QsIFwic2lnbkluV2l0aFBhc3N3b3JkXCIgLyogUmVjYXB0Y2hhQWN0aW9uTmFtZS5TSUdOX0lOX1dJVEhfUEFTU1dPUkQgKi8sIHNpZ25JbldpdGhQYXNzd29yZCwgXCJFTUFJTF9QQVNTV09SRF9QUk9WSURFUlwiIC8qIFJlY2FwdGNoYUF1dGhQcm92aWRlci5FTUFJTF9QQVNTV09SRF9QUk9WSURFUiAqLyk7XG4gICAgICAgICAgICBjYXNlIFwiZW1haWxMaW5rXCIgLyogU2lnbkluTWV0aG9kLkVNQUlMX0xJTksgKi86XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhFbWFpbExpbmskMShhdXRoLCB7XG4gICAgICAgICAgICAgICAgICAgIGVtYWlsOiB0aGlzLl9lbWFpbCxcbiAgICAgICAgICAgICAgICAgICAgb29iQ29kZTogdGhpcy5fcGFzc3dvcmRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgX2ZhaWwoYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBhc3luYyBfbGlua1RvSWRUb2tlbihhdXRoLCBpZFRva2VuKSB7XG4gICAgICAgIHN3aXRjaCAodGhpcy5zaWduSW5NZXRob2QpIHtcbiAgICAgICAgICAgIGNhc2UgXCJwYXNzd29yZFwiIC8qIFNpZ25Jbk1ldGhvZC5FTUFJTF9QQVNTV09SRCAqLzpcbiAgICAgICAgICAgICAgICBjb25zdCByZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgICAgICBpZFRva2VuLFxuICAgICAgICAgICAgICAgICAgICByZXR1cm5TZWN1cmVUb2tlbjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuX2VtYWlsLFxuICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogdGhpcy5fcGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgICAgIGNsaWVudFR5cGU6IFwiQ0xJRU5UX1RZUEVfV0VCXCIgLyogUmVjYXB0Y2hhQ2xpZW50VHlwZS5XRUIgKi9cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHJldHVybiBoYW5kbGVSZWNhcHRjaGFGbG93KGF1dGgsIHJlcXVlc3QsIFwic2lnblVwUGFzc3dvcmRcIiAvKiBSZWNhcHRjaGFBY3Rpb25OYW1lLlNJR05fVVBfUEFTU1dPUkQgKi8sIGxpbmtFbWFpbFBhc3N3b3JkLCBcIkVNQUlMX1BBU1NXT1JEX1BST1ZJREVSXCIgLyogUmVjYXB0Y2hhQXV0aFByb3ZpZGVyLkVNQUlMX1BBU1NXT1JEX1BST1ZJREVSICovKTtcbiAgICAgICAgICAgIGNhc2UgXCJlbWFpbExpbmtcIiAvKiBTaWduSW5NZXRob2QuRU1BSUxfTElOSyAqLzpcbiAgICAgICAgICAgICAgICByZXR1cm4gc2lnbkluV2l0aEVtYWlsTGlua0ZvckxpbmtpbmcoYXV0aCwge1xuICAgICAgICAgICAgICAgICAgICBpZFRva2VuLFxuICAgICAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy5fZW1haWwsXG4gICAgICAgICAgICAgICAgICAgIG9vYkNvZGU6IHRoaXMuX3Bhc3N3b3JkXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIF9mYWlsKGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKiogQGludGVybmFsICovXG4gICAgX2dldFJlYXV0aGVudGljYXRpb25SZXNvbHZlcihhdXRoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRJZFRva2VuUmVzcG9uc2UoYXV0aCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aElkcChhdXRoLCByZXF1ZXN0KSB7XG4gICAgcmV0dXJuIF9wZXJmb3JtU2lnbkluUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBIdHRwTWV0aG9kLlBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnNpZ25JbldpdGhJZHBcIiAvKiBFbmRwb2ludC5TSUdOX0lOX1dJVEhfSURQICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY29uc3QgSURQX1JFUVVFU1RfVVJJJDEgPSAnaHR0cDovL2xvY2FsaG9zdCc7XG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIE9BdXRoIGNyZWRlbnRpYWxzIHJldHVybmVkIGJ5IGFuIHtAbGluayBPQXV0aFByb3ZpZGVyfS5cbiAqXG4gKiBAcmVtYXJrc1xuICogSW1wbGVtZW50YXRpb25zIHNwZWNpZnkgdGhlIGRldGFpbHMgYWJvdXQgZWFjaCBhdXRoIHByb3ZpZGVyJ3MgY3JlZGVudGlhbCByZXF1aXJlbWVudHMuXG4gKlxuICogQHB1YmxpY1xuICovXG5jbGFzcyBPQXV0aENyZWRlbnRpYWwgZXh0ZW5kcyBBdXRoQ3JlZGVudGlhbCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKC4uLmFyZ3VtZW50cyk7XG4gICAgICAgIHRoaXMucGVuZGluZ1Rva2VuID0gbnVsbDtcbiAgICB9XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIHN0YXRpYyBfZnJvbVBhcmFtcyhwYXJhbXMpIHtcbiAgICAgICAgY29uc3QgY3JlZCA9IG5ldyBPQXV0aENyZWRlbnRpYWwocGFyYW1zLnByb3ZpZGVySWQsIHBhcmFtcy5zaWduSW5NZXRob2QpO1xuICAgICAgICBpZiAocGFyYW1zLmlkVG9rZW4gfHwgcGFyYW1zLmFjY2Vzc1Rva2VuKSB7XG4gICAgICAgICAgICAvLyBPQXV0aCAyIGFuZCBlaXRoZXIgSUQgdG9rZW4gb3IgYWNjZXNzIHRva2VuLlxuICAgICAgICAgICAgaWYgKHBhcmFtcy5pZFRva2VuKSB7XG4gICAgICAgICAgICAgICAgY3JlZC5pZFRva2VuID0gcGFyYW1zLmlkVG9rZW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocGFyYW1zLmFjY2Vzc1Rva2VuKSB7XG4gICAgICAgICAgICAgICAgY3JlZC5hY2Nlc3NUb2tlbiA9IHBhcmFtcy5hY2Nlc3NUb2tlbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEFkZCBub25jZSBpZiBhdmFpbGFibGUgYW5kIG5vIHBlbmRpbmdUb2tlbiBpcyBwcmVzZW50LlxuICAgICAgICAgICAgaWYgKHBhcmFtcy5ub25jZSAmJiAhcGFyYW1zLnBlbmRpbmdUb2tlbikge1xuICAgICAgICAgICAgICAgIGNyZWQubm9uY2UgPSBwYXJhbXMubm9uY2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocGFyYW1zLnBlbmRpbmdUb2tlbikge1xuICAgICAgICAgICAgICAgIGNyZWQucGVuZGluZ1Rva2VuID0gcGFyYW1zLnBlbmRpbmdUb2tlbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChwYXJhbXMub2F1dGhUb2tlbiAmJiBwYXJhbXMub2F1dGhUb2tlblNlY3JldCkge1xuICAgICAgICAgICAgLy8gT0F1dGggMSBhbmQgT0F1dGggdG9rZW4gd2l0aCB0b2tlbiBzZWNyZXRcbiAgICAgICAgICAgIGNyZWQuYWNjZXNzVG9rZW4gPSBwYXJhbXMub2F1dGhUb2tlbjtcbiAgICAgICAgICAgIGNyZWQuc2VjcmV0ID0gcGFyYW1zLm9hdXRoVG9rZW5TZWNyZXQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBfZmFpbChcImFyZ3VtZW50LWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUiAqLyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNyZWQ7XG4gICAgfVxuICAgIC8qKiB7QGluaGVyaXRkb2MgQXV0aENyZWRlbnRpYWwudG9KU09OfSAgKi9cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZFRva2VuOiB0aGlzLmlkVG9rZW4sXG4gICAgICAgICAgICBhY2Nlc3NUb2tlbjogdGhpcy5hY2Nlc3NUb2tlbixcbiAgICAgICAgICAgIHNlY3JldDogdGhpcy5zZWNyZXQsXG4gICAgICAgICAgICBub25jZTogdGhpcy5ub25jZSxcbiAgICAgICAgICAgIHBlbmRpbmdUb2tlbjogdGhpcy5wZW5kaW5nVG9rZW4sXG4gICAgICAgICAgICBwcm92aWRlcklkOiB0aGlzLnByb3ZpZGVySWQsXG4gICAgICAgICAgICBzaWduSW5NZXRob2Q6IHRoaXMuc2lnbkluTWV0aG9kXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXRpYyBtZXRob2QgdG8gZGVzZXJpYWxpemUgYSBKU09OIHJlcHJlc2VudGF0aW9uIG9mIGFuIG9iamVjdCBpbnRvIGFuXG4gICAgICoge0BsaW5rICBBdXRoQ3JlZGVudGlhbH0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ganNvbiAtIElucHV0IGNhbiBiZSBlaXRoZXIgT2JqZWN0IG9yIHRoZSBzdHJpbmdpZmllZCByZXByZXNlbnRhdGlvbiBvZiB0aGUgb2JqZWN0LlxuICAgICAqIFdoZW4gc3RyaW5nIGlzIHByb3ZpZGVkLCBKU09OLnBhcnNlIHdvdWxkIGJlIGNhbGxlZCBmaXJzdC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIElmIHRoZSBKU09OIGlucHV0IGRvZXMgbm90IHJlcHJlc2VudCBhbiB7QGxpbmsgIEF1dGhDcmVkZW50aWFsfSwgbnVsbCBpcyByZXR1cm5lZC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbUpTT04oanNvbikge1xuICAgICAgICBjb25zdCBvYmogPSB0eXBlb2YganNvbiA9PT0gJ3N0cmluZycgPyBKU09OLnBhcnNlKGpzb24pIDoganNvbjtcbiAgICAgICAgY29uc3QgeyBwcm92aWRlcklkLCBzaWduSW5NZXRob2QsIC4uLnJlc3QgfSA9IG9iajtcbiAgICAgICAgaWYgKCFwcm92aWRlcklkIHx8ICFzaWduSW5NZXRob2QpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNyZWQgPSBuZXcgT0F1dGhDcmVkZW50aWFsKHByb3ZpZGVySWQsIHNpZ25Jbk1ldGhvZCk7XG4gICAgICAgIGNyZWQuaWRUb2tlbiA9IHJlc3QuaWRUb2tlbiB8fCB1bmRlZmluZWQ7XG4gICAgICAgIGNyZWQuYWNjZXNzVG9rZW4gPSByZXN0LmFjY2Vzc1Rva2VuIHx8IHVuZGVmaW5lZDtcbiAgICAgICAgY3JlZC5zZWNyZXQgPSByZXN0LnNlY3JldDtcbiAgICAgICAgY3JlZC5ub25jZSA9IHJlc3Qubm9uY2U7XG4gICAgICAgIGNyZWQucGVuZGluZ1Rva2VuID0gcmVzdC5wZW5kaW5nVG9rZW4gfHwgbnVsbDtcbiAgICAgICAgcmV0dXJuIGNyZWQ7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBfZ2V0SWRUb2tlblJlc3BvbnNlKGF1dGgpIHtcbiAgICAgICAgY29uc3QgcmVxdWVzdCA9IHRoaXMuYnVpbGRSZXF1ZXN0KCk7XG4gICAgICAgIHJldHVybiBzaWduSW5XaXRoSWRwKGF1dGgsIHJlcXVlc3QpO1xuICAgIH1cbiAgICAvKiogQGludGVybmFsICovXG4gICAgX2xpbmtUb0lkVG9rZW4oYXV0aCwgaWRUb2tlbikge1xuICAgICAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5idWlsZFJlcXVlc3QoKTtcbiAgICAgICAgcmVxdWVzdC5pZFRva2VuID0gaWRUb2tlbjtcbiAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhJZHAoYXV0aCwgcmVxdWVzdCk7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBfZ2V0UmVhdXRoZW50aWNhdGlvblJlc29sdmVyKGF1dGgpIHtcbiAgICAgICAgY29uc3QgcmVxdWVzdCA9IHRoaXMuYnVpbGRSZXF1ZXN0KCk7XG4gICAgICAgIHJlcXVlc3QuYXV0b0NyZWF0ZSA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gc2lnbkluV2l0aElkcChhdXRoLCByZXF1ZXN0KTtcbiAgICB9XG4gICAgYnVpbGRSZXF1ZXN0KCkge1xuICAgICAgICBjb25zdCByZXF1ZXN0ID0ge1xuICAgICAgICAgICAgcmVxdWVzdFVyaTogSURQX1JFUVVFU1RfVVJJJDEsXG4gICAgICAgICAgICByZXR1cm5TZWN1cmVUb2tlbjogdHJ1ZVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5wZW5kaW5nVG9rZW4pIHtcbiAgICAgICAgICAgIHJlcXVlc3QucGVuZGluZ1Rva2VuID0gdGhpcy5wZW5kaW5nVG9rZW47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBwb3N0Qm9keSA9IHt9O1xuICAgICAgICAgICAgaWYgKHRoaXMuaWRUb2tlbikge1xuICAgICAgICAgICAgICAgIHBvc3RCb2R5WydpZF90b2tlbiddID0gdGhpcy5pZFRva2VuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgICAgICAgICBwb3N0Qm9keVsnYWNjZXNzX3Rva2VuJ10gPSB0aGlzLmFjY2Vzc1Rva2VuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuc2VjcmV0KSB7XG4gICAgICAgICAgICAgICAgcG9zdEJvZHlbJ29hdXRoX3Rva2VuX3NlY3JldCddID0gdGhpcy5zZWNyZXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwb3N0Qm9keVsncHJvdmlkZXJJZCddID0gdGhpcy5wcm92aWRlcklkO1xuICAgICAgICAgICAgaWYgKHRoaXMubm9uY2UgJiYgIXRoaXMucGVuZGluZ1Rva2VuKSB7XG4gICAgICAgICAgICAgICAgcG9zdEJvZHlbJ25vbmNlJ10gPSB0aGlzLm5vbmNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVxdWVzdC5wb3N0Qm9keSA9IHF1ZXJ5c3RyaW5nKHBvc3RCb2R5KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVxdWVzdDtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5hc3luYyBmdW5jdGlvbiBzZW5kUGhvbmVWZXJpZmljYXRpb25Db2RlKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6c2VuZFZlcmlmaWNhdGlvbkNvZGVcIiAvKiBFbmRwb2ludC5TRU5EX1ZFUklGSUNBVElPTl9DT0RFICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xufVxuYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aFBob25lTnVtYmVyJDEoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybVNpZ25JblJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92MS9hY2NvdW50czpzaWduSW5XaXRoUGhvbmVOdW1iZXJcIiAvKiBFbmRwb2ludC5TSUdOX0lOX1dJVEhfUEhPTkVfTlVNQkVSICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xufVxuYXN5bmMgZnVuY3Rpb24gbGlua1dpdGhQaG9uZU51bWJlciQxKGF1dGgsIHJlcXVlc3QpIHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IF9wZXJmb3JtU2lnbkluUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBIdHRwTWV0aG9kLlBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnNpZ25JbldpdGhQaG9uZU51bWJlclwiIC8qIEVuZHBvaW50LlNJR05fSU5fV0lUSF9QSE9ORV9OVU1CRVIgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XG4gICAgaWYgKHJlc3BvbnNlLnRlbXBvcmFyeVByb29mKSB7XG4gICAgICAgIHRocm93IF9tYWtlVGFnZ2VkRXJyb3IoYXV0aCwgXCJhY2NvdW50LWV4aXN0cy13aXRoLWRpZmZlcmVudC1jcmVkZW50aWFsXCIgLyogQXV0aEVycm9yQ29kZS5ORUVEX0NPTkZJUk1BVElPTiAqLywgcmVzcG9uc2UpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzcG9uc2U7XG59XG5jb25zdCBWRVJJRllfUEhPTkVfTlVNQkVSX0ZPUl9FWElTVElOR19FUlJPUl9NQVBfID0ge1xuICAgIFtcIlVTRVJfTk9UX0ZPVU5EXCIgLyogU2VydmVyRXJyb3IuVVNFUl9OT1RfRk9VTkQgKi9dOiBcInVzZXItbm90LWZvdW5kXCIgLyogQXV0aEVycm9yQ29kZS5VU0VSX0RFTEVURUQgKi9cbn07XG5hc3luYyBmdW5jdGlvbiB2ZXJpZnlQaG9uZU51bWJlckZvckV4aXN0aW5nKGF1dGgsIHJlcXVlc3QpIHtcbiAgICBjb25zdCBhcGlSZXF1ZXN0ID0ge1xuICAgICAgICAuLi5yZXF1ZXN0LFxuICAgICAgICBvcGVyYXRpb246ICdSRUFVVEgnXG4gICAgfTtcbiAgICByZXR1cm4gX3BlcmZvcm1TaWduSW5SZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6c2lnbkluV2l0aFBob25lTnVtYmVyXCIgLyogRW5kcG9pbnQuU0lHTl9JTl9XSVRIX1BIT05FX05VTUJFUiAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIGFwaVJlcXVlc3QpLCBWRVJJRllfUEhPTkVfTlVNQkVSX0ZPUl9FWElTVElOR19FUlJPUl9NQVBfKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmVwcmVzZW50cyB0aGUgY3JlZGVudGlhbHMgcmV0dXJuZWQgYnkge0BsaW5rIFBob25lQXV0aFByb3ZpZGVyfS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmNsYXNzIFBob25lQXV0aENyZWRlbnRpYWwgZXh0ZW5kcyBBdXRoQ3JlZGVudGlhbCB7XG4gICAgY29uc3RydWN0b3IocGFyYW1zKSB7XG4gICAgICAgIHN1cGVyKFwicGhvbmVcIiAvKiBQcm92aWRlcklkLlBIT05FICovLCBcInBob25lXCIgLyogU2lnbkluTWV0aG9kLlBIT05FICovKTtcbiAgICAgICAgdGhpcy5wYXJhbXMgPSBwYXJhbXM7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBzdGF0aWMgX2Zyb21WZXJpZmljYXRpb24odmVyaWZpY2F0aW9uSWQsIHZlcmlmaWNhdGlvbkNvZGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQaG9uZUF1dGhDcmVkZW50aWFsKHsgdmVyaWZpY2F0aW9uSWQsIHZlcmlmaWNhdGlvbkNvZGUgfSk7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBzdGF0aWMgX2Zyb21Ub2tlblJlc3BvbnNlKHBob25lTnVtYmVyLCB0ZW1wb3JhcnlQcm9vZikge1xuICAgICAgICByZXR1cm4gbmV3IFBob25lQXV0aENyZWRlbnRpYWwoeyBwaG9uZU51bWJlciwgdGVtcG9yYXJ5UHJvb2YgfSk7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBfZ2V0SWRUb2tlblJlc3BvbnNlKGF1dGgpIHtcbiAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhQaG9uZU51bWJlciQxKGF1dGgsIHRoaXMuX21ha2VWZXJpZmljYXRpb25SZXF1ZXN0KCkpO1xuICAgIH1cbiAgICAvKiogQGludGVybmFsICovXG4gICAgX2xpbmtUb0lkVG9rZW4oYXV0aCwgaWRUb2tlbikge1xuICAgICAgICByZXR1cm4gbGlua1dpdGhQaG9uZU51bWJlciQxKGF1dGgsIHtcbiAgICAgICAgICAgIGlkVG9rZW4sXG4gICAgICAgICAgICAuLi50aGlzLl9tYWtlVmVyaWZpY2F0aW9uUmVxdWVzdCgpXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKiogQGludGVybmFsICovXG4gICAgX2dldFJlYXV0aGVudGljYXRpb25SZXNvbHZlcihhdXRoKSB7XG4gICAgICAgIHJldHVybiB2ZXJpZnlQaG9uZU51bWJlckZvckV4aXN0aW5nKGF1dGgsIHRoaXMuX21ha2VWZXJpZmljYXRpb25SZXF1ZXN0KCkpO1xuICAgIH1cbiAgICAvKiogQGludGVybmFsICovXG4gICAgX21ha2VWZXJpZmljYXRpb25SZXF1ZXN0KCkge1xuICAgICAgICBjb25zdCB7IHRlbXBvcmFyeVByb29mLCBwaG9uZU51bWJlciwgdmVyaWZpY2F0aW9uSWQsIHZlcmlmaWNhdGlvbkNvZGUgfSA9IHRoaXMucGFyYW1zO1xuICAgICAgICBpZiAodGVtcG9yYXJ5UHJvb2YgJiYgcGhvbmVOdW1iZXIpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHRlbXBvcmFyeVByb29mLCBwaG9uZU51bWJlciB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzZXNzaW9uSW5mbzogdmVyaWZpY2F0aW9uSWQsXG4gICAgICAgICAgICBjb2RlOiB2ZXJpZmljYXRpb25Db2RlXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKiB7QGluaGVyaXRkb2MgQXV0aENyZWRlbnRpYWwudG9KU09OfSAqL1xuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3Qgb2JqID0ge1xuICAgICAgICAgICAgcHJvdmlkZXJJZDogdGhpcy5wcm92aWRlcklkXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLnBhcmFtcy5waG9uZU51bWJlcikge1xuICAgICAgICAgICAgb2JqLnBob25lTnVtYmVyID0gdGhpcy5wYXJhbXMucGhvbmVOdW1iZXI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFyYW1zLnRlbXBvcmFyeVByb29mKSB7XG4gICAgICAgICAgICBvYmoudGVtcG9yYXJ5UHJvb2YgPSB0aGlzLnBhcmFtcy50ZW1wb3JhcnlQcm9vZjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJhbXMudmVyaWZpY2F0aW9uQ29kZSkge1xuICAgICAgICAgICAgb2JqLnZlcmlmaWNhdGlvbkNvZGUgPSB0aGlzLnBhcmFtcy52ZXJpZmljYXRpb25Db2RlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmFtcy52ZXJpZmljYXRpb25JZCkge1xuICAgICAgICAgICAgb2JqLnZlcmlmaWNhdGlvbklkID0gdGhpcy5wYXJhbXMudmVyaWZpY2F0aW9uSWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB9XG4gICAgLyoqIEdlbmVyYXRlcyBhIHBob25lIGNyZWRlbnRpYWwgYmFzZWQgb24gYSBwbGFpbiBvYmplY3Qgb3IgYSBKU09OIHN0cmluZy4gKi9cbiAgICBzdGF0aWMgZnJvbUpTT04oanNvbikge1xuICAgICAgICBpZiAodHlwZW9mIGpzb24gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBqc29uID0gSlNPTi5wYXJzZShqc29uKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IHZlcmlmaWNhdGlvbklkLCB2ZXJpZmljYXRpb25Db2RlLCBwaG9uZU51bWJlciwgdGVtcG9yYXJ5UHJvb2YgfSA9IGpzb247XG4gICAgICAgIGlmICghdmVyaWZpY2F0aW9uQ29kZSAmJlxuICAgICAgICAgICAgIXZlcmlmaWNhdGlvbklkICYmXG4gICAgICAgICAgICAhcGhvbmVOdW1iZXIgJiZcbiAgICAgICAgICAgICF0ZW1wb3JhcnlQcm9vZikge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBQaG9uZUF1dGhDcmVkZW50aWFsKHtcbiAgICAgICAgICAgIHZlcmlmaWNhdGlvbklkLFxuICAgICAgICAgICAgdmVyaWZpY2F0aW9uQ29kZSxcbiAgICAgICAgICAgIHBob25lTnVtYmVyLFxuICAgICAgICAgICAgdGVtcG9yYXJ5UHJvb2ZcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBNYXBzIHRoZSBtb2RlIHN0cmluZyBpbiBhY3Rpb24gY29kZSBVUkwgdG8gQWN0aW9uIENvZGUgSW5mbyBvcGVyYXRpb24uXG4gKlxuICogQHBhcmFtIG1vZGVcbiAqL1xuZnVuY3Rpb24gcGFyc2VNb2RlKG1vZGUpIHtcbiAgICBzd2l0Y2ggKG1vZGUpIHtcbiAgICAgICAgY2FzZSAncmVjb3ZlckVtYWlsJzpcbiAgICAgICAgICAgIHJldHVybiBcIlJFQ09WRVJfRU1BSUxcIiAvKiBBY3Rpb25Db2RlT3BlcmF0aW9uLlJFQ09WRVJfRU1BSUwgKi87XG4gICAgICAgIGNhc2UgJ3Jlc2V0UGFzc3dvcmQnOlxuICAgICAgICAgICAgcmV0dXJuIFwiUEFTU1dPUkRfUkVTRVRcIiAvKiBBY3Rpb25Db2RlT3BlcmF0aW9uLlBBU1NXT1JEX1JFU0VUICovO1xuICAgICAgICBjYXNlICdzaWduSW4nOlxuICAgICAgICAgICAgcmV0dXJuIFwiRU1BSUxfU0lHTklOXCIgLyogQWN0aW9uQ29kZU9wZXJhdGlvbi5FTUFJTF9TSUdOSU4gKi87XG4gICAgICAgIGNhc2UgJ3ZlcmlmeUVtYWlsJzpcbiAgICAgICAgICAgIHJldHVybiBcIlZFUklGWV9FTUFJTFwiIC8qIEFjdGlvbkNvZGVPcGVyYXRpb24uVkVSSUZZX0VNQUlMICovO1xuICAgICAgICBjYXNlICd2ZXJpZnlBbmRDaGFuZ2VFbWFpbCc6XG4gICAgICAgICAgICByZXR1cm4gXCJWRVJJRllfQU5EX0NIQU5HRV9FTUFJTFwiIC8qIEFjdGlvbkNvZGVPcGVyYXRpb24uVkVSSUZZX0FORF9DSEFOR0VfRU1BSUwgKi87XG4gICAgICAgIGNhc2UgJ3JldmVydFNlY29uZEZhY3RvckFkZGl0aW9uJzpcbiAgICAgICAgICAgIHJldHVybiBcIlJFVkVSVF9TRUNPTkRfRkFDVE9SX0FERElUSU9OXCIgLyogQWN0aW9uQ29kZU9wZXJhdGlvbi5SRVZFUlRfU0VDT05EX0ZBQ1RPUl9BRERJVElPTiAqLztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cbi8qKlxuICogSGVscGVyIHRvIHBhcnNlIEZETCBsaW5rc1xuICpcbiAqIEBwYXJhbSB1cmxcbiAqL1xuZnVuY3Rpb24gcGFyc2VEZWVwTGluayh1cmwpIHtcbiAgICBjb25zdCBsaW5rID0gcXVlcnlzdHJpbmdEZWNvZGUoZXh0cmFjdFF1ZXJ5c3RyaW5nKHVybCkpWydsaW5rJ107XG4gICAgLy8gRG91YmxlIGxpbmsgY2FzZSAoYXV0b21hdGljIHJlZGlyZWN0KS5cbiAgICBjb25zdCBkb3VibGVEZWVwTGluayA9IGxpbmtcbiAgICAgICAgPyBxdWVyeXN0cmluZ0RlY29kZShleHRyYWN0UXVlcnlzdHJpbmcobGluaykpWydkZWVwX2xpbmtfaWQnXVxuICAgICAgICA6IG51bGw7XG4gICAgLy8gaU9TIGN1c3RvbSBzY2hlbWUgbGlua3MuXG4gICAgY29uc3QgaU9TRGVlcExpbmsgPSBxdWVyeXN0cmluZ0RlY29kZShleHRyYWN0UXVlcnlzdHJpbmcodXJsKSlbJ2RlZXBfbGlua19pZCddO1xuICAgIGNvbnN0IGlPU0RvdWJsZURlZXBMaW5rID0gaU9TRGVlcExpbmtcbiAgICAgICAgPyBxdWVyeXN0cmluZ0RlY29kZShleHRyYWN0UXVlcnlzdHJpbmcoaU9TRGVlcExpbmspKVsnbGluayddXG4gICAgICAgIDogbnVsbDtcbiAgICByZXR1cm4gaU9TRG91YmxlRGVlcExpbmsgfHwgaU9TRGVlcExpbmsgfHwgZG91YmxlRGVlcExpbmsgfHwgbGluayB8fCB1cmw7XG59XG4vKipcbiAqIEEgdXRpbGl0eSBjbGFzcyB0byBwYXJzZSBlbWFpbCBhY3Rpb24gVVJMcyBzdWNoIGFzIHBhc3N3b3JkIHJlc2V0LCBlbWFpbCB2ZXJpZmljYXRpb24sXG4gKiBlbWFpbCBsaW5rIHNpZ24gaW4sIGV0Yy5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmNsYXNzIEFjdGlvbkNvZGVVUkwge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSBhY3Rpb25MaW5rIC0gVGhlIGxpbmsgZnJvbSB3aGljaCB0byBleHRyYWN0IHRoZSBVUkwuXG4gICAgICogQHJldHVybnMgVGhlIHtAbGluayBBY3Rpb25Db2RlVVJMfSBvYmplY3QsIG9yIG51bGwgaWYgdGhlIGxpbmsgaXMgaW52YWxpZC5cbiAgICAgKlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGFjdGlvbkxpbmspIHtcbiAgICAgICAgY29uc3Qgc2VhcmNoUGFyYW1zID0gcXVlcnlzdHJpbmdEZWNvZGUoZXh0cmFjdFF1ZXJ5c3RyaW5nKGFjdGlvbkxpbmspKTtcbiAgICAgICAgY29uc3QgYXBpS2V5ID0gc2VhcmNoUGFyYW1zW1wiYXBpS2V5XCIgLyogUXVlcnlGaWVsZC5BUElfS0VZICovXSA/PyBudWxsO1xuICAgICAgICBjb25zdCBjb2RlID0gc2VhcmNoUGFyYW1zW1wib29iQ29kZVwiIC8qIFF1ZXJ5RmllbGQuQ09ERSAqL10gPz8gbnVsbDtcbiAgICAgICAgY29uc3Qgb3BlcmF0aW9uID0gcGFyc2VNb2RlKHNlYXJjaFBhcmFtc1tcIm1vZGVcIiAvKiBRdWVyeUZpZWxkLk1PREUgKi9dID8/IG51bGwpO1xuICAgICAgICAvLyBWYWxpZGF0ZSBBUEkga2V5LCBjb2RlIGFuZCBtb2RlLlxuICAgICAgICBfYXNzZXJ0KGFwaUtleSAmJiBjb2RlICYmIG9wZXJhdGlvbiwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IgKi8pO1xuICAgICAgICB0aGlzLmFwaUtleSA9IGFwaUtleTtcbiAgICAgICAgdGhpcy5vcGVyYXRpb24gPSBvcGVyYXRpb247XG4gICAgICAgIHRoaXMuY29kZSA9IGNvZGU7XG4gICAgICAgIHRoaXMuY29udGludWVVcmwgPSBzZWFyY2hQYXJhbXNbXCJjb250aW51ZVVybFwiIC8qIFF1ZXJ5RmllbGQuQ09OVElOVUVfVVJMICovXSA/PyBudWxsO1xuICAgICAgICB0aGlzLmxhbmd1YWdlQ29kZSA9IHNlYXJjaFBhcmFtc1tcImxhbmdcIiAvKiBRdWVyeUZpZWxkLkxBTkdVQUdFX0NPREUgKi9dID8/IG51bGw7XG4gICAgICAgIHRoaXMudGVuYW50SWQgPSBzZWFyY2hQYXJhbXNbXCJ0ZW5hbnRJZFwiIC8qIFF1ZXJ5RmllbGQuVEVOQU5UX0lEICovXSA/PyBudWxsO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgdGhlIGVtYWlsIGFjdGlvbiBsaW5rIHN0cmluZyBhbmQgcmV0dXJucyBhbiB7QGxpbmsgQWN0aW9uQ29kZVVSTH0gaWYgdGhlIGxpbmsgaXMgdmFsaWQsXG4gICAgICogb3RoZXJ3aXNlIHJldHVybnMgbnVsbC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBsaW5rICAtIFRoZSBlbWFpbCBhY3Rpb24gbGluayBzdHJpbmcuXG4gICAgICogQHJldHVybnMgVGhlIHtAbGluayBBY3Rpb25Db2RlVVJMfSBvYmplY3QsIG9yIG51bGwgaWYgdGhlIGxpbmsgaXMgaW52YWxpZC5cbiAgICAgKlxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBzdGF0aWMgcGFyc2VMaW5rKGxpbmspIHtcbiAgICAgICAgY29uc3QgYWN0aW9uTGluayA9IHBhcnNlRGVlcExpbmsobGluayk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEFjdGlvbkNvZGVVUkwoYWN0aW9uTGluayk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKipcbiAqIFBhcnNlcyB0aGUgZW1haWwgYWN0aW9uIGxpbmsgc3RyaW5nIGFuZCByZXR1cm5zIGFuIHtAbGluayBBY3Rpb25Db2RlVVJMfSBpZlxuICogdGhlIGxpbmsgaXMgdmFsaWQsIG90aGVyd2lzZSByZXR1cm5zIG51bGwuXG4gKlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiBwYXJzZUFjdGlvbkNvZGVVUkwobGluaykge1xuICAgIHJldHVybiBBY3Rpb25Db2RlVVJMLnBhcnNlTGluayhsaW5rKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcge0BsaW5rIEVtYWlsQXV0aENyZWRlbnRpYWx9LlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuY2xhc3MgRW1haWxBdXRoUHJvdmlkZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAvKipcbiAgICAgICAgICogQWx3YXlzIHNldCB0byB7QGxpbmsgUHJvdmlkZXJJZH0uUEFTU1dPUkQsIGV2ZW4gZm9yIGVtYWlsIGxpbmsuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnByb3ZpZGVySWQgPSBFbWFpbEF1dGhQcm92aWRlci5QUk9WSURFUl9JRDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZSBhbiB7QGxpbmsgQXV0aENyZWRlbnRpYWx9IHVzaW5nIGFuIGVtYWlsIGFuZCBwYXNzd29yZC5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogYGBgamF2YXNjcmlwdFxuICAgICAqIGNvbnN0IGF1dGhDcmVkZW50aWFsID0gRW1haWxBdXRoUHJvdmlkZXIuY3JlZGVudGlhbChlbWFpbCwgcGFzc3dvcmQpO1xuICAgICAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgc2lnbkluV2l0aENyZWRlbnRpYWwoYXV0aCwgYXV0aENyZWRlbnRpYWwpO1xuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBgYGBqYXZhc2NyaXB0XG4gICAgICogY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBzaWduSW5XaXRoRW1haWxBbmRQYXNzd29yZChhdXRoLCBlbWFpbCwgcGFzc3dvcmQpO1xuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogQHBhcmFtIGVtYWlsIC0gRW1haWwgYWRkcmVzcy5cbiAgICAgKiBAcGFyYW0gcGFzc3dvcmQgLSBVc2VyIGFjY291bnQgcGFzc3dvcmQuXG4gICAgICogQHJldHVybnMgVGhlIGF1dGggcHJvdmlkZXIgY3JlZGVudGlhbC5cbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlZGVudGlhbChlbWFpbCwgcGFzc3dvcmQpIHtcbiAgICAgICAgcmV0dXJuIEVtYWlsQXV0aENyZWRlbnRpYWwuX2Zyb21FbWFpbEFuZFBhc3N3b3JkKGVtYWlsLCBwYXNzd29yZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemUgYW4ge0BsaW5rIEF1dGhDcmVkZW50aWFsfSB1c2luZyBhbiBlbWFpbCBhbmQgYW4gZW1haWwgbGluayBhZnRlciBhIHNpZ24gaW4gd2l0aFxuICAgICAqIGVtYWlsIGxpbmsgb3BlcmF0aW9uLlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBgYGBqYXZhc2NyaXB0XG4gICAgICogY29uc3QgYXV0aENyZWRlbnRpYWwgPSBFbWFpbEF1dGhQcm92aWRlci5jcmVkZW50aWFsV2l0aExpbmsoYXV0aCwgZW1haWwsIGVtYWlsTGluayk7XG4gICAgICogY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBzaWduSW5XaXRoQ3JlZGVudGlhbChhdXRoLCBhdXRoQ3JlZGVudGlhbCk7XG4gICAgICogYGBgXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGBgYGphdmFzY3JpcHRcbiAgICAgKiBhd2FpdCBzZW5kU2lnbkluTGlua1RvRW1haWwoYXV0aCwgZW1haWwpO1xuICAgICAqIC8vIE9idGFpbiBlbWFpbExpbmsgZnJvbSB1c2VyLlxuICAgICAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgc2lnbkluV2l0aEVtYWlsTGluayhhdXRoLCBlbWFpbCwgZW1haWxMaW5rKTtcbiAgICAgKiBgYGBcbiAgICAgKlxuICAgICAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZSB1c2VkIHRvIHZlcmlmeSB0aGUgbGluay5cbiAgICAgKiBAcGFyYW0gZW1haWwgLSBFbWFpbCBhZGRyZXNzLlxuICAgICAqIEBwYXJhbSBlbWFpbExpbmsgLSBTaWduLWluIGVtYWlsIGxpbmsuXG4gICAgICogQHJldHVybnMgLSBUaGUgYXV0aCBwcm92aWRlciBjcmVkZW50aWFsLlxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVkZW50aWFsV2l0aExpbmsoZW1haWwsIGVtYWlsTGluaykge1xuICAgICAgICBjb25zdCBhY3Rpb25Db2RlVXJsID0gQWN0aW9uQ29kZVVSTC5wYXJzZUxpbmsoZW1haWxMaW5rKTtcbiAgICAgICAgX2Fzc2VydChhY3Rpb25Db2RlVXJsLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUiAqLyk7XG4gICAgICAgIHJldHVybiBFbWFpbEF1dGhDcmVkZW50aWFsLl9mcm9tRW1haWxBbmRDb2RlKGVtYWlsLCBhY3Rpb25Db2RlVXJsLmNvZGUsIGFjdGlvbkNvZGVVcmwudGVuYW50SWQpO1xuICAgIH1cbn1cbi8qKlxuICogQWx3YXlzIHNldCB0byB7QGxpbmsgUHJvdmlkZXJJZH0uUEFTU1dPUkQsIGV2ZW4gZm9yIGVtYWlsIGxpbmsuXG4gKi9cbkVtYWlsQXV0aFByb3ZpZGVyLlBST1ZJREVSX0lEID0gXCJwYXNzd29yZFwiIC8qIFByb3ZpZGVySWQuUEFTU1dPUkQgKi87XG4vKipcbiAqIEFsd2F5cyBzZXQgdG8ge0BsaW5rIFNpZ25Jbk1ldGhvZH0uRU1BSUxfUEFTU1dPUkQuXG4gKi9cbkVtYWlsQXV0aFByb3ZpZGVyLkVNQUlMX1BBU1NXT1JEX1NJR05fSU5fTUVUSE9EID0gXCJwYXNzd29yZFwiIC8qIFNpZ25Jbk1ldGhvZC5FTUFJTF9QQVNTV09SRCAqLztcbi8qKlxuICogQWx3YXlzIHNldCB0byB7QGxpbmsgU2lnbkluTWV0aG9kfS5FTUFJTF9MSU5LLlxuICovXG5FbWFpbEF1dGhQcm92aWRlci5FTUFJTF9MSU5LX1NJR05fSU5fTUVUSE9EID0gXCJlbWFpbExpbmtcIiAvKiBTaWduSW5NZXRob2QuRU1BSUxfTElOSyAqLztcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVGhlIGJhc2UgY2xhc3MgZm9yIGFsbCBGZWRlcmF0ZWQgcHJvdmlkZXJzIChPQXV0aCAoaW5jbHVkaW5nIE9JREMpLCBTQU1MKS5cbiAqXG4gKiBUaGlzIGNsYXNzIGlzIG5vdCBtZWFudCB0byBiZSBpbnN0YW50aWF0ZWQgZGlyZWN0bHkuXG4gKlxuICogQHB1YmxpY1xuICovXG5jbGFzcyBGZWRlcmF0ZWRBdXRoUHJvdmlkZXIge1xuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdG9yIGZvciBnZW5lcmljIE9BdXRoIHByb3ZpZGVycy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwcm92aWRlcklkIC0gUHJvdmlkZXIgZm9yIHdoaWNoIGNyZWRlbnRpYWxzIHNob3VsZCBiZSBnZW5lcmF0ZWQuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocHJvdmlkZXJJZCkge1xuICAgICAgICB0aGlzLnByb3ZpZGVySWQgPSBwcm92aWRlcklkO1xuICAgICAgICAvKiogQGludGVybmFsICovXG4gICAgICAgIHRoaXMuZGVmYXVsdExhbmd1YWdlQ29kZSA9IG51bGw7XG4gICAgICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICAgICAgdGhpcy5jdXN0b21QYXJhbWV0ZXJzID0ge307XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgbGFuZ3VhZ2UgZ29kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBsYW5ndWFnZUNvZGUgLSBsYW5ndWFnZSBjb2RlXG4gICAgICovXG4gICAgc2V0RGVmYXVsdExhbmd1YWdlKGxhbmd1YWdlQ29kZSkge1xuICAgICAgICB0aGlzLmRlZmF1bHRMYW5ndWFnZUNvZGUgPSBsYW5ndWFnZUNvZGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIE9BdXRoIGN1c3RvbSBwYXJhbWV0ZXJzIHRvIHBhc3MgaW4gYW4gT0F1dGggcmVxdWVzdCBmb3IgcG9wdXAgYW5kIHJlZGlyZWN0IHNpZ24taW5cbiAgICAgKiBvcGVyYXRpb25zLlxuICAgICAqXG4gICAgICogQHJlbWFya3NcbiAgICAgKiBGb3IgYSBkZXRhaWxlZCBsaXN0LCBjaGVjayB0aGUgcmVzZXJ2ZWQgcmVxdWlyZWQgT0F1dGggMi4wIHBhcmFtZXRlcnMgc3VjaCBhcyBgY2xpZW50X2lkYCxcbiAgICAgKiBgcmVkaXJlY3RfdXJpYCwgYHNjb3BlYCwgYHJlc3BvbnNlX3R5cGVgLCBhbmQgYHN0YXRlYCBhcmUgbm90IGFsbG93ZWQgYW5kIHdpbGwgYmUgaWdub3JlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjdXN0b21PQXV0aFBhcmFtZXRlcnMgLSBUaGUgY3VzdG9tIE9BdXRoIHBhcmFtZXRlcnMgdG8gcGFzcyBpbiB0aGUgT0F1dGggcmVxdWVzdC5cbiAgICAgKi9cbiAgICBzZXRDdXN0b21QYXJhbWV0ZXJzKGN1c3RvbU9BdXRoUGFyYW1ldGVycykge1xuICAgICAgICB0aGlzLmN1c3RvbVBhcmFtZXRlcnMgPSBjdXN0b21PQXV0aFBhcmFtZXRlcnM7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZSB0aGUgY3VycmVudCBsaXN0IG9mIHtAbGluayBDdXN0b21QYXJhbWV0ZXJzfS5cbiAgICAgKi9cbiAgICBnZXRDdXN0b21QYXJhbWV0ZXJzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jdXN0b21QYXJhbWV0ZXJzO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQ29tbW9uIGNvZGUgdG8gYWxsIE9BdXRoIHByb3ZpZGVycy4gVGhpcyBpcyBzZXBhcmF0ZSBmcm9tIHRoZVxuICoge0BsaW5rIE9BdXRoUHJvdmlkZXJ9IHNvIHRoYXQgY2hpbGQgcHJvdmlkZXJzIChsaWtlXG4gKiB7QGxpbmsgR29vZ2xlQXV0aFByb3ZpZGVyfSkgZG9uJ3QgaW5oZXJpdCB0aGUgYGNyZWRlbnRpYWxgIGluc3RhbmNlIG1ldGhvZC5cbiAqIEluc3RlYWQsIHRoZXkgcmVseSBvbiBhIHN0YXRpYyBgY3JlZGVudGlhbGAgbWV0aG9kLlxuICovXG5jbGFzcyBCYXNlT0F1dGhQcm92aWRlciBleHRlbmRzIEZlZGVyYXRlZEF1dGhQcm92aWRlciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKC4uLmFyZ3VtZW50cyk7XG4gICAgICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICAgICAgdGhpcy5zY29wZXMgPSBbXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkIGFuIE9BdXRoIHNjb3BlIHRvIHRoZSBjcmVkZW50aWFsLlxuICAgICAqXG4gICAgICogQHBhcmFtIHNjb3BlIC0gUHJvdmlkZXIgT0F1dGggc2NvcGUgdG8gYWRkLlxuICAgICAqL1xuICAgIGFkZFNjb3BlKHNjb3BlKSB7XG4gICAgICAgIC8vIElmIG5vdCBhbHJlYWR5IGFkZGVkLCBhZGQgc2NvcGUgdG8gbGlzdC5cbiAgICAgICAgaWYgKCF0aGlzLnNjb3Blcy5pbmNsdWRlcyhzY29wZSkpIHtcbiAgICAgICAgICAgIHRoaXMuc2NvcGVzLnB1c2goc2NvcGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZSB0aGUgY3VycmVudCBsaXN0IG9mIE9BdXRoIHNjb3Blcy5cbiAgICAgKi9cbiAgICBnZXRTY29wZXMoKSB7XG4gICAgICAgIHJldHVybiBbLi4udGhpcy5zY29wZXNdO1xuICAgIH1cbn1cbi8qKlxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcgZ2VuZXJpYyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfS5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gU2lnbiBpbiB1c2luZyBhIHJlZGlyZWN0LlxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgT0F1dGhQcm92aWRlcignZ29vZ2xlLmNvbScpO1xuICogLy8gU3RhcnQgYSBzaWduIGluIHByb2Nlc3MgZm9yIGFuIHVuYXV0aGVudGljYXRlZCB1c2VyLlxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3Byb2ZpbGUnKTtcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCdlbWFpbCcpO1xuICogYXdhaXQgc2lnbkluV2l0aFJlZGlyZWN0KGF1dGgsIHByb3ZpZGVyKTtcbiAqIC8vIFRoaXMgd2lsbCB0cmlnZ2VyIGEgZnVsbCBwYWdlIHJlZGlyZWN0IGF3YXkgZnJvbSB5b3VyIGFwcFxuICpcbiAqIC8vIEFmdGVyIHJldHVybmluZyBmcm9tIHRoZSByZWRpcmVjdCB3aGVuIHlvdXIgYXBwIGluaXRpYWxpemVzIHlvdSBjYW4gb2J0YWluIHRoZSByZXN1bHRcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFJlZGlyZWN0UmVzdWx0KGF1dGgpO1xuICogaWYgKHJlc3VsdCkge1xuICogICAvLyBUaGlzIGlzIHRoZSBzaWduZWQtaW4gdXNlclxuICogICBjb25zdCB1c2VyID0gcmVzdWx0LnVzZXI7XG4gKiAgIC8vIFRoaXMgZ2l2ZXMgeW91IGEgT0F1dGggQWNjZXNzIFRva2VuIGZvciB0aGUgcHJvdmlkZXIuXG4gKiAgIGNvbnN0IGNyZWRlbnRpYWwgPSBwcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChhdXRoLCByZXN1bHQpO1xuICogICBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gU2lnbiBpbiB1c2luZyBhIHBvcHVwLlxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgT0F1dGhQcm92aWRlcignZ29vZ2xlLmNvbScpO1xuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3Byb2ZpbGUnKTtcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCdlbWFpbCcpO1xuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgc2lnbkluV2l0aFBvcHVwKGF1dGgsIHByb3ZpZGVyKTtcbiAqXG4gKiAvLyBUaGUgc2lnbmVkLWluIHVzZXIgaW5mby5cbiAqIGNvbnN0IHVzZXIgPSByZXN1bHQudXNlcjtcbiAqIC8vIFRoaXMgZ2l2ZXMgeW91IGEgT0F1dGggQWNjZXNzIFRva2VuIGZvciB0aGUgcHJvdmlkZXIuXG4gKiBjb25zdCBjcmVkZW50aWFsID0gcHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQoYXV0aCwgcmVzdWx0KTtcbiAqIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcbiAqIGBgYFxuICogQHB1YmxpY1xuICovXG5jbGFzcyBPQXV0aFByb3ZpZGVyIGV4dGVuZHMgQmFzZU9BdXRoUHJvdmlkZXIge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4ge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIEpTT04gc3RyaW5nIG9yIGEgcGxhaW4gb2JqZWN0LlxuICAgICAqIEBwYXJhbSBqc29uIC0gQSBwbGFpbiBvYmplY3Qgb3IgYSBKU09OIHN0cmluZ1xuICAgICAqL1xuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbUpTT04oanNvbikge1xuICAgICAgICBjb25zdCBvYmogPSB0eXBlb2YganNvbiA9PT0gJ3N0cmluZycgPyBKU09OLnBhcnNlKGpzb24pIDoganNvbjtcbiAgICAgICAgX2Fzc2VydCgncHJvdmlkZXJJZCcgaW4gb2JqICYmICdzaWduSW5NZXRob2QnIGluIG9iaiwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IgKi8pO1xuICAgICAgICByZXR1cm4gT0F1dGhDcmVkZW50aWFsLl9mcm9tUGFyYW1zKG9iaik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEgZ2VuZXJpYyBPQXV0aCBwcm92aWRlcidzIGFjY2VzcyB0b2tlbiBvciBJRCB0b2tlbi5cbiAgICAgKlxuICAgICAqIEByZW1hcmtzXG4gICAgICogVGhlIHJhdyBub25jZSBpcyByZXF1aXJlZCB3aGVuIGFuIElEIHRva2VuIHdpdGggYSBub25jZSBmaWVsZCBpcyBwcm92aWRlZC4gVGhlIFNIQS0yNTYgaGFzaCBvZlxuICAgICAqIHRoZSByYXcgbm9uY2UgbXVzdCBtYXRjaCB0aGUgbm9uY2UgZmllbGQgaW4gdGhlIElEIHRva2VuLlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBgYGBqYXZhc2NyaXB0XG4gICAgICogLy8gYGdvb2dsZVVzZXJgIGZyb20gdGhlIG9uc3VjY2VzcyBHb29nbGUgU2lnbiBJbiBjYWxsYmFjay5cbiAgICAgKiAvLyBJbml0aWFsaXplIGEgZ2VuZXJhdGUgT0F1dGggcHJvdmlkZXIgd2l0aCBhIGBnb29nbGUuY29tYCBwcm92aWRlcklkLlxuICAgICAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IE9BdXRoUHJvdmlkZXIoJ2dvb2dsZS5jb20nKTtcbiAgICAgKiBjb25zdCBjcmVkZW50aWFsID0gcHJvdmlkZXIuY3JlZGVudGlhbCh7XG4gICAgICogICBpZFRva2VuOiBnb29nbGVVc2VyLmdldEF1dGhSZXNwb25zZSgpLmlkX3Rva2VuLFxuICAgICAqIH0pO1xuICAgICAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhDcmVkZW50aWFsKGNyZWRlbnRpYWwpO1xuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtcyAtIEVpdGhlciB0aGUgb3B0aW9ucyBvYmplY3QgY29udGFpbmluZyB0aGUgSUQgdG9rZW4sIGFjY2VzcyB0b2tlbiBhbmQgcmF3IG5vbmNlXG4gICAgICogb3IgdGhlIElEIHRva2VuIHN0cmluZy5cbiAgICAgKi9cbiAgICBjcmVkZW50aWFsKHBhcmFtcykge1xuICAgICAgICByZXR1cm4gdGhpcy5fY3JlZGVudGlhbCh7IC4uLnBhcmFtcywgbm9uY2U6IHBhcmFtcy5yYXdOb25jZSB9KTtcbiAgICB9XG4gICAgLyoqIEFuIGludGVybmFsIGNyZWRlbnRpYWwgbWV0aG9kIHRoYXQgYWNjZXB0cyBtb3JlIHBlcm1pc3NpdmUgb3B0aW9ucyAqL1xuICAgIF9jcmVkZW50aWFsKHBhcmFtcykge1xuICAgICAgICBfYXNzZXJ0KHBhcmFtcy5pZFRva2VuIHx8IHBhcmFtcy5hY2Nlc3NUb2tlbiwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IgKi8pO1xuICAgICAgICAvLyBGb3IgT0F1dGhDcmVkZW50aWFsLCBzaWduIGluIG1ldGhvZCBpcyBzYW1lIGFzIHByb3ZpZGVySWQuXG4gICAgICAgIHJldHVybiBPQXV0aENyZWRlbnRpYWwuX2Zyb21QYXJhbXMoe1xuICAgICAgICAgICAgLi4ucGFyYW1zLFxuICAgICAgICAgICAgcHJvdmlkZXJJZDogdGhpcy5wcm92aWRlcklkLFxuICAgICAgICAgICAgc2lnbkluTWV0aG9kOiB0aGlzLnByb3ZpZGVySWRcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIFVzZXJDcmVkZW50aWFsfS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXG4gICAgICovXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKSB7XG4gICAgICAgIHJldHVybiBPQXV0aFByb3ZpZGVyLm9hdXRoQ3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QodXNlckNyZWRlbnRpYWwpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBBdXRoRXJyb3J9IHdoaWNoIHdhc1xuICAgICAqIHRocm93biBkdXJpbmcgYSBzaWduLWluLCBsaW5rLCBvciByZWF1dGhlbnRpY2F0ZSBvcGVyYXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbUVycm9yKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBPQXV0aFByb3ZpZGVyLm9hdXRoQ3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoKGVycm9yLmN1c3RvbURhdGEgfHwge30pKTtcbiAgICB9XG4gICAgc3RhdGljIG9hdXRoQ3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoeyBfdG9rZW5SZXNwb25zZTogdG9rZW5SZXNwb25zZSB9KSB7XG4gICAgICAgIGlmICghdG9rZW5SZXNwb25zZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeyBvYXV0aElkVG9rZW4sIG9hdXRoQWNjZXNzVG9rZW4sIG9hdXRoVG9rZW5TZWNyZXQsIHBlbmRpbmdUb2tlbiwgbm9uY2UsIHByb3ZpZGVySWQgfSA9IHRva2VuUmVzcG9uc2U7XG4gICAgICAgIGlmICghb2F1dGhBY2Nlc3NUb2tlbiAmJlxuICAgICAgICAgICAgIW9hdXRoVG9rZW5TZWNyZXQgJiZcbiAgICAgICAgICAgICFvYXV0aElkVG9rZW4gJiZcbiAgICAgICAgICAgICFwZW5kaW5nVG9rZW4pIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcHJvdmlkZXJJZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgT0F1dGhQcm92aWRlcihwcm92aWRlcklkKS5fY3JlZGVudGlhbCh7XG4gICAgICAgICAgICAgICAgaWRUb2tlbjogb2F1dGhJZFRva2VuLFxuICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBvYXV0aEFjY2Vzc1Rva2VuLFxuICAgICAgICAgICAgICAgIG5vbmNlLFxuICAgICAgICAgICAgICAgIHBlbmRpbmdUb2tlblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBQcm92aWRlciBmb3IgZ2VuZXJhdGluZyBhbiB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmb3Ige0BsaW5rIFByb3ZpZGVySWR9LkZBQ0VCT09LLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcmVkaXJlY3QuXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBGYWNlYm9va0F1dGhQcm92aWRlcigpO1xuICogLy8gU3RhcnQgYSBzaWduIGluIHByb2Nlc3MgZm9yIGFuIHVuYXV0aGVudGljYXRlZCB1c2VyLlxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3VzZXJfYmlydGhkYXknKTtcbiAqIGF3YWl0IHNpZ25JbldpdGhSZWRpcmVjdChhdXRoLCBwcm92aWRlcik7XG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcbiAqXG4gKiAvLyBBZnRlciByZXR1cm5pbmcgZnJvbSB0aGUgcmVkaXJlY3Qgd2hlbiB5b3VyIGFwcCBpbml0aWFsaXplcyB5b3UgY2FuIG9idGFpbiB0aGUgcmVzdWx0XG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcbiAqIGlmIChyZXN1bHQpIHtcbiAqICAgLy8gVGhpcyBpcyB0aGUgc2lnbmVkLWluIHVzZXJcbiAqICAgY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xuICogICAvLyBUaGlzIGdpdmVzIHlvdSBhIEZhY2Vib29rIEFjY2VzcyBUb2tlbi5cbiAqICAgY29uc3QgY3JlZGVudGlhbCA9IEZhY2Vib29rQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KHJlc3VsdCk7XG4gKiAgIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcbiAqIH1cbiAqIGBgYFxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcG9wdXAuXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBGYWNlYm9va0F1dGhQcm92aWRlcigpO1xuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3VzZXJfYmlydGhkYXknKTtcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhQb3B1cChhdXRoLCBwcm92aWRlcik7XG4gKlxuICogLy8gVGhlIHNpZ25lZC1pbiB1c2VyIGluZm8uXG4gKiBjb25zdCB1c2VyID0gcmVzdWx0LnVzZXI7XG4gKiAvLyBUaGlzIGdpdmVzIHlvdSBhIEZhY2Vib29rIEFjY2VzcyBUb2tlbi5cbiAqIGNvbnN0IGNyZWRlbnRpYWwgPSBGYWNlYm9va0F1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChyZXN1bHQpO1xuICogY29uc3QgdG9rZW4gPSBjcmVkZW50aWFsLmFjY2Vzc1Rva2VuO1xuICogYGBgXG4gKlxuICogQHB1YmxpY1xuICovXG5jbGFzcyBGYWNlYm9va0F1dGhQcm92aWRlciBleHRlbmRzIEJhc2VPQXV0aFByb3ZpZGVyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoXCJmYWNlYm9vay5jb21cIiAvKiBQcm92aWRlcklkLkZBQ0VCT09LICovKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGNyZWRlbnRpYWwgZm9yIEZhY2Vib29rLlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBgYGBqYXZhc2NyaXB0XG4gICAgICogLy8gYGV2ZW50YCBmcm9tIHRoZSBGYWNlYm9vayBhdXRoLmF1dGhSZXNwb25zZUNoYW5nZSBjYWxsYmFjay5cbiAgICAgKiBjb25zdCBjcmVkZW50aWFsID0gRmFjZWJvb2tBdXRoUHJvdmlkZXIuY3JlZGVudGlhbChldmVudC5hdXRoUmVzcG9uc2UuYWNjZXNzVG9rZW4pO1xuICAgICAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhDcmVkZW50aWFsKGNyZWRlbnRpYWwpO1xuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogQHBhcmFtIGFjY2Vzc1Rva2VuIC0gRmFjZWJvb2sgYWNjZXNzIHRva2VuLlxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVkZW50aWFsKGFjY2Vzc1Rva2VuKSB7XG4gICAgICAgIHJldHVybiBPQXV0aENyZWRlbnRpYWwuX2Zyb21QYXJhbXMoe1xuICAgICAgICAgICAgcHJvdmlkZXJJZDogRmFjZWJvb2tBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQsXG4gICAgICAgICAgICBzaWduSW5NZXRob2Q6IEZhY2Vib29rQXV0aFByb3ZpZGVyLkZBQ0VCT09LX1NJR05fSU5fTUVUSE9ELFxuICAgICAgICAgICAgYWNjZXNzVG9rZW5cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIFVzZXJDcmVkZW50aWFsfS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXG4gICAgICovXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKSB7XG4gICAgICAgIHJldHVybiBGYWNlYm9va0F1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCh1c2VyQ3JlZGVudGlhbCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIEF1dGhFcnJvcn0gd2hpY2ggd2FzXG4gICAgICogdGhyb3duIGR1cmluZyBhIHNpZ24taW4sIGxpbmssIG9yIHJlYXV0aGVudGljYXRlIG9wZXJhdGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXG4gICAgICovXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tRXJyb3IoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIEZhY2Vib29rQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KChlcnJvci5jdXN0b21EYXRhIHx8IHt9KSk7XG4gICAgfVxuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCh7IF90b2tlblJlc3BvbnNlOiB0b2tlblJlc3BvbnNlIH0pIHtcbiAgICAgICAgaWYgKCF0b2tlblJlc3BvbnNlIHx8ICEoJ29hdXRoQWNjZXNzVG9rZW4nIGluIHRva2VuUmVzcG9uc2UpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRva2VuUmVzcG9uc2Uub2F1dGhBY2Nlc3NUb2tlbikge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBGYWNlYm9va0F1dGhQcm92aWRlci5jcmVkZW50aWFsKHRva2VuUmVzcG9uc2Uub2F1dGhBY2Nlc3NUb2tlbik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKiogQWx3YXlzIHNldCB0byB7QGxpbmsgU2lnbkluTWV0aG9kfS5GQUNFQk9PSy4gKi9cbkZhY2Vib29rQXV0aFByb3ZpZGVyLkZBQ0VCT09LX1NJR05fSU5fTUVUSE9EID0gXCJmYWNlYm9vay5jb21cIiAvKiBTaWduSW5NZXRob2QuRkFDRUJPT0sgKi87XG4vKiogQWx3YXlzIHNldCB0byB7QGxpbmsgUHJvdmlkZXJJZH0uRkFDRUJPT0suICovXG5GYWNlYm9va0F1dGhQcm92aWRlci5QUk9WSURFUl9JRCA9IFwiZmFjZWJvb2suY29tXCIgLyogUHJvdmlkZXJJZC5GQUNFQk9PSyAqLztcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcgYW4ge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZm9yIHtAbGluayBQcm92aWRlcklkfS5HT09HTEUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSByZWRpcmVjdC5cbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IEdvb2dsZUF1dGhQcm92aWRlcigpO1xuICogLy8gU3RhcnQgYSBzaWduIGluIHByb2Nlc3MgZm9yIGFuIHVuYXV0aGVudGljYXRlZCB1c2VyLlxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3Byb2ZpbGUnKTtcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCdlbWFpbCcpO1xuICogYXdhaXQgc2lnbkluV2l0aFJlZGlyZWN0KGF1dGgsIHByb3ZpZGVyKTtcbiAqIC8vIFRoaXMgd2lsbCB0cmlnZ2VyIGEgZnVsbCBwYWdlIHJlZGlyZWN0IGF3YXkgZnJvbSB5b3VyIGFwcFxuICpcbiAqIC8vIEFmdGVyIHJldHVybmluZyBmcm9tIHRoZSByZWRpcmVjdCB3aGVuIHlvdXIgYXBwIGluaXRpYWxpemVzIHlvdSBjYW4gb2J0YWluIHRoZSByZXN1bHRcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFJlZGlyZWN0UmVzdWx0KGF1dGgpO1xuICogaWYgKHJlc3VsdCkge1xuICogICAvLyBUaGlzIGlzIHRoZSBzaWduZWQtaW4gdXNlclxuICogICBjb25zdCB1c2VyID0gcmVzdWx0LnVzZXI7XG4gKiAgIC8vIFRoaXMgZ2l2ZXMgeW91IGEgR29vZ2xlIEFjY2VzcyBUb2tlbi5cbiAqICAgY29uc3QgY3JlZGVudGlhbCA9IEdvb2dsZUF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChyZXN1bHQpO1xuICogICBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gU2lnbiBpbiB1c2luZyBhIHBvcHVwLlxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgR29vZ2xlQXV0aFByb3ZpZGVyKCk7XG4gKiBwcm92aWRlci5hZGRTY29wZSgncHJvZmlsZScpO1xuICogcHJvdmlkZXIuYWRkU2NvcGUoJ2VtYWlsJyk7XG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoUG9wdXAoYXV0aCwgcHJvdmlkZXIpO1xuICpcbiAqIC8vIFRoZSBzaWduZWQtaW4gdXNlciBpbmZvLlxuICogY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xuICogLy8gVGhpcyBnaXZlcyB5b3UgYSBHb29nbGUgQWNjZXNzIFRva2VuLlxuICogY29uc3QgY3JlZGVudGlhbCA9IEdvb2dsZUF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChyZXN1bHQpO1xuICogY29uc3QgdG9rZW4gPSBjcmVkZW50aWFsLmFjY2Vzc1Rva2VuO1xuICogYGBgXG4gKlxuICogQHB1YmxpY1xuICovXG5jbGFzcyBHb29nbGVBdXRoUHJvdmlkZXIgZXh0ZW5kcyBCYXNlT0F1dGhQcm92aWRlciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKFwiZ29vZ2xlLmNvbVwiIC8qIFByb3ZpZGVySWQuR09PR0xFICovKTtcbiAgICAgICAgdGhpcy5hZGRTY29wZSgncHJvZmlsZScpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgY3JlZGVudGlhbCBmb3IgR29vZ2xlLiBBdCBsZWFzdCBvbmUgb2YgSUQgdG9rZW4gYW5kIGFjY2VzcyB0b2tlbiBpcyByZXF1aXJlZC5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogYGBgamF2YXNjcmlwdFxuICAgICAqIC8vIFxcYGdvb2dsZVVzZXJcXGAgZnJvbSB0aGUgb25zdWNjZXNzIEdvb2dsZSBTaWduIEluIGNhbGxiYWNrLlxuICAgICAqIGNvbnN0IGNyZWRlbnRpYWwgPSBHb29nbGVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbChnb29nbGVVc2VyLmdldEF1dGhSZXNwb25zZSgpLmlkX3Rva2VuKTtcbiAgICAgKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoQ3JlZGVudGlhbChjcmVkZW50aWFsKTtcbiAgICAgKiBgYGBcbiAgICAgKlxuICAgICAqIEBwYXJhbSBpZFRva2VuIC0gR29vZ2xlIElEIHRva2VuLlxuICAgICAqIEBwYXJhbSBhY2Nlc3NUb2tlbiAtIEdvb2dsZSBhY2Nlc3MgdG9rZW4uXG4gICAgICovXG4gICAgc3RhdGljIGNyZWRlbnRpYWwoaWRUb2tlbiwgYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIE9BdXRoQ3JlZGVudGlhbC5fZnJvbVBhcmFtcyh7XG4gICAgICAgICAgICBwcm92aWRlcklkOiBHb29nbGVBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQsXG4gICAgICAgICAgICBzaWduSW5NZXRob2Q6IEdvb2dsZUF1dGhQcm92aWRlci5HT09HTEVfU0lHTl9JTl9NRVRIT0QsXG4gICAgICAgICAgICBpZFRva2VuLFxuICAgICAgICAgICAgYWNjZXNzVG9rZW5cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIFVzZXJDcmVkZW50aWFsfS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXG4gICAgICovXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKSB7XG4gICAgICAgIHJldHVybiBHb29nbGVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QodXNlckNyZWRlbnRpYWwpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBBdXRoRXJyb3J9IHdoaWNoIHdhc1xuICAgICAqIHRocm93biBkdXJpbmcgYSBzaWduLWluLCBsaW5rLCBvciByZWF1dGhlbnRpY2F0ZSBvcGVyYXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbUVycm9yKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBHb29nbGVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoKGVycm9yLmN1c3RvbURhdGEgfHwge30pKTtcbiAgICB9XG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHsgX3Rva2VuUmVzcG9uc2U6IHRva2VuUmVzcG9uc2UgfSkge1xuICAgICAgICBpZiAoIXRva2VuUmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHsgb2F1dGhJZFRva2VuLCBvYXV0aEFjY2Vzc1Rva2VuIH0gPSB0b2tlblJlc3BvbnNlO1xuICAgICAgICBpZiAoIW9hdXRoSWRUb2tlbiAmJiAhb2F1dGhBY2Nlc3NUb2tlbikge1xuICAgICAgICAgICAgLy8gVGhpcyBjb3VsZCBiZSBhbiBvYXV0aCAxIGNyZWRlbnRpYWwgb3IgYSBwaG9uZSBjcmVkZW50aWFsXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIEdvb2dsZUF1dGhQcm92aWRlci5jcmVkZW50aWFsKG9hdXRoSWRUb2tlbiwgb2F1dGhBY2Nlc3NUb2tlbik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKiogQWx3YXlzIHNldCB0byB7QGxpbmsgU2lnbkluTWV0aG9kfS5HT09HTEUuICovXG5Hb29nbGVBdXRoUHJvdmlkZXIuR09PR0xFX1NJR05fSU5fTUVUSE9EID0gXCJnb29nbGUuY29tXCIgLyogU2lnbkluTWV0aG9kLkdPT0dMRSAqLztcbi8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBQcm92aWRlcklkfS5HT09HTEUuICovXG5Hb29nbGVBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQgPSBcImdvb2dsZS5jb21cIiAvKiBQcm92aWRlcklkLkdPT0dMRSAqLztcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcgYW4ge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZm9yIHtAbGluayBQcm92aWRlcklkfS5HSVRIVUIuXG4gKlxuICogQHJlbWFya3NcbiAqIEdpdEh1YiByZXF1aXJlcyBhbiBPQXV0aCAyLjAgcmVkaXJlY3QsIHNvIHlvdSBjYW4gZWl0aGVyIGhhbmRsZSB0aGUgcmVkaXJlY3QgZGlyZWN0bHksIG9yIHVzZVxuICogdGhlIHtAbGluayBzaWduSW5XaXRoUG9wdXB9IGhhbmRsZXI6XG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSByZWRpcmVjdC5cbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IEdpdGh1YkF1dGhQcm92aWRlcigpO1xuICogLy8gU3RhcnQgYSBzaWduIGluIHByb2Nlc3MgZm9yIGFuIHVuYXV0aGVudGljYXRlZCB1c2VyLlxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3JlcG8nKTtcbiAqIGF3YWl0IHNpZ25JbldpdGhSZWRpcmVjdChhdXRoLCBwcm92aWRlcik7XG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcbiAqXG4gKiAvLyBBZnRlciByZXR1cm5pbmcgZnJvbSB0aGUgcmVkaXJlY3Qgd2hlbiB5b3VyIGFwcCBpbml0aWFsaXplcyB5b3UgY2FuIG9idGFpbiB0aGUgcmVzdWx0XG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcbiAqIGlmIChyZXN1bHQpIHtcbiAqICAgLy8gVGhpcyBpcyB0aGUgc2lnbmVkLWluIHVzZXJcbiAqICAgY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xuICogICAvLyBUaGlzIGdpdmVzIHlvdSBhIEdpdEh1YiBBY2Nlc3MgVG9rZW4uXG4gKiAgIGNvbnN0IGNyZWRlbnRpYWwgPSBHaXRodWJBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQocmVzdWx0KTtcbiAqICAgY29uc3QgdG9rZW4gPSBjcmVkZW50aWFsLmFjY2Vzc1Rva2VuO1xuICogfVxuICogYGBgXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSBwb3B1cC5cbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IEdpdGh1YkF1dGhQcm92aWRlcigpO1xuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3JlcG8nKTtcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhQb3B1cChhdXRoLCBwcm92aWRlcik7XG4gKlxuICogLy8gVGhlIHNpZ25lZC1pbiB1c2VyIGluZm8uXG4gKiBjb25zdCB1c2VyID0gcmVzdWx0LnVzZXI7XG4gKiAvLyBUaGlzIGdpdmVzIHlvdSBhIEdpdEh1YiBBY2Nlc3MgVG9rZW4uXG4gKiBjb25zdCBjcmVkZW50aWFsID0gR2l0aHViQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KHJlc3VsdCk7XG4gKiBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XG4gKiBgYGBcbiAqIEBwdWJsaWNcbiAqL1xuY2xhc3MgR2l0aHViQXV0aFByb3ZpZGVyIGV4dGVuZHMgQmFzZU9BdXRoUHJvdmlkZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcihcImdpdGh1Yi5jb21cIiAvKiBQcm92aWRlcklkLkdJVEhVQiAqLyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBjcmVkZW50aWFsIGZvciBHaXRIdWIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYWNjZXNzVG9rZW4gLSBHaXRIdWIgYWNjZXNzIHRva2VuLlxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVkZW50aWFsKGFjY2Vzc1Rva2VuKSB7XG4gICAgICAgIHJldHVybiBPQXV0aENyZWRlbnRpYWwuX2Zyb21QYXJhbXMoe1xuICAgICAgICAgICAgcHJvdmlkZXJJZDogR2l0aHViQXV0aFByb3ZpZGVyLlBST1ZJREVSX0lELFxuICAgICAgICAgICAgc2lnbkluTWV0aG9kOiBHaXRodWJBdXRoUHJvdmlkZXIuR0lUSFVCX1NJR05fSU5fTUVUSE9ELFxuICAgICAgICAgICAgYWNjZXNzVG9rZW5cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIFVzZXJDcmVkZW50aWFsfS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXG4gICAgICovXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKSB7XG4gICAgICAgIHJldHVybiBHaXRodWJBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QodXNlckNyZWRlbnRpYWwpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBBdXRoRXJyb3J9IHdoaWNoIHdhc1xuICAgICAqIHRocm93biBkdXJpbmcgYSBzaWduLWluLCBsaW5rLCBvciByZWF1dGhlbnRpY2F0ZSBvcGVyYXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbUVycm9yKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBHaXRodWJBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoKGVycm9yLmN1c3RvbURhdGEgfHwge30pKTtcbiAgICB9XG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHsgX3Rva2VuUmVzcG9uc2U6IHRva2VuUmVzcG9uc2UgfSkge1xuICAgICAgICBpZiAoIXRva2VuUmVzcG9uc2UgfHwgISgnb2F1dGhBY2Nlc3NUb2tlbicgaW4gdG9rZW5SZXNwb25zZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdG9rZW5SZXNwb25zZS5vYXV0aEFjY2Vzc1Rva2VuKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIEdpdGh1YkF1dGhQcm92aWRlci5jcmVkZW50aWFsKHRva2VuUmVzcG9uc2Uub2F1dGhBY2Nlc3NUb2tlbik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKiogQWx3YXlzIHNldCB0byB7QGxpbmsgU2lnbkluTWV0aG9kfS5HSVRIVUIuICovXG5HaXRodWJBdXRoUHJvdmlkZXIuR0lUSFVCX1NJR05fSU5fTUVUSE9EID0gXCJnaXRodWIuY29tXCIgLyogU2lnbkluTWV0aG9kLkdJVEhVQiAqLztcbi8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBQcm92aWRlcklkfS5HSVRIVUIuICovXG5HaXRodWJBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQgPSBcImdpdGh1Yi5jb21cIiAvKiBQcm92aWRlcklkLkdJVEhVQiAqLztcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IElEUF9SRVFVRVNUX1VSSSA9ICdodHRwOi8vbG9jYWxob3N0Jztcbi8qKlxuICogQHB1YmxpY1xuICovXG5jbGFzcyBTQU1MQXV0aENyZWRlbnRpYWwgZXh0ZW5kcyBBdXRoQ3JlZGVudGlhbCB7XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIGNvbnN0cnVjdG9yKHByb3ZpZGVySWQsIHBlbmRpbmdUb2tlbikge1xuICAgICAgICBzdXBlcihwcm92aWRlcklkLCBwcm92aWRlcklkKTtcbiAgICAgICAgdGhpcy5wZW5kaW5nVG9rZW4gPSBwZW5kaW5nVG9rZW47XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBfZ2V0SWRUb2tlblJlc3BvbnNlKGF1dGgpIHtcbiAgICAgICAgY29uc3QgcmVxdWVzdCA9IHRoaXMuYnVpbGRSZXF1ZXN0KCk7XG4gICAgICAgIHJldHVybiBzaWduSW5XaXRoSWRwKGF1dGgsIHJlcXVlc3QpO1xuICAgIH1cbiAgICAvKiogQGludGVybmFsICovXG4gICAgX2xpbmtUb0lkVG9rZW4oYXV0aCwgaWRUb2tlbikge1xuICAgICAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5idWlsZFJlcXVlc3QoKTtcbiAgICAgICAgcmVxdWVzdC5pZFRva2VuID0gaWRUb2tlbjtcbiAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhJZHAoYXV0aCwgcmVxdWVzdCk7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBfZ2V0UmVhdXRoZW50aWNhdGlvblJlc29sdmVyKGF1dGgpIHtcbiAgICAgICAgY29uc3QgcmVxdWVzdCA9IHRoaXMuYnVpbGRSZXF1ZXN0KCk7XG4gICAgICAgIHJlcXVlc3QuYXV0b0NyZWF0ZSA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gc2lnbkluV2l0aElkcChhdXRoLCByZXF1ZXN0KTtcbiAgICB9XG4gICAgLyoqIHtAaW5oZXJpdGRvYyBBdXRoQ3JlZGVudGlhbC50b0pTT059ICAqL1xuICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNpZ25Jbk1ldGhvZDogdGhpcy5zaWduSW5NZXRob2QsXG4gICAgICAgICAgICBwcm92aWRlcklkOiB0aGlzLnByb3ZpZGVySWQsXG4gICAgICAgICAgICBwZW5kaW5nVG9rZW46IHRoaXMucGVuZGluZ1Rva2VuXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXRpYyBtZXRob2QgdG8gZGVzZXJpYWxpemUgYSBKU09OIHJlcHJlc2VudGF0aW9uIG9mIGFuIG9iamVjdCBpbnRvIGFuXG4gICAgICoge0BsaW5rICBBdXRoQ3JlZGVudGlhbH0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ganNvbiAtIElucHV0IGNhbiBiZSBlaXRoZXIgT2JqZWN0IG9yIHRoZSBzdHJpbmdpZmllZCByZXByZXNlbnRhdGlvbiBvZiB0aGUgb2JqZWN0LlxuICAgICAqIFdoZW4gc3RyaW5nIGlzIHByb3ZpZGVkLCBKU09OLnBhcnNlIHdvdWxkIGJlIGNhbGxlZCBmaXJzdC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIElmIHRoZSBKU09OIGlucHV0IGRvZXMgbm90IHJlcHJlc2VudCBhbiB7QGxpbmsgIEF1dGhDcmVkZW50aWFsfSwgbnVsbCBpcyByZXR1cm5lZC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbUpTT04oanNvbikge1xuICAgICAgICBjb25zdCBvYmogPSB0eXBlb2YganNvbiA9PT0gJ3N0cmluZycgPyBKU09OLnBhcnNlKGpzb24pIDoganNvbjtcbiAgICAgICAgY29uc3QgeyBwcm92aWRlcklkLCBzaWduSW5NZXRob2QsIHBlbmRpbmdUb2tlbiB9ID0gb2JqO1xuICAgICAgICBpZiAoIXByb3ZpZGVySWQgfHxcbiAgICAgICAgICAgICFzaWduSW5NZXRob2QgfHxcbiAgICAgICAgICAgICFwZW5kaW5nVG9rZW4gfHxcbiAgICAgICAgICAgIHByb3ZpZGVySWQgIT09IHNpZ25Jbk1ldGhvZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBTQU1MQXV0aENyZWRlbnRpYWwocHJvdmlkZXJJZCwgcGVuZGluZ1Rva2VuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSGVscGVyIHN0YXRpYyBtZXRob2QgdG8gYXZvaWQgZXhwb3NpbmcgdGhlIGNvbnN0cnVjdG9yIHRvIGVuZCB1c2Vycy5cbiAgICAgKlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIHN0YXRpYyBfY3JlYXRlKHByb3ZpZGVySWQsIHBlbmRpbmdUb2tlbikge1xuICAgICAgICByZXR1cm4gbmV3IFNBTUxBdXRoQ3JlZGVudGlhbChwcm92aWRlcklkLCBwZW5kaW5nVG9rZW4pO1xuICAgIH1cbiAgICBidWlsZFJlcXVlc3QoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXF1ZXN0VXJpOiBJRFBfUkVRVUVTVF9VUkksXG4gICAgICAgICAgICByZXR1cm5TZWN1cmVUb2tlbjogdHJ1ZSxcbiAgICAgICAgICAgIHBlbmRpbmdUb2tlbjogdGhpcy5wZW5kaW5nVG9rZW5cbiAgICAgICAgfTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jb25zdCBTQU1MX1BST1ZJREVSX1BSRUZJWCA9ICdzYW1sLic7XG4vKipcbiAqIEFuIHtAbGluayBBdXRoUHJvdmlkZXJ9IGZvciBTQU1MLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuY2xhc3MgU0FNTEF1dGhQcm92aWRlciBleHRlbmRzIEZlZGVyYXRlZEF1dGhQcm92aWRlciB7XG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0b3IuIFRoZSBwcm92aWRlcklkIG11c3Qgc3RhcnQgd2l0aCBcInNhbWwuXCJcbiAgICAgKiBAcGFyYW0gcHJvdmlkZXJJZCAtIFNBTUwgcHJvdmlkZXIgSUQuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocHJvdmlkZXJJZCkge1xuICAgICAgICBfYXNzZXJ0KHByb3ZpZGVySWQuc3RhcnRzV2l0aChTQU1MX1BST1ZJREVSX1BSRUZJWCksIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SICovKTtcbiAgICAgICAgc3VwZXIocHJvdmlkZXJJZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdlbmVyYXRlcyBhbiB7QGxpbmsgQXV0aENyZWRlbnRpYWx9IGZyb20gYSB7QGxpbmsgVXNlckNyZWRlbnRpYWx9IGFmdGVyIGFcbiAgICAgKiBzdWNjZXNzZnVsIFNBTUwgZmxvdyBjb21wbGV0ZXMuXG4gICAgICpcbiAgICAgKiBAcmVtYXJrc1xuICAgICAqXG4gICAgICogRm9yIGV4YW1wbGUsIHRvIGdldCBhbiB7QGxpbmsgQXV0aENyZWRlbnRpYWx9LCB5b3UgY291bGQgd3JpdGUgdGhlXG4gICAgICogZm9sbG93aW5nIGNvZGU6XG4gICAgICpcbiAgICAgKiBgYGBqc1xuICAgICAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgc2lnbkluV2l0aFBvcHVwKGF1dGgsIHNhbWxQcm92aWRlcik7XG4gICAgICogY29uc3QgY3JlZGVudGlhbCA9IFNBTUxBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQodXNlckNyZWRlbnRpYWwpO1xuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21SZXN1bHQodXNlckNyZWRlbnRpYWwpIHtcbiAgICAgICAgcmV0dXJuIFNBTUxBdXRoUHJvdmlkZXIuc2FtbENyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHVzZXJDcmVkZW50aWFsKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXNlZCB0byBleHRyYWN0IHRoZSB1bmRlcmx5aW5nIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZyb20gYSB7QGxpbmsgQXV0aEVycm9yfSB3aGljaCB3YXNcbiAgICAgKiB0aHJvd24gZHVyaW5nIGEgc2lnbi1pbiwgbGluaywgb3IgcmVhdXRoZW50aWNhdGUgb3BlcmF0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21FcnJvcihlcnJvcikge1xuICAgICAgICByZXR1cm4gU0FNTEF1dGhQcm92aWRlci5zYW1sQ3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoKGVycm9yLmN1c3RvbURhdGEgfHwge30pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiB7QGxpbmsgQXV0aENyZWRlbnRpYWx9IGZyb20gYSBKU09OIHN0cmluZyBvciBhIHBsYWluIG9iamVjdC5cbiAgICAgKiBAcGFyYW0ganNvbiAtIEEgcGxhaW4gb2JqZWN0IG9yIGEgSlNPTiBzdHJpbmdcbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21KU09OKGpzb24pIHtcbiAgICAgICAgY29uc3QgY3JlZGVudGlhbCA9IFNBTUxBdXRoQ3JlZGVudGlhbC5mcm9tSlNPTihqc29uKTtcbiAgICAgICAgX2Fzc2VydChjcmVkZW50aWFsLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUiAqLyk7XG4gICAgICAgIHJldHVybiBjcmVkZW50aWFsO1xuICAgIH1cbiAgICBzdGF0aWMgc2FtbENyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHsgX3Rva2VuUmVzcG9uc2U6IHRva2VuUmVzcG9uc2UgfSkge1xuICAgICAgICBpZiAoIXRva2VuUmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHsgcGVuZGluZ1Rva2VuLCBwcm92aWRlcklkIH0gPSB0b2tlblJlc3BvbnNlO1xuICAgICAgICBpZiAoIXBlbmRpbmdUb2tlbiB8fCAhcHJvdmlkZXJJZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBTQU1MQXV0aENyZWRlbnRpYWwuX2NyZWF0ZShwcm92aWRlcklkLCBwZW5kaW5nVG9rZW4pO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcgYW4ge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZm9yIHtAbGluayBQcm92aWRlcklkfS5UV0lUVEVSLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcmVkaXJlY3QuXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBUd2l0dGVyQXV0aFByb3ZpZGVyKCk7XG4gKiAvLyBTdGFydCBhIHNpZ24gaW4gcHJvY2VzcyBmb3IgYW4gdW5hdXRoZW50aWNhdGVkIHVzZXIuXG4gKiBhd2FpdCBzaWduSW5XaXRoUmVkaXJlY3QoYXV0aCwgcHJvdmlkZXIpO1xuICogLy8gVGhpcyB3aWxsIHRyaWdnZXIgYSBmdWxsIHBhZ2UgcmVkaXJlY3QgYXdheSBmcm9tIHlvdXIgYXBwXG4gKlxuICogLy8gQWZ0ZXIgcmV0dXJuaW5nIGZyb20gdGhlIHJlZGlyZWN0IHdoZW4geW91ciBhcHAgaW5pdGlhbGl6ZXMgeW91IGNhbiBvYnRhaW4gdGhlIHJlc3VsdFxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0UmVkaXJlY3RSZXN1bHQoYXV0aCk7XG4gKiBpZiAocmVzdWx0KSB7XG4gKiAgIC8vIFRoaXMgaXMgdGhlIHNpZ25lZC1pbiB1c2VyXG4gKiAgIGNvbnN0IHVzZXIgPSByZXN1bHQudXNlcjtcbiAqICAgLy8gVGhpcyBnaXZlcyB5b3UgYSBUd2l0dGVyIEFjY2VzcyBUb2tlbiBhbmQgU2VjcmV0LlxuICogICBjb25zdCBjcmVkZW50aWFsID0gVHdpdHRlckF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChyZXN1bHQpO1xuICogICBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XG4gKiAgIGNvbnN0IHNlY3JldCA9IGNyZWRlbnRpYWwuc2VjcmV0O1xuICogfVxuICogYGBgXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSBwb3B1cC5cbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IFR3aXR0ZXJBdXRoUHJvdmlkZXIoKTtcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhQb3B1cChhdXRoLCBwcm92aWRlcik7XG4gKlxuICogLy8gVGhlIHNpZ25lZC1pbiB1c2VyIGluZm8uXG4gKiBjb25zdCB1c2VyID0gcmVzdWx0LnVzZXI7XG4gKiAvLyBUaGlzIGdpdmVzIHlvdSBhIFR3aXR0ZXIgQWNjZXNzIFRva2VuIGFuZCBTZWNyZXQuXG4gKiBjb25zdCBjcmVkZW50aWFsID0gVHdpdHRlckF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChyZXN1bHQpO1xuICogY29uc3QgdG9rZW4gPSBjcmVkZW50aWFsLmFjY2Vzc1Rva2VuO1xuICogY29uc3Qgc2VjcmV0ID0gY3JlZGVudGlhbC5zZWNyZXQ7XG4gKiBgYGBcbiAqXG4gKiBAcHVibGljXG4gKi9cbmNsYXNzIFR3aXR0ZXJBdXRoUHJvdmlkZXIgZXh0ZW5kcyBCYXNlT0F1dGhQcm92aWRlciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKFwidHdpdHRlci5jb21cIiAvKiBQcm92aWRlcklkLlRXSVRURVIgKi8pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgY3JlZGVudGlhbCBmb3IgVHdpdHRlci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0b2tlbiAtIFR3aXR0ZXIgYWNjZXNzIHRva2VuLlxuICAgICAqIEBwYXJhbSBzZWNyZXQgLSBUd2l0dGVyIHNlY3JldC5cbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlZGVudGlhbCh0b2tlbiwgc2VjcmV0KSB7XG4gICAgICAgIHJldHVybiBPQXV0aENyZWRlbnRpYWwuX2Zyb21QYXJhbXMoe1xuICAgICAgICAgICAgcHJvdmlkZXJJZDogVHdpdHRlckF1dGhQcm92aWRlci5QUk9WSURFUl9JRCxcbiAgICAgICAgICAgIHNpZ25Jbk1ldGhvZDogVHdpdHRlckF1dGhQcm92aWRlci5UV0lUVEVSX1NJR05fSU5fTUVUSE9ELFxuICAgICAgICAgICAgb2F1dGhUb2tlbjogdG9rZW4sXG4gICAgICAgICAgICBvYXV0aFRva2VuU2VjcmV0OiBzZWNyZXRcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIFVzZXJDcmVkZW50aWFsfS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXG4gICAgICovXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKSB7XG4gICAgICAgIHJldHVybiBUd2l0dGVyQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHVzZXJDcmVkZW50aWFsKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXNlZCB0byBleHRyYWN0IHRoZSB1bmRlcmx5aW5nIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZyb20gYSB7QGxpbmsgQXV0aEVycm9yfSB3aGljaCB3YXNcbiAgICAgKiB0aHJvd24gZHVyaW5nIGEgc2lnbi1pbiwgbGluaywgb3IgcmVhdXRoZW50aWNhdGUgb3BlcmF0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21FcnJvcihlcnJvcikge1xuICAgICAgICByZXR1cm4gVHdpdHRlckF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCgoZXJyb3IuY3VzdG9tRGF0YSB8fCB7fSkpO1xuICAgIH1cbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoeyBfdG9rZW5SZXNwb25zZTogdG9rZW5SZXNwb25zZSB9KSB7XG4gICAgICAgIGlmICghdG9rZW5SZXNwb25zZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeyBvYXV0aEFjY2Vzc1Rva2VuLCBvYXV0aFRva2VuU2VjcmV0IH0gPSB0b2tlblJlc3BvbnNlO1xuICAgICAgICBpZiAoIW9hdXRoQWNjZXNzVG9rZW4gfHwgIW9hdXRoVG9rZW5TZWNyZXQpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gVHdpdHRlckF1dGhQcm92aWRlci5jcmVkZW50aWFsKG9hdXRoQWNjZXNzVG9rZW4sIG9hdXRoVG9rZW5TZWNyZXQpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxufVxuLyoqIEFsd2F5cyBzZXQgdG8ge0BsaW5rIFNpZ25Jbk1ldGhvZH0uVFdJVFRFUi4gKi9cblR3aXR0ZXJBdXRoUHJvdmlkZXIuVFdJVFRFUl9TSUdOX0lOX01FVEhPRCA9IFwidHdpdHRlci5jb21cIiAvKiBTaWduSW5NZXRob2QuVFdJVFRFUiAqLztcbi8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBQcm92aWRlcklkfS5UV0lUVEVSLiAqL1xuVHdpdHRlckF1dGhQcm92aWRlci5QUk9WSURFUl9JRCA9IFwidHdpdHRlci5jb21cIiAvKiBQcm92aWRlcklkLlRXSVRURVIgKi87XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5hc3luYyBmdW5jdGlvbiBzaWduVXAoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybVNpZ25JblJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92MS9hY2NvdW50czpzaWduVXBcIiAvKiBFbmRwb2ludC5TSUdOX1VQICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3MgVXNlckNyZWRlbnRpYWxJbXBsIHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXMpIHtcbiAgICAgICAgdGhpcy51c2VyID0gcGFyYW1zLnVzZXI7XG4gICAgICAgIHRoaXMucHJvdmlkZXJJZCA9IHBhcmFtcy5wcm92aWRlcklkO1xuICAgICAgICB0aGlzLl90b2tlblJlc3BvbnNlID0gcGFyYW1zLl90b2tlblJlc3BvbnNlO1xuICAgICAgICB0aGlzLm9wZXJhdGlvblR5cGUgPSBwYXJhbXMub3BlcmF0aW9uVHlwZTtcbiAgICB9XG4gICAgc3RhdGljIGFzeW5jIF9mcm9tSWRUb2tlblJlc3BvbnNlKGF1dGgsIG9wZXJhdGlvblR5cGUsIGlkVG9rZW5SZXNwb25zZSwgaXNBbm9ueW1vdXMgPSBmYWxzZSkge1xuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlckltcGwuX2Zyb21JZFRva2VuUmVzcG9uc2UoYXV0aCwgaWRUb2tlblJlc3BvbnNlLCBpc0Fub255bW91cyk7XG4gICAgICAgIGNvbnN0IHByb3ZpZGVySWQgPSBwcm92aWRlcklkRm9yUmVzcG9uc2UoaWRUb2tlblJlc3BvbnNlKTtcbiAgICAgICAgY29uc3QgdXNlckNyZWQgPSBuZXcgVXNlckNyZWRlbnRpYWxJbXBsKHtcbiAgICAgICAgICAgIHVzZXIsXG4gICAgICAgICAgICBwcm92aWRlcklkLFxuICAgICAgICAgICAgX3Rva2VuUmVzcG9uc2U6IGlkVG9rZW5SZXNwb25zZSxcbiAgICAgICAgICAgIG9wZXJhdGlvblR5cGVcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB1c2VyQ3JlZDtcbiAgICB9XG4gICAgc3RhdGljIGFzeW5jIF9mb3JPcGVyYXRpb24odXNlciwgb3BlcmF0aW9uVHlwZSwgcmVzcG9uc2UpIHtcbiAgICAgICAgYXdhaXQgdXNlci5fdXBkYXRlVG9rZW5zSWZOZWNlc3NhcnkocmVzcG9uc2UsIC8qIHJlbG9hZCAqLyB0cnVlKTtcbiAgICAgICAgY29uc3QgcHJvdmlkZXJJZCA9IHByb3ZpZGVySWRGb3JSZXNwb25zZShyZXNwb25zZSk7XG4gICAgICAgIHJldHVybiBuZXcgVXNlckNyZWRlbnRpYWxJbXBsKHtcbiAgICAgICAgICAgIHVzZXIsXG4gICAgICAgICAgICBwcm92aWRlcklkLFxuICAgICAgICAgICAgX3Rva2VuUmVzcG9uc2U6IHJlc3BvbnNlLFxuICAgICAgICAgICAgb3BlcmF0aW9uVHlwZVxuICAgICAgICB9KTtcbiAgICB9XG59XG5mdW5jdGlvbiBwcm92aWRlcklkRm9yUmVzcG9uc2UocmVzcG9uc2UpIHtcbiAgICBpZiAocmVzcG9uc2UucHJvdmlkZXJJZCkge1xuICAgICAgICByZXR1cm4gcmVzcG9uc2UucHJvdmlkZXJJZDtcbiAgICB9XG4gICAgaWYgKCdwaG9uZU51bWJlcicgaW4gcmVzcG9uc2UpIHtcbiAgICAgICAgcmV0dXJuIFwicGhvbmVcIiAvKiBQcm92aWRlcklkLlBIT05FICovO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQXN5bmNocm9ub3VzbHkgc2lnbnMgaW4gYXMgYW4gYW5vbnltb3VzIHVzZXIuXG4gKlxuICogQHJlbWFya3NcbiAqIElmIHRoZXJlIGlzIGFscmVhZHkgYW4gYW5vbnltb3VzIHVzZXIgc2lnbmVkIGluLCB0aGF0IHVzZXIgd2lsbCBiZSByZXR1cm5lZDsgb3RoZXJ3aXNlLCBhXG4gKiBuZXcgYW5vbnltb3VzIHVzZXIgaWRlbnRpdHkgd2lsbCBiZSBjcmVhdGVkIGFuZCByZXR1cm5lZC5cbiAqXG4gKiBUaGlzIG1ldGhvZCBpcyBub3Qgc3VwcG9ydGVkIGJ5IHtAbGluayBBdXRofSBpbnN0YW5jZXMgY3JlYXRlZCB3aXRoIGFcbiAqIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlU2VydmVyQXBwfS5cbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiBzaWduSW5Bbm9ueW1vdXNseShhdXRoKSB7XG4gICAgaWYgKF9pc0ZpcmViYXNlU2VydmVyQXBwKGF1dGguYXBwKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoX3NlcnZlckFwcEN1cnJlbnRVc2VyT3BlcmF0aW9uTm90U3VwcG9ydGVkRXJyb3IoYXV0aCkpO1xuICAgIH1cbiAgICBjb25zdCBhdXRoSW50ZXJuYWwgPSBfY2FzdEF1dGgoYXV0aCk7XG4gICAgYXdhaXQgYXV0aEludGVybmFsLl9pbml0aWFsaXphdGlvblByb21pc2U7XG4gICAgaWYgKGF1dGhJbnRlcm5hbC5jdXJyZW50VXNlcj8uaXNBbm9ueW1vdXMpIHtcbiAgICAgICAgLy8gSWYgYW4gYW5vbnltb3VzIHVzZXIgaXMgYWxyZWFkeSBzaWduZWQgaW4sIG5vIG5lZWQgdG8gc2lnbiB0aGVtIGluIGFnYWluLlxuICAgICAgICByZXR1cm4gbmV3IFVzZXJDcmVkZW50aWFsSW1wbCh7XG4gICAgICAgICAgICB1c2VyOiBhdXRoSW50ZXJuYWwuY3VycmVudFVzZXIsXG4gICAgICAgICAgICBwcm92aWRlcklkOiBudWxsLFxuICAgICAgICAgICAgb3BlcmF0aW9uVHlwZTogXCJzaWduSW5cIiAvKiBPcGVyYXRpb25UeXBlLlNJR05fSU4gKi9cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgc2lnblVwKGF1dGhJbnRlcm5hbCwge1xuICAgICAgICByZXR1cm5TZWN1cmVUb2tlbjogdHJ1ZVxuICAgIH0pO1xuICAgIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgVXNlckNyZWRlbnRpYWxJbXBsLl9mcm9tSWRUb2tlblJlc3BvbnNlKGF1dGhJbnRlcm5hbCwgXCJzaWduSW5cIiAvKiBPcGVyYXRpb25UeXBlLlNJR05fSU4gKi8sIHJlc3BvbnNlLCB0cnVlKTtcbiAgICBhd2FpdCBhdXRoSW50ZXJuYWwuX3VwZGF0ZUN1cnJlbnRVc2VyKHVzZXJDcmVkZW50aWFsLnVzZXIpO1xuICAgIHJldHVybiB1c2VyQ3JlZGVudGlhbDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNsYXNzIE11bHRpRmFjdG9yRXJyb3IgZXh0ZW5kcyBGaXJlYmFzZUVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihhdXRoLCBlcnJvciwgb3BlcmF0aW9uVHlwZSwgdXNlcikge1xuICAgICAgICBzdXBlcihlcnJvci5jb2RlLCBlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgdGhpcy5vcGVyYXRpb25UeXBlID0gb3BlcmF0aW9uVHlwZTtcbiAgICAgICAgdGhpcy51c2VyID0gdXNlcjtcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL01pY3Jvc29mdC9UeXBlU2NyaXB0LXdpa2kvYmxvYi9tYXN0ZXIvQnJlYWtpbmctQ2hhbmdlcy5tZCNleHRlbmRpbmctYnVpbHQtaW5zLWxpa2UtZXJyb3ItYXJyYXktYW5kLW1hcC1tYXktbm8tbG9uZ2VyLXdvcmtcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsIE11bHRpRmFjdG9yRXJyb3IucHJvdG90eXBlKTtcbiAgICAgICAgdGhpcy5jdXN0b21EYXRhID0ge1xuICAgICAgICAgICAgYXBwTmFtZTogYXV0aC5uYW1lLFxuICAgICAgICAgICAgdGVuYW50SWQ6IGF1dGgudGVuYW50SWQgPz8gdW5kZWZpbmVkLFxuICAgICAgICAgICAgX3NlcnZlclJlc3BvbnNlOiBlcnJvci5jdXN0b21EYXRhLl9zZXJ2ZXJSZXNwb25zZSxcbiAgICAgICAgICAgIG9wZXJhdGlvblR5cGVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgc3RhdGljIF9mcm9tRXJyb3JBbmRPcGVyYXRpb24oYXV0aCwgZXJyb3IsIG9wZXJhdGlvblR5cGUsIHVzZXIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNdWx0aUZhY3RvckVycm9yKGF1dGgsIGVycm9yLCBvcGVyYXRpb25UeXBlLCB1c2VyKTtcbiAgICB9XG59XG5mdW5jdGlvbiBfcHJvY2Vzc0NyZWRlbnRpYWxTYXZpbmdNZmFDb250ZXh0SWZOZWNlc3NhcnkoYXV0aCwgb3BlcmF0aW9uVHlwZSwgY3JlZGVudGlhbCwgdXNlcikge1xuICAgIGNvbnN0IGlkVG9rZW5Qcm92aWRlciA9IG9wZXJhdGlvblR5cGUgPT09IFwicmVhdXRoZW50aWNhdGVcIiAvKiBPcGVyYXRpb25UeXBlLlJFQVVUSEVOVElDQVRFICovXG4gICAgICAgID8gY3JlZGVudGlhbC5fZ2V0UmVhdXRoZW50aWNhdGlvblJlc29sdmVyKGF1dGgpXG4gICAgICAgIDogY3JlZGVudGlhbC5fZ2V0SWRUb2tlblJlc3BvbnNlKGF1dGgpO1xuICAgIHJldHVybiBpZFRva2VuUHJvdmlkZXIuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICBpZiAoZXJyb3IuY29kZSA9PT0gYGF1dGgvJHtcIm11bHRpLWZhY3Rvci1hdXRoLXJlcXVpcmVkXCIgLyogQXV0aEVycm9yQ29kZS5NRkFfUkVRVUlSRUQgKi99YCkge1xuICAgICAgICAgICAgdGhyb3cgTXVsdGlGYWN0b3JFcnJvci5fZnJvbUVycm9yQW5kT3BlcmF0aW9uKGF1dGgsIGVycm9yLCBvcGVyYXRpb25UeXBlLCB1c2VyKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICB9KTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVGFrZXMgYSBzZXQgb2YgVXNlckluZm8gcHJvdmlkZXIgZGF0YSBhbmQgY29udmVydHMgaXQgdG8gYSBzZXQgb2YgbmFtZXNcbiAqL1xuZnVuY3Rpb24gcHJvdmlkZXJEYXRhQXNOYW1lcyhwcm92aWRlckRhdGEpIHtcbiAgICByZXR1cm4gbmV3IFNldChwcm92aWRlckRhdGFcbiAgICAgICAgLm1hcCgoeyBwcm92aWRlcklkIH0pID0+IHByb3ZpZGVySWQpXG4gICAgICAgIC5maWx0ZXIocGlkID0+ICEhcGlkKSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFVubGlua3MgYSBwcm92aWRlciBmcm9tIGEgdXNlciBhY2NvdW50LlxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gcHJvdmlkZXJJZCAtIFRoZSBwcm92aWRlciB0byB1bmxpbmsuXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiB1bmxpbmsodXNlciwgcHJvdmlkZXJJZCkge1xuICAgIGNvbnN0IHVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKTtcbiAgICBhd2FpdCBfYXNzZXJ0TGlua2VkU3RhdHVzKHRydWUsIHVzZXJJbnRlcm5hbCwgcHJvdmlkZXJJZCk7XG4gICAgY29uc3QgeyBwcm92aWRlclVzZXJJbmZvIH0gPSBhd2FpdCBkZWxldGVMaW5rZWRBY2NvdW50cyh1c2VySW50ZXJuYWwuYXV0aCwge1xuICAgICAgICBpZFRva2VuOiBhd2FpdCB1c2VySW50ZXJuYWwuZ2V0SWRUb2tlbigpLFxuICAgICAgICBkZWxldGVQcm92aWRlcjogW3Byb3ZpZGVySWRdXG4gICAgfSk7XG4gICAgY29uc3QgcHJvdmlkZXJzTGVmdCA9IHByb3ZpZGVyRGF0YUFzTmFtZXMocHJvdmlkZXJVc2VySW5mbyB8fCBbXSk7XG4gICAgdXNlckludGVybmFsLnByb3ZpZGVyRGF0YSA9IHVzZXJJbnRlcm5hbC5wcm92aWRlckRhdGEuZmlsdGVyKHBkID0+IHByb3ZpZGVyc0xlZnQuaGFzKHBkLnByb3ZpZGVySWQpKTtcbiAgICBpZiAoIXByb3ZpZGVyc0xlZnQuaGFzKFwicGhvbmVcIiAvKiBQcm92aWRlcklkLlBIT05FICovKSkge1xuICAgICAgICB1c2VySW50ZXJuYWwucGhvbmVOdW1iZXIgPSBudWxsO1xuICAgIH1cbiAgICBhd2FpdCB1c2VySW50ZXJuYWwuYXV0aC5fcGVyc2lzdFVzZXJJZkN1cnJlbnQodXNlckludGVybmFsKTtcbiAgICByZXR1cm4gdXNlckludGVybmFsO1xufVxuYXN5bmMgZnVuY3Rpb24gX2xpbmskMSh1c2VyLCBjcmVkZW50aWFsLCBieXBhc3NBdXRoU3RhdGUgPSBmYWxzZSkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgX2xvZ291dElmSW52YWxpZGF0ZWQodXNlciwgY3JlZGVudGlhbC5fbGlua1RvSWRUb2tlbih1c2VyLmF1dGgsIGF3YWl0IHVzZXIuZ2V0SWRUb2tlbigpKSwgYnlwYXNzQXV0aFN0YXRlKTtcbiAgICByZXR1cm4gVXNlckNyZWRlbnRpYWxJbXBsLl9mb3JPcGVyYXRpb24odXNlciwgXCJsaW5rXCIgLyogT3BlcmF0aW9uVHlwZS5MSU5LICovLCByZXNwb25zZSk7XG59XG5hc3luYyBmdW5jdGlvbiBfYXNzZXJ0TGlua2VkU3RhdHVzKGV4cGVjdGVkLCB1c2VyLCBwcm92aWRlcikge1xuICAgIGF3YWl0IF9yZWxvYWRXaXRob3V0U2F2aW5nKHVzZXIpO1xuICAgIGNvbnN0IHByb3ZpZGVySWRzID0gcHJvdmlkZXJEYXRhQXNOYW1lcyh1c2VyLnByb3ZpZGVyRGF0YSk7XG4gICAgY29uc3QgY29kZSA9IGV4cGVjdGVkID09PSBmYWxzZVxuICAgICAgICA/IFwicHJvdmlkZXItYWxyZWFkeS1saW5rZWRcIiAvKiBBdXRoRXJyb3JDb2RlLlBST1ZJREVSX0FMUkVBRFlfTElOS0VEICovXG4gICAgICAgIDogXCJuby1zdWNoLXByb3ZpZGVyXCIgLyogQXV0aEVycm9yQ29kZS5OT19TVUNIX1BST1ZJREVSICovO1xuICAgIF9hc3NlcnQocHJvdmlkZXJJZHMuaGFzKHByb3ZpZGVyKSA9PT0gZXhwZWN0ZWQsIHVzZXIuYXV0aCwgY29kZSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5hc3luYyBmdW5jdGlvbiBfcmVhdXRoZW50aWNhdGUodXNlciwgY3JlZGVudGlhbCwgYnlwYXNzQXV0aFN0YXRlID0gZmFsc2UpIHtcbiAgICBjb25zdCB7IGF1dGggfSA9IHVzZXI7XG4gICAgaWYgKF9pc0ZpcmViYXNlU2VydmVyQXBwKGF1dGguYXBwKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoX3NlcnZlckFwcEN1cnJlbnRVc2VyT3BlcmF0aW9uTm90U3VwcG9ydGVkRXJyb3IoYXV0aCkpO1xuICAgIH1cbiAgICBjb25zdCBvcGVyYXRpb25UeXBlID0gXCJyZWF1dGhlbnRpY2F0ZVwiIC8qIE9wZXJhdGlvblR5cGUuUkVBVVRIRU5USUNBVEUgKi87XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBfbG9nb3V0SWZJbnZhbGlkYXRlZCh1c2VyLCBfcHJvY2Vzc0NyZWRlbnRpYWxTYXZpbmdNZmFDb250ZXh0SWZOZWNlc3NhcnkoYXV0aCwgb3BlcmF0aW9uVHlwZSwgY3JlZGVudGlhbCwgdXNlciksIGJ5cGFzc0F1dGhTdGF0ZSk7XG4gICAgICAgIF9hc3NlcnQocmVzcG9uc2UuaWRUb2tlbiwgYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgICAgICBjb25zdCBwYXJzZWQgPSBfcGFyc2VUb2tlbihyZXNwb25zZS5pZFRva2VuKTtcbiAgICAgICAgX2Fzc2VydChwYXJzZWQsIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgY29uc3QgeyBzdWI6IGxvY2FsSWQgfSA9IHBhcnNlZDtcbiAgICAgICAgX2Fzc2VydCh1c2VyLnVpZCA9PT0gbG9jYWxJZCwgYXV0aCwgXCJ1c2VyLW1pc21hdGNoXCIgLyogQXV0aEVycm9yQ29kZS5VU0VSX01JU01BVENIICovKTtcbiAgICAgICAgcmV0dXJuIFVzZXJDcmVkZW50aWFsSW1wbC5fZm9yT3BlcmF0aW9uKHVzZXIsIG9wZXJhdGlvblR5cGUsIHJlc3BvbnNlKTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gQ29udmVydCB1c2VyIGRlbGV0ZWQgZXJyb3IgaW50byB1c2VyIG1pc21hdGNoXG4gICAgICAgIGlmIChlPy5jb2RlID09PSBgYXV0aC8ke1widXNlci1ub3QtZm91bmRcIiAvKiBBdXRoRXJyb3JDb2RlLlVTRVJfREVMRVRFRCAqL31gKSB7XG4gICAgICAgICAgICBfZmFpbChhdXRoLCBcInVzZXItbWlzbWF0Y2hcIiAvKiBBdXRoRXJyb3JDb2RlLlVTRVJfTUlTTUFUQ0ggKi8pO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGU7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gX3NpZ25JbldpdGhDcmVkZW50aWFsKGF1dGgsIGNyZWRlbnRpYWwsIGJ5cGFzc0F1dGhTdGF0ZSA9IGZhbHNlKSB7XG4gICAgaWYgKF9pc0ZpcmViYXNlU2VydmVyQXBwKGF1dGguYXBwKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoX3NlcnZlckFwcEN1cnJlbnRVc2VyT3BlcmF0aW9uTm90U3VwcG9ydGVkRXJyb3IoYXV0aCkpO1xuICAgIH1cbiAgICBjb25zdCBvcGVyYXRpb25UeXBlID0gXCJzaWduSW5cIiAvKiBPcGVyYXRpb25UeXBlLlNJR05fSU4gKi87XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBfcHJvY2Vzc0NyZWRlbnRpYWxTYXZpbmdNZmFDb250ZXh0SWZOZWNlc3NhcnkoYXV0aCwgb3BlcmF0aW9uVHlwZSwgY3JlZGVudGlhbCk7XG4gICAgY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBVc2VyQ3JlZGVudGlhbEltcGwuX2Zyb21JZFRva2VuUmVzcG9uc2UoYXV0aCwgb3BlcmF0aW9uVHlwZSwgcmVzcG9uc2UpO1xuICAgIGlmICghYnlwYXNzQXV0aFN0YXRlKSB7XG4gICAgICAgIGF3YWl0IGF1dGguX3VwZGF0ZUN1cnJlbnRVc2VyKHVzZXJDcmVkZW50aWFsLnVzZXIpO1xuICAgIH1cbiAgICByZXR1cm4gdXNlckNyZWRlbnRpYWw7XG59XG4vKipcbiAqIEFzeW5jaHJvbm91c2x5IHNpZ25zIGluIHdpdGggdGhlIGdpdmVuIGNyZWRlbnRpYWxzLlxuICpcbiAqIEByZW1hcmtzXG4gKiBBbiB7QGxpbmsgQXV0aFByb3ZpZGVyfSBjYW4gYmUgdXNlZCB0byBnZW5lcmF0ZSB0aGUgY3JlZGVudGlhbC5cbiAqXG4gKiBUaGlzIG1ldGhvZCBpcyBub3Qgc3VwcG9ydGVkIGJ5IHtAbGluayBBdXRofSBpbnN0YW5jZXMgY3JlYXRlZCB3aXRoIGFcbiAqIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlU2VydmVyQXBwfS5cbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gY3JlZGVudGlhbCAtIFRoZSBhdXRoIGNyZWRlbnRpYWwuXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoQ3JlZGVudGlhbChhdXRoLCBjcmVkZW50aWFsKSB7XG4gICAgcmV0dXJuIF9zaWduSW5XaXRoQ3JlZGVudGlhbChfY2FzdEF1dGgoYXV0aCksIGNyZWRlbnRpYWwpO1xufVxuLyoqXG4gKiBMaW5rcyB0aGUgdXNlciBhY2NvdW50IHdpdGggdGhlIGdpdmVuIGNyZWRlbnRpYWxzLlxuICpcbiAqIEByZW1hcmtzXG4gKiBBbiB7QGxpbmsgQXV0aFByb3ZpZGVyfSBjYW4gYmUgdXNlZCB0byBnZW5lcmF0ZSB0aGUgY3JlZGVudGlhbC5cbiAqXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxuICogQHBhcmFtIGNyZWRlbnRpYWwgLSBUaGUgYXV0aCBjcmVkZW50aWFsLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gbGlua1dpdGhDcmVkZW50aWFsKHVzZXIsIGNyZWRlbnRpYWwpIHtcbiAgICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcik7XG4gICAgYXdhaXQgX2Fzc2VydExpbmtlZFN0YXR1cyhmYWxzZSwgdXNlckludGVybmFsLCBjcmVkZW50aWFsLnByb3ZpZGVySWQpO1xuICAgIHJldHVybiBfbGluayQxKHVzZXJJbnRlcm5hbCwgY3JlZGVudGlhbCk7XG59XG4vKipcbiAqIFJlLWF1dGhlbnRpY2F0ZXMgYSB1c2VyIHVzaW5nIGEgZnJlc2ggY3JlZGVudGlhbC5cbiAqXG4gKiBAcmVtYXJrc1xuICogVXNlIGJlZm9yZSBvcGVyYXRpb25zIHN1Y2ggYXMge0BsaW5rIHVwZGF0ZVBhc3N3b3JkfSB0aGF0IHJlcXVpcmUgdG9rZW5zIGZyb20gcmVjZW50IHNpZ24taW5cbiAqIGF0dGVtcHRzLiBUaGlzIG1ldGhvZCBjYW4gYmUgdXNlZCB0byByZWNvdmVyIGZyb20gYSBgQ1JFREVOVElBTF9UT09fT0xEX0xPR0lOX0FHQUlOYCBlcnJvclxuICogb3IgYSBgVE9LRU5fRVhQSVJFRGAgZXJyb3IuXG4gKlxuICogVGhpcyBtZXRob2QgaXMgbm90IHN1cHBvcnRlZCBvbiBhbnkge0BsaW5rIFVzZXJ9IHNpZ25lZCBpbiBieSB7QGxpbmsgQXV0aH0gaW5zdGFuY2VzXG4gKiBjcmVhdGVkIHdpdGggYSB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZVNlcnZlckFwcH0uXG4gKlxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cbiAqIEBwYXJhbSBjcmVkZW50aWFsIC0gVGhlIGF1dGggY3JlZGVudGlhbC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHJlYXV0aGVudGljYXRlV2l0aENyZWRlbnRpYWwodXNlciwgY3JlZGVudGlhbCkge1xuICAgIHJldHVybiBfcmVhdXRoZW50aWNhdGUoZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpLCBjcmVkZW50aWFsKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHNpZ25JbldpdGhDdXN0b21Ub2tlbiQxKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1TaWduSW5SZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6c2lnbkluV2l0aEN1c3RvbVRva2VuXCIgLyogRW5kcG9pbnQuU0lHTl9JTl9XSVRIX0NVU1RPTV9UT0tFTiAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQXN5bmNocm9ub3VzbHkgc2lnbnMgaW4gdXNpbmcgYSBjdXN0b20gdG9rZW4uXG4gKlxuICogQHJlbWFya3NcbiAqIEN1c3RvbSB0b2tlbnMgYXJlIHVzZWQgdG8gaW50ZWdyYXRlIEZpcmViYXNlIEF1dGggd2l0aCBleGlzdGluZyBhdXRoIHN5c3RlbXMsIGFuZCBtdXN0XG4gKiBiZSBnZW5lcmF0ZWQgYnkgYW4gYXV0aCBiYWNrZW5kIHVzaW5nIHRoZVxuICoge0BsaW5rIGh0dHBzOi8vZmlyZWJhc2UuZ29vZ2xlLmNvbS9kb2NzL3JlZmVyZW5jZS9hZG1pbi9ub2RlL2FkbWluLmF1dGguQXV0aCNjcmVhdGVjdXN0b210b2tlbiB8IGNyZWF0ZUN1c3RvbVRva2VufVxuICogbWV0aG9kIGluIHRoZSB7QGxpbmsgaHR0cHM6Ly9maXJlYmFzZS5nb29nbGUuY29tL2RvY3MvYXV0aC9hZG1pbiB8IEFkbWluIFNES30gLlxuICpcbiAqIEZhaWxzIHdpdGggYW4gZXJyb3IgaWYgdGhlIHRva2VuIGlzIGludmFsaWQsIGV4cGlyZWQsIG9yIG5vdCBhY2NlcHRlZCBieSB0aGUgRmlyZWJhc2UgQXV0aCBzZXJ2aWNlLlxuICpcbiAqIFRoaXMgbWV0aG9kIGlzIG5vdCBzdXBwb3J0ZWQgYnkge0BsaW5rIEF1dGh9IGluc3RhbmNlcyBjcmVhdGVkIHdpdGggYVxuICoge0BsaW5rIEBmaXJlYmFzZS9hcHAjRmlyZWJhc2VTZXJ2ZXJBcHB9LlxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSBjdXN0b21Ub2tlbiAtIFRoZSBjdXN0b20gdG9rZW4gdG8gc2lnbiBpbiB3aXRoLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aEN1c3RvbVRva2VuKGF1dGgsIGN1c3RvbVRva2VuKSB7XG4gICAgaWYgKF9pc0ZpcmViYXNlU2VydmVyQXBwKGF1dGguYXBwKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoX3NlcnZlckFwcEN1cnJlbnRVc2VyT3BlcmF0aW9uTm90U3VwcG9ydGVkRXJyb3IoYXV0aCkpO1xuICAgIH1cbiAgICBjb25zdCBhdXRoSW50ZXJuYWwgPSBfY2FzdEF1dGgoYXV0aCk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzaWduSW5XaXRoQ3VzdG9tVG9rZW4kMShhdXRoSW50ZXJuYWwsIHtcbiAgICAgICAgdG9rZW46IGN1c3RvbVRva2VuLFxuICAgICAgICByZXR1cm5TZWN1cmVUb2tlbjogdHJ1ZVxuICAgIH0pO1xuICAgIGNvbnN0IGNyZWQgPSBhd2FpdCBVc2VyQ3JlZGVudGlhbEltcGwuX2Zyb21JZFRva2VuUmVzcG9uc2UoYXV0aEludGVybmFsLCBcInNpZ25JblwiIC8qIE9wZXJhdGlvblR5cGUuU0lHTl9JTiAqLywgcmVzcG9uc2UpO1xuICAgIGF3YWl0IGF1dGhJbnRlcm5hbC5fdXBkYXRlQ3VycmVudFVzZXIoY3JlZC51c2VyKTtcbiAgICByZXR1cm4gY3JlZDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNsYXNzIE11bHRpRmFjdG9ySW5mb0ltcGwge1xuICAgIGNvbnN0cnVjdG9yKGZhY3RvcklkLCByZXNwb25zZSkge1xuICAgICAgICB0aGlzLmZhY3RvcklkID0gZmFjdG9ySWQ7XG4gICAgICAgIHRoaXMudWlkID0gcmVzcG9uc2UubWZhRW5yb2xsbWVudElkO1xuICAgICAgICB0aGlzLmVucm9sbG1lbnRUaW1lID0gbmV3IERhdGUocmVzcG9uc2UuZW5yb2xsZWRBdCkudG9VVENTdHJpbmcoKTtcbiAgICAgICAgdGhpcy5kaXNwbGF5TmFtZSA9IHJlc3BvbnNlLmRpc3BsYXlOYW1lO1xuICAgIH1cbiAgICBzdGF0aWMgX2Zyb21TZXJ2ZXJSZXNwb25zZShhdXRoLCBlbnJvbGxtZW50KSB7XG4gICAgICAgIGlmICgncGhvbmVJbmZvJyBpbiBlbnJvbGxtZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gUGhvbmVNdWx0aUZhY3RvckluZm9JbXBsLl9mcm9tU2VydmVyUmVzcG9uc2UoYXV0aCwgZW5yb2xsbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoJ3RvdHBJbmZvJyBpbiBlbnJvbGxtZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gVG90cE11bHRpRmFjdG9ySW5mb0ltcGwuX2Zyb21TZXJ2ZXJSZXNwb25zZShhdXRoLCBlbnJvbGxtZW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX2ZhaWwoYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgIH1cbn1cbmNsYXNzIFBob25lTXVsdGlGYWN0b3JJbmZvSW1wbCBleHRlbmRzIE11bHRpRmFjdG9ySW5mb0ltcGwge1xuICAgIGNvbnN0cnVjdG9yKHJlc3BvbnNlKSB7XG4gICAgICAgIHN1cGVyKFwicGhvbmVcIiAvKiBGYWN0b3JJZC5QSE9ORSAqLywgcmVzcG9uc2UpO1xuICAgICAgICB0aGlzLnBob25lTnVtYmVyID0gcmVzcG9uc2UucGhvbmVJbmZvO1xuICAgIH1cbiAgICBzdGF0aWMgX2Zyb21TZXJ2ZXJSZXNwb25zZShfYXV0aCwgZW5yb2xsbWVudCkge1xuICAgICAgICByZXR1cm4gbmV3IFBob25lTXVsdGlGYWN0b3JJbmZvSW1wbChlbnJvbGxtZW50KTtcbiAgICB9XG59XG5jbGFzcyBUb3RwTXVsdGlGYWN0b3JJbmZvSW1wbCBleHRlbmRzIE11bHRpRmFjdG9ySW5mb0ltcGwge1xuICAgIGNvbnN0cnVjdG9yKHJlc3BvbnNlKSB7XG4gICAgICAgIHN1cGVyKFwidG90cFwiIC8qIEZhY3RvcklkLlRPVFAgKi8sIHJlc3BvbnNlKTtcbiAgICB9XG4gICAgc3RhdGljIF9mcm9tU2VydmVyUmVzcG9uc2UoX2F1dGgsIGVucm9sbG1lbnQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUb3RwTXVsdGlGYWN0b3JJbmZvSW1wbChlbnJvbGxtZW50KTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5mdW5jdGlvbiBfc2V0QWN0aW9uQ29kZVNldHRpbmdzT25SZXF1ZXN0KGF1dGgsIHJlcXVlc3QsIGFjdGlvbkNvZGVTZXR0aW5ncykge1xuICAgIF9hc3NlcnQoYWN0aW9uQ29kZVNldHRpbmdzLnVybD8ubGVuZ3RoID4gMCwgYXV0aCwgXCJpbnZhbGlkLWNvbnRpbnVlLXVyaVwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9DT05USU5VRV9VUkkgKi8pO1xuICAgIF9hc3NlcnQodHlwZW9mIGFjdGlvbkNvZGVTZXR0aW5ncy5keW5hbWljTGlua0RvbWFpbiA9PT0gJ3VuZGVmaW5lZCcgfHxcbiAgICAgICAgYWN0aW9uQ29kZVNldHRpbmdzLmR5bmFtaWNMaW5rRG9tYWluLmxlbmd0aCA+IDAsIGF1dGgsIFwiaW52YWxpZC1keW5hbWljLWxpbmstZG9tYWluXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0RZTkFNSUNfTElOS19ET01BSU4gKi8pO1xuICAgIF9hc3NlcnQodHlwZW9mIGFjdGlvbkNvZGVTZXR0aW5ncy5saW5rRG9tYWluID09PSAndW5kZWZpbmVkJyB8fFxuICAgICAgICBhY3Rpb25Db2RlU2V0dGluZ3MubGlua0RvbWFpbi5sZW5ndGggPiAwLCBhdXRoLCBcImludmFsaWQtaG9zdGluZy1saW5rLWRvbWFpblwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9IT1NUSU5HX0xJTktfRE9NQUlOICovKTtcbiAgICByZXF1ZXN0LmNvbnRpbnVlVXJsID0gYWN0aW9uQ29kZVNldHRpbmdzLnVybDtcbiAgICByZXF1ZXN0LmR5bmFtaWNMaW5rRG9tYWluID0gYWN0aW9uQ29kZVNldHRpbmdzLmR5bmFtaWNMaW5rRG9tYWluO1xuICAgIHJlcXVlc3QubGlua0RvbWFpbiA9IGFjdGlvbkNvZGVTZXR0aW5ncy5saW5rRG9tYWluO1xuICAgIHJlcXVlc3QuY2FuSGFuZGxlQ29kZUluQXBwID0gYWN0aW9uQ29kZVNldHRpbmdzLmhhbmRsZUNvZGVJbkFwcDtcbiAgICBpZiAoYWN0aW9uQ29kZVNldHRpbmdzLmlPUykge1xuICAgICAgICBfYXNzZXJ0KGFjdGlvbkNvZGVTZXR0aW5ncy5pT1MuYnVuZGxlSWQubGVuZ3RoID4gMCwgYXV0aCwgXCJtaXNzaW5nLWlvcy1idW5kbGUtaWRcIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfSU9TX0JVTkRMRV9JRCAqLyk7XG4gICAgICAgIHJlcXVlc3QuaU9TQnVuZGxlSWQgPSBhY3Rpb25Db2RlU2V0dGluZ3MuaU9TLmJ1bmRsZUlkO1xuICAgIH1cbiAgICBpZiAoYWN0aW9uQ29kZVNldHRpbmdzLmFuZHJvaWQpIHtcbiAgICAgICAgX2Fzc2VydChhY3Rpb25Db2RlU2V0dGluZ3MuYW5kcm9pZC5wYWNrYWdlTmFtZS5sZW5ndGggPiAwLCBhdXRoLCBcIm1pc3NpbmctYW5kcm9pZC1wa2ctbmFtZVwiIC8qIEF1dGhFcnJvckNvZGUuTUlTU0lOR19BTkRST0lEX1BBQ0tBR0VfTkFNRSAqLyk7XG4gICAgICAgIHJlcXVlc3QuYW5kcm9pZEluc3RhbGxBcHAgPSBhY3Rpb25Db2RlU2V0dGluZ3MuYW5kcm9pZC5pbnN0YWxsQXBwO1xuICAgICAgICByZXF1ZXN0LmFuZHJvaWRNaW5pbXVtVmVyc2lvbkNvZGUgPVxuICAgICAgICAgICAgYWN0aW9uQ29kZVNldHRpbmdzLmFuZHJvaWQubWluaW11bVZlcnNpb247XG4gICAgICAgIHJlcXVlc3QuYW5kcm9pZFBhY2thZ2VOYW1lID0gYWN0aW9uQ29kZVNldHRpbmdzLmFuZHJvaWQucGFja2FnZU5hbWU7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBVcGRhdGVzIHRoZSBwYXNzd29yZCBwb2xpY3kgY2FjaGVkIGluIHRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UgaWYgYSBwb2xpY3kgaXMgYWxyZWFkeVxuICogY2FjaGVkIGZvciB0aGUgcHJvamVjdCBvciB0ZW5hbnQuXG4gKlxuICogQHJlbWFya3NcbiAqIFdlIG9ubHkgZmV0Y2ggdGhlIHBhc3N3b3JkIHBvbGljeSBpZiB0aGUgcGFzc3dvcmQgZGlkIG5vdCBtZWV0IHBvbGljeSByZXF1aXJlbWVudHMgYW5kXG4gKiB0aGVyZSBpcyBhbiBleGlzdGluZyBwb2xpY3kgY2FjaGVkLiBBIGRldmVsb3BlciBtdXN0IGNhbGwgdmFsaWRhdGVQYXNzd29yZCBhdCBsZWFzdFxuICogb25jZSBmb3IgdGhlIGNhY2hlIHRvIGJlIGF1dG9tYXRpY2FsbHkgdXBkYXRlZC5cbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKlxuICogQHByaXZhdGVcbiAqL1xuYXN5bmMgZnVuY3Rpb24gcmVjYWNoZVBhc3N3b3JkUG9saWN5KGF1dGgpIHtcbiAgICBjb25zdCBhdXRoSW50ZXJuYWwgPSBfY2FzdEF1dGgoYXV0aCk7XG4gICAgaWYgKGF1dGhJbnRlcm5hbC5fZ2V0UGFzc3dvcmRQb2xpY3lJbnRlcm5hbCgpKSB7XG4gICAgICAgIGF3YWl0IGF1dGhJbnRlcm5hbC5fdXBkYXRlUGFzc3dvcmRQb2xpY3koKTtcbiAgICB9XG59XG4vKipcbiAqIFNlbmRzIGEgcGFzc3dvcmQgcmVzZXQgZW1haWwgdG8gdGhlIGdpdmVuIGVtYWlsIGFkZHJlc3MuIFRoaXMgbWV0aG9kIGRvZXMgbm90IHRocm93IGFuIGVycm9yIHdoZW5cbiAqIHRoZXJlJ3Mgbm8gdXNlciBhY2NvdW50IHdpdGggdGhlIGdpdmVuIGVtYWlsIGFkZHJlc3MgYW5kXG4gKiB7QGxpbmsgaHR0cHM6Ly9jbG91ZC5nb29nbGUuY29tL2lkZW50aXR5LXBsYXRmb3JtL2RvY3MvYWRtaW4vZW1haWwtZW51bWVyYXRpb24tcHJvdGVjdGlvbiB8IEVtYWlsIEVudW1lcmF0aW9uIFByb3RlY3Rpb259XG4gKiBpcyBlbmFibGVkLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUbyBjb21wbGV0ZSB0aGUgcGFzc3dvcmQgcmVzZXQsIGNhbGwge0BsaW5rIGNvbmZpcm1QYXNzd29yZFJlc2V0fSB3aXRoIHRoZSBjb2RlIHN1cHBsaWVkIGluXG4gKiB0aGUgZW1haWwgc2VudCB0byB0aGUgdXNlciwgYWxvbmcgd2l0aCB0aGUgbmV3IHBhc3N3b3JkIHNwZWNpZmllZCBieSB0aGUgdXNlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogY29uc3QgYWN0aW9uQ29kZVNldHRpbmdzID0ge1xuICogICB1cmw6ICdodHRwczovL3d3dy5leGFtcGxlLmNvbS8/ZW1haWw9dXNlckBleGFtcGxlLmNvbScsXG4gKiAgIGlPUzoge1xuICogICAgICBidW5kbGVJZDogJ2NvbS5leGFtcGxlLmlvcydcbiAqICAgfSxcbiAqICAgYW5kcm9pZDoge1xuICogICAgIHBhY2thZ2VOYW1lOiAnY29tLmV4YW1wbGUuYW5kcm9pZCcsXG4gKiAgICAgaW5zdGFsbEFwcDogdHJ1ZSxcbiAqICAgICBtaW5pbXVtVmVyc2lvbjogJzEyJ1xuICogICB9LFxuICogICBoYW5kbGVDb2RlSW5BcHA6IHRydWVcbiAqIH07XG4gKiBhd2FpdCBzZW5kUGFzc3dvcmRSZXNldEVtYWlsKGF1dGgsICd1c2VyQGV4YW1wbGUuY29tJywgYWN0aW9uQ29kZVNldHRpbmdzKTtcbiAqIC8vIE9idGFpbiBjb2RlIGZyb20gdXNlci5cbiAqIGF3YWl0IGNvbmZpcm1QYXNzd29yZFJlc2V0KCd1c2VyQGV4YW1wbGUuY29tJywgY29kZSk7XG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gZW1haWwgLSBUaGUgdXNlcidzIGVtYWlsIGFkZHJlc3MuXG4gKiBAcGFyYW0gYWN0aW9uQ29kZVNldHRpbmdzIC0gVGhlIHtAbGluayBBY3Rpb25Db2RlU2V0dGluZ3N9LlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gc2VuZFBhc3N3b3JkUmVzZXRFbWFpbChhdXRoLCBlbWFpbCwgYWN0aW9uQ29kZVNldHRpbmdzKSB7XG4gICAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xuICAgIGNvbnN0IHJlcXVlc3QgPSB7XG4gICAgICAgIHJlcXVlc3RUeXBlOiBcIlBBU1NXT1JEX1JFU0VUXCIgLyogQWN0aW9uQ29kZU9wZXJhdGlvbi5QQVNTV09SRF9SRVNFVCAqLyxcbiAgICAgICAgZW1haWwsXG4gICAgICAgIGNsaWVudFR5cGU6IFwiQ0xJRU5UX1RZUEVfV0VCXCIgLyogUmVjYXB0Y2hhQ2xpZW50VHlwZS5XRUIgKi9cbiAgICB9O1xuICAgIGlmIChhY3Rpb25Db2RlU2V0dGluZ3MpIHtcbiAgICAgICAgX3NldEFjdGlvbkNvZGVTZXR0aW5nc09uUmVxdWVzdChhdXRoSW50ZXJuYWwsIHJlcXVlc3QsIGFjdGlvbkNvZGVTZXR0aW5ncyk7XG4gICAgfVxuICAgIGF3YWl0IGhhbmRsZVJlY2FwdGNoYUZsb3coYXV0aEludGVybmFsLCByZXF1ZXN0LCBcImdldE9vYkNvZGVcIiAvKiBSZWNhcHRjaGFBY3Rpb25OYW1lLkdFVF9PT0JfQ09ERSAqLywgc2VuZFBhc3N3b3JkUmVzZXRFbWFpbCQxLCBcIkVNQUlMX1BBU1NXT1JEX1BST1ZJREVSXCIgLyogUmVjYXB0Y2hhQXV0aFByb3ZpZGVyLkVNQUlMX1BBU1NXT1JEX1BST1ZJREVSICovKTtcbn1cbi8qKlxuICogQ29tcGxldGVzIHRoZSBwYXNzd29yZCByZXNldCBwcm9jZXNzLCBnaXZlbiBhIGNvbmZpcm1hdGlvbiBjb2RlIGFuZCBuZXcgcGFzc3dvcmQuXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIG9vYkNvZGUgLSBBIGNvbmZpcm1hdGlvbiBjb2RlIHNlbnQgdG8gdGhlIHVzZXIuXG4gKiBAcGFyYW0gbmV3UGFzc3dvcmQgLSBUaGUgbmV3IHBhc3N3b3JkLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gY29uZmlybVBhc3N3b3JkUmVzZXQoYXV0aCwgb29iQ29kZSwgbmV3UGFzc3dvcmQpIHtcbiAgICBhd2FpdCByZXNldFBhc3N3b3JkKGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKSwge1xuICAgICAgICBvb2JDb2RlLFxuICAgICAgICBuZXdQYXNzd29yZFxuICAgIH0pXG4gICAgICAgIC5jYXRjaChhc3luYyAoZXJyb3IpID0+IHtcbiAgICAgICAgaWYgKGVycm9yLmNvZGUgPT09XG4gICAgICAgICAgICBgYXV0aC8ke1wicGFzc3dvcmQtZG9lcy1ub3QtbWVldC1yZXF1aXJlbWVudHNcIiAvKiBBdXRoRXJyb3JDb2RlLlBBU1NXT1JEX0RPRVNfTk9UX01FRVRfUkVRVUlSRU1FTlRTICovfWApIHtcbiAgICAgICAgICAgIHZvaWQgcmVjYWNoZVBhc3N3b3JkUG9saWN5KGF1dGgpO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgIH0pO1xuICAgIC8vIERvIG5vdCByZXR1cm4gdGhlIGVtYWlsLlxufVxuLyoqXG4gKiBBcHBsaWVzIGEgdmVyaWZpY2F0aW9uIGNvZGUgc2VudCB0byB0aGUgdXNlciBieSBlbWFpbCBvciBvdGhlciBvdXQtb2YtYmFuZCBtZWNoYW5pc20uXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIG9vYkNvZGUgLSBBIHZlcmlmaWNhdGlvbiBjb2RlIHNlbnQgdG8gdGhlIHVzZXIuXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiBhcHBseUFjdGlvbkNvZGUoYXV0aCwgb29iQ29kZSkge1xuICAgIGF3YWl0IGFwcGx5QWN0aW9uQ29kZSQxKGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKSwgeyBvb2JDb2RlIH0pO1xufVxuLyoqXG4gKiBDaGVja3MgYSB2ZXJpZmljYXRpb24gY29kZSBzZW50IHRvIHRoZSB1c2VyIGJ5IGVtYWlsIG9yIG90aGVyIG91dC1vZi1iYW5kIG1lY2hhbmlzbS5cbiAqXG4gKiBAcmV0dXJucyBtZXRhZGF0YSBhYm91dCB0aGUgY29kZS5cbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gb29iQ29kZSAtIEEgdmVyaWZpY2F0aW9uIGNvZGUgc2VudCB0byB0aGUgdXNlci5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGNoZWNrQWN0aW9uQ29kZShhdXRoLCBvb2JDb2RlKSB7XG4gICAgY29uc3QgYXV0aE1vZHVsYXIgPSBnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXNldFBhc3N3b3JkKGF1dGhNb2R1bGFyLCB7IG9vYkNvZGUgfSk7XG4gICAgLy8gRW1haWwgY291bGQgYmUgZW1wdHkgb25seSBpZiB0aGUgcmVxdWVzdCB0eXBlIGlzIEVNQUlMX1NJR05JTiBvclxuICAgIC8vIFZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMLlxuICAgIC8vIE5ldyBlbWFpbCBzaG91bGQgbm90IGJlIGVtcHR5IGlmIHRoZSByZXF1ZXN0IHR5cGUgaXNcbiAgICAvLyBWRVJJRllfQU5EX0NIQU5HRV9FTUFJTC5cbiAgICAvLyBNdWx0aS1mYWN0b3IgaW5mbyBjb3VsZCBub3QgYmUgZW1wdHkgaWYgdGhlIHJlcXVlc3QgdHlwZSBpc1xuICAgIC8vIFJFVkVSVF9TRUNPTkRfRkFDVE9SX0FERElUSU9OLlxuICAgIGNvbnN0IG9wZXJhdGlvbiA9IHJlc3BvbnNlLnJlcXVlc3RUeXBlO1xuICAgIF9hc3NlcnQob3BlcmF0aW9uLCBhdXRoTW9kdWxhciwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgIHN3aXRjaCAob3BlcmF0aW9uKSB7XG4gICAgICAgIGNhc2UgXCJFTUFJTF9TSUdOSU5cIiAvKiBBY3Rpb25Db2RlT3BlcmF0aW9uLkVNQUlMX1NJR05JTiAqLzpcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiVkVSSUZZX0FORF9DSEFOR0VfRU1BSUxcIiAvKiBBY3Rpb25Db2RlT3BlcmF0aW9uLlZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMICovOlxuICAgICAgICAgICAgX2Fzc2VydChyZXNwb25zZS5uZXdFbWFpbCwgYXV0aE1vZHVsYXIsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiUkVWRVJUX1NFQ09ORF9GQUNUT1JfQURESVRJT05cIiAvKiBBY3Rpb25Db2RlT3BlcmF0aW9uLlJFVkVSVF9TRUNPTkRfRkFDVE9SX0FERElUSU9OICovOlxuICAgICAgICAgICAgX2Fzc2VydChyZXNwb25zZS5tZmFJbmZvLCBhdXRoTW9kdWxhciwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgICAgICAvLyBmYWxsIHRocm91Z2hcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIF9hc3NlcnQocmVzcG9uc2UuZW1haWwsIGF1dGhNb2R1bGFyLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgfVxuICAgIC8vIFRoZSBtdWx0aS1mYWN0b3IgaW5mbyBmb3IgcmV2ZXJ0IHNlY29uZCBmYWN0b3IgYWRkaXRpb25cbiAgICBsZXQgbXVsdGlGYWN0b3JJbmZvID0gbnVsbDtcbiAgICBpZiAocmVzcG9uc2UubWZhSW5mbykge1xuICAgICAgICBtdWx0aUZhY3RvckluZm8gPSBNdWx0aUZhY3RvckluZm9JbXBsLl9mcm9tU2VydmVyUmVzcG9uc2UoX2Nhc3RBdXRoKGF1dGhNb2R1bGFyKSwgcmVzcG9uc2UubWZhSW5mbyk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGVtYWlsOiAocmVzcG9uc2UucmVxdWVzdFR5cGUgPT09IFwiVkVSSUZZX0FORF9DSEFOR0VfRU1BSUxcIiAvKiBBY3Rpb25Db2RlT3BlcmF0aW9uLlZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMICovXG4gICAgICAgICAgICAgICAgPyByZXNwb25zZS5uZXdFbWFpbFxuICAgICAgICAgICAgICAgIDogcmVzcG9uc2UuZW1haWwpIHx8IG51bGwsXG4gICAgICAgICAgICBwcmV2aW91c0VtYWlsOiAocmVzcG9uc2UucmVxdWVzdFR5cGUgPT09IFwiVkVSSUZZX0FORF9DSEFOR0VfRU1BSUxcIiAvKiBBY3Rpb25Db2RlT3BlcmF0aW9uLlZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMICovXG4gICAgICAgICAgICAgICAgPyByZXNwb25zZS5lbWFpbFxuICAgICAgICAgICAgICAgIDogcmVzcG9uc2UubmV3RW1haWwpIHx8IG51bGwsXG4gICAgICAgICAgICBtdWx0aUZhY3RvckluZm9cbiAgICAgICAgfSxcbiAgICAgICAgb3BlcmF0aW9uXG4gICAgfTtcbn1cbi8qKlxuICogQ2hlY2tzIGEgcGFzc3dvcmQgcmVzZXQgY29kZSBzZW50IHRvIHRoZSB1c2VyIGJ5IGVtYWlsIG9yIG90aGVyIG91dC1vZi1iYW5kIG1lY2hhbmlzbS5cbiAqXG4gKiBAcmV0dXJucyB0aGUgdXNlcidzIGVtYWlsIGFkZHJlc3MgaWYgdmFsaWQuXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIGNvZGUgLSBBIHZlcmlmaWNhdGlvbiBjb2RlIHNlbnQgdG8gdGhlIHVzZXIuXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiB2ZXJpZnlQYXNzd29yZFJlc2V0Q29kZShhdXRoLCBjb2RlKSB7XG4gICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBjaGVja0FjdGlvbkNvZGUoZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLCBjb2RlKTtcbiAgICAvLyBFbWFpbCBzaG91bGQgYWx3YXlzIGJlIHByZXNlbnQgc2luY2UgYSBjb2RlIHdhcyBzZW50IHRvIGl0XG4gICAgcmV0dXJuIGRhdGEuZW1haWw7XG59XG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgdXNlciBhY2NvdW50IGFzc29jaWF0ZWQgd2l0aCB0aGUgc3BlY2lmaWVkIGVtYWlsIGFkZHJlc3MgYW5kIHBhc3N3b3JkLlxuICpcbiAqIEByZW1hcmtzXG4gKiBPbiBzdWNjZXNzZnVsIGNyZWF0aW9uIG9mIHRoZSB1c2VyIGFjY291bnQsIHRoaXMgdXNlciB3aWxsIGFsc28gYmUgc2lnbmVkIGluIHRvIHlvdXIgYXBwbGljYXRpb24uXG4gKlxuICogVXNlciBhY2NvdW50IGNyZWF0aW9uIGNhbiBmYWlsIGlmIHRoZSBhY2NvdW50IGFscmVhZHkgZXhpc3RzIG9yIHRoZSBwYXNzd29yZCBpcyBpbnZhbGlkLlxuICpcbiAqIFRoaXMgbWV0aG9kIGlzIG5vdCBzdXBwb3J0ZWQgb24ge0BsaW5rIEF1dGh9IGluc3RhbmNlcyBjcmVhdGVkIHdpdGggYVxuICoge0BsaW5rIEBmaXJlYmFzZS9hcHAjRmlyZWJhc2VTZXJ2ZXJBcHB9LlxuICpcbiAqIE5vdGU6IFRoZSBlbWFpbCBhZGRyZXNzIGFjdHMgYXMgYSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHVzZXIgYW5kIGVuYWJsZXMgYW4gZW1haWwtYmFzZWRcbiAqIHBhc3N3b3JkIHJlc2V0LiBUaGlzIGZ1bmN0aW9uIHdpbGwgY3JlYXRlIGEgbmV3IHVzZXIgYWNjb3VudCBhbmQgc2V0IHRoZSBpbml0aWFsIHVzZXIgcGFzc3dvcmQuXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIGVtYWlsIC0gVGhlIHVzZXIncyBlbWFpbCBhZGRyZXNzLlxuICogQHBhcmFtIHBhc3N3b3JkIC0gVGhlIHVzZXIncyBjaG9zZW4gcGFzc3dvcmQuXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQoYXV0aCwgZW1haWwsIHBhc3N3b3JkKSB7XG4gICAgaWYgKF9pc0ZpcmViYXNlU2VydmVyQXBwKGF1dGguYXBwKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoX3NlcnZlckFwcEN1cnJlbnRVc2VyT3BlcmF0aW9uTm90U3VwcG9ydGVkRXJyb3IoYXV0aCkpO1xuICAgIH1cbiAgICBjb25zdCBhdXRoSW50ZXJuYWwgPSBfY2FzdEF1dGgoYXV0aCk7XG4gICAgY29uc3QgcmVxdWVzdCA9IHtcbiAgICAgICAgcmV0dXJuU2VjdXJlVG9rZW46IHRydWUsXG4gICAgICAgIGVtYWlsLFxuICAgICAgICBwYXNzd29yZCxcbiAgICAgICAgY2xpZW50VHlwZTogXCJDTElFTlRfVFlQRV9XRUJcIiAvKiBSZWNhcHRjaGFDbGllbnRUeXBlLldFQiAqL1xuICAgIH07XG4gICAgY29uc3Qgc2lnblVwUmVzcG9uc2UgPSBoYW5kbGVSZWNhcHRjaGFGbG93KGF1dGhJbnRlcm5hbCwgcmVxdWVzdCwgXCJzaWduVXBQYXNzd29yZFwiIC8qIFJlY2FwdGNoYUFjdGlvbk5hbWUuU0lHTl9VUF9QQVNTV09SRCAqLywgc2lnblVwLCBcIkVNQUlMX1BBU1NXT1JEX1BST1ZJREVSXCIgLyogUmVjYXB0Y2hhQXV0aFByb3ZpZGVyLkVNQUlMX1BBU1NXT1JEX1BST1ZJREVSICovKTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHNpZ25VcFJlc3BvbnNlLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgaWYgKGVycm9yLmNvZGUgPT09IGBhdXRoLyR7XCJwYXNzd29yZC1kb2VzLW5vdC1tZWV0LXJlcXVpcmVtZW50c1wiIC8qIEF1dGhFcnJvckNvZGUuUEFTU1dPUkRfRE9FU19OT1RfTUVFVF9SRVFVSVJFTUVOVFMgKi99YCkge1xuICAgICAgICAgICAgdm9pZCByZWNhY2hlUGFzc3dvcmRQb2xpY3koYXV0aCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfSk7XG4gICAgY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBVc2VyQ3JlZGVudGlhbEltcGwuX2Zyb21JZFRva2VuUmVzcG9uc2UoYXV0aEludGVybmFsLCBcInNpZ25JblwiIC8qIE9wZXJhdGlvblR5cGUuU0lHTl9JTiAqLywgcmVzcG9uc2UpO1xuICAgIGF3YWl0IGF1dGhJbnRlcm5hbC5fdXBkYXRlQ3VycmVudFVzZXIodXNlckNyZWRlbnRpYWwudXNlcik7XG4gICAgcmV0dXJuIHVzZXJDcmVkZW50aWFsO1xufVxuLyoqXG4gKiBBc3luY2hyb25vdXNseSBzaWducyBpbiB1c2luZyBhbiBlbWFpbCBhbmQgcGFzc3dvcmQuXG4gKlxuICogQHJlbWFya3NcbiAqIEZhaWxzIHdpdGggYW4gZXJyb3IgaWYgdGhlIGVtYWlsIGFkZHJlc3MgYW5kIHBhc3N3b3JkIGRvIG5vdCBtYXRjaC4gV2hlblxuICoge0BsaW5rIGh0dHBzOi8vY2xvdWQuZ29vZ2xlLmNvbS9pZGVudGl0eS1wbGF0Zm9ybS9kb2NzL2FkbWluL2VtYWlsLWVudW1lcmF0aW9uLXByb3RlY3Rpb24gfCBFbWFpbCBFbnVtZXJhdGlvbiBQcm90ZWN0aW9ufVxuICogaXMgZW5hYmxlZCwgdGhpcyBtZXRob2QgZmFpbHMgd2l0aCBcImF1dGgvaW52YWxpZC1jcmVkZW50aWFsXCIgaW4gY2FzZSBvZiBhbiBpbnZhbGlkXG4gKiBlbWFpbC9wYXNzd29yZC5cbiAqXG4gKiBUaGlzIG1ldGhvZCBpcyBub3Qgc3VwcG9ydGVkIG9uIHtAbGluayBBdXRofSBpbnN0YW5jZXMgY3JlYXRlZCB3aXRoIGFcbiAqIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlU2VydmVyQXBwfS5cbiAqXG4gKiBOb3RlOiBUaGUgdXNlcidzIHBhc3N3b3JkIGlzIE5PVCB0aGUgcGFzc3dvcmQgdXNlZCB0byBhY2Nlc3MgdGhlIHVzZXIncyBlbWFpbCBhY2NvdW50LiBUaGVcbiAqIGVtYWlsIGFkZHJlc3Mgc2VydmVzIGFzIGEgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSB1c2VyLCBhbmQgdGhlIHBhc3N3b3JkIGlzIHVzZWQgdG8gYWNjZXNzXG4gKiB0aGUgdXNlcidzIGFjY291bnQgaW4geW91ciBGaXJlYmFzZSBwcm9qZWN0LiBTZWUgYWxzbzoge0BsaW5rIGNyZWF0ZVVzZXJXaXRoRW1haWxBbmRQYXNzd29yZH0uXG4gKlxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSBlbWFpbCAtIFRoZSB1c2VycyBlbWFpbCBhZGRyZXNzLlxuICogQHBhcmFtIHBhc3N3b3JkIC0gVGhlIHVzZXJzIHBhc3N3b3JkLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZnVuY3Rpb24gc2lnbkluV2l0aEVtYWlsQW5kUGFzc3dvcmQoYXV0aCwgZW1haWwsIHBhc3N3b3JkKSB7XG4gICAgaWYgKF9pc0ZpcmViYXNlU2VydmVyQXBwKGF1dGguYXBwKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoX3NlcnZlckFwcEN1cnJlbnRVc2VyT3BlcmF0aW9uTm90U3VwcG9ydGVkRXJyb3IoYXV0aCkpO1xuICAgIH1cbiAgICByZXR1cm4gc2lnbkluV2l0aENyZWRlbnRpYWwoZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLCBFbWFpbEF1dGhQcm92aWRlci5jcmVkZW50aWFsKGVtYWlsLCBwYXNzd29yZCkpLmNhdGNoKGFzeW5jIChlcnJvcikgPT4ge1xuICAgICAgICBpZiAoZXJyb3IuY29kZSA9PT0gYGF1dGgvJHtcInBhc3N3b3JkLWRvZXMtbm90LW1lZXQtcmVxdWlyZW1lbnRzXCIgLyogQXV0aEVycm9yQ29kZS5QQVNTV09SRF9ET0VTX05PVF9NRUVUX1JFUVVJUkVNRU5UUyAqL31gKSB7XG4gICAgICAgICAgICB2b2lkIHJlY2FjaGVQYXNzd29yZFBvbGljeShhdXRoKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICB9KTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogU2VuZHMgYSBzaWduLWluIGVtYWlsIGxpbmsgdG8gdGhlIHVzZXIgd2l0aCB0aGUgc3BlY2lmaWVkIGVtYWlsLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUaGUgc2lnbi1pbiBvcGVyYXRpb24gaGFzIHRvIGFsd2F5cyBiZSBjb21wbGV0ZWQgaW4gdGhlIGFwcCB1bmxpa2Ugb3RoZXIgb3V0IG9mIGJhbmQgZW1haWxcbiAqIGFjdGlvbnMgKHBhc3N3b3JkIHJlc2V0IGFuZCBlbWFpbCB2ZXJpZmljYXRpb25zKS4gVGhpcyBpcyBiZWNhdXNlLCBhdCB0aGUgZW5kIG9mIHRoZSBmbG93LFxuICogdGhlIHVzZXIgaXMgZXhwZWN0ZWQgdG8gYmUgc2lnbmVkIGluIGFuZCB0aGVpciBBdXRoIHN0YXRlIHBlcnNpc3RlZCB3aXRoaW4gdGhlIGFwcC5cbiAqXG4gKiBUbyBjb21wbGV0ZSBzaWduIGluIHdpdGggdGhlIGVtYWlsIGxpbmssIGNhbGwge0BsaW5rIHNpZ25JbldpdGhFbWFpbExpbmt9IHdpdGggdGhlIGVtYWlsXG4gKiBhZGRyZXNzIGFuZCB0aGUgZW1haWwgbGluayBzdXBwbGllZCBpbiB0aGUgZW1haWwgc2VudCB0byB0aGUgdXNlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogY29uc3QgYWN0aW9uQ29kZVNldHRpbmdzID0ge1xuICogICB1cmw6ICdodHRwczovL3d3dy5leGFtcGxlLmNvbS8/ZW1haWw9dXNlckBleGFtcGxlLmNvbScsXG4gKiAgIGlPUzoge1xuICogICAgICBidW5kbGVJZDogJ2NvbS5leGFtcGxlLmlvcydcbiAqICAgfSxcbiAqICAgYW5kcm9pZDoge1xuICogICAgIHBhY2thZ2VOYW1lOiAnY29tLmV4YW1wbGUuYW5kcm9pZCcsXG4gKiAgICAgaW5zdGFsbEFwcDogdHJ1ZSxcbiAqICAgICBtaW5pbXVtVmVyc2lvbjogJzEyJ1xuICogICB9LFxuICogICBoYW5kbGVDb2RlSW5BcHA6IHRydWVcbiAqIH07XG4gKiBhd2FpdCBzZW5kU2lnbkluTGlua1RvRW1haWwoYXV0aCwgJ3VzZXJAZXhhbXBsZS5jb20nLCBhY3Rpb25Db2RlU2V0dGluZ3MpO1xuICogLy8gT2J0YWluIGVtYWlsTGluayBmcm9tIHRoZSB1c2VyLlxuICogaWYoaXNTaWduSW5XaXRoRW1haWxMaW5rKGF1dGgsIGVtYWlsTGluaykpIHtcbiAqICAgYXdhaXQgc2lnbkluV2l0aEVtYWlsTGluayhhdXRoLCAndXNlckBleGFtcGxlLmNvbScsIGVtYWlsTGluayk7XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0gYXV0aEludGVybmFsIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSBlbWFpbCAtIFRoZSB1c2VyJ3MgZW1haWwgYWRkcmVzcy5cbiAqIEBwYXJhbSBhY3Rpb25Db2RlU2V0dGluZ3MgLSBUaGUge0BsaW5rIEFjdGlvbkNvZGVTZXR0aW5nc30uXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiBzZW5kU2lnbkluTGlua1RvRW1haWwoYXV0aCwgZW1haWwsIGFjdGlvbkNvZGVTZXR0aW5ncykge1xuICAgIGNvbnN0IGF1dGhJbnRlcm5hbCA9IF9jYXN0QXV0aChhdXRoKTtcbiAgICBjb25zdCByZXF1ZXN0ID0ge1xuICAgICAgICByZXF1ZXN0VHlwZTogXCJFTUFJTF9TSUdOSU5cIiAvKiBBY3Rpb25Db2RlT3BlcmF0aW9uLkVNQUlMX1NJR05JTiAqLyxcbiAgICAgICAgZW1haWwsXG4gICAgICAgIGNsaWVudFR5cGU6IFwiQ0xJRU5UX1RZUEVfV0VCXCIgLyogUmVjYXB0Y2hhQ2xpZW50VHlwZS5XRUIgKi9cbiAgICB9O1xuICAgIGZ1bmN0aW9uIHNldEFjdGlvbkNvZGVTZXR0aW5ncyhyZXF1ZXN0LCBhY3Rpb25Db2RlU2V0dGluZ3MpIHtcbiAgICAgICAgX2Fzc2VydChhY3Rpb25Db2RlU2V0dGluZ3MuaGFuZGxlQ29kZUluQXBwLCBhdXRoSW50ZXJuYWwsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SICovKTtcbiAgICAgICAgaWYgKGFjdGlvbkNvZGVTZXR0aW5ncykge1xuICAgICAgICAgICAgX3NldEFjdGlvbkNvZGVTZXR0aW5nc09uUmVxdWVzdChhdXRoSW50ZXJuYWwsIHJlcXVlc3QsIGFjdGlvbkNvZGVTZXR0aW5ncyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2V0QWN0aW9uQ29kZVNldHRpbmdzKHJlcXVlc3QsIGFjdGlvbkNvZGVTZXR0aW5ncyk7XG4gICAgYXdhaXQgaGFuZGxlUmVjYXB0Y2hhRmxvdyhhdXRoSW50ZXJuYWwsIHJlcXVlc3QsIFwiZ2V0T29iQ29kZVwiIC8qIFJlY2FwdGNoYUFjdGlvbk5hbWUuR0VUX09PQl9DT0RFICovLCBzZW5kU2lnbkluTGlua1RvRW1haWwkMSwgXCJFTUFJTF9QQVNTV09SRF9QUk9WSURFUlwiIC8qIFJlY2FwdGNoYUF1dGhQcm92aWRlci5FTUFJTF9QQVNTV09SRF9QUk9WSURFUiAqLyk7XG59XG4vKipcbiAqIENoZWNrcyBpZiBhbiBpbmNvbWluZyBsaW5rIGlzIGEgc2lnbi1pbiB3aXRoIGVtYWlsIGxpbmsgc3VpdGFibGUgZm9yIHtAbGluayBzaWduSW5XaXRoRW1haWxMaW5rfS5cbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gZW1haWxMaW5rIC0gVGhlIGxpbmsgc2VudCB0byB0aGUgdXNlcidzIGVtYWlsIGFkZHJlc3MuXG4gKlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiBpc1NpZ25JbldpdGhFbWFpbExpbmsoYXV0aCwgZW1haWxMaW5rKSB7XG4gICAgY29uc3QgYWN0aW9uQ29kZVVybCA9IEFjdGlvbkNvZGVVUkwucGFyc2VMaW5rKGVtYWlsTGluayk7XG4gICAgcmV0dXJuIGFjdGlvbkNvZGVVcmw/Lm9wZXJhdGlvbiA9PT0gXCJFTUFJTF9TSUdOSU5cIiAvKiBBY3Rpb25Db2RlT3BlcmF0aW9uLkVNQUlMX1NJR05JTiAqLztcbn1cbi8qKlxuICogQXN5bmNocm9ub3VzbHkgc2lnbnMgaW4gdXNpbmcgYW4gZW1haWwgYW5kIHNpZ24taW4gZW1haWwgbGluay5cbiAqXG4gKiBAcmVtYXJrc1xuICogSWYgbm8gbGluayBpcyBwYXNzZWQsIHRoZSBsaW5rIGlzIGluZmVycmVkIGZyb20gdGhlIGN1cnJlbnQgVVJMLlxuICpcbiAqIEZhaWxzIHdpdGggYW4gZXJyb3IgaWYgdGhlIGVtYWlsIGFkZHJlc3MgaXMgaW52YWxpZCBvciBPVFAgaW4gZW1haWwgbGluayBleHBpcmVzLlxuICpcbiAqIFRoaXMgbWV0aG9kIGlzIG5vdCBzdXBwb3J0ZWQgYnkge0BsaW5rIEF1dGh9IGluc3RhbmNlcyBjcmVhdGVkIHdpdGggYVxuICoge0BsaW5rIEBmaXJlYmFzZS9hcHAjRmlyZWJhc2VTZXJ2ZXJBcHB9LlxuICpcbiAqIE5vdGU6IENvbmZpcm0gdGhlIGxpbmsgaXMgYSBzaWduLWluIGVtYWlsIGxpbmsgYmVmb3JlIGNhbGxpbmcgdGhpcyBtZXRob2QgZmlyZWJhc2UuYXV0aC5BdXRoLmlzU2lnbkluV2l0aEVtYWlsTGluay5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogY29uc3QgYWN0aW9uQ29kZVNldHRpbmdzID0ge1xuICogICB1cmw6ICdodHRwczovL3d3dy5leGFtcGxlLmNvbS8/ZW1haWw9dXNlckBleGFtcGxlLmNvbScsXG4gKiAgIGlPUzoge1xuICogICAgICBidW5kbGVJZDogJ2NvbS5leGFtcGxlLmlvcydcbiAqICAgfSxcbiAqICAgYW5kcm9pZDoge1xuICogICAgIHBhY2thZ2VOYW1lOiAnY29tLmV4YW1wbGUuYW5kcm9pZCcsXG4gKiAgICAgaW5zdGFsbEFwcDogdHJ1ZSxcbiAqICAgICBtaW5pbXVtVmVyc2lvbjogJzEyJ1xuICogICB9LFxuICogICBoYW5kbGVDb2RlSW5BcHA6IHRydWVcbiAqIH07XG4gKiBhd2FpdCBzZW5kU2lnbkluTGlua1RvRW1haWwoYXV0aCwgJ3VzZXJAZXhhbXBsZS5jb20nLCBhY3Rpb25Db2RlU2V0dGluZ3MpO1xuICogLy8gT2J0YWluIGVtYWlsTGluayBmcm9tIHRoZSB1c2VyLlxuICogaWYoaXNTaWduSW5XaXRoRW1haWxMaW5rKGF1dGgsIGVtYWlsTGluaykpIHtcbiAqICAgYXdhaXQgc2lnbkluV2l0aEVtYWlsTGluayhhdXRoLCAndXNlckBleGFtcGxlLmNvbScsIGVtYWlsTGluayk7XG4gKiB9XG4gKiBgYGBcbiAqXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIGVtYWlsIC0gVGhlIHVzZXIncyBlbWFpbCBhZGRyZXNzLlxuICogQHBhcmFtIGVtYWlsTGluayAtIFRoZSBsaW5rIHNlbnQgdG8gdGhlIHVzZXIncyBlbWFpbCBhZGRyZXNzLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aEVtYWlsTGluayhhdXRoLCBlbWFpbCwgZW1haWxMaW5rKSB7XG4gICAgaWYgKF9pc0ZpcmViYXNlU2VydmVyQXBwKGF1dGguYXBwKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoX3NlcnZlckFwcEN1cnJlbnRVc2VyT3BlcmF0aW9uTm90U3VwcG9ydGVkRXJyb3IoYXV0aCkpO1xuICAgIH1cbiAgICBjb25zdCBhdXRoTW9kdWxhciA9IGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKTtcbiAgICBjb25zdCBjcmVkZW50aWFsID0gRW1haWxBdXRoUHJvdmlkZXIuY3JlZGVudGlhbFdpdGhMaW5rKGVtYWlsLCBlbWFpbExpbmsgfHwgX2dldEN1cnJlbnRVcmwoKSk7XG4gICAgLy8gQ2hlY2sgaWYgdGhlIHRlbmFudCBJRCBpbiB0aGUgZW1haWwgbGluayBtYXRjaGVzIHRoZSB0ZW5hbnQgSUQgb24gQXV0aFxuICAgIC8vIGluc3RhbmNlLlxuICAgIF9hc3NlcnQoY3JlZGVudGlhbC5fdGVuYW50SWQgPT09IChhdXRoTW9kdWxhci50ZW5hbnRJZCB8fCBudWxsKSwgYXV0aE1vZHVsYXIsIFwidGVuYW50LWlkLW1pc21hdGNoXCIgLyogQXV0aEVycm9yQ29kZS5URU5BTlRfSURfTUlTTUFUQ0ggKi8pO1xuICAgIHJldHVybiBzaWduSW5XaXRoQ3JlZGVudGlhbChhdXRoTW9kdWxhciwgY3JlZGVudGlhbCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVBdXRoVXJpKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6Y3JlYXRlQXV0aFVyaVwiIC8qIEVuZHBvaW50LkNSRUFURV9BVVRIX1VSSSAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogR2V0cyB0aGUgbGlzdCBvZiBwb3NzaWJsZSBzaWduIGluIG1ldGhvZHMgZm9yIHRoZSBnaXZlbiBlbWFpbCBhZGRyZXNzLiBUaGlzIG1ldGhvZCByZXR1cm5zIGFuXG4gKiBlbXB0eSBsaXN0IHdoZW5cbiAqIHtAbGluayBodHRwczovL2Nsb3VkLmdvb2dsZS5jb20vaWRlbnRpdHktcGxhdGZvcm0vZG9jcy9hZG1pbi9lbWFpbC1lbnVtZXJhdGlvbi1wcm90ZWN0aW9uIHwgRW1haWwgRW51bWVyYXRpb24gUHJvdGVjdGlvbn1cbiAqIGlzIGVuYWJsZWQsIGlycmVzcGVjdGl2ZSBvZiB0aGUgbnVtYmVyIG9mIGF1dGhlbnRpY2F0aW9uIG1ldGhvZHMgYXZhaWxhYmxlIGZvciB0aGUgZ2l2ZW4gZW1haWwuXG4gKlxuICogQHJlbWFya3NcbiAqIFRoaXMgaXMgdXNlZnVsIHRvIGRpZmZlcmVudGlhdGUgbWV0aG9kcyBvZiBzaWduLWluIGZvciB0aGUgc2FtZSBwcm92aWRlciwgZWcuXG4gKiB7QGxpbmsgRW1haWxBdXRoUHJvdmlkZXJ9IHdoaWNoIGhhcyAyIG1ldGhvZHMgb2Ygc2lnbi1pbixcbiAqIHtAbGluayBTaWduSW5NZXRob2R9LkVNQUlMX1BBU1NXT1JEIGFuZFxuICoge0BsaW5rIFNpZ25Jbk1ldGhvZH0uRU1BSUxfTElOSy5cbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gZW1haWwgLSBUaGUgdXNlcidzIGVtYWlsIGFkZHJlc3MuXG4gKlxuICogRGVwcmVjYXRlZC4gTWlncmF0aW5nIG9mZiBvZiB0aGlzIG1ldGhvZCBpcyByZWNvbW1lbmRlZCBhcyBhIHNlY3VyaXR5IGJlc3QtcHJhY3RpY2UuXG4gKiBMZWFybiBtb3JlIGluIHRoZSBJZGVudGl0eSBQbGF0Zm9ybSBkb2N1bWVudGF0aW9uIGZvclxuICoge0BsaW5rIGh0dHBzOi8vY2xvdWQuZ29vZ2xlLmNvbS9pZGVudGl0eS1wbGF0Zm9ybS9kb2NzL2FkbWluL2VtYWlsLWVudW1lcmF0aW9uLXByb3RlY3Rpb24gfCBFbWFpbCBFbnVtZXJhdGlvbiBQcm90ZWN0aW9ufS5cbiAqIEBwdWJsaWNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZmV0Y2hTaWduSW5NZXRob2RzRm9yRW1haWwoYXV0aCwgZW1haWwpIHtcbiAgICAvLyBjcmVhdGVBdXRoVXJpIHJldHVybnMgYW4gZXJyb3IgaWYgY29udGludWUgVVJJIGlzIG5vdCBodHRwIG9yIGh0dHBzLlxuICAgIC8vIEZvciBlbnZpcm9ubWVudHMgbGlrZSBDb3Jkb3ZhLCBDaHJvbWUgZXh0ZW5zaW9ucywgbmF0aXZlIGZyYW1ld29ya3MsIGZpbGVcbiAgICAvLyBzeXN0ZW1zLCBldGMsIHVzZSBodHRwOi8vbG9jYWxob3N0IGFzIGNvbnRpbnVlIFVSTC5cbiAgICBjb25zdCBjb250aW51ZVVyaSA9IF9pc0h0dHBPckh0dHBzKCkgPyBfZ2V0Q3VycmVudFVybCgpIDogJ2h0dHA6Ly9sb2NhbGhvc3QnO1xuICAgIGNvbnN0IHJlcXVlc3QgPSB7XG4gICAgICAgIGlkZW50aWZpZXI6IGVtYWlsLFxuICAgICAgICBjb250aW51ZVVyaVxuICAgIH07XG4gICAgY29uc3QgeyBzaWduaW5NZXRob2RzIH0gPSBhd2FpdCBjcmVhdGVBdXRoVXJpKGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKSwgcmVxdWVzdCk7XG4gICAgcmV0dXJuIHNpZ25pbk1ldGhvZHMgfHwgW107XG59XG4vKipcbiAqIFNlbmRzIGEgdmVyaWZpY2F0aW9uIGVtYWlsIHRvIGEgdXNlci5cbiAqXG4gKiBAcmVtYXJrc1xuICogVGhlIHZlcmlmaWNhdGlvbiBwcm9jZXNzIGlzIGNvbXBsZXRlZCBieSBjYWxsaW5nIHtAbGluayBhcHBseUFjdGlvbkNvZGV9LlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiBjb25zdCBhY3Rpb25Db2RlU2V0dGluZ3MgPSB7XG4gKiAgIHVybDogJ2h0dHBzOi8vd3d3LmV4YW1wbGUuY29tLz9lbWFpbD11c2VyQGV4YW1wbGUuY29tJyxcbiAqICAgaU9TOiB7XG4gKiAgICAgIGJ1bmRsZUlkOiAnY29tLmV4YW1wbGUuaW9zJ1xuICogICB9LFxuICogICBhbmRyb2lkOiB7XG4gKiAgICAgcGFja2FnZU5hbWU6ICdjb20uZXhhbXBsZS5hbmRyb2lkJyxcbiAqICAgICBpbnN0YWxsQXBwOiB0cnVlLFxuICogICAgIG1pbmltdW1WZXJzaW9uOiAnMTInXG4gKiAgIH0sXG4gKiAgIGhhbmRsZUNvZGVJbkFwcDogdHJ1ZVxuICogfTtcbiAqIGF3YWl0IHNlbmRFbWFpbFZlcmlmaWNhdGlvbih1c2VyLCBhY3Rpb25Db2RlU2V0dGluZ3MpO1xuICogLy8gT2J0YWluIGNvZGUgZnJvbSB0aGUgdXNlci5cbiAqIGF3YWl0IGFwcGx5QWN0aW9uQ29kZShhdXRoLCBjb2RlKTtcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gYWN0aW9uQ29kZVNldHRpbmdzIC0gVGhlIHtAbGluayBBY3Rpb25Db2RlU2V0dGluZ3N9LlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gc2VuZEVtYWlsVmVyaWZpY2F0aW9uKHVzZXIsIGFjdGlvbkNvZGVTZXR0aW5ncykge1xuICAgIGNvbnN0IHVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKTtcbiAgICBjb25zdCBpZFRva2VuID0gYXdhaXQgdXNlci5nZXRJZFRva2VuKCk7XG4gICAgY29uc3QgcmVxdWVzdCA9IHtcbiAgICAgICAgcmVxdWVzdFR5cGU6IFwiVkVSSUZZX0VNQUlMXCIgLyogQWN0aW9uQ29kZU9wZXJhdGlvbi5WRVJJRllfRU1BSUwgKi8sXG4gICAgICAgIGlkVG9rZW5cbiAgICB9O1xuICAgIGlmIChhY3Rpb25Db2RlU2V0dGluZ3MpIHtcbiAgICAgICAgX3NldEFjdGlvbkNvZGVTZXR0aW5nc09uUmVxdWVzdCh1c2VySW50ZXJuYWwuYXV0aCwgcmVxdWVzdCwgYWN0aW9uQ29kZVNldHRpbmdzKTtcbiAgICB9XG4gICAgY29uc3QgeyBlbWFpbCB9ID0gYXdhaXQgc2VuZEVtYWlsVmVyaWZpY2F0aW9uJDEodXNlckludGVybmFsLmF1dGgsIHJlcXVlc3QpO1xuICAgIGlmIChlbWFpbCAhPT0gdXNlci5lbWFpbCkge1xuICAgICAgICBhd2FpdCB1c2VyLnJlbG9hZCgpO1xuICAgIH1cbn1cbi8qKlxuICogU2VuZHMgYSB2ZXJpZmljYXRpb24gZW1haWwgdG8gYSBuZXcgZW1haWwgYWRkcmVzcy5cbiAqXG4gKiBAcmVtYXJrc1xuICogVGhlIHVzZXIncyBlbWFpbCB3aWxsIGJlIHVwZGF0ZWQgdG8gdGhlIG5ldyBvbmUgYWZ0ZXIgYmVpbmcgdmVyaWZpZWQuXG4gKlxuICogSWYgeW91IGhhdmUgYSBjdXN0b20gZW1haWwgYWN0aW9uIGhhbmRsZXIsIHlvdSBjYW4gY29tcGxldGUgdGhlIHZlcmlmaWNhdGlvbiBwcm9jZXNzIGJ5IGNhbGxpbmdcbiAqIHtAbGluayBhcHBseUFjdGlvbkNvZGV9LlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiBjb25zdCBhY3Rpb25Db2RlU2V0dGluZ3MgPSB7XG4gKiAgIHVybDogJ2h0dHBzOi8vd3d3LmV4YW1wbGUuY29tLz9lbWFpbD11c2VyQGV4YW1wbGUuY29tJyxcbiAqICAgaU9TOiB7XG4gKiAgICAgIGJ1bmRsZUlkOiAnY29tLmV4YW1wbGUuaW9zJ1xuICogICB9LFxuICogICBhbmRyb2lkOiB7XG4gKiAgICAgcGFja2FnZU5hbWU6ICdjb20uZXhhbXBsZS5hbmRyb2lkJyxcbiAqICAgICBpbnN0YWxsQXBwOiB0cnVlLFxuICogICAgIG1pbmltdW1WZXJzaW9uOiAnMTInXG4gKiAgIH0sXG4gKiAgIGhhbmRsZUNvZGVJbkFwcDogdHJ1ZVxuICogfTtcbiAqIGF3YWl0IHZlcmlmeUJlZm9yZVVwZGF0ZUVtYWlsKHVzZXIsICduZXdlbWFpbEBleGFtcGxlLmNvbScsIGFjdGlvbkNvZGVTZXR0aW5ncyk7XG4gKiAvLyBPYnRhaW4gY29kZSBmcm9tIHRoZSB1c2VyLlxuICogYXdhaXQgYXBwbHlBY3Rpb25Db2RlKGF1dGgsIGNvZGUpO1xuICogYGBgXG4gKlxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cbiAqIEBwYXJhbSBuZXdFbWFpbCAtIFRoZSBuZXcgZW1haWwgYWRkcmVzcyB0byBiZSB2ZXJpZmllZCBiZWZvcmUgdXBkYXRlLlxuICogQHBhcmFtIGFjdGlvbkNvZGVTZXR0aW5ncyAtIFRoZSB7QGxpbmsgQWN0aW9uQ29kZVNldHRpbmdzfS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHZlcmlmeUJlZm9yZVVwZGF0ZUVtYWlsKHVzZXIsIG5ld0VtYWlsLCBhY3Rpb25Db2RlU2V0dGluZ3MpIHtcbiAgICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcik7XG4gICAgY29uc3QgaWRUb2tlbiA9IGF3YWl0IHVzZXIuZ2V0SWRUb2tlbigpO1xuICAgIGNvbnN0IHJlcXVlc3QgPSB7XG4gICAgICAgIHJlcXVlc3RUeXBlOiBcIlZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMXCIgLyogQWN0aW9uQ29kZU9wZXJhdGlvbi5WRVJJRllfQU5EX0NIQU5HRV9FTUFJTCAqLyxcbiAgICAgICAgaWRUb2tlbixcbiAgICAgICAgbmV3RW1haWxcbiAgICB9O1xuICAgIGlmIChhY3Rpb25Db2RlU2V0dGluZ3MpIHtcbiAgICAgICAgX3NldEFjdGlvbkNvZGVTZXR0aW5nc09uUmVxdWVzdCh1c2VySW50ZXJuYWwuYXV0aCwgcmVxdWVzdCwgYWN0aW9uQ29kZVNldHRpbmdzKTtcbiAgICB9XG4gICAgY29uc3QgeyBlbWFpbCB9ID0gYXdhaXQgdmVyaWZ5QW5kQ2hhbmdlRW1haWwodXNlckludGVybmFsLmF1dGgsIHJlcXVlc3QpO1xuICAgIGlmIChlbWFpbCAhPT0gdXNlci5lbWFpbCkge1xuICAgICAgICAvLyBJZiB0aGUgbG9jYWwgY29weSBvZiB0aGUgZW1haWwgb24gdXNlciBpcyBvdXRkYXRlZCwgcmVsb2FkIHRoZVxuICAgICAgICAvLyB1c2VyLlxuICAgICAgICBhd2FpdCB1c2VyLnJlbG9hZCgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVByb2ZpbGUkMShhdXRoLCByZXF1ZXN0KSB7XG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBIdHRwTWV0aG9kLlBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnVwZGF0ZVwiIC8qIEVuZHBvaW50LlNFVF9BQ0NPVU5UX0lORk8gKi8sIHJlcXVlc3QpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBVcGRhdGVzIGEgdXNlcidzIHByb2ZpbGUgZGF0YS5cbiAqXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxuICogQHBhcmFtIHByb2ZpbGUgLSBUaGUgcHJvZmlsZSdzIGBkaXNwbGF5TmFtZWAgYW5kIGBwaG90b1VSTGAgdG8gdXBkYXRlLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gdXBkYXRlUHJvZmlsZSh1c2VyLCB7IGRpc3BsYXlOYW1lLCBwaG90b1VSTDogcGhvdG9VcmwgfSkge1xuICAgIGlmIChkaXNwbGF5TmFtZSA9PT0gdW5kZWZpbmVkICYmIHBob3RvVXJsID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcik7XG4gICAgY29uc3QgaWRUb2tlbiA9IGF3YWl0IHVzZXJJbnRlcm5hbC5nZXRJZFRva2VuKCk7XG4gICAgY29uc3QgcHJvZmlsZVJlcXVlc3QgPSB7XG4gICAgICAgIGlkVG9rZW4sXG4gICAgICAgIGRpc3BsYXlOYW1lLFxuICAgICAgICBwaG90b1VybCxcbiAgICAgICAgcmV0dXJuU2VjdXJlVG9rZW46IHRydWVcbiAgICB9O1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgX2xvZ291dElmSW52YWxpZGF0ZWQodXNlckludGVybmFsLCB1cGRhdGVQcm9maWxlJDEodXNlckludGVybmFsLmF1dGgsIHByb2ZpbGVSZXF1ZXN0KSk7XG4gICAgdXNlckludGVybmFsLmRpc3BsYXlOYW1lID0gcmVzcG9uc2UuZGlzcGxheU5hbWUgfHwgbnVsbDtcbiAgICB1c2VySW50ZXJuYWwucGhvdG9VUkwgPSByZXNwb25zZS5waG90b1VybCB8fCBudWxsO1xuICAgIC8vIFVwZGF0ZSB0aGUgcGFzc3dvcmQgcHJvdmlkZXIgYXMgd2VsbFxuICAgIGNvbnN0IHBhc3N3b3JkUHJvdmlkZXIgPSB1c2VySW50ZXJuYWwucHJvdmlkZXJEYXRhLmZpbmQoKHsgcHJvdmlkZXJJZCB9KSA9PiBwcm92aWRlcklkID09PSBcInBhc3N3b3JkXCIgLyogUHJvdmlkZXJJZC5QQVNTV09SRCAqLyk7XG4gICAgaWYgKHBhc3N3b3JkUHJvdmlkZXIpIHtcbiAgICAgICAgcGFzc3dvcmRQcm92aWRlci5kaXNwbGF5TmFtZSA9IHVzZXJJbnRlcm5hbC5kaXNwbGF5TmFtZTtcbiAgICAgICAgcGFzc3dvcmRQcm92aWRlci5waG90b1VSTCA9IHVzZXJJbnRlcm5hbC5waG90b1VSTDtcbiAgICB9XG4gICAgYXdhaXQgdXNlckludGVybmFsLl91cGRhdGVUb2tlbnNJZk5lY2Vzc2FyeShyZXNwb25zZSk7XG59XG4vKipcbiAqIFVwZGF0ZXMgdGhlIHVzZXIncyBlbWFpbCBhZGRyZXNzLlxuICpcbiAqIEByZW1hcmtzXG4gKiBBbiBlbWFpbCB3aWxsIGJlIHNlbnQgdG8gdGhlIG9yaWdpbmFsIGVtYWlsIGFkZHJlc3MgKGlmIGl0IHdhcyBzZXQpIHRoYXQgYWxsb3dzIHRvIHJldm9rZSB0aGVcbiAqIGVtYWlsIGFkZHJlc3MgY2hhbmdlLCBpbiBvcmRlciB0byBwcm90ZWN0IHRoZW0gZnJvbSBhY2NvdW50IGhpamFja2luZy5cbiAqXG4gKiBUaGlzIG1ldGhvZCBpcyBub3Qgc3VwcG9ydGVkIG9uIGFueSB7QGxpbmsgVXNlcn0gc2lnbmVkIGluIGJ5IHtAbGluayBBdXRofSBpbnN0YW5jZXNcbiAqIGNyZWF0ZWQgd2l0aCBhIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlU2VydmVyQXBwfS5cbiAqXG4gKiBJbXBvcnRhbnQ6IHRoaXMgaXMgYSBzZWN1cml0eSBzZW5zaXRpdmUgb3BlcmF0aW9uIHRoYXQgcmVxdWlyZXMgdGhlIHVzZXIgdG8gaGF2ZSByZWNlbnRseSBzaWduZWRcbiAqIGluLiBJZiB0aGlzIHJlcXVpcmVtZW50IGlzbid0IG1ldCwgYXNrIHRoZSB1c2VyIHRvIGF1dGhlbnRpY2F0ZSBhZ2FpbiBhbmQgdGhlbiBjYWxsXG4gKiB7QGxpbmsgcmVhdXRoZW50aWNhdGVXaXRoQ3JlZGVudGlhbH0uXG4gKlxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cbiAqIEBwYXJhbSBuZXdFbWFpbCAtIFRoZSBuZXcgZW1haWwgYWRkcmVzcy5cbiAqXG4gKiBUaHJvd3MgXCJhdXRoL29wZXJhdGlvbi1ub3QtYWxsb3dlZFwiIGVycm9yIHdoZW5cbiAqIHtAbGluayBodHRwczovL2Nsb3VkLmdvb2dsZS5jb20vaWRlbnRpdHktcGxhdGZvcm0vZG9jcy9hZG1pbi9lbWFpbC1lbnVtZXJhdGlvbi1wcm90ZWN0aW9uIHwgRW1haWwgRW51bWVyYXRpb24gUHJvdGVjdGlvbn1cbiAqIGlzIGVuYWJsZWQuXG4gKiBEZXByZWNhdGVkIC0gVXNlIHtAbGluayB2ZXJpZnlCZWZvcmVVcGRhdGVFbWFpbH0gaW5zdGVhZC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIHVwZGF0ZUVtYWlsKHVzZXIsIG5ld0VtYWlsKSB7XG4gICAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpO1xuICAgIGlmIChfaXNGaXJlYmFzZVNlcnZlckFwcCh1c2VySW50ZXJuYWwuYXV0aC5hcHApKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChfc2VydmVyQXBwQ3VycmVudFVzZXJPcGVyYXRpb25Ob3RTdXBwb3J0ZWRFcnJvcih1c2VySW50ZXJuYWwuYXV0aCkpO1xuICAgIH1cbiAgICByZXR1cm4gdXBkYXRlRW1haWxPclBhc3N3b3JkKHVzZXJJbnRlcm5hbCwgbmV3RW1haWwsIG51bGwpO1xufVxuLyoqXG4gKiBVcGRhdGVzIHRoZSB1c2VyJ3MgcGFzc3dvcmQuXG4gKlxuICogQHJlbWFya3NcbiAqIEltcG9ydGFudDogdGhpcyBpcyBhIHNlY3VyaXR5IHNlbnNpdGl2ZSBvcGVyYXRpb24gdGhhdCByZXF1aXJlcyB0aGUgdXNlciB0byBoYXZlIHJlY2VudGx5IHNpZ25lZFxuICogaW4uIElmIHRoaXMgcmVxdWlyZW1lbnQgaXNuJ3QgbWV0LCBhc2sgdGhlIHVzZXIgdG8gYXV0aGVudGljYXRlIGFnYWluIGFuZCB0aGVuIGNhbGxcbiAqIHtAbGluayByZWF1dGhlbnRpY2F0ZVdpdGhDcmVkZW50aWFsfS5cbiAqXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxuICogQHBhcmFtIG5ld1Bhc3N3b3JkIC0gVGhlIG5ldyBwYXNzd29yZC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIHVwZGF0ZVBhc3N3b3JkKHVzZXIsIG5ld1Bhc3N3b3JkKSB7XG4gICAgcmV0dXJuIHVwZGF0ZUVtYWlsT3JQYXNzd29yZChnZXRNb2R1bGFySW5zdGFuY2UodXNlciksIG51bGwsIG5ld1Bhc3N3b3JkKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUVtYWlsT3JQYXNzd29yZCh1c2VyLCBlbWFpbCwgcGFzc3dvcmQpIHtcbiAgICBjb25zdCB7IGF1dGggfSA9IHVzZXI7XG4gICAgY29uc3QgaWRUb2tlbiA9IGF3YWl0IHVzZXIuZ2V0SWRUb2tlbigpO1xuICAgIGNvbnN0IHJlcXVlc3QgPSB7XG4gICAgICAgIGlkVG9rZW4sXG4gICAgICAgIHJldHVyblNlY3VyZVRva2VuOiB0cnVlXG4gICAgfTtcbiAgICBpZiAoZW1haWwpIHtcbiAgICAgICAgcmVxdWVzdC5lbWFpbCA9IGVtYWlsO1xuICAgIH1cbiAgICBpZiAocGFzc3dvcmQpIHtcbiAgICAgICAgcmVxdWVzdC5wYXNzd29yZCA9IHBhc3N3b3JkO1xuICAgIH1cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IF9sb2dvdXRJZkludmFsaWRhdGVkKHVzZXIsIHVwZGF0ZUVtYWlsUGFzc3dvcmQoYXV0aCwgcmVxdWVzdCkpO1xuICAgIGF3YWl0IHVzZXIuX3VwZGF0ZVRva2Vuc0lmTmVjZXNzYXJ5KHJlc3BvbnNlLCAvKiByZWxvYWQgKi8gdHJ1ZSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFBhcnNlIHRoZSBgQWRkaXRpb25hbFVzZXJJbmZvYCBmcm9tIHRoZSBJRCB0b2tlbiByZXNwb25zZS5cbiAqXG4gKi9cbmZ1bmN0aW9uIF9mcm9tSWRUb2tlblJlc3BvbnNlKGlkVG9rZW5SZXNwb25zZSkge1xuICAgIGlmICghaWRUb2tlblJlc3BvbnNlKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCB7IHByb3ZpZGVySWQgfSA9IGlkVG9rZW5SZXNwb25zZTtcbiAgICBjb25zdCBwcm9maWxlID0gaWRUb2tlblJlc3BvbnNlLnJhd1VzZXJJbmZvXG4gICAgICAgID8gSlNPTi5wYXJzZShpZFRva2VuUmVzcG9uc2UucmF3VXNlckluZm8pXG4gICAgICAgIDoge307XG4gICAgY29uc3QgaXNOZXdVc2VyID0gaWRUb2tlblJlc3BvbnNlLmlzTmV3VXNlciB8fFxuICAgICAgICBpZFRva2VuUmVzcG9uc2Uua2luZCA9PT0gXCJpZGVudGl0eXRvb2xraXQjU2lnbnVwTmV3VXNlclJlc3BvbnNlXCIgLyogSWRUb2tlblJlc3BvbnNlS2luZC5TaWdudXBOZXdVc2VyICovO1xuICAgIGlmICghcHJvdmlkZXJJZCAmJiBpZFRva2VuUmVzcG9uc2U/LmlkVG9rZW4pIHtcbiAgICAgICAgY29uc3Qgc2lnbkluUHJvdmlkZXIgPSBfcGFyc2VUb2tlbihpZFRva2VuUmVzcG9uc2UuaWRUb2tlbik/LmZpcmViYXNlPy5bJ3NpZ25faW5fcHJvdmlkZXInXTtcbiAgICAgICAgaWYgKHNpZ25JblByb3ZpZGVyKSB7XG4gICAgICAgICAgICBjb25zdCBmaWx0ZXJlZFByb3ZpZGVySWQgPSBzaWduSW5Qcm92aWRlciAhPT0gXCJhbm9ueW1vdXNcIiAvKiBQcm92aWRlcklkLkFOT05ZTU9VUyAqLyAmJlxuICAgICAgICAgICAgICAgIHNpZ25JblByb3ZpZGVyICE9PSBcImN1c3RvbVwiIC8qIFByb3ZpZGVySWQuQ1VTVE9NICovXG4gICAgICAgICAgICAgICAgPyBzaWduSW5Qcm92aWRlclxuICAgICAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgICAgIC8vIFVzZXMgZ2VuZXJpYyBjbGFzcyBpbiBhY2NvcmRhbmNlIHdpdGggdGhlIGxlZ2FjeSBTREsuXG4gICAgICAgICAgICByZXR1cm4gbmV3IEdlbmVyaWNBZGRpdGlvbmFsVXNlckluZm8oaXNOZXdVc2VyLCBmaWx0ZXJlZFByb3ZpZGVySWQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICghcHJvdmlkZXJJZCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgc3dpdGNoIChwcm92aWRlcklkKSB7XG4gICAgICAgIGNhc2UgXCJmYWNlYm9vay5jb21cIiAvKiBQcm92aWRlcklkLkZBQ0VCT09LICovOlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBGYWNlYm9va0FkZGl0aW9uYWxVc2VySW5mbyhpc05ld1VzZXIsIHByb2ZpbGUpO1xuICAgICAgICBjYXNlIFwiZ2l0aHViLmNvbVwiIC8qIFByb3ZpZGVySWQuR0lUSFVCICovOlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBHaXRodWJBZGRpdGlvbmFsVXNlckluZm8oaXNOZXdVc2VyLCBwcm9maWxlKTtcbiAgICAgICAgY2FzZSBcImdvb2dsZS5jb21cIiAvKiBQcm92aWRlcklkLkdPT0dMRSAqLzpcbiAgICAgICAgICAgIHJldHVybiBuZXcgR29vZ2xlQWRkaXRpb25hbFVzZXJJbmZvKGlzTmV3VXNlciwgcHJvZmlsZSk7XG4gICAgICAgIGNhc2UgXCJ0d2l0dGVyLmNvbVwiIC8qIFByb3ZpZGVySWQuVFdJVFRFUiAqLzpcbiAgICAgICAgICAgIHJldHVybiBuZXcgVHdpdHRlckFkZGl0aW9uYWxVc2VySW5mbyhpc05ld1VzZXIsIHByb2ZpbGUsIGlkVG9rZW5SZXNwb25zZS5zY3JlZW5OYW1lIHx8IG51bGwpO1xuICAgICAgICBjYXNlIFwiY3VzdG9tXCIgLyogUHJvdmlkZXJJZC5DVVNUT00gKi86XG4gICAgICAgIGNhc2UgXCJhbm9ueW1vdXNcIiAvKiBQcm92aWRlcklkLkFOT05ZTU9VUyAqLzpcbiAgICAgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0FkZGl0aW9uYWxVc2VySW5mbyhpc05ld1VzZXIsIG51bGwpO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmljQWRkaXRpb25hbFVzZXJJbmZvKGlzTmV3VXNlciwgcHJvdmlkZXJJZCwgcHJvZmlsZSk7XG4gICAgfVxufVxuY2xhc3MgR2VuZXJpY0FkZGl0aW9uYWxVc2VySW5mbyB7XG4gICAgY29uc3RydWN0b3IoaXNOZXdVc2VyLCBwcm92aWRlcklkLCBwcm9maWxlID0ge30pIHtcbiAgICAgICAgdGhpcy5pc05ld1VzZXIgPSBpc05ld1VzZXI7XG4gICAgICAgIHRoaXMucHJvdmlkZXJJZCA9IHByb3ZpZGVySWQ7XG4gICAgICAgIHRoaXMucHJvZmlsZSA9IHByb2ZpbGU7XG4gICAgfVxufVxuY2xhc3MgRmVkZXJhdGVkQWRkaXRpb25hbFVzZXJJbmZvV2l0aFVzZXJuYW1lIGV4dGVuZHMgR2VuZXJpY0FkZGl0aW9uYWxVc2VySW5mbyB7XG4gICAgY29uc3RydWN0b3IoaXNOZXdVc2VyLCBwcm92aWRlcklkLCBwcm9maWxlLCB1c2VybmFtZSkge1xuICAgICAgICBzdXBlcihpc05ld1VzZXIsIHByb3ZpZGVySWQsIHByb2ZpbGUpO1xuICAgICAgICB0aGlzLnVzZXJuYW1lID0gdXNlcm5hbWU7XG4gICAgfVxufVxuY2xhc3MgRmFjZWJvb2tBZGRpdGlvbmFsVXNlckluZm8gZXh0ZW5kcyBHZW5lcmljQWRkaXRpb25hbFVzZXJJbmZvIHtcbiAgICBjb25zdHJ1Y3Rvcihpc05ld1VzZXIsIHByb2ZpbGUpIHtcbiAgICAgICAgc3VwZXIoaXNOZXdVc2VyLCBcImZhY2Vib29rLmNvbVwiIC8qIFByb3ZpZGVySWQuRkFDRUJPT0sgKi8sIHByb2ZpbGUpO1xuICAgIH1cbn1cbmNsYXNzIEdpdGh1YkFkZGl0aW9uYWxVc2VySW5mbyBleHRlbmRzIEZlZGVyYXRlZEFkZGl0aW9uYWxVc2VySW5mb1dpdGhVc2VybmFtZSB7XG4gICAgY29uc3RydWN0b3IoaXNOZXdVc2VyLCBwcm9maWxlKSB7XG4gICAgICAgIHN1cGVyKGlzTmV3VXNlciwgXCJnaXRodWIuY29tXCIgLyogUHJvdmlkZXJJZC5HSVRIVUIgKi8sIHByb2ZpbGUsIHR5cGVvZiBwcm9maWxlPy5sb2dpbiA9PT0gJ3N0cmluZycgPyBwcm9maWxlPy5sb2dpbiA6IG51bGwpO1xuICAgIH1cbn1cbmNsYXNzIEdvb2dsZUFkZGl0aW9uYWxVc2VySW5mbyBleHRlbmRzIEdlbmVyaWNBZGRpdGlvbmFsVXNlckluZm8ge1xuICAgIGNvbnN0cnVjdG9yKGlzTmV3VXNlciwgcHJvZmlsZSkge1xuICAgICAgICBzdXBlcihpc05ld1VzZXIsIFwiZ29vZ2xlLmNvbVwiIC8qIFByb3ZpZGVySWQuR09PR0xFICovLCBwcm9maWxlKTtcbiAgICB9XG59XG5jbGFzcyBUd2l0dGVyQWRkaXRpb25hbFVzZXJJbmZvIGV4dGVuZHMgRmVkZXJhdGVkQWRkaXRpb25hbFVzZXJJbmZvV2l0aFVzZXJuYW1lIHtcbiAgICBjb25zdHJ1Y3Rvcihpc05ld1VzZXIsIHByb2ZpbGUsIHNjcmVlbk5hbWUpIHtcbiAgICAgICAgc3VwZXIoaXNOZXdVc2VyLCBcInR3aXR0ZXIuY29tXCIgLyogUHJvdmlkZXJJZC5UV0lUVEVSICovLCBwcm9maWxlLCBzY3JlZW5OYW1lKTtcbiAgICB9XG59XG4vKipcbiAqIEV4dHJhY3RzIHByb3ZpZGVyIHNwZWNpZmljIHtAbGluayBBZGRpdGlvbmFsVXNlckluZm99IGZvciB0aGUgZ2l2ZW4gY3JlZGVudGlhbC5cbiAqXG4gKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZnVuY3Rpb24gZ2V0QWRkaXRpb25hbFVzZXJJbmZvKHVzZXJDcmVkZW50aWFsKSB7XG4gICAgY29uc3QgeyB1c2VyLCBfdG9rZW5SZXNwb25zZSB9ID0gdXNlckNyZWRlbnRpYWw7XG4gICAgaWYgKHVzZXIuaXNBbm9ueW1vdXMgJiYgIV90b2tlblJlc3BvbnNlKSB7XG4gICAgICAgIC8vIEhhbmRsZSB0aGUgc3BlY2lhbCBjYXNlIHdoZXJlIHNpZ25JbkFub255bW91c2x5KCkgZ2V0cyBjYWxsZWQgdHdpY2UuXG4gICAgICAgIC8vIE5vIG5ldHdvcmsgY2FsbCBpcyBtYWRlIHNvIHRoZXJlJ3Mgbm90aGluZyB0byBhY3R1YWxseSBmaWxsIHRoaXMgaW5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHByb3ZpZGVySWQ6IG51bGwsXG4gICAgICAgICAgICBpc05ld1VzZXI6IGZhbHNlLFxuICAgICAgICAgICAgcHJvZmlsZTogbnVsbFxuICAgICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gX2Zyb21JZFRva2VuUmVzcG9uc2UoX3Rva2VuUmVzcG9uc2UpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gTm9uLW9wdGlvbmFsIGF1dGggbWV0aG9kcy5cbi8qKlxuICogQ2hhbmdlcyB0aGUgdHlwZSBvZiBwZXJzaXN0ZW5jZSBvbiB0aGUge0BsaW5rIEF1dGh9IGluc3RhbmNlIGZvciB0aGUgY3VycmVudGx5IHNhdmVkXG4gKiBgQXV0aGAgc2Vzc2lvbiBhbmQgYXBwbGllcyB0aGlzIHR5cGUgb2YgcGVyc2lzdGVuY2UgZm9yIGZ1dHVyZSBzaWduLWluIHJlcXVlc3RzLCBpbmNsdWRpbmdcbiAqIHNpZ24taW4gd2l0aCByZWRpcmVjdCByZXF1ZXN0cy5cbiAqXG4gKiBAcmVtYXJrc1xuICogVGhpcyBtYWtlcyBpdCBlYXN5IGZvciBhIHVzZXIgc2lnbmluZyBpbiB0byBzcGVjaWZ5IHdoZXRoZXIgdGhlaXIgc2Vzc2lvbiBzaG91bGQgYmVcbiAqIHJlbWVtYmVyZWQgb3Igbm90LiBJdCBhbHNvIG1ha2VzIGl0IGVhc2llciB0byBuZXZlciBwZXJzaXN0IHRoZSBgQXV0aGAgc3RhdGUgZm9yIGFwcGxpY2F0aW9uc1xuICogdGhhdCBhcmUgc2hhcmVkIGJ5IG90aGVyIHVzZXJzIG9yIGhhdmUgc2Vuc2l0aXZlIGRhdGEuXG4gKlxuICogVGhpcyBtZXRob2QgZG9lcyBub3Qgd29yayBpbiBhIE5vZGUuanMgZW52aXJvbm1lbnQgb3Igd2l0aCB7QGxpbmsgQXV0aH0gaW5zdGFuY2VzIGNyZWF0ZWQgd2l0aCBhXG4gKiB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZVNlcnZlckFwcH0uXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIHNldFBlcnNpc3RlbmNlKGF1dGgsIGJyb3dzZXJTZXNzaW9uUGVyc2lzdGVuY2UpO1xuICogYGBgXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIHBlcnNpc3RlbmNlIC0gVGhlIHtAbGluayBQZXJzaXN0ZW5jZX0gdG8gdXNlLlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCByZXNvbHZlcyBvbmNlIHRoZSBwZXJzaXN0ZW5jZSBjaGFuZ2UgaGFzIGNvbXBsZXRlZFxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZnVuY3Rpb24gc2V0UGVyc2lzdGVuY2UoYXV0aCwgcGVyc2lzdGVuY2UpIHtcbiAgICByZXR1cm4gZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLnNldFBlcnNpc3RlbmNlKHBlcnNpc3RlbmNlKTtcbn1cbi8qKlxuICogTG9hZHMgdGhlIHJlQ0FQVENIQSBjb25maWd1cmF0aW9uIGludG8gdGhlIGBBdXRoYCBpbnN0YW5jZS5cbiAqXG4gKiBAcmVtYXJrc1xuICogVGhpcyB3aWxsIGxvYWQgdGhlIHJlQ0FQVENIQSBjb25maWcsIHdoaWNoIGluZGljYXRlcyB3aGV0aGVyIHRoZSByZUNBUFRDSEFcbiAqIHZlcmlmaWNhdGlvbiBmbG93IHNob3VsZCBiZSB0cmlnZ2VyZWQgZm9yIGVhY2ggYXV0aCBwcm92aWRlciwgaW50byB0aGVcbiAqIGN1cnJlbnQgQXV0aCBzZXNzaW9uLlxuICpcbiAqIElmIGluaXRpYWxpemVSZWNhcHRjaGFDb25maWcoKSBpcyBub3QgaW52b2tlZCwgdGhlIGF1dGggZmxvdyB3aWxsIGFsd2F5cyBzdGFydFxuICogd2l0aG91dCByZUNBUFRDSEEgdmVyaWZpY2F0aW9uLiBJZiB0aGUgcHJvdmlkZXIgaXMgY29uZmlndXJlZCB0byByZXF1aXJlIHJlQ0FQVENIQVxuICogdmVyaWZpY2F0aW9uLCB0aGUgU0RLIHdpbGwgdHJhbnNwYXJlbnRseSBsb2FkIHRoZSByZUNBUFRDSEEgY29uZmlnIGFuZCByZXN0YXJ0IHRoZVxuICogYXV0aCBmbG93cy5cbiAqXG4gKiBUaHVzLCBieSBjYWxsaW5nIHRoaXMgb3B0aW9uYWwgbWV0aG9kLCB5b3Ugd2lsbCByZWR1Y2UgdGhlIGxhdGVuY3kgb2YgZnV0dXJlIGF1dGggZmxvd3MuXG4gKiBMb2FkaW5nIHRoZSByZUNBUFRDSEEgY29uZmlnIGVhcmx5IHdpbGwgYWxzbyBlbmhhbmNlIHRoZSBzaWduYWwgY29sbGVjdGVkIGJ5IHJlQ0FQVENIQS5cbiAqXG4gKiBUaGlzIG1ldGhvZCBkb2VzIG5vdCB3b3JrIGluIGEgTm9kZS5qcyBlbnZpcm9ubWVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogaW5pdGlhbGl6ZVJlY2FwdGNoYUNvbmZpZyhhdXRoKTtcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIGluaXRpYWxpemVSZWNhcHRjaGFDb25maWcoYXV0aCkge1xuICAgIHJldHVybiBfaW5pdGlhbGl6ZVJlY2FwdGNoYUNvbmZpZyhhdXRoKTtcbn1cbi8qKlxuICogVmFsaWRhdGVzIHRoZSBwYXNzd29yZCBhZ2FpbnN0IHRoZSBwYXNzd29yZCBwb2xpY3kgY29uZmlndXJlZCBmb3IgdGhlIHByb2plY3Qgb3IgdGVuYW50LlxuICpcbiAqIEByZW1hcmtzXG4gKiBJZiBubyB0ZW5hbnQgSUQgaXMgc2V0IG9uIHRoZSBgQXV0aGAgaW5zdGFuY2UsIHRoZW4gdGhpcyBtZXRob2Qgd2lsbCB1c2UgdGhlIHBhc3N3b3JkXG4gKiBwb2xpY3kgY29uZmlndXJlZCBmb3IgdGhlIHByb2plY3QuIE90aGVyd2lzZSwgdGhpcyBtZXRob2Qgd2lsbCB1c2UgdGhlIHBvbGljeSBjb25maWd1cmVkXG4gKiBmb3IgdGhlIHRlbmFudC4gSWYgYSBwYXNzd29yZCBwb2xpY3kgaGFzIG5vdCBiZWVuIGNvbmZpZ3VyZWQsIHRoZW4gdGhlIGRlZmF1bHQgcG9saWN5XG4gKiBjb25maWd1cmVkIGZvciBhbGwgcHJvamVjdHMgd2lsbCBiZSB1c2VkLlxuICpcbiAqIElmIGFuIGF1dGggZmxvdyBmYWlscyBiZWNhdXNlIGEgc3VibWl0dGVkIHBhc3N3b3JkIGRvZXMgbm90IG1lZXQgdGhlIHBhc3N3b3JkIHBvbGljeVxuICogcmVxdWlyZW1lbnRzIGFuZCB0aGlzIG1ldGhvZCBoYXMgcHJldmlvdXNseSBiZWVuIGNhbGxlZCwgdGhlbiB0aGlzIG1ldGhvZCB3aWxsIHVzZSB0aGVcbiAqIG1vc3QgcmVjZW50IHBvbGljeSBhdmFpbGFibGUgd2hlbiBjYWxsZWQgYWdhaW4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIHZhbGlkYXRlUGFzc3dvcmQoYXV0aCwgJ3NvbWUtcGFzc3dvcmQnKTtcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSBhdXRoIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gcGFzc3dvcmQgVGhlIHBhc3N3b3JkIHRvIHZhbGlkYXRlLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gdmFsaWRhdGVQYXNzd29yZChhdXRoLCBwYXNzd29yZCkge1xuICAgIGNvbnN0IGF1dGhJbnRlcm5hbCA9IF9jYXN0QXV0aChhdXRoKTtcbiAgICByZXR1cm4gYXV0aEludGVybmFsLnZhbGlkYXRlUGFzc3dvcmQocGFzc3dvcmQpO1xufVxuLyoqXG4gKiBBZGRzIGFuIG9ic2VydmVyIGZvciBjaGFuZ2VzIHRvIHRoZSBzaWduZWQtaW4gdXNlcidzIElEIHRva2VuLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUaGlzIGluY2x1ZGVzIHNpZ24taW4sIHNpZ24tb3V0LCBhbmQgdG9rZW4gcmVmcmVzaCBldmVudHMuXG4gKiBUaGlzIHdpbGwgbm90IGJlIHRyaWdnZXJlZCBhdXRvbWF0aWNhbGx5IHVwb24gSUQgdG9rZW4gZXhwaXJhdGlvbi4gVXNlIHtAbGluayBVc2VyLmdldElkVG9rZW59IHRvIHJlZnJlc2ggdGhlIElEIHRva2VuLlxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSBuZXh0T3JPYnNlcnZlciAtIGNhbGxiYWNrIHRyaWdnZXJlZCBvbiBjaGFuZ2UuXG4gKiBAcGFyYW0gZXJyb3IgLSBEZXByZWNhdGVkLiBUaGlzIGNhbGxiYWNrIGlzIG5ldmVyIHRyaWdnZXJlZC4gRXJyb3JzXG4gKiBvbiBzaWduaW5nIGluL291dCBjYW4gYmUgY2F1Z2h0IGluIHByb21pc2VzIHJldHVybmVkIGZyb21cbiAqIHNpZ24taW4vc2lnbi1vdXQgZnVuY3Rpb25zLlxuICogQHBhcmFtIGNvbXBsZXRlZCAtIERlcHJlY2F0ZWQuIFRoaXMgY2FsbGJhY2sgaXMgbmV2ZXIgdHJpZ2dlcmVkLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZnVuY3Rpb24gb25JZFRva2VuQ2hhbmdlZChhdXRoLCBuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlZCkge1xuICAgIHJldHVybiBnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCkub25JZFRva2VuQ2hhbmdlZChuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlZCk7XG59XG4vKipcbiAqIEFkZHMgYSBibG9ja2luZyBjYWxsYmFjayB0aGF0IHJ1bnMgYmVmb3JlIGFuIGF1dGggc3RhdGUgY2hhbmdlXG4gKiBzZXRzIGEgbmV3IHVzZXIuXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIGNhbGxiYWNrIC0gY2FsbGJhY2sgdHJpZ2dlcmVkIGJlZm9yZSBuZXcgdXNlciB2YWx1ZSBpcyBzZXQuXG4gKiAgIElmIHRoaXMgdGhyb3dzLCBpdCBibG9ja3MgdGhlIHVzZXIgZnJvbSBiZWluZyBzZXQuXG4gKiBAcGFyYW0gb25BYm9ydCAtIGNhbGxiYWNrIHRyaWdnZXJlZCBpZiBhIGxhdGVyIGBiZWZvcmVBdXRoU3RhdGVDaGFuZ2VkKClgXG4gKiAgIGNhbGxiYWNrIHRocm93cywgYWxsb3dpbmcgeW91IHRvIHVuZG8gYW55IHNpZGUgZWZmZWN0cy5cbiAqL1xuZnVuY3Rpb24gYmVmb3JlQXV0aFN0YXRlQ2hhbmdlZChhdXRoLCBjYWxsYmFjaywgb25BYm9ydCkge1xuICAgIHJldHVybiBnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCkuYmVmb3JlQXV0aFN0YXRlQ2hhbmdlZChjYWxsYmFjaywgb25BYm9ydCk7XG59XG4vKipcbiAqIEFkZHMgYW4gb2JzZXJ2ZXIgZm9yIGNoYW5nZXMgdG8gdGhlIHVzZXIncyBzaWduLWluIHN0YXRlLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUbyBrZWVwIHRoZSBvbGQgYmVoYXZpb3IsIHNlZSB7QGxpbmsgb25JZFRva2VuQ2hhbmdlZH0uXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIG5leHRPck9ic2VydmVyIC0gY2FsbGJhY2sgdHJpZ2dlcmVkIG9uIGNoYW5nZS5cbiAqIEBwYXJhbSBlcnJvciAtIERlcHJlY2F0ZWQuIFRoaXMgY2FsbGJhY2sgaXMgbmV2ZXIgdHJpZ2dlcmVkLiBFcnJvcnNcbiAqIG9uIHNpZ25pbmcgaW4vb3V0IGNhbiBiZSBjYXVnaHQgaW4gcHJvbWlzZXMgcmV0dXJuZWQgZnJvbVxuICogc2lnbi1pbi9zaWduLW91dCBmdW5jdGlvbnMuXG4gKiBAcGFyYW0gY29tcGxldGVkIC0gRGVwcmVjYXRlZC4gVGhpcyBjYWxsYmFjayBpcyBuZXZlciB0cmlnZ2VyZWQuXG4gKlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiBvbkF1dGhTdGF0ZUNoYW5nZWQoYXV0aCwgbmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZWQpIHtcbiAgICByZXR1cm4gZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLm9uQXV0aFN0YXRlQ2hhbmdlZChuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlZCk7XG59XG4vKipcbiAqIFNldHMgdGhlIGN1cnJlbnQgbGFuZ3VhZ2UgdG8gdGhlIGRlZmF1bHQgZGV2aWNlL2Jyb3dzZXIgcHJlZmVyZW5jZS5cbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiB1c2VEZXZpY2VMYW5ndWFnZShhdXRoKSB7XG4gICAgZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLnVzZURldmljZUxhbmd1YWdlKCk7XG59XG4vKipcbiAqIEFzeW5jaHJvbm91c2x5IHNldHMgdGhlIHByb3ZpZGVkIHVzZXIgYXMge0BsaW5rIEF1dGguY3VycmVudFVzZXJ9IG9uIHRoZVxuICoge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICpcbiAqIEByZW1hcmtzXG4gKiBBIG5ldyBpbnN0YW5jZSBjb3B5IG9mIHRoZSB1c2VyIHByb3ZpZGVkIHdpbGwgYmUgbWFkZSBhbmQgc2V0IGFzIGN1cnJlbnRVc2VyLlxuICpcbiAqIFRoaXMgd2lsbCB0cmlnZ2VyIHtAbGluayBvbkF1dGhTdGF0ZUNoYW5nZWR9IGFuZCB7QGxpbmsgb25JZFRva2VuQ2hhbmdlZH0gbGlzdGVuZXJzXG4gKiBsaWtlIG90aGVyIHNpZ24gaW4gbWV0aG9kcy5cbiAqXG4gKiBUaGUgb3BlcmF0aW9uIGZhaWxzIHdpdGggYW4gZXJyb3IgaWYgdGhlIHVzZXIgdG8gYmUgdXBkYXRlZCBiZWxvbmdzIHRvIGEgZGlmZmVyZW50IEZpcmViYXNlXG4gKiBwcm9qZWN0LlxuICpcbiAqIFRoaXMgbWV0aG9kIGlzIG5vdCBzdXBwb3J0ZWQgYnkge0BsaW5rIEF1dGh9IGluc3RhbmNlcyBjcmVhdGVkIHdpdGggYVxuICoge0BsaW5rIEBmaXJlYmFzZS9hcHAjRmlyZWJhc2VTZXJ2ZXJBcHB9LlxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSB1c2VyIC0gVGhlIG5ldyB7QGxpbmsgVXNlcn0uXG4gKlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiB1cGRhdGVDdXJyZW50VXNlcihhdXRoLCB1c2VyKSB7XG4gICAgcmV0dXJuIGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKS51cGRhdGVDdXJyZW50VXNlcih1c2VyKTtcbn1cbi8qKlxuICogU2lnbnMgb3V0IHRoZSBjdXJyZW50IHVzZXIuXG4gKlxuICogQHJlbWFya3NcbiAqIFRoaXMgbWV0aG9kIGlzIG5vdCBzdXBwb3J0ZWQgYnkge0BsaW5rIEF1dGh9IGluc3RhbmNlcyBjcmVhdGVkIHdpdGggYVxuICoge0BsaW5rIEBmaXJlYmFzZS9hcHAjRmlyZWJhc2VTZXJ2ZXJBcHB9LlxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIHNpZ25PdXQoYXV0aCkge1xuICAgIHJldHVybiBnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCkuc2lnbk91dCgpO1xufVxuLyoqXG4gKiBSZXZva2VzIHRoZSBnaXZlbiBhY2Nlc3MgdG9rZW4uIEN1cnJlbnRseSBvbmx5IHN1cHBvcnRzIEFwcGxlIE9BdXRoIGFjY2VzcyB0b2tlbnMuXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIHRva2VuIC0gVGhlIEFwcGxlIE9BdXRoIGFjY2VzcyB0b2tlbi5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIHJldm9rZUFjY2Vzc1Rva2VuKGF1dGgsIHRva2VuKSB7XG4gICAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xuICAgIHJldHVybiBhdXRoSW50ZXJuYWwucmV2b2tlQWNjZXNzVG9rZW4odG9rZW4pO1xufVxuLyoqXG4gKiBEZWxldGVzIGFuZCBzaWducyBvdXQgdGhlIHVzZXIuXG4gKlxuICogQHJlbWFya3NcbiAqIEltcG9ydGFudDogdGhpcyBpcyBhIHNlY3VyaXR5LXNlbnNpdGl2ZSBvcGVyYXRpb24gdGhhdCByZXF1aXJlcyB0aGUgdXNlciB0byBoYXZlIHJlY2VudGx5XG4gKiBzaWduZWQgaW4uIElmIHRoaXMgcmVxdWlyZW1lbnQgaXNuJ3QgbWV0LCBhc2sgdGhlIHVzZXIgdG8gYXV0aGVudGljYXRlIGFnYWluIGFuZCB0aGVuIGNhbGxcbiAqIHtAbGluayByZWF1dGhlbnRpY2F0ZVdpdGhDcmVkZW50aWFsfS5cbiAqXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZGVsZXRlVXNlcih1c2VyKSB7XG4gICAgcmV0dXJuIGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKS5kZWxldGUoKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNsYXNzIE11bHRpRmFjdG9yU2Vzc2lvbkltcGwge1xuICAgIGNvbnN0cnVjdG9yKHR5cGUsIGNyZWRlbnRpYWwsIHVzZXIpIHtcbiAgICAgICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICAgICAgdGhpcy5jcmVkZW50aWFsID0gY3JlZGVudGlhbDtcbiAgICAgICAgdGhpcy51c2VyID0gdXNlcjtcbiAgICB9XG4gICAgc3RhdGljIF9mcm9tSWR0b2tlbihpZFRva2VuLCB1c2VyKSB7XG4gICAgICAgIHJldHVybiBuZXcgTXVsdGlGYWN0b3JTZXNzaW9uSW1wbChcImVucm9sbFwiIC8qIE11bHRpRmFjdG9yU2Vzc2lvblR5cGUuRU5ST0xMICovLCBpZFRva2VuLCB1c2VyKTtcbiAgICB9XG4gICAgc3RhdGljIF9mcm9tTWZhUGVuZGluZ0NyZWRlbnRpYWwobWZhUGVuZGluZ0NyZWRlbnRpYWwpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNdWx0aUZhY3RvclNlc3Npb25JbXBsKFwic2lnbmluXCIgLyogTXVsdGlGYWN0b3JTZXNzaW9uVHlwZS5TSUdOX0lOICovLCBtZmFQZW5kaW5nQ3JlZGVudGlhbCk7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgY29uc3Qga2V5ID0gdGhpcy50eXBlID09PSBcImVucm9sbFwiIC8qIE11bHRpRmFjdG9yU2Vzc2lvblR5cGUuRU5ST0xMICovXG4gICAgICAgICAgICA/ICdpZFRva2VuJ1xuICAgICAgICAgICAgOiAncGVuZGluZ0NyZWRlbnRpYWwnO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbXVsdGlGYWN0b3JTZXNzaW9uOiB7XG4gICAgICAgICAgICAgICAgW2tleV06IHRoaXMuY3JlZGVudGlhbFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbUpTT04ob2JqKSB7XG4gICAgICAgIGlmIChvYmo/Lm11bHRpRmFjdG9yU2Vzc2lvbikge1xuICAgICAgICAgICAgaWYgKG9iai5tdWx0aUZhY3RvclNlc3Npb24/LnBlbmRpbmdDcmVkZW50aWFsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE11bHRpRmFjdG9yU2Vzc2lvbkltcGwuX2Zyb21NZmFQZW5kaW5nQ3JlZGVudGlhbChvYmoubXVsdGlGYWN0b3JTZXNzaW9uLnBlbmRpbmdDcmVkZW50aWFsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG9iai5tdWx0aUZhY3RvclNlc3Npb24/LmlkVG9rZW4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gTXVsdGlGYWN0b3JTZXNzaW9uSW1wbC5fZnJvbUlkdG9rZW4ob2JqLm11bHRpRmFjdG9yU2Vzc2lvbi5pZFRva2VuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jbGFzcyBNdWx0aUZhY3RvclJlc29sdmVySW1wbCB7XG4gICAgY29uc3RydWN0b3Ioc2Vzc2lvbiwgaGludHMsIHNpZ25JblJlc29sdmVyKSB7XG4gICAgICAgIHRoaXMuc2Vzc2lvbiA9IHNlc3Npb247XG4gICAgICAgIHRoaXMuaGludHMgPSBoaW50cztcbiAgICAgICAgdGhpcy5zaWduSW5SZXNvbHZlciA9IHNpZ25JblJlc29sdmVyO1xuICAgIH1cbiAgICAvKiogQGludGVybmFsICovXG4gICAgc3RhdGljIF9mcm9tRXJyb3IoYXV0aEV4dGVybiwgZXJyb3IpIHtcbiAgICAgICAgY29uc3QgYXV0aCA9IF9jYXN0QXV0aChhdXRoRXh0ZXJuKTtcbiAgICAgICAgY29uc3Qgc2VydmVyUmVzcG9uc2UgPSBlcnJvci5jdXN0b21EYXRhLl9zZXJ2ZXJSZXNwb25zZTtcbiAgICAgICAgY29uc3QgaGludHMgPSAoc2VydmVyUmVzcG9uc2UubWZhSW5mbyB8fCBbXSkubWFwKGVucm9sbG1lbnQgPT4gTXVsdGlGYWN0b3JJbmZvSW1wbC5fZnJvbVNlcnZlclJlc3BvbnNlKGF1dGgsIGVucm9sbG1lbnQpKTtcbiAgICAgICAgX2Fzc2VydChzZXJ2ZXJSZXNwb25zZS5tZmFQZW5kaW5nQ3JlZGVudGlhbCwgYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgICAgICBjb25zdCBzZXNzaW9uID0gTXVsdGlGYWN0b3JTZXNzaW9uSW1wbC5fZnJvbU1mYVBlbmRpbmdDcmVkZW50aWFsKHNlcnZlclJlc3BvbnNlLm1mYVBlbmRpbmdDcmVkZW50aWFsKTtcbiAgICAgICAgcmV0dXJuIG5ldyBNdWx0aUZhY3RvclJlc29sdmVySW1wbChzZXNzaW9uLCBoaW50cywgYXN5bmMgKGFzc2VydGlvbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgbWZhUmVzcG9uc2UgPSBhd2FpdCBhc3NlcnRpb24uX3Byb2Nlc3MoYXV0aCwgc2Vzc2lvbik7XG4gICAgICAgICAgICAvLyBDbGVhciBvdXQgdGhlIHVubmVlZGVkIGZpZWxkcyBmcm9tIHRoZSBvbGQgbG9naW4gcmVzcG9uc2VcbiAgICAgICAgICAgIGRlbGV0ZSBzZXJ2ZXJSZXNwb25zZS5tZmFJbmZvO1xuICAgICAgICAgICAgZGVsZXRlIHNlcnZlclJlc3BvbnNlLm1mYVBlbmRpbmdDcmVkZW50aWFsO1xuICAgICAgICAgICAgLy8gVXNlIGluIHRoZSBuZXcgdG9rZW4gJiByZWZyZXNoIHRva2VuIGluIHRoZSBvbGQgcmVzcG9uc2VcbiAgICAgICAgICAgIGNvbnN0IGlkVG9rZW5SZXNwb25zZSA9IHtcbiAgICAgICAgICAgICAgICAuLi5zZXJ2ZXJSZXNwb25zZSxcbiAgICAgICAgICAgICAgICBpZFRva2VuOiBtZmFSZXNwb25zZS5pZFRva2VuLFxuICAgICAgICAgICAgICAgIHJlZnJlc2hUb2tlbjogbWZhUmVzcG9uc2UucmVmcmVzaFRva2VuXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy8gVE9ETzogd2Ugc2hvdWxkIGNvbGxhcHNlIHRoaXMgc3dpdGNoIHN0YXRlbWVudCBpbnRvIFVzZXJDcmVkZW50aWFsSW1wbC5fZm9yT3BlcmF0aW9uIGFuZCBoYXZlIGl0IHN1cHBvcnQgdGhlIFNJR05fSU4gY2FzZVxuICAgICAgICAgICAgc3dpdGNoIChlcnJvci5vcGVyYXRpb25UeXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcInNpZ25JblwiIC8qIE9wZXJhdGlvblR5cGUuU0lHTl9JTiAqLzpcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBVc2VyQ3JlZGVudGlhbEltcGwuX2Zyb21JZFRva2VuUmVzcG9uc2UoYXV0aCwgZXJyb3Iub3BlcmF0aW9uVHlwZSwgaWRUb2tlblJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgYXV0aC5fdXBkYXRlQ3VycmVudFVzZXIodXNlckNyZWRlbnRpYWwudXNlcik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyQ3JlZGVudGlhbDtcbiAgICAgICAgICAgICAgICBjYXNlIFwicmVhdXRoZW50aWNhdGVcIiAvKiBPcGVyYXRpb25UeXBlLlJFQVVUSEVOVElDQVRFICovOlxuICAgICAgICAgICAgICAgICAgICBfYXNzZXJ0KGVycm9yLnVzZXIsIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFVzZXJDcmVkZW50aWFsSW1wbC5fZm9yT3BlcmF0aW9uKGVycm9yLnVzZXIsIGVycm9yLm9wZXJhdGlvblR5cGUsIGlkVG9rZW5SZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgX2ZhaWwoYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgYXN5bmMgcmVzb2x2ZVNpZ25Jbihhc3NlcnRpb25FeHRlcm4pIHtcbiAgICAgICAgY29uc3QgYXNzZXJ0aW9uID0gYXNzZXJ0aW9uRXh0ZXJuO1xuICAgICAgICByZXR1cm4gdGhpcy5zaWduSW5SZXNvbHZlcihhc3NlcnRpb24pO1xuICAgIH1cbn1cbi8qKlxuICogUHJvdmlkZXMgYSB7QGxpbmsgTXVsdGlGYWN0b3JSZXNvbHZlcn0gc3VpdGFibGUgZm9yIGNvbXBsZXRpb24gb2YgYVxuICogbXVsdGktZmFjdG9yIGZsb3cuXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIGVycm9yIC0gVGhlIHtAbGluayBNdWx0aUZhY3RvckVycm9yfSByYWlzZWQgZHVyaW5nIGEgc2lnbi1pbiwgb3JcbiAqIHJlYXV0aGVudGljYXRpb24gb3BlcmF0aW9uLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZnVuY3Rpb24gZ2V0TXVsdGlGYWN0b3JSZXNvbHZlcihhdXRoLCBlcnJvcikge1xuICAgIGNvbnN0IGF1dGhNb2R1bGFyID0gZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpO1xuICAgIGNvbnN0IGVycm9ySW50ZXJuYWwgPSBlcnJvcjtcbiAgICBfYXNzZXJ0KGVycm9yLmN1c3RvbURhdGEub3BlcmF0aW9uVHlwZSwgYXV0aE1vZHVsYXIsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SICovKTtcbiAgICBfYXNzZXJ0KGVycm9ySW50ZXJuYWwuY3VzdG9tRGF0YS5fc2VydmVyUmVzcG9uc2U/Lm1mYVBlbmRpbmdDcmVkZW50aWFsLCBhdXRoTW9kdWxhciwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IgKi8pO1xuICAgIHJldHVybiBNdWx0aUZhY3RvclJlc29sdmVySW1wbC5fZnJvbUVycm9yKGF1dGhNb2R1bGFyLCBlcnJvckludGVybmFsKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmZ1bmN0aW9uIHN0YXJ0RW5yb2xsUGhvbmVNZmEoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92Mi9hY2NvdW50cy9tZmFFbnJvbGxtZW50OnN0YXJ0XCIgLyogRW5kcG9pbnQuU1RBUlRfTUZBX0VOUk9MTE1FTlQgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XG59XG5mdW5jdGlvbiBmaW5hbGl6ZUVucm9sbFBob25lTWZhKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjIvYWNjb3VudHMvbWZhRW5yb2xsbWVudDpmaW5hbGl6ZVwiIC8qIEVuZHBvaW50LkZJTkFMSVpFX01GQV9FTlJPTExNRU5UICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xufVxuZnVuY3Rpb24gc3RhcnRFbnJvbGxUb3RwTWZhKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjIvYWNjb3VudHMvbWZhRW5yb2xsbWVudDpzdGFydFwiIC8qIEVuZHBvaW50LlNUQVJUX01GQV9FTlJPTExNRU5UICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xufVxuZnVuY3Rpb24gZmluYWxpemVFbnJvbGxUb3RwTWZhKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjIvYWNjb3VudHMvbWZhRW5yb2xsbWVudDpmaW5hbGl6ZVwiIC8qIEVuZHBvaW50LkZJTkFMSVpFX01GQV9FTlJPTExNRU5UICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xufVxuZnVuY3Rpb24gd2l0aGRyYXdNZmEoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92Mi9hY2NvdW50cy9tZmFFbnJvbGxtZW50OndpdGhkcmF3XCIgLyogRW5kcG9pbnQuV0lUSERSQVdfTUZBICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xufVxuXG5jbGFzcyBNdWx0aUZhY3RvclVzZXJJbXBsIHtcbiAgICBjb25zdHJ1Y3Rvcih1c2VyKSB7XG4gICAgICAgIHRoaXMudXNlciA9IHVzZXI7XG4gICAgICAgIHRoaXMuZW5yb2xsZWRGYWN0b3JzID0gW107XG4gICAgICAgIHVzZXIuX29uUmVsb2FkKHVzZXJJbmZvID0+IHtcbiAgICAgICAgICAgIGlmICh1c2VySW5mby5tZmFJbmZvKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbnJvbGxlZEZhY3RvcnMgPSB1c2VySW5mby5tZmFJbmZvLm1hcChlbnJvbGxtZW50ID0+IE11bHRpRmFjdG9ySW5mb0ltcGwuX2Zyb21TZXJ2ZXJSZXNwb25zZSh1c2VyLmF1dGgsIGVucm9sbG1lbnQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHN0YXRpYyBfZnJvbVVzZXIodXNlcikge1xuICAgICAgICByZXR1cm4gbmV3IE11bHRpRmFjdG9yVXNlckltcGwodXNlcik7XG4gICAgfVxuICAgIGFzeW5jIGdldFNlc3Npb24oKSB7XG4gICAgICAgIHJldHVybiBNdWx0aUZhY3RvclNlc3Npb25JbXBsLl9mcm9tSWR0b2tlbihhd2FpdCB0aGlzLnVzZXIuZ2V0SWRUb2tlbigpLCB0aGlzLnVzZXIpO1xuICAgIH1cbiAgICBhc3luYyBlbnJvbGwoYXNzZXJ0aW9uRXh0ZXJuLCBkaXNwbGF5TmFtZSkge1xuICAgICAgICBjb25zdCBhc3NlcnRpb24gPSBhc3NlcnRpb25FeHRlcm47XG4gICAgICAgIGNvbnN0IHNlc3Npb24gPSAoYXdhaXQgdGhpcy5nZXRTZXNzaW9uKCkpO1xuICAgICAgICBjb25zdCBmaW5hbGl6ZU1mYVJlc3BvbnNlID0gYXdhaXQgX2xvZ291dElmSW52YWxpZGF0ZWQodGhpcy51c2VyLCBhc3NlcnRpb24uX3Byb2Nlc3ModGhpcy51c2VyLmF1dGgsIHNlc3Npb24sIGRpc3BsYXlOYW1lKSk7XG4gICAgICAgIC8vIE5ldyB0b2tlbnMgd2lsbCBiZSBpc3N1ZWQgYWZ0ZXIgZW5yb2xsbWVudCBvZiB0aGUgbmV3IHNlY29uZCBmYWN0b3JzLlxuICAgICAgICAvLyBUaGV5IG5lZWQgdG8gYmUgdXBkYXRlZCBvbiB0aGUgdXNlci5cbiAgICAgICAgYXdhaXQgdGhpcy51c2VyLl91cGRhdGVUb2tlbnNJZk5lY2Vzc2FyeShmaW5hbGl6ZU1mYVJlc3BvbnNlKTtcbiAgICAgICAgLy8gVGhlIHVzZXIgbmVlZHMgdG8gYmUgcmVsb2FkZWQgdG8gZ2V0IHRoZSBuZXcgbXVsdGktZmFjdG9yIGluZm9ybWF0aW9uXG4gICAgICAgIC8vIGZyb20gc2VydmVyLiBVU0VSX1JFTE9BREVEIGV2ZW50IHdpbGwgYmUgdHJpZ2dlcmVkIGFuZCBgZW5yb2xsZWRGYWN0b3JzYFxuICAgICAgICAvLyB3aWxsIGJlIHVwZGF0ZWQuXG4gICAgICAgIHJldHVybiB0aGlzLnVzZXIucmVsb2FkKCk7XG4gICAgfVxuICAgIGFzeW5jIHVuZW5yb2xsKGluZm9PclVpZCkge1xuICAgICAgICBjb25zdCBtZmFFbnJvbGxtZW50SWQgPSB0eXBlb2YgaW5mb09yVWlkID09PSAnc3RyaW5nJyA/IGluZm9PclVpZCA6IGluZm9PclVpZC51aWQ7XG4gICAgICAgIGNvbnN0IGlkVG9rZW4gPSBhd2FpdCB0aGlzLnVzZXIuZ2V0SWRUb2tlbigpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgaWRUb2tlblJlc3BvbnNlID0gYXdhaXQgX2xvZ291dElmSW52YWxpZGF0ZWQodGhpcy51c2VyLCB3aXRoZHJhd01mYSh0aGlzLnVzZXIuYXV0aCwge1xuICAgICAgICAgICAgICAgIGlkVG9rZW4sXG4gICAgICAgICAgICAgICAgbWZhRW5yb2xsbWVudElkXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAvLyBSZW1vdmUgdGhlIHNlY29uZCBmYWN0b3IgZnJvbSB0aGUgdXNlcidzIGxpc3QuXG4gICAgICAgICAgICB0aGlzLmVucm9sbGVkRmFjdG9ycyA9IHRoaXMuZW5yb2xsZWRGYWN0b3JzLmZpbHRlcigoeyB1aWQgfSkgPT4gdWlkICE9PSBtZmFFbnJvbGxtZW50SWQpO1xuICAgICAgICAgICAgLy8gRGVwZW5kaW5nIG9uIHdoZXRoZXIgdGhlIGJhY2tlbmQgZGVjaWRlZCB0byByZXZva2UgdGhlIHVzZXIncyBzZXNzaW9uLFxuICAgICAgICAgICAgLy8gdGhlIHRva2VuUmVzcG9uc2UgbWF5IGJlIGVtcHR5LiBJZiB0aGUgdG9rZW5zIHdlcmUgbm90IHVwZGF0ZWQgKGFuZCB0aGV5XG4gICAgICAgICAgICAvLyBhcmUgbm93IGludmFsaWQpLCByZWxvYWRpbmcgdGhlIHVzZXIgd2lsbCBkaXNjb3ZlciB0aGlzIGFuZCBpbnZhbGlkYXRlXG4gICAgICAgICAgICAvLyB0aGUgdXNlcidzIHN0YXRlIGFjY29yZGluZ2x5LlxuICAgICAgICAgICAgYXdhaXQgdGhpcy51c2VyLl91cGRhdGVUb2tlbnNJZk5lY2Vzc2FyeShpZFRva2VuUmVzcG9uc2UpO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy51c2VyLnJlbG9hZCgpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICB9XG4gICAgfVxufVxuY29uc3QgbXVsdGlGYWN0b3JVc2VyQ2FjaGUgPSBuZXcgV2Vha01hcCgpO1xuLyoqXG4gKiBUaGUge0BsaW5rIE11bHRpRmFjdG9yVXNlcn0gY29ycmVzcG9uZGluZyB0byB0aGUgdXNlci5cbiAqXG4gKiBAcmVtYXJrc1xuICogVGhpcyBpcyB1c2VkIHRvIGFjY2VzcyBhbGwgbXVsdGktZmFjdG9yIHByb3BlcnRpZXMgYW5kIG9wZXJhdGlvbnMgcmVsYXRlZCB0byB0aGUgdXNlci5cbiAqXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZnVuY3Rpb24gbXVsdGlGYWN0b3IodXNlcikge1xuICAgIGNvbnN0IHVzZXJNb2R1bGFyID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpO1xuICAgIGlmICghbXVsdGlGYWN0b3JVc2VyQ2FjaGUuaGFzKHVzZXJNb2R1bGFyKSkge1xuICAgICAgICBtdWx0aUZhY3RvclVzZXJDYWNoZS5zZXQodXNlck1vZHVsYXIsIE11bHRpRmFjdG9yVXNlckltcGwuX2Zyb21Vc2VyKHVzZXJNb2R1bGFyKSk7XG4gICAgfVxuICAgIHJldHVybiBtdWx0aUZhY3RvclVzZXJDYWNoZS5nZXQodXNlck1vZHVsYXIpO1xufVxuXG5jb25zdCBTVE9SQUdFX0FWQUlMQUJMRV9LRVkgPSAnX19zYWsnO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gVGhlcmUgYXJlIHR3byBkaWZmZXJlbnQgYnJvd3NlciBwZXJzaXN0ZW5jZSB0eXBlczogbG9jYWwgYW5kIHNlc3Npb24uXG4vLyBCb3RoIGhhdmUgdGhlIHNhbWUgaW1wbGVtZW50YXRpb24gYnV0IHVzZSBhIGRpZmZlcmVudCB1bmRlcmx5aW5nIHN0b3JhZ2Vcbi8vIG9iamVjdC5cbmNsYXNzIEJyb3dzZXJQZXJzaXN0ZW5jZUNsYXNzIHtcbiAgICBjb25zdHJ1Y3RvcihzdG9yYWdlUmV0cmlldmVyLCB0eXBlKSB7XG4gICAgICAgIHRoaXMuc3RvcmFnZVJldHJpZXZlciA9IHN0b3JhZ2VSZXRyaWV2ZXI7XG4gICAgICAgIHRoaXMudHlwZSA9IHR5cGU7XG4gICAgfVxuICAgIF9pc0F2YWlsYWJsZSgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICghdGhpcy5zdG9yYWdlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnN0b3JhZ2Uuc2V0SXRlbShTVE9SQUdFX0FWQUlMQUJMRV9LRVksICcxJyk7XG4gICAgICAgICAgICB0aGlzLnN0b3JhZ2UucmVtb3ZlSXRlbShTVE9SQUdFX0FWQUlMQUJMRV9LRVkpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfc2V0KGtleSwgdmFsdWUpIHtcbiAgICAgICAgdGhpcy5zdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpO1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIF9nZXQoa2V5KSB7XG4gICAgICAgIGNvbnN0IGpzb24gPSB0aGlzLnN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGpzb24gPyBKU09OLnBhcnNlKGpzb24pIDogbnVsbCk7XG4gICAgfVxuICAgIF9yZW1vdmUoa2V5KSB7XG4gICAgICAgIHRoaXMuc3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgZ2V0IHN0b3JhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2VSZXRyaWV2ZXIoKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBUaGUgcG9sbGluZyBwZXJpb2QgaW4gY2FzZSBldmVudHMgYXJlIG5vdCBzdXBwb3J0ZWRcbmNvbnN0IF9QT0xMSU5HX0lOVEVSVkFMX01TJDEgPSAxMDAwO1xuLy8gVGhlIElFIDEwIGxvY2FsU3RvcmFnZSBjcm9zcyB0YWIgc3luY2hyb25pemF0aW9uIGRlbGF5IGluIG1pbGxpc2Vjb25kc1xuY29uc3QgSUUxMF9MT0NBTF9TVE9SQUdFX1NZTkNfREVMQVkgPSAxMDtcbmNsYXNzIEJyb3dzZXJMb2NhbFBlcnNpc3RlbmNlIGV4dGVuZHMgQnJvd3NlclBlcnNpc3RlbmNlQ2xhc3Mge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigoKSA9PiB3aW5kb3cubG9jYWxTdG9yYWdlLCBcIkxPQ0FMXCIgLyogUGVyc2lzdGVuY2VUeXBlLkxPQ0FMICovKTtcbiAgICAgICAgdGhpcy5ib3VuZEV2ZW50SGFuZGxlciA9IChldmVudCwgcG9sbCkgPT4gdGhpcy5vblN0b3JhZ2VFdmVudChldmVudCwgcG9sbCk7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0ge307XG4gICAgICAgIHRoaXMubG9jYWxDYWNoZSA9IHt9O1xuICAgICAgICAvLyBzZXRUaW1lb3V0IHJldHVybiB2YWx1ZSBpcyBwbGF0Zm9ybSBzcGVjaWZpY1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICB0aGlzLnBvbGxUaW1lciA9IG51bGw7XG4gICAgICAgIC8vIFdoZXRoZXIgdG8gdXNlIHBvbGxpbmcgaW5zdGVhZCBvZiBkZXBlbmRpbmcgb24gd2luZG93IGV2ZW50c1xuICAgICAgICB0aGlzLmZhbGxiYWNrVG9Qb2xsaW5nID0gX2lzTW9iaWxlQnJvd3NlcigpO1xuICAgICAgICB0aGlzLl9zaG91bGRBbGxvd01pZ3JhdGlvbiA9IHRydWU7XG4gICAgfVxuICAgIGZvckFsbENoYW5nZWRLZXlzKGNiKSB7XG4gICAgICAgIC8vIENoZWNrIGFsbCBrZXlzIHdpdGggbGlzdGVuZXJzIG9uIHRoZW0uXG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKHRoaXMubGlzdGVuZXJzKSkge1xuICAgICAgICAgICAgLy8gR2V0IHZhbHVlIGZyb20gbG9jYWxTdG9yYWdlLlxuICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSB0aGlzLnN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuICAgICAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSB0aGlzLmxvY2FsQ2FjaGVba2V5XTtcbiAgICAgICAgICAgIC8vIElmIGxvY2FsIG1hcCB2YWx1ZSBkb2VzIG5vdCBtYXRjaCwgdHJpZ2dlciBsaXN0ZW5lciB3aXRoIHN0b3JhZ2UgZXZlbnQuXG4gICAgICAgICAgICAvLyBEaWZmZXJlbnRpYXRlIHRoaXMgc2ltdWxhdGVkIGV2ZW50IGZyb20gdGhlIHJlYWwgc3RvcmFnZSBldmVudC5cbiAgICAgICAgICAgIGlmIChuZXdWYWx1ZSAhPT0gb2xkVmFsdWUpIHtcbiAgICAgICAgICAgICAgICBjYihrZXksIG9sZFZhbHVlLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25TdG9yYWdlRXZlbnQoZXZlbnQsIHBvbGwgPSBmYWxzZSkge1xuICAgICAgICAvLyBLZXkgd291bGQgYmUgbnVsbCBpbiBzb21lIHNpdHVhdGlvbnMsIGxpa2Ugd2hlbiBsb2NhbFN0b3JhZ2UgaXMgY2xlYXJlZFxuICAgICAgICBpZiAoIWV2ZW50LmtleSkge1xuICAgICAgICAgICAgdGhpcy5mb3JBbGxDaGFuZ2VkS2V5cygoa2V5LCBfb2xkVmFsdWUsIG5ld1ZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlMaXN0ZW5lcnMoa2V5LCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBrZXkgPSBldmVudC5rZXk7XG4gICAgICAgIC8vIENoZWNrIHRoZSBtZWNoYW5pc20gaG93IHRoaXMgZXZlbnQgd2FzIGRldGVjdGVkLlxuICAgICAgICAvLyBUaGUgZmlyc3QgZXZlbnQgd2lsbCBkaWN0YXRlIHRoZSBtZWNoYW5pc20gdG8gYmUgdXNlZC5cbiAgICAgICAgaWYgKHBvbGwpIHtcbiAgICAgICAgICAgIC8vIEVudmlyb25tZW50IGRldGVjdHMgc3RvcmFnZSBjaGFuZ2VzIHZpYSBwb2xsaW5nLlxuICAgICAgICAgICAgLy8gUmVtb3ZlIHN0b3JhZ2UgZXZlbnQgbGlzdGVuZXIgdG8gcHJldmVudCBwb3NzaWJsZSBldmVudCBkdXBsaWNhdGlvbi5cbiAgICAgICAgICAgIHRoaXMuZGV0YWNoTGlzdGVuZXIoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIEVudmlyb25tZW50IGRldGVjdHMgc3RvcmFnZSBjaGFuZ2VzIHZpYSBzdG9yYWdlIGV2ZW50IGxpc3RlbmVyLlxuICAgICAgICAgICAgLy8gUmVtb3ZlIHBvbGxpbmcgbGlzdGVuZXIgdG8gcHJldmVudCBwb3NzaWJsZSBldmVudCBkdXBsaWNhdGlvbi5cbiAgICAgICAgICAgIHRoaXMuc3RvcFBvbGxpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB0cmlnZ2VyTGlzdGVuZXJzID0gKCkgPT4ge1xuICAgICAgICAgICAgLy8gS2VlcCBsb2NhbCBtYXAgdXAgdG8gZGF0ZSBpbiBjYXNlIHN0b3JhZ2UgZXZlbnQgaXMgdHJpZ2dlcmVkIGJlZm9yZVxuICAgICAgICAgICAgLy8gcG9sbC5cbiAgICAgICAgICAgIGNvbnN0IHN0b3JlZFZhbHVlID0gdGhpcy5zdG9yYWdlLmdldEl0ZW0oa2V5KTtcbiAgICAgICAgICAgIGlmICghcG9sbCAmJiB0aGlzLmxvY2FsQ2FjaGVba2V5XSA9PT0gc3RvcmVkVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAvLyBSZWFsIHN0b3JhZ2UgZXZlbnQgd2hpY2ggaGFzIGFscmVhZHkgYmVlbiBkZXRlY3RlZCwgZG8gbm90aGluZy5cbiAgICAgICAgICAgICAgICAvLyBUaGlzIHNlZW1zIHRvIHRyaWdnZXIgaW4gc29tZSBJRSBicm93c2VycyBmb3Igc29tZSByZWFzb24uXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5ub3RpZnlMaXN0ZW5lcnMoa2V5LCBzdG9yZWRWYWx1ZSk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHN0b3JlZFZhbHVlID0gdGhpcy5zdG9yYWdlLmdldEl0ZW0oa2V5KTtcbiAgICAgICAgaWYgKF9pc0lFMTAoKSAmJlxuICAgICAgICAgICAgc3RvcmVkVmFsdWUgIT09IGV2ZW50Lm5ld1ZhbHVlICYmXG4gICAgICAgICAgICBldmVudC5uZXdWYWx1ZSAhPT0gZXZlbnQub2xkVmFsdWUpIHtcbiAgICAgICAgICAgIC8vIElFIDEwIGhhcyB0aGlzIHdlaXJkIGJ1ZyB3aGVyZSBhIHN0b3JhZ2UgZXZlbnQgd291bGQgdHJpZ2dlciB3aXRoIHRoZVxuICAgICAgICAgICAgLy8gY29ycmVjdCBrZXksIG9sZFZhbHVlIGFuZCBuZXdWYWx1ZSBidXQgbG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KSBkb2VzXG4gICAgICAgICAgICAvLyBub3QgeWllbGQgdGhlIHVwZGF0ZWQgdmFsdWUgdW50aWwgYSBmZXcgbWlsbGlzZWNvbmRzLiBUaGlzIGVuc3VyZXNcbiAgICAgICAgICAgIC8vIHRoaXMgcmVjb3ZlcnMgZnJvbSB0aGF0IHNpdHVhdGlvbi5cbiAgICAgICAgICAgIHNldFRpbWVvdXQodHJpZ2dlckxpc3RlbmVycywgSUUxMF9MT0NBTF9TVE9SQUdFX1NZTkNfREVMQVkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJpZ2dlckxpc3RlbmVycygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIG5vdGlmeUxpc3RlbmVycyhrZXksIHZhbHVlKSB7XG4gICAgICAgIHRoaXMubG9jYWxDYWNoZVtrZXldID0gdmFsdWU7XG4gICAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMubGlzdGVuZXJzW2tleV07XG4gICAgICAgIGlmIChsaXN0ZW5lcnMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbGlzdGVuZXIgb2YgQXJyYXkuZnJvbShsaXN0ZW5lcnMpKSB7XG4gICAgICAgICAgICAgICAgbGlzdGVuZXIodmFsdWUgPyBKU09OLnBhcnNlKHZhbHVlKSA6IHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGFydFBvbGxpbmcoKSB7XG4gICAgICAgIHRoaXMuc3RvcFBvbGxpbmcoKTtcbiAgICAgICAgdGhpcy5wb2xsVGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZvckFsbENoYW5nZWRLZXlzKChrZXksIG9sZFZhbHVlLCBuZXdWYWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMub25TdG9yYWdlRXZlbnQobmV3IFN0b3JhZ2VFdmVudCgnc3RvcmFnZScsIHtcbiAgICAgICAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICAgICAgICBvbGRWYWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWVcbiAgICAgICAgICAgICAgICB9KSwgXG4gICAgICAgICAgICAgICAgLyogcG9sbCAqLyB0cnVlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LCBfUE9MTElOR19JTlRFUlZBTF9NUyQxKTtcbiAgICB9XG4gICAgc3RvcFBvbGxpbmcoKSB7XG4gICAgICAgIGlmICh0aGlzLnBvbGxUaW1lcikge1xuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnBvbGxUaW1lcik7XG4gICAgICAgICAgICB0aGlzLnBvbGxUaW1lciA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXR0YWNoTGlzdGVuZXIoKSB7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzdG9yYWdlJywgdGhpcy5ib3VuZEV2ZW50SGFuZGxlcik7XG4gICAgfVxuICAgIGRldGFjaExpc3RlbmVyKCkge1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3RvcmFnZScsIHRoaXMuYm91bmRFdmVudEhhbmRsZXIpO1xuICAgIH1cbiAgICBfYWRkTGlzdGVuZXIoa2V5LCBsaXN0ZW5lcikge1xuICAgICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5saXN0ZW5lcnMpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgLy8gV2hldGhlciBicm93c2VyIGNhbiBkZXRlY3Qgc3RvcmFnZSBldmVudCB3aGVuIGl0IGhhZCBhbHJlYWR5IGJlZW4gcHVzaGVkIHRvIHRoZSBiYWNrZ3JvdW5kLlxuICAgICAgICAgICAgLy8gVGhpcyBtYXkgaGFwcGVuIGluIHNvbWUgbW9iaWxlIGJyb3dzZXJzLiBBIGxvY2FsU3RvcmFnZSBjaGFuZ2UgaW4gdGhlIGZvcmVncm91bmQgd2luZG93XG4gICAgICAgICAgICAvLyB3aWxsIG5vdCBiZSBkZXRlY3RlZCBpbiB0aGUgYmFja2dyb3VuZCB3aW5kb3cgdmlhIHRoZSBzdG9yYWdlIGV2ZW50LlxuICAgICAgICAgICAgLy8gVGhpcyB3YXMgZGV0ZWN0ZWQgaW4gaU9TIDcueCBtb2JpbGUgYnJvd3NlcnNcbiAgICAgICAgICAgIGlmICh0aGlzLmZhbGxiYWNrVG9Qb2xsaW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydFBvbGxpbmcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuYXR0YWNoTGlzdGVuZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMubGlzdGVuZXJzW2tleV0pIHtcbiAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzW2tleV0gPSBuZXcgU2V0KCk7XG4gICAgICAgICAgICAvLyBQb3B1bGF0ZSB0aGUgY2FjaGUgdG8gYXZvaWQgc3B1cmlvdXNseSB0cmlnZ2VyaW5nIG9uIGZpcnN0IHBvbGwuXG4gICAgICAgICAgICB0aGlzLmxvY2FsQ2FjaGVba2V5XSA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5saXN0ZW5lcnNba2V5XS5hZGQobGlzdGVuZXIpO1xuICAgIH1cbiAgICBfcmVtb3ZlTGlzdGVuZXIoa2V5LCBsaXN0ZW5lcikge1xuICAgICAgICBpZiAodGhpcy5saXN0ZW5lcnNba2V5XSkge1xuICAgICAgICAgICAgdGhpcy5saXN0ZW5lcnNba2V5XS5kZWxldGUobGlzdGVuZXIpO1xuICAgICAgICAgICAgaWYgKHRoaXMubGlzdGVuZXJzW2tleV0uc2l6ZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmxpc3RlbmVyc1trZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLmxpc3RlbmVycykubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmRldGFjaExpc3RlbmVyKCk7XG4gICAgICAgICAgICB0aGlzLnN0b3BQb2xsaW5nKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gVXBkYXRlIGxvY2FsIGNhY2hlIG9uIGJhc2Ugb3BlcmF0aW9uczpcbiAgICBhc3luYyBfc2V0KGtleSwgdmFsdWUpIHtcbiAgICAgICAgYXdhaXQgc3VwZXIuX3NldChrZXksIHZhbHVlKTtcbiAgICAgICAgdGhpcy5sb2NhbENhY2hlW2tleV0gPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7XG4gICAgfVxuICAgIGFzeW5jIF9nZXQoa2V5KSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gYXdhaXQgc3VwZXIuX2dldChrZXkpO1xuICAgICAgICB0aGlzLmxvY2FsQ2FjaGVba2V5XSA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICBhc3luYyBfcmVtb3ZlKGtleSkge1xuICAgICAgICBhd2FpdCBzdXBlci5fcmVtb3ZlKGtleSk7XG4gICAgICAgIGRlbGV0ZSB0aGlzLmxvY2FsQ2FjaGVba2V5XTtcbiAgICB9XG59XG5Ccm93c2VyTG9jYWxQZXJzaXN0ZW5jZS50eXBlID0gJ0xPQ0FMJztcbi8qKlxuICogQW4gaW1wbGVtZW50YXRpb24gb2Yge0BsaW5rIFBlcnNpc3RlbmNlfSBvZiB0eXBlIGBMT0NBTGAgdXNpbmcgYGxvY2FsU3RvcmFnZWBcbiAqIGZvciB0aGUgdW5kZXJseWluZyBzdG9yYWdlLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuY29uc3QgYnJvd3NlckxvY2FsUGVyc2lzdGVuY2UgPSBCcm93c2VyTG9jYWxQZXJzaXN0ZW5jZTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjUgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IFBPTExJTkdfSU5URVJWQUxfTVMgPSAxMDAwO1xuLy8gUHVsbCBhIGNvb2tpZSB2YWx1ZSBmcm9tIGRvY3VtZW50LmNvb2tpZVxuZnVuY3Rpb24gZ2V0RG9jdW1lbnRDb29raWUobmFtZSkge1xuICAgIGNvbnN0IGVzY2FwZWROYW1lID0gbmFtZS5yZXBsYWNlKC9bXFxcXF4kLiorPygpW1xcXXt9fF0vZywgJ1xcXFwkJicpO1xuICAgIGNvbnN0IG1hdGNoZXIgPSBSZWdFeHAoYCR7ZXNjYXBlZE5hbWV9PShbXjtdKylgKTtcbiAgICByZXR1cm4gZG9jdW1lbnQuY29va2llLm1hdGNoKG1hdGNoZXIpPy5bMV0gPz8gbnVsbDtcbn1cbi8vIFByb2R1Y2UgYSBzYW5pdGl6ZWQgY29va2llIG5hbWUgZnJvbSB0aGUgcGVyc2lzdGVuY2Uga2V5XG5mdW5jdGlvbiBnZXRDb29raWVOYW1lKGtleSkge1xuICAgIC8vIF9fSE9TVC0gZG9lc24ndCB3b3JrIGluIGxvY2FsaG9zdCBodHRwczovL2lzc3Vlcy5jaHJvbWl1bS5vcmcvaXNzdWVzLzQwMTk2MTIyIGJ1dCBpdCBoYXNcbiAgICAvLyBkZXNpcmFibGUgc2VjdXJpdHkgcHJvcGVydGllcywgc28gbGV0cyB1c2UgYSBkaWZmZXJlbnQgY29va2llIG5hbWUgd2hpbGUgaW4gZGV2LW1vZGUuXG4gICAgLy8gQWxyZWFkeSBjaGVja2VkIGlzU2VjdXJlQ29udGV4dCBpbiBfaXNBdmFpbGFibGUsIHNvIGlmIGl0J3MgaHR0cCB3ZSdyZSBoaXR0aW5nIGxvY2FsLlxuICAgIGNvbnN0IGlzRGV2TW9kZSA9IHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCA9PT0gJ2h0dHA6JztcbiAgICByZXR1cm4gYCR7aXNEZXZNb2RlID8gJ19fZGV2XycgOiAnX19IT1NULSd9RklSRUJBU0VfJHtrZXkuc3BsaXQoJzonKVszXX1gO1xufVxuY2xhc3MgQ29va2llUGVyc2lzdGVuY2Uge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnR5cGUgPSBcIkNPT0tJRVwiIC8qIFBlcnNpc3RlbmNlVHlwZS5DT09LSUUgKi87XG4gICAgICAgIHRoaXMubGlzdGVuZXJVbnN1YnNjcmliZXMgPSBuZXcgTWFwKCk7XG4gICAgfVxuICAgIC8vIHVzZWQgdG8gZ2V0IHRoZSBVUkwgdG8gdGhlIGJhY2tlbmQgdG8gcHJveHkgdG9cbiAgICBfZ2V0RmluYWxUYXJnZXQob3JpZ2luYWxVcmwpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIG9yaWdpbmFsVXJsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoYCR7d2luZG93LmxvY2F0aW9uLm9yaWdpbn0vX19jb29raWVzX19gKTtcbiAgICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoJ2ZpbmFsVGFyZ2V0Jywgb3JpZ2luYWxVcmwpO1xuICAgICAgICByZXR1cm4gdXJsO1xuICAgIH1cbiAgICAvLyBUbyBiZSBhIHVzYWJsZSBwZXJzaXN0ZW5jZSBtZXRob2QgaW4gYSBjaGFpbiBicm93c2VyQ29va2llUGVyc2lzdGVuY2UgZW5zdXJlcyB0aGF0XG4gICAgLy8gcHJlcmVxdWlzaXRlcyBoYXZlIGJlZW4gbWV0LCBuYW1lbHkgdGhhdCB3ZSdyZSBpbiBhIHNlY3VyZUNvbnRleHQsIG5hdmlnYXRvciBhbmQgZG9jdW1lbnQgYXJlXG4gICAgLy8gYXZhaWxhYmxlIGFuZCBjb29raWVzIGFyZSBlbmFibGVkLiBOb3QgYWxsIFVBcyBzdXBwb3J0IHRoZXNlIG1ldGhvZCwgc28gZmFsbGJhY2sgYWNjb3JkaW5nbHkuXG4gICAgYXN5bmMgX2lzQXZhaWxhYmxlKCkge1xuICAgICAgICBpZiAodHlwZW9mIGlzU2VjdXJlQ29udGV4dCA9PT0gJ2Jvb2xlYW4nICYmICFpc1NlY3VyZUNvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIG5hdmlnYXRvciA9PT0gJ3VuZGVmaW5lZCcgfHwgdHlwZW9mIGRvY3VtZW50ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuYXZpZ2F0b3IuY29va2llRW5hYmxlZCA/PyB0cnVlO1xuICAgIH1cbiAgICAvLyBTZXQgc2hvdWxkIGJlIGEgbm9vcCBhcyB3ZSBleHBlY3QgbWlkZGxld2FyZSB0byBoYW5kbGUgdGhpc1xuICAgIGFzeW5jIF9zZXQoX2tleSwgX3ZhbHVlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gQXR0ZW1wdCB0byBnZXQgdGhlIGNvb2tpZSBmcm9tIGNvb2tpZVN0b3JlLCBmYWxsYmFjayB0byBkb2N1bWVudC5jb29raWVcbiAgICBhc3luYyBfZ2V0KGtleSkge1xuICAgICAgICBpZiAoIXRoaXMuX2lzQXZhaWxhYmxlKCkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5hbWUgPSBnZXRDb29raWVOYW1lKGtleSk7XG4gICAgICAgIGlmICh3aW5kb3cuY29va2llU3RvcmUpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvb2tpZSA9IGF3YWl0IHdpbmRvdy5jb29raWVTdG9yZS5nZXQobmFtZSk7XG4gICAgICAgICAgICByZXR1cm4gY29va2llPy52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZ2V0RG9jdW1lbnRDb29raWUobmFtZSk7XG4gICAgfVxuICAgIC8vIExvZyBvdXQgYnkgb3ZlcnJpZGluZyB0aGUgaWRUb2tlbiB3aXRoIGEgc2VudGluZWwgdmFsdWUgb2YgXCJcIlxuICAgIGFzeW5jIF9yZW1vdmUoa2V5KSB7XG4gICAgICAgIGlmICghdGhpcy5faXNBdmFpbGFibGUoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRvIG1ha2Ugc3VyZSB3ZSBkb24ndCBoaXQgc2lnbm91dCBvdmVyIGFuZCBvdmVyIGFnYWluLCBvbmx5IGRvIHRoaXMgb3BlcmF0aW9uIGlmIHdlIG5lZWQgdG9cbiAgICAgICAgLy8gd2l0aCB0aGUgbG9nb3V0IHNlbnRpbmVsIHZhbHVlIG9mIFwiXCIgdGhpcyBjYW4gY2F1c2UgcmFjZSBjb25kaXRpb25zLiBVbm5lY2Vzc2FyeSBzZXQtY29va2llXG4gICAgICAgIC8vIGhlYWRlcnMgd2lsbCByZWR1Y2UgQ0ROIGhpdCByYXRlcyB0b28uXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nVmFsdWUgPSBhd2FpdCB0aGlzLl9nZXQoa2V5KTtcbiAgICAgICAgaWYgKCFleGlzdGluZ1ZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbmFtZSA9IGdldENvb2tpZU5hbWUoa2V5KTtcbiAgICAgICAgZG9jdW1lbnQuY29va2llID0gYCR7bmFtZX09O01heC1BZ2U9MzQ1NjAwMDA7UGFydGl0aW9uZWQ7U2VjdXJlO1NhbWVTaXRlPVN0cmljdDtQYXRoPS87UHJpb3JpdHk9SGlnaGA7XG4gICAgICAgIGF3YWl0IGZldGNoKGAvX19jb29raWVzX19gLCB7IG1ldGhvZDogJ0RFTEVURScgfSkuY2F0Y2goKCkgPT4gdW5kZWZpbmVkKTtcbiAgICB9XG4gICAgLy8gTGlzdGVuIGZvciBjb29raWUgY2hhbmdlcywgYm90aCBjb29raWVTdG9yZSBhbmQgZmFsbGJhY2sgdG8gcG9sbGluZyBkb2N1bWVudC5jb29raWVcbiAgICBfYWRkTGlzdGVuZXIoa2V5LCBsaXN0ZW5lcikge1xuICAgICAgICBpZiAoIXRoaXMuX2lzQXZhaWxhYmxlKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBuYW1lID0gZ2V0Q29va2llTmFtZShrZXkpO1xuICAgICAgICBpZiAod2luZG93LmNvb2tpZVN0b3JlKSB7XG4gICAgICAgICAgICBjb25zdCBjYiA9ICgoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjaGFuZ2VkQ29va2llID0gZXZlbnQuY2hhbmdlZC5maW5kKGNoYW5nZSA9PiBjaGFuZ2UubmFtZSA9PT0gbmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKGNoYW5nZWRDb29raWUpIHtcbiAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXIoY2hhbmdlZENvb2tpZS52YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGRlbGV0ZWRDb29raWUgPSBldmVudC5kZWxldGVkLmZpbmQoY2hhbmdlID0+IGNoYW5nZS5uYW1lID09PSBuYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAoZGVsZXRlZENvb2tpZSkge1xuICAgICAgICAgICAgICAgICAgICBsaXN0ZW5lcihudWxsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IHVuc3Vic2NyaWJlID0gKCkgPT4gd2luZG93LmNvb2tpZVN0b3JlLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGNiKTtcbiAgICAgICAgICAgIHRoaXMubGlzdGVuZXJVbnN1YnNjcmliZXMuc2V0KGxpc3RlbmVyLCB1bnN1YnNjcmliZSk7XG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmNvb2tpZVN0b3JlLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGNiKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgbGFzdFZhbHVlID0gZ2V0RG9jdW1lbnRDb29raWUobmFtZSk7XG4gICAgICAgIGNvbnN0IGludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudFZhbHVlID0gZ2V0RG9jdW1lbnRDb29raWUobmFtZSk7XG4gICAgICAgICAgICBpZiAoY3VycmVudFZhbHVlICE9PSBsYXN0VmFsdWUpIHtcbiAgICAgICAgICAgICAgICBsaXN0ZW5lcihjdXJyZW50VmFsdWUpO1xuICAgICAgICAgICAgICAgIGxhc3RWYWx1ZSA9IGN1cnJlbnRWYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgUE9MTElOR19JTlRFUlZBTF9NUyk7XG4gICAgICAgIGNvbnN0IHVuc3Vic2NyaWJlID0gKCkgPT4gY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7XG4gICAgICAgIHRoaXMubGlzdGVuZXJVbnN1YnNjcmliZXMuc2V0KGxpc3RlbmVyLCB1bnN1YnNjcmliZSk7XG4gICAgfVxuICAgIF9yZW1vdmVMaXN0ZW5lcihfa2V5LCBsaXN0ZW5lcikge1xuICAgICAgICBjb25zdCB1bnN1YnNjcmliZSA9IHRoaXMubGlzdGVuZXJVbnN1YnNjcmliZXMuZ2V0KGxpc3RlbmVyKTtcbiAgICAgICAgaWYgKCF1bnN1YnNjcmliZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHVuc3Vic2NyaWJlKCk7XG4gICAgICAgIHRoaXMubGlzdGVuZXJVbnN1YnNjcmliZXMuZGVsZXRlKGxpc3RlbmVyKTtcbiAgICB9XG59XG5Db29raWVQZXJzaXN0ZW5jZS50eXBlID0gJ0NPT0tJRSc7XG4vKipcbiAqIEFuIGltcGxlbWVudGF0aW9uIG9mIHtAbGluayBQZXJzaXN0ZW5jZX0gb2YgdHlwZSBgQ09PS0lFYCwgZm9yIHVzZSBvbiB0aGUgY2xpZW50IHNpZGUgaW5cbiAqIGFwcGxpY2F0aW9ucyBsZXZlcmFnaW5nIGh5YnJpZCByZW5kZXJpbmcgYW5kIG1pZGRsZXdhcmUuXG4gKlxuICogQHJlbWFya3MgVGhpcyBwZXJzaXN0ZW5jZSBtZXRob2QgcmVxdWlyZXMgY29tcGFuaW9uIG1pZGRsZXdhcmUgdG8gZnVuY3Rpb24sIHN1Y2ggYXMgdGhhdCBwcm92aWRlZFxuICogYnkge0BsaW5rIGh0dHBzOi8vZmlyZWJhc2VvcGVuc291cmNlLmNvbS9wcm9qZWN0cy9maXJlYmFzZWV4dGVuZGVkL3JlYWN0ZmlyZS8gfCBSZWFjdEZpcmV9IGZvclxuICogTmV4dEpTLlxuICogQGJldGFcbiAqL1xuY29uc3QgYnJvd3NlckNvb2tpZVBlcnNpc3RlbmNlID0gQ29va2llUGVyc2lzdGVuY2U7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jbGFzcyBCcm93c2VyU2Vzc2lvblBlcnNpc3RlbmNlIGV4dGVuZHMgQnJvd3NlclBlcnNpc3RlbmNlQ2xhc3Mge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigoKSA9PiB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UsIFwiU0VTU0lPTlwiIC8qIFBlcnNpc3RlbmNlVHlwZS5TRVNTSU9OICovKTtcbiAgICB9XG4gICAgX2FkZExpc3RlbmVyKF9rZXksIF9saXN0ZW5lcikge1xuICAgICAgICAvLyBMaXN0ZW5lcnMgYXJlIG5vdCBzdXBwb3J0ZWQgZm9yIHNlc3Npb24gc3RvcmFnZSBzaW5jZSBpdCBjYW5ub3QgYmUgc2hhcmVkIGFjcm9zcyB3aW5kb3dzXG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgX3JlbW92ZUxpc3RlbmVyKF9rZXksIF9saXN0ZW5lcikge1xuICAgICAgICAvLyBMaXN0ZW5lcnMgYXJlIG5vdCBzdXBwb3J0ZWQgZm9yIHNlc3Npb24gc3RvcmFnZSBzaW5jZSBpdCBjYW5ub3QgYmUgc2hhcmVkIGFjcm9zcyB3aW5kb3dzXG4gICAgICAgIHJldHVybjtcbiAgICB9XG59XG5Ccm93c2VyU2Vzc2lvblBlcnNpc3RlbmNlLnR5cGUgPSAnU0VTU0lPTic7XG4vKipcbiAqIEFuIGltcGxlbWVudGF0aW9uIG9mIHtAbGluayBQZXJzaXN0ZW5jZX0gb2YgYFNFU1NJT05gIHVzaW5nIGBzZXNzaW9uU3RvcmFnZWBcbiAqIGZvciB0aGUgdW5kZXJseWluZyBzdG9yYWdlLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuY29uc3QgYnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZSA9IEJyb3dzZXJTZXNzaW9uUGVyc2lzdGVuY2U7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFNoaW0gZm9yIFByb21pc2UuYWxsU2V0dGxlZCwgbm90ZSB0aGUgc2xpZ2h0bHkgZGlmZmVyZW50IGZvcm1hdCBvZiBgZnVsZmlsbGVkYCB2cyBgc3RhdHVzYC5cbiAqXG4gKiBAcGFyYW0gcHJvbWlzZXMgLSBBcnJheSBvZiBwcm9taXNlcyB0byB3YWl0IG9uLlxuICovXG5mdW5jdGlvbiBfYWxsU2V0dGxlZChwcm9taXNlcykge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChwcm9taXNlcy5tYXAoYXN5bmMgKHByb21pc2UpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gYXdhaXQgcHJvbWlzZTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZnVsZmlsbGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIHZhbHVlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChyZWFzb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZnVsZmlsbGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICByZWFzb25cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9KSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEludGVyZmFjZSBjbGFzcyBmb3IgcmVjZWl2aW5nIG1lc3NhZ2VzLlxuICpcbiAqL1xuY2xhc3MgUmVjZWl2ZXIge1xuICAgIGNvbnN0cnVjdG9yKGV2ZW50VGFyZ2V0KSB7XG4gICAgICAgIHRoaXMuZXZlbnRUYXJnZXQgPSBldmVudFRhcmdldDtcbiAgICAgICAgdGhpcy5oYW5kbGVyc01hcCA9IHt9O1xuICAgICAgICB0aGlzLmJvdW5kRXZlbnRIYW5kbGVyID0gdGhpcy5oYW5kbGVFdmVudC5iaW5kKHRoaXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBPYnRhaW4gYW4gaW5zdGFuY2Ugb2YgYSBSZWNlaXZlciBmb3IgYSBnaXZlbiBldmVudCB0YXJnZXQsIGlmIG5vbmUgZXhpc3RzIGl0IHdpbGwgYmUgY3JlYXRlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBldmVudFRhcmdldCAtIEFuIGV2ZW50IHRhcmdldCAoc3VjaCBhcyB3aW5kb3cgb3Igc2VsZikgdGhyb3VnaCB3aGljaCB0aGUgdW5kZXJseWluZ1xuICAgICAqIG1lc3NhZ2VzIHdpbGwgYmUgcmVjZWl2ZWQuXG4gICAgICovXG4gICAgc3RhdGljIF9nZXRJbnN0YW5jZShldmVudFRhcmdldCkge1xuICAgICAgICAvLyBUaGUgcmVzdWx0cyBhcmUgc3RvcmVkIGluIGFuIGFycmF5IHNpbmNlIG9iamVjdHMgY2FuJ3QgYmUga2V5cyBmb3Igb3RoZXJcbiAgICAgICAgLy8gb2JqZWN0cy4gSW4gYWRkaXRpb24sIHNldHRpbmcgYSB1bmlxdWUgcHJvcGVydHkgb24gYW4gZXZlbnQgdGFyZ2V0IGFzIGFcbiAgICAgICAgLy8gaGFzaCBtYXAga2V5IG1heSBub3QgYmUgYWxsb3dlZCBkdWUgdG8gQ09SUyByZXN0cmljdGlvbnMuXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nSW5zdGFuY2UgPSB0aGlzLnJlY2VpdmVycy5maW5kKHJlY2VpdmVyID0+IHJlY2VpdmVyLmlzTGlzdGVuaW5ndG8oZXZlbnRUYXJnZXQpKTtcbiAgICAgICAgaWYgKGV4aXN0aW5nSW5zdGFuY2UpIHtcbiAgICAgICAgICAgIHJldHVybiBleGlzdGluZ0luc3RhbmNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5ld0luc3RhbmNlID0gbmV3IFJlY2VpdmVyKGV2ZW50VGFyZ2V0KTtcbiAgICAgICAgdGhpcy5yZWNlaXZlcnMucHVzaChuZXdJbnN0YW5jZSk7XG4gICAgICAgIHJldHVybiBuZXdJbnN0YW5jZTtcbiAgICB9XG4gICAgaXNMaXN0ZW5pbmd0byhldmVudFRhcmdldCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ldmVudFRhcmdldCA9PT0gZXZlbnRUYXJnZXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZhbnMgb3V0IGEgTWVzc2FnZUV2ZW50IHRvIHRoZSBhcHByb3ByaWF0ZSBsaXN0ZW5lcnMuXG4gICAgICpcbiAgICAgKiBAcmVtYXJrc1xuICAgICAqIFNlbmRzIGFuIHtAbGluayBTdGF0dXMuQUNLfSB1cG9uIHJlY2VpcHQgYW5kIGEge0BsaW5rIFN0YXR1cy5ET05FfSBvbmNlIGFsbCBoYW5kbGVycyBoYXZlXG4gICAgICogZmluaXNoZWQgcHJvY2Vzc2luZy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBldmVudCAtIFRoZSBNZXNzYWdlRXZlbnQuXG4gICAgICpcbiAgICAgKi9cbiAgICBhc3luYyBoYW5kbGVFdmVudChldmVudCkge1xuICAgICAgICBjb25zdCBtZXNzYWdlRXZlbnQgPSBldmVudDtcbiAgICAgICAgY29uc3QgeyBldmVudElkLCBldmVudFR5cGUsIGRhdGEgfSA9IG1lc3NhZ2VFdmVudC5kYXRhO1xuICAgICAgICBjb25zdCBoYW5kbGVycyA9IHRoaXMuaGFuZGxlcnNNYXBbZXZlbnRUeXBlXTtcbiAgICAgICAgaWYgKCFoYW5kbGVycz8uc2l6ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIG1lc3NhZ2VFdmVudC5wb3J0c1swXS5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICBzdGF0dXM6IFwiYWNrXCIgLyogX1N0YXR1cy5BQ0sgKi8sXG4gICAgICAgICAgICBldmVudElkLFxuICAgICAgICAgICAgZXZlbnRUeXBlXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBwcm9taXNlcyA9IEFycmF5LmZyb20oaGFuZGxlcnMpLm1hcChhc3luYyAoaGFuZGxlcikgPT4gaGFuZGxlcihtZXNzYWdlRXZlbnQub3JpZ2luLCBkYXRhKSk7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgX2FsbFNldHRsZWQocHJvbWlzZXMpO1xuICAgICAgICBtZXNzYWdlRXZlbnQucG9ydHNbMF0ucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgc3RhdHVzOiBcImRvbmVcIiAvKiBfU3RhdHVzLkRPTkUgKi8sXG4gICAgICAgICAgICBldmVudElkLFxuICAgICAgICAgICAgZXZlbnRUeXBlLFxuICAgICAgICAgICAgcmVzcG9uc2VcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN1YnNjcmliZSBhbiBldmVudCBoYW5kbGVyIGZvciBhIHBhcnRpY3VsYXIgZXZlbnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXZlbnRUeXBlIC0gRXZlbnQgbmFtZSB0byBzdWJzY3JpYmUgdG8uXG4gICAgICogQHBhcmFtIGV2ZW50SGFuZGxlciAtIFRoZSBldmVudCBoYW5kbGVyIHdoaWNoIHNob3VsZCByZWNlaXZlIHRoZSBldmVudHMuXG4gICAgICpcbiAgICAgKi9cbiAgICBfc3Vic2NyaWJlKGV2ZW50VHlwZSwgZXZlbnRIYW5kbGVyKSB7XG4gICAgICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLmhhbmRsZXJzTWFwKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRUYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRoaXMuYm91bmRFdmVudEhhbmRsZXIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5oYW5kbGVyc01hcFtldmVudFR5cGVdKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZXJzTWFwW2V2ZW50VHlwZV0gPSBuZXcgU2V0KCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5oYW5kbGVyc01hcFtldmVudFR5cGVdLmFkZChldmVudEhhbmRsZXIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVbnN1YnNjcmliZSBhbiBldmVudCBoYW5kbGVyIGZyb20gYSBwYXJ0aWN1bGFyIGV2ZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIGV2ZW50VHlwZSAtIEV2ZW50IG5hbWUgdG8gdW5zdWJzY3JpYmUgZnJvbS5cbiAgICAgKiBAcGFyYW0gZXZlbnRIYW5kbGVyIC0gT3B0aW9uYWwgZXZlbnQgaGFuZGxlciwgaWYgbm9uZSBwcm92aWRlZCwgdW5zdWJzY3JpYmUgYWxsIGhhbmRsZXJzIG9uIHRoaXMgZXZlbnQuXG4gICAgICpcbiAgICAgKi9cbiAgICBfdW5zdWJzY3JpYmUoZXZlbnRUeXBlLCBldmVudEhhbmRsZXIpIHtcbiAgICAgICAgaWYgKHRoaXMuaGFuZGxlcnNNYXBbZXZlbnRUeXBlXSAmJiBldmVudEhhbmRsZXIpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlcnNNYXBbZXZlbnRUeXBlXS5kZWxldGUoZXZlbnRIYW5kbGVyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWV2ZW50SGFuZGxlciB8fCB0aGlzLmhhbmRsZXJzTWFwW2V2ZW50VHlwZV0uc2l6ZSA9PT0gMCkge1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuaGFuZGxlcnNNYXBbZXZlbnRUeXBlXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5oYW5kbGVyc01hcCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmV2ZW50VGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLmJvdW5kRXZlbnRIYW5kbGVyKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblJlY2VpdmVyLnJlY2VpdmVycyA9IFtdO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuZnVuY3Rpb24gX2dlbmVyYXRlRXZlbnRJZChwcmVmaXggPSAnJywgZGlnaXRzID0gMTApIHtcbiAgICBsZXQgcmFuZG9tID0gJyc7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkaWdpdHM7IGkrKykge1xuICAgICAgICByYW5kb20gKz0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgIH1cbiAgICByZXR1cm4gcHJlZml4ICsgcmFuZG9tO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBJbnRlcmZhY2UgZm9yIHNlbmRpbmcgbWVzc2FnZXMgYW5kIHdhaXRpbmcgZm9yIGEgY29tcGxldGlvbiByZXNwb25zZS5cbiAqXG4gKi9cbmNsYXNzIFNlbmRlciB7XG4gICAgY29uc3RydWN0b3IodGFyZ2V0KSB7XG4gICAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xuICAgICAgICB0aGlzLmhhbmRsZXJzID0gbmV3IFNldCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVbnN1YnNjcmliZSB0aGUgaGFuZGxlciBhbmQgcmVtb3ZlIGl0IGZyb20gb3VyIHRyYWNraW5nIFNldC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBoYW5kbGVyIC0gVGhlIGhhbmRsZXIgdG8gdW5zdWJzY3JpYmUuXG4gICAgICovXG4gICAgcmVtb3ZlTWVzc2FnZUhhbmRsZXIoaGFuZGxlcikge1xuICAgICAgICBpZiAoaGFuZGxlci5tZXNzYWdlQ2hhbm5lbCkge1xuICAgICAgICAgICAgaGFuZGxlci5tZXNzYWdlQ2hhbm5lbC5wb3J0MS5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgaGFuZGxlci5vbk1lc3NhZ2UpO1xuICAgICAgICAgICAgaGFuZGxlci5tZXNzYWdlQ2hhbm5lbC5wb3J0MS5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaGFuZGxlcnMuZGVsZXRlKGhhbmRsZXIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZW5kIGEgbWVzc2FnZSB0byB0aGUgUmVjZWl2ZXIgbG9jYXRlZCBhdCB7QGxpbmsgdGFyZ2V0fS5cbiAgICAgKlxuICAgICAqIEByZW1hcmtzXG4gICAgICogV2UnbGwgZmlyc3Qgd2FpdCBhIGJpdCBmb3IgYW4gQUNLICwgaWYgd2UgZ2V0IG9uZSB3ZSB3aWxsIHdhaXQgc2lnbmlmaWNhbnRseSBsb25nZXIgdW50aWwgdGhlXG4gICAgICogcmVjZWl2ZXIgaGFzIGhhZCBhIGNoYW5jZSB0byBmdWxseSBwcm9jZXNzIHRoZSBldmVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBldmVudFR5cGUgLSBUeXBlIG9mIGV2ZW50IHRvIHNlbmQuXG4gICAgICogQHBhcmFtIGRhdGEgLSBUaGUgcGF5bG9hZCBvZiB0aGUgZXZlbnQuXG4gICAgICogQHBhcmFtIHRpbWVvdXQgLSBUaW1lb3V0IGZvciB3YWl0aW5nIG9uIGFuIEFDSyBmcm9tIHRoZSByZWNlaXZlci5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIEFuIGFycmF5IG9mIHNldHRsZWQgcHJvbWlzZXMgZnJvbSBhbGwgdGhlIGhhbmRsZXJzIHRoYXQgd2VyZSBsaXN0ZW5pbmcgb24gdGhlIHJlY2VpdmVyLlxuICAgICAqL1xuICAgIGFzeW5jIF9zZW5kKGV2ZW50VHlwZSwgZGF0YSwgdGltZW91dCA9IDUwIC8qIF9UaW1lb3V0RHVyYXRpb24uQUNLICovKSB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2VDaGFubmVsID0gdHlwZW9mIE1lc3NhZ2VDaGFubmVsICE9PSAndW5kZWZpbmVkJyA/IG5ldyBNZXNzYWdlQ2hhbm5lbCgpIDogbnVsbDtcbiAgICAgICAgaWYgKCFtZXNzYWdlQ2hhbm5lbCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiY29ubmVjdGlvbl91bmF2YWlsYWJsZVwiIC8qIF9NZXNzYWdlRXJyb3IuQ09OTkVDVElPTl9VTkFWQUlMQUJMRSAqLyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gTm9kZSB0aW1lcnMgYW5kIGJyb3dzZXIgdGltZXJzIHJldHVybiBmdW5kYW1lbnRhbGx5IGRpZmZlcmVudCB0eXBlcy5cbiAgICAgICAgLy8gV2UgZG9uJ3QgYWN0dWFsbHkgY2FyZSB3aGF0IHRoZSB2YWx1ZSBpcyBidXQgVFMgd29uJ3QgYWNjZXB0IHVua25vd24gYW5kXG4gICAgICAgIC8vIHdlIGNhbid0IGNhc3QgcHJvcGVybHkgaW4gYm90aCBlbnZpcm9ubWVudHMuXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIGxldCBjb21wbGV0aW9uVGltZXI7XG4gICAgICAgIGxldCBoYW5kbGVyO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZXZlbnRJZCA9IF9nZW5lcmF0ZUV2ZW50SWQoJycsIDIwKTtcbiAgICAgICAgICAgIG1lc3NhZ2VDaGFubmVsLnBvcnQxLnN0YXJ0KCk7XG4gICAgICAgICAgICBjb25zdCBhY2tUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoXCJ1bnN1cHBvcnRlZF9ldmVudFwiIC8qIF9NZXNzYWdlRXJyb3IuVU5TVVBQT1JURURfRVZFTlQgKi8pKTtcbiAgICAgICAgICAgIH0sIHRpbWVvdXQpO1xuICAgICAgICAgICAgaGFuZGxlciA9IHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlQ2hhbm5lbCxcbiAgICAgICAgICAgICAgICBvbk1lc3NhZ2UoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZUV2ZW50ID0gZXZlbnQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlRXZlbnQuZGF0YS5ldmVudElkICE9PSBldmVudElkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChtZXNzYWdlRXZlbnQuZGF0YS5zdGF0dXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJhY2tcIiAvKiBfU3RhdHVzLkFDSyAqLzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcmVjZWl2ZXIgc2hvdWxkIEFDSyBmaXJzdC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoYWNrVGltZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRpb25UaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKFwidGltZW91dFwiIC8qIF9NZXNzYWdlRXJyb3IuVElNRU9VVCAqLykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDMwMDAgLyogX1RpbWVvdXREdXJhdGlvbi5DT01QTEVUSU9OICovKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJkb25lXCIgLyogX1N0YXR1cy5ET05FICovOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9uY2UgdGhlIHJlY2VpdmVyJ3MgaGFuZGxlcnMgYXJlIGZpbmlzaGVkIHdlIHdpbGwgZ2V0IHRoZSByZXN1bHRzLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChjb21wbGV0aW9uVGltZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUobWVzc2FnZUV2ZW50LmRhdGEucmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoYWNrVGltZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChjb21wbGV0aW9uVGltZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoXCJpbnZhbGlkX3Jlc3BvbnNlXCIgLyogX01lc3NhZ2VFcnJvci5JTlZBTElEX1JFU1BPTlNFICovKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVycy5hZGQoaGFuZGxlcik7XG4gICAgICAgICAgICBtZXNzYWdlQ2hhbm5lbC5wb3J0MS5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgaGFuZGxlci5vbk1lc3NhZ2UpO1xuICAgICAgICAgICAgdGhpcy50YXJnZXQucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgICAgIGV2ZW50VHlwZSxcbiAgICAgICAgICAgICAgICBldmVudElkLFxuICAgICAgICAgICAgICAgIGRhdGFcbiAgICAgICAgICAgIH0sIFttZXNzYWdlQ2hhbm5lbC5wb3J0Ml0pO1xuICAgICAgICB9KS5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgIGlmIChoYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVNZXNzYWdlSGFuZGxlcihoYW5kbGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBMYXp5IGFjY2Vzc29yIGZvciB3aW5kb3csIHNpbmNlIHRoZSBjb21wYXQgbGF5ZXIgd29uJ3QgdHJlZSBzaGFrZSB0aGlzIG91dCxcbiAqIHdlIG5lZWQgdG8gbWFrZSBzdXJlIG5vdCB0byBtZXNzIHdpdGggd2luZG93IHVubGVzcyB3ZSBoYXZlIHRvXG4gKi9cbmZ1bmN0aW9uIF93aW5kb3coKSB7XG4gICAgcmV0dXJuIHdpbmRvdztcbn1cbmZ1bmN0aW9uIF9zZXRXaW5kb3dMb2NhdGlvbih1cmwpIHtcbiAgICBfd2luZG93KCkubG9jYXRpb24uaHJlZiA9IHVybDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5mdW5jdGlvbiBfaXNXb3JrZXIoKSB7XG4gICAgcmV0dXJuICh0eXBlb2YgX3dpbmRvdygpWydXb3JrZXJHbG9iYWxTY29wZSddICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICB0eXBlb2YgX3dpbmRvdygpWydpbXBvcnRTY3JpcHRzJ10gPT09ICdmdW5jdGlvbicpO1xufVxuYXN5bmMgZnVuY3Rpb24gX2dldEFjdGl2ZVNlcnZpY2VXb3JrZXIoKSB7XG4gICAgaWYgKCFuYXZpZ2F0b3I/LnNlcnZpY2VXb3JrZXIpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlZ2lzdHJhdGlvbiA9IGF3YWl0IG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlYWR5O1xuICAgICAgICByZXR1cm4gcmVnaXN0cmF0aW9uLmFjdGl2ZTtcbiAgICB9XG4gICAgY2F0Y2gge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59XG5mdW5jdGlvbiBfZ2V0U2VydmljZVdvcmtlckNvbnRyb2xsZXIoKSB7XG4gICAgcmV0dXJuIG5hdmlnYXRvcj8uc2VydmljZVdvcmtlcj8uY29udHJvbGxlciB8fCBudWxsO1xufVxuZnVuY3Rpb24gX2dldFdvcmtlckdsb2JhbFNjb3BlKCkge1xuICAgIHJldHVybiBfaXNXb3JrZXIoKSA/IHNlbGYgOiBudWxsO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY29uc3QgREJfTkFNRSA9ICdmaXJlYmFzZUxvY2FsU3RvcmFnZURiJztcbmNvbnN0IERCX1ZFUlNJT04gPSAxO1xuY29uc3QgREJfT0JKRUNUU1RPUkVfTkFNRSA9ICdmaXJlYmFzZUxvY2FsU3RvcmFnZSc7XG5jb25zdCBEQl9EQVRBX0tFWVBBVEggPSAnZmJhc2Vfa2V5Jztcbi8qKlxuICogUHJvbWlzZSB3cmFwcGVyIGZvciBJREJSZXF1ZXN0XG4gKlxuICogVW5mb3J0dW5hdGVseSB3ZSBjYW4ndCBjbGVhbmx5IGV4dGVuZCBQcm9taXNlPFQ+IHNpbmNlIHByb21pc2VzIGFyZSBub3QgY2FsbGFibGUgaW4gRVM2XG4gKlxuICovXG5jbGFzcyBEQlByb21pc2Uge1xuICAgIGNvbnN0cnVjdG9yKHJlcXVlc3QpIHtcbiAgICAgICAgdGhpcy5yZXF1ZXN0ID0gcmVxdWVzdDtcbiAgICB9XG4gICAgdG9Qcm9taXNlKCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5yZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Y2Nlc3MnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLnJlcXVlc3QucmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5yZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHJlamVjdCh0aGlzLnJlcXVlc3QuZXJyb3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdldE9iamVjdFN0b3JlKGRiLCBpc1JlYWRXcml0ZSkge1xuICAgIHJldHVybiBkYlxuICAgICAgICAudHJhbnNhY3Rpb24oW0RCX09CSkVDVFNUT1JFX05BTUVdLCBpc1JlYWRXcml0ZSA/ICdyZWFkd3JpdGUnIDogJ3JlYWRvbmx5JylcbiAgICAgICAgLm9iamVjdFN0b3JlKERCX09CSkVDVFNUT1JFX05BTUUpO1xufVxuZnVuY3Rpb24gX2RlbGV0ZURhdGFiYXNlKCkge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBpbmRleGVkREIuZGVsZXRlRGF0YWJhc2UoREJfTkFNRSk7XG4gICAgcmV0dXJuIG5ldyBEQlByb21pc2UocmVxdWVzdCkudG9Qcm9taXNlKCk7XG59XG5mdW5jdGlvbiBfb3BlbkRhdGFiYXNlKCkge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBpbmRleGVkREIub3BlbihEQl9OQU1FLCBEQl9WRVJTSU9OKTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgKCkgPT4ge1xuICAgICAgICAgICAgcmVqZWN0KHJlcXVlc3QuZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCd1cGdyYWRlbmVlZGVkJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZGIgPSByZXF1ZXN0LnJlc3VsdDtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZGIuY3JlYXRlT2JqZWN0U3RvcmUoREJfT0JKRUNUU1RPUkVfTkFNRSwgeyBrZXlQYXRoOiBEQl9EQVRBX0tFWVBBVEggfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcignc3VjY2VzcycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRiID0gcmVxdWVzdC5yZXN1bHQ7XG4gICAgICAgICAgICAvLyBTdHJhbmdlIGJ1ZyB0aGF0IG9jY3VycyBpbiBGaXJlZm94IHdoZW4gbXVsdGlwbGUgdGFicyBhcmUgb3BlbmVkIGF0IHRoZVxuICAgICAgICAgICAgLy8gc2FtZSB0aW1lLiBUaGUgb25seSB3YXkgdG8gcmVjb3ZlciBzZWVtcyB0byBiZSBkZWxldGluZyB0aGUgZGF0YWJhc2VcbiAgICAgICAgICAgIC8vIGFuZCByZS1pbml0aWFsaXppbmcgaXQuXG4gICAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZmlyZWJhc2UvZmlyZWJhc2UtanMtc2RrL2lzc3Vlcy82MzRcbiAgICAgICAgICAgIGlmICghZGIub2JqZWN0U3RvcmVOYW1lcy5jb250YWlucyhEQl9PQkpFQ1RTVE9SRV9OQU1FKSkge1xuICAgICAgICAgICAgICAgIC8vIE5lZWQgdG8gY2xvc2UgdGhlIGRhdGFiYXNlIG9yIGVsc2UgeW91IGdldCBhIGBibG9ja2VkYCBldmVudFxuICAgICAgICAgICAgICAgIGRiLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgX2RlbGV0ZURhdGFiYXNlKCk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShhd2FpdCBfb3BlbkRhdGFiYXNlKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShkYik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuYXN5bmMgZnVuY3Rpb24gX3B1dE9iamVjdChkYiwga2V5LCB2YWx1ZSkge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBnZXRPYmplY3RTdG9yZShkYiwgdHJ1ZSkucHV0KHtcbiAgICAgICAgW0RCX0RBVEFfS0VZUEFUSF06IGtleSxcbiAgICAgICAgdmFsdWVcbiAgICB9KTtcbiAgICByZXR1cm4gbmV3IERCUHJvbWlzZShyZXF1ZXN0KS50b1Byb21pc2UoKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGdldE9iamVjdChkYiwga2V5KSB7XG4gICAgY29uc3QgcmVxdWVzdCA9IGdldE9iamVjdFN0b3JlKGRiLCBmYWxzZSkuZ2V0KGtleSk7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IG5ldyBEQlByb21pc2UocmVxdWVzdCkudG9Qcm9taXNlKCk7XG4gICAgcmV0dXJuIGRhdGEgPT09IHVuZGVmaW5lZCA/IG51bGwgOiBkYXRhLnZhbHVlO1xufVxuZnVuY3Rpb24gX2RlbGV0ZU9iamVjdChkYiwga2V5KSB7XG4gICAgY29uc3QgcmVxdWVzdCA9IGdldE9iamVjdFN0b3JlKGRiLCB0cnVlKS5kZWxldGUoa2V5KTtcbiAgICByZXR1cm4gbmV3IERCUHJvbWlzZShyZXF1ZXN0KS50b1Byb21pc2UoKTtcbn1cbmNvbnN0IF9QT0xMSU5HX0lOVEVSVkFMX01TID0gODAwO1xuY29uc3QgX1RSQU5TQUNUSU9OX1JFVFJZX0NPVU5UID0gMztcbmNsYXNzIEluZGV4ZWREQkxvY2FsUGVyc2lzdGVuY2Uge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnR5cGUgPSBcIkxPQ0FMXCIgLyogUGVyc2lzdGVuY2VUeXBlLkxPQ0FMICovO1xuICAgICAgICB0aGlzLl9zaG91bGRBbGxvd01pZ3JhdGlvbiA9IHRydWU7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0ge307XG4gICAgICAgIHRoaXMubG9jYWxDYWNoZSA9IHt9O1xuICAgICAgICAvLyBzZXRUaW1lb3V0IHJldHVybiB2YWx1ZSBpcyBwbGF0Zm9ybSBzcGVjaWZpY1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICB0aGlzLnBvbGxUaW1lciA9IG51bGw7XG4gICAgICAgIHRoaXMucGVuZGluZ1dyaXRlcyA9IDA7XG4gICAgICAgIHRoaXMucmVjZWl2ZXIgPSBudWxsO1xuICAgICAgICB0aGlzLnNlbmRlciA9IG51bGw7XG4gICAgICAgIHRoaXMuc2VydmljZVdvcmtlclJlY2VpdmVyQXZhaWxhYmxlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYWN0aXZlU2VydmljZVdvcmtlciA9IG51bGw7XG4gICAgICAgIC8vIEZpcmUgJiBmb3JnZXQgdGhlIHNlcnZpY2Ugd29ya2VyIHJlZ2lzdHJhdGlvbiBhcyBpdCBtYXkgbmV2ZXIgcmVzb2x2ZVxuICAgICAgICB0aGlzLl93b3JrZXJJbml0aWFsaXphdGlvblByb21pc2UgPVxuICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplU2VydmljZVdvcmtlck1lc3NhZ2luZygpLnRoZW4oKCkgPT4geyB9LCAoKSA9PiB7IH0pO1xuICAgIH1cbiAgICBhc3luYyBfb3BlbkRiKCkge1xuICAgICAgICBpZiAodGhpcy5kYikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGI7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kYiA9IGF3YWl0IF9vcGVuRGF0YWJhc2UoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGI7XG4gICAgfVxuICAgIGFzeW5jIF93aXRoUmV0cmllcyhvcCkge1xuICAgICAgICBsZXQgbnVtQXR0ZW1wdHMgPSAwO1xuICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYiA9IGF3YWl0IHRoaXMuX29wZW5EYigpO1xuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCBvcChkYik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGlmIChudW1BdHRlbXB0cysrID4gX1RSQU5TQUNUSU9OX1JFVFJZX0NPVU5UKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGIuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYiA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gVE9ETzogY29uc2lkZXIgYWRkaW5nIGV4cG9uZW50aWFsIGJhY2tvZmZcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbmRleGVkREIgZXZlbnRzIGRvIG5vdCBwcm9wYWdhdGUgZnJvbSB0aGUgbWFpbiB3aW5kb3cgdG8gdGhlIHdvcmtlciBjb250ZXh0LiAgV2UgcmVseSBvbiBhXG4gICAgICogcG9zdE1lc3NhZ2UgaW50ZXJmYWNlIHRvIHNlbmQgdGhlc2UgZXZlbnRzIHRvIHRoZSB3b3JrZXIgb3Vyc2VsdmVzLlxuICAgICAqL1xuICAgIGFzeW5jIGluaXRpYWxpemVTZXJ2aWNlV29ya2VyTWVzc2FnaW5nKCkge1xuICAgICAgICByZXR1cm4gX2lzV29ya2VyKCkgPyB0aGlzLmluaXRpYWxpemVSZWNlaXZlcigpIDogdGhpcy5pbml0aWFsaXplU2VuZGVyKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFzIHRoZSB3b3JrZXIgd2Ugc2hvdWxkIGxpc3RlbiB0byBldmVudHMgZnJvbSB0aGUgbWFpbiB3aW5kb3cuXG4gICAgICovXG4gICAgYXN5bmMgaW5pdGlhbGl6ZVJlY2VpdmVyKCkge1xuICAgICAgICB0aGlzLnJlY2VpdmVyID0gUmVjZWl2ZXIuX2dldEluc3RhbmNlKF9nZXRXb3JrZXJHbG9iYWxTY29wZSgpKTtcbiAgICAgICAgLy8gUmVmcmVzaCBmcm9tIHBlcnNpc3RlbmNlIGlmIHdlIHJlY2VpdmUgYSBLZXlDaGFuZ2VkIG1lc3NhZ2UuXG4gICAgICAgIHRoaXMucmVjZWl2ZXIuX3N1YnNjcmliZShcImtleUNoYW5nZWRcIiAvKiBfRXZlbnRUeXBlLktFWV9DSEFOR0VEICovLCBhc3luYyAoX29yaWdpbiwgZGF0YSkgPT4ge1xuICAgICAgICAgICAgY29uc3Qga2V5cyA9IGF3YWl0IHRoaXMuX3BvbGwoKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAga2V5UHJvY2Vzc2VkOiBrZXlzLmluY2x1ZGVzKGRhdGEua2V5KVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIExldCB0aGUgc2VuZGVyIGtub3cgdGhhdCB3ZSBhcmUgbGlzdGVuaW5nIHNvIHRoZXkgZ2l2ZSB1cyBtb3JlIHRpbWVvdXQuXG4gICAgICAgIHRoaXMucmVjZWl2ZXIuX3N1YnNjcmliZShcInBpbmdcIiAvKiBfRXZlbnRUeXBlLlBJTkcgKi8sIGFzeW5jIChfb3JpZ2luLCBfZGF0YSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIFtcImtleUNoYW5nZWRcIiAvKiBfRXZlbnRUeXBlLktFWV9DSEFOR0VEICovXTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFzIHRoZSBtYWluIHdpbmRvdywgd2Ugc2hvdWxkIGxldCB0aGUgd29ya2VyIGtub3cgd2hlbiBrZXlzIGNoYW5nZSAoc2V0IGFuZCByZW1vdmUpLlxuICAgICAqXG4gICAgICogQHJlbWFya3NcbiAgICAgKiB7QGxpbmsgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL1NlcnZpY2VXb3JrZXJDb250YWluZXIvcmVhZHkgfCBTZXJ2aWNlV29ya2VyQ29udGFpbmVyLnJlYWR5fVxuICAgICAqIG1heSBub3QgcmVzb2x2ZS5cbiAgICAgKi9cbiAgICBhc3luYyBpbml0aWFsaXplU2VuZGVyKCkge1xuICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhlcmUncyBhbiBhY3RpdmUgc2VydmljZSB3b3JrZXIuXG4gICAgICAgIHRoaXMuYWN0aXZlU2VydmljZVdvcmtlciA9IGF3YWl0IF9nZXRBY3RpdmVTZXJ2aWNlV29ya2VyKCk7XG4gICAgICAgIGlmICghdGhpcy5hY3RpdmVTZXJ2aWNlV29ya2VyKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZW5kZXIgPSBuZXcgU2VuZGVyKHRoaXMuYWN0aXZlU2VydmljZVdvcmtlcik7XG4gICAgICAgIC8vIFBpbmcgdGhlIHNlcnZpY2Ugd29ya2VyIHRvIGNoZWNrIHdoYXQgZXZlbnRzIHRoZXkgY2FuIGhhbmRsZS5cbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHRoaXMuc2VuZGVyLl9zZW5kKFwicGluZ1wiIC8qIF9FdmVudFR5cGUuUElORyAqLywge30sIDgwMCAvKiBfVGltZW91dER1cmF0aW9uLkxPTkdfQUNLICovKTtcbiAgICAgICAgaWYgKCFyZXN1bHRzKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlc3VsdHNbMF0/LmZ1bGZpbGxlZCAmJlxuICAgICAgICAgICAgcmVzdWx0c1swXT8udmFsdWUuaW5jbHVkZXMoXCJrZXlDaGFuZ2VkXCIgLyogX0V2ZW50VHlwZS5LRVlfQ0hBTkdFRCAqLykpIHtcbiAgICAgICAgICAgIHRoaXMuc2VydmljZVdvcmtlclJlY2VpdmVyQXZhaWxhYmxlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBMZXQgdGhlIHdvcmtlciBrbm93IGFib3V0IGEgY2hhbmdlZCBrZXksIHRoZSBleGFjdCBrZXkgZG9lc24ndCB0ZWNobmljYWxseSBtYXR0ZXIgc2luY2UgdGhlXG4gICAgICogd29ya2VyIHdpbGwganVzdCB0cmlnZ2VyIGEgZnVsbCBzeW5jIGFueXdheS5cbiAgICAgKlxuICAgICAqIEByZW1hcmtzXG4gICAgICogRm9yIG5vdywgd2Ugb25seSBzdXBwb3J0IG9uZSBzZXJ2aWNlIHdvcmtlciBwZXIgcGFnZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBrZXkgLSBTdG9yYWdlIGtleSB3aGljaCBjaGFuZ2VkLlxuICAgICAqL1xuICAgIGFzeW5jIG5vdGlmeVNlcnZpY2VXb3JrZXIoa2V5KSB7XG4gICAgICAgIGlmICghdGhpcy5zZW5kZXIgfHxcbiAgICAgICAgICAgICF0aGlzLmFjdGl2ZVNlcnZpY2VXb3JrZXIgfHxcbiAgICAgICAgICAgIF9nZXRTZXJ2aWNlV29ya2VyQ29udHJvbGxlcigpICE9PSB0aGlzLmFjdGl2ZVNlcnZpY2VXb3JrZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5zZW5kZXIuX3NlbmQoXCJrZXlDaGFuZ2VkXCIgLyogX0V2ZW50VHlwZS5LRVlfQ0hBTkdFRCAqLywgeyBrZXkgfSwgXG4gICAgICAgICAgICAvLyBVc2UgbG9uZyB0aW1lb3V0IGlmIHJlY2VpdmVyIGhhcyBwcmV2aW91c2x5IHJlc3BvbmRlZCB0byBhIHBpbmcgZnJvbSB1cy5cbiAgICAgICAgICAgIHRoaXMuc2VydmljZVdvcmtlclJlY2VpdmVyQXZhaWxhYmxlXG4gICAgICAgICAgICAgICAgPyA4MDAgLyogX1RpbWVvdXREdXJhdGlvbi5MT05HX0FDSyAqL1xuICAgICAgICAgICAgICAgIDogNTAgLyogX1RpbWVvdXREdXJhdGlvbi5BQ0sgKi8pO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBiZXN0IGVmZm9ydCBhcHByb2FjaC4gSWdub3JlIGVycm9ycy5cbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBfaXNBdmFpbGFibGUoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoIWluZGV4ZWREQikge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGRiID0gYXdhaXQgX29wZW5EYXRhYmFzZSgpO1xuICAgICAgICAgICAgYXdhaXQgX3B1dE9iamVjdChkYiwgU1RPUkFHRV9BVkFJTEFCTEVfS0VZLCAnMScpO1xuICAgICAgICAgICAgYXdhaXQgX2RlbGV0ZU9iamVjdChkYiwgU1RPUkFHRV9BVkFJTEFCTEVfS0VZKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIHsgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGFzeW5jIF93aXRoUGVuZGluZ1dyaXRlKHdyaXRlKSB7XG4gICAgICAgIHRoaXMucGVuZGluZ1dyaXRlcysrO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgd3JpdGUoKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMucGVuZGluZ1dyaXRlcy0tO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFzeW5jIF9zZXQoa2V5LCB2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fd2l0aFBlbmRpbmdXcml0ZShhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLl93aXRoUmV0cmllcygoZGIpID0+IF9wdXRPYmplY3QoZGIsIGtleSwgdmFsdWUpKTtcbiAgICAgICAgICAgIHRoaXMubG9jYWxDYWNoZVtrZXldID0gdmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ub3RpZnlTZXJ2aWNlV29ya2VyKGtleSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhc3luYyBfZ2V0KGtleSkge1xuICAgICAgICBjb25zdCBvYmogPSAoYXdhaXQgdGhpcy5fd2l0aFJldHJpZXMoKGRiKSA9PiBnZXRPYmplY3QoZGIsIGtleSkpKTtcbiAgICAgICAgdGhpcy5sb2NhbENhY2hlW2tleV0gPSBvYmo7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgfVxuICAgIGFzeW5jIF9yZW1vdmUoa2V5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl93aXRoUGVuZGluZ1dyaXRlKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuX3dpdGhSZXRyaWVzKChkYikgPT4gX2RlbGV0ZU9iamVjdChkYiwga2V5KSk7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5sb2NhbENhY2hlW2tleV07XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ub3RpZnlTZXJ2aWNlV29ya2VyKGtleSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhc3luYyBfcG9sbCgpIHtcbiAgICAgICAgLy8gVE9ETzogY2hlY2sgaWYgd2UgbmVlZCB0byBmYWxsYmFjayBpZiBnZXRBbGwgaXMgbm90IHN1cHBvcnRlZFxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLl93aXRoUmV0cmllcygoZGIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGdldEFsbFJlcXVlc3QgPSBnZXRPYmplY3RTdG9yZShkYiwgZmFsc2UpLmdldEFsbCgpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBEQlByb21pc2UoZ2V0QWxsUmVxdWVzdCkudG9Qcm9taXNlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIC8vIElmIHdlIGhhdmUgcGVuZGluZyB3cml0ZXMgaW4gcHJvZ3Jlc3MgYWJvcnQsIHdlJ2xsIGdldCBwaWNrZWQgdXAgb24gdGhlIG5leHQgcG9sbFxuICAgICAgICBpZiAodGhpcy5wZW5kaW5nV3JpdGVzICE9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qga2V5cyA9IFtdO1xuICAgICAgICBjb25zdCBrZXlzSW5SZXN1bHQgPSBuZXcgU2V0KCk7XG4gICAgICAgIGlmIChyZXN1bHQubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHsgZmJhc2Vfa2V5OiBrZXksIHZhbHVlIH0gb2YgcmVzdWx0KSB7XG4gICAgICAgICAgICAgICAga2V5c0luUmVzdWx0LmFkZChrZXkpO1xuICAgICAgICAgICAgICAgIGlmIChKU09OLnN0cmluZ2lmeSh0aGlzLmxvY2FsQ2FjaGVba2V5XSkgIT09IEpTT04uc3RyaW5naWZ5KHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeUxpc3RlbmVycyhrZXksIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAga2V5cy5wdXNoKGtleSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgbG9jYWxLZXkgb2YgT2JqZWN0LmtleXModGhpcy5sb2NhbENhY2hlKSkge1xuICAgICAgICAgICAgaWYgKHRoaXMubG9jYWxDYWNoZVtsb2NhbEtleV0gJiYgIWtleXNJblJlc3VsdC5oYXMobG9jYWxLZXkpKSB7XG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlZFxuICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5TGlzdGVuZXJzKGxvY2FsS2V5LCBudWxsKTtcbiAgICAgICAgICAgICAgICBrZXlzLnB1c2gobG9jYWxLZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBrZXlzO1xuICAgIH1cbiAgICBub3RpZnlMaXN0ZW5lcnMoa2V5LCBuZXdWYWx1ZSkge1xuICAgICAgICB0aGlzLmxvY2FsQ2FjaGVba2V5XSA9IG5ld1ZhbHVlO1xuICAgICAgICBjb25zdCBsaXN0ZW5lcnMgPSB0aGlzLmxpc3RlbmVyc1trZXldO1xuICAgICAgICBpZiAobGlzdGVuZXJzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIEFycmF5LmZyb20obGlzdGVuZXJzKSkge1xuICAgICAgICAgICAgICAgIGxpc3RlbmVyKG5ld1ZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBzdGFydFBvbGxpbmcoKSB7XG4gICAgICAgIHRoaXMuc3RvcFBvbGxpbmcoKTtcbiAgICAgICAgdGhpcy5wb2xsVGltZXIgPSBzZXRJbnRlcnZhbChhc3luYyAoKSA9PiB0aGlzLl9wb2xsKCksIF9QT0xMSU5HX0lOVEVSVkFMX01TKTtcbiAgICB9XG4gICAgc3RvcFBvbGxpbmcoKSB7XG4gICAgICAgIGlmICh0aGlzLnBvbGxUaW1lcikge1xuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnBvbGxUaW1lcik7XG4gICAgICAgICAgICB0aGlzLnBvbGxUaW1lciA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2FkZExpc3RlbmVyKGtleSwgbGlzdGVuZXIpIHtcbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKHRoaXMubGlzdGVuZXJzKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRQb2xsaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLmxpc3RlbmVyc1trZXldKSB7XG4gICAgICAgICAgICB0aGlzLmxpc3RlbmVyc1trZXldID0gbmV3IFNldCgpO1xuICAgICAgICAgICAgLy8gUG9wdWxhdGUgdGhlIGNhY2hlIHRvIGF2b2lkIHNwdXJpb3VzbHkgdHJpZ2dlcmluZyBvbiBmaXJzdCBwb2xsLlxuICAgICAgICAgICAgdm9pZCB0aGlzLl9nZXQoa2V5KTsgLy8gVGhpcyBjYW4gaGFwcGVuIGluIHRoZSBiYWNrZ3JvdW5kIGFzeW5jIGFuZCB3ZSBjYW4gcmV0dXJuIGltbWVkaWF0ZWx5LlxuICAgICAgICB9XG4gICAgICAgIHRoaXMubGlzdGVuZXJzW2tleV0uYWRkKGxpc3RlbmVyKTtcbiAgICB9XG4gICAgX3JlbW92ZUxpc3RlbmVyKGtleSwgbGlzdGVuZXIpIHtcbiAgICAgICAgaWYgKHRoaXMubGlzdGVuZXJzW2tleV0pIHtcbiAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzW2tleV0uZGVsZXRlKGxpc3RlbmVyKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmxpc3RlbmVyc1trZXldLnNpemUgPT09IDApIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5saXN0ZW5lcnNba2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5saXN0ZW5lcnMpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5zdG9wUG9sbGluZygpO1xuICAgICAgICB9XG4gICAgfVxufVxuSW5kZXhlZERCTG9jYWxQZXJzaXN0ZW5jZS50eXBlID0gJ0xPQ0FMJztcbi8qKlxuICogQW4gaW1wbGVtZW50YXRpb24gb2Yge0BsaW5rIFBlcnNpc3RlbmNlfSBvZiB0eXBlIGBMT0NBTGAgdXNpbmcgYGluZGV4ZWREQmBcbiAqIGZvciB0aGUgdW5kZXJseWluZyBzdG9yYWdlLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuY29uc3QgaW5kZXhlZERCTG9jYWxQZXJzaXN0ZW5jZSA9IEluZGV4ZWREQkxvY2FsUGVyc2lzdGVuY2U7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5mdW5jdGlvbiBzdGFydFNpZ25JblBob25lTWZhKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjIvYWNjb3VudHMvbWZhU2lnbkluOnN0YXJ0XCIgLyogRW5kcG9pbnQuU1RBUlRfTUZBX1NJR05fSU4gKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XG59XG5mdW5jdGlvbiBmaW5hbGl6ZVNpZ25JblBob25lTWZhKGF1dGgsIHJlcXVlc3QpIHtcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIEh0dHBNZXRob2QuUE9TVCAqLywgXCIvdjIvYWNjb3VudHMvbWZhU2lnbkluOmZpbmFsaXplXCIgLyogRW5kcG9pbnQuRklOQUxJWkVfTUZBX1NJR05fSU4gKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XG59XG5mdW5jdGlvbiBmaW5hbGl6ZVNpZ25JblRvdHBNZmEoYXV0aCwgcmVxdWVzdCkge1xuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogSHR0cE1ldGhvZC5QT1NUICovLCBcIi92Mi9hY2NvdW50cy9tZmFTaWduSW46ZmluYWxpemVcIiAvKiBFbmRwb2ludC5GSU5BTElaRV9NRkFfU0lHTl9JTiAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8vIFJlQ2FwdGNoYSB3aWxsIGxvYWQgdXNpbmcgdGhlIHNhbWUgY2FsbGJhY2ssIHNvIHRoZSBjYWxsYmFjayBmdW5jdGlvbiBuZWVkc1xuLy8gdG8gYmUga2VwdCBhcm91bmRcbmNvbnN0IF9KU0xPQURfQ0FMTEJBQ0sgPSBfZ2VuZXJhdGVDYWxsYmFja05hbWUoJ3JjYicpO1xuY29uc3QgTkVUV09SS19USU1FT1VUX0RFTEFZID0gbmV3IERlbGF5KDMwMDAwLCA2MDAwMCk7XG4vKipcbiAqIExvYWRlciBmb3IgdGhlIEdSZUNhcHRjaGEgbGlicmFyeS4gVGhlcmUgc2hvdWxkIG9ubHkgZXZlciBiZSBvbmUgb2YgdGhpcy5cbiAqL1xuY2xhc3MgUmVDYXB0Y2hhTG9hZGVySW1wbCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuaG9zdExhbmd1YWdlID0gJyc7XG4gICAgICAgIHRoaXMuY291bnRlciA9IDA7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDaGVjayBmb3IgYHJlbmRlcigpYCBtZXRob2QuIGB3aW5kb3cuZ3JlY2FwdGNoYWAgd2lsbCBleGlzdCBpZiB0aGUgRW50ZXJwcmlzZVxuICAgICAgICAgKiB2ZXJzaW9uIG9mIHRoZSBSZUNBUFRDSEEgc2NyaXB0IHdhcyBsb2FkZWQgYnkgc29tZW9uZSBlbHNlIChlLmcuIEFwcCBDaGVjaykgYnV0XG4gICAgICAgICAqIGB3aW5kb3cuZ3JlY2FwdGNoYS5yZW5kZXIoKWAgd2lsbCBub3QuIEFub3RoZXIgbG9hZCB3aWxsIGFkZCBpdC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubGlicmFyeVNlcGFyYXRlbHlMb2FkZWQgPSAhIV93aW5kb3coKS5ncmVjYXB0Y2hhPy5yZW5kZXI7XG4gICAgfVxuICAgIGxvYWQoYXV0aCwgaGwgPSAnJykge1xuICAgICAgICBfYXNzZXJ0KGlzSG9zdExhbmd1YWdlVmFsaWQoaGwpLCBhdXRoLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUiAqLyk7XG4gICAgICAgIGlmICh0aGlzLnNob3VsZFJlc29sdmVJbW1lZGlhdGVseShobCkgJiYgaXNWMihfd2luZG93KCkuZ3JlY2FwdGNoYSkpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoX3dpbmRvdygpLmdyZWNhcHRjaGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXR3b3JrVGltZW91dCA9IF93aW5kb3coKS5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICByZWplY3QoX2NyZWF0ZUVycm9yKGF1dGgsIFwibmV0d29yay1yZXF1ZXN0LWZhaWxlZFwiIC8qIEF1dGhFcnJvckNvZGUuTkVUV09SS19SRVFVRVNUX0ZBSUxFRCAqLykpO1xuICAgICAgICAgICAgfSwgTkVUV09SS19USU1FT1VUX0RFTEFZLmdldCgpKTtcbiAgICAgICAgICAgIF93aW5kb3coKVtfSlNMT0FEX0NBTExCQUNLXSA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBfd2luZG93KCkuY2xlYXJUaW1lb3V0KG5ldHdvcmtUaW1lb3V0KTtcbiAgICAgICAgICAgICAgICBkZWxldGUgX3dpbmRvdygpW19KU0xPQURfQ0FMTEJBQ0tdO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlY2FwdGNoYSA9IF93aW5kb3coKS5ncmVjYXB0Y2hhO1xuICAgICAgICAgICAgICAgIGlmICghcmVjYXB0Y2hhIHx8ICFpc1YyKHJlY2FwdGNoYSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KF9jcmVhdGVFcnJvcihhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLykpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIFdyYXAgdGhlIHJlY2FwdGNoYSByZW5kZXIgZnVuY3Rpb24gc28gdGhhdCB3ZSBrbm93IGlmIHRoZSBkZXZlbG9wZXIgaGFzXG4gICAgICAgICAgICAgICAgLy8gY2FsbGVkIGl0IHNlcGFyYXRlbHlcbiAgICAgICAgICAgICAgICBjb25zdCByZW5kZXIgPSByZWNhcHRjaGEucmVuZGVyO1xuICAgICAgICAgICAgICAgIHJlY2FwdGNoYS5yZW5kZXIgPSAoY29udGFpbmVyLCBwYXJhbXMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgd2lkZ2V0SWQgPSByZW5kZXIoY29udGFpbmVyLCBwYXJhbXMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvdW50ZXIrKztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdpZGdldElkO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy5ob3N0TGFuZ3VhZ2UgPSBobDtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlY2FwdGNoYSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29uc3QgdXJsID0gYCR7X3JlY2FwdGNoYVYyU2NyaXB0VXJsKCl9PyR7cXVlcnlzdHJpbmcoe1xuICAgICAgICAgICAgICAgIG9ubG9hZDogX0pTTE9BRF9DQUxMQkFDSyxcbiAgICAgICAgICAgICAgICByZW5kZXI6ICdleHBsaWNpdCcsXG4gICAgICAgICAgICAgICAgaGxcbiAgICAgICAgICAgIH0pfWA7XG4gICAgICAgICAgICBfbG9hZEpTKHVybCkuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChuZXR3b3JrVGltZW91dCk7XG4gICAgICAgICAgICAgICAgcmVqZWN0KF9jcmVhdGVFcnJvcihhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLykpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjbGVhcmVkT25lSW5zdGFuY2UoKSB7XG4gICAgICAgIHRoaXMuY291bnRlci0tO1xuICAgIH1cbiAgICBzaG91bGRSZXNvbHZlSW1tZWRpYXRlbHkoaGwpIHtcbiAgICAgICAgLy8gV2UgY2FuIHJlc29sdmUgaW1tZWRpYXRlbHkgaWY6XG4gICAgICAgIC8vICAg4oCiIGdyZWNhcHRjaGEgaXMgYWxyZWFkeSBkZWZpbmVkIEFORCAoXG4gICAgICAgIC8vICAgICAxLiB0aGUgcmVxdWVzdGVkIGxhbmd1YWdlIGNvZGVzIGFyZSB0aGUgc2FtZSBPUlxuICAgICAgICAvLyAgICAgMi4gdGhlcmUgZXhpc3RzIGFscmVhZHkgYSBSZUNhcHRjaGEgb24gdGhlIHBhZ2VcbiAgICAgICAgLy8gICAgIDMuIHRoZSBsaWJyYXJ5IHdhcyBhbHJlYWR5IGxvYWRlZCBieSB0aGUgYXBwXG4gICAgICAgIC8vIEluIGNhc2VzICgyKSBhbmQgKDMpLCB3ZSBfY2FuJ3RfIHJlbG9hZCBhcyBpdCB3b3VsZCBicmVhayB0aGUgcmVjYXB0Y2hhc1xuICAgICAgICAvLyB0aGF0IGFyZSBhbHJlYWR5IGluIHRoZSBwYWdlXG4gICAgICAgIHJldHVybiAoISFfd2luZG93KCkuZ3JlY2FwdGNoYT8ucmVuZGVyICYmXG4gICAgICAgICAgICAoaGwgPT09IHRoaXMuaG9zdExhbmd1YWdlIHx8XG4gICAgICAgICAgICAgICAgdGhpcy5jb3VudGVyID4gMCB8fFxuICAgICAgICAgICAgICAgIHRoaXMubGlicmFyeVNlcGFyYXRlbHlMb2FkZWQpKTtcbiAgICB9XG59XG5mdW5jdGlvbiBpc0hvc3RMYW5ndWFnZVZhbGlkKGhsKSB7XG4gICAgcmV0dXJuIGhsLmxlbmd0aCA8PSA2ICYmIC9eXFxzKlthLXpBLVowLTlcXC1dKlxccyokLy50ZXN0KGhsKTtcbn1cbmNsYXNzIE1vY2tSZUNhcHRjaGFMb2FkZXJJbXBsIHtcbiAgICBhc3luYyBsb2FkKGF1dGgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNb2NrUmVDYXB0Y2hhKGF1dGgpO1xuICAgIH1cbiAgICBjbGVhcmVkT25lSW5zdGFuY2UoKSB7IH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IFJFQ0FQVENIQV9WRVJJRklFUl9UWVBFID0gJ3JlY2FwdGNoYSc7XG5jb25zdCBERUZBVUxUX1BBUkFNUyA9IHtcbiAgICB0aGVtZTogJ2xpZ2h0JyxcbiAgICB0eXBlOiAnaW1hZ2UnXG59O1xuLyoqXG4gKiBBbiB7QGxpbmsgaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9yZWNhcHRjaGEvIHwgcmVDQVBUQ0hBfS1iYXNlZCBhcHBsaWNhdGlvbiB2ZXJpZmllci5cbiAqXG4gKiBAcmVtYXJrc1xuICogYFJlY2FwdGNoYVZlcmlmaWVyYCBkb2VzIG5vdCB3b3JrIGluIGEgTm9kZS5qcyBlbnZpcm9ubWVudC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmNsYXNzIFJlY2FwdGNoYVZlcmlmaWVyIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gYXV0aEV4dGVybiAtIFRoZSBjb3JyZXNwb25kaW5nIEZpcmViYXNlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjb250YWluZXJPcklkIC0gVGhlIHJlQ0FQVENIQSBjb250YWluZXIgcGFyYW1ldGVyLlxuICAgICAqXG4gICAgICogQHJlbWFya3NcbiAgICAgKiBUaGlzIGhhcyBkaWZmZXJlbnQgbWVhbmluZyBkZXBlbmRpbmcgb24gd2hldGhlciB0aGUgcmVDQVBUQ0hBIGlzIGhpZGRlbiBvciB2aXNpYmxlLiBGb3IgYVxuICAgICAqIHZpc2libGUgcmVDQVBUQ0hBIHRoZSBjb250YWluZXIgbXVzdCBiZSBlbXB0eS4gSWYgYSBzdHJpbmcgaXMgdXNlZCwgaXQgaGFzIHRvIGNvcnJlc3BvbmQgdG9cbiAgICAgKiBhbiBlbGVtZW50IElELiBUaGUgY29ycmVzcG9uZGluZyBlbGVtZW50IG11c3QgYWxzbyBtdXN0IGJlIGluIHRoZSBET00gYXQgdGhlIHRpbWUgb2ZcbiAgICAgKiBpbml0aWFsaXphdGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbWV0ZXJzIC0gVGhlIG9wdGlvbmFsIHJlQ0FQVENIQSBwYXJhbWV0ZXJzLlxuICAgICAqXG4gICAgICogQHJlbWFya3NcbiAgICAgKiBDaGVjayB0aGUgcmVDQVBUQ0hBIGRvY3MgZm9yIGEgY29tcHJlaGVuc2l2ZSBsaXN0LiBBbGwgcGFyYW1ldGVycyBhcmUgYWNjZXB0ZWQgZXhjZXB0IGZvclxuICAgICAqIHRoZSBzaXRla2V5LiBGaXJlYmFzZSBBdXRoIGJhY2tlbmQgcHJvdmlzaW9ucyBhIHJlQ0FQVENIQSBmb3IgZWFjaCBwcm9qZWN0IGFuZCB3aWxsXG4gICAgICogY29uZmlndXJlIHRoaXMgdXBvbiByZW5kZXJpbmcuIEZvciBhbiBpbnZpc2libGUgcmVDQVBUQ0hBLCBhIHNpemUga2V5IG11c3QgaGF2ZSB0aGUgdmFsdWVcbiAgICAgKiAnaW52aXNpYmxlJy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihhdXRoRXh0ZXJuLCBjb250YWluZXJPcklkLCBwYXJhbWV0ZXJzID0ge1xuICAgICAgICAuLi5ERUZBVUxUX1BBUkFNU1xuICAgIH0pIHtcbiAgICAgICAgdGhpcy5wYXJhbWV0ZXJzID0gcGFyYW1ldGVycztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBhcHBsaWNhdGlvbiB2ZXJpZmllciB0eXBlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcmVtYXJrc1xuICAgICAgICAgKiBGb3IgYSByZUNBUFRDSEEgdmVyaWZpZXIsIHRoaXMgaXMgJ3JlY2FwdGNoYScuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBSRUNBUFRDSEFfVkVSSUZJRVJfVFlQRTtcbiAgICAgICAgdGhpcy5kZXN0cm95ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy53aWRnZXRJZCA9IG51bGw7XG4gICAgICAgIHRoaXMudG9rZW5DaGFuZ2VMaXN0ZW5lcnMgPSBuZXcgU2V0KCk7XG4gICAgICAgIHRoaXMucmVuZGVyUHJvbWlzZSA9IG51bGw7XG4gICAgICAgIHRoaXMucmVjYXB0Y2hhID0gbnVsbDtcbiAgICAgICAgdGhpcy5hdXRoID0gX2Nhc3RBdXRoKGF1dGhFeHRlcm4pO1xuICAgICAgICB0aGlzLmlzSW52aXNpYmxlID0gdGhpcy5wYXJhbWV0ZXJzLnNpemUgPT09ICdpbnZpc2libGUnO1xuICAgICAgICBfYXNzZXJ0KHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcsIHRoaXMuYXV0aCwgXCJvcGVyYXRpb24tbm90LXN1cHBvcnRlZC1pbi10aGlzLWVudmlyb25tZW50XCIgLyogQXV0aEVycm9yQ29kZS5PUEVSQVRJT05fTk9UX1NVUFBPUlRFRCAqLyk7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHR5cGVvZiBjb250YWluZXJPcklkID09PSAnc3RyaW5nJ1xuICAgICAgICAgICAgPyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb250YWluZXJPcklkKVxuICAgICAgICAgICAgOiBjb250YWluZXJPcklkO1xuICAgICAgICBfYXNzZXJ0KGNvbnRhaW5lciwgdGhpcy5hdXRoLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUiAqLyk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuICAgICAgICB0aGlzLnBhcmFtZXRlcnMuY2FsbGJhY2sgPSB0aGlzLm1ha2VUb2tlbkNhbGxiYWNrKHRoaXMucGFyYW1ldGVycy5jYWxsYmFjayk7XG4gICAgICAgIHRoaXMuX3JlY2FwdGNoYUxvYWRlciA9IHRoaXMuYXV0aC5zZXR0aW5ncy5hcHBWZXJpZmljYXRpb25EaXNhYmxlZEZvclRlc3RpbmdcbiAgICAgICAgICAgID8gbmV3IE1vY2tSZUNhcHRjaGFMb2FkZXJJbXBsKClcbiAgICAgICAgICAgIDogbmV3IFJlQ2FwdGNoYUxvYWRlckltcGwoKTtcbiAgICAgICAgdGhpcy52YWxpZGF0ZVN0YXJ0aW5nU3RhdGUoKTtcbiAgICAgICAgLy8gVE9ETzogRmlndXJlIG91dCBpZiBzZGsgdmVyc2lvbiBpcyBuZWVkZWRcbiAgICB9XG4gICAgLyoqXG4gICAgICogV2FpdHMgZm9yIHRoZSB1c2VyIHRvIHNvbHZlIHRoZSByZUNBUFRDSEEgYW5kIHJlc29sdmVzIHdpdGggdGhlIHJlQ0FQVENIQSB0b2tlbi5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIEEgUHJvbWlzZSBmb3IgdGhlIHJlQ0FQVENIQSB0b2tlbi5cbiAgICAgKi9cbiAgICBhc3luYyB2ZXJpZnkoKSB7XG4gICAgICAgIHRoaXMuYXNzZXJ0Tm90RGVzdHJveWVkKCk7XG4gICAgICAgIGNvbnN0IGlkID0gYXdhaXQgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgY29uc3QgcmVjYXB0Y2hhID0gdGhpcy5nZXRBc3NlcnRlZFJlY2FwdGNoYSgpO1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IHJlY2FwdGNoYS5nZXRSZXNwb25zZShpZCk7XG4gICAgICAgIGlmIChyZXNwb25zZSkge1xuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRva2VuQ2hhbmdlID0gKHRva2VuKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCF0b2tlbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47IC8vIElnbm9yZSB0b2tlbiBleHBpcmF0aW9ucy5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy50b2tlbkNoYW5nZUxpc3RlbmVycy5kZWxldGUodG9rZW5DaGFuZ2UpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUodG9rZW4pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMudG9rZW5DaGFuZ2VMaXN0ZW5lcnMuYWRkKHRva2VuQ2hhbmdlKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzSW52aXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgcmVjYXB0Y2hhLmV4ZWN1dGUoaWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVuZGVycyB0aGUgcmVDQVBUQ0hBIHdpZGdldCBvbiB0aGUgcGFnZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggdGhlIHJlQ0FQVENIQSB3aWRnZXQgSUQuXG4gICAgICovXG4gICAgcmVuZGVyKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5hc3NlcnROb3REZXN0cm95ZWQoKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgLy8gVGhpcyBtZXRob2QgcmV0dXJucyBhIHByb21pc2UuIFNpbmNlIGl0J3Mgbm90IGFzeW5jICh3ZSB3YW50IHRvIHJldHVybiB0aGVcbiAgICAgICAgICAgIC8vIF9zYW1lXyBwcm9taXNlIGlmIHJlbmRlcmluZyBpcyBzdGlsbCBvY2N1cnJpbmcpLCB0aGUgQVBJIHN1cmZhY2Ugc2hvdWxkXG4gICAgICAgICAgICAvLyByZWplY3Qgd2l0aCB0aGUgZXJyb3IgcmF0aGVyIHRoYW4ganVzdCB0aHJvd1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnJlbmRlclByb21pc2UpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbmRlclByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZW5kZXJQcm9taXNlID0gdGhpcy5tYWtlUmVuZGVyUHJvbWlzZSgpLmNhdGNoKGUgPT4ge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJQcm9taXNlID0gbnVsbDtcbiAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJQcm9taXNlO1xuICAgIH1cbiAgICAvKiogQGludGVybmFsICovXG4gICAgX3Jlc2V0KCkge1xuICAgICAgICB0aGlzLmFzc2VydE5vdERlc3Ryb3llZCgpO1xuICAgICAgICBpZiAodGhpcy53aWRnZXRJZCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5nZXRBc3NlcnRlZFJlY2FwdGNoYSgpLnJlc2V0KHRoaXMud2lkZ2V0SWQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsZWFycyB0aGUgcmVDQVBUQ0hBIHdpZGdldCBmcm9tIHRoZSBwYWdlIGFuZCBkZXN0cm95cyB0aGUgaW5zdGFuY2UuXG4gICAgICovXG4gICAgY2xlYXIoKSB7XG4gICAgICAgIHRoaXMuYXNzZXJ0Tm90RGVzdHJveWVkKCk7XG4gICAgICAgIHRoaXMuZGVzdHJveWVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fcmVjYXB0Y2hhTG9hZGVyLmNsZWFyZWRPbmVJbnN0YW5jZSgpO1xuICAgICAgICBpZiAoIXRoaXMuaXNJbnZpc2libGUpIHtcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLmNoaWxkTm9kZXMuZm9yRWFjaChub2RlID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5yZW1vdmVDaGlsZChub2RlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhbGlkYXRlU3RhcnRpbmdTdGF0ZSgpIHtcbiAgICAgICAgX2Fzc2VydCghdGhpcy5wYXJhbWV0ZXJzLnNpdGVrZXksIHRoaXMuYXV0aCwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IgKi8pO1xuICAgICAgICBfYXNzZXJ0KHRoaXMuaXNJbnZpc2libGUgfHwgIXRoaXMuY29udGFpbmVyLmhhc0NoaWxkTm9kZXMoKSwgdGhpcy5hdXRoLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUiAqLyk7XG4gICAgICAgIF9hc3NlcnQodHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJywgdGhpcy5hdXRoLCBcIm9wZXJhdGlvbi1ub3Qtc3VwcG9ydGVkLWluLXRoaXMtZW52aXJvbm1lbnRcIiAvKiBBdXRoRXJyb3JDb2RlLk9QRVJBVElPTl9OT1RfU1VQUE9SVEVEICovKTtcbiAgICB9XG4gICAgbWFrZVRva2VuQ2FsbGJhY2soZXhpc3RpbmcpIHtcbiAgICAgICAgcmV0dXJuIHRva2VuID0+IHtcbiAgICAgICAgICAgIHRoaXMudG9rZW5DaGFuZ2VMaXN0ZW5lcnMuZm9yRWFjaChsaXN0ZW5lciA9PiBsaXN0ZW5lcih0b2tlbikpO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBleGlzdGluZyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIGV4aXN0aW5nKHRva2VuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBleGlzdGluZyA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBnbG9iYWxGdW5jID0gX3dpbmRvdygpW2V4aXN0aW5nXTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGdsb2JhbEZ1bmMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2xvYmFsRnVuYyh0b2tlbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbiAgICBhc3NlcnROb3REZXN0cm95ZWQoKSB7XG4gICAgICAgIF9hc3NlcnQoIXRoaXMuZGVzdHJveWVkLCB0aGlzLmF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICB9XG4gICAgYXN5bmMgbWFrZVJlbmRlclByb21pc2UoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuaW5pdCgpO1xuICAgICAgICBpZiAoIXRoaXMud2lkZ2V0SWQpIHtcbiAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB0aGlzLmNvbnRhaW5lcjtcbiAgICAgICAgICAgIGlmICghdGhpcy5pc0ludmlzaWJsZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGd1YXJhbnRlZWRFbXB0eSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChndWFyYW50ZWVkRW1wdHkpO1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IGd1YXJhbnRlZWRFbXB0eTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMud2lkZ2V0SWQgPSB0aGlzLmdldEFzc2VydGVkUmVjYXB0Y2hhKCkucmVuZGVyKGNvbnRhaW5lciwgdGhpcy5wYXJhbWV0ZXJzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy53aWRnZXRJZDtcbiAgICB9XG4gICAgYXN5bmMgaW5pdCgpIHtcbiAgICAgICAgX2Fzc2VydChfaXNIdHRwT3JIdHRwcygpICYmICFfaXNXb3JrZXIoKSwgdGhpcy5hdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgIGF3YWl0IGRvbVJlYWR5KCk7XG4gICAgICAgIHRoaXMucmVjYXB0Y2hhID0gYXdhaXQgdGhpcy5fcmVjYXB0Y2hhTG9hZGVyLmxvYWQodGhpcy5hdXRoLCB0aGlzLmF1dGgubGFuZ3VhZ2VDb2RlIHx8IHVuZGVmaW5lZCk7XG4gICAgICAgIGNvbnN0IHNpdGVLZXkgPSBhd2FpdCBnZXRSZWNhcHRjaGFQYXJhbXModGhpcy5hdXRoKTtcbiAgICAgICAgX2Fzc2VydChzaXRlS2V5LCB0aGlzLmF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgdGhpcy5wYXJhbWV0ZXJzLnNpdGVrZXkgPSBzaXRlS2V5O1xuICAgIH1cbiAgICBnZXRBc3NlcnRlZFJlY2FwdGNoYSgpIHtcbiAgICAgICAgX2Fzc2VydCh0aGlzLnJlY2FwdGNoYSwgdGhpcy5hdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgIHJldHVybiB0aGlzLnJlY2FwdGNoYTtcbiAgICB9XG59XG5mdW5jdGlvbiBkb21SZWFkeSgpIHtcbiAgICBsZXQgcmVzb2x2ZXIgPSBudWxsO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZScpIHtcbiAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBEb2N1bWVudCBub3QgcmVhZHksIHdhaXQgZm9yIGxvYWQgYmVmb3JlIHJlc29sdmluZy5cbiAgICAgICAgLy8gU2F2ZSByZXNvbHZlciwgc28gd2UgY2FuIHJlbW92ZSBsaXN0ZW5lciBpbiBjYXNlIGl0IHdhcyBleHRlcm5hbGx5XG4gICAgICAgIC8vIGNhbmNlbGxlZC5cbiAgICAgICAgcmVzb2x2ZXIgPSAoKSA9PiByZXNvbHZlKCk7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgcmVzb2x2ZXIpO1xuICAgIH0pLmNhdGNoKGUgPT4ge1xuICAgICAgICBpZiAocmVzb2x2ZXIpIHtcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdsb2FkJywgcmVzb2x2ZXIpO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGU7XG4gICAgfSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jbGFzcyBDb25maXJtYXRpb25SZXN1bHRJbXBsIHtcbiAgICBjb25zdHJ1Y3Rvcih2ZXJpZmljYXRpb25JZCwgb25Db25maXJtYXRpb24pIHtcbiAgICAgICAgdGhpcy52ZXJpZmljYXRpb25JZCA9IHZlcmlmaWNhdGlvbklkO1xuICAgICAgICB0aGlzLm9uQ29uZmlybWF0aW9uID0gb25Db25maXJtYXRpb247XG4gICAgfVxuICAgIGNvbmZpcm0odmVyaWZpY2F0aW9uQ29kZSkge1xuICAgICAgICBjb25zdCBhdXRoQ3JlZGVudGlhbCA9IFBob25lQXV0aENyZWRlbnRpYWwuX2Zyb21WZXJpZmljYXRpb24odGhpcy52ZXJpZmljYXRpb25JZCwgdmVyaWZpY2F0aW9uQ29kZSk7XG4gICAgICAgIHJldHVybiB0aGlzLm9uQ29uZmlybWF0aW9uKGF1dGhDcmVkZW50aWFsKTtcbiAgICB9XG59XG4vKipcbiAqIEFzeW5jaHJvbm91c2x5IHNpZ25zIGluIHVzaW5nIGEgcGhvbmUgbnVtYmVyLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUaGlzIG1ldGhvZCBzZW5kcyBhIGNvZGUgdmlhIFNNUyB0byB0aGUgZ2l2ZW5cbiAqIHBob25lIG51bWJlciwgYW5kIHJldHVybnMgYSB7QGxpbmsgQ29uZmlybWF0aW9uUmVzdWx0fS4gQWZ0ZXIgdGhlIHVzZXJcbiAqIHByb3ZpZGVzIHRoZSBjb2RlIHNlbnQgdG8gdGhlaXIgcGhvbmUsIGNhbGwge0BsaW5rIENvbmZpcm1hdGlvblJlc3VsdC5jb25maXJtfVxuICogd2l0aCB0aGUgY29kZSB0byBzaWduIHRoZSB1c2VyIGluLlxuICpcbiAqIEZvciBhYnVzZSBwcmV2ZW50aW9uLCB0aGlzIG1ldGhvZCByZXF1aXJlcyBhIHtAbGluayBBcHBsaWNhdGlvblZlcmlmaWVyfS5cbiAqIFRoaXMgU0RLIGluY2x1ZGVzIGFuIGltcGxlbWVudGF0aW9uIGJhc2VkIG9uIHJlQ0FQVENIQSB2Miwge0BsaW5rIFJlY2FwdGNoYVZlcmlmaWVyfS5cbiAqIFRoaXMgZnVuY3Rpb24gY2FuIHdvcmsgb24gb3RoZXIgcGxhdGZvcm1zIHRoYXQgZG8gbm90IHN1cHBvcnQgdGhlXG4gKiB7QGxpbmsgUmVjYXB0Y2hhVmVyaWZpZXJ9IChsaWtlIFJlYWN0IE5hdGl2ZSksIGJ1dCB5b3UgbmVlZCB0byB1c2UgYVxuICogdGhpcmQtcGFydHkge0BsaW5rIEFwcGxpY2F0aW9uVmVyaWZpZXJ9IGltcGxlbWVudGF0aW9uLlxuICpcbiAqIElmIHlvdSd2ZSBlbmFibGVkIHByb2plY3QtbGV2ZWwgcmVDQVBUQ0hBIEVudGVycHJpc2UgYm90IHByb3RlY3Rpb24gaW5cbiAqIEVuZm9yY2UgbW9kZSwgeW91IGNhbiBvbWl0IHRoZSB7QGxpbmsgQXBwbGljYXRpb25WZXJpZmllcn0uXG4gKlxuICogVGhpcyBtZXRob2QgZG9lcyBub3Qgd29yayBpbiBhIE5vZGUuanMgZW52aXJvbm1lbnQgb3Igd2l0aCB7QGxpbmsgQXV0aH0gaW5zdGFuY2VzIGNyZWF0ZWQgd2l0aCBhXG4gKiB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZVNlcnZlckFwcH0uXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIC8vICdyZWNhcHRjaGEtY29udGFpbmVyJyBpcyB0aGUgSUQgb2YgYW4gZWxlbWVudCBpbiB0aGUgRE9NLlxuICogY29uc3QgYXBwbGljYXRpb25WZXJpZmllciA9IG5ldyBmaXJlYmFzZS5hdXRoLlJlY2FwdGNoYVZlcmlmaWVyKCdyZWNhcHRjaGEtY29udGFpbmVyJyk7XG4gKiBjb25zdCBjb25maXJtYXRpb25SZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoUGhvbmVOdW1iZXIoYXV0aCwgcGhvbmVOdW1iZXIsIGFwcGxpY2F0aW9uVmVyaWZpZXIpO1xuICogLy8gT2J0YWluIGEgdmVyaWZpY2F0aW9uQ29kZSBmcm9tIHRoZSB1c2VyLlxuICogY29uc3QgY3JlZGVudGlhbCA9IGF3YWl0IGNvbmZpcm1hdGlvblJlc3VsdC5jb25maXJtKHZlcmlmaWNhdGlvbkNvZGUpO1xuICogYGBgXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIHBob25lTnVtYmVyIC0gVGhlIHVzZXIncyBwaG9uZSBudW1iZXIgaW4gRS4xNjQgZm9ybWF0IChlLmcuICsxNjUwNTU1MDEwMSkuXG4gKiBAcGFyYW0gYXBwVmVyaWZpZXIgLSBUaGUge0BsaW5rIEFwcGxpY2F0aW9uVmVyaWZpZXJ9LlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aFBob25lTnVtYmVyKGF1dGgsIHBob25lTnVtYmVyLCBhcHBWZXJpZmllcikge1xuICAgIGlmIChfaXNGaXJlYmFzZVNlcnZlckFwcChhdXRoLmFwcCkpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KF9zZXJ2ZXJBcHBDdXJyZW50VXNlck9wZXJhdGlvbk5vdFN1cHBvcnRlZEVycm9yKGF1dGgpKTtcbiAgICB9XG4gICAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xuICAgIGNvbnN0IHZlcmlmaWNhdGlvbklkID0gYXdhaXQgX3ZlcmlmeVBob25lTnVtYmVyKGF1dGhJbnRlcm5hbCwgcGhvbmVOdW1iZXIsIGdldE1vZHVsYXJJbnN0YW5jZShhcHBWZXJpZmllcikpO1xuICAgIHJldHVybiBuZXcgQ29uZmlybWF0aW9uUmVzdWx0SW1wbCh2ZXJpZmljYXRpb25JZCwgY3JlZCA9PiBzaWduSW5XaXRoQ3JlZGVudGlhbChhdXRoSW50ZXJuYWwsIGNyZWQpKTtcbn1cbi8qKlxuICogTGlua3MgdGhlIHVzZXIgYWNjb3VudCB3aXRoIHRoZSBnaXZlbiBwaG9uZSBudW1iZXIuXG4gKlxuICogQHJlbWFya3NcbiAqIFRoaXMgbWV0aG9kIGRvZXMgbm90IHdvcmsgaW4gYSBOb2RlLmpzIGVudmlyb25tZW50LlxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gcGhvbmVOdW1iZXIgLSBUaGUgdXNlcidzIHBob25lIG51bWJlciBpbiBFLjE2NCBmb3JtYXQgKGUuZy4gKzE2NTA1NTUwMTAxKS5cbiAqIEBwYXJhbSBhcHBWZXJpZmllciAtIFRoZSB7QGxpbmsgQXBwbGljYXRpb25WZXJpZmllcn0uXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiBsaW5rV2l0aFBob25lTnVtYmVyKHVzZXIsIHBob25lTnVtYmVyLCBhcHBWZXJpZmllcikge1xuICAgIGNvbnN0IHVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKTtcbiAgICBhd2FpdCBfYXNzZXJ0TGlua2VkU3RhdHVzKGZhbHNlLCB1c2VySW50ZXJuYWwsIFwicGhvbmVcIiAvKiBQcm92aWRlcklkLlBIT05FICovKTtcbiAgICBjb25zdCB2ZXJpZmljYXRpb25JZCA9IGF3YWl0IF92ZXJpZnlQaG9uZU51bWJlcih1c2VySW50ZXJuYWwuYXV0aCwgcGhvbmVOdW1iZXIsIGdldE1vZHVsYXJJbnN0YW5jZShhcHBWZXJpZmllcikpO1xuICAgIHJldHVybiBuZXcgQ29uZmlybWF0aW9uUmVzdWx0SW1wbCh2ZXJpZmljYXRpb25JZCwgY3JlZCA9PiBsaW5rV2l0aENyZWRlbnRpYWwodXNlckludGVybmFsLCBjcmVkKSk7XG59XG4vKipcbiAqIFJlLWF1dGhlbnRpY2F0ZXMgYSB1c2VyIHVzaW5nIGEgZnJlc2ggcGhvbmUgY3JlZGVudGlhbC5cbiAqXG4gKiBAcmVtYXJrc1xuICogVXNlIGJlZm9yZSBvcGVyYXRpb25zIHN1Y2ggYXMge0BsaW5rIHVwZGF0ZVBhc3N3b3JkfSB0aGF0IHJlcXVpcmUgdG9rZW5zIGZyb20gcmVjZW50IHNpZ24taW4gYXR0ZW1wdHMuXG4gKlxuICogVGhpcyBtZXRob2QgZG9lcyBub3Qgd29yayBpbiBhIE5vZGUuanMgZW52aXJvbm1lbnQgb3Igb24gYW55IHtAbGluayBVc2VyfSBzaWduZWQgaW4gYnlcbiAqIHtAbGluayBBdXRofSBpbnN0YW5jZXMgY3JlYXRlZCB3aXRoIGEge0BsaW5rIEBmaXJlYmFzZS9hcHAjRmlyZWJhc2VTZXJ2ZXJBcHB9LlxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gcGhvbmVOdW1iZXIgLSBUaGUgdXNlcidzIHBob25lIG51bWJlciBpbiBFLjE2NCBmb3JtYXQgKGUuZy4gKzE2NTA1NTUwMTAxKS5cbiAqIEBwYXJhbSBhcHBWZXJpZmllciAtIFRoZSB7QGxpbmsgQXBwbGljYXRpb25WZXJpZmllcn0uXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiByZWF1dGhlbnRpY2F0ZVdpdGhQaG9uZU51bWJlcih1c2VyLCBwaG9uZU51bWJlciwgYXBwVmVyaWZpZXIpIHtcbiAgICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcik7XG4gICAgaWYgKF9pc0ZpcmViYXNlU2VydmVyQXBwKHVzZXJJbnRlcm5hbC5hdXRoLmFwcCkpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KF9zZXJ2ZXJBcHBDdXJyZW50VXNlck9wZXJhdGlvbk5vdFN1cHBvcnRlZEVycm9yKHVzZXJJbnRlcm5hbC5hdXRoKSk7XG4gICAgfVxuICAgIGNvbnN0IHZlcmlmaWNhdGlvbklkID0gYXdhaXQgX3ZlcmlmeVBob25lTnVtYmVyKHVzZXJJbnRlcm5hbC5hdXRoLCBwaG9uZU51bWJlciwgZ2V0TW9kdWxhckluc3RhbmNlKGFwcFZlcmlmaWVyKSk7XG4gICAgcmV0dXJuIG5ldyBDb25maXJtYXRpb25SZXN1bHRJbXBsKHZlcmlmaWNhdGlvbklkLCBjcmVkID0+IHJlYXV0aGVudGljYXRlV2l0aENyZWRlbnRpYWwodXNlckludGVybmFsLCBjcmVkKSk7XG59XG4vKipcbiAqIFJldHVybnMgYSB2ZXJpZmljYXRpb24gSUQgdG8gYmUgdXNlZCBpbiBjb25qdW5jdGlvbiB3aXRoIHRoZSBTTVMgY29kZSB0aGF0IGlzIHNlbnQuXG4gKlxuICovXG5hc3luYyBmdW5jdGlvbiBfdmVyaWZ5UGhvbmVOdW1iZXIoYXV0aCwgb3B0aW9ucywgdmVyaWZpZXIpIHtcbiAgICBpZiAoIWF1dGguX2dldFJlY2FwdGNoYUNvbmZpZygpKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBfaW5pdGlhbGl6ZVJlY2FwdGNoYUNvbmZpZyhhdXRoKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIElmIGFuIGVycm9yIG9jY3VycyB3aGlsZSBmZXRjaGluZyB0aGUgY29uZmlnLCB0aGVyZSBpcyBubyB3YXkgdG8ga25vdyB0aGUgZW5hYmxlbWVudCBzdGF0ZVxuICAgICAgICAgICAgLy8gb2YgUGhvbmUgcHJvdmlkZXIsIHNvIHdlIHByb2NlZWQgd2l0aCByZWNhcHRjaGEgVjIgdmVyaWZpY2F0aW9uLlxuICAgICAgICAgICAgLy8gVGhlIGVycm9yIGlzIGxpa2VseSBcInJlY2FwdGNoYUtleSB1bmRlZmluZWRcIiwgYXMgcmVDQVBUQ0hBIEVudGVycHJpc2UgaXMgbm90XG4gICAgICAgICAgICAvLyBlbmFibGVkIGZvciBhbnkgcHJvdmlkZXIuXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnRmFpbGVkIHRvIGluaXRpYWxpemUgcmVDQVBUQ0hBIEVudGVycHJpc2UgY29uZmlnLiBUcmlnZ2VyaW5nIHRoZSByZUNBUFRDSEEgdjIgdmVyaWZpY2F0aW9uLicpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGxldCBwaG9uZUluZm9PcHRpb25zO1xuICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBwaG9uZUluZm9PcHRpb25zID0ge1xuICAgICAgICAgICAgICAgIHBob25lTnVtYmVyOiBvcHRpb25zXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcGhvbmVJbmZvT3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCdzZXNzaW9uJyBpbiBwaG9uZUluZm9PcHRpb25zKSB7XG4gICAgICAgICAgICBjb25zdCBzZXNzaW9uID0gcGhvbmVJbmZvT3B0aW9ucy5zZXNzaW9uO1xuICAgICAgICAgICAgaWYgKCdwaG9uZU51bWJlcicgaW4gcGhvbmVJbmZvT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIF9hc3NlcnQoc2Vzc2lvbi50eXBlID09PSBcImVucm9sbFwiIC8qIE11bHRpRmFjdG9yU2Vzc2lvblR5cGUuRU5ST0xMICovLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRQaG9uZU1mYUVucm9sbG1lbnRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgICAgICBpZFRva2VuOiBzZXNzaW9uLmNyZWRlbnRpYWwsXG4gICAgICAgICAgICAgICAgICAgIHBob25lRW5yb2xsbWVudEluZm86IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBob25lTnVtYmVyOiBwaG9uZUluZm9PcHRpb25zLnBob25lTnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50VHlwZTogXCJDTElFTlRfVFlQRV9XRUJcIiAvKiBSZWNhcHRjaGFDbGllbnRUeXBlLldFQiAqL1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjb25zdCBzdGFydEVucm9sbFBob25lTWZhQWN0aW9uQ2FsbGJhY2sgPSBhc3luYyAoYXV0aEluc3RhbmNlLCByZXF1ZXN0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHJlQ0FQVENIQSBFbnRlcnByaXNlIHRva2VuIGlzIEZBS0VfVE9LRU4sIGZldGNoIHJlQ0FQVENIQSB2MiB0b2tlbiBhbmQgaW5qZWN0IGludG8gcmVxdWVzdC5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcXVlc3QucGhvbmVFbnJvbGxtZW50SW5mby5jYXB0Y2hhUmVzcG9uc2UgPT09IEZBS0VfVE9LRU4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hc3NlcnQodmVyaWZpZXI/LnR5cGUgPT09IFJFQ0FQVENIQV9WRVJJRklFUl9UWVBFLCBhdXRoSW5zdGFuY2UsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SICovKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RXaXRoUmVjYXB0Y2hhVjIgPSBhd2FpdCBpbmplY3RSZWNhcHRjaGFWMlRva2VuKGF1dGhJbnN0YW5jZSwgcmVxdWVzdCwgdmVyaWZpZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0YXJ0RW5yb2xsUGhvbmVNZmEoYXV0aEluc3RhbmNlLCByZXF1ZXN0V2l0aFJlY2FwdGNoYVYyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RhcnRFbnJvbGxQaG9uZU1mYShhdXRoSW5zdGFuY2UsIHJlcXVlc3QpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRQaG9uZU1mYUVucm9sbG1lbnRSZXNwb25zZSA9IGhhbmRsZVJlY2FwdGNoYUZsb3coYXV0aCwgc3RhcnRQaG9uZU1mYUVucm9sbG1lbnRSZXF1ZXN0LCBcIm1mYVNtc0Vucm9sbG1lbnRcIiAvKiBSZWNhcHRjaGFBY3Rpb25OYW1lLk1GQV9TTVNfRU5ST0xMTUVOVCAqLywgc3RhcnRFbnJvbGxQaG9uZU1mYUFjdGlvbkNhbGxiYWNrLCBcIlBIT05FX1BST1ZJREVSXCIgLyogUmVjYXB0Y2hhQXV0aFByb3ZpZGVyLlBIT05FX1BST1ZJREVSICovKTtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHN0YXJ0UGhvbmVNZmFFbnJvbGxtZW50UmVzcG9uc2UuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5waG9uZVNlc3Npb25JbmZvLnNlc3Npb25JbmZvO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgX2Fzc2VydChzZXNzaW9uLnR5cGUgPT09IFwic2lnbmluXCIgLyogTXVsdGlGYWN0b3JTZXNzaW9uVHlwZS5TSUdOX0lOICovLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgICAgICAgICAgY29uc3QgbWZhRW5yb2xsbWVudElkID0gcGhvbmVJbmZvT3B0aW9ucy5tdWx0aUZhY3RvckhpbnQ/LnVpZCB8fFxuICAgICAgICAgICAgICAgICAgICBwaG9uZUluZm9PcHRpb25zLm11bHRpRmFjdG9yVWlkO1xuICAgICAgICAgICAgICAgIF9hc3NlcnQobWZhRW5yb2xsbWVudElkLCBhdXRoLCBcIm1pc3NpbmctbXVsdGktZmFjdG9yLWluZm9cIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfTUZBX0lORk8gKi8pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0UGhvbmVNZmFTaWduSW5SZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgICAgICBtZmFQZW5kaW5nQ3JlZGVudGlhbDogc2Vzc2lvbi5jcmVkZW50aWFsLFxuICAgICAgICAgICAgICAgICAgICBtZmFFbnJvbGxtZW50SWQsXG4gICAgICAgICAgICAgICAgICAgIHBob25lU2lnbkluSW5mbzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50VHlwZTogXCJDTElFTlRfVFlQRV9XRUJcIiAvKiBSZWNhcHRjaGFDbGllbnRUeXBlLldFQiAqL1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjb25zdCBzdGFydFNpZ25JblBob25lTWZhQWN0aW9uQ2FsbGJhY2sgPSBhc3luYyAoYXV0aEluc3RhbmNlLCByZXF1ZXN0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHJlQ0FQVENIQSBFbnRlcnByaXNlIHRva2VuIGlzIEZBS0VfVE9LRU4sIGZldGNoIHJlQ0FQVENIQSB2MiB0b2tlbiBhbmQgaW5qZWN0IGludG8gcmVxdWVzdC5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcXVlc3QucGhvbmVTaWduSW5JbmZvLmNhcHRjaGFSZXNwb25zZSA9PT0gRkFLRV9UT0tFTikge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2Fzc2VydCh2ZXJpZmllcj8udHlwZSA9PT0gUkVDQVBUQ0hBX1ZFUklGSUVSX1RZUEUsIGF1dGhJbnN0YW5jZSwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IgKi8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVxdWVzdFdpdGhSZWNhcHRjaGFWMiA9IGF3YWl0IGluamVjdFJlY2FwdGNoYVYyVG9rZW4oYXV0aEluc3RhbmNlLCByZXF1ZXN0LCB2ZXJpZmllcik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RhcnRTaWduSW5QaG9uZU1mYShhdXRoSW5zdGFuY2UsIHJlcXVlc3RXaXRoUmVjYXB0Y2hhVjIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdGFydFNpZ25JblBob25lTWZhKGF1dGhJbnN0YW5jZSwgcmVxdWVzdCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjb25zdCBzdGFydFBob25lTWZhU2lnbkluUmVzcG9uc2UgPSBoYW5kbGVSZWNhcHRjaGFGbG93KGF1dGgsIHN0YXJ0UGhvbmVNZmFTaWduSW5SZXF1ZXN0LCBcIm1mYVNtc1NpZ25JblwiIC8qIFJlY2FwdGNoYUFjdGlvbk5hbWUuTUZBX1NNU19TSUdOSU4gKi8sIHN0YXJ0U2lnbkluUGhvbmVNZmFBY3Rpb25DYWxsYmFjaywgXCJQSE9ORV9QUk9WSURFUlwiIC8qIFJlY2FwdGNoYUF1dGhQcm92aWRlci5QSE9ORV9QUk9WSURFUiAqLyk7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzdGFydFBob25lTWZhU2lnbkluUmVzcG9uc2UuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5waG9uZVJlc3BvbnNlSW5mby5zZXNzaW9uSW5mbztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbmRQaG9uZVZlcmlmaWNhdGlvbkNvZGVSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHBob25lTnVtYmVyOiBwaG9uZUluZm9PcHRpb25zLnBob25lTnVtYmVyLFxuICAgICAgICAgICAgICAgIGNsaWVudFR5cGU6IFwiQ0xJRU5UX1RZUEVfV0VCXCIgLyogUmVjYXB0Y2hhQ2xpZW50VHlwZS5XRUIgKi9cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb25zdCBzZW5kUGhvbmVWZXJpZmljYXRpb25Db2RlQWN0aW9uQ2FsbGJhY2sgPSBhc3luYyAoYXV0aEluc3RhbmNlLCByZXF1ZXN0KSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gSWYgcmVDQVBUQ0hBIEVudGVycHJpc2UgdG9rZW4gaXMgRkFLRV9UT0tFTiwgZmV0Y2ggcmVDQVBUQ0hBIHYyIHRva2VuIGFuZCBpbmplY3QgaW50byByZXF1ZXN0LlxuICAgICAgICAgICAgICAgIGlmIChyZXF1ZXN0LmNhcHRjaGFSZXNwb25zZSA9PT0gRkFLRV9UT0tFTikge1xuICAgICAgICAgICAgICAgICAgICBfYXNzZXJ0KHZlcmlmaWVyPy50eXBlID09PSBSRUNBUFRDSEFfVkVSSUZJRVJfVFlQRSwgYXV0aEluc3RhbmNlLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUiAqLyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RXaXRoUmVjYXB0Y2hhVjIgPSBhd2FpdCBpbmplY3RSZWNhcHRjaGFWMlRva2VuKGF1dGhJbnN0YW5jZSwgcmVxdWVzdCwgdmVyaWZpZXIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VuZFBob25lVmVyaWZpY2F0aW9uQ29kZShhdXRoSW5zdGFuY2UsIHJlcXVlc3RXaXRoUmVjYXB0Y2hhVjIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gc2VuZFBob25lVmVyaWZpY2F0aW9uQ29kZShhdXRoSW5zdGFuY2UsIHJlcXVlc3QpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNvbnN0IHNlbmRQaG9uZVZlcmlmaWNhdGlvbkNvZGVSZXNwb25zZSA9IGhhbmRsZVJlY2FwdGNoYUZsb3coYXV0aCwgc2VuZFBob25lVmVyaWZpY2F0aW9uQ29kZVJlcXVlc3QsIFwic2VuZFZlcmlmaWNhdGlvbkNvZGVcIiAvKiBSZWNhcHRjaGFBY3Rpb25OYW1lLlNFTkRfVkVSSUZJQ0FUSU9OX0NPREUgKi8sIHNlbmRQaG9uZVZlcmlmaWNhdGlvbkNvZGVBY3Rpb25DYWxsYmFjaywgXCJQSE9ORV9QUk9WSURFUlwiIC8qIFJlY2FwdGNoYUF1dGhQcm92aWRlci5QSE9ORV9QUk9WSURFUiAqLyk7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHNlbmRQaG9uZVZlcmlmaWNhdGlvbkNvZGVSZXNwb25zZS5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnNlc3Npb25JbmZvO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZpbmFsbHkge1xuICAgICAgICB2ZXJpZmllcj8uX3Jlc2V0KCk7XG4gICAgfVxufVxuLyoqXG4gKiBVcGRhdGVzIHRoZSB1c2VyJ3MgcGhvbmUgbnVtYmVyLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUaGlzIG1ldGhvZCBkb2VzIG5vdCB3b3JrIGluIGEgTm9kZS5qcyBlbnZpcm9ubWVudCBvciBvbiBhbnkge0BsaW5rIFVzZXJ9IHNpZ25lZCBpbiBieVxuICoge0BsaW5rIEF1dGh9IGluc3RhbmNlcyBjcmVhdGVkIHdpdGggYSB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZVNlcnZlckFwcH0uXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogLy8gJ3JlY2FwdGNoYS1jb250YWluZXInIGlzIHRoZSBJRCBvZiBhbiBlbGVtZW50IGluIHRoZSBET00uXG4gKiBjb25zdCBhcHBsaWNhdGlvblZlcmlmaWVyID0gbmV3IFJlY2FwdGNoYVZlcmlmaWVyKCdyZWNhcHRjaGEtY29udGFpbmVyJyk7XG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBQaG9uZUF1dGhQcm92aWRlcihhdXRoKTtcbiAqIGNvbnN0IHZlcmlmaWNhdGlvbklkID0gYXdhaXQgcHJvdmlkZXIudmVyaWZ5UGhvbmVOdW1iZXIoJysxNjUwNTU1MDEwMScsIGFwcGxpY2F0aW9uVmVyaWZpZXIpO1xuICogLy8gT2J0YWluIHRoZSB2ZXJpZmljYXRpb25Db2RlIGZyb20gdGhlIHVzZXIuXG4gKiBjb25zdCBwaG9uZUNyZWRlbnRpYWwgPSBQaG9uZUF1dGhQcm92aWRlci5jcmVkZW50aWFsKHZlcmlmaWNhdGlvbklkLCB2ZXJpZmljYXRpb25Db2RlKTtcbiAqIGF3YWl0IHVwZGF0ZVBob25lTnVtYmVyKHVzZXIsIHBob25lQ3JlZGVudGlhbCk7XG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxuICogQHBhcmFtIGNyZWRlbnRpYWwgLSBBIGNyZWRlbnRpYWwgYXV0aGVudGljYXRpbmcgdGhlIG5ldyBwaG9uZSBudW1iZXIuXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiB1cGRhdGVQaG9uZU51bWJlcih1c2VyLCBjcmVkZW50aWFsKSB7XG4gICAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpO1xuICAgIGlmIChfaXNGaXJlYmFzZVNlcnZlckFwcCh1c2VySW50ZXJuYWwuYXV0aC5hcHApKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChfc2VydmVyQXBwQ3VycmVudFVzZXJPcGVyYXRpb25Ob3RTdXBwb3J0ZWRFcnJvcih1c2VySW50ZXJuYWwuYXV0aCkpO1xuICAgIH1cbiAgICBhd2FpdCBfbGluayQxKHVzZXJJbnRlcm5hbCwgY3JlZGVudGlhbCk7XG59XG4vLyBIZWxwZXIgZnVuY3Rpb24gdGhhdCBmZXRjaGVzIGFuZCBpbmplY3RzIGEgcmVDQVBUQ0hBIHYyIHRva2VuIGludG8gdGhlIHJlcXVlc3QuXG5hc3luYyBmdW5jdGlvbiBpbmplY3RSZWNhcHRjaGFWMlRva2VuKGF1dGgsIHJlcXVlc3QsIHJlY2FwdGNoYVYyVmVyaWZpZXIpIHtcbiAgICBfYXNzZXJ0KHJlY2FwdGNoYVYyVmVyaWZpZXIudHlwZSA9PT0gUkVDQVBUQ0hBX1ZFUklGSUVSX1RZUEUsIGF1dGgsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SICovKTtcbiAgICBjb25zdCByZWNhcHRjaGFWMlRva2VuID0gYXdhaXQgcmVjYXB0Y2hhVjJWZXJpZmllci52ZXJpZnkoKTtcbiAgICBfYXNzZXJ0KHR5cGVvZiByZWNhcHRjaGFWMlRva2VuID09PSAnc3RyaW5nJywgYXV0aCwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IgKi8pO1xuICAgIGNvbnN0IG5ld1JlcXVlc3QgPSB7IC4uLnJlcXVlc3QgfTtcbiAgICBpZiAoJ3Bob25lRW5yb2xsbWVudEluZm8nIGluIG5ld1JlcXVlc3QpIHtcbiAgICAgICAgY29uc3QgcGhvbmVOdW1iZXIgPSBuZXdSZXF1ZXN0LnBob25lRW5yb2xsbWVudEluZm8ucGhvbmVOdW1iZXI7XG4gICAgICAgIGNvbnN0IGNhcHRjaGFSZXNwb25zZSA9IG5ld1JlcXVlc3QucGhvbmVFbnJvbGxtZW50SW5mby5jYXB0Y2hhUmVzcG9uc2U7XG4gICAgICAgIGNvbnN0IGNsaWVudFR5cGUgPSBuZXdSZXF1ZXN0XG4gICAgICAgICAgICAucGhvbmVFbnJvbGxtZW50SW5mby5jbGllbnRUeXBlO1xuICAgICAgICBjb25zdCByZWNhcHRjaGFWZXJzaW9uID0gbmV3UmVxdWVzdC5waG9uZUVucm9sbG1lbnRJbmZvLnJlY2FwdGNoYVZlcnNpb247XG4gICAgICAgIE9iamVjdC5hc3NpZ24obmV3UmVxdWVzdCwge1xuICAgICAgICAgICAgJ3Bob25lRW5yb2xsbWVudEluZm8nOiB7XG4gICAgICAgICAgICAgICAgcGhvbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgcmVjYXB0Y2hhVG9rZW46IHJlY2FwdGNoYVYyVG9rZW4sXG4gICAgICAgICAgICAgICAgY2FwdGNoYVJlc3BvbnNlLFxuICAgICAgICAgICAgICAgIGNsaWVudFR5cGUsXG4gICAgICAgICAgICAgICAgcmVjYXB0Y2hhVmVyc2lvblxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG5ld1JlcXVlc3Q7XG4gICAgfVxuICAgIGVsc2UgaWYgKCdwaG9uZVNpZ25JbkluZm8nIGluIG5ld1JlcXVlc3QpIHtcbiAgICAgICAgY29uc3QgY2FwdGNoYVJlc3BvbnNlID0gbmV3UmVxdWVzdC5waG9uZVNpZ25JbkluZm8uY2FwdGNoYVJlc3BvbnNlO1xuICAgICAgICBjb25zdCBjbGllbnRUeXBlID0gbmV3UmVxdWVzdFxuICAgICAgICAgICAgLnBob25lU2lnbkluSW5mby5jbGllbnRUeXBlO1xuICAgICAgICBjb25zdCByZWNhcHRjaGFWZXJzaW9uID0gbmV3UmVxdWVzdC5waG9uZVNpZ25JbkluZm8ucmVjYXB0Y2hhVmVyc2lvbjtcbiAgICAgICAgT2JqZWN0LmFzc2lnbihuZXdSZXF1ZXN0LCB7XG4gICAgICAgICAgICAncGhvbmVTaWduSW5JbmZvJzoge1xuICAgICAgICAgICAgICAgIHJlY2FwdGNoYVRva2VuOiByZWNhcHRjaGFWMlRva2VuLFxuICAgICAgICAgICAgICAgIGNhcHRjaGFSZXNwb25zZSxcbiAgICAgICAgICAgICAgICBjbGllbnRUeXBlLFxuICAgICAgICAgICAgICAgIHJlY2FwdGNoYVZlcnNpb25cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBuZXdSZXF1ZXN0O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgT2JqZWN0LmFzc2lnbihuZXdSZXF1ZXN0LCB7ICdyZWNhcHRjaGFUb2tlbic6IHJlY2FwdGNoYVYyVG9rZW4gfSk7XG4gICAgICAgIHJldHVybiBuZXdSZXF1ZXN0O1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcgYW4ge0BsaW5rIFBob25lQXV0aENyZWRlbnRpYWx9LlxuICpcbiAqIEByZW1hcmtzXG4gKiBgUGhvbmVBdXRoUHJvdmlkZXJgIGRvZXMgbm90IHdvcmsgaW4gYSBOb2RlLmpzIGVudmlyb25tZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiAvLyAncmVjYXB0Y2hhLWNvbnRhaW5lcicgaXMgdGhlIElEIG9mIGFuIGVsZW1lbnQgaW4gdGhlIERPTS5cbiAqIGNvbnN0IGFwcGxpY2F0aW9uVmVyaWZpZXIgPSBuZXcgUmVjYXB0Y2hhVmVyaWZpZXIoJ3JlY2FwdGNoYS1jb250YWluZXInKTtcbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IFBob25lQXV0aFByb3ZpZGVyKGF1dGgpO1xuICogY29uc3QgdmVyaWZpY2F0aW9uSWQgPSBhd2FpdCBwcm92aWRlci52ZXJpZnlQaG9uZU51bWJlcignKzE2NTA1NTUwMTAxJywgYXBwbGljYXRpb25WZXJpZmllcik7XG4gKiAvLyBPYnRhaW4gdGhlIHZlcmlmaWNhdGlvbkNvZGUgZnJvbSB0aGUgdXNlci5cbiAqIGNvbnN0IHBob25lQ3JlZGVudGlhbCA9IFBob25lQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWwodmVyaWZpY2F0aW9uSWQsIHZlcmlmaWNhdGlvbkNvZGUpO1xuICogY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBzaWduSW5XaXRoQ3JlZGVudGlhbChhdXRoLCBwaG9uZUNyZWRlbnRpYWwpO1xuICogYGBgXG4gKlxuICogQHB1YmxpY1xuICovXG5jbGFzcyBQaG9uZUF1dGhQcm92aWRlciB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIGF1dGggLSBUaGUgRmlyZWJhc2Uge0BsaW5rIEF1dGh9IGluc3RhbmNlIGluIHdoaWNoIHNpZ24taW5zIHNob3VsZCBvY2N1ci5cbiAgICAgKlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGF1dGgpIHtcbiAgICAgICAgLyoqIEFsd2F5cyBzZXQgdG8ge0BsaW5rIFByb3ZpZGVySWR9LlBIT05FLiAqL1xuICAgICAgICB0aGlzLnByb3ZpZGVySWQgPSBQaG9uZUF1dGhQcm92aWRlci5QUk9WSURFUl9JRDtcbiAgICAgICAgdGhpcy5hdXRoID0gX2Nhc3RBdXRoKGF1dGgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKlxuICAgICAqIFN0YXJ0cyBhIHBob25lIG51bWJlciBhdXRoZW50aWNhdGlvbiBmbG93IGJ5IHNlbmRpbmcgYSB2ZXJpZmljYXRpb24gY29kZSB0byB0aGUgZ2l2ZW4gcGhvbmVcbiAgICAgKiBudW1iZXIuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGBgYGphdmFzY3JpcHRcbiAgICAgKiBjb25zdCBwcm92aWRlciA9IG5ldyBQaG9uZUF1dGhQcm92aWRlcihhdXRoKTtcbiAgICAgKiBjb25zdCB2ZXJpZmljYXRpb25JZCA9IGF3YWl0IHByb3ZpZGVyLnZlcmlmeVBob25lTnVtYmVyKHBob25lTnVtYmVyLCBhcHBsaWNhdGlvblZlcmlmaWVyKTtcbiAgICAgKiAvLyBPYnRhaW4gdmVyaWZpY2F0aW9uQ29kZSBmcm9tIHRoZSB1c2VyLlxuICAgICAqIGNvbnN0IGF1dGhDcmVkZW50aWFsID0gUGhvbmVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbCh2ZXJpZmljYXRpb25JZCwgdmVyaWZpY2F0aW9uQ29kZSk7XG4gICAgICogY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBzaWduSW5XaXRoQ3JlZGVudGlhbChhdXRoLCBhdXRoQ3JlZGVudGlhbCk7XG4gICAgICogYGBgXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIEFuIGFsdGVybmF0aXZlIGZsb3cgaXMgcHJvdmlkZWQgdXNpbmcgdGhlIGBzaWduSW5XaXRoUGhvbmVOdW1iZXJgIG1ldGhvZC5cbiAgICAgKiBgYGBqYXZhc2NyaXB0XG4gICAgICogY29uc3QgY29uZmlybWF0aW9uUmVzdWx0ID0gc2lnbkluV2l0aFBob25lTnVtYmVyKGF1dGgsIHBob25lTnVtYmVyLCBhcHBsaWNhdGlvblZlcmlmaWVyKTtcbiAgICAgKiAvLyBPYnRhaW4gdmVyaWZpY2F0aW9uQ29kZSBmcm9tIHRoZSB1c2VyLlxuICAgICAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gY29uZmlybWF0aW9uUmVzdWx0LmNvbmZpcm0odmVyaWZpY2F0aW9uQ29kZSk7XG4gICAgICogYGBgXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGhvbmVJbmZvT3B0aW9ucyAtIFRoZSB1c2VyJ3Mge0BsaW5rIFBob25lSW5mb09wdGlvbnN9LiBUaGUgcGhvbmUgbnVtYmVyIHNob3VsZCBiZSBpblxuICAgICAqIEUuMTY0IGZvcm1hdCAoZS5nLiArMTY1MDU1NTAxMDEpLlxuICAgICAqIEBwYXJhbSBhcHBsaWNhdGlvblZlcmlmaWVyIC0gQW4ge0BsaW5rIEFwcGxpY2F0aW9uVmVyaWZpZXJ9LCB3aGljaCBwcmV2ZW50c1xuICAgICAqIHJlcXVlc3RzIGZyb20gdW5hdXRob3JpemVkIGNsaWVudHMuIFRoaXMgU0RLIGluY2x1ZGVzIGFuIGltcGxlbWVudGF0aW9uXG4gICAgICogYmFzZWQgb24gcmVDQVBUQ0hBIHYyLCB7QGxpbmsgUmVjYXB0Y2hhVmVyaWZpZXJ9LiBJZiB5b3UndmUgZW5hYmxlZFxuICAgICAqIHJlQ0FQVENIQSBFbnRlcnByaXNlIGJvdCBwcm90ZWN0aW9uIGluIEVuZm9yY2UgbW9kZSwgdGhpcyBwYXJhbWV0ZXIgaXNcbiAgICAgKiBvcHRpb25hbDsgaW4gYWxsIG90aGVyIGNvbmZpZ3VyYXRpb25zLCB0aGUgcGFyYW1ldGVyIGlzIHJlcXVpcmVkLlxuICAgICAqXG4gICAgICogQHJldHVybnMgQSBQcm9taXNlIGZvciBhIHZlcmlmaWNhdGlvbiBJRCB0aGF0IGNhbiBiZSBwYXNzZWQgdG9cbiAgICAgKiB7QGxpbmsgUGhvbmVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbH0gdG8gaWRlbnRpZnkgdGhpcyBmbG93LlxuICAgICAqL1xuICAgIHZlcmlmeVBob25lTnVtYmVyKHBob25lT3B0aW9ucywgYXBwbGljYXRpb25WZXJpZmllcikge1xuICAgICAgICByZXR1cm4gX3ZlcmlmeVBob25lTnVtYmVyKHRoaXMuYXV0aCwgcGhvbmVPcHRpb25zLCBnZXRNb2R1bGFySW5zdGFuY2UoYXBwbGljYXRpb25WZXJpZmllcikpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgcGhvbmUgYXV0aCBjcmVkZW50aWFsLCBnaXZlbiB0aGUgdmVyaWZpY2F0aW9uIElEIGZyb21cbiAgICAgKiB7QGxpbmsgUGhvbmVBdXRoUHJvdmlkZXIudmVyaWZ5UGhvbmVOdW1iZXJ9IGFuZCB0aGUgY29kZSB0aGF0IHdhcyBzZW50IHRvIHRoZSB1c2VyJ3NcbiAgICAgKiBtb2JpbGUgZGV2aWNlLlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBgYGBqYXZhc2NyaXB0XG4gICAgICogY29uc3QgcHJvdmlkZXIgPSBuZXcgUGhvbmVBdXRoUHJvdmlkZXIoYXV0aCk7XG4gICAgICogY29uc3QgdmVyaWZpY2F0aW9uSWQgPSBwcm92aWRlci52ZXJpZnlQaG9uZU51bWJlcihwaG9uZU51bWJlciwgYXBwbGljYXRpb25WZXJpZmllcik7XG4gICAgICogLy8gT2J0YWluIHZlcmlmaWNhdGlvbkNvZGUgZnJvbSB0aGUgdXNlci5cbiAgICAgKiBjb25zdCBhdXRoQ3JlZGVudGlhbCA9IFBob25lQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWwodmVyaWZpY2F0aW9uSWQsIHZlcmlmaWNhdGlvbkNvZGUpO1xuICAgICAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gc2lnbkluV2l0aENyZWRlbnRpYWwoYXV0aCwgYXV0aENyZWRlbnRpYWwpO1xuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBBbiBhbHRlcm5hdGl2ZSBmbG93IGlzIHByb3ZpZGVkIHVzaW5nIHRoZSBgc2lnbkluV2l0aFBob25lTnVtYmVyYCBtZXRob2QuXG4gICAgICogYGBgamF2YXNjcmlwdFxuICAgICAqIGNvbnN0IGNvbmZpcm1hdGlvblJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhQaG9uZU51bWJlcihhdXRoLCBwaG9uZU51bWJlciwgYXBwbGljYXRpb25WZXJpZmllcik7XG4gICAgICogLy8gT2J0YWluIHZlcmlmaWNhdGlvbkNvZGUgZnJvbSB0aGUgdXNlci5cbiAgICAgKiBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IGNvbmZpcm1hdGlvblJlc3VsdC5jb25maXJtKHZlcmlmaWNhdGlvbkNvZGUpO1xuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogQHBhcmFtIHZlcmlmaWNhdGlvbklkIC0gVGhlIHZlcmlmaWNhdGlvbiBJRCByZXR1cm5lZCBmcm9tIHtAbGluayBQaG9uZUF1dGhQcm92aWRlci52ZXJpZnlQaG9uZU51bWJlcn0uXG4gICAgICogQHBhcmFtIHZlcmlmaWNhdGlvbkNvZGUgLSBUaGUgdmVyaWZpY2F0aW9uIGNvZGUgc2VudCB0byB0aGUgdXNlcidzIG1vYmlsZSBkZXZpY2UuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBUaGUgYXV0aCBwcm92aWRlciBjcmVkZW50aWFsLlxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVkZW50aWFsKHZlcmlmaWNhdGlvbklkLCB2ZXJpZmljYXRpb25Db2RlKSB7XG4gICAgICAgIHJldHVybiBQaG9uZUF1dGhDcmVkZW50aWFsLl9mcm9tVmVyaWZpY2F0aW9uKHZlcmlmaWNhdGlvbklkLCB2ZXJpZmljYXRpb25Db2RlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2VuZXJhdGVzIGFuIHtAbGluayBBdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBVc2VyQ3JlZGVudGlhbH0uXG4gICAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21SZXN1bHQodXNlckNyZWRlbnRpYWwpIHtcbiAgICAgICAgY29uc3QgY3JlZGVudGlhbCA9IHVzZXJDcmVkZW50aWFsO1xuICAgICAgICByZXR1cm4gUGhvbmVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoY3JlZGVudGlhbCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYW4ge0BsaW5rIEF1dGhDcmVkZW50aWFsfSB3aGVuIHBhc3NlZCBhbiBlcnJvci5cbiAgICAgKlxuICAgICAqIEByZW1hcmtzXG4gICAgICpcbiAgICAgKiBUaGlzIG1ldGhvZCB3b3JrcyBmb3IgZXJyb3JzIGxpa2VcbiAgICAgKiBgYXV0aC9hY2NvdW50LWV4aXN0cy13aXRoLWRpZmZlcmVudC1jcmVkZW50aWFsc2AuIFRoaXMgaXMgdXNlZnVsIGZvclxuICAgICAqIHJlY292ZXJpbmcgd2hlbiBhdHRlbXB0aW5nIHRvIHNldCBhIHVzZXIncyBwaG9uZSBudW1iZXIgYnV0IHRoZSBudW1iZXJcbiAgICAgKiBpbiBxdWVzdGlvbiBpcyBhbHJlYWR5IHRpZWQgdG8gYW5vdGhlciBhY2NvdW50LiBGb3IgZXhhbXBsZSwgdGhlIGZvbGxvd2luZ1xuICAgICAqIGNvZGUgdHJpZXMgdG8gdXBkYXRlIHRoZSBjdXJyZW50IHVzZXIncyBwaG9uZSBudW1iZXIsIGFuZCBpZiB0aGF0XG4gICAgICogZmFpbHMsIGxpbmtzIHRoZSB1c2VyIHdpdGggdGhlIGFjY291bnQgYXNzb2NpYXRlZCB3aXRoIHRoYXQgbnVtYmVyOlxuICAgICAqXG4gICAgICogYGBganNcbiAgICAgKiBjb25zdCBwcm92aWRlciA9IG5ldyBQaG9uZUF1dGhQcm92aWRlcihhdXRoKTtcbiAgICAgKiBjb25zdCB2ZXJpZmljYXRpb25JZCA9IGF3YWl0IHByb3ZpZGVyLnZlcmlmeVBob25lTnVtYmVyKG51bWJlciwgdmVyaWZpZXIpO1xuICAgICAqIHRyeSB7XG4gICAgICogICBjb25zdCBjb2RlID0gJyc7IC8vIFByb21wdCB0aGUgdXNlciBmb3IgdGhlIHZlcmlmaWNhdGlvbiBjb2RlXG4gICAgICogICBhd2FpdCB1cGRhdGVQaG9uZU51bWJlcihcbiAgICAgKiAgICAgICBhdXRoLmN1cnJlbnRVc2VyLFxuICAgICAqICAgICAgIFBob25lQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWwodmVyaWZpY2F0aW9uSWQsIGNvZGUpKTtcbiAgICAgKiB9IGNhdGNoIChlKSB7XG4gICAgICogICBpZiAoKGUgYXMgRmlyZWJhc2VFcnJvcik/LmNvZGUgPT09ICdhdXRoL2FjY291bnQtZXhpc3RzLXdpdGgtZGlmZmVyZW50LWNyZWRlbnRpYWwnKSB7XG4gICAgICogICAgIGNvbnN0IGNyZWQgPSBQaG9uZUF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbUVycm9yKGUpO1xuICAgICAqICAgICBhd2FpdCBsaW5rV2l0aENyZWRlbnRpYWwoYXV0aC5jdXJyZW50VXNlciwgY3JlZCk7XG4gICAgICogICB9XG4gICAgICogfVxuICAgICAqXG4gICAgICogLy8gQXQgdGhpcyBwb2ludCwgYXV0aC5jdXJyZW50VXNlci5waG9uZU51bWJlciA9PT0gbnVtYmVyLlxuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogQHBhcmFtIGVycm9yIC0gVGhlIGVycm9yIHRvIGdlbmVyYXRlIGEgY3JlZGVudGlhbCBmcm9tLlxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbUVycm9yKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBQaG9uZUF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCgoZXJyb3IuY3VzdG9tRGF0YSB8fCB7fSkpO1xuICAgIH1cbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoeyBfdG9rZW5SZXNwb25zZTogdG9rZW5SZXNwb25zZSB9KSB7XG4gICAgICAgIGlmICghdG9rZW5SZXNwb25zZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeyBwaG9uZU51bWJlciwgdGVtcG9yYXJ5UHJvb2YgfSA9IHRva2VuUmVzcG9uc2U7XG4gICAgICAgIGlmIChwaG9uZU51bWJlciAmJiB0ZW1wb3JhcnlQcm9vZikge1xuICAgICAgICAgICAgcmV0dXJuIFBob25lQXV0aENyZWRlbnRpYWwuX2Zyb21Ub2tlblJlc3BvbnNlKHBob25lTnVtYmVyLCB0ZW1wb3JhcnlQcm9vZik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxuLyoqIEFsd2F5cyBzZXQgdG8ge0BsaW5rIFByb3ZpZGVySWR9LlBIT05FLiAqL1xuUGhvbmVBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQgPSBcInBob25lXCIgLyogUHJvdmlkZXJJZC5QSE9ORSAqLztcbi8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBTaWduSW5NZXRob2R9LlBIT05FLiAqL1xuUGhvbmVBdXRoUHJvdmlkZXIuUEhPTkVfU0lHTl9JTl9NRVRIT0QgPSBcInBob25lXCIgLyogU2lnbkluTWV0aG9kLlBIT05FICovO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBDaG9vc2VzIGEgcG9wdXAvcmVkaXJlY3QgcmVzb2x2ZXIgdG8gdXNlLiBUaGlzIHByZWZlcnMgdGhlIG92ZXJyaWRlICh3aGljaFxuICogaXMgZGlyZWN0bHkgcGFzc2VkIGluKSwgYW5kIGZhbGxzIGJhY2sgdG8gdGhlIHByb3BlcnR5IHNldCBvbiB0aGUgYXV0aFxuICogb2JqZWN0LiBJZiBuZWl0aGVyIGFyZSBhdmFpbGFibGUsIHRoaXMgZnVuY3Rpb24gZXJyb3JzIHcvIGFuIGFyZ3VtZW50IGVycm9yLlxuICovXG5mdW5jdGlvbiBfd2l0aERlZmF1bHRSZXNvbHZlcihhdXRoLCByZXNvbHZlck92ZXJyaWRlKSB7XG4gICAgaWYgKHJlc29sdmVyT3ZlcnJpZGUpIHtcbiAgICAgICAgcmV0dXJuIF9nZXRJbnN0YW5jZShyZXNvbHZlck92ZXJyaWRlKTtcbiAgICB9XG4gICAgX2Fzc2VydChhdXRoLl9wb3B1cFJlZGlyZWN0UmVzb2x2ZXIsIGF1dGgsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SICovKTtcbiAgICByZXR1cm4gYXV0aC5fcG9wdXBSZWRpcmVjdFJlc29sdmVyO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3MgSWRwQ3JlZGVudGlhbCBleHRlbmRzIEF1dGhDcmVkZW50aWFsIHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXMpIHtcbiAgICAgICAgc3VwZXIoXCJjdXN0b21cIiAvKiBQcm92aWRlcklkLkNVU1RPTSAqLywgXCJjdXN0b21cIiAvKiBQcm92aWRlcklkLkNVU1RPTSAqLyk7XG4gICAgICAgIHRoaXMucGFyYW1zID0gcGFyYW1zO1xuICAgIH1cbiAgICBfZ2V0SWRUb2tlblJlc3BvbnNlKGF1dGgpIHtcbiAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhJZHAoYXV0aCwgdGhpcy5fYnVpbGRJZHBSZXF1ZXN0KCkpO1xuICAgIH1cbiAgICBfbGlua1RvSWRUb2tlbihhdXRoLCBpZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBzaWduSW5XaXRoSWRwKGF1dGgsIHRoaXMuX2J1aWxkSWRwUmVxdWVzdChpZFRva2VuKSk7XG4gICAgfVxuICAgIF9nZXRSZWF1dGhlbnRpY2F0aW9uUmVzb2x2ZXIoYXV0aCkge1xuICAgICAgICByZXR1cm4gc2lnbkluV2l0aElkcChhdXRoLCB0aGlzLl9idWlsZElkcFJlcXVlc3QoKSk7XG4gICAgfVxuICAgIF9idWlsZElkcFJlcXVlc3QoaWRUb2tlbikge1xuICAgICAgICBjb25zdCByZXF1ZXN0ID0ge1xuICAgICAgICAgICAgcmVxdWVzdFVyaTogdGhpcy5wYXJhbXMucmVxdWVzdFVyaSxcbiAgICAgICAgICAgIHNlc3Npb25JZDogdGhpcy5wYXJhbXMuc2Vzc2lvbklkLFxuICAgICAgICAgICAgcG9zdEJvZHk6IHRoaXMucGFyYW1zLnBvc3RCb2R5LFxuICAgICAgICAgICAgdGVuYW50SWQ6IHRoaXMucGFyYW1zLnRlbmFudElkLFxuICAgICAgICAgICAgcGVuZGluZ1Rva2VuOiB0aGlzLnBhcmFtcy5wZW5kaW5nVG9rZW4sXG4gICAgICAgICAgICByZXR1cm5TZWN1cmVUb2tlbjogdHJ1ZSxcbiAgICAgICAgICAgIHJldHVybklkcENyZWRlbnRpYWw6IHRydWVcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKGlkVG9rZW4pIHtcbiAgICAgICAgICAgIHJlcXVlc3QuaWRUb2tlbiA9IGlkVG9rZW47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcXVlc3Q7XG4gICAgfVxufVxuZnVuY3Rpb24gX3NpZ25JbihwYXJhbXMpIHtcbiAgICByZXR1cm4gX3NpZ25JbldpdGhDcmVkZW50aWFsKHBhcmFtcy5hdXRoLCBuZXcgSWRwQ3JlZGVudGlhbChwYXJhbXMpLCBwYXJhbXMuYnlwYXNzQXV0aFN0YXRlKTtcbn1cbmZ1bmN0aW9uIF9yZWF1dGgocGFyYW1zKSB7XG4gICAgY29uc3QgeyBhdXRoLCB1c2VyIH0gPSBwYXJhbXM7XG4gICAgX2Fzc2VydCh1c2VyLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgcmV0dXJuIF9yZWF1dGhlbnRpY2F0ZSh1c2VyLCBuZXcgSWRwQ3JlZGVudGlhbChwYXJhbXMpLCBwYXJhbXMuYnlwYXNzQXV0aFN0YXRlKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIF9saW5rKHBhcmFtcykge1xuICAgIGNvbnN0IHsgYXV0aCwgdXNlciB9ID0gcGFyYW1zO1xuICAgIF9hc3NlcnQodXNlciwgYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgIHJldHVybiBfbGluayQxKHVzZXIsIG5ldyBJZHBDcmVkZW50aWFsKHBhcmFtcyksIHBhcmFtcy5ieXBhc3NBdXRoU3RhdGUpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBQb3B1cCBldmVudCBtYW5hZ2VyLiBIYW5kbGVzIHRoZSBwb3B1cCdzIGVudGlyZSBsaWZlY3ljbGU7IGxpc3RlbnMgdG8gYXV0aFxuICogZXZlbnRzXG4gKi9cbmNsYXNzIEFic3RyYWN0UG9wdXBSZWRpcmVjdE9wZXJhdGlvbiB7XG4gICAgY29uc3RydWN0b3IoYXV0aCwgZmlsdGVyLCByZXNvbHZlciwgdXNlciwgYnlwYXNzQXV0aFN0YXRlID0gZmFsc2UpIHtcbiAgICAgICAgdGhpcy5hdXRoID0gYXV0aDtcbiAgICAgICAgdGhpcy5yZXNvbHZlciA9IHJlc29sdmVyO1xuICAgICAgICB0aGlzLnVzZXIgPSB1c2VyO1xuICAgICAgICB0aGlzLmJ5cGFzc0F1dGhTdGF0ZSA9IGJ5cGFzc0F1dGhTdGF0ZTtcbiAgICAgICAgdGhpcy5wZW5kaW5nUHJvbWlzZSA9IG51bGw7XG4gICAgICAgIHRoaXMuZXZlbnRNYW5hZ2VyID0gbnVsbDtcbiAgICAgICAgdGhpcy5maWx0ZXIgPSBBcnJheS5pc0FycmF5KGZpbHRlcikgPyBmaWx0ZXIgOiBbZmlsdGVyXTtcbiAgICB9XG4gICAgZXhlY3V0ZSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGFzeW5jIChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRoaXMucGVuZGluZ1Byb21pc2UgPSB7IHJlc29sdmUsIHJlamVjdCB9O1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLmV2ZW50TWFuYWdlciA9IGF3YWl0IHRoaXMucmVzb2x2ZXIuX2luaXRpYWxpemUodGhpcy5hdXRoKTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLm9uRXhlY3V0aW9uKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5ldmVudE1hbmFnZXIucmVnaXN0ZXJDb25zdW1lcih0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWplY3QoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhc3luYyBvbkF1dGhFdmVudChldmVudCkge1xuICAgICAgICBjb25zdCB7IHVybFJlc3BvbnNlLCBzZXNzaW9uSWQsIHBvc3RCb2R5LCB0ZW5hbnRJZCwgZXJyb3IsIHR5cGUgfSA9IGV2ZW50O1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICAgICAgICBhdXRoOiB0aGlzLmF1dGgsXG4gICAgICAgICAgICByZXF1ZXN0VXJpOiB1cmxSZXNwb25zZSxcbiAgICAgICAgICAgIHNlc3Npb25JZDogc2Vzc2lvbklkLFxuICAgICAgICAgICAgdGVuYW50SWQ6IHRlbmFudElkIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHBvc3RCb2R5OiBwb3N0Qm9keSB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICB1c2VyOiB0aGlzLnVzZXIsXG4gICAgICAgICAgICBieXBhc3NBdXRoU3RhdGU6IHRoaXMuYnlwYXNzQXV0aFN0YXRlXG4gICAgICAgIH07XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLnJlc29sdmUoYXdhaXQgdGhpcy5nZXRJZHBUYXNrKHR5cGUpKHBhcmFtcykpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICB0aGlzLnJlamVjdChlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvbkVycm9yKGVycm9yKSB7XG4gICAgICAgIHRoaXMucmVqZWN0KGVycm9yKTtcbiAgICB9XG4gICAgZ2V0SWRwVGFzayh0eXBlKSB7XG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgY2FzZSBcInNpZ25JblZpYVBvcHVwXCIgLyogQXV0aEV2ZW50VHlwZS5TSUdOX0lOX1ZJQV9QT1BVUCAqLzpcbiAgICAgICAgICAgIGNhc2UgXCJzaWduSW5WaWFSZWRpcmVjdFwiIC8qIEF1dGhFdmVudFR5cGUuU0lHTl9JTl9WSUFfUkVESVJFQ1QgKi86XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9zaWduSW47XG4gICAgICAgICAgICBjYXNlIFwibGlua1ZpYVBvcHVwXCIgLyogQXV0aEV2ZW50VHlwZS5MSU5LX1ZJQV9QT1BVUCAqLzpcbiAgICAgICAgICAgIGNhc2UgXCJsaW5rVmlhUmVkaXJlY3RcIiAvKiBBdXRoRXZlbnRUeXBlLkxJTktfVklBX1JFRElSRUNUICovOlxuICAgICAgICAgICAgICAgIHJldHVybiBfbGluaztcbiAgICAgICAgICAgIGNhc2UgXCJyZWF1dGhWaWFQb3B1cFwiIC8qIEF1dGhFdmVudFR5cGUuUkVBVVRIX1ZJQV9QT1BVUCAqLzpcbiAgICAgICAgICAgIGNhc2UgXCJyZWF1dGhWaWFSZWRpcmVjdFwiIC8qIEF1dGhFdmVudFR5cGUuUkVBVVRIX1ZJQV9SRURJUkVDVCAqLzpcbiAgICAgICAgICAgICAgICByZXR1cm4gX3JlYXV0aDtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgX2ZhaWwodGhpcy5hdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVzb2x2ZShjcmVkKSB7XG4gICAgICAgIGRlYnVnQXNzZXJ0KHRoaXMucGVuZGluZ1Byb21pc2UsICdQZW5kaW5nIHByb21pc2Ugd2FzIG5ldmVyIHNldCcpO1xuICAgICAgICB0aGlzLnBlbmRpbmdQcm9taXNlLnJlc29sdmUoY3JlZCk7XG4gICAgICAgIHRoaXMudW5yZWdpc3RlckFuZENsZWFuVXAoKTtcbiAgICB9XG4gICAgcmVqZWN0KGVycm9yKSB7XG4gICAgICAgIGRlYnVnQXNzZXJ0KHRoaXMucGVuZGluZ1Byb21pc2UsICdQZW5kaW5nIHByb21pc2Ugd2FzIG5ldmVyIHNldCcpO1xuICAgICAgICB0aGlzLnBlbmRpbmdQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICAgIHRoaXMudW5yZWdpc3RlckFuZENsZWFuVXAoKTtcbiAgICB9XG4gICAgdW5yZWdpc3RlckFuZENsZWFuVXAoKSB7XG4gICAgICAgIGlmICh0aGlzLmV2ZW50TWFuYWdlcikge1xuICAgICAgICAgICAgdGhpcy5ldmVudE1hbmFnZXIudW5yZWdpc3RlckNvbnN1bWVyKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucGVuZGluZ1Byb21pc2UgPSBudWxsO1xuICAgICAgICB0aGlzLmNsZWFuVXAoKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jb25zdCBfUE9MTF9XSU5ET1dfQ0xPU0VfVElNRU9VVCA9IG5ldyBEZWxheSgyMDAwLCAxMDAwMCk7XG4vKipcbiAqIEF1dGhlbnRpY2F0ZXMgYSBGaXJlYmFzZSBjbGllbnQgdXNpbmcgYSBwb3B1cC1iYXNlZCBPQXV0aCBhdXRoZW50aWNhdGlvbiBmbG93LlxuICpcbiAqIEByZW1hcmtzXG4gKiBJZiBzdWNjZWVkcywgcmV0dXJucyB0aGUgc2lnbmVkIGluIHVzZXIgYWxvbmcgd2l0aCB0aGUgcHJvdmlkZXIncyBjcmVkZW50aWFsLiBJZiBzaWduIGluIHdhc1xuICogdW5zdWNjZXNzZnVsLCByZXR1cm5zIGFuIGVycm9yIG9iamVjdCBjb250YWluaW5nIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGVycm9yLlxuICpcbiAqIFRoaXMgbWV0aG9kIGRvZXMgbm90IHdvcmsgaW4gYSBOb2RlLmpzIGVudmlyb25tZW50IG9yIHdpdGgge0BsaW5rIEF1dGh9IGluc3RhbmNlcyBjcmVhdGVkIHdpdGggYVxuICoge0BsaW5rIEBmaXJlYmFzZS9hcHAjRmlyZWJhc2VTZXJ2ZXJBcHB9LlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcG9wdXAuXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBGYWNlYm9va0F1dGhQcm92aWRlcigpO1xuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgc2lnbkluV2l0aFBvcHVwKGF1dGgsIHByb3ZpZGVyKTtcbiAqXG4gKiAvLyBUaGUgc2lnbmVkLWluIHVzZXIgaW5mby5cbiAqIGNvbnN0IHVzZXIgPSByZXN1bHQudXNlcjtcbiAqIC8vIFRoaXMgZ2l2ZXMgeW91IGEgRmFjZWJvb2sgQWNjZXNzIFRva2VuLlxuICogY29uc3QgY3JlZGVudGlhbCA9IHByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KGF1dGgsIHJlc3VsdCk7XG4gKiBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gcHJvdmlkZXIgLSBUaGUgcHJvdmlkZXIgdG8gYXV0aGVudGljYXRlLiBUaGUgcHJvdmlkZXIgaGFzIHRvIGJlIGFuIHtAbGluayBPQXV0aFByb3ZpZGVyfS5cbiAqIE5vbi1PQXV0aCBwcm92aWRlcnMgbGlrZSB7QGxpbmsgRW1haWxBdXRoUHJvdmlkZXJ9IHdpbGwgdGhyb3cgYW4gZXJyb3IuXG4gKiBAcGFyYW0gcmVzb2x2ZXIgLSBBbiBpbnN0YW5jZSBvZiB7QGxpbmsgUG9wdXBSZWRpcmVjdFJlc29sdmVyfSwgb3B0aW9uYWxcbiAqIGlmIGFscmVhZHkgc3VwcGxpZWQgdG8ge0BsaW5rIGluaXRpYWxpemVBdXRofSBvciBwcm92aWRlZCBieSB7QGxpbmsgZ2V0QXV0aH0uXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoUG9wdXAoYXV0aCwgcHJvdmlkZXIsIHJlc29sdmVyKSB7XG4gICAgaWYgKF9pc0ZpcmViYXNlU2VydmVyQXBwKGF1dGguYXBwKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoX2NyZWF0ZUVycm9yKGF1dGgsIFwib3BlcmF0aW9uLW5vdC1zdXBwb3J0ZWQtaW4tdGhpcy1lbnZpcm9ubWVudFwiIC8qIEF1dGhFcnJvckNvZGUuT1BFUkFUSU9OX05PVF9TVVBQT1JURUQgKi8pKTtcbiAgICB9XG4gICAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xuICAgIF9hc3NlcnRJbnN0YW5jZU9mKGF1dGgsIHByb3ZpZGVyLCBGZWRlcmF0ZWRBdXRoUHJvdmlkZXIpO1xuICAgIGNvbnN0IHJlc29sdmVySW50ZXJuYWwgPSBfd2l0aERlZmF1bHRSZXNvbHZlcihhdXRoSW50ZXJuYWwsIHJlc29sdmVyKTtcbiAgICBjb25zdCBhY3Rpb24gPSBuZXcgUG9wdXBPcGVyYXRpb24oYXV0aEludGVybmFsLCBcInNpZ25JblZpYVBvcHVwXCIgLyogQXV0aEV2ZW50VHlwZS5TSUdOX0lOX1ZJQV9QT1BVUCAqLywgcHJvdmlkZXIsIHJlc29sdmVySW50ZXJuYWwpO1xuICAgIHJldHVybiBhY3Rpb24uZXhlY3V0ZU5vdE51bGwoKTtcbn1cbi8qKlxuICogUmVhdXRoZW50aWNhdGVzIHRoZSBjdXJyZW50IHVzZXIgd2l0aCB0aGUgc3BlY2lmaWVkIHtAbGluayBPQXV0aFByb3ZpZGVyfSB1c2luZyBhIHBvcC11cCBiYXNlZFxuICogT0F1dGggZmxvdy5cbiAqXG4gKiBAcmVtYXJrc1xuICogSWYgdGhlIHJlYXV0aGVudGljYXRpb24gaXMgc3VjY2Vzc2Z1bCwgdGhlIHJldHVybmVkIHJlc3VsdCB3aWxsIGNvbnRhaW4gdGhlIHVzZXIgYW5kIHRoZVxuICogcHJvdmlkZXIncyBjcmVkZW50aWFsLlxuICpcbiAqIFRoaXMgbWV0aG9kIGRvZXMgbm90IHdvcmsgaW4gYSBOb2RlLmpzIGVudmlyb25tZW50IG9yIG9uIGFueSB7QGxpbmsgVXNlcn0gc2lnbmVkIGluIGJ5XG4gKiB7QGxpbmsgQXV0aH0gaW5zdGFuY2VzIGNyZWF0ZWQgd2l0aCBhIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlU2VydmVyQXBwfS5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gU2lnbiBpbiB1c2luZyBhIHBvcHVwLlxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgRmFjZWJvb2tBdXRoUHJvdmlkZXIoKTtcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhQb3B1cChhdXRoLCBwcm92aWRlcik7XG4gKiAvLyBSZWF1dGhlbnRpY2F0ZSB1c2luZyBhIHBvcHVwLlxuICogYXdhaXQgcmVhdXRoZW50aWNhdGVXaXRoUG9wdXAocmVzdWx0LnVzZXIsIHByb3ZpZGVyKTtcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gcHJvdmlkZXIgLSBUaGUgcHJvdmlkZXIgdG8gYXV0aGVudGljYXRlLiBUaGUgcHJvdmlkZXIgaGFzIHRvIGJlIGFuIHtAbGluayBPQXV0aFByb3ZpZGVyfS5cbiAqIE5vbi1PQXV0aCBwcm92aWRlcnMgbGlrZSB7QGxpbmsgRW1haWxBdXRoUHJvdmlkZXJ9IHdpbGwgdGhyb3cgYW4gZXJyb3IuXG4gKiBAcGFyYW0gcmVzb2x2ZXIgLSBBbiBpbnN0YW5jZSBvZiB7QGxpbmsgUG9wdXBSZWRpcmVjdFJlc29sdmVyfSwgb3B0aW9uYWxcbiAqIGlmIGFscmVhZHkgc3VwcGxpZWQgdG8ge0BsaW5rIGluaXRpYWxpemVBdXRofSBvciBwcm92aWRlZCBieSB7QGxpbmsgZ2V0QXV0aH0uXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiByZWF1dGhlbnRpY2F0ZVdpdGhQb3B1cCh1c2VyLCBwcm92aWRlciwgcmVzb2x2ZXIpIHtcbiAgICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcik7XG4gICAgaWYgKF9pc0ZpcmViYXNlU2VydmVyQXBwKHVzZXJJbnRlcm5hbC5hdXRoLmFwcCkpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KF9jcmVhdGVFcnJvcih1c2VySW50ZXJuYWwuYXV0aCwgXCJvcGVyYXRpb24tbm90LXN1cHBvcnRlZC1pbi10aGlzLWVudmlyb25tZW50XCIgLyogQXV0aEVycm9yQ29kZS5PUEVSQVRJT05fTk9UX1NVUFBPUlRFRCAqLykpO1xuICAgIH1cbiAgICBfYXNzZXJ0SW5zdGFuY2VPZih1c2VySW50ZXJuYWwuYXV0aCwgcHJvdmlkZXIsIEZlZGVyYXRlZEF1dGhQcm92aWRlcik7XG4gICAgY29uc3QgcmVzb2x2ZXJJbnRlcm5hbCA9IF93aXRoRGVmYXVsdFJlc29sdmVyKHVzZXJJbnRlcm5hbC5hdXRoLCByZXNvbHZlcik7XG4gICAgY29uc3QgYWN0aW9uID0gbmV3IFBvcHVwT3BlcmF0aW9uKHVzZXJJbnRlcm5hbC5hdXRoLCBcInJlYXV0aFZpYVBvcHVwXCIgLyogQXV0aEV2ZW50VHlwZS5SRUFVVEhfVklBX1BPUFVQICovLCBwcm92aWRlciwgcmVzb2x2ZXJJbnRlcm5hbCwgdXNlckludGVybmFsKTtcbiAgICByZXR1cm4gYWN0aW9uLmV4ZWN1dGVOb3ROdWxsKCk7XG59XG4vKipcbiAqIExpbmtzIHRoZSBhdXRoZW50aWNhdGVkIHByb3ZpZGVyIHRvIHRoZSB1c2VyIGFjY291bnQgdXNpbmcgYSBwb3AtdXAgYmFzZWQgT0F1dGggZmxvdy5cbiAqXG4gKiBAcmVtYXJrc1xuICogSWYgdGhlIGxpbmtpbmcgaXMgc3VjY2Vzc2Z1bCwgdGhlIHJldHVybmVkIHJlc3VsdCB3aWxsIGNvbnRhaW4gdGhlIHVzZXIgYW5kIHRoZSBwcm92aWRlcidzIGNyZWRlbnRpYWwuXG4gKlxuICogVGhpcyBtZXRob2QgZG9lcyBub3Qgd29yayBpbiBhIE5vZGUuanMgZW52aXJvbm1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIC8vIFNpZ24gaW4gdXNpbmcgc29tZSBvdGhlciBwcm92aWRlci5cbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkKGF1dGgsIGVtYWlsLCBwYXNzd29yZCk7XG4gKiAvLyBMaW5rIHVzaW5nIGEgcG9wdXAuXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBGYWNlYm9va0F1dGhQcm92aWRlcigpO1xuICogYXdhaXQgbGlua1dpdGhQb3B1cChyZXN1bHQudXNlciwgcHJvdmlkZXIpO1xuICogYGBgXG4gKlxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cbiAqIEBwYXJhbSBwcm92aWRlciAtIFRoZSBwcm92aWRlciB0byBhdXRoZW50aWNhdGUuIFRoZSBwcm92aWRlciBoYXMgdG8gYmUgYW4ge0BsaW5rIE9BdXRoUHJvdmlkZXJ9LlxuICogTm9uLU9BdXRoIHByb3ZpZGVycyBsaWtlIHtAbGluayBFbWFpbEF1dGhQcm92aWRlcn0gd2lsbCB0aHJvdyBhbiBlcnJvci5cbiAqIEBwYXJhbSByZXNvbHZlciAtIEFuIGluc3RhbmNlIG9mIHtAbGluayBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJ9LCBvcHRpb25hbFxuICogaWYgYWxyZWFkeSBzdXBwbGllZCB0byB7QGxpbmsgaW5pdGlhbGl6ZUF1dGh9IG9yIHByb3ZpZGVkIGJ5IHtAbGluayBnZXRBdXRofS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGxpbmtXaXRoUG9wdXAodXNlciwgcHJvdmlkZXIsIHJlc29sdmVyKSB7XG4gICAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpO1xuICAgIF9hc3NlcnRJbnN0YW5jZU9mKHVzZXJJbnRlcm5hbC5hdXRoLCBwcm92aWRlciwgRmVkZXJhdGVkQXV0aFByb3ZpZGVyKTtcbiAgICBjb25zdCByZXNvbHZlckludGVybmFsID0gX3dpdGhEZWZhdWx0UmVzb2x2ZXIodXNlckludGVybmFsLmF1dGgsIHJlc29sdmVyKTtcbiAgICBjb25zdCBhY3Rpb24gPSBuZXcgUG9wdXBPcGVyYXRpb24odXNlckludGVybmFsLmF1dGgsIFwibGlua1ZpYVBvcHVwXCIgLyogQXV0aEV2ZW50VHlwZS5MSU5LX1ZJQV9QT1BVUCAqLywgcHJvdmlkZXIsIHJlc29sdmVySW50ZXJuYWwsIHVzZXJJbnRlcm5hbCk7XG4gICAgcmV0dXJuIGFjdGlvbi5leGVjdXRlTm90TnVsbCgpO1xufVxuLyoqXG4gKiBQb3B1cCBldmVudCBtYW5hZ2VyLiBIYW5kbGVzIHRoZSBwb3B1cCdzIGVudGlyZSBsaWZlY3ljbGU7IGxpc3RlbnMgdG8gYXV0aFxuICogZXZlbnRzXG4gKlxuICovXG5jbGFzcyBQb3B1cE9wZXJhdGlvbiBleHRlbmRzIEFic3RyYWN0UG9wdXBSZWRpcmVjdE9wZXJhdGlvbiB7XG4gICAgY29uc3RydWN0b3IoYXV0aCwgZmlsdGVyLCBwcm92aWRlciwgcmVzb2x2ZXIsIHVzZXIpIHtcbiAgICAgICAgc3VwZXIoYXV0aCwgZmlsdGVyLCByZXNvbHZlciwgdXNlcik7XG4gICAgICAgIHRoaXMucHJvdmlkZXIgPSBwcm92aWRlcjtcbiAgICAgICAgdGhpcy5hdXRoV2luZG93ID0gbnVsbDtcbiAgICAgICAgdGhpcy5wb2xsSWQgPSBudWxsO1xuICAgICAgICBpZiAoUG9wdXBPcGVyYXRpb24uY3VycmVudFBvcHVwQWN0aW9uKSB7XG4gICAgICAgICAgICBQb3B1cE9wZXJhdGlvbi5jdXJyZW50UG9wdXBBY3Rpb24uY2FuY2VsKCk7XG4gICAgICAgIH1cbiAgICAgICAgUG9wdXBPcGVyYXRpb24uY3VycmVudFBvcHVwQWN0aW9uID0gdGhpcztcbiAgICB9XG4gICAgYXN5bmMgZXhlY3V0ZU5vdE51bGwoKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZSgpO1xuICAgICAgICBfYXNzZXJ0KHJlc3VsdCwgdGhpcy5hdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGFzeW5jIG9uRXhlY3V0aW9uKCkge1xuICAgICAgICBkZWJ1Z0Fzc2VydCh0aGlzLmZpbHRlci5sZW5ndGggPT09IDEsICdQb3B1cCBvcGVyYXRpb25zIG9ubHkgaGFuZGxlIG9uZSBldmVudCcpO1xuICAgICAgICBjb25zdCBldmVudElkID0gX2dlbmVyYXRlRXZlbnRJZCgpO1xuICAgICAgICB0aGlzLmF1dGhXaW5kb3cgPSBhd2FpdCB0aGlzLnJlc29sdmVyLl9vcGVuUG9wdXAodGhpcy5hdXRoLCB0aGlzLnByb3ZpZGVyLCB0aGlzLmZpbHRlclswXSwgLy8gVGhlcmUncyBhbHdheXMgb25lLCBzZWUgY29uc3RydWN0b3JcbiAgICAgICAgZXZlbnRJZCk7XG4gICAgICAgIHRoaXMuYXV0aFdpbmRvdy5hc3NvY2lhdGVkRXZlbnQgPSBldmVudElkO1xuICAgICAgICAvLyBDaGVjayBmb3Igd2ViIHN0b3JhZ2Ugc3VwcG9ydCBhbmQgb3JpZ2luIHZhbGlkYXRpb24gX2FmdGVyXyB0aGUgcG9wdXAgaXNcbiAgICAgICAgLy8gbG9hZGVkLiBUaGVzZSBvcGVyYXRpb25zIGFyZSBzbG93ICh+MSBzZWNvbmQgb3Igc28pIFJhdGhlciB0aGFuXG4gICAgICAgIC8vIHdhaXRpbmcgb24gdGhlbSBiZWZvcmUgb3BlbmluZyB0aGUgd2luZG93LCBvcHRpbWlzdGljYWxseSBvcGVuIHRoZSBwb3B1cFxuICAgICAgICAvLyBhbmQgY2hlY2sgZm9yIHN0b3JhZ2Ugc3VwcG9ydCBhdCB0aGUgc2FtZSB0aW1lLiBJZiBzdG9yYWdlIHN1cHBvcnQgaXNcbiAgICAgICAgLy8gbm90IGF2YWlsYWJsZSwgdGhpcyB3aWxsIGNhdXNlIHRoZSB3aG9sZSB0aGluZyB0byByZWplY3QgcHJvcGVybHkuIEl0XG4gICAgICAgIC8vIHdpbGwgYWxzbyBjbG9zZSB0aGUgcG9wdXAsIGJ1dCBzaW5jZSB0aGUgcHJvbWlzZSBoYXMgYWxyZWFkeSByZWplY3RlZCxcbiAgICAgICAgLy8gdGhlIHBvcHVwIGNsb3NlZCBieSB1c2VyIHBvbGwgd2lsbCByZWplY3QgaW50byB0aGUgdm9pZC5cbiAgICAgICAgdGhpcy5yZXNvbHZlci5fb3JpZ2luVmFsaWRhdGlvbih0aGlzLmF1dGgpLmNhdGNoKGUgPT4ge1xuICAgICAgICAgICAgdGhpcy5yZWplY3QoZSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnJlc29sdmVyLl9pc0lmcmFtZVdlYlN0b3JhZ2VTdXBwb3J0ZWQodGhpcy5hdXRoLCBpc1N1cHBvcnRlZCA9PiB7XG4gICAgICAgICAgICBpZiAoIWlzU3VwcG9ydGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWplY3QoX2NyZWF0ZUVycm9yKHRoaXMuYXV0aCwgXCJ3ZWItc3RvcmFnZS11bnN1cHBvcnRlZFwiIC8qIEF1dGhFcnJvckNvZGUuV0VCX1NUT1JBR0VfVU5TVVBQT1JURUQgKi8pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIEhhbmRsZSB1c2VyIGNsb3N1cmUuIE5vdGljZSB0aGlzIGRvZXMgKm5vdCogdXNlIGF3YWl0XG4gICAgICAgIHRoaXMucG9sbFVzZXJDYW5jZWxsYXRpb24oKTtcbiAgICB9XG4gICAgZ2V0IGV2ZW50SWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmF1dGhXaW5kb3c/LmFzc29jaWF0ZWRFdmVudCB8fCBudWxsO1xuICAgIH1cbiAgICBjYW5jZWwoKSB7XG4gICAgICAgIHRoaXMucmVqZWN0KF9jcmVhdGVFcnJvcih0aGlzLmF1dGgsIFwiY2FuY2VsbGVkLXBvcHVwLXJlcXVlc3RcIiAvKiBBdXRoRXJyb3JDb2RlLkVYUElSRURfUE9QVVBfUkVRVUVTVCAqLykpO1xuICAgIH1cbiAgICBjbGVhblVwKCkge1xuICAgICAgICBpZiAodGhpcy5hdXRoV2luZG93KSB7XG4gICAgICAgICAgICB0aGlzLmF1dGhXaW5kb3cuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wb2xsSWQpIHtcbiAgICAgICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5wb2xsSWQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYXV0aFdpbmRvdyA9IG51bGw7XG4gICAgICAgIHRoaXMucG9sbElkID0gbnVsbDtcbiAgICAgICAgUG9wdXBPcGVyYXRpb24uY3VycmVudFBvcHVwQWN0aW9uID0gbnVsbDtcbiAgICB9XG4gICAgcG9sbFVzZXJDYW5jZWxsYXRpb24oKSB7XG4gICAgICAgIGNvbnN0IHBvbGwgPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5hdXRoV2luZG93Py53aW5kb3c/LmNsb3NlZCkge1xuICAgICAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IHRoZXJlIGlzIHN1ZmZpY2llbnQgdGltZSBmb3Igd2hhdGV2ZXIgYWN0aW9uIHRvXG4gICAgICAgICAgICAgICAgLy8gY29tcGxldGUuIFRoZSB3aW5kb3cgY291bGQgaGF2ZSBjbG9zZWQgYnV0IHRoZSBzaWduIGluIG5ldHdvcmtcbiAgICAgICAgICAgICAgICAvLyBjYWxsIGNvdWxkIHN0aWxsIGJlIGluIGZsaWdodC4gVGhpcyBpcyBzcGVjaWZpY2FsbHkgdHJ1ZSBmb3JcbiAgICAgICAgICAgICAgICAvLyBGaXJlZm94IG9yIGlmIHRoZSBvcGVuZXIgaXMgaW4gYW4gaWZyYW1lLCBpbiB3aGljaCBjYXNlIHRoZSBvYXV0aFxuICAgICAgICAgICAgICAgIC8vIGhlbHBlciBjbG9zZXMgdGhlIHBvcHVwLlxuICAgICAgICAgICAgICAgIHRoaXMucG9sbElkID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvbGxJZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVqZWN0KF9jcmVhdGVFcnJvcih0aGlzLmF1dGgsIFwicG9wdXAtY2xvc2VkLWJ5LXVzZXJcIiAvKiBBdXRoRXJyb3JDb2RlLlBPUFVQX0NMT1NFRF9CWV9VU0VSICovKSk7XG4gICAgICAgICAgICAgICAgfSwgODAwMCAvKiBfVGltZW91dC5BVVRIX0VWRU5UICovKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnBvbGxJZCA9IHdpbmRvdy5zZXRUaW1lb3V0KHBvbGwsIF9QT0xMX1dJTkRPV19DTE9TRV9USU1FT1VULmdldCgpKTtcbiAgICAgICAgfTtcbiAgICAgICAgcG9sbCgpO1xuICAgIH1cbn1cbi8vIE9ubHkgb25lIHBvcHVwIGlzIGV2ZXIgc2hvd24gYXQgb25jZS4gVGhlIGxpZmVjeWNsZSBvZiB0aGUgY3VycmVudCBwb3B1cFxuLy8gY2FuIGJlIG1hbmFnZWQgLyBjYW5jZWxsZWQgYnkgdGhlIGNvbnN0cnVjdG9yLlxuUG9wdXBPcGVyYXRpb24uY3VycmVudFBvcHVwQWN0aW9uID0gbnVsbDtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IFBFTkRJTkdfUkVESVJFQ1RfS0VZID0gJ3BlbmRpbmdSZWRpcmVjdCc7XG4vLyBXZSBvbmx5IGdldCBvbmUgcmVkaXJlY3Qgb3V0Y29tZSBmb3IgYW55IG9uZSBhdXRoLCBzbyBqdXN0IHN0b3JlIGl0XG4vLyBpbiBoZXJlLlxuY29uc3QgcmVkaXJlY3RPdXRjb21lTWFwID0gbmV3IE1hcCgpO1xuY2xhc3MgUmVkaXJlY3RBY3Rpb24gZXh0ZW5kcyBBYnN0cmFjdFBvcHVwUmVkaXJlY3RPcGVyYXRpb24ge1xuICAgIGNvbnN0cnVjdG9yKGF1dGgsIHJlc29sdmVyLCBieXBhc3NBdXRoU3RhdGUgPSBmYWxzZSkge1xuICAgICAgICBzdXBlcihhdXRoLCBbXG4gICAgICAgICAgICBcInNpZ25JblZpYVJlZGlyZWN0XCIgLyogQXV0aEV2ZW50VHlwZS5TSUdOX0lOX1ZJQV9SRURJUkVDVCAqLyxcbiAgICAgICAgICAgIFwibGlua1ZpYVJlZGlyZWN0XCIgLyogQXV0aEV2ZW50VHlwZS5MSU5LX1ZJQV9SRURJUkVDVCAqLyxcbiAgICAgICAgICAgIFwicmVhdXRoVmlhUmVkaXJlY3RcIiAvKiBBdXRoRXZlbnRUeXBlLlJFQVVUSF9WSUFfUkVESVJFQ1QgKi8sXG4gICAgICAgICAgICBcInVua25vd25cIiAvKiBBdXRoRXZlbnRUeXBlLlVOS05PV04gKi9cbiAgICAgICAgXSwgcmVzb2x2ZXIsIHVuZGVmaW5lZCwgYnlwYXNzQXV0aFN0YXRlKTtcbiAgICAgICAgdGhpcy5ldmVudElkID0gbnVsbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogT3ZlcnJpZGUgdGhlIGV4ZWN1dGUgZnVuY3Rpb247IGlmIHdlIGFscmVhZHkgaGF2ZSBhIHJlZGlyZWN0IHJlc3VsdCwgdGhlblxuICAgICAqIGp1c3QgcmV0dXJuIGl0LlxuICAgICAqL1xuICAgIGFzeW5jIGV4ZWN1dGUoKSB7XG4gICAgICAgIGxldCByZWFkeU91dGNvbWUgPSByZWRpcmVjdE91dGNvbWVNYXAuZ2V0KHRoaXMuYXV0aC5fa2V5KCkpO1xuICAgICAgICBpZiAoIXJlYWR5T3V0Y29tZSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBoYXNQZW5kaW5nUmVkaXJlY3QgPSBhd2FpdCBfZ2V0QW5kQ2xlYXJQZW5kaW5nUmVkaXJlY3RTdGF0dXModGhpcy5yZXNvbHZlciwgdGhpcy5hdXRoKTtcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBoYXNQZW5kaW5nUmVkaXJlY3QgPyBhd2FpdCBzdXBlci5leGVjdXRlKCkgOiBudWxsO1xuICAgICAgICAgICAgICAgIHJlYWR5T3V0Y29tZSA9ICgpID0+IFByb21pc2UucmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZWFkeU91dGNvbWUgPSAoKSA9PiBQcm9taXNlLnJlamVjdChlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlZGlyZWN0T3V0Y29tZU1hcC5zZXQodGhpcy5hdXRoLl9rZXkoKSwgcmVhZHlPdXRjb21lKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBJZiB3ZSdyZSBub3QgYnlwYXNzaW5nIGF1dGggc3RhdGUsIHRoZSByZWFkeSBvdXRjb21lIHNob3VsZCBiZSBzZXQgdG9cbiAgICAgICAgLy8gbnVsbC5cbiAgICAgICAgaWYgKCF0aGlzLmJ5cGFzc0F1dGhTdGF0ZSkge1xuICAgICAgICAgICAgcmVkaXJlY3RPdXRjb21lTWFwLnNldCh0aGlzLmF1dGguX2tleSgpLCAoKSA9PiBQcm9taXNlLnJlc29sdmUobnVsbCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZWFkeU91dGNvbWUoKTtcbiAgICB9XG4gICAgYXN5bmMgb25BdXRoRXZlbnQoZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LnR5cGUgPT09IFwic2lnbkluVmlhUmVkaXJlY3RcIiAvKiBBdXRoRXZlbnRUeXBlLlNJR05fSU5fVklBX1JFRElSRUNUICovKSB7XG4gICAgICAgICAgICByZXR1cm4gc3VwZXIub25BdXRoRXZlbnQoZXZlbnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV2ZW50LnR5cGUgPT09IFwidW5rbm93blwiIC8qIEF1dGhFdmVudFR5cGUuVU5LTk9XTiAqLykge1xuICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHNlbnRpbmVsIHZhbHVlIGluZGljYXRpbmcgdGhlcmUncyBubyBwZW5kaW5nIHJlZGlyZWN0XG4gICAgICAgICAgICB0aGlzLnJlc29sdmUobnVsbCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2ZW50LmV2ZW50SWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCB0aGlzLmF1dGguX3JlZGlyZWN0VXNlckZvcklkKGV2ZW50LmV2ZW50SWQpO1xuICAgICAgICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVzZXIgPSB1c2VyO1xuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5vbkF1dGhFdmVudChldmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlc29sdmUobnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXN5bmMgb25FeGVjdXRpb24oKSB7IH1cbiAgICBjbGVhblVwKCkgeyB9XG59XG5hc3luYyBmdW5jdGlvbiBfZ2V0QW5kQ2xlYXJQZW5kaW5nUmVkaXJlY3RTdGF0dXMocmVzb2x2ZXIsIGF1dGgpIHtcbiAgICBjb25zdCBrZXkgPSBwZW5kaW5nUmVkaXJlY3RLZXkoYXV0aCk7XG4gICAgY29uc3QgcGVyc2lzdGVuY2UgPSByZXNvbHZlclBlcnNpc3RlbmNlKHJlc29sdmVyKTtcbiAgICBpZiAoIShhd2FpdCBwZXJzaXN0ZW5jZS5faXNBdmFpbGFibGUoKSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjb25zdCBoYXNQZW5kaW5nUmVkaXJlY3QgPSAoYXdhaXQgcGVyc2lzdGVuY2UuX2dldChrZXkpKSA9PT0gJ3RydWUnO1xuICAgIGF3YWl0IHBlcnNpc3RlbmNlLl9yZW1vdmUoa2V5KTtcbiAgICByZXR1cm4gaGFzUGVuZGluZ1JlZGlyZWN0O1xufVxuYXN5bmMgZnVuY3Rpb24gX3NldFBlbmRpbmdSZWRpcmVjdFN0YXR1cyhyZXNvbHZlciwgYXV0aCkge1xuICAgIHJldHVybiByZXNvbHZlclBlcnNpc3RlbmNlKHJlc29sdmVyKS5fc2V0KHBlbmRpbmdSZWRpcmVjdEtleShhdXRoKSwgJ3RydWUnKTtcbn1cbmZ1bmN0aW9uIF9jbGVhclJlZGlyZWN0T3V0Y29tZXMoKSB7XG4gICAgcmVkaXJlY3RPdXRjb21lTWFwLmNsZWFyKCk7XG59XG5mdW5jdGlvbiBfb3ZlcnJpZGVSZWRpcmVjdFJlc3VsdChhdXRoLCByZXN1bHQpIHtcbiAgICByZWRpcmVjdE91dGNvbWVNYXAuc2V0KGF1dGguX2tleSgpLCByZXN1bHQpO1xufVxuZnVuY3Rpb24gcmVzb2x2ZXJQZXJzaXN0ZW5jZShyZXNvbHZlcikge1xuICAgIHJldHVybiBfZ2V0SW5zdGFuY2UocmVzb2x2ZXIuX3JlZGlyZWN0UGVyc2lzdGVuY2UpO1xufVxuZnVuY3Rpb24gcGVuZGluZ1JlZGlyZWN0S2V5KGF1dGgpIHtcbiAgICByZXR1cm4gX3BlcnNpc3RlbmNlS2V5TmFtZShQRU5ESU5HX1JFRElSRUNUX0tFWSwgYXV0aC5jb25maWcuYXBpS2V5LCBhdXRoLm5hbWUpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBdXRoZW50aWNhdGVzIGEgRmlyZWJhc2UgY2xpZW50IHVzaW5nIGEgZnVsbC1wYWdlIHJlZGlyZWN0IGZsb3cuXG4gKlxuICogQHJlbWFya3NcbiAqIFRvIGhhbmRsZSB0aGUgcmVzdWx0cyBhbmQgZXJyb3JzIGZvciB0aGlzIG9wZXJhdGlvbiwgcmVmZXIgdG8ge0BsaW5rIGdldFJlZGlyZWN0UmVzdWx0fS5cbiAqIEZvbGxvdyB0aGUge0BsaW5rIGh0dHBzOi8vZmlyZWJhc2UuZ29vZ2xlLmNvbS9kb2NzL2F1dGgvd2ViL3JlZGlyZWN0LWJlc3QtcHJhY3RpY2VzXG4gKiB8IGJlc3QgcHJhY3RpY2VzfSB3aGVuIHVzaW5nIHtAbGluayBzaWduSW5XaXRoUmVkaXJlY3R9LlxuICpcbiAqIFRoaXMgbWV0aG9kIGRvZXMgbm90IHdvcmsgaW4gYSBOb2RlLmpzIGVudmlyb25tZW50IG9yIHdpdGgge0BsaW5rIEF1dGh9IGluc3RhbmNlcyBjcmVhdGVkIHdpdGggYVxuICoge0BsaW5rIEBmaXJlYmFzZS9hcHAjRmlyZWJhc2VTZXJ2ZXJBcHB9LlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcmVkaXJlY3QuXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBGYWNlYm9va0F1dGhQcm92aWRlcigpO1xuICogLy8gWW91IGNhbiBhZGQgYWRkaXRpb25hbCBzY29wZXMgdG8gdGhlIHByb3ZpZGVyOlxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3VzZXJfYmlydGhkYXknKTtcbiAqIC8vIFN0YXJ0IGEgc2lnbiBpbiBwcm9jZXNzIGZvciBhbiB1bmF1dGhlbnRpY2F0ZWQgdXNlci5cbiAqIGF3YWl0IHNpZ25JbldpdGhSZWRpcmVjdChhdXRoLCBwcm92aWRlcik7XG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcbiAqXG4gKiAvLyBBZnRlciByZXR1cm5pbmcgZnJvbSB0aGUgcmVkaXJlY3Qgd2hlbiB5b3VyIGFwcCBpbml0aWFsaXplcyB5b3UgY2FuIG9idGFpbiB0aGUgcmVzdWx0XG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcbiAqIGlmIChyZXN1bHQpIHtcbiAqICAgLy8gVGhpcyBpcyB0aGUgc2lnbmVkLWluIHVzZXJcbiAqICAgY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xuICogICAvLyBUaGlzIGdpdmVzIHlvdSBhIEZhY2Vib29rIEFjY2VzcyBUb2tlbi5cbiAqICAgY29uc3QgY3JlZGVudGlhbCA9IHByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KGF1dGgsIHJlc3VsdCk7XG4gKiAgIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcbiAqIH1cbiAqIC8vIEFzIHRoaXMgQVBJIGNhbiBiZSB1c2VkIGZvciBzaWduLWluLCBsaW5raW5nIGFuZCByZWF1dGhlbnRpY2F0aW9uLFxuICogLy8gY2hlY2sgdGhlIG9wZXJhdGlvblR5cGUgdG8gZGV0ZXJtaW5lIHdoYXQgdHJpZ2dlcmVkIHRoaXMgcmVkaXJlY3RcbiAqIC8vIG9wZXJhdGlvbi5cbiAqIGNvbnN0IG9wZXJhdGlvblR5cGUgPSByZXN1bHQub3BlcmF0aW9uVHlwZTtcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSBwcm92aWRlciAtIFRoZSBwcm92aWRlciB0byBhdXRoZW50aWNhdGUuIFRoZSBwcm92aWRlciBoYXMgdG8gYmUgYW4ge0BsaW5rIE9BdXRoUHJvdmlkZXJ9LlxuICogTm9uLU9BdXRoIHByb3ZpZGVycyBsaWtlIHtAbGluayBFbWFpbEF1dGhQcm92aWRlcn0gd2lsbCB0aHJvdyBhbiBlcnJvci5cbiAqIEBwYXJhbSByZXNvbHZlciAtIEFuIGluc3RhbmNlIG9mIHtAbGluayBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJ9LCBvcHRpb25hbFxuICogaWYgYWxyZWFkeSBzdXBwbGllZCB0byB7QGxpbmsgaW5pdGlhbGl6ZUF1dGh9IG9yIHByb3ZpZGVkIGJ5IHtAbGluayBnZXRBdXRofS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIHNpZ25JbldpdGhSZWRpcmVjdChhdXRoLCBwcm92aWRlciwgcmVzb2x2ZXIpIHtcbiAgICByZXR1cm4gX3NpZ25JbldpdGhSZWRpcmVjdChhdXRoLCBwcm92aWRlciwgcmVzb2x2ZXIpO1xufVxuYXN5bmMgZnVuY3Rpb24gX3NpZ25JbldpdGhSZWRpcmVjdChhdXRoLCBwcm92aWRlciwgcmVzb2x2ZXIpIHtcbiAgICBpZiAoX2lzRmlyZWJhc2VTZXJ2ZXJBcHAoYXV0aC5hcHApKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChfc2VydmVyQXBwQ3VycmVudFVzZXJPcGVyYXRpb25Ob3RTdXBwb3J0ZWRFcnJvcihhdXRoKSk7XG4gICAgfVxuICAgIGNvbnN0IGF1dGhJbnRlcm5hbCA9IF9jYXN0QXV0aChhdXRoKTtcbiAgICBfYXNzZXJ0SW5zdGFuY2VPZihhdXRoLCBwcm92aWRlciwgRmVkZXJhdGVkQXV0aFByb3ZpZGVyKTtcbiAgICAvLyBXYWl0IGZvciBhdXRoIGluaXRpYWxpemF0aW9uIHRvIGNvbXBsZXRlLCB0aGlzIHdpbGwgcHJvY2VzcyBwZW5kaW5nIHJlZGlyZWN0cyBhbmQgY2xlYXIgdGhlXG4gICAgLy8gUEVORElOR19SRURJUkVDVF9LRVkgaW4gcGVyc2lzdGVuY2UuIFRoaXMgc2hvdWxkIGJlIGNvbXBsZXRlZCBiZWZvcmUgc3RhcnRpbmcgYSBuZXdcbiAgICAvLyByZWRpcmVjdCBhbmQgY3JlYXRpbmcgYSBQRU5ESU5HX1JFRElSRUNUX0tFWSBlbnRyeS5cbiAgICBhd2FpdCBhdXRoSW50ZXJuYWwuX2luaXRpYWxpemF0aW9uUHJvbWlzZTtcbiAgICBjb25zdCByZXNvbHZlckludGVybmFsID0gX3dpdGhEZWZhdWx0UmVzb2x2ZXIoYXV0aEludGVybmFsLCByZXNvbHZlcik7XG4gICAgYXdhaXQgX3NldFBlbmRpbmdSZWRpcmVjdFN0YXR1cyhyZXNvbHZlckludGVybmFsLCBhdXRoSW50ZXJuYWwpO1xuICAgIHJldHVybiByZXNvbHZlckludGVybmFsLl9vcGVuUmVkaXJlY3QoYXV0aEludGVybmFsLCBwcm92aWRlciwgXCJzaWduSW5WaWFSZWRpcmVjdFwiIC8qIEF1dGhFdmVudFR5cGUuU0lHTl9JTl9WSUFfUkVESVJFQ1QgKi8pO1xufVxuLyoqXG4gKiBSZWF1dGhlbnRpY2F0ZXMgdGhlIGN1cnJlbnQgdXNlciB3aXRoIHRoZSBzcGVjaWZpZWQge0BsaW5rIE9BdXRoUHJvdmlkZXJ9IHVzaW5nIGEgZnVsbC1wYWdlIHJlZGlyZWN0IGZsb3cuXG4gKiBAcmVtYXJrc1xuICogVG8gaGFuZGxlIHRoZSByZXN1bHRzIGFuZCBlcnJvcnMgZm9yIHRoaXMgb3BlcmF0aW9uLCByZWZlciB0byB7QGxpbmsgZ2V0UmVkaXJlY3RSZXN1bHR9LlxuICogRm9sbG93IHRoZSB7QGxpbmsgaHR0cHM6Ly9maXJlYmFzZS5nb29nbGUuY29tL2RvY3MvYXV0aC93ZWIvcmVkaXJlY3QtYmVzdC1wcmFjdGljZXNcbiAqIHwgYmVzdCBwcmFjdGljZXN9IHdoZW4gdXNpbmcge0BsaW5rIHJlYXV0aGVudGljYXRlV2l0aFJlZGlyZWN0fS5cbiAqXG4gKiBUaGlzIG1ldGhvZCBkb2VzIG5vdCB3b3JrIGluIGEgTm9kZS5qcyBlbnZpcm9ubWVudCBvciB3aXRoIHtAbGluayBBdXRofSBpbnN0YW5jZXNcbiAqIGNyZWF0ZWQgd2l0aCBhIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlU2VydmVyQXBwfS5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gU2lnbiBpbiB1c2luZyBhIHJlZGlyZWN0LlxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgRmFjZWJvb2tBdXRoUHJvdmlkZXIoKTtcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhSZWRpcmVjdChhdXRoLCBwcm92aWRlcik7XG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcbiAqXG4gKiAvLyBBZnRlciByZXR1cm5pbmcgZnJvbSB0aGUgcmVkaXJlY3Qgd2hlbiB5b3VyIGFwcCBpbml0aWFsaXplcyB5b3UgY2FuIG9idGFpbiB0aGUgcmVzdWx0XG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcbiAqIC8vIFJlYXV0aGVudGljYXRlIHVzaW5nIGEgcmVkaXJlY3QuXG4gKiBhd2FpdCByZWF1dGhlbnRpY2F0ZVdpdGhSZWRpcmVjdChyZXN1bHQudXNlciwgcHJvdmlkZXIpO1xuICogLy8gVGhpcyB3aWxsIGFnYWluIHRyaWdnZXIgYSBmdWxsIHBhZ2UgcmVkaXJlY3QgYXdheSBmcm9tIHlvdXIgYXBwXG4gKlxuICogLy8gQWZ0ZXIgcmV0dXJuaW5nIGZyb20gdGhlIHJlZGlyZWN0IHdoZW4geW91ciBhcHAgaW5pdGlhbGl6ZXMgeW91IGNhbiBvYnRhaW4gdGhlIHJlc3VsdFxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0UmVkaXJlY3RSZXN1bHQoYXV0aCk7XG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxuICogQHBhcmFtIHByb3ZpZGVyIC0gVGhlIHByb3ZpZGVyIHRvIGF1dGhlbnRpY2F0ZS4gVGhlIHByb3ZpZGVyIGhhcyB0byBiZSBhbiB7QGxpbmsgT0F1dGhQcm92aWRlcn0uXG4gKiBOb24tT0F1dGggcHJvdmlkZXJzIGxpa2Uge0BsaW5rIEVtYWlsQXV0aFByb3ZpZGVyfSB3aWxsIHRocm93IGFuIGVycm9yLlxuICogQHBhcmFtIHJlc29sdmVyIC0gQW4gaW5zdGFuY2Ugb2Yge0BsaW5rIFBvcHVwUmVkaXJlY3RSZXNvbHZlcn0sIG9wdGlvbmFsXG4gKiBpZiBhbHJlYWR5IHN1cHBsaWVkIHRvIHtAbGluayBpbml0aWFsaXplQXV0aH0gb3IgcHJvdmlkZWQgYnkge0BsaW5rIGdldEF1dGh9LlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZnVuY3Rpb24gcmVhdXRoZW50aWNhdGVXaXRoUmVkaXJlY3QodXNlciwgcHJvdmlkZXIsIHJlc29sdmVyKSB7XG4gICAgcmV0dXJuIF9yZWF1dGhlbnRpY2F0ZVdpdGhSZWRpcmVjdCh1c2VyLCBwcm92aWRlciwgcmVzb2x2ZXIpO1xufVxuYXN5bmMgZnVuY3Rpb24gX3JlYXV0aGVudGljYXRlV2l0aFJlZGlyZWN0KHVzZXIsIHByb3ZpZGVyLCByZXNvbHZlcikge1xuICAgIGNvbnN0IHVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKTtcbiAgICBfYXNzZXJ0SW5zdGFuY2VPZih1c2VySW50ZXJuYWwuYXV0aCwgcHJvdmlkZXIsIEZlZGVyYXRlZEF1dGhQcm92aWRlcik7XG4gICAgaWYgKF9pc0ZpcmViYXNlU2VydmVyQXBwKHVzZXJJbnRlcm5hbC5hdXRoLmFwcCkpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KF9zZXJ2ZXJBcHBDdXJyZW50VXNlck9wZXJhdGlvbk5vdFN1cHBvcnRlZEVycm9yKHVzZXJJbnRlcm5hbC5hdXRoKSk7XG4gICAgfVxuICAgIC8vIFdhaXQgZm9yIGF1dGggaW5pdGlhbGl6YXRpb24gdG8gY29tcGxldGUsIHRoaXMgd2lsbCBwcm9jZXNzIHBlbmRpbmcgcmVkaXJlY3RzIGFuZCBjbGVhciB0aGVcbiAgICAvLyBQRU5ESU5HX1JFRElSRUNUX0tFWSBpbiBwZXJzaXN0ZW5jZS4gVGhpcyBzaG91bGQgYmUgY29tcGxldGVkIGJlZm9yZSBzdGFydGluZyBhIG5ld1xuICAgIC8vIHJlZGlyZWN0IGFuZCBjcmVhdGluZyBhIFBFTkRJTkdfUkVESVJFQ1RfS0VZIGVudHJ5LlxuICAgIGF3YWl0IHVzZXJJbnRlcm5hbC5hdXRoLl9pbml0aWFsaXphdGlvblByb21pc2U7XG4gICAgLy8gQWxsb3cgdGhlIHJlc29sdmVyIHRvIGVycm9yIGJlZm9yZSBwZXJzaXN0aW5nIHRoZSByZWRpcmVjdCB1c2VyXG4gICAgY29uc3QgcmVzb2x2ZXJJbnRlcm5hbCA9IF93aXRoRGVmYXVsdFJlc29sdmVyKHVzZXJJbnRlcm5hbC5hdXRoLCByZXNvbHZlcik7XG4gICAgYXdhaXQgX3NldFBlbmRpbmdSZWRpcmVjdFN0YXR1cyhyZXNvbHZlckludGVybmFsLCB1c2VySW50ZXJuYWwuYXV0aCk7XG4gICAgY29uc3QgZXZlbnRJZCA9IGF3YWl0IHByZXBhcmVVc2VyRm9yUmVkaXJlY3QodXNlckludGVybmFsKTtcbiAgICByZXR1cm4gcmVzb2x2ZXJJbnRlcm5hbC5fb3BlblJlZGlyZWN0KHVzZXJJbnRlcm5hbC5hdXRoLCBwcm92aWRlciwgXCJyZWF1dGhWaWFSZWRpcmVjdFwiIC8qIEF1dGhFdmVudFR5cGUuUkVBVVRIX1ZJQV9SRURJUkVDVCAqLywgZXZlbnRJZCk7XG59XG4vKipcbiAqIExpbmtzIHRoZSB7QGxpbmsgT0F1dGhQcm92aWRlcn0gdG8gdGhlIHVzZXIgYWNjb3VudCB1c2luZyBhIGZ1bGwtcGFnZSByZWRpcmVjdCBmbG93LlxuICogQHJlbWFya3NcbiAqIFRvIGhhbmRsZSB0aGUgcmVzdWx0cyBhbmQgZXJyb3JzIGZvciB0aGlzIG9wZXJhdGlvbiwgcmVmZXIgdG8ge0BsaW5rIGdldFJlZGlyZWN0UmVzdWx0fS5cbiAqIEZvbGxvdyB0aGUge0BsaW5rIGh0dHBzOi8vZmlyZWJhc2UuZ29vZ2xlLmNvbS9kb2NzL2F1dGgvd2ViL3JlZGlyZWN0LWJlc3QtcHJhY3RpY2VzXG4gKiB8IGJlc3QgcHJhY3RpY2VzfSB3aGVuIHVzaW5nIHtAbGluayBsaW5rV2l0aFJlZGlyZWN0fS5cbiAqXG4gKiBUaGlzIG1ldGhvZCBkb2VzIG5vdCB3b3JrIGluIGEgTm9kZS5qcyBlbnZpcm9ubWVudCBvciB3aXRoIHtAbGluayBBdXRofSBpbnN0YW5jZXNcbiAqIGNyZWF0ZWQgd2l0aCBhIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlU2VydmVyQXBwfS5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gU2lnbiBpbiB1c2luZyBzb21lIG90aGVyIHByb3ZpZGVyLlxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgc2lnbkluV2l0aEVtYWlsQW5kUGFzc3dvcmQoYXV0aCwgZW1haWwsIHBhc3N3b3JkKTtcbiAqIC8vIExpbmsgdXNpbmcgYSByZWRpcmVjdC5cbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IEZhY2Vib29rQXV0aFByb3ZpZGVyKCk7XG4gKiBhd2FpdCBsaW5rV2l0aFJlZGlyZWN0KHJlc3VsdC51c2VyLCBwcm92aWRlcik7XG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcbiAqXG4gKiAvLyBBZnRlciByZXR1cm5pbmcgZnJvbSB0aGUgcmVkaXJlY3Qgd2hlbiB5b3VyIGFwcCBpbml0aWFsaXplcyB5b3UgY2FuIG9idGFpbiB0aGUgcmVzdWx0XG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gcHJvdmlkZXIgLSBUaGUgcHJvdmlkZXIgdG8gYXV0aGVudGljYXRlLiBUaGUgcHJvdmlkZXIgaGFzIHRvIGJlIGFuIHtAbGluayBPQXV0aFByb3ZpZGVyfS5cbiAqIE5vbi1PQXV0aCBwcm92aWRlcnMgbGlrZSB7QGxpbmsgRW1haWxBdXRoUHJvdmlkZXJ9IHdpbGwgdGhyb3cgYW4gZXJyb3IuXG4gKiBAcGFyYW0gcmVzb2x2ZXIgLSBBbiBpbnN0YW5jZSBvZiB7QGxpbmsgUG9wdXBSZWRpcmVjdFJlc29sdmVyfSwgb3B0aW9uYWxcbiAqIGlmIGFscmVhZHkgc3VwcGxpZWQgdG8ge0BsaW5rIGluaXRpYWxpemVBdXRofSBvciBwcm92aWRlZCBieSB7QGxpbmsgZ2V0QXV0aH0uXG4gKlxuICogQHB1YmxpY1xuICovXG5mdW5jdGlvbiBsaW5rV2l0aFJlZGlyZWN0KHVzZXIsIHByb3ZpZGVyLCByZXNvbHZlcikge1xuICAgIHJldHVybiBfbGlua1dpdGhSZWRpcmVjdCh1c2VyLCBwcm92aWRlciwgcmVzb2x2ZXIpO1xufVxuYXN5bmMgZnVuY3Rpb24gX2xpbmtXaXRoUmVkaXJlY3QodXNlciwgcHJvdmlkZXIsIHJlc29sdmVyKSB7XG4gICAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpO1xuICAgIF9hc3NlcnRJbnN0YW5jZU9mKHVzZXJJbnRlcm5hbC5hdXRoLCBwcm92aWRlciwgRmVkZXJhdGVkQXV0aFByb3ZpZGVyKTtcbiAgICAvLyBXYWl0IGZvciBhdXRoIGluaXRpYWxpemF0aW9uIHRvIGNvbXBsZXRlLCB0aGlzIHdpbGwgcHJvY2VzcyBwZW5kaW5nIHJlZGlyZWN0cyBhbmQgY2xlYXIgdGhlXG4gICAgLy8gUEVORElOR19SRURJUkVDVF9LRVkgaW4gcGVyc2lzdGVuY2UuIFRoaXMgc2hvdWxkIGJlIGNvbXBsZXRlZCBiZWZvcmUgc3RhcnRpbmcgYSBuZXdcbiAgICAvLyByZWRpcmVjdCBhbmQgY3JlYXRpbmcgYSBQRU5ESU5HX1JFRElSRUNUX0tFWSBlbnRyeS5cbiAgICBhd2FpdCB1c2VySW50ZXJuYWwuYXV0aC5faW5pdGlhbGl6YXRpb25Qcm9taXNlO1xuICAgIC8vIEFsbG93IHRoZSByZXNvbHZlciB0byBlcnJvciBiZWZvcmUgcGVyc2lzdGluZyB0aGUgcmVkaXJlY3QgdXNlclxuICAgIGNvbnN0IHJlc29sdmVySW50ZXJuYWwgPSBfd2l0aERlZmF1bHRSZXNvbHZlcih1c2VySW50ZXJuYWwuYXV0aCwgcmVzb2x2ZXIpO1xuICAgIGF3YWl0IF9hc3NlcnRMaW5rZWRTdGF0dXMoZmFsc2UsIHVzZXJJbnRlcm5hbCwgcHJvdmlkZXIucHJvdmlkZXJJZCk7XG4gICAgYXdhaXQgX3NldFBlbmRpbmdSZWRpcmVjdFN0YXR1cyhyZXNvbHZlckludGVybmFsLCB1c2VySW50ZXJuYWwuYXV0aCk7XG4gICAgY29uc3QgZXZlbnRJZCA9IGF3YWl0IHByZXBhcmVVc2VyRm9yUmVkaXJlY3QodXNlckludGVybmFsKTtcbiAgICByZXR1cm4gcmVzb2x2ZXJJbnRlcm5hbC5fb3BlblJlZGlyZWN0KHVzZXJJbnRlcm5hbC5hdXRoLCBwcm92aWRlciwgXCJsaW5rVmlhUmVkaXJlY3RcIiAvKiBBdXRoRXZlbnRUeXBlLkxJTktfVklBX1JFRElSRUNUICovLCBldmVudElkKTtcbn1cbi8qKlxuICogUmV0dXJucyBhIHtAbGluayBVc2VyQ3JlZGVudGlhbH0gZnJvbSB0aGUgcmVkaXJlY3QtYmFzZWQgc2lnbi1pbiBmbG93LlxuICpcbiAqIEByZW1hcmtzXG4gKiBJZiBzaWduLWluIHN1Y2NlZWRlZCwgcmV0dXJucyB0aGUgc2lnbmVkIGluIHVzZXIuIElmIHNpZ24taW4gd2FzIHVuc3VjY2Vzc2Z1bCwgZmFpbHMgd2l0aCBhblxuICogZXJyb3IuIElmIG5vIHJlZGlyZWN0IG9wZXJhdGlvbiB3YXMgY2FsbGVkLCByZXR1cm5zIGBudWxsYC5cbiAqXG4gKiBUaGlzIG1ldGhvZCBkb2VzIG5vdCB3b3JrIGluIGEgTm9kZS5qcyBlbnZpcm9ubWVudCBvciB3aXRoIHtAbGluayBBdXRofSBpbnN0YW5jZXMgY3JlYXRlZCB3aXRoIGFcbiAqIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlU2VydmVyQXBwfS5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gU2lnbiBpbiB1c2luZyBhIHJlZGlyZWN0LlxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgRmFjZWJvb2tBdXRoUHJvdmlkZXIoKTtcbiAqIC8vIFlvdSBjYW4gYWRkIGFkZGl0aW9uYWwgc2NvcGVzIHRvIHRoZSBwcm92aWRlcjpcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCd1c2VyX2JpcnRoZGF5Jyk7XG4gKiAvLyBTdGFydCBhIHNpZ24gaW4gcHJvY2VzcyBmb3IgYW4gdW5hdXRoZW50aWNhdGVkIHVzZXIuXG4gKiBhd2FpdCBzaWduSW5XaXRoUmVkaXJlY3QoYXV0aCwgcHJvdmlkZXIpO1xuICogLy8gVGhpcyB3aWxsIHRyaWdnZXIgYSBmdWxsIHBhZ2UgcmVkaXJlY3QgYXdheSBmcm9tIHlvdXIgYXBwXG4gKlxuICogLy8gQWZ0ZXIgcmV0dXJuaW5nIGZyb20gdGhlIHJlZGlyZWN0IHdoZW4geW91ciBhcHAgaW5pdGlhbGl6ZXMgeW91IGNhbiBvYnRhaW4gdGhlIHJlc3VsdFxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0UmVkaXJlY3RSZXN1bHQoYXV0aCk7XG4gKiBpZiAocmVzdWx0KSB7XG4gKiAgIC8vIFRoaXMgaXMgdGhlIHNpZ25lZC1pbiB1c2VyXG4gKiAgIGNvbnN0IHVzZXIgPSByZXN1bHQudXNlcjtcbiAqICAgLy8gVGhpcyBnaXZlcyB5b3UgYSBGYWNlYm9vayBBY2Nlc3MgVG9rZW4uXG4gKiAgIGNvbnN0IGNyZWRlbnRpYWwgPSBwcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChhdXRoLCByZXN1bHQpO1xuICogICBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XG4gKiB9XG4gKiAvLyBBcyB0aGlzIEFQSSBjYW4gYmUgdXNlZCBmb3Igc2lnbi1pbiwgbGlua2luZyBhbmQgcmVhdXRoZW50aWNhdGlvbixcbiAqIC8vIGNoZWNrIHRoZSBvcGVyYXRpb25UeXBlIHRvIGRldGVybWluZSB3aGF0IHRyaWdnZXJlZCB0aGlzIHJlZGlyZWN0XG4gKiAvLyBvcGVyYXRpb24uXG4gKiBjb25zdCBvcGVyYXRpb25UeXBlID0gcmVzdWx0Lm9wZXJhdGlvblR5cGU7XG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gcmVzb2x2ZXIgLSBBbiBpbnN0YW5jZSBvZiB7QGxpbmsgUG9wdXBSZWRpcmVjdFJlc29sdmVyfSwgb3B0aW9uYWxcbiAqIGlmIGFscmVhZHkgc3VwcGxpZWQgdG8ge0BsaW5rIGluaXRpYWxpemVBdXRofSBvciBwcm92aWRlZCBieSB7QGxpbmsgZ2V0QXV0aH0uXG4gKlxuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiBnZXRSZWRpcmVjdFJlc3VsdChhdXRoLCByZXNvbHZlcikge1xuICAgIGF3YWl0IF9jYXN0QXV0aChhdXRoKS5faW5pdGlhbGl6YXRpb25Qcm9taXNlO1xuICAgIHJldHVybiBfZ2V0UmVkaXJlY3RSZXN1bHQoYXV0aCwgcmVzb2x2ZXIsIGZhbHNlKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIF9nZXRSZWRpcmVjdFJlc3VsdChhdXRoLCByZXNvbHZlckV4dGVybiwgYnlwYXNzQXV0aFN0YXRlID0gZmFsc2UpIHtcbiAgICBpZiAoX2lzRmlyZWJhc2VTZXJ2ZXJBcHAoYXV0aC5hcHApKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChfc2VydmVyQXBwQ3VycmVudFVzZXJPcGVyYXRpb25Ob3RTdXBwb3J0ZWRFcnJvcihhdXRoKSk7XG4gICAgfVxuICAgIGNvbnN0IGF1dGhJbnRlcm5hbCA9IF9jYXN0QXV0aChhdXRoKTtcbiAgICBjb25zdCByZXNvbHZlciA9IF93aXRoRGVmYXVsdFJlc29sdmVyKGF1dGhJbnRlcm5hbCwgcmVzb2x2ZXJFeHRlcm4pO1xuICAgIGNvbnN0IGFjdGlvbiA9IG5ldyBSZWRpcmVjdEFjdGlvbihhdXRoSW50ZXJuYWwsIHJlc29sdmVyLCBieXBhc3NBdXRoU3RhdGUpO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGFjdGlvbi5leGVjdXRlKCk7XG4gICAgaWYgKHJlc3VsdCAmJiAhYnlwYXNzQXV0aFN0YXRlKSB7XG4gICAgICAgIGRlbGV0ZSByZXN1bHQudXNlci5fcmVkaXJlY3RFdmVudElkO1xuICAgICAgICBhd2FpdCBhdXRoSW50ZXJuYWwuX3BlcnNpc3RVc2VySWZDdXJyZW50KHJlc3VsdC51c2VyKTtcbiAgICAgICAgYXdhaXQgYXV0aEludGVybmFsLl9zZXRSZWRpcmVjdFVzZXIobnVsbCwgcmVzb2x2ZXJFeHRlcm4pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuYXN5bmMgZnVuY3Rpb24gcHJlcGFyZVVzZXJGb3JSZWRpcmVjdCh1c2VyKSB7XG4gICAgY29uc3QgZXZlbnRJZCA9IF9nZW5lcmF0ZUV2ZW50SWQoYCR7dXNlci51aWR9Ojo6YCk7XG4gICAgdXNlci5fcmVkaXJlY3RFdmVudElkID0gZXZlbnRJZDtcbiAgICBhd2FpdCB1c2VyLmF1dGguX3NldFJlZGlyZWN0VXNlcih1c2VyKTtcbiAgICBhd2FpdCB1c2VyLmF1dGguX3BlcnNpc3RVc2VySWZDdXJyZW50KHVzZXIpO1xuICAgIHJldHVybiBldmVudElkO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gVGhlIGFtb3VudCBvZiB0aW1lIHRvIHN0b3JlIHRoZSBVSURzIG9mIHNlZW4gZXZlbnRzOyB0aGlzIGlzXG4vLyBzZXQgdG8gMTAgbWluIGJ5IGRlZmF1bHRcbmNvbnN0IEVWRU5UX0RVUExJQ0FUSU9OX0NBQ0hFX0RVUkFUSU9OX01TID0gMTAgKiA2MCAqIDEwMDA7XG5jbGFzcyBBdXRoRXZlbnRNYW5hZ2VyIHtcbiAgICBjb25zdHJ1Y3RvcihhdXRoKSB7XG4gICAgICAgIHRoaXMuYXV0aCA9IGF1dGg7XG4gICAgICAgIHRoaXMuY2FjaGVkRXZlbnRVaWRzID0gbmV3IFNldCgpO1xuICAgICAgICB0aGlzLmNvbnN1bWVycyA9IG5ldyBTZXQoKTtcbiAgICAgICAgdGhpcy5xdWV1ZWRSZWRpcmVjdEV2ZW50ID0gbnVsbDtcbiAgICAgICAgdGhpcy5oYXNIYW5kbGVkUG90ZW50aWFsUmVkaXJlY3QgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5sYXN0UHJvY2Vzc2VkRXZlbnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICB9XG4gICAgcmVnaXN0ZXJDb25zdW1lcihhdXRoRXZlbnRDb25zdW1lcikge1xuICAgICAgICB0aGlzLmNvbnN1bWVycy5hZGQoYXV0aEV2ZW50Q29uc3VtZXIpO1xuICAgICAgICBpZiAodGhpcy5xdWV1ZWRSZWRpcmVjdEV2ZW50ICYmXG4gICAgICAgICAgICB0aGlzLmlzRXZlbnRGb3JDb25zdW1lcih0aGlzLnF1ZXVlZFJlZGlyZWN0RXZlbnQsIGF1dGhFdmVudENvbnN1bWVyKSkge1xuICAgICAgICAgICAgdGhpcy5zZW5kVG9Db25zdW1lcih0aGlzLnF1ZXVlZFJlZGlyZWN0RXZlbnQsIGF1dGhFdmVudENvbnN1bWVyKTtcbiAgICAgICAgICAgIHRoaXMuc2F2ZUV2ZW50VG9DYWNoZSh0aGlzLnF1ZXVlZFJlZGlyZWN0RXZlbnQpO1xuICAgICAgICAgICAgdGhpcy5xdWV1ZWRSZWRpcmVjdEV2ZW50ID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICB1bnJlZ2lzdGVyQ29uc3VtZXIoYXV0aEV2ZW50Q29uc3VtZXIpIHtcbiAgICAgICAgdGhpcy5jb25zdW1lcnMuZGVsZXRlKGF1dGhFdmVudENvbnN1bWVyKTtcbiAgICB9XG4gICAgb25FdmVudChldmVudCkge1xuICAgICAgICAvLyBDaGVjayBpZiB0aGUgZXZlbnQgaGFzIGFscmVhZHkgYmVlbiBoYW5kbGVkXG4gICAgICAgIGlmICh0aGlzLmhhc0V2ZW50QmVlbkhhbmRsZWQoZXZlbnQpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGhhbmRsZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jb25zdW1lcnMuZm9yRWFjaChjb25zdW1lciA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0V2ZW50Rm9yQ29uc3VtZXIoZXZlbnQsIGNvbnN1bWVyKSkge1xuICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VuZFRvQ29uc3VtZXIoZXZlbnQsIGNvbnN1bWVyKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNhdmVFdmVudFRvQ2FjaGUoZXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRoaXMuaGFzSGFuZGxlZFBvdGVudGlhbFJlZGlyZWN0IHx8ICFpc1JlZGlyZWN0RXZlbnQoZXZlbnQpKSB7XG4gICAgICAgICAgICAvLyBJZiB3ZSd2ZSBhbHJlYWR5IHNlZW4gYSByZWRpcmVjdCBiZWZvcmUsIG9yIHRoaXMgaXMgYSBwb3B1cCBldmVudCxcbiAgICAgICAgICAgIC8vIGJhaWwgbm93XG4gICAgICAgICAgICByZXR1cm4gaGFuZGxlZDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmhhc0hhbmRsZWRQb3RlbnRpYWxSZWRpcmVjdCA9IHRydWU7XG4gICAgICAgIC8vIElmIHRoZSByZWRpcmVjdCB3YXNuJ3QgaGFuZGxlZCwgaGFuZyBvbiB0byBpdFxuICAgICAgICBpZiAoIWhhbmRsZWQpIHtcbiAgICAgICAgICAgIHRoaXMucXVldWVkUmVkaXJlY3RFdmVudCA9IGV2ZW50O1xuICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGhhbmRsZWQ7XG4gICAgfVxuICAgIHNlbmRUb0NvbnN1bWVyKGV2ZW50LCBjb25zdW1lcikge1xuICAgICAgICBpZiAoZXZlbnQuZXJyb3IgJiYgIWlzTnVsbFJlZGlyZWN0RXZlbnQoZXZlbnQpKSB7XG4gICAgICAgICAgICBjb25zdCBjb2RlID0gZXZlbnQuZXJyb3IuY29kZT8uc3BsaXQoJ2F1dGgvJylbMV0gfHxcbiAgICAgICAgICAgICAgICBcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLztcbiAgICAgICAgICAgIGNvbnN1bWVyLm9uRXJyb3IoX2NyZWF0ZUVycm9yKHRoaXMuYXV0aCwgY29kZSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3VtZXIub25BdXRoRXZlbnQoZXZlbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlzRXZlbnRGb3JDb25zdW1lcihldmVudCwgY29uc3VtZXIpIHtcbiAgICAgICAgY29uc3QgZXZlbnRJZE1hdGNoZXMgPSBjb25zdW1lci5ldmVudElkID09PSBudWxsIHx8XG4gICAgICAgICAgICAoISFldmVudC5ldmVudElkICYmIGV2ZW50LmV2ZW50SWQgPT09IGNvbnN1bWVyLmV2ZW50SWQpO1xuICAgICAgICByZXR1cm4gY29uc3VtZXIuZmlsdGVyLmluY2x1ZGVzKGV2ZW50LnR5cGUpICYmIGV2ZW50SWRNYXRjaGVzO1xuICAgIH1cbiAgICBoYXNFdmVudEJlZW5IYW5kbGVkKGV2ZW50KSB7XG4gICAgICAgIGlmIChEYXRlLm5vdygpIC0gdGhpcy5sYXN0UHJvY2Vzc2VkRXZlbnRUaW1lID49XG4gICAgICAgICAgICBFVkVOVF9EVVBMSUNBVElPTl9DQUNIRV9EVVJBVElPTl9NUykge1xuICAgICAgICAgICAgdGhpcy5jYWNoZWRFdmVudFVpZHMuY2xlYXIoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5jYWNoZWRFdmVudFVpZHMuaGFzKGV2ZW50VWlkKGV2ZW50KSk7XG4gICAgfVxuICAgIHNhdmVFdmVudFRvQ2FjaGUoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5jYWNoZWRFdmVudFVpZHMuYWRkKGV2ZW50VWlkKGV2ZW50KSk7XG4gICAgICAgIHRoaXMubGFzdFByb2Nlc3NlZEV2ZW50VGltZSA9IERhdGUubm93KCk7XG4gICAgfVxufVxuZnVuY3Rpb24gZXZlbnRVaWQoZSkge1xuICAgIHJldHVybiBbZS50eXBlLCBlLmV2ZW50SWQsIGUuc2Vzc2lvbklkLCBlLnRlbmFudElkXS5maWx0ZXIodiA9PiB2KS5qb2luKCctJyk7XG59XG5mdW5jdGlvbiBpc051bGxSZWRpcmVjdEV2ZW50KHsgdHlwZSwgZXJyb3IgfSkge1xuICAgIHJldHVybiAodHlwZSA9PT0gXCJ1bmtub3duXCIgLyogQXV0aEV2ZW50VHlwZS5VTktOT1dOICovICYmXG4gICAgICAgIGVycm9yPy5jb2RlID09PSBgYXV0aC8ke1wibm8tYXV0aC1ldmVudFwiIC8qIEF1dGhFcnJvckNvZGUuTk9fQVVUSF9FVkVOVCAqL31gKTtcbn1cbmZ1bmN0aW9uIGlzUmVkaXJlY3RFdmVudChldmVudCkge1xuICAgIHN3aXRjaCAoZXZlbnQudHlwZSkge1xuICAgICAgICBjYXNlIFwic2lnbkluVmlhUmVkaXJlY3RcIiAvKiBBdXRoRXZlbnRUeXBlLlNJR05fSU5fVklBX1JFRElSRUNUICovOlxuICAgICAgICBjYXNlIFwibGlua1ZpYVJlZGlyZWN0XCIgLyogQXV0aEV2ZW50VHlwZS5MSU5LX1ZJQV9SRURJUkVDVCAqLzpcbiAgICAgICAgY2FzZSBcInJlYXV0aFZpYVJlZGlyZWN0XCIgLyogQXV0aEV2ZW50VHlwZS5SRUFVVEhfVklBX1JFRElSRUNUICovOlxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIGNhc2UgXCJ1bmtub3duXCIgLyogQXV0aEV2ZW50VHlwZS5VTktOT1dOICovOlxuICAgICAgICAgICAgcmV0dXJuIGlzTnVsbFJlZGlyZWN0RXZlbnQoZXZlbnQpO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIF9nZXRQcm9qZWN0Q29uZmlnKGF1dGgsIHJlcXVlc3QgPSB7fSkge1xuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJHRVRcIiAvKiBIdHRwTWV0aG9kLkdFVCAqLywgXCIvdjEvcHJvamVjdHNcIiAvKiBFbmRwb2ludC5HRVRfUFJPSkVDVF9DT05GSUcgKi8sIHJlcXVlc3QpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY29uc3QgSVBfQUREUkVTU19SRUdFWCA9IC9eXFxkezEsM31cXC5cXGR7MSwzfVxcLlxcZHsxLDN9XFwuXFxkezEsM30kLztcbmNvbnN0IEhUVFBfUkVHRVggPSAvXmh0dHBzPy87XG5hc3luYyBmdW5jdGlvbiBfdmFsaWRhdGVPcmlnaW4oYXV0aCkge1xuICAgIC8vIFNraXAgb3JpZ2luIHZhbGlkYXRpb24gaWYgd2UgYXJlIGluIGFuIGVtdWxhdGVkIGVudmlyb25tZW50XG4gICAgaWYgKGF1dGguY29uZmlnLmVtdWxhdG9yKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgeyBhdXRob3JpemVkRG9tYWlucyB9ID0gYXdhaXQgX2dldFByb2plY3RDb25maWcoYXV0aCk7XG4gICAgZm9yIChjb25zdCBkb21haW4gb2YgYXV0aG9yaXplZERvbWFpbnMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChtYXRjaERvbWFpbihkb21haW4pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgIC8vIERvIG5vdGhpbmcgaWYgdGhlcmUncyBhIFVSTCBlcnJvcjsganVzdCBjb250aW51ZSBzZWFyY2hpbmdcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBJbiB0aGUgb2xkIFNESywgdGhpcyBlcnJvciBhbHNvIHByb3ZpZGVzIGhlbHBmdWwgbWVzc2FnZXMuXG4gICAgX2ZhaWwoYXV0aCwgXCJ1bmF1dGhvcml6ZWQtZG9tYWluXCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX09SSUdJTiAqLyk7XG59XG5mdW5jdGlvbiBtYXRjaERvbWFpbihleHBlY3RlZCkge1xuICAgIGNvbnN0IGN1cnJlbnRVcmwgPSBfZ2V0Q3VycmVudFVybCgpO1xuICAgIGNvbnN0IHsgcHJvdG9jb2wsIGhvc3RuYW1lIH0gPSBuZXcgVVJMKGN1cnJlbnRVcmwpO1xuICAgIGlmIChleHBlY3RlZC5zdGFydHNXaXRoKCdjaHJvbWUtZXh0ZW5zaW9uOi8vJykpIHtcbiAgICAgICAgY29uc3QgY2VVcmwgPSBuZXcgVVJMKGV4cGVjdGVkKTtcbiAgICAgICAgaWYgKGNlVXJsLmhvc3RuYW1lID09PSAnJyAmJiBob3N0bmFtZSA9PT0gJycpIHtcbiAgICAgICAgICAgIC8vIEZvciBzb21lIHJlYXNvbiB3ZSdyZSBub3QgcGFyc2luZyBjaHJvbWUgVVJMcyBwcm9wZXJseVxuICAgICAgICAgICAgcmV0dXJuIChwcm90b2NvbCA9PT0gJ2Nocm9tZS1leHRlbnNpb246JyAmJlxuICAgICAgICAgICAgICAgIGV4cGVjdGVkLnJlcGxhY2UoJ2Nocm9tZS1leHRlbnNpb246Ly8nLCAnJykgPT09XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRVcmwucmVwbGFjZSgnY2hyb21lLWV4dGVuc2lvbjovLycsICcnKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb3RvY29sID09PSAnY2hyb21lLWV4dGVuc2lvbjonICYmIGNlVXJsLmhvc3RuYW1lID09PSBob3N0bmFtZTtcbiAgICB9XG4gICAgaWYgKCFIVFRQX1JFR0VYLnRlc3QocHJvdG9jb2wpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKElQX0FERFJFU1NfUkVHRVgudGVzdChleHBlY3RlZCkpIHtcbiAgICAgICAgLy8gVGhlIGRvbWFpbiBoYXMgdG8gYmUgZXhhY3RseSBlcXVhbCB0byB0aGUgcGF0dGVybiwgYXMgYW4gSVAgZG9tYWluIHdpbGxcbiAgICAgICAgLy8gb25seSBjb250YWluIHRoZSBJUCwgbm8gZXh0cmEgY2hhcmFjdGVyLlxuICAgICAgICByZXR1cm4gaG9zdG5hbWUgPT09IGV4cGVjdGVkO1xuICAgIH1cbiAgICAvLyBEb3RzIGluIHBhdHRlcm4gc2hvdWxkIGJlIGVzY2FwZWQuXG4gICAgY29uc3QgZXNjYXBlZERvbWFpblBhdHRlcm4gPSBleHBlY3RlZC5yZXBsYWNlKC9cXC4vZywgJ1xcXFwuJyk7XG4gICAgLy8gTm9uIGlwIGFkZHJlc3MgZG9tYWlucy5cbiAgICAvLyBkb21haW4uY29tID0gKi5kb21haW4uY29tIE9SIGRvbWFpbi5jb21cbiAgICBjb25zdCByZSA9IG5ldyBSZWdFeHAoJ14oLitcXFxcLicgKyBlc2NhcGVkRG9tYWluUGF0dGVybiArICd8JyArIGVzY2FwZWREb21haW5QYXR0ZXJuICsgJykkJywgJ2knKTtcbiAgICByZXR1cm4gcmUudGVzdChob3N0bmFtZSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTEMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY29uc3QgTkVUV09SS19USU1FT1VUID0gbmV3IERlbGF5KDMwMDAwLCA2MDAwMCk7XG4vKipcbiAqIFJlc2V0IHVubG9hZGVkIEdBcGkgbW9kdWxlcy4gSWYgZ2FwaS5sb2FkIGZhaWxzIGR1ZSB0byBhIG5ldHdvcmsgZXJyb3IsXG4gKiBpdCB3aWxsIHN0b3Agd29ya2luZyBhZnRlciBhIHJldHJpYWwuIFRoaXMgaXMgYSBoYWNrIHRvIGZpeCB0aGlzIGlzc3VlLlxuICovXG5mdW5jdGlvbiByZXNldFVubG9hZGVkR2FwaU1vZHVsZXMoKSB7XG4gICAgLy8gQ2xlYXIgbGFzdCBmYWlsZWQgZ2FwaS5sb2FkIHN0YXRlIHRvIGZvcmNlIG5leHQgZ2FwaS5sb2FkIHRvIGZpcnN0XG4gICAgLy8gbG9hZCB0aGUgZmFpbGVkIGdhcGkuaWZyYW1lcyBtb2R1bGUuXG4gICAgLy8gR2V0IGdhcGl4LmJlYWNvbiBjb250ZXh0LlxuICAgIGNvbnN0IGJlYWNvbiA9IF93aW5kb3coKS5fX19qc2w7XG4gICAgLy8gR2V0IGN1cnJlbnQgaGludC5cbiAgICBpZiAoYmVhY29uPy5IKSB7XG4gICAgICAgIC8vIEdldCBnYXBpIGhpbnQuXG4gICAgICAgIGZvciAoY29uc3QgaGludCBvZiBPYmplY3Qua2V5cyhiZWFjb24uSCkpIHtcbiAgICAgICAgICAgIC8vIFJlcXVlc3RlZCBtb2R1bGVzLlxuICAgICAgICAgICAgYmVhY29uLkhbaGludF0uciA9IGJlYWNvbi5IW2hpbnRdLnIgfHwgW107XG4gICAgICAgICAgICAvLyBMb2FkZWQgbW9kdWxlcy5cbiAgICAgICAgICAgIGJlYWNvbi5IW2hpbnRdLkwgPSBiZWFjb24uSFtoaW50XS5MIHx8IFtdO1xuICAgICAgICAgICAgLy8gU2V0IHJlcXVlc3RlZCBtb2R1bGVzIHRvIGEgY29weSBvZiB0aGUgbG9hZGVkIG1vZHVsZXMuXG4gICAgICAgICAgICBiZWFjb24uSFtoaW50XS5yID0gWy4uLmJlYWNvbi5IW2hpbnRdLkxdO1xuICAgICAgICAgICAgLy8gQ2xlYXIgcGVuZGluZyBjYWxsYmFja3MuXG4gICAgICAgICAgICBpZiAoYmVhY29uLkNQKSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiZWFjb24uQ1AubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGFsbCBmYWlsZWQgcGVuZGluZyBjYWxsYmFja3MuXG4gICAgICAgICAgICAgICAgICAgIGJlYWNvbi5DUFtpXSA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gbG9hZEdhcGkoYXV0aCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIC8vIEZ1bmN0aW9uIHRvIHJ1biB3aGVuIGdhcGkubG9hZCBpcyByZWFkeS5cbiAgICAgICAgZnVuY3Rpb24gbG9hZEdhcGlJZnJhbWUoKSB7XG4gICAgICAgICAgICAvLyBUaGUgZGV2ZWxvcGVyIG1heSBoYXZlIHRyaWVkIHRvIHByZXZpb3VzbHkgcnVuIGdhcGkubG9hZCBhbmQgZmFpbGVkLlxuICAgICAgICAgICAgLy8gUnVuIHRoaXMgdG8gZml4IHRoYXQuXG4gICAgICAgICAgICByZXNldFVubG9hZGVkR2FwaU1vZHVsZXMoKTtcbiAgICAgICAgICAgIGdhcGkubG9hZCgnZ2FwaS5pZnJhbWVzJywge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZ2FwaS5pZnJhbWVzLmdldENvbnRleHQoKSk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvbnRpbWVvdXQ6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGFib3ZlIHJlc2V0IG1heSBiZSBzdWZmaWNpZW50LCBidXQgaGF2aW5nIHRoaXMgcmVzZXQgYWZ0ZXJcbiAgICAgICAgICAgICAgICAgICAgLy8gZmFpbHVyZSBlbnN1cmVzIHRoYXQgaWYgdGhlIGRldmVsb3BlciBjYWxscyBnYXBpLmxvYWQgYWZ0ZXIgdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbm5lY3Rpb24gaXMgcmUtZXN0YWJsaXNoZWQgYW5kIGJlZm9yZSBhbm90aGVyIGF0dGVtcHQgdG8gZW1iZWRcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGlmcmFtZSwgaXQgd291bGQgd29yayBhbmQgd291bGQgbm90IGJlIGJyb2tlbiBiZWNhdXNlIG9mIG91clxuICAgICAgICAgICAgICAgICAgICAvLyBmYWlsZWQgYXR0ZW1wdC5cbiAgICAgICAgICAgICAgICAgICAgLy8gVGltZW91dCB3aGVuIGdhcGkuaWZyYW1lcy5JZnJhbWUgbm90IGxvYWRlZC5cbiAgICAgICAgICAgICAgICAgICAgcmVzZXRVbmxvYWRlZEdhcGlNb2R1bGVzKCk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChfY3JlYXRlRXJyb3IoYXV0aCwgXCJuZXR3b3JrLXJlcXVlc3QtZmFpbGVkXCIgLyogQXV0aEVycm9yQ29kZS5ORVRXT1JLX1JFUVVFU1RfRkFJTEVEICovKSk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB0aW1lb3V0OiBORVRXT1JLX1RJTUVPVVQuZ2V0KClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChfd2luZG93KCkuZ2FwaT8uaWZyYW1lcz8uSWZyYW1lKSB7XG4gICAgICAgICAgICAvLyBJZiBnYXBpLmlmcmFtZXMuSWZyYW1lIGF2YWlsYWJsZSwgcmVzb2x2ZS5cbiAgICAgICAgICAgIHJlc29sdmUoZ2FwaS5pZnJhbWVzLmdldENvbnRleHQoKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoISFfd2luZG93KCkuZ2FwaT8ubG9hZCkge1xuICAgICAgICAgICAgLy8gR2FwaSBsb2FkZXIgcmVhZHksIGxvYWQgZ2FwaS5pZnJhbWVzLlxuICAgICAgICAgICAgbG9hZEdhcGlJZnJhbWUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIENyZWF0ZSBhIG5ldyBpZnJhbWUgY2FsbGJhY2sgd2hlbiB0aGlzIGlzIGNhbGxlZCBzbyBhcyBub3QgdG8gb3ZlcndyaXRlXG4gICAgICAgICAgICAvLyBhbnkgcHJldmlvdXMgZGVmaW5lZCBjYWxsYmFjay4gVGhpcyBoYXBwZW5zIGlmIHRoaXMgbWV0aG9kIGlzIGNhbGxlZFxuICAgICAgICAgICAgLy8gbXVsdGlwbGUgdGltZXMgaW4gcGFyYWxsZWwgYW5kIGNvdWxkIHJlc3VsdCBpbiB0aGUgbGF0ZXIgY2FsbGJhY2tcbiAgICAgICAgICAgIC8vIG92ZXJ3cml0aW5nIHRoZSBwcmV2aW91cyBvbmUuIFRoaXMgd291bGQgZW5kIHVwIHdpdGggYSBpZnJhbWVcbiAgICAgICAgICAgIC8vIHRpbWVvdXQuXG4gICAgICAgICAgICBjb25zdCBjYk5hbWUgPSBfZ2VuZXJhdGVDYWxsYmFja05hbWUoJ2lmcmFtZWZjYicpO1xuICAgICAgICAgICAgLy8gR0FwaSBsb2FkZXIgbm90IGF2YWlsYWJsZSwgZHluYW1pY2FsbHkgbG9hZCBwbGF0Zm9ybS5qcy5cbiAgICAgICAgICAgIF93aW5kb3coKVtjYk5hbWVdID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIEdBcGkgbG9hZGVyIHNob3VsZCBiZSByZWFkeS5cbiAgICAgICAgICAgICAgICBpZiAoISFnYXBpLmxvYWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9hZEdhcGlJZnJhbWUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEdhcGkgbG9hZGVyIGZhaWxlZCwgdGhyb3cgZXJyb3IuXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChfY3JlYXRlRXJyb3IoYXV0aCwgXCJuZXR3b3JrLXJlcXVlc3QtZmFpbGVkXCIgLyogQXV0aEVycm9yQ29kZS5ORVRXT1JLX1JFUVVFU1RfRkFJTEVEICovKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8vIExvYWQgR0FwaSBsb2FkZXIuXG4gICAgICAgICAgICByZXR1cm4gX2xvYWRKUyhgJHtfZ2FwaVNjcmlwdFVybCgpfT9vbmxvYWQ9JHtjYk5hbWV9YClcbiAgICAgICAgICAgICAgICAuY2F0Y2goZSA9PiByZWplY3QoZSkpO1xuICAgICAgICB9XG4gICAgfSkuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAvLyBSZXNldCBjYWNoZWQgcHJvbWlzZSB0byBhbGxvdyBmb3IgcmV0cmlhbC5cbiAgICAgICAgY2FjaGVkR0FwaUxvYWRlciA9IG51bGw7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgIH0pO1xufVxubGV0IGNhY2hlZEdBcGlMb2FkZXIgPSBudWxsO1xuZnVuY3Rpb24gX2xvYWRHYXBpKGF1dGgpIHtcbiAgICBjYWNoZWRHQXBpTG9hZGVyID0gY2FjaGVkR0FwaUxvYWRlciB8fCBsb2FkR2FwaShhdXRoKTtcbiAgICByZXR1cm4gY2FjaGVkR0FwaUxvYWRlcjtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jb25zdCBQSU5HX1RJTUVPVVQgPSBuZXcgRGVsYXkoNTAwMCwgMTUwMDApO1xuY29uc3QgSUZSQU1FX1BBVEggPSAnX18vYXV0aC9pZnJhbWUnO1xuY29uc3QgRU1VTEFURURfSUZSQU1FX1BBVEggPSAnZW11bGF0b3IvYXV0aC9pZnJhbWUnO1xuY29uc3QgSUZSQU1FX0FUVFJJQlVURVMgPSB7XG4gICAgc3R5bGU6IHtcbiAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICAgIHRvcDogJy0xMDBweCcsXG4gICAgICAgIHdpZHRoOiAnMXB4JyxcbiAgICAgICAgaGVpZ2h0OiAnMXB4J1xuICAgIH0sXG4gICAgJ2FyaWEtaGlkZGVuJzogJ3RydWUnLFxuICAgIHRhYmluZGV4OiAnLTEnXG59O1xuLy8gTWFwIGZyb20gYXBpSG9zdCB0byBlbmRwb2ludCBJRCBmb3IgcGFzc2luZyBpbnRvIGlmcmFtZS4gSW4gY3VycmVudCBTREssIGFwaUhvc3QgY2FuIGJlIHNldCB0b1xuLy8gYW55dGhpbmcgKG5vdCBmcm9tIGEgbGlzdCBvZiBlbmRwb2ludHMgd2l0aCBJRHMgYXMgaW4gbGVnYWN5KSwgc28gdGhpcyBpcyB0aGUgY2xvc2VzdCB3ZSBjYW4gZ2V0LlxuY29uc3QgRUlEX0ZST01fQVBJSE9TVCA9IG5ldyBNYXAoW1xuICAgIFtcImlkZW50aXR5dG9vbGtpdC5nb29nbGVhcGlzLmNvbVwiIC8qIERlZmF1bHRDb25maWcuQVBJX0hPU1QgKi8sICdwJ10sIC8vIHByb2R1Y3Rpb25cbiAgICBbJ3N0YWdpbmctaWRlbnRpdHl0b29sa2l0LnNhbmRib3guZ29vZ2xlYXBpcy5jb20nLCAncyddLCAvLyBzdGFnaW5nXG4gICAgWyd0ZXN0LWlkZW50aXR5dG9vbGtpdC5zYW5kYm94Lmdvb2dsZWFwaXMuY29tJywgJ3QnXSAvLyB0ZXN0XG5dKTtcbmZ1bmN0aW9uIGdldElmcmFtZVVybChhdXRoKSB7XG4gICAgY29uc3QgY29uZmlnID0gYXV0aC5jb25maWc7XG4gICAgX2Fzc2VydChjb25maWcuYXV0aERvbWFpbiwgYXV0aCwgXCJhdXRoLWRvbWFpbi1jb25maWctcmVxdWlyZWRcIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfQVVUSF9ET01BSU4gKi8pO1xuICAgIGNvbnN0IHVybCA9IGNvbmZpZy5lbXVsYXRvclxuICAgICAgICA/IF9lbXVsYXRvclVybChjb25maWcsIEVNVUxBVEVEX0lGUkFNRV9QQVRIKVxuICAgICAgICA6IGBodHRwczovLyR7YXV0aC5jb25maWcuYXV0aERvbWFpbn0vJHtJRlJBTUVfUEFUSH1gO1xuICAgIGNvbnN0IHBhcmFtcyA9IHtcbiAgICAgICAgYXBpS2V5OiBjb25maWcuYXBpS2V5LFxuICAgICAgICBhcHBOYW1lOiBhdXRoLm5hbWUsXG4gICAgICAgIHY6IFNES19WRVJTSU9OXG4gICAgfTtcbiAgICBjb25zdCBlaWQgPSBFSURfRlJPTV9BUElIT1NULmdldChhdXRoLmNvbmZpZy5hcGlIb3N0KTtcbiAgICBpZiAoZWlkKSB7XG4gICAgICAgIHBhcmFtcy5laWQgPSBlaWQ7XG4gICAgfVxuICAgIGNvbnN0IGZyYW1ld29ya3MgPSBhdXRoLl9nZXRGcmFtZXdvcmtzKCk7XG4gICAgaWYgKGZyYW1ld29ya3MubGVuZ3RoKSB7XG4gICAgICAgIHBhcmFtcy5mdyA9IGZyYW1ld29ya3Muam9pbignLCcpO1xuICAgIH1cbiAgICByZXR1cm4gYCR7dXJsfT8ke3F1ZXJ5c3RyaW5nKHBhcmFtcykuc2xpY2UoMSl9YDtcbn1cbmFzeW5jIGZ1bmN0aW9uIF9vcGVuSWZyYW1lKGF1dGgpIHtcbiAgICBjb25zdCBjb250ZXh0ID0gYXdhaXQgX2xvYWRHYXBpKGF1dGgpO1xuICAgIGNvbnN0IGdhcGkgPSBfd2luZG93KCkuZ2FwaTtcbiAgICBfYXNzZXJ0KGdhcGksIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICByZXR1cm4gY29udGV4dC5vcGVuKHtcbiAgICAgICAgd2hlcmU6IGRvY3VtZW50LmJvZHksXG4gICAgICAgIHVybDogZ2V0SWZyYW1lVXJsKGF1dGgpLFxuICAgICAgICBtZXNzYWdlSGFuZGxlcnNGaWx0ZXI6IGdhcGkuaWZyYW1lcy5DUk9TU19PUklHSU5fSUZSQU1FU19GSUxURVIsXG4gICAgICAgIGF0dHJpYnV0ZXM6IElGUkFNRV9BVFRSSUJVVEVTLFxuICAgICAgICBkb250Y2xlYXI6IHRydWVcbiAgICB9LCAoaWZyYW1lKSA9PiBuZXcgUHJvbWlzZShhc3luYyAocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGF3YWl0IGlmcmFtZS5yZXN0eWxlKHtcbiAgICAgICAgICAgIC8vIFByZXZlbnQgaWZyYW1lIGZyb20gY2xvc2luZyBvbiBtb3VzZSBvdXQuXG4gICAgICAgICAgICBzZXRIaWRlT25MZWF2ZTogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IG5ldHdvcmtFcnJvciA9IF9jcmVhdGVFcnJvcihhdXRoLCBcIm5ldHdvcmstcmVxdWVzdC1mYWlsZWRcIiAvKiBBdXRoRXJyb3JDb2RlLk5FVFdPUktfUkVRVUVTVF9GQUlMRUQgKi8pO1xuICAgICAgICAvLyBDb25maXJtIGlmcmFtZSBpcyBjb3JyZWN0bHkgbG9hZGVkLlxuICAgICAgICAvLyBUbyBmYWxsYmFjayBvbiBmYWlsdXJlLCBzZXQgYSB0aW1lb3V0LlxuICAgICAgICBjb25zdCBuZXR3b3JrRXJyb3JUaW1lciA9IF93aW5kb3coKS5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHJlamVjdChuZXR3b3JrRXJyb3IpO1xuICAgICAgICB9LCBQSU5HX1RJTUVPVVQuZ2V0KCkpO1xuICAgICAgICAvLyBDbGVhciB0aW1lciBhbmQgcmVzb2x2ZSBwZW5kaW5nIGlmcmFtZSByZWFkeSBwcm9taXNlLlxuICAgICAgICBmdW5jdGlvbiBjbGVhclRpbWVyQW5kUmVzb2x2ZSgpIHtcbiAgICAgICAgICAgIF93aW5kb3coKS5jbGVhclRpbWVvdXQobmV0d29ya0Vycm9yVGltZXIpO1xuICAgICAgICAgICAgcmVzb2x2ZShpZnJhbWUpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRoaXMgcmV0dXJucyBhbiBJVGhlbmFibGUuIEhvd2V2ZXIgdGhlIHJlamVjdCBwYXJ0IGRvZXMgbm90IGNhbGxcbiAgICAgICAgLy8gd2hlbiB0aGUgaWZyYW1lIGlzIG5vdCBsb2FkZWQuXG4gICAgICAgIGlmcmFtZS5waW5nKGNsZWFyVGltZXJBbmRSZXNvbHZlKS50aGVuKGNsZWFyVGltZXJBbmRSZXNvbHZlLCAoKSA9PiB7XG4gICAgICAgICAgICByZWplY3QobmV0d29ya0Vycm9yKTtcbiAgICAgICAgfSk7XG4gICAgfSkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IEJBU0VfUE9QVVBfT1BUSU9OUyA9IHtcbiAgICBsb2NhdGlvbjogJ3llcycsXG4gICAgcmVzaXphYmxlOiAneWVzJyxcbiAgICBzdGF0dXNiYXI6ICd5ZXMnLFxuICAgIHRvb2xiYXI6ICdubydcbn07XG5jb25zdCBERUZBVUxUX1dJRFRIID0gNTAwO1xuY29uc3QgREVGQVVMVF9IRUlHSFQgPSA2MDA7XG5jb25zdCBUQVJHRVRfQkxBTksgPSAnX2JsYW5rJztcbmNvbnN0IEZJUkVGT1hfRU1QVFlfVVJMID0gJ2h0dHA6Ly9sb2NhbGhvc3QnO1xuY2xhc3MgQXV0aFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcih3aW5kb3cpIHtcbiAgICAgICAgdGhpcy53aW5kb3cgPSB3aW5kb3c7XG4gICAgICAgIHRoaXMuYXNzb2NpYXRlZEV2ZW50ID0gbnVsbDtcbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIGlmICh0aGlzLndpbmRvdykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLndpbmRvdy5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHsgfVxuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gX29wZW4oYXV0aCwgdXJsLCBuYW1lLCB3aWR0aCA9IERFRkFVTFRfV0lEVEgsIGhlaWdodCA9IERFRkFVTFRfSEVJR0hUKSB7XG4gICAgY29uc3QgdG9wID0gTWF0aC5tYXgoKHdpbmRvdy5zY3JlZW4uYXZhaWxIZWlnaHQgLSBoZWlnaHQpIC8gMiwgMCkudG9TdHJpbmcoKTtcbiAgICBjb25zdCBsZWZ0ID0gTWF0aC5tYXgoKHdpbmRvdy5zY3JlZW4uYXZhaWxXaWR0aCAtIHdpZHRoKSAvIDIsIDApLnRvU3RyaW5nKCk7XG4gICAgbGV0IHRhcmdldCA9ICcnO1xuICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgIC4uLkJBU0VfUE9QVVBfT1BUSU9OUyxcbiAgICAgICAgd2lkdGg6IHdpZHRoLnRvU3RyaW5nKCksXG4gICAgICAgIGhlaWdodDogaGVpZ2h0LnRvU3RyaW5nKCksXG4gICAgICAgIHRvcCxcbiAgICAgICAgbGVmdFxuICAgIH07XG4gICAgLy8gQ2hyb21lIGlPUyA3IGFuZCA4IGlzIHJldHVybmluZyBhbiB1bmRlZmluZWQgcG9wdXAgd2luIHdoZW4gdGFyZ2V0IGlzXG4gICAgLy8gc3BlY2lmaWVkLCBldmVuIHRob3VnaCB0aGUgcG9wdXAgaXMgbm90IG5lY2Vzc2FyaWx5IGJsb2NrZWQuXG4gICAgY29uc3QgdWEgPSBnZXRVQSgpLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKG5hbWUpIHtcbiAgICAgICAgdGFyZ2V0ID0gX2lzQ2hyb21lSU9TKHVhKSA/IFRBUkdFVF9CTEFOSyA6IG5hbWU7XG4gICAgfVxuICAgIGlmIChfaXNGaXJlZm94KHVhKSkge1xuICAgICAgICAvLyBGaXJlZm94IGNvbXBsYWlucyB3aGVuIGludmFsaWQgVVJMcyBhcmUgcG9wcGVkIG91dC4gSGFja3kgd2F5IHRvIGJ5cGFzcy5cbiAgICAgICAgdXJsID0gdXJsIHx8IEZJUkVGT1hfRU1QVFlfVVJMO1xuICAgICAgICAvLyBGaXJlZm94IGRpc2FibGVzIGJ5IGRlZmF1bHQgc2Nyb2xsaW5nIG9uIHBvcHVwIHdpbmRvd3MsIHdoaWNoIGNhbiBjcmVhdGVcbiAgICAgICAgLy8gaXNzdWVzIHdoZW4gdGhlIHVzZXIgaGFzIG1hbnkgR29vZ2xlIGFjY291bnRzLCBmb3IgaW5zdGFuY2UuXG4gICAgICAgIG9wdGlvbnMuc2Nyb2xsYmFycyA9ICd5ZXMnO1xuICAgIH1cbiAgICBjb25zdCBvcHRpb25zU3RyaW5nID0gT2JqZWN0LmVudHJpZXMob3B0aW9ucykucmVkdWNlKChhY2N1bSwgW2tleSwgdmFsdWVdKSA9PiBgJHthY2N1bX0ke2tleX09JHt2YWx1ZX0sYCwgJycpO1xuICAgIGlmIChfaXNJT1NTdGFuZGFsb25lKHVhKSAmJiB0YXJnZXQgIT09ICdfc2VsZicpIHtcbiAgICAgICAgb3BlbkFzTmV3V2luZG93SU9TKHVybCB8fCAnJywgdGFyZ2V0KTtcbiAgICAgICAgcmV0dXJuIG5ldyBBdXRoUG9wdXAobnVsbCk7XG4gICAgfVxuICAgIC8vIGFib3V0OmJsYW5rIGdldHRpbmcgc2FuaXRpemVkIGNhdXNpbmcgYnJvd3NlcnMgbGlrZSBJRS9FZGdlIHRvIGRpc3BsYXlcbiAgICAvLyBicmllZiBlcnJvciBtZXNzYWdlIGJlZm9yZSByZWRpcmVjdGluZyB0byBoYW5kbGVyLlxuICAgIGNvbnN0IG5ld1dpbiA9IHdpbmRvdy5vcGVuKHVybCB8fCAnJywgdGFyZ2V0LCBvcHRpb25zU3RyaW5nKTtcbiAgICBfYXNzZXJ0KG5ld1dpbiwgYXV0aCwgXCJwb3B1cC1ibG9ja2VkXCIgLyogQXV0aEVycm9yQ29kZS5QT1BVUF9CTE9DS0VEICovKTtcbiAgICAvLyBGbGFreSBvbiBJRSBlZGdlLCBlbmNhcHN1bGF0ZSB3aXRoIGEgdHJ5IGFuZCBjYXRjaC5cbiAgICB0cnkge1xuICAgICAgICBuZXdXaW4uZm9jdXMoKTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHsgfVxuICAgIHJldHVybiBuZXcgQXV0aFBvcHVwKG5ld1dpbik7XG59XG5mdW5jdGlvbiBvcGVuQXNOZXdXaW5kb3dJT1ModXJsLCB0YXJnZXQpIHtcbiAgICBjb25zdCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICBlbC5ocmVmID0gdXJsO1xuICAgIGVsLnRhcmdldCA9IHRhcmdldDtcbiAgICBjb25zdCBjbGljayA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdNb3VzZUV2ZW50Jyk7XG4gICAgY2xpY2suaW5pdE1vdXNlRXZlbnQoJ2NsaWNrJywgdHJ1ZSwgdHJ1ZSwgd2luZG93LCAxLCAwLCAwLCAwLCAwLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgMSwgbnVsbCk7XG4gICAgZWwuZGlzcGF0Y2hFdmVudChjbGljayk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIxIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFVSTCBmb3IgQXV0aGVudGljYXRpb24gd2lkZ2V0IHdoaWNoIHdpbGwgaW5pdGlhdGUgdGhlIE9BdXRoIGhhbmRzaGFrZVxuICpcbiAqIEBpbnRlcm5hbFxuICovXG5jb25zdCBXSURHRVRfUEFUSCA9ICdfXy9hdXRoL2hhbmRsZXInO1xuLyoqXG4gKiBVUkwgZm9yIGVtdWxhdGVkIGVudmlyb25tZW50XG4gKlxuICogQGludGVybmFsXG4gKi9cbmNvbnN0IEVNVUxBVE9SX1dJREdFVF9QQVRIID0gJ2VtdWxhdG9yL2F1dGgvaGFuZGxlcic7XG4vKipcbiAqIEZyYWdtZW50IG5hbWUgZm9yIHRoZSBBcHAgQ2hlY2sgdG9rZW4gdGhhdCBnZXRzIHBhc3NlZCB0byB0aGUgd2lkZ2V0XG4gKlxuICogQGludGVybmFsXG4gKi9cbmNvbnN0IEZJUkVCQVNFX0FQUF9DSEVDS19GUkFHTUVOVF9JRCA9IGVuY29kZVVSSUNvbXBvbmVudCgnZmFjJyk7XG5hc3luYyBmdW5jdGlvbiBfZ2V0UmVkaXJlY3RVcmwoYXV0aCwgcHJvdmlkZXIsIGF1dGhUeXBlLCByZWRpcmVjdFVybCwgZXZlbnRJZCwgYWRkaXRpb25hbFBhcmFtcykge1xuICAgIF9hc3NlcnQoYXV0aC5jb25maWcuYXV0aERvbWFpbiwgYXV0aCwgXCJhdXRoLWRvbWFpbi1jb25maWctcmVxdWlyZWRcIiAvKiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfQVVUSF9ET01BSU4gKi8pO1xuICAgIF9hc3NlcnQoYXV0aC5jb25maWcuYXBpS2V5LCBhdXRoLCBcImludmFsaWQtYXBpLWtleVwiIC8qIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9BUElfS0VZICovKTtcbiAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICAgIGFwaUtleTogYXV0aC5jb25maWcuYXBpS2V5LFxuICAgICAgICBhcHBOYW1lOiBhdXRoLm5hbWUsXG4gICAgICAgIGF1dGhUeXBlLFxuICAgICAgICByZWRpcmVjdFVybCxcbiAgICAgICAgdjogU0RLX1ZFUlNJT04sXG4gICAgICAgIGV2ZW50SWRcbiAgICB9O1xuICAgIGlmIChwcm92aWRlciBpbnN0YW5jZW9mIEZlZGVyYXRlZEF1dGhQcm92aWRlcikge1xuICAgICAgICBwcm92aWRlci5zZXREZWZhdWx0TGFuZ3VhZ2UoYXV0aC5sYW5ndWFnZUNvZGUpO1xuICAgICAgICBwYXJhbXMucHJvdmlkZXJJZCA9IHByb3ZpZGVyLnByb3ZpZGVySWQgfHwgJyc7XG4gICAgICAgIGlmICghaXNFbXB0eShwcm92aWRlci5nZXRDdXN0b21QYXJhbWV0ZXJzKCkpKSB7XG4gICAgICAgICAgICBwYXJhbXMuY3VzdG9tUGFyYW1ldGVycyA9IEpTT04uc3RyaW5naWZ5KHByb3ZpZGVyLmdldEN1c3RvbVBhcmFtZXRlcnMoKSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gVE9ETyBzZXQgYWRkaXRpb25hbFBhcmFtcyBmcm9tIHRoZSBwcm92aWRlciBhcyB3ZWxsP1xuICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhhZGRpdGlvbmFsUGFyYW1zIHx8IHt9KSkge1xuICAgICAgICAgICAgcGFyYW1zW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAocHJvdmlkZXIgaW5zdGFuY2VvZiBCYXNlT0F1dGhQcm92aWRlcikge1xuICAgICAgICBjb25zdCBzY29wZXMgPSBwcm92aWRlci5nZXRTY29wZXMoKS5maWx0ZXIoc2NvcGUgPT4gc2NvcGUgIT09ICcnKTtcbiAgICAgICAgaWYgKHNjb3Blcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBwYXJhbXMuc2NvcGVzID0gc2NvcGVzLmpvaW4oJywnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoYXV0aC50ZW5hbnRJZCkge1xuICAgICAgICBwYXJhbXMudGlkID0gYXV0aC50ZW5hbnRJZDtcbiAgICB9XG4gICAgLy8gVE9ETzogbWF5YmUgc2V0IGVpZCBhcyBlbmRwb2ludElkXG4gICAgLy8gVE9ETzogbWF5YmUgc2V0IGZ3IGFzIEZyYW1ld29ya3Muam9pbihcIixcIilcbiAgICBjb25zdCBwYXJhbXNEaWN0ID0gcGFyYW1zO1xuICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKHBhcmFtc0RpY3QpKSB7XG4gICAgICAgIGlmIChwYXJhbXNEaWN0W2tleV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgZGVsZXRlIHBhcmFtc0RpY3Rba2V5XTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBTZXRzIHRoZSBBcHAgQ2hlY2sgdG9rZW4gdG8gcGFzcyB0byB0aGUgd2lkZ2V0XG4gICAgY29uc3QgYXBwQ2hlY2tUb2tlbiA9IGF3YWl0IGF1dGguX2dldEFwcENoZWNrVG9rZW4oKTtcbiAgICBjb25zdCBhcHBDaGVja1Rva2VuRnJhZ21lbnQgPSBhcHBDaGVja1Rva2VuXG4gICAgICAgID8gYCMke0ZJUkVCQVNFX0FQUF9DSEVDS19GUkFHTUVOVF9JRH09JHtlbmNvZGVVUklDb21wb25lbnQoYXBwQ2hlY2tUb2tlbil9YFxuICAgICAgICA6ICcnO1xuICAgIC8vIFN0YXJ0IGF0IGluZGV4IDEgdG8gc2tpcCB0aGUgbGVhZGluZyAnJicgaW4gdGhlIHF1ZXJ5IHN0cmluZ1xuICAgIHJldHVybiBgJHtnZXRIYW5kbGVyQmFzZShhdXRoKX0/JHtxdWVyeXN0cmluZyhwYXJhbXNEaWN0KS5zbGljZSgxKX0ke2FwcENoZWNrVG9rZW5GcmFnbWVudH1gO1xufVxuZnVuY3Rpb24gZ2V0SGFuZGxlckJhc2UoeyBjb25maWcgfSkge1xuICAgIGlmICghY29uZmlnLmVtdWxhdG9yKSB7XG4gICAgICAgIHJldHVybiBgaHR0cHM6Ly8ke2NvbmZpZy5hdXRoRG9tYWlufS8ke1dJREdFVF9QQVRIfWA7XG4gICAgfVxuICAgIHJldHVybiBfZW11bGF0b3JVcmwoY29uZmlnLCBFTVVMQVRPUl9XSURHRVRfUEFUSCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFRoZSBzcGVjaWFsIHdlYiBzdG9yYWdlIGV2ZW50XG4gKlxuICovXG5jb25zdCBXRUJfU1RPUkFHRV9TVVBQT1JUX0tFWSA9ICd3ZWJTdG9yYWdlU3VwcG9ydCc7XG5jbGFzcyBCcm93c2VyUG9wdXBSZWRpcmVjdFJlc29sdmVyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5ldmVudE1hbmFnZXJzID0ge307XG4gICAgICAgIHRoaXMuaWZyYW1lcyA9IHt9O1xuICAgICAgICB0aGlzLm9yaWdpblZhbGlkYXRpb25Qcm9taXNlcyA9IHt9O1xuICAgICAgICB0aGlzLl9yZWRpcmVjdFBlcnNpc3RlbmNlID0gYnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZTtcbiAgICAgICAgdGhpcy5fY29tcGxldGVSZWRpcmVjdEZuID0gX2dldFJlZGlyZWN0UmVzdWx0O1xuICAgICAgICB0aGlzLl9vdmVycmlkZVJlZGlyZWN0UmVzdWx0ID0gX292ZXJyaWRlUmVkaXJlY3RSZXN1bHQ7XG4gICAgfVxuICAgIC8vIFdyYXBwaW5nIGluIGFzeW5jIGV2ZW4gdGhvdWdoIHdlIGRvbid0IGF3YWl0IGFueXdoZXJlIGluIG9yZGVyXG4gICAgLy8gdG8gbWFrZSBzdXJlIGVycm9ycyBhcmUgcmFpc2VkIGFzIHByb21pc2UgcmVqZWN0aW9uc1xuICAgIGFzeW5jIF9vcGVuUG9wdXAoYXV0aCwgcHJvdmlkZXIsIGF1dGhUeXBlLCBldmVudElkKSB7XG4gICAgICAgIGRlYnVnQXNzZXJ0KHRoaXMuZXZlbnRNYW5hZ2Vyc1thdXRoLl9rZXkoKV0/Lm1hbmFnZXIsICdfaW5pdGlhbGl6ZSgpIG5vdCBjYWxsZWQgYmVmb3JlIF9vcGVuUG9wdXAoKScpO1xuICAgICAgICBjb25zdCB1cmwgPSBhd2FpdCBfZ2V0UmVkaXJlY3RVcmwoYXV0aCwgcHJvdmlkZXIsIGF1dGhUeXBlLCBfZ2V0Q3VycmVudFVybCgpLCBldmVudElkKTtcbiAgICAgICAgcmV0dXJuIF9vcGVuKGF1dGgsIHVybCwgX2dlbmVyYXRlRXZlbnRJZCgpKTtcbiAgICB9XG4gICAgYXN5bmMgX29wZW5SZWRpcmVjdChhdXRoLCBwcm92aWRlciwgYXV0aFR5cGUsIGV2ZW50SWQpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5fb3JpZ2luVmFsaWRhdGlvbihhdXRoKTtcbiAgICAgICAgY29uc3QgdXJsID0gYXdhaXQgX2dldFJlZGlyZWN0VXJsKGF1dGgsIHByb3ZpZGVyLCBhdXRoVHlwZSwgX2dldEN1cnJlbnRVcmwoKSwgZXZlbnRJZCk7XG4gICAgICAgIF9zZXRXaW5kb3dMb2NhdGlvbih1cmwpO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKCkgPT4geyB9KTtcbiAgICB9XG4gICAgX2luaXRpYWxpemUoYXV0aCkge1xuICAgICAgICBjb25zdCBrZXkgPSBhdXRoLl9rZXkoKTtcbiAgICAgICAgaWYgKHRoaXMuZXZlbnRNYW5hZ2Vyc1trZXldKSB7XG4gICAgICAgICAgICBjb25zdCB7IG1hbmFnZXIsIHByb21pc2UgfSA9IHRoaXMuZXZlbnRNYW5hZ2Vyc1trZXldO1xuICAgICAgICAgICAgaWYgKG1hbmFnZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG1hbmFnZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZGVidWdBc3NlcnQocHJvbWlzZSwgJ0lmIG1hbmFnZXIgaXMgbm90IHNldCwgcHJvbWlzZSBzaG91bGQgYmUnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwcm9taXNlID0gdGhpcy5pbml0QW5kR2V0TWFuYWdlcihhdXRoKTtcbiAgICAgICAgdGhpcy5ldmVudE1hbmFnZXJzW2tleV0gPSB7IHByb21pc2UgfTtcbiAgICAgICAgLy8gSWYgdGhlIHByb21pc2UgaXMgcmVqZWN0ZWQsIHRoZSBrZXkgc2hvdWxkIGJlIHJlbW92ZWQgc28gdGhhdCB0aGVcbiAgICAgICAgLy8gb3BlcmF0aW9uIGNhbiBiZSByZXRyaWVkIGxhdGVyLlxuICAgICAgICBwcm9taXNlLmNhdGNoKCgpID0+IHtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmV2ZW50TWFuYWdlcnNba2V5XTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH1cbiAgICBhc3luYyBpbml0QW5kR2V0TWFuYWdlcihhdXRoKSB7XG4gICAgICAgIGNvbnN0IGlmcmFtZSA9IGF3YWl0IF9vcGVuSWZyYW1lKGF1dGgpO1xuICAgICAgICBjb25zdCBtYW5hZ2VyID0gbmV3IEF1dGhFdmVudE1hbmFnZXIoYXV0aCk7XG4gICAgICAgIGlmcmFtZS5yZWdpc3RlcignYXV0aEV2ZW50JywgKGlmcmFtZUV2ZW50KSA9PiB7XG4gICAgICAgICAgICBfYXNzZXJ0KGlmcmFtZUV2ZW50Py5hdXRoRXZlbnQsIGF1dGgsIFwiaW52YWxpZC1hdXRoLWV2ZW50XCIgLyogQXV0aEVycm9yQ29kZS5JTlZBTElEX0FVVEhfRVZFTlQgKi8pO1xuICAgICAgICAgICAgLy8gVE9ETzogQ29uc2lkZXIgc3BsaXR0aW5nIHJlZGlyZWN0IGFuZCBwb3B1cCBldmVudHMgZWFybGllciBvblxuICAgICAgICAgICAgY29uc3QgaGFuZGxlZCA9IG1hbmFnZXIub25FdmVudChpZnJhbWVFdmVudC5hdXRoRXZlbnQpO1xuICAgICAgICAgICAgcmV0dXJuIHsgc3RhdHVzOiBoYW5kbGVkID8gXCJBQ0tcIiAvKiBHYXBpT3V0Y29tZS5BQ0sgKi8gOiBcIkVSUk9SXCIgLyogR2FwaU91dGNvbWUuRVJST1IgKi8gfTtcbiAgICAgICAgfSwgZ2FwaS5pZnJhbWVzLkNST1NTX09SSUdJTl9JRlJBTUVTX0ZJTFRFUik7XG4gICAgICAgIHRoaXMuZXZlbnRNYW5hZ2Vyc1thdXRoLl9rZXkoKV0gPSB7IG1hbmFnZXIgfTtcbiAgICAgICAgdGhpcy5pZnJhbWVzW2F1dGguX2tleSgpXSA9IGlmcmFtZTtcbiAgICAgICAgcmV0dXJuIG1hbmFnZXI7XG4gICAgfVxuICAgIF9pc0lmcmFtZVdlYlN0b3JhZ2VTdXBwb3J0ZWQoYXV0aCwgY2IpIHtcbiAgICAgICAgY29uc3QgaWZyYW1lID0gdGhpcy5pZnJhbWVzW2F1dGguX2tleSgpXTtcbiAgICAgICAgaWZyYW1lLnNlbmQoV0VCX1NUT1JBR0VfU1VQUE9SVF9LRVksIHsgdHlwZTogV0VCX1NUT1JBR0VfU1VQUE9SVF9LRVkgfSwgcmVzdWx0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGlzU3VwcG9ydGVkID0gcmVzdWx0Py5bMF0/LltXRUJfU1RPUkFHRV9TVVBQT1JUX0tFWV07XG4gICAgICAgICAgICBpZiAoaXNTdXBwb3J0ZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNiKCEhaXNTdXBwb3J0ZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX2ZhaWwoYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IgKi8pO1xuICAgICAgICB9LCBnYXBpLmlmcmFtZXMuQ1JPU1NfT1JJR0lOX0lGUkFNRVNfRklMVEVSKTtcbiAgICB9XG4gICAgX29yaWdpblZhbGlkYXRpb24oYXV0aCkge1xuICAgICAgICBjb25zdCBrZXkgPSBhdXRoLl9rZXkoKTtcbiAgICAgICAgaWYgKCF0aGlzLm9yaWdpblZhbGlkYXRpb25Qcm9taXNlc1trZXldKSB7XG4gICAgICAgICAgICB0aGlzLm9yaWdpblZhbGlkYXRpb25Qcm9taXNlc1trZXldID0gX3ZhbGlkYXRlT3JpZ2luKGF1dGgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLm9yaWdpblZhbGlkYXRpb25Qcm9taXNlc1trZXldO1xuICAgIH1cbiAgICBnZXQgX3Nob3VsZEluaXRQcm9hY3RpdmVseSgpIHtcbiAgICAgICAgLy8gTW9iaWxlIGJyb3dzZXJzIGFuZCBTYWZhcmkgbmVlZCB0byBvcHRpbWlzdGljYWxseSBpbml0aWFsaXplXG4gICAgICAgIHJldHVybiBfaXNNb2JpbGVCcm93c2VyKCkgfHwgX2lzU2FmYXJpKCkgfHwgX2lzSU9TKCk7XG4gICAgfVxufVxuLyoqXG4gKiBBbiBpbXBsZW1lbnRhdGlvbiBvZiB7QGxpbmsgUG9wdXBSZWRpcmVjdFJlc29sdmVyfSBzdWl0YWJsZSBmb3IgYnJvd3NlclxuICogYmFzZWQgYXBwbGljYXRpb25zLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUaGlzIG1ldGhvZCBkb2VzIG5vdCB3b3JrIGluIGEgTm9kZS5qcyBlbnZpcm9ubWVudC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmNvbnN0IGJyb3dzZXJQb3B1cFJlZGlyZWN0UmVzb2x2ZXIgPSBCcm93c2VyUG9wdXBSZWRpcmVjdFJlc29sdmVyO1xuXG5jbGFzcyBNdWx0aUZhY3RvckFzc2VydGlvbkltcGwge1xuICAgIGNvbnN0cnVjdG9yKGZhY3RvcklkKSB7XG4gICAgICAgIHRoaXMuZmFjdG9ySWQgPSBmYWN0b3JJZDtcbiAgICB9XG4gICAgX3Byb2Nlc3MoYXV0aCwgc2Vzc2lvbiwgZGlzcGxheU5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChzZXNzaW9uLnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJlbnJvbGxcIiAvKiBNdWx0aUZhY3RvclNlc3Npb25UeXBlLkVOUk9MTCAqLzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZmluYWxpemVFbnJvbGwoYXV0aCwgc2Vzc2lvbi5jcmVkZW50aWFsLCBkaXNwbGF5TmFtZSk7XG4gICAgICAgICAgICBjYXNlIFwic2lnbmluXCIgLyogTXVsdGlGYWN0b3JTZXNzaW9uVHlwZS5TSUdOX0lOICovOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9maW5hbGl6ZVNpZ25JbihhdXRoLCBzZXNzaW9uLmNyZWRlbnRpYWwpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVidWdGYWlsKCd1bmV4cGVjdGVkIE11bHRpRmFjdG9yU2Vzc2lvblR5cGUnKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLyoqXG4gKiB7QGluaGVyaXRkb2MgUGhvbmVNdWx0aUZhY3RvckFzc2VydGlvbn1cbiAqXG4gKiBAcHVibGljXG4gKi9cbmNsYXNzIFBob25lTXVsdGlGYWN0b3JBc3NlcnRpb25JbXBsIGV4dGVuZHMgTXVsdGlGYWN0b3JBc3NlcnRpb25JbXBsIHtcbiAgICBjb25zdHJ1Y3RvcihjcmVkZW50aWFsKSB7XG4gICAgICAgIHN1cGVyKFwicGhvbmVcIiAvKiBGYWN0b3JJZC5QSE9ORSAqLyk7XG4gICAgICAgIHRoaXMuY3JlZGVudGlhbCA9IGNyZWRlbnRpYWw7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBzdGF0aWMgX2Zyb21DcmVkZW50aWFsKGNyZWRlbnRpYWwpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQaG9uZU11bHRpRmFjdG9yQXNzZXJ0aW9uSW1wbChjcmVkZW50aWFsKTtcbiAgICB9XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIF9maW5hbGl6ZUVucm9sbChhdXRoLCBpZFRva2VuLCBkaXNwbGF5TmFtZSkge1xuICAgICAgICByZXR1cm4gZmluYWxpemVFbnJvbGxQaG9uZU1mYShhdXRoLCB7XG4gICAgICAgICAgICBpZFRva2VuLFxuICAgICAgICAgICAgZGlzcGxheU5hbWUsXG4gICAgICAgICAgICBwaG9uZVZlcmlmaWNhdGlvbkluZm86IHRoaXMuY3JlZGVudGlhbC5fbWFrZVZlcmlmaWNhdGlvblJlcXVlc3QoKVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIF9maW5hbGl6ZVNpZ25JbihhdXRoLCBtZmFQZW5kaW5nQ3JlZGVudGlhbCkge1xuICAgICAgICByZXR1cm4gZmluYWxpemVTaWduSW5QaG9uZU1mYShhdXRoLCB7XG4gICAgICAgICAgICBtZmFQZW5kaW5nQ3JlZGVudGlhbCxcbiAgICAgICAgICAgIHBob25lVmVyaWZpY2F0aW9uSW5mbzogdGhpcy5jcmVkZW50aWFsLl9tYWtlVmVyaWZpY2F0aW9uUmVxdWVzdCgpXG4gICAgICAgIH0pO1xuICAgIH1cbn1cbi8qKlxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcgYSB7QGxpbmsgUGhvbmVNdWx0aUZhY3RvckFzc2VydGlvbn0uXG4gKlxuICogQHB1YmxpY1xuICovXG5jbGFzcyBQaG9uZU11bHRpRmFjdG9yR2VuZXJhdG9yIHtcbiAgICBjb25zdHJ1Y3RvcigpIHsgfVxuICAgIC8qKlxuICAgICAqIFByb3ZpZGVzIGEge0BsaW5rIFBob25lTXVsdGlGYWN0b3JBc3NlcnRpb259IHRvIGNvbmZpcm0gb3duZXJzaGlwIG9mIHRoZSBwaG9uZSBzZWNvbmQgZmFjdG9yLlxuICAgICAqXG4gICAgICogQHJlbWFya3NcbiAgICAgKiBUaGlzIG1ldGhvZCBkb2VzIG5vdCB3b3JrIGluIGEgTm9kZS5qcyBlbnZpcm9ubWVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwaG9uZUF1dGhDcmVkZW50aWFsIC0gQSBjcmVkZW50aWFsIHByb3ZpZGVkIGJ5IHtAbGluayBQaG9uZUF1dGhQcm92aWRlci5jcmVkZW50aWFsfS5cbiAgICAgKiBAcmV0dXJucyBBIHtAbGluayBQaG9uZU11bHRpRmFjdG9yQXNzZXJ0aW9ufSB3aGljaCBjYW4gYmUgdXNlZCB3aXRoXG4gICAgICoge0BsaW5rIE11bHRpRmFjdG9yUmVzb2x2ZXIucmVzb2x2ZVNpZ25Jbn1cbiAgICAgKi9cbiAgICBzdGF0aWMgYXNzZXJ0aW9uKGNyZWRlbnRpYWwpIHtcbiAgICAgICAgcmV0dXJuIFBob25lTXVsdGlGYWN0b3JBc3NlcnRpb25JbXBsLl9mcm9tQ3JlZGVudGlhbChjcmVkZW50aWFsKTtcbiAgICB9XG59XG4vKipcbiAqIFRoZSBpZGVudGlmaWVyIG9mIHRoZSBwaG9uZSBzZWNvbmQgZmFjdG9yOiBgcGhvbmVgLlxuICovXG5QaG9uZU11bHRpRmFjdG9yR2VuZXJhdG9yLkZBQ1RPUl9JRCA9ICdwaG9uZSc7XG5cbi8qKlxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcgYSB7QGxpbmsgVG90cE11bHRpRmFjdG9yQXNzZXJ0aW9ufS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmNsYXNzIFRvdHBNdWx0aUZhY3RvckdlbmVyYXRvciB7XG4gICAgLyoqXG4gICAgICogUHJvdmlkZXMgYSB7QGxpbmsgVG90cE11bHRpRmFjdG9yQXNzZXJ0aW9ufSB0byBjb25maXJtIG93bmVyc2hpcCBvZlxuICAgICAqIHRoZSBUT1RQICh0aW1lLWJhc2VkIG9uZS10aW1lIHBhc3N3b3JkKSBzZWNvbmQgZmFjdG9yLlxuICAgICAqIFRoaXMgYXNzZXJ0aW9uIGlzIHVzZWQgdG8gY29tcGxldGUgZW5yb2xsbWVudCBpbiBUT1RQIHNlY29uZCBmYWN0b3IuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2VjcmV0IEEge0BsaW5rIFRvdHBTZWNyZXR9IGNvbnRhaW5pbmcgdGhlIHNoYXJlZCBzZWNyZXQga2V5IGFuZCBvdGhlciBUT1RQIHBhcmFtZXRlcnMuXG4gICAgICogQHBhcmFtIG9uZVRpbWVQYXNzd29yZCBPbmUtdGltZSBwYXNzd29yZCBmcm9tIFRPVFAgQXBwLlxuICAgICAqIEByZXR1cm5zIEEge0BsaW5rIFRvdHBNdWx0aUZhY3RvckFzc2VydGlvbn0gd2hpY2ggY2FuIGJlIHVzZWQgd2l0aFxuICAgICAqIHtAbGluayBNdWx0aUZhY3RvclVzZXIuZW5yb2xsfS5cbiAgICAgKi9cbiAgICBzdGF0aWMgYXNzZXJ0aW9uRm9yRW5yb2xsbWVudChzZWNyZXQsIG9uZVRpbWVQYXNzd29yZCkge1xuICAgICAgICByZXR1cm4gVG90cE11bHRpRmFjdG9yQXNzZXJ0aW9uSW1wbC5fZnJvbVNlY3JldChzZWNyZXQsIG9uZVRpbWVQYXNzd29yZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFByb3ZpZGVzIGEge0BsaW5rIFRvdHBNdWx0aUZhY3RvckFzc2VydGlvbn0gdG8gY29uZmlybSBvd25lcnNoaXAgb2YgdGhlIFRPVFAgc2Vjb25kIGZhY3Rvci5cbiAgICAgKiBUaGlzIGFzc2VydGlvbiBpcyB1c2VkIHRvIGNvbXBsZXRlIHNpZ25JbiB3aXRoIFRPVFAgYXMgdGhlIHNlY29uZCBmYWN0b3IuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZW5yb2xsbWVudElkIGlkZW50aWZpZXMgdGhlIGVucm9sbGVkIFRPVFAgc2Vjb25kIGZhY3Rvci5cbiAgICAgKiBAcGFyYW0gb25lVGltZVBhc3N3b3JkIE9uZS10aW1lIHBhc3N3b3JkIGZyb20gVE9UUCBBcHAuXG4gICAgICogQHJldHVybnMgQSB7QGxpbmsgVG90cE11bHRpRmFjdG9yQXNzZXJ0aW9ufSB3aGljaCBjYW4gYmUgdXNlZCB3aXRoXG4gICAgICoge0BsaW5rIE11bHRpRmFjdG9yUmVzb2x2ZXIucmVzb2x2ZVNpZ25Jbn0uXG4gICAgICovXG4gICAgc3RhdGljIGFzc2VydGlvbkZvclNpZ25JbihlbnJvbGxtZW50SWQsIG9uZVRpbWVQYXNzd29yZCkge1xuICAgICAgICByZXR1cm4gVG90cE11bHRpRmFjdG9yQXNzZXJ0aW9uSW1wbC5fZnJvbUVucm9sbG1lbnRJZChlbnJvbGxtZW50SWQsIG9uZVRpbWVQYXNzd29yZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBwcm9taXNlIHRvIHtAbGluayBUb3RwU2VjcmV0fSB3aGljaCBjb250YWlucyB0aGUgVE9UUCBzaGFyZWQgc2VjcmV0IGtleSBhbmQgb3RoZXIgcGFyYW1ldGVycy5cbiAgICAgKiBDcmVhdGVzIGEgVE9UUCBzZWNyZXQgYXMgcGFydCBvZiBlbnJvbGxpbmcgYSBUT1RQIHNlY29uZCBmYWN0b3IuXG4gICAgICogVXNlZCBmb3IgZ2VuZXJhdGluZyBhIFFSIGNvZGUgVVJMIG9yIGlucHV0dGluZyBpbnRvIGEgVE9UUCBhcHAuXG4gICAgICogVGhpcyBtZXRob2QgdXNlcyB0aGUgYXV0aCBpbnN0YW5jZSBjb3JyZXNwb25kaW5nIHRvIHRoZSB1c2VyIGluIHRoZSBtdWx0aUZhY3RvclNlc3Npb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2Vzc2lvbiBUaGUge0BsaW5rIE11bHRpRmFjdG9yU2Vzc2lvbn0gdGhhdCB0aGUgdXNlciBpcyBwYXJ0IG9mLlxuICAgICAqIEByZXR1cm5zIEEgcHJvbWlzZSB0byB7QGxpbmsgVG90cFNlY3JldH0uXG4gICAgICovXG4gICAgc3RhdGljIGFzeW5jIGdlbmVyYXRlU2VjcmV0KHNlc3Npb24pIHtcbiAgICAgICAgY29uc3QgbWZhU2Vzc2lvbiA9IHNlc3Npb247XG4gICAgICAgIF9hc3NlcnQodHlwZW9mIG1mYVNlc3Npb24udXNlcj8uYXV0aCAhPT0gJ3VuZGVmaW5lZCcsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SICovKTtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzdGFydEVucm9sbFRvdHBNZmEobWZhU2Vzc2lvbi51c2VyLmF1dGgsIHtcbiAgICAgICAgICAgIGlkVG9rZW46IG1mYVNlc3Npb24uY3JlZGVudGlhbCxcbiAgICAgICAgICAgIHRvdHBFbnJvbGxtZW50SW5mbzoge31cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBUb3RwU2VjcmV0Ll9mcm9tU3RhcnRUb3RwTWZhRW5yb2xsbWVudFJlc3BvbnNlKHJlc3BvbnNlLCBtZmFTZXNzaW9uLnVzZXIuYXV0aCk7XG4gICAgfVxufVxuLyoqXG4gKiBUaGUgaWRlbnRpZmllciBvZiB0aGUgVE9UUCBzZWNvbmQgZmFjdG9yOiBgdG90cGAuXG4gKi9cblRvdHBNdWx0aUZhY3RvckdlbmVyYXRvci5GQUNUT1JfSUQgPSBcInRvdHBcIiAvKiBGYWN0b3JJZC5UT1RQICovO1xuY2xhc3MgVG90cE11bHRpRmFjdG9yQXNzZXJ0aW9uSW1wbCBleHRlbmRzIE11bHRpRmFjdG9yQXNzZXJ0aW9uSW1wbCB7XG4gICAgY29uc3RydWN0b3Iob3RwLCBlbnJvbGxtZW50SWQsIHNlY3JldCkge1xuICAgICAgICBzdXBlcihcInRvdHBcIiAvKiBGYWN0b3JJZC5UT1RQICovKTtcbiAgICAgICAgdGhpcy5vdHAgPSBvdHA7XG4gICAgICAgIHRoaXMuZW5yb2xsbWVudElkID0gZW5yb2xsbWVudElkO1xuICAgICAgICB0aGlzLnNlY3JldCA9IHNlY3JldDtcbiAgICB9XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIHN0YXRpYyBfZnJvbVNlY3JldChzZWNyZXQsIG90cCkge1xuICAgICAgICByZXR1cm4gbmV3IFRvdHBNdWx0aUZhY3RvckFzc2VydGlvbkltcGwob3RwLCB1bmRlZmluZWQsIHNlY3JldCk7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBzdGF0aWMgX2Zyb21FbnJvbGxtZW50SWQoZW5yb2xsbWVudElkLCBvdHApIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUb3RwTXVsdGlGYWN0b3JBc3NlcnRpb25JbXBsKG90cCwgZW5yb2xsbWVudElkKTtcbiAgICB9XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIGFzeW5jIF9maW5hbGl6ZUVucm9sbChhdXRoLCBpZFRva2VuLCBkaXNwbGF5TmFtZSkge1xuICAgICAgICBfYXNzZXJ0KHR5cGVvZiB0aGlzLnNlY3JldCAhPT0gJ3VuZGVmaW5lZCcsIGF1dGgsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SICovKTtcbiAgICAgICAgcmV0dXJuIGZpbmFsaXplRW5yb2xsVG90cE1mYShhdXRoLCB7XG4gICAgICAgICAgICBpZFRva2VuLFxuICAgICAgICAgICAgZGlzcGxheU5hbWUsXG4gICAgICAgICAgICB0b3RwVmVyaWZpY2F0aW9uSW5mbzogdGhpcy5zZWNyZXQuX21ha2VUb3RwVmVyaWZpY2F0aW9uSW5mbyh0aGlzLm90cClcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICBhc3luYyBfZmluYWxpemVTaWduSW4oYXV0aCwgbWZhUGVuZGluZ0NyZWRlbnRpYWwpIHtcbiAgICAgICAgX2Fzc2VydCh0aGlzLmVucm9sbG1lbnRJZCAhPT0gdW5kZWZpbmVkICYmIHRoaXMub3RwICE9PSB1bmRlZmluZWQsIGF1dGgsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SICovKTtcbiAgICAgICAgY29uc3QgdG90cFZlcmlmaWNhdGlvbkluZm8gPSB7IHZlcmlmaWNhdGlvbkNvZGU6IHRoaXMub3RwIH07XG4gICAgICAgIHJldHVybiBmaW5hbGl6ZVNpZ25JblRvdHBNZmEoYXV0aCwge1xuICAgICAgICAgICAgbWZhUGVuZGluZ0NyZWRlbnRpYWwsXG4gICAgICAgICAgICBtZmFFbnJvbGxtZW50SWQ6IHRoaXMuZW5yb2xsbWVudElkLFxuICAgICAgICAgICAgdG90cFZlcmlmaWNhdGlvbkluZm9cbiAgICAgICAgfSk7XG4gICAgfVxufVxuLyoqXG4gKiBQcm92aWRlciBmb3IgZ2VuZXJhdGluZyBhIHtAbGluayBUb3RwTXVsdGlGYWN0b3JBc3NlcnRpb259LlxuICpcbiAqIFN0b3JlcyB0aGUgc2hhcmVkIHNlY3JldCBrZXkgYW5kIG90aGVyIHBhcmFtZXRlcnMgdG8gZ2VuZXJhdGUgdGltZS1iYXNlZCBPVFBzLlxuICogSW1wbGVtZW50cyBtZXRob2RzIHRvIHJldHJpZXZlIHRoZSBzaGFyZWQgc2VjcmV0IGtleSBhbmQgZ2VuZXJhdGUgYSBRUiBjb2RlIFVSTC5cbiAqIEBwdWJsaWNcbiAqL1xuY2xhc3MgVG90cFNlY3JldCB7XG4gICAgLy8gVGhlIHB1YmxpYyBtZW1iZXJzIGFyZSBkZWNsYXJlZCBvdXRzaWRlIHRoZSBjb25zdHJ1Y3RvciBzbyB0aGUgZG9jcyBjYW4gYmUgZ2VuZXJhdGVkLlxuICAgIGNvbnN0cnVjdG9yKHNlY3JldEtleSwgaGFzaGluZ0FsZ29yaXRobSwgY29kZUxlbmd0aCwgY29kZUludGVydmFsU2Vjb25kcywgZW5yb2xsbWVudENvbXBsZXRpb25EZWFkbGluZSwgc2Vzc2lvbkluZm8sIGF1dGgpIHtcbiAgICAgICAgdGhpcy5zZXNzaW9uSW5mbyA9IHNlc3Npb25JbmZvO1xuICAgICAgICB0aGlzLmF1dGggPSBhdXRoO1xuICAgICAgICB0aGlzLnNlY3JldEtleSA9IHNlY3JldEtleTtcbiAgICAgICAgdGhpcy5oYXNoaW5nQWxnb3JpdGhtID0gaGFzaGluZ0FsZ29yaXRobTtcbiAgICAgICAgdGhpcy5jb2RlTGVuZ3RoID0gY29kZUxlbmd0aDtcbiAgICAgICAgdGhpcy5jb2RlSW50ZXJ2YWxTZWNvbmRzID0gY29kZUludGVydmFsU2Vjb25kcztcbiAgICAgICAgdGhpcy5lbnJvbGxtZW50Q29tcGxldGlvbkRlYWRsaW5lID0gZW5yb2xsbWVudENvbXBsZXRpb25EZWFkbGluZTtcbiAgICB9XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIHN0YXRpYyBfZnJvbVN0YXJ0VG90cE1mYUVucm9sbG1lbnRSZXNwb25zZShyZXNwb25zZSwgYXV0aCkge1xuICAgICAgICByZXR1cm4gbmV3IFRvdHBTZWNyZXQocmVzcG9uc2UudG90cFNlc3Npb25JbmZvLnNoYXJlZFNlY3JldEtleSwgcmVzcG9uc2UudG90cFNlc3Npb25JbmZvLmhhc2hpbmdBbGdvcml0aG0sIHJlc3BvbnNlLnRvdHBTZXNzaW9uSW5mby52ZXJpZmljYXRpb25Db2RlTGVuZ3RoLCByZXNwb25zZS50b3RwU2Vzc2lvbkluZm8ucGVyaW9kU2VjLCBuZXcgRGF0ZShyZXNwb25zZS50b3RwU2Vzc2lvbkluZm8uZmluYWxpemVFbnJvbGxtZW50VGltZSkudG9VVENTdHJpbmcoKSwgcmVzcG9uc2UudG90cFNlc3Npb25JbmZvLnNlc3Npb25JbmZvLCBhdXRoKTtcbiAgICB9XG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIF9tYWtlVG90cFZlcmlmaWNhdGlvbkluZm8ob3RwKSB7XG4gICAgICAgIHJldHVybiB7IHNlc3Npb25JbmZvOiB0aGlzLnNlc3Npb25JbmZvLCB2ZXJpZmljYXRpb25Db2RlOiBvdHAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIFFSIGNvZGUgVVJMIGFzIGRlc2NyaWJlZCBpblxuICAgICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvZ29vZ2xlLWF1dGhlbnRpY2F0b3Ivd2lraS9LZXktVXJpLUZvcm1hdFxuICAgICAqIFRoaXMgY2FuIGJlIGRpc3BsYXllZCB0byB0aGUgdXNlciBhcyBhIFFSIGNvZGUgdG8gYmUgc2Nhbm5lZCBpbnRvIGEgVE9UUCBhcHAgbGlrZSBHb29nbGUgQXV0aGVudGljYXRvci5cbiAgICAgKiBJZiB0aGUgb3B0aW9uYWwgcGFyYW1ldGVycyBhcmUgdW5zcGVjaWZpZWQsIGFuIGFjY291bnROYW1lIG9mIDx1c2VyRW1haWw+IGFuZCBpc3N1ZXIgb2YgPGZpcmViYXNlQXBwTmFtZT4gYXJlIHVzZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYWNjb3VudE5hbWUgdGhlIG5hbWUgb2YgdGhlIGFjY291bnQvYXBwIGFsb25nIHdpdGggYSB1c2VyIGlkZW50aWZpZXIuXG4gICAgICogQHBhcmFtIGlzc3VlciBpc3N1ZXIgb2YgdGhlIFRPVFAgKGxpa2VseSB0aGUgYXBwIG5hbWUpLlxuICAgICAqIEByZXR1cm5zIEEgUVIgY29kZSBVUkwgc3RyaW5nLlxuICAgICAqL1xuICAgIGdlbmVyYXRlUXJDb2RlVXJsKGFjY291bnROYW1lLCBpc3N1ZXIpIHtcbiAgICAgICAgbGV0IHVzZURlZmF1bHRzID0gZmFsc2U7XG4gICAgICAgIGlmIChfaXNFbXB0eVN0cmluZyhhY2NvdW50TmFtZSkgfHwgX2lzRW1wdHlTdHJpbmcoaXNzdWVyKSkge1xuICAgICAgICAgICAgdXNlRGVmYXVsdHMgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1c2VEZWZhdWx0cykge1xuICAgICAgICAgICAgaWYgKF9pc0VtcHR5U3RyaW5nKGFjY291bnROYW1lKSkge1xuICAgICAgICAgICAgICAgIGFjY291bnROYW1lID0gdGhpcy5hdXRoLmN1cnJlbnRVc2VyPy5lbWFpbCB8fCAndW5rbm93bnVzZXInO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKF9pc0VtcHR5U3RyaW5nKGlzc3VlcikpIHtcbiAgICAgICAgICAgICAgICBpc3N1ZXIgPSB0aGlzLmF1dGgubmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYG90cGF1dGg6Ly90b3RwLyR7aXNzdWVyfToke2FjY291bnROYW1lfT9zZWNyZXQ9JHt0aGlzLnNlY3JldEtleX0maXNzdWVyPSR7aXNzdWVyfSZhbGdvcml0aG09JHt0aGlzLmhhc2hpbmdBbGdvcml0aG19JmRpZ2l0cz0ke3RoaXMuY29kZUxlbmd0aH1gO1xuICAgIH1cbn1cbi8qKiBAaW50ZXJuYWwgKi9cbmZ1bmN0aW9uIF9pc0VtcHR5U3RyaW5nKGlucHV0KSB7XG4gICAgcmV0dXJuIHR5cGVvZiBpbnB1dCA9PT0gJ3VuZGVmaW5lZCcgfHwgaW5wdXQ/Lmxlbmd0aCA9PT0gMDtcbn1cblxudmFyIG5hbWUgPSBcIkBmaXJlYmFzZS9hdXRoXCI7XG52YXIgdmVyc2lvbiA9IFwiMS4xMS4xXCI7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jbGFzcyBBdXRoSW50ZXJvcCB7XG4gICAgY29uc3RydWN0b3IoYXV0aCkge1xuICAgICAgICB0aGlzLmF1dGggPSBhdXRoO1xuICAgICAgICB0aGlzLmludGVybmFsTGlzdGVuZXJzID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgICBnZXRVaWQoKSB7XG4gICAgICAgIHRoaXMuYXNzZXJ0QXV0aENvbmZpZ3VyZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXV0aC5jdXJyZW50VXNlcj8udWlkIHx8IG51bGw7XG4gICAgfVxuICAgIGFzeW5jIGdldFRva2VuKGZvcmNlUmVmcmVzaCkge1xuICAgICAgICB0aGlzLmFzc2VydEF1dGhDb25maWd1cmVkKCk7XG4gICAgICAgIGF3YWl0IHRoaXMuYXV0aC5faW5pdGlhbGl6YXRpb25Qcm9taXNlO1xuICAgICAgICBpZiAoIXRoaXMuYXV0aC5jdXJyZW50VXNlcikge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCB0aGlzLmF1dGguY3VycmVudFVzZXIuZ2V0SWRUb2tlbihmb3JjZVJlZnJlc2gpO1xuICAgICAgICByZXR1cm4geyBhY2Nlc3NUb2tlbiB9O1xuICAgIH1cbiAgICBhZGRBdXRoVG9rZW5MaXN0ZW5lcihsaXN0ZW5lcikge1xuICAgICAgICB0aGlzLmFzc2VydEF1dGhDb25maWd1cmVkKCk7XG4gICAgICAgIGlmICh0aGlzLmludGVybmFsTGlzdGVuZXJzLmhhcyhsaXN0ZW5lcikpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB1bnN1YnNjcmliZSA9IHRoaXMuYXV0aC5vbklkVG9rZW5DaGFuZ2VkKHVzZXIgPT4ge1xuICAgICAgICAgICAgbGlzdGVuZXIodXNlcj8uc3RzVG9rZW5NYW5hZ2VyLmFjY2Vzc1Rva2VuIHx8IG51bGwpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5pbnRlcm5hbExpc3RlbmVycy5zZXQobGlzdGVuZXIsIHVuc3Vic2NyaWJlKTtcbiAgICAgICAgdGhpcy51cGRhdGVQcm9hY3RpdmVSZWZyZXNoKCk7XG4gICAgfVxuICAgIHJlbW92ZUF1dGhUb2tlbkxpc3RlbmVyKGxpc3RlbmVyKSB7XG4gICAgICAgIHRoaXMuYXNzZXJ0QXV0aENvbmZpZ3VyZWQoKTtcbiAgICAgICAgY29uc3QgdW5zdWJzY3JpYmUgPSB0aGlzLmludGVybmFsTGlzdGVuZXJzLmdldChsaXN0ZW5lcik7XG4gICAgICAgIGlmICghdW5zdWJzY3JpYmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmludGVybmFsTGlzdGVuZXJzLmRlbGV0ZShsaXN0ZW5lcik7XG4gICAgICAgIHVuc3Vic2NyaWJlKCk7XG4gICAgICAgIHRoaXMudXBkYXRlUHJvYWN0aXZlUmVmcmVzaCgpO1xuICAgIH1cbiAgICBhc3NlcnRBdXRoQ29uZmlndXJlZCgpIHtcbiAgICAgICAgX2Fzc2VydCh0aGlzLmF1dGguX2luaXRpYWxpemF0aW9uUHJvbWlzZSwgXCJkZXBlbmRlbnQtc2RrLWluaXRpYWxpemVkLWJlZm9yZS1hdXRoXCIgLyogQXV0aEVycm9yQ29kZS5ERVBFTkRFTlRfU0RLX0lOSVRfQkVGT1JFX0FVVEggKi8pO1xuICAgIH1cbiAgICB1cGRhdGVQcm9hY3RpdmVSZWZyZXNoKCkge1xuICAgICAgICBpZiAodGhpcy5pbnRlcm5hbExpc3RlbmVycy5zaXplID4gMCkge1xuICAgICAgICAgICAgdGhpcy5hdXRoLl9zdGFydFByb2FjdGl2ZVJlZnJlc2goKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYXV0aC5fc3RvcFByb2FjdGl2ZVJlZnJlc2goKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmZ1bmN0aW9uIGdldFZlcnNpb25Gb3JQbGF0Zm9ybShjbGllbnRQbGF0Zm9ybSkge1xuICAgIHN3aXRjaCAoY2xpZW50UGxhdGZvcm0pIHtcbiAgICAgICAgY2FzZSBcIk5vZGVcIiAvKiBDbGllbnRQbGF0Zm9ybS5OT0RFICovOlxuICAgICAgICAgICAgcmV0dXJuICdub2RlJztcbiAgICAgICAgY2FzZSBcIlJlYWN0TmF0aXZlXCIgLyogQ2xpZW50UGxhdGZvcm0uUkVBQ1RfTkFUSVZFICovOlxuICAgICAgICAgICAgcmV0dXJuICdybic7XG4gICAgICAgIGNhc2UgXCJXb3JrZXJcIiAvKiBDbGllbnRQbGF0Zm9ybS5XT1JLRVIgKi86XG4gICAgICAgICAgICByZXR1cm4gJ3dlYndvcmtlcic7XG4gICAgICAgIGNhc2UgXCJDb3Jkb3ZhXCIgLyogQ2xpZW50UGxhdGZvcm0uQ09SRE9WQSAqLzpcbiAgICAgICAgICAgIHJldHVybiAnY29yZG92YSc7XG4gICAgICAgIGNhc2UgXCJXZWJFeHRlbnNpb25cIiAvKiBDbGllbnRQbGF0Zm9ybS5XRUJfRVhURU5TSU9OICovOlxuICAgICAgICAgICAgcmV0dXJuICd3ZWItZXh0ZW5zaW9uJztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxufVxuLyoqIEBpbnRlcm5hbCAqL1xuZnVuY3Rpb24gcmVnaXN0ZXJBdXRoKGNsaWVudFBsYXRmb3JtKSB7XG4gICAgX3JlZ2lzdGVyQ29tcG9uZW50KG5ldyBDb21wb25lbnQoXCJhdXRoXCIgLyogX0NvbXBvbmVudE5hbWUuQVVUSCAqLywgKGNvbnRhaW5lciwgeyBvcHRpb25zOiBkZXBzIH0pID0+IHtcbiAgICAgICAgY29uc3QgYXBwID0gY29udGFpbmVyLmdldFByb3ZpZGVyKCdhcHAnKS5nZXRJbW1lZGlhdGUoKTtcbiAgICAgICAgY29uc3QgaGVhcnRiZWF0U2VydmljZVByb3ZpZGVyID0gY29udGFpbmVyLmdldFByb3ZpZGVyKCdoZWFydGJlYXQnKTtcbiAgICAgICAgY29uc3QgYXBwQ2hlY2tTZXJ2aWNlUHJvdmlkZXIgPSBjb250YWluZXIuZ2V0UHJvdmlkZXIoJ2FwcC1jaGVjay1pbnRlcm5hbCcpO1xuICAgICAgICBjb25zdCB7IGFwaUtleSwgYXV0aERvbWFpbiB9ID0gYXBwLm9wdGlvbnM7XG4gICAgICAgIF9hc3NlcnQoYXBpS2V5ICYmICFhcGlLZXkuaW5jbHVkZXMoJzonKSwgXCJpbnZhbGlkLWFwaS1rZXlcIiAvKiBBdXRoRXJyb3JDb2RlLklOVkFMSURfQVBJX0tFWSAqLywgeyBhcHBOYW1lOiBhcHAubmFtZSB9KTtcbiAgICAgICAgY29uc3QgY29uZmlnID0ge1xuICAgICAgICAgICAgYXBpS2V5LFxuICAgICAgICAgICAgYXV0aERvbWFpbixcbiAgICAgICAgICAgIGNsaWVudFBsYXRmb3JtLFxuICAgICAgICAgICAgYXBpSG9zdDogXCJpZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb21cIiAvKiBEZWZhdWx0Q29uZmlnLkFQSV9IT1NUICovLFxuICAgICAgICAgICAgdG9rZW5BcGlIb3N0OiBcInNlY3VyZXRva2VuLmdvb2dsZWFwaXMuY29tXCIgLyogRGVmYXVsdENvbmZpZy5UT0tFTl9BUElfSE9TVCAqLyxcbiAgICAgICAgICAgIGFwaVNjaGVtZTogXCJodHRwc1wiIC8qIERlZmF1bHRDb25maWcuQVBJX1NDSEVNRSAqLyxcbiAgICAgICAgICAgIHNka0NsaWVudFZlcnNpb246IF9nZXRDbGllbnRWZXJzaW9uKGNsaWVudFBsYXRmb3JtKVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBhdXRoSW5zdGFuY2UgPSBuZXcgQXV0aEltcGwoYXBwLCBoZWFydGJlYXRTZXJ2aWNlUHJvdmlkZXIsIGFwcENoZWNrU2VydmljZVByb3ZpZGVyLCBjb25maWcpO1xuICAgICAgICBfaW5pdGlhbGl6ZUF1dGhJbnN0YW5jZShhdXRoSW5zdGFuY2UsIGRlcHMpO1xuICAgICAgICByZXR1cm4gYXV0aEluc3RhbmNlO1xuICAgIH0sIFwiUFVCTElDXCIgLyogQ29tcG9uZW50VHlwZS5QVUJMSUMgKi8pXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBdXRoIGNhbiBvbmx5IGJlIGluaXRpYWxpemVkIGJ5IGV4cGxpY2l0bHkgY2FsbGluZyBnZXRBdXRoKCkgb3IgaW5pdGlhbGl6ZUF1dGgoKVxuICAgICAgICAgKiBGb3Igd2h5IHdlIGRvIHRoaXMsIFNlZSBnby9maXJlYmFzZS1uZXh0LWF1dGgtaW5pdFxuICAgICAgICAgKi9cbiAgICAgICAgLnNldEluc3RhbnRpYXRpb25Nb2RlKFwiRVhQTElDSVRcIiAvKiBJbnN0YW50aWF0aW9uTW9kZS5FWFBMSUNJVCAqLylcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEJlY2F1c2UgYWxsIGZpcmViYXNlIHByb2R1Y3RzIHRoYXQgZGVwZW5kIG9uIGF1dGggZGVwZW5kIG9uIGF1dGgtaW50ZXJuYWwgZGlyZWN0bHksXG4gICAgICAgICAqIHdlIG5lZWQgdG8gaW5pdGlhbGl6ZSBhdXRoLWludGVybmFsIGFmdGVyIGF1dGggaXMgaW5pdGlhbGl6ZWQgdG8gbWFrZSBpdCBhdmFpbGFibGUgdG8gb3RoZXIgZmlyZWJhc2UgcHJvZHVjdHMuXG4gICAgICAgICAqL1xuICAgICAgICAuc2V0SW5zdGFuY2VDcmVhdGVkQ2FsbGJhY2soKGNvbnRhaW5lciwgX2luc3RhbmNlSWRlbnRpZmllciwgX2luc3RhbmNlKSA9PiB7XG4gICAgICAgIGNvbnN0IGF1dGhJbnRlcm5hbFByb3ZpZGVyID0gY29udGFpbmVyLmdldFByb3ZpZGVyKFwiYXV0aC1pbnRlcm5hbFwiIC8qIF9Db21wb25lbnROYW1lLkFVVEhfSU5URVJOQUwgKi8pO1xuICAgICAgICBhdXRoSW50ZXJuYWxQcm92aWRlci5pbml0aWFsaXplKCk7XG4gICAgfSkpO1xuICAgIF9yZWdpc3RlckNvbXBvbmVudChuZXcgQ29tcG9uZW50KFwiYXV0aC1pbnRlcm5hbFwiIC8qIF9Db21wb25lbnROYW1lLkFVVEhfSU5URVJOQUwgKi8sIGNvbnRhaW5lciA9PiB7XG4gICAgICAgIGNvbnN0IGF1dGggPSBfY2FzdEF1dGgoY29udGFpbmVyLmdldFByb3ZpZGVyKFwiYXV0aFwiIC8qIF9Db21wb25lbnROYW1lLkFVVEggKi8pLmdldEltbWVkaWF0ZSgpKTtcbiAgICAgICAgcmV0dXJuIChhdXRoID0+IG5ldyBBdXRoSW50ZXJvcChhdXRoKSkoYXV0aCk7XG4gICAgfSwgXCJQUklWQVRFXCIgLyogQ29tcG9uZW50VHlwZS5QUklWQVRFICovKS5zZXRJbnN0YW50aWF0aW9uTW9kZShcIkVYUExJQ0lUXCIgLyogSW5zdGFudGlhdGlvbk1vZGUuRVhQTElDSVQgKi8pKTtcbiAgICByZWdpc3RlclZlcnNpb24obmFtZSwgdmVyc2lvbiwgZ2V0VmVyc2lvbkZvclBsYXRmb3JtKGNsaWVudFBsYXRmb3JtKSk7XG4gICAgLy8gQlVJTERfVEFSR0VUIHdpbGwgYmUgcmVwbGFjZWQgYnkgdmFsdWVzIGxpa2UgZXNtLCBjanMsIGV0YyBkdXJpbmcgdGhlIGNvbXBpbGF0aW9uXG4gICAgcmVnaXN0ZXJWZXJzaW9uKG5hbWUsIHZlcnNpb24sICdlc20yMDIwJyk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIxIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jb25zdCBERUZBVUxUX0lEX1RPS0VOX01BWF9BR0UgPSA1ICogNjA7XG5jb25zdCBhdXRoSWRUb2tlbk1heEFnZSA9IGdldEV4cGVyaW1lbnRhbFNldHRpbmcoJ2F1dGhJZFRva2VuTWF4QWdlJykgfHwgREVGQVVMVF9JRF9UT0tFTl9NQVhfQUdFO1xubGV0IGxhc3RQb3N0ZWRJZFRva2VuID0gbnVsbDtcbmNvbnN0IG1pbnRDb29raWVGYWN0b3J5ID0gKHVybCkgPT4gYXN5bmMgKHVzZXIpID0+IHtcbiAgICBjb25zdCBpZFRva2VuUmVzdWx0ID0gdXNlciAmJiAoYXdhaXQgdXNlci5nZXRJZFRva2VuUmVzdWx0KCkpO1xuICAgIGNvbnN0IGlkVG9rZW5BZ2UgPSBpZFRva2VuUmVzdWx0ICYmXG4gICAgICAgIChuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIERhdGUucGFyc2UoaWRUb2tlblJlc3VsdC5pc3N1ZWRBdFRpbWUpKSAvIDEwMDA7XG4gICAgaWYgKGlkVG9rZW5BZ2UgJiYgaWRUb2tlbkFnZSA+IGF1dGhJZFRva2VuTWF4QWdlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gU3BlY2lmaWNhbGx5IHRyaXAgbnVsbCA9PiB1bmRlZmluZWQgd2hlbiBsb2dnZWQgb3V0LCB0byBkZWxldGUgYW55IGV4aXN0aW5nIGNvb2tpZVxuICAgIGNvbnN0IGlkVG9rZW4gPSBpZFRva2VuUmVzdWx0Py50b2tlbjtcbiAgICBpZiAobGFzdFBvc3RlZElkVG9rZW4gPT09IGlkVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBsYXN0UG9zdGVkSWRUb2tlbiA9IGlkVG9rZW47XG4gICAgYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgIG1ldGhvZDogaWRUb2tlbiA/ICdQT1NUJyA6ICdERUxFVEUnLFxuICAgICAgICBoZWFkZXJzOiBpZFRva2VuXG4gICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtpZFRva2VufWBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDoge31cbiAgICB9KTtcbn07XG4vKipcbiAqIFJldHVybnMgdGhlIEF1dGggaW5zdGFuY2UgYXNzb2NpYXRlZCB3aXRoIHRoZSBwcm92aWRlZCB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZUFwcH0uXG4gKiBJZiBubyBpbnN0YW5jZSBleGlzdHMsIGluaXRpYWxpemVzIGFuIEF1dGggaW5zdGFuY2Ugd2l0aCBwbGF0Zm9ybS1zcGVjaWZpYyBkZWZhdWx0IGRlcGVuZGVuY2llcy5cbiAqXG4gKiBAcGFyYW0gYXBwIC0gVGhlIEZpcmViYXNlIEFwcC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIGdldEF1dGgoYXBwID0gZ2V0QXBwKCkpIHtcbiAgICBjb25zdCBwcm92aWRlciA9IF9nZXRQcm92aWRlcihhcHAsICdhdXRoJyk7XG4gICAgaWYgKHByb3ZpZGVyLmlzSW5pdGlhbGl6ZWQoKSkge1xuICAgICAgICByZXR1cm4gcHJvdmlkZXIuZ2V0SW1tZWRpYXRlKCk7XG4gICAgfVxuICAgIGNvbnN0IGF1dGggPSBpbml0aWFsaXplQXV0aChhcHAsIHtcbiAgICAgICAgcG9wdXBSZWRpcmVjdFJlc29sdmVyOiBicm93c2VyUG9wdXBSZWRpcmVjdFJlc29sdmVyLFxuICAgICAgICBwZXJzaXN0ZW5jZTogW1xuICAgICAgICAgICAgaW5kZXhlZERCTG9jYWxQZXJzaXN0ZW5jZSxcbiAgICAgICAgICAgIGJyb3dzZXJMb2NhbFBlcnNpc3RlbmNlLFxuICAgICAgICAgICAgYnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZVxuICAgICAgICBdXG4gICAgfSk7XG4gICAgY29uc3QgYXV0aFRva2VuU3luY1BhdGggPSBnZXRFeHBlcmltZW50YWxTZXR0aW5nKCdhdXRoVG9rZW5TeW5jVVJMJyk7XG4gICAgLy8gT25seSBkbyB0aGUgQ29va2llIGV4Y2hhbmdlIGluIGEgc2VjdXJlIGNvbnRleHRcbiAgICBpZiAoYXV0aFRva2VuU3luY1BhdGggJiZcbiAgICAgICAgdHlwZW9mIGlzU2VjdXJlQ29udGV4dCA9PT0gJ2Jvb2xlYW4nICYmXG4gICAgICAgIGlzU2VjdXJlQ29udGV4dCkge1xuICAgICAgICAvLyBEb24ndCBhbGxvdyB1cmxzIChYU1MgcG9zc2liaWxpdHkpLCBvbmx5IHBhdGhzIG9uIHRoZSBzYW1lIGRvbWFpblxuICAgICAgICBjb25zdCBhdXRoVG9rZW5TeW5jVXJsID0gbmV3IFVSTChhdXRoVG9rZW5TeW5jUGF0aCwgbG9jYXRpb24ub3JpZ2luKTtcbiAgICAgICAgaWYgKGxvY2F0aW9uLm9yaWdpbiA9PT0gYXV0aFRva2VuU3luY1VybC5vcmlnaW4pIHtcbiAgICAgICAgICAgIGNvbnN0IG1pbnRDb29raWUgPSBtaW50Q29va2llRmFjdG9yeShhdXRoVG9rZW5TeW5jVXJsLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgYmVmb3JlQXV0aFN0YXRlQ2hhbmdlZChhdXRoLCBtaW50Q29va2llLCAoKSA9PiBtaW50Q29va2llKGF1dGguY3VycmVudFVzZXIpKTtcbiAgICAgICAgICAgIG9uSWRUb2tlbkNoYW5nZWQoYXV0aCwgdXNlciA9PiBtaW50Q29va2llKHVzZXIpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBhdXRoRW11bGF0b3JIb3N0ID0gZ2V0RGVmYXVsdEVtdWxhdG9ySG9zdCgnYXV0aCcpO1xuICAgIGlmIChhdXRoRW11bGF0b3JIb3N0KSB7XG4gICAgICAgIGNvbm5lY3RBdXRoRW11bGF0b3IoYXV0aCwgYGh0dHA6Ly8ke2F1dGhFbXVsYXRvckhvc3R9YCk7XG4gICAgfVxuICAgIHJldHVybiBhdXRoO1xufVxuZnVuY3Rpb24gZ2V0U2NyaXB0UGFyZW50RWxlbWVudCgpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKT8uWzBdID8/IGRvY3VtZW50O1xufVxuX3NldEV4dGVybmFsSlNQcm92aWRlcih7XG4gICAgbG9hZEpTKHVybCkge1xuICAgICAgICAvLyBUT0RPOiBjb25zaWRlciBhZGRpbmcgdGltZW91dCBzdXBwb3J0ICYgY2FuY2VsbGF0aW9uXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlKCdzcmMnLCB1cmwpO1xuICAgICAgICAgICAgZWwub25sb2FkID0gcmVzb2x2ZTtcbiAgICAgICAgICAgIGVsLm9uZXJyb3IgPSBlID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlcnJvciA9IF9jcmVhdGVFcnJvcihcImludGVybmFsLWVycm9yXCIgLyogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUiAqLyk7XG4gICAgICAgICAgICAgICAgZXJyb3IuY3VzdG9tRGF0YSA9IGU7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBlbC50eXBlID0gJ3RleHQvamF2YXNjcmlwdCc7XG4gICAgICAgICAgICBlbC5jaGFyc2V0ID0gJ1VURi04JztcbiAgICAgICAgICAgIGdldFNjcmlwdFBhcmVudEVsZW1lbnQoKS5hcHBlbmRDaGlsZChlbCk7XG4gICAgICAgIH0pO1xuICAgIH0sXG4gICAgZ2FwaVNjcmlwdDogJ2h0dHBzOi8vYXBpcy5nb29nbGUuY29tL2pzL2FwaS5qcycsXG4gICAgcmVjYXB0Y2hhVjJTY3JpcHQ6ICdodHRwczovL3d3dy5nb29nbGUuY29tL3JlY2FwdGNoYS9hcGkuanMnLFxuICAgIHJlY2FwdGNoYUVudGVycHJpc2VTY3JpcHQ6ICdodHRwczovL3d3dy5nb29nbGUuY29tL3JlY2FwdGNoYS9lbnRlcnByaXNlLmpzP3JlbmRlcj0nXG59KTtcbnJlZ2lzdGVyQXV0aChcIkJyb3dzZXJcIiAvKiBDbGllbnRQbGF0Zm9ybS5CUk9XU0VSICovKTtcblxuZXhwb3J0IHsgU0FNTEF1dGhQcm92aWRlciBhcyAkLCBBY3Rpb25Db2RlT3BlcmF0aW9uIGFzIEEsIHVzZURldmljZUxhbmd1YWdlIGFzIEIsIHVwZGF0ZUN1cnJlbnRVc2VyIGFzIEMsIHNpZ25PdXQgYXMgRCwgcmV2b2tlQWNjZXNzVG9rZW4gYXMgRSwgRmFjdG9ySWQgYXMgRiwgZGVsZXRlVXNlciBhcyBHLCBkZWJ1Z0Vycm9yTWFwIGFzIEgsIHByb2RFcnJvck1hcCBhcyBJLCBBVVRIX0VSUk9SX0NPREVTX01BUF9ET19OT1RfVVNFX0lOVEVSTkFMTFkgYXMgSiwgaW5pdGlhbGl6ZUF1dGggYXMgSywgY29ubmVjdEF1dGhFbXVsYXRvciBhcyBMLCBBdXRoQ3JlZGVudGlhbCBhcyBNLCBFbWFpbEF1dGhDcmVkZW50aWFsIGFzIE4sIE9wZXJhdGlvblR5cGUgYXMgTywgUGhvbmVBdXRoUHJvdmlkZXIgYXMgUCwgT0F1dGhDcmVkZW50aWFsIGFzIFEsIFJlY2FwdGNoYVZlcmlmaWVyIGFzIFIsIFNpZ25Jbk1ldGhvZCBhcyBTLCBUb3RwTXVsdGlGYWN0b3JHZW5lcmF0b3IgYXMgVCwgUGhvbmVBdXRoQ3JlZGVudGlhbCBhcyBVLCBpbk1lbW9yeVBlcnNpc3RlbmNlIGFzIFYsIEVtYWlsQXV0aFByb3ZpZGVyIGFzIFcsIEZhY2Vib29rQXV0aFByb3ZpZGVyIGFzIFgsIEdvb2dsZUF1dGhQcm92aWRlciBhcyBZLCBHaXRodWJBdXRoUHJvdmlkZXIgYXMgWiwgT0F1dGhQcm92aWRlciBhcyBfLCBicm93c2VyQ29va2llUGVyc2lzdGVuY2UgYXMgYSwgVHdpdHRlckF1dGhQcm92aWRlciBhcyBhMCwgc2lnbkluQW5vbnltb3VzbHkgYXMgYTEsIHNpZ25JbldpdGhDcmVkZW50aWFsIGFzIGEyLCBsaW5rV2l0aENyZWRlbnRpYWwgYXMgYTMsIHJlYXV0aGVudGljYXRlV2l0aENyZWRlbnRpYWwgYXMgYTQsIHNpZ25JbldpdGhDdXN0b21Ub2tlbiBhcyBhNSwgc2VuZFBhc3N3b3JkUmVzZXRFbWFpbCBhcyBhNiwgY29uZmlybVBhc3N3b3JkUmVzZXQgYXMgYTcsIGFwcGx5QWN0aW9uQ29kZSBhcyBhOCwgY2hlY2tBY3Rpb25Db2RlIGFzIGE5LCBfZ2V0UHJvamVjdENvbmZpZyBhcyBhQSwgX2lzSU9TN09yOCBhcyBhQiwgX2NyZWF0ZUVycm9yIGFzIGFDLCBfYXNzZXJ0IGFzIGFELCBBdXRoRXZlbnRNYW5hZ2VyIGFzIGFFLCBfZ2V0SW5zdGFuY2UgYXMgYUYsIF9wZXJzaXN0ZW5jZUtleU5hbWUgYXMgYUcsIF9nZXRSZWRpcmVjdFJlc3VsdCBhcyBhSCwgX292ZXJyaWRlUmVkaXJlY3RSZXN1bHQgYXMgYUksIF9jbGVhclJlZGlyZWN0T3V0Y29tZXMgYXMgYUosIF9jYXN0QXV0aCBhcyBhSywgVXNlckltcGwgYXMgYUwsIEF1dGhJbXBsIGFzIGFNLCBfZ2V0Q2xpZW50VmVyc2lvbiBhcyBhTiwgX2dlbmVyYXRlRXZlbnRJZCBhcyBhTywgQXV0aFBvcHVwIGFzIGFQLCBGZXRjaFByb3ZpZGVyIGFzIGFRLCBTQU1MQXV0aENyZWRlbnRpYWwgYXMgYVIsIHZlcmlmeVBhc3N3b3JkUmVzZXRDb2RlIGFzIGFhLCBjcmVhdGVVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQgYXMgYWIsIHNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkIGFzIGFjLCBzZW5kU2lnbkluTGlua1RvRW1haWwgYXMgYWQsIGlzU2lnbkluV2l0aEVtYWlsTGluayBhcyBhZSwgc2lnbkluV2l0aEVtYWlsTGluayBhcyBhZiwgZmV0Y2hTaWduSW5NZXRob2RzRm9yRW1haWwgYXMgYWcsIHNlbmRFbWFpbFZlcmlmaWNhdGlvbiBhcyBhaCwgdmVyaWZ5QmVmb3JlVXBkYXRlRW1haWwgYXMgYWksIEFjdGlvbkNvZGVVUkwgYXMgYWosIHBhcnNlQWN0aW9uQ29kZVVSTCBhcyBhaywgdXBkYXRlUHJvZmlsZSBhcyBhbCwgdXBkYXRlRW1haWwgYXMgYW0sIHVwZGF0ZVBhc3N3b3JkIGFzIGFuLCBnZXRJZFRva2VuIGFzIGFvLCBnZXRJZFRva2VuUmVzdWx0IGFzIGFwLCB1bmxpbmsgYXMgYXEsIGdldEFkZGl0aW9uYWxVc2VySW5mbyBhcyBhciwgcmVsb2FkIGFzIGFzLCBnZXRNdWx0aUZhY3RvclJlc29sdmVyIGFzIGF0LCBtdWx0aUZhY3RvciBhcyBhdSwgZGVidWdBc3NlcnQgYXMgYXYsIF9pc0lPUyBhcyBhdywgX2lzQW5kcm9pZCBhcyBheCwgX2ZhaWwgYXMgYXksIF9nZXRSZWRpcmVjdFVybCBhcyBheiwgYnJvd3NlckxvY2FsUGVyc2lzdGVuY2UgYXMgYiwgYnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZSBhcyBjLCBzaWduSW5XaXRoUG9wdXAgYXMgZCwgbGlua1dpdGhQb3B1cCBhcyBlLCByZWF1dGhlbnRpY2F0ZVdpdGhQb3B1cCBhcyBmLCBzaWduSW5XaXRoUmVkaXJlY3QgYXMgZywgbGlua1dpdGhSZWRpcmVjdCBhcyBoLCBpbmRleGVkREJMb2NhbFBlcnNpc3RlbmNlIGFzIGksIHJlYXV0aGVudGljYXRlV2l0aFJlZGlyZWN0IGFzIGosIGdldFJlZGlyZWN0UmVzdWx0IGFzIGssIGxpbmtXaXRoUGhvbmVOdW1iZXIgYXMgbCwgYnJvd3NlclBvcHVwUmVkaXJlY3RSZXNvbHZlciBhcyBtLCBQaG9uZU11bHRpRmFjdG9yR2VuZXJhdG9yIGFzIG4sIFRvdHBTZWNyZXQgYXMgbywgZ2V0QXV0aCBhcyBwLCBQcm92aWRlcklkIGFzIHEsIHJlYXV0aGVudGljYXRlV2l0aFBob25lTnVtYmVyIGFzIHIsIHNpZ25JbldpdGhQaG9uZU51bWJlciBhcyBzLCBzZXRQZXJzaXN0ZW5jZSBhcyB0LCB1cGRhdGVQaG9uZU51bWJlciBhcyB1LCBpbml0aWFsaXplUmVjYXB0Y2hhQ29uZmlnIGFzIHYsIHZhbGlkYXRlUGFzc3dvcmQgYXMgdywgb25JZFRva2VuQ2hhbmdlZCBhcyB4LCBiZWZvcmVBdXRoU3RhdGVDaGFuZ2VkIGFzIHksIG9uQXV0aFN0YXRlQ2hhbmdlZCBhcyB6IH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC0xOTcwMDI3Zi5qcy5tYXBcbiIsImNvbnN0IGdldERlZmF1bHRzRnJvbVBvc3RpbnN0YWxsID0gKCkgPT4gKHVuZGVmaW5lZCk7XG5leHBvcnQgeyBnZXREZWZhdWx0c0Zyb21Qb3N0aW5zdGFsbCB9OyIsImltcG9ydCB7IENvbXBvbmVudCwgQ29tcG9uZW50Q29udGFpbmVyIH0gZnJvbSAnQGZpcmViYXNlL2NvbXBvbmVudCc7XG5pbXBvcnQgeyBMb2dnZXIsIHNldFVzZXJMb2dIYW5kbGVyLCBzZXRMb2dMZXZlbCBhcyBzZXRMb2dMZXZlbCQxIH0gZnJvbSAnQGZpcmViYXNlL2xvZ2dlcic7XG5pbXBvcnQgeyBFcnJvckZhY3RvcnksIGJhc2U2NERlY29kZSwgZ2V0RGVmYXVsdEFwcENvbmZpZywgZGVlcEVxdWFsLCBpc0Jyb3dzZXIsIGlzV2ViV29ya2VyLCBGaXJlYmFzZUVycm9yLCBiYXNlNjR1cmxFbmNvZGVXaXRob3V0UGFkZGluZywgaXNJbmRleGVkREJBdmFpbGFibGUsIHZhbGlkYXRlSW5kZXhlZERCT3BlbmFibGUgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5leHBvcnQgeyBGaXJlYmFzZUVycm9yIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuaW1wb3J0IHsgb3BlbkRCIH0gZnJvbSAnaWRiJztcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNsYXNzIFBsYXRmb3JtTG9nZ2VyU2VydmljZUltcGwge1xuICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lcikge1xuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICB9XG4gICAgLy8gSW4gaW5pdGlhbCBpbXBsZW1lbnRhdGlvbiwgdGhpcyB3aWxsIGJlIGNhbGxlZCBieSBpbnN0YWxsYXRpb25zIG9uXG4gICAgLy8gYXV0aCB0b2tlbiByZWZyZXNoLCBhbmQgaW5zdGFsbGF0aW9ucyB3aWxsIHNlbmQgdGhpcyBzdHJpbmcuXG4gICAgZ2V0UGxhdGZvcm1JbmZvU3RyaW5nKCkge1xuICAgICAgICBjb25zdCBwcm92aWRlcnMgPSB0aGlzLmNvbnRhaW5lci5nZXRQcm92aWRlcnMoKTtcbiAgICAgICAgLy8gTG9vcCB0aHJvdWdoIHByb3ZpZGVycyBhbmQgZ2V0IGxpYnJhcnkvdmVyc2lvbiBwYWlycyBmcm9tIGFueSB0aGF0IGFyZVxuICAgICAgICAvLyB2ZXJzaW9uIGNvbXBvbmVudHMuXG4gICAgICAgIHJldHVybiBwcm92aWRlcnNcbiAgICAgICAgICAgIC5tYXAocHJvdmlkZXIgPT4ge1xuICAgICAgICAgICAgaWYgKGlzVmVyc2lvblNlcnZpY2VQcm92aWRlcihwcm92aWRlcikpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzZXJ2aWNlID0gcHJvdmlkZXIuZ2V0SW1tZWRpYXRlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGAke3NlcnZpY2UubGlicmFyeX0vJHtzZXJ2aWNlLnZlcnNpb259YDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAgICAgLmZpbHRlcihsb2dTdHJpbmcgPT4gbG9nU3RyaW5nKVxuICAgICAgICAgICAgLmpvaW4oJyAnKTtcbiAgICB9XG59XG4vKipcbiAqXG4gKiBAcGFyYW0gcHJvdmlkZXIgY2hlY2sgaWYgdGhpcyBwcm92aWRlciBwcm92aWRlcyBhIFZlcnNpb25TZXJ2aWNlXG4gKlxuICogTk9URTogVXNpbmcgUHJvdmlkZXI8J2FwcC12ZXJzaW9uJz4gaXMgYSBoYWNrIHRvIGluZGljYXRlIHRoYXQgdGhlIHByb3ZpZGVyXG4gKiBwcm92aWRlcyBWZXJzaW9uU2VydmljZS4gVGhlIHByb3ZpZGVyIGlzIG5vdCBuZWNlc3NhcmlseSBhICdhcHAtdmVyc2lvbidcbiAqIHByb3ZpZGVyLlxuICovXG5mdW5jdGlvbiBpc1ZlcnNpb25TZXJ2aWNlUHJvdmlkZXIocHJvdmlkZXIpIHtcbiAgICBjb25zdCBjb21wb25lbnQgPSBwcm92aWRlci5nZXRDb21wb25lbnQoKTtcbiAgICByZXR1cm4gY29tcG9uZW50Py50eXBlID09PSBcIlZFUlNJT05cIiAvKiBDb21wb25lbnRUeXBlLlZFUlNJT04gKi87XG59XG5cbmNvbnN0IG5hbWUkcSA9IFwiQGZpcmViYXNlL2FwcFwiO1xuY29uc3QgdmVyc2lvbiQxID0gXCIwLjE0LjVcIjtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IGxvZ2dlciA9IG5ldyBMb2dnZXIoJ0BmaXJlYmFzZS9hcHAnKTtcblxuY29uc3QgbmFtZSRwID0gXCJAZmlyZWJhc2UvYXBwLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lJG8gPSBcIkBmaXJlYmFzZS9hbmFseXRpY3MtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkbiA9IFwiQGZpcmViYXNlL2FuYWx5dGljc1wiO1xuXG5jb25zdCBuYW1lJG0gPSBcIkBmaXJlYmFzZS9hcHAtY2hlY2stY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkbCA9IFwiQGZpcmViYXNlL2FwcC1jaGVja1wiO1xuXG5jb25zdCBuYW1lJGsgPSBcIkBmaXJlYmFzZS9hdXRoXCI7XG5cbmNvbnN0IG5hbWUkaiA9IFwiQGZpcmViYXNlL2F1dGgtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkaSA9IFwiQGZpcmViYXNlL2RhdGFiYXNlXCI7XG5cbmNvbnN0IG5hbWUkaCA9IFwiQGZpcmViYXNlL2RhdGEtY29ubmVjdFwiO1xuXG5jb25zdCBuYW1lJGcgPSBcIkBmaXJlYmFzZS9kYXRhYmFzZS1jb21wYXRcIjtcblxuY29uc3QgbmFtZSRmID0gXCJAZmlyZWJhc2UvZnVuY3Rpb25zXCI7XG5cbmNvbnN0IG5hbWUkZSA9IFwiQGZpcmViYXNlL2Z1bmN0aW9ucy1jb21wYXRcIjtcblxuY29uc3QgbmFtZSRkID0gXCJAZmlyZWJhc2UvaW5zdGFsbGF0aW9uc1wiO1xuXG5jb25zdCBuYW1lJGMgPSBcIkBmaXJlYmFzZS9pbnN0YWxsYXRpb25zLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lJGIgPSBcIkBmaXJlYmFzZS9tZXNzYWdpbmdcIjtcblxuY29uc3QgbmFtZSRhID0gXCJAZmlyZWJhc2UvbWVzc2FnaW5nLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lJDkgPSBcIkBmaXJlYmFzZS9wZXJmb3JtYW5jZVwiO1xuXG5jb25zdCBuYW1lJDggPSBcIkBmaXJlYmFzZS9wZXJmb3JtYW5jZS1jb21wYXRcIjtcblxuY29uc3QgbmFtZSQ3ID0gXCJAZmlyZWJhc2UvcmVtb3RlLWNvbmZpZ1wiO1xuXG5jb25zdCBuYW1lJDYgPSBcIkBmaXJlYmFzZS9yZW1vdGUtY29uZmlnLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lJDUgPSBcIkBmaXJlYmFzZS9zdG9yYWdlXCI7XG5cbmNvbnN0IG5hbWUkNCA9IFwiQGZpcmViYXNlL3N0b3JhZ2UtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkMyA9IFwiQGZpcmViYXNlL2ZpcmVzdG9yZVwiO1xuXG5jb25zdCBuYW1lJDIgPSBcIkBmaXJlYmFzZS9haVwiO1xuXG5jb25zdCBuYW1lJDEgPSBcIkBmaXJlYmFzZS9maXJlc3RvcmUtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUgPSBcImZpcmViYXNlXCI7XG5jb25zdCB2ZXJzaW9uID0gXCIxMi41LjBcIjtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVGhlIGRlZmF1bHQgYXBwIG5hbWVcbiAqXG4gKiBAaW50ZXJuYWxcbiAqL1xuY29uc3QgREVGQVVMVF9FTlRSWV9OQU1FID0gJ1tERUZBVUxUXSc7XG5jb25zdCBQTEFURk9STV9MT0dfU1RSSU5HID0ge1xuICAgIFtuYW1lJHFdOiAnZmlyZS1jb3JlJyxcbiAgICBbbmFtZSRwXTogJ2ZpcmUtY29yZS1jb21wYXQnLFxuICAgIFtuYW1lJG5dOiAnZmlyZS1hbmFseXRpY3MnLFxuICAgIFtuYW1lJG9dOiAnZmlyZS1hbmFseXRpY3MtY29tcGF0JyxcbiAgICBbbmFtZSRsXTogJ2ZpcmUtYXBwLWNoZWNrJyxcbiAgICBbbmFtZSRtXTogJ2ZpcmUtYXBwLWNoZWNrLWNvbXBhdCcsXG4gICAgW25hbWUka106ICdmaXJlLWF1dGgnLFxuICAgIFtuYW1lJGpdOiAnZmlyZS1hdXRoLWNvbXBhdCcsXG4gICAgW25hbWUkaV06ICdmaXJlLXJ0ZGInLFxuICAgIFtuYW1lJGhdOiAnZmlyZS1kYXRhLWNvbm5lY3QnLFxuICAgIFtuYW1lJGddOiAnZmlyZS1ydGRiLWNvbXBhdCcsXG4gICAgW25hbWUkZl06ICdmaXJlLWZuJyxcbiAgICBbbmFtZSRlXTogJ2ZpcmUtZm4tY29tcGF0JyxcbiAgICBbbmFtZSRkXTogJ2ZpcmUtaWlkJyxcbiAgICBbbmFtZSRjXTogJ2ZpcmUtaWlkLWNvbXBhdCcsXG4gICAgW25hbWUkYl06ICdmaXJlLWZjbScsXG4gICAgW25hbWUkYV06ICdmaXJlLWZjbS1jb21wYXQnLFxuICAgIFtuYW1lJDldOiAnZmlyZS1wZXJmJyxcbiAgICBbbmFtZSQ4XTogJ2ZpcmUtcGVyZi1jb21wYXQnLFxuICAgIFtuYW1lJDddOiAnZmlyZS1yYycsXG4gICAgW25hbWUkNl06ICdmaXJlLXJjLWNvbXBhdCcsXG4gICAgW25hbWUkNV06ICdmaXJlLWdjcycsXG4gICAgW25hbWUkNF06ICdmaXJlLWdjcy1jb21wYXQnLFxuICAgIFtuYW1lJDNdOiAnZmlyZS1mc3QnLFxuICAgIFtuYW1lJDFdOiAnZmlyZS1mc3QtY29tcGF0JyxcbiAgICBbbmFtZSQyXTogJ2ZpcmUtdmVydGV4JyxcbiAgICAnZmlyZS1qcyc6ICdmaXJlLWpzJywgLy8gUGxhdGZvcm0gaWRlbnRpZmllciBmb3IgSlMgU0RLLlxuICAgIFtuYW1lXTogJ2ZpcmUtanMtYWxsJ1xufTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQGludGVybmFsXG4gKi9cbmNvbnN0IF9hcHBzID0gbmV3IE1hcCgpO1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuY29uc3QgX3NlcnZlckFwcHMgPSBuZXcgTWFwKCk7XG4vKipcbiAqIFJlZ2lzdGVyZWQgY29tcG9uZW50cy5cbiAqXG4gKiBAaW50ZXJuYWxcbiAqL1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbmNvbnN0IF9jb21wb25lbnRzID0gbmV3IE1hcCgpO1xuLyoqXG4gKiBAcGFyYW0gY29tcG9uZW50IC0gdGhlIGNvbXBvbmVudCBiZWluZyBhZGRlZCB0byB0aGlzIGFwcCdzIGNvbnRhaW5lclxuICpcbiAqIEBpbnRlcm5hbFxuICovXG5mdW5jdGlvbiBfYWRkQ29tcG9uZW50KGFwcCwgY29tcG9uZW50KSB7XG4gICAgdHJ5IHtcbiAgICAgICAgYXBwLmNvbnRhaW5lci5hZGRDb21wb25lbnQoY29tcG9uZW50KTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgbG9nZ2VyLmRlYnVnKGBDb21wb25lbnQgJHtjb21wb25lbnQubmFtZX0gZmFpbGVkIHRvIHJlZ2lzdGVyIHdpdGggRmlyZWJhc2VBcHAgJHthcHAubmFtZX1gLCBlKTtcbiAgICB9XG59XG4vKipcbiAqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZnVuY3Rpb24gX2FkZE9yT3ZlcndyaXRlQ29tcG9uZW50KGFwcCwgY29tcG9uZW50KSB7XG4gICAgYXBwLmNvbnRhaW5lci5hZGRPck92ZXJ3cml0ZUNvbXBvbmVudChjb21wb25lbnQpO1xufVxuLyoqXG4gKlxuICogQHBhcmFtIGNvbXBvbmVudCAtIHRoZSBjb21wb25lbnQgdG8gcmVnaXN0ZXJcbiAqIEByZXR1cm5zIHdoZXRoZXIgb3Igbm90IHRoZSBjb21wb25lbnQgaXMgcmVnaXN0ZXJlZCBzdWNjZXNzZnVsbHlcbiAqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZnVuY3Rpb24gX3JlZ2lzdGVyQ29tcG9uZW50KGNvbXBvbmVudCkge1xuICAgIGNvbnN0IGNvbXBvbmVudE5hbWUgPSBjb21wb25lbnQubmFtZTtcbiAgICBpZiAoX2NvbXBvbmVudHMuaGFzKGNvbXBvbmVudE5hbWUpKSB7XG4gICAgICAgIGxvZ2dlci5kZWJ1ZyhgVGhlcmUgd2VyZSBtdWx0aXBsZSBhdHRlbXB0cyB0byByZWdpc3RlciBjb21wb25lbnQgJHtjb21wb25lbnROYW1lfS5gKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBfY29tcG9uZW50cy5zZXQoY29tcG9uZW50TmFtZSwgY29tcG9uZW50KTtcbiAgICAvLyBhZGQgdGhlIGNvbXBvbmVudCB0byBleGlzdGluZyBhcHAgaW5zdGFuY2VzXG4gICAgZm9yIChjb25zdCBhcHAgb2YgX2FwcHMudmFsdWVzKCkpIHtcbiAgICAgICAgX2FkZENvbXBvbmVudChhcHAsIGNvbXBvbmVudCk7XG4gICAgfVxuICAgIGZvciAoY29uc3Qgc2VydmVyQXBwIG9mIF9zZXJ2ZXJBcHBzLnZhbHVlcygpKSB7XG4gICAgICAgIF9hZGRDb21wb25lbnQoc2VydmVyQXBwLCBjb21wb25lbnQpO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cbi8qKlxuICpcbiAqIEBwYXJhbSBhcHAgLSBGaXJlYmFzZUFwcCBpbnN0YW5jZVxuICogQHBhcmFtIG5hbWUgLSBzZXJ2aWNlIG5hbWVcbiAqXG4gKiBAcmV0dXJucyB0aGUgcHJvdmlkZXIgZm9yIHRoZSBzZXJ2aWNlIHdpdGggdGhlIG1hdGNoaW5nIG5hbWVcbiAqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZnVuY3Rpb24gX2dldFByb3ZpZGVyKGFwcCwgbmFtZSkge1xuICAgIGNvbnN0IGhlYXJ0YmVhdENvbnRyb2xsZXIgPSBhcHAuY29udGFpbmVyXG4gICAgICAgIC5nZXRQcm92aWRlcignaGVhcnRiZWF0JylcbiAgICAgICAgLmdldEltbWVkaWF0ZSh7IG9wdGlvbmFsOiB0cnVlIH0pO1xuICAgIGlmIChoZWFydGJlYXRDb250cm9sbGVyKSB7XG4gICAgICAgIHZvaWQgaGVhcnRiZWF0Q29udHJvbGxlci50cmlnZ2VySGVhcnRiZWF0KCk7XG4gICAgfVxuICAgIHJldHVybiBhcHAuY29udGFpbmVyLmdldFByb3ZpZGVyKG5hbWUpO1xufVxuLyoqXG4gKlxuICogQHBhcmFtIGFwcCAtIEZpcmViYXNlQXBwIGluc3RhbmNlXG4gKiBAcGFyYW0gbmFtZSAtIHNlcnZpY2UgbmFtZVxuICogQHBhcmFtIGluc3RhbmNlSWRlbnRpZmllciAtIHNlcnZpY2UgaW5zdGFuY2UgaWRlbnRpZmllciBpbiBjYXNlIHRoZSBzZXJ2aWNlIHN1cHBvcnRzIG11bHRpcGxlIGluc3RhbmNlc1xuICpcbiAqIEBpbnRlcm5hbFxuICovXG5mdW5jdGlvbiBfcmVtb3ZlU2VydmljZUluc3RhbmNlKGFwcCwgbmFtZSwgaW5zdGFuY2VJZGVudGlmaWVyID0gREVGQVVMVF9FTlRSWV9OQU1FKSB7XG4gICAgX2dldFByb3ZpZGVyKGFwcCwgbmFtZSkuY2xlYXJJbnN0YW5jZShpbnN0YW5jZUlkZW50aWZpZXIpO1xufVxuLyoqXG4gKlxuICogQHBhcmFtIG9iaiAtIGFuIG9iamVjdCBvZiB0eXBlIEZpcmViYXNlQXBwLCBGaXJlYmFzZU9wdGlvbnMgb3IgRmlyZWJhc2VBcHBTZXR0aW5ncy5cbiAqXG4gKiBAcmV0dXJucyB0cnVlIGlmIHRoZSBwcm92aWRlIG9iamVjdCBpcyBvZiB0eXBlIEZpcmViYXNlQXBwLlxuICpcbiAqIEBpbnRlcm5hbFxuICovXG5mdW5jdGlvbiBfaXNGaXJlYmFzZUFwcChvYmopIHtcbiAgICByZXR1cm4gb2JqLm9wdGlvbnMgIT09IHVuZGVmaW5lZDtcbn1cbi8qKlxuICpcbiAqIEBwYXJhbSBvYmogLSBhbiBvYmplY3Qgb2YgdHlwZSBGaXJlYmFzZUFwcCwgRmlyZWJhc2VPcHRpb25zIG9yIEZpcmViYXNlQXBwU2V0dGluZ3MuXG4gKlxuICogQHJldHVybnMgdHJ1ZSBpZiB0aGUgcHJvdmlkZWQgb2JqZWN0IGlzIG9mIHR5cGUgRmlyZWJhc2VTZXJ2ZXJBcHBJbXBsLlxuICpcbiAqIEBpbnRlcm5hbFxuICovXG5mdW5jdGlvbiBfaXNGaXJlYmFzZVNlcnZlckFwcFNldHRpbmdzKG9iaikge1xuICAgIGlmIChfaXNGaXJlYmFzZUFwcChvYmopKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuICgnYXV0aElkVG9rZW4nIGluIG9iaiB8fFxuICAgICAgICAnYXBwQ2hlY2tUb2tlbicgaW4gb2JqIHx8XG4gICAgICAgICdyZWxlYXNlT25EZXJlZicgaW4gb2JqIHx8XG4gICAgICAgICdhdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQnIGluIG9iaik7XG59XG4vKipcbiAqXG4gKiBAcGFyYW0gb2JqIC0gYW4gb2JqZWN0IG9mIHR5cGUgRmlyZWJhc2VBcHAuXG4gKlxuICogQHJldHVybnMgdHJ1ZSBpZiB0aGUgcHJvdmlkZWQgb2JqZWN0IGlzIG9mIHR5cGUgRmlyZWJhc2VTZXJ2ZXJBcHBJbXBsLlxuICpcbiAqIEBpbnRlcm5hbFxuICovXG5mdW5jdGlvbiBfaXNGaXJlYmFzZVNlcnZlckFwcChvYmopIHtcbiAgICBpZiAob2JqID09PSBudWxsIHx8IG9iaiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIG9iai5zZXR0aW5ncyAhPT0gdW5kZWZpbmVkO1xufVxuLyoqXG4gKiBUZXN0IG9ubHlcbiAqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZnVuY3Rpb24gX2NsZWFyQ29tcG9uZW50cygpIHtcbiAgICBfY29tcG9uZW50cy5jbGVhcigpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY29uc3QgRVJST1JTID0ge1xuICAgIFtcIm5vLWFwcFwiIC8qIEFwcEVycm9yLk5PX0FQUCAqL106IFwiTm8gRmlyZWJhc2UgQXBwICd7JGFwcE5hbWV9JyBoYXMgYmVlbiBjcmVhdGVkIC0gXCIgK1xuICAgICAgICAnY2FsbCBpbml0aWFsaXplQXBwKCkgZmlyc3QnLFxuICAgIFtcImJhZC1hcHAtbmFtZVwiIC8qIEFwcEVycm9yLkJBRF9BUFBfTkFNRSAqL106IFwiSWxsZWdhbCBBcHAgbmFtZTogJ3skYXBwTmFtZX0nXCIsXG4gICAgW1wiZHVwbGljYXRlLWFwcFwiIC8qIEFwcEVycm9yLkRVUExJQ0FURV9BUFAgKi9dOiBcIkZpcmViYXNlIEFwcCBuYW1lZCAneyRhcHBOYW1lfScgYWxyZWFkeSBleGlzdHMgd2l0aCBkaWZmZXJlbnQgb3B0aW9ucyBvciBjb25maWdcIixcbiAgICBbXCJhcHAtZGVsZXRlZFwiIC8qIEFwcEVycm9yLkFQUF9ERUxFVEVEICovXTogXCJGaXJlYmFzZSBBcHAgbmFtZWQgJ3skYXBwTmFtZX0nIGFscmVhZHkgZGVsZXRlZFwiLFxuICAgIFtcInNlcnZlci1hcHAtZGVsZXRlZFwiIC8qIEFwcEVycm9yLlNFUlZFUl9BUFBfREVMRVRFRCAqL106ICdGaXJlYmFzZSBTZXJ2ZXIgQXBwIGhhcyBiZWVuIGRlbGV0ZWQnLFxuICAgIFtcIm5vLW9wdGlvbnNcIiAvKiBBcHBFcnJvci5OT19PUFRJT05TICovXTogJ05lZWQgdG8gcHJvdmlkZSBvcHRpb25zLCB3aGVuIG5vdCBiZWluZyBkZXBsb3llZCB0byBob3N0aW5nIHZpYSBzb3VyY2UuJyxcbiAgICBbXCJpbnZhbGlkLWFwcC1hcmd1bWVudFwiIC8qIEFwcEVycm9yLklOVkFMSURfQVBQX0FSR1VNRU5UICovXTogJ2ZpcmViYXNlLnskYXBwTmFtZX0oKSB0YWtlcyBlaXRoZXIgbm8gYXJndW1lbnQgb3IgYSAnICtcbiAgICAgICAgJ0ZpcmViYXNlIEFwcCBpbnN0YW5jZS4nLFxuICAgIFtcImludmFsaWQtbG9nLWFyZ3VtZW50XCIgLyogQXBwRXJyb3IuSU5WQUxJRF9MT0dfQVJHVU1FTlQgKi9dOiAnRmlyc3QgYXJndW1lbnQgdG8gYG9uTG9nYCBtdXN0IGJlIG51bGwgb3IgYSBmdW5jdGlvbi4nLFxuICAgIFtcImlkYi1vcGVuXCIgLyogQXBwRXJyb3IuSURCX09QRU4gKi9dOiAnRXJyb3IgdGhyb3duIHdoZW4gb3BlbmluZyBJbmRleGVkREIuIE9yaWdpbmFsIGVycm9yOiB7JG9yaWdpbmFsRXJyb3JNZXNzYWdlfS4nLFxuICAgIFtcImlkYi1nZXRcIiAvKiBBcHBFcnJvci5JREJfR0VUICovXTogJ0Vycm9yIHRocm93biB3aGVuIHJlYWRpbmcgZnJvbSBJbmRleGVkREIuIE9yaWdpbmFsIGVycm9yOiB7JG9yaWdpbmFsRXJyb3JNZXNzYWdlfS4nLFxuICAgIFtcImlkYi1zZXRcIiAvKiBBcHBFcnJvci5JREJfV1JJVEUgKi9dOiAnRXJyb3IgdGhyb3duIHdoZW4gd3JpdGluZyB0byBJbmRleGVkREIuIE9yaWdpbmFsIGVycm9yOiB7JG9yaWdpbmFsRXJyb3JNZXNzYWdlfS4nLFxuICAgIFtcImlkYi1kZWxldGVcIiAvKiBBcHBFcnJvci5JREJfREVMRVRFICovXTogJ0Vycm9yIHRocm93biB3aGVuIGRlbGV0aW5nIGZyb20gSW5kZXhlZERCLiBPcmlnaW5hbCBlcnJvcjogeyRvcmlnaW5hbEVycm9yTWVzc2FnZX0uJyxcbiAgICBbXCJmaW5hbGl6YXRpb24tcmVnaXN0cnktbm90LXN1cHBvcnRlZFwiIC8qIEFwcEVycm9yLkZJTkFMSVpBVElPTl9SRUdJU1RSWV9OT1RfU1VQUE9SVEVEICovXTogJ0ZpcmViYXNlU2VydmVyQXBwIGRlbGV0ZU9uRGVyZWYgZmllbGQgZGVmaW5lZCBidXQgdGhlIEpTIHJ1bnRpbWUgZG9lcyBub3Qgc3VwcG9ydCBGaW5hbGl6YXRpb25SZWdpc3RyeS4nLFxuICAgIFtcImludmFsaWQtc2VydmVyLWFwcC1lbnZpcm9ubWVudFwiIC8qIEFwcEVycm9yLklOVkFMSURfU0VSVkVSX0FQUF9FTlZJUk9OTUVOVCAqL106ICdGaXJlYmFzZVNlcnZlckFwcCBpcyBub3QgZm9yIHVzZSBpbiBicm93c2VyIGVudmlyb25tZW50cy4nXG59O1xuY29uc3QgRVJST1JfRkFDVE9SWSA9IG5ldyBFcnJvckZhY3RvcnkoJ2FwcCcsICdGaXJlYmFzZScsIEVSUk9SUyk7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jbGFzcyBGaXJlYmFzZUFwcEltcGwge1xuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMsIGNvbmZpZywgY29udGFpbmVyKSB7XG4gICAgICAgIHRoaXMuX2lzRGVsZXRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9vcHRpb25zID0geyAuLi5vcHRpb25zIH07XG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IHsgLi4uY29uZmlnIH07XG4gICAgICAgIHRoaXMuX25hbWUgPSBjb25maWcubmFtZTtcbiAgICAgICAgdGhpcy5fYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkID1cbiAgICAgICAgICAgIGNvbmZpZy5hdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQ7XG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICAgICAgdGhpcy5jb250YWluZXIuYWRkQ29tcG9uZW50KG5ldyBDb21wb25lbnQoJ2FwcCcsICgpID0+IHRoaXMsIFwiUFVCTElDXCIgLyogQ29tcG9uZW50VHlwZS5QVUJMSUMgKi8pKTtcbiAgICB9XG4gICAgZ2V0IGF1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCgpIHtcbiAgICAgICAgdGhpcy5jaGVja0Rlc3Ryb3llZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5fYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkO1xuICAgIH1cbiAgICBzZXQgYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkKHZhbCkge1xuICAgICAgICB0aGlzLmNoZWNrRGVzdHJveWVkKCk7XG4gICAgICAgIHRoaXMuX2F1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCA9IHZhbDtcbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHRoaXMuY2hlY2tEZXN0cm95ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX25hbWU7XG4gICAgfVxuICAgIGdldCBvcHRpb25zKCkge1xuICAgICAgICB0aGlzLmNoZWNrRGVzdHJveWVkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLl9vcHRpb25zO1xuICAgIH1cbiAgICBnZXQgY29uZmlnKCkge1xuICAgICAgICB0aGlzLmNoZWNrRGVzdHJveWVkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLl9jb25maWc7XG4gICAgfVxuICAgIGdldCBjb250YWluZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jb250YWluZXI7XG4gICAgfVxuICAgIGdldCBpc0RlbGV0ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pc0RlbGV0ZWQ7XG4gICAgfVxuICAgIHNldCBpc0RlbGV0ZWQodmFsKSB7XG4gICAgICAgIHRoaXMuX2lzRGVsZXRlZCA9IHZhbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhpcyBmdW5jdGlvbiB3aWxsIHRocm93IGFuIEVycm9yIGlmIHRoZSBBcHAgaGFzIGFscmVhZHkgYmVlbiBkZWxldGVkIC1cbiAgICAgKiB1c2UgYmVmb3JlIHBlcmZvcm1pbmcgQVBJIGFjdGlvbnMgb24gdGhlIEFwcC5cbiAgICAgKi9cbiAgICBjaGVja0Rlc3Ryb3llZCgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNEZWxldGVkKSB7XG4gICAgICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcImFwcC1kZWxldGVkXCIgLyogQXBwRXJyb3IuQVBQX0RFTEVURUQgKi8sIHsgYXBwTmFtZTogdGhpcy5fbmFtZSB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8vIFBhcnNlIHRoZSB0b2tlbiBhbmQgY2hlY2sgdG8gc2VlIGlmIHRoZSBgZXhwYCBjbGFpbSBpcyBpbiB0aGUgZnV0dXJlLlxuLy8gUmVwb3J0cyBhbiBlcnJvciB0byB0aGUgY29uc29sZSBpZiB0aGUgdG9rZW4gb3IgY2xhaW0gY291bGQgbm90IGJlIHBhcnNlZCwgb3IgaWYgYGV4cGAgaXMgaW5cbi8vIHRoZSBwYXN0LlxuZnVuY3Rpb24gdmFsaWRhdGVUb2tlblRUTChiYXNlNjRUb2tlbiwgdG9rZW5OYW1lKSB7XG4gICAgY29uc3Qgc2Vjb25kUGFydCA9IGJhc2U2NERlY29kZShiYXNlNjRUb2tlbi5zcGxpdCgnLicpWzFdKTtcbiAgICBpZiAoc2Vjb25kUGFydCA9PT0gbnVsbCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBGaXJlYmFzZVNlcnZlckFwcCAke3Rva2VuTmFtZX0gaXMgaW52YWxpZDogc2Vjb25kIHBhcnQgY291bGQgbm90IGJlIHBhcnNlZC5gKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBleHBDbGFpbSA9IEpTT04ucGFyc2Uoc2Vjb25kUGFydCkuZXhwO1xuICAgIGlmIChleHBDbGFpbSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYEZpcmViYXNlU2VydmVyQXBwICR7dG9rZW5OYW1lfSBpcyBpbnZhbGlkOiBleHBpcmF0aW9uIGNsYWltIGNvdWxkIG5vdCBiZSBwYXJzZWRgKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBleHAgPSBKU09OLnBhcnNlKHNlY29uZFBhcnQpLmV4cCAqIDEwMDA7XG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgY29uc3QgZGlmZiA9IGV4cCAtIG5vdztcbiAgICBpZiAoZGlmZiA8PSAwKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYEZpcmViYXNlU2VydmVyQXBwICR7dG9rZW5OYW1lfSBpcyBpbnZhbGlkOiB0aGUgdG9rZW4gaGFzIGV4cGlyZWQuYCk7XG4gICAgfVxufVxuY2xhc3MgRmlyZWJhc2VTZXJ2ZXJBcHBJbXBsIGV4dGVuZHMgRmlyZWJhc2VBcHBJbXBsIHtcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zLCBzZXJ2ZXJDb25maWcsIG5hbWUsIGNvbnRhaW5lcikge1xuICAgICAgICAvLyBCdWlsZCBjb25maWd1cmF0aW9uIHBhcmFtZXRlcnMgZm9yIHRoZSBGaXJlYmFzZUFwcEltcGwgYmFzZSBjbGFzcy5cbiAgICAgICAgY29uc3QgYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkID0gc2VydmVyQ29uZmlnLmF1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICA/IHNlcnZlckNvbmZpZy5hdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWRcbiAgICAgICAgICAgIDogdHJ1ZTtcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBGaXJlYmFzZUFwcFNldHRpbmdzIG9iamVjdCBmb3IgdGhlIEZpcmViYXNlQXBwSW1wIGNvbnN0cnVjdG9yLlxuICAgICAgICBjb25zdCBjb25maWcgPSB7XG4gICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkXG4gICAgICAgIH07XG4gICAgICAgIGlmIChvcHRpb25zLmFwaUtleSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAvLyBDb25zdHJ1Y3QgdGhlIHBhcmVudCBGaXJlYmFzZUFwcEltcCBvYmplY3QuXG4gICAgICAgICAgICBzdXBlcihvcHRpb25zLCBjb25maWcsIGNvbnRhaW5lcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBhcHBJbXBsID0gb3B0aW9ucztcbiAgICAgICAgICAgIHN1cGVyKGFwcEltcGwub3B0aW9ucywgY29uZmlnLCBjb250YWluZXIpO1xuICAgICAgICB9XG4gICAgICAgIC8vIE5vdyBjb25zdHJ1Y3QgdGhlIGRhdGEgZm9yIHRoZSBGaXJlYmFzZVNlcnZlckFwcEltcGwuXG4gICAgICAgIHRoaXMuX3NlcnZlckNvbmZpZyA9IHtcbiAgICAgICAgICAgIGF1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCxcbiAgICAgICAgICAgIC4uLnNlcnZlckNvbmZpZ1xuICAgICAgICB9O1xuICAgICAgICAvLyBFbnN1cmUgdGhhdCB0aGUgY3VycmVudCB0aW1lIGlzIHdpdGhpbiB0aGUgYGF1dGhJZHRva2VuYCB3aW5kb3cgb2YgdmFsaWRpdHkuXG4gICAgICAgIGlmICh0aGlzLl9zZXJ2ZXJDb25maWcuYXV0aElkVG9rZW4pIHtcbiAgICAgICAgICAgIHZhbGlkYXRlVG9rZW5UVEwodGhpcy5fc2VydmVyQ29uZmlnLmF1dGhJZFRva2VuLCAnYXV0aElkVG9rZW4nKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBFbnN1cmUgdGhhdCB0aGUgY3VycmVudCB0aW1lIGlzIHdpdGhpbiB0aGUgYGFwcENoZWNrVG9rZW5gIHdpbmRvdyBvZiB2YWxpZGl0eS5cbiAgICAgICAgaWYgKHRoaXMuX3NlcnZlckNvbmZpZy5hcHBDaGVja1Rva2VuKSB7XG4gICAgICAgICAgICB2YWxpZGF0ZVRva2VuVFRMKHRoaXMuX3NlcnZlckNvbmZpZy5hcHBDaGVja1Rva2VuLCAnYXBwQ2hlY2tUb2tlbicpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2ZpbmFsaXphdGlvblJlZ2lzdHJ5ID0gbnVsbDtcbiAgICAgICAgaWYgKHR5cGVvZiBGaW5hbGl6YXRpb25SZWdpc3RyeSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHRoaXMuX2ZpbmFsaXphdGlvblJlZ2lzdHJ5ID0gbmV3IEZpbmFsaXphdGlvblJlZ2lzdHJ5KCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmF1dG9tYXRpY0NsZWFudXAoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3JlZkNvdW50ID0gMDtcbiAgICAgICAgdGhpcy5pbmNSZWZDb3VudCh0aGlzLl9zZXJ2ZXJDb25maWcucmVsZWFzZU9uRGVyZWYpO1xuICAgICAgICAvLyBEbyBub3QgcmV0YWluIGEgaGFyZCByZWZlcmVuY2UgdG8gdGhlIGRyZWYgb2JqZWN0LCBvdGhlcndpc2UgdGhlIEZpbmFsaXphdGlvblJlZ2lzdHJ5XG4gICAgICAgIC8vIHdpbGwgbmV2ZXIgdHJpZ2dlci5cbiAgICAgICAgdGhpcy5fc2VydmVyQ29uZmlnLnJlbGVhc2VPbkRlcmVmID0gdW5kZWZpbmVkO1xuICAgICAgICBzZXJ2ZXJDb25maWcucmVsZWFzZU9uRGVyZWYgPSB1bmRlZmluZWQ7XG4gICAgICAgIHJlZ2lzdGVyVmVyc2lvbihuYW1lJHEsIHZlcnNpb24kMSwgJ3NlcnZlcmFwcCcpO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGdldCByZWZDb3VudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlZkNvdW50O1xuICAgIH1cbiAgICAvLyBJbmNyZW1lbnQgdGhlIHJlZmVyZW5jZSBjb3VudCBvZiB0aGlzIHNlcnZlciBhcHAuIElmIGFuIG9iamVjdCBpcyBwcm92aWRlZCwgcmVnaXN0ZXIgaXRcbiAgICAvLyB3aXRoIHRoZSBmaW5hbGl6YXRpb24gcmVnaXN0cnkuXG4gICAgaW5jUmVmQ291bnQob2JqKSB7XG4gICAgICAgIGlmICh0aGlzLmlzRGVsZXRlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3JlZkNvdW50Kys7XG4gICAgICAgIGlmIChvYmogIT09IHVuZGVmaW5lZCAmJiB0aGlzLl9maW5hbGl6YXRpb25SZWdpc3RyeSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5fZmluYWxpemF0aW9uUmVnaXN0cnkucmVnaXN0ZXIob2JqLCB0aGlzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBEZWNyZW1lbnQgdGhlIHJlZmVyZW5jZSBjb3VudC5cbiAgICBkZWNSZWZDb3VudCgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNEZWxldGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLS10aGlzLl9yZWZDb3VudDtcbiAgICB9XG4gICAgLy8gSW52b2tlZCBieSB0aGUgRmluYWxpemF0aW9uUmVnaXN0cnkgY2FsbGJhY2sgdG8gbm90ZSB0aGF0IHRoaXMgYXBwIHNob3VsZCBnbyB0aHJvdWdoIGl0c1xuICAgIC8vIHJlZmVyZW5jZSBjb3VudHMgYW5kIGRlbGV0ZSBpdHNlbGYgaWYgbm8gcmVmZXJlbmNlIGNvdW50IHJlbWFpbi4gVGhlIGNvb3JkaW5hdGluZyBsb2dpYyB0aGF0XG4gICAgLy8gaGFuZGxlcyB0aGlzIGlzIGluIGRlbGV0ZUFwcCguLi4pLlxuICAgIGF1dG9tYXRpY0NsZWFudXAoKSB7XG4gICAgICAgIHZvaWQgZGVsZXRlQXBwKHRoaXMpO1xuICAgIH1cbiAgICBnZXQgc2V0dGluZ3MoKSB7XG4gICAgICAgIHRoaXMuY2hlY2tEZXN0cm95ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NlcnZlckNvbmZpZztcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhpcyBmdW5jdGlvbiB3aWxsIHRocm93IGFuIEVycm9yIGlmIHRoZSBBcHAgaGFzIGFscmVhZHkgYmVlbiBkZWxldGVkIC1cbiAgICAgKiB1c2UgYmVmb3JlIHBlcmZvcm1pbmcgQVBJIGFjdGlvbnMgb24gdGhlIEFwcC5cbiAgICAgKi9cbiAgICBjaGVja0Rlc3Ryb3llZCgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNEZWxldGVkKSB7XG4gICAgICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcInNlcnZlci1hcHAtZGVsZXRlZFwiIC8qIEFwcEVycm9yLlNFUlZFUl9BUFBfREVMRVRFRCAqLyk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFRoZSBjdXJyZW50IFNESyB2ZXJzaW9uLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuY29uc3QgU0RLX1ZFUlNJT04gPSB2ZXJzaW9uO1xuZnVuY3Rpb24gaW5pdGlhbGl6ZUFwcChfb3B0aW9ucywgcmF3Q29uZmlnID0ge30pIHtcbiAgICBsZXQgb3B0aW9ucyA9IF9vcHRpb25zO1xuICAgIGlmICh0eXBlb2YgcmF3Q29uZmlnICE9PSAnb2JqZWN0Jykge1xuICAgICAgICBjb25zdCBuYW1lID0gcmF3Q29uZmlnO1xuICAgICAgICByYXdDb25maWcgPSB7IG5hbWUgfTtcbiAgICB9XG4gICAgY29uc3QgY29uZmlnID0ge1xuICAgICAgICBuYW1lOiBERUZBVUxUX0VOVFJZX05BTUUsXG4gICAgICAgIGF1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgLi4ucmF3Q29uZmlnXG4gICAgfTtcbiAgICBjb25zdCBuYW1lID0gY29uZmlnLm5hbWU7XG4gICAgaWYgKHR5cGVvZiBuYW1lICE9PSAnc3RyaW5nJyB8fCAhbmFtZSkge1xuICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcImJhZC1hcHAtbmFtZVwiIC8qIEFwcEVycm9yLkJBRF9BUFBfTkFNRSAqLywge1xuICAgICAgICAgICAgYXBwTmFtZTogU3RyaW5nKG5hbWUpXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBvcHRpb25zIHx8IChvcHRpb25zID0gZ2V0RGVmYXVsdEFwcENvbmZpZygpKTtcbiAgICBpZiAoIW9wdGlvbnMpIHtcbiAgICAgICAgdGhyb3cgRVJST1JfRkFDVE9SWS5jcmVhdGUoXCJuby1vcHRpb25zXCIgLyogQXBwRXJyb3IuTk9fT1BUSU9OUyAqLyk7XG4gICAgfVxuICAgIGNvbnN0IGV4aXN0aW5nQXBwID0gX2FwcHMuZ2V0KG5hbWUpO1xuICAgIGlmIChleGlzdGluZ0FwcCkge1xuICAgICAgICAvLyByZXR1cm4gdGhlIGV4aXN0aW5nIGFwcCBpZiBvcHRpb25zIGFuZCBjb25maWcgZGVlcCBlcXVhbCB0aGUgb25lcyBpbiB0aGUgZXhpc3RpbmcgYXBwLlxuICAgICAgICBpZiAoZGVlcEVxdWFsKG9wdGlvbnMsIGV4aXN0aW5nQXBwLm9wdGlvbnMpICYmXG4gICAgICAgICAgICBkZWVwRXF1YWwoY29uZmlnLCBleGlzdGluZ0FwcC5jb25maWcpKSB7XG4gICAgICAgICAgICByZXR1cm4gZXhpc3RpbmdBcHA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcImR1cGxpY2F0ZS1hcHBcIiAvKiBBcHBFcnJvci5EVVBMSUNBVEVfQVBQICovLCB7IGFwcE5hbWU6IG5hbWUgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgY29udGFpbmVyID0gbmV3IENvbXBvbmVudENvbnRhaW5lcihuYW1lKTtcbiAgICBmb3IgKGNvbnN0IGNvbXBvbmVudCBvZiBfY29tcG9uZW50cy52YWx1ZXMoKSkge1xuICAgICAgICBjb250YWluZXIuYWRkQ29tcG9uZW50KGNvbXBvbmVudCk7XG4gICAgfVxuICAgIGNvbnN0IG5ld0FwcCA9IG5ldyBGaXJlYmFzZUFwcEltcGwob3B0aW9ucywgY29uZmlnLCBjb250YWluZXIpO1xuICAgIF9hcHBzLnNldChuYW1lLCBuZXdBcHApO1xuICAgIHJldHVybiBuZXdBcHA7XG59XG5mdW5jdGlvbiBpbml0aWFsaXplU2VydmVyQXBwKF9vcHRpb25zLCBfc2VydmVyQXBwQ29uZmlnID0ge30pIHtcbiAgICBpZiAoaXNCcm93c2VyKCkgJiYgIWlzV2ViV29ya2VyKCkpIHtcbiAgICAgICAgLy8gRmlyZWJhc2VTZXJ2ZXJBcHAgaXNuJ3QgZGVzaWduZWQgdG8gYmUgcnVuIGluIGJyb3dzZXJzLlxuICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcImludmFsaWQtc2VydmVyLWFwcC1lbnZpcm9ubWVudFwiIC8qIEFwcEVycm9yLklOVkFMSURfU0VSVkVSX0FQUF9FTlZJUk9OTUVOVCAqLyk7XG4gICAgfVxuICAgIGxldCBmaXJlYmFzZU9wdGlvbnM7XG4gICAgbGV0IHNlcnZlckFwcFNldHRpbmdzID0gX3NlcnZlckFwcENvbmZpZyB8fCB7fTtcbiAgICBpZiAoX29wdGlvbnMpIHtcbiAgICAgICAgaWYgKF9pc0ZpcmViYXNlQXBwKF9vcHRpb25zKSkge1xuICAgICAgICAgICAgZmlyZWJhc2VPcHRpb25zID0gX29wdGlvbnMub3B0aW9ucztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChfaXNGaXJlYmFzZVNlcnZlckFwcFNldHRpbmdzKF9vcHRpb25zKSkge1xuICAgICAgICAgICAgc2VydmVyQXBwU2V0dGluZ3MgPSBfb3B0aW9ucztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGZpcmViYXNlT3B0aW9ucyA9IF9vcHRpb25zO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChzZXJ2ZXJBcHBTZXR0aW5ncy5hdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBzZXJ2ZXJBcHBTZXR0aW5ncy5hdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQgPSB0cnVlO1xuICAgIH1cbiAgICBmaXJlYmFzZU9wdGlvbnMgfHwgKGZpcmViYXNlT3B0aW9ucyA9IGdldERlZmF1bHRBcHBDb25maWcoKSk7XG4gICAgaWYgKCFmaXJlYmFzZU9wdGlvbnMpIHtcbiAgICAgICAgdGhyb3cgRVJST1JfRkFDVE9SWS5jcmVhdGUoXCJuby1vcHRpb25zXCIgLyogQXBwRXJyb3IuTk9fT1BUSU9OUyAqLyk7XG4gICAgfVxuICAgIC8vIEJ1aWxkIGFuIGFwcCBuYW1lIGJhc2VkIG9uIGEgaGFzaCBvZiB0aGUgY29uZmlndXJhdGlvbiBvcHRpb25zLlxuICAgIGNvbnN0IG5hbWVPYmogPSB7XG4gICAgICAgIC4uLnNlcnZlckFwcFNldHRpbmdzLFxuICAgICAgICAuLi5maXJlYmFzZU9wdGlvbnNcbiAgICB9O1xuICAgIC8vIEhvd2V2ZXIsIERvIG5vdCBtYW5nbGUgdGhlIG5hbWUgYmFzZWQgb24gcmVsZWFzZU9uRGVyZWYsIHNpbmNlIGl0IHdpbGwgdmFyeSBiZXR3ZWVuIHRoZVxuICAgIC8vIGNvbnN0cnVjdGlvbiBvZiBGaXJlYmFzZVNlcnZlckFwcCBpbnN0YW5jZXMuIEZvciBleGFtcGxlLCBpZiB0aGUgb2JqZWN0IGlzIHRoZSByZXF1ZXN0IGhlYWRlcnMuXG4gICAgaWYgKG5hbWVPYmoucmVsZWFzZU9uRGVyZWYgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBkZWxldGUgbmFtZU9iai5yZWxlYXNlT25EZXJlZjtcbiAgICB9XG4gICAgY29uc3QgaGFzaENvZGUgPSAocykgPT4ge1xuICAgICAgICByZXR1cm4gWy4uLnNdLnJlZHVjZSgoaGFzaCwgYykgPT4gKE1hdGguaW11bCgzMSwgaGFzaCkgKyBjLmNoYXJDb2RlQXQoMCkpIHwgMCwgMCk7XG4gICAgfTtcbiAgICBpZiAoc2VydmVyQXBwU2V0dGluZ3MucmVsZWFzZU9uRGVyZWYgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAodHlwZW9mIEZpbmFsaXphdGlvblJlZ2lzdHJ5ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgdGhyb3cgRVJST1JfRkFDVE9SWS5jcmVhdGUoXCJmaW5hbGl6YXRpb24tcmVnaXN0cnktbm90LXN1cHBvcnRlZFwiIC8qIEFwcEVycm9yLkZJTkFMSVpBVElPTl9SRUdJU1RSWV9OT1RfU1VQUE9SVEVEICovLCB7fSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgbmFtZVN0cmluZyA9ICcnICsgaGFzaENvZGUoSlNPTi5zdHJpbmdpZnkobmFtZU9iaikpO1xuICAgIGNvbnN0IGV4aXN0aW5nQXBwID0gX3NlcnZlckFwcHMuZ2V0KG5hbWVTdHJpbmcpO1xuICAgIGlmIChleGlzdGluZ0FwcCkge1xuICAgICAgICBleGlzdGluZ0FwcC5pbmNSZWZDb3VudChzZXJ2ZXJBcHBTZXR0aW5ncy5yZWxlYXNlT25EZXJlZik7XG4gICAgICAgIHJldHVybiBleGlzdGluZ0FwcDtcbiAgICB9XG4gICAgY29uc3QgY29udGFpbmVyID0gbmV3IENvbXBvbmVudENvbnRhaW5lcihuYW1lU3RyaW5nKTtcbiAgICBmb3IgKGNvbnN0IGNvbXBvbmVudCBvZiBfY29tcG9uZW50cy52YWx1ZXMoKSkge1xuICAgICAgICBjb250YWluZXIuYWRkQ29tcG9uZW50KGNvbXBvbmVudCk7XG4gICAgfVxuICAgIGNvbnN0IG5ld0FwcCA9IG5ldyBGaXJlYmFzZVNlcnZlckFwcEltcGwoZmlyZWJhc2VPcHRpb25zLCBzZXJ2ZXJBcHBTZXR0aW5ncywgbmFtZVN0cmluZywgY29udGFpbmVyKTtcbiAgICBfc2VydmVyQXBwcy5zZXQobmFtZVN0cmluZywgbmV3QXBwKTtcbiAgICByZXR1cm4gbmV3QXBwO1xufVxuLyoqXG4gKiBSZXRyaWV2ZXMgYSB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZUFwcH0gaW5zdGFuY2UuXG4gKlxuICogV2hlbiBjYWxsZWQgd2l0aCBubyBhcmd1bWVudHMsIHRoZSBkZWZhdWx0IGFwcCBpcyByZXR1cm5lZC4gV2hlbiBhbiBhcHAgbmFtZVxuICogaXMgcHJvdmlkZWQsIHRoZSBhcHAgY29ycmVzcG9uZGluZyB0byB0aGF0IG5hbWUgaXMgcmV0dXJuZWQuXG4gKlxuICogQW4gZXhjZXB0aW9uIGlzIHRocm93biBpZiB0aGUgYXBwIGJlaW5nIHJldHJpZXZlZCBoYXMgbm90IHlldCBiZWVuXG4gKiBpbml0aWFsaXplZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gUmV0dXJuIHRoZSBkZWZhdWx0IGFwcFxuICogY29uc3QgYXBwID0gZ2V0QXBwKCk7XG4gKiBgYGBcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gUmV0dXJuIGEgbmFtZWQgYXBwXG4gKiBjb25zdCBvdGhlckFwcCA9IGdldEFwcChcIm90aGVyQXBwXCIpO1xuICogYGBgXG4gKlxuICogQHBhcmFtIG5hbWUgLSBPcHRpb25hbCBuYW1lIG9mIHRoZSBhcHAgdG8gcmV0dXJuLiBJZiBubyBuYW1lIGlzXG4gKiAgIHByb3ZpZGVkLCB0aGUgZGVmYXVsdCBpcyBgXCJbREVGQVVMVF1cImAuXG4gKlxuICogQHJldHVybnMgVGhlIGFwcCBjb3JyZXNwb25kaW5nIHRvIHRoZSBwcm92aWRlZCBhcHAgbmFtZS5cbiAqICAgSWYgbm8gYXBwIG5hbWUgaXMgcHJvdmlkZWQsIHRoZSBkZWZhdWx0IGFwcCBpcyByZXR1cm5lZC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIGdldEFwcChuYW1lID0gREVGQVVMVF9FTlRSWV9OQU1FKSB7XG4gICAgY29uc3QgYXBwID0gX2FwcHMuZ2V0KG5hbWUpO1xuICAgIGlmICghYXBwICYmIG5hbWUgPT09IERFRkFVTFRfRU5UUllfTkFNRSAmJiBnZXREZWZhdWx0QXBwQ29uZmlnKCkpIHtcbiAgICAgICAgcmV0dXJuIGluaXRpYWxpemVBcHAoKTtcbiAgICB9XG4gICAgaWYgKCFhcHApIHtcbiAgICAgICAgdGhyb3cgRVJST1JfRkFDVE9SWS5jcmVhdGUoXCJuby1hcHBcIiAvKiBBcHBFcnJvci5OT19BUFAgKi8sIHsgYXBwTmFtZTogbmFtZSB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGFwcDtcbn1cbi8qKlxuICogQSAocmVhZC1vbmx5KSBhcnJheSBvZiBhbGwgaW5pdGlhbGl6ZWQgYXBwcy5cbiAqIEBwdWJsaWNcbiAqL1xuZnVuY3Rpb24gZ2V0QXBwcygpIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShfYXBwcy52YWx1ZXMoKSk7XG59XG4vKipcbiAqIFJlbmRlcnMgdGhpcyBhcHAgdW51c2FibGUgYW5kIGZyZWVzIHRoZSByZXNvdXJjZXMgb2YgYWxsIGFzc29jaWF0ZWRcbiAqIHNlcnZpY2VzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiBkZWxldGVBcHAoYXBwKVxuICogICAudGhlbihmdW5jdGlvbigpIHtcbiAqICAgICBjb25zb2xlLmxvZyhcIkFwcCBkZWxldGVkIHN1Y2Nlc3NmdWxseVwiKTtcbiAqICAgfSlcbiAqICAgLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gKiAgICAgY29uc29sZS5sb2coXCJFcnJvciBkZWxldGluZyBhcHA6XCIsIGVycm9yKTtcbiAqICAgfSk7XG4gKiBgYGBcbiAqXG4gKiBAcHVibGljXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUFwcChhcHApIHtcbiAgICBsZXQgY2xlYW51cFByb3ZpZGVycyA9IGZhbHNlO1xuICAgIGNvbnN0IG5hbWUgPSBhcHAubmFtZTtcbiAgICBpZiAoX2FwcHMuaGFzKG5hbWUpKSB7XG4gICAgICAgIGNsZWFudXBQcm92aWRlcnMgPSB0cnVlO1xuICAgICAgICBfYXBwcy5kZWxldGUobmFtZSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKF9zZXJ2ZXJBcHBzLmhhcyhuYW1lKSkge1xuICAgICAgICBjb25zdCBmaXJlYmFzZVNlcnZlckFwcCA9IGFwcDtcbiAgICAgICAgaWYgKGZpcmViYXNlU2VydmVyQXBwLmRlY1JlZkNvdW50KCkgPD0gMCkge1xuICAgICAgICAgICAgX3NlcnZlckFwcHMuZGVsZXRlKG5hbWUpO1xuICAgICAgICAgICAgY2xlYW51cFByb3ZpZGVycyA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGNsZWFudXBQcm92aWRlcnMpIHtcbiAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoYXBwLmNvbnRhaW5lclxuICAgICAgICAgICAgLmdldFByb3ZpZGVycygpXG4gICAgICAgICAgICAubWFwKHByb3ZpZGVyID0+IHByb3ZpZGVyLmRlbGV0ZSgpKSk7XG4gICAgICAgIGFwcC5pc0RlbGV0ZWQgPSB0cnVlO1xuICAgIH1cbn1cbi8qKlxuICogUmVnaXN0ZXJzIGEgbGlicmFyeSdzIG5hbWUgYW5kIHZlcnNpb24gZm9yIHBsYXRmb3JtIGxvZ2dpbmcgcHVycG9zZXMuXG4gKiBAcGFyYW0gbGlicmFyeSAtIE5hbWUgb2YgMXAgb3IgM3AgbGlicmFyeSAoZS5nLiBmaXJlc3RvcmUsIGFuZ3VsYXJmaXJlKVxuICogQHBhcmFtIHZlcnNpb24gLSBDdXJyZW50IHZlcnNpb24gb2YgdGhhdCBsaWJyYXJ5LlxuICogQHBhcmFtIHZhcmlhbnQgLSBCdW5kbGUgdmFyaWFudCwgZS5nLiwgbm9kZSwgcm4sIGV0Yy5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIHJlZ2lzdGVyVmVyc2lvbihsaWJyYXJ5S2V5T3JOYW1lLCB2ZXJzaW9uLCB2YXJpYW50KSB7XG4gICAgLy8gVE9ETzogV2UgY2FuIHVzZSB0aGlzIGNoZWNrIHRvIHdoaXRlbGlzdCBzdHJpbmdzIHdoZW4vaWYgd2Ugc2V0IHVwXG4gICAgLy8gYSBnb29kIHdoaXRlbGlzdCBzeXN0ZW0uXG4gICAgbGV0IGxpYnJhcnkgPSBQTEFURk9STV9MT0dfU1RSSU5HW2xpYnJhcnlLZXlPck5hbWVdID8/IGxpYnJhcnlLZXlPck5hbWU7XG4gICAgaWYgKHZhcmlhbnQpIHtcbiAgICAgICAgbGlicmFyeSArPSBgLSR7dmFyaWFudH1gO1xuICAgIH1cbiAgICBjb25zdCBsaWJyYXJ5TWlzbWF0Y2ggPSBsaWJyYXJ5Lm1hdGNoKC9cXHN8XFwvLyk7XG4gICAgY29uc3QgdmVyc2lvbk1pc21hdGNoID0gdmVyc2lvbi5tYXRjaCgvXFxzfFxcLy8pO1xuICAgIGlmIChsaWJyYXJ5TWlzbWF0Y2ggfHwgdmVyc2lvbk1pc21hdGNoKSB7XG4gICAgICAgIGNvbnN0IHdhcm5pbmcgPSBbXG4gICAgICAgICAgICBgVW5hYmxlIHRvIHJlZ2lzdGVyIGxpYnJhcnkgXCIke2xpYnJhcnl9XCIgd2l0aCB2ZXJzaW9uIFwiJHt2ZXJzaW9ufVwiOmBcbiAgICAgICAgXTtcbiAgICAgICAgaWYgKGxpYnJhcnlNaXNtYXRjaCkge1xuICAgICAgICAgICAgd2FybmluZy5wdXNoKGBsaWJyYXJ5IG5hbWUgXCIke2xpYnJhcnl9XCIgY29udGFpbnMgaWxsZWdhbCBjaGFyYWN0ZXJzICh3aGl0ZXNwYWNlIG9yIFwiL1wiKWApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsaWJyYXJ5TWlzbWF0Y2ggJiYgdmVyc2lvbk1pc21hdGNoKSB7XG4gICAgICAgICAgICB3YXJuaW5nLnB1c2goJ2FuZCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2ZXJzaW9uTWlzbWF0Y2gpIHtcbiAgICAgICAgICAgIHdhcm5pbmcucHVzaChgdmVyc2lvbiBuYW1lIFwiJHt2ZXJzaW9ufVwiIGNvbnRhaW5zIGlsbGVnYWwgY2hhcmFjdGVycyAod2hpdGVzcGFjZSBvciBcIi9cIilgKTtcbiAgICAgICAgfVxuICAgICAgICBsb2dnZXIud2Fybih3YXJuaW5nLmpvaW4oJyAnKSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgX3JlZ2lzdGVyQ29tcG9uZW50KG5ldyBDb21wb25lbnQoYCR7bGlicmFyeX0tdmVyc2lvbmAsICgpID0+ICh7IGxpYnJhcnksIHZlcnNpb24gfSksIFwiVkVSU0lPTlwiIC8qIENvbXBvbmVudFR5cGUuVkVSU0lPTiAqLykpO1xufVxuLyoqXG4gKiBTZXRzIGxvZyBoYW5kbGVyIGZvciBhbGwgRmlyZWJhc2UgU0RLcy5cbiAqIEBwYXJhbSBsb2dDYWxsYmFjayAtIEFuIG9wdGlvbmFsIGN1c3RvbSBsb2cgaGFuZGxlciB0aGF0IGV4ZWN1dGVzIHVzZXIgY29kZSB3aGVuZXZlclxuICogdGhlIEZpcmViYXNlIFNESyBtYWtlcyBhIGxvZ2dpbmcgY2FsbC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIG9uTG9nKGxvZ0NhbGxiYWNrLCBvcHRpb25zKSB7XG4gICAgaWYgKGxvZ0NhbGxiYWNrICE9PSBudWxsICYmIHR5cGVvZiBsb2dDYWxsYmFjayAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcImludmFsaWQtbG9nLWFyZ3VtZW50XCIgLyogQXBwRXJyb3IuSU5WQUxJRF9MT0dfQVJHVU1FTlQgKi8pO1xuICAgIH1cbiAgICBzZXRVc2VyTG9nSGFuZGxlcihsb2dDYWxsYmFjaywgb3B0aW9ucyk7XG59XG4vKipcbiAqIFNldHMgbG9nIGxldmVsIGZvciBhbGwgRmlyZWJhc2UgU0RLcy5cbiAqXG4gKiBBbGwgb2YgdGhlIGxvZyB0eXBlcyBhYm92ZSB0aGUgY3VycmVudCBsb2cgbGV2ZWwgYXJlIGNhcHR1cmVkIChpLmUuIGlmXG4gKiB5b3Ugc2V0IHRoZSBsb2cgbGV2ZWwgdG8gYGluZm9gLCBlcnJvcnMgYXJlIGxvZ2dlZCwgYnV0IGBkZWJ1Z2AgYW5kXG4gKiBgdmVyYm9zZWAgbG9ncyBhcmUgbm90KS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmZ1bmN0aW9uIHNldExvZ0xldmVsKGxvZ0xldmVsKSB7XG4gICAgc2V0TG9nTGV2ZWwkMShsb2dMZXZlbCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIxIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jb25zdCBEQl9OQU1FID0gJ2ZpcmViYXNlLWhlYXJ0YmVhdC1kYXRhYmFzZSc7XG5jb25zdCBEQl9WRVJTSU9OID0gMTtcbmNvbnN0IFNUT1JFX05BTUUgPSAnZmlyZWJhc2UtaGVhcnRiZWF0LXN0b3JlJztcbmxldCBkYlByb21pc2UgPSBudWxsO1xuZnVuY3Rpb24gZ2V0RGJQcm9taXNlKCkge1xuICAgIGlmICghZGJQcm9taXNlKSB7XG4gICAgICAgIGRiUHJvbWlzZSA9IG9wZW5EQihEQl9OQU1FLCBEQl9WRVJTSU9OLCB7XG4gICAgICAgICAgICB1cGdyYWRlOiAoZGIsIG9sZFZlcnNpb24pID0+IHtcbiAgICAgICAgICAgICAgICAvLyBXZSBkb24ndCB1c2UgJ2JyZWFrJyBpbiB0aGlzIHN3aXRjaCBzdGF0ZW1lbnQsIHRoZSBmYWxsLXRocm91Z2hcbiAgICAgICAgICAgICAgICAvLyBiZWhhdmlvciBpcyB3aGF0IHdlIHdhbnQsIGJlY2F1c2UgaWYgdGhlcmUgYXJlIG11bHRpcGxlIHZlcnNpb25zIGJldHdlZW5cbiAgICAgICAgICAgICAgICAvLyB0aGUgb2xkIHZlcnNpb24gYW5kIHRoZSBjdXJyZW50IHZlcnNpb24sIHdlIHdhbnQgQUxMIHRoZSBtaWdyYXRpb25zXG4gICAgICAgICAgICAgICAgLy8gdGhhdCBjb3JyZXNwb25kIHRvIHRob3NlIHZlcnNpb25zIHRvIHJ1biwgbm90IG9ubHkgdGhlIGxhc3Qgb25lLlxuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZWZhdWx0LWNhc2VcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9sZFZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYi5jcmVhdGVPYmplY3RTdG9yZShTVE9SRV9OQU1FKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2FmYXJpL2lPUyBicm93c2VycyB0aHJvdyBvY2Nhc2lvbmFsIGV4Y2VwdGlvbnMgb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBkYi5jcmVhdGVPYmplY3RTdG9yZSgpIHRoYXQgbWF5IGJlIGEgYnVnLiBBdm9pZCBibG9ja2luZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSByZXN0IG9mIHRoZSBhcHAgZnVuY3Rpb25hbGl0eS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KS5jYXRjaChlID0+IHtcbiAgICAgICAgICAgIHRocm93IEVSUk9SX0ZBQ1RPUlkuY3JlYXRlKFwiaWRiLW9wZW5cIiAvKiBBcHBFcnJvci5JREJfT1BFTiAqLywge1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsRXJyb3JNZXNzYWdlOiBlLm1lc3NhZ2VcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGRiUHJvbWlzZTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHJlYWRIZWFydGJlYXRzRnJvbUluZGV4ZWREQihhcHApIHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBkYiA9IGF3YWl0IGdldERiUHJvbWlzZSgpO1xuICAgICAgICBjb25zdCB0eCA9IGRiLnRyYW5zYWN0aW9uKFNUT1JFX05BTUUpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0eC5vYmplY3RTdG9yZShTVE9SRV9OQU1FKS5nZXQoY29tcHV0ZUtleShhcHApKTtcbiAgICAgICAgLy8gV2UgYWxyZWFkeSBoYXZlIHRoZSB2YWx1ZSBidXQgdHguZG9uZSBjYW4gdGhyb3csXG4gICAgICAgIC8vIHNvIHdlIG5lZWQgdG8gYXdhaXQgaXQgaGVyZSB0byBjYXRjaCBlcnJvcnNcbiAgICAgICAgYXdhaXQgdHguZG9uZTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBGaXJlYmFzZUVycm9yKSB7XG4gICAgICAgICAgICBsb2dnZXIud2FybihlLm1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgaWRiR2V0RXJyb3IgPSBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcImlkYi1nZXRcIiAvKiBBcHBFcnJvci5JREJfR0VUICovLCB7XG4gICAgICAgICAgICAgICAgb3JpZ2luYWxFcnJvck1lc3NhZ2U6IGU/Lm1lc3NhZ2VcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbG9nZ2VyLndhcm4oaWRiR2V0RXJyb3IubWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5hc3luYyBmdW5jdGlvbiB3cml0ZUhlYXJ0YmVhdHNUb0luZGV4ZWREQihhcHAsIGhlYXJ0YmVhdE9iamVjdCkge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGRiID0gYXdhaXQgZ2V0RGJQcm9taXNlKCk7XG4gICAgICAgIGNvbnN0IHR4ID0gZGIudHJhbnNhY3Rpb24oU1RPUkVfTkFNRSwgJ3JlYWR3cml0ZScpO1xuICAgICAgICBjb25zdCBvYmplY3RTdG9yZSA9IHR4Lm9iamVjdFN0b3JlKFNUT1JFX05BTUUpO1xuICAgICAgICBhd2FpdCBvYmplY3RTdG9yZS5wdXQoaGVhcnRiZWF0T2JqZWN0LCBjb21wdXRlS2V5KGFwcCkpO1xuICAgICAgICBhd2FpdCB0eC5kb25lO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEZpcmViYXNlRXJyb3IpIHtcbiAgICAgICAgICAgIGxvZ2dlci53YXJuKGUubWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBpZGJHZXRFcnJvciA9IEVSUk9SX0ZBQ1RPUlkuY3JlYXRlKFwiaWRiLXNldFwiIC8qIEFwcEVycm9yLklEQl9XUklURSAqLywge1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsRXJyb3JNZXNzYWdlOiBlPy5tZXNzYWdlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGxvZ2dlci53YXJuKGlkYkdldEVycm9yLm1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gY29tcHV0ZUtleShhcHApIHtcbiAgICByZXR1cm4gYCR7YXBwLm5hbWV9ISR7YXBwLm9wdGlvbnMuYXBwSWR9YDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IE1BWF9IRUFERVJfQllURVMgPSAxMDI0O1xuY29uc3QgTUFYX05VTV9TVE9SRURfSEVBUlRCRUFUUyA9IDMwO1xuY2xhc3MgSGVhcnRiZWF0U2VydmljZUltcGwge1xuICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lcikge1xuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluLW1lbW9yeSBjYWNoZSBmb3IgaGVhcnRiZWF0cywgdXNlZCBieSBnZXRIZWFydGJlYXRzSGVhZGVyKCkgdG8gZ2VuZXJhdGVcbiAgICAgICAgICogdGhlIGhlYWRlciBzdHJpbmcuXG4gICAgICAgICAqIFN0b3JlcyBvbmUgcmVjb3JkIHBlciBkYXRlLiBUaGlzIHdpbGwgYmUgY29uc29saWRhdGVkIGludG8gdGhlIHN0YW5kYXJkXG4gICAgICAgICAqIGZvcm1hdCBvZiBvbmUgcmVjb3JkIHBlciB1c2VyIGFnZW50IHN0cmluZyBiZWZvcmUgYmVpbmcgc2VudCBhcyBhIGhlYWRlci5cbiAgICAgICAgICogUG9wdWxhdGVkIGZyb20gaW5kZXhlZERCIHdoZW4gdGhlIGNvbnRyb2xsZXIgaXMgaW5zdGFudGlhdGVkIGFuZCBzaG91bGRcbiAgICAgICAgICogYmUga2VwdCBpbiBzeW5jIHdpdGggaW5kZXhlZERCLlxuICAgICAgICAgKiBMZWF2ZSBwdWJsaWMgZm9yIGVhc2llciB0ZXN0aW5nLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5faGVhcnRiZWF0c0NhY2hlID0gbnVsbDtcbiAgICAgICAgY29uc3QgYXBwID0gdGhpcy5jb250YWluZXIuZ2V0UHJvdmlkZXIoJ2FwcCcpLmdldEltbWVkaWF0ZSgpO1xuICAgICAgICB0aGlzLl9zdG9yYWdlID0gbmV3IEhlYXJ0YmVhdFN0b3JhZ2VJbXBsKGFwcCk7XG4gICAgICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZVByb21pc2UgPSB0aGlzLl9zdG9yYWdlLnJlYWQoKS50aGVuKHJlc3VsdCA9PiB7XG4gICAgICAgICAgICB0aGlzLl9oZWFydGJlYXRzQ2FjaGUgPSByZXN1bHQ7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHRvIHJlcG9ydCBhIGhlYXJ0YmVhdC4gVGhlIGZ1bmN0aW9uIHdpbGwgZ2VuZXJhdGVcbiAgICAgKiBhIEhlYXJ0YmVhdHNCeVVzZXJBZ2VudCBvYmplY3QsIHVwZGF0ZSBoZWFydGJlYXRzQ2FjaGUsIGFuZCBwZXJzaXN0IGl0XG4gICAgICogdG8gSW5kZXhlZERCLlxuICAgICAqIE5vdGUgdGhhdCB3ZSBvbmx5IHN0b3JlIG9uZSBoZWFydGJlYXQgcGVyIGRheS4gU28gaWYgYSBoZWFydGJlYXQgZm9yIHRvZGF5IGlzXG4gICAgICogYWxyZWFkeSBsb2dnZWQsIHN1YnNlcXVlbnQgY2FsbHMgdG8gdGhpcyBmdW5jdGlvbiBpbiB0aGUgc2FtZSBkYXkgd2lsbCBiZSBpZ25vcmVkLlxuICAgICAqL1xuICAgIGFzeW5jIHRyaWdnZXJIZWFydGJlYXQoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBwbGF0Zm9ybUxvZ2dlciA9IHRoaXMuY29udGFpbmVyXG4gICAgICAgICAgICAgICAgLmdldFByb3ZpZGVyKCdwbGF0Zm9ybS1sb2dnZXInKVxuICAgICAgICAgICAgICAgIC5nZXRJbW1lZGlhdGUoKTtcbiAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIFwiRmlyZWJhc2UgdXNlciBhZ2VudFwiIHN0cmluZyBmcm9tIHRoZSBwbGF0Zm9ybSBsb2dnZXJcbiAgICAgICAgICAgIC8vIHNlcnZpY2UsIG5vdCB0aGUgYnJvd3NlciB1c2VyIGFnZW50LlxuICAgICAgICAgICAgY29uc3QgYWdlbnQgPSBwbGF0Zm9ybUxvZ2dlci5nZXRQbGF0Zm9ybUluZm9TdHJpbmcoKTtcbiAgICAgICAgICAgIGNvbnN0IGRhdGUgPSBnZXRVVENEYXRlU3RyaW5nKCk7XG4gICAgICAgICAgICBpZiAodGhpcy5faGVhcnRiZWF0c0NhY2hlPy5oZWFydGJlYXRzID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9oZWFydGJlYXRzQ2FjaGUgPSBhd2FpdCB0aGlzLl9oZWFydGJlYXRzQ2FjaGVQcm9taXNlO1xuICAgICAgICAgICAgICAgIC8vIElmIHdlIGZhaWxlZCB0byBjb25zdHJ1Y3QgYSBoZWFydGJlYXRzIGNhY2hlLCB0aGVuIHJldHVybiBpbW1lZGlhdGVseS5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faGVhcnRiZWF0c0NhY2hlPy5oZWFydGJlYXRzID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIERvIG5vdCBzdG9yZSBhIGhlYXJ0YmVhdCBpZiBvbmUgaXMgYWxyZWFkeSBzdG9yZWQgZm9yIHRoaXMgZGF5XG4gICAgICAgICAgICAvLyBvciBpZiBhIGhlYWRlciBoYXMgYWxyZWFkeSBiZWVuIHNlbnQgdG9kYXkuXG4gICAgICAgICAgICBpZiAodGhpcy5faGVhcnRiZWF0c0NhY2hlLmxhc3RTZW50SGVhcnRiZWF0RGF0ZSA9PT0gZGF0ZSB8fFxuICAgICAgICAgICAgICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZS5oZWFydGJlYXRzLnNvbWUoc2luZ2xlRGF0ZUhlYXJ0YmVhdCA9PiBzaW5nbGVEYXRlSGVhcnRiZWF0LmRhdGUgPT09IGRhdGUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gVGhlcmUgaXMgbm8gZW50cnkgZm9yIHRoaXMgZGF0ZS4gQ3JlYXRlIG9uZS5cbiAgICAgICAgICAgICAgICB0aGlzLl9oZWFydGJlYXRzQ2FjaGUuaGVhcnRiZWF0cy5wdXNoKHsgZGF0ZSwgYWdlbnQgfSk7XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIG51bWJlciBvZiBzdG9yZWQgaGVhcnRiZWF0cyBleGNlZWRzIHRoZSBtYXhpbXVtIG51bWJlciBvZiBzdG9yZWQgaGVhcnRiZWF0cywgcmVtb3ZlIHRoZSBoZWFydGJlYXQgd2l0aCB0aGUgZWFybGllc3QgZGF0ZS5cbiAgICAgICAgICAgICAgICAvLyBTaW5jZSB0aGlzIGlzIGV4ZWN1dGVkIGVhY2ggdGltZSBhIGhlYXJ0YmVhdCBpcyBwdXNoZWQsIHRoZSBsaW1pdCBjYW4gb25seSBiZSBleGNlZWRlZCBieSBvbmUsIHNvIG9ubHkgb25lIG5lZWRzIHRvIGJlIHJlbW92ZWQuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2hlYXJ0YmVhdHNDYWNoZS5oZWFydGJlYXRzLmxlbmd0aCA+IE1BWF9OVU1fU1RPUkVEX0hFQVJUQkVBVFMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWFybGllc3RIZWFydGJlYXRJZHggPSBnZXRFYXJsaWVzdEhlYXJ0YmVhdElkeCh0aGlzLl9oZWFydGJlYXRzQ2FjaGUuaGVhcnRiZWF0cyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZS5oZWFydGJlYXRzLnNwbGljZShlYXJsaWVzdEhlYXJ0YmVhdElkeCwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0b3JhZ2Uub3ZlcndyaXRlKHRoaXMuX2hlYXJ0YmVhdHNDYWNoZSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGxvZ2dlci53YXJuKGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBiYXNlNjQgZW5jb2RlZCBzdHJpbmcgd2hpY2ggY2FuIGJlIGF0dGFjaGVkIHRvIHRoZSBoZWFydGJlYXQtc3BlY2lmaWMgaGVhZGVyIGRpcmVjdGx5LlxuICAgICAqIEl0IGFsc28gY2xlYXJzIGFsbCBoZWFydGJlYXRzIGZyb20gbWVtb3J5IGFzIHdlbGwgYXMgaW4gSW5kZXhlZERCLlxuICAgICAqXG4gICAgICogTk9URTogQ29uc3VtaW5nIHByb2R1Y3QgU0RLcyBzaG91bGQgbm90IHNlbmQgdGhlIGhlYWRlciBpZiB0aGlzIG1ldGhvZFxuICAgICAqIHJldHVybnMgYW4gZW1wdHkgc3RyaW5nLlxuICAgICAqL1xuICAgIGFzeW5jIGdldEhlYXJ0YmVhdHNIZWFkZXIoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodGhpcy5faGVhcnRiZWF0c0NhY2hlID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5faGVhcnRiZWF0c0NhY2hlUHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIElmIGl0J3Mgc3RpbGwgbnVsbCBvciB0aGUgYXJyYXkgaXMgZW1wdHksIHRoZXJlIGlzIG5vIGRhdGEgdG8gc2VuZC5cbiAgICAgICAgICAgIGlmICh0aGlzLl9oZWFydGJlYXRzQ2FjaGU/LmhlYXJ0YmVhdHMgPT0gbnVsbCB8fFxuICAgICAgICAgICAgICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZS5oZWFydGJlYXRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGRhdGUgPSBnZXRVVENEYXRlU3RyaW5nKCk7XG4gICAgICAgICAgICAvLyBFeHRyYWN0IGFzIG1hbnkgaGVhcnRiZWF0cyBmcm9tIHRoZSBjYWNoZSBhcyB3aWxsIGZpdCB1bmRlciB0aGUgc2l6ZSBsaW1pdC5cbiAgICAgICAgICAgIGNvbnN0IHsgaGVhcnRiZWF0c1RvU2VuZCwgdW5zZW50RW50cmllcyB9ID0gZXh0cmFjdEhlYXJ0YmVhdHNGb3JIZWFkZXIodGhpcy5faGVhcnRiZWF0c0NhY2hlLmhlYXJ0YmVhdHMpO1xuICAgICAgICAgICAgY29uc3QgaGVhZGVyU3RyaW5nID0gYmFzZTY0dXJsRW5jb2RlV2l0aG91dFBhZGRpbmcoSlNPTi5zdHJpbmdpZnkoeyB2ZXJzaW9uOiAyLCBoZWFydGJlYXRzOiBoZWFydGJlYXRzVG9TZW5kIH0pKTtcbiAgICAgICAgICAgIC8vIFN0b3JlIGxhc3Qgc2VudCBkYXRlIHRvIHByZXZlbnQgYW5vdGhlciBiZWluZyBsb2dnZWQvc2VudCBmb3IgdGhlIHNhbWUgZGF5LlxuICAgICAgICAgICAgdGhpcy5faGVhcnRiZWF0c0NhY2hlLmxhc3RTZW50SGVhcnRiZWF0RGF0ZSA9IGRhdGU7XG4gICAgICAgICAgICBpZiAodW5zZW50RW50cmllcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgLy8gU3RvcmUgYW55IHVuc2VudCBlbnRyaWVzIGlmIHRoZXkgZXhpc3QuXG4gICAgICAgICAgICAgICAgdGhpcy5faGVhcnRiZWF0c0NhY2hlLmhlYXJ0YmVhdHMgPSB1bnNlbnRFbnRyaWVzO1xuICAgICAgICAgICAgICAgIC8vIFRoaXMgc2VlbXMgbW9yZSBsaWtlbHkgdGhhbiBlbXB0eWluZyB0aGUgYXJyYXkgKGJlbG93KSB0byBsZWFkIHRvIHNvbWUgb2RkIHN0YXRlXG4gICAgICAgICAgICAgICAgLy8gc2luY2UgdGhlIGNhY2hlIGlzbid0IGVtcHR5IGFuZCB0aGlzIHdpbGwgYmUgY2FsbGVkIGFnYWluIG9uIHRoZSBuZXh0IHJlcXVlc3QsXG4gICAgICAgICAgICAgICAgLy8gYW5kIGlzIHByb2JhYmx5IHNhZmVzdCBpZiB3ZSBhd2FpdCBpdC5cbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLl9zdG9yYWdlLm92ZXJ3cml0ZSh0aGlzLl9oZWFydGJlYXRzQ2FjaGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faGVhcnRiZWF0c0NhY2hlLmhlYXJ0YmVhdHMgPSBbXTtcbiAgICAgICAgICAgICAgICAvLyBEbyBub3Qgd2FpdCBmb3IgdGhpcywgdG8gcmVkdWNlIGxhdGVuY3kuXG4gICAgICAgICAgICAgICAgdm9pZCB0aGlzLl9zdG9yYWdlLm92ZXJ3cml0ZSh0aGlzLl9oZWFydGJlYXRzQ2FjaGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGhlYWRlclN0cmluZztcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgbG9nZ2VyLndhcm4oZSk7XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBnZXRVVENEYXRlU3RyaW5nKCkge1xuICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKTtcbiAgICAvLyBSZXR1cm5zIGRhdGUgZm9ybWF0ICdZWVlZLU1NLUREJ1xuICAgIHJldHVybiB0b2RheS50b0lTT1N0cmluZygpLnN1YnN0cmluZygwLCAxMCk7XG59XG5mdW5jdGlvbiBleHRyYWN0SGVhcnRiZWF0c0ZvckhlYWRlcihoZWFydGJlYXRzQ2FjaGUsIG1heFNpemUgPSBNQVhfSEVBREVSX0JZVEVTKSB7XG4gICAgLy8gSGVhcnRiZWF0cyBncm91cGVkIGJ5IHVzZXIgYWdlbnQgaW4gdGhlIHN0YW5kYXJkIGZvcm1hdCB0byBiZSBzZW50IGluXG4gICAgLy8gdGhlIGhlYWRlci5cbiAgICBjb25zdCBoZWFydGJlYXRzVG9TZW5kID0gW107XG4gICAgLy8gU2luZ2xlIGRhdGUgZm9ybWF0IGhlYXJ0YmVhdHMgdGhhdCBhcmUgbm90IHNlbnQuXG4gICAgbGV0IHVuc2VudEVudHJpZXMgPSBoZWFydGJlYXRzQ2FjaGUuc2xpY2UoKTtcbiAgICBmb3IgKGNvbnN0IHNpbmdsZURhdGVIZWFydGJlYXQgb2YgaGVhcnRiZWF0c0NhY2hlKSB7XG4gICAgICAgIC8vIExvb2sgZm9yIGFuIGV4aXN0aW5nIGVudHJ5IHdpdGggdGhlIHNhbWUgdXNlciBhZ2VudC5cbiAgICAgICAgY29uc3QgaGVhcnRiZWF0RW50cnkgPSBoZWFydGJlYXRzVG9TZW5kLmZpbmQoaGIgPT4gaGIuYWdlbnQgPT09IHNpbmdsZURhdGVIZWFydGJlYXQuYWdlbnQpO1xuICAgICAgICBpZiAoIWhlYXJ0YmVhdEVudHJ5KSB7XG4gICAgICAgICAgICAvLyBJZiBubyBlbnRyeSBmb3IgdGhpcyB1c2VyIGFnZW50IGV4aXN0cywgY3JlYXRlIG9uZS5cbiAgICAgICAgICAgIGhlYXJ0YmVhdHNUb1NlbmQucHVzaCh7XG4gICAgICAgICAgICAgICAgYWdlbnQ6IHNpbmdsZURhdGVIZWFydGJlYXQuYWdlbnQsXG4gICAgICAgICAgICAgICAgZGF0ZXM6IFtzaW5nbGVEYXRlSGVhcnRiZWF0LmRhdGVdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChjb3VudEJ5dGVzKGhlYXJ0YmVhdHNUb1NlbmQpID4gbWF4U2l6ZSkge1xuICAgICAgICAgICAgICAgIC8vIElmIHRoZSBoZWFkZXIgd291bGQgZXhjZWVkIG1heCBzaXplLCByZW1vdmUgdGhlIGFkZGVkIGhlYXJ0YmVhdFxuICAgICAgICAgICAgICAgIC8vIGVudHJ5IGFuZCBzdG9wIGFkZGluZyB0byB0aGUgaGVhZGVyLlxuICAgICAgICAgICAgICAgIGhlYXJ0YmVhdHNUb1NlbmQucG9wKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBoZWFydGJlYXRFbnRyeS5kYXRlcy5wdXNoKHNpbmdsZURhdGVIZWFydGJlYXQuZGF0ZSk7XG4gICAgICAgICAgICAvLyBJZiB0aGUgaGVhZGVyIHdvdWxkIGV4Y2VlZCBtYXggc2l6ZSwgcmVtb3ZlIHRoZSBhZGRlZCBkYXRlXG4gICAgICAgICAgICAvLyBhbmQgc3RvcCBhZGRpbmcgdG8gdGhlIGhlYWRlci5cbiAgICAgICAgICAgIGlmIChjb3VudEJ5dGVzKGhlYXJ0YmVhdHNUb1NlbmQpID4gbWF4U2l6ZSkge1xuICAgICAgICAgICAgICAgIGhlYXJ0YmVhdEVudHJ5LmRhdGVzLnBvcCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIFBvcCB1bnNlbnQgZW50cnkgZnJvbSBxdWV1ZS4gKFNraXBwZWQgaWYgYWRkaW5nIHRoZSBlbnRyeSBleGNlZWRlZFxuICAgICAgICAvLyBxdW90YSBhbmQgdGhlIGxvb3AgYnJlYWtzIGVhcmx5LilcbiAgICAgICAgdW5zZW50RW50cmllcyA9IHVuc2VudEVudHJpZXMuc2xpY2UoMSk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGhlYXJ0YmVhdHNUb1NlbmQsXG4gICAgICAgIHVuc2VudEVudHJpZXNcbiAgICB9O1xufVxuY2xhc3MgSGVhcnRiZWF0U3RvcmFnZUltcGwge1xuICAgIGNvbnN0cnVjdG9yKGFwcCkge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy5fY2FuVXNlSW5kZXhlZERCUHJvbWlzZSA9IHRoaXMucnVuSW5kZXhlZERCRW52aXJvbm1lbnRDaGVjaygpO1xuICAgIH1cbiAgICBhc3luYyBydW5JbmRleGVkREJFbnZpcm9ubWVudENoZWNrKCkge1xuICAgICAgICBpZiAoIWlzSW5kZXhlZERCQXZhaWxhYmxlKCkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB2YWxpZGF0ZUluZGV4ZWREQk9wZW5hYmxlKClcbiAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB0cnVlKVxuICAgICAgICAgICAgICAgIC5jYXRjaCgoKSA9PiBmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVhZCBhbGwgaGVhcnRiZWF0cy5cbiAgICAgKi9cbiAgICBhc3luYyByZWFkKCkge1xuICAgICAgICBjb25zdCBjYW5Vc2VJbmRleGVkREIgPSBhd2FpdCB0aGlzLl9jYW5Vc2VJbmRleGVkREJQcm9taXNlO1xuICAgICAgICBpZiAoIWNhblVzZUluZGV4ZWREQikge1xuICAgICAgICAgICAgcmV0dXJuIHsgaGVhcnRiZWF0czogW10gfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGlkYkhlYXJ0YmVhdE9iamVjdCA9IGF3YWl0IHJlYWRIZWFydGJlYXRzRnJvbUluZGV4ZWREQih0aGlzLmFwcCk7XG4gICAgICAgICAgICBpZiAoaWRiSGVhcnRiZWF0T2JqZWN0Py5oZWFydGJlYXRzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlkYkhlYXJ0YmVhdE9iamVjdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IGhlYXJ0YmVhdHM6IFtdIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gb3ZlcndyaXRlIHRoZSBzdG9yYWdlIHdpdGggdGhlIHByb3ZpZGVkIGhlYXJ0YmVhdHNcbiAgICBhc3luYyBvdmVyd3JpdGUoaGVhcnRiZWF0c09iamVjdCkge1xuICAgICAgICBjb25zdCBjYW5Vc2VJbmRleGVkREIgPSBhd2FpdCB0aGlzLl9jYW5Vc2VJbmRleGVkREJQcm9taXNlO1xuICAgICAgICBpZiAoIWNhblVzZUluZGV4ZWREQikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdIZWFydGJlYXRzT2JqZWN0ID0gYXdhaXQgdGhpcy5yZWFkKCk7XG4gICAgICAgICAgICByZXR1cm4gd3JpdGVIZWFydGJlYXRzVG9JbmRleGVkREIodGhpcy5hcHAsIHtcbiAgICAgICAgICAgICAgICBsYXN0U2VudEhlYXJ0YmVhdERhdGU6IGhlYXJ0YmVhdHNPYmplY3QubGFzdFNlbnRIZWFydGJlYXREYXRlID8/XG4gICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nSGVhcnRiZWF0c09iamVjdC5sYXN0U2VudEhlYXJ0YmVhdERhdGUsXG4gICAgICAgICAgICAgICAgaGVhcnRiZWF0czogaGVhcnRiZWF0c09iamVjdC5oZWFydGJlYXRzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBhZGQgaGVhcnRiZWF0c1xuICAgIGFzeW5jIGFkZChoZWFydGJlYXRzT2JqZWN0KSB7XG4gICAgICAgIGNvbnN0IGNhblVzZUluZGV4ZWREQiA9IGF3YWl0IHRoaXMuX2NhblVzZUluZGV4ZWREQlByb21pc2U7XG4gICAgICAgIGlmICghY2FuVXNlSW5kZXhlZERCKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ0hlYXJ0YmVhdHNPYmplY3QgPSBhd2FpdCB0aGlzLnJlYWQoKTtcbiAgICAgICAgICAgIHJldHVybiB3cml0ZUhlYXJ0YmVhdHNUb0luZGV4ZWREQih0aGlzLmFwcCwge1xuICAgICAgICAgICAgICAgIGxhc3RTZW50SGVhcnRiZWF0RGF0ZTogaGVhcnRiZWF0c09iamVjdC5sYXN0U2VudEhlYXJ0YmVhdERhdGUgPz9cbiAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdIZWFydGJlYXRzT2JqZWN0Lmxhc3RTZW50SGVhcnRiZWF0RGF0ZSxcbiAgICAgICAgICAgICAgICBoZWFydGJlYXRzOiBbXG4gICAgICAgICAgICAgICAgICAgIC4uLmV4aXN0aW5nSGVhcnRiZWF0c09iamVjdC5oZWFydGJlYXRzLFxuICAgICAgICAgICAgICAgICAgICAuLi5oZWFydGJlYXRzT2JqZWN0LmhlYXJ0YmVhdHNcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbi8qKlxuICogQ2FsY3VsYXRlIGJ5dGVzIG9mIGEgSGVhcnRiZWF0c0J5VXNlckFnZW50IGFycmF5IGFmdGVyIGJlaW5nIHdyYXBwZWRcbiAqIGluIGEgcGxhdGZvcm0gbG9nZ2luZyBoZWFkZXIgSlNPTiBvYmplY3QsIHN0cmluZ2lmaWVkLCBhbmQgY29udmVydGVkXG4gKiB0byBiYXNlIDY0LlxuICovXG5mdW5jdGlvbiBjb3VudEJ5dGVzKGhlYXJ0YmVhdHNDYWNoZSkge1xuICAgIC8vIGJhc2U2NCBoYXMgYSByZXN0cmljdGVkIHNldCBvZiBjaGFyYWN0ZXJzLCBhbGwgb2Ygd2hpY2ggc2hvdWxkIGJlIDEgYnl0ZS5cbiAgICByZXR1cm4gYmFzZTY0dXJsRW5jb2RlV2l0aG91dFBhZGRpbmcoXG4gICAgLy8gaGVhcnRiZWF0c0NhY2hlIHdyYXBwZXIgcHJvcGVydGllc1xuICAgIEpTT04uc3RyaW5naWZ5KHsgdmVyc2lvbjogMiwgaGVhcnRiZWF0czogaGVhcnRiZWF0c0NhY2hlIH0pKS5sZW5ndGg7XG59XG4vKipcbiAqIFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBoZWFydGJlYXQgd2l0aCB0aGUgZWFybGllc3QgZGF0ZS5cbiAqIElmIHRoZSBoZWFydGJlYXRzIGFycmF5IGlzIGVtcHR5LCAtMSBpcyByZXR1cm5lZC5cbiAqL1xuZnVuY3Rpb24gZ2V0RWFybGllc3RIZWFydGJlYXRJZHgoaGVhcnRiZWF0cykge1xuICAgIGlmIChoZWFydGJlYXRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIGxldCBlYXJsaWVzdEhlYXJ0YmVhdElkeCA9IDA7XG4gICAgbGV0IGVhcmxpZXN0SGVhcnRiZWF0RGF0ZSA9IGhlYXJ0YmVhdHNbMF0uZGF0ZTtcbiAgICBmb3IgKGxldCBpID0gMTsgaSA8IGhlYXJ0YmVhdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGhlYXJ0YmVhdHNbaV0uZGF0ZSA8IGVhcmxpZXN0SGVhcnRiZWF0RGF0ZSkge1xuICAgICAgICAgICAgZWFybGllc3RIZWFydGJlYXREYXRlID0gaGVhcnRiZWF0c1tpXS5kYXRlO1xuICAgICAgICAgICAgZWFybGllc3RIZWFydGJlYXRJZHggPSBpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBlYXJsaWVzdEhlYXJ0YmVhdElkeDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmZ1bmN0aW9uIHJlZ2lzdGVyQ29yZUNvbXBvbmVudHModmFyaWFudCkge1xuICAgIF9yZWdpc3RlckNvbXBvbmVudChuZXcgQ29tcG9uZW50KCdwbGF0Zm9ybS1sb2dnZXInLCBjb250YWluZXIgPT4gbmV3IFBsYXRmb3JtTG9nZ2VyU2VydmljZUltcGwoY29udGFpbmVyKSwgXCJQUklWQVRFXCIgLyogQ29tcG9uZW50VHlwZS5QUklWQVRFICovKSk7XG4gICAgX3JlZ2lzdGVyQ29tcG9uZW50KG5ldyBDb21wb25lbnQoJ2hlYXJ0YmVhdCcsIGNvbnRhaW5lciA9PiBuZXcgSGVhcnRiZWF0U2VydmljZUltcGwoY29udGFpbmVyKSwgXCJQUklWQVRFXCIgLyogQ29tcG9uZW50VHlwZS5QUklWQVRFICovKSk7XG4gICAgLy8gUmVnaXN0ZXIgYGFwcGAgcGFja2FnZS5cbiAgICByZWdpc3RlclZlcnNpb24obmFtZSRxLCB2ZXJzaW9uJDEsIHZhcmlhbnQpO1xuICAgIC8vIEJVSUxEX1RBUkdFVCB3aWxsIGJlIHJlcGxhY2VkIGJ5IHZhbHVlcyBsaWtlIGVzbSwgY2pzLCBldGMgZHVyaW5nIHRoZSBjb21waWxhdGlvblxuICAgIHJlZ2lzdGVyVmVyc2lvbihuYW1lJHEsIHZlcnNpb24kMSwgJ2VzbTIwMjAnKTtcbiAgICAvLyBSZWdpc3RlciBwbGF0Zm9ybSBTREsgaWRlbnRpZmllciAobm8gdmVyc2lvbikuXG4gICAgcmVnaXN0ZXJWZXJzaW9uKCdmaXJlLWpzJywgJycpO1xufVxuXG4vKipcbiAqIEZpcmViYXNlIEFwcFxuICpcbiAqIEByZW1hcmtzIFRoaXMgcGFja2FnZSBjb29yZGluYXRlcyB0aGUgY29tbXVuaWNhdGlvbiBiZXR3ZWVuIHRoZSBkaWZmZXJlbnQgRmlyZWJhc2UgY29tcG9uZW50c1xuICogQHBhY2thZ2VEb2N1bWVudGF0aW9uXG4gKi9cbnJlZ2lzdGVyQ29yZUNvbXBvbmVudHMoJycpO1xuXG5leHBvcnQgeyBTREtfVkVSU0lPTiwgREVGQVVMVF9FTlRSWV9OQU1FIGFzIF9ERUZBVUxUX0VOVFJZX05BTUUsIF9hZGRDb21wb25lbnQsIF9hZGRPck92ZXJ3cml0ZUNvbXBvbmVudCwgX2FwcHMsIF9jbGVhckNvbXBvbmVudHMsIF9jb21wb25lbnRzLCBfZ2V0UHJvdmlkZXIsIF9pc0ZpcmViYXNlQXBwLCBfaXNGaXJlYmFzZVNlcnZlckFwcCwgX2lzRmlyZWJhc2VTZXJ2ZXJBcHBTZXR0aW5ncywgX3JlZ2lzdGVyQ29tcG9uZW50LCBfcmVtb3ZlU2VydmljZUluc3RhbmNlLCBfc2VydmVyQXBwcywgZGVsZXRlQXBwLCBnZXRBcHAsIGdldEFwcHMsIGluaXRpYWxpemVBcHAsIGluaXRpYWxpemVTZXJ2ZXJBcHAsIG9uTG9nLCByZWdpc3RlclZlcnNpb24sIHNldExvZ0xldmVsIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5lc20uanMubWFwXG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5nID0gKGZ1bmN0aW9uKCkge1xuXHRpZiAodHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnKSByZXR1cm4gZ2xvYmFsVGhpcztcblx0dHJ5IHtcblx0XHRyZXR1cm4gdGhpcyB8fCBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgcmV0dXJuIHdpbmRvdztcblx0fVxufSkoKTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLyoqXG4gKiBTZXJ2aWNlIFdvcmtlciBQb2x5ZmlsbHNcbiAqIE1VU1QgYmUgaW1wb3J0ZWQgRklSU1QgYmVmb3JlIGFueSBvdGhlciBtb2R1bGVzXG4gKiBQcm92aWRlcyBtaW5pbWFsIGJyb3dzZXIgQVBJIHN0dWJzIGZvciBGaXJlYmFzZSBTREsgY29tcGF0aWJpbGl0eVxuICovXG5cbi8vIE1hcmsgdGhpcyBhcyBzZXJ2aWNlIHdvcmtlciBjb250ZXh0IEJFRk9SRSBhZGRpbmcgcG9seWZpbGxzXG4vLyBUaGlzIGZsYWcgaXMgY2hlY2tlZCBieSBmaXJlYmFzZS50cyBmb3IgY29udGV4dCBkZXRlY3Rpb25cbihnbG9iYWxUaGlzIGFzIGFueSkuX19JU19TRVJWSUNFX1dPUktFUl9fID0gdHJ1ZTtcblxuLy8gRmlyZWJhc2UgU0RLIGNoZWNrcyBmb3IgJ2RvY3VtZW50JyBldmVuIGluIHdlYi1leHRlbnNpb24gbW9kZVxuLy8gVGhpcyBwb2x5ZmlsbCBwcmV2ZW50cyBcImRvY3VtZW50IGlzIG5vdCBkZWZpbmVkXCIgZXJyb3JzXG5pZiAodHlwZW9mIGRvY3VtZW50ID09PSAndW5kZWZpbmVkJykge1xuICAoZ2xvYmFsVGhpcyBhcyBhbnkpLmRvY3VtZW50ID0ge1xuICAgIHJlYWR5U3RhdGU6ICdjb21wbGV0ZScsXG4gICAgYWRkRXZlbnRMaXN0ZW5lcjogKCkgPT4ge30sXG4gICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcjogKCkgPT4ge30sXG4gICAgZGlzcGF0Y2hFdmVudDogKCkgPT4gdHJ1ZSxcbiAgICBjcmVhdGVFbGVtZW50OiAoKSA9PiAoe1xuICAgICAgc2V0QXR0cmlidXRlOiAoKSA9PiB7fSxcbiAgICAgIGdldEF0dHJpYnV0ZTogKCkgPT4gbnVsbCxcbiAgICAgIHN0eWxlOiB7fSxcbiAgICB9KSxcbiAgICBjcmVhdGVFdmVudDogKCkgPT4gKHtcbiAgICAgIGluaXRFdmVudDogKCkgPT4ge30sXG4gICAgfSksXG4gICAgZ2V0RWxlbWVudEJ5SWQ6ICgpID0+IG51bGwsXG4gICAgZ2V0RWxlbWVudHNCeVRhZ05hbWU6ICgpID0+IFtdLFxuICAgIHF1ZXJ5U2VsZWN0b3I6ICgpID0+IG51bGwsXG4gICAgcXVlcnlTZWxlY3RvckFsbDogKCkgPT4gW10sXG4gICAgaGVhZDoge1xuICAgICAgYXBwZW5kQ2hpbGQ6ICgpID0+IHt9LFxuICAgICAgcmVtb3ZlQ2hpbGQ6ICgpID0+IHt9LFxuICAgIH0sXG4gICAgYm9keToge1xuICAgICAgYXBwZW5kQ2hpbGQ6ICgpID0+IHt9LFxuICAgICAgcmVtb3ZlQ2hpbGQ6ICgpID0+IHt9LFxuICAgIH0sXG4gIH07XG4gIGNvbnNvbGUubG9nKCdbUG9seWZpbGxzXSBEb2N1bWVudCBzdHViIGluc3RhbGxlZCBmb3IgRmlyZWJhc2UgU0RLJyk7XG59XG5cbi8vIFdpbmRvdyBwb2x5ZmlsbCAoc29tZSBGaXJlYmFzZSBjb2RlIGNoZWNrcyB3aW5kb3cubG9jYXRpb24pXG5pZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgKGdsb2JhbFRoaXMgYXMgYW55KS53aW5kb3cgPSB7XG4gICAgbG9jYXRpb246IHtcbiAgICAgIGhyZWY6ICdjaHJvbWUtZXh0ZW5zaW9uOi8vJyxcbiAgICAgIGhvc3RuYW1lOiAnbG9jYWxob3N0JyxcbiAgICAgIHByb3RvY29sOiAnY2hyb21lLWV4dGVuc2lvbjonLFxuICAgIH0sXG4gICAgYWRkRXZlbnRMaXN0ZW5lcjogKCkgPT4ge30sXG4gICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcjogKCkgPT4ge30sXG4gIH07XG4gIGNvbnNvbGUubG9nKCdbUG9seWZpbGxzXSBXaW5kb3cgc3R1YiBpbnN0YWxsZWQgZm9yIEZpcmViYXNlIFNESycpO1xufVxuXG5leHBvcnQge307IC8vIE1ha2UgdGhpcyBhIG1vZHVsZVxuIiwiLyoqXG4gKiBTdG9yYWdlIEVuY3J5cHRpb24gTWFuYWdlclxuICogSGFuZGxlcyBhbGwgZW5jcnlwdGlvbi9kZWNyeXB0aW9uIG9wZXJhdGlvbnMgdXNpbmcgV2ViIENyeXB0byBBUElcbiAqXG4gKiBTZWN1cml0eSBGZWF0dXJlczpcbiAqIC0gQUVTLTI1Ni1HQ00gZW5jcnlwdGlvblxuICogLSBGaXJlYmFzZSBVSUQgYXMga2V5IG1hdGVyaWFsICh0cnVlIGtleSBzZXBhcmF0aW9uKVxuICogLSBQQktERjIgd2l0aCAyMTBrIGl0ZXJhdGlvbnMgKE9XQVNQIDIwMjMgcmVjb21tZW5kYXRpb24pXG4gKiAtIFJhbmRvbSBJViBwZXIgZW5jcnlwdGlvblxuICogLSBMZWdhY3kga2V5IHN1cHBvcnQgZm9yIG1pZ3JhdGlvblxuICovXG5cbmltcG9ydCB7IEF1dGggfSBmcm9tICdmaXJlYmFzZS9hdXRoJztcblxuZXhwb3J0IGNsYXNzIFN0b3JhZ2VFbmNyeXB0aW9uTWFuYWdlciB7XG4gIHByaXZhdGUgY3VzdG9tQXV0aEluc3RhbmNlOiBBdXRoIHwgbnVsbCA9IG51bGw7XG5cbiAgLy8gPT09PT09PT09PSBDT1JFIEVOQ1JZUFRJT04gPT09PT09PT09PVxuXG4gIC8qKlxuICAgKiBFbmNyeXB0IGRhdGEgdXNpbmcgQUVTLTI1Ni1HQ01cbiAgICovXG4gIGFzeW5jIGVuY3J5cHQoZGF0YTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XG4gICAgY29uc3QgZGF0YUJ1ZmZlciA9IGVuY29kZXIuZW5jb2RlKGRhdGEpO1xuXG4gICAgY29uc3Qga2V5ID0gYXdhaXQgdGhpcy5nZXRFbmNyeXB0aW9uS2V5KCk7XG4gICAgY29uc3QgaXYgPSBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKG5ldyBVaW50OEFycmF5KDEyKSk7XG5cbiAgICBjb25zdCBlbmNyeXB0ZWQgPSBhd2FpdCBjcnlwdG8uc3VidGxlLmVuY3J5cHQoXG4gICAgICB7IG5hbWU6ICdBRVMtR0NNJywgaXYgfSxcbiAgICAgIGtleSxcbiAgICAgIGRhdGFCdWZmZXJcbiAgICApO1xuXG4gICAgLy8gQ29tYmluZSBJViArIGVuY3J5cHRlZCBkYXRhXG4gICAgY29uc3QgY29tYmluZWQgPSBuZXcgVWludDhBcnJheShpdi5sZW5ndGggKyBlbmNyeXB0ZWQuYnl0ZUxlbmd0aCk7XG4gICAgY29tYmluZWQuc2V0KGl2KTtcbiAgICBjb21iaW5lZC5zZXQobmV3IFVpbnQ4QXJyYXkoZW5jcnlwdGVkKSwgaXYubGVuZ3RoKTtcblxuICAgIHJldHVybiB0aGlzLmFycmF5QnVmZmVyVG9CYXNlNjQoY29tYmluZWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIERlY3J5cHQgZGF0YVxuICAgKi9cbiAgYXN5bmMgZGVjcnlwdChlbmNyeXB0ZWREYXRhOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IGNvbWJpbmVkID0gdGhpcy5iYXNlNjRUb0FycmF5QnVmZmVyKGVuY3J5cHRlZERhdGEpO1xuICAgIGNvbnN0IGl2ID0gY29tYmluZWQuc2xpY2UoMCwgMTIpO1xuICAgIGNvbnN0IGRhdGEgPSBjb21iaW5lZC5zbGljZSgxMik7XG5cbiAgICBjb25zdCBrZXkgPSBhd2FpdCB0aGlzLmdldEVuY3J5cHRpb25LZXkoKTtcbiAgICBjb25zdCBkZWNyeXB0ZWQgPSBhd2FpdCBjcnlwdG8uc3VidGxlLmRlY3J5cHQoXG4gICAgICB7IG5hbWU6ICdBRVMtR0NNJywgaXYgfSxcbiAgICAgIGtleSxcbiAgICAgIGRhdGFcbiAgICApO1xuXG4gICAgcmV0dXJuIG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZShkZWNyeXB0ZWQpO1xuICB9XG5cbiAgLy8gPT09PT09PT09PSBLRVkgREVSSVZBVElPTiA9PT09PT09PT09XG5cbiAgLyoqXG4gICAqIEdldCBlbmNyeXB0aW9uIGtleSB1c2luZyBGaXJlYmFzZSBVSUQgYXMga2V5IG1hdGVyaWFsXG4gICAqIFNFQ1VSSVRZOiBLZXkgbWF0ZXJpYWwgaXMgTk9UIHN0b3JlZCBsb2NhbGx5IC0gZGVyaXZlZCBmcm9tIEZpcmViYXNlIGF1dGggc2Vzc2lvblxuICAgKiBUaGlzIHByb3ZpZGVzIHRydWUga2V5IHNlcGFyYXRpb246IGVuY3J5cHRlZCBkYXRhIGluIGNocm9tZS5zdG9yYWdlLCBrZXkgbWF0ZXJpYWwgaW4gRmlyZWJhc2VcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZ2V0RW5jcnlwdGlvbktleSgpOiBQcm9taXNlPENyeXB0b0tleT4ge1xuICAgIGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcblxuICAgIC8vIEdldCBGaXJlYmFzZSBVSUQgYXMga2V5IG1hdGVyaWFsICh0aHJvd3MgaWYgbm90IGF1dGhlbnRpY2F0ZWQpXG4gICAgY29uc3Qga2V5TWF0ZXJpYWwgPSBhd2FpdCB0aGlzLmdldEZpcmViYXNlS2V5TWF0ZXJpYWwoKTtcblxuICAgIC8vIEltcG9ydCBGaXJlYmFzZSBVSUQgYXMgUEJLREYyIGtleVxuICAgIGNvbnN0IGltcG9ydGVkS2V5ID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5pbXBvcnRLZXkoXG4gICAgICAncmF3JyxcbiAgICAgIGVuY29kZXIuZW5jb2RlKGtleU1hdGVyaWFsKSxcbiAgICAgICdQQktERjInLFxuICAgICAgZmFsc2UsXG4gICAgICBbJ2Rlcml2ZUtleSddXG4gICAgKTtcblxuICAgIC8vIEdldCBvciBnZW5lcmF0ZSB1bmlxdWUgc2FsdCAoc2FsdCBjYW4gYmUgcHVibGljIC0gc3RvcmVkIGluIGNocm9tZS5zdG9yYWdlIGlzIE9LKVxuICAgIGNvbnN0IHNhbHQgPSBhd2FpdCB0aGlzLmdldE9yR2VuZXJhdGVTYWx0KCk7XG5cbiAgICAvLyBEZXJpdmUgQUVTLTI1Ni1HQ00ga2V5IHdpdGggNjAwayBpdGVyYXRpb25zIChPV0FTUCAyMDIzIGNvbXBsaWFudClcbiAgICByZXR1cm4gY3J5cHRvLnN1YnRsZS5kZXJpdmVLZXkoXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICdQQktERjInLFxuICAgICAgICBzYWx0OiBlbmNvZGVyLmVuY29kZShzYWx0KSxcbiAgICAgICAgaXRlcmF0aW9uczogNjAwMDAwLCAvLyBPV0FTUCAyMDIzIHJlY29tbWVuZGF0aW9uOiBtaW5pbXVtIDYwMCwwMDAgaXRlcmF0aW9uc1xuICAgICAgICBoYXNoOiAnU0hBLTI1NicsXG4gICAgICB9LFxuICAgICAgaW1wb3J0ZWRLZXksXG4gICAgICB7IG5hbWU6ICdBRVMtR0NNJywgbGVuZ3RoOiAyNTYgfSxcbiAgICAgIGZhbHNlLFxuICAgICAgWydlbmNyeXB0JywgJ2RlY3J5cHQnXVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IEZpcmViYXNlIFVJRCBhcyBlbmNyeXB0aW9uIGtleSBtYXRlcmlhbFxuICAgKiBTRUNVUklUWTogTmV2ZXIgc3RvcmVkIGxvY2FsbHkgLSBvbmx5IGF2YWlsYWJsZSB3aGVuIHVzZXIgaXMgYXV0aGVudGljYXRlZFxuICAgKiBAdGhyb3dzIEVycm9yIGlmIHVzZXIgaXMgbm90IGF1dGhlbnRpY2F0ZWRcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZ2V0RmlyZWJhc2VLZXlNYXRlcmlhbCgpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBVc2UgY3VzdG9tIGF1dGggaW5zdGFuY2UgaWYgcHJvdmlkZWQgKGZvciBpbnRlZ3JhdGlvbiB0ZXN0cylcbiAgICAgIC8vIE90aGVyd2lzZSwgaW1wb3J0IGRlZmF1bHQgcHJvZHVjdGlvbiBhdXRoICh3b3JrcyBpbiBib3RoIHBvcHVwIGFuZCBzZXJ2aWNlIHdvcmtlcilcbiAgICAgIGxldCBhdXRoO1xuICAgICAgaWYgKHRoaXMuY3VzdG9tQXV0aEluc3RhbmNlKSB7XG4gICAgICAgIGF1dGggPSB0aGlzLmN1c3RvbUF1dGhJbnN0YW5jZTtcbiAgICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlRW5jcnlwdGlvbk1hbmFnZXJdIFVzaW5nIGN1c3RvbSBhdXRoIGluc3RhbmNlICh0ZXN0IG1vZGUpJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBJbXBvcnQgZmlyZWJhc2UudHMgd2hpY2ggYXV0by1kZXRlY3RzIGNvbnRleHQgYW5kIGxvYWRzIGNvcnJlY3QgYXV0aCBtb2R1bGVcbiAgICAgICAgY29uc3QgZmlyZWJhc2VNb2R1bGUgPSBhd2FpdCBpbXBvcnQoXG4gICAgICAgICAgLyogd2VicGFja01vZGU6IFwiZWFnZXJcIiAqL1xuICAgICAgICAgIC8qIHdlYnBhY2tDaHVua05hbWU6IFwiZmlyZWJhc2UtY29udGV4dFwiICovXG4gICAgICAgICAgJy4uL2ZpcmViYXNlJ1xuICAgICAgICApO1xuICAgICAgICBhdXRoID0gZmlyZWJhc2VNb2R1bGUuYXV0aDtcbiAgICAgIH1cblxuICAgICAgLy8gV2FpdCBmb3IgRmlyZWJhc2UgdG8gaW5pdGlhbGl6ZSBpZiBuZWVkZWQgKG1heCAzMDBtcywgaW5zdGFudCBpZiBhbHJlYWR5IGxvYWRlZClcbiAgICAgIC8vIFRoaXMgaGFuZGxlcyBjYXNlcyB3aGVyZSBhdXRoIGlzIHN0aWxsIGluaXRpYWxpemluZyBpbiBwb3B1cFxuICAgICAgaWYgKCFhdXRoLmN1cnJlbnRVc2VyKSB7XG4gICAgICAgIGNvbnN0IG1heFdhaXRUaW1lID0gMzAwOyAvLyAzMDBtcyBtYXggd2FpdFxuICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgICAgIGF3YWl0IG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgY29uc3QgdW5zdWJzY3JpYmUgPSBhdXRoLm9uQXV0aFN0YXRlQ2hhbmdlZCgoKSA9PiB7XG4gICAgICAgICAgICB1bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgLy8gVGltZW91dCBmYWxsYmFjayAtIHJlc29sdmUgaW1tZWRpYXRlbHkgaWYgYXV0aCBkb2Vzbid0IGZpcmVcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICB9LCBtYXhXYWl0VGltZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHdhaXRUaW1lID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgICAgaWYgKGF1dGguY3VycmVudFVzZXIpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgW1N0b3JhZ2VFbmNyeXB0aW9uTWFuYWdlcl0gRmlyZWJhc2UgYXV0aCBpbml0aWFsaXplZCBhZnRlciAke3dhaXRUaW1lfW1zIHdhaXRgKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBpZiB1c2VyIGlzIGF1dGhlbnRpY2F0ZWQgYWZ0ZXIgd2FpdGluZ1xuICAgICAgaWYgKCFhdXRoLmN1cnJlbnRVc2VyKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAnRU5DUllQVElPTl9LRVlfVU5BVkFJTEFCTEU6IFBsZWFzZSBzaWduIGluIHRvIGFjY2VzcyBlbmNyeXB0ZWQgZGF0YS4gJyArXG4gICAgICAgICAgJ1lvdXIgZGF0YSBpcyBsb2NrZWQgYW5kIHJlcXVpcmVzIGF1dGhlbnRpY2F0aW9uLidcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdWlkID0gYXV0aC5jdXJyZW50VXNlci51aWQ7XG5cbiAgICAgIGlmICghdWlkIHx8IHVpZC50cmltKCkgPT09ICcnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRU5DUllQVElPTl9LRVlfSU5WQUxJRDogRmlyZWJhc2UgVUlEIGlzIG1pc3Npbmcgb3IgZW1wdHkuJyk7XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZUVuY3J5cHRpb25NYW5hZ2VyXSBVc2luZyBGaXJlYmFzZSBVSUQgZm9yIGVuY3J5cHRpb24ga2V5IGRlcml2YXRpb24nKTtcbiAgICAgIHJldHVybiB1aWQ7XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnRU5DUllQVElPTl9LRVknKSkge1xuICAgICAgICB0aHJvdyBlcnJvcjsgLy8gUmUtdGhyb3cgb3VyIGN1c3RvbSBlcnJvcnMgKGRvbid0IGxvZywgYWxyZWFkeSBkZXNjcmlwdGl2ZSlcbiAgICAgIH1cbiAgICAgIC8vIFVuZXhwZWN0ZWQgZXJyb3IgZHVyaW5nIEZpcmViYXNlIGltcG9ydC9hY2Nlc3MgKGUuZy4sIGRvY3VtZW50IG5vdCBkZWZpbmVkKVxuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnZG9jdW1lbnQgaXMgbm90IGRlZmluZWQnKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0VOQ1JZUFRJT05fS0VZX1VOQVZBSUxBQkxFOiBDYW5ub3QgYWNjZXNzIGVuY3J5cHRlZCBkYXRhIGluIHNlcnZpY2Ugd29ya2VyIGNvbnRleHQuJyk7XG4gICAgICB9XG4gICAgICBjb25zb2xlLmVycm9yKCdbU3RvcmFnZUVuY3J5cHRpb25NYW5hZ2VyXSBVbmV4cGVjdGVkIGVycm9yIGFjY2Vzc2luZyBGaXJlYmFzZSBhdXRoOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRU5DUllQVElPTl9LRVlfVU5BVkFJTEFCTEU6IEF1dGhlbnRpY2F0aW9uIHJlcXVpcmVkIHRvIGFjY2VzcyBlbmNyeXB0ZWQgZGF0YS4nKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGxlZ2FjeSBlbmNyeXB0aW9uIGtleSAodXNlcyByYW5kb20ga2V5IG1hdGVyaWFsIGZyb20gY2hyb21lLnN0b3JhZ2UpXG4gICAqIERFUFJFQ0FURUQ6IE9ubHkgdXNlZCBmb3IgbWlncmF0aW9uIGZyb20gb2xkIGVuY3J5cHRpb24gbWV0aG9kXG4gICAqIFdpbGwgYmUgcmVtb3ZlZCBpbiB2Mi4wXG4gICAqL1xuICBhc3luYyBnZXRMZWdhY3lFbmNyeXB0aW9uS2V5KCk6IFByb21pc2U8Q3J5cHRvS2V5PiB7XG4gICAgY29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xuXG4gICAgLy8gR2V0IG9sZCByYW5kb20ga2V5IG1hdGVyaWFsXG4gICAgY29uc3Qga2V5TWF0ZXJpYWwgPSBhd2FpdCB0aGlzLmdldE9yR2VuZXJhdGVLZXlNYXRlcmlhbCgpO1xuXG4gICAgY29uc3QgaW1wb3J0ZWRLZXkgPSBhd2FpdCBjcnlwdG8uc3VidGxlLmltcG9ydEtleShcbiAgICAgICdyYXcnLFxuICAgICAgZW5jb2Rlci5lbmNvZGUoa2V5TWF0ZXJpYWwpLFxuICAgICAgJ1BCS0RGMicsXG4gICAgICBmYWxzZSxcbiAgICAgIFsnZGVyaXZlS2V5J11cbiAgICApO1xuXG4gICAgY29uc3Qgc2FsdCA9IGF3YWl0IHRoaXMuZ2V0T3JHZW5lcmF0ZVNhbHQoKTtcblxuICAgIHJldHVybiBjcnlwdG8uc3VidGxlLmRlcml2ZUtleShcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ1BCS0RGMicsXG4gICAgICAgIHNhbHQ6IGVuY29kZXIuZW5jb2RlKHNhbHQpLFxuICAgICAgICBpdGVyYXRpb25zOiAyMTAwMDAsXG4gICAgICAgIGhhc2g6ICdTSEEtMjU2JyxcbiAgICAgIH0sXG4gICAgICBpbXBvcnRlZEtleSxcbiAgICAgIHsgbmFtZTogJ0FFUy1HQ00nLCBsZW5ndGg6IDI1NiB9LFxuICAgICAgZmFsc2UsXG4gICAgICBbJ2VuY3J5cHQnLCAnZGVjcnlwdCddXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWNyeXB0IGRhdGEgd2l0aCBhIHNwZWNpZmljIGtleSAodXNlZCBmb3IgbWlncmF0aW9uKVxuICAgKi9cbiAgYXN5bmMgZGVjcnlwdFdpdGhLZXkoZW5jcnlwdGVkRGF0YTogc3RyaW5nLCBrZXk6IENyeXB0b0tleSk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgY29tYmluZWQgPSB0aGlzLmJhc2U2NFRvQXJyYXlCdWZmZXIoZW5jcnlwdGVkRGF0YSk7XG4gICAgY29uc3QgaXYgPSBjb21iaW5lZC5zbGljZSgwLCAxMik7XG4gICAgY29uc3QgZGF0YSA9IGNvbWJpbmVkLnNsaWNlKDEyKTtcblxuICAgIGNvbnN0IGRlY3J5cHRlZCA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuZGVjcnlwdChcbiAgICAgIHsgbmFtZTogJ0FFUy1HQ00nLCBpdiB9LFxuICAgICAga2V5LFxuICAgICAgZGF0YVxuICAgICk7XG5cbiAgICByZXR1cm4gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGRlY3J5cHRlZCk7XG4gIH1cblxuICAvLyA9PT09PT09PT09IFNQRUNJQUxJWkVEIEVOQ1JZUFRJT04gPT09PT09PT09PVxuXG4gIC8qKlxuICAgKiBFbmNyeXB0IEFQSSBrZXkgdmF1bHRcbiAgICogRW5jcnlwdHMgdGhlIGVudGlyZSBhcGlLZXlWYXVsdCBvYmplY3QgaW5jbHVkaW5nIGFsbCBrZXkgdmFsdWVzXG4gICAqL1xuICBhc3luYyBlbmNyeXB0QVBJS2V5VmF1bHQodmF1bHQ6IGFueSk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGpzb24gPSBKU09OLnN0cmluZ2lmeSh2YXVsdCk7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5lbmNyeXB0KGpzb24pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbU3RvcmFnZUVuY3J5cHRpb25NYW5hZ2VyXSBGYWlsZWQgdG8gZW5jcnlwdCBBUEkga2V5IHZhdWx0OicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBEZWNyeXB0IEFQSSBrZXkgdmF1bHRcbiAgICogRGVjcnlwdHMgdGhlIGVuY3J5cHRlZCB2YXVsdCBzdHJpbmcgYmFjayB0byB0aGUgb3JpZ2luYWwgb2JqZWN0XG4gICAqL1xuICBhc3luYyBkZWNyeXB0QVBJS2V5VmF1bHQoZW5jcnlwdGVkVmF1bHQ6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGpzb24gPSBhd2FpdCB0aGlzLmRlY3J5cHQoZW5jcnlwdGVkVmF1bHQpO1xuICAgICAgcmV0dXJuIEpTT04ucGFyc2UoanNvbik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIERvbid0IGxvZyBFTkNSWVBUSU9OX0tFWV9VTkFWQUlMQUJMRSBhcyBlcnJvciAoZXhwZWN0ZWQgd2hlbiBub3QgYXV0aGVudGljYXRlZClcbiAgICAgIGlmICghKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnRU5DUllQVElPTl9LRVlfVU5BVkFJTEFCTEUnKSkpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignW1N0b3JhZ2VFbmNyeXB0aW9uTWFuYWdlcl0gRmFpbGVkIHRvIGRlY3J5cHQgQVBJIGtleSB2YXVsdDonLCBlcnJvcik7XG4gICAgICB9XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRW5jcnlwdCBjdXN0b20gcnVsZXNcbiAgICogRW5jcnlwdHMgdGhlIGN1c3RvbSBydWxlcyBhcnJheSBpbmNsdWRpbmcgcGF0dGVybnMgYW5kIHJlcGxhY2VtZW50c1xuICAgKi9cbiAgYXN5bmMgZW5jcnlwdEN1c3RvbVJ1bGVzKHJ1bGVzOiBhbnkpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBqc29uID0gSlNPTi5zdHJpbmdpZnkocnVsZXMpO1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZW5jcnlwdChqc29uKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW1N0b3JhZ2VFbmNyeXB0aW9uTWFuYWdlcl0gRmFpbGVkIHRvIGVuY3J5cHQgY3VzdG9tIHJ1bGVzOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBEZWNyeXB0IGN1c3RvbSBydWxlc1xuICAgKi9cbiAgYXN5bmMgZGVjcnlwdEN1c3RvbVJ1bGVzKGVuY3J5cHRlZFJ1bGVzOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBqc29uID0gYXdhaXQgdGhpcy5kZWNyeXB0KGVuY3J5cHRlZFJ1bGVzKTtcbiAgICAgIHJldHVybiBKU09OLnBhcnNlKGpzb24pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBEb24ndCBsb2cgRU5DUllQVElPTl9LRVlfVU5BVkFJTEFCTEUgYXMgZXJyb3IgKGV4cGVjdGVkIHdoZW4gbm90IGF1dGhlbnRpY2F0ZWQpXG4gICAgICBpZiAoIShlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0VOQ1JZUFRJT05fS0VZX1VOQVZBSUxBQkxFJykpKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTdG9yYWdlRW5jcnlwdGlvbk1hbmFnZXJdIEZhaWxlZCB0byBkZWNyeXB0IGN1c3RvbSBydWxlczonLCBlcnJvcik7XG4gICAgICB9XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRW5jcnlwdCBhY3Rpdml0eSBsb2dzXG4gICAqIEVuY3J5cHRzIGFjdGl2aXR5IGxvZyBhcnJheSB0byBwcm90ZWN0IHVzYWdlIGhpc3RvcnlcbiAgICovXG4gIGFzeW5jIGVuY3J5cHRBY3Rpdml0eUxvZ3MobG9nczogYW55KTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QganNvbiA9IEpTT04uc3RyaW5naWZ5KGxvZ3MpO1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZW5jcnlwdChqc29uKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW1N0b3JhZ2VFbmNyeXB0aW9uTWFuYWdlcl0gRmFpbGVkIHRvIGVuY3J5cHQgYWN0aXZpdHkgbG9nczonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGVjcnlwdCBhY3Rpdml0eSBsb2dzXG4gICAqL1xuICBhc3luYyBkZWNyeXB0QWN0aXZpdHlMb2dzKGVuY3J5cHRlZExvZ3M6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGpzb24gPSBhd2FpdCB0aGlzLmRlY3J5cHQoZW5jcnlwdGVkTG9ncyk7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShqc29uKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gRG9uJ3QgbG9nIEVOQ1JZUFRJT05fS0VZX1VOQVZBSUxBQkxFIGFzIGVycm9yIChleHBlY3RlZCB3aGVuIG5vdCBhdXRoZW50aWNhdGVkKVxuICAgICAgaWYgKCEoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdFTkNSWVBUSU9OX0tFWV9VTkFWQUlMQUJMRScpKSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbU3RvcmFnZUVuY3J5cHRpb25NYW5hZ2VyXSBGYWlsZWQgdG8gZGVjcnlwdCBhY3Rpdml0eSBsb2dzOicsIGVycm9yKTtcbiAgICAgIH1cbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBFbmNyeXB0IGFjY291bnQgZGF0YVxuICAgKiBFbmNyeXB0cyBlbWFpbCwgZGlzcGxheU5hbWUsIHBob3RvVVJMXG4gICAqL1xuICBhc3luYyBlbmNyeXB0QWNjb3VudERhdGEoYWNjb3VudDogYW55KTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QganNvbiA9IEpTT04uc3RyaW5naWZ5KGFjY291bnQpO1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZW5jcnlwdChqc29uKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW1N0b3JhZ2VFbmNyeXB0aW9uTWFuYWdlcl0gRmFpbGVkIHRvIGVuY3J5cHQgYWNjb3VudCBkYXRhOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBEZWNyeXB0IGFjY291bnQgZGF0YVxuICAgKi9cbiAgYXN5bmMgZGVjcnlwdEFjY291bnREYXRhKGVuY3J5cHRlZEFjY291bnQ6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGpzb24gPSBhd2FpdCB0aGlzLmRlY3J5cHQoZW5jcnlwdGVkQWNjb3VudCk7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShqc29uKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gRG9uJ3QgbG9nIEVOQ1JZUFRJT05fS0VZX1VOQVZBSUxBQkxFIGFzIGVycm9yIChleHBlY3RlZCB3aGVuIG5vdCBhdXRoZW50aWNhdGVkKVxuICAgICAgaWYgKCEoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdFTkNSWVBUSU9OX0tFWV9VTkFWQUlMQUJMRScpKSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbU3RvcmFnZUVuY3J5cHRpb25NYW5hZ2VyXSBGYWlsZWQgdG8gZGVjcnlwdCBhY2NvdW50IGRhdGE6JywgZXJyb3IpO1xuICAgICAgfVxuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLy8gPT09PT09PT09PSBLRVkgTUFURVJJQUwgJiBTQUxUIE1BTkFHRU1FTlQgPT09PT09PT09PVxuXG4gIC8qKlxuICAgKiBHZXQgb3IgZ2VuZXJhdGUgcmFuZG9tIGtleSBtYXRlcmlhbCB1bmlxdWUgdG8gdGhpcyB1c2VyXG4gICAqIFN0b3JlZCBpbiBjaHJvbWUuc3RvcmFnZSAobm90IGVuY3J5cHRlZCwgYXMgaXQncyB1c2VkIGZvciBlbmNyeXB0aW9uKVxuICAgKiBERVBSRUNBVEVEOiBPbmx5IHVzZWQgZm9yIGxlZ2FjeSBlbmNyeXB0aW9uXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdldE9yR2VuZXJhdGVLZXlNYXRlcmlhbCgpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IFNUT1JBR0VfS0VZID0gJ19lbmNyeXB0aW9uS2V5TWF0ZXJpYWwnO1xuXG4gICAgLy8gVHJ5IHRvIGxvYWQgZXhpc3Rpbmcga2V5IG1hdGVyaWFsXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IGNocm9tZS5zdG9yYWdlLmxvY2FsLmdldChTVE9SQUdFX0tFWSk7XG5cbiAgICBpZiAoZGF0YVtTVE9SQUdFX0tFWV0pIHtcbiAgICAgIHJldHVybiBkYXRhW1NUT1JBR0VfS0VZXTtcbiAgICB9XG5cbiAgICAvLyBHZW5lcmF0ZSBuZXcgcmFuZG9tIGtleSBtYXRlcmlhbCAoMjU2IGJpdHMgPSAzMiBieXRlcylcbiAgICBjb25zdCByYW5kb21CeXRlcyA9IGNyeXB0by5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoMzIpKTtcbiAgICBjb25zdCBrZXlNYXRlcmlhbCA9IHRoaXMuYXJyYXlCdWZmZXJUb0Jhc2U2NChyYW5kb21CeXRlcyk7XG5cbiAgICAvLyBTdG9yZSBmb3IgZnV0dXJlIHVzZVxuICAgIGF3YWl0IGNocm9tZS5zdG9yYWdlLmxvY2FsLnNldCh7IFtTVE9SQUdFX0tFWV06IGtleU1hdGVyaWFsIH0pO1xuXG4gICAgY29uc29sZS5sb2coJ1tTdG9yYWdlRW5jcnlwdGlvbk1hbmFnZXJdIEdlbmVyYXRlZCBuZXcgZW5jcnlwdGlvbiBrZXkgbWF0ZXJpYWwnKTtcbiAgICByZXR1cm4ga2V5TWF0ZXJpYWw7XG4gIH1cblxuICAvKipcbiAgICogR2V0IG9yIGdlbmVyYXRlIHJhbmRvbSBzYWx0IHVuaXF1ZSB0byB0aGlzIHVzZXJcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZ2V0T3JHZW5lcmF0ZVNhbHQoKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBTVE9SQUdFX0tFWSA9ICdfZW5jcnlwdGlvblNhbHQnO1xuXG4gICAgLy8gVHJ5IHRvIGxvYWQgZXhpc3Rpbmcgc2FsdFxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5nZXQoU1RPUkFHRV9LRVkpO1xuXG4gICAgaWYgKGRhdGFbU1RPUkFHRV9LRVldKSB7XG4gICAgICByZXR1cm4gZGF0YVtTVE9SQUdFX0tFWV07XG4gICAgfVxuXG4gICAgLy8gR2VuZXJhdGUgbmV3IHJhbmRvbSBzYWx0ICgxMjggYml0cyA9IDE2IGJ5dGVzKVxuICAgIGNvbnN0IHJhbmRvbUJ5dGVzID0gY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhuZXcgVWludDhBcnJheSgxNikpO1xuICAgIGNvbnN0IHNhbHQgPSB0aGlzLmFycmF5QnVmZmVyVG9CYXNlNjQocmFuZG9tQnl0ZXMpO1xuXG4gICAgLy8gU3RvcmUgZm9yIGZ1dHVyZSB1c2VcbiAgICBhd2FpdCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoeyBbU1RPUkFHRV9LRVldOiBzYWx0IH0pO1xuXG4gICAgY29uc29sZS5sb2coJ1tTdG9yYWdlRW5jcnlwdGlvbk1hbmFnZXJdIEdlbmVyYXRlZCBuZXcgZW5jcnlwdGlvbiBzYWx0Jyk7XG4gICAgcmV0dXJuIHNhbHQ7XG4gIH1cblxuICAvLyA9PT09PT09PT09IFVUSUxJVElFUyA9PT09PT09PT09XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgQXJyYXlCdWZmZXIgdG8gQmFzZTY0XG4gICAqL1xuICBwcml2YXRlIGFycmF5QnVmZmVyVG9CYXNlNjQoYnVmZmVyOiBVaW50OEFycmF5KTogc3RyaW5nIHtcbiAgICBsZXQgYmluYXJ5ID0gJyc7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBidWZmZXIuYnl0ZUxlbmd0aDsgaSsrKSB7XG4gICAgICBiaW5hcnkgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShidWZmZXJbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gYnRvYShiaW5hcnkpO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgQmFzZTY0IHRvIEFycmF5QnVmZmVyXG4gICAqL1xuICBwcml2YXRlIGJhc2U2NFRvQXJyYXlCdWZmZXIoYmFzZTY0OiBzdHJpbmcpOiBVaW50OEFycmF5IHtcbiAgICBjb25zdCBiaW5hcnkgPSBhdG9iKGJhc2U2NCk7XG4gICAgY29uc3QgYnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoYmluYXJ5Lmxlbmd0aCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiaW5hcnkubGVuZ3RoOyBpKyspIHtcbiAgICAgIGJ1ZmZlcltpXSA9IGJpbmFyeS5jaGFyQ29kZUF0KGkpO1xuICAgIH1cbiAgICByZXR1cm4gYnVmZmVyO1xuICB9XG5cbiAgLy8gPT09PT09PT09PSBURVNUIElOSkVDVElPTiA9PT09PT09PT09XG5cbiAgLyoqXG4gICAqIFNldCBjdXN0b20gYXV0aCBpbnN0YW5jZSBmb3IgdGVzdGluZ1xuICAgKi9cbiAgc2V0Q3VzdG9tQXV0aChhdXRoOiBBdXRoKTogdm9pZCB7XG4gICAgdGhpcy5jdXN0b21BdXRoSW5zdGFuY2UgPSBhdXRoO1xuICB9XG5cbiAgLyoqXG4gICAqIENsZWFyIGN1c3RvbSBhdXRoIGluc3RhbmNlXG4gICAqL1xuICBjbGVhckN1c3RvbUF1dGgoKTogdm9pZCB7XG4gICAgdGhpcy5jdXN0b21BdXRoSW5zdGFuY2UgPSBudWxsO1xuICB9XG59XG4iLCIvKipcbiAqIFN0b3JhZ2UgQ29uZmlnIE1hbmFnZXJcbiAqIEhhbmRsZXMgYWxsIFVzZXJDb25maWcgc3RvcmFnZSBvcGVyYXRpb25zIHdpdGggc2VsZWN0aXZlIGZpZWxkIGVuY3J5cHRpb25cbiAqXG4gKiBGZWF0dXJlczpcbiAqIC0gNS1zZWNvbmQgY29uZmlnIGNhY2hlIHRvIHByZXZlbnQgZXhjZXNzaXZlIGRlY3J5cHRpb25cbiAqIC0gU2VsZWN0aXZlIGVuY3J5cHRpb246IEFQSSBrZXlzLCBjdXN0b20gcnVsZXMsIGFjdGl2aXR5IGxvZ3MsIGFjY291bnQgZGF0YVxuICogLSBDcm9zcy1jb250ZXh0IGNhY2hlIGludmFsaWRhdGlvblxuICogLSBBdXRvbWF0aWMgbWlncmF0aW9uIG9mIHBsYWludGV4dCB0byBlbmNyeXB0ZWQgc3RvcmFnZVxuICogLSBTdGFydGVyIHRlbXBsYXRlcyBpbml0aWFsaXphdGlvblxuICovXG5cbmltcG9ydCB7IFVzZXJDb25maWcsIFByb21wdFRlbXBsYXRlIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgU3RvcmFnZUVuY3J5cHRpb25NYW5hZ2VyIH0gZnJvbSAnLi9TdG9yYWdlRW5jcnlwdGlvbk1hbmFnZXInO1xuXG5leHBvcnQgY2xhc3MgU3RvcmFnZUNvbmZpZ01hbmFnZXIge1xuICBwcml2YXRlIGVuY3J5cHRpb25NYW5hZ2VyOiBTdG9yYWdlRW5jcnlwdGlvbk1hbmFnZXI7XG5cbiAgLy8gQ2FjaGUgdG8gcHJldmVudCBleGNlc3NpdmUgZGVjcnlwdGlvblxuICAvLyBMb25nZXIgY2FjaGUgc2luY2UgZWFjaCBjb250ZXh0IChwb3B1cCwgYmFja2dyb3VuZCkgaGFzIGl0cyBvd24gaW5zdGFuY2VcbiAgcHJpdmF0ZSBjb25maWdDYWNoZTogVXNlckNvbmZpZyB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGNvbmZpZ0NhY2hlVGltZXN0YW1wOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIHJlYWRvbmx5IENBQ0hFX1RUTF9NUyA9IDUwMDA7IC8vIDUgc2Vjb25kIGNhY2hlIChsb25nZXIgZHVlIHRvIGNyb3NzLWNvbnRleHQgaXNzdWVzKVxuXG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IENPTkZJR19LRVkgPSAnY29uZmlnJztcblxuICBjb25zdHJ1Y3RvcihlbmNyeXB0aW9uTWFuYWdlcjogU3RvcmFnZUVuY3J5cHRpb25NYW5hZ2VyKSB7XG4gICAgdGhpcy5lbmNyeXB0aW9uTWFuYWdlciA9IGVuY3J5cHRpb25NYW5hZ2VyO1xuXG4gICAgLy8gTGlzdGVuIGZvciBzdG9yYWdlIGNoYW5nZXMgZnJvbSBPVEhFUiBjb250ZXh0cyB0byBpbnZhbGlkYXRlIGNhY2hlXG4gICAgY2hyb21lLnN0b3JhZ2Uub25DaGFuZ2VkLmFkZExpc3RlbmVyKChjaGFuZ2VzLCBhcmVhTmFtZSkgPT4ge1xuICAgICAgaWYgKGFyZWFOYW1lID09PSAnbG9jYWwnICYmIGNoYW5nZXNbU3RvcmFnZUNvbmZpZ01hbmFnZXIuQ09ORklHX0tFWV0pIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlQ29uZmlnTWFuYWdlcl0g8J+UhCBDb25maWcgY2hhbmdlZCBpbiBhbm90aGVyIGNvbnRleHQsIGludmFsaWRhdGluZyBjYWNoZScpO1xuICAgICAgICB0aGlzLmNvbmZpZ0NhY2hlID0gbnVsbDtcbiAgICAgICAgdGhpcy5jb25maWdDYWNoZVRpbWVzdGFtcCA9IDA7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogU2F2ZSBjb25maWd1cmF0aW9uXG4gICAqIEVuY3J5cHRzIEFMTCBzZW5zaXRpdmUgZGF0YSBiZWZvcmUgc2F2aW5nOlxuICAgKiAtIEFQSSBrZXkgdmF1bHRcbiAgICogLSBDdXN0b20gcnVsZXNcbiAgICogLSBBY3Rpdml0eSBsb2dzXG4gICAqIC0gQWNjb3VudCBkYXRhIChlbWFpbCwgZGlzcGxheU5hbWUsIHBob3RvVVJMKVxuICAgKi9cbiAgYXN5bmMgc2F2ZUNvbmZpZyhjb25maWc6IFVzZXJDb25maWcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VDb25maWdNYW5hZ2VyXSDwn5K+IFNhdmluZyBjb25maWcgd2l0aCBlbmNyeXB0aW9uLi4uJyk7XG5cbiAgICAvLyBDbG9uZSBjb25maWcgdG8gYXZvaWQgbXV0YXRpbmcgdGhlIG9yaWdpbmFsXG4gICAgY29uc3QgY29uZmlnVG9TYXZlID0geyAuLi5jb25maWcgfTtcbiAgICBjb25zdCBlbmNyeXB0ZWREYXRhID0gY29uZmlnVG9TYXZlIGFzIGFueTtcblxuICAgIC8vIDEuIEVuY3J5cHQgQVBJIGtleSB2YXVsdCBpZiBpdCBleGlzdHMgYW5kIGhhcyBrZXlzXG4gICAgaWYgKGNvbmZpZ1RvU2F2ZS5hcGlLZXlWYXVsdCAmJiBjb25maWdUb1NhdmUuYXBpS2V5VmF1bHQua2V5cy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VDb25maWdNYW5hZ2VyXSDwn5SQIEVuY3J5cHRpbmcgQVBJIGtleSB2YXVsdC4uLicpO1xuICAgICAgZW5jcnlwdGVkRGF0YS5fZW5jcnlwdGVkQXBpS2V5VmF1bHQgPSBhd2FpdCB0aGlzLmVuY3J5cHRpb25NYW5hZ2VyLmVuY3J5cHRBUElLZXlWYXVsdChjb25maWdUb1NhdmUuYXBpS2V5VmF1bHQpO1xuICAgICAgY29uZmlnVG9TYXZlLmFwaUtleVZhdWx0ID0geyAuLi5jb25maWdUb1NhdmUuYXBpS2V5VmF1bHQsIGtleXM6IFtdIH07XG4gICAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VDb25maWdNYW5hZ2VyXSDinIUgQVBJIGtleSB2YXVsdCBlbmNyeXB0ZWQnKTtcbiAgICB9XG5cbiAgICAvLyAyLiBFbmNyeXB0IGN1c3RvbSBydWxlcyBpZiB0aGV5IGV4aXN0XG4gICAgaWYgKGNvbmZpZ1RvU2F2ZS5jdXN0b21SdWxlcyAmJiBjb25maWdUb1NhdmUuY3VzdG9tUnVsZXMucnVsZXMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlQ29uZmlnTWFuYWdlcl0g8J+UkCBFbmNyeXB0aW5nIGN1c3RvbSBydWxlcy4uLicpO1xuICAgICAgZW5jcnlwdGVkRGF0YS5fZW5jcnlwdGVkQ3VzdG9tUnVsZXMgPSBhd2FpdCB0aGlzLmVuY3J5cHRpb25NYW5hZ2VyLmVuY3J5cHRDdXN0b21SdWxlcyhjb25maWdUb1NhdmUuY3VzdG9tUnVsZXMpO1xuICAgICAgY29uZmlnVG9TYXZlLmN1c3RvbVJ1bGVzID0geyAuLi5jb25maWdUb1NhdmUuY3VzdG9tUnVsZXMsIHJ1bGVzOiBbXSB9O1xuICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlQ29uZmlnTWFuYWdlcl0g4pyFIEN1c3RvbSBydWxlcyBlbmNyeXB0ZWQnKTtcbiAgICB9XG5cbiAgICAvLyAzLiBFbmNyeXB0IGFjdGl2aXR5IGxvZ3MgaWYgdGhleSBleGlzdFxuICAgIGlmIChjb25maWdUb1NhdmUuc3RhdHMgJiYgY29uZmlnVG9TYXZlLnN0YXRzLmFjdGl2aXR5TG9nICYmIGNvbmZpZ1RvU2F2ZS5zdGF0cy5hY3Rpdml0eUxvZy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VDb25maWdNYW5hZ2VyXSDwn5SQIEVuY3J5cHRpbmcgYWN0aXZpdHkgbG9ncy4uLicpO1xuICAgICAgZW5jcnlwdGVkRGF0YS5fZW5jcnlwdGVkQWN0aXZpdHlMb2dzID0gYXdhaXQgdGhpcy5lbmNyeXB0aW9uTWFuYWdlci5lbmNyeXB0QWN0aXZpdHlMb2dzKGNvbmZpZ1RvU2F2ZS5zdGF0cy5hY3Rpdml0eUxvZyk7XG4gICAgICBjb25maWdUb1NhdmUuc3RhdHMgPSB7IC4uLmNvbmZpZ1RvU2F2ZS5zdGF0cywgYWN0aXZpdHlMb2c6IFtdIH07XG4gICAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VDb25maWdNYW5hZ2VyXSDinIUgQWN0aXZpdHkgbG9ncyBlbmNyeXB0ZWQnKTtcbiAgICB9XG5cbiAgICAvLyA0LiBFbmNyeXB0IGFjY291bnQgZGF0YSAoZW1haWwsIGRpc3BsYXlOYW1lLCBwaG90b1VSTClcbiAgICBpZiAoY29uZmlnVG9TYXZlLmFjY291bnQgJiYgKGNvbmZpZ1RvU2F2ZS5hY2NvdW50LmVtYWlsIHx8IGNvbmZpZ1RvU2F2ZS5hY2NvdW50LmRpc3BsYXlOYW1lKSkge1xuICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlQ29uZmlnTWFuYWdlcl0g8J+UkCBFbmNyeXB0aW5nIGFjY291bnQgZGF0YS4uLicpO1xuICAgICAgY29uc3QgYWNjb3VudFRvRW5jcnlwdCA9IHtcbiAgICAgICAgZW1haWw6IGNvbmZpZ1RvU2F2ZS5hY2NvdW50LmVtYWlsLFxuICAgICAgICBkaXNwbGF5TmFtZTogY29uZmlnVG9TYXZlLmFjY291bnQuZGlzcGxheU5hbWUsXG4gICAgICAgIHBob3RvVVJMOiBjb25maWdUb1NhdmUuYWNjb3VudC5waG90b1VSTCxcbiAgICAgIH07XG4gICAgICBlbmNyeXB0ZWREYXRhLl9lbmNyeXB0ZWRBY2NvdW50RGF0YSA9IGF3YWl0IHRoaXMuZW5jcnlwdGlvbk1hbmFnZXIuZW5jcnlwdEFjY291bnREYXRhKGFjY291bnRUb0VuY3J5cHQpO1xuXG4gICAgICAvLyBLZWVwIHRpZXIgYW5kIG90aGVyIG5vbi1zZW5zaXRpdmUgZmllbGRzLCBjbGVhciBzZW5zaXRpdmUgb25lc1xuICAgICAgY29uZmlnVG9TYXZlLmFjY291bnQgPSB7XG4gICAgICAgIC4uLmNvbmZpZ1RvU2F2ZS5hY2NvdW50LFxuICAgICAgICBlbWFpbDogdW5kZWZpbmVkLFxuICAgICAgICBkaXNwbGF5TmFtZTogdW5kZWZpbmVkLFxuICAgICAgICBwaG90b1VSTDogdW5kZWZpbmVkLFxuICAgICAgICBmaXJlYmFzZVVpZDogdW5kZWZpbmVkLCAvLyBBbHNvIGVuY3J5cHQgVUlEXG4gICAgICB9O1xuICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlQ29uZmlnTWFuYWdlcl0g4pyFIEFjY291bnQgZGF0YSBlbmNyeXB0ZWQnKTtcbiAgICB9XG5cbiAgICBhd2FpdCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoe1xuICAgICAgW1N0b3JhZ2VDb25maWdNYW5hZ2VyLkNPTkZJR19LRVldOiBjb25maWdUb1NhdmUsXG4gICAgfSk7XG4gICAgY29uc29sZS5sb2coJ1tTdG9yYWdlQ29uZmlnTWFuYWdlcl0g4pyFIENvbmZpZyBzYXZlZCB3aXRoIGFsbCBzZW5zaXRpdmUgZGF0YSBlbmNyeXB0ZWQnKTtcblxuICAgIC8vIFVwZGF0ZSBjYWNoZSB3aXRoIHRoZSBuZXcgY29uZmlnIGluc3RlYWQgb2YgaW52YWxpZGF0aW5nXG4gICAgLy8gVGhpcyBwcmV2ZW50cyB1bm5lY2Vzc2FyeSByZS1kZWNyeXB0aW9uIGluIHRoZSBzYW1lIGNvbnRleHRcbiAgICB0aGlzLmNvbmZpZ0NhY2hlID0gY29uZmlnO1xuICAgIHRoaXMuY29uZmlnQ2FjaGVUaW1lc3RhbXAgPSBEYXRlLm5vdygpO1xuICB9XG5cbiAgLyoqXG4gICAqIExvYWQgY29uZmlndXJhdGlvblxuICAgKiBEZWNyeXB0cyBhbGwgc2Vuc2l0aXZlIGRhdGE6IEFQSSBrZXlzLCBjdXN0b20gcnVsZXMsIGFjdGl2aXR5IGxvZ3MsIGFuZCBhY2NvdW50IGRhdGFcbiAgICogVXNlcyA1LXNlY29uZCBjYWNoZSB0byBwcmV2ZW50IGV4Y2Vzc2l2ZSBkZWNyeXB0aW9uIGNhbGxzXG4gICAqL1xuICBhc3luYyBsb2FkQ29uZmlnKCk6IFByb21pc2U8VXNlckNvbmZpZyB8IG51bGw+IHtcbiAgICAvLyBDaGVjayBjYWNoZSBmaXJzdFxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgaWYgKHRoaXMuY29uZmlnQ2FjaGUgJiYgKG5vdyAtIHRoaXMuY29uZmlnQ2FjaGVUaW1lc3RhbXApIDwgdGhpcy5DQUNIRV9UVExfTVMpIHtcbiAgICAgIC8vIFNpbGVudGx5IHJldHVybiBjYWNoZWQgY29uZmlnIChyZW1vdmUgc3BhbSlcbiAgICAgIHJldHVybiB0aGlzLmNvbmZpZ0NhY2hlO1xuICAgIH1cblxuICAgIC8vIENhY2hlIG1pc3MgLSBuZWVkIHRvIGRlY3J5cHRcbiAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VDb25maWdNYW5hZ2VyXSDwn5OCIExvYWRpbmcgY29uZmlnIGZyb20gc3RvcmFnZSAoY2FjaGUgbWlzcyknKTtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgY2hyb21lLnN0b3JhZ2UubG9jYWwuZ2V0KFN0b3JhZ2VDb25maWdNYW5hZ2VyLkNPTkZJR19LRVkpO1xuICAgIGNvbnN0IGNvbmZpZyA9IGRhdGFbU3RvcmFnZUNvbmZpZ01hbmFnZXIuQ09ORklHX0tFWV0gfHwgbnVsbDtcblxuICAgIGlmICghY29uZmlnKSB7XG4gICAgICBjb25zb2xlLmxvZygnW1RoZW1lIERlYnVnXSDwn5OCIE5vIGNvbmZpZyBmb3VuZCBpbiBzdG9yYWdlJyk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCBjb25maWdXaXRoRW5jcnlwdGVkID0gY29uZmlnIGFzIGFueTtcblxuICAgIC8vIDEuIERlY3J5cHQgQVBJIGtleSB2YXVsdCBpZiBpdCBleGlzdHNcbiAgICBpZiAoY29uZmlnV2l0aEVuY3J5cHRlZC5fZW5jcnlwdGVkQXBpS2V5VmF1bHQpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIFJlbW92ZWQgdmVyYm9zZSBsb2dnaW5nIGZvciBwcm9kdWN0aW9uXG4gICAgICAgIGNvbnN0IGRlY3J5cHRlZFZhdWx0ID0gYXdhaXQgdGhpcy5lbmNyeXB0aW9uTWFuYWdlci5kZWNyeXB0QVBJS2V5VmF1bHQoY29uZmlnV2l0aEVuY3J5cHRlZC5fZW5jcnlwdGVkQXBpS2V5VmF1bHQpO1xuICAgICAgICBjb25maWcuYXBpS2V5VmF1bHQgPSBkZWNyeXB0ZWRWYXVsdDtcbiAgICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlQ29uZmlnTWFuYWdlcl0g4pyFIEFQSSBrZXkgdmF1bHQgZGVjcnlwdGVkJyk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAvLyBVc2VyIG5vdCBhdXRoZW50aWNhdGVkIC0gZXhwZWN0ZWQsIGRvbid0IHNwYW0gY29uc29sZVxuICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdFTkNSWVBUSU9OX0tFWV9VTkFWQUlMQUJMRScpKSB7XG4gICAgICAgICAgLy8gTG9ja2VkIHN0YXRlIGlzIGV4cGVjdGVkIGluIHNlcnZpY2Ugd29ya2VyXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignW1N0b3JhZ2VDb25maWdNYW5hZ2VyXSDinYwgRmFpbGVkIHRvIGRlY3J5cHQgQVBJIGtleSB2YXVsdDonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgLy8gS2VlcCB0aGUgZW1wdHkgdmF1bHQgaWYgZGVjcnlwdGlvbiBmYWlsc1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoY29uZmlnLmFwaUtleVZhdWx0ICYmIGNvbmZpZy5hcGlLZXlWYXVsdC5rZXlzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnNvbGUud2FybignW1N0b3JhZ2VDb25maWdNYW5hZ2VyXSDimqDvuI8gRm91bmQgcGxhaW50ZXh0IEFQSSBrZXlzIC0gd2lsbCBlbmNyeXB0IG9uIG5leHQgc2F2ZScpO1xuICAgIH1cblxuICAgIC8vIDIuIERlY3J5cHQgY3VzdG9tIHJ1bGVzIGlmIHRoZXkgZXhpc3RcbiAgICBpZiAoY29uZmlnV2l0aEVuY3J5cHRlZC5fZW5jcnlwdGVkQ3VzdG9tUnVsZXMpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIFJlbW92ZWQgdmVyYm9zZSBsb2dnaW5nIGZvciBwcm9kdWN0aW9uXG4gICAgICAgIGNvbnN0IGRlY3J5cHRlZFJ1bGVzID0gYXdhaXQgdGhpcy5lbmNyeXB0aW9uTWFuYWdlci5kZWNyeXB0Q3VzdG9tUnVsZXMoY29uZmlnV2l0aEVuY3J5cHRlZC5fZW5jcnlwdGVkQ3VzdG9tUnVsZXMpO1xuICAgICAgICBjb25maWcuY3VzdG9tUnVsZXMgPSBkZWNyeXB0ZWRSdWxlcztcbiAgICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlQ29uZmlnTWFuYWdlcl0g4pyFIEN1c3RvbSBydWxlcyBkZWNyeXB0ZWQnKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIC8vIFVzZXIgbm90IGF1dGhlbnRpY2F0ZWQgLSBleHBlY3RlZCwgZG9uJ3Qgc3BhbSBjb25zb2xlXG4gICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0VOQ1JZUFRJT05fS0VZX1VOQVZBSUxBQkxFJykpIHtcbiAgICAgICAgICAvLyBMb2NrZWQgc3RhdGUgaXMgZXhwZWN0ZWQgaW4gc2VydmljZSB3b3JrZXJcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdbU3RvcmFnZUNvbmZpZ01hbmFnZXJdIOKdjCBGYWlsZWQgdG8gZGVjcnlwdCBjdXN0b20gcnVsZXM6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgICAgIC8vIEtlZXAgdGhlIGVtcHR5IHJ1bGVzIGlmIGRlY3J5cHRpb24gZmFpbHNcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGNvbmZpZy5jdXN0b21SdWxlcyAmJiBjb25maWcuY3VzdG9tUnVsZXMucnVsZXMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc29sZS53YXJuKCdbU3RvcmFnZUNvbmZpZ01hbmFnZXJdIOKaoO+4jyBGb3VuZCBwbGFpbnRleHQgY3VzdG9tIHJ1bGVzIC0gd2lsbCBlbmNyeXB0IG9uIG5leHQgc2F2ZScpO1xuICAgIH1cblxuICAgIC8vIDMuIERlY3J5cHQgYWN0aXZpdHkgbG9ncyBpZiB0aGV5IGV4aXN0XG4gICAgaWYgKGNvbmZpZ1dpdGhFbmNyeXB0ZWQuX2VuY3J5cHRlZEFjdGl2aXR5TG9ncykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gUmVtb3ZlZCB2ZXJib3NlIGxvZ2dpbmcgZm9yIHByb2R1Y3Rpb25cbiAgICAgICAgY29uc3QgZGVjcnlwdGVkTG9ncyA9IGF3YWl0IHRoaXMuZW5jcnlwdGlvbk1hbmFnZXIuZGVjcnlwdEFjdGl2aXR5TG9ncyhjb25maWdXaXRoRW5jcnlwdGVkLl9lbmNyeXB0ZWRBY3Rpdml0eUxvZ3MpO1xuICAgICAgICBjb25maWcuc3RhdHMuYWN0aXZpdHlMb2cgPSBkZWNyeXB0ZWRMb2dzO1xuICAgICAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VDb25maWdNYW5hZ2VyXSDinIUgQWN0aXZpdHkgbG9ncyBkZWNyeXB0ZWQnKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIC8vIFVzZXIgbm90IGF1dGhlbnRpY2F0ZWQgLSBleHBlY3RlZCwgZG9uJ3Qgc3BhbSBjb25zb2xlXG4gICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0VOQ1JZUFRJT05fS0VZX1VOQVZBSUxBQkxFJykpIHtcbiAgICAgICAgICAvLyBMb2NrZWQgc3RhdGUgaXMgZXhwZWN0ZWQgaW4gc2VydmljZSB3b3JrZXJcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdbU3RvcmFnZUNvbmZpZ01hbmFnZXJdIOKdjCBGYWlsZWQgdG8gZGVjcnlwdCBhY3Rpdml0eSBsb2dzOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBLZWVwIGVtcHR5IGxvZ3MgaWYgZGVjcnlwdGlvbiBmYWlsc1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoY29uZmlnLnN0YXRzICYmIGNvbmZpZy5zdGF0cy5hY3Rpdml0eUxvZyAmJiBjb25maWcuc3RhdHMuYWN0aXZpdHlMb2cubGVuZ3RoID4gMCkge1xuICAgICAgY29uc29sZS53YXJuKCdbU3RvcmFnZUNvbmZpZ01hbmFnZXJdIOKaoO+4jyBGb3VuZCBwbGFpbnRleHQgYWN0aXZpdHkgbG9ncyAtIHdpbGwgZW5jcnlwdCBvbiBuZXh0IHNhdmUnKTtcbiAgICB9XG5cbiAgICAvLyA0LiBEZWNyeXB0IGFjY291bnQgZGF0YSBpZiBpdCBleGlzdHNcbiAgICBpZiAoY29uZmlnV2l0aEVuY3J5cHRlZC5fZW5jcnlwdGVkQWNjb3VudERhdGEpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIFJlbW92ZWQgdmVyYm9zZSBsb2dnaW5nIGZvciBwcm9kdWN0aW9uXG4gICAgICAgIGNvbnN0IGRlY3J5cHRlZEFjY291bnQgPSBhd2FpdCB0aGlzLmVuY3J5cHRpb25NYW5hZ2VyLmRlY3J5cHRBY2NvdW50RGF0YShjb25maWdXaXRoRW5jcnlwdGVkLl9lbmNyeXB0ZWRBY2NvdW50RGF0YSk7XG4gICAgICAgIGNvbmZpZy5hY2NvdW50ID0ge1xuICAgICAgICAgIC4uLmNvbmZpZy5hY2NvdW50LFxuICAgICAgICAgIGVtYWlsOiBkZWNyeXB0ZWRBY2NvdW50LmVtYWlsLFxuICAgICAgICAgIGRpc3BsYXlOYW1lOiBkZWNyeXB0ZWRBY2NvdW50LmRpc3BsYXlOYW1lLFxuICAgICAgICAgIHBob3RvVVJMOiBkZWNyeXB0ZWRBY2NvdW50LnBob3RvVVJMLFxuICAgICAgICAgIGZpcmViYXNlVWlkOiBkZWNyeXB0ZWRBY2NvdW50LmZpcmViYXNlVWlkLFxuICAgICAgICB9O1xuICAgICAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VDb25maWdNYW5hZ2VyXSDinIUgQWNjb3VudCBkYXRhIGRlY3J5cHRlZCcpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgLy8gVXNlciBub3QgYXV0aGVudGljYXRlZCAtIGV4cGVjdGVkLCBkb24ndCBzcGFtIGNvbnNvbGVcbiAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnRU5DUllQVElPTl9LRVlfVU5BVkFJTEFCTEUnKSkge1xuICAgICAgICAgIC8vIExvY2tlZCBzdGF0ZSBpcyBleHBlY3RlZCBpbiBzZXJ2aWNlIHdvcmtlclxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTdG9yYWdlQ29uZmlnTWFuYWdlcl0g4p2MIEZhaWxlZCB0byBkZWNyeXB0IGFjY291bnQgZGF0YTonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgLy8gS2VlcCBlbXB0eSBhY2NvdW50IGRhdGEgaWYgZGVjcnlwdGlvbiBmYWlsc1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoY29uZmlnLmFjY291bnQgJiYgKGNvbmZpZy5hY2NvdW50LmVtYWlsIHx8IGNvbmZpZy5hY2NvdW50LmRpc3BsYXlOYW1lKSkge1xuICAgICAgY29uc29sZS53YXJuKCdbU3RvcmFnZUNvbmZpZ01hbmFnZXJdIOKaoO+4jyBGb3VuZCBwbGFpbnRleHQgYWNjb3VudCBkYXRhIC0gd2lsbCBlbmNyeXB0IG9uIG5leHQgc2F2ZScpO1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKCdbVGhlbWUgRGVidWddIPCfk4IgQ29uZmlnIHJldHJpZXZlZCBmcm9tIGNocm9tZS5zdG9yYWdlLmxvY2FsOicsIHtcbiAgICAgIGhhc0NvbmZpZzogISFjb25maWcsXG4gICAgICB0aGVtZTogY29uZmlnPy5zZXR0aW5ncz8udGhlbWUgfHwgJ25vbmUnLFxuICAgICAgaXNOdWxsOiBjb25maWcgPT09IG51bGwsXG4gICAgICBoYXNFbmNyeXB0ZWRLZXlzOiAhIWNvbmZpZ1dpdGhFbmNyeXB0ZWQuX2VuY3J5cHRlZEFwaUtleVZhdWx0LFxuICAgICAgaGFzRW5jcnlwdGVkUnVsZXM6ICEhY29uZmlnV2l0aEVuY3J5cHRlZC5fZW5jcnlwdGVkQ3VzdG9tUnVsZXMsXG4gICAgICBoYXNFbmNyeXB0ZWRMb2dzOiAhIWNvbmZpZ1dpdGhFbmNyeXB0ZWQuX2VuY3J5cHRlZEFjdGl2aXR5TG9ncyxcbiAgICAgIGhhc0VuY3J5cHRlZEFjY291bnQ6ICEhY29uZmlnV2l0aEVuY3J5cHRlZC5fZW5jcnlwdGVkQWNjb3VudERhdGEsXG4gICAgICBrZXlDb3VudDogY29uZmlnLmFwaUtleVZhdWx0Py5rZXlzPy5sZW5ndGggfHwgMCxcbiAgICAgIHJ1bGVzQ291bnQ6IGNvbmZpZy5jdXN0b21SdWxlcz8ucnVsZXM/Lmxlbmd0aCB8fCAwLFxuICAgICAgbG9nc0NvdW50OiBjb25maWcuc3RhdHM/LmFjdGl2aXR5TG9nPy5sZW5ndGggfHwgMCxcbiAgICAgIGhhc0FjY291bnRFbWFpbDogISFjb25maWcuYWNjb3VudD8uZW1haWxcbiAgICB9KTtcblxuICAgIC8vIDUuIEluaXRpYWxpemUgcHJvbXB0IHRlbXBsYXRlcyBpZiBtaXNzaW5nIChmb3IgZXhpc3RpbmcgdXNlcnMpXG4gICAgaWYgKCFjb25maWcucHJvbXB0VGVtcGxhdGVzKSB7XG4gICAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VDb25maWdNYW5hZ2VyXSDwn4aVIEFkZGluZyBzdGFydGVyIHByb21wdCB0ZW1wbGF0ZXMgdG8gZXhpc3RpbmcgY29uZmlnJyk7XG4gICAgICBjb25maWcucHJvbXB0VGVtcGxhdGVzID0ge1xuICAgICAgICB0ZW1wbGF0ZXM6IHRoaXMuZ2V0U3RhcnRlclRlbXBsYXRlcygpLFxuICAgICAgICBtYXhUZW1wbGF0ZXM6IDEwLFxuICAgICAgICBlbmFibGVLZXlib2FyZFNob3J0Y3V0czogdHJ1ZSxcbiAgICAgIH07XG4gICAgICAvLyBTYXZlIHRoZSB1cGRhdGVkIGNvbmZpZ1xuICAgICAgYXdhaXQgdGhpcy5zYXZlQ29uZmlnKGNvbmZpZyk7XG4gICAgfVxuXG4gICAgLy8gQ2FjaGUgdGhlIHJlc3VsdFxuICAgIHRoaXMuY29uZmlnQ2FjaGUgPSBjb25maWc7XG4gICAgdGhpcy5jb25maWdDYWNoZVRpbWVzdGFtcCA9IERhdGUubm93KCk7XG5cbiAgICByZXR1cm4gY29uZmlnO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gKHYyKVxuICAgKi9cbiAgZ2V0RGVmYXVsdENvbmZpZygpOiBVc2VyQ29uZmlnIHtcbiAgICByZXR1cm4ge1xuICAgICAgdmVyc2lvbjogMixcbiAgICAgIGFjY291bnQ6IHtcbiAgICAgICAgZW1haWxPcHRJbjogZmFsc2UsXG4gICAgICAgIHRpZXI6ICdwcm8nLFxuICAgICAgICBzeW5jRW5hYmxlZDogZmFsc2UsXG4gICAgICB9LFxuICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgZGVmYXVsdE1vZGU6ICdhdXRvLXJlcGxhY2UnLFxuICAgICAgICBzaG93Tm90aWZpY2F0aW9uczogdHJ1ZSxcbiAgICAgICAgZGVjb2RlUmVzcG9uc2VzOiBmYWxzZSwgICAgICAgIC8vIERvbid0IGNvbnZlcnQgYWxpYXNlcyBiYWNrIHRvIHJlYWwgbmFtZXMgYnkgZGVmYXVsdFxuICAgICAgICB0aGVtZTogJ2NsYXNzaWMtZGFyaycsICAgICAgICAgLy8gRGVmYXVsdCBiYWNrZ3JvdW5kIHRoZW1lIChkYXJrIG1vZGUpXG4gICAgICAgIHByb3RlY3RlZERvbWFpbnM6IFtcbiAgICAgICAgICAnY2hhdC5vcGVuYWkuY29tJyxcbiAgICAgICAgICAnY2hhdGdwdC5jb20nLFxuICAgICAgICAgICdjbGF1ZGUuYWknLFxuICAgICAgICAgICdnZW1pbmkuZ29vZ2xlLmNvbScsXG4gICAgICAgICAgJ3BlcnBsZXhpdHkuYWknLFxuICAgICAgICAgICdjb3BpbG90Lm1pY3Jvc29mdC5jb20nLFxuICAgICAgICBdLFxuICAgICAgICBleGNsdWRlZERvbWFpbnM6IFtdLFxuICAgICAgICBzdHJpY3RNb2RlOiBmYWxzZSxcbiAgICAgICAgZGVidWdNb2RlOiBmYWxzZSxcbiAgICAgICAgY2xvdWRTeW5jOiBmYWxzZSxcbiAgICAgIH0sXG4gICAgICBwcm9maWxlczogW10sXG4gICAgICBzdGF0czoge1xuICAgICAgICB0b3RhbFN1YnN0aXR1dGlvbnM6IDAsXG4gICAgICAgIHRvdGFsSW50ZXJjZXB0aW9uczogMCxcbiAgICAgICAgdG90YWxXYXJuaW5nczogMCxcbiAgICAgICAgc3VjY2Vzc1JhdGU6IDEuMCxcbiAgICAgICAgbGFzdFN5bmNUaW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgIGJ5U2VydmljZToge1xuICAgICAgICAgIGNoYXRncHQ6IHsgcmVxdWVzdHM6IDAsIHN1YnN0aXR1dGlvbnM6IDAgfSxcbiAgICAgICAgICBjbGF1ZGU6IHsgcmVxdWVzdHM6IDAsIHN1YnN0aXR1dGlvbnM6IDAgfSxcbiAgICAgICAgICBnZW1pbmk6IHsgcmVxdWVzdHM6IDAsIHN1YnN0aXR1dGlvbnM6IDAgfSxcbiAgICAgICAgICBwZXJwbGV4aXR5OiB7IHJlcXVlc3RzOiAwLCBzdWJzdGl0dXRpb25zOiAwIH0sXG4gICAgICAgICAgY29waWxvdDogeyByZXF1ZXN0czogMCwgc3Vic3RpdHV0aW9uczogMCB9LFxuICAgICAgICB9LFxuICAgICAgICBhY3Rpdml0eUxvZzogW10sXG4gICAgICB9LFxuICAgICAgcHJvbXB0VGVtcGxhdGVzOiB7XG4gICAgICAgIHRlbXBsYXRlczogdGhpcy5nZXRTdGFydGVyVGVtcGxhdGVzKCksXG4gICAgICAgIG1heFRlbXBsYXRlczogMTAsIC8vIEZyZWUgdGllciBsaW1pdFxuICAgICAgICBlbmFibGVLZXlib2FyZFNob3J0Y3V0czogdHJ1ZSxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgc3RhcnRlciB0ZW1wbGF0ZXMgdG8gaGVscCB1c2VycyB1bmRlcnN0YW5kIHRoZSBmZWF0dXJlXG4gICAqL1xuICBnZXRTdGFydGVyVGVtcGxhdGVzKCk6IFByb21wdFRlbXBsYXRlW10ge1xuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG5cbiAgICByZXR1cm4gW1xuICAgICAge1xuICAgICAgICBpZDogYHN0YXJ0ZXItcHJvZmVzc2lvbmFsLWVtYWlsYCxcbiAgICAgICAgaXNTdGFydGVyOiB0cnVlLFxuICAgICAgICByZWFkb25seTogZmFsc2UsIC8vIFdpbGwgYmUgc2V0IGR5bmFtaWNhbGx5IGJhc2VkIG9uIHRpZXJcbiAgICAgICAgbmFtZTogJ1Byb2Zlc3Npb25hbCBFbWFpbCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnR2VuZXJhdGUgYSBwcm9mZXNzaW9uYWwgZW1haWwgdXNpbmcgeW91ciBwcm90ZWN0ZWQgaWRlbnRpdHknLFxuICAgICAgICBjb250ZW50OiBgV3JpdGUgYSBwcm9mZXNzaW9uYWwgZW1haWwgd2l0aCB0aGUgZm9sbG93aW5nIGRldGFpbHM6XG5cbkZyb206IHt7bmFtZX19ICh7e2VtYWlsfX0pXG5Db21wYW55OiB7e2NvbXBhbnl9fVxuU3ViamVjdDogW1lvdXIgc3ViamVjdCBoZXJlXVxuXG5QbGVhc2UgZHJhZnQgYSBwb2xpdGUsIHByb2Zlc3Npb25hbCBlbWFpbCB0aGF0OlxuLSBJbnRyb2R1Y2VzIG15c2VsZiBhbmQgbXkgY29tcGFueVxuLSBDbGVhcmx5IHN0YXRlcyB0aGUgcHVycG9zZVxuLSBJbmNsdWRlcyBhIGNhbGwgdG8gYWN0aW9uXG4tIEVuZHMgd2l0aCBhcHByb3ByaWF0ZSBjbG9zaW5nXG5cblRvbmU6IFByb2Zlc3Npb25hbCBhbmQgZnJpZW5kbHlgLFxuICAgICAgICBjYXRlZ29yeTogJ0VtYWlsJyxcbiAgICAgICAgdXNhZ2VDb3VudDogMCxcbiAgICAgICAgY3JlYXRlZEF0OiBub3csXG4gICAgICAgIHVwZGF0ZWRBdDogbm93LFxuICAgICAgICBsYXN0VXNlZDogdW5kZWZpbmVkLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaWQ6IGBzdGFydGVyLWNvZGUtcmV2aWV3YCxcbiAgICAgICAgaXNTdGFydGVyOiB0cnVlLFxuICAgICAgICByZWFkb25seTogZmFsc2UsIC8vIFdpbGwgYmUgc2V0IGR5bmFtaWNhbGx5IGJhc2VkIG9uIHRpZXJcbiAgICAgICAgbmFtZTogJ0NvZGUgUmV2aWV3IFJlcXVlc3QnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1JlcXVlc3QgQUkgdG8gcmV2aWV3IGNvZGUgYXMgeW91ciBkZXZlbG9wZXIgcGVyc29uYScsXG4gICAgICAgIGNvbnRlbnQ6IGBJJ20ge3tuYW1lfX0sIGEgZGV2ZWxvcGVyIGF0IHt7Y29tcGFueX19LiBQbGVhc2UgcmV2aWV3IHRoZSBmb2xsb3dpbmcgY29kZTpcblxuW1Bhc3RlIHlvdXIgY29kZSBoZXJlXVxuXG5TcGVjaWZpY2FsbHksIHBsZWFzZSBjaGVjayBmb3I6XG4tIFNlY3VyaXR5IHZ1bG5lcmFiaWxpdGllc1xuLSBQZXJmb3JtYW5jZSBpc3N1ZXNcbi0gQ29kZSBzdHlsZSBhbmQgYmVzdCBwcmFjdGljZXNcbi0gUG90ZW50aWFsIGJ1Z3Mgb3IgZWRnZSBjYXNlc1xuXG5Qcm92aWRlIGZlZWRiYWNrIGFzIGlmIHlvdSdyZSBjb25kdWN0aW5nIGEgcHJvZmVzc2lvbmFsIGNvZGUgcmV2aWV3LmAsXG4gICAgICAgIGNhdGVnb3J5OiAnQ29kZSBSZXZpZXcnLFxuICAgICAgICB1c2FnZUNvdW50OiAwLFxuICAgICAgICBjcmVhdGVkQXQ6IG5vdyxcbiAgICAgICAgdXBkYXRlZEF0OiBub3csXG4gICAgICAgIGxhc3RVc2VkOiB1bmRlZmluZWQsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBpZDogYHN0YXJ0ZXItbWVldGluZy1zdW1tYXJ5YCxcbiAgICAgICAgaXNTdGFydGVyOiB0cnVlLFxuICAgICAgICByZWFkb25seTogZmFsc2UsIC8vIFdpbGwgYmUgc2V0IGR5bmFtaWNhbGx5IGJhc2VkIG9uIHRpZXJcbiAgICAgICAgbmFtZTogJ01lZXRpbmcgU3VtbWFyeScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQ3JlYXRlIG1lZXRpbmcgbm90ZXMgdXNpbmcgeW91ciB3b3JrIGlkZW50aXR5JyxcbiAgICAgICAgY29udGVudDogYENyZWF0ZSBwcm9mZXNzaW9uYWwgbWVldGluZyBub3RlcyBmb3I6XG5cbkF0dGVuZGVlOiB7e25hbWV9fSAoe3tlbWFpbH19KVxuQ29tcGFueToge3tjb21wYW55fX1cbkRhdGU6IFtUb2RheSdzIGRhdGVdXG5Ub3BpYzogW01lZXRpbmcgdG9waWNdXG5cblBsZWFzZSBoZWxwIG1lIHN0cnVjdHVyZSBtZWV0aW5nIG5vdGVzIHRoYXQgaW5jbHVkZTpcbi0gS2V5IGRpc2N1c3Npb24gcG9pbnRzXG4tIEFjdGlvbiBpdGVtcyBhbmQgb3duZXJzXG4tIERlY2lzaW9ucyBtYWRlXG4tIE5leHQgc3RlcHMgYW5kIHRpbWVsaW5lXG5cbktlZXAgaXQgY29uY2lzZSBhbmQgcHJvZmVzc2lvbmFsLCBzdWl0YWJsZSBmb3Igc2hhcmluZyB3aXRoIHN0YWtlaG9sZGVycy5gLFxuICAgICAgICBjYXRlZ29yeTogJ1dyaXRpbmcnLFxuICAgICAgICB1c2FnZUNvdW50OiAwLFxuICAgICAgICBjcmVhdGVkQXQ6IG5vdyxcbiAgICAgICAgdXBkYXRlZEF0OiBub3csXG4gICAgICAgIGxhc3RVc2VkOiB1bmRlZmluZWQsXG4gICAgICB9LFxuICAgIF07XG4gIH1cblxuICAvKipcbiAgICogQ2xlYXIgaW50ZXJuYWwgY2FjaGUgKGZvciB0ZXN0aW5nIHB1cnBvc2VzKVxuICAgKiBAaW50ZXJuYWxcbiAgICovXG4gIGNsZWFyQ2FjaGUoKTogdm9pZCB7XG4gICAgdGhpcy5jb25maWdDYWNoZSA9IG51bGw7XG4gICAgdGhpcy5jb25maWdDYWNoZVRpbWVzdGFtcCA9IDA7XG4gIH1cbn1cbiIsIi8qKlxuICogQWxpYXMgVmFyaWF0aW9ucyBFbmdpbmVcbiAqIEF1dG8tZ2VuZXJhdGVzIG5hbWUgYW5kIGVtYWlsIGZvcm1hdCB2YXJpYXRpb25zIHRvIGNhdGNoIGFsbCBwb3NzaWJsZSBtYXRjaGVzXG4gKlxuICogRXhhbXBsZXM6XG4gKiAtIFwiR3JlZyBCYXJrZXJcIiDihpIgW1wiR3JlZyBCYXJrZXJcIiwgXCJHcmVnQmFya2VyXCIsIFwiZ3JlZ2JhcmtlclwiLCBcImdiYXJrZXJcIiwgXCJHLkJhcmtlclwiLCBcIkcgQmFya2VyXCJdXG4gKiAtIFwiZ3JlZy5iYXJrZXJAZXhhbXBsZS5jb21cIiDihpIgW1wiZ3JlZy5iYXJrZXJAZXhhbXBsZS5jb21cIiwgXCJHcmVnQmFya2VyQGV4YW1wbGUuY29tXCIsIFwiZ3JlZ2JhcmtlckBleGFtcGxlLmNvbVwiXVxuICovXG5cbmV4cG9ydCBpbnRlcmZhY2UgVmFyaWF0aW9uU2V0IHtcbiAgb3JpZ2luYWw6IHN0cmluZztcbiAgdmFyaWF0aW9uczogc3RyaW5nW107XG4gIHR5cGU6ICduYW1lJyB8ICdlbWFpbCcgfCAncGhvbmUnIHwgJ290aGVyJztcbn1cblxuLyoqXG4gKiBHZW5lcmF0ZSBhbGwgdmFyaWF0aW9ucyBvZiBhIG5hbWVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlTmFtZVZhcmlhdGlvbnMobmFtZTogc3RyaW5nKTogc3RyaW5nW10ge1xuICBpZiAoIW5hbWUgfHwgbmFtZS50cmltKCkgPT09ICcnKSByZXR1cm4gW107XG5cbiAgY29uc3QgdmFyaWF0aW9ucyA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICBjb25zdCB0cmltbWVkID0gbmFtZS50cmltKCk7XG5cbiAgLy8gQWRkIG9yaWdpbmFsXG4gIHZhcmlhdGlvbnMuYWRkKHRyaW1tZWQpO1xuXG4gIC8vIFBhcnNlIG5hbWUgcGFydHNcbiAgY29uc3QgcGFydHMgPSB0cmltbWVkLnNwbGl0KC9cXHMrLyk7XG5cbiAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIFt0cmltbWVkXTtcblxuICAvLyBTaW5nbGUgd29yZCBuYW1lIChlLmcuLCBcIk1hZG9ubmFcIilcbiAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMSkge1xuICAgIGNvbnN0IHdvcmQgPSBwYXJ0c1swXTtcbiAgICB2YXJpYXRpb25zLmFkZCh3b3JkKTtcbiAgICB2YXJpYXRpb25zLmFkZCh3b3JkLnRvTG93ZXJDYXNlKCkpO1xuICAgIHZhcmlhdGlvbnMuYWRkKHdvcmQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB3b3JkLnNsaWNlKDEpLnRvTG93ZXJDYXNlKCkpOyAvLyBUaXRsZSBjYXNlXG4gICAgdmFyaWF0aW9ucy5hZGQod29yZC50b1VwcGVyQ2FzZSgpKTtcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh2YXJpYXRpb25zKTtcbiAgfVxuXG4gIC8vIE11bHRpLXBhcnQgbmFtZXNcbiAgY29uc3QgZmlyc3ROYW1lID0gcGFydHNbMF07XG4gIGNvbnN0IGxhc3ROYW1lID0gcGFydHNbcGFydHMubGVuZ3RoIC0gMV07XG4gIGNvbnN0IG1pZGRsZVBhcnRzID0gcGFydHMuc2xpY2UoMSwgLTEpO1xuXG4gIC8vIDEuIE9yaWdpbmFsIHdpdGggc3BhY2VzXG4gIHZhcmlhdGlvbnMuYWRkKHBhcnRzLmpvaW4oJyAnKSk7XG5cbiAgLy8gMi4gTm8gc3BhY2VzIChDYW1lbENhc2UtbGlrZSlcbiAgdmFyaWF0aW9ucy5hZGQocGFydHMuam9pbignJykpO1xuXG4gIC8vIDMuIEFsbCBsb3dlcmNhc2Ugbm8gc3BhY2VzXG4gIHZhcmlhdGlvbnMuYWRkKHBhcnRzLmpvaW4oJycpLnRvTG93ZXJDYXNlKCkpO1xuXG4gIC8vIDQuIEFsbCBsb3dlcmNhc2Ugd2l0aCBzcGFjZXNcbiAgdmFyaWF0aW9ucy5hZGQocGFydHMuam9pbignICcpLnRvTG93ZXJDYXNlKCkpO1xuXG4gIC8vIDUuIFRpdGxlIENhc2VcbiAgY29uc3QgdGl0bGVDYXNlID0gcGFydHMubWFwKHAgPT4gcC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHAuc2xpY2UoMSkudG9Mb3dlckNhc2UoKSkuam9pbignICcpO1xuICB2YXJpYXRpb25zLmFkZCh0aXRsZUNhc2UpO1xuXG4gIC8vIDYuIFRpdGxlIENhc2Ugbm8gc3BhY2VzXG4gIHZhcmlhdGlvbnMuYWRkKHRpdGxlQ2FzZS5yZXBsYWNlKC9cXHMrL2csICcnKSk7XG5cbiAgLy8gNy4gRmlyc3QgaW5pdGlhbCArIExhc3QgbmFtZVxuICB2YXJpYXRpb25zLmFkZChgJHtmaXJzdE5hbWUuY2hhckF0KDApLnRvTG93ZXJDYXNlKCl9JHtsYXN0TmFtZS50b0xvd2VyQ2FzZSgpfWApO1xuICB2YXJpYXRpb25zLmFkZChgJHtmaXJzdE5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCl9JHtsYXN0TmFtZS50b0xvd2VyQ2FzZSgpfWApO1xuICB2YXJpYXRpb25zLmFkZChgJHtmaXJzdE5hbWUuY2hhckF0KDApLnRvTG93ZXJDYXNlKCl9JHtsYXN0TmFtZX1gKTtcbiAgdmFyaWF0aW9ucy5hZGQoYCR7Zmlyc3ROYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpfSR7bGFzdE5hbWV9YCk7XG5cbiAgLy8gOC4gRmlyc3QgaW5pdGlhbCB3aXRoIGRvdCArIHNwYWNlICsgTGFzdCBuYW1lXG4gIHZhcmlhdGlvbnMuYWRkKGAke2ZpcnN0TmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKX0uICR7bGFzdE5hbWV9YCk7XG4gIHZhcmlhdGlvbnMuYWRkKGAke2ZpcnN0TmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKX0uJHtsYXN0TmFtZX1gKTtcblxuICAvLyA5LiBGaXJzdCArIExhc3QgKHNraXAgbWlkZGxlIG5hbWVzIGlmIGFueSlcbiAgaWYgKG1pZGRsZVBhcnRzLmxlbmd0aCA+IDApIHtcbiAgICB2YXJpYXRpb25zLmFkZChgJHtmaXJzdE5hbWV9ICR7bGFzdE5hbWV9YCk7XG4gICAgdmFyaWF0aW9ucy5hZGQoYCR7Zmlyc3ROYW1lfSR7bGFzdE5hbWV9YCk7XG4gICAgdmFyaWF0aW9ucy5hZGQoYCR7Zmlyc3ROYW1lLnRvTG93ZXJDYXNlKCl9JHtsYXN0TmFtZS50b0xvd2VyQ2FzZSgpfWApO1xuICB9XG5cbiAgLy8gMTAuIEFsbCBjYXBzXG4gIHZhcmlhdGlvbnMuYWRkKHBhcnRzLmpvaW4oJyAnKS50b1VwcGVyQ2FzZSgpKTtcbiAgdmFyaWF0aW9ucy5hZGQocGFydHMuam9pbignJykudG9VcHBlckNhc2UoKSk7XG5cbiAgLy8gMTEuIFNuYWtlIGNhc2VcbiAgdmFyaWF0aW9ucy5hZGQocGFydHMuam9pbignXycpLnRvTG93ZXJDYXNlKCkpO1xuICB2YXJpYXRpb25zLmFkZChwYXJ0cy5qb2luKCdfJykudG9VcHBlckNhc2UoKSk7XG5cbiAgLy8gMTIuIEh5cGhlbmF0ZWRcbiAgdmFyaWF0aW9ucy5hZGQocGFydHMuam9pbignLScpLnRvTG93ZXJDYXNlKCkpO1xuICB2YXJpYXRpb25zLmFkZChwYXJ0cy5qb2luKCctJykpO1xuXG4gIC8vIDEzLiBEb3Qgc2VwYXJhdGVkXG4gIHZhcmlhdGlvbnMuYWRkKHBhcnRzLmpvaW4oJy4nKS50b0xvd2VyQ2FzZSgpKTtcbiAgdmFyaWF0aW9ucy5hZGQocGFydHMuam9pbignLicpKTtcblxuICAvLyBSZW1vdmUgZW1wdHkgc3RyaW5ncyBhbmQgZHVwbGljYXRlcyAoU2V0IGFscmVhZHkgaGFuZGxlcyBkdXBsaWNhdGVzKVxuICByZXR1cm4gQXJyYXkuZnJvbSh2YXJpYXRpb25zKS5maWx0ZXIodiA9PiB2Lmxlbmd0aCA+IDApO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlIGFsbCB2YXJpYXRpb25zIG9mIGFuIGVtYWlsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUVtYWlsVmFyaWF0aW9ucyhlbWFpbDogc3RyaW5nKTogc3RyaW5nW10ge1xuICBpZiAoIWVtYWlsIHx8ICFlbWFpbC5pbmNsdWRlcygnQCcpKSByZXR1cm4gW107XG5cbiAgY29uc3QgdmFyaWF0aW9ucyA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICBjb25zdCB0cmltbWVkID0gZW1haWwudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG5cbiAgLy8gQWRkIG9yaWdpbmFsXG4gIHZhcmlhdGlvbnMuYWRkKHRyaW1tZWQpO1xuXG4gIGNvbnN0IFtsb2NhbFBhcnQsIGRvbWFpbl0gPSB0cmltbWVkLnNwbGl0KCdAJyk7XG5cbiAgLy8gRW1haWwgdmFyaWF0aW9ucyAobG9jYWwgcGFydCBvbmx5LCBkb21haW4gc3RheXMgc2FtZSlcbiAgLy8gMS4gQWxsIGxvd2VyY2FzZSAoYWxyZWFkeSBhZGRlZClcblxuICAvLyAyLiBEb3RzIHJlbW92ZWRcbiAgY29uc3Qgbm9Eb3RzID0gbG9jYWxQYXJ0LnJlcGxhY2UoL1xcLi9nLCAnJyk7XG4gIHZhcmlhdGlvbnMuYWRkKGAke25vRG90c31AJHtkb21haW59YCk7XG5cbiAgLy8gMy4gQ2FtZWxDYXNlIGxvY2FsIHBhcnRcbiAgaWYgKGxvY2FsUGFydC5pbmNsdWRlcygnLicpKSB7XG4gICAgY29uc3QgcGFydHMgPSBsb2NhbFBhcnQuc3BsaXQoJy4nKTtcbiAgICBjb25zdCBjYW1lbENhc2UgPSBwYXJ0c1swXSArIHBhcnRzLnNsaWNlKDEpLm1hcChwID0+IHAuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBwLnNsaWNlKDEpKS5qb2luKCcnKTtcbiAgICB2YXJpYXRpb25zLmFkZChgJHtjYW1lbENhc2V9QCR7ZG9tYWlufWApO1xuICB9XG5cbiAgLy8gNC4gVW5kZXJzY29yZXMgdG8gZG90c1xuICBpZiAobG9jYWxQYXJ0LmluY2x1ZGVzKCdfJykpIHtcbiAgICB2YXJpYXRpb25zLmFkZChgJHtsb2NhbFBhcnQucmVwbGFjZSgvXy9nLCAnLicpfUAke2RvbWFpbn1gKTtcbiAgfVxuXG4gIC8vIDUuIERvdHMgdG8gdW5kZXJzY29yZXNcbiAgaWYgKGxvY2FsUGFydC5pbmNsdWRlcygnLicpKSB7XG4gICAgdmFyaWF0aW9ucy5hZGQoYCR7bG9jYWxQYXJ0LnJlcGxhY2UoL1xcLi9nLCAnXycpfUAke2RvbWFpbn1gKTtcbiAgfVxuXG4gIC8vIDYuIFRpdGxlIGNhc2UgZW50aXJlIGxvY2FsIHBhcnRcbiAgY29uc3QgdGl0bGVDYXNlID0gbG9jYWxQYXJ0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbG9jYWxQYXJ0LnNsaWNlKDEpO1xuICB2YXJpYXRpb25zLmFkZChgJHt0aXRsZUNhc2V9QCR7ZG9tYWlufWApO1xuXG4gIHJldHVybiBBcnJheS5mcm9tKHZhcmlhdGlvbnMpO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlIGFsbCB2YXJpYXRpb25zIG9mIGEgcGhvbmUgbnVtYmVyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVBob25lVmFyaWF0aW9ucyhwaG9uZTogc3RyaW5nKTogc3RyaW5nW10ge1xuICBpZiAoIXBob25lIHx8IHBob25lLnRyaW0oKSA9PT0gJycpIHJldHVybiBbXTtcblxuICBjb25zdCB2YXJpYXRpb25zID0gbmV3IFNldDxzdHJpbmc+KCk7XG5cbiAgLy8gQWRkIG9yaWdpbmFsXG4gIHZhcmlhdGlvbnMuYWRkKHBob25lLnRyaW0oKSk7XG5cbiAgLy8gRXh0cmFjdCBkaWdpdHMgb25seVxuICBjb25zdCBkaWdpdHNPbmx5ID0gcGhvbmUucmVwbGFjZSgvXFxEL2csICcnKTtcblxuICBpZiAoZGlnaXRzT25seS5sZW5ndGggPT09IDApIHJldHVybiBbcGhvbmVdO1xuXG4gIC8vIDEuIERpZ2l0cyBvbmx5XG4gIHZhcmlhdGlvbnMuYWRkKGRpZ2l0c09ubHkpO1xuXG4gIC8vIEZvciBVUyBudW1iZXJzICgxMCBvciAxMSBkaWdpdHMpXG4gIGlmIChkaWdpdHNPbmx5Lmxlbmd0aCA9PT0gMTApIHtcbiAgICBjb25zdCBhcmVhQ29kZSA9IGRpZ2l0c09ubHkuc2xpY2UoMCwgMyk7XG4gICAgY29uc3QgcHJlZml4ID0gZGlnaXRzT25seS5zbGljZSgzLCA2KTtcbiAgICBjb25zdCBsaW5lTnVtYmVyID0gZGlnaXRzT25seS5zbGljZSg2LCAxMCk7XG5cbiAgICAvLyAyLiAoWFhYKSBYWFgtWFhYWFxuICAgIHZhcmlhdGlvbnMuYWRkKGAoJHthcmVhQ29kZX0pICR7cHJlZml4fS0ke2xpbmVOdW1iZXJ9YCk7XG5cbiAgICAvLyAzLiBYWFgtWFhYLVhYWFhcbiAgICB2YXJpYXRpb25zLmFkZChgJHthcmVhQ29kZX0tJHtwcmVmaXh9LSR7bGluZU51bWJlcn1gKTtcblxuICAgIC8vIDQuIFhYWC5YWFguWFhYWFxuICAgIHZhcmlhdGlvbnMuYWRkKGAke2FyZWFDb2RlfS4ke3ByZWZpeH0uJHtsaW5lTnVtYmVyfWApO1xuXG4gICAgLy8gNS4gWFhYIFhYWCBYWFhYXG4gICAgdmFyaWF0aW9ucy5hZGQoYCR7YXJlYUNvZGV9ICR7cHJlZml4fSAke2xpbmVOdW1iZXJ9YCk7XG5cbiAgICAvLyA2LiArMSBYWFggWFhYIFhYWFhcbiAgICB2YXJpYXRpb25zLmFkZChgKzEgJHthcmVhQ29kZX0gJHtwcmVmaXh9ICR7bGluZU51bWJlcn1gKTtcblxuICAgIC8vIDcuICsxLVhYWC1YWFgtWFhYWFxuICAgIHZhcmlhdGlvbnMuYWRkKGArMS0ke2FyZWFDb2RlfS0ke3ByZWZpeH0tJHtsaW5lTnVtYmVyfWApO1xuXG4gICAgLy8gOC4gMS1YWFgtWFhYLVhYWFhcbiAgICB2YXJpYXRpb25zLmFkZChgMS0ke2FyZWFDb2RlfS0ke3ByZWZpeH0tJHtsaW5lTnVtYmVyfWApO1xuICB9IGVsc2UgaWYgKGRpZ2l0c09ubHkubGVuZ3RoID09PSAxMSAmJiBkaWdpdHNPbmx5LnN0YXJ0c1dpdGgoJzEnKSkge1xuICAgIC8vIEhhcyBjb3VudHJ5IGNvZGVcbiAgICBjb25zdCBhcmVhQ29kZSA9IGRpZ2l0c09ubHkuc2xpY2UoMSwgNCk7XG4gICAgY29uc3QgcHJlZml4ID0gZGlnaXRzT25seS5zbGljZSg0LCA3KTtcbiAgICBjb25zdCBsaW5lTnVtYmVyID0gZGlnaXRzT25seS5zbGljZSg3LCAxMSk7XG5cbiAgICB2YXJpYXRpb25zLmFkZChgKyR7ZGlnaXRzT25seX1gKTtcbiAgICB2YXJpYXRpb25zLmFkZChgKzEgJHthcmVhQ29kZX0gJHtwcmVmaXh9ICR7bGluZU51bWJlcn1gKTtcbiAgICB2YXJpYXRpb25zLmFkZChgKzEtJHthcmVhQ29kZX0tJHtwcmVmaXh9LSR7bGluZU51bWJlcn1gKTtcbiAgICB2YXJpYXRpb25zLmFkZChgMS0ke2FyZWFDb2RlfS0ke3ByZWZpeH0tJHtsaW5lTnVtYmVyfWApO1xuICAgIHZhcmlhdGlvbnMuYWRkKGAoJHthcmVhQ29kZX0pICR7cHJlZml4fS0ke2xpbmVOdW1iZXJ9YCk7XG4gIH1cblxuICByZXR1cm4gQXJyYXkuZnJvbSh2YXJpYXRpb25zKTtcbn1cblxuLyoqXG4gKiBHZW5lcmF0ZSB2YXJpYXRpb25zIGZvciBhIGdlbmVyaWMgZmllbGQgKGNvbXBhbnksIGFkZHJlc3MsIGV0Yy4pXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUdlbmVyaWNWYXJpYXRpb25zKHRleHQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgaWYgKCF0ZXh0IHx8IHRleHQudHJpbSgpID09PSAnJykgcmV0dXJuIFtdO1xuXG4gIGNvbnN0IHZhcmlhdGlvbnMgPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgY29uc3QgdHJpbW1lZCA9IHRleHQudHJpbSgpO1xuXG4gIC8vIEFkZCBvcmlnaW5hbFxuICB2YXJpYXRpb25zLmFkZCh0cmltbWVkKTtcblxuICAvLyBBZGQgY2FzZSB2YXJpYXRpb25zXG4gIHZhcmlhdGlvbnMuYWRkKHRyaW1tZWQudG9Mb3dlckNhc2UoKSk7XG4gIHZhcmlhdGlvbnMuYWRkKHRyaW1tZWQudG9VcHBlckNhc2UoKSk7XG5cbiAgLy8gVGl0bGUgY2FzZVxuICBjb25zdCB0aXRsZUNhc2UgPSB0cmltbWVkLnNwbGl0KC9cXHMrLykubWFwKHdvcmQgPT5cbiAgICB3b3JkLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgd29yZC5zbGljZSgxKS50b0xvd2VyQ2FzZSgpXG4gICkuam9pbignICcpO1xuICB2YXJpYXRpb25zLmFkZCh0aXRsZUNhc2UpO1xuXG4gIHJldHVybiBBcnJheS5mcm9tKHZhcmlhdGlvbnMpO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlIGFsbCB2YXJpYXRpb25zIGZvciBpZGVudGl0eSBkYXRhXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUlkZW50aXR5VmFyaWF0aW9ucyhpZGVudGl0eToge1xuICBuYW1lPzogc3RyaW5nO1xuICBlbWFpbD86IHN0cmluZztcbiAgcGhvbmU/OiBzdHJpbmc7XG4gIGNlbGxQaG9uZT86IHN0cmluZztcbiAgY29tcGFueT86IHN0cmluZztcbiAgYWRkcmVzcz86IHN0cmluZztcbn0pOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4ge1xuICBjb25zdCB2YXJpYXRpb25zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7fTtcblxuICBpZiAoaWRlbnRpdHkubmFtZSkge1xuICAgIHZhcmlhdGlvbnMubmFtZSA9IGdlbmVyYXRlTmFtZVZhcmlhdGlvbnMoaWRlbnRpdHkubmFtZSk7XG4gIH1cblxuICBpZiAoaWRlbnRpdHkuZW1haWwpIHtcbiAgICB2YXJpYXRpb25zLmVtYWlsID0gZ2VuZXJhdGVFbWFpbFZhcmlhdGlvbnMoaWRlbnRpdHkuZW1haWwpO1xuICB9XG5cbiAgaWYgKGlkZW50aXR5LnBob25lKSB7XG4gICAgdmFyaWF0aW9ucy5waG9uZSA9IGdlbmVyYXRlUGhvbmVWYXJpYXRpb25zKGlkZW50aXR5LnBob25lKTtcbiAgfVxuXG4gIGlmIChpZGVudGl0eS5jZWxsUGhvbmUpIHtcbiAgICB2YXJpYXRpb25zLmNlbGxQaG9uZSA9IGdlbmVyYXRlUGhvbmVWYXJpYXRpb25zKGlkZW50aXR5LmNlbGxQaG9uZSk7XG4gIH1cblxuICBpZiAoaWRlbnRpdHkuY29tcGFueSkge1xuICAgIHZhcmlhdGlvbnMuY29tcGFueSA9IGdlbmVyYXRlR2VuZXJpY1ZhcmlhdGlvbnMoaWRlbnRpdHkuY29tcGFueSk7XG4gIH1cblxuICBpZiAoaWRlbnRpdHkuYWRkcmVzcykge1xuICAgIHZhcmlhdGlvbnMuYWRkcmVzcyA9IGdlbmVyYXRlR2VuZXJpY1ZhcmlhdGlvbnMoaWRlbnRpdHkuYWRkcmVzcyk7XG4gIH1cblxuICByZXR1cm4gdmFyaWF0aW9ucztcbn1cblxuLyoqXG4gKiBDaGVjayBpZiBhIHRleHQgY29udGFpbnMgYW55IHZhcmlhdGlvbiBvZiB0aGUgZ2l2ZW4gdmFsdWVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbnRhaW5zVmFyaWF0aW9uKHRleHQ6IHN0cmluZywgdmFyaWF0aW9uczogc3RyaW5nW10pOiBib29sZWFuIHtcbiAgaWYgKCF0ZXh0IHx8IHZhcmlhdGlvbnMubGVuZ3RoID09PSAwKSByZXR1cm4gZmFsc2U7XG5cbiAgY29uc3QgbG93ZXJUZXh0ID0gdGV4dC50b0xvd2VyQ2FzZSgpO1xuXG4gIHJldHVybiB2YXJpYXRpb25zLnNvbWUodmFyaWF0aW9uID0+IHtcbiAgICAvLyBDYXNlLWluc2Vuc2l0aXZlIHNlYXJjaFxuICAgIHJldHVybiBsb3dlclRleHQuaW5jbHVkZXModmFyaWF0aW9uLnRvTG93ZXJDYXNlKCkpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBGaW5kIGFsbCB2YXJpYXRpb25zIHByZXNlbnQgaW4gdGV4dFxuICovXG5leHBvcnQgZnVuY3Rpb24gZmluZFZhcmlhdGlvbnModGV4dDogc3RyaW5nLCB2YXJpYXRpb25zOiBzdHJpbmdbXSk6IHN0cmluZ1tdIHtcbiAgaWYgKCF0ZXh0IHx8IHZhcmlhdGlvbnMubGVuZ3RoID09PSAwKSByZXR1cm4gW107XG5cbiAgY29uc3QgZm91bmQ6IHN0cmluZ1tdID0gW107XG4gIGNvbnN0IGxvd2VyVGV4dCA9IHRleHQudG9Mb3dlckNhc2UoKTtcblxuICBmb3IgKGNvbnN0IHZhcmlhdGlvbiBvZiB2YXJpYXRpb25zKSB7XG4gICAgaWYgKGxvd2VyVGV4dC5pbmNsdWRlcyh2YXJpYXRpb24udG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgIGZvdW5kLnB1c2godmFyaWF0aW9uKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZm91bmQ7XG59XG5cbi8qKlxuICogR2V0IHN0YXRpc3RpY3MgYWJvdXQgdmFyaWF0aW9uc1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmFyaWF0aW9uU3RhdHModmFyaWF0aW9uczogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+KToge1xuICB0b3RhbFZhcmlhdGlvbnM6IG51bWJlcjtcbiAgYnlGaWVsZDogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbn0ge1xuICBsZXQgdG90YWxWYXJpYXRpb25zID0gMDtcbiAgY29uc3QgYnlGaWVsZDogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xuXG4gIGZvciAoY29uc3QgW2ZpZWxkLCB2YXJzXSBvZiBPYmplY3QuZW50cmllcyh2YXJpYXRpb25zKSkge1xuICAgIGJ5RmllbGRbZmllbGRdID0gdmFycy5sZW5ndGg7XG4gICAgdG90YWxWYXJpYXRpb25zICs9IHZhcnMubGVuZ3RoO1xuICB9XG5cbiAgcmV0dXJuIHsgdG90YWxWYXJpYXRpb25zLCBieUZpZWxkIH07XG59XG4iLCIvKipcbiAqIFN0b3JhZ2UgUHJvZmlsZSBNYW5hZ2VyXG4gKiBIYW5kbGVzIGFsbCBBbGlhc1Byb2ZpbGUgc3RvcmFnZSBvcGVyYXRpb25zXG4gKlxuICogRmVhdHVyZXM6XG4gKiAtIFByb2ZpbGUgQ1JVRCBvcGVyYXRpb25zXG4gKiAtIEF1dG9tYXRpYyB2YXJpYXRpb24gZ2VuZXJhdGlvbiBmb3IgUFJPIHVzZXJzXG4gKiAtIEZSRUUgdGllciBsaW1pdCBlbmZvcmNlbWVudCAoMSBwcm9maWxlIG1heClcbiAqIC0gVXNhZ2Ugc3RhdGlzdGljcyB0cmFja2luZ1xuICogLSBFbmNyeXB0ZWQgc3RvcmFnZSBzdXBwb3J0XG4gKi9cblxuaW1wb3J0IHsgQWxpYXNQcm9maWxlLCBJZGVudGl0eURhdGEgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBTdG9yYWdlRW5jcnlwdGlvbk1hbmFnZXIgfSBmcm9tICcuL1N0b3JhZ2VFbmNyeXB0aW9uTWFuYWdlcic7XG5pbXBvcnQgeyBTdG9yYWdlQ29uZmlnTWFuYWdlciB9IGZyb20gJy4vU3RvcmFnZUNvbmZpZ01hbmFnZXInO1xuaW1wb3J0IHsgZ2VuZXJhdGVJZGVudGl0eVZhcmlhdGlvbnMgfSBmcm9tICcuLi9hbGlhc1ZhcmlhdGlvbnMnO1xuXG5leHBvcnQgY2xhc3MgU3RvcmFnZVByb2ZpbGVNYW5hZ2VyIHtcbiAgcHJpdmF0ZSBlbmNyeXB0aW9uTWFuYWdlcjogU3RvcmFnZUVuY3J5cHRpb25NYW5hZ2VyO1xuICBwcml2YXRlIGNvbmZpZ01hbmFnZXI6IFN0b3JhZ2VDb25maWdNYW5hZ2VyO1xuXG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFBST0ZJTEVTX0tFWSA9ICdwcm9maWxlcyc7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgZW5jcnlwdGlvbk1hbmFnZXI6IFN0b3JhZ2VFbmNyeXB0aW9uTWFuYWdlcixcbiAgICBjb25maWdNYW5hZ2VyOiBTdG9yYWdlQ29uZmlnTWFuYWdlclxuICApIHtcbiAgICB0aGlzLmVuY3J5cHRpb25NYW5hZ2VyID0gZW5jcnlwdGlvbk1hbmFnZXI7XG4gICAgdGhpcy5jb25maWdNYW5hZ2VyID0gY29uZmlnTWFuYWdlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBTYXZlIHByb2ZpbGVzIGFycmF5XG4gICAqL1xuICBhc3luYyBzYXZlUHJvZmlsZXMocHJvZmlsZXM6IEFsaWFzUHJvZmlsZVtdKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgZW5jcnlwdGVkID0gYXdhaXQgdGhpcy5lbmNyeXB0aW9uTWFuYWdlci5lbmNyeXB0KEpTT04uc3RyaW5naWZ5KHByb2ZpbGVzKSk7XG4gICAgYXdhaXQgY2hyb21lLnN0b3JhZ2UubG9jYWwuc2V0KHtcbiAgICAgIFtTdG9yYWdlUHJvZmlsZU1hbmFnZXIuUFJPRklMRVNfS0VZXTogZW5jcnlwdGVkLFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIExvYWQgYW5kIGRlY3J5cHQgcHJvZmlsZXNcbiAgICogU3VwcG9ydHMgYXV0b21hdGljIG1pZ3JhdGlvbiBmcm9tIGxlZ2FjeSBlbmNyeXB0aW9uIChyYW5kb20ga2V5IG1hdGVyaWFsKSB0byBGaXJlYmFzZSBVSURcbiAgICovXG4gIGFzeW5jIGxvYWRQcm9maWxlcygpOiBQcm9taXNlPEFsaWFzUHJvZmlsZVtdPiB7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IGNocm9tZS5zdG9yYWdlLmxvY2FsLmdldChTdG9yYWdlUHJvZmlsZU1hbmFnZXIuUFJPRklMRVNfS0VZKTtcbiAgICBpZiAoIWRhdGFbU3RvcmFnZVByb2ZpbGVNYW5hZ2VyLlBST0ZJTEVTX0tFWV0pIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBjb25zdCBlbmNyeXB0ZWREYXRhID0gZGF0YVtTdG9yYWdlUHJvZmlsZU1hbmFnZXIuUFJPRklMRVNfS0VZXTtcblxuICAgIHRyeSB7XG4gICAgICAvLyBUcnkgRmlyZWJhc2UgVUlEIGtleSBmaXJzdCAobmV3IG1ldGhvZClcbiAgICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZVByb2ZpbGVNYW5hZ2VyXSBBdHRlbXB0aW5nIGRlY3J5cHRpb24gd2l0aCBGaXJlYmFzZSBVSUQga2V5Li4uJyk7XG4gICAgICBjb25zdCBkZWNyeXB0ZWQgPSBhd2FpdCB0aGlzLmVuY3J5cHRpb25NYW5hZ2VyLmRlY3J5cHQoZW5jcnlwdGVkRGF0YSk7XG4gICAgICBjb25zdCBwcm9maWxlcyA9IEpTT04ucGFyc2UoZGVjcnlwdGVkKTtcbiAgICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZVByb2ZpbGVNYW5hZ2VyXSDinIUgRmlyZWJhc2UgVUlEIGRlY3J5cHRpb24gc3VjY2Vzc2Z1bCcpO1xuICAgICAgcmV0dXJuIHByb2ZpbGVzO1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIExvZyB0aGUgQUNUVUFMIGRlY3J5cHRpb24gZXJyb3IgZm9yIGRlYnVnZ2luZ1xuICAgICAgY29uc29sZS5lcnJvcignW1N0b3JhZ2VQcm9maWxlTWFuYWdlcl0g4p2MIFByb2ZpbGVzIGRlY3J5cHRpb24gZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTdG9yYWdlUHJvZmlsZU1hbmFnZXJdIEVycm9yIHR5cGU6JywgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLmNvbnN0cnVjdG9yLm5hbWUgOiB0eXBlb2YgZXJyb3IpO1xuICAgICAgY29uc29sZS5lcnJvcignW1N0b3JhZ2VQcm9maWxlTWFuYWdlcl0gRXJyb3IgbWVzc2FnZTonLCBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcikpO1xuXG4gICAgICAvLyBDaGVjayBpZiBsZWdhY3kga2V5IG1hdGVyaWFsIGV4aXN0cyAoaW5kaWNhdGVzIGRhdGEgbm90IHlldCBtaWdyYXRlZClcbiAgICAgIGNvbnN0IGxlZ2FjeUtleURhdGEgPSBhd2FpdCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5nZXQoJ19lbmNyeXB0aW9uS2V5TWF0ZXJpYWwnKTtcbiAgICAgIGNvbnN0IGhhc0xlZ2FjeUtleSA9ICEhbGVnYWN5S2V5RGF0YVsnX2VuY3J5cHRpb25LZXlNYXRlcmlhbCddO1xuXG4gICAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VQcm9maWxlTWFuYWdlcl0gTGVnYWN5IGtleSBjaGVjazonLCB7IGhhc0xlZ2FjeUtleSB9KTtcblxuICAgICAgaWYgKCFoYXNMZWdhY3lLZXkpIHtcbiAgICAgICAgLy8gTm8gbGVnYWN5IGtleSA9IGFscmVhZHkgbWlncmF0ZWQgdG8gRmlyZWJhc2UgVUlEXG4gICAgICAgIC8vIElmIHdlJ3JlIGluIHNlcnZpY2Ugd29ya2VyLCB3ZSBjYW4ndCBkZWNyeXB0IEZpcmViYXNlIFVJRCBlbmNyeXB0ZWQgZGF0YVxuICAgICAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VQcm9maWxlTWFuYWdlcl0gRGF0YSBhbHJlYWR5IG1pZ3JhdGVkIHRvIEZpcmViYXNlIFVJRCAobm8gbGVnYWN5IGtleSBmb3VuZCknKTtcblxuICAgICAgICAvLyBSZS10aHJvdyB0aGUgb3JpZ2luYWwgZXJyb3IgKGxpa2VseSBFTkNSWVBUSU9OX0tFWV9VTkFWQUlMQUJMRSBpbiBzZXJ2aWNlIHdvcmtlcilcbiAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnRU5DUllQVElPTl9LRVlfVU5BVkFJTEFCTEUnKSkge1xuICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSW5jbHVkZSB0aGUgb3JpZ2luYWwgZXJyb3IgaW4gdGhlIG5ldyBlcnJvciBtZXNzYWdlXG4gICAgICAgIGNvbnN0IG9yaWdpbmFsRXJyb3IgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcik7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgREVDUllQVElPTl9GQUlMRUQ6IFByb2ZpbGVzIGVuY3J5cHRlZCB3aXRoIEZpcmViYXNlIFVJRC4gQXV0aGVudGljYXRpb24gcmVxdWlyZWQuIE9yaWdpbmFsIGVycm9yOiAke29yaWdpbmFsRXJyb3J9YCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUud2FybignW1N0b3JhZ2VQcm9maWxlTWFuYWdlcl0gTGVnYWN5IGtleSBmb3VuZCAtIGF0dGVtcHRpbmcgbGVnYWN5IGtleSBtaWdyYXRpb24uLi4nKTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gRmFsbCBiYWNrIHRvIGxlZ2FjeSByYW5kb20ga2V5IG1hdGVyaWFsXG4gICAgICAgIGNvbnN0IGxlZ2FjeUtleSA9IGF3YWl0IHRoaXMuZW5jcnlwdGlvbk1hbmFnZXIuZ2V0TGVnYWN5RW5jcnlwdGlvbktleSgpO1xuICAgICAgICBjb25zdCBkZWNyeXB0ZWQgPSBhd2FpdCB0aGlzLmVuY3J5cHRpb25NYW5hZ2VyLmRlY3J5cHRXaXRoS2V5KGVuY3J5cHRlZERhdGEsIGxlZ2FjeUtleSk7XG4gICAgICAgIGNvbnN0IHByb2ZpbGVzID0gSlNPTi5wYXJzZShkZWNyeXB0ZWQpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZVByb2ZpbGVNYW5hZ2VyXSDinIUgTGVnYWN5IGRlY3J5cHRpb24gc3VjY2Vzc2Z1bCcpO1xuXG4gICAgICAgIC8vIENoZWNrIGlmIHdlJ3JlIGluIHNlcnZpY2Ugd29ya2VyIGNvbnRleHRcbiAgICAgICAgY29uc3QgaXNTZXJ2aWNlV29ya2VyID0gdHlwZW9mIGRvY3VtZW50ID09PSAndW5kZWZpbmVkJztcblxuICAgICAgICBpZiAoaXNTZXJ2aWNlV29ya2VyKSB7XG4gICAgICAgICAgLy8gSW4gc2VydmljZSB3b3JrZXIsIGNhbid0IHJlLWVuY3J5cHQgKG5vIEZpcmViYXNlIGF1dGgpXG4gICAgICAgICAgLy8gSnVzdCByZXR1cm4gdGhlIGRlY3J5cHRlZCBwcm9maWxlcywgbWlncmF0aW9uIHdpbGwgaGFwcGVuIGluIHBvcHVwXG4gICAgICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlUHJvZmlsZU1hbmFnZXJdIOKPre+4jyBSdW5uaW5nIGluIHNlcnZpY2Ugd29ya2VyIC0gc2tpcHBpbmcgbWlncmF0aW9uICh3aWxsIGhhcHBlbiBpbiBwb3B1cCknKTtcbiAgICAgICAgICByZXR1cm4gcHJvZmlsZXM7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJbiBwb3B1cC9jb250ZW50IGNvbnRleHQgLSBwcm9jZWVkIHdpdGggbWlncmF0aW9uXG4gICAgICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZVByb2ZpbGVNYW5hZ2VyXSDwn5SEIE1pZ3JhdGluZyB0byBGaXJlYmFzZSBVSUQgZW5jcnlwdGlvbi4uLicpO1xuXG4gICAgICAgIC8vIFJlLWVuY3J5cHQgd2l0aCBGaXJlYmFzZSBVSUQga2V5XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZVByb2ZpbGVzKHByb2ZpbGVzKTsgLy8gVXNlcyBGaXJlYmFzZSBVSUQgYXV0b21hdGljYWxseVxuXG4gICAgICAgIC8vIENsZWFuIHVwIG9sZCBrZXkgbWF0ZXJpYWwgKG5vIGxvbmdlciBuZWVkZWQpXG4gICAgICAgIGF3YWl0IGNocm9tZS5zdG9yYWdlLmxvY2FsLnJlbW92ZSgnX2VuY3J5cHRpb25LZXlNYXRlcmlhbCcpO1xuICAgICAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VQcm9maWxlTWFuYWdlcl0g4pyFIE1pZ3JhdGlvbiBjb21wbGV0ZSAtIG9sZCBrZXkgbWF0ZXJpYWwgcmVtb3ZlZCcpO1xuICAgICAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VQcm9maWxlTWFuYWdlcl0g8J+UkCBEYXRhIG5vdyBlbmNyeXB0ZWQgd2l0aCBGaXJlYmFzZSBVSUQnKTtcblxuICAgICAgICByZXR1cm4gcHJvZmlsZXM7XG5cbiAgICAgIH0gY2F0Y2ggKGxlZ2FjeUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTdG9yYWdlUHJvZmlsZU1hbmFnZXJdIEJvdGggZGVjcnlwdGlvbiBtZXRob2RzIGZhaWxlZDonLCBsZWdhY3lFcnJvcik7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTdG9yYWdlUHJvZmlsZU1hbmFnZXJdIE9yaWdpbmFsIGVycm9yOicsIGVycm9yKTtcblxuICAgICAgICAvLyBDaGVjayBpZiBpdCdzIGFuIGF1dGhlbnRpY2F0aW9uIGVycm9yXG4gICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0VOQ1JZUFRJT05fS0VZX1VOQVZBSUxBQkxFJykpIHtcbiAgICAgICAgICB0aHJvdyBlcnJvcjsgLy8gUmUtdGhyb3cgYXV0aCBlcnJvciBmb3IgVUkgdG8gaGFuZGxlXG4gICAgICAgIH1cblxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0RFQ1JZUFRJT05fRkFJTEVEOiBDYW5ub3QgZGVjcnlwdCBwcm9maWxlcy4gRGF0YSBtYXkgYmUgY29ycnVwdGVkIG9yIGF1dGhlbnRpY2F0aW9uIHJlcXVpcmVkLicpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBuZXcgcHJvZmlsZVxuICAgKi9cbiAgYXN5bmMgY3JlYXRlUHJvZmlsZShwcm9maWxlRGF0YToge1xuICAgIHByb2ZpbGVOYW1lOiBzdHJpbmc7XG4gICAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gICAgcmVhbDogSWRlbnRpdHlEYXRhO1xuICAgIGFsaWFzOiBJZGVudGl0eURhdGE7XG4gICAgZW5hYmxlZD86IGJvb2xlYW47XG4gIH0pOiBQcm9taXNlPEFsaWFzUHJvZmlsZT4ge1xuICAgIGNvbnN0IHByb2ZpbGVzID0gYXdhaXQgdGhpcy5sb2FkUHJvZmlsZXMoKTtcblxuICAgIC8vIENoZWNrIEZSRUUgdGllciBsaW1pdCAoMSBwcm9maWxlIG1heClcbiAgICBjb25zdCBjb25maWcgPSBhd2FpdCB0aGlzLmNvbmZpZ01hbmFnZXIubG9hZENvbmZpZygpO1xuICAgIGNvbnN0IGlzRnJlZSA9IGNvbmZpZz8uYWNjb3VudD8udGllciA9PT0gJ2ZyZWUnO1xuXG4gICAgaWYgKGlzRnJlZSAmJiBwcm9maWxlcy5sZW5ndGggPj0gMSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGUkVFX1RJRVJfTElNSVQ6IFlvdSBjYW4gb25seSBjcmVhdGUgMSBwcm9maWxlIG9uIHRoZSBGUkVFIHRpZXIuIFVwZ3JhZGUgdG8gUFJPIGZvciB1bmxpbWl0ZWQgcHJvZmlsZXMuJyk7XG4gICAgfVxuXG4gICAgLy8gR2VuZXJhdGUgdmFyaWF0aW9ucyBPTkxZIGZvciBQUk8gdXNlcnMgKFBSTyBmZWF0dXJlKVxuICAgIGxldCB2YXJpYXRpb25zOiBBbGlhc1Byb2ZpbGVbJ3ZhcmlhdGlvbnMnXSB8IHVuZGVmaW5lZDtcbiAgICBpZiAoIWlzRnJlZSkge1xuICAgICAgY29uc3QgcmVhbFZhcmlhdGlvbnMgPSBnZW5lcmF0ZUlkZW50aXR5VmFyaWF0aW9ucyhwcm9maWxlRGF0YS5yZWFsKTtcbiAgICAgIGNvbnN0IGFsaWFzVmFyaWF0aW9ucyA9IGdlbmVyYXRlSWRlbnRpdHlWYXJpYXRpb25zKHByb2ZpbGVEYXRhLmFsaWFzKTtcbiAgICAgIHZhcmlhdGlvbnMgPSB7XG4gICAgICAgIHJlYWw6IHJlYWxWYXJpYXRpb25zLFxuICAgICAgICBhbGlhczogYWxpYXNWYXJpYXRpb25zLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBjb25zdCBuZXdQcm9maWxlOiBBbGlhc1Byb2ZpbGUgPSB7XG4gICAgICBpZDogdGhpcy5nZW5lcmF0ZUlkKCksXG4gICAgICBwcm9maWxlTmFtZTogcHJvZmlsZURhdGEucHJvZmlsZU5hbWUsXG4gICAgICBkZXNjcmlwdGlvbjogcHJvZmlsZURhdGEuZGVzY3JpcHRpb24sXG4gICAgICBlbmFibGVkOiBwcm9maWxlRGF0YS5lbmFibGVkID8/IHRydWUsXG4gICAgICByZWFsOiBwcm9maWxlRGF0YS5yZWFsLFxuICAgICAgYWxpYXM6IHByb2ZpbGVEYXRhLmFsaWFzLFxuICAgICAgdmFyaWF0aW9ucywgLy8gT25seSBwb3B1bGF0ZWQgZm9yIFBSTyB1c2Vyc1xuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgY3JlYXRlZEF0OiBEYXRlLm5vdygpLFxuICAgICAgICB1cGRhdGVkQXQ6IERhdGUubm93KCksXG4gICAgICAgIHVzYWdlU3RhdHM6IHtcbiAgICAgICAgICB0b3RhbFN1YnN0aXR1dGlvbnM6IDAsXG4gICAgICAgICAgbGFzdFVzZWQ6IDAsXG4gICAgICAgICAgYnlTZXJ2aWNlOiB7XG4gICAgICAgICAgICBjaGF0Z3B0OiAwLFxuICAgICAgICAgICAgY2xhdWRlOiAwLFxuICAgICAgICAgICAgZ2VtaW5pOiAwLFxuICAgICAgICAgICAgcGVycGxleGl0eTogMCxcbiAgICAgICAgICAgIGNvcGlsb3Q6IDAsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBieVBJSVR5cGU6IHtcbiAgICAgICAgICAgIG5hbWU6IDAsXG4gICAgICAgICAgICBlbWFpbDogMCxcbiAgICAgICAgICAgIHBob25lOiAwLFxuICAgICAgICAgICAgY2VsbFBob25lOiAwLFxuICAgICAgICAgICAgYWRkcmVzczogMCxcbiAgICAgICAgICAgIGNvbXBhbnk6IDAsXG4gICAgICAgICAgICBjdXN0b206IDAsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgY29uZmlkZW5jZTogMSxcbiAgICAgIH0sXG4gICAgICBzZXR0aW5nczoge1xuICAgICAgICBhdXRvUmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgaGlnaGxpZ2h0SW5VSTogdHJ1ZSxcbiAgICAgICAgYWN0aXZlU2VydmljZXM6IFsnY2hhdGdwdCcsICdjbGF1ZGUnLCAnZ2VtaW5pJ10sXG4gICAgICAgIGVuYWJsZVZhcmlhdGlvbnM6ICFpc0ZyZWUsIC8vIFBSTyBvbmx5OiBFbmFibGUgdmFyaWF0aW9ucyBmb3IgUFJPIHVzZXJzLCBkaXNhYmxlIGZvciBGUkVFXG4gICAgICB9LFxuICAgIH07XG5cbiAgICBwcm9maWxlcy5wdXNoKG5ld1Byb2ZpbGUpO1xuICAgIGF3YWl0IHRoaXMuc2F2ZVByb2ZpbGVzKHByb2ZpbGVzKTtcbiAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VQcm9maWxlTWFuYWdlcl0gQ3JlYXRlZCBwcm9maWxlOicsIG5ld1Byb2ZpbGUucHJvZmlsZU5hbWUsICd3aXRoIHZhcmlhdGlvbnMnKTtcbiAgICByZXR1cm4gbmV3UHJvZmlsZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgYW4gZXhpc3RpbmcgcHJvZmlsZVxuICAgKi9cbiAgYXN5bmMgdXBkYXRlUHJvZmlsZShpZDogc3RyaW5nLCB1cGRhdGVzOiBQYXJ0aWFsPEFsaWFzUHJvZmlsZT4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBwcm9maWxlcyA9IGF3YWl0IHRoaXMubG9hZFByb2ZpbGVzKCk7XG4gICAgY29uc3QgaW5kZXggPSBwcm9maWxlcy5maW5kSW5kZXgocCA9PiBwLmlkID09PSBpZCk7XG5cbiAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICBjb25zdCB1cGRhdGVkUHJvZmlsZSA9IHtcbiAgICAgICAgLi4ucHJvZmlsZXNbaW5kZXhdLFxuICAgICAgICAuLi51cGRhdGVzLFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIC4uLnByb2ZpbGVzW2luZGV4XS5tZXRhZGF0YSxcbiAgICAgICAgICB1cGRhdGVkQXQ6IERhdGUubm93KCksXG4gICAgICAgIH0sXG4gICAgICAgIC8vIE1lcmdlIHNldHRpbmdzIHByb3Blcmx5XG4gICAgICAgIHNldHRpbmdzOiB7XG4gICAgICAgICAgLi4ucHJvZmlsZXNbaW5kZXhdLnNldHRpbmdzLFxuICAgICAgICAgIC4uLih1cGRhdGVzLnNldHRpbmdzIHx8IHt9KSxcbiAgICAgICAgfSxcbiAgICAgIH07XG5cbiAgICAgIC8vIFJlZ2VuZXJhdGUgdmFyaWF0aW9ucyBpZiByZWFsIG9yIGFsaWFzIGlkZW50aXR5IGNoYW5nZWQgKFBSTyBvbmx5KVxuICAgICAgaWYgKHVwZGF0ZXMucmVhbCB8fCB1cGRhdGVzLmFsaWFzKSB7XG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IGF3YWl0IHRoaXMuY29uZmlnTWFuYWdlci5sb2FkQ29uZmlnKCk7XG4gICAgICAgIGNvbnN0IGlzRnJlZSA9IGNvbmZpZz8uYWNjb3VudD8udGllciA9PT0gJ2ZyZWUnO1xuXG4gICAgICAgIGlmICghaXNGcmVlKSB7XG4gICAgICAgICAgLy8gUFJPIGZlYXR1cmU6IEdlbmVyYXRlIHZhcmlhdGlvbnNcbiAgICAgICAgICBjb25zdCByZWFsVmFyaWF0aW9ucyA9IGdlbmVyYXRlSWRlbnRpdHlWYXJpYXRpb25zKHVwZGF0ZWRQcm9maWxlLnJlYWwpO1xuICAgICAgICAgIGNvbnN0IGFsaWFzVmFyaWF0aW9ucyA9IGdlbmVyYXRlSWRlbnRpdHlWYXJpYXRpb25zKHVwZGF0ZWRQcm9maWxlLmFsaWFzKTtcbiAgICAgICAgICB1cGRhdGVkUHJvZmlsZS52YXJpYXRpb25zID0ge1xuICAgICAgICAgICAgcmVhbDogcmVhbFZhcmlhdGlvbnMsXG4gICAgICAgICAgICBhbGlhczogYWxpYXNWYXJpYXRpb25zLFxuICAgICAgICAgIH07XG4gICAgICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlUHJvZmlsZU1hbmFnZXJdIFJlZ2VuZXJhdGVkIHZhcmlhdGlvbnMgZm9yIHByb2ZpbGU6JywgdXBkYXRlZFByb2ZpbGUucHJvZmlsZU5hbWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIEZSRUUgdGllcjogTm8gdmFyaWF0aW9uc1xuICAgICAgICAgIHVwZGF0ZWRQcm9maWxlLnZhcmlhdGlvbnMgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlUHJvZmlsZU1hbmFnZXJdIFZhcmlhdGlvbnMgZGlzYWJsZWQgZm9yIEZSRUUgdGllciBwcm9maWxlOicsIHVwZGF0ZWRQcm9maWxlLnByb2ZpbGVOYW1lKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBwcm9maWxlc1tpbmRleF0gPSB1cGRhdGVkUHJvZmlsZTtcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZVByb2ZpbGVzKHByb2ZpbGVzKTtcbiAgICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZVByb2ZpbGVNYW5hZ2VyXSBVcGRhdGVkIHByb2ZpbGU6JywgcHJvZmlsZXNbaW5kZXhdLnByb2ZpbGVOYW1lKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGVsZXRlIGEgcHJvZmlsZSBieSBJRFxuICAgKi9cbiAgYXN5bmMgZGVsZXRlUHJvZmlsZShpZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcHJvZmlsZXMgPSBhd2FpdCB0aGlzLmxvYWRQcm9maWxlcygpO1xuICAgIGNvbnN0IGZpbHRlcmVkID0gcHJvZmlsZXMuZmlsdGVyKHAgPT4gcC5pZCAhPT0gaWQpO1xuICAgIGF3YWl0IHRoaXMuc2F2ZVByb2ZpbGVzKGZpbHRlcmVkKTtcbiAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VQcm9maWxlTWFuYWdlcl0gRGVsZXRlZCBwcm9maWxlOicsIGlkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUb2dnbGUgcHJvZmlsZSBlbmFibGVkIHN0YXRlXG4gICAqL1xuICBhc3luYyB0b2dnbGVQcm9maWxlKGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBwcm9maWxlcyA9IGF3YWl0IHRoaXMubG9hZFByb2ZpbGVzKCk7XG4gICAgY29uc3QgaW5kZXggPSBwcm9maWxlcy5maW5kSW5kZXgocCA9PiBwLmlkID09PSBpZCk7XG5cbiAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICBwcm9maWxlc1tpbmRleF0uZW5hYmxlZCA9ICFwcm9maWxlc1tpbmRleF0uZW5hYmxlZDtcbiAgICAgIHByb2ZpbGVzW2luZGV4XS5tZXRhZGF0YS51cGRhdGVkQXQgPSBEYXRlLm5vdygpO1xuICAgICAgYXdhaXQgdGhpcy5zYXZlUHJvZmlsZXMocHJvZmlsZXMpO1xuICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlUHJvZmlsZU1hbmFnZXJdIFRvZ2dsZWQgcHJvZmlsZTonLCBwcm9maWxlc1tpbmRleF0ucHJvZmlsZU5hbWUsICd0bycsIHByb2ZpbGVzW2luZGV4XS5lbmFibGVkKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGEgc2luZ2xlIHByb2ZpbGUgYnkgSURcbiAgICovXG4gIGFzeW5jIGdldFByb2ZpbGUoaWQ6IHN0cmluZyk6IFByb21pc2U8QWxpYXNQcm9maWxlIHwgbnVsbD4ge1xuICAgIGNvbnN0IHByb2ZpbGVzID0gYXdhaXQgdGhpcy5sb2FkUHJvZmlsZXMoKTtcbiAgICByZXR1cm4gcHJvZmlsZXMuZmluZChwID0+IHAuaWQgPT09IGlkKSB8fCBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEluY3JlbWVudCB1c2FnZSBzdGF0cyBmb3IgYSBwcm9maWxlXG4gICAqL1xuICBhc3luYyBpbmNyZW1lbnRQcm9maWxlVXNhZ2UoXG4gICAgcHJvZmlsZUlkOiBzdHJpbmcsXG4gICAgc2VydmljZTogJ2NoYXRncHQnIHwgJ2NsYXVkZScgfCAnZ2VtaW5pJyxcbiAgICBwaWlUeXBlOiBrZXlvZiBBbGlhc1Byb2ZpbGVbJ21ldGFkYXRhJ11bJ3VzYWdlU3RhdHMnXVsnYnlQSUlUeXBlJ11cbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcHJvZmlsZXMgPSBhd2FpdCB0aGlzLmxvYWRQcm9maWxlcygpO1xuICAgIGNvbnN0IGluZGV4ID0gcHJvZmlsZXMuZmluZEluZGV4KHAgPT4gcC5pZCA9PT0gcHJvZmlsZUlkKTtcblxuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgIGNvbnN0IHByb2ZpbGUgPSBwcm9maWxlc1tpbmRleF07XG4gICAgICBwcm9maWxlLm1ldGFkYXRhLnVzYWdlU3RhdHMudG90YWxTdWJzdGl0dXRpb25zKys7XG4gICAgICBwcm9maWxlLm1ldGFkYXRhLnVzYWdlU3RhdHMubGFzdFVzZWQgPSBEYXRlLm5vdygpO1xuICAgICAgcHJvZmlsZS5tZXRhZGF0YS51c2FnZVN0YXRzLmJ5U2VydmljZVtzZXJ2aWNlXSsrO1xuICAgICAgcHJvZmlsZS5tZXRhZGF0YS51c2FnZVN0YXRzLmJ5UElJVHlwZVtwaWlUeXBlXSsrO1xuICAgICAgcHJvZmlsZS5tZXRhZGF0YS51cGRhdGVkQXQgPSBEYXRlLm5vdygpO1xuXG4gICAgICBhd2FpdCB0aGlzLnNhdmVQcm9maWxlcyhwcm9maWxlcyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIHVuaXF1ZSBJRCBmb3IgcHJvZmlsZXNcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVJZCgpOiBzdHJpbmcge1xuICAgIHJldHVybiBgJHtEYXRlLm5vdygpfS0ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gO1xuICB9XG59XG4iLCIvKipcbiAqIFN0b3JhZ2UgQVBJIEtleSBWYXVsdCBNYW5hZ2VyXG4gKiBIYW5kbGVzIGFsbCBBUEkga2V5IHZhdWx0IG9wZXJhdGlvbnNcbiAqXG4gKiBGZWF0dXJlczpcbiAqIC0gQVBJIGtleSBDUlVEIG9wZXJhdGlvbnNcbiAqIC0gQXV0b21hdGljIGtleSBmb3JtYXQgZGV0ZWN0aW9uXG4gKiAtIEZSRUUgdGllciBlbmZvcmNlbWVudCAoMTAga2V5cyBtYXgsIE9wZW5BSSBvbmx5KVxuICogLSBQcm90ZWN0aW9uIGNvdW50IHRyYWNraW5nXG4gKiAtIEVuY3J5cHRlZCBzdG9yYWdlIHZpYSBDb25maWdNYW5hZ2VyXG4gKi9cblxuaW1wb3J0IHsgQVBJS2V5LCBBUElLZXlGb3JtYXQsIEFQSUtleVZhdWx0Q29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgU3RvcmFnZUNvbmZpZ01hbmFnZXIgfSBmcm9tICcuL1N0b3JhZ2VDb25maWdNYW5hZ2VyJztcblxuZXhwb3J0IGNsYXNzIFN0b3JhZ2VBUElLZXlWYXVsdE1hbmFnZXIge1xuICBwcml2YXRlIGNvbmZpZ01hbmFnZXI6IFN0b3JhZ2VDb25maWdNYW5hZ2VyO1xuXG4gIGNvbnN0cnVjdG9yKGNvbmZpZ01hbmFnZXI6IFN0b3JhZ2VDb25maWdNYW5hZ2VyKSB7XG4gICAgdGhpcy5jb25maWdNYW5hZ2VyID0gY29uZmlnTWFuYWdlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIEFQSSBLZXkgVmF1bHQgaW4gY29uZmlnIGlmIG5vdCBwcmVzZW50XG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGVuc3VyZUFQSUtleVZhdWx0Q29uZmlnKGNvbmZpZzogYW55KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKCFjb25maWcuYXBpS2V5VmF1bHQpIHtcbiAgICAgIGNvbmZpZy5hcGlLZXlWYXVsdCA9IHtcbiAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgbW9kZTogJ3dhcm4tZmlyc3QnLFxuICAgICAgICBhdXRvRGV0ZWN0UGF0dGVybnM6IHRydWUsXG4gICAgICAgIGtleXM6IFtdLFxuICAgICAgICBjdXN0b21QYXR0ZXJuczogW10sXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgQVBJIGtleSB0byB2YXVsdFxuICAgKiBGUkVFIHRpZXI6IDEwIGtleXMgbWF4LCBPcGVuQUkgZGV0ZWN0aW9uIG9ubHlcbiAgICogUFJPIHRpZXI6IFVubGltaXRlZCBrZXlzLCBhbGwgcGF0dGVybnNcbiAgICovXG4gIGFzeW5jIGFkZEFQSUtleShrZXlEYXRhOiB7XG4gICAgbmFtZT86IHN0cmluZztcbiAgICBrZXlWYWx1ZTogc3RyaW5nO1xuICAgIGZvcm1hdD86IEFQSUtleUZvcm1hdDtcbiAgfSk6IFByb21pc2U8QVBJS2V5PiB7XG4gICAgY29uc3QgY29uZmlnID0gYXdhaXQgdGhpcy5jb25maWdNYW5hZ2VyLmxvYWRDb25maWcoKTtcbiAgICBpZiAoIWNvbmZpZykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb25maWcgbm90IGluaXRpYWxpemVkJyk7XG4gICAgfVxuXG4gICAgYXdhaXQgdGhpcy5lbnN1cmVBUElLZXlWYXVsdENvbmZpZyhjb25maWcpO1xuXG4gICAgLy8gRlJFRSB0aWVyIGVuZm9yY2VtZW50XG4gICAgY29uc3QgaXNGcmVlID0gY29uZmlnLmFjY291bnQ/LnRpZXIgPT09ICdmcmVlJztcbiAgICBpZiAoaXNGcmVlKSB7XG4gICAgICBjb25zdCBjdXJyZW50S2V5Q291bnQgPSBjb25maWcuYXBpS2V5VmF1bHQhLmtleXMubGVuZ3RoO1xuICAgICAgaWYgKGN1cnJlbnRLZXlDb3VudCA+PSAxMCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZSRUVfVElFUl9MSU1JVDogVXBncmFkZSB0byBQUk8gZm9yIHVubGltaXRlZCBrZXlzJyk7XG4gICAgICB9XG5cbiAgICAgIC8vIE9ubHkgT3BlbkFJIGtleXMgYWxsb3dlZCBpbiBGUkVFIHRpZXJcbiAgICAgIGNvbnN0IGZvcm1hdCA9IGtleURhdGEuZm9ybWF0IHx8IHRoaXMuZGV0ZWN0S2V5Rm9ybWF0KGtleURhdGEua2V5VmFsdWUpO1xuICAgICAgaWYgKGZvcm1hdCAhPT0gJ29wZW5haScpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGUkVFX1RJRVJfUEFUVEVSTjogVXBncmFkZSB0byBQUk8gZm9yIG5vbi1PcGVuQUkga2V5IGRldGVjdGlvbicpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IG5ld0tleTogQVBJS2V5ID0ge1xuICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVJZCgpLFxuICAgICAgbmFtZToga2V5RGF0YS5uYW1lLFxuICAgICAga2V5VmFsdWU6IGtleURhdGEua2V5VmFsdWUsIC8vIFdpbGwgYmUgZW5jcnlwdGVkIGluIGNvbmZpZ1xuICAgICAgZm9ybWF0OiBrZXlEYXRhLmZvcm1hdCB8fCB0aGlzLmRldGVjdEtleUZvcm1hdChrZXlEYXRhLmtleVZhbHVlKSxcbiAgICAgIGNyZWF0ZWRBdDogRGF0ZS5ub3coKSxcbiAgICAgIGxhc3RVc2VkOiAwLFxuICAgICAgcHJvdGVjdGlvbkNvdW50OiAwLFxuICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICB9O1xuXG4gICAgY29uZmlnLmFwaUtleVZhdWx0IS5rZXlzLnB1c2gobmV3S2V5KTtcbiAgICBhd2FpdCB0aGlzLmNvbmZpZ01hbmFnZXIuc2F2ZUNvbmZpZyhjb25maWcpO1xuXG4gICAgY29uc29sZS5sb2coJ1tTdG9yYWdlQVBJS2V5VmF1bHRNYW5hZ2VyXSBBZGRlZCBBUEkga2V5OicsIG5ld0tleS5mb3JtYXQsIG5ld0tleS5uYW1lKTtcbiAgICByZXR1cm4gbmV3S2V5O1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBBUEkga2V5IGZyb20gdmF1bHRcbiAgICovXG4gIGFzeW5jIHJlbW92ZUFQSUtleShrZXlJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgY29uZmlnID0gYXdhaXQgdGhpcy5jb25maWdNYW5hZ2VyLmxvYWRDb25maWcoKTtcbiAgICBpZiAoIWNvbmZpZyB8fCAhY29uZmlnLmFwaUtleVZhdWx0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uZmlnLmFwaUtleVZhdWx0LmtleXMgPSBjb25maWcuYXBpS2V5VmF1bHQua2V5cy5maWx0ZXIoayA9PiBrLmlkICE9PSBrZXlJZCk7XG4gICAgYXdhaXQgdGhpcy5jb25maWdNYW5hZ2VyLnNhdmVDb25maWcoY29uZmlnKTtcbiAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VBUElLZXlWYXVsdE1hbmFnZXJdIFJlbW92ZWQgQVBJIGtleTonLCBrZXlJZCk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIEFQSSBrZXlcbiAgICovXG4gIGFzeW5jIHVwZGF0ZUFQSUtleShrZXlJZDogc3RyaW5nLCB1cGRhdGVzOiBQYXJ0aWFsPEFQSUtleT4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjb25maWcgPSBhd2FpdCB0aGlzLmNvbmZpZ01hbmFnZXIubG9hZENvbmZpZygpO1xuICAgIGlmICghY29uZmlnIHx8ICFjb25maWcuYXBpS2V5VmF1bHQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBpbmRleCA9IGNvbmZpZy5hcGlLZXlWYXVsdC5rZXlzLmZpbmRJbmRleChrID0+IGsuaWQgPT09IGtleUlkKTtcbiAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICBjb25maWcuYXBpS2V5VmF1bHQua2V5c1tpbmRleF0gPSB7XG4gICAgICAgIC4uLmNvbmZpZy5hcGlLZXlWYXVsdC5rZXlzW2luZGV4XSxcbiAgICAgICAgLi4udXBkYXRlcyxcbiAgICAgIH07XG4gICAgICBhd2FpdCB0aGlzLmNvbmZpZ01hbmFnZXIuc2F2ZUNvbmZpZyhjb25maWcpO1xuICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlQVBJS2V5VmF1bHRNYW5hZ2VyXSBVcGRhdGVkIEFQSSBrZXk6Jywga2V5SWQpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgQVBJIGtleSBieSBJRFxuICAgKi9cbiAgYXN5bmMgZ2V0QVBJS2V5KGtleUlkOiBzdHJpbmcpOiBQcm9taXNlPEFQSUtleSB8IG51bGw+IHtcbiAgICBjb25zdCBjb25maWcgPSBhd2FpdCB0aGlzLmNvbmZpZ01hbmFnZXIubG9hZENvbmZpZygpO1xuICAgIGlmICghY29uZmlnIHx8ICFjb25maWcuYXBpS2V5VmF1bHQpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiBjb25maWcuYXBpS2V5VmF1bHQua2V5cy5maW5kKGsgPT4gay5pZCA9PT0ga2V5SWQpIHx8IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGFsbCBBUEkga2V5cyAoZW5jcnlwdGVkIHZhbHVlcyBwcmVzZXJ2ZWQpXG4gICAqL1xuICBhc3luYyBnZXRBbGxBUElLZXlzKCk6IFByb21pc2U8QVBJS2V5W10+IHtcbiAgICBjb25zdCBjb25maWcgPSBhd2FpdCB0aGlzLmNvbmZpZ01hbmFnZXIubG9hZENvbmZpZygpO1xuICAgIGlmICghY29uZmlnIHx8ICFjb25maWcuYXBpS2V5VmF1bHQpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICByZXR1cm4gY29uZmlnLmFwaUtleVZhdWx0LmtleXM7XG4gIH1cblxuICAvKipcbiAgICogSW5jcmVtZW50IHByb3RlY3Rpb24gY291bnQgZm9yIEFQSSBrZXlcbiAgICovXG4gIGFzeW5jIGluY3JlbWVudEFQSUtleVByb3RlY3Rpb24oa2V5SWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNvbmZpZyA9IGF3YWl0IHRoaXMuY29uZmlnTWFuYWdlci5sb2FkQ29uZmlnKCk7XG4gICAgaWYgKCFjb25maWcgfHwgIWNvbmZpZy5hcGlLZXlWYXVsdCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGtleSA9IGNvbmZpZy5hcGlLZXlWYXVsdC5rZXlzLmZpbmQoayA9PiBrLmlkID09PSBrZXlJZCk7XG4gICAgaWYgKGtleSkge1xuICAgICAga2V5LnByb3RlY3Rpb25Db3VudCsrO1xuICAgICAga2V5Lmxhc3RVc2VkID0gRGF0ZS5ub3coKTtcbiAgICAgIGF3YWl0IHRoaXMuY29uZmlnTWFuYWdlci5zYXZlQ29uZmlnKGNvbmZpZyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBBUEkgS2V5IFZhdWx0IHNldHRpbmdzXG4gICAqL1xuICBhc3luYyB1cGRhdGVBUElLZXlWYXVsdFNldHRpbmdzKHNldHRpbmdzOiBQYXJ0aWFsPEFQSUtleVZhdWx0Q29uZmlnPik6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNvbmZpZyA9IGF3YWl0IHRoaXMuY29uZmlnTWFuYWdlci5sb2FkQ29uZmlnKCk7XG4gICAgaWYgKCFjb25maWcpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBhd2FpdCB0aGlzLmVuc3VyZUFQSUtleVZhdWx0Q29uZmlnKGNvbmZpZyk7XG4gICAgY29uZmlnLmFwaUtleVZhdWx0ID0ge1xuICAgICAgLi4uY29uZmlnLmFwaUtleVZhdWx0ISxcbiAgICAgIC4uLnNldHRpbmdzLFxuICAgIH07XG5cbiAgICBhd2FpdCB0aGlzLmNvbmZpZ01hbmFnZXIuc2F2ZUNvbmZpZyhjb25maWcpO1xuICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZUFQSUtleVZhdWx0TWFuYWdlcl0gVXBkYXRlZCBBUEkgS2V5IFZhdWx0IHNldHRpbmdzJyk7XG4gIH1cblxuICAvKipcbiAgICogRGV0ZWN0IEFQSSBrZXkgZm9ybWF0IHVzaW5nIHNpbXBsZSBwYXR0ZXJuIG1hdGNoaW5nXG4gICAqL1xuICBwcml2YXRlIGRldGVjdEtleUZvcm1hdChrZXk6IHN0cmluZyk6IEFQSUtleUZvcm1hdCB7XG4gICAgaWYgKC9ec2stKHByb2otKT9bQS1aYS16MC05XXs0OCx9Ly50ZXN0KGtleSkpIHJldHVybiAnb3BlbmFpJztcbiAgICBpZiAoL15zay1hbnQtW0EtWmEtejAtOS1dezk1fS8udGVzdChrZXkpKSByZXR1cm4gJ2FudGhyb3BpYyc7XG4gICAgaWYgKC9eQUl6YVtBLVphLXowLTlfLV17MzV9Ly50ZXN0KGtleSkpIHJldHVybiAnZ29vZ2xlJztcbiAgICBpZiAoL14oQUtJQXxBU0lBKVtBLVowLTldezE2fS8udGVzdChrZXkpKSByZXR1cm4gJ2F3cyc7XG4gICAgaWYgKC9eZ2hbcHNdX1tBLVphLXowLTldezM2fS8udGVzdChrZXkpKSByZXR1cm4gJ2dpdGh1Yic7XG4gICAgaWYgKC9eKHNrfHBrKV8obGl2ZXx0ZXN0KV9bQS1aYS16MC05XXsyNCx9Ly50ZXN0KGtleSkpIHJldHVybiAnc3RyaXBlJztcbiAgICByZXR1cm4gJ2dlbmVyaWMnO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIHVuaXF1ZSBJRCBmb3IgQVBJIGtleXNcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVJZCgpOiBzdHJpbmcge1xuICAgIHJldHVybiBgJHtEYXRlLm5vdygpfS0ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gO1xuICB9XG59XG4iLCIvKipcbiAqIFN0b3JhZ2UgQ3VzdG9tIFJ1bGVzIE1hbmFnZXJcbiAqIEhhbmRsZXMgYWxsIGN1c3RvbSByZWRhY3Rpb24gcnVsZXMgb3BlcmF0aW9uc1xuICpcbiAqIEZlYXR1cmVzOlxuICogLSBDdXN0b20gcnVsZSBDUlVEIG9wZXJhdGlvbnNcbiAqIC0gUFJPIHRpZXIgcmVxdWlyZW1lbnQgZW5mb3JjZW1lbnRcbiAqIC0gTWF0Y2ggY291bnQgdHJhY2tpbmdcbiAqIC0gVGVzdCBjYXNlIHN1cHBvcnRcbiAqIC0gRW5jcnlwdGVkIHN0b3JhZ2UgdmlhIENvbmZpZ01hbmFnZXJcbiAqL1xuXG5pbXBvcnQgeyBDdXN0b21SdWxlLCBDdXN0b21SdWxlc0NvbmZpZyB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IFN0b3JhZ2VDb25maWdNYW5hZ2VyIH0gZnJvbSAnLi9TdG9yYWdlQ29uZmlnTWFuYWdlcic7XG5cbmV4cG9ydCBjbGFzcyBTdG9yYWdlQ3VzdG9tUnVsZXNNYW5hZ2VyIHtcbiAgcHJpdmF0ZSBjb25maWdNYW5hZ2VyOiBTdG9yYWdlQ29uZmlnTWFuYWdlcjtcblxuICBjb25zdHJ1Y3Rvcihjb25maWdNYW5hZ2VyOiBTdG9yYWdlQ29uZmlnTWFuYWdlcikge1xuICAgIHRoaXMuY29uZmlnTWFuYWdlciA9IGNvbmZpZ01hbmFnZXI7XG4gIH1cblxuICAvKipcbiAgICogRW5zdXJlIGN1c3RvbSBydWxlcyBjb25maWcgZXhpc3RzXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGVuc3VyZUN1c3RvbVJ1bGVzQ29uZmlnKGNvbmZpZzogYW55KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKCFjb25maWcuY3VzdG9tUnVsZXMpIHtcbiAgICAgIGNvbmZpZy5jdXN0b21SdWxlcyA9IHtcbiAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgcnVsZXM6IFtdXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgYSBjdXN0b20gcmVkYWN0aW9uIHJ1bGVcbiAgICovXG4gIGFzeW5jIGFkZEN1c3RvbVJ1bGUocnVsZURhdGE6IHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgcGF0dGVybjogc3RyaW5nO1xuICAgIHJlcGxhY2VtZW50OiBzdHJpbmc7XG4gICAgY2F0ZWdvcnk6ICdwaWknIHwgJ2ZpbmFuY2lhbCcgfCAnbWVkaWNhbCcgfCAnY3VzdG9tJztcbiAgICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgICBwcmlvcml0eT86IG51bWJlcjtcbiAgICB0ZXN0Q2FzZXM/OiB7IGlucHV0OiBzdHJpbmc7IGV4cGVjdGVkOiBzdHJpbmcgfVtdO1xuICB9KTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBjb25maWcgPSBhd2FpdCB0aGlzLmNvbmZpZ01hbmFnZXIubG9hZENvbmZpZygpO1xuICAgIGlmICghY29uZmlnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBsb2FkIGNvbmZpZycpO1xuICAgIH1cblxuICAgIGF3YWl0IHRoaXMuZW5zdXJlQ3VzdG9tUnVsZXNDb25maWcoY29uZmlnKTtcblxuICAgIC8vIENoZWNrIFBSTyB0aWVyIHJlcXVpcmVtZW50XG4gICAgY29uc3QgaXNGcmVlID0gY29uZmlnLmFjY291bnQ/LnRpZXIgPT09ICdmcmVlJztcbiAgICBpZiAoaXNGcmVlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1BST19GRUFUVVJFOiBDdXN0b20gcmVkYWN0aW9uIHJ1bGVzIGFyZSBhIFBSTyBmZWF0dXJlLiBVcGdyYWRlIHRvIFBSTyB0byBjcmVhdGUgY3VzdG9tIHJ1bGVzLicpO1xuICAgIH1cblxuICAgIGNvbnN0IHJ1bGVJZCA9IGNyeXB0by5yYW5kb21VVUlEKCk7XG4gICAgY29uc3QgbmV3UnVsZTogQ3VzdG9tUnVsZSA9IHtcbiAgICAgIGlkOiBydWxlSWQsXG4gICAgICBuYW1lOiBydWxlRGF0YS5uYW1lLFxuICAgICAgcGF0dGVybjogcnVsZURhdGEucGF0dGVybixcbiAgICAgIHJlcGxhY2VtZW50OiBydWxlRGF0YS5yZXBsYWNlbWVudCxcbiAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICBwcmlvcml0eTogcnVsZURhdGEucHJpb3JpdHkgPz8gNTAsXG4gICAgICBjYXRlZ29yeTogcnVsZURhdGEuY2F0ZWdvcnksXG4gICAgICBkZXNjcmlwdGlvbjogcnVsZURhdGEuZGVzY3JpcHRpb24sXG4gICAgICBjcmVhdGVkQXQ6IERhdGUubm93KCksXG4gICAgICBtYXRjaENvdW50OiAwLFxuICAgICAgdGVzdENhc2VzOiBydWxlRGF0YS50ZXN0Q2FzZXNcbiAgICB9O1xuXG4gICAgY29uZmlnLmN1c3RvbVJ1bGVzIS5ydWxlcy5wdXNoKG5ld1J1bGUpO1xuICAgIGF3YWl0IHRoaXMuY29uZmlnTWFuYWdlci5zYXZlQ29uZmlnKGNvbmZpZyk7XG5cbiAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VDdXN0b21SdWxlc01hbmFnZXJdIEFkZGVkIGN1c3RvbSBydWxlOicsIHJ1bGVJZCk7XG4gICAgcmV0dXJuIHJ1bGVJZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgYSBjdXN0b20gcnVsZVxuICAgKi9cbiAgYXN5bmMgcmVtb3ZlQ3VzdG9tUnVsZShydWxlSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNvbmZpZyA9IGF3YWl0IHRoaXMuY29uZmlnTWFuYWdlci5sb2FkQ29uZmlnKCk7XG4gICAgaWYgKCFjb25maWc/LmN1c3RvbVJ1bGVzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uZmlnLmN1c3RvbVJ1bGVzLnJ1bGVzID0gY29uZmlnLmN1c3RvbVJ1bGVzLnJ1bGVzLmZpbHRlcihyID0+IHIuaWQgIT09IHJ1bGVJZCk7XG4gICAgYXdhaXQgdGhpcy5jb25maWdNYW5hZ2VyLnNhdmVDb25maWcoY29uZmlnKTtcblxuICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZUN1c3RvbVJ1bGVzTWFuYWdlcl0gUmVtb3ZlZCBjdXN0b20gcnVsZTonLCBydWxlSWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBhIGN1c3RvbSBydWxlXG4gICAqL1xuICBhc3luYyB1cGRhdGVDdXN0b21SdWxlKHJ1bGVJZDogc3RyaW5nLCB1cGRhdGVzOiBQYXJ0aWFsPEN1c3RvbVJ1bGU+KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgY29uZmlnID0gYXdhaXQgdGhpcy5jb25maWdNYW5hZ2VyLmxvYWRDb25maWcoKTtcbiAgICBpZiAoIWNvbmZpZz8uY3VzdG9tUnVsZXMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBydWxlSW5kZXggPSBjb25maWcuY3VzdG9tUnVsZXMucnVsZXMuZmluZEluZGV4KHIgPT4gci5pZCA9PT0gcnVsZUlkKTtcbiAgICBpZiAocnVsZUluZGV4ID09PSAtMSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBSdWxlIG5vdCBmb3VuZDogJHtydWxlSWR9YCk7XG4gICAgfVxuXG4gICAgY29uZmlnLmN1c3RvbVJ1bGVzLnJ1bGVzW3J1bGVJbmRleF0gPSB7XG4gICAgICAuLi5jb25maWcuY3VzdG9tUnVsZXMucnVsZXNbcnVsZUluZGV4XSxcbiAgICAgIC4uLnVwZGF0ZXNcbiAgICB9O1xuXG4gICAgYXdhaXQgdGhpcy5jb25maWdNYW5hZ2VyLnNhdmVDb25maWcoY29uZmlnKTtcbiAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VDdXN0b21SdWxlc01hbmFnZXJdIFVwZGF0ZWQgY3VzdG9tIHJ1bGU6JywgcnVsZUlkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUb2dnbGUgY3VzdG9tIHJ1bGUgZW5hYmxlZCBzdGF0ZVxuICAgKi9cbiAgYXN5bmMgdG9nZ2xlQ3VzdG9tUnVsZShydWxlSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNvbmZpZyA9IGF3YWl0IHRoaXMuY29uZmlnTWFuYWdlci5sb2FkQ29uZmlnKCk7XG4gICAgaWYgKCFjb25maWc/LmN1c3RvbVJ1bGVzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgcnVsZSA9IGNvbmZpZy5jdXN0b21SdWxlcy5ydWxlcy5maW5kKHIgPT4gci5pZCA9PT0gcnVsZUlkKTtcbiAgICBpZiAocnVsZSkge1xuICAgICAgcnVsZS5lbmFibGVkID0gIXJ1bGUuZW5hYmxlZDtcbiAgICAgIGF3YWl0IHRoaXMuY29uZmlnTWFuYWdlci5zYXZlQ29uZmlnKGNvbmZpZyk7XG4gICAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VDdXN0b21SdWxlc01hbmFnZXJdIFRvZ2dsZWQgY3VzdG9tIHJ1bGU6JywgcnVsZUlkLCAnZW5hYmxlZDonLCBydWxlLmVuYWJsZWQpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgY3VzdG9tIHJ1bGVzIG1hdGNoIGNvdW50XG4gICAqL1xuICBhc3luYyBpbmNyZW1lbnRSdWxlTWF0Y2hDb3VudChydWxlSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNvbmZpZyA9IGF3YWl0IHRoaXMuY29uZmlnTWFuYWdlci5sb2FkQ29uZmlnKCk7XG4gICAgaWYgKCFjb25maWc/LmN1c3RvbVJ1bGVzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgcnVsZSA9IGNvbmZpZy5jdXN0b21SdWxlcy5ydWxlcy5maW5kKHIgPT4gci5pZCA9PT0gcnVsZUlkKTtcbiAgICBpZiAocnVsZSkge1xuICAgICAgcnVsZS5tYXRjaENvdW50Kys7XG4gICAgICBydWxlLmxhc3RVc2VkID0gRGF0ZS5ub3coKTtcbiAgICAgIGF3YWl0IHRoaXMuY29uZmlnTWFuYWdlci5zYXZlQ29uZmlnKGNvbmZpZyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBjdXN0b20gcnVsZXMgc2V0dGluZ3NcbiAgICovXG4gIGFzeW5jIHVwZGF0ZUN1c3RvbVJ1bGVzU2V0dGluZ3Moc2V0dGluZ3M6IFBhcnRpYWw8Q3VzdG9tUnVsZXNDb25maWc+KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgY29uZmlnID0gYXdhaXQgdGhpcy5jb25maWdNYW5hZ2VyLmxvYWRDb25maWcoKTtcbiAgICBpZiAoIWNvbmZpZykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGF3YWl0IHRoaXMuZW5zdXJlQ3VzdG9tUnVsZXNDb25maWcoY29uZmlnKTtcbiAgICBjb25maWcuY3VzdG9tUnVsZXMgPSB7XG4gICAgICAuLi5jb25maWcuY3VzdG9tUnVsZXMhLFxuICAgICAgLi4uc2V0dGluZ3NcbiAgICB9O1xuXG4gICAgYXdhaXQgdGhpcy5jb25maWdNYW5hZ2VyLnNhdmVDb25maWcoY29uZmlnKTtcbiAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VDdXN0b21SdWxlc01hbmFnZXJdIFVwZGF0ZWQgY3VzdG9tIHJ1bGVzIHNldHRpbmdzJyk7XG4gIH1cbn1cbiIsIi8qKlxuICogU3RvcmFnZSBQcm9tcHQgVGVtcGxhdGVzIE1hbmFnZXJcbiAqIEhhbmRsZXMgYWxsIHByb21wdCB0ZW1wbGF0ZSBvcGVyYXRpb25zXG4gKlxuICogRmVhdHVyZXM6XG4gKiAtIFRlbXBsYXRlIENSVUQgb3BlcmF0aW9uc1xuICogLSBQUk8gdGllciByZXF1aXJlbWVudCBmb3IgY3VzdG9tIHRlbXBsYXRlc1xuICogLSBTdGFydGVyIHRlbXBsYXRlcyAoYWx3YXlzIGF2YWlsYWJsZSlcbiAqIC0gVXNhZ2UgdHJhY2tpbmdcbiAqIC0gU3RvcmFnZSB2aWEgQ29uZmlnTWFuYWdlclxuICovXG5cbmltcG9ydCB7IFByb21wdFRlbXBsYXRlLCBQcm9tcHRUZW1wbGF0ZXNDb25maWcsIFVzZXJDb25maWcgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBTdG9yYWdlQ29uZmlnTWFuYWdlciB9IGZyb20gJy4vU3RvcmFnZUNvbmZpZ01hbmFnZXInO1xuXG5leHBvcnQgY2xhc3MgU3RvcmFnZVByb21wdFRlbXBsYXRlc01hbmFnZXIge1xuICBwcml2YXRlIGNvbmZpZ01hbmFnZXI6IFN0b3JhZ2VDb25maWdNYW5hZ2VyO1xuXG4gIGNvbnN0cnVjdG9yKGNvbmZpZ01hbmFnZXI6IFN0b3JhZ2VDb25maWdNYW5hZ2VyKSB7XG4gICAgdGhpcy5jb25maWdNYW5hZ2VyID0gY29uZmlnTWFuYWdlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBFbnN1cmUgY29uZmlnIGhhcyBwcm9tcHQgdGVtcGxhdGVzIHN0cnVjdHVyZVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBlbnN1cmVQcm9tcHRUZW1wbGF0ZXNDb25maWcoY29uZmlnOiBVc2VyQ29uZmlnKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKCFjb25maWcucHJvbXB0VGVtcGxhdGVzKSB7XG4gICAgICBjb25zdCB1c2VyVGllciA9IGNvbmZpZy5hY2NvdW50Py50aWVyIHx8ICdmcmVlJztcbiAgICAgIGNvbmZpZy5wcm9tcHRUZW1wbGF0ZXMgPSB7XG4gICAgICAgIHRlbXBsYXRlczogW10sXG4gICAgICAgIG1heFRlbXBsYXRlczogdXNlclRpZXIgPT09ICdwcm8nIHx8IHVzZXJUaWVyID09PSAnZW50ZXJwcmlzZScgPyAtMSA6IDMsIC8vIC0xID0gdW5saW1pdGVkXG4gICAgICAgIGVuYWJsZUtleWJvYXJkU2hvcnRjdXRzOiB0cnVlLFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQWRkIGEgbmV3IHByb21wdCB0ZW1wbGF0ZVxuICAgKi9cbiAgYXN5bmMgYWRkUHJvbXB0VGVtcGxhdGUodGVtcGxhdGVEYXRhOiB7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIGNvbnRlbnQ6IHN0cmluZztcbiAgICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgICBjYXRlZ29yeT86IHN0cmluZztcbiAgICB0YWdzPzogc3RyaW5nW107XG4gICAgcHJvZmlsZUlkPzogc3RyaW5nO1xuICB9KTogUHJvbWlzZTxQcm9tcHRUZW1wbGF0ZT4ge1xuICAgIGNvbnN0IGNvbmZpZyA9IGF3YWl0IHRoaXMuY29uZmlnTWFuYWdlci5sb2FkQ29uZmlnKCk7XG4gICAgaWYgKCFjb25maWcpIHRocm93IG5ldyBFcnJvcignQ29uZmlnIG5vdCBpbml0aWFsaXplZCcpO1xuXG4gICAgYXdhaXQgdGhpcy5lbnN1cmVQcm9tcHRUZW1wbGF0ZXNDb25maWcoY29uZmlnKTtcblxuICAgIC8vIEZSRUUgdXNlcnMgY2Fubm90IGNyZWF0ZSBjdXN0b20gdGVtcGxhdGVzIChzdGFydGVyIHRlbXBsYXRlcyBhcmUgYWx3YXlzIGZyZWUpXG4gICAgY29uc3QgaXNGcmVlID0gY29uZmlnLmFjY291bnQ/LnRpZXIgPT09ICdmcmVlJztcbiAgICBpZiAoaXNGcmVlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1BST19GRUFUVVJFOiBDcmVhdGluZyBjdXN0b20gdGVtcGxhdGVzIHJlcXVpcmVzIFBSTyB0aWVyLiBVcGdyYWRlIHRvIHVubG9jayB1bmxpbWl0ZWQgdGVtcGxhdGVzLicpO1xuICAgIH1cblxuICAgIGNvbnN0IG5ld1RlbXBsYXRlOiBQcm9tcHRUZW1wbGF0ZSA9IHtcbiAgICAgIGlkOiB0aGlzLmdlbmVyYXRlSWQoKSxcbiAgICAgIG5hbWU6IHRlbXBsYXRlRGF0YS5uYW1lLFxuICAgICAgY29udGVudDogdGVtcGxhdGVEYXRhLmNvbnRlbnQsXG4gICAgICBkZXNjcmlwdGlvbjogdGVtcGxhdGVEYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgY2F0ZWdvcnk6IHRlbXBsYXRlRGF0YS5jYXRlZ29yeSxcbiAgICAgIHRhZ3M6IHRlbXBsYXRlRGF0YS50YWdzLFxuICAgICAgcHJvZmlsZUlkOiB0ZW1wbGF0ZURhdGEucHJvZmlsZUlkLFxuICAgICAgY3JlYXRlZEF0OiBEYXRlLm5vdygpLFxuICAgICAgdXBkYXRlZEF0OiBEYXRlLm5vdygpLFxuICAgICAgdXNhZ2VDb3VudDogMCxcbiAgICAgIGxhc3RVc2VkOiB1bmRlZmluZWQsXG4gICAgfTtcblxuICAgIGNvbmZpZy5wcm9tcHRUZW1wbGF0ZXMhLnRlbXBsYXRlcy5wdXNoKG5ld1RlbXBsYXRlKTtcbiAgICBhd2FpdCB0aGlzLmNvbmZpZ01hbmFnZXIuc2F2ZUNvbmZpZyhjb25maWcpO1xuICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZVByb21wdFRlbXBsYXRlc01hbmFnZXJdIEFkZGVkIHByb21wdCB0ZW1wbGF0ZTonLCBuZXdUZW1wbGF0ZS5uYW1lKTtcblxuICAgIHJldHVybiBuZXdUZW1wbGF0ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgYSBwcm9tcHQgdGVtcGxhdGUgYnkgSURcbiAgICovXG4gIGFzeW5jIHJlbW92ZVByb21wdFRlbXBsYXRlKHRlbXBsYXRlSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNvbmZpZyA9IGF3YWl0IHRoaXMuY29uZmlnTWFuYWdlci5sb2FkQ29uZmlnKCk7XG4gICAgaWYgKCFjb25maWcgfHwgIWNvbmZpZy5wcm9tcHRUZW1wbGF0ZXMpIHJldHVybjtcblxuICAgIGNvbmZpZy5wcm9tcHRUZW1wbGF0ZXMudGVtcGxhdGVzID0gY29uZmlnLnByb21wdFRlbXBsYXRlcy50ZW1wbGF0ZXMuZmlsdGVyKHQgPT4gdC5pZCAhPT0gdGVtcGxhdGVJZCk7XG4gICAgYXdhaXQgdGhpcy5jb25maWdNYW5hZ2VyLnNhdmVDb25maWcoY29uZmlnKTtcbiAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VQcm9tcHRUZW1wbGF0ZXNNYW5hZ2VyXSBSZW1vdmVkIHByb21wdCB0ZW1wbGF0ZTonLCB0ZW1wbGF0ZUlkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgYSBwcm9tcHQgdGVtcGxhdGVcbiAgICovXG4gIGFzeW5jIHVwZGF0ZVByb21wdFRlbXBsYXRlKHRlbXBsYXRlSWQ6IHN0cmluZywgdXBkYXRlczogUGFydGlhbDxQcm9tcHRUZW1wbGF0ZT4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjb25maWcgPSBhd2FpdCB0aGlzLmNvbmZpZ01hbmFnZXIubG9hZENvbmZpZygpO1xuICAgIGlmICghY29uZmlnIHx8ICFjb25maWcucHJvbXB0VGVtcGxhdGVzKSByZXR1cm47XG5cbiAgICBjb25zdCB0ZW1wbGF0ZSA9IGNvbmZpZy5wcm9tcHRUZW1wbGF0ZXMudGVtcGxhdGVzLmZpbmQodCA9PiB0LmlkID09PSB0ZW1wbGF0ZUlkKTtcbiAgICBpZiAoIXRlbXBsYXRlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbU3RvcmFnZVByb21wdFRlbXBsYXRlc01hbmFnZXJdIFRlbXBsYXRlIG5vdCBmb3VuZDonLCB0ZW1wbGF0ZUlkKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBGUkVFIHVzZXJzIGNhbm5vdCBlZGl0IHN0YXJ0ZXIgdGVtcGxhdGVzXG4gICAgY29uc3QgaXNGcmVlID0gY29uZmlnLmFjY291bnQ/LnRpZXIgPT09ICdmcmVlJztcbiAgICBpZiAoaXNGcmVlICYmIHRlbXBsYXRlLmlzU3RhcnRlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdQUk9fRkVBVFVSRTogRWRpdGluZyB0ZW1wbGF0ZXMgcmVxdWlyZXMgUFJPIHRpZXIuIFVwZ3JhZGUgdG8gdW5sb2NrLicpO1xuICAgIH1cblxuICAgIE9iamVjdC5hc3NpZ24odGVtcGxhdGUsIHVwZGF0ZXMsIHsgdXBkYXRlZEF0OiBEYXRlLm5vdygpIH0pO1xuICAgIGF3YWl0IHRoaXMuY29uZmlnTWFuYWdlci5zYXZlQ29uZmlnKGNvbmZpZyk7XG4gICAgY29uc29sZS5sb2coJ1tTdG9yYWdlUHJvbXB0VGVtcGxhdGVzTWFuYWdlcl0gVXBkYXRlZCBwcm9tcHQgdGVtcGxhdGU6JywgdGVtcGxhdGVJZCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGEgc2luZ2xlIHByb21wdCB0ZW1wbGF0ZSBieSBJRFxuICAgKi9cbiAgYXN5bmMgZ2V0UHJvbXB0VGVtcGxhdGUodGVtcGxhdGVJZDogc3RyaW5nKTogUHJvbWlzZTxQcm9tcHRUZW1wbGF0ZSB8IG51bGw+IHtcbiAgICBjb25zdCBjb25maWcgPSBhd2FpdCB0aGlzLmNvbmZpZ01hbmFnZXIubG9hZENvbmZpZygpO1xuICAgIGlmICghY29uZmlnIHx8ICFjb25maWcucHJvbXB0VGVtcGxhdGVzKSByZXR1cm4gbnVsbDtcblxuICAgIHJldHVybiBjb25maWcucHJvbXB0VGVtcGxhdGVzLnRlbXBsYXRlcy5maW5kKHQgPT4gdC5pZCA9PT0gdGVtcGxhdGVJZCkgfHwgbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYWxsIHByb21wdCB0ZW1wbGF0ZXNcbiAgICovXG4gIGFzeW5jIGdldEFsbFByb21wdFRlbXBsYXRlcygpOiBQcm9taXNlPFByb21wdFRlbXBsYXRlW10+IHtcbiAgICBjb25zdCBjb25maWcgPSBhd2FpdCB0aGlzLmNvbmZpZ01hbmFnZXIubG9hZENvbmZpZygpO1xuICAgIGlmICghY29uZmlnIHx8ICFjb25maWcucHJvbXB0VGVtcGxhdGVzKSByZXR1cm4gW107XG5cbiAgICByZXR1cm4gY29uZmlnLnByb21wdFRlbXBsYXRlcy50ZW1wbGF0ZXM7XG4gIH1cblxuICAvKipcbiAgICogSW5jcmVtZW50IHRlbXBsYXRlIHVzYWdlIGNvdW50ZXJcbiAgICovXG4gIGFzeW5jIGluY3JlbWVudFRlbXBsYXRlVXNhZ2UodGVtcGxhdGVJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgY29uZmlnID0gYXdhaXQgdGhpcy5jb25maWdNYW5hZ2VyLmxvYWRDb25maWcoKTtcbiAgICBpZiAoIWNvbmZpZyB8fCAhY29uZmlnLnByb21wdFRlbXBsYXRlcykgcmV0dXJuO1xuXG4gICAgY29uc3QgdGVtcGxhdGUgPSBjb25maWcucHJvbXB0VGVtcGxhdGVzLnRlbXBsYXRlcy5maW5kKHQgPT4gdC5pZCA9PT0gdGVtcGxhdGVJZCk7XG4gICAgaWYgKHRlbXBsYXRlKSB7XG4gICAgICB0ZW1wbGF0ZS51c2FnZUNvdW50Kys7XG4gICAgICB0ZW1wbGF0ZS5sYXN0VXNlZCA9IERhdGUubm93KCk7XG4gICAgICBhd2FpdCB0aGlzLmNvbmZpZ01hbmFnZXIuc2F2ZUNvbmZpZyhjb25maWcpO1xuICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlUHJvbXB0VGVtcGxhdGVzTWFuYWdlcl0gSW5jcmVtZW50ZWQgdGVtcGxhdGUgdXNhZ2U6JywgdGVtcGxhdGVJZCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBwcm9tcHQgdGVtcGxhdGVzIHNldHRpbmdzXG4gICAqL1xuICBhc3luYyB1cGRhdGVQcm9tcHRUZW1wbGF0ZXNTZXR0aW5ncyhzZXR0aW5nczogUGFydGlhbDxQcm9tcHRUZW1wbGF0ZXNDb25maWc+KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgY29uZmlnID0gYXdhaXQgdGhpcy5jb25maWdNYW5hZ2VyLmxvYWRDb25maWcoKTtcbiAgICBpZiAoIWNvbmZpZykgcmV0dXJuO1xuXG4gICAgYXdhaXQgdGhpcy5lbnN1cmVQcm9tcHRUZW1wbGF0ZXNDb25maWcoY29uZmlnKTtcblxuICAgIGNvbmZpZy5wcm9tcHRUZW1wbGF0ZXMgPSB7XG4gICAgICAuLi5jb25maWcucHJvbXB0VGVtcGxhdGVzISxcbiAgICAgIC4uLnNldHRpbmdzXG4gICAgfTtcblxuICAgIGF3YWl0IHRoaXMuY29uZmlnTWFuYWdlci5zYXZlQ29uZmlnKGNvbmZpZyk7XG4gICAgY29uc29sZS5sb2coJ1tTdG9yYWdlUHJvbXB0VGVtcGxhdGVzTWFuYWdlcl0gVXBkYXRlZCBwcm9tcHQgdGVtcGxhdGVzIHNldHRpbmdzJyk7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgdW5pcXVlIElEIGZvciB0ZW1wbGF0ZXNcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVJZCgpOiBzdHJpbmcge1xuICAgIHJldHVybiBgJHtEYXRlLm5vdygpfS0ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gO1xuICB9XG59XG4iLCIvKipcbiAqIFN0b3JhZ2UgRG9jdW1lbnQgQWxpYXMgTWFuYWdlclxuICogSGFuZGxlcyBkb2N1bWVudCBhbmFseXNpcyBhbGlhcyBzdG9yYWdlXG4gKlxuICogRmVhdHVyZXM6XG4gKiAtIERvY3VtZW50IGFsaWFzIENSVUQgb3BlcmF0aW9uc1xuICogLSBFbmNyeXB0ZWQgc3RvcmFnZSBmb3IgZG9jdW1lbnQgYW5hbHlzaXMgcmVzdWx0c1xuICogLSBBdXRvbWF0aWMgZG9jdW1lbnQgbGltaXQgbWFuYWdlbWVudCAoNTAgbWF4KVxuICogLSBVc2FnZSB0cmFja2luZ1xuICovXG5cbmltcG9ydCB7IERvY3VtZW50QWxpYXMgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBTdG9yYWdlRW5jcnlwdGlvbk1hbmFnZXIgfSBmcm9tICcuL1N0b3JhZ2VFbmNyeXB0aW9uTWFuYWdlcic7XG5cbnR5cGUgU3RvcmVkRG9jdW1lbnRJdGVtID0ge1xuICBpZDogc3RyaW5nO1xuICBkb2N1bWVudE5hbWU6IHN0cmluZztcbiAgY3JlYXRlZEF0OiBudW1iZXI7XG4gIGVuY3J5cHRlZERhdGE6IHN0cmluZztcbn07XG5cbmV4cG9ydCBjbGFzcyBTdG9yYWdlRG9jdW1lbnRBbGlhc01hbmFnZXIge1xuICBwcml2YXRlIGVuY3J5cHRpb25NYW5hZ2VyOiBTdG9yYWdlRW5jcnlwdGlvbk1hbmFnZXI7XG5cbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgRE9DVU1FTlRfQUxJQVNFU19LRVkgPSAnZG9jdW1lbnRBbGlhc2VzJztcbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgTUFYX0RPQ1VNRU5UUyA9IDUwO1xuXG4gIGNvbnN0cnVjdG9yKGVuY3J5cHRpb25NYW5hZ2VyOiBTdG9yYWdlRW5jcnlwdGlvbk1hbmFnZXIpIHtcbiAgICB0aGlzLmVuY3J5cHRpb25NYW5hZ2VyID0gZW5jcnlwdGlvbk1hbmFnZXI7XG4gIH1cblxuICAvKipcbiAgICogTG9hZCBkb2N1bWVudCBhbGlhc2VzIChkZWNyeXB0ZWQpXG4gICAqL1xuICBhc3luYyBsb2FkRG9jdW1lbnRBbGlhc2VzKCk6IFByb21pc2U8RG9jdW1lbnRBbGlhc1tdPiB7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IGNocm9tZS5zdG9yYWdlLmxvY2FsLmdldChTdG9yYWdlRG9jdW1lbnRBbGlhc01hbmFnZXIuRE9DVU1FTlRfQUxJQVNFU19LRVkpO1xuXG4gICAgaWYgKCFkYXRhW1N0b3JhZ2VEb2N1bWVudEFsaWFzTWFuYWdlci5ET0NVTUVOVF9BTElBU0VTX0tFWV0pIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBjb25zdCBhbGlhc2VzOiBEb2N1bWVudEFsaWFzW10gPSBbXTtcblxuICAgIGZvciAoY29uc3QgaXRlbSBvZiBkYXRhW1N0b3JhZ2VEb2N1bWVudEFsaWFzTWFuYWdlci5ET0NVTUVOVF9BTElBU0VTX0tFWV0pIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGRlY3J5cHRlZCA9IGF3YWl0IHRoaXMuZW5jcnlwdGlvbk1hbmFnZXIuZGVjcnlwdChpdGVtLmVuY3J5cHRlZERhdGEpO1xuICAgICAgICBhbGlhc2VzLnB1c2goSlNPTi5wYXJzZShkZWNyeXB0ZWQpKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTdG9yYWdlRG9jdW1lbnRBbGlhc01hbmFnZXJdIEZhaWxlZCB0byBkZWNyeXB0IGRvY3VtZW50OicsIGl0ZW0uaWQsIGVycm9yKTtcbiAgICAgICAgLy8gU2tpcCBjb3JydXB0ZWQgZG9jdW1lbnRzXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gU29ydCBieSBjcmVhdGlvbiBkYXRlIChuZXdlc3QgZmlyc3QpXG4gICAgcmV0dXJuIGFsaWFzZXMuc29ydCgoYSwgYikgPT4gYi5jcmVhdGVkQXQgLSBhLmNyZWF0ZWRBdCk7XG4gIH1cblxuICAvKipcbiAgICogU2F2ZSBkb2N1bWVudCBhbGlhcyAoZW5jcnlwdGVkKVxuICAgKi9cbiAgYXN5bmMgc2F2ZURvY3VtZW50QWxpYXMoZG9jdW1lbnRBbGlhczogRG9jdW1lbnRBbGlhcyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGVuY3J5cHRlZCA9IGF3YWl0IHRoaXMuZW5jcnlwdGlvbk1hbmFnZXIuZW5jcnlwdChKU09OLnN0cmluZ2lmeShkb2N1bWVudEFsaWFzKSk7XG5cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgY2hyb21lLnN0b3JhZ2UubG9jYWwuZ2V0KFN0b3JhZ2VEb2N1bWVudEFsaWFzTWFuYWdlci5ET0NVTUVOVF9BTElBU0VTX0tFWSk7XG4gICAgY29uc3QgZXhpc3Rpbmc6IFN0b3JlZERvY3VtZW50SXRlbVtdID0gZGF0YVtTdG9yYWdlRG9jdW1lbnRBbGlhc01hbmFnZXIuRE9DVU1FTlRfQUxJQVNFU19LRVldIHx8IFtdO1xuXG4gICAgZXhpc3RpbmcucHVzaCh7XG4gICAgICBpZDogZG9jdW1lbnRBbGlhcy5pZCxcbiAgICAgIGRvY3VtZW50TmFtZTogZG9jdW1lbnRBbGlhcy5kb2N1bWVudE5hbWUsXG4gICAgICBjcmVhdGVkQXQ6IGRvY3VtZW50QWxpYXMuY3JlYXRlZEF0LFxuICAgICAgZW5jcnlwdGVkRGF0YTogZW5jcnlwdGVkXG4gICAgfSk7XG5cbiAgICAvLyBMaW1pdCB0byBNQVhfRE9DVU1FTlRTIChjb25maWd1cmFibGUpXG4gICAgaWYgKGV4aXN0aW5nLmxlbmd0aCA+IFN0b3JhZ2VEb2N1bWVudEFsaWFzTWFuYWdlci5NQVhfRE9DVU1FTlRTKSB7XG4gICAgICAvLyBSZW1vdmUgb2xkZXN0IGRvY3VtZW50c1xuICAgICAgZXhpc3Rpbmcuc29ydCgoYSwgYikgPT4gYi5jcmVhdGVkQXQgLSBhLmNyZWF0ZWRBdCk7XG4gICAgICBleGlzdGluZy5zcGxpY2UoU3RvcmFnZURvY3VtZW50QWxpYXNNYW5hZ2VyLk1BWF9ET0NVTUVOVFMpO1xuICAgICAgY29uc29sZS5sb2coYFtTdG9yYWdlRG9jdW1lbnRBbGlhc01hbmFnZXJdIFRyaW1tZWQgdG8gJHtTdG9yYWdlRG9jdW1lbnRBbGlhc01hbmFnZXIuTUFYX0RPQ1VNRU5UU30gZG9jdW1lbnRzYCk7XG4gICAgfVxuXG4gICAgYXdhaXQgY2hyb21lLnN0b3JhZ2UubG9jYWwuc2V0KHtcbiAgICAgIFtTdG9yYWdlRG9jdW1lbnRBbGlhc01hbmFnZXIuRE9DVU1FTlRfQUxJQVNFU19LRVldOiBleGlzdGluZ1xuICAgIH0pO1xuICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZURvY3VtZW50QWxpYXNNYW5hZ2VyXSBTYXZlZCBkb2N1bWVudCBhbGlhczonLCBkb2N1bWVudEFsaWFzLmlkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxldGUgZG9jdW1lbnQgYWxpYXNcbiAgICovXG4gIGFzeW5jIGRlbGV0ZURvY3VtZW50QWxpYXMoaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5nZXQoU3RvcmFnZURvY3VtZW50QWxpYXNNYW5hZ2VyLkRPQ1VNRU5UX0FMSUFTRVNfS0VZKTtcbiAgICBjb25zdCBleGlzdGluZzogU3RvcmVkRG9jdW1lbnRJdGVtW10gPSBkYXRhW1N0b3JhZ2VEb2N1bWVudEFsaWFzTWFuYWdlci5ET0NVTUVOVF9BTElBU0VTX0tFWV0gfHwgW107XG5cbiAgICBjb25zdCBmaWx0ZXJlZCA9IGV4aXN0aW5nLmZpbHRlcigoaXRlbTogU3RvcmVkRG9jdW1lbnRJdGVtKSA9PiBpdGVtLmlkICE9PSBpZCk7XG5cbiAgICBhd2FpdCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoe1xuICAgICAgW1N0b3JhZ2VEb2N1bWVudEFsaWFzTWFuYWdlci5ET0NVTUVOVF9BTElBU0VTX0tFWV06IGZpbHRlcmVkXG4gICAgfSk7XG4gICAgY29uc29sZS5sb2coJ1tTdG9yYWdlRG9jdW1lbnRBbGlhc01hbmFnZXJdIERlbGV0ZWQgZG9jdW1lbnQgYWxpYXM6JywgaWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBkb2N1bWVudCBhbGlhcyAoZm9yIGluY3JlbWVudGluZyB1c2FnZSlcbiAgICovXG4gIGFzeW5jIHVwZGF0ZURvY3VtZW50QWxpYXMoZG9jdW1lbnRBbGlhczogRG9jdW1lbnRBbGlhcyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5nZXQoU3RvcmFnZURvY3VtZW50QWxpYXNNYW5hZ2VyLkRPQ1VNRU5UX0FMSUFTRVNfS0VZKTtcbiAgICBjb25zdCBleGlzdGluZzogU3RvcmVkRG9jdW1lbnRJdGVtW10gPSBkYXRhW1N0b3JhZ2VEb2N1bWVudEFsaWFzTWFuYWdlci5ET0NVTUVOVF9BTElBU0VTX0tFWV0gfHwgW107XG5cbiAgICBjb25zdCBpbmRleCA9IGV4aXN0aW5nLmZpbmRJbmRleCgoaXRlbTogU3RvcmVkRG9jdW1lbnRJdGVtKSA9PiBpdGVtLmlkID09PSBkb2N1bWVudEFsaWFzLmlkKTtcblxuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgIGNvbnN0IGVuY3J5cHRlZCA9IGF3YWl0IHRoaXMuZW5jcnlwdGlvbk1hbmFnZXIuZW5jcnlwdChKU09OLnN0cmluZ2lmeShkb2N1bWVudEFsaWFzKSk7XG4gICAgICBleGlzdGluZ1tpbmRleF0gPSB7XG4gICAgICAgIGlkOiBkb2N1bWVudEFsaWFzLmlkLFxuICAgICAgICBkb2N1bWVudE5hbWU6IGRvY3VtZW50QWxpYXMuZG9jdW1lbnROYW1lLFxuICAgICAgICBjcmVhdGVkQXQ6IGRvY3VtZW50QWxpYXMuY3JlYXRlZEF0LFxuICAgICAgICBlbmNyeXB0ZWREYXRhOiBlbmNyeXB0ZWRcbiAgICAgIH07XG5cbiAgICAgIGF3YWl0IGNocm9tZS5zdG9yYWdlLmxvY2FsLnNldCh7XG4gICAgICAgIFtTdG9yYWdlRG9jdW1lbnRBbGlhc01hbmFnZXIuRE9DVU1FTlRfQUxJQVNFU19LRVldOiBleGlzdGluZ1xuICAgICAgfSk7XG4gICAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VEb2N1bWVudEFsaWFzTWFuYWdlcl0gVXBkYXRlZCBkb2N1bWVudCBhbGlhczonLCBkb2N1bWVudEFsaWFzLmlkKTtcbiAgICB9XG4gIH1cbn1cbiIsIi8qKlxuICogU3RvcmFnZSBVdGlsaXRpZXNcbiAqIFNoYXJlZCB1dGlsaXR5IGZ1bmN0aW9ucyBmb3Igc3RvcmFnZSBvcGVyYXRpb25zXG4gKi9cblxuLyoqXG4gKiBHZW5lcmF0ZSB1bmlxdWUgSUQgZm9yIHN0b3JhZ2UgZW50aXRpZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlSWQoKTogc3RyaW5nIHtcbiAgcmV0dXJuIGAke0RhdGUubm93KCl9LSR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWA7XG59XG5cbi8qKlxuICogR2V0IHN0b3JhZ2UgcXVvdGEgaW5mb3JtYXRpb25cbiAqIFdpdGggdW5saW1pdGVkU3RvcmFnZSBwZXJtaXNzaW9uLCBxdW90YSBpcyBlc3NlbnRpYWxseSBkaXNrIHNwYWNlXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTdG9yYWdlUXVvdGEoKTogUHJvbWlzZTx7XG4gIHVzZWQ6IG51bWJlcjtcbiAgcXVvdGE6IG51bWJlcjtcbiAgcGVyY2VudGFnZTogbnVtYmVyO1xuICBoYXNVbmxpbWl0ZWRTdG9yYWdlOiBib29sZWFuO1xufT4ge1xuICBjb25zdCBlc3RpbWF0ZSA9IGF3YWl0IG5hdmlnYXRvci5zdG9yYWdlLmVzdGltYXRlKCk7XG5cbiAgY29uc3QgdXNlZCA9IGVzdGltYXRlLnVzYWdlIHx8IDA7XG4gIGNvbnN0IHF1b3RhID0gZXN0aW1hdGUucXVvdGEgfHwgMTA0ODU3NjA7IC8vIDEwIE1CIGZhbGxiYWNrXG4gIGNvbnN0IHBlcmNlbnRhZ2UgPSAodXNlZCAvIHF1b3RhKSAqIDEwMDtcblxuICAvLyBDaGVjayBpZiB3ZSBoYXZlIHVubGltaXRlZCBzdG9yYWdlXG4gIC8vIFdpdGggdW5saW1pdGVkU3RvcmFnZSBwZXJtaXNzaW9uLCBxdW90YSBpcyBodWdlIChkaXNrIHNwYWNlKVxuICBjb25zdCBoYXNVbmxpbWl0ZWRTdG9yYWdlID0gcXVvdGEgPiAxMDAwMDAwMDA7IC8vID4gMTAwIE1CID0gdW5saW1pdGVkXG5cbiAgcmV0dXJuIHtcbiAgICB1c2VkLFxuICAgIHF1b3RhLFxuICAgIHBlcmNlbnRhZ2UsXG4gICAgaGFzVW5saW1pdGVkU3RvcmFnZVxuICB9O1xufVxuIiwiLyoqXG4gKiBTdG9yYWdlIE1pZ3JhdGlvbiBNYW5hZ2VyXG4gKiBIYW5kbGVzIGFsbCBkYXRhIG1pZ3JhdGlvbiBvcGVyYXRpb25zXG4gKlxuICogRmVhdHVyZXM6XG4gKiAtIFYxIHRvIFYyIG1pZ3JhdGlvbiAoYWxpYXNlcyB0byBwcm9maWxlcylcbiAqIC0gUGxhaW50ZXh0IHRvIGVuY3J5cHRlZCBzdG9yYWdlIG1pZ3JhdGlvblxuICogLSBMZWdhY3kga2V5IG1hdGVyaWFsIHRvIEZpcmViYXNlIFVJRCBtaWdyYXRpb25cbiAqIC0gQXV0b21hdGljIG1pZ3JhdGlvbiBvbiBpbml0aWFsaXphdGlvblxuICovXG5cbmltcG9ydCB7IEFsaWFzUHJvZmlsZSwgQWxpYXNFbnRyeSwgSWRlbnRpdHlEYXRhLCBVc2VyQ29uZmlnLCBVc2VyQ29uZmlnVjEgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBTdG9yYWdlRW5jcnlwdGlvbk1hbmFnZXIgfSBmcm9tICcuL1N0b3JhZ2VFbmNyeXB0aW9uTWFuYWdlcic7XG5pbXBvcnQgeyBTdG9yYWdlQ29uZmlnTWFuYWdlciB9IGZyb20gJy4vU3RvcmFnZUNvbmZpZ01hbmFnZXInO1xuaW1wb3J0IHsgU3RvcmFnZVByb2ZpbGVNYW5hZ2VyIH0gZnJvbSAnLi9TdG9yYWdlUHJvZmlsZU1hbmFnZXInO1xuaW1wb3J0IHsgZ2VuZXJhdGVJZCB9IGZyb20gJy4vc3RvcmFnZS11dGlscyc7XG5cbmV4cG9ydCBjbGFzcyBTdG9yYWdlTWlncmF0aW9uTWFuYWdlciB7XG4gIHByaXZhdGUgZW5jcnlwdGlvbk1hbmFnZXI6IFN0b3JhZ2VFbmNyeXB0aW9uTWFuYWdlcjtcbiAgcHJpdmF0ZSBjb25maWdNYW5hZ2VyOiBTdG9yYWdlQ29uZmlnTWFuYWdlcjtcbiAgcHJpdmF0ZSBwcm9maWxlTWFuYWdlcjogU3RvcmFnZVByb2ZpbGVNYW5hZ2VyO1xuXG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IEtFWVMgPSB7XG4gICAgQUxJQVNFUzogJ2FsaWFzZXMnLFxuICAgIFBST0ZJTEVTOiAncHJvZmlsZXMnLFxuICAgIENPTkZJRzogJ2NvbmZpZycsXG4gICAgVkVSU0lPTjogJ2RhdGFWZXJzaW9uJyxcbiAgfTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBlbmNyeXB0aW9uTWFuYWdlcjogU3RvcmFnZUVuY3J5cHRpb25NYW5hZ2VyLFxuICAgIGNvbmZpZ01hbmFnZXI6IFN0b3JhZ2VDb25maWdNYW5hZ2VyLFxuICAgIHByb2ZpbGVNYW5hZ2VyOiBTdG9yYWdlUHJvZmlsZU1hbmFnZXJcbiAgKSB7XG4gICAgdGhpcy5lbmNyeXB0aW9uTWFuYWdlciA9IGVuY3J5cHRpb25NYW5hZ2VyO1xuICAgIHRoaXMuY29uZmlnTWFuYWdlciA9IGNvbmZpZ01hbmFnZXI7XG4gICAgdGhpcy5wcm9maWxlTWFuYWdlciA9IHByb2ZpbGVNYW5hZ2VyO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgc3RvcmFnZSB3aXRoIGRlZmF1bHQgdmFsdWVzXG4gICAqIEhhbmRsZXMgdjEgdG8gdjIgbWlncmF0aW9uIGlmIG5lZWRlZFxuICAgKiBHcmFjZWZ1bGx5IGhhbmRsZXMgdW5hdXRoZW50aWNhdGVkIHN0YXRlIChyZXR1cm5zIGVtcHR5IGRhdGEpXG4gICAqIFdvcmtzIGluIGJvdGggc2VydmljZSB3b3JrZXIgYW5kIHBvcHVwIGNvbnRleHRzIChGaXJlYmFzZSBhdXRoL3dlYi1leHRlbnNpb24gc3VwcG9ydClcbiAgICovXG4gIGFzeW5jIGluaXRpYWxpemUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgLy8gRGV0ZWN0IGNvbnRleHQgZm9yIGxvZ2dpbmdcbiAgICBjb25zdCBpc1NlcnZpY2VXb3JrZXIgPSB0eXBlb2YgZG9jdW1lbnQgPT09ICd1bmRlZmluZWQnO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIENoZWNrIGZvciB2MSBkYXRhIGFuZCBtaWdyYXRlIGlmIG5lZWRlZFxuICAgICAgYXdhaXQgdGhpcy5taWdyYXRlVjFUb1YySWZOZWVkZWQoKTtcblxuICAgICAgLy8gTWlncmF0ZSBwbGFpbnRleHQgQVBJIGtleXMgdG8gZW5jcnlwdGVkIHN0b3JhZ2UgaWYgbmVlZGVkXG4gICAgICBhd2FpdCB0aGlzLm1pZ3JhdGVBUElLZXlzVG9FbmNyeXB0ZWRJZk5lZWRlZCgpO1xuXG4gICAgICBjb25zdCBjb25maWcgPSBhd2FpdCB0aGlzLmNvbmZpZ01hbmFnZXIubG9hZENvbmZpZygpO1xuICAgICAgaWYgKCFjb25maWcpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5jb25maWdNYW5hZ2VyLnNhdmVDb25maWcodGhpcy5jb25maWdNYW5hZ2VyLmdldERlZmF1bHRDb25maWcoKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIExvYWQgcHJvZmlsZXMgaW4gQUxMIGNvbnRleHRzIChzZXJ2aWNlIHdvcmtlciBjYW4gbm93IGRlY3J5cHQgd2l0aCB3ZWItZXh0ZW5zaW9uIGF1dGgpXG4gICAgICBjb25zdCBwcm9maWxlcyA9IGF3YWl0IHRoaXMucHJvZmlsZU1hbmFnZXIubG9hZFByb2ZpbGVzKCk7XG4gICAgICBpZiAoIXByb2ZpbGVzIHx8IHByb2ZpbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAvLyBJbml0aWFsaXplIHdpdGggZW1wdHkgcHJvZmlsZXMgYXJyYXlcbiAgICAgICAgYXdhaXQgdGhpcy5wcm9maWxlTWFuYWdlci5zYXZlUHJvZmlsZXMoW10pO1xuICAgICAgfVxuXG4gICAgICBjb25zb2xlLmxvZyhgW1N0b3JhZ2VNaWdyYXRpb25NYW5hZ2VyXSDinIUgSW5pdGlhbGl6ZWQgd2l0aCAke3Byb2ZpbGVzLmxlbmd0aH0gcHJvZmlsZXMgaW4gJHtpc1NlcnZpY2VXb3JrZXIgPyAnU0VSVklDRSBXT1JLRVInIDogJ1BPUFVQJ30gY29udGV4dGApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBJZiB1c2VyIG5vdCBhdXRoZW50aWNhdGVkLCBza2lwIGluaXRpYWxpemF0aW9uIChkYXRhIGxvY2tlZClcbiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0VOQ1JZUFRJT05fS0VZX1VOQVZBSUxBQkxFJykpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlTWlncmF0aW9uTWFuYWdlcl0gVXNlciBub3QgYXV0aGVudGljYXRlZCAtIHNraXBwaW5nIGRhdGEgaW5pdGlhbGl6YXRpb24nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgLy8gSWYgZGVjcnlwdGlvbiBmYWlscyAod3JvbmcgVUlEKSwgYWxsb3cgYXBwIHRvIGZ1bmN0aW9uIHdpdGggZW1wdHkgcHJvZmlsZXNcbiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0RFQ1JZUFRJT05fRkFJTEVEJykpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdbU3RvcmFnZU1pZ3JhdGlvbk1hbmFnZXJdIOKaoO+4jyBEZWNyeXB0aW9uIGZhaWxlZCAtIHBvc3NpYmxlIFVJRCBtaXNtYXRjaCcpO1xuICAgICAgICBjb25zb2xlLndhcm4oJ1tTdG9yYWdlTWlncmF0aW9uTWFuYWdlcl0gQXBwIHdpbGwgcnVuIHdpdGggZW1wdHkgcHJvZmlsZXMuIFNpZ24gaW4gd2l0aCBvcmlnaW5hbCBwcm92aWRlciB0byBhY2Nlc3MgZW5jcnlwdGVkIGRhdGEuJyk7XG5cbiAgICAgICAgLy8gU2hvdyBhdXRoIGlzc3VlIGJhbm5lciBpbiBwb3B1cCAobm90IGluIHNlcnZpY2Ugd29ya2VyKVxuICAgICAgICBpZiAodHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgIC8vIE5vdGlmeSBwb3B1cCB0byBzaG93IHRoZSBiYW5uZXJcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdhdXRoLWRlY3J5cHRpb24tZmFpbGVkJyk7XG4gICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERvbid0IHRocm93IC0gYWxsb3cgYXBwIHRvIGNvbnRpbnVlXG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIC8vIFJlLXRocm93IG90aGVyIGVycm9yc1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIHYxIGRhdGEgZXhpc3RzIGFuZCBtaWdyYXRlIHRvIHYyIGlmIG5lZWRlZFxuICAgKi9cbiAgYXN5bmMgbWlncmF0ZVYxVG9WMklmTmVlZGVkKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGRhdGFWZXJzaW9uID0gYXdhaXQgY2hyb21lLnN0b3JhZ2UubG9jYWwuZ2V0KFN0b3JhZ2VNaWdyYXRpb25NYW5hZ2VyLktFWVMuVkVSU0lPTik7XG5cbiAgICAvLyBBbHJlYWR5IG9uIHYyIG9yIGhpZ2hlclxuICAgIGlmIChkYXRhVmVyc2lvbltTdG9yYWdlTWlncmF0aW9uTWFuYWdlci5LRVlTLlZFUlNJT05dID49IDIpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZU1pZ3JhdGlvbk1hbmFnZXJdIEFscmVhZHkgb24gdjInKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiB2MSBhbGlhc2VzIGV4aXN0XG4gICAgY29uc3QgdjFBbGlhc2VzID0gYXdhaXQgdGhpcy5sb2FkQWxpYXNlc0Zvck1pZ3JhdGlvbigpO1xuICAgIGlmICghdjFBbGlhc2VzIHx8IHYxQWxpYXNlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZU1pZ3JhdGlvbk1hbmFnZXJdIE5vIHYxIGRhdGEgdG8gbWlncmF0ZScpO1xuICAgICAgYXdhaXQgY2hyb21lLnN0b3JhZ2UubG9jYWwuc2V0KHsgW1N0b3JhZ2VNaWdyYXRpb25NYW5hZ2VyLktFWVMuVkVSU0lPTl06IDIgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coJ1tTdG9yYWdlTWlncmF0aW9uTWFuYWdlcl0gTWlncmF0aW5nIHYxIGFsaWFzZXMgdG8gdjIgcHJvZmlsZXMuLi4nKTtcblxuICAgIC8vIEdyb3VwIGFsaWFzZXMgYnkgY2F0ZWdvcnkvcGVyc29uIHRvIGNyZWF0ZSBwcm9maWxlc1xuICAgIGNvbnN0IHByb2ZpbGVNYXAgPSBuZXcgTWFwPHN0cmluZywgQWxpYXNFbnRyeVtdPigpO1xuXG4gICAgLy8gR3JvdXAgYWxpYXNlcyBieSBjYXRlZ29yeSBvciBjcmVhdGUgaW5kaXZpZHVhbCBwcm9maWxlc1xuICAgIHYxQWxpYXNlcy5mb3JFYWNoKGFsaWFzID0+IHtcbiAgICAgIGNvbnN0IGtleSA9IGFsaWFzLmNhdGVnb3J5IHx8IGBwcm9maWxlLSR7YWxpYXMuaWR9YDtcbiAgICAgIGlmICghcHJvZmlsZU1hcC5oYXMoa2V5KSkge1xuICAgICAgICBwcm9maWxlTWFwLnNldChrZXksIFtdKTtcbiAgICAgIH1cbiAgICAgIHByb2ZpbGVNYXAuZ2V0KGtleSkhLnB1c2goYWxpYXMpO1xuICAgIH0pO1xuXG4gICAgLy8gQ29udmVydCBncm91cHMgdG8gcHJvZmlsZXNcbiAgICBjb25zdCBuZXdQcm9maWxlczogQWxpYXNQcm9maWxlW10gPSBbXTtcblxuICAgIHByb2ZpbGVNYXAuZm9yRWFjaCgoYWxpYXNlcywgY2F0ZWdvcnlOYW1lKSA9PiB7XG4gICAgICBjb25zdCByZWFsOiBJZGVudGl0eURhdGEgPSB7fTtcbiAgICAgIGNvbnN0IGFsaWFzRGF0YTogSWRlbnRpdHlEYXRhID0ge307XG5cbiAgICAgIC8vIEJ1aWxkIHJlYWwgYW5kIGFsaWFzIGlkZW50aXR5IGZyb20gZ3JvdXBlZCBhbGlhc2VzXG4gICAgICBhbGlhc2VzLmZvckVhY2goYWxpYXMgPT4ge1xuICAgICAgICBzd2l0Y2ggKGFsaWFzLnR5cGUpIHtcbiAgICAgICAgICBjYXNlICduYW1lJzpcbiAgICAgICAgICAgIHJlYWwubmFtZSA9IGFsaWFzLnJlYWxWYWx1ZTtcbiAgICAgICAgICAgIGFsaWFzRGF0YS5uYW1lID0gYWxpYXMuYWxpYXNWYWx1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ2VtYWlsJzpcbiAgICAgICAgICAgIHJlYWwuZW1haWwgPSBhbGlhcy5yZWFsVmFsdWU7XG4gICAgICAgICAgICBhbGlhc0RhdGEuZW1haWwgPSBhbGlhcy5hbGlhc1ZhbHVlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAncGhvbmUnOlxuICAgICAgICAgICAgcmVhbC5waG9uZSA9IGFsaWFzLnJlYWxWYWx1ZTtcbiAgICAgICAgICAgIGFsaWFzRGF0YS5waG9uZSA9IGFsaWFzLmFsaWFzVmFsdWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdhZGRyZXNzJzpcbiAgICAgICAgICAgIHJlYWwuYWRkcmVzcyA9IGFsaWFzLnJlYWxWYWx1ZTtcbiAgICAgICAgICAgIGFsaWFzRGF0YS5hZGRyZXNzID0gYWxpYXMuYWxpYXNWYWx1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gR2V0IGhpZ2hlc3QgdXNhZ2Ugc3RhdHMgZnJvbSBhbGlhc2VzXG4gICAgICBjb25zdCB0b3RhbFVzYWdlID0gYWxpYXNlcy5yZWR1Y2UoKHN1bSwgYSkgPT4gc3VtICsgYS5tZXRhZGF0YS51c2FnZUNvdW50LCAwKTtcbiAgICAgIGNvbnN0IGxhc3RVc2VkID0gTWF0aC5tYXgoLi4uYWxpYXNlcy5tYXAoYSA9PiBhLm1ldGFkYXRhLmxhc3RVc2VkKSk7XG4gICAgICBjb25zdCBjcmVhdGVkQXQgPSBNYXRoLm1pbiguLi5hbGlhc2VzLm1hcChhID0+IGEubWV0YWRhdGEuY3JlYXRlZEF0KSk7XG5cbiAgICAgIGNvbnN0IHByb2ZpbGU6IEFsaWFzUHJvZmlsZSA9IHtcbiAgICAgICAgaWQ6IGdlbmVyYXRlSWQoKSxcbiAgICAgICAgcHJvZmlsZU5hbWU6IGNhdGVnb3J5TmFtZSA9PT0gYHByb2ZpbGUtJHthbGlhc2VzWzBdLmlkfWBcbiAgICAgICAgICA/IGBQcm9maWxlIC0gJHtyZWFsLm5hbWUgfHwgcmVhbC5lbWFpbCB8fCAnVW5rbm93bid9YFxuICAgICAgICAgIDogY2F0ZWdvcnlOYW1lLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ01pZ3JhdGVkIGZyb20gdjEnLFxuICAgICAgICBlbmFibGVkOiBhbGlhc2VzWzBdLmVuYWJsZWQsXG4gICAgICAgIHJlYWwsXG4gICAgICAgIGFsaWFzOiBhbGlhc0RhdGEsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgY3JlYXRlZEF0LFxuICAgICAgICAgIHVwZGF0ZWRBdDogRGF0ZS5ub3coKSxcbiAgICAgICAgICB1c2FnZVN0YXRzOiB7XG4gICAgICAgICAgICB0b3RhbFN1YnN0aXR1dGlvbnM6IHRvdGFsVXNhZ2UsXG4gICAgICAgICAgICBsYXN0VXNlZCxcbiAgICAgICAgICAgIGJ5U2VydmljZTogeyBjaGF0Z3B0OiAwLCBjbGF1ZGU6IDAsIGdlbWluaTogMCwgcGVycGxleGl0eTogMCwgY29waWxvdDogMCB9LFxuICAgICAgICAgICAgYnlQSUlUeXBlOiB7IG5hbWU6IDAsIGVtYWlsOiAwLCBwaG9uZTogMCwgY2VsbFBob25lOiAwLCBhZGRyZXNzOiAwLCBjb21wYW55OiAwLCBjdXN0b206IDAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNvbmZpZGVuY2U6IGFsaWFzZXNbMF0ubWV0YWRhdGEuY29uZmlkZW5jZSxcbiAgICAgICAgfSxcbiAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICBhdXRvUmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgICBoaWdobGlnaHRJblVJOiB0cnVlLFxuICAgICAgICAgIGFjdGl2ZVNlcnZpY2VzOiBbJ2NoYXRncHQnLCAnY2xhdWRlJywgJ2dlbWluaSddLFxuICAgICAgICAgIGVuYWJsZVZhcmlhdGlvbnM6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICBuZXdQcm9maWxlcy5wdXNoKHByb2ZpbGUpO1xuICAgIH0pO1xuXG4gICAgLy8gU2F2ZSBtaWdyYXRlZCBwcm9maWxlc1xuICAgIGF3YWl0IHRoaXMucHJvZmlsZU1hbmFnZXIuc2F2ZVByb2ZpbGVzKG5ld1Byb2ZpbGVzKTtcblxuICAgIC8vIFVwZGF0ZSBjb25maWcgdG8gdjJcbiAgICBjb25zdCBvbGRDb25maWcgPSBhd2FpdCB0aGlzLmNvbmZpZ01hbmFnZXIubG9hZENvbmZpZygpIGFzIFVzZXJDb25maWdWMSB8IG51bGw7XG4gICAgaWYgKG9sZENvbmZpZykge1xuICAgICAgY29uc3QgbmV3Q29uZmlnOiBVc2VyQ29uZmlnID0ge1xuICAgICAgICB2ZXJzaW9uOiAyLFxuICAgICAgICBhY2NvdW50OiB7XG4gICAgICAgICAgZW1haWxPcHRJbjogZmFsc2UsXG4gICAgICAgICAgdGllcjogJ2ZyZWUnLFxuICAgICAgICAgIHN5bmNFbmFibGVkOiBmYWxzZSxcbiAgICAgICAgfSxcbiAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICBlbmFibGVkOiBvbGRDb25maWcuc2V0dGluZ3MuZW5hYmxlZCxcbiAgICAgICAgICBkZWZhdWx0TW9kZTogJ2F1dG8tcmVwbGFjZScsXG4gICAgICAgICAgc2hvd05vdGlmaWNhdGlvbnM6IG9sZENvbmZpZy5zZXR0aW5ncy5zaG93Tm90aWZpY2F0aW9ucyxcbiAgICAgICAgICBkZWNvZGVSZXNwb25zZXM6IGZhbHNlLCAgICAgICAgLy8gRGVmYXVsdCB0byBmYWxzZSBmb3IgbWlncmF0ZWQgY29uZmlnc1xuICAgICAgICAgIHRoZW1lOiAnY2xhc3NpYy1kYXJrJywgICAgICAgICAvLyBEZWZhdWx0IHRoZW1lIGZvciBtaWdyYXRlZCBjb25maWdzXG4gICAgICAgICAgcHJvdGVjdGVkRG9tYWluczogb2xkQ29uZmlnLnNldHRpbmdzLnByb3RlY3RlZERvbWFpbnMsXG4gICAgICAgICAgZXhjbHVkZWREb21haW5zOiBvbGRDb25maWcuc2V0dGluZ3MuZXhjbHVkZWREb21haW5zLFxuICAgICAgICAgIHN0cmljdE1vZGU6IG9sZENvbmZpZy5zZXR0aW5ncy5zdHJpY3RNb2RlLFxuICAgICAgICAgIGRlYnVnTW9kZTogZmFsc2UsXG4gICAgICAgICAgY2xvdWRTeW5jOiBmYWxzZSxcbiAgICAgICAgfSxcbiAgICAgICAgcHJvZmlsZXM6IG5ld1Byb2ZpbGVzLFxuICAgICAgICBzdGF0czoge1xuICAgICAgICAgIHRvdGFsU3Vic3RpdHV0aW9uczogb2xkQ29uZmlnLnN0YXRzLnRvdGFsU3Vic3RpdHV0aW9ucyxcbiAgICAgICAgICB0b3RhbEludGVyY2VwdGlvbnM6IDAsXG4gICAgICAgICAgdG90YWxXYXJuaW5nczogMCxcbiAgICAgICAgICBzdWNjZXNzUmF0ZTogb2xkQ29uZmlnLnN0YXRzLnN1Y2Nlc3NSYXRlLFxuICAgICAgICAgIGxhc3RTeW5jVGltZXN0YW1wOiBvbGRDb25maWcuc3RhdHMubGFzdFN5bmNUaW1lc3RhbXAsXG4gICAgICAgICAgYnlTZXJ2aWNlOiB7XG4gICAgICAgICAgICBjaGF0Z3B0OiB7IHJlcXVlc3RzOiAwLCBzdWJzdGl0dXRpb25zOiAwIH0sXG4gICAgICAgICAgICBjbGF1ZGU6IHsgcmVxdWVzdHM6IDAsIHN1YnN0aXR1dGlvbnM6IDAgfSxcbiAgICAgICAgICAgIGdlbWluaTogeyByZXF1ZXN0czogMCwgc3Vic3RpdHV0aW9uczogMCB9LFxuICAgICAgICAgICAgcGVycGxleGl0eTogeyByZXF1ZXN0czogMCwgc3Vic3RpdHV0aW9uczogMCB9LFxuICAgICAgICAgICAgY29waWxvdDogeyByZXF1ZXN0czogMCwgc3Vic3RpdHV0aW9uczogMCB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgYWN0aXZpdHlMb2c6IFtdLFxuICAgICAgICB9LFxuICAgICAgfTtcblxuICAgICAgYXdhaXQgdGhpcy5jb25maWdNYW5hZ2VyLnNhdmVDb25maWcobmV3Q29uZmlnKTtcbiAgICB9XG5cbiAgICAvLyBNYXJrIGFzIHYyXG4gICAgYXdhaXQgY2hyb21lLnN0b3JhZ2UubG9jYWwuc2V0KHsgW1N0b3JhZ2VNaWdyYXRpb25NYW5hZ2VyLktFWVMuVkVSU0lPTl06IDIgfSk7XG5cbiAgICBjb25zb2xlLmxvZyhgW1N0b3JhZ2VNaWdyYXRpb25NYW5hZ2VyXSBNaWdyYXRpb24gY29tcGxldGUhIENyZWF0ZWQgJHtuZXdQcm9maWxlcy5sZW5ndGh9IHByb2ZpbGVzIGZyb20gJHt2MUFsaWFzZXMubGVuZ3RofSBhbGlhc2VzYCk7XG4gIH1cblxuICAvKipcbiAgICogTWlncmF0ZSBhbGwgcGxhaW50ZXh0IHNlbnNpdGl2ZSBkYXRhIHRvIGVuY3J5cHRlZCBzdG9yYWdlXG4gICAqIFRoaXMgcnVucyBhdXRvbWF0aWNhbGx5IG9uIGluaXRpYWxpemF0aW9uIGFuZCBoYW5kbGVzOlxuICAgKiAtIEFQSSBrZXlzXG4gICAqIC0gQ3VzdG9tIHJ1bGVzXG4gICAqIC0gQWN0aXZpdHkgbG9nc1xuICAgKiAtIEFjY291bnQgZGF0YVxuICAgKi9cbiAgYXN5bmMgbWlncmF0ZUFQSUtleXNUb0VuY3J5cHRlZElmTmVlZGVkKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5nZXQoU3RvcmFnZU1pZ3JhdGlvbk1hbmFnZXIuS0VZUy5DT05GSUcpO1xuICAgIGNvbnN0IGNvbmZpZyA9IGRhdGFbU3RvcmFnZU1pZ3JhdGlvbk1hbmFnZXIuS0VZUy5DT05GSUddO1xuXG4gICAgaWYgKCFjb25maWcpIHtcbiAgICAgIHJldHVybjsgLy8gTm8gY29uZmlnIHRvIG1pZ3JhdGVcbiAgICB9XG5cbiAgICBjb25zdCBjb25maWdXaXRoRW5jcnlwdGVkID0gY29uZmlnIGFzIGFueTtcbiAgICBsZXQgbmVlZHNTYXZlID0gZmFsc2U7XG5cbiAgICAvLyAxLiBNaWdyYXRlIEFQSSBrZXlzXG4gICAgY29uc3QgaGFzUGxhaW50ZXh0S2V5cyA9IGNvbmZpZy5hcGlLZXlWYXVsdCAmJiBjb25maWcuYXBpS2V5VmF1bHQua2V5cy5sZW5ndGggPiAwO1xuICAgIGNvbnN0IGhhc0VuY3J5cHRlZFZhdWx0ID0gISFjb25maWdXaXRoRW5jcnlwdGVkLl9lbmNyeXB0ZWRBcGlLZXlWYXVsdDtcblxuICAgIGlmIChoYXNQbGFpbnRleHRLZXlzICYmICFoYXNFbmNyeXB0ZWRWYXVsdCkge1xuICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlTWlncmF0aW9uTWFuYWdlcl0g8J+UkCBNaWdyYXRpbmcgcGxhaW50ZXh0IEFQSSBrZXlzIHRvIGVuY3J5cHRlZCBzdG9yYWdlLi4uJyk7XG4gICAgICBjb25zb2xlLmxvZyhgW1N0b3JhZ2VNaWdyYXRpb25NYW5hZ2VyXSBGb3VuZCAke2NvbmZpZy5hcGlLZXlWYXVsdC5rZXlzLmxlbmd0aH0gcGxhaW50ZXh0IEFQSSBrZXlzYCk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGVuY3J5cHRlZFZhdWx0ID0gYXdhaXQgdGhpcy5lbmNyeXB0aW9uTWFuYWdlci5lbmNyeXB0QVBJS2V5VmF1bHQoY29uZmlnLmFwaUtleVZhdWx0KTtcbiAgICAgICAgY29uZmlnV2l0aEVuY3J5cHRlZC5fZW5jcnlwdGVkQXBpS2V5VmF1bHQgPSBlbmNyeXB0ZWRWYXVsdDtcbiAgICAgICAgY29uZmlnLmFwaUtleVZhdWx0ID0ge1xuICAgICAgICAgIC4uLmNvbmZpZy5hcGlLZXlWYXVsdCxcbiAgICAgICAgICBrZXlzOiBbXSwgLy8gQ2xlYXIgcGxhaW50ZXh0IGtleXNcbiAgICAgICAgfTtcbiAgICAgICAgbmVlZHNTYXZlID0gdHJ1ZTtcbiAgICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlTWlncmF0aW9uTWFuYWdlcl0g4pyFIEFQSSBrZXkgbWlncmF0aW9uIGNvbXBsZXRlIC0ga2V5cyBhcmUgbm93IGVuY3J5cHRlZCcpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignW1N0b3JhZ2VNaWdyYXRpb25NYW5hZ2VyXSDinYwgRmFpbGVkIHRvIG1pZ3JhdGUgQVBJIGtleXM6JywgZXJyb3IpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIDIuIE1pZ3JhdGUgY3VzdG9tIHJ1bGVzXG4gICAgY29uc3QgaGFzUGxhaW50ZXh0UnVsZXMgPSBjb25maWcuY3VzdG9tUnVsZXMgJiYgY29uZmlnLmN1c3RvbVJ1bGVzLnJ1bGVzLmxlbmd0aCA+IDA7XG4gICAgY29uc3QgaGFzRW5jcnlwdGVkUnVsZXMgPSAhIWNvbmZpZ1dpdGhFbmNyeXB0ZWQuX2VuY3J5cHRlZEN1c3RvbVJ1bGVzO1xuXG4gICAgaWYgKGhhc1BsYWludGV4dFJ1bGVzICYmICFoYXNFbmNyeXB0ZWRSdWxlcykge1xuICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlTWlncmF0aW9uTWFuYWdlcl0g8J+UkCBNaWdyYXRpbmcgcGxhaW50ZXh0IGN1c3RvbSBydWxlcyB0byBlbmNyeXB0ZWQgc3RvcmFnZS4uLicpO1xuICAgICAgY29uc29sZS5sb2coYFtTdG9yYWdlTWlncmF0aW9uTWFuYWdlcl0gRm91bmQgJHtjb25maWcuY3VzdG9tUnVsZXMucnVsZXMubGVuZ3RofSBwbGFpbnRleHQgY3VzdG9tIHJ1bGVzYCk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGVuY3J5cHRlZFJ1bGVzID0gYXdhaXQgdGhpcy5lbmNyeXB0aW9uTWFuYWdlci5lbmNyeXB0Q3VzdG9tUnVsZXMoY29uZmlnLmN1c3RvbVJ1bGVzKTtcbiAgICAgICAgY29uZmlnV2l0aEVuY3J5cHRlZC5fZW5jcnlwdGVkQ3VzdG9tUnVsZXMgPSBlbmNyeXB0ZWRSdWxlcztcbiAgICAgICAgY29uZmlnLmN1c3RvbVJ1bGVzID0ge1xuICAgICAgICAgIC4uLmNvbmZpZy5jdXN0b21SdWxlcyxcbiAgICAgICAgICBydWxlczogW10sIC8vIENsZWFyIHBsYWludGV4dCBydWxlc1xuICAgICAgICB9O1xuICAgICAgICBuZWVkc1NhdmUgPSB0cnVlO1xuICAgICAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VNaWdyYXRpb25NYW5hZ2VyXSDinIUgQ3VzdG9tIHJ1bGVzIG1pZ3JhdGlvbiBjb21wbGV0ZSAtIHJ1bGVzIGFyZSBub3cgZW5jcnlwdGVkJyk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbU3RvcmFnZU1pZ3JhdGlvbk1hbmFnZXJdIOKdjCBGYWlsZWQgdG8gbWlncmF0ZSBjdXN0b20gcnVsZXM6JywgZXJyb3IpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIDMuIE1pZ3JhdGUgYWN0aXZpdHkgbG9nc1xuICAgIGNvbnN0IGhhc1BsYWludGV4dExvZ3MgPSBjb25maWcuc3RhdHMgJiYgY29uZmlnLnN0YXRzLmFjdGl2aXR5TG9nICYmIGNvbmZpZy5zdGF0cy5hY3Rpdml0eUxvZy5sZW5ndGggPiAwO1xuICAgIGNvbnN0IGhhc0VuY3J5cHRlZExvZ3MgPSAhIWNvbmZpZ1dpdGhFbmNyeXB0ZWQuX2VuY3J5cHRlZEFjdGl2aXR5TG9ncztcblxuICAgIGlmIChoYXNQbGFpbnRleHRMb2dzICYmICFoYXNFbmNyeXB0ZWRMb2dzKSB7XG4gICAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VNaWdyYXRpb25NYW5hZ2VyXSDwn5SQIE1pZ3JhdGluZyBwbGFpbnRleHQgYWN0aXZpdHkgbG9ncyB0byBlbmNyeXB0ZWQgc3RvcmFnZS4uLicpO1xuICAgICAgY29uc29sZS5sb2coYFtTdG9yYWdlTWlncmF0aW9uTWFuYWdlcl0gRm91bmQgJHtjb25maWcuc3RhdHMhLmFjdGl2aXR5TG9nIS5sZW5ndGh9IHBsYWludGV4dCBhY3Rpdml0eSBsb2cgZW50cmllc2ApO1xuXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBlbmNyeXB0ZWRMb2dzID0gYXdhaXQgdGhpcy5lbmNyeXB0aW9uTWFuYWdlci5lbmNyeXB0QWN0aXZpdHlMb2dzKGNvbmZpZy5zdGF0cy5hY3Rpdml0eUxvZyk7XG4gICAgICAgIGNvbmZpZ1dpdGhFbmNyeXB0ZWQuX2VuY3J5cHRlZEFjdGl2aXR5TG9ncyA9IGVuY3J5cHRlZExvZ3M7XG4gICAgICAgIGNvbmZpZy5zdGF0cyA9IHtcbiAgICAgICAgICAuLi5jb25maWcuc3RhdHMsXG4gICAgICAgICAgYWN0aXZpdHlMb2c6IFtdLCAvLyBDbGVhciBwbGFpbnRleHQgbG9nc1xuICAgICAgICB9O1xuICAgICAgICBuZWVkc1NhdmUgPSB0cnVlO1xuICAgICAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VNaWdyYXRpb25NYW5hZ2VyXSDinIUgQWN0aXZpdHkgbG9ncyBtaWdyYXRpb24gY29tcGxldGUgLSBsb2dzIGFyZSBub3cgZW5jcnlwdGVkJyk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbU3RvcmFnZU1pZ3JhdGlvbk1hbmFnZXJdIOKdjCBGYWlsZWQgdG8gbWlncmF0ZSBhY3Rpdml0eSBsb2dzOicsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyA0LiBNaWdyYXRlIGFjY291bnQgZGF0YVxuICAgIGNvbnN0IGhhc1BsYWludGV4dEFjY291bnQgPSBjb25maWcuYWNjb3VudCAmJiAoY29uZmlnLmFjY291bnQuZW1haWwgfHwgY29uZmlnLmFjY291bnQuZGlzcGxheU5hbWUpO1xuICAgIGNvbnN0IGhhc0VuY3J5cHRlZEFjY291bnQgPSAhIWNvbmZpZ1dpdGhFbmNyeXB0ZWQuX2VuY3J5cHRlZEFjY291bnREYXRhO1xuXG4gICAgaWYgKGhhc1BsYWludGV4dEFjY291bnQgJiYgIWhhc0VuY3J5cHRlZEFjY291bnQpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZU1pZ3JhdGlvbk1hbmFnZXJdIPCflJAgTWlncmF0aW5nIHBsYWludGV4dCBhY2NvdW50IGRhdGEgdG8gZW5jcnlwdGVkIHN0b3JhZ2UuLi4nKTtcbiAgICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZU1pZ3JhdGlvbk1hbmFnZXJdIEZvdW5kIHBsYWludGV4dCBhY2NvdW50IGRhdGEgKGVtYWlsLCBkaXNwbGF5TmFtZSwgZXRjLiknKTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgYWNjb3VudFRvRW5jcnlwdCA9IHtcbiAgICAgICAgICBlbWFpbDogY29uZmlnLmFjY291bnQuZW1haWwsXG4gICAgICAgICAgZGlzcGxheU5hbWU6IGNvbmZpZy5hY2NvdW50LmRpc3BsYXlOYW1lLFxuICAgICAgICAgIHBob3RvVVJMOiBjb25maWcuYWNjb3VudC5waG90b1VSTCxcbiAgICAgICAgICBmaXJlYmFzZVVpZDogY29uZmlnLmFjY291bnQuZmlyZWJhc2VVaWQsXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGVuY3J5cHRlZEFjY291bnQgPSBhd2FpdCB0aGlzLmVuY3J5cHRpb25NYW5hZ2VyLmVuY3J5cHRBY2NvdW50RGF0YShhY2NvdW50VG9FbmNyeXB0KTtcbiAgICAgICAgY29uZmlnV2l0aEVuY3J5cHRlZC5fZW5jcnlwdGVkQWNjb3VudERhdGEgPSBlbmNyeXB0ZWRBY2NvdW50O1xuICAgICAgICBjb25maWcuYWNjb3VudCA9IHtcbiAgICAgICAgICAuLi5jb25maWcuYWNjb3VudCxcbiAgICAgICAgICBlbWFpbDogdW5kZWZpbmVkLFxuICAgICAgICAgIGRpc3BsYXlOYW1lOiB1bmRlZmluZWQsXG4gICAgICAgICAgcGhvdG9VUkw6IHVuZGVmaW5lZCxcbiAgICAgICAgICBmaXJlYmFzZVVpZDogdW5kZWZpbmVkLFxuICAgICAgICB9O1xuICAgICAgICBuZWVkc1NhdmUgPSB0cnVlO1xuICAgICAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VNaWdyYXRpb25NYW5hZ2VyXSDinIUgQWNjb3VudCBkYXRhIG1pZ3JhdGlvbiBjb21wbGV0ZSAtIGFjY291bnQgZGF0YSBpcyBub3cgZW5jcnlwdGVkJyk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbU3RvcmFnZU1pZ3JhdGlvbk1hbmFnZXJdIOKdjCBGYWlsZWQgdG8gbWlncmF0ZSBhY2NvdW50IGRhdGE6JywgZXJyb3IpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFNhdmUgdXBkYXRlZCBjb25maWcgaWYgYW55IG1pZ3JhdGlvbnMgb2NjdXJyZWRcbiAgICBpZiAobmVlZHNTYXZlKSB7XG4gICAgICBhd2FpdCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoe1xuICAgICAgICBbU3RvcmFnZU1pZ3JhdGlvbk1hbmFnZXIuS0VZUy5DT05GSUddOiBjb25maWcsXG4gICAgICB9KTtcbiAgICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZU1pZ3JhdGlvbk1hbmFnZXJdIPCfjokgQWxsIHNlbnNpdGl2ZSBkYXRhIG1pZ3JhdGlvbiBjb21wbGV0ZSAtIGFsbCBkYXRhIGlzIG5vdyBlbmNyeXB0ZWQnKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTG9hZCBhbmQgZGVjcnlwdCBhbGlhc2VzIChsZWdhY3kgdjEgZGF0YSkgLSB1c2VkIGZvciBtaWdyYXRpb25cbiAgICogU3VwcG9ydHMgYXV0b21hdGljIG1pZ3JhdGlvbiBmcm9tIGxlZ2FjeSBlbmNyeXB0aW9uIHRvIEZpcmViYXNlIFVJRFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBsb2FkQWxpYXNlc0Zvck1pZ3JhdGlvbigpOiBQcm9taXNlPEFsaWFzRW50cnlbXT4ge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5nZXQoU3RvcmFnZU1pZ3JhdGlvbk1hbmFnZXIuS0VZUy5BTElBU0VTKTtcbiAgICBpZiAoIWRhdGFbU3RvcmFnZU1pZ3JhdGlvbk1hbmFnZXIuS0VZUy5BTElBU0VTXSkge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIGNvbnN0IGVuY3J5cHRlZERhdGEgPSBkYXRhW1N0b3JhZ2VNaWdyYXRpb25NYW5hZ2VyLktFWVMuQUxJQVNFU107XG5cbiAgICB0cnkge1xuICAgICAgLy8gVHJ5IEZpcmViYXNlIFVJRCBrZXkgZmlyc3QgKG5ldyBtZXRob2QpXG4gICAgICBjb25zdCBkZWNyeXB0ZWQgPSBhd2FpdCB0aGlzLmVuY3J5cHRpb25NYW5hZ2VyLmRlY3J5cHQoZW5jcnlwdGVkRGF0YSk7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShkZWNyeXB0ZWQpO1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIENoZWNrIGlmIGxlZ2FjeSBrZXkgbWF0ZXJpYWwgZXhpc3RzXG4gICAgICBjb25zdCBsZWdhY3lLZXlEYXRhID0gYXdhaXQgY2hyb21lLnN0b3JhZ2UubG9jYWwuZ2V0KCdfZW5jcnlwdGlvbktleU1hdGVyaWFsJyk7XG4gICAgICBjb25zdCBoYXNMZWdhY3lLZXkgPSAhIWxlZ2FjeUtleURhdGFbJ19lbmNyeXB0aW9uS2V5TWF0ZXJpYWwnXTtcblxuICAgICAgaWYgKCFoYXNMZWdhY3lLZXkpIHtcbiAgICAgICAgLy8gTm8gbGVnYWN5IGtleSA9IGFscmVhZHkgbWlncmF0ZWRcbiAgICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlTWlncmF0aW9uTWFuYWdlcl0gQWxpYXNlcyBhbHJlYWR5IG1pZ3JhdGVkIHRvIEZpcmViYXNlIFVJRCcpO1xuXG4gICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0VOQ1JZUFRJT05fS0VZX1VOQVZBSUxBQkxFJykpIHtcbiAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBbXTsgLy8gUmV0dXJuIGVtcHR5IGlmIGNhbid0IGRlY3J5cHRcbiAgICAgIH1cblxuICAgICAgY29uc29sZS53YXJuKCdbU3RvcmFnZU1pZ3JhdGlvbk1hbmFnZXJdIEFsaWFzZXM6IEZpcmViYXNlIFVJRCBkZWNyeXB0aW9uIGZhaWxlZCwgYXR0ZW1wdGluZyBsZWdhY3kgbWlncmF0aW9uLi4uJyk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIEZhbGwgYmFjayB0byBsZWdhY3kga2V5XG4gICAgICAgIGNvbnN0IGxlZ2FjeUtleSA9IGF3YWl0IHRoaXMuZW5jcnlwdGlvbk1hbmFnZXIuZ2V0TGVnYWN5RW5jcnlwdGlvbktleSgpO1xuICAgICAgICBjb25zdCBkZWNyeXB0ZWQgPSBhd2FpdCB0aGlzLmVuY3J5cHRpb25NYW5hZ2VyLmRlY3J5cHRXaXRoS2V5KGVuY3J5cHRlZERhdGEsIGxlZ2FjeUtleSk7XG4gICAgICAgIGNvbnN0IGFsaWFzZXMgPSBKU09OLnBhcnNlKGRlY3J5cHRlZCk7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlTWlncmF0aW9uTWFuYWdlcl0g4pyFIExlZ2FjeSBhbGlhc2VzIGRlY3J5cHRlZCcpO1xuXG4gICAgICAgIC8vIENoZWNrIGlmIHdlJ3JlIGluIHNlcnZpY2Ugd29ya2VyIGNvbnRleHRcbiAgICAgICAgY29uc3QgaXNTZXJ2aWNlV29ya2VyID0gdHlwZW9mIGRvY3VtZW50ID09PSAndW5kZWZpbmVkJztcblxuICAgICAgICBpZiAoaXNTZXJ2aWNlV29ya2VyKSB7XG4gICAgICAgICAgLy8gSW4gc2VydmljZSB3b3JrZXIsIGNhbid0IHJlLWVuY3J5cHQgKG5vIEZpcmViYXNlIGF1dGgpXG4gICAgICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlTWlncmF0aW9uTWFuYWdlcl0g4o+t77iPIFJ1bm5pbmcgaW4gc2VydmljZSB3b3JrZXIgLSBza2lwcGluZyBhbGlhc2VzIG1pZ3JhdGlvbicpO1xuICAgICAgICAgIHJldHVybiBhbGlhc2VzO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSW4gcG9wdXAvY29udGVudCBjb250ZXh0IC0gcHJvY2VlZCB3aXRoIG1pZ3JhdGlvblxuICAgICAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VNaWdyYXRpb25NYW5hZ2VyXSDwn5SEIE1pZ3JhdGluZyBhbGlhc2VzIHRvIEZpcmViYXNlIFVJRC4uLicpO1xuXG4gICAgICAgIC8vIFJlLWVuY3J5cHQgd2l0aCBGaXJlYmFzZSBVSURcbiAgICAgICAgY29uc3QgZW5jcnlwdGVkID0gYXdhaXQgdGhpcy5lbmNyeXB0aW9uTWFuYWdlci5lbmNyeXB0KEpTT04uc3RyaW5naWZ5KGFsaWFzZXMpKTtcbiAgICAgICAgYXdhaXQgY2hyb21lLnN0b3JhZ2UubG9jYWwuc2V0KHtcbiAgICAgICAgICBbU3RvcmFnZU1pZ3JhdGlvbk1hbmFnZXIuS0VZUy5BTElBU0VTXTogZW5jcnlwdGVkLFxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gYWxpYXNlcztcblxuICAgICAgfSBjYXRjaCAobGVnYWN5RXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignW1N0b3JhZ2VNaWdyYXRpb25NYW5hZ2VyXSBGYWlsZWQgdG8gZGVjcnlwdCBhbGlhc2VzOicsIGxlZ2FjeUVycm9yKTtcblxuICAgICAgICAvLyBSZS10aHJvdyBhdXRoIGVycm9ycyBmb3IgVUkgaGFuZGxpbmdcbiAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnRU5DUllQVElPTl9LRVlfVU5BVkFJTEFCTEUnKSkge1xuICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIiwiLyoqXG4gKiBTdG9yYWdlIE1hbmFnZXIgZm9yIHBlcnNpc3RpbmcgYWxpYXNlcyBhbmQgY29uZmlndXJhdGlvblxuICogVXNlcyBDaHJvbWUgU3RvcmFnZSBBUEkgd2l0aCBlbmNyeXB0aW9uIGZvciBzZW5zaXRpdmUgZGF0YVxuICogVmVyc2lvbiAyLjAgLSBQcm9maWxlLWJhc2VkIGFyY2hpdGVjdHVyZSB3aXRoIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcbiAqIFZlcnNpb24gMi4xIC0gQWRkZWQgYWxpYXMgdmFyaWF0aW9ucyBzdXBwb3J0XG4gKiBWZXJzaW9uIDMuMCAtIFJlZmFjdG9yZWQgdG8gbW9kdWxhciBhcmNoaXRlY3R1cmUgd2l0aCBzdWItbWFuYWdlcnNcbiAqL1xuXG5pbXBvcnQge1xuICBBbGlhc0VudHJ5LFxuICBBbGlhc1Byb2ZpbGUsXG4gIFVzZXJDb25maWcsXG4gIElkZW50aXR5RGF0YSxcbiAgUHJvbXB0VGVtcGxhdGUsXG4gIERvY3VtZW50QWxpYXMsXG4gIEFQSUtleSxcbiAgQVBJS2V5VmF1bHRDb25maWcsXG4gIEN1c3RvbVJ1bGVzQ29uZmlnLFxuICBQcm9tcHRUZW1wbGF0ZXNDb25maWcsXG59IGZyb20gJy4vdHlwZXMnO1xuXG4vLyBJbXBvcnQgYWxsIHN1Yi1tYW5hZ2Vyc1xuaW1wb3J0IHsgU3RvcmFnZUVuY3J5cHRpb25NYW5hZ2VyIH0gZnJvbSAnLi9zdG9yYWdlL1N0b3JhZ2VFbmNyeXB0aW9uTWFuYWdlcic7XG5pbXBvcnQgeyBTdG9yYWdlQ29uZmlnTWFuYWdlciB9IGZyb20gJy4vc3RvcmFnZS9TdG9yYWdlQ29uZmlnTWFuYWdlcic7XG5pbXBvcnQgeyBTdG9yYWdlUHJvZmlsZU1hbmFnZXIgfSBmcm9tICcuL3N0b3JhZ2UvU3RvcmFnZVByb2ZpbGVNYW5hZ2VyJztcbmltcG9ydCB7IFN0b3JhZ2VBUElLZXlWYXVsdE1hbmFnZXIgfSBmcm9tICcuL3N0b3JhZ2UvU3RvcmFnZUFQSUtleVZhdWx0TWFuYWdlcic7XG5pbXBvcnQgeyBTdG9yYWdlQ3VzdG9tUnVsZXNNYW5hZ2VyIH0gZnJvbSAnLi9zdG9yYWdlL1N0b3JhZ2VDdXN0b21SdWxlc01hbmFnZXInO1xuaW1wb3J0IHsgU3RvcmFnZVByb21wdFRlbXBsYXRlc01hbmFnZXIgfSBmcm9tICcuL3N0b3JhZ2UvU3RvcmFnZVByb21wdFRlbXBsYXRlc01hbmFnZXInO1xuaW1wb3J0IHsgU3RvcmFnZURvY3VtZW50QWxpYXNNYW5hZ2VyIH0gZnJvbSAnLi9zdG9yYWdlL1N0b3JhZ2VEb2N1bWVudEFsaWFzTWFuYWdlcic7XG5pbXBvcnQgeyBTdG9yYWdlTWlncmF0aW9uTWFuYWdlciB9IGZyb20gJy4vc3RvcmFnZS9TdG9yYWdlTWlncmF0aW9uTWFuYWdlcic7XG5pbXBvcnQgeyBnZW5lcmF0ZUlkLCBnZXRTdG9yYWdlUXVvdGEgfSBmcm9tICcuL3N0b3JhZ2Uvc3RvcmFnZS11dGlscyc7XG5cbmV4cG9ydCBjbGFzcyBTdG9yYWdlTWFuYWdlciB7XG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBTdG9yYWdlTWFuYWdlcjtcbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgS0VZUyA9IHtcbiAgICBBTElBU0VTOiAnYWxpYXNlcycsICAgICAgICAvLyB2MSBsZWdhY3lcbiAgICBQUk9GSUxFUzogJ3Byb2ZpbGVzJywgICAgICAgLy8gdjIgbmV3XG4gICAgQ09ORklHOiAnY29uZmlnJyxcbiAgICBTVEFUUzogJ3N0YXRzJyxcbiAgICBWRVJTSU9OOiAnZGF0YVZlcnNpb24nLCAgICAgLy8gVHJhY2sgbWlncmF0aW9uIHN0YXRlXG4gIH07XG5cbiAgLy8gU3ViLW1hbmFnZXJzXG4gIHByaXZhdGUgZW5jcnlwdGlvbk1hbmFnZXI6IFN0b3JhZ2VFbmNyeXB0aW9uTWFuYWdlcjtcbiAgcHJpdmF0ZSBjb25maWdNYW5hZ2VyOiBTdG9yYWdlQ29uZmlnTWFuYWdlcjtcbiAgcHJpdmF0ZSBwcm9maWxlTWFuYWdlcjogU3RvcmFnZVByb2ZpbGVNYW5hZ2VyO1xuICBwcml2YXRlIGFwaUtleVZhdWx0TWFuYWdlcjogU3RvcmFnZUFQSUtleVZhdWx0TWFuYWdlcjtcbiAgcHJpdmF0ZSBjdXN0b21SdWxlc01hbmFnZXI6IFN0b3JhZ2VDdXN0b21SdWxlc01hbmFnZXI7XG4gIHByaXZhdGUgcHJvbXB0VGVtcGxhdGVzTWFuYWdlcjogU3RvcmFnZVByb21wdFRlbXBsYXRlc01hbmFnZXI7XG4gIHByaXZhdGUgZG9jdW1lbnRBbGlhc01hbmFnZXI6IFN0b3JhZ2VEb2N1bWVudEFsaWFzTWFuYWdlcjtcbiAgcHJpdmF0ZSBtaWdyYXRpb25NYW5hZ2VyOiBTdG9yYWdlTWlncmF0aW9uTWFuYWdlcjtcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xuICAgIC8vIEluc3RhbnRpYXRlIHN1Yi1tYW5hZ2VycyBpbiBjb3JyZWN0IGRlcGVuZGVuY3kgb3JkZXJcblxuICAgIC8vIDEuIEVuY3J5cHRpb24gbWFuYWdlciAobm8gZGVwZW5kZW5jaWVzKVxuICAgIHRoaXMuZW5jcnlwdGlvbk1hbmFnZXIgPSBuZXcgU3RvcmFnZUVuY3J5cHRpb25NYW5hZ2VyKCk7XG5cbiAgICAvLyAyLiBDb25maWcgbWFuYWdlciAoZGVwZW5kcyBvbiBlbmNyeXB0aW9uKVxuICAgIHRoaXMuY29uZmlnTWFuYWdlciA9IG5ldyBTdG9yYWdlQ29uZmlnTWFuYWdlcih0aGlzLmVuY3J5cHRpb25NYW5hZ2VyKTtcblxuICAgIC8vIDMuIFByb2ZpbGUgbWFuYWdlciAoZGVwZW5kcyBvbiBlbmNyeXB0aW9uIGFuZCBjb25maWcpXG4gICAgdGhpcy5wcm9maWxlTWFuYWdlciA9IG5ldyBTdG9yYWdlUHJvZmlsZU1hbmFnZXIoXG4gICAgICB0aGlzLmVuY3J5cHRpb25NYW5hZ2VyLFxuICAgICAgdGhpcy5jb25maWdNYW5hZ2VyXG4gICAgKTtcblxuICAgIC8vIDQuIEZlYXR1cmUgbWFuYWdlcnMgKGRlcGVuZCBvbiBjb25maWcpXG4gICAgdGhpcy5hcGlLZXlWYXVsdE1hbmFnZXIgPSBuZXcgU3RvcmFnZUFQSUtleVZhdWx0TWFuYWdlcihcbiAgICAgIHRoaXMuY29uZmlnTWFuYWdlclxuICAgICk7XG5cbiAgICB0aGlzLmN1c3RvbVJ1bGVzTWFuYWdlciA9IG5ldyBTdG9yYWdlQ3VzdG9tUnVsZXNNYW5hZ2VyKFxuICAgICAgdGhpcy5jb25maWdNYW5hZ2VyXG4gICAgKTtcblxuICAgIHRoaXMucHJvbXB0VGVtcGxhdGVzTWFuYWdlciA9IG5ldyBTdG9yYWdlUHJvbXB0VGVtcGxhdGVzTWFuYWdlcihcbiAgICAgIHRoaXMuY29uZmlnTWFuYWdlclxuICAgICk7XG5cbiAgICB0aGlzLmRvY3VtZW50QWxpYXNNYW5hZ2VyID0gbmV3IFN0b3JhZ2VEb2N1bWVudEFsaWFzTWFuYWdlcihcbiAgICAgIHRoaXMuZW5jcnlwdGlvbk1hbmFnZXJcbiAgICApO1xuXG4gICAgLy8gNS4gTWlncmF0aW9uIG1hbmFnZXIgKGRlcGVuZHMgb24gZW5jcnlwdGlvbiwgY29uZmlnLCBhbmQgcHJvZmlsZSBtYW5hZ2VycylcbiAgICB0aGlzLm1pZ3JhdGlvbk1hbmFnZXIgPSBuZXcgU3RvcmFnZU1pZ3JhdGlvbk1hbmFnZXIoXG4gICAgICB0aGlzLmVuY3J5cHRpb25NYW5hZ2VyLFxuICAgICAgdGhpcy5jb25maWdNYW5hZ2VyLFxuICAgICAgdGhpcy5wcm9maWxlTWFuYWdlclxuICAgICk7XG5cbiAgICAvLyBTZXR1cCBsaXN0ZW5lcnNcbiAgICB0aGlzLnNldHVwU3RvcmFnZUNoYW5nZUxpc3RlbmVyKCk7XG4gICAgdGhpcy5zZXR1cEF1dGhMaXN0ZW5lcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHVwIEZpcmViYXNlIGF1dGggc3RhdGUgbGlzdGVuZXIgdG8gaW52YWxpZGF0ZSBjYWNoZSB3aGVuIHVzZXIgc2lnbnMgaW4vb3V0XG4gICAqIFRoaXMgZW5zdXJlcyBmcmVzaCBkYXRhIGxvYWRpbmcgd2hlbiBhdXRoZW50aWNhdGlvbiBzdGF0ZSBjaGFuZ2VzXG4gICAqIE5PVEU6IE9ubHkgd29ya3MgaW4gcG9wdXAvY29udGVudCBjb250ZXh0cywgbm90IGluIHNlcnZpY2Ugd29ya2VyIChubyBET00pXG4gICAqL1xuICBwcml2YXRlIHNldHVwQXV0aExpc3RlbmVyKCkge1xuICAgIC8vIENoZWNrIGlmIHdlJ3JlIGluIGEgc2VydmljZSB3b3JrZXIgY29udGV4dCAobm8gZG9jdW1lbnQgb2JqZWN0KVxuICAgIGlmICh0eXBlb2YgZG9jdW1lbnQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBjb25zb2xlLmxvZygnW1N0b3JhZ2VNYW5hZ2VyXSBSdW5uaW5nIGluIHNlcnZpY2Ugd29ya2VyIGNvbnRleHQgLSBza2lwcGluZyBhdXRoIGxpc3RlbmVyIHNldHVwJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gRHluYW1pY2FsbHkgaW1wb3J0IEZpcmViYXNlIHRvIGF2b2lkIGNpcmN1bGFyIGRlcGVuZGVuY2llc1xuICAgIC8vIFVzZSB3ZWJwYWNrIG1hZ2ljIGNvbW1lbnRzIHRvIGVuYWJsZSBjb25kaXRpb25hbCBpbXBvcnRzXG4gICAgaW1wb3J0KFxuICAgICAgLyogd2VicGFja01vZGU6IFwiZWFnZXJcIiAqL1xuICAgICAgLyogd2VicGFja0NodW5rTmFtZTogXCJmaXJlYmFzZS1jb250ZXh0XCIgKi9cbiAgICAgICcuL2ZpcmViYXNlJ1xuICAgICkudGhlbigoeyBhdXRoIH0pID0+IHtcbiAgICAgIGF1dGgub25BdXRoU3RhdGVDaGFuZ2VkKCh1c2VyOiBhbnkpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlTWFuYWdlcl0g8J+UkCBBdXRoIHN0YXRlIGNoYW5nZWQ6JywgdXNlciA/ICdTaWduZWQgaW4nIDogJ1NpZ25lZCBvdXQnKTtcbiAgICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlTWFuYWdlcl0g8J+UhCBJbnZhbGlkYXRpbmcgY2FjaGUgZHVlIHRvIGF1dGggc3RhdGUgY2hhbmdlJyk7XG4gICAgICAgIHRoaXMuY29uZmlnTWFuYWdlci5jbGVhckNhY2hlKCk7XG4gICAgICB9KTtcbiAgICB9KS5jYXRjaChlcnJvciA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbU3RvcmFnZU1hbmFnZXJdIEZhaWxlZCB0byBzZXR1cCBhdXRoIGxpc3RlbmVyOicsIGVycm9yKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXR1cCBzdG9yYWdlIGNoYW5nZSBsaXN0ZW5lciBmb3IgY3Jvc3MtY29udGV4dCBzeW5jaHJvbml6YXRpb25cbiAgICovXG4gIHByaXZhdGUgc2V0dXBTdG9yYWdlQ2hhbmdlTGlzdGVuZXIoKSB7XG4gICAgY2hyb21lLnN0b3JhZ2Uub25DaGFuZ2VkLmFkZExpc3RlbmVyKChjaGFuZ2VzLCBhcmVhTmFtZSkgPT4ge1xuICAgICAgaWYgKGFyZWFOYW1lID09PSAnbG9jYWwnICYmIGNoYW5nZXNbU3RvcmFnZU1hbmFnZXIuS0VZUy5DT05GSUddKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZU1hbmFnZXJdIPCflIQgQ29uZmlnIGNoYW5nZWQgaW4gYW5vdGhlciBjb250ZXh0Jyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGdldEluc3RhbmNlKCk6IFN0b3JhZ2VNYW5hZ2VyIHtcbiAgICBpZiAoIVN0b3JhZ2VNYW5hZ2VyLmluc3RhbmNlKSB7XG4gICAgICBTdG9yYWdlTWFuYWdlci5pbnN0YW5jZSA9IG5ldyBTdG9yYWdlTWFuYWdlcigpO1xuICAgIH1cbiAgICByZXR1cm4gU3RvcmFnZU1hbmFnZXIuaW5zdGFuY2U7XG4gIH1cblxuICAvLyA9PT09PT09PT09IEFVVEggSU5KRUNUSU9OIChmb3IgdGVzdGluZykgPT09PT09PT09PVxuXG4gIC8qKlxuICAgKiBTZXQgY3VzdG9tIEZpcmViYXNlIEF1dGggaW5zdGFuY2UgKGZvciB0ZXN0aW5nIHdpdGggc2VwYXJhdGUgRmlyZWJhc2UgaW5zdGFuY2VzKVxuICAgKiBUaGlzIGFsbG93cyBpbnRlZ3JhdGlvbiB0ZXN0cyB0byB1c2UgYSBzZXBhcmF0ZSB0ZXN0IGF1dGggaW5zdGFuY2Ugd2hpbGVcbiAgICogcHJvZHVjdGlvbiBjb2RlIHVzZXMgdGhlIGRlZmF1bHQgaW5zdGFuY2VcbiAgICogQHBhcmFtIGF1dGggLSBGaXJlYmFzZSBBdXRoIGluc3RhbmNlIHRvIHVzZSBmb3IgZW5jcnlwdGlvbiBrZXkgZGVyaXZhdGlvblxuICAgKi9cbiAgcHVibGljIHNldEN1c3RvbUF1dGgoYXV0aDogYW55KTogdm9pZCB7XG4gICAgdGhpcy5lbmNyeXB0aW9uTWFuYWdlci5zZXRDdXN0b21BdXRoKGF1dGgpO1xuICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZU1hbmFnZXJdIEN1c3RvbSBhdXRoIGluc3RhbmNlIGNvbmZpZ3VyZWQgZm9yIHRlc3RpbmcnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhciBjdXN0b20gYXV0aCBpbnN0YW5jZSAocmVzdG9yZSBkZWZhdWx0IGJlaGF2aW9yKVxuICAgKi9cbiAgcHVibGljIGNsZWFyQ3VzdG9tQXV0aCgpOiB2b2lkIHtcbiAgICB0aGlzLmVuY3J5cHRpb25NYW5hZ2VyLmNsZWFyQ3VzdG9tQXV0aCgpO1xuICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZU1hbmFnZXJdIENsZWFyZWQgY3VzdG9tIGF1dGggaW5zdGFuY2UnKTtcbiAgfVxuXG4gIC8vID09PT09PT09PT0gSU5JVElBTElaQVRJT04gJiBNSUdSQVRJT04gPT09PT09PT09PVxuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIHN0b3JhZ2Ugd2l0aCBkZWZhdWx0IHZhbHVlc1xuICAgKiBIYW5kbGVzIHYxIHRvIHYyIG1pZ3JhdGlvbiBpZiBuZWVkZWRcbiAgICogR3JhY2VmdWxseSBoYW5kbGVzIHVuYXV0aGVudGljYXRlZCBzdGF0ZSAocmV0dXJucyBlbXB0eSBkYXRhKVxuICAgKiBJbiBzZXJ2aWNlIHdvcmtlciBjb250ZXh0LCBza2lwcyBwcm9maWxlIGxvYWRpbmcgKHByb2ZpbGVzIHNlbnQgZnJvbSBwb3B1cClcbiAgICovXG4gIGFzeW5jIGluaXRpYWxpemUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIHRoaXMubWlncmF0aW9uTWFuYWdlci5pbml0aWFsaXplKCk7XG4gIH1cblxuICAvLyA9PT09PT09PT09IENPTkZJRyBNRVRIT0RTID09PT09PT09PT1cblxuICBhc3luYyBzYXZlQ29uZmlnKGNvbmZpZzogVXNlckNvbmZpZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiB0aGlzLmNvbmZpZ01hbmFnZXIuc2F2ZUNvbmZpZyhjb25maWcpO1xuICB9XG5cbiAgYXN5bmMgbG9hZENvbmZpZygpOiBQcm9taXNlPFVzZXJDb25maWcgfCBudWxsPiB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnTWFuYWdlci5sb2FkQ29uZmlnKCk7XG4gIH1cblxuICBjbGVhckNhY2hlKCk6IHZvaWQge1xuICAgIHRoaXMuY29uZmlnTWFuYWdlci5jbGVhckNhY2hlKCk7XG4gIH1cblxuICAvLyA9PT09PT09PT09IFBST0ZJTEUgTUVUSE9EUyAoVjIpID09PT09PT09PT1cblxuICBhc3luYyBzYXZlUHJvZmlsZXMocHJvZmlsZXM6IEFsaWFzUHJvZmlsZVtdKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIHRoaXMucHJvZmlsZU1hbmFnZXIuc2F2ZVByb2ZpbGVzKHByb2ZpbGVzKTtcbiAgfVxuXG4gIGFzeW5jIGxvYWRQcm9maWxlcygpOiBQcm9taXNlPEFsaWFzUHJvZmlsZVtdPiB7XG4gICAgcmV0dXJuIHRoaXMucHJvZmlsZU1hbmFnZXIubG9hZFByb2ZpbGVzKCk7XG4gIH1cblxuICBhc3luYyBjcmVhdGVQcm9maWxlKHByb2ZpbGVEYXRhOiB7XG4gICAgcHJvZmlsZU5hbWU6IHN0cmluZztcbiAgICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgICByZWFsOiBJZGVudGl0eURhdGE7XG4gICAgYWxpYXM6IElkZW50aXR5RGF0YTtcbiAgICBlbmFibGVkPzogYm9vbGVhbjtcbiAgfSk6IFByb21pc2U8QWxpYXNQcm9maWxlPiB7XG4gICAgcmV0dXJuIHRoaXMucHJvZmlsZU1hbmFnZXIuY3JlYXRlUHJvZmlsZShwcm9maWxlRGF0YSk7XG4gIH1cblxuICBhc3luYyB1cGRhdGVQcm9maWxlKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IFBhcnRpYWw8QWxpYXNQcm9maWxlPik6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiB0aGlzLnByb2ZpbGVNYW5hZ2VyLnVwZGF0ZVByb2ZpbGUoaWQsIHVwZGF0ZXMpO1xuICB9XG5cbiAgYXN5bmMgZGVsZXRlUHJvZmlsZShpZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIHRoaXMucHJvZmlsZU1hbmFnZXIuZGVsZXRlUHJvZmlsZShpZCk7XG4gIH1cblxuICBhc3luYyB0b2dnbGVQcm9maWxlKGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gdGhpcy5wcm9maWxlTWFuYWdlci50b2dnbGVQcm9maWxlKGlkKTtcbiAgfVxuXG4gIGFzeW5jIGdldFByb2ZpbGUoaWQ6IHN0cmluZyk6IFByb21pc2U8QWxpYXNQcm9maWxlIHwgbnVsbD4ge1xuICAgIHJldHVybiB0aGlzLnByb2ZpbGVNYW5hZ2VyLmdldFByb2ZpbGUoaWQpO1xuICB9XG5cbiAgYXN5bmMgaW5jcmVtZW50UHJvZmlsZVVzYWdlKFxuICAgIHByb2ZpbGVJZDogc3RyaW5nLFxuICAgIHNlcnZpY2U6ICdjaGF0Z3B0JyB8ICdjbGF1ZGUnIHwgJ2dlbWluaScsXG4gICAgcGlpVHlwZToga2V5b2YgQWxpYXNQcm9maWxlWydtZXRhZGF0YSddWyd1c2FnZVN0YXRzJ11bJ2J5UElJVHlwZSddXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiB0aGlzLnByb2ZpbGVNYW5hZ2VyLmluY3JlbWVudFByb2ZpbGVVc2FnZShwcm9maWxlSWQsIHNlcnZpY2UsIHBpaVR5cGUpO1xuICB9XG5cbiAgLy8gPT09PT09PT09PSBMRUdBQ1kgVjEgQUxJQVMgTUVUSE9EUyAoYmFja3dhcmQgY29tcGF0aWJpbGl0eSkgPT09PT09PT09PVxuXG4gIC8qKlxuICAgKiBTYXZlIGFsaWFzIGRpY3Rpb25hcnkgKGxlZ2FjeSB2MSlcbiAgICovXG4gIGFzeW5jIHNhdmVBbGlhc2VzKGFsaWFzZXM6IEFsaWFzRW50cnlbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGVuY3J5cHRlZCA9IGF3YWl0IHRoaXMuZW5jcnlwdGlvbk1hbmFnZXIuZW5jcnlwdChKU09OLnN0cmluZ2lmeShhbGlhc2VzKSk7XG4gICAgYXdhaXQgY2hyb21lLnN0b3JhZ2UubG9jYWwuc2V0KHtcbiAgICAgIFtTdG9yYWdlTWFuYWdlci5LRVlTLkFMSUFTRVNdOiBlbmNyeXB0ZWQsXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogTG9hZCBhbmQgZGVjcnlwdCBhbGlhc2VzIChsZWdhY3kgdjEgZGF0YSlcbiAgICogU3VwcG9ydHMgYXV0b21hdGljIG1pZ3JhdGlvbiBmcm9tIGxlZ2FjeSBlbmNyeXB0aW9uIHRvIEZpcmViYXNlIFVJRFxuICAgKi9cbiAgYXN5bmMgbG9hZEFsaWFzZXMoKTogUHJvbWlzZTxBbGlhc0VudHJ5W10+IHtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgY2hyb21lLnN0b3JhZ2UubG9jYWwuZ2V0KFN0b3JhZ2VNYW5hZ2VyLktFWVMuQUxJQVNFUyk7XG4gICAgaWYgKCFkYXRhW1N0b3JhZ2VNYW5hZ2VyLktFWVMuQUxJQVNFU10pIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBjb25zdCBlbmNyeXB0ZWREYXRhID0gZGF0YVtTdG9yYWdlTWFuYWdlci5LRVlTLkFMSUFTRVNdO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIFRyeSBGaXJlYmFzZSBVSUQga2V5IGZpcnN0IChuZXcgbWV0aG9kKVxuICAgICAgY29uc3QgZGVjcnlwdGVkID0gYXdhaXQgdGhpcy5lbmNyeXB0aW9uTWFuYWdlci5kZWNyeXB0KGVuY3J5cHRlZERhdGEpO1xuICAgICAgcmV0dXJuIEpTT04ucGFyc2UoZGVjcnlwdGVkKTtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBDaGVjayBpZiBsZWdhY3kga2V5IG1hdGVyaWFsIGV4aXN0c1xuICAgICAgY29uc3QgbGVnYWN5S2V5RGF0YSA9IGF3YWl0IGNocm9tZS5zdG9yYWdlLmxvY2FsLmdldCgnX2VuY3J5cHRpb25LZXlNYXRlcmlhbCcpO1xuICAgICAgY29uc3QgaGFzTGVnYWN5S2V5ID0gISFsZWdhY3lLZXlEYXRhWydfZW5jcnlwdGlvbktleU1hdGVyaWFsJ107XG5cbiAgICAgIGlmICghaGFzTGVnYWN5S2V5KSB7XG4gICAgICAgIC8vIE5vIGxlZ2FjeSBrZXkgPSBhbHJlYWR5IG1pZ3JhdGVkXG4gICAgICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZU1hbmFnZXJdIEFsaWFzZXMgYWxyZWFkeSBtaWdyYXRlZCB0byBGaXJlYmFzZSBVSUQnKTtcblxuICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdFTkNSWVBUSU9OX0tFWV9VTkFWQUlMQUJMRScpKSB7XG4gICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gW107IC8vIFJldHVybiBlbXB0eSBpZiBjYW4ndCBkZWNyeXB0XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUud2FybignW1N0b3JhZ2VNYW5hZ2VyXSBBbGlhc2VzOiBGaXJlYmFzZSBVSUQgZGVjcnlwdGlvbiBmYWlsZWQsIGF0dGVtcHRpbmcgbGVnYWN5IG1pZ3JhdGlvbi4uLicpO1xuXG4gICAgICB0cnkge1xuICAgICAgICAvLyBGYWxsIGJhY2sgdG8gbGVnYWN5IGtleVxuICAgICAgICBjb25zdCBsZWdhY3lLZXkgPSBhd2FpdCB0aGlzLmVuY3J5cHRpb25NYW5hZ2VyLmdldExlZ2FjeUVuY3J5cHRpb25LZXkoKTtcbiAgICAgICAgY29uc3QgZGVjcnlwdGVkID0gYXdhaXQgdGhpcy5lbmNyeXB0aW9uTWFuYWdlci5kZWNyeXB0V2l0aEtleShlbmNyeXB0ZWREYXRhLCBsZWdhY3lLZXkpO1xuICAgICAgICBjb25zdCBhbGlhc2VzID0gSlNPTi5wYXJzZShkZWNyeXB0ZWQpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZU1hbmFnZXJdIOKchSBMZWdhY3kgYWxpYXNlcyBkZWNyeXB0ZWQnKTtcblxuICAgICAgICAvLyBDaGVjayBpZiB3ZSdyZSBpbiBzZXJ2aWNlIHdvcmtlciBjb250ZXh0XG4gICAgICAgIGNvbnN0IGlzU2VydmljZVdvcmtlciA9IHR5cGVvZiBkb2N1bWVudCA9PT0gJ3VuZGVmaW5lZCc7XG5cbiAgICAgICAgaWYgKGlzU2VydmljZVdvcmtlcikge1xuICAgICAgICAgIC8vIEluIHNlcnZpY2Ugd29ya2VyLCBjYW4ndCByZS1lbmNyeXB0IChubyBGaXJlYmFzZSBhdXRoKVxuICAgICAgICAgIGNvbnNvbGUubG9nKCdbU3RvcmFnZU1hbmFnZXJdIOKPre+4jyBSdW5uaW5nIGluIHNlcnZpY2Ugd29ya2VyIC0gc2tpcHBpbmcgYWxpYXNlcyBtaWdyYXRpb24nKTtcbiAgICAgICAgICByZXR1cm4gYWxpYXNlcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEluIHBvcHVwL2NvbnRlbnQgY29udGV4dCAtIHByb2NlZWQgd2l0aCBtaWdyYXRpb25cbiAgICAgICAgY29uc29sZS5sb2coJ1tTdG9yYWdlTWFuYWdlcl0g8J+UhCBNaWdyYXRpbmcgYWxpYXNlcyB0byBGaXJlYmFzZSBVSUQuLi4nKTtcblxuICAgICAgICAvLyBSZS1lbmNyeXB0IHdpdGggRmlyZWJhc2UgVUlEXG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZUFsaWFzZXMoYWxpYXNlcyk7XG5cbiAgICAgICAgcmV0dXJuIGFsaWFzZXM7XG5cbiAgICAgIH0gY2F0Y2ggKGxlZ2FjeUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTdG9yYWdlTWFuYWdlcl0gRmFpbGVkIHRvIGRlY3J5cHQgYWxpYXNlczonLCBsZWdhY3lFcnJvcik7XG5cbiAgICAgICAgLy8gUmUtdGhyb3cgYXV0aCBlcnJvcnMgZm9yIFVJIGhhbmRsaW5nXG4gICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0VOQ1JZUFRJT05fS0VZX1VOQVZBSUxBQkxFJykpIHtcbiAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQWRkIGEgbmV3IGFsaWFzIChsZWdhY3kgdjEpXG4gICAqL1xuICBhc3luYyBhZGRBbGlhcyhhbGlhczogT21pdDxBbGlhc0VudHJ5LCAnaWQnIHwgJ21ldGFkYXRhJz4pOiBQcm9taXNlPEFsaWFzRW50cnk+IHtcbiAgICBjb25zdCBhbGlhc2VzID0gYXdhaXQgdGhpcy5sb2FkQWxpYXNlcygpO1xuXG4gICAgY29uc3QgbmV3QWxpYXM6IEFsaWFzRW50cnkgPSB7XG4gICAgICAuLi5hbGlhcyxcbiAgICAgIGlkOiBnZW5lcmF0ZUlkKCksXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICBjcmVhdGVkQXQ6IERhdGUubm93KCksXG4gICAgICAgIHVzYWdlQ291bnQ6IDAsXG4gICAgICAgIGxhc3RVc2VkOiAwLFxuICAgICAgICBjb25maWRlbmNlOiAxLFxuICAgICAgfSxcbiAgICB9O1xuXG4gICAgYWxpYXNlcy5wdXNoKG5ld0FsaWFzKTtcbiAgICBhd2FpdCB0aGlzLnNhdmVBbGlhc2VzKGFsaWFzZXMpO1xuICAgIHJldHVybiBuZXdBbGlhcztcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgYW4gYWxpYXMgYnkgSUQgKGxlZ2FjeSB2MSlcbiAgICovXG4gIGFzeW5jIHJlbW92ZUFsaWFzKGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBhbGlhc2VzID0gYXdhaXQgdGhpcy5sb2FkQWxpYXNlcygpO1xuICAgIGNvbnN0IGZpbHRlcmVkID0gYWxpYXNlcy5maWx0ZXIoYSA9PiBhLmlkICE9PSBpZCk7XG4gICAgYXdhaXQgdGhpcy5zYXZlQWxpYXNlcyhmaWx0ZXJlZCk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIGFuIGV4aXN0aW5nIGFsaWFzIChsZWdhY3kgdjEpXG4gICAqL1xuICBhc3luYyB1cGRhdGVBbGlhcyhpZDogc3RyaW5nLCB1cGRhdGVzOiBQYXJ0aWFsPEFsaWFzRW50cnk+KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgYWxpYXNlcyA9IGF3YWl0IHRoaXMubG9hZEFsaWFzZXMoKTtcbiAgICBjb25zdCBpbmRleCA9IGFsaWFzZXMuZmluZEluZGV4KGEgPT4gYS5pZCA9PT0gaWQpO1xuXG4gICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgYWxpYXNlc1tpbmRleF0gPSB7IC4uLmFsaWFzZXNbaW5kZXhdLCAuLi51cGRhdGVzIH07XG4gICAgICBhd2FpdCB0aGlzLnNhdmVBbGlhc2VzKGFsaWFzZXMpO1xuICAgIH1cbiAgfVxuXG4gIC8vID09PT09PT09PT0gQVBJIEtFWSBWQVVMVCBNRVRIT0RTID09PT09PT09PT1cblxuICBhc3luYyBhZGRBUElLZXkoa2V5RGF0YToge1xuICAgIG5hbWU/OiBzdHJpbmc7XG4gICAga2V5VmFsdWU6IHN0cmluZztcbiAgICBmb3JtYXQ/OiBpbXBvcnQoJy4vdHlwZXMnKS5BUElLZXlGb3JtYXQ7XG4gIH0pOiBQcm9taXNlPEFQSUtleT4ge1xuICAgIHJldHVybiB0aGlzLmFwaUtleVZhdWx0TWFuYWdlci5hZGRBUElLZXkoa2V5RGF0YSk7XG4gIH1cblxuICBhc3luYyByZW1vdmVBUElLZXkoa2V5SWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiB0aGlzLmFwaUtleVZhdWx0TWFuYWdlci5yZW1vdmVBUElLZXkoa2V5SWQpO1xuICB9XG5cbiAgYXN5bmMgdXBkYXRlQVBJS2V5KGtleUlkOiBzdHJpbmcsIHVwZGF0ZXM6IFBhcnRpYWw8QVBJS2V5Pik6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiB0aGlzLmFwaUtleVZhdWx0TWFuYWdlci51cGRhdGVBUElLZXkoa2V5SWQsIHVwZGF0ZXMpO1xuICB9XG5cbiAgYXN5bmMgZ2V0QVBJS2V5KGtleUlkOiBzdHJpbmcpOiBQcm9taXNlPEFQSUtleSB8IG51bGw+IHtcbiAgICByZXR1cm4gdGhpcy5hcGlLZXlWYXVsdE1hbmFnZXIuZ2V0QVBJS2V5KGtleUlkKTtcbiAgfVxuXG4gIGFzeW5jIGdldEFsbEFQSUtleXMoKTogUHJvbWlzZTxBUElLZXlbXT4ge1xuICAgIHJldHVybiB0aGlzLmFwaUtleVZhdWx0TWFuYWdlci5nZXRBbGxBUElLZXlzKCk7XG4gIH1cblxuICBhc3luYyBpbmNyZW1lbnRBUElLZXlQcm90ZWN0aW9uKGtleUlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gdGhpcy5hcGlLZXlWYXVsdE1hbmFnZXIuaW5jcmVtZW50QVBJS2V5UHJvdGVjdGlvbihrZXlJZCk7XG4gIH1cblxuICBhc3luYyB1cGRhdGVBUElLZXlWYXVsdFNldHRpbmdzKHNldHRpbmdzOiBQYXJ0aWFsPEFQSUtleVZhdWx0Q29uZmlnPik6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiB0aGlzLmFwaUtleVZhdWx0TWFuYWdlci51cGRhdGVBUElLZXlWYXVsdFNldHRpbmdzKHNldHRpbmdzKTtcbiAgfVxuXG4gIC8vID09PT09PT09PT0gQ1VTVE9NIFJFREFDVElPTiBSVUxFUyBNRVRIT0RTID09PT09PT09PT1cblxuICBhc3luYyBhZGRDdXN0b21SdWxlKHJ1bGVEYXRhOiB7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHBhdHRlcm46IHN0cmluZztcbiAgICByZXBsYWNlbWVudDogc3RyaW5nO1xuICAgIGNhdGVnb3J5OiAncGlpJyB8ICdmaW5hbmNpYWwnIHwgJ21lZGljYWwnIHwgJ2N1c3RvbSc7XG4gICAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gICAgcHJpb3JpdHk/OiBudW1iZXI7XG4gICAgdGVzdENhc2VzPzogeyBpbnB1dDogc3RyaW5nOyBleHBlY3RlZDogc3RyaW5nIH1bXTtcbiAgfSk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgcmV0dXJuIHRoaXMuY3VzdG9tUnVsZXNNYW5hZ2VyLmFkZEN1c3RvbVJ1bGUocnVsZURhdGEpO1xuICB9XG5cbiAgYXN5bmMgcmVtb3ZlQ3VzdG9tUnVsZShydWxlSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiB0aGlzLmN1c3RvbVJ1bGVzTWFuYWdlci5yZW1vdmVDdXN0b21SdWxlKHJ1bGVJZCk7XG4gIH1cblxuICBhc3luYyB1cGRhdGVDdXN0b21SdWxlKHJ1bGVJZDogc3RyaW5nLCB1cGRhdGVzOiBQYXJ0aWFsPGltcG9ydCgnLi90eXBlcycpLkN1c3RvbVJ1bGU+KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIHRoaXMuY3VzdG9tUnVsZXNNYW5hZ2VyLnVwZGF0ZUN1c3RvbVJ1bGUocnVsZUlkLCB1cGRhdGVzKTtcbiAgfVxuXG4gIGFzeW5jIHRvZ2dsZUN1c3RvbVJ1bGUocnVsZUlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gdGhpcy5jdXN0b21SdWxlc01hbmFnZXIudG9nZ2xlQ3VzdG9tUnVsZShydWxlSWQpO1xuICB9XG5cbiAgYXN5bmMgaW5jcmVtZW50UnVsZU1hdGNoQ291bnQocnVsZUlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gdGhpcy5jdXN0b21SdWxlc01hbmFnZXIuaW5jcmVtZW50UnVsZU1hdGNoQ291bnQocnVsZUlkKTtcbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZUN1c3RvbVJ1bGVzU2V0dGluZ3Moc2V0dGluZ3M6IFBhcnRpYWw8Q3VzdG9tUnVsZXNDb25maWc+KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIHRoaXMuY3VzdG9tUnVsZXNNYW5hZ2VyLnVwZGF0ZUN1c3RvbVJ1bGVzU2V0dGluZ3Moc2V0dGluZ3MpO1xuICB9XG5cbiAgLy8gPT09PT09PT09PSBQUk9NUFQgVEVNUExBVEVTIE1BTkFHRU1FTlQgPT09PT09PT09PVxuXG4gIGFzeW5jIGFkZFByb21wdFRlbXBsYXRlKHRlbXBsYXRlRGF0YToge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBjb250ZW50OiBzdHJpbmc7XG4gICAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gICAgY2F0ZWdvcnk/OiBzdHJpbmc7XG4gICAgdGFncz86IHN0cmluZ1tdO1xuICAgIHByb2ZpbGVJZD86IHN0cmluZztcbiAgfSk6IFByb21pc2U8UHJvbXB0VGVtcGxhdGU+IHtcbiAgICByZXR1cm4gdGhpcy5wcm9tcHRUZW1wbGF0ZXNNYW5hZ2VyLmFkZFByb21wdFRlbXBsYXRlKHRlbXBsYXRlRGF0YSk7XG4gIH1cblxuICBhc3luYyByZW1vdmVQcm9tcHRUZW1wbGF0ZSh0ZW1wbGF0ZUlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gdGhpcy5wcm9tcHRUZW1wbGF0ZXNNYW5hZ2VyLnJlbW92ZVByb21wdFRlbXBsYXRlKHRlbXBsYXRlSWQpO1xuICB9XG5cbiAgYXN5bmMgdXBkYXRlUHJvbXB0VGVtcGxhdGUodGVtcGxhdGVJZDogc3RyaW5nLCB1cGRhdGVzOiBQYXJ0aWFsPFByb21wdFRlbXBsYXRlPik6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiB0aGlzLnByb21wdFRlbXBsYXRlc01hbmFnZXIudXBkYXRlUHJvbXB0VGVtcGxhdGUodGVtcGxhdGVJZCwgdXBkYXRlcyk7XG4gIH1cblxuICBhc3luYyBnZXRQcm9tcHRUZW1wbGF0ZSh0ZW1wbGF0ZUlkOiBzdHJpbmcpOiBQcm9taXNlPFByb21wdFRlbXBsYXRlIHwgbnVsbD4ge1xuICAgIHJldHVybiB0aGlzLnByb21wdFRlbXBsYXRlc01hbmFnZXIuZ2V0UHJvbXB0VGVtcGxhdGUodGVtcGxhdGVJZCk7XG4gIH1cblxuICBhc3luYyBnZXRBbGxQcm9tcHRUZW1wbGF0ZXMoKTogUHJvbWlzZTxQcm9tcHRUZW1wbGF0ZVtdPiB7XG4gICAgcmV0dXJuIHRoaXMucHJvbXB0VGVtcGxhdGVzTWFuYWdlci5nZXRBbGxQcm9tcHRUZW1wbGF0ZXMoKTtcbiAgfVxuXG4gIGFzeW5jIGluY3JlbWVudFRlbXBsYXRlVXNhZ2UodGVtcGxhdGVJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIHRoaXMucHJvbXB0VGVtcGxhdGVzTWFuYWdlci5pbmNyZW1lbnRUZW1wbGF0ZVVzYWdlKHRlbXBsYXRlSWQpO1xuICB9XG5cbiAgYXN5bmMgdXBkYXRlUHJvbXB0VGVtcGxhdGVzU2V0dGluZ3Moc2V0dGluZ3M6IFBhcnRpYWw8UHJvbXB0VGVtcGxhdGVzQ29uZmlnPik6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiB0aGlzLnByb21wdFRlbXBsYXRlc01hbmFnZXIudXBkYXRlUHJvbXB0VGVtcGxhdGVzU2V0dGluZ3Moc2V0dGluZ3MpO1xuICB9XG5cbiAgLy8gPT09PT09PT09PSBET0NVTUVOVCBBTkFMWVNJUyBNRVRIT0RTID09PT09PT09PT1cblxuICBhc3luYyBsb2FkRG9jdW1lbnRBbGlhc2VzKCk6IFByb21pc2U8RG9jdW1lbnRBbGlhc1tdPiB7XG4gICAgcmV0dXJuIHRoaXMuZG9jdW1lbnRBbGlhc01hbmFnZXIubG9hZERvY3VtZW50QWxpYXNlcygpO1xuICB9XG5cbiAgYXN5bmMgc2F2ZURvY3VtZW50QWxpYXMoZG9jdW1lbnRBbGlhczogRG9jdW1lbnRBbGlhcyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiB0aGlzLmRvY3VtZW50QWxpYXNNYW5hZ2VyLnNhdmVEb2N1bWVudEFsaWFzKGRvY3VtZW50QWxpYXMpO1xuICB9XG5cbiAgYXN5bmMgZGVsZXRlRG9jdW1lbnRBbGlhcyhpZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIHRoaXMuZG9jdW1lbnRBbGlhc01hbmFnZXIuZGVsZXRlRG9jdW1lbnRBbGlhcyhpZCk7XG4gIH1cblxuICBhc3luYyB1cGRhdGVEb2N1bWVudEFsaWFzKGRvY3VtZW50QWxpYXM6IERvY3VtZW50QWxpYXMpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gdGhpcy5kb2N1bWVudEFsaWFzTWFuYWdlci51cGRhdGVEb2N1bWVudEFsaWFzKGRvY3VtZW50QWxpYXMpO1xuICB9XG5cbiAgLy8gPT09PT09PT09PSBTVE9SQUdFIFFVT1RBIE1PTklUT1JJTkcgPT09PT09PT09PVxuXG4gIGFzeW5jIGdldFN0b3JhZ2VRdW90YSgpOiBQcm9taXNlPHtcbiAgICB1c2VkOiBudW1iZXI7XG4gICAgcXVvdGE6IG51bWJlcjtcbiAgICBwZXJjZW50YWdlOiBudW1iZXI7XG4gICAgaGFzVW5saW1pdGVkU3RvcmFnZTogYm9vbGVhbjtcbiAgfT4ge1xuICAgIHJldHVybiBnZXRTdG9yYWdlUXVvdGEoKTtcbiAgfVxuXG4gIC8vID09PT09PT09PT0gRU5DUllQVElPTiBERUxFR0FUSU9OID09PT09PT09PT1cblxuICAvKipcbiAgICogRW5jcnlwdCBkYXRhIChkZWxlZ2F0ZXMgdG8gZW5jcnlwdGlvbk1hbmFnZXIpXG4gICAqIFVzZWQgYnkgdGllciBhcmNoaXZlL21pZ3JhdGlvbiBzeXN0ZW1zXG4gICAqL1xuICBhc3luYyBlbmNyeXB0KGRhdGE6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgcmV0dXJuIHRoaXMuZW5jcnlwdGlvbk1hbmFnZXIuZW5jcnlwdChkYXRhKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWNyeXB0IGRhdGEgKGRlbGVnYXRlcyB0byBlbmNyeXB0aW9uTWFuYWdlcilcbiAgICogVXNlZCBieSB0aWVyIGFyY2hpdmUvbWlncmF0aW9uIHN5c3RlbXNcbiAgICovXG4gIGFzeW5jIGRlY3J5cHQoZW5jcnlwdGVkRGF0YTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICByZXR1cm4gdGhpcy5lbmNyeXB0aW9uTWFuYWdlci5kZWNyeXB0KGVuY3J5cHRlZERhdGEpO1xuICB9XG5cbiAgLy8gPT09PT09PT09PSBDT05GSUcgREVMRUdBVElPTiA9PT09PT09PT09XG5cbiAgLyoqXG4gICAqIEdldCBzdGFydGVyIHRlbXBsYXRlcyAoZGVsZWdhdGVzIHRvIGNvbmZpZ01hbmFnZXIpXG4gICAqIFVzZWQgYnkgdGllciBhcmNoaXZlL21pZ3JhdGlvbiBzeXN0ZW1zXG4gICAqL1xuICBnZXRTdGFydGVyVGVtcGxhdGVzKCk6IFByb21wdFRlbXBsYXRlW10ge1xuICAgIHJldHVybiB0aGlzLmNvbmZpZ01hbmFnZXIuZ2V0U3RhcnRlclRlbXBsYXRlcygpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFN0b3JhZ2VNYW5hZ2VyO1xuIiwiLyoqXG4gKiBBbGlhcyBFbmdpbmUgLSBDb3JlIHN1YnN0aXR1dGlvbiBsb2dpY1xuICogSGFuZGxlcyBiaWRpcmVjdGlvbmFsIHRleHQgc3Vic3RpdHV0aW9uIHdpdGggY2FzZSBwcmVzZXJ2YXRpb25cbiAqIFZlcnNpb24gMi4wIC0gUHJvZmlsZS1iYXNlZCBtdWx0aS1QSUkgbWF0Y2hpbmdcbiAqIFZlcnNpb24gMi4xIC0gQWRkZWQgYWxpYXMgdmFyaWF0aW9ucyBzdXBwb3J0XG4gKi9cblxuaW1wb3J0IHsgQWxpYXNQcm9maWxlLCBTdWJzdGl0dXRpb25SZXN1bHQsIFN1YnN0aXR1dGlvbk9wdGlvbnMsIFBJSVR5cGUgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IFN0b3JhZ2VNYW5hZ2VyIH0gZnJvbSAnLi9zdG9yYWdlJztcblxuY29uc3QgREVCVUdfTU9ERSA9IGZhbHNlOyAvLyBTZXQgdG8gdHJ1ZSBmb3IgZGV2ZWxvcG1lbnQgZGVidWdnaW5nXG5cbmludGVyZmFjZSBQSUlNYXBwaW5nIHtcbiAgcmVhbDogc3RyaW5nO1xuICBhbGlhczogc3RyaW5nO1xuICBwcm9maWxlSWQ6IHN0cmluZztcbiAgcHJvZmlsZU5hbWU6IHN0cmluZztcbiAgcGlpVHlwZTogUElJVHlwZTtcbn1cblxuZXhwb3J0IGNsYXNzIEFsaWFzRW5naW5lIHtcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IEFsaWFzRW5naW5lO1xuICBwcml2YXRlIHByb2ZpbGVzOiBBbGlhc1Byb2ZpbGVbXSA9IFtdO1xuICBwcml2YXRlIHJlYWxUb0FsaWFzTWFwOiBNYXA8c3RyaW5nLCBQSUlNYXBwaW5nPiA9IG5ldyBNYXAoKTtcbiAgcHJpdmF0ZSBhbGlhc1RvUmVhbE1hcDogTWFwPHN0cmluZywgUElJTWFwcGluZz4gPSBuZXcgTWFwKCk7XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHt9XG5cbiAgcHVibGljIHN0YXRpYyBhc3luYyBnZXRJbnN0YW5jZSgpOiBQcm9taXNlPEFsaWFzRW5naW5lPiB7XG4gICAgaWYgKCFBbGlhc0VuZ2luZS5pbnN0YW5jZSkge1xuICAgICAgQWxpYXNFbmdpbmUuaW5zdGFuY2UgPSBuZXcgQWxpYXNFbmdpbmUoKTtcblxuICAgICAgLy8gT25seSBsb2FkIHByb2ZpbGVzIGlmIG5vdCBpbiBzZXJ2aWNlIHdvcmtlciBjb250ZXh0XG4gICAgICAvLyBJbiBzZXJ2aWNlIHdvcmtlciwgcHJvZmlsZXMgd2lsbCBiZSBzZW50IHZpYSBTRVRfUFJPRklMRVMgbWVzc2FnZVxuICAgICAgY29uc3QgaXNTZXJ2aWNlV29ya2VyID0gdHlwZW9mIGRvY3VtZW50ID09PSAndW5kZWZpbmVkJztcbiAgICAgIGlmICghaXNTZXJ2aWNlV29ya2VyKSB7XG4gICAgICAgIGF3YWl0IEFsaWFzRW5naW5lLmluc3RhbmNlLmxvYWRQcm9maWxlcygpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tBbGlhc0VuZ2luZV0gU2VydmljZSB3b3JrZXIgY29udGV4dCAtIHdhaXRpbmcgZm9yIHByb2ZpbGVzIHZpYSBTRVRfUFJPRklMRVMnKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIEFsaWFzRW5naW5lLmluc3RhbmNlO1xuICB9XG5cbiAgLyoqXG4gICAqIExvYWQgcHJvZmlsZXMgZnJvbSBzdG9yYWdlIGFuZCBidWlsZCBsb29rdXAgbWFwc1xuICAgKiBIYW5kbGVzIHNlcnZpY2Ugd29ya2VyIGNvbnRleHQgZ3JhY2VmdWxseSAod2hlcmUgZW5jcnlwdGlvbiBtYXkgbm90IGJlIGF2YWlsYWJsZSlcbiAgICovXG4gIGFzeW5jIGxvYWRQcm9maWxlcygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3RvcmFnZSA9IFN0b3JhZ2VNYW5hZ2VyLmdldEluc3RhbmNlKCk7XG4gICAgICB0aGlzLnByb2ZpbGVzID0gYXdhaXQgc3RvcmFnZS5sb2FkUHJvZmlsZXMoKTtcbiAgICAgIHRoaXMuYnVpbGRMb29rdXBNYXBzKCk7XG4gICAgICBjb25zb2xlLmxvZygnW0FsaWFzRW5naW5lXSBMb2FkZWQnLCB0aGlzLnByb2ZpbGVzLmxlbmd0aCwgJ3Byb2ZpbGVzJyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIEluIHNlcnZpY2Ugd29ya2VyIGNvbnRleHQsIGVuY3J5cHRlZCBwcm9maWxlcyBtYXkgbm90IGJlIGFjY2Vzc2libGVcbiAgICAgIC8vIFRoaXMgaXMgZXhwZWN0ZWQgLSBwcm9maWxlcyB3aWxsIGJlIGVtcHR5IHVudGlsIGFjY2Vzc2VkIGZyb20gcG9wdXBcbiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0VOQ1JZUFRJT05fS0VZX1VOQVZBSUxBQkxFJykpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tBbGlhc0VuZ2luZV0gUnVubmluZyBpbiBzZXJ2aWNlIHdvcmtlciBjb250ZXh0IC0gcHJvZmlsZXMgdW5hdmFpbGFibGUgKGVuY3J5cHRlZCknKTtcbiAgICAgICAgY29uc29sZS5sb2coJ1tBbGlhc0VuZ2luZV0gUHJvZmlsZXMgd2lsbCBsb2FkIG9uY2UgdXNlciBvcGVucyBwb3B1cCBhbmQgYXV0aGVudGljYXRlcycpO1xuICAgICAgICB0aGlzLnByb2ZpbGVzID0gW107XG4gICAgICAgIHRoaXMuYnVpbGRMb29rdXBNYXBzKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbQWxpYXNFbmdpbmVdIEZhaWxlZCB0byBsb2FkIHByb2ZpbGVzOicsIGVycm9yKTtcbiAgICAgICAgdGhpcy5wcm9maWxlcyA9IFtdO1xuICAgICAgICB0aGlzLmJ1aWxkTG9va3VwTWFwcygpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgcHJvZmlsZXMgZGlyZWN0bHkgKHVzZWQgYnkgcG9wdXAgdG8gc2VuZCBkZWNyeXB0ZWQgcHJvZmlsZXMgdG8gc2VydmljZSB3b3JrZXIpXG4gICAqIFRoaXMgYnlwYXNzZXMgZW5jcnlwdGlvbiBpc3N1ZXMgaW4gc2VydmljZSB3b3JrZXIgY29udGV4dFxuICAgKi9cbiAgc2V0UHJvZmlsZXMocHJvZmlsZXM6IEFsaWFzUHJvZmlsZVtdKTogdm9pZCB7XG4gICAgdGhpcy5wcm9maWxlcyA9IHByb2ZpbGVzO1xuICAgIHRoaXMuYnVpbGRMb29rdXBNYXBzKCk7XG4gICAgY29uc29sZS5sb2coJ1tBbGlhc0VuZ2luZV0gUHJvZmlsZXMgc2V0IGRpcmVjdGx5OicsIHRoaXMucHJvZmlsZXMubGVuZ3RoLCAncHJvZmlsZXMnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBCdWlsZCBlZmZpY2llbnQgbG9va3VwIG1hcHMgZnJvbSBhbGwgUElJIGZpZWxkcyBpbiBwcm9maWxlc1xuICAgKiBJbmNsdWRlcyB2YXJpYXRpb25zIGlmIGVuYWJsZWRcbiAgICovXG4gIHByaXZhdGUgYnVpbGRMb29rdXBNYXBzKCk6IHZvaWQge1xuICAgIHRoaXMucmVhbFRvQWxpYXNNYXAuY2xlYXIoKTtcbiAgICB0aGlzLmFsaWFzVG9SZWFsTWFwLmNsZWFyKCk7XG5cbiAgICBjb25zdCBwaWlGaWVsZHM6IFBJSVR5cGVbXSA9IFsnbmFtZScsICdlbWFpbCcsICdwaG9uZScsICdjZWxsUGhvbmUnLCAnYWRkcmVzcycsICdjb21wYW55J107XG5cbiAgICBmb3IgKGNvbnN0IHByb2ZpbGUgb2YgdGhpcy5wcm9maWxlcykge1xuICAgICAgaWYgKCFwcm9maWxlLmVuYWJsZWQpIGNvbnRpbnVlO1xuXG4gICAgICBjb25zdCB1c2VWYXJpYXRpb25zID0gcHJvZmlsZS5zZXR0aW5ncz8uZW5hYmxlVmFyaWF0aW9ucyA/PyB0cnVlOyAvLyBEZWZhdWx0IHRvIGVuYWJsZWRcblxuICAgICAgLy8gQnVpbGQgbWFwcGluZ3MgZm9yIGVhY2ggUElJIGZpZWxkXG4gICAgICBmb3IgKGNvbnN0IHBpaVR5cGUgb2YgcGlpRmllbGRzKSB7XG4gICAgICAgIGNvbnN0IHJlYWxWYWx1ZSA9IHByb2ZpbGUucmVhbFtwaWlUeXBlXSBhcyBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gICAgICAgIGNvbnN0IGFsaWFzVmFsdWUgPSBwcm9maWxlLmFsaWFzW3BpaVR5cGVdIGFzIHN0cmluZyB8IHVuZGVmaW5lZDtcblxuICAgICAgICBpZiAocmVhbFZhbHVlICYmIGFsaWFzVmFsdWUgJiYgdHlwZW9mIHJlYWxWYWx1ZSA9PT0gJ3N0cmluZycgJiYgdHlwZW9mIGFsaWFzVmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgY29uc3QgbWFwcGluZzogUElJTWFwcGluZyA9IHtcbiAgICAgICAgICAgIHJlYWw6IHJlYWxWYWx1ZSxcbiAgICAgICAgICAgIGFsaWFzOiBhbGlhc1ZhbHVlLFxuICAgICAgICAgICAgcHJvZmlsZUlkOiBwcm9maWxlLmlkLFxuICAgICAgICAgICAgcHJvZmlsZU5hbWU6IHByb2ZpbGUucHJvZmlsZU5hbWUsXG4gICAgICAgICAgICBwaWlUeXBlLFxuICAgICAgICAgIH07XG5cbiAgICAgICAgICAvLyBBZGQgcHJpbWFyeSB2YWx1ZXNcbiAgICAgICAgICB0aGlzLnJlYWxUb0FsaWFzTWFwLnNldChyZWFsVmFsdWUudG9Mb3dlckNhc2UoKSwgbWFwcGluZyk7XG4gICAgICAgICAgdGhpcy5hbGlhc1RvUmVhbE1hcC5zZXQoYWxpYXNWYWx1ZS50b0xvd2VyQ2FzZSgpLCBtYXBwaW5nKTtcblxuICAgICAgICAgIC8vIEFkZCB2YXJpYXRpb25zIGlmIGVuYWJsZWRcbiAgICAgICAgICBpZiAodXNlVmFyaWF0aW9ucyAmJiBwcm9maWxlLnZhcmlhdGlvbnMpIHtcbiAgICAgICAgICAgIC8vIEdldCBkaXNhYmxlZCB2YXJpYXRpb25zIGxpc3RcbiAgICAgICAgICAgIGNvbnN0IGRpc2FibGVkUmVhbFZhcmlhdGlvbnMgPSBwcm9maWxlLmRpc2FibGVkVmFyaWF0aW9ucz8ucmVhbFtwaWlUeXBlXSB8fCBbXTtcbiAgICAgICAgICAgIGNvbnN0IGRpc2FibGVkQWxpYXNWYXJpYXRpb25zID0gcHJvZmlsZS5kaXNhYmxlZFZhcmlhdGlvbnM/LmFsaWFzW3BpaVR5cGVdIHx8IFtdO1xuXG4gICAgICAgICAgICAvLyBBZGQgcmVhbCB2YXJpYXRpb25zIChhdXRvLWdlbmVyYXRlZCkgLSBza2lwIGRpc2FibGVkIG9uZXNcbiAgICAgICAgICAgIGNvbnN0IHJlYWxWYXJpYXRpb25zID0gcHJvZmlsZS52YXJpYXRpb25zLnJlYWxbcGlpVHlwZV0gfHwgW107XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHZhcmlhdGlvbiBvZiByZWFsVmFyaWF0aW9ucykge1xuICAgICAgICAgICAgICBpZiAodmFyaWF0aW9uICYmXG4gICAgICAgICAgICAgICAgICB2YXJpYXRpb24udG9Mb3dlckNhc2UoKSAhPT0gcmVhbFZhbHVlLnRvTG93ZXJDYXNlKCkgJiZcbiAgICAgICAgICAgICAgICAgICFkaXNhYmxlZFJlYWxWYXJpYXRpb25zLmluY2x1ZGVzKHZhcmlhdGlvbikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlYWxUb0FsaWFzTWFwLnNldCh2YXJpYXRpb24udG9Mb3dlckNhc2UoKSwgbWFwcGluZyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQWRkIGFsaWFzIHZhcmlhdGlvbnMgKGF1dG8tZ2VuZXJhdGVkKSAtIHNraXAgZGlzYWJsZWQgb25lc1xuICAgICAgICAgICAgY29uc3QgYWxpYXNWYXJpYXRpb25zID0gcHJvZmlsZS52YXJpYXRpb25zLmFsaWFzW3BpaVR5cGVdIHx8IFtdO1xuICAgICAgICAgICAgZm9yIChjb25zdCB2YXJpYXRpb24gb2YgYWxpYXNWYXJpYXRpb25zKSB7XG4gICAgICAgICAgICAgIGlmICh2YXJpYXRpb24gJiZcbiAgICAgICAgICAgICAgICAgIHZhcmlhdGlvbi50b0xvd2VyQ2FzZSgpICE9PSBhbGlhc1ZhbHVlLnRvTG93ZXJDYXNlKCkgJiZcbiAgICAgICAgICAgICAgICAgICFkaXNhYmxlZEFsaWFzVmFyaWF0aW9ucy5pbmNsdWRlcyh2YXJpYXRpb24pKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hbGlhc1RvUmVhbE1hcC5zZXQodmFyaWF0aW9uLnRvTG93ZXJDYXNlKCksIG1hcHBpbmcpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gQWRkIGN1c3RvbSB2YXJpYXRpb25zIChvbmx5IGlmIGVuYWJsZWQgZmxhZyBpcyB0cnVlKVxuICAgICAgICAgIGlmICh1c2VWYXJpYXRpb25zICYmIHByb2ZpbGUuY3VzdG9tVmFyaWF0aW9ucykge1xuICAgICAgICAgICAgLy8gQWRkIGN1c3RvbSByZWFsIHZhcmlhdGlvbnMgKG9ubHkgaWYgZW5hYmxlZClcbiAgICAgICAgICAgIGNvbnN0IGN1c3RvbVJlYWxWYXJpYXRpb25zID0gcHJvZmlsZS5jdXN0b21WYXJpYXRpb25zLnJlYWxbcGlpVHlwZV0gfHwgW107XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHZhck9iaiBvZiBjdXN0b21SZWFsVmFyaWF0aW9ucykge1xuICAgICAgICAgICAgICBpZiAodmFyT2JqICYmIHZhck9iai5lbmFibGVkICYmXG4gICAgICAgICAgICAgICAgICB2YXJPYmoudmFsdWUgJiZcbiAgICAgICAgICAgICAgICAgIHZhck9iai52YWx1ZS50b0xvd2VyQ2FzZSgpICE9PSByZWFsVmFsdWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVhbFRvQWxpYXNNYXAuc2V0KHZhck9iai52YWx1ZS50b0xvd2VyQ2FzZSgpLCBtYXBwaW5nKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBBZGQgY3VzdG9tIGFsaWFzIHZhcmlhdGlvbnMgKG9ubHkgaWYgZW5hYmxlZClcbiAgICAgICAgICAgIGNvbnN0IGN1c3RvbUFsaWFzVmFyaWF0aW9ucyA9IHByb2ZpbGUuY3VzdG9tVmFyaWF0aW9ucy5hbGlhc1twaWlUeXBlXSB8fCBbXTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgdmFyT2JqIG9mIGN1c3RvbUFsaWFzVmFyaWF0aW9ucykge1xuICAgICAgICAgICAgICBpZiAodmFyT2JqICYmIHZhck9iai5lbmFibGVkICYmXG4gICAgICAgICAgICAgICAgICB2YXJPYmoudmFsdWUgJiZcbiAgICAgICAgICAgICAgICAgIHZhck9iai52YWx1ZS50b0xvd2VyQ2FzZSgpICE9PSBhbGlhc1ZhbHVlLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFsaWFzVG9SZWFsTWFwLnNldCh2YXJPYmoudmFsdWUudG9Mb3dlckNhc2UoKSwgbWFwcGluZyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gSGFuZGxlIGN1c3RvbSBmaWVsZHNcbiAgICAgIGlmIChwcm9maWxlLnJlYWwuY3VzdG9tICYmIHByb2ZpbGUuYWxpYXMuY3VzdG9tKSB7XG4gICAgICAgIGZvciAoY29uc3QgW2tleSwgcmVhbFZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhwcm9maWxlLnJlYWwuY3VzdG9tKSkge1xuICAgICAgICAgIGNvbnN0IGFsaWFzVmFsdWUgPSBwcm9maWxlLmFsaWFzLmN1c3RvbVtrZXldO1xuICAgICAgICAgIGlmIChyZWFsVmFsdWUgJiYgYWxpYXNWYWx1ZSkge1xuICAgICAgICAgICAgY29uc3QgbWFwcGluZzogUElJTWFwcGluZyA9IHtcbiAgICAgICAgICAgICAgcmVhbDogcmVhbFZhbHVlLFxuICAgICAgICAgICAgICBhbGlhczogYWxpYXNWYWx1ZSxcbiAgICAgICAgICAgICAgcHJvZmlsZUlkOiBwcm9maWxlLmlkLFxuICAgICAgICAgICAgICBwcm9maWxlTmFtZTogcHJvZmlsZS5wcm9maWxlTmFtZSxcbiAgICAgICAgICAgICAgcGlpVHlwZTogJ2N1c3RvbScsXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzLnJlYWxUb0FsaWFzTWFwLnNldChyZWFsVmFsdWUudG9Mb3dlckNhc2UoKSwgbWFwcGluZyk7XG4gICAgICAgICAgICB0aGlzLmFsaWFzVG9SZWFsTWFwLnNldChhbGlhc1ZhbHVlLnRvTG93ZXJDYXNlKCksIG1hcHBpbmcpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKCdbQWxpYXNFbmdpbmVdIEJ1aWx0IG1hcHM6JywgdGhpcy5yZWFsVG9BbGlhc01hcC5zaXplLCAncmVhbOKGkmFsaWFzIG1hcHBpbmdzICh3aXRoIHZhcmlhdGlvbnMpJyk7XG4gIH1cblxuICAvKipcbiAgICogTWFpbiBzdWJzdGl0dXRpb24gZnVuY3Rpb25cbiAgICogQHBhcmFtIHRleHQgLSBUZXh0IHRvIHByb2Nlc3NcbiAgICogQHBhcmFtIGRpcmVjdGlvbiAtICdlbmNvZGUnIChyZWFs4oaSYWxpYXMpIG9yICdkZWNvZGUnIChhbGlhc+KGknJlYWwpXG4gICAqIEBwYXJhbSBvcHRpb25zIC0gT3B0aW9uYWwgc3Vic3RpdHV0aW9uIG9wdGlvbnNcbiAgICovXG4gIHN1YnN0aXR1dGUoXG4gICAgdGV4dDogc3RyaW5nLFxuICAgIGRpcmVjdGlvbjogJ2VuY29kZScgfCAnZGVjb2RlJyxcbiAgICBvcHRpb25zPzogU3Vic3RpdHV0aW9uT3B0aW9uc1xuICApOiBTdWJzdGl0dXRpb25SZXN1bHQge1xuICAgIGNvbnN0IG1hcCA9IGRpcmVjdGlvbiA9PT0gJ2VuY29kZScgPyB0aGlzLnJlYWxUb0FsaWFzTWFwIDogdGhpcy5hbGlhc1RvUmVhbE1hcDtcblxuICAgIC8vIFJlbW92ZWQgdmVyYm9zZSBkZWNvZGUgbG9nZ2luZyBmb3IgcHJvZHVjdGlvbiAodG9vIG5vaXN5KVxuXG4gICAgY29uc3Qgc3Vic3RpdHV0aW9uczogQXJyYXk8e1xuICAgICAgZnJvbTogc3RyaW5nO1xuICAgICAgdG86IHN0cmluZztcbiAgICAgIHBvc2l0aW9uOiBudW1iZXI7XG4gICAgICBwcm9maWxlSWQ/OiBzdHJpbmc7XG4gICAgICBwaWlUeXBlPzogc3RyaW5nO1xuICAgIH0+ID0gW107XG5cbiAgICAvLyBUcmFjayB3aGljaCBwcm9maWxlcyB3ZXJlIG1hdGNoZWRcbiAgICBjb25zdCBwcm9maWxlTWF0Y2hlcyA9IG5ldyBNYXA8c3RyaW5nLCB7XG4gICAgICBwcm9maWxlSWQ6IHN0cmluZztcbiAgICAgIHByb2ZpbGVOYW1lOiBzdHJpbmc7XG4gICAgICBwaWlUeXBlczogU2V0PHN0cmluZz47XG4gICAgICBtYXRjaGVzOiBBcnJheTx7IHR5cGU6IHN0cmluZzsgdmFsdWU6IHN0cmluZzsgcG9zaXRpb246IG51bWJlciB9PjtcbiAgICB9PigpO1xuXG4gICAgbGV0IHJlc3VsdCA9IHRleHQ7XG5cbiAgICAvLyBTb3J0IGtleXMgYnkgbGVuZ3RoIChsb25nZXN0IGZpcnN0KSB0byBoYW5kbGUgb3ZlcmxhcHBpbmcgbWF0Y2hlc1xuICAgIGNvbnN0IHNvcnRlZEtleXMgPSBBcnJheS5mcm9tKG1hcC5rZXlzKCkpLnNvcnQoKGEsIGIpID0+IGIubGVuZ3RoIC0gYS5sZW5ndGgpO1xuXG4gICAgZm9yIChjb25zdCBrZXkgb2Ygc29ydGVkS2V5cykge1xuICAgICAgY29uc3QgbWFwcGluZyA9IG1hcC5nZXQoa2V5KTtcbiAgICAgIGlmICghbWFwcGluZykgY29udGludWU7XG5cbiAgICAgIC8vIEZpbHRlciBieSBwcm9maWxlIElEcyBpZiBzcGVjaWZpZWRcbiAgICAgIGlmIChvcHRpb25zPy5wcm9maWxlSWRzICYmICFvcHRpb25zLnByb2ZpbGVJZHMuaW5jbHVkZXMobWFwcGluZy5wcm9maWxlSWQpKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBjb25zdCByZXBsYWNlbWVudCA9IGRpcmVjdGlvbiA9PT0gJ2VuY29kZScgPyBtYXBwaW5nLmFsaWFzIDogbWFwcGluZy5yZWFsO1xuXG4gICAgICAvLyBDcmVhdGUgcmVnZXggd2l0aCB3b3JkIGJvdW5kYXJpZXNcbiAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgXFxcXGIke3RoaXMuZXNjYXBlUmVnZXgoa2V5KX1cXFxcYmAsICdnaScpO1xuICAgICAgbGV0IG1hdGNoO1xuXG4gICAgICAvLyBUcmFjayBhbGwgbWF0Y2hlcyBiZWZvcmUgcmVwbGFjaW5nXG4gICAgICBjb25zdCBtYXRjaGVzOiBBcnJheTx7IG1hdGNoOiBzdHJpbmc7IGluZGV4OiBudW1iZXIgfT4gPSBbXTtcbiAgICAgIHdoaWxlICgobWF0Y2ggPSByZWdleC5leGVjKHJlc3VsdCkpICE9PSBudWxsKSB7XG4gICAgICAgIG1hdGNoZXMucHVzaCh7IG1hdGNoOiBtYXRjaFswXSwgaW5kZXg6IG1hdGNoLmluZGV4IH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBSZXBsYWNlIGFsbCBtYXRjaGVzIHdpdGggY2FzZSBwcmVzZXJ2YXRpb24gKHJldmVyc2Ugb3JkZXIgdG8gcHJlc2VydmUgaW5kaWNlcylcbiAgICAgIGZvciAobGV0IGkgPSBtYXRjaGVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgIGNvbnN0IG0gPSBtYXRjaGVzW2ldO1xuICAgICAgICBjb25zdCBwcmVzZXJ2ZWQgPSB0aGlzLnByZXNlcnZlQ2FzZShtLm1hdGNoLCByZXBsYWNlbWVudCk7XG5cbiAgICAgICAgLy8gT25seSByZXBsYWNlIGlmIG1vZGUgaXMgJ2F1dG8nLCBvdGhlcndpc2UganVzdCBkZXRlY3RcbiAgICAgICAgaWYgKG9wdGlvbnM/Lm1vZGUgIT09ICdkZXRlY3Qtb25seScpIHtcbiAgICAgICAgICByZXN1bHQgPSByZXN1bHQuc3Vic3RyaW5nKDAsIG0uaW5kZXgpICsgcHJlc2VydmVkICsgcmVzdWx0LnN1YnN0cmluZyhtLmluZGV4ICsgbS5tYXRjaC5sZW5ndGgpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3Vic3RpdHV0aW9ucy5wdXNoKHtcbiAgICAgICAgICBmcm9tOiBtLm1hdGNoLFxuICAgICAgICAgIHRvOiBwcmVzZXJ2ZWQsXG4gICAgICAgICAgcG9zaXRpb246IG0uaW5kZXgsXG4gICAgICAgICAgcHJvZmlsZUlkOiBtYXBwaW5nLnByb2ZpbGVJZCxcbiAgICAgICAgICBwaWlUeXBlOiBtYXBwaW5nLnBpaVR5cGUsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFRyYWNrIHByb2ZpbGUgdXNhZ2VcbiAgICAgICAgaWYgKCFwcm9maWxlTWF0Y2hlcy5oYXMobWFwcGluZy5wcm9maWxlSWQpKSB7XG4gICAgICAgICAgcHJvZmlsZU1hdGNoZXMuc2V0KG1hcHBpbmcucHJvZmlsZUlkLCB7XG4gICAgICAgICAgICBwcm9maWxlSWQ6IG1hcHBpbmcucHJvZmlsZUlkLFxuICAgICAgICAgICAgcHJvZmlsZU5hbWU6IG1hcHBpbmcucHJvZmlsZU5hbWUsXG4gICAgICAgICAgICBwaWlUeXBlczogbmV3IFNldCgpLFxuICAgICAgICAgICAgbWF0Y2hlczogW10sXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwcm9maWxlTWF0Y2ggPSBwcm9maWxlTWF0Y2hlcy5nZXQobWFwcGluZy5wcm9maWxlSWQpITtcbiAgICAgICAgcHJvZmlsZU1hdGNoLnBpaVR5cGVzLmFkZChtYXBwaW5nLnBpaVR5cGUpO1xuICAgICAgICBwcm9maWxlTWF0Y2gubWF0Y2hlcy5wdXNoKHtcbiAgICAgICAgICB0eXBlOiBtYXBwaW5nLnBpaVR5cGUsXG4gICAgICAgICAgdmFsdWU6IG0ubWF0Y2gsXG4gICAgICAgICAgcG9zaXRpb246IG0uaW5kZXgsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhhbmRsZSBwb3NzZXNzaXZlcyAoZS5nLiwgXCJKb2Unc1wiIOKGkiBcIkpvaG4nc1wiKVxuICAgIGlmIChvcHRpb25zPy5tb2RlICE9PSAnZGV0ZWN0LW9ubHknKSB7XG4gICAgICByZXN1bHQgPSB0aGlzLmhhbmRsZVBvc3Nlc3NpdmVzKHJlc3VsdCwgbWFwLCBkaXJlY3Rpb24pO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB0ZXh0OiByZXN1bHQsXG4gICAgICBzdWJzdGl0dXRpb25zLFxuICAgICAgY29uZmlkZW5jZTogdGhpcy5jYWxjdWxhdGVDb25maWRlbmNlKHN1YnN0aXR1dGlvbnMubGVuZ3RoKSxcbiAgICAgIHByb2ZpbGVzTWF0Y2hlZDogQXJyYXkuZnJvbShwcm9maWxlTWF0Y2hlcy52YWx1ZXMoKSkubWFwKHBtID0+ICh7XG4gICAgICAgIHByb2ZpbGVJZDogcG0ucHJvZmlsZUlkLFxuICAgICAgICBwcm9maWxlTmFtZTogcG0ucHJvZmlsZU5hbWUsXG4gICAgICAgIHBpaVR5cGVzOiBBcnJheS5mcm9tKHBtLnBpaVR5cGVzKSxcbiAgICAgICAgbWF0Y2hlczogcG0ubWF0Y2hlcyxcbiAgICAgIH0pKSxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEZpbmQgUElJIGluIHRleHQgd2l0aG91dCBzdWJzdGl0dXRpbmdcbiAgICogVXNlZCBmb3IgaGlnaGxpZ2h0aW5nIGluIGNvbnRlbnQgc2NyaXB0XG4gICAqL1xuICBmaW5kUElJKHRleHQ6IHN0cmluZyk6IEFycmF5PHtcbiAgICB0ZXh0OiBzdHJpbmc7XG4gICAgc3RhcnQ6IG51bWJlcjtcbiAgICBlbmQ6IG51bWJlcjtcbiAgICBhbGlhczogc3RyaW5nO1xuICAgIHByb2ZpbGVJZDogc3RyaW5nO1xuICAgIHByb2ZpbGVOYW1lOiBzdHJpbmc7XG4gICAgcGlpVHlwZTogc3RyaW5nO1xuICB9PiB7XG4gICAgY29uc3QgbWF0Y2hlczogQXJyYXk8e1xuICAgICAgdGV4dDogc3RyaW5nO1xuICAgICAgc3RhcnQ6IG51bWJlcjtcbiAgICAgIGVuZDogbnVtYmVyO1xuICAgICAgYWxpYXM6IHN0cmluZztcbiAgICAgIHByb2ZpbGVJZDogc3RyaW5nO1xuICAgICAgcHJvZmlsZU5hbWU6IHN0cmluZztcbiAgICAgIHBpaVR5cGU6IHN0cmluZztcbiAgICB9PiA9IFtdO1xuXG4gICAgZm9yIChjb25zdCBbcmVhbFZhbHVlLCBtYXBwaW5nXSBvZiB0aGlzLnJlYWxUb0FsaWFzTWFwKSB7XG4gICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFxcXFxiJHt0aGlzLmVzY2FwZVJlZ2V4KHJlYWxWYWx1ZSl9XFxcXGJgLCAnZ2knKTtcbiAgICAgIGxldCBtYXRjaDtcblxuICAgICAgd2hpbGUgKChtYXRjaCA9IHJlZ2V4LmV4ZWModGV4dCkpICE9PSBudWxsKSB7XG4gICAgICAgIG1hdGNoZXMucHVzaCh7XG4gICAgICAgICAgdGV4dDogbWF0Y2hbMF0sXG4gICAgICAgICAgc3RhcnQ6IG1hdGNoLmluZGV4LFxuICAgICAgICAgIGVuZDogbWF0Y2guaW5kZXggKyBtYXRjaFswXS5sZW5ndGgsXG4gICAgICAgICAgYWxpYXM6IG1hcHBpbmcuYWxpYXMsXG4gICAgICAgICAgcHJvZmlsZUlkOiBtYXBwaW5nLnByb2ZpbGVJZCxcbiAgICAgICAgICBwcm9maWxlTmFtZTogbWFwcGluZy5wcm9maWxlTmFtZSxcbiAgICAgICAgICBwaWlUeXBlOiBtYXBwaW5nLnBpaVR5cGUsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBtYXRjaGVzO1xuICB9XG5cbiAgLyoqXG4gICAqIEVzY2FwZSBzcGVjaWFsIHJlZ2V4IGNoYXJhY3RlcnNcbiAgICovXG4gIHByaXZhdGUgZXNjYXBlUmVnZXgoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiBzdHIucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQcmVzZXJ2ZSBjYXNlIHBhdHRlcm4gZnJvbSBvcmlnaW5hbCB0byByZXBsYWNlbWVudFxuICAgKiBFeGFtcGxlczpcbiAgICogICBcIkpPRSBTTUlUSFwiIOKGkiBcIkpPSE4gRE9FXCJcbiAgICogICBcIkpvZSBTbWl0aFwiIOKGkiBcIkpvaG4gRG9lXCJcbiAgICogICBcImpvZSBzbWl0aFwiIOKGkiBcImpvaG4gZG9lXCJcbiAgICovXG4gIHByaXZhdGUgcHJlc2VydmVDYXNlKG9yaWdpbmFsOiBzdHJpbmcsIHJlcGxhY2VtZW50OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIC8vIEFsbCB1cHBlcmNhc2VcbiAgICBpZiAob3JpZ2luYWwgPT09IG9yaWdpbmFsLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgIHJldHVybiByZXBsYWNlbWVudC50b1VwcGVyQ2FzZSgpO1xuICAgIH1cblxuICAgIC8vIEFsbCBsb3dlcmNhc2VcbiAgICBpZiAob3JpZ2luYWwgPT09IG9yaWdpbmFsLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgIHJldHVybiByZXBsYWNlbWVudC50b0xvd2VyQ2FzZSgpO1xuICAgIH1cblxuICAgIC8vIFRpdGxlIGNhc2Ugb3IgbWl4ZWQgY2FzZVxuICAgIGNvbnN0IG9yaWdpbmFsV29yZHMgPSBvcmlnaW5hbC5zcGxpdCgnICcpO1xuICAgIGNvbnN0IHJlcGxhY2VtZW50V29yZHMgPSByZXBsYWNlbWVudC5zcGxpdCgnICcpO1xuXG4gICAgcmV0dXJuIHJlcGxhY2VtZW50V29yZHNcbiAgICAgIC5tYXAoKHdvcmQsIGkpID0+IHtcbiAgICAgICAgaWYgKGkgPj0gb3JpZ2luYWxXb3Jkcy5sZW5ndGgpIHJldHVybiB3b3JkO1xuXG4gICAgICAgIGNvbnN0IG9yaWdpbmFsV29yZCA9IG9yaWdpbmFsV29yZHNbaV07XG4gICAgICAgIGNvbnN0IGZpcnN0Q2hhciA9IG9yaWdpbmFsV29yZFswXTtcblxuICAgICAgICBpZiAoZmlyc3RDaGFyID09PSBmaXJzdENoYXIudG9VcHBlckNhc2UoKSkge1xuICAgICAgICAgIHJldHVybiB3b3JkLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgd29yZC5zbGljZSgxKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB3b3JkLnRvTG93ZXJDYXNlKCk7XG4gICAgICB9KVxuICAgICAgLmpvaW4oJyAnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGUgcG9zc2Vzc2l2ZSBmb3JtczogXCJKb2UncyBjYXJcIiDihpIgXCJKb2huJ3MgY2FyXCJcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlUG9zc2Vzc2l2ZXMoXG4gICAgdGV4dDogc3RyaW5nLFxuICAgIG1hcDogTWFwPHN0cmluZywgUElJTWFwcGluZz4sXG4gICAgZGlyZWN0aW9uOiAnZW5jb2RlJyB8ICdkZWNvZGUnXG4gICk6IHN0cmluZyB7XG4gICAgbGV0IHJlc3VsdCA9IHRleHQ7XG5cbiAgICBmb3IgKGNvbnN0IFtrZXksIG1hcHBpbmddIG9mIG1hcCkge1xuICAgICAgY29uc3QgdmFsdWUgPSBkaXJlY3Rpb24gPT09ICdlbmNvZGUnID8gbWFwcGluZy5hbGlhcyA6IG1hcHBpbmcucmVhbDtcbiAgICAgIGNvbnN0IHBvc3Nlc3NpdmVQYXR0ZXJuID0gbmV3IFJlZ0V4cChgXFxcXGIke3RoaXMuZXNjYXBlUmVnZXgoa2V5KX0nc1xcXFxiYCwgJ2dpJyk7XG4gICAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZShwb3NzZXNzaXZlUGF0dGVybiwgKG1hdGNoKSA9PiB7XG4gICAgICAgIGNvbnN0IHByZXNlcnZlZCA9IHRoaXMucHJlc2VydmVDYXNlKG1hdGNoLnJlcGxhY2UoLydzJC9pLCAnJyksIHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIGAke3ByZXNlcnZlZH0nc2A7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZSBjb25maWRlbmNlIHNjb3JlIGJhc2VkIG9uIHN1YnN0aXR1dGlvbnNcbiAgICovXG4gIHByaXZhdGUgY2FsY3VsYXRlQ29uZmlkZW5jZShzdWJzdGl0dXRpb25Db3VudDogbnVtYmVyKTogbnVtYmVyIHtcbiAgICAvLyBTaW1wbGUgY29uZmlkZW5jZSBjYWxjdWxhdGlvblxuICAgIC8vIEluIHByb2R1Y3Rpb24sIHRoaXMgd291bGQgYmUgbW9yZSBzb3BoaXN0aWNhdGVkXG4gICAgcmV0dXJuIHN1YnN0aXR1dGlvbkNvdW50ID4gMCA/IDAuOSA6IDEuMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgcHJvZmlsZSB1c2FnZSBzdGF0aXN0aWNzXG4gICAqL1xuICBhc3luYyB1cGRhdGVQcm9maWxlVXNhZ2UoXG4gICAgcHJvZmlsZUlkOiBzdHJpbmcsXG4gICAgc2VydmljZTogJ2NoYXRncHQnIHwgJ2NsYXVkZScgfCAnZ2VtaW5pJyxcbiAgICBwaWlUeXBlOiBQSUlUeXBlXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHN0b3JhZ2UgPSBTdG9yYWdlTWFuYWdlci5nZXRJbnN0YW5jZSgpO1xuICAgIGF3YWl0IHN0b3JhZ2UuaW5jcmVtZW50UHJvZmlsZVVzYWdlKHByb2ZpbGVJZCwgc2VydmljZSwgcGlpVHlwZSk7XG4gICAgaWYgKERFQlVHX01PREUpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdbQWxpYXNFbmdpbmVdIFVwZGF0ZWQgdXNhZ2UgZm9yIHByb2ZpbGU6JywgcHJvZmlsZUlkLCAnc2VydmljZTonLCBzZXJ2aWNlLCAndHlwZTonLCBwaWlUeXBlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGFsbCBlbmFibGVkIHByb2ZpbGVzXG4gICAqL1xuICBnZXRQcm9maWxlcygpOiBBbGlhc1Byb2ZpbGVbXSB7XG4gICAgcmV0dXJuIHRoaXMucHJvZmlsZXMuZmlsdGVyKHAgPT4gcC5lbmFibGVkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYSBzaW5nbGUgcHJvZmlsZSBieSBJRFxuICAgKi9cbiAgZ2V0UHJvZmlsZShpZDogc3RyaW5nKTogQWxpYXNQcm9maWxlIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5wcm9maWxlcy5maW5kKHAgPT4gcC5pZCA9PT0gaWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbG9hZCBwcm9maWxlcyBmcm9tIHN0b3JhZ2VcbiAgICovXG4gIGFzeW5jIHJlbG9hZCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCB0aGlzLmxvYWRQcm9maWxlcygpO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGVuZ2luZSBoYXMgYW55IHByb2ZpbGVzIGxvYWRlZFxuICAgKi9cbiAgaGFzUHJvZmlsZXMoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMucHJvZmlsZXMuZmlsdGVyKHAgPT4gcC5lbmFibGVkKS5sZW5ndGggPiAwO1xuICB9XG59XG4iLCIvKipcbiAqIEFQSSBLZXkgRGV0ZWN0aW9uIEVuZ2luZVxuICogRGV0ZWN0cyBjb21tb24gQVBJIGtleSBmb3JtYXRzIGluIHRleHRcbiAqL1xuXG5pbXBvcnQgeyBBUElLZXlGb3JtYXQgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBEZXRlY3RlZEtleSB7XG4gIHZhbHVlOiBzdHJpbmc7IC8vIFRoZSBhY3R1YWwga2V5IGZvdW5kXG4gIGZvcm1hdDogQVBJS2V5Rm9ybWF0O1xuICBzdGFydEluZGV4OiBudW1iZXI7XG4gIGVuZEluZGV4OiBudW1iZXI7XG4gIGxpbmVOdW1iZXI/OiBudW1iZXI7XG4gIGNvbnRleHQ/OiBzdHJpbmc7IC8vIFN1cnJvdW5kaW5nIHRleHQgZm9yIHByZXZpZXdcbn1cblxuZXhwb3J0IGNsYXNzIEFQSUtleURldGVjdG9yIHtcbiAgLy8gS25vd24gcGF0dGVybnMgKGFsd2F5cyBhY3RpdmUpXG4gIHByaXZhdGUgc3RhdGljIHBhdHRlcm5zOiBSZWNvcmQ8QVBJS2V5Rm9ybWF0LCBSZWdFeHA+ID0ge1xuICAgIG9wZW5haTogL3NrLShwcm9qLSk/W0EtWmEtejAtOV17NDgsfS9nLFxuICAgIGFudGhyb3BpYzogL3NrLWFudC1bQS1aYS16MC05LV17OTV9L2csXG4gICAgZ29vZ2xlOiAvQUl6YVtBLVphLXowLTlfLV17MzV9L2csXG4gICAgYXdzOiAvKEFLSUF8QVNJQSlbQS1aMC05XXsxNn0vZyxcbiAgICBnaXRodWI6IC9naFtwc11fW0EtWmEtejAtOV17MzZ9L2csXG4gICAgc3RyaXBlOiAvKHNrfHBrKV8obGl2ZXx0ZXN0KV9bQS1aYS16MC05XXsyNCx9L2csXG4gICAgZ2VuZXJpYzogL1xcYltBLUZhLWYwLTldezMyLH1cXGJ8XFxiW0EtWmEtejAtOSsvXXs0MCx9PXswLDJ9XFxiL2csIC8vIEhleCBvciBiYXNlNjRcbiAgICBjdXN0b206IC8uKi8sIC8vIFBsYWNlaG9sZGVyXG4gIH07XG5cbiAgLyoqXG4gICAqIFNjYW4gdGV4dCBmb3IgQVBJIGtleXNcbiAgICovXG4gIHN0YXRpYyBkZXRlY3QoXG4gICAgdGV4dDogc3RyaW5nLFxuICAgIG9wdGlvbnM6IHtcbiAgICAgIGluY2x1ZGVHZW5lcmljPzogYm9vbGVhbjsgLy8gSW5jbHVkZSBnZW5lcmljIGhleC9iYXNlNjQgKG5vaXN5KVxuICAgICAgY3VzdG9tUGF0dGVybnM/OiBSZWdFeHBbXTsgLy8gVXNlci1kZWZpbmVkIHBhdHRlcm5zXG4gICAgICBzdG9yZWRLZXlzPzogc3RyaW5nW107IC8vIFVzZXIncyB2YXVsdCBrZXlzIChleGFjdCBtYXRjaClcbiAgICB9ID0ge31cbiAgKTogRGV0ZWN0ZWRLZXlbXSB7XG4gICAgY29uc3QgZGV0ZWN0ZWQ6IERldGVjdGVkS2V5W10gPSBbXTtcblxuICAgIC8vIENoZWNrIGtub3duIHBhdHRlcm5zXG4gICAgZm9yIChjb25zdCBbZm9ybWF0LCBwYXR0ZXJuXSBvZiBPYmplY3QuZW50cmllcyh0aGlzLnBhdHRlcm5zKSkge1xuICAgICAgaWYgKGZvcm1hdCA9PT0gJ2dlbmVyaWMnICYmICFvcHRpb25zLmluY2x1ZGVHZW5lcmljKSBjb250aW51ZTtcbiAgICAgIGlmIChmb3JtYXQgPT09ICdjdXN0b20nKSBjb250aW51ZTtcblxuICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKHBhdHRlcm4uc291cmNlLCBwYXR0ZXJuLmZsYWdzKTtcbiAgICAgIGxldCBtYXRjaDtcbiAgICAgIHdoaWxlICgobWF0Y2ggPSByZWdleC5leGVjKHRleHQpKSAhPT0gbnVsbCkge1xuICAgICAgICBkZXRlY3RlZC5wdXNoKHtcbiAgICAgICAgICB2YWx1ZTogbWF0Y2hbMF0sXG4gICAgICAgICAgZm9ybWF0OiBmb3JtYXQgYXMgQVBJS2V5Rm9ybWF0LFxuICAgICAgICAgIHN0YXJ0SW5kZXg6IG1hdGNoLmluZGV4LFxuICAgICAgICAgIGVuZEluZGV4OiBtYXRjaC5pbmRleCArIG1hdGNoWzBdLmxlbmd0aCxcbiAgICAgICAgICBjb250ZXh0OiB0aGlzLmdldENvbnRleHQodGV4dCwgbWF0Y2guaW5kZXgsIG1hdGNoWzBdLmxlbmd0aCksXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIENoZWNrIGN1c3RvbSBwYXR0ZXJuc1xuICAgIGlmIChvcHRpb25zLmN1c3RvbVBhdHRlcm5zKSB7XG4gICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2Ygb3B0aW9ucy5jdXN0b21QYXR0ZXJucykge1xuICAgICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAocGF0dGVybiwgJ2cnKTtcbiAgICAgICAgbGV0IG1hdGNoO1xuICAgICAgICB3aGlsZSAoKG1hdGNoID0gcmVnZXguZXhlYyh0ZXh0KSkgIT09IG51bGwpIHtcbiAgICAgICAgICBkZXRlY3RlZC5wdXNoKHtcbiAgICAgICAgICAgIHZhbHVlOiBtYXRjaFswXSxcbiAgICAgICAgICAgIGZvcm1hdDogJ2N1c3RvbScsXG4gICAgICAgICAgICBzdGFydEluZGV4OiBtYXRjaC5pbmRleCxcbiAgICAgICAgICAgIGVuZEluZGV4OiBtYXRjaC5pbmRleCArIG1hdGNoWzBdLmxlbmd0aCxcbiAgICAgICAgICAgIGNvbnRleHQ6IHRoaXMuZ2V0Q29udGV4dCh0ZXh0LCBtYXRjaC5pbmRleCwgbWF0Y2hbMF0ubGVuZ3RoKSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIENoZWNrIGV4YWN0IG1hdGNoZXMgZnJvbSB2YXVsdFxuICAgIGlmIChvcHRpb25zLnN0b3JlZEtleXMpIHtcbiAgICAgIGZvciAoY29uc3Qga2V5IG9mIG9wdGlvbnMuc3RvcmVkS2V5cykge1xuICAgICAgICBjb25zdCBpbmRleCA9IHRleHQuaW5kZXhPZihrZXkpO1xuICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgZGV0ZWN0ZWQucHVzaCh7XG4gICAgICAgICAgICB2YWx1ZToga2V5LFxuICAgICAgICAgICAgZm9ybWF0OiB0aGlzLmRldGVjdEZvcm1hdChrZXkpLFxuICAgICAgICAgICAgc3RhcnRJbmRleDogaW5kZXgsXG4gICAgICAgICAgICBlbmRJbmRleDogaW5kZXggKyBrZXkubGVuZ3RoLFxuICAgICAgICAgICAgY29udGV4dDogdGhpcy5nZXRDb250ZXh0KHRleHQsIGluZGV4LCBrZXkubGVuZ3RoKSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIChzYW1lIHBvc2l0aW9uKVxuICAgIHJldHVybiB0aGlzLmRlZHVwbGljYXRlS2V5cyhkZXRlY3RlZCk7XG4gIH1cblxuICAvKipcbiAgICogUmVkYWN0IGRldGVjdGVkIGtleXNcbiAgICovXG4gIHN0YXRpYyByZWRhY3QoXG4gICAgdGV4dDogc3RyaW5nLFxuICAgIGRldGVjdGVkS2V5czogRGV0ZWN0ZWRLZXlbXSxcbiAgICBtb2RlOiAnZnVsbCcgfCAncGFydGlhbCcgfCAncGxhY2Vob2xkZXInID0gJ2Z1bGwnXG4gICk6IHN0cmluZyB7XG4gICAgLy8gU29ydCBieSBzdGFydEluZGV4IGRlc2NlbmRpbmcgKHJlZGFjdCBmcm9tIGVuZCB0byBhdm9pZCBvZmZzZXQgaXNzdWVzKVxuICAgIGNvbnN0IHNvcnRlZCA9IFsuLi5kZXRlY3RlZEtleXNdLnNvcnQoKGEsIGIpID0+IGIuc3RhcnRJbmRleCAtIGEuc3RhcnRJbmRleCk7XG5cbiAgICBsZXQgcmVzdWx0ID0gdGV4dDtcbiAgICBmb3IgKGNvbnN0IGtleSBvZiBzb3J0ZWQpIHtcbiAgICAgIGxldCByZXBsYWNlbWVudDogc3RyaW5nO1xuXG4gICAgICBzd2l0Y2ggKG1vZGUpIHtcbiAgICAgICAgY2FzZSAnZnVsbCc6XG4gICAgICAgICAgcmVwbGFjZW1lbnQgPSAnW1JFREFDVEVEX0FQSV9LRVldJztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAncGFydGlhbCc6IHtcbiAgICAgICAgICAvLyBTaG93IGZpcnN0IDQgYW5kIGxhc3QgNCBjaGFyc1xuICAgICAgICAgIGNvbnN0IHZpc2libGUgPSA0O1xuICAgICAgICAgIGNvbnN0IHN0YXJ0ID0ga2V5LnZhbHVlLnN1YnN0cmluZygwLCB2aXNpYmxlKTtcbiAgICAgICAgICBjb25zdCBlbmQgPSBrZXkudmFsdWUuc3Vic3RyaW5nKGtleS52YWx1ZS5sZW5ndGggLSB2aXNpYmxlKTtcbiAgICAgICAgICByZXBsYWNlbWVudCA9IGAke3N0YXJ0fSR7J+KAoicucmVwZWF0KE1hdGgubWF4KDAsIGtleS52YWx1ZS5sZW5ndGggLSB2aXNpYmxlICogMikpfSR7ZW5kfWA7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAncGxhY2Vob2xkZXInOlxuICAgICAgICAgIHJlcGxhY2VtZW50ID0gYFske2tleS5mb3JtYXQudG9VcHBlckNhc2UoKX1fS0VZXWA7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIHJlc3VsdCA9IHJlc3VsdC5zdWJzdHJpbmcoMCwga2V5LnN0YXJ0SW5kZXgpICsgcmVwbGFjZW1lbnQgKyByZXN1bHQuc3Vic3RyaW5nKGtleS5lbmRJbmRleCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXRlY3QgZm9ybWF0IGZyb20ga2V5IHZhbHVlXG4gICAqL1xuICBzdGF0aWMgZGV0ZWN0Rm9ybWF0KGtleTogc3RyaW5nKTogQVBJS2V5Rm9ybWF0IHtcbiAgICBmb3IgKGNvbnN0IFtmb3JtYXQsIHBhdHRlcm5dIG9mIE9iamVjdC5lbnRyaWVzKHRoaXMucGF0dGVybnMpKSB7XG4gICAgICBpZiAoZm9ybWF0ID09PSAnY3VzdG9tJykgY29udGludWU7XG4gICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAocGF0dGVybi5zb3VyY2UpO1xuICAgICAgaWYgKHJlZ2V4LnRlc3Qoa2V5KSkge1xuICAgICAgICByZXR1cm4gZm9ybWF0IGFzIEFQSUtleUZvcm1hdDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuICdnZW5lcmljJztcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgc3Vycm91bmRpbmcgY29udGV4dCBmb3IgcHJldmlld1xuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgZ2V0Q29udGV4dCh0ZXh0OiBzdHJpbmcsIGluZGV4OiBudW1iZXIsIGxlbmd0aDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBjb25zdCBzdGFydCA9IE1hdGgubWF4KDAsIGluZGV4IC0gMzApO1xuICAgIGNvbnN0IGVuZCA9IE1hdGgubWluKHRleHQubGVuZ3RoLCBpbmRleCArIGxlbmd0aCArIDMwKTtcbiAgICByZXR1cm4gdGV4dC5zdWJzdHJpbmcoc3RhcnQsIGVuZCk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGR1cGxpY2F0ZSBkZXRlY3Rpb25zIChzYW1lIGtleSBhdCBzYW1lIHBvc2l0aW9uKVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgZGVkdXBsaWNhdGVLZXlzKGtleXM6IERldGVjdGVkS2V5W10pOiBEZXRlY3RlZEtleVtdIHtcbiAgICBjb25zdCBzZWVuID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgcmV0dXJuIGtleXMuZmlsdGVyKChrZXkpID0+IHtcbiAgICAgIGNvbnN0IGlkID0gYCR7a2V5LnN0YXJ0SW5kZXh9LSR7a2V5LmVuZEluZGV4fWA7XG4gICAgICBpZiAoc2Vlbi5oYXMoaWQpKSByZXR1cm4gZmFsc2U7XG4gICAgICBzZWVuLmFkZChpZCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KTtcbiAgfVxufVxuIiwiLyoqXG4gKiBSZWRhY3Rpb24gRW5naW5lXG4gKiBBcHBsaWVzIGN1c3RvbSByZWRhY3Rpb24gcnVsZXMgdG8gdGV4dCBiYXNlZCBvbiB1c2VyLWRlZmluZWQgcGF0dGVybnNcbiAqL1xuXG5pbXBvcnQgeyBDdXN0b21SdWxlIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVkYWN0aW9uTWF0Y2gge1xuICBydWxlSWQ6IHN0cmluZztcbiAgcnVsZU5hbWU6IHN0cmluZztcbiAgbWF0Y2g6IHN0cmluZztcbiAgcmVwbGFjZW1lbnQ6IHN0cmluZztcbiAgc3RhcnRJbmRleDogbnVtYmVyO1xuICBlbmRJbmRleDogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlZGFjdGlvblJlc3VsdCB7XG4gIG1vZGlmaWVkVGV4dDogc3RyaW5nO1xuICBtYXRjaGVzOiBSZWRhY3Rpb25NYXRjaFtdO1xuICBydWxlc0FwcGxpZWQ6IHN0cmluZ1tdOyAvLyBSdWxlIElEcyB0aGF0IG1hdGNoZWRcbn1cblxuLyoqXG4gKiBSZWRhY3Rpb24gRW5naW5lIENsYXNzXG4gKiBIYW5kbGVzIHBhdHRlcm4gbWF0Y2hpbmcgYW5kIHRleHQgcmVwbGFjZW1lbnQgYmFzZWQgb24gY3VzdG9tIHJ1bGVzXG4gKi9cbmV4cG9ydCBjbGFzcyBSZWRhY3Rpb25FbmdpbmUge1xuICBwcml2YXRlIGNvbXBpbGVkUnVsZXM6IE1hcDxzdHJpbmcsIFJlZ0V4cD4gPSBuZXcgTWFwKCk7XG5cbiAgLyoqXG4gICAqIENvbXBpbGUgcnVsZXMgaW50byByZWdleCBwYXR0ZXJuc1xuICAgKi9cbiAgY29tcGlsZVJ1bGVzKHJ1bGVzOiBDdXN0b21SdWxlW10pOiB2b2lkIHtcbiAgICB0aGlzLmNvbXBpbGVkUnVsZXMuY2xlYXIoKTtcblxuICAgIC8vIFNvcnQgcnVsZXMgYnkgcHJpb3JpdHkgKGhpZ2hlc3QgZmlyc3QpXG4gICAgY29uc3Qgc29ydGVkUnVsZXMgPSBydWxlc1xuICAgICAgLmZpbHRlcihydWxlID0+IHJ1bGUuZW5hYmxlZClcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBiLnByaW9yaXR5IC0gYS5wcmlvcml0eSk7XG5cbiAgICBmb3IgKGNvbnN0IHJ1bGUgb2Ygc29ydGVkUnVsZXMpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIENvbXBpbGUgcGF0dGVybiB3aXRoIGdsb2JhbCBmbGFnIGZvciBtdWx0aXBsZSBtYXRjaGVzXG4gICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChydWxlLnBhdHRlcm4sICdnJyk7XG4gICAgICAgIHRoaXMuY29tcGlsZWRSdWxlcy5zZXQocnVsZS5pZCwgcmVnZXgpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihgW1JlZGFjdGlvbiBFbmdpbmVdIEZhaWxlZCB0byBjb21waWxlIHJ1bGUgXCIke3J1bGUubmFtZX1cIjpgLCBlcnJvcik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYFtSZWRhY3Rpb24gRW5naW5lXSBDb21waWxlZCAke3RoaXMuY29tcGlsZWRSdWxlcy5zaXplfSBydWxlc2ApO1xuICB9XG5cbiAgLyoqXG4gICAqIEFwcGx5IHJlZGFjdGlvbiBydWxlcyB0byB0ZXh0XG4gICAqL1xuICBhcHBseVJ1bGVzKHRleHQ6IHN0cmluZywgcnVsZXM6IEN1c3RvbVJ1bGVbXSk6IFJlZGFjdGlvblJlc3VsdCB7XG4gICAgaWYgKCF0ZXh0IHx8IHJ1bGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbW9kaWZpZWRUZXh0OiB0ZXh0LFxuICAgICAgICBtYXRjaGVzOiBbXSxcbiAgICAgICAgcnVsZXNBcHBsaWVkOiBbXVxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBSZWNvbXBpbGUgaWYgbmVlZGVkXG4gICAgaWYgKHRoaXMuY29tcGlsZWRSdWxlcy5zaXplID09PSAwKSB7XG4gICAgICB0aGlzLmNvbXBpbGVSdWxlcyhydWxlcyk7XG4gICAgfVxuXG4gICAgY29uc3QgbWF0Y2hlczogUmVkYWN0aW9uTWF0Y2hbXSA9IFtdO1xuICAgIGNvbnN0IHJ1bGVzQXBwbGllZDogU2V0PHN0cmluZz4gPSBuZXcgU2V0KCk7XG4gICAgbGV0IG1vZGlmaWVkVGV4dCA9IHRleHQ7XG5cbiAgICAvLyBTb3J0IHJ1bGVzIGJ5IHByaW9yaXR5IChoaWdoZXN0IGZpcnN0KVxuICAgIGNvbnN0IHNvcnRlZFJ1bGVzID0gcnVsZXNcbiAgICAgIC5maWx0ZXIocnVsZSA9PiBydWxlLmVuYWJsZWQpXG4gICAgICAuc29ydCgoYSwgYikgPT4gYi5wcmlvcml0eSAtIGEucHJpb3JpdHkpO1xuXG4gICAgLy8gQXBwbHkgZWFjaCBydWxlIHNlcXVlbnRpYWxseVxuICAgIGZvciAoY29uc3QgcnVsZSBvZiBzb3J0ZWRSdWxlcykge1xuICAgICAgY29uc3QgcmVnZXggPSB0aGlzLmNvbXBpbGVkUnVsZXMuZ2V0KHJ1bGUuaWQpO1xuICAgICAgaWYgKCFyZWdleCkgY29udGludWU7XG5cbiAgICAgIC8vIFJlc2V0IHJlZ2V4IGxhc3RJbmRleFxuICAgICAgcmVnZXgubGFzdEluZGV4ID0gMDtcblxuICAgICAgbGV0IG1hdGNoOiBSZWdFeHBFeGVjQXJyYXkgfCBudWxsO1xuICAgICAgY29uc3QgcnVsZU1hdGNoZXM6IFJlZGFjdGlvbk1hdGNoW10gPSBbXTtcblxuICAgICAgLy8gRmluZCBhbGwgbWF0Y2hlcyBmb3IgdGhpcyBydWxlXG4gICAgICB3aGlsZSAoKG1hdGNoID0gcmVnZXguZXhlYyhtb2RpZmllZFRleHQpKSAhPT0gbnVsbCkge1xuICAgICAgICBjb25zdCBvcmlnaW5hbE1hdGNoID0gbWF0Y2hbMF07XG4gICAgICAgIGNvbnN0IHJlcGxhY2VtZW50ID0gdGhpcy5wcm9jZXNzUmVwbGFjZW1lbnQocnVsZS5yZXBsYWNlbWVudCwgbWF0Y2gpO1xuXG4gICAgICAgIHJ1bGVNYXRjaGVzLnB1c2goe1xuICAgICAgICAgIHJ1bGVJZDogcnVsZS5pZCxcbiAgICAgICAgICBydWxlTmFtZTogcnVsZS5uYW1lLFxuICAgICAgICAgIG1hdGNoOiBvcmlnaW5hbE1hdGNoLFxuICAgICAgICAgIHJlcGxhY2VtZW50LFxuICAgICAgICAgIHN0YXJ0SW5kZXg6IG1hdGNoLmluZGV4LFxuICAgICAgICAgIGVuZEluZGV4OiBtYXRjaC5pbmRleCArIG9yaWdpbmFsTWF0Y2gubGVuZ3RoXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJ1bGVzQXBwbGllZC5hZGQocnVsZS5pZCk7XG4gICAgICB9XG5cbiAgICAgIC8vIEFwcGx5IHJlcGxhY2VtZW50cyBmb3IgdGhpcyBydWxlIChpbiByZXZlcnNlIG9yZGVyIHRvIHByZXNlcnZlIGluZGljZXMpXG4gICAgICBmb3IgKGxldCBpID0gcnVsZU1hdGNoZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgY29uc3QgcnVsZU1hdGNoID0gcnVsZU1hdGNoZXNbaV07XG4gICAgICAgIG1vZGlmaWVkVGV4dCA9XG4gICAgICAgICAgbW9kaWZpZWRUZXh0LnNsaWNlKDAsIHJ1bGVNYXRjaC5zdGFydEluZGV4KSArXG4gICAgICAgICAgcnVsZU1hdGNoLnJlcGxhY2VtZW50ICtcbiAgICAgICAgICBtb2RpZmllZFRleHQuc2xpY2UocnVsZU1hdGNoLmVuZEluZGV4KTtcbiAgICAgIH1cblxuICAgICAgbWF0Y2hlcy5wdXNoKC4uLnJ1bGVNYXRjaGVzKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgbW9kaWZpZWRUZXh0LFxuICAgICAgbWF0Y2hlcyxcbiAgICAgIHJ1bGVzQXBwbGllZDogQXJyYXkuZnJvbShydWxlc0FwcGxpZWQpXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQcm9jZXNzIHJlcGxhY2VtZW50IHN0cmluZyAoc3VwcG9ydHMgJDEsICQyLCBldGMuIGZvciBjYXB0dXJlIGdyb3VwcylcbiAgICovXG4gIHByaXZhdGUgcHJvY2Vzc1JlcGxhY2VtZW50KHJlcGxhY2VtZW50OiBzdHJpbmcsIG1hdGNoOiBSZWdFeHBFeGVjQXJyYXkpOiBzdHJpbmcge1xuICAgIGxldCByZXN1bHQgPSByZXBsYWNlbWVudDtcblxuICAgIC8vIFJlcGxhY2UgJDEsICQyLCBldGMuIHdpdGggY2FwdHVyZWQgZ3JvdXBzXG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPCBtYXRjaC5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgY2FwdHVyZUdyb3VwID0gbWF0Y2hbaV0gfHwgJyc7XG4gICAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZShuZXcgUmVnRXhwKGBcXFxcJCR7aX1gLCAnZycpLCBjYXB0dXJlR3JvdXApO1xuICAgIH1cblxuICAgIC8vIFJlcGxhY2UgJCYgd2l0aCBmdWxsIG1hdGNoXG4gICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UoL1xcJCYvZywgbWF0Y2hbMF0pO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBhIHJlZ2V4IHBhdHRlcm5cbiAgICovXG4gIHN0YXRpYyB2YWxpZGF0ZVBhdHRlcm4ocGF0dGVybjogc3RyaW5nKTogeyB2YWxpZDogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmcgfSB7XG4gICAgdHJ5IHtcbiAgICAgIG5ldyBSZWdFeHAocGF0dGVybik7XG4gICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdJbnZhbGlkIHJlZ2V4IHBhdHRlcm4nXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBUZXN0IGEgcnVsZSBhZ2FpbnN0IHNhbXBsZSB0ZXh0XG4gICAqL1xuICBzdGF0aWMgdGVzdFJ1bGUoXG4gICAgcnVsZTogQ3VzdG9tUnVsZSxcbiAgICB0ZXN0VGV4dDogc3RyaW5nXG4gICk6IHsgbWF0Y2hlczogc3RyaW5nW107IHJlcGxhY2VtZW50czogc3RyaW5nW107IGVycm9yPzogc3RyaW5nIH0ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAocnVsZS5wYXR0ZXJuLCAnZycpO1xuICAgICAgY29uc3QgbWF0Y2hlczogc3RyaW5nW10gPSBbXTtcbiAgICAgIGNvbnN0IHJlcGxhY2VtZW50czogc3RyaW5nW10gPSBbXTtcblxuICAgICAgbGV0IG1hdGNoOiBSZWdFeHBFeGVjQXJyYXkgfCBudWxsO1xuICAgICAgd2hpbGUgKChtYXRjaCA9IHJlZ2V4LmV4ZWModGVzdFRleHQpKSAhPT0gbnVsbCkge1xuICAgICAgICBtYXRjaGVzLnB1c2gobWF0Y2hbMF0pO1xuXG4gICAgICAgIC8vIFByb2Nlc3MgcmVwbGFjZW1lbnRcbiAgICAgICAgbGV0IHJlcGxhY2VtZW50ID0gcnVsZS5yZXBsYWNlbWVudDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBtYXRjaC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHJlcGxhY2VtZW50ID0gcmVwbGFjZW1lbnQucmVwbGFjZShuZXcgUmVnRXhwKGBcXFxcJCR7aX1gLCAnZycpLCBtYXRjaFtpXSB8fCAnJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmVwbGFjZW1lbnQgPSByZXBsYWNlbWVudC5yZXBsYWNlKC9cXCQmL2csIG1hdGNoWzBdKTtcbiAgICAgICAgcmVwbGFjZW1lbnRzLnB1c2gocmVwbGFjZW1lbnQpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4geyBtYXRjaGVzLCByZXBsYWNlbWVudHMgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbWF0Y2hlczogW10sXG4gICAgICAgIHJlcGxhY2VtZW50czogW10sXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdUZXN0IGZhaWxlZCdcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIERldGVjdCBwb3RlbnRpYWwgY29uZmxpY3RzIGJldHdlZW4gcnVsZXNcbiAgICovXG4gIHN0YXRpYyBkZXRlY3RDb25mbGljdHMocnVsZXM6IEN1c3RvbVJ1bGVbXSk6IHsgcnVsZTE6IHN0cmluZzsgcnVsZTI6IHN0cmluZzsgcmVhc29uOiBzdHJpbmcgfVtdIHtcbiAgICBjb25zdCBjb25mbGljdHM6IHsgcnVsZTE6IHN0cmluZzsgcnVsZTI6IHN0cmluZzsgcmVhc29uOiBzdHJpbmcgfVtdID0gW107XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJ1bGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBmb3IgKGxldCBqID0gaSArIDE7IGogPCBydWxlcy5sZW5ndGg7IGorKykge1xuICAgICAgICBjb25zdCBydWxlMSA9IHJ1bGVzW2ldO1xuICAgICAgICBjb25zdCBydWxlMiA9IHJ1bGVzW2pdO1xuXG4gICAgICAgIC8vIENoZWNrIGlmIHBhdHRlcm5zIG1pZ2h0IG92ZXJsYXBcbiAgICAgICAgaWYgKHRoaXMucGF0dGVybnNPdmVybGFwKHJ1bGUxLnBhdHRlcm4sIHJ1bGUyLnBhdHRlcm4pKSB7XG4gICAgICAgICAgY29uZmxpY3RzLnB1c2goe1xuICAgICAgICAgICAgcnVsZTE6IHJ1bGUxLm5hbWUsXG4gICAgICAgICAgICBydWxlMjogcnVsZTIubmFtZSxcbiAgICAgICAgICAgIHJlYXNvbjogJ1BhdHRlcm5zIG1heSBvdmVybGFwIC0gY29uc2lkZXIgYWRqdXN0aW5nIHByaW9yaXRpZXMnXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gY29uZmxpY3RzO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIHR3byBwYXR0ZXJucyBtaWdodCBvdmVybGFwIChiYXNpYyBoZXVyaXN0aWMpXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBwYXR0ZXJuc092ZXJsYXAocGF0dGVybjE6IHN0cmluZywgcGF0dGVybjI6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIC8vIFZlcnkgYmFzaWMgY2hlY2sgLSBjb3VsZCBiZSBlbmhhbmNlZFxuICAgIC8vIEZvciBub3csIGp1c3QgY2hlY2sgaWYgcGF0dGVybnMgYXJlIGlkZW50aWNhbFxuICAgIHJldHVybiBwYXR0ZXJuMSA9PT0gcGF0dGVybjI7XG4gIH1cbn1cblxuLy8gRXhwb3J0IHNpbmdsZXRvbiBpbnN0YW5jZVxuZXhwb3J0IGNvbnN0IHJlZGFjdGlvbkVuZ2luZSA9IG5ldyBSZWRhY3Rpb25FbmdpbmUoKTtcbiIsIi8qKlxuICogQmFkZ2UgTWFuYWdlclxuICogSGFuZGxlcyBleHRlbnNpb24gYmFkZ2UgdXBkYXRlcyBiYXNlZCBvbiBwcm90ZWN0aW9uIHN0YXRlXG4gKi9cblxuaW1wb3J0IHsgU3RvcmFnZU1hbmFnZXIgfSBmcm9tICcuLi8uLi9saWIvc3RvcmFnZSc7XG5pbXBvcnQgeyBDb250ZW50U2NyaXB0TWFuYWdlciB9IGZyb20gJy4vQ29udGVudFNjcmlwdE1hbmFnZXInO1xuXG4vKipcbiAqIFByb3RlY3Rpb24gc3RhdGUgZm9yIGJhZGdlIGRpc3BsYXlcbiAqL1xuZXhwb3J0IHR5cGUgUHJvdGVjdGlvblN0YXRlID0gJ3Byb3RlY3RlZCcgfCAndW5wcm90ZWN0ZWQnIHwgJ2Rpc2FibGVkJztcblxuLyoqXG4gKiBEZWJ1ZyBtb2RlIC0gc2V0IHRvIGZhbHNlIGZvciBwcm9kdWN0aW9uIHRvIHJlZHVjZSBsb2cgc3BhbVxuICovXG5jb25zdCBERUJVR19NT0RFID0gZmFsc2U7XG5cbmV4cG9ydCBjbGFzcyBCYWRnZU1hbmFnZXIge1xuICAvKipcbiAgICogQUkgc2VydmljZSBVUkwgcGF0dGVybnMgZm9yIHByb3RlY3Rpb24gZGV0ZWN0aW9uXG4gICAqL1xuICBzdGF0aWMgcmVhZG9ubHkgQUlfU0VSVklDRV9VUkxTID0gW1xuICAgICdjaGF0Z3B0LmNvbScsXG4gICAgJ29wZW5haS5jb20nLFxuICAgICdjbGF1ZGUuYWknLFxuICAgICdnZW1pbmkuZ29vZ2xlLmNvbScsXG4gICAgJ3BlcnBsZXhpdHkuYWknLFxuICAgICdjb3BpbG90Lm1pY3Jvc29mdC5jb20nLFxuICBdO1xuXG4gIC8qKlxuICAgKiBUcmFjayBsYXN0IGJhZGdlIHN0YXRlIHBlciB0YWIgdG8gYXZvaWQgbG9nIHNwYW1cbiAgICovXG4gIHByaXZhdGUgYmFkZ2VTdGF0ZUNhY2hlID0gbmV3IE1hcDxudW1iZXIsIFByb3RlY3Rpb25TdGF0ZT4oKTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHN0b3JhZ2U6IFN0b3JhZ2VNYW5hZ2VyLFxuICAgIHByaXZhdGUgY29udGVudFNjcmlwdE1hbmFnZXI6IENvbnRlbnRTY3JpcHRNYW5hZ2VyXG4gICkge31cblxuICAvKipcbiAgICogQ2hlY2sgaWYgVVJMIGlzIGFuIEFJIHNlcnZpY2VcbiAgICovXG4gIGlzQUlTZXJ2aWNlVVJMKHVybDogc3RyaW5nIHwgdW5kZWZpbmVkKTogYm9vbGVhbiB7XG4gICAgaWYgKCF1cmwpIHJldHVybiBmYWxzZTtcbiAgICByZXR1cm4gQmFkZ2VNYW5hZ2VyLkFJX1NFUlZJQ0VfVVJMUy5zb21lKGRvbWFpbiA9PiB1cmwuaW5jbHVkZXMoZG9tYWluKSk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIGV4dGVuc2lvbiBiYWRnZSBiYXNlZCBvbiBwcm90ZWN0aW9uIHN0YXRlXG4gICAqL1xuICBhc3luYyB1cGRhdGVCYWRnZSh0YWJJZDogbnVtYmVyLCBzdGF0ZTogUHJvdGVjdGlvblN0YXRlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIENoZWNrIGlmIHN0YXRlIGNoYW5nZWQgKG9ubHkgbG9nIGNoYW5nZXMsIG5vdCBldmVyeSBoZWFsdGggY2hlY2spXG4gICAgICBjb25zdCBsYXN0U3RhdGUgPSB0aGlzLmJhZGdlU3RhdGVDYWNoZS5nZXQodGFiSWQpO1xuICAgICAgY29uc3Qgc3RhdGVDaGFuZ2VkID0gbGFzdFN0YXRlICE9PSBzdGF0ZTtcblxuICAgICAgaWYgKHN0YXRlQ2hhbmdlZCkge1xuICAgICAgICB0aGlzLmJhZGdlU3RhdGVDYWNoZS5zZXQodGFiSWQsIHN0YXRlKTtcbiAgICAgIH1cblxuICAgICAgc3dpdGNoIChzdGF0ZSkge1xuICAgICAgICBjYXNlICdwcm90ZWN0ZWQnOlxuICAgICAgICAgIGF3YWl0IGNocm9tZS5hY3Rpb24uc2V0QmFkZ2VUZXh0KHsgdGFiSWQsIHRleHQ6ICfinJMnIH0pO1xuICAgICAgICAgIGF3YWl0IGNocm9tZS5hY3Rpb24uc2V0QmFkZ2VCYWNrZ3JvdW5kQ29sb3IoeyB0YWJJZCwgY29sb3I6ICcjMTBCOTgxJyB9KTsgLy8gR3JlZW5cbiAgICAgICAgICBhd2FpdCBjaHJvbWUuYWN0aW9uLnNldFRpdGxlKHsgdGFiSWQsIHRpdGxlOiAnQUkgUElJIFNhbml0aXplciAtIFByb3RlY3RlZCDinJMnIH0pO1xuICAgICAgICAgIGlmIChERUJVR19NT0RFIHx8IHN0YXRlQ2hhbmdlZCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFtCYWRnZU1hbmFnZXJdIFRhYiAke3RhYklkfTogUFJPVEVDVEVEIChHcmVlbilgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAndW5wcm90ZWN0ZWQnOlxuICAgICAgICAgIGF3YWl0IGNocm9tZS5hY3Rpb24uc2V0QmFkZ2VUZXh0KHsgdGFiSWQsIHRleHQ6ICchJyB9KTtcbiAgICAgICAgICBhd2FpdCBjaHJvbWUuYWN0aW9uLnNldEJhZGdlQmFja2dyb3VuZENvbG9yKHsgdGFiSWQsIGNvbG9yOiAnI0VGNDQ0NCcgfSk7IC8vIFJlZFxuICAgICAgICAgIGF3YWl0IGNocm9tZS5hY3Rpb24uc2V0VGl0bGUoeyB0YWJJZCwgdGl0bGU6ICdBSSBQSUkgU2FuaXRpemVyIC0gTk9UIFBST1RFQ1RFRCEgQ2xpY2sgdG8gcmVsb2FkIHBhZ2UnIH0pO1xuICAgICAgICAgIGlmIChERUJVR19NT0RFIHx8IHN0YXRlQ2hhbmdlZCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFtCYWRnZU1hbmFnZXJdIFRhYiAke3RhYklkfTogVU5QUk9URUNURUQgKFJlZClgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnZGlzYWJsZWQnOlxuICAgICAgICAgIGF3YWl0IGNocm9tZS5hY3Rpb24uc2V0QmFkZ2VUZXh0KHsgdGFiSWQsIHRleHQ6ICcnIH0pO1xuICAgICAgICAgIGF3YWl0IGNocm9tZS5hY3Rpb24uc2V0QmFkZ2VCYWNrZ3JvdW5kQ29sb3IoeyB0YWJJZCwgY29sb3I6ICcjNkI3MjgwJyB9KTsgLy8gR3JleVxuICAgICAgICAgIGF3YWl0IGNocm9tZS5hY3Rpb24uc2V0VGl0bGUoeyB0YWJJZCwgdGl0bGU6ICdBSSBQSUkgU2FuaXRpemVyIC0gRGlzYWJsZWQnIH0pO1xuICAgICAgICAgIGlmIChERUJVR19NT0RFIHx8IHN0YXRlQ2hhbmdlZCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFtCYWRnZU1hbmFnZXJdIFRhYiAke3RhYklkfTogRElTQUJMRUQgKE5vIGJhZGdlKWApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihgW0JhZGdlTWFuYWdlcl0gRmFpbGVkIHRvIHVwZGF0ZSBiYWRnZSBmb3IgdGFiICR7dGFiSWR9OmAsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgdGFiIHByb3RlY3Rpb24gc3RhdHVzIGFuZCB1cGRhdGUgYmFkZ2VcbiAgICovXG4gIGFzeW5jIGNoZWNrQW5kVXBkYXRlQmFkZ2UodGFiSWQ6IG51bWJlciwgdXJsPzogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIENsZWFyIGJhZGdlIGZvciBub24tQUkgc2VydmljZSBwYWdlc1xuICAgICAgaWYgKCF0aGlzLmlzQUlTZXJ2aWNlVVJMKHVybCkpIHtcbiAgICAgICAgYXdhaXQgY2hyb21lLmFjdGlvbi5zZXRCYWRnZVRleHQoeyB0YWJJZCwgdGV4dDogJycgfSk7XG4gICAgICAgIGlmIChERUJVR19NT0RFKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coYFtCYWRnZU1hbmFnZXJdIFRhYiAke3RhYklkfTogTm90IGFuIEFJIHNlcnZpY2UsIGJhZGdlIGNsZWFyZWRgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGlmIGV4dGVuc2lvbiBpcyBlbmFibGVkXG4gICAgICBsZXQgY29uZmlnOiBBd2FpdGVkPFJldHVyblR5cGU8dHlwZW9mIHRoaXMuc3RvcmFnZS5sb2FkQ29uZmlnPj4gPSBudWxsO1xuXG4gICAgICB0cnkge1xuICAgICAgICBjb25maWcgPSBhd2FpdCB0aGlzLnN0b3JhZ2UubG9hZENvbmZpZygpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgLy8gSWYgY29uZmlnIGxvYWRpbmcgZmFpbHMgZHVlIHRvIGF1dGgsIGFzc3VtZSBleHRlbnNpb24gaXMgZGlzYWJsZWRcbiAgICAgICAgLy8gVGhpcyBwcmV2ZW50cyBlcnJvcnMgZnJvbSBzcGFtbWluZyB3aGVuIHVzZXIgaXNuJ3Qgc2lnbmVkIGluXG4gICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0VOQ1JZUFRJT05fS0VZX1VOQVZBSUxBQkxFJykpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgW0JhZGdlTWFuYWdlcl0gVGFiICR7dGFiSWR9OiBEYXRhIGxvY2tlZCAodXNlciBub3QgYXV0aGVudGljYXRlZClgKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZUJhZGdlKHRhYklkLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgZXJyb3I7IC8vIFJlLXRocm93IG90aGVyIGVycm9yc1xuICAgICAgfVxuXG4gICAgICBpZiAoREVCVUdfTU9ERSkge1xuICAgICAgICBjb25zb2xlLmxvZyhgW0JhZGdlTWFuYWdlcl0gQ29uZmlnIGNoZWNrIGZvciB0YWIgJHt0YWJJZH06YCwge1xuICAgICAgICAgIGhhc0NvbmZpZzogISFjb25maWcsXG4gICAgICAgICAgaGFzU2V0dGluZ3M6ICEhY29uZmlnPy5zZXR0aW5ncyxcbiAgICAgICAgICBlbmFibGVkOiBjb25maWc/LnNldHRpbmdzPy5lbmFibGVkXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWNvbmZpZz8uc2V0dGluZ3M/LmVuYWJsZWQpIHtcbiAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVCYWRnZSh0YWJJZCwgJ2Rpc2FibGVkJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBzcGVjaWZpYyBkb21haW4gaXMgaW4gcHJvdGVjdGVkRG9tYWluc1xuICAgICAgY29uc3QgcHJvdGVjdGVkRG9tYWlucyA9IGNvbmZpZz8uc2V0dGluZ3M/LnByb3RlY3RlZERvbWFpbnMgfHwgW107XG4gICAgICBjb25zdCBjdXJyZW50RG9tYWluID0gdXJsID8gbmV3IFVSTCh1cmwpLmhvc3RuYW1lIDogJyc7XG4gICAgICBjb25zdCBpc0RvbWFpblByb3RlY3RlZCA9IHByb3RlY3RlZERvbWFpbnMuc29tZShkb21haW4gPT5cbiAgICAgICAgY3VycmVudERvbWFpbi5pbmNsdWRlcyhkb21haW4pIHx8IGRvbWFpbi5pbmNsdWRlcyhjdXJyZW50RG9tYWluKVxuICAgICAgKTtcblxuICAgICAgaWYgKCFpc0RvbWFpblByb3RlY3RlZCkge1xuICAgICAgICAvLyBTZXJ2aWNlIGlzIGRpc2FibGVkIGZvciB0aGlzIGRvbWFpblxuICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZUJhZGdlKHRhYklkLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgaWYgKERFQlVHX01PREUpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgW0JhZGdlTWFuYWdlcl0gVGFiICR7dGFiSWR9OiBEb21haW4gJHtjdXJyZW50RG9tYWlufSBub3QgaW4gcHJvdGVjdGVkRG9tYWluc2AsIHByb3RlY3RlZERvbWFpbnMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgY29udGVudCBzY3JpcHQgaXMgaW5qZWN0ZWQgYW5kIHJlc3BvbmRpbmdcbiAgICAgIGNvbnN0IGlzSW5qZWN0ZWQgPSBhd2FpdCB0aGlzLmNvbnRlbnRTY3JpcHRNYW5hZ2VyLmlzQ29udGVudFNjcmlwdEluamVjdGVkKHRhYklkKTtcblxuICAgICAgLy8gQ2hlY2sgaWYgcHJvZmlsZXMgYXJlIGxvYWRlZCBhbmQgYWN0aXZlXG4gICAgICBsZXQgaGFzQWN0aXZlUHJvZmlsZXMgPSBmYWxzZTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHByb2ZpbGVzID0gYXdhaXQgdGhpcy5zdG9yYWdlLmxvYWRQcm9maWxlcygpO1xuICAgICAgICBoYXNBY3RpdmVQcm9maWxlcyA9IHByb2ZpbGVzLnNvbWUocCA9PiBwLmVuYWJsZWQpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgLy8gSWYgcHJvZmlsZXMgY2FuJ3QgYmUgbG9hZGVkLCBhc3N1bWUgbm8gYWN0aXZlIHByb2ZpbGVzXG4gICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0VOQ1JZUFRJT05fS0VZX1VOQVZBSUxBQkxFJykpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgW0JhZGdlTWFuYWdlcl0gVGFiICR7dGFiSWR9OiBQcm9maWxlcyBsb2NrZWQgKHVzZXIgbm90IGF1dGhlbnRpY2F0ZWQpYCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQWxsIHRocmVlIGNvbmRpdGlvbnMgbXVzdCBiZSB0cnVlIGZvciBmdWxsIHByb3RlY3Rpb25cbiAgICAgIGNvbnN0IGlzUHJvdGVjdGVkID0gaXNJbmplY3RlZCAmJiBoYXNBY3RpdmVQcm9maWxlcztcblxuICAgICAgaWYgKCFpc1Byb3RlY3RlZCAmJiBpc0luamVjdGVkICYmICFoYXNBY3RpdmVQcm9maWxlcykge1xuICAgICAgICAvLyBFeHRlbnNpb24gZW5hYmxlZCBidXQgbm8gYWN0aXZlIHByb2ZpbGVzIC0gc2hvdyB3YXJuaW5nXG4gICAgICAgIGNvbnNvbGUubG9nKGBbQmFkZ2VNYW5hZ2VyXSBUYWIgJHt0YWJJZH06IE5PIEFDVElWRSBQUk9GSUxFUyAoV2FybmluZylgKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGlzUHJvdGVjdGVkKSB7XG4gICAgICAgIGF3YWl0IHRoaXMudXBkYXRlQmFkZ2UodGFiSWQsICdwcm90ZWN0ZWQnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGF3YWl0IHRoaXMudXBkYXRlQmFkZ2UodGFiSWQsICd1bnByb3RlY3RlZCcpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBbQmFkZ2VNYW5hZ2VyXSBFcnJvciBjaGVja2luZyBwcm90ZWN0aW9uIGZvciB0YWIgJHt0YWJJZH06YCwgZXJyb3IpO1xuICAgIH1cbiAgfVxufVxuIiwiLyoqXG4gKiBDb250ZW50IFNjcmlwdCBNYW5hZ2VyXG4gKiBIYW5kbGVzIGNvbnRlbnQgc2NyaXB0IGluamVjdGlvbiBpbnRvIEFJIHNlcnZpY2UgdGFic1xuICovXG5cbmltcG9ydCB7IEJhZGdlTWFuYWdlciB9IGZyb20gJy4vQmFkZ2VNYW5hZ2VyJztcblxuZXhwb3J0IGNsYXNzIENvbnRlbnRTY3JpcHRNYW5hZ2VyIHtcbiAgLyoqXG4gICAqIEFJIHNlcnZpY2UgVVJMIHBhdHRlcm5zIGZvciBjb250ZW50IHNjcmlwdCBpbmplY3Rpb25cbiAgICovXG4gIHN0YXRpYyByZWFkb25seSBBSV9TRVJWSUNFX1BBVFRFUk5TID0gW1xuICAgICcqOi8vY2hhdGdwdC5jb20vKicsXG4gICAgJyo6Ly8qLm9wZW5haS5jb20vKicsXG4gICAgJyo6Ly9jbGF1ZGUuYWkvKicsXG4gICAgJyo6Ly9nZW1pbmkuZ29vZ2xlLmNvbS8qJyxcbiAgICAnKjovL3BlcnBsZXhpdHkuYWkvKicsXG4gICAgJyo6Ly9jb3BpbG90Lm1pY3Jvc29mdC5jb20vKicsXG4gIF07XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBiYWRnZU1hbmFnZXI6IEJhZGdlTWFuYWdlcikge31cblxuICAvKipcbiAgICogQ2hlY2sgaWYgY29udGVudCBzY3JpcHQgaXMgYWxyZWFkeSBpbmplY3RlZCBpbiBhIHRhYlxuICAgKi9cbiAgYXN5bmMgaXNDb250ZW50U2NyaXB0SW5qZWN0ZWQodGFiSWQ6IG51bWJlcik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNocm9tZS50YWJzLnNlbmRNZXNzYWdlKHRhYklkLCB7IHR5cGU6ICdQSU5HJyB9KTtcbiAgICAgIHJldHVybiByZXNwb25zZSA9PT0gJ1BPTkcnO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEluamVjdCBjb250ZW50IHNjcmlwdHMgaW50byBhbGwgZXhpc3RpbmcgQUkgc2VydmljZSB0YWJzXG4gICAqL1xuICBhc3luYyBpbmplY3RJbnRvRXhpc3RpbmdUYWJzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnNvbGUubG9nKCdbQ29udGVudFNjcmlwdE1hbmFnZXJdIEluamVjdGluZyBjb250ZW50IHNjcmlwdHMgaW50byBleGlzdGluZyB0YWJzLi4uJyk7XG5cbiAgICB0cnkge1xuICAgICAgLy8gUXVlcnkgYWxsIHRhYnMgbWF0Y2hpbmcgQUkgc2VydmljZSBVUkxzXG4gICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgQ29udGVudFNjcmlwdE1hbmFnZXIuQUlfU0VSVklDRV9QQVRURVJOUykge1xuICAgICAgICBjb25zdCB0YWJzID0gYXdhaXQgY2hyb21lLnRhYnMucXVlcnkoeyB1cmw6IHBhdHRlcm4gfSk7XG5cbiAgICAgICAgZm9yIChjb25zdCB0YWIgb2YgdGFicykge1xuICAgICAgICAgIGlmICghdGFiLmlkKSBjb250aW51ZTtcblxuICAgICAgICAgIC8vIENoZWNrIGlmIGNvbnRlbnQgc2NyaXB0IGlzIGFscmVhZHkgaW5qZWN0ZWRcbiAgICAgICAgICBjb25zdCBpc0luamVjdGVkID0gYXdhaXQgdGhpcy5pc0NvbnRlbnRTY3JpcHRJbmplY3RlZCh0YWIuaWQpO1xuXG4gICAgICAgICAgaWYgKCFpc0luamVjdGVkKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgW0NvbnRlbnRTY3JpcHRNYW5hZ2VyXSBJbmplY3RpbmcgaW50byB0YWIgJHt0YWIuaWR9OiAke3RhYi51cmx9YCk7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGF3YWl0IGNocm9tZS5zY3JpcHRpbmcuZXhlY3V0ZVNjcmlwdCh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiB7IHRhYklkOiB0YWIuaWQgfSxcbiAgICAgICAgICAgICAgICBmaWxlczogWydjb250ZW50LmpzJ10sXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgW0NvbnRlbnRTY3JpcHRNYW5hZ2VyXSDinIUgSW5qZWN0ZWQgaW50byB0YWIgJHt0YWIuaWR9YCk7XG4gICAgICAgICAgICAgIC8vIFVwZGF0ZSBiYWRnZSBhZnRlciBzdWNjZXNzZnVsIGluamVjdGlvblxuICAgICAgICAgICAgICBhd2FpdCB0aGlzLmJhZGdlTWFuYWdlci5jaGVja0FuZFVwZGF0ZUJhZGdlKHRhYi5pZCwgdGFiLnVybCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFtDb250ZW50U2NyaXB0TWFuYWdlcl0gRmFpbGVkIHRvIGluamVjdCBpbnRvIHRhYiAke3RhYi5pZH06YCwgZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gVXBkYXRlIGJhZGdlIGZvciBhbHJlYWR5LWluamVjdGVkIHRhYnNcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYmFkZ2VNYW5hZ2VyLmNoZWNrQW5kVXBkYXRlQmFkZ2UodGFiLmlkLCB0YWIudXJsKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFtDb250ZW50U2NyaXB0TWFuYWdlcl0gQWxyZWFkeSBpbmplY3RlZCBpbiB0YWIgJHt0YWIuaWR9YCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCdbQ29udGVudFNjcmlwdE1hbmFnZXJdIOKchSBDb250ZW50IHNjcmlwdCBpbmplY3Rpb24gY29tcGxldGUnKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW0NvbnRlbnRTY3JpcHRNYW5hZ2VyXSBFcnJvciBpbmplY3RpbmcgaW50byBleGlzdGluZyB0YWJzOicsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlIFJFSU5KRUNUX0NPTlRFTlRfU0NSSVBUUyBtZXNzYWdlIGZyb20gcG9wdXBcbiAgICovXG4gIGFzeW5jIGhhbmRsZVJlaW5qZWN0KCk6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuOyBtZXNzYWdlOiBzdHJpbmcgfT4ge1xuICAgIGF3YWl0IHRoaXMuaW5qZWN0SW50b0V4aXN0aW5nVGFicygpO1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIG1lc3NhZ2U6ICdDb250ZW50IHNjcmlwdHMgcmVpbmplY3RlZCcgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWxvYWQgYWxsIEFJIHNlcnZpY2UgdGFicyAoZm9yIGV4dGVuc2lvbiB1cGRhdGVzL2RldiBtb2RlKVxuICAgKiBSZXR1cm5zIHRoZSBudW1iZXIgb2YgdGFicyByZWxvYWRlZFxuICAgKi9cbiAgYXN5bmMgcmVsb2FkQUlTZXJ2aWNlVGFicygpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIGNvbnNvbGUubG9nKCdbQ29udGVudFNjcmlwdE1hbmFnZXJdIFJlbG9hZGluZyBhbGwgQUkgc2VydmljZSB0YWJzLi4uJyk7XG4gICAgbGV0IHJlbG9hZGVkQ291bnQgPSAwO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIFF1ZXJ5IGFsbCB0YWJzIG1hdGNoaW5nIEFJIHNlcnZpY2UgVVJMc1xuICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIENvbnRlbnRTY3JpcHRNYW5hZ2VyLkFJX1NFUlZJQ0VfUEFUVEVSTlMpIHtcbiAgICAgICAgY29uc3QgdGFicyA9IGF3YWl0IGNocm9tZS50YWJzLnF1ZXJ5KHsgdXJsOiBwYXR0ZXJuIH0pO1xuXG4gICAgICAgIGZvciAoY29uc3QgdGFiIG9mIHRhYnMpIHtcbiAgICAgICAgICBpZiAoIXRhYi5pZCkgY29udGludWU7XG5cbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFtDb250ZW50U2NyaXB0TWFuYWdlcl0gUmVsb2FkaW5nIHRhYiAke3RhYi5pZH06ICR7dGFiLnVybH1gKTtcbiAgICAgICAgICAgIGF3YWl0IGNocm9tZS50YWJzLnJlbG9hZCh0YWIuaWQpO1xuICAgICAgICAgICAgcmVsb2FkZWRDb3VudCsrO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYFtDb250ZW50U2NyaXB0TWFuYWdlcl0gRmFpbGVkIHRvIHJlbG9hZCB0YWIgJHt0YWIuaWR9OmAsIGVycm9yKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coYFtDb250ZW50U2NyaXB0TWFuYWdlcl0g4pyFIFJlbG9hZGVkICR7cmVsb2FkZWRDb3VudH0gQUkgc2VydmljZSB0YWJzYCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tDb250ZW50U2NyaXB0TWFuYWdlcl0gRXJyb3IgcmVsb2FkaW5nIEFJIHNlcnZpY2UgdGFiczonLCBlcnJvcik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlbG9hZGVkQ291bnQ7XG4gIH1cbn1cbiIsIi8qKlxuICogQWN0aXZpdHkgTG9nZ2VyXG4gKiBMb2dzIGFjdGl2aXR5IGRpcmVjdGx5IHRvIGVuY3J5cHRlZCBzdG9yYWdlXG4gKiBTZXJ2aWNlIHdvcmtlciBjYW4gbm93IGVuY3J5cHQgd2l0aCBGaXJlYmFzZSBhdXRoL3dlYi1leHRlbnNpb24gc3VwcG9ydFxuICovXG5cbmltcG9ydCB0eXBlIHsgQUlTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vbGliL3R5cGVzJztcbmltcG9ydCB7IFN0b3JhZ2VNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vbGliL3N0b3JhZ2UnO1xuXG4vKipcbiAqIEFjdGl2aXR5IGxvZyBlbnRyeSAod2l0aG91dCBpZC90aW1lc3RhbXAgLSBhZGRlZCB3aGVuIHNhdmluZylcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBBY3Rpdml0eUxvZ0VudHJ5SW5wdXQge1xuICB0eXBlOiAnaW50ZXJjZXB0aW9uJyB8ICdzdWJzdGl0dXRpb24nIHwgJ3dhcm5pbmcnIHwgJ2Vycm9yJztcbiAgc2VydmljZTogQUlTZXJ2aWNlO1xuICBkZXRhaWxzOiB7XG4gICAgdXJsOiBzdHJpbmc7XG4gICAgcHJvZmlsZXNVc2VkPzogc3RyaW5nW107XG4gICAgcGlpVHlwZXNGb3VuZD86IHN0cmluZ1tdO1xuICAgIHN1YnN0aXR1dGlvbkNvdW50OiBudW1iZXI7XG4gICAgZXJyb3I/OiBzdHJpbmc7XG4gICAgYXBpS2V5c1Byb3RlY3RlZD86IG51bWJlcjtcbiAgICBhcGlLZXlzRm91bmQ/OiBudW1iZXI7XG4gICAga2V5VHlwZXM/OiBzdHJpbmdbXTtcbiAgfTtcbiAgbWVzc2FnZTogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgQWN0aXZpdHlMb2dnZXIge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHN0b3JhZ2U6IFN0b3JhZ2VNYW5hZ2VyKSB7fVxuXG4gIC8qKlxuICAgKiBMb2cgYWN0aXZpdHkgZGlyZWN0bHkgdG8gZW5jcnlwdGVkIHN0b3JhZ2VcbiAgICovXG4gIGFzeW5jIGxvZ0FjdGl2aXR5KGVudHJ5OiBBY3Rpdml0eUxvZ0VudHJ5SW5wdXQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zb2xlLmxvZygnW0FjdGl2aXR5TG9nZ2VyXSBBY3Rpdml0eTonLCBlbnRyeS5tZXNzYWdlKTtcblxuICAgIHRyeSB7XG4gICAgICAvLyBMb2FkIGN1cnJlbnQgY29uZmlnXG4gICAgICBjb25zdCBjb25maWcgPSBhd2FpdCB0aGlzLnN0b3JhZ2UubG9hZENvbmZpZygpO1xuICAgICAgaWYgKCFjb25maWcpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdbQWN0aXZpdHlMb2dnZXJdIE5vIGNvbmZpZyBmb3VuZCAtIHNraXBwaW5nIGFjdGl2aXR5IGxvZycpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIEdldCBjdXJyZW50IGFjdGl2aXR5IGxvZ3MgKGRlY3J5cHRlZClcbiAgICAgIGNvbnN0IGN1cnJlbnRMb2dzID0gY29uZmlnLnN0YXRzPy5hY3Rpdml0eUxvZyB8fCBbXTtcblxuICAgICAgLy8gQWRkIG5ldyBlbnRyeSB3aXRoIGlkIGFuZCB0aW1lc3RhbXBcbiAgICAgIGNvbnN0IG5ld0VudHJ5ID0ge1xuICAgICAgICAuLi5lbnRyeSxcbiAgICAgICAgaWQ6IGBsb2dfJHtEYXRlLm5vdygpfV8ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCA5KX1gLFxuICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICB9O1xuXG4gICAgICAvLyBBZGQgdG8gYmVnaW5uaW5nIChtb3N0IHJlY2VudCBmaXJzdClcbiAgICAgIGNvbnN0IHVwZGF0ZWRMb2dzID0gW25ld0VudHJ5LCAuLi5jdXJyZW50TG9nc107XG5cbiAgICAgIC8vIEtlZXAgb25seSBsYXN0IDEwMCBlbnRyaWVzIHRvIHByZXZlbnQgdW5ib3VuZGVkIGdyb3d0aFxuICAgICAgY29uc3QgdHJpbW1lZExvZ3MgPSB1cGRhdGVkTG9ncy5zbGljZSgwLCAxMDApO1xuXG4gICAgICAvLyBTYXZlIGJhY2sgdG8gZW5jcnlwdGVkIHN0b3JhZ2VcbiAgICAgIGF3YWl0IHRoaXMuc3RvcmFnZS5zYXZlQ29uZmlnKHtcbiAgICAgICAgLi4uY29uZmlnLFxuICAgICAgICBzdGF0czoge1xuICAgICAgICAgIC4uLmNvbmZpZy5zdGF0cyxcbiAgICAgICAgICBhY3Rpdml0eUxvZzogdHJpbW1lZExvZ3MsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc29sZS5sb2coJ1tBY3Rpdml0eUxvZ2dlcl0g4pyFIEFjdGl2aXR5IGxvZ2dlZCB0byBlbmNyeXB0ZWQgc3RvcmFnZScpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbQWN0aXZpdHlMb2dnZXJdIEZhaWxlZCB0byBsb2cgYWN0aXZpdHk6JywgZXJyb3IpO1xuICAgICAgLy8gRG9uJ3QgdGhyb3cgLSBhY3Rpdml0eSBsb2dnaW5nIGlzIG5vbi1jcml0aWNhbFxuICAgIH1cbiAgfVxufVxuIiwiLyoqXG4gKiBSZXF1ZXN0IFByb2Nlc3NvclxuICogSGFuZGxlcyByZXF1ZXN0IGJvZHkgc3Vic3RpdHV0aW9uIChyZWFsIOKGkiBhbGlhcylcbiAqL1xuXG5pbXBvcnQgeyBTdG9yYWdlTWFuYWdlciB9IGZyb20gJy4uLy4uL2xpYi9zdG9yYWdlJztcbmltcG9ydCB7IEFsaWFzRW5naW5lIH0gZnJvbSAnLi4vLi4vbGliL2FsaWFzRW5naW5lJztcbmltcG9ydCB7IEFQSUtleURldGVjdG9yIH0gZnJvbSAnLi4vLi4vbGliL2FwaUtleURldGVjdG9yJztcbmltcG9ydCB7IHJlZGFjdGlvbkVuZ2luZSB9IGZyb20gJy4uLy4uL2xpYi9yZWRhY3Rpb25FbmdpbmUnO1xuaW1wb3J0IHsgQWN0aXZpdHlMb2dnZXIgfSBmcm9tICcuLi9tYW5hZ2Vycy9BY3Rpdml0eUxvZ2dlcic7XG5pbXBvcnQgeyBleHRyYWN0QWxsVGV4dCwgcmVwbGFjZUFsbFRleHQgfSBmcm9tICcuLi8uLi9saWIvdGV4dFByb2Nlc3Nvcic7XG5pbXBvcnQgeyBkZXRlY3RTZXJ2aWNlIH0gZnJvbSAnLi4vdXRpbHMvU2VydmljZURldGVjdG9yJztcbmltcG9ydCB0eXBlIHsgQUlTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vbGliL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIFJlcXVlc3RQcm9jZXNzb3Ige1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHN0b3JhZ2U6IFN0b3JhZ2VNYW5hZ2VyLFxuICAgIHByaXZhdGUgYWxpYXNFbmdpbmU6IEFsaWFzRW5naW5lLFxuICAgIF9hcGlLZXlEZXRlY3RvcjogQVBJS2V5RGV0ZWN0b3IsIC8vIFVudXNlZCAtIHVzaW5nIHN0YXRpYyBtZXRob2RzIGRpcmVjdGx5XG4gICAgcHJpdmF0ZSByZWRhY3Rpb25FbmdpbmVJbnN0YW5jZTogdHlwZW9mIHJlZGFjdGlvbkVuZ2luZSxcbiAgICBwcml2YXRlIGFjdGl2aXR5TG9nZ2VyOiBBY3Rpdml0eUxvZ2dlclxuICApIHt9XG5cbiAgLyoqXG4gICAqIFByb2Nlc3MgcmVxdWVzdCBib2R5IC0gc3Vic3RpdHV0ZSByZWFsIGRhdGEgd2l0aCBhbGlhc2VzXG4gICAqL1xuICBhc3luYyBwcm9jZXNzUmVxdWVzdChcbiAgICByZXF1ZXN0Qm9keTogc3RyaW5nLFxuICAgIF90YWJJZD86IG51bWJlcixcbiAgICB1cmw/OiBzdHJpbmdcbiAgKTogUHJvbWlzZTx7XG4gICAgc3VjY2VzczogYm9vbGVhbjtcbiAgICBtb2RpZmllZEJvZHk6IHN0cmluZztcbiAgICBzdWJzdGl0dXRpb25zOiBudW1iZXI7XG4gICAgbmVlZHNXYXJuaW5nPzogYm9vbGVhbjtcbiAgICBrZXlzRGV0ZWN0ZWQ/OiBudW1iZXI7XG4gICAga2V5VHlwZXM/OiBzdHJpbmdbXTtcbiAgICBvcmlnaW5hbEJvZHk/OiBzdHJpbmc7XG4gICAgZXJyb3I/OiBzdHJpbmc7XG4gIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc2VydmljZSA9IHVybCA/IGRldGVjdFNlcnZpY2UodXJsKSA6ICd1bmtub3duJztcblxuICAgICAgY29uc29sZS5sb2coJ1tSZXF1ZXN0UHJvY2Vzc29yXSDwn5SEIFN1YnN0aXR1dGluZyByZXF1ZXN0IGJvZHknKTtcblxuICAgICAgLy8gSGFuZGxlIGVtcHR5IG9yIG5vbi1KU09OIGJvZGllcyAoc3RyZWFtaW5nLCBtdWx0aXBhcnQsIGV0Yy4pXG4gICAgICBpZiAoIXJlcXVlc3RCb2R5IHx8IHJlcXVlc3RCb2R5LnRyaW0oKSA9PT0gJycpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tSZXF1ZXN0UHJvY2Vzc29yXSDimqDvuI8gRW1wdHkgcmVxdWVzdCBib2R5LCBza2lwcGluZyBzdWJzdGl0dXRpb24nKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIG1vZGlmaWVkQm9keTogcmVxdWVzdEJvZHksXG4gICAgICAgICAgc3Vic3RpdHV0aW9uczogMCxcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gUGFyc2UgcmVxdWVzdCBib2R5XG4gICAgICBsZXQgcmVxdWVzdERhdGE7XG4gICAgICB0cnkge1xuICAgICAgICByZXF1ZXN0RGF0YSA9IEpTT04ucGFyc2UocmVxdWVzdEJvZHkpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyBOb3QgSlNPTiAtIG1pZ2h0IGJlIHN0cmVhbWluZywgZm9ybSBkYXRhLCBvciBvdGhlciBmb3JtYXQgKGUuZy4sIEdlbWluaSdzIFVSTC1lbmNvZGVkIGJhdGNoZXhlY3V0ZSlcbiAgICAgICAgY29uc29sZS5sb2coJ1tSZXF1ZXN0UHJvY2Vzc29yXSDimqDvuI8gTm9uLUpTT04gcmVxdWVzdCBib2R5LCBhdHRlbXB0aW5nIHBsYWluIHRleHQgc3Vic3RpdHV0aW9uJyk7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgYm9keSBpcyBVUkwtZW5jb2RlZCAoR2VtaW5pIGJhdGNoZXhlY3V0ZSBmb3JtYXQpXG4gICAgICAgIGxldCBib2R5VG9TdWJzdGl0dXRlID0gcmVxdWVzdEJvZHk7XG4gICAgICAgIGxldCBpc1VybEVuY29kZWQgPSBmYWxzZTtcblxuICAgICAgICBpZiAodHlwZW9mIHJlcXVlc3RCb2R5ID09PSAnc3RyaW5nJyAmJiByZXF1ZXN0Qm9keS5pbmNsdWRlcygnZi5yZXE9JykpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnW1JlcXVlc3RQcm9jZXNzb3JdIFtHZW1pbmldIERldGVjdGVkIFVSTC1lbmNvZGVkIGJhdGNoZXhlY3V0ZSBmb3JtYXQnKTtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gUGFyc2UgVVJMIHBhcmFtZXRlcnNcbiAgICAgICAgICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMocmVxdWVzdEJvZHkpO1xuICAgICAgICAgICAgY29uc3QgZnJlcVZhbHVlID0gcGFyYW1zLmdldCgnZi5yZXEnKTtcblxuICAgICAgICAgICAgaWYgKGZyZXFWYWx1ZSkge1xuICAgICAgICAgICAgICAvLyBEZWNvZGUgb25seSB0aGUgZi5yZXEgdmFsdWUgZm9yIHN1YnN0aXR1dGlvblxuICAgICAgICAgICAgICBib2R5VG9TdWJzdGl0dXRlID0gZnJlcVZhbHVlO1xuICAgICAgICAgICAgICBpc1VybEVuY29kZWQgPSB0cnVlO1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW1JlcXVlc3RQcm9jZXNzb3JdIFtHZW1pbmldIERlY29kZWQgZi5yZXEgdmFsdWUgbGVuZ3RoOicsIGJvZHlUb1N1YnN0aXR1dGUubGVuZ3RoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChkZWNvZGVFcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdbUmVxdWVzdFByb2Nlc3Nvcl0gW0dlbWluaV0gRmFpbGVkIHRvIHBhcnNlIFVSTCBwYXJhbWV0ZXJzLCB1c2luZyBvcmlnaW5hbCcpO1xuICAgICAgICAgICAgYm9keVRvU3Vic3RpdHV0ZSA9IHJlcXVlc3RCb2R5O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRyeSBwbGFpbiB0ZXh0IHN1YnN0aXR1dGlvblxuICAgICAgICBjb25zdCBzdWJzdGl0dXRlZCA9IHRoaXMuYWxpYXNFbmdpbmUuc3Vic3RpdHV0ZShib2R5VG9TdWJzdGl0dXRlLCAnZW5jb2RlJyk7XG5cbiAgICAgICAgaWYgKHN1YnN0aXR1dGVkLnN1YnN0aXR1dGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdbUmVxdWVzdFByb2Nlc3Nvcl0g4pyFIFBsYWluIHRleHQgc3Vic3RpdHV0ZWQ6Jywgc3Vic3RpdHV0ZWQuc3Vic3RpdHV0aW9ucy5sZW5ndGgsICdyZXBsYWNlbWVudHMnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJlLWVuY29kZSBpZiB3ZSBkZWNvZGVkIGl0XG4gICAgICAgIGxldCBmaW5hbEJvZHkgPSBzdWJzdGl0dXRlZC50ZXh0O1xuICAgICAgICBpZiAoaXNVcmxFbmNvZGVkKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFJlY29uc3RydWN0IHRoZSBmb3JtIGJvZHkgd2l0aCBzdWJzdGl0dXRlZCBmLnJlcSB2YWx1ZVxuICAgICAgICAgICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyhyZXF1ZXN0Qm9keSk7XG4gICAgICAgICAgICBwYXJhbXMuc2V0KCdmLnJlcScsIHN1YnN0aXR1dGVkLnRleHQpO1xuICAgICAgICAgICAgZmluYWxCb2R5ID0gcGFyYW1zLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW1JlcXVlc3RQcm9jZXNzb3JdIFtHZW1pbmldIFJlY29uc3RydWN0ZWQgYm9keSBsZW5ndGg6JywgZmluYWxCb2R5Lmxlbmd0aCk7XG4gICAgICAgICAgfSBjYXRjaCAoZW5jb2RlRXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tSZXF1ZXN0UHJvY2Vzc29yXSBbR2VtaW5pXSBGYWlsZWQgdG8gcmVjb25zdHJ1Y3QgYm9keTonLCBlbmNvZGVFcnJvcik7XG4gICAgICAgICAgICBmaW5hbEJvZHkgPSBzdWJzdGl0dXRlZC50ZXh0O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBtb2RpZmllZEJvZHk6IGZpbmFsQm9keSxcbiAgICAgICAgICBzdWJzdGl0dXRpb25zOiBzdWJzdGl0dXRlZC5zdWJzdGl0dXRpb25zLmxlbmd0aCxcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gRXh0cmFjdCBhbGwgdGV4dCBjb250ZW50IGZyb20gbWVzc2FnZXMvcHJvbXB0XG4gICAgICBjb25zdCB0ZXh0Q29udGVudCA9IGV4dHJhY3RBbGxUZXh0KHJlcXVlc3REYXRhKTtcblxuICAgICAgY29uc29sZS5sb2coJ1tSZXF1ZXN0UHJvY2Vzc29yXSDwn5OdIEV4dHJhY3RlZCB0ZXh0OicsIHRleHRDb250ZW50LnN1YnN0cmluZygwLCAzMDApKTtcblxuICAgICAgaWYgKCF0ZXh0Q29udGVudCkge1xuICAgICAgICBjb25zb2xlLmxvZygnW1JlcXVlc3RQcm9jZXNzb3JdIOKaoO+4jyBObyB0ZXh0IGV4dHJhY3RlZCBmcm9tIHJlcXVlc3QnKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIG1vZGlmaWVkQm9keTogcmVxdWVzdEJvZHksXG4gICAgICAgICAgc3Vic3RpdHV0aW9uczogMCxcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gQXBwbHkgc3Vic3RpdHV0aW9uIChyZWFsIOKGkiBhbGlhcylcbiAgICAgIGNvbnN0IHByb2ZpbGVzID0gdGhpcy5hbGlhc0VuZ2luZS5nZXRQcm9maWxlcygpO1xuICAgICAgY29uc29sZS5sb2coJ1tSZXF1ZXN0UHJvY2Vzc29yXSDwn5OLIEFjdGl2ZSBwcm9maWxlczonLCBwcm9maWxlcy5sZW5ndGgsICctJywgcHJvZmlsZXMubWFwKChwOiBhbnkpID0+IHAucHJvZmlsZU5hbWUpLmpvaW4oJywgJykpO1xuXG4gICAgICBjb25zdCBzdWJzdGl0dXRlZCA9IHRoaXMuYWxpYXNFbmdpbmUuc3Vic3RpdHV0ZSh0ZXh0Q29udGVudCwgJ2VuY29kZScpO1xuXG4gICAgICBjb25zb2xlLmxvZygnW1JlcXVlc3RQcm9jZXNzb3JdIOKchSBSZXF1ZXN0IHN1YnN0aXR1dGVkOicsIHN1YnN0aXR1dGVkLnN1YnN0aXR1dGlvbnMubGVuZ3RoLCAncmVwbGFjZW1lbnRzJyk7XG4gICAgICBpZiAoc3Vic3RpdHV0ZWQuc3Vic3RpdHV0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdbUmVxdWVzdFByb2Nlc3Nvcl0g8J+UgCBDaGFuZ2VzOicsIHN1YnN0aXR1dGVkLnN1YnN0aXR1dGlvbnMpO1xuXG4gICAgICAgIC8vIExvZyBhY3Rpdml0eSBmb3IgZGVidWcgY29uc29sZVxuICAgICAgICBjb25zdCBzZXJ2aWNlTmFtZSA9IHRoaXMuZ2V0U2VydmljZU5hbWUoc2VydmljZSk7XG5cbiAgICAgICAgdGhpcy5hY3Rpdml0eUxvZ2dlci5sb2dBY3Rpdml0eSh7XG4gICAgICAgICAgdHlwZTogJ3N1YnN0aXR1dGlvbicsXG4gICAgICAgICAgc2VydmljZTogc2VydmljZSxcbiAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICB1cmw6IHNlcnZpY2VOYW1lLFxuICAgICAgICAgICAgcHJvZmlsZXNVc2VkOiBzdWJzdGl0dXRlZC5wcm9maWxlc01hdGNoZWQ/Lm1hcChwID0+IHAucHJvZmlsZU5hbWUpIHx8IFtdLFxuICAgICAgICAgICAgcGlpVHlwZXNGb3VuZDogc3Vic3RpdHV0ZWQucHJvZmlsZXNNYXRjaGVkPy5mbGF0TWFwKHAgPT4gcC5waWlUeXBlcykgfHwgW10sXG4gICAgICAgICAgICBzdWJzdGl0dXRpb25Db3VudDogc3Vic3RpdHV0ZWQuc3Vic3RpdHV0aW9ucy5sZW5ndGgsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBtZXNzYWdlOiBgJHtzZXJ2aWNlTmFtZX06ICR7c3Vic3RpdHV0ZWQuc3Vic3RpdHV0aW9ucy5sZW5ndGh9IGl0ZW1zIHJlcGxhY2VkYCxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFJlY29uc3RydWN0IHJlcXVlc3QgYm9keSB3aXRoIHN1YnN0aXR1dGVkIHRleHRcbiAgICAgIGxldCBtb2RpZmllZFRleHQgPSBzdWJzdGl0dXRlZC50ZXh0O1xuXG4gICAgICAvLyA9PT09PT09PT09IENVU1RPTSBSRURBQ1RJT04gUlVMRVMgPT09PT09PT09PVxuICAgICAgY29uc3QgY29uZmlnID0gYXdhaXQgdGhpcy5zdG9yYWdlLmxvYWRDb25maWcoKTtcblxuICAgICAgaWYgKGNvbmZpZz8uY3VzdG9tUnVsZXM/LmVuYWJsZWQgJiYgY29uZmlnLmN1c3RvbVJ1bGVzLnJ1bGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tSZXF1ZXN0UHJvY2Vzc29yXSDwn46vIEN1c3RvbSBydWxlcyBlbmFibGVkLCBhcHBseWluZyByZWRhY3Rpb24gcnVsZXMuLi4nKTtcbiAgICAgICAgY29uc29sZS5sb2coJ1tSZXF1ZXN0UHJvY2Vzc29yXSDwn5OdIFRleHQgYmVmb3JlIGN1c3RvbSBydWxlczonLCBtb2RpZmllZFRleHQuc3Vic3RyaW5nKDAsIDIwMCkpO1xuXG4gICAgICAgIC8vIEFwcGx5IGN1c3RvbSByZWRhY3Rpb24gcnVsZXNcbiAgICAgICAgY29uc3QgcnVsZXNSZXN1bHQgPSB0aGlzLnJlZGFjdGlvbkVuZ2luZUluc3RhbmNlLmFwcGx5UnVsZXMobW9kaWZpZWRUZXh0LCBjb25maWcuY3VzdG9tUnVsZXMucnVsZXMpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKGBbUmVxdWVzdFByb2Nlc3Nvcl0g8J+OryBSdWxlcyByZXN1bHQ6ICR7cnVsZXNSZXN1bHQubWF0Y2hlcy5sZW5ndGh9IG1hdGNoZXMsICR7cnVsZXNSZXN1bHQucnVsZXNBcHBsaWVkLmxlbmd0aH0gcnVsZXMgYXBwbGllZGApO1xuICAgICAgICBpZiAocnVsZXNSZXN1bHQubWF0Y2hlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1tSZXF1ZXN0UHJvY2Vzc29yXSDwn5SNIE1hdGNoZXM6JywgcnVsZXNSZXN1bHQubWF0Y2hlcyk7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1tSZXF1ZXN0UHJvY2Vzc29yXSDwn5OdIFRleHQgYWZ0ZXIgY3VzdG9tIHJ1bGVzOicsIHJ1bGVzUmVzdWx0Lm1vZGlmaWVkVGV4dC5zdWJzdHJpbmcoMCwgMjAwKSk7XG4gICAgICAgICAgbW9kaWZpZWRUZXh0ID0gcnVsZXNSZXN1bHQubW9kaWZpZWRUZXh0O1xuXG4gICAgICAgICAgLy8gVXBkYXRlIG1hdGNoIGNvdW50cyBmb3IgcnVsZXNcbiAgICAgICAgICBmb3IgKGNvbnN0IHJ1bGVJZCBvZiBydWxlc1Jlc3VsdC5ydWxlc0FwcGxpZWQpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc3RvcmFnZS5pbmNyZW1lbnRSdWxlTWF0Y2hDb3VudChydWxlSWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnW1JlcXVlc3RQcm9jZXNzb3JdIOKaoO+4jyBObyBtYXRjaGVzIGZvdW5kIGZvciBjdXN0b20gcnVsZXMnKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyA9PT09PT09PT09IEFQSSBLRVkgREVURUNUSU9OID09PT09PT09PT1cblxuICAgICAgLy8gU2VydmljZSBuYW1lIG1hcHBpbmcgZm9yIGFjdGl2aXR5IGxvZ1xuICAgICAgY29uc3Qgc2VydmljZU5hbWUgPSB0aGlzLmdldFNlcnZpY2VOYW1lKHNlcnZpY2UpO1xuXG4gICAgICBpZiAoY29uZmlnPy5hcGlLZXlWYXVsdD8uZW5hYmxlZCkge1xuICAgICAgICBjb25zb2xlLmxvZygnW1JlcXVlc3RQcm9jZXNzb3JdIPCflJAgQVBJIEtleSBWYXVsdCBlbmFibGVkLCBzY2FubmluZyBmb3Iga2V5cy4uLicpO1xuXG4gICAgICAgIC8vIEdldCB1c2VyJ3Mgc3RvcmVkIGtleXNcbiAgICAgICAgY29uc3Qgc3RvcmVkS2V5cyA9IGNvbmZpZy5hcGlLZXlWYXVsdC5rZXlzXG4gICAgICAgICAgLmZpbHRlcigoaykgPT4gay5lbmFibGVkKVxuICAgICAgICAgIC5tYXAoKGspID0+IGsua2V5VmFsdWUpO1xuXG4gICAgICAgIC8vIERldGVybWluZSB3aGljaCBwYXR0ZXJucyB0byBjaGVjayBiYXNlZCBvbiB0aWVyXG4gICAgICAgIGNvbnN0IGlzRnJlZSA9IGNvbmZpZy5hY2NvdW50Py50aWVyID09PSAnZnJlZSc7XG4gICAgICAgIGNvbnN0IGluY2x1ZGVHZW5lcmljID0gIWlzRnJlZTsgLy8gUFJPIG9ubHlcblxuICAgICAgICAvLyBDb252ZXJ0IGN1c3RvbSBwYXR0ZXJucyBmcm9tIHN0cmluZ3MgdG8gUmVnRXhwXG4gICAgICAgIGNvbnN0IGN1c3RvbVBhdHRlcm5zID0gKGNvbmZpZy5hcGlLZXlWYXVsdC5jdXN0b21QYXR0ZXJucyB8fCBbXSkubWFwKFxuICAgICAgICAgIChwYXR0ZXJuOiBzdHJpbmcpID0+IG5ldyBSZWdFeHAocGF0dGVybiwgJ2cnKVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIERldGVjdCBBUEkga2V5c1xuICAgICAgICBjb25zdCBkZXRlY3RlZEtleXMgPSBBUElLZXlEZXRlY3Rvci5kZXRlY3QobW9kaWZpZWRUZXh0LCB7XG4gICAgICAgICAgaW5jbHVkZUdlbmVyaWMsXG4gICAgICAgICAgY3VzdG9tUGF0dGVybnMsXG4gICAgICAgICAgc3RvcmVkS2V5cyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gRmlsdGVyIGRldGVjdGlvbnMgYmFzZWQgb24gRlJFRSB0aWVyIHJlc3RyaWN0aW9uc1xuICAgICAgICBjb25zdCBhbGxvd2VkRGV0ZWN0aW9ucyA9IGlzRnJlZVxuICAgICAgICAgID8gZGV0ZWN0ZWRLZXlzLmZpbHRlcigoazogYW55KSA9PiBrLmZvcm1hdCA9PT0gJ29wZW5haScpXG4gICAgICAgICAgOiBkZXRlY3RlZEtleXM7XG5cbiAgICAgICAgaWYgKGFsbG93ZWREZXRlY3Rpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgW1JlcXVlc3RQcm9jZXNzb3JdIPCflJAgRGV0ZWN0ZWQgJHthbGxvd2VkRGV0ZWN0aW9ucy5sZW5ndGh9IEFQSSBrZXlzIChtb2RlOiAke2NvbmZpZy5hcGlLZXlWYXVsdC5tb2RlfSlgKTtcblxuICAgICAgICAgIC8vIEhhbmRsZSBiYXNlZCBvbiBtb2RlXG4gICAgICAgICAgaWYgKGNvbmZpZy5hcGlLZXlWYXVsdC5tb2RlID09PSAnYXV0by1yZWRhY3QnKSB7XG4gICAgICAgICAgICAvLyBBdXRvLXJlZGFjdCBrZXlzXG4gICAgICAgICAgICBtb2RpZmllZFRleHQgPSBBUElLZXlEZXRlY3Rvci5yZWRhY3QobW9kaWZpZWRUZXh0LCBhbGxvd2VkRGV0ZWN0aW9ucywgJ3BsYWNlaG9sZGVyJyk7XG5cbiAgICAgICAgICAgIC8vIFVwZGF0ZSBzdGF0cyBmb3IgZWFjaCBkZXRlY3RlZCBrZXlcbiAgICAgICAgICAgIGZvciAoY29uc3QgZGV0ZWN0ZWQgb2YgYWxsb3dlZERldGVjdGlvbnMpIHtcbiAgICAgICAgICAgICAgY29uc3Qgc3RvcmVkID0gY29uZmlnLmFwaUtleVZhdWx0LmtleXMuZmluZCgoaykgPT4gay5rZXlWYWx1ZSA9PT0gZGV0ZWN0ZWQudmFsdWUpO1xuICAgICAgICAgICAgICBpZiAoc3RvcmVkKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zdG9yYWdlLmluY3JlbWVudEFQSUtleVByb3RlY3Rpb24oc3RvcmVkLmlkKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBMb2cgYWN0aXZpdHlcbiAgICAgICAgICAgIHRoaXMuYWN0aXZpdHlMb2dnZXIubG9nQWN0aXZpdHkoe1xuICAgICAgICAgICAgICB0eXBlOiAnc3Vic3RpdHV0aW9uJyxcbiAgICAgICAgICAgICAgc2VydmljZTogc2VydmljZSxcbiAgICAgICAgICAgICAgZGV0YWlsczoge1xuICAgICAgICAgICAgICAgIHVybDogc2VydmljZU5hbWUsXG4gICAgICAgICAgICAgICAgYXBpS2V5c1Byb3RlY3RlZDogYWxsb3dlZERldGVjdGlvbnMubGVuZ3RoLFxuICAgICAgICAgICAgICAgIGtleVR5cGVzOiBhbGxvd2VkRGV0ZWN0aW9ucy5tYXAoKGs6IGFueSkgPT4gay5mb3JtYXQpLFxuICAgICAgICAgICAgICAgIHN1YnN0aXR1dGlvbkNvdW50OiBhbGxvd2VkRGV0ZWN0aW9ucy5sZW5ndGgsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IGBBUEkgS2V5czogJHthbGxvd2VkRGV0ZWN0aW9ucy5sZW5ndGh9IGtleXMgcmVkYWN0ZWRgLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbUmVxdWVzdFByb2Nlc3Nvcl0g4pyFIEFQSSBrZXlzIGF1dG8tcmVkYWN0ZWQ6JywgYWxsb3dlZERldGVjdGlvbnMubWFwKChrOiBhbnkpID0+IGsuZm9ybWF0KSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChjb25maWcuYXBpS2V5VmF1bHQubW9kZSA9PT0gJ3dhcm4tZmlyc3QnKSB7XG4gICAgICAgICAgICAvLyBSZXR1cm4gdG8gaW5qZWN0LmpzIHdpdGggd2FybmluZyAtIGxldCB1c2VyIGRlY2lkZVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1tSZXF1ZXN0UHJvY2Vzc29yXSDimqDvuI8gIFdhcm4tZmlyc3QgbW9kZTogUmV0dXJuaW5nIHdhcm5pbmcgdG8gdXNlcicpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgbmVlZHNXYXJuaW5nOiB0cnVlLFxuICAgICAgICAgICAgICBrZXlzRGV0ZWN0ZWQ6IGFsbG93ZWREZXRlY3Rpb25zLmxlbmd0aCxcbiAgICAgICAgICAgICAga2V5VHlwZXM6IGFsbG93ZWREZXRlY3Rpb25zLm1hcCgoaykgPT4gay5mb3JtYXQpLFxuICAgICAgICAgICAgICBvcmlnaW5hbEJvZHk6IHJlcXVlc3RCb2R5LCAvLyBTZW5kIG9yaWdpbmFsIGJhY2sgZm9yIHVzZXIgY2hvaWNlXG4gICAgICAgICAgICAgIG1vZGlmaWVkQm9keTogcmVxdWVzdEJvZHksXG4gICAgICAgICAgICAgIHN1YnN0aXR1dGlvbnM6IHN1YnN0aXR1dGVkLnN1YnN0aXR1dGlvbnMubGVuZ3RoLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGNvbmZpZy5hcGlLZXlWYXVsdC5tb2RlID09PSAnbG9nLW9ubHknKSB7XG4gICAgICAgICAgICAvLyBKdXN0IGxvZywgZG9uJ3QgcmVkYWN0XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW1JlcXVlc3RQcm9jZXNzb3JdIPCfk4sgTG9nLW9ubHkgbW9kZTogS2V5cyBkZXRlY3RlZCBidXQgbm90IHJlZGFjdGVkJyk7XG4gICAgICAgICAgICB0aGlzLmFjdGl2aXR5TG9nZ2VyLmxvZ0FjdGl2aXR5KHtcbiAgICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnLFxuICAgICAgICAgICAgICBzZXJ2aWNlOiBzZXJ2aWNlLFxuICAgICAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICAgICAgdXJsOiBzZXJ2aWNlTmFtZSxcbiAgICAgICAgICAgICAgICBhcGlLZXlzRm91bmQ6IGFsbG93ZWREZXRlY3Rpb25zLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBrZXlUeXBlczogYWxsb3dlZERldGVjdGlvbnMubWFwKChrOiBhbnkpID0+IGsuZm9ybWF0KSxcbiAgICAgICAgICAgICAgICBzdWJzdGl0dXRpb25Db3VudDogMCxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgbWVzc2FnZTogYFdhcm5pbmc6ICR7YWxsb3dlZERldGVjdGlvbnMubGVuZ3RofSBBUEkga2V5cyBmb3VuZCBidXQgbm90IHJlZGFjdGVkIChsb2ctb25seSBtb2RlKWAsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gUmVjb25zdHJ1Y3QgcmVxdWVzdCBib2R5IHdpdGggbW9kaWZpZWQgdGV4dCAoUElJICsgQVBJIGtleXMgc3Vic3RpdHV0ZWQpXG4gICAgICBjb25zdCBtb2RpZmllZFJlcXVlc3REYXRhID0gcmVwbGFjZUFsbFRleHQocmVxdWVzdERhdGEsIG1vZGlmaWVkVGV4dCk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIG1vZGlmaWVkQm9keTogSlNPTi5zdHJpbmdpZnkobW9kaWZpZWRSZXF1ZXN0RGF0YSksXG4gICAgICAgIHN1YnN0aXR1dGlvbnM6IHN1YnN0aXR1dGVkLnN1YnN0aXR1dGlvbnMubGVuZ3RoLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbUmVxdWVzdFByb2Nlc3Nvcl0g4p2MIFJlcXVlc3Qgc3Vic3RpdHV0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBtb2RpZmllZEJvZHk6IHJlcXVlc3RCb2R5LFxuICAgICAgICBzdWJzdGl0dXRpb25zOiAwLFxuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBzZXJ2aWNlIGRpc3BsYXkgbmFtZVxuICAgKi9cbiAgcHJpdmF0ZSBnZXRTZXJ2aWNlTmFtZShzZXJ2aWNlOiBBSVNlcnZpY2UpOiBzdHJpbmcge1xuICAgIHN3aXRjaCAoc2VydmljZSkge1xuICAgICAgY2FzZSAnY2hhdGdwdCc6IHJldHVybiAnQ2hhdEdQVCc7XG4gICAgICBjYXNlICdjbGF1ZGUnOiByZXR1cm4gJ0NsYXVkZSc7XG4gICAgICBjYXNlICdnZW1pbmknOiByZXR1cm4gJ0dlbWluaSc7XG4gICAgICBjYXNlICdwZXJwbGV4aXR5JzogcmV0dXJuICdQZXJwbGV4aXR5JztcbiAgICAgIGNhc2UgJ2NvcGlsb3QnOiByZXR1cm4gJ0NvcGlsb3QnO1xuICAgICAgZGVmYXVsdDogcmV0dXJuICdVbmtub3duJztcbiAgICB9XG4gIH1cbn1cbiIsIi8qKlxuICogU2VydmljZSBEZXRlY3RvclxuICogRGV0ZWN0cyBBSSBzZXJ2aWNlIGZyb20gVVJMXG4gKi9cblxuaW1wb3J0IHR5cGUgeyBBSVNlcnZpY2UgfSBmcm9tICcuLi8uLi9saWIvdHlwZXMnO1xuXG4vKipcbiAqIERldGVjdCBBSSBzZXJ2aWNlIGZyb20gVVJMXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZXRlY3RTZXJ2aWNlKHVybDogc3RyaW5nKTogQUlTZXJ2aWNlIHtcbiAgaWYgKHVybC5pbmNsdWRlcygnb3BlbmFpLmNvbScpIHx8IHVybC5pbmNsdWRlcygnY2hhdGdwdC5jb20nKSkge1xuICAgIHJldHVybiAnY2hhdGdwdCc7XG4gIH1cbiAgaWYgKHVybC5pbmNsdWRlcygnY2xhdWRlLmFpJykpIHtcbiAgICByZXR1cm4gJ2NsYXVkZSc7XG4gIH1cbiAgaWYgKHVybC5pbmNsdWRlcygnZ2VtaW5pLmdvb2dsZS5jb20nKSkge1xuICAgIHJldHVybiAnZ2VtaW5pJztcbiAgfVxuICBpZiAodXJsLmluY2x1ZGVzKCdwZXJwbGV4aXR5LmFpJykpIHtcbiAgICByZXR1cm4gJ3BlcnBsZXhpdHknO1xuICB9XG4gIGlmICh1cmwuaW5jbHVkZXMoJ2NvcGlsb3QubWljcm9zb2Z0LmNvbScpIHx8IHVybC5pbmNsdWRlcygnYmluZy5jb20vc3lkbmV5JykpIHtcbiAgICByZXR1cm4gJ2NvcGlsb3QnO1xuICB9XG4gIHJldHVybiAndW5rbm93bic7XG59XG4iLCIvKipcbiAqIFRleHQgUHJvY2Vzc2luZyBVdGlsaXRpZXNcbiAqIEV4dHJhY3RzIGFuZCByZXBsYWNlcyB0ZXh0IGNvbnRlbnQgaW4gdmFyaW91cyBBSSBzZXJ2aWNlIHJlcXVlc3QvcmVzcG9uc2UgZm9ybWF0c1xuICovXG5cbi8qKlxuICogRXh0cmFjdCBhbGwgdGV4dCBjb250ZW50IGZyb20gcmVxdWVzdCBkYXRhXG4gKiBTdXBwb3J0cyBDaGF0R1BULCBDbGF1ZGUsIEdlbWluaSwgUGVycGxleGl0eSwgQ29waWxvdCwgYW5kIG90aGVyIEFJIHNlcnZpY2UgZm9ybWF0c1xuICovXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdEFsbFRleHQoZGF0YTogYW55KTogc3RyaW5nIHtcbiAgLy8gSGFuZGxlIG51bGwvdW5kZWZpbmVkIGRhdGFcbiAgaWYgKCFkYXRhIHx8IHR5cGVvZiBkYXRhICE9PSAnb2JqZWN0Jykge1xuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIC8vIENvcGlsb3QgV2ViU29ja2V0IGZvcm1hdDogeyBldmVudDogXCJzZW5kXCIsIGNvbnRlbnQ6IFt7IHR5cGU6IFwidGV4dFwiLCB0ZXh0OiBcIi4uLlwiIH1dIH1cbiAgaWYgKGRhdGEuZXZlbnQgPT09ICdzZW5kJyAmJiBBcnJheS5pc0FycmF5KGRhdGEuY29udGVudCkpIHtcbiAgICBjb25zdCB0ZXh0czogc3RyaW5nW10gPSBbXTtcbiAgICBkYXRhLmNvbnRlbnQuZm9yRWFjaCgoaXRlbTogYW55KSA9PiB7XG4gICAgICBpZiAoaXRlbS50eXBlID09PSAndGV4dCcgJiYgdHlwZW9mIGl0ZW0udGV4dCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGV4dHMucHVzaChpdGVtLnRleHQpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGlmICh0ZXh0cy5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gdGV4dHMuam9pbignXFxuXFxuXFxuJyk7IC8vIFRyaXBsZSBuZXdsaW5lIGFzIG1lc3NhZ2Ugc2VwYXJhdG9yXG4gICAgfVxuICB9XG5cbiAgLy8gUGVycGxleGl0eSBmb3JtYXQgMTogeyBxdWVyeV9zdHI6IFwiLi4uXCIsIHBhcmFtczogeyBkc2xfcXVlcnk6IFwiLi4uXCIgfSB9XG4gIC8vIEV4dHJhY3QgYWxsIHF1ZXJ5LXJlbGF0ZWQgZmllbGRzIGFuZCBjb21iaW5lIHRoZW1cbiAgaWYgKGRhdGEucXVlcnlfc3RyICYmIHR5cGVvZiBkYXRhLnF1ZXJ5X3N0ciA9PT0gJ3N0cmluZycpIHtcbiAgICBjb25zdCBxdWVyaWVzID0gW2RhdGEucXVlcnlfc3RyXTtcblxuICAgIC8vIEFsc28gY2hlY2sgZm9yIGRzbF9xdWVyeSBpbiBwYXJhbXNcbiAgICBpZiAoZGF0YS5wYXJhbXM/LmRzbF9xdWVyeSAmJiB0eXBlb2YgZGF0YS5wYXJhbXMuZHNsX3F1ZXJ5ID09PSAnc3RyaW5nJykge1xuICAgICAgcXVlcmllcy5wdXNoKGRhdGEucGFyYW1zLmRzbF9xdWVyeSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHF1ZXJpZXMuam9pbignXFxuXFxuXFxuJyk7IC8vIFRyaXBsZSBuZXdsaW5lIGFzIGZpZWxkIHNlcGFyYXRvclxuICB9XG5cbiAgLy8gUGVycGxleGl0eSBmb3JtYXQgMjogeyBxdWVyeTogXCIuLi5cIiB9XG4gIGlmIChkYXRhLnF1ZXJ5ICYmIHR5cGVvZiBkYXRhLnF1ZXJ5ID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBkYXRhLnF1ZXJ5O1xuICB9XG5cbiAgLy8gQ2hhdEdQVCBmb3JtYXQ6IHsgbWVzc2FnZXM6IFt7IHJvbGUsIGNvbnRlbnQgfV0gfVxuICAvLyBjb250ZW50IGNhbiBiZTpcbiAgLy8gICAtIHN0cmluZzogXCJoZWxsbyB3b3JsZFwiXG4gIC8vICAgLSBvYmplY3Q6IHsgY29udGVudF90eXBlOiBcInRleHRcIiwgcGFydHM6IFtcImhlbGxvIHdvcmxkXCJdIH1cbiAgaWYgKGRhdGEubWVzc2FnZXMgJiYgQXJyYXkuaXNBcnJheShkYXRhLm1lc3NhZ2VzKSkge1xuICAgIHJldHVybiBkYXRhLm1lc3NhZ2VzXG4gICAgICAuZmlsdGVyKChtOiBhbnkpID0+IG0gJiYgdHlwZW9mIG0gPT09ICdvYmplY3QnKSAvLyBGaWx0ZXIgb3V0IG51bGwvdW5kZWZpbmVkIGVsZW1lbnRzXG4gICAgICAubWFwKChtOiBhbnkpID0+IHtcbiAgICAgICAgaWYgKHR5cGVvZiBtLmNvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgcmV0dXJuIG0uY29udGVudDtcbiAgICAgICAgfVxuICAgICAgICAvLyBIYW5kbGUgbmVzdGVkIENoYXRHUFQgZm9ybWF0XG4gICAgICAgIGlmIChtLmNvbnRlbnQ/LnBhcnRzICYmIEFycmF5LmlzQXJyYXkobS5jb250ZW50LnBhcnRzKSkge1xuICAgICAgICAgIHJldHVybiBtLmNvbnRlbnQucGFydHMuam9pbignXFxuJyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gSGFuZGxlIGFycmF5IG9mIGNvbnRlbnQgYmxvY2tzXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KG0uY29udGVudCkpIHtcbiAgICAgICAgICByZXR1cm4gbS5jb250ZW50XG4gICAgICAgICAgICAubWFwKChjOiBhbnkpID0+ICh0eXBlb2YgYyA9PT0gJ3N0cmluZycgPyBjIDogYy50ZXh0IHx8ICcnKSlcbiAgICAgICAgICAgIC5qb2luKCdcXG4nKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJyc7XG4gICAgICB9KVxuICAgICAgLmZpbHRlcihCb29sZWFuKVxuICAgICAgLmpvaW4oJ1xcblxcblxcbicpOyAvLyBUcmlwbGUgbmV3bGluZSBhcyBtZXNzYWdlIHNlcGFyYXRvciAoZGlzdGluY3QgZnJvbSBkb3VibGUgbmV3bGluZSBpbiBjb250ZW50KVxuICB9XG5cbiAgLy8gQ2xhdWRlIGZvcm1hdDogeyBwcm9tcHQ6IFwiLi4uXCIgfSBvciB7IG1lc3NhZ2VzOiBbLi4uXSB9XG4gIGlmIChkYXRhLnByb21wdCAmJiB0eXBlb2YgZGF0YS5wcm9tcHQgPT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIGRhdGEucHJvbXB0O1xuICB9XG5cbiAgLy8gR2VtaW5pIGZvcm1hdDogeyBjb250ZW50czogW3sgcGFydHM6IFt7IHRleHQgfV0gfV0gfVxuICBpZiAoZGF0YS5jb250ZW50cyAmJiBBcnJheS5pc0FycmF5KGRhdGEuY29udGVudHMpKSB7XG4gICAgcmV0dXJuIGRhdGEuY29udGVudHNcbiAgICAgIC5maWx0ZXIoKGM6IGFueSkgPT4gYyAmJiB0eXBlb2YgYyA9PT0gJ29iamVjdCcpIC8vIEZpbHRlciBvdXQgbnVsbC91bmRlZmluZWQgZWxlbWVudHNcbiAgICAgIC5mbGF0TWFwKChjOiBhbnkpID0+IHtcbiAgICAgICAgaWYgKCFjLnBhcnRzIHx8ICFBcnJheS5pc0FycmF5KGMucGFydHMpKSByZXR1cm4gW107XG4gICAgICAgIHJldHVybiBjLnBhcnRzXG4gICAgICAgICAgLmZpbHRlcigocDogYW55KSA9PiBwICYmIHR5cGVvZiBwID09PSAnb2JqZWN0JykgLy8gRmlsdGVyIG91dCBudWxsIHBhcnRzXG4gICAgICAgICAgLm1hcCgocDogYW55KSA9PiBwLnRleHQpO1xuICAgICAgfSlcbiAgICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAgIC5qb2luKCdcXG5cXG5cXG4nKTsgLy8gVHJpcGxlIG5ld2xpbmUgYXMgbWVzc2FnZSBzZXBhcmF0b3IgKGRpc3RpbmN0IGZyb20gZG91YmxlIG5ld2xpbmUgaW4gY29udGVudClcbiAgfVxuXG4gIHJldHVybiAnJztcbn1cblxuLyoqXG4gKiBSZXBsYWNlIGFsbCB0ZXh0IGNvbnRlbnQgaW4gcmVxdWVzdCBkYXRhIHdpdGggc3Vic3RpdHV0ZWQgdGV4dFxuICogTWFpbnRhaW5zIG9yaWdpbmFsIGRhdGEgc3RydWN0dXJlIHdoaWxlIHJlcGxhY2luZyB0ZXh0IGNvbnRlbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlcGxhY2VBbGxUZXh0KGRhdGE6IGFueSwgc3Vic3RpdHV0ZWRUZXh0OiBzdHJpbmcpOiBhbnkge1xuICBjb25zdCBtb2RpZmllZCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOyAvLyBEZWVwIGNsb25lXG5cbiAgLy8gQ29waWxvdCBXZWJTb2NrZXQgZm9ybWF0OiB7IGV2ZW50OiBcInNlbmRcIiwgY29udGVudDogW3sgdHlwZTogXCJ0ZXh0XCIsIHRleHQ6IFwiLi4uXCIgfV0gfVxuICBpZiAobW9kaWZpZWQuZXZlbnQgPT09ICdzZW5kJyAmJiBBcnJheS5pc0FycmF5KG1vZGlmaWVkLmNvbnRlbnQpKSB7XG4gICAgY29uc3QgdGV4dFBhcnRzID0gc3Vic3RpdHV0ZWRUZXh0LnNwbGl0KCdcXG5cXG5cXG4nKS5maWx0ZXIoQm9vbGVhbik7XG4gICAgbGV0IHBhcnRJbmRleCA9IDA7XG5cbiAgICBtb2RpZmllZC5jb250ZW50LmZvckVhY2goKGl0ZW06IGFueSkgPT4ge1xuICAgICAgaWYgKGl0ZW0udHlwZSA9PT0gJ3RleHQnICYmIHR5cGVvZiBpdGVtLnRleHQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGl0ZW0udGV4dCA9IHRleHRQYXJ0c1twYXJ0SW5kZXhdIHx8IHN1YnN0aXR1dGVkVGV4dDtcbiAgICAgICAgcGFydEluZGV4Kys7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gbW9kaWZpZWQ7XG4gIH1cblxuICAvLyBQZXJwbGV4aXR5IGZvcm1hdCAxOiBxdWVyeV9zdHIgKyBkc2xfcXVlcnlcbiAgaWYgKG1vZGlmaWVkLnF1ZXJ5X3N0ciAmJiB0eXBlb2YgbW9kaWZpZWQucXVlcnlfc3RyID09PSAnc3RyaW5nJykge1xuICAgIC8vIFNwbGl0IHN1YnN0aXR1dGVkIHRleHQgYmFjayBpbnRvIHBhcnRzIChpZiB3ZSBjb21iaW5lZCBtdWx0aXBsZSBmaWVsZHMpXG4gICAgY29uc3QgdGV4dFBhcnRzID0gc3Vic3RpdHV0ZWRUZXh0LnNwbGl0KCdcXG5cXG5cXG4nKTtcblxuICAgIG1vZGlmaWVkLnF1ZXJ5X3N0ciA9IHRleHRQYXJ0c1swXSB8fCBzdWJzdGl0dXRlZFRleHQ7XG5cbiAgICAvLyBBbHNvIHVwZGF0ZSBkc2xfcXVlcnkgaWYgaXQgZXhpc3RzXG4gICAgaWYgKG1vZGlmaWVkLnBhcmFtcz8uZHNsX3F1ZXJ5ICYmIHR5cGVvZiBtb2RpZmllZC5wYXJhbXMuZHNsX3F1ZXJ5ID09PSAnc3RyaW5nJykge1xuICAgICAgbW9kaWZpZWQucGFyYW1zLmRzbF9xdWVyeSA9IHRleHRQYXJ0c1sxXSB8fCB0ZXh0UGFydHNbMF0gfHwgc3Vic3RpdHV0ZWRUZXh0O1xuICAgIH1cblxuICAgIHJldHVybiBtb2RpZmllZDtcbiAgfVxuXG4gIC8vIFBlcnBsZXhpdHkgZm9ybWF0IDI6IHF1ZXJ5XG4gIGlmIChtb2RpZmllZC5xdWVyeSAmJiB0eXBlb2YgbW9kaWZpZWQucXVlcnkgPT09ICdzdHJpbmcnKSB7XG4gICAgbW9kaWZpZWQucXVlcnkgPSBzdWJzdGl0dXRlZFRleHQ7XG4gICAgcmV0dXJuIG1vZGlmaWVkO1xuICB9XG5cbiAgLy8gU3BsaXQgc3Vic3RpdHV0ZWQgdGV4dCBiYWNrIGludG8gbWVzc2FnZXNcbiAgLy8gVXNlIHRyaXBsZSBuZXdsaW5lIHRvIHNwbGl0IChtYXRjaGVzIHRoZSB0cmlwbGUgbmV3bGluZSB3ZSB1c2VkIGluIGV4dHJhY3RBbGxUZXh0KVxuICBjb25zdCB0ZXh0UGFydHMgPSBzdWJzdGl0dXRlZFRleHQuc3BsaXQoJ1xcblxcblxcbicpLmZpbHRlcihCb29sZWFuKTtcbiAgbGV0IHBhcnRJbmRleCA9IDA7XG5cbiAgLy8gQ2hhdEdQVCBmb3JtYXRcbiAgaWYgKG1vZGlmaWVkLm1lc3NhZ2VzICYmIEFycmF5LmlzQXJyYXkobW9kaWZpZWQubWVzc2FnZXMpKSB7XG4gICAgbW9kaWZpZWQubWVzc2FnZXMgPSBtb2RpZmllZC5tZXNzYWdlcy5tYXAoKG06IGFueSkgPT4ge1xuICAgICAgaWYgKCFtLmNvbnRlbnQpIHJldHVybiBtO1xuXG4gICAgICAvLyBTdHJpbmcgY29udGVudFxuICAgICAgaWYgKHR5cGVvZiBtLmNvbnRlbnQgPT09ICdzdHJpbmcnICYmIG0uY29udGVudCkge1xuICAgICAgICByZXR1cm4geyAuLi5tLCBjb250ZW50OiB0ZXh0UGFydHNbcGFydEluZGV4KytdIHx8IG0uY29udGVudCB9O1xuICAgICAgfVxuXG4gICAgICAvLyBOZXN0ZWQgb2JqZWN0OiB7IGNvbnRlbnRfdHlwZTogXCJ0ZXh0XCIsIHBhcnRzOiBbLi4uXSB9XG4gICAgICBpZiAobS5jb250ZW50LnBhcnRzICYmIEFycmF5LmlzQXJyYXkobS5jb250ZW50LnBhcnRzKSkge1xuICAgICAgICBjb25zdCBzdWJzdGl0dXRlZCA9IHRleHRQYXJ0c1twYXJ0SW5kZXgrK107XG4gICAgICAgIGlmIChzdWJzdGl0dXRlZCkge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5tLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAuLi5tLmNvbnRlbnQsXG4gICAgICAgICAgICAgIHBhcnRzOiBbc3Vic3RpdHV0ZWRdXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBBcnJheSBvZiBjb250ZW50IGJsb2Nrc1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkobS5jb250ZW50KSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLm0sXG4gICAgICAgICAgY29udGVudDogbS5jb250ZW50Lm1hcCgoYzogYW55KSA9PiB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGMgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0ZXh0UGFydHNbcGFydEluZGV4KytdIHx8IGM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYy50ZXh0KSB7XG4gICAgICAgICAgICAgIHJldHVybiB7IC4uLmMsIHRleHQ6IHRleHRQYXJ0c1twYXJ0SW5kZXgrK10gfHwgYy50ZXh0IH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYztcbiAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIENsYXVkZSBwcm9tcHQgZm9ybWF0XG4gIGlmIChtb2RpZmllZC5wcm9tcHQgJiYgdHlwZW9mIG1vZGlmaWVkLnByb21wdCA9PT0gJ3N0cmluZycpIHtcbiAgICBtb2RpZmllZC5wcm9tcHQgPSBzdWJzdGl0dXRlZFRleHQ7XG4gIH1cblxuICAvLyBHZW1pbmkgZm9ybWF0XG4gIGlmIChtb2RpZmllZC5jb250ZW50cyAmJiBBcnJheS5pc0FycmF5KG1vZGlmaWVkLmNvbnRlbnRzKSkge1xuICAgIG1vZGlmaWVkLmNvbnRlbnRzID0gbW9kaWZpZWQuY29udGVudHMubWFwKChjOiBhbnkpID0+IHtcbiAgICAgIGlmIChjLnBhcnRzICYmIEFycmF5LmlzQXJyYXkoYy5wYXJ0cykpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5jLFxuICAgICAgICAgIHBhcnRzOiBjLnBhcnRzLm1hcCgocDogYW55KSA9PiB7XG4gICAgICAgICAgICBpZiAocC50ZXh0KSB7XG4gICAgICAgICAgICAgIHJldHVybiB7IC4uLnAsIHRleHQ6IHRleHRQYXJ0c1twYXJ0SW5kZXgrK10gfHwgcC50ZXh0IH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcDtcbiAgICAgICAgICB9KSxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBjO1xuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIG1vZGlmaWVkO1xufVxuXG4vKipcbiAqIEFuYWx5emUgdGV4dCBjb250ZW50IGZvciBzdGF0aXN0aWNzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhbmFseXplVGV4dCh0ZXh0OiBzdHJpbmcpOiB7XG4gIHdvcmRDb3VudDogbnVtYmVyO1xuICBjaGFyYWN0ZXJDb3VudDogbnVtYmVyO1xuICBsaW5lQ291bnQ6IG51bWJlcjtcbn0ge1xuICByZXR1cm4ge1xuICAgIHdvcmRDb3VudDogdGV4dC5zcGxpdCgvXFxzKy8pLmZpbHRlcihCb29sZWFuKS5sZW5ndGgsXG4gICAgY2hhcmFjdGVyQ291bnQ6IHRleHQubGVuZ3RoLFxuICAgIGxpbmVDb3VudDogdGV4dC5zcGxpdCgnXFxuJykubGVuZ3RoLFxuICB9O1xufVxuXG4vKipcbiAqIERldGVjdCBpZiBkYXRhIGNvbnRhaW5zIHRleHQgY29udGVudCB0aGF0IGNhbiBiZSBwcm9jZXNzZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhhc1RleHRDb250ZW50KGRhdGE6IGFueSk6IGJvb2xlYW4ge1xuICByZXR1cm4gZXh0cmFjdEFsbFRleHQoZGF0YSkudHJpbSgpLmxlbmd0aCA+IDA7XG59XG5cbi8qKlxuICogRXh0cmFjdCBtZXRhZGF0YSBhYm91dCB0aGUgcmVxdWVzdCBmb3JtYXRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRldGVjdEZvcm1hdChkYXRhOiBhbnkpOiAnY2hhdGdwdCcgfCAnY2xhdWRlJyB8ICdnZW1pbmknIHwgJ3BlcnBsZXhpdHknIHwgJ2NvcGlsb3QnIHwgJ3Vua25vd24nIHtcbiAgLy8gSGFuZGxlIG51bGwvdW5kZWZpbmVkIGRhdGFcbiAgaWYgKCFkYXRhIHx8IHR5cGVvZiBkYXRhICE9PSAnb2JqZWN0Jykge1xuICAgIHJldHVybiAndW5rbm93bic7XG4gIH1cblxuICBpZiAoZGF0YS5ldmVudCA9PT0gJ3NlbmQnICYmIEFycmF5LmlzQXJyYXkoZGF0YS5jb250ZW50KSkge1xuICAgIHJldHVybiAnY29waWxvdCc7XG4gIH1cbiAgaWYgKGRhdGEucXVlcnlfc3RyICYmIHR5cGVvZiBkYXRhLnF1ZXJ5X3N0ciA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gJ3BlcnBsZXhpdHknO1xuICB9XG4gIGlmIChkYXRhLnF1ZXJ5ICYmIHR5cGVvZiBkYXRhLnF1ZXJ5ID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiAncGVycGxleGl0eSc7XG4gIH1cbiAgaWYgKGRhdGEubWVzc2FnZXMgJiYgQXJyYXkuaXNBcnJheShkYXRhLm1lc3NhZ2VzKSkge1xuICAgIHJldHVybiAnY2hhdGdwdCc7XG4gIH1cbiAgaWYgKGRhdGEucHJvbXB0ICYmIHR5cGVvZiBkYXRhLnByb21wdCA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gJ2NsYXVkZSc7XG4gIH1cbiAgaWYgKGRhdGEuY29udGVudHMgJiYgQXJyYXkuaXNBcnJheShkYXRhLmNvbnRlbnRzKSkge1xuICAgIHJldHVybiAnZ2VtaW5pJztcbiAgfVxuICByZXR1cm4gJ3Vua25vd24nO1xufVxuIiwiLyoqXG4gKiBSZXNwb25zZSBQcm9jZXNzb3JcbiAqIEhhbmRsZXMgcmVzcG9uc2UgdGV4dCBzdWJzdGl0dXRpb24gKGFsaWFzIOKGkiByZWFsKVxuICovXG5cbmltcG9ydCB7IFN0b3JhZ2VNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vbGliL3N0b3JhZ2UnO1xuaW1wb3J0IHsgQWxpYXNFbmdpbmUgfSBmcm9tICcuLi8uLi9saWIvYWxpYXNFbmdpbmUnO1xuXG5leHBvcnQgY2xhc3MgUmVzcG9uc2VQcm9jZXNzb3Ige1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHN0b3JhZ2U6IFN0b3JhZ2VNYW5hZ2VyLFxuICAgIHByaXZhdGUgYWxpYXNFbmdpbmU6IEFsaWFzRW5naW5lXG4gICkge31cblxuICAvKipcbiAgICogUHJvY2VzcyByZXNwb25zZSB0ZXh0IC0gc3Vic3RpdHV0ZSBhbGlhc2VzIGJhY2sgdG8gcmVhbCBkYXRhXG4gICAqL1xuICBhc3luYyBwcm9jZXNzUmVzcG9uc2UoXG4gICAgcmVzcG9uc2VUZXh0OiBzdHJpbmcsXG4gICAgX3VybD86IHN0cmluZ1xuICApOiBQcm9taXNlPHtcbiAgICBzdWNjZXNzOiBib29sZWFuO1xuICAgIG1vZGlmaWVkVGV4dDogc3RyaW5nO1xuICAgIHN1YnN0aXR1dGlvbnM6IG51bWJlcjtcbiAgICBlcnJvcj86IHN0cmluZztcbiAgfT4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAoIXJlc3BvbnNlVGV4dCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgbW9kaWZpZWRUZXh0OiByZXNwb25zZVRleHQsXG4gICAgICAgICAgc3Vic3RpdHV0aW9uczogMCxcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgcmVzcG9uc2UgZGVjb2RpbmcgaXMgZW5hYmxlZFxuICAgICAgY29uc3QgY29uZmlnID0gYXdhaXQgdGhpcy5zdG9yYWdlLmxvYWRDb25maWcoKTtcblxuICAgICAgaWYgKCFjb25maWc/LnNldHRpbmdzPy5kZWNvZGVSZXNwb25zZXMpIHtcbiAgICAgICAgLy8gRGVjb2RpbmcgZGlzYWJsZWQgLSByZXR1cm4gb3JpZ2luYWwgdGV4dCB3aXRoIGFsaWFzZXNcbiAgICAgICAgY29uc29sZS5sb2coJ1tSZXNwb25zZVByb2Nlc3Nvcl0g4oS577iPIFJlc3BvbnNlIGRlY29kaW5nIGRpc2FibGVkIC0ga2VlcGluZyBhbGlhc2VzIGluIHJlc3BvbnNlJyk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBtb2RpZmllZFRleHQ6IHJlc3BvbnNlVGV4dCxcbiAgICAgICAgICBzdWJzdGl0dXRpb25zOiAwLFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICAvLyBBcHBseSByZXZlcnNlIHN1YnN0aXR1dGlvbiAoYWxpYXMg4oaSIHJlYWwpXG4gICAgICBjb25zdCBkZWNvZGVkID0gdGhpcy5hbGlhc0VuZ2luZS5zdWJzdGl0dXRlKHJlc3BvbnNlVGV4dCwgJ2RlY29kZScpO1xuXG4gICAgICBpZiAoZGVjb2RlZC5zdWJzdGl0dXRpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tSZXNwb25zZVByb2Nlc3Nvcl0g4pyFIERlY29kZWQ6JywgZGVjb2RlZC5zdWJzdGl0dXRpb25zLmxlbmd0aCwgJ3JlcGxhY2VtZW50cycpO1xuICAgICAgICBjb25zb2xlLmxvZygnW1Jlc3BvbnNlUHJvY2Vzc29yXSBSZXBsYWNlbWVudHMgbWFkZTonLCBkZWNvZGVkLnN1YnN0aXR1dGlvbnMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBtb2RpZmllZFRleHQ6IGRlY29kZWQudGV4dCxcbiAgICAgICAgc3Vic3RpdHV0aW9uczogZGVjb2RlZC5zdWJzdGl0dXRpb25zLmxlbmd0aCxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc29sZS5lcnJvcignW1Jlc3BvbnNlUHJvY2Vzc29yXSDinYwgUmVzcG9uc2Ugc3Vic3RpdHV0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBtb2RpZmllZFRleHQ6IHJlc3BvbnNlVGV4dCxcbiAgICAgICAgc3Vic3RpdHV0aW9uczogMCxcbiAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXG4gICAgICB9O1xuICAgIH1cbiAgfVxufVxuIiwiLyoqXG4gKiBNZXNzYWdlIFJvdXRlclxuICogUm91dGVzIG1lc3NhZ2VzIHRvIGFwcHJvcHJpYXRlIGhhbmRsZXJzXG4gKi9cblxuaW1wb3J0IHsgU3RvcmFnZU1hbmFnZXIgfSBmcm9tICcuLi8uLi9saWIvc3RvcmFnZSc7XG5pbXBvcnQgeyBNZXNzYWdlIH0gZnJvbSAnLi4vLi4vbGliL3R5cGVzJztcbmltcG9ydCB7IEFsaWFzSGFuZGxlcnMgfSBmcm9tICcuL0FsaWFzSGFuZGxlcnMnO1xuaW1wb3J0IHsgQ29uZmlnSGFuZGxlcnMgfSBmcm9tICcuL0NvbmZpZ0hhbmRsZXJzJztcbmltcG9ydCB7IEFQSUtleUhhbmRsZXJzIH0gZnJvbSAnLi9BUElLZXlIYW5kbGVycyc7XG5pbXBvcnQgeyBDdXN0b21SdWxlc0hhbmRsZXJzIH0gZnJvbSAnLi9DdXN0b21SdWxlc0hhbmRsZXJzJztcbmltcG9ydCB7IFJlcXVlc3RQcm9jZXNzb3IgfSBmcm9tICcuLi9wcm9jZXNzb3JzL1JlcXVlc3RQcm9jZXNzb3InO1xuaW1wb3J0IHsgUmVzcG9uc2VQcm9jZXNzb3IgfSBmcm9tICcuLi9wcm9jZXNzb3JzL1Jlc3BvbnNlUHJvY2Vzc29yJztcbmltcG9ydCB7IEJhZGdlTWFuYWdlciB9IGZyb20gJy4uL21hbmFnZXJzL0JhZGdlTWFuYWdlcic7XG5pbXBvcnQgeyBDb250ZW50U2NyaXB0TWFuYWdlciB9IGZyb20gJy4uL21hbmFnZXJzL0NvbnRlbnRTY3JpcHRNYW5hZ2VyJztcblxuLyoqXG4gKiBEZWJ1ZyBtb2RlIC0gc2V0IHRvIGZhbHNlIGZvciBwcm9kdWN0aW9uIHRvIHJlZHVjZSBsb2cgc3BhbVxuICovXG5jb25zdCBERUJVR19NT0RFID0gZmFsc2U7XG5cbmV4cG9ydCBjbGFzcyBNZXNzYWdlUm91dGVyIHtcbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBzdG9yYWdlOiBTdG9yYWdlTWFuYWdlcixcbiAgICBwcml2YXRlIGFsaWFzSGFuZGxlcnM6IEFsaWFzSGFuZGxlcnMsXG4gICAgcHJpdmF0ZSBjb25maWdIYW5kbGVyczogQ29uZmlnSGFuZGxlcnMsXG4gICAgcHJpdmF0ZSBhcGlLZXlIYW5kbGVyczogQVBJS2V5SGFuZGxlcnMsXG4gICAgcHJpdmF0ZSBjdXN0b21SdWxlc0hhbmRsZXJzOiBDdXN0b21SdWxlc0hhbmRsZXJzLFxuICAgIHByaXZhdGUgcmVxdWVzdFByb2Nlc3NvcjogUmVxdWVzdFByb2Nlc3NvcixcbiAgICBwcml2YXRlIHJlc3BvbnNlUHJvY2Vzc29yOiBSZXNwb25zZVByb2Nlc3NvcixcbiAgICBwcml2YXRlIGJhZGdlTWFuYWdlcjogQmFkZ2VNYW5hZ2VyLFxuICAgIHByaXZhdGUgY29udGVudFNjcmlwdE1hbmFnZXI6IENvbnRlbnRTY3JpcHRNYW5hZ2VyXG4gICkge31cblxuICAvKipcbiAgICogUm91dGUgbWVzc2FnZXMgdG8gYXBwcm9wcmlhdGUgaGFuZGxlcnNcbiAgICovXG4gIGFzeW5jIGhhbmRsZU1lc3NhZ2UobWVzc2FnZTogTWVzc2FnZSwgc2VuZGVyOiBjaHJvbWUucnVudGltZS5NZXNzYWdlU2VuZGVyKTogUHJvbWlzZTxhbnk+IHtcbiAgICBzd2l0Y2ggKG1lc3NhZ2UudHlwZSkge1xuICAgICAgY2FzZSAnSEVBTFRIX0NIRUNLJzoge1xuICAgICAgICAvLyBIZWFsdGggY2hlY2sgYWxzbyByZXBvcnRzIHByb3RlY3Rpb24gc3RhdHVzIGJhY2sgdG8gdGFiXG4gICAgICAgIGNvbnN0IHNlbmRlclRhYklkID0gbWVzc2FnZS50YWJJZCB8fCBzZW5kZXI/LnRhYj8uaWQ7XG5cbiAgICAgICAgaWYgKHNlbmRlclRhYklkKSB7XG4gICAgICAgICAgaWYgKERFQlVHX01PREUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbTWVzc2FnZVJvdXRlcl0gSGVhbHRoIGNoZWNrIHBhc3NlZCBmb3IgdGFiICR7c2VuZGVyVGFiSWR9YCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gVXBkYXRlIGJhZGdlIHRvIHByb3RlY3RlZCAoaGVhbHRoIGNoZWNrcyBhcmUgcGFzc2luZylcbiAgICAgICAgICBjb25zdCBjb25maWcgPSBhd2FpdCB0aGlzLnN0b3JhZ2UubG9hZENvbmZpZygpO1xuXG4gICAgICAgICAgaWYgKGNvbmZpZz8uc2V0dGluZ3M/LmVuYWJsZWQpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYmFkZ2VNYW5hZ2VyLnVwZGF0ZUJhZGdlKHNlbmRlclRhYklkLCAncHJvdGVjdGVkJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgc3RhdHVzOiAnb2snIH07XG4gICAgICB9XG5cbiAgICAgIGNhc2UgJ1BST1RFQ1RJT05fTE9TVCc6IHtcbiAgICAgICAgLy8gR2V0IHRhYklkIGZyb20gbWVzc2FnZSBzZW5kZXIgKGNvbnRlbnQudHMgZG9lc24ndCBoYXZlIGFjY2VzcyB0byBjaHJvbWUudGFicy5nZXRDdXJyZW50KVxuICAgICAgICBjb25zdCB0YWJJZCA9IG1lc3NhZ2UudGFiSWQgfHwgc2VuZGVyPy50YWI/LmlkO1xuICAgICAgICBpZiAodGFiSWQpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgW01lc3NhZ2VSb3V0ZXJdIFByb3RlY3Rpb24gbG9zdCBmb3IgdGFiICR7dGFiSWR9YCk7XG4gICAgICAgICAgYXdhaXQgdGhpcy5iYWRnZU1hbmFnZXIudXBkYXRlQmFkZ2UodGFiSWQsICd1bnByb3RlY3RlZCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUud2FybignW01lc3NhZ2VSb3V0ZXJdIFBST1RFQ1RJT05fTE9TVCByZWNlaXZlZCBidXQgbm8gdGFiSWQgYXZhaWxhYmxlJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xuICAgICAgfVxuXG4gICAgICBjYXNlICdESVNBQkxFX0VYVEVOU0lPTic6IHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tNZXNzYWdlUm91dGVyXSBVc2VyIHJlcXVlc3RlZCBleHRlbnNpb24gZGlzYWJsZScpO1xuXG4gICAgICAgIC8vIFVwZGF0ZSBjb25maWcgdG8gZGlzYWJsZSBleHRlbnNpb25cbiAgICAgICAgY29uc3QgY3VycmVudENvbmZpZyA9IGF3YWl0IHRoaXMuc3RvcmFnZS5sb2FkQ29uZmlnKCk7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRDb25maWcpIHtcbiAgICAgICAgICBhd2FpdCB0aGlzLnN0b3JhZ2Uuc2F2ZUNvbmZpZyh7XG4gICAgICAgICAgICAuLi5jdXJyZW50Q29uZmlnLFxuICAgICAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICAgICAgLi4uY3VycmVudENvbmZpZy5zZXR0aW5ncyxcbiAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGNvbnNvbGUubG9nKCdbTWVzc2FnZVJvdXRlcl0g4pyFIEV4dGVuc2lvbiBkaXNhYmxlZCcpO1xuXG4gICAgICAgICAgLy8gVXBkYXRlIGFsbCBiYWRnZXMgdG8gc2hvdyBkaXNhYmxlZCBzdGF0ZVxuICAgICAgICAgIGNvbnN0IHRhYnMgPSBhd2FpdCBjaHJvbWUudGFicy5xdWVyeSh7fSk7XG4gICAgICAgICAgZm9yIChjb25zdCB0YWIgb2YgdGFicykge1xuICAgICAgICAgICAgaWYgKHRhYi5pZCkge1xuICAgICAgICAgICAgICBhd2FpdCB0aGlzLmJhZGdlTWFuYWdlci5jaGVja0FuZFVwZGF0ZUJhZGdlKHRhYi5pZCwgdGFiLnVybCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xuICAgICAgfVxuXG4gICAgICBjYXNlICdTVUJTVElUVVRFX1JFUVVFU1QnOlxuICAgICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0UHJvY2Vzc29yLnByb2Nlc3NSZXF1ZXN0KFxuICAgICAgICAgIG1lc3NhZ2UucGF5bG9hZC5ib2R5LFxuICAgICAgICAgIG1lc3NhZ2UudGFiSWQsXG4gICAgICAgICAgbWVzc2FnZS5wYXlsb2FkLnVybFxuICAgICAgICApO1xuXG4gICAgICBjYXNlICdTVUJTVElUVVRFX1JFU1BPTlNFJzpcbiAgICAgICAgcmV0dXJuIHRoaXMucmVzcG9uc2VQcm9jZXNzb3IucHJvY2Vzc1Jlc3BvbnNlKFxuICAgICAgICAgIG1lc3NhZ2UucGF5bG9hZC50ZXh0LFxuICAgICAgICAgIG1lc3NhZ2UucGF5bG9hZC51cmxcbiAgICAgICAgKTtcblxuICAgICAgY2FzZSAnUkVMT0FEX1BST0ZJTEVTJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuYWxpYXNIYW5kbGVycy5oYW5kbGVSZWxvYWRQcm9maWxlcygpO1xuXG4gICAgICBjYXNlICdHRVRfQUxJQVNFUyc6XG4gICAgICAgIHJldHVybiB0aGlzLmFsaWFzSGFuZGxlcnMuaGFuZGxlR2V0QWxpYXNlcygpO1xuXG4gICAgICBjYXNlICdHRVRfUFJPRklMRVMnOlxuICAgICAgICByZXR1cm4gdGhpcy5hbGlhc0hhbmRsZXJzLmhhbmRsZUdldFByb2ZpbGVzKCk7XG5cbiAgICAgIGNhc2UgJ0FERF9BTElBUyc6XG4gICAgICAgIHJldHVybiB0aGlzLmFsaWFzSGFuZGxlcnMuaGFuZGxlQWRkQWxpYXMobWVzc2FnZS5wYXlsb2FkKTtcblxuICAgICAgY2FzZSAnUkVNT1ZFX0FMSUFTJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuYWxpYXNIYW5kbGVycy5oYW5kbGVSZW1vdmVBbGlhcyhtZXNzYWdlLnBheWxvYWQpO1xuXG4gICAgICBjYXNlICdVUERBVEVfQ09ORklHJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uZmlnSGFuZGxlcnMuaGFuZGxlVXBkYXRlQ29uZmlnKG1lc3NhZ2UucGF5bG9hZCk7XG5cbiAgICAgIGNhc2UgJ0dFVF9DT05GSUcnOlxuICAgICAgICByZXR1cm4gdGhpcy5jb25maWdIYW5kbGVycy5oYW5kbGVHZXRDb25maWcoKTtcblxuICAgICAgY2FzZSAnUkVJTkpFQ1RfQ09OVEVOVF9TQ1JJUFRTJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGVudFNjcmlwdE1hbmFnZXIuaGFuZGxlUmVpbmplY3QoKTtcblxuICAgICAgY2FzZSAnQUREX0FQSV9LRVknOlxuICAgICAgICByZXR1cm4gdGhpcy5hcGlLZXlIYW5kbGVycy5oYW5kbGVBZGRBUElLZXkobWVzc2FnZS5wYXlsb2FkKTtcblxuICAgICAgY2FzZSAnUkVNT1ZFX0FQSV9LRVknOlxuICAgICAgICByZXR1cm4gdGhpcy5hcGlLZXlIYW5kbGVycy5oYW5kbGVSZW1vdmVBUElLZXkobWVzc2FnZS5wYXlsb2FkKTtcblxuICAgICAgY2FzZSAnVVBEQVRFX0FQSV9LRVknOlxuICAgICAgICByZXR1cm4gdGhpcy5hcGlLZXlIYW5kbGVycy5oYW5kbGVVcGRhdGVBUElLZXkobWVzc2FnZS5wYXlsb2FkKTtcblxuICAgICAgY2FzZSAnR0VUX0FQSV9LRVlTJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBpS2V5SGFuZGxlcnMuaGFuZGxlR2V0QVBJS2V5cygpO1xuXG4gICAgICBjYXNlICdVUERBVEVfQVBJX0tFWV9WQVVMVF9TRVRUSU5HUyc6XG4gICAgICAgIHJldHVybiB0aGlzLmFwaUtleUhhbmRsZXJzLmhhbmRsZVVwZGF0ZUFQSUtleVZhdWx0U2V0dGluZ3MobWVzc2FnZS5wYXlsb2FkKTtcblxuICAgICAgY2FzZSAnQUREX0NVU1RPTV9SVUxFJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuY3VzdG9tUnVsZXNIYW5kbGVycy5oYW5kbGVBZGRDdXN0b21SdWxlKG1lc3NhZ2UucGF5bG9hZCk7XG5cbiAgICAgIGNhc2UgJ1JFTU9WRV9DVVNUT01fUlVMRSc6XG4gICAgICAgIHJldHVybiB0aGlzLmN1c3RvbVJ1bGVzSGFuZGxlcnMuaGFuZGxlUmVtb3ZlQ3VzdG9tUnVsZShtZXNzYWdlLnBheWxvYWQpO1xuXG4gICAgICBjYXNlICdVUERBVEVfQ1VTVE9NX1JVTEUnOlxuICAgICAgICByZXR1cm4gdGhpcy5jdXN0b21SdWxlc0hhbmRsZXJzLmhhbmRsZVVwZGF0ZUN1c3RvbVJ1bGUobWVzc2FnZS5wYXlsb2FkKTtcblxuICAgICAgY2FzZSAnVE9HR0xFX0NVU1RPTV9SVUxFJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuY3VzdG9tUnVsZXNIYW5kbGVycy5oYW5kbGVUb2dnbGVDdXN0b21SdWxlKG1lc3NhZ2UucGF5bG9hZCk7XG5cbiAgICAgIGNhc2UgJ1VQREFURV9DVVNUT01fUlVMRVNfU0VUVElOR1MnOlxuICAgICAgICByZXR1cm4gdGhpcy5jdXN0b21SdWxlc0hhbmRsZXJzLmhhbmRsZVVwZGF0ZUN1c3RvbVJ1bGVzU2V0dGluZ3MobWVzc2FnZS5wYXlsb2FkKTtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIG1lc3NhZ2UgdHlwZTogJHttZXNzYWdlLnR5cGV9YCk7XG4gICAgfVxuICB9XG59XG4iLCIvKipcbiAqIEFsaWFzIEhhbmRsZXJzXG4gKiBIYW5kbGVzIGFsaWFzIGFuZCBwcm9maWxlLXJlbGF0ZWQgbWVzc2FnZXMgZnJvbSBwb3B1cC9jb250ZW50IHNjcmlwdHNcbiAqL1xuXG5pbXBvcnQgeyBTdG9yYWdlTWFuYWdlciB9IGZyb20gJy4uLy4uL2xpYi9zdG9yYWdlJztcbmltcG9ydCB7IEFsaWFzRW5naW5lIH0gZnJvbSAnLi4vLi4vbGliL2FsaWFzRW5naW5lJztcblxuZXhwb3J0IGNsYXNzIEFsaWFzSGFuZGxlcnMge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHN0b3JhZ2U6IFN0b3JhZ2VNYW5hZ2VyLFxuICAgIHByaXZhdGUgYWxpYXNFbmdpbmU6IEFsaWFzRW5naW5lXG4gICkge31cblxuICAvKipcbiAgICogR2V0IGFsbCBhbGlhc2VzXG4gICAqL1xuICBhc3luYyBoYW5kbGVHZXRBbGlhc2VzKCk6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuOyBkYXRhPzogYW55OyBlcnJvcj86IHN0cmluZyB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGFsaWFzZXMgPSBhd2FpdCB0aGlzLnN0b3JhZ2UubG9hZEFsaWFzZXMoKTtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGFsaWFzZXMgfTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGFsbCBwcm9maWxlcyAoVjIpIC0gZm9yIEdlbWluaSBvYnNlcnZlclxuICAgKi9cbiAgYXN5bmMgaGFuZGxlR2V0UHJvZmlsZXMoKTogUHJvbWlzZTx7IHN1Y2Nlc3M6IGJvb2xlYW47IGRhdGE/OiBhbnk7IGVycm9yPzogc3RyaW5nIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcHJvZmlsZXMgPSBhd2FpdCB0aGlzLnN0b3JhZ2UubG9hZFByb2ZpbGVzKCk7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBwcm9maWxlcyB9O1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgbmV3IGFsaWFzXG4gICAqL1xuICBhc3luYyBoYW5kbGVBZGRBbGlhcyhwYXlsb2FkOiBhbnkpOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbjsgZGF0YT86IGFueTsgZXJyb3I/OiBzdHJpbmcgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBuZXdBbGlhcyA9IGF3YWl0IHRoaXMuc3RvcmFnZS5hZGRBbGlhcyhwYXlsb2FkKTtcblxuICAgICAgLy8gUmVsb2FkIGFsaWFzIGVuZ2luZVxuICAgICAgYXdhaXQgdGhpcy5hbGlhc0VuZ2luZS5yZWxvYWQoKTtcblxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogbmV3QWxpYXMgfTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGFsaWFzXG4gICAqL1xuICBhc3luYyBoYW5kbGVSZW1vdmVBbGlhcyhwYXlsb2FkOiB7IGlkOiBzdHJpbmcgfSk6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuc3RvcmFnZS5yZW1vdmVBbGlhcyhwYXlsb2FkLmlkKTtcblxuICAgICAgLy8gUmVsb2FkIGFsaWFzIGVuZ2luZVxuICAgICAgYXdhaXQgdGhpcy5hbGlhc0VuZ2luZS5yZWxvYWQoKTtcblxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZWxvYWQgcHJvZmlsZXMgaW4gQWxpYXNFbmdpbmVcbiAgICogQ2FsbGVkIHdoZW4gcHJvZmlsZXMgYXJlIGFkZGVkL3VwZGF0ZWQvZGVsZXRlZCBmcm9tIHBvcHVwXG4gICAqL1xuICBhc3luYyBoYW5kbGVSZWxvYWRQcm9maWxlcygpOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbjsgcHJvZmlsZUNvdW50OiBudW1iZXIgfT4ge1xuICAgIGNvbnNvbGUubG9nKCdbQWxpYXNIYW5kbGVyc10gUmVsb2FkaW5nIHByb2ZpbGVzLi4uJyk7XG4gICAgYXdhaXQgdGhpcy5hbGlhc0VuZ2luZS5yZWxvYWQoKTtcbiAgICBjb25zdCBwcm9maWxlcyA9IHRoaXMuYWxpYXNFbmdpbmUuZ2V0UHJvZmlsZXMoKTtcbiAgICBjb25zb2xlLmxvZygnW0FsaWFzSGFuZGxlcnNdIOKchSBQcm9maWxlcyByZWxvYWRlZDonLCBwcm9maWxlcy5sZW5ndGgsICdhY3RpdmUgcHJvZmlsZXMnKTtcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBwcm9maWxlQ291bnQ6IHByb2ZpbGVzLmxlbmd0aCB9O1xuICB9XG59XG4iLCIvKipcbiAqIENvbmZpZyBIYW5kbGVyc1xuICogSGFuZGxlcyBjb25maWd1cmF0aW9uLXJlbGF0ZWQgbWVzc2FnZXMgZnJvbSBwb3B1cC9jb250ZW50IHNjcmlwdHNcbiAqL1xuXG5pbXBvcnQgeyBTdG9yYWdlTWFuYWdlciB9IGZyb20gJy4uLy4uL2xpYi9zdG9yYWdlJztcblxuZXhwb3J0IGNsYXNzIENvbmZpZ0hhbmRsZXJzIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBzdG9yYWdlOiBTdG9yYWdlTWFuYWdlcikge31cblxuICAvKipcbiAgICogVXBkYXRlIGNvbmZpZ3VyYXRpb25cbiAgICovXG4gIGFzeW5jIGhhbmRsZVVwZGF0ZUNvbmZpZyhwYXlsb2FkOiBhbnkpOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmcgfT4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnN0b3JhZ2Uuc2F2ZUNvbmZpZyhwYXlsb2FkKTtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGNvbmZpZ3VyYXRpb25cbiAgICovXG4gIGFzeW5jIGhhbmRsZUdldENvbmZpZygpOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbjsgZGF0YT86IGFueTsgZXJyb3I/OiBzdHJpbmcgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb25maWcgPSBhd2FpdCB0aGlzLnN0b3JhZ2UubG9hZENvbmZpZygpO1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogY29uZmlnIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIElmIGNvbmZpZyBsb2FkaW5nIGZhaWxzIGR1ZSB0byBhdXRoLCByZXR1cm4gYSBkZWZhdWx0IGRpc2FibGVkIGNvbmZpZ1xuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnRU5DUllQVElPTl9LRVlfVU5BVkFJTEFCTEUnKSkge1xuICAgICAgICBjb25zb2xlLmxvZygnW0NvbmZpZ0hhbmRsZXJzXSBDb25maWcgcmVxdWVzdGVkIGJ1dCB1c2VyIG5vdCBhdXRoZW50aWNhdGVkIC0gcmV0dXJuaW5nIGRlZmF1bHQgY29uZmlnJyk7XG4gICAgICAgIC8vIFJldHVybiBhIHNhZmUgZGVmYXVsdCBjb25maWdcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIHNldHRpbmdzOiB7IGVuYWJsZWQ6IGZhbHNlIH0sXG4gICAgICAgICAgICBmZWF0dXJlczoge30sXG4gICAgICAgICAgICBzdGF0czogeyB0b3RhbFN1YnN0aXR1dGlvbnM6IDAsIHRvdGFsSW50ZXJjZXB0aW9uczogMCwgYnlTZXJ2aWNlOiB7fSB9LFxuICAgICAgICAgICAgYWNjb3VudDogeyB0aWVyOiAnZnJlZScgfVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tDb25maWdIYW5kbGVyc10gRXJyb3IgbG9hZGluZyBjb25maWc6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyB9O1xuICAgIH1cbiAgfVxufVxuIiwiLyoqXG4gKiBBUEkgS2V5IEhhbmRsZXJzXG4gKiBIYW5kbGVzIEFQSSBLZXkgVmF1bHQtcmVsYXRlZCBtZXNzYWdlcyBmcm9tIHBvcHVwXG4gKi9cblxuaW1wb3J0IHsgU3RvcmFnZU1hbmFnZXIgfSBmcm9tICcuLi8uLi9saWIvc3RvcmFnZSc7XG5pbXBvcnQgdHlwZSB7IEFQSUtleUZvcm1hdCwgQVBJS2V5LCBBUElLZXlWYXVsdENvbmZpZyB9IGZyb20gJy4uLy4uL2xpYi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBBUElLZXlIYW5kbGVycyB7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgc3RvcmFnZTogU3RvcmFnZU1hbmFnZXIpIHt9XG5cbiAgLyoqXG4gICAqIEhhbmRsZSBBRERfQVBJX0tFWSBtZXNzYWdlIGZyb20gcG9wdXBcbiAgICovXG4gIGFzeW5jIGhhbmRsZUFkZEFQSUtleShwYXlsb2FkOiB7XG4gICAgbmFtZT86IHN0cmluZztcbiAgICBrZXlWYWx1ZTogc3RyaW5nO1xuICAgIGZvcm1hdD86IEFQSUtleUZvcm1hdFxuICB9KTogUHJvbWlzZTx7IHN1Y2Nlc3M6IGJvb2xlYW47IGRhdGE/OiBhbnk7IGVycm9yPzogc3RyaW5nOyBtZXNzYWdlPzogc3RyaW5nIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgbmV3S2V5ID0gYXdhaXQgdGhpcy5zdG9yYWdlLmFkZEFQSUtleShwYXlsb2FkKTtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IG5ld0tleSB9O1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tBUElLZXlIYW5kbGVyc10gRmFpbGVkIHRvIGFkZCBBUEkga2V5OicsIGVycm9yKTtcblxuICAgICAgLy8gQ2hlY2sgZm9yIEZSRUUgdGllciBsaW1pdHNcbiAgICAgIGlmIChlcnJvci5tZXNzYWdlLnN0YXJ0c1dpdGgoJ0ZSRUVfVElFUl9MSU1JVCcpKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6ICdGUkVFX1RJRVJfTElNSVQnLFxuICAgICAgICAgIG1lc3NhZ2U6ICdZb3UgaGF2ZSByZWFjaGVkIHRoZSBGUkVFIHRpZXIgbGltaXQgb2YgMTAgQVBJIGtleXMuIFVwZ3JhZGUgdG8gUFJPIGZvciB1bmxpbWl0ZWQga2V5cy4nLFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICBpZiAoZXJyb3IubWVzc2FnZS5zdGFydHNXaXRoKCdGUkVFX1RJRVJfUEFUVEVSTicpKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6ICdGUkVFX1RJRVJfUEFUVEVSTicsXG4gICAgICAgICAgbWVzc2FnZTogJ0ZSRUUgdGllciBvbmx5IHN1cHBvcnRzIE9wZW5BSSBrZXkgZGV0ZWN0aW9uLiBVcGdyYWRlIHRvIFBSTyBmb3IgR2l0SHViLCBBV1MsIFN0cmlwZSwgYW5kIG90aGVyIHBhdHRlcm5zLicsXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGUgUkVNT1ZFX0FQSV9LRVkgbWVzc2FnZSBmcm9tIHBvcHVwXG4gICAqL1xuICBhc3luYyBoYW5kbGVSZW1vdmVBUElLZXkocGF5bG9hZDogeyBpZDogc3RyaW5nIH0pOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmcgfT4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnN0b3JhZ2UucmVtb3ZlQVBJS2V5KHBheWxvYWQuaWQpO1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tBUElLZXlIYW5kbGVyc10gRmFpbGVkIHRvIHJlbW92ZSBBUEkga2V5OicsIGVycm9yKTtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGUgVVBEQVRFX0FQSV9LRVkgbWVzc2FnZSBmcm9tIHBvcHVwXG4gICAqL1xuICBhc3luYyBoYW5kbGVVcGRhdGVBUElLZXkocGF5bG9hZDoge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgdXBkYXRlczogUGFydGlhbDxBUElLZXk+XG4gIH0pOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmcgfT4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnN0b3JhZ2UudXBkYXRlQVBJS2V5KHBheWxvYWQuaWQsIHBheWxvYWQudXBkYXRlcyk7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc29sZS5lcnJvcignW0FQSUtleUhhbmRsZXJzXSBGYWlsZWQgdG8gdXBkYXRlIEFQSSBrZXk6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZSBHRVRfQVBJX0tFWVMgbWVzc2FnZSBmcm9tIHBvcHVwXG4gICAqL1xuICBhc3luYyBoYW5kbGVHZXRBUElLZXlzKCk6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuOyBkYXRhPzogYW55OyBlcnJvcj86IHN0cmluZyB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGtleXMgPSBhd2FpdCB0aGlzLnN0b3JhZ2UuZ2V0QWxsQVBJS2V5cygpO1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YToga2V5cyB9O1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tBUElLZXlIYW5kbGVyc10gRmFpbGVkIHRvIGdldCBBUEkga2V5czonLCBlcnJvcik7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlIFVQREFURV9BUElfS0VZX1ZBVUxUX1NFVFRJTkdTIG1lc3NhZ2UgZnJvbSBwb3B1cFxuICAgKi9cbiAgYXN5bmMgaGFuZGxlVXBkYXRlQVBJS2V5VmF1bHRTZXR0aW5ncyhcbiAgICBwYXlsb2FkOiBQYXJ0aWFsPEFQSUtleVZhdWx0Q29uZmlnPlxuICApOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmcgfT4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnN0b3JhZ2UudXBkYXRlQVBJS2V5VmF1bHRTZXR0aW5ncyhwYXlsb2FkKTtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbQVBJS2V5SGFuZGxlcnNdIEZhaWxlZCB0byB1cGRhdGUgQVBJIEtleSBWYXVsdCBzZXR0aW5nczonLCBlcnJvcik7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcbiAgICB9XG4gIH1cbn1cbiIsIi8qKlxuICogQ3VzdG9tIFJ1bGVzIEhhbmRsZXJzXG4gKiBIYW5kbGVzIGN1c3RvbSByZWRhY3Rpb24gcnVsZXMtcmVsYXRlZCBtZXNzYWdlcyBmcm9tIHBvcHVwXG4gKi9cblxuaW1wb3J0IHsgU3RvcmFnZU1hbmFnZXIgfSBmcm9tICcuLi8uLi9saWIvc3RvcmFnZSc7XG5pbXBvcnQgdHlwZSB7IEN1c3RvbVJ1bGVzQ29uZmlnIH0gZnJvbSAnLi4vLi4vbGliL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEN1c3RvbVJ1bGVzSGFuZGxlcnMge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHN0b3JhZ2U6IFN0b3JhZ2VNYW5hZ2VyKSB7fVxuXG4gIC8qKlxuICAgKiBBZGQgY3VzdG9tIHJlZGFjdGlvbiBydWxlXG4gICAqL1xuICBhc3luYyBoYW5kbGVBZGRDdXN0b21SdWxlKHBheWxvYWQ6IGFueSk6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuOyBkYXRhPzogYW55OyBlcnJvcj86IHN0cmluZyB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJ1bGVJZCA9IGF3YWl0IHRoaXMuc3RvcmFnZS5hZGRDdXN0b21SdWxlKHBheWxvYWQpO1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogeyBydWxlSWQgfSB9O1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tDdXN0b21SdWxlc0hhbmRsZXJzXSBGYWlsZWQgdG8gYWRkIGN1c3RvbSBydWxlOicsIGVycm9yKTtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgY3VzdG9tIHJlZGFjdGlvbiBydWxlXG4gICAqL1xuICBhc3luYyBoYW5kbGVSZW1vdmVDdXN0b21SdWxlKHBheWxvYWQ6IHsgcnVsZUlkOiBzdHJpbmcgfSk6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuc3RvcmFnZS5yZW1vdmVDdXN0b21SdWxlKHBheWxvYWQucnVsZUlkKTtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbQ3VzdG9tUnVsZXNIYW5kbGVyc10gRmFpbGVkIHRvIHJlbW92ZSBjdXN0b20gcnVsZTonLCBlcnJvcik7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIGN1c3RvbSByZWRhY3Rpb24gcnVsZVxuICAgKi9cbiAgYXN5bmMgaGFuZGxlVXBkYXRlQ3VzdG9tUnVsZShwYXlsb2FkOiB7XG4gICAgcnVsZUlkOiBzdHJpbmc7XG4gICAgdXBkYXRlczogYW55XG4gIH0pOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmcgfT4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnN0b3JhZ2UudXBkYXRlQ3VzdG9tUnVsZShwYXlsb2FkLnJ1bGVJZCwgcGF5bG9hZC51cGRhdGVzKTtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbQ3VzdG9tUnVsZXNIYW5kbGVyc10gRmFpbGVkIHRvIHVwZGF0ZSBjdXN0b20gcnVsZTonLCBlcnJvcik7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVG9nZ2xlIGN1c3RvbSBydWxlIGVuYWJsZWQgc3RhdGVcbiAgICovXG4gIGFzeW5jIGhhbmRsZVRvZ2dsZUN1c3RvbVJ1bGUocGF5bG9hZDogeyBydWxlSWQ6IHN0cmluZyB9KTogUHJvbWlzZTx7IHN1Y2Nlc3M6IGJvb2xlYW47IGVycm9yPzogc3RyaW5nIH0+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5zdG9yYWdlLnRvZ2dsZUN1c3RvbVJ1bGUocGF5bG9hZC5ydWxlSWQpO1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tDdXN0b21SdWxlc0hhbmRsZXJzXSBGYWlsZWQgdG8gdG9nZ2xlIGN1c3RvbSBydWxlOicsIGVycm9yKTtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgY3VzdG9tIHJ1bGVzIHNldHRpbmdzXG4gICAqL1xuICBhc3luYyBoYW5kbGVVcGRhdGVDdXN0b21SdWxlc1NldHRpbmdzKFxuICAgIHBheWxvYWQ6IFBhcnRpYWw8Q3VzdG9tUnVsZXNDb25maWc+XG4gICk6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuc3RvcmFnZS51cGRhdGVDdXN0b21SdWxlc1NldHRpbmdzKHBheWxvYWQpO1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tDdXN0b21SdWxlc0hhbmRsZXJzXSBGYWlsZWQgdG8gdXBkYXRlIGN1c3RvbSBydWxlcyBzZXR0aW5nczonLCBlcnJvcik7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcbiAgICB9XG4gIH1cbn1cbiIsIi8qKlxuICogU2VydmljZSBXb3JrZXIgKEJhY2tncm91bmQgU2NyaXB0KVxuICogQ2xlYW4gb3JjaGVzdHJhdG9yIHRoYXQgZGVsZWdhdGVzIHRvIHNwZWNpYWxpemVkIG1vZHVsZXNcbiAqL1xuXG4vLyBDUklUSUNBTDogSW1wb3J0IHBvbHlmaWxscyBGSVJTVCBiZWZvcmUgYW55dGhpbmcgZWxzZVxuaW1wb3J0ICcuL3BvbHlmaWxscyc7XG5cbmltcG9ydCB7IHdhaXRGb3JBdXRoIH0gZnJvbSAnLi4vbGliL2ZpcmViYXNlJztcbmltcG9ydCB7IFN0b3JhZ2VNYW5hZ2VyIH0gZnJvbSAnLi4vbGliL3N0b3JhZ2UnO1xuaW1wb3J0IHsgQWxpYXNFbmdpbmUgfSBmcm9tICcuLi9saWIvYWxpYXNFbmdpbmUnO1xuaW1wb3J0IHsgQVBJS2V5RGV0ZWN0b3IgfSBmcm9tICcuLi9saWIvYXBpS2V5RGV0ZWN0b3InO1xuaW1wb3J0IHsgcmVkYWN0aW9uRW5naW5lIH0gZnJvbSAnLi4vbGliL3JlZGFjdGlvbkVuZ2luZSc7XG5pbXBvcnQgeyBCYWRnZU1hbmFnZXIgfSBmcm9tICcuL21hbmFnZXJzL0JhZGdlTWFuYWdlcic7XG5pbXBvcnQgeyBDb250ZW50U2NyaXB0TWFuYWdlciB9IGZyb20gJy4vbWFuYWdlcnMvQ29udGVudFNjcmlwdE1hbmFnZXInO1xuaW1wb3J0IHsgQWN0aXZpdHlMb2dnZXIgfSBmcm9tICcuL21hbmFnZXJzL0FjdGl2aXR5TG9nZ2VyJztcbmltcG9ydCB7IFJlcXVlc3RQcm9jZXNzb3IgfSBmcm9tICcuL3Byb2Nlc3NvcnMvUmVxdWVzdFByb2Nlc3Nvcic7XG5pbXBvcnQgeyBSZXNwb25zZVByb2Nlc3NvciB9IGZyb20gJy4vcHJvY2Vzc29ycy9SZXNwb25zZVByb2Nlc3Nvcic7XG5pbXBvcnQgeyBNZXNzYWdlUm91dGVyIH0gZnJvbSAnLi9oYW5kbGVycy9NZXNzYWdlUm91dGVyJztcbmltcG9ydCB7IEFsaWFzSGFuZGxlcnMgfSBmcm9tICcuL2hhbmRsZXJzL0FsaWFzSGFuZGxlcnMnO1xuaW1wb3J0IHsgQ29uZmlnSGFuZGxlcnMgfSBmcm9tICcuL2hhbmRsZXJzL0NvbmZpZ0hhbmRsZXJzJztcbmltcG9ydCB7IEFQSUtleUhhbmRsZXJzIH0gZnJvbSAnLi9oYW5kbGVycy9BUElLZXlIYW5kbGVycyc7XG5pbXBvcnQgeyBDdXN0b21SdWxlc0hhbmRsZXJzIH0gZnJvbSAnLi9oYW5kbGVycy9DdXN0b21SdWxlc0hhbmRsZXJzJztcbmltcG9ydCB7IE1lc3NhZ2UgfSBmcm9tICcuLi9saWIvdHlwZXMnO1xuXG4vLyA9PT09PT09PT09IEZJUkVCQVNFIElOSVRJQUxJWkFUSU9OID09PT09PT09PT1cblxuY29uc29sZS5sb2coJ1tCYWNrZ3JvdW5kXSBJbml0aWFsaXppbmcgRmlyZWJhc2UgYXV0aCBmb3Igc2VydmljZSB3b3JrZXIuLi4nKTtcbndhaXRGb3JBdXRoKCkudGhlbigoKSA9PiB7XG4gIGNvbnNvbGUubG9nKCdbQmFja2dyb3VuZF0g4pyFIEZpcmViYXNlIGF1dGggaW5pdGlhbGl6ZWQgaW4gc2VydmljZSB3b3JrZXInKTtcbn0pLmNhdGNoKGVycm9yID0+IHtcbiAgY29uc29sZS5lcnJvcignW0JhY2tncm91bmRdIOKdjCBGaXJlYmFzZSBhdXRoIGluaXRpYWxpemF0aW9uIGZhaWxlZDonLCBlcnJvcik7XG59KTtcblxuLy8gPT09PT09PT09PSBJTklUSUFMSVpFIENPUkUgU0VSVklDRVMgPT09PT09PT09PVxuXG4vLyBXcmFwIGluaXRpYWxpemF0aW9uIGluIGFzeW5jIElJRkUgdG8gcHJvcGVybHkgYXdhaXQgQWxpYXNFbmdpbmVcbihhc3luYyAoKSA9PiB7XG4gIGNvbnN0IHN0b3JhZ2UgPSBTdG9yYWdlTWFuYWdlci5nZXRJbnN0YW5jZSgpO1xuICBjb25zdCBhbGlhc0VuZ2luZSA9IGF3YWl0IEFsaWFzRW5naW5lLmdldEluc3RhbmNlKCk7XG4gIGNvbnN0IGFwaUtleURldGVjdG9yID0gbmV3IEFQSUtleURldGVjdG9yKCk7XG5cbiAgLy8gPT09PT09PT09PSBJTklUSUFMSVpFIE1BTkFHRVJTID09PT09PT09PT1cblxuICBjb25zdCBhY3Rpdml0eUxvZ2dlciA9IG5ldyBBY3Rpdml0eUxvZ2dlcihzdG9yYWdlKTtcbiAgY29uc3QgYmFkZ2VNYW5hZ2VyID0gbmV3IEJhZGdlTWFuYWdlcihzdG9yYWdlLCBudWxsIGFzIGFueSk7IC8vIFdpbGwgc2V0IGNvbnRlbnRTY3JpcHRNYW5hZ2VyIG5leHRcbiAgY29uc3QgY29udGVudFNjcmlwdE1hbmFnZXIgPSBuZXcgQ29udGVudFNjcmlwdE1hbmFnZXIoYmFkZ2VNYW5hZ2VyKTtcbiAgLy8gU2V0IGNpcmN1bGFyIHJlZmVyZW5jZVxuICAoYmFkZ2VNYW5hZ2VyIGFzIGFueSkuY29udGVudFNjcmlwdE1hbmFnZXIgPSBjb250ZW50U2NyaXB0TWFuYWdlcjtcblxuICAvLyA9PT09PT09PT09IElOSVRJQUxJWkUgUFJPQ0VTU09SUyA9PT09PT09PT09XG5cbiAgY29uc3QgcmVxdWVzdFByb2Nlc3NvciA9IG5ldyBSZXF1ZXN0UHJvY2Vzc29yKHN0b3JhZ2UsIGFsaWFzRW5naW5lLCBhcGlLZXlEZXRlY3RvciwgcmVkYWN0aW9uRW5naW5lLCBhY3Rpdml0eUxvZ2dlcik7XG4gIGNvbnN0IHJlc3BvbnNlUHJvY2Vzc29yID0gbmV3IFJlc3BvbnNlUHJvY2Vzc29yKHN0b3JhZ2UsIGFsaWFzRW5naW5lKTtcblxuICAvLyA9PT09PT09PT09IElOSVRJQUxJWkUgSEFORExFUlMgPT09PT09PT09PVxuXG4gIGNvbnN0IGFsaWFzSGFuZGxlcnMgPSBuZXcgQWxpYXNIYW5kbGVycyhzdG9yYWdlLCBhbGlhc0VuZ2luZSk7XG4gIGNvbnN0IGNvbmZpZ0hhbmRsZXJzID0gbmV3IENvbmZpZ0hhbmRsZXJzKHN0b3JhZ2UpO1xuICBjb25zdCBhcGlLZXlIYW5kbGVycyA9IG5ldyBBUElLZXlIYW5kbGVycyhzdG9yYWdlKTtcbiAgY29uc3QgY3VzdG9tUnVsZXNIYW5kbGVycyA9IG5ldyBDdXN0b21SdWxlc0hhbmRsZXJzKHN0b3JhZ2UpO1xuXG4gIC8vID09PT09PT09PT0gSU5JVElBTElaRSBST1VURVIgPT09PT09PT09PVxuXG4gIGNvbnN0IG1lc3NhZ2VSb3V0ZXIgPSBuZXcgTWVzc2FnZVJvdXRlcihcbiAgICBzdG9yYWdlLFxuICAgIGFsaWFzSGFuZGxlcnMsXG4gICAgY29uZmlnSGFuZGxlcnMsXG4gICAgYXBpS2V5SGFuZGxlcnMsXG4gICAgY3VzdG9tUnVsZXNIYW5kbGVycyxcbiAgICByZXF1ZXN0UHJvY2Vzc29yLFxuICAgIHJlc3BvbnNlUHJvY2Vzc29yLFxuICAgIGJhZGdlTWFuYWdlcixcbiAgICBjb250ZW50U2NyaXB0TWFuYWdlclxuICApO1xuXG4gIC8vID09PT09PT09PT0gRklSRUJBU0UgQVVUSCBTVEFURSBMSVNURU5FUiA9PT09PT09PT09XG5cbiAgLyoqXG4gICAqIExpc3RlbiBmb3IgRmlyZWJhc2UgYXV0aCBzdGF0ZSBjaGFuZ2VzXG4gICAqIFJlbG9hZCBwcm9maWxlcyB3aGVuIHVzZXIgc2lnbnMgaW4gKGVuYWJsZXMgUElJIHByb3RlY3Rpb24pXG4gICAqL1xuICBjb25zdCB7IGF1dGggfSA9IGF3YWl0IGltcG9ydCgnLi4vbGliL2ZpcmViYXNlJyk7XG5cbiAgYXV0aC5vbkF1dGhTdGF0ZUNoYW5nZWQoYXN5bmMgKHVzZXIpID0+IHtcbiAgICBpZiAodXNlcikge1xuICAgICAgY29uc29sZS5sb2coJ1tCYWNrZ3JvdW5kXSDwn5SQIFVzZXIgc2lnbmVkIGluOicsIHVzZXIuZW1haWwpO1xuICAgICAgY29uc29sZS5sb2coJ1tCYWNrZ3JvdW5kXSBSZWxvYWRpbmcgcHJvZmlsZXMgd2l0aCBGaXJlYmFzZSBVSUQgZW5jcnlwdGlvbi4uLicpO1xuXG4gICAgICB0cnkge1xuICAgICAgICAvLyBSZWluaXRpYWxpemUgc3RvcmFnZSB3aXRoIGF1dGhlbnRpY2F0ZWQgdXNlclxuICAgICAgICBhd2FpdCBzdG9yYWdlLmluaXRpYWxpemUoKTtcblxuICAgICAgICAvLyBMb2FkIHByb2ZpbGVzIChub3cgZGVjcnlwdGFibGUgd2l0aCBGaXJlYmFzZSBVSUQpXG4gICAgICAgIGNvbnN0IHByb2ZpbGVzID0gYXdhaXQgc3RvcmFnZS5sb2FkUHJvZmlsZXMoKTtcblxuICAgICAgICAvLyBVcGRhdGUgYWxpYXMgZW5naW5lIHdpdGggbG9hZGVkIHByb2ZpbGVzXG4gICAgICAgIGFsaWFzRW5naW5lLnNldFByb2ZpbGVzKHByb2ZpbGVzKTtcblxuICAgICAgICBjb25zb2xlLmxvZygnW0JhY2tncm91bmRdIOKchSBQcm9maWxlcyByZWxvYWRlZDonLCBwcm9maWxlcy5sZW5ndGgsICdwcm9maWxlcycpO1xuICAgICAgICBjb25zb2xlLmxvZygnW0JhY2tncm91bmRdIOKchSBBY3RpdmUgcHJvZmlsZXM6JywgcHJvZmlsZXMuZmlsdGVyKHAgPT4gcC5lbmFibGVkKS5sZW5ndGgpO1xuXG4gICAgICAgIC8vIFVwZGF0ZSBiYWRnZXMgZm9yIGFsbCB0YWJzIChwcm90ZWN0aW9uIG5vdyBhY3RpdmUpXG4gICAgICAgIGNvbnN0IHRhYnMgPSBhd2FpdCBjaHJvbWUudGFicy5xdWVyeSh7fSk7XG4gICAgICAgIGZvciAoY29uc3QgdGFiIG9mIHRhYnMpIHtcbiAgICAgICAgICBpZiAodGFiLmlkKSB7XG4gICAgICAgICAgICBhd2FpdCBiYWRnZU1hbmFnZXIuY2hlY2tBbmRVcGRhdGVCYWRnZSh0YWIuaWQsIHRhYi51cmwpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZygnW0JhY2tncm91bmRdIOKchSBCYWRnZXMgdXBkYXRlZCBmb3IgYWxsIHRhYnMnKTtcblxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignW0JhY2tncm91bmRdIOKdjCBGYWlsZWQgdG8gcmVsb2FkIHByb2ZpbGVzIGFmdGVyIHNpZ24taW46JywgZXJyb3IpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZygnW0JhY2tncm91bmRdIPCflJMgVXNlciBzaWduZWQgb3V0IC0gcHJvZmlsZXMgbG9ja2VkJyk7XG4gICAgICAvLyBDbGVhciBwcm9maWxlcyBmcm9tIGFsaWFzIGVuZ2luZSAodXNlciBzaWduZWQgb3V0KVxuICAgICAgYWxpYXNFbmdpbmUuc2V0UHJvZmlsZXMoW10pO1xuICAgIH1cbiAgfSk7XG5cbiAgY29uc29sZS5sb2coJ1tCYWNrZ3JvdW5kXSDinIUgRmlyZWJhc2UgYXV0aCBzdGF0ZSBsaXN0ZW5lciByZWdpc3RlcmVkJyk7XG5cbiAgLy8gPT09PT09PT09PSBFVkVOVCBMSVNURU5FUlMgPT09PT09PT09PVxuXG4gIC8qKlxuICAgKiBTdGFydHVwOiBJbmplY3QgY29udGVudCBzY3JpcHRzIGFuZCB1cGRhdGUgYmFkZ2VzXG4gICAqL1xuICBjaHJvbWUucnVudGltZS5vblN0YXJ0dXAuYWRkTGlzdGVuZXIoYXN5bmMgKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKCdBSSBQSUkgU2FuaXRpemVyIHN0YXJ0dXAnKTtcbiAgICBhd2FpdCBjb250ZW50U2NyaXB0TWFuYWdlci5pbmplY3RJbnRvRXhpc3RpbmdUYWJzKCk7XG5cbiAgICAvLyBVcGRhdGUgYmFkZ2VzIGZvciBhbGwgdGFic1xuICAgIGNvbnN0IHRhYnMgPSBhd2FpdCBjaHJvbWUudGFicy5xdWVyeSh7fSk7XG4gICAgZm9yIChjb25zdCB0YWIgb2YgdGFicykge1xuICAgICAgaWYgKHRhYi5pZCkge1xuICAgICAgICBhd2FpdCBiYWRnZU1hbmFnZXIuY2hlY2tBbmRVcGRhdGVCYWRnZSh0YWIuaWQsIHRhYi51cmwpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgLyoqXG4gICAqIEluc3RhbGwvVXBkYXRlOiBJbml0aWFsaXplIHN0b3JhZ2UsIHJlbG9hZCB0YWJzLCBpbmplY3Qgc2NyaXB0c1xuICAgKi9cbiAgY2hyb21lLnJ1bnRpbWUub25JbnN0YWxsZWQuYWRkTGlzdGVuZXIoYXN5bmMgKGRldGFpbHMpID0+IHtcbiAgICBjb25zb2xlLmxvZygnQUkgUElJIFNhbml0aXplciBpbnN0YWxsZWQ6JywgZGV0YWlscy5yZWFzb24pO1xuXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHN0b3JhZ2UuaW5pdGlhbGl6ZSgpO1xuXG4gICAgICAvLyBFbnN1cmUgZXh0ZW5zaW9uIGlzIGVuYWJsZWQgb24gaW5zdGFsbC91cGRhdGVcbiAgICAgIGNvbnN0IGNvbmZpZyA9IGF3YWl0IHN0b3JhZ2UubG9hZENvbmZpZygpO1xuICAgICAgaWYgKGNvbmZpZyAmJiAhY29uZmlnLnNldHRpbmdzLmVuYWJsZWQpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tCYWNrZ3JvdW5kXSBFeHRlbnNpb24gd2FzIGRpc2FibGVkIC0gZW5hYmxpbmcgaXQgbm93Jyk7XG4gICAgICAgIGNvbmZpZy5zZXR0aW5ncy5lbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgYXdhaXQgc3RvcmFnZS5zYXZlQ29uZmlnKGNvbmZpZyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0VOQ1JZUFRJT05fS0VZX1VOQVZBSUxBQkxFJykpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tCYWNrZ3JvdW5kXSBVc2VyIG5vdCBhdXRoZW50aWNhdGVkIC0gc2tpcHBpbmcgZGF0YSBpbml0aWFsaXphdGlvbicpO1xuICAgICAgICBjb25zb2xlLmxvZygnW0JhY2tncm91bmRdIEV4dGVuc2lvbiB3aWxsIGluaXRpYWxpemUgd2hlbiB1c2VyIHNpZ25zIGluJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbQmFja2dyb3VuZF0gRmFpbGVkIHRvIGluaXRpYWxpemUgb24gaW5zdGFsbDonLCBlcnJvcik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQXV0by1yZWxvYWQgQUkgc2VydmljZSB0YWJzIG9uIGV4dGVuc2lvbiB1cGRhdGUvcmVsb2FkIChkZXYgbW9kZSlcbiAgICBpZiAoZGV0YWlscy5yZWFzb24gPT09ICd1cGRhdGUnIHx8IGRldGFpbHMucmVhc29uID09PSAnaW5zdGFsbCcpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdbQmFja2dyb3VuZF0gRXh0ZW5zaW9uIHVwZGF0ZWQvaW5zdGFsbGVkIC0gYXV0by1yZWxvYWRpbmcgQUkgc2VydmljZSB0YWJzJyk7XG4gICAgICBjb25zdCByZWxvYWRlZENvdW50ID0gYXdhaXQgY29udGVudFNjcmlwdE1hbmFnZXIucmVsb2FkQUlTZXJ2aWNlVGFicygpO1xuICAgICAgY29uc29sZS5sb2coYFtCYWNrZ3JvdW5kXSDinIUgQXV0by1yZWxvYWRlZCAke3JlbG9hZGVkQ291bnR9IEFJIHNlcnZpY2UgdGFic2ApO1xuICAgIH1cblxuICAgIC8vIEluamVjdCBjb250ZW50IHNjcmlwdHMgaW50byBleGlzdGluZyB0YWJzIHRoYXQgd2VyZW4ndCByZWxvYWRlZFxuICAgIGF3YWl0IGNvbnRlbnRTY3JpcHRNYW5hZ2VyLmluamVjdEludG9FeGlzdGluZ1RhYnMoKTtcblxuICAgIC8vIFVwZGF0ZSBiYWRnZXMgZm9yIGFsbCB0YWJzXG4gICAgY29uc3QgdGFicyA9IGF3YWl0IGNocm9tZS50YWJzLnF1ZXJ5KHt9KTtcbiAgICBmb3IgKGNvbnN0IHRhYiBvZiB0YWJzKSB7XG4gICAgICBpZiAodGFiLmlkKSB7XG4gICAgICAgIGF3YWl0IGJhZGdlTWFuYWdlci5jaGVja0FuZFVwZGF0ZUJhZGdlKHRhYi5pZCwgdGFiLnVybCk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICAvKipcbiAgICogTWVzc2FnZXM6IERlbGVnYXRlIHRvIE1lc3NhZ2VSb3V0ZXJcbiAgICovXG4gIGNocm9tZS5ydW50aW1lLm9uTWVzc2FnZS5hZGRMaXN0ZW5lcihcbiAgICAobWVzc2FnZTogTWVzc2FnZSwgc2VuZGVyLCBzZW5kUmVzcG9uc2UpID0+IHtcbiAgICAgIGlmICghbWVzc2FnZSB8fCAhbWVzc2FnZS50eXBlKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignW0JhY2tncm91bmRdIFJlY2VpdmVkIG1lc3NhZ2Ugd2l0aG91dCB0eXBlIGZpZWxkOicsIG1lc3NhZ2UpO1xuICAgICAgICBzZW5kUmVzcG9uc2UoeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdJbnZhbGlkIG1lc3NhZ2UgZm9ybWF0JyB9KTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICBtZXNzYWdlUm91dGVyLmhhbmRsZU1lc3NhZ2UobWVzc2FnZSwgc2VuZGVyKVxuICAgICAgICAudGhlbihzZW5kUmVzcG9uc2UpXG4gICAgICAgIC5jYXRjaCgoZXJyb3I6IEVycm9yKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaGFuZGxpbmcgbWVzc2FnZTonLCBlcnJvcik7XG4gICAgICAgICAgc2VuZFJlc3BvbnNlKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgcmV0dXJuIHRydWU7IC8vIEFzeW5jIHJlc3BvbnNlXG4gICAgfVxuICApO1xuXG4gIC8qKlxuICAgKiBUYWIgYWN0aXZhdGlvbjogVXBkYXRlIGJhZGdlIHdoZW4gdGFiIGJlY29tZXMgYWN0aXZlXG4gICAqL1xuICBjaHJvbWUudGFicy5vbkFjdGl2YXRlZC5hZGRMaXN0ZW5lcihhc3luYyAoYWN0aXZlSW5mbykgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB0YWIgPSBhd2FpdCBjaHJvbWUudGFicy5nZXQoYWN0aXZlSW5mby50YWJJZCk7XG4gICAgICBhd2FpdCBiYWRnZU1hbmFnZXIuY2hlY2tBbmRVcGRhdGVCYWRnZShhY3RpdmVJbmZvLnRhYklkLCB0YWIudXJsKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW0JhZGdlXSBFcnJvciBvbiB0YWIgYWN0aXZhdGlvbjonLCBlcnJvcik7XG4gICAgfVxuICB9KTtcblxuICAvKipcbiAgICogVGFiIHVwZGF0ZTogVXBkYXRlIGJhZGdlIHdoZW4gdGFiIFVSTCBjaGFuZ2VzXG4gICAqL1xuICBjaHJvbWUudGFicy5vblVwZGF0ZWQuYWRkTGlzdGVuZXIoYXN5bmMgKHRhYklkLCBjaGFuZ2VJbmZvLCB0YWIpID0+IHtcbiAgICAvLyBPbmx5IGNoZWNrIHdoZW4gVVJMIGNoYW5nZXMgb3IgcGFnZSBmaW5pc2hlcyBsb2FkaW5nXG4gICAgaWYgKGNoYW5nZUluZm8udXJsIHx8IGNoYW5nZUluZm8uc3RhdHVzID09PSAnY29tcGxldGUnKSB7XG4gICAgICBhd2FpdCBiYWRnZU1hbmFnZXIuY2hlY2tBbmRVcGRhdGVCYWRnZSh0YWJJZCwgdGFiLnVybCk7XG4gICAgfVxuICB9KTtcblxuICAvKipcbiAgICogU3RvcmFnZSBjaGFuZ2VzOiBSZWxvYWQgcHJvZmlsZXMgd2hlbiBjb25maWcgY2hhbmdlc1xuICAgKi9cbiAgY2hyb21lLnN0b3JhZ2Uub25DaGFuZ2VkLmFkZExpc3RlbmVyKGFzeW5jIChjaGFuZ2VzLCBhcmVhTmFtZSkgPT4ge1xuICAgIGlmIChhcmVhTmFtZSA9PT0gJ2xvY2FsJyAmJiBjaGFuZ2VzLmNvbmZpZykge1xuICAgICAgY29uc3Qgb2xkQ29uZmlnID0gY2hhbmdlcy5jb25maWcub2xkVmFsdWU7XG4gICAgICBjb25zdCBuZXdDb25maWcgPSBjaGFuZ2VzLmNvbmZpZy5uZXdWYWx1ZTtcblxuICAgICAgLy8gQ2hlY2sgaWYgZW5hYmxlZCBzdGF0ZSBvciBwcm90ZWN0ZWREb21haW5zIGNoYW5nZWRcbiAgICAgIGNvbnN0IGVuYWJsZWRDaGFuZ2VkID0gb2xkQ29uZmlnPy5zZXR0aW5ncz8uZW5hYmxlZCAhPT0gbmV3Q29uZmlnPy5zZXR0aW5ncz8uZW5hYmxlZDtcbiAgICAgIGNvbnN0IGRvbWFpbnNDaGFuZ2VkID0gSlNPTi5zdHJpbmdpZnkob2xkQ29uZmlnPy5zZXR0aW5ncz8ucHJvdGVjdGVkRG9tYWlucykgIT09XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KG5ld0NvbmZpZz8uc2V0dGluZ3M/LnByb3RlY3RlZERvbWFpbnMpO1xuXG4gICAgICBpZiAoZW5hYmxlZENoYW5nZWQgfHwgZG9tYWluc0NoYW5nZWQpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tCYWRnZV0gUHJvdGVjdGlvbiBzZXR0aW5ncyBjaGFuZ2VkLCB1cGRhdGluZyBhbGwgYmFkZ2VzJywge1xuICAgICAgICAgIGVuYWJsZWRDaGFuZ2VkLFxuICAgICAgICAgIGRvbWFpbnNDaGFuZ2VkLFxuICAgICAgICAgIG9sZERvbWFpbnM6IG9sZENvbmZpZz8uc2V0dGluZ3M/LnByb3RlY3RlZERvbWFpbnMsXG4gICAgICAgICAgbmV3RG9tYWluczogbmV3Q29uZmlnPy5zZXR0aW5ncz8ucHJvdGVjdGVkRG9tYWluc1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBVcGRhdGUgYmFkZ2VzIGZvciBhbGwgdGFic1xuICAgICAgICBjb25zdCB0YWJzID0gYXdhaXQgY2hyb21lLnRhYnMucXVlcnkoe30pO1xuICAgICAgICBmb3IgKGNvbnN0IHRhYiBvZiB0YWJzKSB7XG4gICAgICAgICAgaWYgKHRhYi5pZCkge1xuICAgICAgICAgICAgYXdhaXQgYmFkZ2VNYW5hZ2VyLmNoZWNrQW5kVXBkYXRlQmFkZ2UodGFiLmlkLCB0YWIudXJsKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufSkoKTtcbiJdLCJuYW1lcyI6WyJmaXJlYmFzZUNvbmZpZyIsImFwaUtleSIsImF1dGhEb21haW4iLCJwcm9qZWN0SWQiLCJzdG9yYWdlQnVja2V0IiwibWVzc2FnaW5nU2VuZGVySWQiLCJhcHBJZCIsIm1pc3NpbmdLZXlzIiwiZmlsdGVyIiwia2V5IiwibGVuZ3RoIiwiRXJyb3IiLCJtYXAiLCJrIiwidG9VcHBlckNhc2UiLCJqb2luIiwiaXNTZXJ2aWNlV29ya2VyIiwiZ2xvYmFsVGhpcyIsIl9fSVNfU0VSVklDRV9XT1JLRVJfXyIsImRvY3VtZW50IiwiY29udGV4dE5hbWUiLCJhcHAiLCJkYiIsIlVTRV9GSVJFQkFTRV9FTVVMQVRPUlMiLCJjb25zb2xlIiwibG9nIiwiZXJyb3IiLCJhdXRoUmVhZHkiLCJhdXRoIiwiYXN5bmMiLCJ3YWl0Rm9yQXV0aCIsInNldFBlcnNpc3RlbmNlIiwib3BlbkRCIiwibmFtZSIsInZlcnNpb24iLCJibG9ja2VkIiwidXBncmFkZSIsImJsb2NraW5nIiwidGVybWluYXRlZCIsInJlcXVlc3QiLCJpbmRleGVkREIiLCJvcGVuIiwib3BlblByb21pc2UiLCJ3IiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwicmVzdWx0Iiwib2xkVmVyc2lvbiIsIm5ld1ZlcnNpb24iLCJ0cmFuc2FjdGlvbiIsInRoZW4iLCJjYXRjaCIsInJlYWRNZXRob2RzIiwid3JpdGVNZXRob2RzIiwiY2FjaGVkTWV0aG9kcyIsIk1hcCIsImdldE1ldGhvZCIsInRhcmdldCIsInByb3AiLCJJREJEYXRhYmFzZSIsImdldCIsInRhcmdldEZ1bmNOYW1lIiwicmVwbGFjZSIsInVzZUluZGV4IiwiaXNXcml0ZSIsImluY2x1ZGVzIiwiSURCSW5kZXgiLCJJREJPYmplY3RTdG9yZSIsInByb3RvdHlwZSIsIm1ldGhvZCIsInN0b3JlTmFtZSIsImFyZ3MiLCJ0eCIsInRoaXMiLCJzdG9yZSIsImluZGV4Iiwic2hpZnQiLCJQcm9taXNlIiwiYWxsIiwiZG9uZSIsInNldCIsInIiLCJvbGRUcmFwcyIsInJlY2VpdmVyIiwiaGFzIiwiaW5zdGFuY2VzIiwiTG9nTGV2ZWwiLCJsZXZlbFN0cmluZ1RvRW51bSIsIkRFQlVHIiwiVkVSQk9TRSIsIklORk8iLCJXQVJOIiwiRVJST1IiLCJTSUxFTlQiLCJkZWZhdWx0TG9nTGV2ZWwiLCJDb25zb2xlTWV0aG9kIiwiZGVmYXVsdExvZ0hhbmRsZXIiLCJpbnN0YW5jZSIsImxvZ1R5cGUiLCJsb2dMZXZlbCIsIm5vdyIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsIkxvZ2dlciIsImNvbnN0cnVjdG9yIiwiX2xvZ0xldmVsIiwiX2xvZ0hhbmRsZXIiLCJfdXNlckxvZ0hhbmRsZXIiLCJwdXNoIiwidmFsIiwiVHlwZUVycm9yIiwic2V0TG9nTGV2ZWwiLCJsb2dIYW5kbGVyIiwidXNlckxvZ0hhbmRsZXIiLCJkZWJ1ZyIsImluZm8iLCJ3YXJuIiwicHJvZEVycm9yTWFwIiwiX0RFRkFVTFRfQVVUSF9FUlJPUl9GQUNUT1JZIiwibG9nQ2xpZW50IiwiX2xvZ0Vycm9yIiwibXNnIiwiX2ZhaWwiLCJhdXRoT3JDb2RlIiwicmVzdCIsImNyZWF0ZUVycm9ySW50ZXJuYWwiLCJfY3JlYXRlRXJyb3IiLCJfZXJyb3JXaXRoQ3VzdG9tTWVzc2FnZSIsImNvZGUiLCJtZXNzYWdlIiwiZXJyb3JNYXAiLCJjcmVhdGUiLCJhcHBOYW1lIiwiX3NlcnZlckFwcEN1cnJlbnRVc2VyT3BlcmF0aW9uTm90U3VwcG9ydGVkRXJyb3IiLCJmdWxsUGFyYW1zIiwic2xpY2UiLCJfZXJyb3JGYWN0b3J5IiwiX2Fzc2VydCIsImFzc2VydGlvbiIsImRlYnVnRmFpbCIsImZhaWx1cmUiLCJkZWJ1Z0Fzc2VydCIsIl9nZXRDdXJyZW50U2NoZW1lIiwic2VsZiIsImxvY2F0aW9uIiwicHJvdG9jb2wiLCJGZXRjaFByb3ZpZGVyIiwiaW5pdGlhbGl6ZSIsImZldGNoSW1wbCIsImhlYWRlcnNJbXBsIiwicmVzcG9uc2VJbXBsIiwiZmV0Y2giLCJoZWFkZXJzIiwiSGVhZGVycyIsInJlc3BvbnNlIiwiUmVzcG9uc2UiLCJTRVJWRVJfRVJST1JfTUFQIiwiQ29va2llQXV0aFByb3hpZWRFbmRwb2ludHMiLCJERUZBVUxUX0FQSV9USU1FT1VUX01TIiwic2hvcnREZWxheSIsImxvbmdEZWxheSIsImlzTW9iaWxlIiwibmF2aWdhdG9yIiwib25MaW5lIiwiTWF0aCIsIm1pbiIsIl9hZGRUaWRJZk5lY2Vzc2FyeSIsInRlbmFudElkIiwiX3BlcmZvcm1BcGlSZXF1ZXN0IiwicGF0aCIsImN1c3RvbUVycm9yTWFwIiwiX3BlcmZvcm1GZXRjaFdpdGhFcnJvckhhbmRsaW5nIiwiYm9keSIsInBhcmFtcyIsIkpTT04iLCJzdHJpbmdpZnkiLCJxdWVyeSIsImNvbmZpZyIsIl9nZXRBZGRpdGlvbmFsSGVhZGVycyIsImxhbmd1YWdlQ29kZSIsImZldGNoQXJncyIsInJlZmVycmVyUG9saWN5IiwiZW11bGF0b3JDb25maWciLCJob3N0IiwiY3JlZGVudGlhbHMiLCJfZ2V0RmluYWxUYXJnZXQiLCJhcGlIb3N0IiwiZmV0Y2hGbiIsIl9jYW5Jbml0RW11bGF0b3IiLCJuZXR3b3JrVGltZW91dCIsIk5ldHdvcmtUaW1lb3V0IiwicmFjZSIsInByb21pc2UiLCJjbGVhck5ldHdvcmtUaW1lb3V0IiwianNvbiIsIl9tYWtlVGFnZ2VkRXJyb3IiLCJvayIsImVycm9yTWVzc2FnZSIsInNlcnZlckVycm9yQ29kZSIsInNlcnZlckVycm9yTWVzc2FnZSIsInNwbGl0IiwiYXV0aEVycm9yIiwidG9Mb3dlckNhc2UiLCJlIiwiU3RyaW5nIiwiX3BlcmZvcm1TaWduSW5SZXF1ZXN0Iiwic2VydmVyUmVzcG9uc2UiLCJfc2VydmVyUmVzcG9uc2UiLCJiYXNlIiwiYXV0aEludGVybmFsIiwiZmluYWxUYXJnZXQiLCJlbXVsYXRvciIsInVybCIsInN0YXJ0c1dpdGgiLCJfZW11bGF0b3JVcmwiLCJhcGlTY2hlbWUiLCJfcGVyc2lzdGVuY2VNYW5hZ2VyQXZhaWxhYmxlIiwiX2dldFBlcnNpc3RlbmNlVHlwZSIsIl9nZXRQZXJzaXN0ZW5jZSIsInRvU3RyaW5nIiwiX3BhcnNlRW5mb3JjZW1lbnRTdGF0ZSIsImVuZm9yY2VtZW50U3RhdGVTdHIiLCJjbGVhclRpbWVvdXQiLCJ0aW1lciIsIl8iLCJyZWplY3QiLCJzZXRUaW1lb3V0IiwiZXJyb3JQYXJhbXMiLCJlbWFpbCIsInBob25lTnVtYmVyIiwiY3VzdG9tRGF0YSIsIl90b2tlblJlc3BvbnNlIiwiaXNFbnRlcnByaXNlIiwiZ3JlY2FwdGNoYSIsInVuZGVmaW5lZCIsImVudGVycHJpc2UiLCJSZWNhcHRjaGFDb25maWciLCJzaXRlS2V5IiwicmVjYXB0Y2hhRW5mb3JjZW1lbnRTdGF0ZSIsInJlY2FwdGNoYUtleSIsImdldFByb3ZpZGVyRW5mb3JjZW1lbnRTdGF0ZSIsInByb3ZpZGVyU3RyIiwicHJvdmlkZXIiLCJlbmZvcmNlbWVudFN0YXRlIiwiaXNQcm92aWRlckVuYWJsZWQiLCJpc0FueVByb3ZpZGVyRW5hYmxlZCIsImdldEFjY291bnRJbmZvIiwidXRjVGltZXN0YW1wVG9EYXRlU3RyaW5nIiwidXRjVGltZXN0YW1wIiwiZGF0ZSIsIk51bWJlciIsImlzTmFOIiwiZ2V0VGltZSIsInRvVVRDU3RyaW5nIiwic2Vjb25kc1N0cmluZ1RvTWlsbGlzZWNvbmRzIiwic2Vjb25kcyIsIl9wYXJzZVRva2VuIiwidG9rZW4iLCJhbGdvcml0aG0iLCJwYXlsb2FkIiwic2lnbmF0dXJlIiwiZGVjb2RlZCIsInBhcnNlIiwiX3Rva2VuRXhwaXJlc0luIiwicGFyc2VkVG9rZW4iLCJleHAiLCJpYXQiLCJfbG9nb3V0SWZJbnZhbGlkYXRlZCIsInVzZXIiLCJieXBhc3NBdXRoU3RhdGUiLCJpc1VzZXJJbnZhbGlkYXRlZCIsImN1cnJlbnRVc2VyIiwic2lnbk91dCIsIlByb2FjdGl2ZVJlZnJlc2giLCJpc1J1bm5pbmciLCJ0aW1lcklkIiwiZXJyb3JCYWNrb2ZmIiwiX3N0YXJ0Iiwic2NoZWR1bGUiLCJfc3RvcCIsImdldEludGVydmFsIiwid2FzRXJyb3IiLCJpbnRlcnZhbCIsInN0c1Rva2VuTWFuYWdlciIsImV4cGlyYXRpb25UaW1lIiwibWF4IiwiaXRlcmF0aW9uIiwiZ2V0SWRUb2tlbiIsIlVzZXJNZXRhZGF0YSIsImNyZWF0ZWRBdCIsImxhc3RMb2dpbkF0IiwiX2luaXRpYWxpemVUaW1lIiwibGFzdFNpZ25JblRpbWUiLCJjcmVhdGlvblRpbWUiLCJfY29weSIsIm1ldGFkYXRhIiwidG9KU09OIiwiX3JlbG9hZFdpdGhvdXRTYXZpbmciLCJpZFRva2VuIiwidXNlcnMiLCJjb3JlQWNjb3VudCIsIl9ub3RpZnlSZWxvYWRMaXN0ZW5lciIsIm5ld1Byb3ZpZGVyRGF0YSIsInByb3ZpZGVyVXNlckluZm8iLCJleHRyYWN0UHJvdmlkZXJEYXRhIiwicHJvdmlkZXJEYXRhIiwib3JpZ2luYWwiLCJuZXdEYXRhIiwibyIsInNvbWUiLCJuIiwicHJvdmlkZXJJZCIsIm9sZElzQW5vbnltb3VzIiwiaXNBbm9ueW1vdXMiLCJuZXdJc0Fub255bW91cyIsInBhc3N3b3JkSGFzaCIsInVwZGF0ZXMiLCJ1aWQiLCJsb2NhbElkIiwiZGlzcGxheU5hbWUiLCJwaG90b1VSTCIsInBob3RvVXJsIiwiZW1haWxWZXJpZmllZCIsIk9iamVjdCIsImFzc2lnbiIsInByb3ZpZGVycyIsInJhd0lkIiwiU3RzVG9rZW5NYW5hZ2VyIiwicmVmcmVzaFRva2VuIiwiYWNjZXNzVG9rZW4iLCJpc0V4cGlyZWQiLCJ1cGRhdGVGcm9tU2VydmVyUmVzcG9uc2UiLCJleHBpcmVzSW4iLCJ1cGRhdGVUb2tlbnNBbmRFeHBpcmF0aW9uIiwidXBkYXRlRnJvbUlkVG9rZW4iLCJnZXRUb2tlbiIsImZvcmNlUmVmcmVzaCIsInJlZnJlc2giLCJjbGVhclJlZnJlc2hUb2tlbiIsIm9sZFRva2VuIiwidG9rZW5BcGlIb3N0Iiwib3B0aW9ucyIsImFjY2Vzc190b2tlbiIsImV4cGlyZXNfaW4iLCJyZWZyZXNoX3Rva2VuIiwicmVxdWVzdFN0c1Rva2VuIiwiZXhwaXJlc0luU2VjIiwiZnJvbUpTT04iLCJvYmplY3QiLCJtYW5hZ2VyIiwiX2Fzc2lnbiIsIl9jbG9uZSIsIl9wZXJmb3JtUmVmcmVzaCIsImFzc2VydFN0cmluZ09yVW5kZWZpbmVkIiwiVXNlckltcGwiLCJvcHQiLCJwcm9hY3RpdmVSZWZyZXNoIiwicmVsb2FkVXNlckluZm8iLCJyZWxvYWRMaXN0ZW5lciIsIl9wZXJzaXN0VXNlcklmQ3VycmVudCIsIl9ub3RpZnlMaXN0ZW5lcnNJZkN1cnJlbnQiLCJnZXRJZFRva2VuUmVzdWx0IiwidXNlckludGVybmFsIiwiY2xhaW1zIiwiYXV0aF90aW1lIiwiZmlyZWJhc2UiLCJzaWduSW5Qcm92aWRlciIsImF1dGhUaW1lIiwiaXNzdWVkQXRUaW1lIiwic2lnbkluU2Vjb25kRmFjdG9yIiwicmVsb2FkIiwidXNlckluZm8iLCJuZXdVc2VyIiwiX29uUmVsb2FkIiwiY2FsbGJhY2siLCJfc3RhcnRQcm9hY3RpdmVSZWZyZXNoIiwiX3N0b3BQcm9hY3RpdmVSZWZyZXNoIiwiX3VwZGF0ZVRva2Vuc0lmTmVjZXNzYXJ5IiwidG9rZW5zUmVmcmVzaGVkIiwiZGVsZXRlQWNjb3VudCIsIl9yZWRpcmVjdEV2ZW50SWQiLCJfZnJvbUpTT04iLCJwbGFpbk9iamVjdFRva2VuTWFuYWdlciIsIkFycmF5IiwiaXNBcnJheSIsIl9mcm9tSWRUb2tlblJlc3BvbnNlIiwiaWRUb2tlblJlc3BvbnNlIiwiX2Zyb21HZXRBY2NvdW50SW5mb1Jlc3BvbnNlIiwiaW5zdGFuY2VDYWNoZSIsIl9nZXRJbnN0YW5jZSIsImNscyIsIkZ1bmN0aW9uIiwiSW5NZW1vcnlQZXJzaXN0ZW5jZSIsInR5cGUiLCJzdG9yYWdlIiwiX2lzQXZhaWxhYmxlIiwiX3NldCIsInZhbHVlIiwiX2dldCIsIl9yZW1vdmUiLCJfYWRkTGlzdGVuZXIiLCJfa2V5IiwiX2xpc3RlbmVyIiwiX3JlbW92ZUxpc3RlbmVyIiwiaW5NZW1vcnlQZXJzaXN0ZW5jZSIsIl9wZXJzaXN0ZW5jZUtleU5hbWUiLCJQZXJzaXN0ZW5jZVVzZXJNYW5hZ2VyIiwicGVyc2lzdGVuY2UiLCJ1c2VyS2V5IiwiZnVsbFVzZXJLZXkiLCJmdWxsUGVyc2lzdGVuY2VLZXkiLCJib3VuZEV2ZW50SGFuZGxlciIsIl9vblN0b3JhZ2VFdmVudCIsImJpbmQiLCJzZXRDdXJyZW50VXNlciIsImdldEN1cnJlbnRVc2VyIiwiYmxvYiIsInJlbW92ZUN1cnJlbnRVc2VyIiwic2F2ZVBlcnNpc3RlbmNlRm9yUmVkaXJlY3QiLCJuZXdQZXJzaXN0ZW5jZSIsInBlcnNpc3RlbmNlSGllcmFyY2h5IiwiYXZhaWxhYmxlUGVyc2lzdGVuY2VzIiwic2VsZWN0ZWRQZXJzaXN0ZW5jZSIsInVzZXJUb01pZ3JhdGUiLCJtaWdyYXRpb25IaWVyYXJjaHkiLCJwIiwiX3Nob3VsZEFsbG93TWlncmF0aW9uIiwiX2dldEJyb3dzZXJOYW1lIiwidXNlckFnZW50IiwidWEiLCJ0ZXN0IiwiX2lzSUVNb2JpbGUiLCJfaXNGaXJlZm94IiwiX2lzQmxhY2tCZXJyeSIsIl9pc1dlYk9TIiwiX2lzU2FmYXJpIiwiX2lzQ2hyb21lSU9TIiwiX2lzQW5kcm9pZCIsInJlIiwibWF0Y2hlcyIsIm1hdGNoIiwiX2dldENsaWVudFZlcnNpb24iLCJjbGllbnRQbGF0Zm9ybSIsImZyYW1ld29ya3MiLCJyZXBvcnRlZFBsYXRmb3JtIiwicmVwb3J0ZWRGcmFtZXdvcmtzIiwiQXV0aE1pZGRsZXdhcmVRdWV1ZSIsInF1ZXVlIiwicHVzaENhbGxiYWNrIiwib25BYm9ydCIsIndyYXBwZWRDYWxsYmFjayIsInJlc29sdmUiLCJydW5NaWRkbGV3YXJlIiwibmV4dFVzZXIiLCJvbkFib3J0U3RhY2siLCJiZWZvcmVTdGF0ZUNhbGxiYWNrIiwicmV2ZXJzZSIsIm9yaWdpbmFsTWVzc2FnZSIsIlBhc3N3b3JkUG9saWN5SW1wbCIsInJlc3BvbnNlT3B0aW9ucyIsImN1c3RvbVN0cmVuZ3RoT3B0aW9ucyIsIm1pblBhc3N3b3JkTGVuZ3RoIiwibWF4UGFzc3dvcmRMZW5ndGgiLCJjb250YWluc0xvd2VyY2FzZUNoYXJhY3RlciIsImNvbnRhaW5zTG93ZXJjYXNlTGV0dGVyIiwiY29udGFpbnNVcHBlcmNhc2VDaGFyYWN0ZXIiLCJjb250YWluc1VwcGVyY2FzZUxldHRlciIsImNvbnRhaW5zTnVtZXJpY0NoYXJhY3RlciIsImNvbnRhaW5zTm9uQWxwaGFudW1lcmljQ2hhcmFjdGVyIiwiYWxsb3dlZE5vbkFscGhhbnVtZXJpY0NoYXJhY3RlcnMiLCJmb3JjZVVwZ3JhZGVPblNpZ25pbiIsInNjaGVtYVZlcnNpb24iLCJ2YWxpZGF0ZVBhc3N3b3JkIiwicGFzc3dvcmQiLCJzdGF0dXMiLCJpc1ZhbGlkIiwicGFzc3dvcmRQb2xpY3kiLCJ2YWxpZGF0ZVBhc3N3b3JkTGVuZ3RoT3B0aW9ucyIsInZhbGlkYXRlUGFzc3dvcmRDaGFyYWN0ZXJPcHRpb25zIiwibWVldHNNaW5QYXNzd29yZExlbmd0aCIsIm1lZXRzTWF4UGFzc3dvcmRMZW5ndGgiLCJwYXNzd29yZENoYXIiLCJ1cGRhdGVQYXNzd29yZENoYXJhY3Rlck9wdGlvbnNTdGF0dXNlcyIsImkiLCJjaGFyQXQiLCJBdXRoSW1wbCIsImhlYXJ0YmVhdFNlcnZpY2VQcm92aWRlciIsImFwcENoZWNrU2VydmljZVByb3ZpZGVyIiwib3BlcmF0aW9ucyIsImF1dGhTdGF0ZVN1YnNjcmlwdGlvbiIsIlN1YnNjcmlwdGlvbiIsImlkVG9rZW5TdWJzY3JpcHRpb24iLCJiZWZvcmVTdGF0ZVF1ZXVlIiwicmVkaXJlY3RVc2VyIiwiaXNQcm9hY3RpdmVSZWZyZXNoRW5hYmxlZCIsIkVYUEVDVEVEX1BBU1NXT1JEX1BPTElDWV9TQ0hFTUFfVkVSU0lPTiIsIl9pc0luaXRpYWxpemVkIiwiX2RlbGV0ZWQiLCJfaW5pdGlhbGl6YXRpb25Qcm9taXNlIiwiX3BvcHVwUmVkaXJlY3RSZXNvbHZlciIsIl9hZ2VudFJlY2FwdGNoYUNvbmZpZyIsIl90ZW5hbnRSZWNhcHRjaGFDb25maWdzIiwiX3Byb2plY3RQYXNzd29yZFBvbGljeSIsIl90ZW5hbnRQYXNzd29yZFBvbGljaWVzIiwiX3Jlc29sdmVQZXJzaXN0ZW5jZU1hbmFnZXJBdmFpbGFibGUiLCJsYXN0Tm90aWZpZWRVaWQiLCJzZXR0aW5ncyIsImFwcFZlcmlmaWNhdGlvbkRpc2FibGVkRm9yVGVzdGluZyIsImNsaWVudFZlcnNpb24iLCJzZGtDbGllbnRWZXJzaW9uIiwiX2luaXRpYWxpemVXaXRoUGVyc2lzdGVuY2UiLCJwb3B1cFJlZGlyZWN0UmVzb2x2ZXIiLCJwZXJzaXN0ZW5jZU1hbmFnZXIiLCJfc2hvdWxkSW5pdFByb2FjdGl2ZWx5IiwiX2luaXRpYWxpemUiLCJpbml0aWFsaXplQ3VycmVudFVzZXIiLCJhc3NlcnRlZFBlcnNpc3RlbmNlIiwiX2N1cnJlbnRVc2VyIiwiX3VwZGF0ZUN1cnJlbnRVc2VyIiwiaW5pdGlhbGl6ZUN1cnJlbnRVc2VyRnJvbUlkVG9rZW4iLCJkaXJlY3RseVNldEN1cnJlbnRVc2VyIiwiZXJyIiwiYXV0aElkVG9rZW4iLCJwcmV2aW91c2x5U3RvcmVkVXNlciIsImZ1dHVyZUN1cnJlbnRVc2VyIiwibmVlZHNUb2NoZWNrTWlkZGxld2FyZSIsImdldE9ySW5pdFJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyIiwicmVkaXJlY3RVc2VyRXZlbnRJZCIsInN0b3JlZFVzZXJFdmVudElkIiwidHJ5UmVkaXJlY3RTaWduSW4iLCJfb3ZlcnJpZGVSZWRpcmVjdFJlc3VsdCIsInJlbG9hZEFuZFNldEN1cnJlbnRVc2VyT3JDbGVhciIsInJlZGlyZWN0UmVzb2x2ZXIiLCJfY29tcGxldGVSZWRpcmVjdEZuIiwiX3NldFJlZGlyZWN0VXNlciIsInVzZURldmljZUxhbmd1YWdlIiwibmF2aWdhdG9yTGFuZ3VhZ2UiLCJsYW5ndWFnZXMiLCJsYW5ndWFnZSIsIl9nZXRVc2VyTGFuZ3VhZ2UiLCJfZGVsZXRlIiwidXBkYXRlQ3VycmVudFVzZXIiLCJ1c2VyRXh0ZXJuIiwic2tpcEJlZm9yZVN0YXRlQ2FsbGJhY2tzIiwibm90aWZ5QXV0aExpc3RlbmVycyIsInJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyIiwiX2dldFJlY2FwdGNoYUNvbmZpZyIsIl9nZXRQYXNzd29yZFBvbGljeUludGVybmFsIiwiX3VwZGF0ZVBhc3N3b3JkUG9saWN5IiwiX2dldFBhc3N3b3JkUG9saWN5IiwiX3VwZGF0ZUVycm9yTWFwIiwib25BdXRoU3RhdGVDaGFuZ2VkIiwibmV4dE9yT2JzZXJ2ZXIiLCJjb21wbGV0ZWQiLCJyZWdpc3RlclN0YXRlTGlzdGVuZXIiLCJiZWZvcmVBdXRoU3RhdGVDaGFuZ2VkIiwib25JZFRva2VuQ2hhbmdlZCIsImF1dGhTdGF0ZVJlYWR5IiwidW5zdWJzY3JpYmUiLCJyZXZva2VBY2Nlc3NUb2tlbiIsInRva2VuVHlwZSIsInJldm9rZVRva2VuIiwicmVkaXJlY3RNYW5hZ2VyIiwicmVzb2x2ZXIiLCJfcmVkaXJlY3RQZXJzaXN0ZW5jZSIsIl9yZWRpcmVjdFVzZXJGb3JJZCIsImlkIiwibmV4dCIsImN1cnJlbnRVaWQiLCJzdWJzY3JpcHRpb24iLCJjYiIsImlzVW5zdWJzY3JpYmVkIiwiYWRkT2JzZXJ2ZXIiLCJhY3Rpb24iLCJfbG9nRnJhbWV3b3JrIiwiZnJhbWV3b3JrIiwic29ydCIsIl9nZXRGcmFtZXdvcmtzIiwiaGVhcnRiZWF0c0hlYWRlciIsImdldEltbWVkaWF0ZSIsIm9wdGlvbmFsIiwiZ2V0SGVhcnRiZWF0c0hlYWRlciIsImFwcENoZWNrVG9rZW4iLCJfZ2V0QXBwQ2hlY2tUb2tlbiIsImFwcENoZWNrVG9rZW5SZXN1bHQiLCJfbG9nV2FybiIsIl9jYXN0QXV0aCIsIm9ic2VydmVyIiwiZXh0ZXJuYWxKU1Byb3ZpZGVyIiwibG9hZEpTIiwicmVjYXB0Y2hhVjJTY3JpcHQiLCJyZWNhcHRjaGFFbnRlcnByaXNlU2NyaXB0IiwiZ2FwaVNjcmlwdCIsIk1vY2tHcmVDQVBUQ0hBVG9wTGV2ZWwiLCJNb2NrR3JlQ0FQVENIQSIsInJlYWR5IiwiZXhlY3V0ZSIsIl9zaXRlS2V5IiwiX29wdGlvbnMiLCJyZW5kZXIiLCJfY29udGFpbmVyIiwiX3BhcmFtZXRlcnMiLCJGQUtFX1RPS0VOIiwiUmVjYXB0Y2hhRW50ZXJwcmlzZVZlcmlmaWVyIiwiYXV0aEV4dGVybiIsInZlcmlmeSIsInJldHJpZXZlUmVjYXB0Y2hhVG9rZW4iLCJ3aW5kb3ciLCJnZXRSZWNhcHRjaGFDb25maWciLCJjbGllbnRUeXBlIiwicmV0cmlldmVTaXRlS2V5IiwiX2xvYWRKUyIsImluamVjdFJlY2FwdGNoYUZpZWxkcyIsImlzQ2FwdGNoYVJlc3AiLCJpc0Zha2VUb2tlbiIsInZlcmlmaWVyIiwiY2FwdGNoYVJlc3BvbnNlIiwibmV3UmVxdWVzdCIsInBob25lRW5yb2xsbWVudEluZm8iLCJyZWNhcHRjaGFUb2tlbiIsInBob25lU2lnbkluSW5mbyIsImhhbmRsZVJlY2FwdGNoYUZsb3ciLCJhdXRoSW5zdGFuY2UiLCJhY3Rpb25OYW1lIiwiYWN0aW9uTWV0aG9kIiwicmVjYXB0Y2hhQXV0aFByb3ZpZGVyIiwicmVxdWVzdFdpdGhSZWNhcHRjaGEiLCJyZXF1ZXN0V2l0aFJlY2FwdGNoYUZpZWxkcyIsImluaXRpYWxpemVBdXRoIiwiZGVwcyIsImlzSW5pdGlhbGl6ZWQiLCJpbml0aWFsT3B0aW9ucyIsImdldE9wdGlvbnMiLCJjb25uZWN0QXV0aEVtdWxhdG9yIiwiZGlzYWJsZVdhcm5pbmdzIiwiZXh0cmFjdFByb3RvY29sIiwicG9ydCIsImF1dGhvcml0eSIsImV4ZWMiLCJzdWJzdHIiLCJob3N0QW5kUG9ydCIsInBvcCIsImJyYWNrZXRlZElQdjYiLCJwYXJzZVBvcnQiLCJleHRyYWN0SG9zdEFuZFBvcnQiLCJwb3J0U3RyIiwiZnJlZXplIiwiYXR0YWNoQmFubmVyIiwiZWwiLCJjcmVhdGVFbGVtZW50Iiwic3R5Iiwic3R5bGUiLCJpbm5lclRleHQiLCJwb3NpdGlvbiIsIndpZHRoIiwiYmFja2dyb3VuZENvbG9yIiwiYm9yZGVyIiwiY29sb3IiLCJib3R0b20iLCJsZWZ0IiwibWFyZ2luIiwiekluZGV4IiwidGV4dEFsaWduIiwiY2xhc3NMaXN0IiwiYWRkIiwiYXBwZW5kQ2hpbGQiLCJyZWFkeVN0YXRlIiwiZW1pdEVtdWxhdG9yV2FybmluZyIsInByb3RvY29sRW5kIiwiaW5kZXhPZiIsIkF1dGhDcmVkZW50aWFsIiwic2lnbkluTWV0aG9kIiwiX2dldElkVG9rZW5SZXNwb25zZSIsIl9hdXRoIiwiX2xpbmtUb0lkVG9rZW4iLCJfaWRUb2tlbiIsIl9nZXRSZWF1dGhlbnRpY2F0aW9uUmVzb2x2ZXIiLCJsaW5rRW1haWxQYXNzd29yZCIsInNpZ25JbldpdGhQYXNzd29yZCIsIkVtYWlsQXV0aENyZWRlbnRpYWwiLCJfZW1haWwiLCJfcGFzc3dvcmQiLCJfdGVuYW50SWQiLCJzdXBlciIsIl9mcm9tRW1haWxBbmRQYXNzd29yZCIsIl9mcm9tRW1haWxBbmRDb2RlIiwib29iQ29kZSIsIm9iaiIsInJldHVyblNlY3VyZVRva2VuIiwic2lnbkluV2l0aEVtYWlsTGluayQxIiwic2lnbkluV2l0aEVtYWlsTGlua0ZvckxpbmtpbmciLCJzaWduSW5XaXRoSWRwIiwiT0F1dGhDcmVkZW50aWFsIiwiYXJndW1lbnRzIiwicGVuZGluZ1Rva2VuIiwiX2Zyb21QYXJhbXMiLCJjcmVkIiwibm9uY2UiLCJvYXV0aFRva2VuIiwib2F1dGhUb2tlblNlY3JldCIsInNlY3JldCIsImJ1aWxkUmVxdWVzdCIsImF1dG9DcmVhdGUiLCJyZXF1ZXN0VXJpIiwicG9zdEJvZHkiLCJBY3Rpb25Db2RlVVJMIiwiYWN0aW9uTGluayIsInNlYXJjaFBhcmFtcyIsIm9wZXJhdGlvbiIsIm1vZGUiLCJwYXJzZU1vZGUiLCJjb250aW51ZVVybCIsInBhcnNlTGluayIsImxpbmsiLCJkb3VibGVEZWVwTGluayIsImlPU0RlZXBMaW5rIiwicGFyc2VEZWVwTGluayIsIkVtYWlsQXV0aFByb3ZpZGVyIiwiUFJPVklERVJfSUQiLCJjcmVkZW50aWFsIiwiY3JlZGVudGlhbFdpdGhMaW5rIiwiZW1haWxMaW5rIiwiYWN0aW9uQ29kZVVybCIsIkVNQUlMX1BBU1NXT1JEX1NJR05fSU5fTUVUSE9EIiwiRU1BSUxfTElOS19TSUdOX0lOX01FVEhPRCIsIkZlZGVyYXRlZEF1dGhQcm92aWRlciIsImRlZmF1bHRMYW5ndWFnZUNvZGUiLCJjdXN0b21QYXJhbWV0ZXJzIiwic2V0RGVmYXVsdExhbmd1YWdlIiwic2V0Q3VzdG9tUGFyYW1ldGVycyIsImN1c3RvbU9BdXRoUGFyYW1ldGVycyIsImdldEN1c3RvbVBhcmFtZXRlcnMiLCJCYXNlT0F1dGhQcm92aWRlciIsInNjb3BlcyIsImFkZFNjb3BlIiwic2NvcGUiLCJnZXRTY29wZXMiLCJGYWNlYm9va0F1dGhQcm92aWRlciIsIkZBQ0VCT09LX1NJR05fSU5fTUVUSE9EIiwiY3JlZGVudGlhbEZyb21SZXN1bHQiLCJ1c2VyQ3JlZGVudGlhbCIsImNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0IiwiY3JlZGVudGlhbEZyb21FcnJvciIsInRva2VuUmVzcG9uc2UiLCJvYXV0aEFjY2Vzc1Rva2VuIiwiR29vZ2xlQXV0aFByb3ZpZGVyIiwiR09PR0xFX1NJR05fSU5fTUVUSE9EIiwib2F1dGhJZFRva2VuIiwiR2l0aHViQXV0aFByb3ZpZGVyIiwiR0lUSFVCX1NJR05fSU5fTUVUSE9EIiwiVHdpdHRlckF1dGhQcm92aWRlciIsIlRXSVRURVJfU0lHTl9JTl9NRVRIT0QiLCJXZWFrTWFwIiwiU1RPUkFHRV9BVkFJTEFCTEVfS0VZIiwiUmVjZWl2ZXIiLCJldmVudFRhcmdldCIsImhhbmRsZXJzTWFwIiwiaGFuZGxlRXZlbnQiLCJleGlzdGluZ0luc3RhbmNlIiwicmVjZWl2ZXJzIiwiZmluZCIsImlzTGlzdGVuaW5ndG8iLCJuZXdJbnN0YW5jZSIsIm1lc3NhZ2VFdmVudCIsImV2ZW50SWQiLCJldmVudFR5cGUiLCJkYXRhIiwiaGFuZGxlcnMiLCJzaXplIiwicG9ydHMiLCJwb3N0TWVzc2FnZSIsInByb21pc2VzIiwiZnJvbSIsImhhbmRsZXIiLCJvcmlnaW4iLCJmdWxmaWxsZWQiLCJyZWFzb24iLCJfYWxsU2V0dGxlZCIsIl9zdWJzY3JpYmUiLCJldmVudEhhbmRsZXIiLCJrZXlzIiwiU2V0IiwiX3Vuc3Vic2NyaWJlIiwiZGVsZXRlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlNlbmRlciIsInJlbW92ZU1lc3NhZ2VIYW5kbGVyIiwibWVzc2FnZUNoYW5uZWwiLCJwb3J0MSIsIm9uTWVzc2FnZSIsImNsb3NlIiwiX3NlbmQiLCJ0aW1lb3V0IiwiTWVzc2FnZUNoYW5uZWwiLCJjb21wbGV0aW9uVGltZXIiLCJwcmVmaXgiLCJkaWdpdHMiLCJyYW5kb20iLCJmbG9vciIsIl9nZW5lcmF0ZUV2ZW50SWQiLCJzdGFydCIsImFja1RpbWVyIiwicG9ydDIiLCJmaW5hbGx5IiwiX3dpbmRvdyIsIl9pc1dvcmtlciIsIkRCX05BTUUiLCJEQl9PQkpFQ1RTVE9SRV9OQU1FIiwiREJfREFUQV9LRVlQQVRIIiwiREJQcm9taXNlIiwidG9Qcm9taXNlIiwiZ2V0T2JqZWN0U3RvcmUiLCJpc1JlYWRXcml0ZSIsIm9iamVjdFN0b3JlIiwiX29wZW5EYXRhYmFzZSIsImNyZWF0ZU9iamVjdFN0b3JlIiwia2V5UGF0aCIsIm9iamVjdFN0b3JlTmFtZXMiLCJjb250YWlucyIsImRlbGV0ZURhdGFiYXNlIiwiX2RlbGV0ZURhdGFiYXNlIiwiX3B1dE9iamVjdCIsInB1dCIsIl9kZWxldGVPYmplY3QiLCJJbmRleGVkREJMb2NhbFBlcnNpc3RlbmNlIiwibGlzdGVuZXJzIiwibG9jYWxDYWNoZSIsInBvbGxUaW1lciIsInBlbmRpbmdXcml0ZXMiLCJzZW5kZXIiLCJzZXJ2aWNlV29ya2VyUmVjZWl2ZXJBdmFpbGFibGUiLCJhY3RpdmVTZXJ2aWNlV29ya2VyIiwiX3dvcmtlckluaXRpYWxpemF0aW9uUHJvbWlzZSIsImluaXRpYWxpemVTZXJ2aWNlV29ya2VyTWVzc2FnaW5nIiwiX29wZW5EYiIsIl93aXRoUmV0cmllcyIsIm9wIiwibnVtQXR0ZW1wdHMiLCJpbml0aWFsaXplUmVjZWl2ZXIiLCJpbml0aWFsaXplU2VuZGVyIiwiX29yaWdpbiIsImtleVByb2Nlc3NlZCIsIl9wb2xsIiwiX2RhdGEiLCJzZXJ2aWNlV29ya2VyIiwiYWN0aXZlIiwiX2dldEFjdGl2ZVNlcnZpY2VXb3JrZXIiLCJyZXN1bHRzIiwibm90aWZ5U2VydmljZVdvcmtlciIsImNvbnRyb2xsZXIiLCJfd2l0aFBlbmRpbmdXcml0ZSIsIndyaXRlIiwiZ2V0T2JqZWN0IiwiZ2V0QWxsUmVxdWVzdCIsImdldEFsbCIsImtleXNJblJlc3VsdCIsImZiYXNlX2tleSIsIm5vdGlmeUxpc3RlbmVycyIsImxvY2FsS2V5IiwibmV3VmFsdWUiLCJsaXN0ZW5lciIsInN0YXJ0UG9sbGluZyIsInN0b3BQb2xsaW5nIiwic2V0SW50ZXJ2YWwiLCJjbGVhckludGVydmFsIiwiaW5kZXhlZERCTG9jYWxQZXJzaXN0ZW5jZSIsIkF1dGhJbnRlcm9wIiwiaW50ZXJuYWxMaXN0ZW5lcnMiLCJnZXRVaWQiLCJhc3NlcnRBdXRoQ29uZmlndXJlZCIsImFkZEF1dGhUb2tlbkxpc3RlbmVyIiwidXBkYXRlUHJvYWN0aXZlUmVmcmVzaCIsInJlbW92ZUF1dGhUb2tlbkxpc3RlbmVyIiwicmVnaXN0ZXJBdXRoIiwiY29udGFpbmVyIiwiZ2V0UHJvdmlkZXIiLCJoaWVyYXJjaHkiLCJfaW5pdGlhbGl6ZUF1dGhJbnN0YW5jZSIsInNldEluc3RhbnRpYXRpb25Nb2RlIiwic2V0SW5zdGFuY2VDcmVhdGVkQ2FsbGJhY2siLCJfaW5zdGFuY2VJZGVudGlmaWVyIiwiX2luc3RhbmNlIiwiZ2V0VmVyc2lvbkZvclBsYXRmb3JtIiwic3RyaW5nVG9CeXRlQXJyYXkkMSIsInN0ciIsIm91dCIsImMiLCJjaGFyQ29kZUF0IiwiYmFzZTY0IiwiYnl0ZVRvQ2hhck1hcF8iLCJjaGFyVG9CeXRlTWFwXyIsImJ5dGVUb0NoYXJNYXBXZWJTYWZlXyIsImNoYXJUb0J5dGVNYXBXZWJTYWZlXyIsIkVOQ09ERURfVkFMU19CQVNFIiwiRU5DT0RFRF9WQUxTIiwiRU5DT0RFRF9WQUxTX1dFQlNBRkUiLCJIQVNfTkFUSVZFX1NVUFBPUlQiLCJhdG9iIiwiZW5jb2RlQnl0ZUFycmF5IiwiaW5wdXQiLCJ3ZWJTYWZlIiwiaW5pdF8iLCJieXRlVG9DaGFyTWFwIiwib3V0cHV0IiwiYnl0ZTEiLCJoYXZlQnl0ZTIiLCJieXRlMiIsImhhdmVCeXRlMyIsImJ5dGUzIiwib3V0Qnl0ZTEiLCJvdXRCeXRlMiIsIm91dEJ5dGUzIiwib3V0Qnl0ZTQiLCJlbmNvZGVTdHJpbmciLCJidG9hIiwiZGVjb2RlU3RyaW5nIiwiYnl0ZXMiLCJwb3MiLCJjMSIsImZyb21DaGFyQ29kZSIsImMyIiwidSIsImMzIiwiYnl0ZUFycmF5VG9TdHJpbmciLCJkZWNvZGVTdHJpbmdUb0J5dGVBcnJheSIsImNoYXJUb0J5dGVNYXAiLCJieXRlNCIsIkRlY29kZUJhc2U2NFN0cmluZ0Vycm9yIiwiYmFzZTY0dXJsRW5jb2RlV2l0aG91dFBhZGRpbmciLCJ1dGY4Qnl0ZXMiLCJiYXNlNjRFbmNvZGUiLCJiYXNlNjREZWNvZGUiLCJnZXRHbG9iYWwiLCJnIiwiZ2V0RGVmYXVsdHMiLCJfX0ZJUkVCQVNFX0RFRkFVTFRTX18iLCJwcm9jZXNzIiwiZGVmYXVsdHNKc29uU3RyaW5nIiwiZ2V0RGVmYXVsdHNGcm9tRW52VmFyaWFibGUiLCJjb29raWUiLCJnZXREZWZhdWx0c0Zyb21Db29raWUiLCJnZXREZWZhdWx0RW11bGF0b3JIb3N0IiwicHJvZHVjdE5hbWUiLCJlbXVsYXRvckhvc3RzIiwiZ2V0RGVmYXVsdEVtdWxhdG9ySG9zdG5hbWVBbmRQb3J0Iiwic2VwYXJhdG9ySW5kZXgiLCJsYXN0SW5kZXhPZiIsInBhcnNlSW50Iiwic3Vic3RyaW5nIiwiZ2V0RGVmYXVsdEFwcENvbmZpZyIsImdldEV4cGVyaW1lbnRhbFNldHRpbmciLCJEZWZlcnJlZCIsIndyYXBDYWxsYmFjayIsImlzQ2xvdWRXb3Jrc3RhdGlvbiIsIlVSTCIsImhvc3RuYW1lIiwiZW5kc1dpdGgiLCJwaW5nU2VydmVyIiwiZW5kcG9pbnQiLCJjcmVhdGVNb2NrVXNlclRva2VuIiwicHJvamVjdCIsInN1YiIsInVzZXJfaWQiLCJpc3MiLCJhdWQiLCJzaWduX2luX3Byb3ZpZGVyIiwiaWRlbnRpdGllcyIsImFsZyIsImVtdWxhdG9yU3RhdHVzIiwicHJldmlvdXNseURpc21pc3NlZCIsInVwZGF0ZUVtdWxhdG9yQmFubmVyIiwiaXNSdW5uaW5nRW11bGF0b3IiLCJwcmVmaXhlZElkIiwiYmFubmVySWQiLCJzaG93RXJyb3IiLCJzdW1tYXJ5IiwicHJvZCIsImdldEVtdWxhdG9yU3VtbWFyeSIsInNldHVwRG9tIiwiYmFubmVyIiwicGFyZW50RGl2IiwiZ2V0RWxlbWVudEJ5SWQiLCJjcmVhdGVkIiwic2V0QXR0cmlidXRlIiwiZWxlbWVudCIsImdldE9yQ3JlYXRlRWwiLCJmaXJlYmFzZVRleHRJZCIsImZpcmViYXNlVGV4dCIsImxlYXJuTW9yZUlkIiwibGVhcm5Nb3JlTGluayIsInByZXBlbmRJY29uSWQiLCJwcmVwZW5kSWNvbiIsImNyZWF0ZUVsZW1lbnROUyIsImJhbm5lckVsIiwiZGlzcGxheSIsImJhY2tncm91bmQiLCJwYWRkaW5nIiwiYm9yZGVyUmFkaXVzIiwiYWxpZ25JdGVtcyIsInNldHVwQmFubmVyU3R5bGVzIiwiaHJlZiIsInBhZGRpbmdMZWZ0IiwidGV4dERlY29yYXRpb24iLCJzZXR1cExpbmtTdHlsZXMiLCJjbG9zZUJ0biIsImN1cnNvciIsIm1hcmdpbkxlZnQiLCJmb250U2l6ZSIsImlubmVySFRNTCIsIm9uY2xpY2siLCJyZW1vdmUiLCJ0ZWFyRG93biIsInNldHVwQ2xvc2VCdG4iLCJpY29uSWQiLCJzZXR1cEljb25TdHlsZXMiLCJhcHBlbmQiLCJnZXRVQSIsImlzTW9iaWxlQ29yZG92YSIsImlzTm9kZSIsImZvcmNlRW52aXJvbm1lbnQiLCJjYWxsIiwiaXNDbG91ZGZsYXJlV29ya2VyIiwiaXNCcm93c2VyRXh0ZW5zaW9uIiwicnVudGltZSIsImNocm9tZSIsImJyb3dzZXIiLCJpc1JlYWN0TmF0aXZlIiwiaXNJRSIsImlzU2FmYXJpIiwiaXNTYWZhcmlPcldlYmtpdCIsImlzSW5kZXhlZERCQXZhaWxhYmxlIiwidmFsaWRhdGVJbmRleGVkREJPcGVuYWJsZSIsInByZUV4aXN0IiwiREJfQ0hFQ0tfTkFNRSIsIm9uc3VjY2VzcyIsIm9udXBncmFkZW5lZWRlZCIsIm9uZXJyb3IiLCJGaXJlYmFzZUVycm9yIiwic2V0UHJvdG90eXBlT2YiLCJjYXB0dXJlU3RhY2tUcmFjZSIsIkVycm9yRmFjdG9yeSIsInNlcnZpY2UiLCJzZXJ2aWNlTmFtZSIsImVycm9ycyIsImZ1bGxDb2RlIiwidGVtcGxhdGUiLCJQQVRURVJOIiwicmVwbGFjZVRlbXBsYXRlIiwiZnVsbE1lc3NhZ2UiLCJpc0VtcHR5IiwiaGFzT3duUHJvcGVydHkiLCJkZWVwRXF1YWwiLCJhIiwiYiIsImFLZXlzIiwiYktleXMiLCJhUHJvcCIsImJQcm9wIiwiaXNPYmplY3QiLCJ0aGluZyIsInF1ZXJ5c3RyaW5nIiwicXVlcnlzdHJpbmdQYXJhbXMiLCJlbnRyaWVzIiwiZm9yRWFjaCIsImFycmF5VmFsIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwicXVlcnlzdHJpbmdEZWNvZGUiLCJkZWNvZGVVUklDb21wb25lbnQiLCJleHRyYWN0UXVlcnlzdHJpbmciLCJxdWVyeVN0YXJ0IiwiZnJhZ21lbnRTdGFydCIsImNyZWF0ZVN1YnNjcmliZSIsImV4ZWN1dG9yIiwib25Ob09ic2VydmVycyIsInByb3h5IiwiT2JzZXJ2ZXJQcm94eSIsInN1YnNjcmliZSIsIm9ic2VydmVycyIsInVuc3Vic2NyaWJlcyIsIm9ic2VydmVyQ291bnQiLCJ0YXNrIiwiZmluYWxpemVkIiwiZm9yRWFjaE9ic2VydmVyIiwiY29tcGxldGUiLCJpbXBsZW1lbnRzQW55TWV0aG9kcyIsIm5vb3AiLCJ1bnN1YiIsInVuc3Vic2NyaWJlT25lIiwiZmluYWxFcnJvciIsImZuIiwic2VuZE9uZSIsImdldE1vZHVsYXJJbnN0YW5jZSIsIl9kZWxlZ2F0ZSIsIkNvbXBvbmVudCIsImluc3RhbmNlRmFjdG9yeSIsIm11bHRpcGxlSW5zdGFuY2VzIiwic2VydmljZVByb3BzIiwiaW5zdGFudGlhdGlvbk1vZGUiLCJvbkluc3RhbmNlQ3JlYXRlZCIsInNldE11bHRpcGxlSW5zdGFuY2VzIiwic2V0U2VydmljZVByb3BzIiwicHJvcHMiLCJERUZBVUxUX0VOVFJZX05BTUUiLCJQcm92aWRlciIsImNvbXBvbmVudCIsImluc3RhbmNlc0RlZmVycmVkIiwiaW5zdGFuY2VzT3B0aW9ucyIsIm9uSW5pdENhbGxiYWNrcyIsImlkZW50aWZpZXIiLCJub3JtYWxpemVkSWRlbnRpZmllciIsIm5vcm1hbGl6ZUluc3RhbmNlSWRlbnRpZmllciIsImRlZmVycmVkIiwic2hvdWxkQXV0b0luaXRpYWxpemUiLCJnZXRPckluaXRpYWxpemVTZXJ2aWNlIiwiaW5zdGFuY2VJZGVudGlmaWVyIiwiZ2V0Q29tcG9uZW50Iiwic2V0Q29tcG9uZW50IiwiaXNDb21wb25lbnRFYWdlciIsImluc3RhbmNlRGVmZXJyZWQiLCJjbGVhckluc3RhbmNlIiwic2VydmljZXMiLCJ2YWx1ZXMiLCJJTlRFUk5BTCIsImlzQ29tcG9uZW50U2V0Iiwib3B0cyIsIm9uSW5pdCIsImV4aXN0aW5nQ2FsbGJhY2tzIiwiaW52b2tlT25Jbml0Q2FsbGJhY2tzIiwiY2FsbGJhY2tzIiwiQ29tcG9uZW50Q29udGFpbmVyIiwiYWRkQ29tcG9uZW50IiwiYWRkT3JPdmVyd3JpdGVDb21wb25lbnQiLCJnZXRQcm92aWRlcnMiLCJYaHJJbyIsIldlYkNoYW5uZWwiLCJFdmVudFR5cGUiLCJFcnJvckNvZGUiLCJTdGF0IiwiRXZlbnQiLCJnZXRTdGF0RXZlbnRUYXJnZXQiLCJjcmVhdGVXZWJDaGFubmVsVHJhbnNwb3J0IiwiY29tbW9uanNHbG9iYWwiLCJnbG9iYWwiLCJ3ZWJjaGFubmVsX2Jsb2JfZXMyMDE4IiwiaCIsImFhIiwiZGVmaW5lUHJvcGVydHkiLCJjYSIsImJhIiwiZGEiLCJkIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJTeW1ib2wiLCJpdGVyYXRvciIsImVhIiwibCIsImZhIiwiYXBwbHkiLCJoYSIsInQiLCJaIiwiT2IiLCJmIiwiaWEiLCJBc3luY0NvbnRleHQiLCJTbmFwc2hvdCIsIndyYXAiLCJqYSIsImthIiwibWEiLCJuYSIsIm9hIiwicWEiLCJqIiwicmEiLCJyZXNldCIsInYiLCJ0YSIsInNhIiwiQyIsIngiLCJkZWZhdWx0UHJldmVudGVkIiwiZGlzcG9zZSIsIk4iLCJ5IiwieiIsInJlbGF0ZWRUYXJnZXQiLCJidXR0b24iLCJzY3JlZW5ZIiwic2NyZWVuWCIsImNsaWVudFkiLCJjbGllbnRYIiwibWV0YUtleSIsInNoaWZ0S2V5IiwiYWx0S2V5IiwiY3RybEtleSIsInN0YXRlIiwicG9pbnRlcklkIiwicG9pbnRlclR5cGUiLCJpbml0IiwiY2hhbmdlZFRvdWNoZXMiLCJzcmNFbGVtZW50IiwiZnJvbUVsZW1lbnQiLCJ0b0VsZW1lbnQiLCJwYWdlWCIsInBhZ2VZIiwicHJldmVudERlZmF1bHQiLCJyZXR1cm5WYWx1ZSIsIkIiLCJ2YSIsIndhIiwic3JjIiwiY2FwdHVyZSIsInhhIiwieWEiLCJCYSIsIkNhIiwiRGEiLCJFYSIsIkdhIiwic3BsaWNlIiwiRmEiLCJIYSIsIklhIiwiS2EiLCJvbmNlIiwiTGEiLCJNYSIsIkoiLCJOYSIsIk9hIiwiUmEiLCJQYSIsImF0dGFjaEV2ZW50IiwiUWEiLCJhZGRMaXN0ZW5lciIsInJlbW92ZUxpc3RlbmVyIiwiSyIsIlNhIiwiVGEiLCJkZXRhY2hFdmVudCIsIlVhIiwiTSIsIkciLCJEIiwiVmEiLCJjb25jYXQiLCJxIiwiWGEiLCJXYSIsIm0iLCJZYSIsIkUiLCJaYSIsIiRhIiwiYWIiLCJlYiIsImZiIiwiSCIsIk9QRU4iLCJoYiIsInRiIiwiZ2IiLCJJIiwiaWIiLCJqYiIsImtiIiwibGIiLCJtYiIsIlNUQVRfRVZFTlQiLCJzdGF0IiwibmIiLCJKYSIsIm9iIiwicGIiLCJzYiIsIndiIiwidWIiLCJOT19FUlJPUiIsInFiIiwicmIiLCJUSU1FT1VUIiwidmIiLCJGYiIsInhiIiwieWIiLCJOYiIsIkwiLCJTIiwiViIsIkEiLCJGIiwiVCIsIlgiLCJQIiwiTyIsIlciLCJVIiwiUiIsInpiIiwiWE1MSHR0cFJlcXVlc3QiLCJBYiIsIkJiIiwiQ2IiLCJEYiIsIkViIiwiR2IiLCJIYiIsIlkiLCJBYSIsIlNiIiwiSmIiLCJNYiIsIlFiIiwiUSIsImFib3J0IiwiTGIiLCJUYiIsIlViIiwiVmIiLCJXYiIsIlhiIiwiemEiLCJnZXRSZXNwb25zZUhlYWRlciIsIlliIiwiYmIiLCJaYiIsIiRiIiwiYWMiLCJiYyIsImNjIiwibGEiLCJJYiIsIlRleHREZWNvZGVyIiwiZGVjb2RlIiwic3RyZWFtIiwiS2IiLCJQYiIsImdldEFsbFJlc3BvbnNlSGVhZGVycyIsInRyaW0iLCJSYiIsImNhbmNlbCIsImRjIiwiZWMiLCJQZXJmb3JtYW5jZU5hdmlnYXRpb25UaW1pbmciLCJwZXJmb3JtYW5jZSIsImdldEVudHJpZXNCeVR5cGUiLCJuZXh0SG9wUHJvdG9jb2wiLCJsb2FkVGltZXMiLCJ3YXNGZXRjaGVkVmlhU3BkeSIsImZjIiwiaGMiLCJjbGVhciIsImljIiwiUmVnRXhwIiwia2MiLCJsYyIsIm1jIiwibmMiLCJvYyIsInBjIiwieWMiLCJ2YyIsInFjIiwid2MiLCJhYnMiLCJkZWNvZGVVUkkiLCJlbmNvZGVVUkkiLCJ4YyIsInJjIiwic2MiLCJ0YyIsInVjIiwiamMiLCJ6YyIsIkFjIiwib25sb2FkIiwib25hYm9ydCIsIm9udGltZW91dCIsIkRjIiwiRWMiLCJGYyIsInJlc3BvbnNlVHlwZSIsInJlc3BvbnNlVGV4dCIsInN0YXR1c1RleHQiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJBYm9ydENvbnRyb2xsZXIiLCJJYyIsInJlYWQiLCJnYSIsIkhjIiwiR2MiLCJKYyIsIktjIiwic2VuZCIsInNpZ25hbCIsImFib3J0ZWQiLCJjYWNoZSIsIlJlcXVlc3QiLCJhcnJheUJ1ZmZlciIsIlJlYWRhYmxlU3RyZWFtIiwiZ2V0UmVhZGVyIiwidGV4dCIsIlVpbnQ4QXJyYXkiLCJzZXRSZXF1ZXN0SGVhZGVyIiwiTGMiLCJNYyIsIk5jIiwiT2MiLCJQYyIsIlFjIiwibW96UmVzcG9uc2VBcnJheUJ1ZmZlciIsIlJjIiwiaW50ZXJuYWxDaGFubmVsUGFyYW1zIiwiU2MiLCJ4bWxIdHRwRmFjdG9yeSIsInVzZUZldGNoU3RyZWFtcyIsInN1cHBvcnRzQ3Jvc3NEb21haW5YaHIiLCJjb25jdXJyZW50UmVxdWVzdExpbWl0IiwiZmFzdEhhbmRzaGFrZSIsImVuY29kZUluaXRNZXNzYWdlSGVhZGVycyIsImZvcmNlTG9uZ1BvbGxpbmciLCJkZXRlY3RCdWZmZXJpbmdQcm94eSIsImxvbmdQb2xsaW5nVGltZW91dCIsIlRjIiwiVWMiLCJzZW5kQmVhY29uIiwiSW1hZ2UiLCJWYyIsIlpjIiwiWWMiLCJyb3VuZCIsIlhjIiwiJGMiLCJXYyIsImlzQWN0aXZlIiwiQmMiLCJDYyIsInBhIiwiYWQiLCJiZCIsIm1lc3NhZ2VVcmxQYXJhbXMiLCJtZXNzYWdlSGVhZGVycyIsImNsaWVudFByb3RvY29sSGVhZGVyUmVxdWlyZWQiLCJpbml0TWVzc2FnZUhlYWRlcnMiLCJtZXNzYWdlQ29udGVudFR5cGUiLCJzZW5kUmF3SnNvbiIsImh0dHBTZXNzaW9uSWRQYXJhbSIsImNkIiwiX19oZWFkZXJzX18iLCJzdGF0dXNDb2RlIiwiX19zdGF0dXNfXyIsIl9fc21fXyIsImRkIiwiZ2V0UHJvdG90eXBlT2YiLCJGb3JtRGF0YSIsIndpdGhDcmVkZW50aWFscyIsImNvbm5lY3QiLCJPU0lEIiwiT0FJRCIsIl9fZGF0YV9fIiwiY3JlYXRlV2ViQ2hhbm5lbCIsIlBST1hZIiwiTk9QUk9YWSIsIkhUVFBfRVJST1IiLCJDT01QTEVURSIsIkNMT1NFIiwiTUVTU0FHRSIsImxpc3RlbiIsIkZldGNoWG1sSHR0cEZhY3RvcnkiLCJsaXN0ZW5PbmNlIiwiZ2V0TGFzdEVycm9yIiwiZ2V0TGFzdEVycm9yQ29kZSIsImdldFN0YXR1cyIsImdldFJlc3BvbnNlSnNvbiIsImdldFJlc3BvbnNlVGV4dCIsInNldFdpdGhDcmVkZW50aWFscyIsIkludGVnZXIiLCJNZDUiLCJibG9vbV9ibG9iX2VzMjAxOCIsImJsb2NrU2l6ZSIsImlzRmluaXRlIiwiY2VpbCIsIkxOMiIsInBvdyIsImFuZCIsIm9yIiwieG9yIiwiZGlnZXN0IiwidXBkYXRlIiwibXVsdGlwbHkiLCJtb2R1bG8iLCJjb21wYXJlIiwidG9OdW1iZXIiLCJnZXRCaXRzIiwiZnJvbU51bWJlciIsImZyb21TdHJpbmciLCJnZXRBdXRoIiwiYXV0aEVtdWxhdG9ySG9zdCIsIlVzZXIiLCJpc0F1dGhlbnRpY2F0ZWQiLCJ0b0tleSIsImlzRXF1YWwiLCJVTkFVVEhFTlRJQ0FURUQiLCJHT09HTEVfQ1JFREVOVElBTFMiLCJGSVJTVF9QQVJUWSIsIk1PQ0tfVVNFUiIsIl9fUFJJVkFURV9nZXRMb2dMZXZlbCIsIl9fUFJJVkFURV9sb2dEZWJ1ZyIsIl9fUFJJVkFURV9hcmdUb1N0cmluZyIsIl9fUFJJVkFURV9sb2dFcnJvciIsIl9fUFJJVkFURV9sb2dXYXJuIiwiZmFpbCIsIl9fUFJJVkFURV9fZmFpbCIsIl9fUFJJVkFURV9oYXJkQXNzZXJ0IiwiX19QUklWQVRFX2RlYnVnQ2FzdCIsIk9LIiwiQ0FOQ0VMTEVEIiwiVU5LTk9XTiIsIklOVkFMSURfQVJHVU1FTlQiLCJERUFETElORV9FWENFRURFRCIsIk5PVF9GT1VORCIsIkFMUkVBRFlfRVhJU1RTIiwiUEVSTUlTU0lPTl9ERU5JRUQiLCJSRVNPVVJDRV9FWEhBVVNURUQiLCJGQUlMRURfUFJFQ09ORElUSU9OIiwiQUJPUlRFRCIsIk9VVF9PRl9SQU5HRSIsIlVOSU1QTEVNRU5URUQiLCJVTkFWQUlMQUJMRSIsIkRBVEFfTE9TUyIsIkZpcmVzdG9yZUVycm9yIiwiX19QUklWQVRFX0RlZmVycmVkIiwiX19QUklWQVRFX09BdXRoVG9rZW4iLCJfX1BSSVZBVEVfRW1wdHlBdXRoQ3JlZGVudGlhbHNQcm92aWRlciIsImludmFsaWRhdGVUb2tlbiIsImVucXVldWVSZXRyeWFibGUiLCJzaHV0ZG93biIsIl9fUFJJVkFURV9FbXVsYXRvckF1dGhDcmVkZW50aWFsc1Byb3ZpZGVyIiwiY2hhbmdlTGlzdGVuZXIiLCJfX1BSSVZBVEVfRmlyZWJhc2VBdXRoQ3JlZGVudGlhbHNQcm92aWRlciIsIl9fUFJJVkFURV9ndWFyZGVkQ2hhbmdlTGlzdGVuZXIiLCJfX1BSSVZBVEVfYXdhaXROZXh0VG9rZW4iLCJfX1BSSVZBVEVfcmVnaXN0ZXJBdXRoIiwiX19QUklWQVRFX0ZpcnN0UGFydHlUb2tlbiIsIl9fUFJJVkFURV9GaXJzdFBhcnR5QXV0aENyZWRlbnRpYWxzUHJvdmlkZXIiLCJBcHBDaGVja1Rva2VuIiwiX19QUklWQVRFX0ZpcmViYXNlQXBwQ2hlY2tUb2tlblByb3ZpZGVyIiwiYXBwQ2hlY2siLCJvblRva2VuQ2hhbmdlZCIsIl9fUFJJVkFURV9yZWdpc3RlckFwcENoZWNrIiwiYWRkVG9rZW5MaXN0ZW5lciIsInRva2VuUmVzdWx0IiwicmVtb3ZlVG9rZW5MaXN0ZW5lciIsIl9fUFJJVkFURV9yYW5kb21CeXRlcyIsImNyeXB0byIsIm1zQ3J5cHRvIiwiZ2V0UmFuZG9tVmFsdWVzIiwiX19QUklWQVRFX0F1dG9JZCIsIm5ld0lkIiwiX19QUklWQVRFX3ByaW1pdGl2ZUNvbXBhcmF0b3IiLCJfX1BSSVZBVEVfY29tcGFyZVV0ZjhTdHJpbmdzIiwiX19QUklWQVRFX2lzU3Vycm9nYXRlIiwiX19QUklWQVRFX2FycmF5RXF1YWxzIiwiZXZlcnkiLCJCYXNlUGF0aCIsIm9mZnNldCIsInJhbmdlIiwic2VnbWVudHMiLCJsZW4iLCJjb21wYXJhdG9yIiwiY2hpbGQiLCJsaW1pdCIsImNvbnN0cnVjdCIsInBvcEZpcnN0IiwicG9wTGFzdCIsImZpcnN0U2VnbWVudCIsImxhc3RTZWdtZW50IiwiaXNQcmVmaXhPZiIsImlzSW1tZWRpYXRlUGFyZW50T2YiLCJ0b0FycmF5IiwiY29tcGFyZVNlZ21lbnRzIiwiaXNOdW1lcmljSWQiLCJleHRyYWN0TnVtZXJpY0lkIiwiUmVzb3VyY2VQYXRoIiwiY2Fub25pY2FsU3RyaW5nIiwidG9VcmlFbmNvZGVkU3RyaW5nIiwiZW1wdHlQYXRoIiwiRmllbGRQYXRoJDEiLCJpc1ZhbGlkSWRlbnRpZmllciIsImlzS2V5RmllbGQiLCJrZXlGaWVsZCIsImZyb21TZXJ2ZXJGb3JtYXQiLCJfX1BSSVZBVEVfYWRkQ3VycmVudFNlZ21lbnQiLCJEb2N1bWVudEtleSIsImZyb21QYXRoIiwiZnJvbU5hbWUiLCJlbXB0eSIsImNvbGxlY3Rpb25Hcm91cCIsImhhc0NvbGxlY3Rpb25JZCIsImdldENvbGxlY3Rpb25Hcm91cCIsImdldENvbGxlY3Rpb25QYXRoIiwiaXNEb2N1bWVudEtleSIsImZyb21TZWdtZW50cyIsIl9fUFJJVkFURV9jYXN0IiwiX19QUklWQVRFX3ZhbHVlRGVzY3JpcHRpb24iLCJwcm9wZXJ0eSIsInR5cGVTdHJpbmciLCJfX1BSSVZBVEVfdmFsaWRhdGVKU09OIiwiX19QUklWQVRFX2lzUGxhaW5PYmplY3QiLCJzIiwiJCIsIlRpbWVzdGFtcCIsImZyb21NaWxsaXMiLCJmcm9tRGF0ZSIsIm5hbm9zZWNvbmRzIiwidG9EYXRlIiwidG9NaWxsaXMiLCJfY29tcGFyZVRvIiwiX2pzb25TY2hlbWFWZXJzaW9uIiwiX2pzb25TY2hlbWEiLCJ2YWx1ZU9mIiwicGFkU3RhcnQiLCJTbmFwc2hvdFZlcnNpb24iLCJmcm9tVGltZXN0YW1wIiwidGltZXN0YW1wIiwiY29tcGFyZVRvIiwidG9NaWNyb3NlY29uZHMiLCJ0b1RpbWVzdGFtcCIsIl9fUFJJVkFURV9uZXdJbmRleE9mZnNldEZyb21Eb2N1bWVudCIsIkluZGV4T2Zmc2V0IiwicmVhZFRpbWUiLCJkb2N1bWVudEtleSIsImxhcmdlc3RCYXRjaElkIiwiX19QUklWQVRFX2luZGV4T2Zmc2V0Q29tcGFyYXRvciIsIlBlcnNpc3RlbmNlVHJhbnNhY3Rpb24iLCJvbkNvbW1pdHRlZExpc3RlbmVycyIsImFkZE9uQ29tbWl0dGVkTGlzdGVuZXIiLCJyYWlzZU9uQ29tbWl0dGVkRXZlbnQiLCJQZXJzaXN0ZW5jZVByb21pc2UiLCJuZXh0Q2FsbGJhY2siLCJjYXRjaENhbGxiYWNrIiwiaXNEb25lIiwiY2FsbGJhY2tBdHRhY2hlZCIsIndyYXBGYWlsdXJlIiwid3JhcFN1Y2Nlc3MiLCJ3cmFwVXNlckZ1bmN0aW9uIiwid2FpdEZvciIsIm1hcEFycmF5IiwiZG9XaGlsZSIsIl9fUFJJVkFURV9pc0luZGV4ZWREYlRyYW5zYWN0aW9uRXJyb3IiLCJfX1BSSVZBVEVfTGlzdGVuU2VxdWVuY2UiLCJwcmV2aW91c1ZhbHVlIiwic2VxdWVuY2VOdW1iZXJIYW5kbGVyIiwiYWUiLCJ1ZSIsIndyaXRlU2VxdWVuY2VOdW1iZXIiLCJjZSIsIl9fUFJJVkFURV9pc051bGxPclVuZGVmaW5lZCIsIl9fUFJJVkFURV9pc05lZ2F0aXZlWmVybyIsInRlIiwib2UiLCJQZSIsIkllIiwiQWUiLCJnZSIsInBlIiwid2UiLCJiZSIsIkNlIiwiX19QUklWQVRFX29iamVjdFNpemUiLCJTb3J0ZWRNYXAiLCJyb290IiwiTExSQk5vZGUiLCJFTVBUWSIsImluc2VydCIsImNvcHkiLCJCTEFDSyIsInJpZ2h0IiwibWluS2V5IiwibWF4S2V5IiwiaW5vcmRlclRyYXZlcnNhbCIsInJldmVyc2VUcmF2ZXJzYWwiLCJnZXRJdGVyYXRvciIsIlNvcnRlZE1hcEl0ZXJhdG9yIiwiZ2V0SXRlcmF0b3JGcm9tIiwiZ2V0UmV2ZXJzZUl0ZXJhdG9yIiwiZ2V0UmV2ZXJzZUl0ZXJhdG9yRnJvbSIsImlzUmV2ZXJzZSIsIm5vZGVTdGFjayIsImdldE5leHQiLCJoYXNOZXh0IiwicGVlayIsIlJFRCIsImZpeFVwIiwicmVtb3ZlTWluIiwiaXNSZWQiLCJtb3ZlUmVkTGVmdCIsInJvdGF0ZVJpZ2h0IiwibW92ZVJlZFJpZ2h0Iiwicm90YXRlTGVmdCIsImNvbG9yRmxpcCIsImNoZWNrTWF4RGVwdGgiLCJjaGVjayIsIlNvcnRlZFNldCIsImZpcnN0IiwibGFzdCIsImZvckVhY2hJblJhbmdlIiwiZm9yRWFjaFdoaWxlIiwiZmlyc3RBZnRlck9yRXF1YWwiLCJTb3J0ZWRTZXRJdGVyYXRvciIsInVuaW9uV2l0aCIsIml0ZXIiLCJGaWVsZE1hc2siLCJmaWVsZHMiLCJjb3ZlcnMiLCJfX1BSSVZBVEVfQmFzZTY0RGVjb2RlRXJyb3IiLCJCeXRlU3RyaW5nIiwiYmluYXJ5U3RyaW5nIiwiZnJvbUJhc2U2NFN0cmluZyIsIkRPTUV4Y2VwdGlvbiIsImZyb21VaW50OEFycmF5IiwidG9CYXNlNjQiLCJ0b1VpbnQ4QXJyYXkiLCJhcHByb3hpbWF0ZUJ5dGVTaXplIiwiRU1QVFlfQllURV9TVFJJTkciLCJvdCIsIl9fUFJJVkFURV9ub3JtYWxpemVUaW1lc3RhbXAiLCJuYW5vcyIsIl9fUFJJVkFURV9ub3JtYWxpemVOdW1iZXIiLCJfX1BSSVZBVEVfbm9ybWFsaXplQnl0ZVN0cmluZyIsIl90IiwiYXQiLCJ1dCIsImN0IiwiX19QUklWQVRFX2lzU2VydmVyVGltZXN0YW1wIiwibWFwVmFsdWUiLCJzdHJpbmdWYWx1ZSIsIl9fUFJJVkFURV9nZXRQcmV2aW91c1ZhbHVlIiwiX19QUklWQVRFX2dldExvY2FsV3JpdGVUaW1lIiwidGltZXN0YW1wVmFsdWUiLCJsdCIsIkRhdGFiYXNlSWQiLCJkYXRhYmFzZSIsImlzRGVmYXVsdERhdGFiYXNlIiwiUHQiLCJUdCIsIl9fdHlwZV9fIiwiRXQiLCJfX1BSSVZBVEVfdHlwZU9yZGVyIiwiX19QUklWQVRFX2lzTWF4VmFsdWUiLCJfX1BSSVZBVEVfaXNWZWN0b3JWYWx1ZSIsIl9fUFJJVkFURV92YWx1ZUVxdWFscyIsImJvb2xlYW5WYWx1ZSIsImJ5dGVzVmFsdWUiLCJyZWZlcmVuY2VWYWx1ZSIsImdlb1BvaW50VmFsdWUiLCJsYXRpdHVkZSIsImxvbmdpdHVkZSIsImludGVnZXJWYWx1ZSIsImRvdWJsZVZhbHVlIiwiYXJyYXlWYWx1ZSIsIl9fUFJJVkFURV9hcnJheVZhbHVlQ29udGFpbnMiLCJfX1BSSVZBVEVfdmFsdWVDb21wYXJlIiwiX19QUklWQVRFX2NvbXBhcmVUaW1lc3RhbXBzIiwiX19QUklWQVRFX2NvbXBhcmVBcnJheXMiLCJoZSIsImNhbm9uaWNhbElkIiwiX19QUklWQVRFX2Nhbm9uaWZ5VmFsdWUiLCJpc0ludGVnZXIiLCJfX1BSSVZBVEVfaXNNYXBWYWx1ZSIsIl9fUFJJVkFURV9kZWVwQ2xvbmUiLCJPYmplY3RWYWx1ZSIsImZpZWxkIiwiZ2V0RmllbGRzTWFwIiwic2V0QWxsIiwiYXBwbHlDaGFuZ2VzIiwiY2xvbmUiLCJNdXRhYmxlRG9jdW1lbnQiLCJkb2N1bWVudFR5cGUiLCJjcmVhdGVUaW1lIiwiZG9jdW1lbnRTdGF0ZSIsIm5ld0ludmFsaWREb2N1bWVudCIsIm5ld0ZvdW5kRG9jdW1lbnQiLCJuZXdOb0RvY3VtZW50IiwibmV3VW5rbm93bkRvY3VtZW50IiwiY29udmVydFRvRm91bmREb2N1bWVudCIsImNvbnZlcnRUb05vRG9jdW1lbnQiLCJjb252ZXJ0VG9Vbmtub3duRG9jdW1lbnQiLCJzZXRIYXNDb21taXR0ZWRNdXRhdGlvbnMiLCJzZXRIYXNMb2NhbE11dGF0aW9ucyIsInNldFJlYWRUaW1lIiwiaGFzTG9jYWxNdXRhdGlvbnMiLCJoYXNDb21taXR0ZWRNdXRhdGlvbnMiLCJoYXNQZW5kaW5nV3JpdGVzIiwiaXNWYWxpZERvY3VtZW50IiwiaXNGb3VuZERvY3VtZW50IiwiaXNOb0RvY3VtZW50IiwiaXNVbmtub3duRG9jdW1lbnQiLCJtdXRhYmxlQ29weSIsIkJvdW5kIiwiaW5jbHVzaXZlIiwiX19QUklWQVRFX2JvdW5kQ29tcGFyZVRvRG9jdW1lbnQiLCJkaXIiLCJfX1BSSVZBVEVfYm91bmRFcXVhbHMiLCJPcmRlckJ5IiwiX19QUklWQVRFX29yZGVyQnlFcXVhbHMiLCJGaWx0ZXIiLCJGaWVsZEZpbHRlciIsImNyZWF0ZUtleUZpZWxkSW5GaWx0ZXIiLCJfX1BSSVZBVEVfS2V5RmllbGRGaWx0ZXIiLCJfX1BSSVZBVEVfQXJyYXlDb250YWluc0ZpbHRlciIsIl9fUFJJVkFURV9JbkZpbHRlciIsIl9fUFJJVkFURV9Ob3RJbkZpbHRlciIsIl9fUFJJVkFURV9BcnJheUNvbnRhaW5zQW55RmlsdGVyIiwiX19QUklWQVRFX0tleUZpZWxkSW5GaWx0ZXIiLCJfX1BSSVZBVEVfS2V5RmllbGROb3RJbkZpbHRlciIsIm51bGxWYWx1ZSIsIm1hdGNoZXNDb21wYXJpc29uIiwib3BlcmF0b3IiLCJpc0luZXF1YWxpdHkiLCJnZXRGbGF0dGVuZWRGaWx0ZXJzIiwiZ2V0RmlsdGVycyIsIkNvbXBvc2l0ZUZpbHRlciIsImZpbHRlcnMiLCJfX1BSSVZBVEVfY29tcG9zaXRlRmlsdGVySXNDb25qdW5jdGlvbiIsInJlZHVjZSIsIl9fUFJJVkFURV9jb21wb3NpdGVGaWx0ZXJJc0ZsYXRDb25qdW5jdGlvbiIsIl9fUFJJVkFURV9jb21wb3NpdGVGaWx0ZXJJc0ZsYXQiLCJfX1BSSVZBVEVfY2Fub25pZnlGaWx0ZXIiLCJfX1BSSVZBVEVfZmlsdGVyRXF1YWxzIiwiX19QUklWQVRFX3N0cmluZ2lmeUZpbHRlciIsIl9fUFJJVkFURV9leHRyYWN0RG9jdW1lbnRLZXlzRnJvbUFycmF5VmFsdWUiLCJfX1BSSVZBVEVfVGFyZ2V0SW1wbCIsIm9yZGVyQnkiLCJzdGFydEF0IiwiZW5kQXQiLCJUZSIsIl9fUFJJVkFURV9uZXdUYXJnZXQiLCJfX1BSSVZBVEVfY2Fub25pZnlUYXJnZXQiLCJfX1BSSVZBVEVfdGFyZ2V0RXF1YWxzIiwiX19QUklWQVRFX1F1ZXJ5SW1wbCIsImV4cGxpY2l0T3JkZXJCeSIsImxpbWl0VHlwZSIsIkVlIiwiZGUiLCJfX1BSSVZBVEVfcXVlcnlNYXRjaGVzQWxsRG9jdW1lbnRzIiwiX19QUklWQVRFX3F1ZXJ5Tm9ybWFsaXplZE9yZGVyQnkiLCJfX1BSSVZBVEVfcXVlcnlUb1RhcmdldCIsIl9fUFJJVkFURV9fcXVlcnlUb1RhcmdldCIsIl9fUFJJVkFURV9xdWVyeVdpdGhMaW1pdCIsIl9fUFJJVkFURV9xdWVyeUVxdWFscyIsIl9fUFJJVkFURV9jYW5vbmlmeVF1ZXJ5IiwiX19QUklWQVRFX3N0cmluZ2lmeVF1ZXJ5IiwiX19QUklWQVRFX3F1ZXJ5TWF0Y2hlcyIsIl9fUFJJVkFURV9jb21wYXJlRG9jcyIsImRpcmVjdGlvbiIsIk9iamVjdE1hcCIsIm1hcEtleUZuIiwiZXF1YWxzRm4iLCJpbm5lciIsImlubmVyU2l6ZSIsIlJ0IiwiX19QUklWQVRFX211dGFibGVEb2N1bWVudE1hcCIsIlZ0IiwiZG9jdW1lbnRNYXAiLCJfX1BSSVZBVEVfY29udmVydE92ZXJsYXllZERvY3VtZW50TWFwVG9Eb2N1bWVudE1hcCIsIm92ZXJsYXllZERvY3VtZW50IiwiX19QUklWQVRFX25ld092ZXJsYXlNYXAiLCJfX1BSSVZBVEVfbmV3RG9jdW1lbnRLZXlNYXAiLCJfX1BSSVZBVEVfbmV3TXV0YXRpb25NYXAiLCJmdCIsIl9fUFJJVkFURV9kb2N1bWVudEtleVNldCIsImd0IiwiVHJhbnNmb3JtT3BlcmF0aW9uIiwiX19QUklWQVRFX2FwcGx5VHJhbnNmb3JtT3BlcmF0aW9uVG9Mb2NhbFZpZXciLCJfX1BSSVZBVEVfU2VydmVyVGltZXN0YW1wVHJhbnNmb3JtIiwiX19QUklWQVRFX0FycmF5VW5pb25UcmFuc2Zvcm1PcGVyYXRpb24iLCJfX1BSSVZBVEVfYXBwbHlBcnJheVVuaW9uVHJhbnNmb3JtT3BlcmF0aW9uIiwiX19QUklWQVRFX0FycmF5UmVtb3ZlVHJhbnNmb3JtT3BlcmF0aW9uIiwiX19QUklWQVRFX2FwcGx5QXJyYXlSZW1vdmVUcmFuc2Zvcm1PcGVyYXRpb24iLCJfX1BSSVZBVEVfTnVtZXJpY0luY3JlbWVudFRyYW5zZm9ybU9wZXJhdGlvbiIsIl9fUFJJVkFURV9jb21wdXRlVHJhbnNmb3JtT3BlcmF0aW9uQmFzZVZhbHVlIiwiYXNOdW1iZXIiLCJfX1BSSVZBVEVfdG9JbnRlZ2VyIiwidXNlUHJvdG8zSnNvbiIsIl9fUFJJVkFURV90b0RvdWJsZSIsInNlcmlhbGl6ZXIiLCJfX1BSSVZBVEVfYXBwbHlUcmFuc2Zvcm1PcGVyYXRpb25Ub1JlbW90ZURvY3VtZW50IiwiZWxlbWVudHMiLCJfX1BSSVZBVEVfY29lcmNlZEZpZWxkVmFsdWVzQXJyYXkiLCJQcmVjb25kaXRpb24iLCJ1cGRhdGVUaW1lIiwiZXhpc3RzIiwibm9uZSIsImlzTm9uZSIsIl9fUFJJVkFURV9wcmVjb25kaXRpb25Jc1ZhbGlkRm9yRG9jdW1lbnQiLCJNdXRhdGlvbiIsIl9fUFJJVkFURV9jYWxjdWxhdGVPdmVybGF5TXV0YXRpb24iLCJfX1BSSVZBVEVfRGVsZXRlTXV0YXRpb24iLCJfX1BSSVZBVEVfU2V0TXV0YXRpb24iLCJfX1BSSVZBVEVfUGF0Y2hNdXRhdGlvbiIsIl9fUFJJVkFURV9tdXRhdGlvbkFwcGx5VG9SZW1vdGVEb2N1bWVudCIsIl9fUFJJVkFURV9zZXJ2ZXJUcmFuc2Zvcm1SZXN1bHRzIiwiZmllbGRUcmFuc2Zvcm1zIiwidHJhbnNmb3JtUmVzdWx0cyIsInByZWNvbmRpdGlvbiIsIl9fUFJJVkFURV9nZXRQYXRjaCIsIl9fUFJJVkFURV9tdXRhdGlvbkFwcGx5VG9Mb2NhbFZpZXciLCJfX1BSSVZBVEVfbG9jYWxUcmFuc2Zvcm1SZXN1bHRzIiwiZmllbGRNYXNrIiwiX19QUklWQVRFX211dGF0aW9uRXF1YWxzIiwidHJhbnNmb3JtIiwiX19QUklWQVRFX2ZpZWxkVHJhbnNmb3JtRXF1YWxzIiwiZ2V0RmllbGRNYXNrIiwiUmUiLCJWZSIsIk11dGF0aW9uQmF0Y2giLCJiYXRjaElkIiwibG9jYWxXcml0ZVRpbWUiLCJiYXNlTXV0YXRpb25zIiwibXV0YXRpb25zIiwiYXBwbHlUb1JlbW90ZURvY3VtZW50IiwibXV0YXRpb25SZXN1bHRzIiwiYXBwbHlUb0xvY2FsVmlldyIsImFwcGx5VG9Mb2NhbERvY3VtZW50U2V0IiwibXV0YXRlZEZpZWxkcyIsIk92ZXJsYXkiLCJtdXRhdGlvbiIsImdldEtleSIsInB0IiwieXQiLCJKc29uUHJvdG9TZXJpYWxpemVyIiwiZGF0YWJhc2VJZCIsIl9fUFJJVkFURV9mcm9tVmVyc2lvbiIsIl9fUFJJVkFURV90b1Jlc291cmNlUGF0aCIsIl9fUFJJVkFURV9mcm9tUXVlcnlQYXRoIiwiX19QUklWQVRFX2lzVmFsaWRSZXNvdXJjZU5hbWUiLCJfX1BSSVZBVEVfZnJvbVJlc291cmNlTmFtZSIsIl9fUFJJVkFURV9leHRyYWN0TG9jYWxQYXRoRnJvbVJlc291cmNlTmFtZSIsIl9fUFJJVkFURV9jb252ZXJ0UXVlcnlUYXJnZXRUb1F1ZXJ5IiwicGFyZW50Iiwic3RydWN0dXJlZFF1ZXJ5IiwiYWxsRGVzY2VuZGFudHMiLCJjb2xsZWN0aW9uSWQiLCJ3aGVyZSIsIl9fUFJJVkFURV9mcm9tRmlsdGVyIiwiX19QUklWQVRFX2Zyb21GaWVsZFBhdGhSZWZlcmVuY2UiLCJiZWZvcmUiLCJfX1BSSVZBVEVfbmV3UXVlcnkiLCJ1bmFyeUZpbHRlciIsIk5hTiIsImZpZWxkRmlsdGVyIiwiY29tcG9zaXRlRmlsdGVyIiwiZmllbGRQYXRoIiwiX19QUklWQVRFX0xvY2FsU2VyaWFsaXplciIsIl9fUFJJVkFURV9mcm9tQnVuZGxlZFF1ZXJ5IiwiX19QUklWQVRFX0ZpcmVzdG9yZUluZGV4VmFsdWVXcml0ZXIiLCJEdCIsIkN0IiwidnQiLCJGdCIsIk10IiwieHQiLCJPdCIsIk50IiwiQnQiLCJMdCIsIk1BWF9TQUZFX0lOVEVHRVIiLCJrdCIsInF0IiwiUXQiLCIkdCIsIlV0IiwiS3QiLCJfX1BSSVZBVEVfTWVtb3J5SW5kZXhNYW5hZ2VyIiwiQ24iLCJfX1BSSVZBVEVfTWVtb3J5Q29sbGVjdGlvblBhcmVudEluZGV4IiwiYWRkVG9Db2xsZWN0aW9uUGFyZW50SW5kZXgiLCJnZXRDb2xsZWN0aW9uUGFyZW50cyIsImdldEVudHJpZXMiLCJhZGRGaWVsZEluZGV4IiwiZGVsZXRlRmllbGRJbmRleCIsImRlbGV0ZUFsbEZpZWxkSW5kZXhlcyIsImNyZWF0ZVRhcmdldEluZGV4ZXMiLCJnZXREb2N1bWVudHNNYXRjaGluZ1RhcmdldCIsImdldEluZGV4VHlwZSIsImdldEZpZWxkSW5kZXhlcyIsImdldE5leHRDb2xsZWN0aW9uR3JvdXBUb1VwZGF0ZSIsImdldE1pbk9mZnNldCIsImdldE1pbk9mZnNldEZyb21Db2xsZWN0aW9uR3JvdXAiLCJ1cGRhdGVDb2xsZWN0aW9uR3JvdXAiLCJ1cGRhdGVJbmRleEVudHJpZXMiLCJMcnVQYXJhbXMiLCJ3aXRoQ2FjaGVTaXplIiwiREVGQVVMVF9DT0xMRUNUSU9OX1BFUkNFTlRJTEUiLCJERUZBVUxUX01BWF9TRVFVRU5DRV9OVU1CRVJTX1RPX0NPTExFQ1QiLCJjYWNoZVNpemVDb2xsZWN0aW9uVGhyZXNob2xkIiwicGVyY2VudGlsZVRvQ29sbGVjdCIsIm1heGltdW1TZXF1ZW5jZU51bWJlcnNUb0NvbGxlY3QiLCJERUZBVUxUIiwiRElTQUJMRUQiLCJfX1BSSVZBVEVfVGFyZ2V0SWRHZW5lcmF0b3IiLCJhciIsInVyIiwiY3IiLCJSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlciIsImNoYW5nZXMiLCJjaGFuZ2VzQXBwbGllZCIsImFkZEVudHJ5IiwiYXNzZXJ0Tm90QXBwbGllZCIsInJlbW92ZUVudHJ5IiwiZ2V0RW50cnkiLCJnZXRGcm9tQ2FjaGUiLCJnZXRBbGxGcm9tQ2FjaGUiLCJPdmVybGF5ZWREb2N1bWVudCIsIkxvY2FsRG9jdW1lbnRzVmlldyIsInJlbW90ZURvY3VtZW50Q2FjaGUiLCJtdXRhdGlvblF1ZXVlIiwiZG9jdW1lbnRPdmVybGF5Q2FjaGUiLCJpbmRleE1hbmFnZXIiLCJnZXREb2N1bWVudCIsImdldE92ZXJsYXkiLCJnZXREb2N1bWVudHMiLCJnZXRMb2NhbFZpZXdPZkRvY3VtZW50cyIsInBvcHVsYXRlT3ZlcmxheXMiLCJjb21wdXRlVmlld3MiLCJnZXRPdmVybGF5ZWREb2N1bWVudHMiLCJnZXRPdmVybGF5cyIsInJlY2FsY3VsYXRlQW5kU2F2ZU92ZXJsYXlzIiwiZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXlzIiwic2F2ZU92ZXJsYXlzIiwicmVjYWxjdWxhdGVBbmRTYXZlT3ZlcmxheXNGb3JEb2N1bWVudEtleXMiLCJnZXREb2N1bWVudHNNYXRjaGluZ1F1ZXJ5IiwiZ2V0RG9jdW1lbnRzTWF0Y2hpbmdEb2N1bWVudFF1ZXJ5IiwiX19QUklWQVRFX2lzQ29sbGVjdGlvbkdyb3VwUXVlcnkiLCJnZXREb2N1bWVudHNNYXRjaGluZ0NvbGxlY3Rpb25Hcm91cFF1ZXJ5IiwiZ2V0RG9jdW1lbnRzTWF0Y2hpbmdDb2xsZWN0aW9uUXVlcnkiLCJnZXROZXh0RG9jdW1lbnRzIiwiZ2V0QWxsRnJvbUNvbGxlY3Rpb25Hcm91cCIsImdldE92ZXJsYXlzRm9yQ29sbGVjdGlvbkdyb3VwIiwiZ2V0T3ZlcmxheXNGb3JDb2xsZWN0aW9uIiwiX19QUklWQVRFX01lbW9yeUJ1bmRsZUNhY2hlIiwiTHIiLCJrciIsImdldEJ1bmRsZU1ldGFkYXRhIiwic2F2ZUJ1bmRsZU1ldGFkYXRhIiwiZ2V0TmFtZWRRdWVyeSIsInNhdmVOYW1lZFF1ZXJ5IiwiYnVuZGxlZFF1ZXJ5IiwiX19QUklWQVRFX01lbW9yeURvY3VtZW50T3ZlcmxheUNhY2hlIiwib3ZlcmxheXMiLCJxciIsIlN0IiwicmVtb3ZlT3ZlcmxheXNGb3JCYXRjaElkIiwiX19QUklWQVRFX01lbW9yeUdsb2JhbHNDYWNoZSIsInNlc3Npb25Ub2tlbiIsImdldFNlc3Npb25Ub2tlbiIsInNldFNlc3Npb25Ub2tlbiIsIl9fUFJJVkFURV9SZWZlcmVuY2VTZXQiLCJRciIsIl9fUFJJVkFURV9Eb2NSZWZlcmVuY2UiLCIkciIsIlVyIiwiS3IiLCJhZGRSZWZlcmVuY2UiLCJXciIsInJlbW92ZVJlZmVyZW5jZSIsIkdyIiwienIiLCJqciIsIkpyIiwiSHIiLCJjb250YWluc0tleSIsIllyIiwiX19QUklWQVRFX01lbW9yeU11dGF0aW9uUXVldWUiLCJyZWZlcmVuY2VEZWxlZ2F0ZSIsInRyIiwiWnIiLCJjaGVja0VtcHR5IiwiYWRkTXV0YXRpb25CYXRjaCIsImxvb2t1cE11dGF0aW9uQmF0Y2giLCJYciIsImdldE5leHRNdXRhdGlvbkJhdGNoQWZ0ZXJCYXRjaElkIiwiZWkiLCJnZXRIaWdoZXN0VW5hY2tub3dsZWRnZWRCYXRjaElkIiwiZ2V0QWxsTXV0YXRpb25CYXRjaGVzIiwiZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXkiLCJQT1NJVElWRV9JTkZJTklUWSIsInRpIiwiZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nUXVlcnkiLCJyZW1vdmVNdXRhdGlvbkJhdGNoIiwibmkiLCJtYXJrUG90ZW50aWFsbHlPcnBoYW5lZCIsImlyIiwicGVyZm9ybUNvbnNpc3RlbmN5Q2hlY2siLCJfX1BSSVZBVEVfTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZUltcGwiLCJyaSIsImRvY3MiLCJzZXRJbmRleE1hbmFnZXIiLCJpaSIsIm5ld0NoYW5nZUJ1ZmZlciIsIl9fUFJJVkFURV9NZW1vcnlSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlciIsImdldFNpemUiLCJOciIsIl9fUFJJVkFURV9NZW1vcnlUYXJnZXRDYWNoZSIsInNpIiwibGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbiIsImhpZ2hlc3RUYXJnZXRJZCIsIm9pIiwiX2kiLCJ0YXJnZXRDb3VudCIsImFpIiwiZm9yRWFjaFRhcmdldCIsImdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24iLCJnZXRIaWdoZXN0U2VxdWVuY2VOdW1iZXIiLCJhbGxvY2F0ZVRhcmdldElkIiwic2V0VGFyZ2V0c01ldGFkYXRhIiwiUHIiLCJ0YXJnZXRJZCIsInNlcXVlbmNlTnVtYmVyIiwiYWRkVGFyZ2V0RGF0YSIsInVwZGF0ZVRhcmdldERhdGEiLCJyZW1vdmVUYXJnZXREYXRhIiwicmVtb3ZlVGFyZ2V0cyIsInJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkIiwiZ2V0VGFyZ2V0Q291bnQiLCJnZXRUYXJnZXREYXRhIiwiYWRkTWF0Y2hpbmdLZXlzIiwicmVtb3ZlTWF0Y2hpbmdLZXlzIiwiZ2V0TWF0Y2hpbmdLZXlzRm9yVGFyZ2V0SWQiLCJfX1BSSVZBVEVfTWVtb3J5UGVyc2lzdGVuY2UiLCJ1aSIsImNpIiwibGkiLCJoaSIsIlBpIiwiVGkiLCJJaSIsInN0YXJ0ZWQiLCJzZXREYXRhYmFzZURlbGV0ZWRMaXN0ZW5lciIsInNldE5ldHdvcmtFbmFibGVkIiwiZ2V0SW5kZXhNYW5hZ2VyIiwiZ2V0RG9jdW1lbnRPdmVybGF5Q2FjaGUiLCJnZXRNdXRhdGlvblF1ZXVlIiwiZ2V0R2xvYmFsc0NhY2hlIiwiZ2V0VGFyZ2V0Q2FjaGUiLCJnZXRSZW1vdGVEb2N1bWVudENhY2hlIiwiZ2V0QnVuZGxlQ2FjaGUiLCJydW5UcmFuc2FjdGlvbiIsIl9fUFJJVkFURV9NZW1vcnlUcmFuc2FjdGlvbiIsIkVpIiwiZGkiLCJBaSIsImN1cnJlbnRTZXF1ZW5jZU51bWJlciIsIl9fUFJJVkFURV9NZW1vcnlFYWdlckRlbGVnYXRlIiwiUmkiLCJWaSIsIm1pIiwiZmkiLCJyZW1vdmVUYXJnZXQiLCJnaSIsInVwZGF0ZUxpbWJvRG9jdW1lbnQiLCJfX1BSSVZBVEVfTG9jYWxWaWV3Q2hhbmdlcyIsImZyb21DYWNoZSIsIkVzIiwiZHMiLCJBcyIsImRvY0NoYW5nZXMiLCJkb2MiLCJRdWVyeUNvbnRleHQiLCJfZG9jdW1lbnRSZWFkQ291bnQiLCJkb2N1bWVudFJlYWRDb3VudCIsImluY3JlbWVudERvY3VtZW50UmVhZENvdW50IiwiX19QUklWQVRFX1F1ZXJ5RW5naW5lIiwiUnMiLCJWcyIsImZzIiwiZ3MiLCJfX1BSSVZBVEVfZ2V0QW5kcm9pZFZlcnNpb24iLCJwcyIsInlzIiwid3MiLCJTcyIsImJzIiwiRHMiLCJDcyIsInZzIiwiX19QUklWQVRFX25ld0luZGV4T2Zmc2V0U3VjY2Vzc29yRnJvbVJlYWRUaW1lIiwiX19QUklWQVRFX25ld1F1ZXJ5Q29tcGFyYXRvciIsIl9fUFJJVkFURV9Mb2NhbFN0b3JlSW1wbCIsIkZzIiwiTXMiLCJ4cyIsIk9zIiwiTnMiLCJCcyIsImxvY2FsRG9jdW1lbnRzIiwiY29sbGVjdEdhcmJhZ2UiLCJjb2xsZWN0IiwiX19QUklWQVRFX0xvY2FsQ2xpZW50U3RhdGUiLCJhY3RpdmVUYXJnZXRJZHMiLCJ6cyIsImpzIiwiR3MiLCJ1cGRhdGVUaW1lTXMiLCJfX1BSSVZBVEVfTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGUiLCJNbyIsInhvIiwib25saW5lU3RhdGVIYW5kbGVyIiwiYWRkUGVuZGluZ011dGF0aW9uIiwidXBkYXRlTXV0YXRpb25TdGF0ZSIsImFkZExvY2FsUXVlcnlUYXJnZXQiLCJ1cGRhdGVRdWVyeVN0YXRlIiwicmVtb3ZlTG9jYWxRdWVyeVRhcmdldCIsImlzTG9jYWxRdWVyeVRhcmdldCIsImNsZWFyUXVlcnlTdGF0ZSIsImdldEFsbEFjdGl2ZVF1ZXJ5VGFyZ2V0cyIsImlzQWN0aXZlUXVlcnlUYXJnZXQiLCJoYW5kbGVVc2VyQ2hhbmdlIiwic2V0T25saW5lU3RhdGUiLCJub3RpZnlCdW5kbGVMb2FkZWQiLCJfX1BSSVZBVEVfTm9vcENvbm5lY3Rpdml0eU1vbml0b3IiLCJPbyIsIkp0IiwiX19QUklWQVRFX0Jyb3dzZXJDb25uZWN0aXZpdHlNb25pdG9yIiwiTm8iLCJCbyIsIkxvIiwia28iLCJxbyIsIlFvIiwiSHQiLCJfX1BSSVZBVEVfZ2VuZXJhdGVVbmlxdWVEZWJ1Z0lkIiwiWXQiLCJadCIsIkJhdGNoR2V0RG9jdW1lbnRzIiwiQ29tbWl0IiwiUnVuUXVlcnkiLCJSdW5BZ2dyZWdhdGlvblF1ZXJ5IiwiX19QUklWQVRFX1Jlc3RDb25uZWN0aW9uIiwiJG8iLCJkYXRhYmFzZUluZm8iLCJzc2wiLCJVbyIsIktvIiwiV28iLCJHbyIsInpvIiwiam8iLCJKbyIsIkhvIiwidGVybWluYXRlIiwiX19QUklWQVRFX1N0cmVhbUJyaWRnZSIsIllvIiwiWm8iLCJYbyIsImVfIiwidF8iLCJuXyIsInJfIiwiaV8iLCJzXyIsIm9fIiwiX18iLCJhXyIsInVfIiwiWHQiLCJfX1BSSVZBVEVfV2ViQ2hhbm5lbENvbm5lY3Rpb24iLCJjXyIsImF1dG9EZXRlY3RMb25nUG9sbGluZyIsImxvbmdQb2xsaW5nT3B0aW9ucyIsImxfIiwic3RyZWFtSWQiLCJoXyIsIlBfIiwiVF8iLCJmb3J3YXJkQ2hhbm5lbFJlcXVlc3RUaW1lb3V0TXMiLCJ0aW1lb3V0U2Vjb25kcyIsIklfIiwiX19QUklWQVRFX3VuZ3VhcmRlZEV2ZW50TGlzdGVuIiwiRV8iLCJfX1BSSVZBVEVfbWFwQ29kZUZyb21ScGNDb2RlIiwiX19QUklWQVRFX25ld1NlcmlhbGl6ZXIiLCJfX1BSSVZBVEVfRXhwb25lbnRpYWxCYWNrb2ZmIiwiTWkiLCJkXyIsIkFfIiwiUl8iLCJWXyIsIm1fIiwiZl8iLCJnXyIsInBfIiwieV8iLCJlbnF1ZXVlQWZ0ZXJEZWxheSIsIndfIiwic2tpcERlbGF5IiwiRGF0YXN0b3JlIiwiX19QUklWQVRFX0RhdGFzdG9yZUltcGwiLCJhdXRoQ3JlZGVudGlhbHMiLCJhcHBDaGVja0NyZWRlbnRpYWxzIiwiY29ubmVjdGlvbiIsIl9fUFJJVkFURV9PbmxpbmVTdGF0ZVRyYWNrZXIiLCJhc3luY1F1ZXVlIiwiX2EiLCJ0biIsIl9fUFJJVkFURV9SZW1vdGVTdG9yZUltcGwiLCJsb2NhbFN0b3JlIiwiZGF0YXN0b3JlIiwicmVtb3RlU3luY2VyIiwiZW5xdWV1ZUFuZEZvcmdldCIsIl9fUFJJVkFURV9jYW5Vc2VOZXR3b3JrIiwiX19QUklWQVRFX2Rpc2FibGVOZXR3b3JrSW50ZXJuYWwiLCJfX1BSSVZBVEVfZW5hYmxlTmV0d29ya0ludGVybmFsIiwiRGVsYXllZE9wZXJhdGlvbiIsInRhcmdldFRpbWVNcyIsInJlbW92YWxDYWxsYmFjayIsImNyZWF0ZUFuZFNjaGVkdWxlIiwidGltZXJIYW5kbGUiLCJoYW5kbGVEZWxheUVsYXBzZWQiLCJfX1BSSVZBVEVfRXZlbnRNYW5hZ2VySW1wbCIsInF1ZXJpZXMiLCJfX1BSSVZBVEVfbmV3UXVlcmllc09iamVjdE1hcCIsIm9ubGluZVN0YXRlIiwib25FcnJvciIsIm5uIiwicm4iLCJDYWNoZSIsIl9fUFJJVkFURV9TeW5jRW5naW5lSW1wbCIsInJlbW90ZVN0b3JlIiwiZXZlbnRNYW5hZ2VyIiwic2hhcmVkQ2xpZW50U3RhdGUiLCJtYXhDb25jdXJyZW50TGltYm9SZXNvbHV0aW9ucyIsIlB1IiwiVHUiLCJJdSIsIkV1IiwiZHUiLCJBdSIsIlJ1IiwiVnUiLCJtdSIsImZ1IiwiZ3UiLCJpc1ByaW1hcnlDbGllbnQiLCJfX1BSSVZBVEVfc3luY0VuZ2luZUFwcGx5T25saW5lU3RhdGVDaGFuZ2UiLCJ2aWV3Iiwic25hcHNob3QiLCJfX1BSSVZBVEVfcmFpc2VTbmFwc2hvdHNJblN5bmNFdmVudCIsIkhfIiwiX19QUklWQVRFX3N5bmNFbmdpbmVIYW5kbGVDcmVkZW50aWFsQ2hhbmdlIiwiTHMiLCJyZW1vdmVkQmF0Y2hJZHMiLCJhZGRlZEJhdGNoSWRzIiwiX19QUklWQVRFX2xvY2FsU3RvcmVIYW5kbGVVc2VyQ2hhbmdlIiwicHUiLCJ0YXJnZXRDaGFuZ2VzIiwiY3VycmVudCIsInNuYXBzaG90VmVyc2lvbiIsIndpdGhMYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uIiwiX19QUklWQVRFX3N5bmNFbmdpbmVFbWl0TmV3U25hcHNBbmROb3RpZnlMb2NhbFN0b3JlIiwiX19QUklWQVRFX01lbW9yeU9mZmxpbmVDb21wb25lbnRQcm92aWRlciIsImtpbmQiLCJzeW5jaHJvbml6ZVRhYnMiLCJEdSIsIkN1IiwidnUiLCJnY1NjaGVkdWxlciIsIkZ1IiwiaW5kZXhCYWNrZmlsbGVyU2NoZWR1bGVyIiwiTXUiLCJfX1BSSVZBVEVfbmV3TG9jYWxTdG9yZSIsImluaXRpYWxVc2VyIiwic3RvcCIsImJ1aWxkIiwiT25saW5lQ29tcG9uZW50UHJvdmlkZXIiLCJjcmVhdGVEYXRhc3RvcmUiLCJjcmVhdGVSZW1vdGVTdG9yZSIsImNyZWF0ZUV2ZW50TWFuYWdlciIsInN5bmNFbmdpbmUiLCJjcmVhdGVTeW5jRW5naW5lIiwiaGFuZGxlQ3JlZGVudGlhbENoYW5nZSIsIl9fUFJJVkFURV9yZW1vdGVTdG9yZUFwcGx5UHJpbWFyeVN0YXRlIiwiX24iLCJhbiIsInVuIiwiRmlyZXN0b3JlU2V0dGluZ3NJbXBsIiwiaXNVc2luZ0VtdWxhdG9yIiwiZW11bGF0b3JPcHRpb25zIiwiaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcyIsImNhY2hlU2l6ZUJ5dGVzIiwiX19QUklWQVRFX3ZhbGlkYXRlSXNOb3RVc2VkVG9nZXRoZXIiLCJleHBlcmltZW50YWxGb3JjZUxvbmdQb2xsaW5nIiwiZXhwZXJpbWVudGFsQXV0b0RldGVjdExvbmdQb2xsaW5nIiwiZXhwZXJpbWVudGFsTG9uZ1BvbGxpbmdPcHRpb25zIiwiX19QUklWQVRFX2Nsb25lTG9uZ1BvbGxpbmdPcHRpb25zIiwiRmlyZXN0b3JlJDEiLCJfYXV0aENyZWRlbnRpYWxzIiwiX2FwcENoZWNrQ3JlZGVudGlhbHMiLCJfZGF0YWJhc2VJZCIsIl9hcHAiLCJfcGVyc2lzdGVuY2VLZXkiLCJfc2V0dGluZ3MiLCJfc2V0dGluZ3NGcm96ZW4iLCJfZW11bGF0b3JPcHRpb25zIiwiX3Rlcm1pbmF0ZVRhc2siLCJfaW5pdGlhbGl6ZWQiLCJfdGVybWluYXRlZCIsIl9zZXRTZXR0aW5ncyIsInNlc3Npb25JbmRleCIsImlhbVRva2VuIiwiYXV0aFRva2VuRmFjdG9yeSIsImNsaWVudCIsIl9nZXRTZXR0aW5ncyIsIl9nZXRFbXVsYXRvck9wdGlvbnMiLCJfZnJlZXplU2V0dGluZ3MiLCJfdGVybWluYXRlIiwiX3Jlc3RhcnQiLCJjb25uZWN0RmlyZXN0b3JlRW11bGF0b3IiLCJtb2NrVXNlclRva2VuIiwiUXVlcnkiLCJjb252ZXJ0ZXIiLCJfcXVlcnkiLCJmaXJlc3RvcmUiLCJ3aXRoQ29udmVydGVyIiwiRG9jdW1lbnRSZWZlcmVuY2UiLCJfcGF0aCIsIkNvbGxlY3Rpb25SZWZlcmVuY2UiLCJyZWZlcmVuY2VQYXRoIiwiX19QUklWQVRFX25ld1F1ZXJ5Rm9yUGF0aCIsImNuIiwiX19QUklWQVRFX0FzeW5jUXVldWVJbXBsIiwiWHUiLCJNXyIsIl9jIiwidmlzaWJpbGl0eVN0YXRlIiwiaXNTaHV0dGluZ0Rvd24iLCJlbnF1ZXVlIiwiZW5xdWV1ZUFuZEZvcmdldEV2ZW5XaGlsZVJlc3RyaWN0ZWQiLCJlbnRlclJlc3RyaWN0ZWRNb2RlIiwiX19QUklWQVRFX2dldE1lc3NhZ2VPclN0YWNrIiwidmVyaWZ5T3BlcmF0aW9uSW5Qcm9ncmVzcyIsInN0YWNrIiwiRmlyZXN0b3JlIiwiX3F1ZXVlIiwiX2ZpcmVzdG9yZUNsaWVudCIsImdldEZpcmVzdG9yZSIsIkJ5dGVzIiwiX2J5dGVTdHJpbmciLCJGaWVsZFBhdGgiLCJfaW50ZXJuYWxQYXRoIiwiR2VvUG9pbnQiLCJfbGF0IiwiX2xvbmciLCJWZWN0b3JWYWx1ZSIsIl92YWx1ZXMiLCJ2ZWN0b3JWYWx1ZXMiLCJQbiIsIl9fUFJJVkFURV9jcmVhdGVFcnJvciIsIkRvY3VtZW50U25hcHNob3QkMSIsIl9maXJlc3RvcmUiLCJfdXNlckRhdGFXcml0ZXIiLCJfZG9jdW1lbnQiLCJfY29udmVydGVyIiwicmVmIiwiUXVlcnlEb2N1bWVudFNuYXBzaG90JDEiLCJmcm9tRmlyZXN0b3JlIiwiY29udmVydFZhbHVlIiwiX19QUklWQVRFX2ZpZWxkUGF0aEZyb21Bcmd1bWVudCIsInNlYXJjaCIsIl9fUFJJVkFURV9maWVsZFBhdGhGcm9tRG90U2VwYXJhdGVkU3RyaW5nIiwiU25hcHNob3RNZXRhZGF0YSIsIkRvY3VtZW50U25hcHNob3QiLCJfZmlyZXN0b3JlSW1wbCIsIlF1ZXJ5RG9jdW1lbnRTbmFwc2hvdCIsInNlcnZlclRpbWVzdGFtcHMiLCJidW5kbGUiLCJidW5kbGVTb3VyY2UiLCJidW5kbGVOYW1lIiwiY29udmVydE9iamVjdE1hcCIsIlF1ZXJ5U25hcHNob3QiLCJfc25hcHNob3QiLCJtdXRhdGVkS2V5cyIsImluY2x1ZGVNZXRhZGF0YUNoYW5nZXMiLCJleGNsdWRlc01ldGFkYXRhQ2hhbmdlcyIsIl9jYWNoZWRDaGFuZ2VzIiwiX2NhY2hlZENoYW5nZXNJbmNsdWRlTWV0YWRhdGFDaGFuZ2VzIiwib2xkRG9jcyIsIm9sZEluZGV4IiwibmV3SW5kZXgiLCJfX1BSSVZBVEVfcmVzdWx0Q2hhbmdlVHlwZSIsImluc3RhbmNlT2ZBbnkiLCJjb25zdHJ1Y3RvcnMiLCJpZGJQcm94eWFibGVUeXBlcyIsImN1cnNvckFkdmFuY2VNZXRob2RzIiwiY3Vyc29yUmVxdWVzdE1hcCIsInRyYW5zYWN0aW9uRG9uZU1hcCIsInRyYW5zYWN0aW9uU3RvcmVOYW1lc01hcCIsInRyYW5zZm9ybUNhY2hlIiwicmV2ZXJzZVRyYW5zZm9ybUNhY2hlIiwiaWRiUHJveHlUcmFwcyIsIklEQlRyYW5zYWN0aW9uIiwicmVwbGFjZVRyYXBzIiwidHJhbnNmb3JtQ2FjaGFibGVWYWx1ZSIsImZ1bmMiLCJJREJDdXJzb3IiLCJhZHZhbmNlIiwiY29udGludWUiLCJjb250aW51ZVByaW1hcnlLZXkiLCJ1bndyYXAiLCJzdG9yZU5hbWVzIiwidW5saXN0ZW4iLCJjYWNoZURvbmVQcm9taXNlRm9yVHJhbnNhY3Rpb24iLCJQcm94eSIsIklEQlJlcXVlc3QiLCJzdWNjZXNzIiwicHJvbWlzaWZ5UmVxdWVzdCIsIl9nZXRDdXJyZW50VXJsIiwiRGVsYXkiLCJfaXNJT1MiLCJfaXNNb2JpbGVCcm93c2VyIiwiX2dlbmVyYXRlQ2FsbGJhY2tOYW1lIiwic2VuZFBob25lVmVyaWZpY2F0aW9uQ29kZSIsIlZFUklGWV9QSE9ORV9OVU1CRVJfRk9SX0VYSVNUSU5HX0VSUk9SX01BUF8iLCJQaG9uZUF1dGhDcmVkZW50aWFsIiwiX2Zyb21WZXJpZmljYXRpb24iLCJ2ZXJpZmljYXRpb25JZCIsInZlcmlmaWNhdGlvbkNvZGUiLCJfZnJvbVRva2VuUmVzcG9uc2UiLCJ0ZW1wb3JhcnlQcm9vZiIsInNpZ25JbldpdGhQaG9uZU51bWJlciQxIiwiX21ha2VWZXJpZmljYXRpb25SZXF1ZXN0IiwibGlua1dpdGhQaG9uZU51bWJlciQxIiwidmVyaWZ5UGhvbmVOdW1iZXJGb3JFeGlzdGluZyIsInNlc3Npb25JbmZvIiwiVXNlckNyZWRlbnRpYWxJbXBsIiwib3BlcmF0aW9uVHlwZSIsInByb3ZpZGVySWRGb3JSZXNwb25zZSIsIl9mb3JPcGVyYXRpb24iLCJNdWx0aUZhY3RvckVycm9yIiwiX2Zyb21FcnJvckFuZE9wZXJhdGlvbiIsIl9wcm9jZXNzQ3JlZGVudGlhbFNhdmluZ01mYUNvbnRleHRJZk5lY2Vzc2FyeSIsInN0YXJ0RW5yb2xsUGhvbmVNZmEiLCJCcm93c2VyUGVyc2lzdGVuY2VDbGFzcyIsInN0b3JhZ2VSZXRyaWV2ZXIiLCJzZXRJdGVtIiwicmVtb3ZlSXRlbSIsImdldEl0ZW0iLCJCcm93c2VyTG9jYWxQZXJzaXN0ZW5jZSIsImxvY2FsU3RvcmFnZSIsInBvbGwiLCJvblN0b3JhZ2VFdmVudCIsImZhbGxiYWNrVG9Qb2xsaW5nIiwiZm9yQWxsQ2hhbmdlZEtleXMiLCJvbGRWYWx1ZSIsIl9vbGRWYWx1ZSIsImRldGFjaExpc3RlbmVyIiwidHJpZ2dlckxpc3RlbmVycyIsInN0b3JlZFZhbHVlIiwiZG9jdW1lbnRNb2RlIiwiU3RvcmFnZUV2ZW50IiwiYXR0YWNoTGlzdGVuZXIiLCJicm93c2VyTG9jYWxQZXJzaXN0ZW5jZSIsIkJyb3dzZXJTZXNzaW9uUGVyc2lzdGVuY2UiLCJzZXNzaW9uU3RvcmFnZSIsImJyb3dzZXJTZXNzaW9uUGVyc2lzdGVuY2UiLCJzdGFydFNpZ25JblBob25lTWZhIiwiUkVDQVBUQ0hBX1ZFUklGSUVSX1RZUEUiLCJfdmVyaWZ5UGhvbmVOdW1iZXIiLCJfaW5pdGlhbGl6ZVJlY2FwdGNoYUNvbmZpZyIsInBob25lSW5mb09wdGlvbnMiLCJzZXNzaW9uIiwic3RhcnRQaG9uZU1mYUVucm9sbG1lbnRSZXNwb25zZSIsImluamVjdFJlY2FwdGNoYVYyVG9rZW4iLCJwaG9uZVNlc3Npb25JbmZvIiwibWZhRW5yb2xsbWVudElkIiwibXVsdGlGYWN0b3JIaW50IiwibXVsdGlGYWN0b3JVaWQiLCJzdGFydFBob25lTWZhU2lnbkluUmVzcG9uc2UiLCJtZmFQZW5kaW5nQ3JlZGVudGlhbCIsInBob25lUmVzcG9uc2VJbmZvIiwic2VuZFBob25lVmVyaWZpY2F0aW9uQ29kZVJlc3BvbnNlIiwiX3Jlc2V0IiwicmVjYXB0Y2hhVjJWZXJpZmllciIsInJlY2FwdGNoYVYyVG9rZW4iLCJyZWNhcHRjaGFWZXJzaW9uIiwiUGhvbmVBdXRoUHJvdmlkZXIiLCJ2ZXJpZnlQaG9uZU51bWJlciIsInBob25lT3B0aW9ucyIsImFwcGxpY2F0aW9uVmVyaWZpZXIiLCJQSE9ORV9TSUdOX0lOX01FVEhPRCIsIklkcENyZWRlbnRpYWwiLCJfYnVpbGRJZHBSZXF1ZXN0Iiwic2Vzc2lvbklkIiwicmV0dXJuSWRwQ3JlZGVudGlhbCIsIl9zaWduSW4iLCJfc2lnbkluV2l0aENyZWRlbnRpYWwiLCJfcmVhdXRoIiwicGFyc2VkIiwiX3JlYXV0aGVudGljYXRlIiwiX2xpbmsiLCJfbGluayQxIiwiQWJzdHJhY3RQb3B1cFJlZGlyZWN0T3BlcmF0aW9uIiwicGVuZGluZ1Byb21pc2UiLCJvbkV4ZWN1dGlvbiIsInJlZ2lzdGVyQ29uc3VtZXIiLCJvbkF1dGhFdmVudCIsInVybFJlc3BvbnNlIiwiZ2V0SWRwVGFzayIsInVucmVnaXN0ZXJBbmRDbGVhblVwIiwidW5yZWdpc3RlckNvbnN1bWVyIiwiY2xlYW5VcCIsIl9QT0xMX1dJTkRPV19DTE9TRV9USU1FT1VUIiwiUG9wdXBPcGVyYXRpb24iLCJhdXRoV2luZG93IiwicG9sbElkIiwiY3VycmVudFBvcHVwQWN0aW9uIiwiZXhlY3V0ZU5vdE51bGwiLCJfb3BlblBvcHVwIiwiYXNzb2NpYXRlZEV2ZW50IiwiX29yaWdpblZhbGlkYXRpb24iLCJfaXNJZnJhbWVXZWJTdG9yYWdlU3VwcG9ydGVkIiwiaXNTdXBwb3J0ZWQiLCJwb2xsVXNlckNhbmNlbGxhdGlvbiIsImNsb3NlZCIsInJlZGlyZWN0T3V0Y29tZU1hcCIsIlJlZGlyZWN0QWN0aW9uIiwicmVhZHlPdXRjb21lIiwicGVuZGluZ1JlZGlyZWN0S2V5IiwicmVzb2x2ZXJQZXJzaXN0ZW5jZSIsImhhc1BlbmRpbmdSZWRpcmVjdCIsIl9nZXRBbmRDbGVhclBlbmRpbmdSZWRpcmVjdFN0YXR1cyIsIl9nZXRSZWRpcmVjdFJlc3VsdCIsInJlc29sdmVyRXh0ZXJuIiwicmVzb2x2ZXJPdmVycmlkZSIsIl93aXRoRGVmYXVsdFJlc29sdmVyIiwiQXV0aEV2ZW50TWFuYWdlciIsImNhY2hlZEV2ZW50VWlkcyIsImNvbnN1bWVycyIsInF1ZXVlZFJlZGlyZWN0RXZlbnQiLCJoYXNIYW5kbGVkUG90ZW50aWFsUmVkaXJlY3QiLCJsYXN0UHJvY2Vzc2VkRXZlbnRUaW1lIiwiYXV0aEV2ZW50Q29uc3VtZXIiLCJpc0V2ZW50Rm9yQ29uc3VtZXIiLCJzZW5kVG9Db25zdW1lciIsInNhdmVFdmVudFRvQ2FjaGUiLCJvbkV2ZW50IiwiaGFzRXZlbnRCZWVuSGFuZGxlZCIsImhhbmRsZWQiLCJjb25zdW1lciIsImlzTnVsbFJlZGlyZWN0RXZlbnQiLCJpc1JlZGlyZWN0RXZlbnQiLCJldmVudElkTWF0Y2hlcyIsImV2ZW50VWlkIiwiSVBfQUREUkVTU19SRUdFWCIsIkhUVFBfUkVHRVgiLCJtYXRjaERvbWFpbiIsImV4cGVjdGVkIiwiY3VycmVudFVybCIsImNlVXJsIiwiZXNjYXBlZERvbWFpblBhdHRlcm4iLCJORVRXT1JLX1RJTUVPVVQiLCJyZXNldFVubG9hZGVkR2FwaU1vZHVsZXMiLCJiZWFjb24iLCJfX19qc2wiLCJoaW50IiwiQ1AiLCJsb2FkR2FwaSIsImxvYWRHYXBpSWZyYW1lIiwiZ2FwaSIsImxvYWQiLCJpZnJhbWVzIiwiZ2V0Q29udGV4dCIsIklmcmFtZSIsImNiTmFtZSIsImNhY2hlZEdBcGlMb2FkZXIiLCJQSU5HX1RJTUVPVVQiLCJJRlJBTUVfQVRUUklCVVRFUyIsInRvcCIsImhlaWdodCIsInRhYmluZGV4IiwiRUlEX0ZST01fQVBJSE9TVCIsImdldElmcmFtZVVybCIsImVpZCIsImZ3IiwiQkFTRV9QT1BVUF9PUFRJT05TIiwicmVzaXphYmxlIiwic3RhdHVzYmFyIiwidG9vbGJhciIsIkF1dGhQb3B1cCIsIkZJUkVCQVNFX0FQUF9DSEVDS19GUkFHTUVOVF9JRCIsIl9nZXRSZWRpcmVjdFVybCIsImF1dGhUeXBlIiwicmVkaXJlY3RVcmwiLCJhZGRpdGlvbmFsUGFyYW1zIiwidGlkIiwicGFyYW1zRGljdCIsImFwcENoZWNrVG9rZW5GcmFnbWVudCIsImdldEhhbmRsZXJCYXNlIiwiV0VCX1NUT1JBR0VfU1VQUE9SVF9LRVkiLCJicm93c2VyUG9wdXBSZWRpcmVjdFJlc29sdmVyIiwiZXZlbnRNYW5hZ2VycyIsIm9yaWdpblZhbGlkYXRpb25Qcm9taXNlcyIsInNjcmVlbiIsImF2YWlsSGVpZ2h0IiwiYXZhaWxXaWR0aCIsInNjcm9sbGJhcnMiLCJvcHRpb25zU3RyaW5nIiwiYWNjdW0iLCJzdGFuZGFsb25lIiwiX2lzSU9TU3RhbmRhbG9uZSIsImNsaWNrIiwiY3JlYXRlRXZlbnQiLCJpbml0TW91c2VFdmVudCIsImRpc3BhdGNoRXZlbnQiLCJvcGVuQXNOZXdXaW5kb3dJT1MiLCJuZXdXaW4iLCJmb2N1cyIsIl9vcGVuIiwiX29wZW5SZWRpcmVjdCIsImluaXRBbmRHZXRNYW5hZ2VyIiwiaWZyYW1lIiwiY29udGV4dCIsIl9sb2FkR2FwaSIsIm1lc3NhZ2VIYW5kbGVyc0ZpbHRlciIsIkNST1NTX09SSUdJTl9JRlJBTUVTX0ZJTFRFUiIsImF0dHJpYnV0ZXMiLCJkb250Y2xlYXIiLCJyZXN0eWxlIiwic2V0SGlkZU9uTGVhdmUiLCJuZXR3b3JrRXJyb3IiLCJuZXR3b3JrRXJyb3JUaW1lciIsImNsZWFyVGltZXJBbmRSZXNvbHZlIiwicGluZyIsIl9vcGVuSWZyYW1lIiwicmVnaXN0ZXIiLCJpZnJhbWVFdmVudCIsImF1dGhFdmVudCIsImF1dGhvcml6ZWREb21haW5zIiwiX2dldFByb2plY3RDb25maWciLCJkb21haW4iLCJfdmFsaWRhdGVPcmlnaW4iLCJhdXRoSWRUb2tlbk1heEFnZSIsImxhc3RQb3N0ZWRJZFRva2VuIiwibWludENvb2tpZUZhY3RvcnkiLCJpZFRva2VuUmVzdWx0IiwiaWRUb2tlbkFnZSIsImF1dGhUb2tlblN5bmNQYXRoIiwiaXNTZWN1cmVDb250ZXh0IiwiYXV0aFRva2VuU3luY1VybCIsIm1pbnRDb29raWUiLCJjaGFyc2V0IiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJnZXREZWZhdWx0c0Zyb21Qb3N0aW5zdGFsbCIsIlBsYXRmb3JtTG9nZ2VyU2VydmljZUltcGwiLCJnZXRQbGF0Zm9ybUluZm9TdHJpbmciLCJpc1ZlcnNpb25TZXJ2aWNlUHJvdmlkZXIiLCJsaWJyYXJ5IiwibG9nU3RyaW5nIiwibmFtZSRxIiwidmVyc2lvbiQxIiwibG9nZ2VyIiwibmFtZSRwIiwibmFtZSRvIiwibmFtZSRuIiwibmFtZSRtIiwibmFtZSRsIiwibmFtZSRrIiwibmFtZSRqIiwibmFtZSRpIiwibmFtZSRoIiwibmFtZSRnIiwibmFtZSRmIiwibmFtZSRlIiwibmFtZSRkIiwibmFtZSRjIiwibmFtZSRiIiwibmFtZSRhIiwibmFtZSQ5IiwibmFtZSQ4IiwibmFtZSQ3IiwibmFtZSQ2IiwibmFtZSQ1IiwibmFtZSQ0IiwibmFtZSQzIiwibmFtZSQyIiwibmFtZSQxIiwiUExBVEZPUk1fTE9HX1NUUklORyIsIl9hcHBzIiwiX3NlcnZlckFwcHMiLCJfY29tcG9uZW50cyIsIl9hZGRDb21wb25lbnQiLCJfcmVnaXN0ZXJDb21wb25lbnQiLCJjb21wb25lbnROYW1lIiwic2VydmVyQXBwIiwiX2dldFByb3ZpZGVyIiwiaGVhcnRiZWF0Q29udHJvbGxlciIsInRyaWdnZXJIZWFydGJlYXQiLCJfaXNGaXJlYmFzZVNlcnZlckFwcCIsIkVSUk9SX0ZBQ1RPUlkiLCJGaXJlYmFzZUFwcEltcGwiLCJfaXNEZWxldGVkIiwiX2NvbmZpZyIsIl9uYW1lIiwiX2F1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCIsImF1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCIsImNoZWNrRGVzdHJveWVkIiwiaXNEZWxldGVkIiwiU0RLX1ZFUlNJT04iLCJpbml0aWFsaXplQXBwIiwicmF3Q29uZmlnIiwiZXhpc3RpbmdBcHAiLCJuZXdBcHAiLCJnZXRBcHAiLCJyZWdpc3RlclZlcnNpb24iLCJsaWJyYXJ5S2V5T3JOYW1lIiwidmFyaWFudCIsImxpYnJhcnlNaXNtYXRjaCIsInZlcnNpb25NaXNtYXRjaCIsIndhcm5pbmciLCJTVE9SRV9OQU1FIiwiZGJQcm9taXNlIiwiZ2V0RGJQcm9taXNlIiwib3JpZ2luYWxFcnJvck1lc3NhZ2UiLCJ3cml0ZUhlYXJ0YmVhdHNUb0luZGV4ZWREQiIsImhlYXJ0YmVhdE9iamVjdCIsImNvbXB1dGVLZXkiLCJpZGJHZXRFcnJvciIsIkhlYXJ0YmVhdFNlcnZpY2VJbXBsIiwiX2hlYXJ0YmVhdHNDYWNoZSIsIl9zdG9yYWdlIiwiSGVhcnRiZWF0U3RvcmFnZUltcGwiLCJfaGVhcnRiZWF0c0NhY2hlUHJvbWlzZSIsImFnZW50IiwiZ2V0VVRDRGF0ZVN0cmluZyIsImhlYXJ0YmVhdHMiLCJsYXN0U2VudEhlYXJ0YmVhdERhdGUiLCJzaW5nbGVEYXRlSGVhcnRiZWF0IiwiZWFybGllc3RIZWFydGJlYXRJZHgiLCJlYXJsaWVzdEhlYXJ0YmVhdERhdGUiLCJnZXRFYXJsaWVzdEhlYXJ0YmVhdElkeCIsIm92ZXJ3cml0ZSIsImhlYXJ0YmVhdHNUb1NlbmQiLCJ1bnNlbnRFbnRyaWVzIiwiaGVhcnRiZWF0c0NhY2hlIiwibWF4U2l6ZSIsImhlYXJ0YmVhdEVudHJ5IiwiZGF0ZXMiLCJjb3VudEJ5dGVzIiwiZXh0cmFjdEhlYXJ0YmVhdHNGb3JIZWFkZXIiLCJoZWFkZXJTdHJpbmciLCJfY2FuVXNlSW5kZXhlZERCUHJvbWlzZSIsInJ1bkluZGV4ZWREQkVudmlyb25tZW50Q2hlY2siLCJpZGJIZWFydGJlYXRPYmplY3QiLCJyZWFkSGVhcnRiZWF0c0Zyb21JbmRleGVkREIiLCJoZWFydGJlYXRzT2JqZWN0IiwiZXhpc3RpbmdIZWFydGJlYXRzT2JqZWN0IiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJkZWZpbml0aW9uIiwiZW51bWVyYWJsZSIsImdldEF0dHJpYnV0ZSIsImluaXRFdmVudCIsInF1ZXJ5U2VsZWN0b3IiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaGVhZCIsInJlbW92ZUNoaWxkIiwiU3RvcmFnZUVuY3J5cHRpb25NYW5hZ2VyIiwiY3VzdG9tQXV0aEluc3RhbmNlIiwiZW5jcnlwdCIsImRhdGFCdWZmZXIiLCJUZXh0RW5jb2RlciIsImVuY29kZSIsImdldEVuY3J5cHRpb25LZXkiLCJpdiIsImVuY3J5cHRlZCIsInN1YnRsZSIsImNvbWJpbmVkIiwiYnl0ZUxlbmd0aCIsImFycmF5QnVmZmVyVG9CYXNlNjQiLCJkZWNyeXB0IiwiZW5jcnlwdGVkRGF0YSIsImJhc2U2NFRvQXJyYXlCdWZmZXIiLCJkZWNyeXB0ZWQiLCJlbmNvZGVyIiwia2V5TWF0ZXJpYWwiLCJnZXRGaXJlYmFzZUtleU1hdGVyaWFsIiwiaW1wb3J0ZWRLZXkiLCJpbXBvcnRLZXkiLCJzYWx0IiwiZ2V0T3JHZW5lcmF0ZVNhbHQiLCJkZXJpdmVLZXkiLCJpdGVyYXRpb25zIiwiaGFzaCIsImZpcmViYXNlTW9kdWxlIiwibWF4V2FpdFRpbWUiLCJzdGFydFRpbWUiLCJ3YWl0VGltZSIsImdldExlZ2FjeUVuY3J5cHRpb25LZXkiLCJnZXRPckdlbmVyYXRlS2V5TWF0ZXJpYWwiLCJkZWNyeXB0V2l0aEtleSIsImVuY3J5cHRBUElLZXlWYXVsdCIsInZhdWx0IiwiZGVjcnlwdEFQSUtleVZhdWx0IiwiZW5jcnlwdGVkVmF1bHQiLCJlbmNyeXB0Q3VzdG9tUnVsZXMiLCJydWxlcyIsImRlY3J5cHRDdXN0b21SdWxlcyIsImVuY3J5cHRlZFJ1bGVzIiwiZW5jcnlwdEFjdGl2aXR5TG9ncyIsImxvZ3MiLCJkZWNyeXB0QWN0aXZpdHlMb2dzIiwiZW5jcnlwdGVkTG9ncyIsImVuY3J5cHRBY2NvdW50RGF0YSIsImFjY291bnQiLCJkZWNyeXB0QWNjb3VudERhdGEiLCJlbmNyeXB0ZWRBY2NvdW50IiwiU1RPUkFHRV9LRVkiLCJsb2NhbCIsInJhbmRvbUJ5dGVzIiwiYnVmZmVyIiwiYmluYXJ5Iiwic2V0Q3VzdG9tQXV0aCIsImNsZWFyQ3VzdG9tQXV0aCIsIlN0b3JhZ2VDb25maWdNYW5hZ2VyIiwiZW5jcnlwdGlvbk1hbmFnZXIiLCJjb25maWdDYWNoZSIsImNvbmZpZ0NhY2hlVGltZXN0YW1wIiwiQ0FDSEVfVFRMX01TIiwib25DaGFuZ2VkIiwiYXJlYU5hbWUiLCJDT05GSUdfS0VZIiwic2F2ZUNvbmZpZyIsImNvbmZpZ1RvU2F2ZSIsImFwaUtleVZhdWx0IiwiX2VuY3J5cHRlZEFwaUtleVZhdWx0IiwiY3VzdG9tUnVsZXMiLCJfZW5jcnlwdGVkQ3VzdG9tUnVsZXMiLCJzdGF0cyIsImFjdGl2aXR5TG9nIiwiX2VuY3J5cHRlZEFjdGl2aXR5TG9ncyIsImFjY291bnRUb0VuY3J5cHQiLCJfZW5jcnlwdGVkQWNjb3VudERhdGEiLCJmaXJlYmFzZVVpZCIsImxvYWRDb25maWciLCJjb25maWdXaXRoRW5jcnlwdGVkIiwiZGVjcnlwdGVkVmF1bHQiLCJkZWNyeXB0ZWRSdWxlcyIsImRlY3J5cHRlZExvZ3MiLCJkZWNyeXB0ZWRBY2NvdW50IiwiaGFzQ29uZmlnIiwidGhlbWUiLCJpc051bGwiLCJoYXNFbmNyeXB0ZWRLZXlzIiwiaGFzRW5jcnlwdGVkUnVsZXMiLCJoYXNFbmNyeXB0ZWRMb2dzIiwiaGFzRW5jcnlwdGVkQWNjb3VudCIsImtleUNvdW50IiwicnVsZXNDb3VudCIsImxvZ3NDb3VudCIsImhhc0FjY291bnRFbWFpbCIsInByb21wdFRlbXBsYXRlcyIsInRlbXBsYXRlcyIsImdldFN0YXJ0ZXJUZW1wbGF0ZXMiLCJtYXhUZW1wbGF0ZXMiLCJlbmFibGVLZXlib2FyZFNob3J0Y3V0cyIsImdldERlZmF1bHRDb25maWciLCJlbWFpbE9wdEluIiwidGllciIsInN5bmNFbmFibGVkIiwiZW5hYmxlZCIsImRlZmF1bHRNb2RlIiwic2hvd05vdGlmaWNhdGlvbnMiLCJkZWNvZGVSZXNwb25zZXMiLCJwcm90ZWN0ZWREb21haW5zIiwiZXhjbHVkZWREb21haW5zIiwic3RyaWN0TW9kZSIsImRlYnVnTW9kZSIsImNsb3VkU3luYyIsInByb2ZpbGVzIiwidG90YWxTdWJzdGl0dXRpb25zIiwidG90YWxJbnRlcmNlcHRpb25zIiwidG90YWxXYXJuaW5ncyIsInN1Y2Nlc3NSYXRlIiwibGFzdFN5bmNUaW1lc3RhbXAiLCJieVNlcnZpY2UiLCJjaGF0Z3B0IiwicmVxdWVzdHMiLCJzdWJzdGl0dXRpb25zIiwiY2xhdWRlIiwiZ2VtaW5pIiwicGVycGxleGl0eSIsImNvcGlsb3QiLCJpc1N0YXJ0ZXIiLCJyZWFkb25seSIsImRlc2NyaXB0aW9uIiwiY29udGVudCIsImNhdGVnb3J5IiwidXNhZ2VDb3VudCIsInVwZGF0ZWRBdCIsImxhc3RVc2VkIiwiY2xlYXJDYWNoZSIsImdlbmVyYXRlUGhvbmVWYXJpYXRpb25zIiwicGhvbmUiLCJ2YXJpYXRpb25zIiwiZGlnaXRzT25seSIsImFyZWFDb2RlIiwibGluZU51bWJlciIsImdlbmVyYXRlR2VuZXJpY1ZhcmlhdGlvbnMiLCJ0cmltbWVkIiwidGl0bGVDYXNlIiwid29yZCIsImdlbmVyYXRlSWRlbnRpdHlWYXJpYXRpb25zIiwiaWRlbnRpdHkiLCJwYXJ0cyIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwibWlkZGxlUGFydHMiLCJnZW5lcmF0ZU5hbWVWYXJpYXRpb25zIiwibG9jYWxQYXJ0Iiwibm9Eb3RzIiwiY2FtZWxDYXNlIiwiZ2VuZXJhdGVFbWFpbFZhcmlhdGlvbnMiLCJjZWxsUGhvbmUiLCJjb21wYW55IiwiYWRkcmVzcyIsIlN0b3JhZ2VQcm9maWxlTWFuYWdlciIsImNvbmZpZ01hbmFnZXIiLCJzYXZlUHJvZmlsZXMiLCJQUk9GSUxFU19LRVkiLCJsb2FkUHJvZmlsZXMiLCJoYXNMZWdhY3lLZXkiLCJvcmlnaW5hbEVycm9yIiwibGVnYWN5S2V5IiwibGVnYWN5RXJyb3IiLCJjcmVhdGVQcm9maWxlIiwicHJvZmlsZURhdGEiLCJpc0ZyZWUiLCJyZWFsIiwiYWxpYXMiLCJuZXdQcm9maWxlIiwiZ2VuZXJhdGVJZCIsInByb2ZpbGVOYW1lIiwidXNhZ2VTdGF0cyIsImJ5UElJVHlwZSIsImN1c3RvbSIsImNvbmZpZGVuY2UiLCJhdXRvUmVwbGFjZSIsImhpZ2hsaWdodEluVUkiLCJhY3RpdmVTZXJ2aWNlcyIsImVuYWJsZVZhcmlhdGlvbnMiLCJ1cGRhdGVQcm9maWxlIiwiZmluZEluZGV4IiwidXBkYXRlZFByb2ZpbGUiLCJyZWFsVmFyaWF0aW9ucyIsImFsaWFzVmFyaWF0aW9ucyIsImRlbGV0ZVByb2ZpbGUiLCJmaWx0ZXJlZCIsInRvZ2dsZVByb2ZpbGUiLCJnZXRQcm9maWxlIiwiaW5jcmVtZW50UHJvZmlsZVVzYWdlIiwicHJvZmlsZUlkIiwicGlpVHlwZSIsInByb2ZpbGUiLCJTdG9yYWdlQVBJS2V5VmF1bHRNYW5hZ2VyIiwiZW5zdXJlQVBJS2V5VmF1bHRDb25maWciLCJhdXRvRGV0ZWN0UGF0dGVybnMiLCJjdXN0b21QYXR0ZXJucyIsImFkZEFQSUtleSIsImtleURhdGEiLCJmb3JtYXQiLCJkZXRlY3RLZXlGb3JtYXQiLCJrZXlWYWx1ZSIsIm5ld0tleSIsInByb3RlY3Rpb25Db3VudCIsInJlbW92ZUFQSUtleSIsImtleUlkIiwidXBkYXRlQVBJS2V5IiwiZ2V0QVBJS2V5IiwiZ2V0QWxsQVBJS2V5cyIsImluY3JlbWVudEFQSUtleVByb3RlY3Rpb24iLCJ1cGRhdGVBUElLZXlWYXVsdFNldHRpbmdzIiwiU3RvcmFnZUN1c3RvbVJ1bGVzTWFuYWdlciIsImVuc3VyZUN1c3RvbVJ1bGVzQ29uZmlnIiwiYWRkQ3VzdG9tUnVsZSIsInJ1bGVEYXRhIiwicnVsZUlkIiwicmFuZG9tVVVJRCIsIm5ld1J1bGUiLCJwYXR0ZXJuIiwicmVwbGFjZW1lbnQiLCJwcmlvcml0eSIsIm1hdGNoQ291bnQiLCJ0ZXN0Q2FzZXMiLCJyZW1vdmVDdXN0b21SdWxlIiwidXBkYXRlQ3VzdG9tUnVsZSIsInJ1bGVJbmRleCIsInRvZ2dsZUN1c3RvbVJ1bGUiLCJydWxlIiwiaW5jcmVtZW50UnVsZU1hdGNoQ291bnQiLCJ1cGRhdGVDdXN0b21SdWxlc1NldHRpbmdzIiwiU3RvcmFnZVByb21wdFRlbXBsYXRlc01hbmFnZXIiLCJlbnN1cmVQcm9tcHRUZW1wbGF0ZXNDb25maWciLCJ1c2VyVGllciIsImFkZFByb21wdFRlbXBsYXRlIiwidGVtcGxhdGVEYXRhIiwibmV3VGVtcGxhdGUiLCJ0YWdzIiwicmVtb3ZlUHJvbXB0VGVtcGxhdGUiLCJ0ZW1wbGF0ZUlkIiwidXBkYXRlUHJvbXB0VGVtcGxhdGUiLCJnZXRQcm9tcHRUZW1wbGF0ZSIsImdldEFsbFByb21wdFRlbXBsYXRlcyIsImluY3JlbWVudFRlbXBsYXRlVXNhZ2UiLCJ1cGRhdGVQcm9tcHRUZW1wbGF0ZXNTZXR0aW5ncyIsIlN0b3JhZ2VEb2N1bWVudEFsaWFzTWFuYWdlciIsImxvYWREb2N1bWVudEFsaWFzZXMiLCJET0NVTUVOVF9BTElBU0VTX0tFWSIsImFsaWFzZXMiLCJpdGVtIiwic2F2ZURvY3VtZW50QWxpYXMiLCJkb2N1bWVudEFsaWFzIiwiZXhpc3RpbmciLCJkb2N1bWVudE5hbWUiLCJNQVhfRE9DVU1FTlRTIiwiZGVsZXRlRG9jdW1lbnRBbGlhcyIsInVwZGF0ZURvY3VtZW50QWxpYXMiLCJTdG9yYWdlTWlncmF0aW9uTWFuYWdlciIsInByb2ZpbGVNYW5hZ2VyIiwibWlncmF0ZVYxVG9WMklmTmVlZGVkIiwibWlncmF0ZUFQSUtleXNUb0VuY3J5cHRlZElmTmVlZGVkIiwiQ3VzdG9tRXZlbnQiLCJLRVlTIiwiVkVSU0lPTiIsInYxQWxpYXNlcyIsImxvYWRBbGlhc2VzRm9yTWlncmF0aW9uIiwicHJvZmlsZU1hcCIsIm5ld1Byb2ZpbGVzIiwiY2F0ZWdvcnlOYW1lIiwiYWxpYXNEYXRhIiwicmVhbFZhbHVlIiwiYWxpYXNWYWx1ZSIsInRvdGFsVXNhZ2UiLCJzdW0iLCJvbGRDb25maWciLCJuZXdDb25maWciLCJDT05GSUciLCJuZWVkc1NhdmUiLCJoYXNQbGFpbnRleHRLZXlzIiwiaGFzRW5jcnlwdGVkVmF1bHQiLCJoYXNQbGFpbnRleHRSdWxlcyIsImhhc1BsYWludGV4dExvZ3MiLCJoYXNQbGFpbnRleHRBY2NvdW50IiwiQUxJQVNFUyIsIlBST0ZJTEVTIiwiU3RvcmFnZU1hbmFnZXIiLCJhcGlLZXlWYXVsdE1hbmFnZXIiLCJjdXN0b21SdWxlc01hbmFnZXIiLCJwcm9tcHRUZW1wbGF0ZXNNYW5hZ2VyIiwiZG9jdW1lbnRBbGlhc01hbmFnZXIiLCJtaWdyYXRpb25NYW5hZ2VyIiwic2V0dXBTdG9yYWdlQ2hhbmdlTGlzdGVuZXIiLCJzZXR1cEF1dGhMaXN0ZW5lciIsImdldEluc3RhbmNlIiwic2F2ZUFsaWFzZXMiLCJsb2FkQWxpYXNlcyIsImFkZEFsaWFzIiwibmV3QWxpYXMiLCJyZW1vdmVBbGlhcyIsInVwZGF0ZUFsaWFzIiwiZ2V0U3RvcmFnZVF1b3RhIiwiZXN0aW1hdGUiLCJ1c2VkIiwidXNhZ2UiLCJxdW90YSIsInBlcmNlbnRhZ2UiLCJoYXNVbmxpbWl0ZWRTdG9yYWdlIiwiU1RBVFMiLCJBbGlhc0VuZ2luZSIsInJlYWxUb0FsaWFzTWFwIiwiYWxpYXNUb1JlYWxNYXAiLCJidWlsZExvb2t1cE1hcHMiLCJzZXRQcm9maWxlcyIsInBpaUZpZWxkcyIsInVzZVZhcmlhdGlvbnMiLCJtYXBwaW5nIiwiZGlzYWJsZWRSZWFsVmFyaWF0aW9ucyIsImRpc2FibGVkVmFyaWF0aW9ucyIsImRpc2FibGVkQWxpYXNWYXJpYXRpb25zIiwidmFyaWF0aW9uIiwiY3VzdG9tVmFyaWF0aW9ucyIsImN1c3RvbVJlYWxWYXJpYXRpb25zIiwidmFyT2JqIiwiY3VzdG9tQWxpYXNWYXJpYXRpb25zIiwic3Vic3RpdHV0ZSIsInByb2ZpbGVNYXRjaGVzIiwic29ydGVkS2V5cyIsInByb2ZpbGVJZHMiLCJyZWdleCIsImVzY2FwZVJlZ2V4IiwicHJlc2VydmVkIiwicHJlc2VydmVDYXNlIiwidG8iLCJwaWlUeXBlcyIsInByb2ZpbGVNYXRjaCIsImhhbmRsZVBvc3Nlc3NpdmVzIiwiY2FsY3VsYXRlQ29uZmlkZW5jZSIsInByb2ZpbGVzTWF0Y2hlZCIsInBtIiwiZmluZFBJSSIsImVuZCIsIm9yaWdpbmFsV29yZHMiLCJmaXJzdENoYXIiLCJwb3NzZXNzaXZlUGF0dGVybiIsInN1YnN0aXR1dGlvbkNvdW50IiwidXBkYXRlUHJvZmlsZVVzYWdlIiwiZ2V0UHJvZmlsZXMiLCJoYXNQcm9maWxlcyIsIkFQSUtleURldGVjdG9yIiwiZGV0ZWN0IiwiZGV0ZWN0ZWQiLCJwYXR0ZXJucyIsImluY2x1ZGVHZW5lcmljIiwic291cmNlIiwiZmxhZ3MiLCJzdGFydEluZGV4IiwiZW5kSW5kZXgiLCJzdG9yZWRLZXlzIiwiZGV0ZWN0Rm9ybWF0IiwiZGVkdXBsaWNhdGVLZXlzIiwicmVkYWN0IiwiZGV0ZWN0ZWRLZXlzIiwic29ydGVkIiwidmlzaWJsZSIsInJlcGVhdCIsInNlZW4iLCJvcGVuYWkiLCJhbnRocm9waWMiLCJnb29nbGUiLCJhd3MiLCJnaXRodWIiLCJzdHJpcGUiLCJnZW5lcmljIiwicmVkYWN0aW9uRW5naW5lIiwiY29tcGlsZWRSdWxlcyIsImNvbXBpbGVSdWxlcyIsInNvcnRlZFJ1bGVzIiwiYXBwbHlSdWxlcyIsIm1vZGlmaWVkVGV4dCIsInJ1bGVzQXBwbGllZCIsImxhc3RJbmRleCIsInJ1bGVNYXRjaGVzIiwib3JpZ2luYWxNYXRjaCIsInByb2Nlc3NSZXBsYWNlbWVudCIsInJ1bGVOYW1lIiwicnVsZU1hdGNoIiwiY2FwdHVyZUdyb3VwIiwidmFsaWRhdGVQYXR0ZXJuIiwidmFsaWQiLCJ0ZXN0UnVsZSIsInRlc3RUZXh0IiwicmVwbGFjZW1lbnRzIiwiZGV0ZWN0Q29uZmxpY3RzIiwiY29uZmxpY3RzIiwicnVsZTEiLCJydWxlMiIsInBhdHRlcm5zT3ZlcmxhcCIsInBhdHRlcm4xIiwicGF0dGVybjIiLCJCYWRnZU1hbmFnZXIiLCJjb250ZW50U2NyaXB0TWFuYWdlciIsImJhZGdlU3RhdGVDYWNoZSIsImlzQUlTZXJ2aWNlVVJMIiwiQUlfU0VSVklDRV9VUkxTIiwidXBkYXRlQmFkZ2UiLCJ0YWJJZCIsInN0YXRlQ2hhbmdlZCIsInNldEJhZGdlVGV4dCIsInNldEJhZGdlQmFja2dyb3VuZENvbG9yIiwic2V0VGl0bGUiLCJ0aXRsZSIsImNoZWNrQW5kVXBkYXRlQmFkZ2UiLCJjdXJyZW50RG9tYWluIiwiaXNJbmplY3RlZCIsImlzQ29udGVudFNjcmlwdEluamVjdGVkIiwiaGFzQWN0aXZlUHJvZmlsZXMiLCJpc1Byb3RlY3RlZCIsIkNvbnRlbnRTY3JpcHRNYW5hZ2VyIiwiYmFkZ2VNYW5hZ2VyIiwidGFicyIsInNlbmRNZXNzYWdlIiwiaW5qZWN0SW50b0V4aXN0aW5nVGFicyIsIkFJX1NFUlZJQ0VfUEFUVEVSTlMiLCJ0YWIiLCJzY3JpcHRpbmciLCJleGVjdXRlU2NyaXB0IiwiZmlsZXMiLCJoYW5kbGVSZWluamVjdCIsInJlbG9hZEFJU2VydmljZVRhYnMiLCJyZWxvYWRlZENvdW50IiwiQWN0aXZpdHlMb2dnZXIiLCJsb2dBY3Rpdml0eSIsImVudHJ5IiwiY3VycmVudExvZ3MiLCJ0cmltbWVkTG9ncyIsIlJlcXVlc3RQcm9jZXNzb3IiLCJhbGlhc0VuZ2luZSIsIl9hcGlLZXlEZXRlY3RvciIsInJlZGFjdGlvbkVuZ2luZUluc3RhbmNlIiwiYWN0aXZpdHlMb2dnZXIiLCJwcm9jZXNzUmVxdWVzdCIsInJlcXVlc3RCb2R5IiwiX3RhYklkIiwiZGV0ZWN0U2VydmljZSIsIm1vZGlmaWVkQm9keSIsInJlcXVlc3REYXRhIiwiYm9keVRvU3Vic3RpdHV0ZSIsImlzVXJsRW5jb2RlZCIsImZyZXFWYWx1ZSIsIlVSTFNlYXJjaFBhcmFtcyIsImRlY29kZUVycm9yIiwic3Vic3RpdHV0ZWQiLCJmaW5hbEJvZHkiLCJlbmNvZGVFcnJvciIsInRleHRDb250ZW50IiwidGV4dHMiLCJxdWVyeV9zdHIiLCJkc2xfcXVlcnkiLCJtZXNzYWdlcyIsIkJvb2xlYW4iLCJwcm9tcHQiLCJjb250ZW50cyIsImZsYXRNYXAiLCJleHRyYWN0QWxsVGV4dCIsImdldFNlcnZpY2VOYW1lIiwiZGV0YWlscyIsInByb2ZpbGVzVXNlZCIsInBpaVR5cGVzRm91bmQiLCJydWxlc1Jlc3VsdCIsImFsbG93ZWREZXRlY3Rpb25zIiwic3RvcmVkIiwiYXBpS2V5c1Byb3RlY3RlZCIsImtleVR5cGVzIiwibmVlZHNXYXJuaW5nIiwia2V5c0RldGVjdGVkIiwib3JpZ2luYWxCb2R5IiwiYXBpS2V5c0ZvdW5kIiwibW9kaWZpZWRSZXF1ZXN0RGF0YSIsInN1YnN0aXR1dGVkVGV4dCIsIm1vZGlmaWVkIiwidGV4dFBhcnRzIiwicGFydEluZGV4IiwicmVwbGFjZUFsbFRleHQiLCJSZXNwb25zZVByb2Nlc3NvciIsInByb2Nlc3NSZXNwb25zZSIsIl91cmwiLCJNZXNzYWdlUm91dGVyIiwiYWxpYXNIYW5kbGVycyIsImNvbmZpZ0hhbmRsZXJzIiwiYXBpS2V5SGFuZGxlcnMiLCJjdXN0b21SdWxlc0hhbmRsZXJzIiwicmVxdWVzdFByb2Nlc3NvciIsInJlc3BvbnNlUHJvY2Vzc29yIiwiaGFuZGxlTWVzc2FnZSIsInNlbmRlclRhYklkIiwiY3VycmVudENvbmZpZyIsImhhbmRsZVJlbG9hZFByb2ZpbGVzIiwiaGFuZGxlR2V0QWxpYXNlcyIsImhhbmRsZUdldFByb2ZpbGVzIiwiaGFuZGxlQWRkQWxpYXMiLCJoYW5kbGVSZW1vdmVBbGlhcyIsImhhbmRsZVVwZGF0ZUNvbmZpZyIsImhhbmRsZUdldENvbmZpZyIsImhhbmRsZUFkZEFQSUtleSIsImhhbmRsZVJlbW92ZUFQSUtleSIsImhhbmRsZVVwZGF0ZUFQSUtleSIsImhhbmRsZUdldEFQSUtleXMiLCJoYW5kbGVVcGRhdGVBUElLZXlWYXVsdFNldHRpbmdzIiwiaGFuZGxlQWRkQ3VzdG9tUnVsZSIsImhhbmRsZVJlbW92ZUN1c3RvbVJ1bGUiLCJoYW5kbGVVcGRhdGVDdXN0b21SdWxlIiwiaGFuZGxlVG9nZ2xlQ3VzdG9tUnVsZSIsImhhbmRsZVVwZGF0ZUN1c3RvbVJ1bGVzU2V0dGluZ3MiLCJBbGlhc0hhbmRsZXJzIiwicHJvZmlsZUNvdW50IiwiQ29uZmlnSGFuZGxlcnMiLCJmZWF0dXJlcyIsIkFQSUtleUhhbmRsZXJzIiwiQ3VzdG9tUnVsZXNIYW5kbGVycyIsImFwaUtleURldGVjdG9yIiwibWVzc2FnZVJvdXRlciIsIm9uU3RhcnR1cCIsIm9uSW5zdGFsbGVkIiwic2VuZFJlc3BvbnNlIiwib25BY3RpdmF0ZWQiLCJhY3RpdmVJbmZvIiwib25VcGRhdGVkIiwiY2hhbmdlSW5mbyIsImVuYWJsZWRDaGFuZ2VkIiwiZG9tYWluc0NoYW5nZWQiLCJvbGREb21haW5zIiwibmV3RG9tYWlucyJdLCJzb3VyY2VSb290IjoiIn0=